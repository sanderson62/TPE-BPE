* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* EL331.cbl
* Options: int("EL331.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL331.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL331.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL331.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL331 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:30:06.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.037.
     9
    10*AUTHOR.     LOGIC INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* EL331.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*         THIS PROGRAM UPDATES THE ONLINE INFORCE FILE USING
    27*       AN EXTRACT FILE FROM ECS CREDIT SYSTEM- AN AUDIT
    28*       REPORT IS PRODUCED SHOWING THE CHANGE IN STATUS OF
    29*       THE CERTIFICATE HAVING ASSOCIATED CLAIMS.
    30*
    31*         THE PROGRAM ALSO LOADS AND MAINTAINS THE COMMISSION
    32*       EXCEPTION FILE (ERCOMM).
    33*
    34**** NOTE FOLLOWING FILES MUST BE CLOSED TO RUN THIS PROG
    35*            ERCOMM, ELCERT, ERMAIL
    36*
    37*       INPUT FILES-             CLAIM MASTER
    38*                                ACCOUNT MASTER (IF SYSTEM D)
    39*                                DATE CARD FILE
    40*                                CERTIFICATE MASTER
    41*                                ECS CERTIFICATE MASTER
    42*                                DISK DATE
    43*                                MAIL DATA
    44*
    45*       OUTPUT-                  CERT LOAD CONTROL PAGE
    46*                                ERCOMM FILE (IF SYSTEM D)
    47*                                CERTIFICATE MASTER
    48*                                (FICH FILE)
    49*                                MAIL DATA
    50*
    51******************************************************************
    52*                   C H A N G E   L O G
    53*
    54* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    55*-----------------------------------------------------------------
    56*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    57* EFFECTIVE    NUMBER
    58*-----------------------------------------------------------------
    59* 062104    2004050700001  SMVA  ADD NEW FILE TO AUTOMATE ME BALANCING
    60* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
    61* 020906                   PEMA  INCREASE SIZE OF LOAN OFFICER
    62* 042607    2007032700002  PEMA  KEEP SPEC VA STUFF ON LINE
    63* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    64* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    65* 032612  CR2011110200001  PEMA  AHL CHANGES
    66* 042314  IR2013012200001  PEMA  Correct status on old certs.
    67* 042814  IR2014042400001  PEMA  Correct status on old certs.
    68* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    69* 070714  CR2013060600001  PEMA  AUTOMATE MONTH END BALANCING
    70* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    71* 011215  IR2015011200001  PEMA  Add I and G to claim type chks
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* EL331.cbl
    72******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* EL331.cbl
    74 ENVIRONMENT DIVISION.
    75
    76 INPUT-OUTPUT SECTION.
    77
    78 FILE-CONTROL.
    79
    80     SELECT PRNTR            ASSIGN TO SYS008.
    81
    82     SELECT DISK-DATE        ASSIGN TO SYS019.
    83
    84     SELECT FICH             ASSIGN TO SYS020.
    85
    86     SELECT ME50-EL331-BALANCE
    87                             ASSIGN TO SYS015
    88                             ORGANIZATION IS LINE SEQUENTIAL.
    89
    90     SELECT ECSCRT01         ASSIGN TO SYS010.
    91
    92     SELECT ELMSTR5          ASSIGN TO SYS011-3380-ELMSTR5
    93                             ORGANIZATION IS INDEXED
    94                             ACCESS IS DYNAMIC
    95                             RECORD KEY IS CL-CONTROL-BY-CERT-NO
    96                             FILE STATUS IS CL-STATUS.
    97
    98     SELECT ELRETR5          ASSIGN TO SYS011-3380-ELRETR5
    99                             ORGANIZATION IS INDEXED
   100                             ACCESS IS DYNAMIC
   101                             RECORD KEY IS RL-CONTROL-BY-CERT-NO
   102                             FILE STATUS IS ELRETR5-FILE-STATUS.
   103
   104     SELECT ELCERTF          ASSIGN TO SYS012-3380-ELCERT
   105                             ORGANIZATION IS INDEXED
   106                             ACCESS IS DYNAMIC
   107                             RECORD KEY IS CM-CONTROL-PRIMARY
   108                             FILE STATUS IS CM-STATUS.
   109
   110     SELECT ERCOMM           ASSIGN TO SYS013-3380-ERCOMM
   111                             ORGANIZATION IS INDEXED
   112                             ACCESS IS DYNAMIC
   113                             RECORD KEY IS CE-CONTROL-PRIMARY
   114                             FILE STATUS IS CE-STATUS.
   115
   116     SELECT ERACCT           ASSIGN TO SYS014-3380-ERACCT
   117                             ORGANIZATION IS INDEXED
   118                             ACCESS IS DYNAMIC
   119                             RECORD KEY IS AM-CONTROL-PRIMARY
   120                             FILE STATUS IS AM-STATUSF.
   121
   122     SELECT ELREPT           ASSIGN TO SYS018-3380-ELREPT
   123                             ORGANIZATION IS INDEXED
   124                             ACCESS IS DYNAMIC
   125                             RECORD KEY IS RF-CONTROL-PRIMARY
   126                             FILE STATUS IS DTE-VSAM-FLAGS.
   127
   128     SELECT ERMEBL           ASSIGN SYS024-3380-ERMEBL
   129                             ORGANIZATION INDEXED
   130                             ACCESS DYNAMIC
   131                             RECORD KEY ME-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* EL331.cbl
   132                             FILE STATUS ERMEBL-FILE-STATUS.
   133
   134     SELECT ERMAIL           ASSIGN TO SYS021-3380-ERMAIL
   135                             ORGANIZATION IS INDEXED
   136                             ACCESS IS RANDOM
   137                             RECORD KEY IS MA-CONTROL-PRIMARY
   138                             FILE STATUS IS ERMAIL-FILE-STATUS.
   139
   140     SELECT ERCTBL           ASSIGN TO ERCTBLT
   141                             ORGANIZATION IS INDEXED
   142                             ACCESS IS RANDOM
   143                             RECORD KEY IS CT-CONTROL-PRIMARY
   144                             FILE STATUS IS ERCTBL-FILE-STATUS.
   145
   146     SELECT  DISPLAY-PRT     ASSIGN TO SYS022-UR-1403-S-SYS022.
   147
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* EL331.cbl
   149
   150 DATA DIVISION.
   151
   152 FILE SECTION.
   153
   154 FD  PRNTR
*                                      COPY ELCPRTFD.
   155******************************************************************04/15/98
   156*                                                                *ELCPRTFD
   157*                                                                *ELCPRTFD
   158*                            ELCPRTFD.                           *   LV003
   159*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   160*                            VMOD=2.006                          *ELCPRTFD
   161******************************************************************ELCPRTFD
   162     RECORDING MODE F                                             ELCPRTFD
   163     LABEL RECORDS OMITTED                                        ELCPRTFD
   164     BLOCK CONTAINS 0 RECORDS
   165     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   166 01  PRT.                                                         ELCPRTFD
   167     12  P-CTL               PIC  X.                                 CL**2
   168     12  P-DATA              PIC  X(132).                         ELCPRTFD
   169******************************************************************ELCPRTFD
   170
   171 FD  ME50-EL331-BALANCE
   172     RECORDING MODE IS F
   173     BLOCK CONTAINS 0 RECORDS.
   174 01  ME50-EL331-BALANCE-REC    PIC X(95).
   175
   177 FD  ECSCRT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* EL331.cbl
*                                      COPY ECSCRIFD.
   178******************************************************************07/10/97
   179*                                                                *ECSCRIFD
   180*                            ECSCRIFD                            *   LV001
   181*                            VMOD 2.005                          *ECSCRIFD
   182*                                                                *ECSCRIFD
   183*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   184*                                                                *ECSCRIFD
   185******************************************************************ECSCRIFD
   186     BLOCK CONTAINS 0 RECORDS
   187     RECORDING MODE F.                                            ECSCRIFD
   188                                                                  ECSCRIFD
   189 01  CERT-IN-RECORD.                                              ECSCRIFD
   190                                                                  ECSCRIFD
   191     12  FILLER                            PIC XXX.               ECSCRIFD
   192     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   193     12  FILLER                            PIC X(66).             ECSCRIFD
   194     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   195     12  FILLER                            PIC X(20).             ECSCRIFD
   196     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   197     12  FILLER                            PIC X(14).             ECSCRIFD
   198     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   199     12  FILLER                            PIC X(39).             ECSCRIFD
   200     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   201     12  FILLER                            PIC X(45).             ECSCRIFD
   202     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   203     12  FILLER                            PIC X(35).             ECSCRIFD
   204     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   205     12  FILLER                            PIC X(41).             ECSCRIFD
   206     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   207     12  FILLER                            PIC X(48).             ECSCRIFD
   208     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   209     12  FILLER                            PIC X(9).              ECSCRIFD
   210     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   211     12  FILLER                            PIC X(120).            ECSCRIFD
   212     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   213     12  FILLER                            PIC X(73).             ECSCRIFD
   214     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   215     12  FILLER                            PIC X(464).            ECSCRIFD
   216                                                                  ECSCRIFD
   217******************************************************************ECSCRIFD
   218
*  219             COPY ECSCRT01 REPLACING CERTIFICATE-MASTER
*  220                                  BY ECS-CERT-RECORD.
   221******************************************************************
   222*                                                                *
   223*                            ECSCRT01                            *
   224*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   225*                            VMOD=2.016                          *
   226*                                                                *
   227*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   228*                                                                *
   229*   FILE TYPE = SEQUENTIAL
   230*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   231*                                                                *
   232*   KEY DATA =                         START=4, LEN=36           *
   233*                                                                *
   234*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   235*                                                                *
   236******************************************************************
   237******************************************************************
   238*                   C H A N G E   L O G
   239*
   240* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   241*-----------------------------------------------------------------
   242*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   243* EFFECTIVE    NUMBER
   244*-----------------------------------------------------------------
   245* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   246* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   247* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   248* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   249* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   250* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   251* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   252* 032612  CR2011110200001  PEMA  AHL CHANGES
   253* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
   254* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   255******************************************************************
   256
   257 01  CERTIFICATE-RECORD.
   258     12  CR-RECORD-ID                      PIC XX.
   259         88  VALID-CR-ID                      VALUE 'CR'.
   260
   261     12  CR-COMPANY-CD                     PIC X.
   262
   263     12  CR-FULL-CONTROL.
   264         16  CR-CONTROL-1.
   265             20  CR-ACCT-CONTROL.
   266                 24  CR-CARRIER            PIC X.
   267                 24  CR-GROUPING.
   268                     28  CR-GROUP-PREFIX   PIC XXX.
   269                     28  CR-GROUP-PRIME    PIC XXX.
   270                 24  CR-STATE              PIC XX.
   271                 24  CR-ACCOUNT.
   272                     28  CR-ACCT-PREFIX    PIC X(4).
   273                     28  CR-ACCT-PRIME     PIC X(6).
   274             20  CR-DT                     PIC 9(11)  COMP-3.
   275         16  CR-CERT-NO.
   276             20  CR-CERT.
   277                 24  CR-CERT-PREFIX        PIC X(3).
   278                 24  CR-CERT-PRIME         PIC X(7).
   279             20  CR-CERT-SFX               PIC X.
   280
   281     12  CR-INSUREDS-PROFILE.
   282         16  CR-NAME.
   283             20  CR-LNAME                  PIC X(15).
   284             20  CR-FNAME.
   285                 24  CR-1ST-INITIAL        PIC X.
   286                 24  FILLER                PIC X(9).
   287             20  CR-INIT                   PIC X.
   288         16  CR-AGE                        PIC 99.
   289         16  CR-SEX                        PIC X.
   290             88  CR-SEX-MALE                  VALUE 'M'.
   291             88  CR-SEX-FEMALE                VALUE 'F'.
   292         16  CR-SOC-SEC                    PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   293         16  CR-JOINT-NAME.
   294             20  CR-JT-LNAME               PIC X(15).
   295             20  CR-JT-FNAME.
   296                 24  CR-JT-1ST-INIT        PIC X.
   297                 24  FILLER                PIC X(9).
   298             20  CR-JT-INIT                PIC X.
   299         16  CR-JOINT-AGE                  PIC 99.
   300
   301         16  cr-ahl-ah-claim-no            pic x(9).
   302         16  cr-ahl-ah-cert-seq            pic x(3).
   303         16  cr-hst-proc-lf                pic x.
   304         16  f                             pic x(7).
   305
   306     12  CR-LF-COVERAGE-DATA.
   307         16  CR-LFTYP                      PIC XX.
   308         16  CR-LF-TERM                    PIC S999       COMP-3.
   309         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   310         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   311         16  CR-LF-DEV-CODE                PIC XXX.
   312         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   313
   314         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   315         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   316         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   317         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   318
   319         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   320         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   321         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   322         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   323
   324         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   325         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   326
   327         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   328         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   329
   330         16  CR-LF-REFUND-TYPE             PIC X.
   331         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   332
   333         16  CR-LF-COMM-CHARGEBACK         PIC X.
   334             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   335
   336         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   337
   338         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   339         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   340         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   341
   342         16  cr-ahl-lf-claim-no            pic x(9).
   343         16  cr-ahl-lf-cert-seq            pic x(3).
   344         16  FILLER                        PIC XX.
   345
   346     12  CR-AH-COVERAGE-DATA.
   347         16  CR-AHTYP                      PIC XX.
   348         16  CR-AH-TERM                    PIC S999       COMP-3.
   349         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   350         16  CR-AH-DEV-CODE                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   351         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   352
   353         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   354         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   355         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   356         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   357
   358         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   359         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   360
   361         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   362         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   363
   364         16  CR-AH-REFUND-TYPE             PIC X.
   365         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   366
   367         16  CR-AH-COMM-CHARGEBACK         PIC X.
   368             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   369
   370         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   371
   372         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   373         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   374         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   375
   376         16  FILLER                        PIC XX.
   377*        16  FILLER                        PIC X(8).
   378
   379     12  CR-LOAN-DATA.
   380         16  CR-LIVES                      PIC S9(7)      COMP-3.
   381         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   382                                           PIC S9(5)V99   COMP-3.
   383         16  CR-BILLED                     PIC S9(7)      COMP-3.
   384         16  CR-APR                        PIC S999V9(4)  COMP-3.
   385         16  CR-PMT-FREQ                   PIC 99.
   386         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   387         16  CR-RATING-CLASS               PIC XX.
   388         16  CR-POLICY-FORM-NO             PIC X(12).
   389         16  CR-GRPTYP                     PIC XX.
   390         16  CR-IND-GRP                    PIC X.
   391             88  CR-INDIVIDUAL                VALUE '1'.
   392             88  CR-GROUP                     VALUE '2'.
   393         16  CR-SKIP                       PIC 99.
   394             88  NO-MONTHS-SKIPPED            VALUE 00.
   395             88  SKIP-JULY                    VALUE 01.
   396             88  SKIP-AUGUST                  VALUE 02.
   397             88  SKIP-SEPTEMBER               VALUE 03.
   398             88  SKIP-JULY-AUG                VALUE 04.
   399             88  SKIP-AUG-SEPT                VALUE 05.
   400             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   401             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   402             88  SKIP-JUNE                    VALUE 08.
   403             88  SKIP-JUNE-JULY               VALUE 09.
   404             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   405             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   406         16  CR-RESIDENT-STATE             PIC XX.
   407         16  CR-RATE-CODE.
   408             20  CR-LF-CLASS-CD            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   409             20  CR-AH-CLASS-CD            PIC XX.
   410         16  CR-MORT.
   411             20  CR-TAB                    PIC X.
   412             20  CR-INT                    PIC 99.
   413             20  CR-GRP                    PIC X.
   414         16  CR-MEMBER-NO                  PIC X(12).
   415         16  CR-OLD-LOF                    PIC XXX.
   416*        16  CR-LOAN-OFFICER               PIC XXX.
   417         16  CR-REIN-TABLE                 PIC XXX.
   418         16  CR-REIN-SPEC                  PIC X.
   419         16  CR-LOAN-1ST-PMT-DT.
   420             20  CR-1ST-PMT-YR             PIC 99.
   421             20  CR-1ST-PMT-MO             PIC 99.
   422             20  CR-1ST-PMT-DA             PIC 99.
   423         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   424         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   425         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   426         16  CR-LAST-ADD-ON-DT             PIC XX.
   427
   428         16  CR-UNDERWRITING-CODE          PIC X.
   429             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   430
   431         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   432         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   433         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   434         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   435
   436     12  CR-STATUS-INFORMATION.
   437         16  CR-ENTRY-STATUS               PIC X.
   438             88  CR-NORMAL-ENTRY              VALUE '1'.
   439             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   440             88  CR-CONVERSION-ENTRY          VALUE '4'.
   441             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   442             88  CR-POLICY-IS-CASH            VALUE 'C'.
   443             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   444             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   445             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   446             88  CR-POLICY-IS-VOID            VALUE 'V'.
   447             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   448             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   449                                                'C' '5' '9' 'P'.
   450         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   451
   452         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   453         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   454         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   455
   456         16  CR-LF-STATUS-AT-DEATH         PIC X.
   457         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   458
   459         16  CR-LF-CURRENT-STATUS          PIC X.
   460             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   461             88  CR-LF-POLICY-PENDING         VALUE '2'.
   462             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   463             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   464             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   465             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   466             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   467             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   468             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   469             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   470             88  CR-LF-IS-DECLINED            VALUE 'D'.
   471             88  CR-LF-IS-VOID                VALUE 'V'.
   472             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   473                                                    '4' '5' '9'.
   474
   475         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   476
   477         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   478         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   479
   480         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   481         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   482
   483         16  CR-AH-CURRENT-STATUS          PIC X.
   484             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   485             88  CR-AH-POLICY-PENDING         VALUE '2'.
   486             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   487             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   488             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   489             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   490             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   491             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   492             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   493             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   494             88  CR-AH-IS-DECLINED            VALUE 'D'.
   495             88  CR-AH-IS-VOID                VALUE 'V'.
   496             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   497                                                    '4' '5' '9'.
   498         16  CR-LOAN-OFFICER               PIC X(5).
   499         16  CR-CANCEL-REASON              PIC X.
   500         16  cr-xycor-lf-cov-code          pic x(4).
   501         16  cr-xycor-ah-cov-code          pic x(4).
   502         16  cr-temp-epiq                  pic x(4).
   503         16  FILLER                        PIC XX.
   504
   505     12  CR-DEATH-CLAIM-DATA.
   506         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   507
   508         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   509         16  CR-DTH-RPT-DT.
   510             20  CR-DTH-RPT-YR             PIC 99.
   511             20  CR-DTH-RPT-MO             PIC 99.
   512             20  CR-DTH-RPT-DA             PIC 99.
   513         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   514
   515         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   516         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   517         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   518         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   519         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   520
   521         16  CR-DTH-AGE                    PIC 99.
   522         16  CR-DTH-PAY-CD                 PIC X.
   523         16  CR-DEATH-CAUSE                PIC X(6).
   524
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   525         16  FILLER                        PIC X(16).
   526
   527     12  CR-DISAB-CLAIM-DATA.
   528         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   529
   530         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   531         16  CR-DIS-RPT-DT.
   532             20  CR-DIS-RPT-YR             PIC 99.
   533             20  CR-DIS-RPT-MO             PIC 99.
   534             20  CR-DIS-RPT-DA             PIC 99.
   535         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   536         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   537
   538         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   539         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   540         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   541         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   542         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   543
   544         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   545         16  CR-DIS-PAY-CD                 PIC X.
   546         16  FILLER                        PIC XX.
   547
   548         16  CR-DISAB-INCURRED-DETAIL.
   549             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   550**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   551                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   552                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   553                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   554
   555         16  CR-DISAB-CAUSE                PIC X(6).
   556         16  FILLER                        PIC X(14).
   557
   558     12  CR-REMIT-TO                       PIC 99.
   559
   560     12  CR-COMPENSATION-LEVELS.
   561         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   562             20  CR-COM-AGT.
   563                 24  CR-COM-AGT-PREFIX     PIC X(4).
   564                 24  CR-COM-AGT-PRIME      PIC X(6).
   565             20  CR-AGT-TYPE               PIC X.
   566             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   567             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   568
   569     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   570     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   571     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   572     12  CR-CLP-STATE                      PIC XX.
   573     12  CR-POST-CARD-IND                  PIC X.
   574     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   575     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   576     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   577     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   578     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   579     12  FILLER                            PIC X(07).
   580
   581     12  CR-CSR-CODE                       PIC XXX.
   582
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   583     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   584     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   585
   586     12  CR-MICROFILM-NUMBERS.
   587*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   588         16  FILLER                        PIC X(5).
   589     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   590
   591     12  CR-USER-CODE                      PIC X.
   592     12  CR-USER-FUTURE                    PIC X(9).
   593
   594     12  CR-BENEFICIARY.
   595         16  CR-BANK-NO                    PIC X(10).
   596         16  FILLER                        PIC X(15).
   597
   598     12  CR-ENTRY-BATCH                    PIC X(6).
   599     12  CR-LF-EXIT-BATCH                  PIC X(6).
   600     12  CR-AH-EXIT-BATCH                  PIC X(6).
   601
   602     12  CR-NOTE-SW                        PIC X.
   603
   604     12  CR-ORIGIN-INDICATOR               PIC X.
   605         88  CR-ENTERED-MANUALLY              VALUE '1'.
   606         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   607
   608     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   609     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   610     12  FILLER                            PIC X(33).
   611
   612******************************************************************
   613
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* EL331.cbl
   615 FD  ELCERTF.
*  616                                 COPY ELCCERT.
   617******************************************************************04/15/98
   618*                                                                *ELCCERT
   619*                            ELCCERT.                            *   LV002
   620*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   621*                            VMOD=2.013                          *   CL**2
   622*                                                                *ELCCERT
   623*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
   624*                                                                *ELCCERT
   625*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
   626*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
   627*                                                                *ELCCERT
   628*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
   629*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
   630*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
   631*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
   632*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
   633*                                                                *ELCCERT
   634*   LOG = YES                                                    *ELCCERT
   635*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
   636******************************************************************
   637*                   C H A N G E   L O G
   638*
   639* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   640*-----------------------------------------------------------------
   641*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   642* EFFECTIVE    NUMBER
   643*-----------------------------------------------------------------
   644* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   645* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   646* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   647* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   648* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   649* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   650* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   651* 032612  CR2011110200001  PEMA  AHL CHANGES
   652* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   653******************************************************************
   654                                                                  ELCCERT
   655 01  CERTIFICATE-MASTER.                                          ELCCERT
   656     12  CM-RECORD-ID                      PIC XX.                ELCCERT
   657         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
   658                                                                  ELCCERT
   659     12  CM-CONTROL-PRIMARY.                                      ELCCERT
   660         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
   661         16  CM-CARRIER                    PIC X.                 ELCCERT
   662         16  CM-GROUPING.                                         ELCCERT
   663             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
   664             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
   665         16  CM-STATE                      PIC XX.                ELCCERT
   666         16  CM-ACCOUNT.                                          ELCCERT
   667             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
   668             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
   669         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
   670         16  CM-CERT-NO.                                          ELCCERT
   671             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
   672             20  CM-CERT-SFX               PIC X.                 ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   673                                                                  ELCCERT
   674     12  CM-CONTROL-BY-NAME.                                      ELCCERT
   675         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
   676         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
   677         16  CM-INSURED-INITIALS.                                 ELCCERT
   678             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
   679             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
   680                                                                  ELCCERT
   681     12  CM-CONTROL-BY-SSN.                                       ELCCERT
   682         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
   683         16  CM-SOC-SEC-NO.                                       ELCCERT
   684             20  CM-SSN-STATE              PIC XX.                ELCCERT
   685             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
   686             20  CM-SSN-LN3.                                      ELCCERT
   687                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
   688                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
   689                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
   690                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
   691                                                                  ELCCERT
   692     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
   693         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
   694         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
   695                                                                  ELCCERT
   696     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
   697         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
   698         16  CM-MEMBER-NO.                                        ELCCERT
   699             20  CM-MEMB-STATE             PIC XX.                ELCCERT
   700             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
   701             20  CM-MEMB-LN4.                                     ELCCERT
   702                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
   703                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
   704                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
   705                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
   706                                                                  ELCCERT
   707     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
   708         16  CM-INSURED-FIRST-NAME.                               ELCCERT
   709             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
   710             20  FILLER                    PIC X(9).              ELCCERT
   711         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
   712         16  CM-INSURED-SEX                PIC X.                 ELCCERT
   713             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
   714             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
   715         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
   716         16  CM-JOINT-INSURED-NAME.                               ELCCERT
   717             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
   718             20  CM-JT-FIRST-NAME.                                ELCCERT
   719                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
   720                 24  FILLER                PIC X(9).              ELCCERT
   721             20  CM-JT-INITIAL             PIC X.                 ELCCERT
   722                                                                  ELCCERT
   723     12  CM-LIFE-DATA.                                            ELCCERT
   724         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
   725         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
   726         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
   727         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
   728         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
   729         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
   730         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   731         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   732         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
   733         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   734         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   735         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
   736         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
   737         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
   738         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
   739         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
   740         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
   741         16  cm-temp-epiq                  pic xx.
   742             88  EPIQ-CLASS                  value 'EQ'.
   743*        16  FILLER                        PIC XX.                ELCCERT
   744                                                                  ELCCERT
   745     12  CM-AH-DATA.                                              ELCCERT
   746         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
   747         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
   748         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
   749         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
   750         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
   751         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   752         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   753         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   754         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
   755         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
   756         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
   757         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
   758             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
   759         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
   760         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
   761         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
   762         16  FILLER                        PIC X.                 ELCCERT
   763                                                                  ELCCERT
   764     12  CM-LOAN-INFORMATION.                                     ELCCERT
   765         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
   766         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   767                                           PIC S9(5)V99  COMP-3.
   768         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
   769         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
   770         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
   771         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
   772         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
   773         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
   774         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
   775         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
   776         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
   777         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
   778             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
   779             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
   780         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
   781             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
   782             20  CM-RATE-CODE              PIC X(4).              ELCCERT
   783             20  FILLER                    PIC XX.                ELCCERT
   784         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
   785             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
   786             20  FILLER                    PIC XXX.               ELCCERT
   787         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
   788         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   789             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
   790         16  CM-POST-CARD-IND              PIC X.
   791         16  CM-NH-INTERFACE-SW            PIC X.
   792         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
   793             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
   794             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
   795             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
   796         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
   797             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
   798             88  CM-GROUP                     VALUE 'G'.          ELCCERT
   799         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
   800             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
   801             88  SKIP-JULY                    VALUE '1'.          ELCCERT
   802             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
   803             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
   804             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
   805             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
   806             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
   807             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
   808             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
   809             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
   810             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
   811             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
   812         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
   813             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
   814             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
   815             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
   816             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
   817             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
   818         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
   819         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
   820         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
   821*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
   822         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
   823         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
   824         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
   825         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
   826         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
   827                                                                  ELCCERT
   828     12  CM-STATUS-DATA.                                          ELCCERT
   829         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
   830         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
   831                                                                  ELCCERT
   832         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
   833         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
   834         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
   835                                                                  ELCCERT
   836         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
   837         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
   838         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
   839                                                                  ELCCERT
   840         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
   841             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
   842                                                'M' '4' '5' '9'.  ELCCERT
   843             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
   844             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
   845             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
   846             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   847             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
   848             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   849             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
   850             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
   851             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
   852             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
   853             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
   854             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
   855             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
   856                                                                  ELCCERT
   857         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
   858         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
   859         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
   860                                                                  ELCCERT
   861         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
   862         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
   863         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
   864                                                                  ELCCERT
   865         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
   866             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
   867                                                'M' '4' '5' '9'.  ELCCERT
   868             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
   869             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
   870             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
   871             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
   872             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
   873             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   874             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
   875             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
   876             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
   877             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
   878             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
   879             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
   880             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
   881                                                                  ELCCERT
   882         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
   883             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
   884             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
   885             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
   886         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
   887                                                                  ELCCERT
   888         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
   889         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
   890         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
   891         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
   892                                                                  ELCCERT
   893     12  CM-NOTE-SW                        PIC X.                 ELCCERT
   894         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
   895         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
   896         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
   897         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
   898         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   899         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   900         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   901         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   902     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
   903         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
   904         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   905     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
   906         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
   907         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
   908                                                                  ELCCERT
   909*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
   910     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   911     12  FILLER                            PIC X.
   912                                                                  ELCCERT
   913*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
   914     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   915     12  FILLER                            PIC X.
   916*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
   917     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
   918                                                                  ELCCERT
   919     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
   920         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
   921         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
   922         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
   923         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
   924         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
   925     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
   926         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
   927         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
   928         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
   929         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
   930         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
   931         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
   932         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
   933         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
   934                                                                  ELCCERT
   935     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
   936         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
   937         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
   938                                                                  ELCCERT
   939     12  CM-USER-FIELD                     PIC X.                 ELCCERT
   940     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   941     12  CM-CLP-STATE                      PIC XX.
   942     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   943     12  CM-USER-RESERVED                  PIC XXX.
   944     12  FILLER REDEFINES CM-USER-RESERVED.
   945         16  CM-AH-CLASS-CD                PIC XX.
   946         16  F                             PIC X.
   947******************************************************************ELCCERT
   948
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* EL331.cbl
   950 FD  ERCOMM.
   951
*  952                                 COPY ERCCOMM.
   953******************************************************************04/29/98
   954*                                                                *ERCCOMM
   955*                                                                *ERCCOMM
   956*                            ERCCOMM                             *   LV002
   957*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   958*                            VMOD=2.003                          *   CL**2
   959*                                                                *ERCCOMM
   960*        FILE DESCRIPTION = COMPENSATION RATES WHEN DIFFERENT    *ERCCOMM
   961*                             FROM THOSE IN ACCOUNT MASTER       *ERCCOMM
   962*                                                                *ERCCOMM
   963*        FILE TYPE= VSAM,KSDS                                    *ERCCOMM
   964*        RECORD SIZE = 250    RECFORM = FIXED                    *ERCCOMM
   965*                                                                *ERCCOMM
   966*        BASE CLUSTER = CRCOMM        RKP=2,LEN=33               *ERCCOMM
   967*                                                                *ERCCOMM
   968*        LOG = YES                                               *ERCCOMM
   969*        SERVREQ = DELETE,UPDATE,NEWREC                          *ERCCOMM
   970*                                                                *ERCCOMM
   971******************************************************************ERCCOMM
   972                                                                  ERCCOMM
   973 01  COMMISSION-EXCEPTIONS.                                       ERCCOMM
   974     12  CE-RECORD-ID                PIC  XX.                     ERCCOMM
   975         88  VALID-CE-ID         VALUE 'CE'.                      ERCCOMM
   976                                                                  ERCCOMM
   977     12  CE-CONTROL-PRIMARY.                                      ERCCOMM
   978         16  CE-COMPANY-CD           PIC  X.                      ERCCOMM
   979         16  CE-CARRIER              PIC  X.                      ERCCOMM
   980         16  CE-GROUPING             PIC  X(6).                   ERCCOMM
   981         16  CE-STATE                PIC  XX.                     ERCCOMM
   982         16  CE-ACCOUNT              PIC  X(10).                  ERCCOMM
   983         16  CE-CERT-EFF-DT          PIC  XX.                     ERCCOMM
   984         16  CE-CERT-NO.                                          ERCCOMM
   985             20  CE-CERT-PRIME       PIC  X(10).                  ERCCOMM
   986             20  CE-CERT-SFX         PIC  X.                      ERCCOMM
   987                                                                  ERCCOMM
   988     12  CE-CERT-EXPIRATION-DT       PIC  XX.                     ERCCOMM
   989                                                                  ERCCOMM
   990     12  CE-COMP-STRUCTURE.                                       ERCCOMM
   991         16  CE-DEFN-1.                                           ERCCOMM
   992             20  CE-AGT-COMMS       OCCURS 10 TIMES.              ERCCOMM
   993                 24  CE-AGENT-NO    PIC  X(10).                   ERCCOMM
   994                 24  CE-COMP-TYPE   PIC  X.                       ERCCOMM
   995                 24  CE-LF-COMP     PIC SV9(5)      COMP-3.       ERCCOMM
   996                 24  CE-AH-COMP     PIC SV9(5)      COMP-3.       ERCCOMM
   997         16  CE-DEFN-2              REDEFINES CE-DEFN-1.          ERCCOMM
   998             20  CE-COMP-TABLES     OCCURS 10 TIMES.              ERCCOMM
   999                 24  FILLER         PIC  X(11).                   ERCCOMM
  1000                 24  CE-LF-COMPT    PIC  X(3).                    ERCCOMM
  1001                 24  CE-AH-COMPT    PIC  X(3).                    ERCCOMM
  1002                                                                  ERCCOMM
  1003     12  FILLER                     PIC  X(43).                   ERCCOMM
  1004******************************************************************ERCCOMM
  1005
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* EL331.cbl
  1007 FD  ERACCT.
  1008
* 1009                                 COPY ERCACCT.
  1010******************************************************************04/19/98
  1011*                                                                *ERCACCT
  1012*                                                                *ERCACCT
  1013*                            ERCACCT                             *   LV031
  1014*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
  1015*                            VMOD=2.031                          *ERCACCT
  1016*                                                                *ERCACCT
  1017*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
  1018*                                                                *ERCACCT
  1019*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
  1020*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
  1021*                                                                *ERCACCT
  1022*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
  1023*                                                                *ERCACCT
  1024*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
  1025*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
  1026*                                                                *ERCACCT
  1027*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
  1028*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
  1029*                                                                *ERCACCT
  1030*   LOG = NO                                                     *ERCACCT
  1031*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
  1032*                                                                *ERCACCT
  1033*                                                                *ERCACCT
  1034******************************************************************ERCACCT
  1035*                   C H A N G E   L O G
  1036*
  1037* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1038*-----------------------------------------------------------------
  1039*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1040* EFFECTIVE    NUMBER
  1041*-----------------------------------------------------------------
  1042* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1043* 092705    2005050300006  PEMA  ADD SPP LEASES
  1044* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1045* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1046* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1047* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1048* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1049******************************************************************
  1050                                                                  ERCACCT
  1051 01  ACCOUNT-MASTER.                                              ERCACCT
  1052     12  AM-RECORD-ID                      PIC XX.                ERCACCT
  1053         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
  1054                                                                  ERCACCT
  1055     12  AM-CONTROL-PRIMARY.                                      ERCACCT
  1056         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
  1057         16  AM-MSTR-CNTRL.                                       ERCACCT
  1058             20  AM-CONTROL-A.                                    ERCACCT
  1059                 24  AM-CARRIER            PIC X.                 ERCACCT
  1060                 24  AM-GROUPING.                                 ERCACCT
  1061                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
  1062                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
  1063                 24  AM-STATE              PIC XX.                ERCACCT
  1064                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1065                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
  1066                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
  1067             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
  1068                                           PIC X(19).             ERCACCT
  1069             20  AM-CNTRL-B.                                      ERCACCT
  1070                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
  1071                 24  FILLER                PIC X(4).              ERCACCT
  1072             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
  1073                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
  1074                                                                  ERCACCT
  1075     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
  1076         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
  1077         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
  1078         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
  1079         16  AM-VG-STATE                   PIC XX.                ERCACCT
  1080         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
  1081         16  AM-VG-DATE.                                          ERCACCT
  1082             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
  1083             20  FILLER                    PIC X(4).              ERCACCT
  1084         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
  1085                                           PIC 9(11)      COMP-3. ERCACCT
  1086     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1087         16  FILLER                        PIC X(10).
  1088         16  AM-VG-KEY3.
  1089             20  AM-VG3-ACCOUNT            PIC X(10).
  1090             20  AM-VG3-EXP-DT             PIC XX.
  1091         16  FILLER                        PIC X(4).
  1092     12  AM-MAINT-INFORMATION.                                    ERCACCT
  1093         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
  1094         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
  1095         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
  1096         16  FILLER                        PIC XX.                ERCACCT
  1097                                                                  ERCACCT
  1098     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
  1099     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
  1100                                                                  ERCACCT
  1101     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
  1102         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
  1103         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
  1104                                                                  ERCACCT
  1105     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
  1106     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
  1107                                                                  ERCACCT
  1108     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
  1109     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
  1110                                                                  ERCACCT
  1111     12  AM-NAME                           PIC X(30).             ERCACCT
  1112     12  AM-PERSON                         PIC X(30).             ERCACCT
  1113     12  AM-ADDRS                          PIC X(30).             ERCACCT
  1114     12  AM-CITY.
  1115         16  AM-ADDR-CITY                  PIC X(28).
  1116         16  AM-ADDR-STATE                 PIC XX.
  1117     12  AM-ZIP.                                                  ERCACCT
  1118         16  AM-ZIP-PRIME.                                        ERCACCT
  1119             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
  1120                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
  1121             20  FILLER                    PIC X(4).              ERCACCT
  1122         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1123     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
  1124         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
  1125         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
  1126         16  FILLER                        PIC XXX.               ERCACCT
  1127     12  AM-TEL-NO.                                               ERCACCT
  1128         16  AM-AREA-CODE                  PIC 999.               ERCACCT
  1129         16  AM-TEL-PRE                    PIC 999.               ERCACCT
  1130         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
  1131     12  AM-TEL-LOC                        PIC X.                 ERCACCT
  1132         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
  1133         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
  1134                                                                  ERCACCT
  1135     12  AM-COMM-STRUCTURE.                                       ERCACCT
  1136         16  AM-DEFN-1.                                           ERCACCT
  1137             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
  1138                 24  AM-AGT.                                      ERCACCT
  1139                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
  1140                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
  1141                 24  AM-COM-TYP            PIC X.                 ERCACCT
  1142                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
  1143                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
  1144                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
  1145                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
  1146                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
  1147                 24  AM-GL-CODES           PIC X.                 ERCACCT
  1148                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
  1149                 24  FILLER                PIC X(01).             ERCACCT
  1150         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
  1151             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
  1152                 24  FILLER                PIC X(11).             ERCACCT
  1153                 24  AM-L-COMA             PIC XXX.               ERCACCT
  1154                 24  AM-J-COMA             PIC XXX.               ERCACCT
  1155                 24  AM-A-COMA             PIC XXX.               ERCACCT
  1156                 24  FILLER                PIC X(6).              ERCACCT
  1157                                                                  ERCACCT
  1158     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
  1159         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
  1160                                                                  ERCACCT
  1161     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
  1162                                                                  ERCACCT
  1163     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
  1164         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
  1165         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
  1166     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
  1167         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
  1168         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
  1169     12  AM-GPCD                           PIC 99.                ERCACCT
  1170     12  AM-IG                             PIC X.                 ERCACCT
  1171         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
  1172         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
  1173     12  AM-STATUS                         PIC X.                 ERCACCT
  1174         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
  1175         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
  1176         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
  1177         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1178         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1179         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1180     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1181     12  AM-ID-NO                          PIC X(11).             ERCACCT
  1182                                                                  ERCACCT
  1183     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
  1184     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
  1185     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
  1186     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  1187     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  1188     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  1189     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  1190     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  1191     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  1192                                                                  ERCACCT
  1193     12  AM-USER-FIELDS.                                          ERCACCT
  1194         16  AM-FLD-1                      PIC XX.                ERCACCT
  1195         16  AM-FLD-2                      PIC XX.                ERCACCT
  1196         16  AM-FLD-3                      PIC XX.                ERCACCT
  1197         16  AM-FLD-4                      PIC XX.                ERCACCT
  1198         16  AM-FLD-5                      PIC XX.                ERCACCT
  1199                                                                  ERCACCT
  1200     12  AM-1ST-PROD-DATE.                                        ERCACCT
  1201         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
  1202         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
  1203         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
  1204     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
  1205     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
  1206         16  AM-PUR-YR                     PIC XX.                ERCACCT
  1207         16  AM-PUR-MO                     PIC XX.                ERCACCT
  1208         16  AM-PUR-DA                     PIC XX.                ERCACCT
  1209     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  1210     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  1211     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
  1212     12  AM-INACTIVE-DATE.                                        ERCACCT
  1213         16  AM-INA-MO                     PIC 99.                ERCACCT
  1214         16  AM-INA-DA                     PIC 99.                ERCACCT
  1215         16  AM-INA-YR                     PIC 99.                ERCACCT
  1216     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
  1217                                                                  ERCACCT
  1218     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  1219     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  1220                                                                  ERCACCT
  1221     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  1222         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  1223         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  1224         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  1225         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  1226                                                                  ERCACCT
  1227     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  1228         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  1229         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  1230                                                                  ERCACCT
  1231     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  1232                                                                  ERCACCT
  1233     12  AM-OVER-SHORT.                                           ERCACCT
  1234         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  1235         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  1236                                                                  ERCACCT
  1237     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1238     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1239                                                                  ERCACCT
  1240     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  1241     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  1242                                                                  ERCACCT
  1243     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  1244     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  1245     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  1246     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  1247     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  1248     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  1249     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  1250     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  1251     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  1252     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  1253     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  1254     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  1255     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  1256     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  1257     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  1258     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  1259                                                                  ERCACCT
  1260     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  1261                                                                  ERCACCT
  1262     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  1263     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  1264                                                                  ERCACCT
  1265     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  1266     12  AM-EARN-METHODS.                                         ERCACCT
  1267         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  1268             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  1269             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  1270             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  1271             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  1272         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  1273             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  1274             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  1275             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  1276             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  1277         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  1278             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  1279             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  1280             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  1281             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  1282             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  1283             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  1284                                                                  ERCACCT
  1285     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  1286     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  1287     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  1288                                                                  ERCACCT
  1289     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  1290     12  AM-RET-P-E                        PIC X.                 ERCACCT
  1291     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  1292     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  1293     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  1294     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  1295         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  1296         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1297     12  AM-RETRO-EARNINGS.                                       ERCACCT
  1298         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  1299         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  1300         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  1301     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  1302         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  1303         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  1304     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  1305         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  1306         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  1307         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  1308     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  1309     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  1310                                                                  ERCACCT
  1311     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  1312         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  1313         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  1314         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  1315         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  1316         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  1317                                                                  ERCACCT
  1318     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  1319                                                                  ERCACCT
  1320     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  1321                                                                  ERCACCT
  1322     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  1323         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  1324                                                                  ERCACCT
  1325     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  1326         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  1327         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  1328                                                                  ERCACCT
  1329     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  1330         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  1331                                                                  ERCACCT
  1332     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  1333         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  1334         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  1335                                                                  ERCACCT
  1336     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  1337                                                                  ERCACCT
  1338     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  1339     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1340     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1341     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1342     12  AM-DCC-UEF-STATE                  PIC XX.
  1343     12  FILLER                            PIC XXX.
  1344     12  AM-REPORT-CODE-3                  PIC X(10).
  1345*    12  FILLER                            PIC X(22).             ERCACCT
  1346                                                                  ERCACCT
  1347     12  AM-RESERVE-DATE.                                         ERCACCT
  1348         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  1349         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  1350         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  1351                                                                  ERCACCT
  1352     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  1353     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  1354         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1355         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
  1356         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  1357         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  1358                                                                  ERCACCT
  1359     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  1360         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  1361         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  1362         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  1363         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  1364                                                                  ERCACCT
  1365     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  1366         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  1367             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  1368             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  1369             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  1370             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  1371             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  1372             20  FILLER                    PIC XX.                ERCACCT
  1373         16  FILLER                        PIC X(80).             ERCACCT
  1374                                                                  ERCACCT
  1375     12  AM-TRANSFER-DATA.                                        ERCACCT
  1376         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  1377             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  1378             20  AM-TRNFROM-GROUPING.                             ERCACCT
  1379                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  1380                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  1381             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  1382             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  1383                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  1384                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  1385             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  1386         16  AM-TRANSFERRED-TO.                                   ERCACCT
  1387             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  1388             20  AM-TRNTO-GROUPING.                               ERCACCT
  1389                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  1390                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  1391             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  1392             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  1393                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  1394                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  1395             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  1396         16  FILLER                        PIC X(10).             ERCACCT
  1397                                                                  ERCACCT
  1398     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  1399                                                                  ERCACCT
  1400     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  1401         16  AM-DEFN-1-SAVED.                                     ERCACCT
  1402             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  1403                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  1404                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  1405                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1406                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1407                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1408                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  1409                 24  FILLER                PIC X.                 ERCACCT
  1410                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  1411                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  1412                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1413         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
  1414             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  1415                 24  FILLER                PIC X(11).             ERCACCT
  1416                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  1417                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  1418                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  1419                 24  FILLER                PIC X(6).              ERCACCT
  1420                                                                  ERCACCT
  1421     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  1422         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  1423            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  1424            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  1425            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  1426                                                                  ERCACCT
  1427     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  1428     12  FILLER                            PIC X(120).            ERCACCT
  1429                                                                  ERCACCT
  1430     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  1431         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  1432         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  1433             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  1434             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  1435                                                          COMP-3. ERCACCT
  1436             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  1437                                                          COMP-3. ERCACCT
  1438         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  1439             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  1440             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  1441                                                          COMP-3. ERCACCT
  1442             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  1443                                                          COMP-3. ERCACCT
  1444                                                                  ERCACCT
  1445     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  1446         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  1447         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  1448         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  1449         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  1450             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  1451                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  1452                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  1453             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  1454                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  1455                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  1456             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  1457                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  1458                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  1459         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  1460             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  1461                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  1462                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  1463                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  1464             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  1465                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  1466                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  1467             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  1468                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  1469                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  1470                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1471     12  AM-COMMENTS.                                             ERCACCT
  1472         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  1473                                                                  ERCACCT
  1474     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  1475         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  1476         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  1477         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  1478         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  1479         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  1480             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  1481             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  1482             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  1483             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  1484         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  1485             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  1486             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  1487             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  1488         16  FILLER                        PIC X(102).            ERCACCT
  1489                                                                  ERCACCT
  1490     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  1491         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  1492             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  1493             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  1494             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  1495             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  1496             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  1497         16  FILLER                          PIC X(10).           ERCACCT
  1498******************************************************************ERCACCT
  1499
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* EL331.cbl
  1501 FD  ELMSTR5.
  1502
* 1503                                 COPY ELCMSTR.
  1504******************************************************************04/15/98
  1505*                                                                *ELCMSTR
  1506*                            ELCMSTR.                            *   LV002
  1507*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1508*                            VMOD=2.012                          *   CL**2
  1509*                                                                *ELCMSTR
  1510*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
  1511*                                                                *ELCMSTR
  1512*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
  1513*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
  1514*                                                                *ELCMSTR
  1515*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
  1516*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
  1517*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
  1518*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
  1519*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
  1520*                                                 RKP=75,LEN=21  *ELCMSTR
  1521*                                                                *ELCMSTR
  1522*   **** NOTE ****                                               *ELCMSTR
  1523*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
  1524*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
  1525*                                                                *ELCMSTR
  1526*   LOG = YES                                                    *ELCMSTR
  1527*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
  1528******************************************************************
  1529*                   C H A N G E   L O G
  1530*
  1531* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1532*-----------------------------------------------------------------
  1533*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1534* EFFECTIVE    NUMBER
  1535*-----------------------------------------------------------------
  1536* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1537* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1538* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1539* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1540* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1541******************************************************************ELCMSTR
  1542 01  CLAIM-MASTER.                                                ELCMSTR
  1543     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
  1544         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
  1545                                                                  ELCMSTR
  1546     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
  1547         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
  1548         16  CL-CARRIER              PIC X.                       ELCMSTR
  1549         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
  1550         16  CL-CERT-NO.                                          ELCMSTR
  1551             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
  1552             20  CL-CERT-SFX         PIC X.                       ELCMSTR
  1553                                                                  ELCMSTR
  1554     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
  1555         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
  1556         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
  1557         16  CL-INSURED-NAME.                                     ELCMSTR
  1558             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1559             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
  1560                                                                  ELCMSTR
  1561     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
  1562         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
  1563         16  CL-SOC-SEC-NO.                                       ELCMSTR
  1564             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
  1565             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
  1566             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
  1567                                                                  ELCMSTR
  1568     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
  1569         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
  1570         16  CL-CERT-NO-A4.                                       ELCMSTR
  1571             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
  1572             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
  1573                                                                  ELCMSTR
  1574     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
  1575         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
  1576         16  CL-CCN-A5.                                           ELCMSTR
  1577             20  CL-CCN.                                          ELCMSTR
  1578                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
  1579                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
  1580             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
  1581                                                                  ELCMSTR
  1582     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
  1583         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
  1584         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
  1585             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
  1586             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
  1587             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
  1588         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
  1589         16  FILLER                  PIC X(5).                    ELCMSTR
  1590                                                                  ELCMSTR
  1591     12  CL-PROCESSING-INFO.                                      ELCMSTR
  1592         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
  1593         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
  1594             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
  1595             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
  1596         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
  1597*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
  1598*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
  1599*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
  1600*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
  1601*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
  1602*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  1603         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
  1604             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
  1605             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
  1606             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
  1607         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
  1608         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
  1609         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
  1610         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
  1611         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
  1612         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
  1613         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
  1614         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
  1615         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
  1616         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1617         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
  1618             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
  1619             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
  1620             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
  1621         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
  1622                                                                  ELCMSTR
  1623         16  CL-PRIME-CERT-NO.                                    ELCMSTR
  1624             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
  1625             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
  1626                                                                  ELCMSTR
  1627         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
  1628             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
  1629             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
  1630                                                                  ELCMSTR
  1631         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
  1632         16  FILLER REDEFINES CL-MICROFILM-NO.
  1633             20  CL-BENEFIT-PERIOD   PIC 99.
  1634             20  FILLER              PIC X(8).
  1635         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
  1636         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
  1637                                                                  ELCMSTR
  1638         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
  1639         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
  1640         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
  1641             88  FINAL-PAID             VALUE '1'.                ELCMSTR
  1642             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
  1643             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
  1644             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
  1645             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
  1646             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
  1647         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
  1648         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
  1649         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
  1650             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
  1651         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1652         16  FILLER                  PIC X.
  1653                                                                  ELCMSTR
  1654     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
  1655         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
  1656             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
  1657             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
  1658             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
  1659         16  CL-CERT-KEY-DATA.                                    ELCMSTR
  1660             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
  1661             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
  1662             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
  1663             20  CL-CERT-ACCOUNT.                                 ELCMSTR
  1664                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
  1665                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
  1666             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
  1667                                                                  ELCMSTR
  1668     12  CL-STATUS-CONTROLS.                                      ELCMSTR
  1669         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
  1670             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
  1671             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
  1672         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
  1673             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
  1674             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1675         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
  1676         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
  1677         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
  1678         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
  1679         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
  1680         16  CL-CRITICAL-PERIOD      PIC 99.
  1681*        16  FILLER                  PIC XX.                      ELCMSTR
  1682         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
  1683         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
  1684         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
  1685         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
  1686             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
  1687             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
  1688             88  LETTER-SENT            VALUE '2'.                ELCMSTR
  1689             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
  1690             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
  1691             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
  1692             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
  1693             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
  1694             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
  1695         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
  1696         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
  1697         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
  1698         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
  1699         16  CL-DENIAL-TYPE          PIC X.
  1700             88  CL-TYPE-DENIAL          VALUE '1'.
  1701             88  CL-TYPE-RESCISSION      VALUE '2'.
  1702             88  CL-TYPE-REFORMATION     VALUE '3'.
  1703             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1704             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1705         16  filler                  pic x(5).
  1706*        16  CL-CRIT-PER-RECURRENT   PIC X.
  1707*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1708*        16  CL-RTW-DT               PIC XX.
  1709                                                                  ELCMSTR
  1710     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
  1711         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
  1712             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
  1713             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
  1714             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
  1715         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
  1716         16  FILLER                  PIC XX.                      ELCMSTR
  1717         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
  1718         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
  1719             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1720                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
  1721             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1722                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
  1723             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
  1724                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
  1725             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
  1726                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
  1727             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
  1728                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
  1729             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1730                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
  1731             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1732                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1733                                                                  ELCMSTR
  1734     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
  1735         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
  1736         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
  1737                                                                  ELCMSTR
  1738     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
  1739                                                                  ELCMSTR
  1740     12  CL-PROCESS-ERRORS.                                       ELCMSTR
  1741         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
  1742             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
  1743         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
  1744             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
  1745                                                                  ELCMSTR
  1746     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
  1747                                                                  ELCMSTR
  1748     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
  1749         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
  1750         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
  1751         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
  1752         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
  1753                                                                  ELCMSTR
  1754     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
  1755         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
  1756         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
  1757         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
  1758         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
  1759                                                                  ELCMSTR
  1760     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
  1761     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
  1762     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
  1763                                                                  ELCMSTR
  1764     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
  1765     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
  1766     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
  1767     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
  1768                                                                  ELCMSTR
  1769     12  CL-YESNOSW                  PIC X.                       ELCMSTR
  1770     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  1771         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  1772         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  1773         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  1774     12  cl-insured-type             pic x.
  1775         88  cl-claim-on-primary         value 'P'.
  1776         88  cl-claim-on-co-borrower     value 'C'.
  1777     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* EL331.cbl
  1779 FD  ELRETR5.
  1780
* 1781                                 COPY ELCRETR.
  1782******************************************************************04/16/98
  1783*                                                                *ELCRETR
  1784*                                                                *ELCRETR
  1785*                            ELCRETR.                            *   LV002
  1786*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1787*                            VMOD=2.002                          *   CL**2
  1788*                                                                *ELCRETR
  1789*   FILE DESCRIPTION = CLAIM MASTER RETRIEVE FILE                *ELCRETR
  1790*                                                                *ELCRETR
  1791*   **** NOTE -- THIS FILE IS IDENTICAL TO CLAIM MASTER (ELMSTR) *ELCRETR
  1792*   ****      ANY CHANGES TO THIS COPYBOOK OR ELCMSTR MUST BE    *ELCRETR
  1793*   ****      DUPLICATED IN THE OTHER.                           *ELCRETR
  1794*                                                                *ELCRETR
  1795*   FILE TYPE = VSAM,KSDS                                        *ELCRETR
  1796*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCRETR
  1797*                                                                *ELCRETR
  1798*   BASE CLUSTER = ELRETR                         RKP=2,LEN=20   *ELCRETR
  1799*       ALTERNATE PATH1 = ELRETR2 (BY NAME)       RKP=22,LEN=29  *ELCRETR
  1800*       ALTERNATE PATH2 = ELRETR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCRETR
  1801*       ALTERNATE PATH3 = ELRETR5 (BY CERT NO)    RKP=63,LEN=12  *ELCRETR
  1802*       ALTERNATE PATH4 = ELRETR6 (BY CREDIT CARD NO)             ELCRETR
  1803*                                                 RKP=75,LEN=21  *ELCRETR
  1804*                                                                *ELCRETR
  1805*   LOG = YES                                                    *ELCRETR
  1806*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCRETR
  1807******************************************************************ELCRETR
  1808 01  RETRIEVE-MASTER.                                             ELCRETR
  1809     12  RL-RECORD-ID                PIC XX.                      ELCRETR
  1810         88  VALID-RL-ID         VALUE 'RL'.                      ELCRETR
  1811                                                                  ELCRETR
  1812     12  RL-CONTROL-PRIMARY.                                      ELCRETR
  1813         16  RL-COMPANY-CD           PIC X.                       ELCRETR
  1814         16  RL-CARRIER              PIC X.                       ELCRETR
  1815         16  RL-CLAIM-NO             PIC X(7).                    ELCRETR
  1816         16  RL-CERT-NO.                                          ELCRETR
  1817             20  RL-CERT-PRIME       PIC X(10).                   ELCRETR
  1818             20  RL-CERT-SFX         PIC X.                       ELCRETR
  1819                                                                  ELCRETR
  1820     12  RL-CONTROL-BY-NAME.                                      ELCRETR
  1821         16  RL-COMPANY-CD-A1        PIC X.                       ELCRETR
  1822         16  RL-INSURED-LAST-NAME    PIC X(15).                   ELCRETR
  1823         16  RL-INSURED-NAME.                                     ELCRETR
  1824             20  RL-INSURED-1ST-NAME PIC X(12).                   ELCRETR
  1825             20  RL-INSURED-MID-INIT PIC X.                       ELCRETR
  1826                                                                  ELCRETR
  1827     12  RL-CONTROL-BY-SSN.                                       ELCRETR
  1828         16  RL-COMPANY-CD-A2        PIC X.                       ELCRETR
  1829         16  RL-SOC-SEC-NO.                                       ELCRETR
  1830             20  RL-SSN-STATE        PIC XX.                      ELCRETR
  1831             20  RL-SSN-ACCOUNT      PIC X(6).                    ELCRETR
  1832             20  RL-SSN-LN3          PIC X(3).                    ELCRETR
  1833                                                                  ELCRETR
  1834     12  RL-CONTROL-BY-CERT-NO.                                   ELCRETR
  1835         16  RL-COMPANY-CD-A4        PIC X.                       ELCRETR
  1836         16  RL-CERT-NO-A4.                                       ELCRETR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1837             20  RL-CERT-A4-PRIME    PIC X(10).                   ELCRETR
  1838             20  RL-CERT-A4-SFX      PIC X.                       ELCRETR
  1839                                                                  ELCRETR
  1840     12  RL-CONTROL-BY-CCN.                                       ELCRETR
  1841         16  RL-COMPANY-CD-A5        PIC X.                       ELCRETR
  1842         16  RL-CCN-A5.                                           ELCRETR
  1843             20  RL-CCN-NO.                                       ELCRETR
  1844                 24  RL-CCN-PREFIX-A5 PIC X(4).                   ELCRETR
  1845                 24  RL-CCN-PRIME-A5 PIC X(12).                   ELCRETR
  1846             20  RL-CCN-FILLER-A5    PIC X(4).                    ELCRETR
  1847                                                                  ELCRETR
  1848     12  RL-INSURED-PROFILE-DATA.                                 ELCRETR
  1849         16  RL-INSURED-BIRTH-DT     PIC XX.                      ELCRETR
  1850         16  RL-INSURED-SEX-CD       PIC X.                       ELCRETR
  1851             88  RL-INSURED-IS-MALE     VALUE 'M'.                ELCRETR
  1852             88  RL-INSURED-IS-FEMALE   VALUE 'F'.                ELCRETR
  1853             88  RL-INSURED-SEX-UNKNOWN VALUE ' '.                ELCRETR
  1854         16  RL-INSURED-OCC-CD       PIC X(6).                    ELCRETR
  1855         16  FILLER                  PIC X(5).                    ELCRETR
  1856                                                                  ELCRETR
  1857     12  RL-PROCESSING-INFO.                                      ELCRETR
  1858         16  RL-PROCESSOR-ID         PIC X(4).                    ELCRETR
  1859         16  RL-CLAIM-STATUS         PIC X.                       ELCRETR
  1860             88  RL-CLAIM-IS-OPEN       VALUE 'O'.                ELCRETR
  1861             88  RL-CLAIM-IS-CLOSED     VALUE 'C'.                ELCRETR
  1862         16  RL-CLAIM-TYPE           PIC X.                       ELCRETR
  1863*            88  RL-AH-CLAIM            VALUE 'A'.                ELCRETR
  1864*            88  RL-LIFE-CLAIM          VALUE 'L'.                ELCRETR
  1865*            88  RL-PROPERTY-CLAIM      VALUE 'P'.                ELCRETR
  1866*            88  RL-UNEMPLOYMENT-CLAIM  VALUE 'U'.                ELCRETR
  1867         16  RL-CLAIM-PREM-TYPE      PIC X.                       ELCRETR
  1868             88  RL-SINGLE-PREMIUM         VALUE '1'.             ELCRETR
  1869             88  RL-O-B-COVERAGE           VALUE '2'.             ELCRETR
  1870             88  RL-OPEN-END-COVERAGE      VALUE '3'.             ELCRETR
  1871         16  RL-INCURRED-DT          PIC XX.                      ELCRETR
  1872         16  RL-REPORTED-DT          PIC XX.                      ELCRETR
  1873         16  RL-FILE-ESTABLISH-DT    PIC XX.                      ELCRETR
  1874         16  RL-EST-END-OF-DISAB-DT  PIC XX.                      ELCRETR
  1875         16  RL-LAST-PMT-DT          PIC XX.                      ELCRETR
  1876         16  RL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCRETR
  1877         16  RL-PAID-THRU-DT         PIC XX.                      ELCRETR
  1878         16  RL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCRETR
  1879         16  RL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCRETR
  1880         16  RL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCRETR
  1881         16  RL-PMT-CALC-METHOD      PIC X.                       ELCRETR
  1882             88  RL-360-DAY-YR          VALUE '1'.                ELCRETR
  1883             88  RL-365-DAY-YR          VALUE '2'.                ELCRETR
  1884             88  RL-FULL-MONTHS         VALUE '3'.                ELCRETR
  1885         16  RL-CAUSE-CD             PIC X(6).                    ELCRETR
  1886                                                                  ELCRETR
  1887         16  RL-PRIME-CERT-NO.                                    ELCRETR
  1888             20  RL-PRIME-CERT-PRIME PIC X(10).                   ELCRETR
  1889             20  RL-PRIME-CERT-SFX   PIC X.                       ELCRETR
  1890                                                                  ELCRETR
  1891         16  RL-SYSTEM-IDENTIFIER    PIC XX.                      ELCRETR
  1892             88  RL-CREDIT-CLAIM        VALUE 'CR'.               ELCRETR
  1893             88  RL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCRETR
  1894                                                                  ELCRETR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1895         16  RL-MICROFILM-NO         PIC X(10).                   ELCRETR
  1896         16  RL-PROG-FORM-TYPE       PIC X.                       ELCRETR
  1897         16  RL-LAST-ADD-ON-DT       PIC XX.                      ELCRETR
  1898                                                                  ELCRETR
  1899         16  RL-LAST-REOPEN-DT       PIC XX.                      ELCRETR
  1900         16  RL-LAST-CLOSE-DT        PIC XX.                      ELCRETR
  1901         16  RL-LAST-CLOSE-REASON    PIC X.                       ELCRETR
  1902             88  RL-FINAL-PAID          VALUE '1'.                ELCRETR
  1903             88  RL-CLAIM-DENIED        VALUE '2'.                ELCRETR
  1904             88  RL-AUTO-CLOSE          VALUE '3'.                ELCRETR
  1905             88  RL-MANUAL-CLOSE        VALUE '4'.                ELCRETR
  1906         16  RL-ASSOC-CERT-SEQU      PIC S99.                     ELCRETR
  1907         16  RL-ASSOC-CERT-TOTAL     PIC S99.                     ELCRETR
  1908         16  RL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCRETR
  1909             88  RL-PAYMENT-IN-PREP     VALUE 1 THRU 9.           ELCRETR
  1910         16  FILLER                  PIC X(5).                    ELCRETR
  1911                                                                  ELCRETR
  1912     12  RL-CERTIFICATE-DATA.                                     ELCRETR
  1913         16  RL-CERT-ORIGIN          PIC X.                       ELCRETR
  1914             88  RL-CERT-WAS-ONLINE     VALUE '1'.                ELCRETR
  1915             88  RL-CERT-WAS-CREATED    VALUE '2'.                ELCRETR
  1916             88  RL-COVERAGE-WAS-ADDED  VALUE '3'.                ELCRETR
  1917         16  RL-CERT-KEY-DATA.                                    ELCRETR
  1918             20  RL-CERT-CARRIER     PIC X.                       ELCRETR
  1919             20  RL-CERT-GROUPING    PIC X(6).                    ELCRETR
  1920             20  RL-CERT-STATE       PIC XX.                      ELCRETR
  1921             20  RL-CERT-ACCOUNT.                                 ELCRETR
  1922                 24  RL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCRETR
  1923                 24  RL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCRETR
  1924             20  RL-CERT-EFF-DT      PIC XX.                      ELCRETR
  1925                                                                  ELCRETR
  1926     12  RL-STATUS-CONTROLS.                                      ELCRETR
  1927         16  RL-PRIORITY-CD          PIC X.                       ELCRETR
  1928             88  RL-HIGHEST-PRIORITY    VALUE '9'.                ELCRETR
  1929         16  RL-SUPV-ATTN-CD         PIC X.                       ELCRETR
  1930             88  RL-SUPV-NOT-REQUIRED   VALUE ' ' 'N'.            ELCRETR
  1931             88  RL-SUPV-IS-REQUIRED    VALUE 'Y'.                ELCRETR
  1932         16  RL-PURGED-DT            PIC XX.                      ELCRETR
  1933         16  RL-RESTORED-DT          PIC XX.                      ELCRETR
  1934         16  RL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCRETR
  1935         16  RL-NEXT-RESEND-DT       PIC XX.                      ELCRETR
  1936         16  RL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCRETR
  1937         16  FILLER                  PIC XX.                      ELCRETR
  1938         16  RL-LAST-MAINT-DT        PIC XX.                      ELCRETR
  1939         16  RL-LAST-MAINT-USER      PIC X(4).                    ELCRETR
  1940         16  RL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCRETR
  1941         16  RL-LAST-MAINT-TYPE      PIC X.                       ELCRETR
  1942             88  RL-CLAIM-SET-UP           VALUE ' '.             ELCRETR
  1943             88  RL-PAYMENT-MADE           VALUE '1'.             ELCRETR
  1944             88  RL-LETTER-SENT            VALUE '2'.             ELCRETR
  1945             88  RL-MASTER-WAS-ALTERED     VALUE '3'.             ELCRETR
  1946             88  RL-MASTER-WAS-RESTORED    VALUE '4'.             ELCRETR
  1947             88  RL-INCURRED-DATE-CHANGED  VALUE '5'.             ELCRETR
  1948             88  RL-FILE-CONVERTED         VALUE '6'.             ELCRETR
  1949         16  RL-RELATED-CLAIM-NO     PIC X(7).                    ELCRETR
  1950         16  RL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCRETR
  1951         16  RL-BENEFICIARY          PIC X(10).                   ELCRETR
  1952         16  RL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCRETR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1953         16  FILLER                  PIC X(6).                    ELCRETR
  1954                                                                  ELCRETR
  1955     12  RL-TRAILER-CONTROLS.                                     ELCRETR
  1956         16  RL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCRETR
  1957             88  RL-1ST-TRL-AVAIL       VALUE +4095.              ELCRETR
  1958             88  RL-LAST-TRL-AVAIL      VALUE +100.               ELCRETR
  1959             88  RL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCRETR
  1960         16  RL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCRETR
  1961         16  FILLER                  PIC XX.                      ELCRETR
  1962         16  RL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCRETR
  1963         16  RL-ADDRESS-TRAILER-CNT.                              ELCRETR
  1964             20  RL-INSURED-ADDR-CNT  PIC S9.                     ELCRETR
  1965                 88  RL-NO-INSURED-AVAILABLE VALUE ZERO.          ELCRETR
  1966             20  RL-ACCOUNT-ADDR-CNT  PIC S9.                     ELCRETR
  1967                 88  RL-ACCOUNT-IS-ONLINE    VALUE ZERO.          ELCRETR
  1968             20  RL-BENIF-ADDR-CNT    PIC S9.                     ELCRETR
  1969                 88  RL-BENEFICIARY-IS-ONLINE VALUE ZERO.         ELCRETR
  1970             20  RL-EMPLOYER-ADDR-CNT PIC S9.                     ELCRETR
  1971                 88  RL-NO-EMPLOY-AVAILABLE   VALUE ZERO.         ELCRETR
  1972             20  RL-DOCTOR-ADDR-CNT   PIC S9.                     ELCRETR
  1973                 88  RL-NO-DOCTOR-AVAILABLE   VALUE ZERO.         ELCRETR
  1974             20  RL-OTHER-1-ADDR-CNT  PIC S9.                     ELCRETR
  1975                 88  RL-NO-OTHER-1-ADDRESSES  VALUE ZERO.         ELCRETR
  1976             20  RL-OTHER-2-ADDR-CNT  PIC S9.                     ELCRETR
  1977                 88  RL-NO-OTHER-2-ADDRESSES  VALUE ZERO.         ELCRETR
  1978                                                                  ELCRETR
  1979     12  RL-CV-REFERENCE-NO.                                      ELCRETR
  1980         16  RL-CV-REFNO-PRIME       PIC X(18).                   ELCRETR
  1981         16  RL-CV-REFNO-SFX         PIC XX.                      ELCRETR
  1982                                                                  ELCRETR
  1983     12  RL-FILE-LOCATION            PIC X(4).                    ELCRETR
  1984                                                                  ELCRETR
  1985     12  RL-PROCESS-ERRORS.                                       ELCRETR
  1986         16  RL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCRETR
  1987             88  RL-NO-FATAL-ERRORS     VALUE ZERO.               ELCRETR
  1988         16  RL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCRETR
  1989             88  RL-NO-FORCABLE-ERRORS  VALUE ZERO.               ELCRETR
  1990                                                                  ELCRETR
  1991     12  RL-PRODUCT-CD               PIC X.                       ELCRETR
  1992                                                                  ELCRETR
  1993     12  RL-CURRENT-KEY-DATA.                                     ELCRETR
  1994         16  RL-CURRENT-CARRIER      PIC X.                       ELCRETR
  1995         16  RL-CURRENT-GROUPING     PIC X(6).                    ELCRETR
  1996         16  RL-CURRENT-STATE        PIC XX.                      ELCRETR
  1997         16  RL-CURRENT-ACCOUNT      PIC X(10).                   ELCRETR
  1998                                                                  ELCRETR
  1999     12  RL-ASSOCIATES               PIC X.                       ELCRETR
  2000         88  RL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCRETR
  2001         88  RL-ASSOC-INTERFACE         VALUE 'I'.                ELCRETR
  2002         88  RL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCRETR
  2003         88  RL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCRETR
  2004                                                                  ELCRETR
  2005     12  RL-ACTIVITY-CODE            PIC 99.                      ELCRETR
  2006     12  RL-ACTIVITY-MAINT-DT        PIC XX.                      ELCRETR
  2007     12  RL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCRETR
  2008                                                                  ELCRETR
  2009     12  RL-LAPSE-REPORT-CODE        PIC 9.                       ELCRETR
  2010     12  RL-LAG-REPORT-CODE          PIC 9.                       ELCRETR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  2011     12  RL-LOAN-TYPE                PIC XX.                      ELCRETR
  2012     12  RL-LEGAL-STATE              PIC XX.                      ELCRETR
  2013                                                                  ELCRETR
  2014     12  FILLER                      PIC X(5).                    ELCRETR
  2015
  2017 FD  DISK-DATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* EL331.cbl
*                                      COPY ELCDTEFD.
  2018******************************************************************04/15/98
  2019*                                                                *ELCDTEFD
  2020*                                                                *ELCDTEFD
  2021*                            ELCDTEFD.                           *   LV002
  2022*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2023*                            VMOD=2.007                          *   CL**2
  2024*                                                                *ELCDTEFD
  2025******************************************************************ELCDTEFD
  2026     BLOCK CONTAINS 0 RECORDS
  2027     RECORDING MODE F.                                            ELCDTEFD
  2028                                                                  ELCDTEFD
  2029 01  DATE-DISK.                                                   ELCDTEFD
  2030     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2031     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2032     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2033     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2034     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2035     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2036     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2037                                                                  ELCDTEFD
  2038 01  DATE-DISK-R.                                                 ELCDTEFD
  2039     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2040     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2041                                     PIC  X(32).                  ELCDTEFD
  2042                                                                  ELCDTEFD
  2043 01  DATE-DISK-T.                                                 ELCDTEFD
  2044     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2045     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2046                                     PIC  X(48).                  ELCDTEFD
  2047                                                                  ELCDTEFD
  2048 01  DATE-DISK-M.                                                 ELCDTEFD
  2049     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2050     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2051                                     PIC  X(48).                  ELCDTEFD
  2052                                                                  ELCDTEFD
  2053 01  DATE-DISK-P.                                                 ELCDTEFD
  2054     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2055     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2056     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2057     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2058         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2059                                     PIC  X.                      ELCDTEFD
  2060         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2061     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2062         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2063             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2064             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2065             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2066             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2067         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2068                                                                  ELCDTEFD
  2069 01  DATE-DISK-E.                                                 ELCDTEFD
  2070     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2071     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2072                                     PIC  X(4).                   ELCDTEFD
  2073                                                                  ELCDTEFD
  2074 01  DATE-DISK-C.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2075     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2076     12  DD-CARR1-SECPAY-SW          PIC  X.
  2077     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2078     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2079     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2080     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2081     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2082     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2083     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2084     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2085     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2086     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2087     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2088     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2089     12  DD-CARR2-SECPAY-SW          PIC  X.
  2090     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2091                                                                  ELCDTEFD
  2092 01  DATE-DISK-OPT.                                               ELCDTEFD
  2093     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2094     12  DD-TLR-DATA.                                             ELCDTEFD
  2095         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2096                                     PIC  X(03).                  ELCDTEFD
  2097     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2098         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2099                                     PIC  X(06).                  ELCDTEFD
  2100     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2101         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2102                                     PIC  X(07).                  ELCDTEFD
  2103         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2104     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2105                                     PIC  X(96).                  ELCDTEFD
  2106******************************************************************ELCDTEFD
  2107
  2109 FD  FICH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* EL331.cbl
*                                      COPY ELCFCHFD.
  2110******************************************************************04/15/98
  2111*                                                                *ELCFCHFD
  2112*                            ELCFCHFD.                           *   LV003
  2113*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2114*                            VMOD=2.004                          *   CL**3
  2115*                                                                *ELCFCHFD
  2116******************************************************************ELCFCHFD
  2117     BLOCK CONTAINS 0 RECORDS
  2118     RECORDING MODE F.                                            ELCFCHFD
  2119                                                                  ELCFCHFD
  2120 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2121******************************************************************ELCFCHFD
  2122
  2124 FD  ELREPT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* EL331.cbl
*                                      COPY ELCRPTFD.
  2125******************************************************************04/16/98
  2126*                                                                *ELCRPTFD
  2127*                            ELCRPTFD.                           *   LV002
  2128*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2129*                            VMOD=2.001                          *ELCRPTFD
  2130*                                                                *ELCRPTFD
  2131* NOTE- USE ELCREPT AS COPY FOR 01 LEVEL                         *ELCRPTFD
  2132*                                                                *ELCRPTFD
  2133******************************************************************ELCRPTFD
  2134      LABEL RECORDS ARE STANDARD.                                 ELCRPTFD
  2135******************************************************************ELCRPTFD
* 2136                                 COPY ELCREPT.
  2137******************************************************************04/15/98
  2138*                                                                *ELCREPT
  2139*                                                                *ELCREPT
  2140*                            ELCREPT.                            *   LV002
  2141*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2142*                            VMOD=2.002                          *   CL**2
  2143*                                                                *ELCREPT
  2144*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
  2145*                                                                *ELCREPT
  2146*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
  2147*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
  2148*                                                                *ELCREPT
  2149*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
  2150*       ALTERNATE PATH  = NOT USED                               *ELCREPT
  2151*                                                                *ELCREPT
  2152*   LOG = NO                                                     *ELCREPT
  2153*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
  2154******************************************************************ELCREPT
  2155 01  REPORT-SAVE-FILE.                                            ELCREPT
  2156     12  RF-RECORD-ID                PIC XX.                      ELCREPT
  2157         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
  2158                                                                  ELCREPT
  2159     12  RF-CONTROL-PRIMARY.                                      ELCREPT
  2160         16  RF-COMPANY-CD           PIC X.                       ELCREPT
  2161         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
  2162             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
  2163             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
  2164         16  RF-REPORT-ID.                                        ELCREPT
  2165             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
  2166                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
  2167                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
  2168             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
  2169         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
  2170     12  RF-REPORT-LINE-133.                                      ELCREPT
  2171         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
  2172         16  RF-DATA-133             PIC X(132).                  ELCREPT
  2173         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
  2174             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
  2175             20  FILLER              PIC X(52).                   ELCREPT
  2176         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
  2177             20  FILLER              PIC X(53).                   ELCREPT
  2178             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
  2179     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
  2180         16  FILLER                  PIC X.                       ELCREPT
  2181         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* EL331.cbl (/apps/prod/cid1p/copy/ELCREPT)
  2182         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
  2183         16  FILLER                  PIC X(115).                  ELCREPT
  2184         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
  2185******************************************************************ELCREPT
  2186
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* EL331.cbl
  2188 FD  ERMEBL.
  2189
* 2190                                 COPY ERCMEBL.
  2191******************************************************************
  2192*
  2193*
  2194*                            ERCMEBL                             *
  2195*                                                                *
  2196*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *
  2197*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *
  2198*                       4-6 OF THE FIELD NAMES) AND BY EL541     *
  2199*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*
  2200*                                                                *
  2201*    FILE TYPE = VSAM, KSDS                                      *
  2202*    RECORD SIZE = 765       RECFORM = FIXED                     *
  2203*                                                                *
  2204*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *
  2205*    ALTERNATE PATHS = NONE        STARTING IN  3                *
  2206*                                                                *
  2207******************************************************************
  2208
  2209******************************************************************
  2210*                   C H A N G E   L O G
  2211*
  2212* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2213*-----------------------------------------------------------------
  2214*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2215* EFFECTIVE    NUMBER
  2216*-----------------------------------------------------------------
  2217* 070714  CR2013060600001  PEMA  AUTOMATE EOM BALANCING
  2218******************************************************************
  2219 01  MONTH-END-BALANCES.
  2220     12  ME-RECORD-ID            PIC  XX.
  2221     12  ME-CONTROL-PRIMARY.
  2222         16  ME-COMPANY          PIC  XXX.
  2223         16  ME-MOYR             PIC  9999       COMP.
  2224     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.
  2225     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.
  2226     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.
  2227     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.
  2228     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.
  2229     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.
  2230     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.
  2231     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.
  2232     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.
  2233     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.
  2234     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.
  2235     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.
  2236     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.
  2237     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.
  2238*    12  ME-010-START            PIC  9(6)       COMP-3.
  2239*    12  ME-010-END              PIC  9(6)       COMP-3.
  2240     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.
  2241     12  ME-018-COMM-Y           PIC S9(9)V99    COMP-3.
  2242     12  ME-018-COMM-1           PIC S9(9)V99    COMP-3.
  2243     12  ME-018-OW-Y             PIC S9(9)V99    COMP-3.
  2244     12  ME-018-OW-1             PIC S9(9)V99    COMP-3.
  2245     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* EL331.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  2246*    12  ME-018-START            PIC  9(6)       COMP-3.
  2247*    12  ME-018-END              PIC  9(6)       COMP-3.
  2248     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.
  2249     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.
  2250     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.
  2251     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.
  2252     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.
  2253     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.
  2254     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.
  2255     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.
  2256     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.
  2257     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.
  2258*    12  ME-019-START            PIC  9(6)       COMP-3.
  2259*    12  ME-019-END              PIC  9(6)       COMP-3.
  2260     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.
  2261     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.
  2262     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.
  2263     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.
  2264*    12  ME-030-START            PIC  9(6)       COMP-3.
  2265*    12  ME-030-END              PIC  9(6)       COMP-3.
  2266     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.
  2267     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.
  2268     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.
  2269     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.
  2270*    12  ME-032-START            PIC  9(6)       COMP-3.
  2271*    12  ME-032-END              PIC  9(6)       COMP-3.
  2272     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.
  2273     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.
  2274     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.
  2275     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.
  2276*    12  ME-035-START            PIC S9(6)       COMP-3.
  2277*    12  ME-035-END              PIC S9(6)       COMP-3.
  2278     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.
  2279     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.
  2280     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.
  2281     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.
  2282*    12  ME-038-START            PIC  9(6)       COMP-3.
  2283*    12  ME-038-END              PIC  9(6)       COMP-3.
  2284     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.
  2285     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.
  2286     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.
  2287*    12  ME-041-START            PIC  9(6)       COMP-3.
  2288*    12  ME-041-END              PIC  9(6)       COMP-3.
  2289     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.
  2290     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.
  2291     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.
  2292*    12  ME-050-START            PIC  9(6)       COMP-3.
  2293     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.
  2294*    12  ME-050-END              PIC  9(6)       COMP-3.
  2295     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.
  2296     12  ME-061-PREM             PIC S9(9)V99    COMP-3.
  2297     12  ME-061-COMM             PIC S9(9)V99    COMP-3.
  2298     12  ME-061-OR               PIC S9(9)V99    COMP-3.
  2299     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.
  2300     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.
  2301     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.
  2302     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.
  2303     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* EL331.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  2304*    12  ME-061-START            PIC  9(6)       COMP-3.
  2305*    12  ME-061-END              PIC  9(6)       COMP-3.
  2306     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.
  2307     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.
  2308     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.
  2309*    12  ME-080-START            PIC  9(6)       COMP-3.
  2310*    12  ME-080-END              PIC  9(6)       COMP-3.
  2311     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.
  2312     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.
  2313     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.
  2314     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.
  2315*    12  ME-315-START            PIC  9(6)       COMP-3.
  2316*    12  ME-315-END              PIC  9(6)       COMP-3.
  2317     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.
  2318     12  ME-331-FLAG             PIC  9.
  2319     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.
  2320*    12  ME-331-START            PIC  9(6)       COMP-3.
  2321*    12  ME-331-END              PIC  9(6)       COMP-3.
  2322     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.
  2323     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.
  2324     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.
  2325*    12  ME-341-START            PIC  9(6)       COMP-3.
  2326*    12  ME-341-END              PIC  9(6)       COMP-3.
  2327     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.
  2328     12  ME-501-FLAG             PIC  9.
  2329     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.
  2330     12  ME-501-START            PIC  9(6)       COMP-3.
  2331     12  ME-501-END              PIC  9(6)       COMP-3.
  2332     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.
  2333     12  ME-509-FLAG             PIC  9.
  2334     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.
  2335     12  ME-509-START            PIC  9(6)       COMP-3.
  2336     12  ME-509-END              PIC  9(6)       COMP-3.
  2337     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.
  2338     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.
  2339     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.
  2340     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.
  2341     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.
  2342     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.
  2343     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.
  2344     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.
  2345     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.
  2346     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.
  2347     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.
  2348     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.
  2349     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.
  2350     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.
  2351     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.
  2352     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.
  2353     12  ME-522-START            PIC  9(6)       COMP-3.
  2354     12  ME-522-END              PIC  9(6)       COMP-3.
  2355     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.
  2356     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.
  2357     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.
  2358     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.
  2359     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.
  2360     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.
  2361     12  ME-524-START            PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* EL331.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  2362     12  ME-524-END              PIC  9(6)       COMP-3.
  2363     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.
  2364     12  ME-525-FLAG             PIC  9.
  2365     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.
  2366     12  ME-525-START            PIC  9(6)       COMP-3.
  2367     12  ME-525-END              PIC  9(6)       COMP-3.
  2368     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.
  2369     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.
  2370     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.
  2371     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.
  2372     12  ME-048-START            PIC  9(6)       COMP-3.
  2373     12  ME-048-END              PIC  9(6)       COMP-3.
  2374     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.
  2375     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.
  2376
  2377     12  ME-019-CLMS-L           PIC S9(9)V99    COMP-3.
  2378     12  ME-019-CLMS-AH          PIC S9(9)V99    COMP-3.
  2379     12  ME-035-COMM-TOT         PIC S9(9)V99    COMP-3.
  2380     12  ME-035-CLMS-L           PIC S9(9)V99    COMP-3.
  2381     12  ME-035-CLMS-AH          PIC S9(9)V99    COMP-3.
  2382     12  ME-041-RECS-IN          PIC S9(9)       COMP-3.
  2383     12  ME-041-RECS-OUT         PIC S9(9)       COMP-3.
  2384     12  ME-050-ACT-L            PIC S9(7)       COMP-3.
  2385     12  ME-050-ACT-AH           PIC S9(7)       COMP-3.
  2386     12  ME-061-CLMS             PIC S9(9)V99    COMP-3.
  2387     12  ME-341-CLMS-L           PIC S9(9)V99    COMP-3.
  2388     12  ME-341-CLMS-AH          PIC S9(9)V99    COMP-3.
  2389     12  ME-515-CLMS-WRAP        PIC S9(7)V99    COMP-3.
  2390     12  ME-515-RESV-WRAP        PIC S9(7)V99    COMP-3.
  2391     12  ME-317-CLMS-TOT         PIC S9(9)V99    comp-3.
  2392     12  ME-325-CLMS-TOT         PIC S9(9)V99    comp-3.
  2393     12  ME-020-PREM-TOT         PIC S9(11)V99   COMP-3.
  2394     12  ME-020-CLMS-TOT         PIC S9(9)V99    COMP-3.
  2395     12  ME-020-RESV-TOT         PIC S9(9)V99    COMP-3.
  2396     12  ME-063-OW               PIC S9(9)V99    COMP-3.
  2397     12  ME-082-ACT-L            PIC S9(7)       COMP-3.
  2398     12  ME-082-ACT-AH           PIC S9(7)       COMP-3.
  2399     12  ME-016-RECS-IN          PIC S9(9)       COMP-3.
  2400     12  ME-016-RECS-OUT         PIC S9(9)       COMP-3.
  2401     12  ME-562-PREM-TOT         PIC S9(9)V99    COMP-3.
  2402     12  ME-562-COMM-TOT         PIC S9(9)V99    COMP-3.
  2403     12  ME-524-CLMS-TOT-CM      PIC S9(9)V99    comp-3.
  2404     12  ME-523-PREM-TOT         PIC S9(9)V99    COMP-3.
  2405     12  ME-064-BEG-BAL          PIC S9(9)V99    COMP-3.
  2406     12  ME-064-END-BAL          PIC S9(9)V99    COMP-3.
  2407     12  ME-010-MM-PREM-TOT      PIC S9(9)V99    COMP-3.
  2408     12  ME-010-MM-TOT-CLMS      PIC S9(9)V99    COMP-3.
  2409     12  ME-010-MM-TOT-RESV      PIC S9(9)V99    COMP-3.
  2410     12  ME-080-MORT-RESV        PIC S9(9)V99    COMP-3.
  2411
  2412     12  FILLER                  PIC  X(09).
  2413*    12  FILLER                  PIC  X(88).
  2414******************************************************************
  2415
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* EL331.cbl
  2417 FD  ERMAIL.
  2418
* 2419                                 COPY ERCMAIL.
  2420******************************************************************
  2421*                                                                *
  2422*                                                                *
  2423*                            ERCMAIL                             *
  2424*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2425*                            VMOD=2.003                          *
  2426*                                                                *
  2427*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2428*                                                                *
  2429*   FILE TYPE = VSAM,KSDS                                        *
  2430*   RECORD SIZE = 374   RECFORM = FIX                            *
  2431*                                                                *
  2432*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2433*   ALTERNATE PATH    = NOT USED                                 *
  2434*                                                                *
  2435*   LOG = YES                                                    *
  2436*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2437******************************************************************
  2438*                   C H A N G E   L O G
  2439*
  2440* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2441*-----------------------------------------------------------------
  2442*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2443* EFFECTIVE    NUMBER
  2444*-----------------------------------------------------------------
  2445* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2446* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2447* 111108                   PEMA  ADD CRED BENE ADDR2
  2448******************************************************************
  2449
  2450 01  MAILING-DATA.
  2451     12  MA-RECORD-ID                      PIC XX.
  2452         88  VALID-MA-ID                       VALUE 'MA'.
  2453
  2454     12  MA-CONTROL-PRIMARY.
  2455         16  MA-COMPANY-CD                 PIC X.
  2456         16  MA-CARRIER                    PIC X.
  2457         16  MA-GROUPING.
  2458             20  MA-GROUPING-PREFIX        PIC XXX.
  2459             20  MA-GROUPING-PRIME         PIC XXX.
  2460         16  MA-STATE                      PIC XX.
  2461         16  MA-ACCOUNT.
  2462             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2463             20  MA-ACCOUNT-PRIME          PIC X(6).
  2464         16  MA-CERT-EFF-DT                PIC XX.
  2465         16  MA-CERT-NO.
  2466             20  MA-CERT-PRIME             PIC X(10).
  2467             20  MA-CERT-SFX               PIC X.
  2468
  2469     12  FILLER                            PIC XX.
  2470
  2471     12  MA-ACCESS-CONTROL.
  2472         16  MA-SOURCE-SYSTEM              PIC XX.
  2473             88  MA-FROM-CREDIT                VALUE 'CR'.
  2474             88  MA-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* EL331.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  2475             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2476             88  MA-FROM-OTHER                 VALUE 'OT'.
  2477         16  MA-RECORD-ADD-DT              PIC XX.
  2478         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2479         16  MA-LAST-MAINT-DT              PIC XX.
  2480         16  MA-LAST-MAINT-BY              PIC XXXX.
  2481         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2482
  2483     12  MA-PROFILE-INFO.
  2484         16  MA-QUALIFY-CODE-1             PIC XX.
  2485         16  MA-QUALIFY-CODE-2             PIC XX.
  2486         16  MA-QUALIFY-CODE-3             PIC XX.
  2487         16  MA-QUALIFY-CODE-4             PIC XX.
  2488         16  MA-QUALIFY-CODE-5             PIC XX.
  2489
  2490         16  MA-INSURED-LAST-NAME          PIC X(15).
  2491         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2492         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2493         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2494         16  MA-INSURED-BIRTH-DT           PIC XX.
  2495         16  MA-INSURED-SEX                PIC X.
  2496             88  MA-SEX-MALE                   VALUE 'M'.
  2497             88  MA-SEX-FEMALE                 VALUE 'F'.
  2498         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2499
  2500         16  MA-ADDRESS-CORRECTED          PIC X.
  2501         16  MA-JOINT-BIRTH-DT             PIC XX.
  2502*        16  FILLER                        PIC X(12).
  2503
  2504         16  MA-ADDRESS-LINE-1             PIC X(30).
  2505         16  MA-ADDRESS-LINE-2             PIC X(30).
  2506         16  MA-CITY-STATE.
  2507             20  MA-CITY                   PIC X(28).
  2508             20  MA-ADDR-STATE             PIC XX.
  2509         16  MA-ZIP.
  2510             20  MA-ZIP-CODE.
  2511                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2512                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2513                 24  FILLER                PIC X(4).
  2514             20  MA-ZIP-PLUS4              PIC X(4).
  2515         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2516             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2517             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2518             20  FILLER                    PIC X(3).
  2519
  2520         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2521
  2522         16  FILLER                        PIC XXX.
  2523*        16  FILLER                        PIC X(10).
  2524
  2525
  2526     12  MA-CRED-BENE-INFO.
  2527         16  MA-CRED-BENE-NAME                 PIC X(25).
  2528         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2529         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2530         16  MA-CRED-BENE-CTYST.
  2531             20  MA-CRED-BENE-CITY             PIC X(28).
  2532             20  MA-CRED-BENE-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* EL331.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  2533         16  MA-CRED-BENE-ZIP.
  2534             20  MA-CB-ZIP-CODE.
  2535                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  2536                     88  MA-CB-CANADIAN-POST-CODE
  2537                                           VALUE 'A' THRU 'Z'.
  2538                 24  FILLER                    PIC X(4).
  2539             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2540         16  MA-CB-CANADIAN-POSTAL-CODE
  2541                            REDEFINES MA-CRED-BENE-ZIP.
  2542             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2543             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2544             20  FILLER                        PIC X(3).
  2545     12  MA-POST-CARD-MAIL-DATA.
  2546         16  MA-MAIL-DATA OCCURS 7.
  2547             20  MA-MAIL-TYPE              PIC X.
  2548                 88  MA-12MO-MAILING           VALUE '1'.
  2549                 88  MA-EXP-MAILING            VALUE '2'.
  2550             20  MA-MAIL-STATUS            PIC X.
  2551                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2552                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2553                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2554             20  MA-MAIL-DATE              PIC XX.
  2555     12  FILLER                            PIC XX.
  2556     12  FILLER                            PIC XX.
  2557*    12  FILLER                            PIC X(30).
  2558******************************************************************
  2559
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* EL331.cbl
  2561 FD  ERCTBL.
  2562
* 2563                                 COPY ERCCTBL.
  2564******************************************************************04/29/98
  2565*                                                                *ERCCTBL
  2566*                                                                *ERCCTBL
  2567*                            ERCCTBL                             *   LV002
  2568*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2569*                            VMOD=2.003                              CL**2
  2570*                                                                *ERCCTBL
  2571*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  2572*                                                                *ERCCTBL
  2573*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  2574*                                                                *ERCCTBL
  2575*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  2576*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  2577*                                                                *ERCCTBL
  2578*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  2579*       ALTERNATE PATH = NONE                                    *ERCCTBL
  2580*                                                                *ERCCTBL
  2581*   LOG = NO                                                     *ERCCTBL
  2582*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  2583*                                                                *ERCCTBL
  2584*                                                                *ERCCTBL
  2585******************************************************************ERCCTBL
  2586                                                                  ERCCTBL
  2587 01  COMM-TABLE-RECORD.                                           ERCCTBL
  2588     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  2589         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  2590                                                                  ERCCTBL
  2591     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  2592         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  2593         16  CT-TABLE                      PIC XXX.               ERCCTBL
  2594         16  CT-CNTRL-2.                                          ERCCTBL
  2595             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  2596             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  2597                                                                  ERCCTBL
  2598     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  2599         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  2600         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  2601         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  2602         16  FILLER                        PIC X(31).             ERCCTBL
  2603                                                                  ERCCTBL
  2604     12  CT-LIMITS.                                               ERCCTBL
  2605         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  2606                                                                  ERCCTBL
  2607         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  2608                                                                  ERCCTBL
  2609         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  2610                                                                  ERCCTBL
  2611     12  CT-RATES.                                                ERCCTBL
  2612         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  2613             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  2614             20  CT-RT-R   REDEFINES                              ERCCTBL
  2615                 CT-RT                     PIC XXX.               ERCCTBL
  2616                                                                  ERCCTBL
  2617     12  FILLER                            PIC  X(42).            ERCCTBL
  2618                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* EL331.cbl
  2619******************************************************************ERCCTBL
  2620
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* EL331.cbl
  2622 FD  DISPLAY-PRT
  2623     RECORDING MODE F
  2624     LABEL RECORDS ARE STANDARD
  2625     RECORD CONTAINS 133 CHARACTERS
  2626     BLOCK CONTAINS 0 RECORDS
  2627     DATA RECORD IS DISPLAY-REC.
  2628
  2629 01  DISPLAY-REC.
  2630     12  DISPLAY-CC              PIC X.
  2631     12  DISPLAY-INFO            PIC X(132).
  2632
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* EL331.cbl
  2634 WORKING-STORAGE SECTION.
  2635 77  FILLER  PIC X(32) VALUE '********************************'.
  2636 77  FILLER  PIC X(32) VALUE '*    EL331  WORKING-STORAGE    *'.
  2637 77  FILLER  PIC X(32) VALUE '********** VMOD=2.037 **********'.
  2638
  2639 77  DIS-HEAD-SW             PIC X       VALUE 'Y'.
  2640 77  ERROR-COUNT             PIC 9(7)    VALUE ZEROS.
  2641 77  DIS-LINE-CNT            PIC 99      VALUE ZEROS.
  2642
  2643 77  NDX                         PIC S9(4) COMP     VALUE ZERO.
  2644 77  CINDX                       PIC S9(4) COMP     VALUE ZERO.
  2645
  2646 77  WS-ACT-END-SW               PIC X              VALUE SPACE.
  2647     88  NO-MORE-ACT-RECORDS         VALUE 'X'.
  2648     88  MORE-ACT-RECORDS            VALUE ' '.
  2649
  2650 77  WS-FIRST-TIME-SW            PIC X              VALUE '1'.
  2651     88  FIRST-TIME                  VALUE '1'.
  2652
  2653 77  WS-PRT-FULL-LINE-SW         PIC X              VALUE SPACE.
  2654     88  LINE-FULL                   VALUE 'X'.
  2655
  2656 77  WS-ONL-GE-SW                PIC X              VALUE SPACE.
  2657     88  ONL-KEY-EQUAL-OR-GREATER    VALUE 'X'.
  2658
  2659 77  WS-B-END-SW                 PIC X              VALUE SPACE.
  2660     88  END-O-FILE                  VALUE 'E'.
  2661
  2662 77  WS-CLM-END-SW               PIC X              VALUE SPACE.
  2663     88  NO-MORE-CLAIM-MATCH         VALUE 'X'.
  2664
  2665 77  WS-ONL-END-SW               PIC X              VALUE SPACE.
  2666     88  NO-MORE-ONL-RECORDS         VALUE 'X'.
  2667     88  MORE-ONL-RECORDS            VALUE ' '.
  2668
  2669 77  WS-ALL-END-SW               PIC X              VALUE SPACE.
  2670     88  NO-MORE-RECORDS             VALUE 'X'.
  2671
  2672 77  WS-ECS-END-SW               PIC X              VALUE SPACE.
  2673     88  NO-MORE-ECS-RECORDS         VALUE 'X'.
  2674     88  MORE-ECS-RECORDS            VALUE ' '.
  2675
  2676 77  ERROR-SW                    PIC X              VALUE SPACE.
  2677     88  ERROR-OCCURRED              VALUE 'E'.
  2678     88  NO-ERRORS                   VALUE ' '.
  2679
  2680 77  WS-O-MATCH-SW               PIC X              VALUE 'M'.
  2681     88  MATCHED-REC                 VALUE 'M'.
  2682     88  NO-MATCH-FOUND              VALUE ' '.
  2683
  2684 77  WS-IO-ERROR-SW              PIC X              VALUE SPACE.
  2685     88  IO-ERROR                    VALUE 'E'.
  2686     88  IO-ERROR-OCCURRED           VALUE 'E'.
  2687
  2688 77  NO-PREM-CT                  PIC 9(07)          VALUE ZEROS.
  2689 77  NO-PLAN-CODE-CT             PIC 9(07)          VALUE ZEROS.
  2690 77  WS-LINE-CNT                 PIC S999  COMP-3   VALUE ZEROS.
  2691 77  WS-PAGE-CNT                 PIC S999  COMP-3   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* EL331.cbl
  2692 77  WS-MAX-LINES                PIC S999  COMP-3   VALUE +60.
  2693 77  X                           PIC X              VALUE SPACE.
  2694 77  WS-ZERO                     PIC S9    COMP-3   VALUE ZERO.
  2695 77  WS-RETURN-CODE              PIC S9(4) COMP     VALUE ZERO.
  2696 77  WS-LEVEL-INDEX              PIC S9(4) COMP     VALUE ZERO.
  2697
  2698 77  WS-ABEND-MESSAGE            PIC X(80)          VALUE SPACES.
  2699 77  WS-ABEND-FILE-STATUS        PIC XX             VALUE ZERO.
  2700
  2701 77  WS-CLAIM-SW                 PIC X              VALUE SPACE.
  2702     88  NO-ASSOCIATED-CLAIM         VALUE 'N'.
  2703     88  ASSOCIATED-CLAIM            VALUE 'A'.
  2704
  2705 77  WS-ERCOMM-SW                PIC X              VALUE SPACE.
  2706     88  ASSOCIATED-ERCOMM           VALUE '1'.
  2707 77  ws-cert-load-sw             pic x value spaces.
  2708     88  do-not-load                value 'Y'.
  2709
  2710 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2711     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2712
  2713 01  WS-ME50-BALANCE-REC.
  2714     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2715     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2716     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'EL331   '.
  2717     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2718     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2719     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2720     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2721     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2722     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2723
  2724 01  DISPLAY-HD-1.
  2725     12  FILLER      PIC X     VALUE SPACES.
  2726     12  FILLER      PIC X(51) VALUE SPACES.
  2727     12  FILLER      PIC X(23) VALUE 'PROCESSING ERROR REPORT'.
  2728     12  FILLER      PIC X(51) VALUE SPACES.
  2729     12  FILLER      PIC X(07) VALUE ' EL-331'.
  2730
  2731 01  DISPLAY-HD-2.
  2732     12  FILLER      PIC X     VALUE SPACES.
  2733     12  FILLER      PIC X     VALUE SPACES.
  2734     12  FILLER      PIC X(56) VALUE SPACES.
  2735     12  DIS-DATE    PIC X(8)  VALUE SPACES.
  2736     12  FILLER      PIC X(67) VALUE SPACES.
  2737
  2738 01  DISPLAY-LINE.
  2739     05  DISPLAY-LINE-05.
  2740        10  DIS-CC              PIC X.
  2741        10  DIS-LINE-REASON     PIC X(32).
  2742        10  DIS-LINE-REC        PIC X(100).
  2743
  2744     05  DISPLAY-LINE-ALT  REDEFINES  DISPLAY-LINE-05.
  2745        10  DIS-CC-ALT          PIC X.
  2746        10  DIS-FLD-1           PIC X(52).
  2747        10  DIS-FLD-2           PIC X(80).
  2748
  2749 01  WK-MEMB-ACCT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* EL331.cbl
  2750     12  WK-MEMB-ACCT-CHAR       PIC X   OCCURS 6.
  2751 01  WK-LAST-NAME.
  2752     12  WK-LAST-NAME-CHAR       PIC X   OCCURS 12.
  2753
  2754 01  ws-epiq-cert-added          pic 9(7) value zeros.
  2755 01  WORK-AREA.
  2756     12  LST-NM-SUB              PIC S9(4) COMP  VALUE +0.
  2757     12  ACCT-SUB                PIC S9(4) COMP  VALUE +0.
  2758     12  BIN-CR-DT               PIC XX    VALUE SPACES.
  2759     12  ERROR-FLAG              PIC X           VALUE ' '.
  2760        88 NO-ERRORS                    VALUE ' '.
  2761        88 NON-ALPHA                    VALUE 'A'.
  2762        88 BLANK-NAME                   VALUE 'B'.
  2763
  2764 01  MONTH-END-DATA.
  2765     12  ME-START-DATE.
  2766         16  ME-START-MO         PIC 99.
  2767         16  FILLER              PIC X.
  2768         16  ME-START-DA         PIC 99.
  2769         16  FILLER              PIC X.
  2770         16  ME-START-YR         PIC 99.
  2771     12  ME-CNDS-DATE            PIC 9(6).
  2772     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2773         16  ME-CNDS-MO          PIC 99.
  2774         16  ME-CNDS-DA          PIC 99.
  2775         16  ME-CNDS-YR          PIC 99.
  2776     12  ME-START-TIME           PIC 9(6).
  2777     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2778         88  ME-DO-UPDATE        VALUE 'Y'.
  2779         88  ME-NO-UPDATE        VALUE 'N'.
  2780     12  ERMEBL-FILE-STATUS      PIC XX.
  2781     12  ERCTBL-FILE-STATUS      PIC XX.
  2782     12  MONTH-END-MOYR          PIC S9(5)    COMP-3.
  2783
  2784 01  DTE-INTERFACE-AREAS.
  2785     12  PGM-SUB                 PIC S9(4)    COMP VALUE +331.
  2786     12  ABEND-CODE              PIC XXXX          VALUE SPACE.
  2787     12  ABEND-OPTION            PIC X.
  2788     12  OLC-REPORT-NAME         PIC X(5)          VALUE 'EL331'.
  2789
  2790 01  WS-SAVE-AREAS.
  2791     12  FILLER   PIC X(27)  VALUE '---------------------------'.
  2792     12  FILLER   PIC X(27)  VALUE '---- EL331 SAVED AREAS ----'.
  2793     12  FILLER   PIC X(27)  VALUE '---------------------------'.
  2794
  2795     12  WS-ECS-READ       COMP-3     PIC S9(9)   VALUE ZEROS.
  2796     12  WS-ACT-READ       COMP-3     PIC S9(9)   VALUE ZEROS.
  2797     12  WS-ACCT-READS     COMP-3     PIC S9(9)   VALUE ZEROS.
  2798     12  WS-ACCT-MATCH     COMP-3     PIC S9(9)   VALUE ZEROS.
  2799     12  WS-EXCP-ADD       COMP-3     PIC S9(9)   VALUE ZEROS.
  2800     12  WS-EXCP-TBL       COMP-3     PIC S9(9)   VALUE ZEROS.
  2801     12  WS-EXCP-DEL       COMP-3     PIC S9(9)   VALUE ZEROS.
  2802     12  WS-MAIL-DEL       COMP-3     PIC S9(9)   VALUE ZEROS.
  2803     12  WS-MATCHED-ONL    COMP-3     PIC S9(9)   VALUE ZEROS.
  2804     12  WS-ONL-READ       COMP-3     PIC S9(9)   VALUE ZEROS.
  2805     12  WS-LOADED-ECS     COMP-3     PIC S9(9)   VALUE ZEROS.
  2806     12  WS-ONL-DELETED    COMP-3     PIC S9(9)   VALUE ZEROS.
  2807     12  WS-ONL-EXIST      COMP-3     PIC S9(9)   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* EL331.cbl
  2808     12  WS-CLAIM-MATCH    COMP-3     PIC S9(9)   VALUE ZEROS.
  2809     12  WS-INACTIVE-CERTS COMP-3     PIC S9(9)   VALUE ZEROS.
  2810     12  WS-EXPIRE-MOS     COMP-3     PIC S9(9)   VALUE ZEROS.
  2811     12  WS-WORK-TERM      COMP-3     PIC S9(3)   VALUE ZEROS.
  2812     12  WS-CURRENT-MOS           PIC S9(9) COMP-3  VALUE ZEROS.
  2813     12  WS-UPDATE-SW             PIC S9  COMP-3    VALUE ZERO.
  2814     12  WS-ONL-RECORD            PIC  X(450)       VALUE SPACES.
  2815     12  WS-BEFORE-CERT           PIC  X(450)       VALUE SPACES.
  2816     12  WS-LAST-CLAIM-MATCHED    PIC  X(450)       VALUE SPACES.
  2817     12  WS-CLM-CNT               PIC  S9(4)  COMP  VALUE ZEROS.
  2818     12  WS-CM-ORIG               PIC  X            VALUE SPACE.
  2819     12  WS-CL-ORIG               PIC  X            VALUE SPACE.
  2820     12  WS-CM-INSURED-ADDRESS-SW PIC  X            VALUE SPACE.
  2821     12  WS-CM-ENTRY-BATCH        PIC  X(6)         VALUE SPACES.
  2822     12  WS-CM-LF-EXIT-BATCH      PIC  X(6)         VALUE SPACES.
  2823     12  WS-CM-AH-EXIT-BATCH      PIC  X(6)         VALUE SPACES.
  2824     12  WS-CM-BENEFICIARY        PIC  X(25)        VALUE SPACES.
  2825     12  WS-LST-ADD-ON-DT         PIC  XX           VALUE SPACES.
  2826     12  WS-LN-NUMBER             PIC  X(8)         VALUE SPACES.
  2827     12  WS-LN-BALANCE            PIC S9(7)V99 COMP-3 VALUE ZERO.
  2828     12  WS-CLAIM-DEDUCT-WITHHELD PIC S9(5)V99 COMP-3 VALUE ZERO.
  2829     12  WS-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99 COMP-3 VALUE ZERO.
  2830     12  WS-LF-DEATH-EXIT-DT      PIC X(02)      VALUE LOW-VALUES.
  2831     12  WS-LF-CURRENT-STATUS     PIC X(01)      VALUE SPACE.
  2832     12  WS-LF-STATUS-AT-DEATH    PIC X(01)      VALUE SPACE.
  2833     12  WS-EOM-DT                PIC X(02)      VALUE LOW-VALUES.
  2834
  2835     12  WS-NAME-WORK.
  2836         16  WS-NAME-14           PIC X(14)          VALUE SPACE.
  2837         16  WS-NAME-15           PIC X              VALUE '|'.
  2838
  2839     12  WS-EFF-ACT-NAME.
  2840         16  WS-NAME-EFF-DT      PIC X(6)  VALUE SPACES.
  2841         16  WS-NAME-FILL        PIC XX    VALUE SPACES.
  2842         16  WS-NAME-ACCT        PIC X(7)  VALUE SPACES.
  2843
  2844     12  WS-HAN-ACCOUNT.
  2845         16  FILLER              PIC XXX   VALUE SPACES.
  2846         16  WS-HAN-ACCT-4-10    PIC X(7)  VALUE SPACES.
  2847
  2848     12  WS-HI-LAST-NAME.
  2849         16  FILLER              PIC X(8)  VALUE SPACES.
  2850         16  WS-HI-CERT-4-10     PIC X(7)  VALUE SPACES.
  2851
  2852     12  WS-CLAS-I-CALC-TYPE     PIC X              VALUE SPACE.
  2853     12  WS-CLAS-I-BEN           PIC XX             VALUE SPACES.
  2854
  2855     12  CL-STATUS.
  2856         16  CL-STAT-1           PIC X              VALUE ZERO.
  2857         16  CL-STAT-2           PIC X              VALUE ZERO.
  2858
  2859     12  ELRETR5-FILE-STATUS.
  2860         16  ELRETR5-STAT-1      PIC X              VALUE ZERO.
  2861         16  ELRETR5-STAT-2      PIC X              VALUE ZERO.
  2862
  2863     12  ERMAIL-FILE-STATUS.
  2864         16  CFS-STAT-1          PIC X              VALUE ZERO.
  2865         16  CFS-STAT-2          PIC X              VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* EL331.cbl
  2866
  2867     12  CM-STATUS.
  2868         16  CM-STAT-1           PIC X              VALUE ZERO.
  2869         16  CM-STAT-2           PIC X              VALUE ZERO.
  2870
  2871     12  CE-STATUS.
  2872         16  CE-STAT-1           PIC X              VALUE ZERO.
  2873         16  CE-STAT-2           PIC X              VALUE ZERO.
  2874
  2875     12  AM-STATUSF.
  2876         16  AM-STAT-1           PIC X              VALUE ZERO.
  2877         16  AM-STAT-2           PIC X              VALUE ZERO.
  2878
  2879     12  WS-CM-CONTROL-PRIMARY   PIC X(33)  VALUE LOW-VALUES.
  2880
  2881     12  WS-SAVED-ECS-KEY.
  2882         16  WS-SAVED-B-COMP     PIC X     VALUE LOW-VALUE.
  2883         16  WS-SAVED-B-CARR     PIC X     VALUE SPACE.
  2884         16  WS-SAVED-B-GRPG     PIC X(6)  VALUE SPACES.
  2885         16  WS-SAVED-B-STAT     PIC XX    VALUE SPACES.
  2886         16  WS-SAVED-B-ACCT     PIC X(10) VALUE SPACES.
  2887         16  WS-SAVED-B-DATE     PIC 9(11) COMP-3 VALUE ZEROS.
  2888         16  WS-SAVED-B-CERT     PIC X(11) VALUE SPACES.
  2889
  2890     12  WS-SAVED-ONL-KEY.
  2891         16  WS-SAVED-O-COMP     PIC X     VALUE LOW-VALUE.
  2892         16  WS-SAVED-O-CARR     PIC X     VALUE SPACE.
  2893         16  WS-SAVED-O-GRPG     PIC X(6)  VALUE SPACES.
  2894         16  WS-SAVED-O-STAT     PIC XX    VALUE SPACES.
  2895         16  WS-SAVED-O-ACCT     PIC X(10) VALUE SPACES.
  2896         16  WS-SAVED-O-DATE     PIC 9(11) COMP-3 VALUE ZEROS.
  2897         16  WS-SAVED-O-CERT     PIC X(11) VALUE SPACES.
  2898
  2899     12  WS-CLAIM-MATCH-KEY.
  2900         16  WS-CL-CARR          PIC X     VALUE SPACES.
  2901         16  WS-CL-GRPG          PIC X(6)  VALUE SPACES.
  2902         16  WS-CL-STAT          PIC XX    VALUE SPACES.
  2903         16  WS-CL-ACCT          PIC X(10) VALUE SPACES.
  2904         16  WS-CL-EFDT          PIC XX    VALUE LOW-VALUES.
  2905
  2906     12  WS-SEC-CLAIM-INDEX.
  2907         16  WS-S-CL-COMP        PIC X     VALUE LOW-VALUES.
  2908         16  WS-S-CL-PRIM        PIC X(10) VALUE SPACES.
  2909         16  WS-S-CL-SFX         PIC X     VALUE SPACE.
  2910
  2911     12  WS-CM-CANCEL-DATE.
  2912         16  WS-CM-CANC-MO       PIC XX   VALUE SPACES.
  2913         16  WS-CM-CANC-DA       PIC XX   VALUE SPACES.
  2914         16  WS-CM-CANC-YR       PIC XX   VALUE SPACES.
  2915
  2916     12  WS-CURRENT-DATE-MDY.
  2917         16  WS-CURR-MO          PIC XX   VALUE SPACES.
  2918         16  WS-CURR-DA          PIC XX   VALUE SPACES.
  2919         16  WS-CURR-YR          PIC XX   VALUE SPACES.
  2920
  2921     12  WS-CTBL-KEY.
  2922         16  WS-CTBL-COMP-CD     PIC X    VALUE LOW-VALUES.
  2923         16  WS-CTBL-TABLE       PIC XXX  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* EL331.cbl
  2924         16  WS-CTBL-BEN-TYPE    PIC X    VALUE SPACE.
  2925         16  WS-CTBL-BEN-CODE    PIC XX   VALUE '  '.
  2926     12  WS-LAST-CTBL-KEY        PIC X(7) VALUE SPACES.
  2927
  2928 01  COMM-MATCH-AREA.
  2929     12  WS-L-COM                PIC SV9(5) COMP-3 VALUE +0.
  2930     12  WS-J-COM                PIC SV9(5) COMP-3 VALUE +0.
  2931     12  WS-A-COM                PIC SV9(5) COMP-3 VALUE +0.
  2932     12  WS-COMM-CK-AMT          PIC S9(9)V99 COMP-3 VALUE +0.
  2933     12  WS-CK-AGE               PIC S999    VALUE ZEROS.
  2934     12  WS-CK-TERM              PIC S99     VALUE ZEROS.
  2935
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* EL331.cbl
* 2937                                 COPY ELCDATE.
  2938******************************************************************06/11/98
  2939*                                                                *ELCDATE
  2940*                                                                *ELCDATE
  2941*                            ELCDATE.                            *   LV023
  2942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  2943*                            VMOD=2.003                           ELCDATE
  2944*                                                                *ELCDATE
  2945*                                                                *ELCDATE
  2946*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  2947*                 LENGTH = 200                                   *   CL*19
  2948******************************************************************ELCDATE
  2949                                                                  ELCDATE
  2950 01  DATE-CONVERSION-DATA.                                        ELCDATE
  2951     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  2952     12  DC-OPTION-CODE                PIC X.                        CL*15
  2953         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  2954         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  2955         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  2956         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  2957         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  2958         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  2959         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  2960         88  FIND-CENTURY               VALUE '7'.                   CL*22
  2961         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  2962         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  2963         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  2964         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  2965         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  2966         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  2967         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  2968         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  2969         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  2970         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  2971         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  2972         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  2973         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  2974         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  2975         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  2976         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  2977         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  2978         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  2979         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  2980         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  2981         88  THREE-CHARACTER-BIN                                  ELCDATE
  2982                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  2983         88  GREGORIAN-TO-BIN                                        CL**2
  2984                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  2985         88  BIN-TO-GREGORIAN                                        CL**2
  2986                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  2987         88  JULIAN-TO-BINARY                                        CL**2
  2988                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  2989     12  DC-ERROR-CODE                 PIC X.                        CL*15
  2990         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  2991         88  DATE-CONVERSION-ERROR                                ELCDATE
  2992                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  2993         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  2994         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* EL331.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2995         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  2996         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  2997         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  2998         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  2999         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  3000         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  3001         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  3002         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  3003     12  DC-END-OF-MONTH               PIC X.                        CL*15
  3004         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  3005     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  3006         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  3007         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  3008         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  3009     12  FILLER                        PIC X.                        CL*15
  3010     12  DC-CONVERSION-DATES.                                        CL*15
  3011         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  3012         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  3013         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  3014         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  3015                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  3016             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  3017             20  SLASH1-1              PIC X.                        CL*15
  3018             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  3019             20  SLASH1-2              PIC X.                        CL*15
  3020             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  3021         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  3022         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  3023                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  3024             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  3025             20  SLASH2-1              PIC X.                        CL*15
  3026             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  3027             20  SLASH2-2              PIC X.                        CL*15
  3028             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  3029         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  3030         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  3031                     DC-GREG-DATE-1-YMD.                          ELCDATE
  3032             20  DC-YMD-YEAR           PIC 99.                       CL*15
  3033             20  DC-YMD-MONTH          PIC 99.                       CL*15
  3034             20  DC-YMD-DAY            PIC 99.                       CL*15
  3035         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  3036         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  3037                      DC-GREG-DATE-1-MDY.                         ELCDATE
  3038             20  DC-MDY-MONTH          PIC 99.                       CL*15
  3039             20  DC-MDY-DAY            PIC 99.                       CL*15
  3040             20  DC-MDY-YEAR           PIC 99.                       CL*15
  3041         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  3042             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  3043             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  3044             20  FILLER                PIC XX.                       CL*15
  3045             20  DC-ALPHA-CENTURY.                                   CL*15
  3046                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  3047             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  3048         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  3049         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  3050         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  3051         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  3052         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* EL331.cbl (/apps/prod/cid1p/copy/ELCDATE)
  3053                                       PIC 9(05).                    CL*20
  3054         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  3055             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  3056             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  3057         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  3058         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  3059         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  3060     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  3061         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  3062         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  3063             20  FILLER                PIC 9(3).                     CL*15
  3064             20  HOLD-CEN-1-CCYY.                                    CL*15
  3065                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  3066                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  3067             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  3068             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  3069         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  3070             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  3071             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  3072             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  3073                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  3074                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  3075             20  FILLER                PIC 9(3).                     CL*15
  3076         16  HOLD-CENTURY-1-X.                                       CL*15
  3077             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  3078             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  3079                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  3080                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  3081             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  3082             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  3083         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  3084             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  3085             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  3086             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  3087                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  3088                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  3089             20  FILLER                PIC XXX.                      CL*23
  3090         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  3091         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  3092         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  3093         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  3094             20  DC-JULIAN-1-CCYY.                                   CL*15
  3095                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  3096                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  3097             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  3098         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  3099         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  3100             20  DC-JULIAN-2-CCYY.                                   CL*15
  3101                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  3102                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  3103             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  3104         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  3105             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  3106             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  3107             20  DC-EDITA-DAY          PIC 99.                       CL*15
  3108             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  3109             20  DC-EDITA-CCYY.                                      CL*15
  3110                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* EL331.cbl (/apps/prod/cid1p/copy/ELCDATE)
  3111                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  3112         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  3113             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  3114             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  3115             20  DC-EDITB-DAY          PIC 99.                       CL*15
  3116             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  3117             20  DC-EDITB-CCYY.                                      CL*15
  3118                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  3119                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  3120         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  3121         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  3122                              DC-GREG-DATE-CYMD.                  ELCDATE
  3123             20  DC-CYMD-CEN           PIC 99.                       CL*15
  3124             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  3125             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  3126             20  DC-CYMD-DAY           PIC 99.                       CL*15
  3127         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  3128         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  3129                              DC-GREG-DATE-MDCY.                  ELCDATE
  3130             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  3131             20  DC-MDCY-DAY           PIC 99.                       CL*15
  3132             20  DC-MDCY-CEN           PIC 99.                       CL*15
  3133             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  3134    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  3135        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  3136    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  3137    12  FILLER                         PIC X(28).                    CL*26
  3138
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* EL331.cbl
  3140 01  PRINTER-WORK-AREAS.
  3141     12  HEADING-1.
  3142         16  FILLER      PIC X(50) VALUE SPACE.
  3143         16  FILLER      PIC X(21) VALUE '  CERTIFICATE AUDIT  '.
  3144         16  FILLER      PIC X(60) VALUE SPACES.
  3145
  3146     12  HEADING-2.
  3147         16  FILLER      PIC X(47) VALUE SPACE.
  3148         16  HD-COMP-NM  PIC X(30) VALUE SPACE.
  3149         16  FILLER      PIC X(42) VALUE SPACES.
  3150         16  FILLER      PIC X(08) VALUE 'EL331  '.
  3151
  3152     12  HEADING-3.
  3153         16  FILLER      PIC X(50) VALUE SPACE.
  3154         16  FILLER      PIC X(3)  VALUE '** '.
  3155         16  HD-DATE-FULL PIC X(18).
  3156         16  FILLER      PIC X(3)  VALUE ' **'.
  3157         16  FILLER      PIC X(45)  VALUE SPACES.
  3158         16  HD-RUN-DATE PIC X(8).
  3159
  3160     12  HEADING-4.
  3161         16  FILLER      PIC X(119) VALUE SPACE.
  3162         16  FILLER      PIC X(4)   VALUE 'PAGE'.
  3163         16  HD-PAGE-NO  PIC ZZZ9.
  3164
  3165     12  HEADING-5.
  3166         16  FILLER      PIC X(44)  VALUE
  3167         ' *---------- CERTIFICATE CONTROLS ---------*'.
  3168         16  FILLER      PIC X(44)  VALUE
  3169         '  *------------ ASSOCIATED CLAIM -----------'.
  3170         16  FILLER      PIC X(45)  VALUE
  3171         '---* *------- EXCEPTION CONDITION ----------*'.
  3172
  3173     12  HEADING-6.
  3174         16  FILLER      PIC X(46)  VALUE
  3175             '   NUMBER   EFFECTIVE C GROUP  ST  ACCOUNT    '.
  3176         16  FILLER      PIC X(46)  VALUE
  3177             'NUMBER  TYPE STATUS LN KIND INCURRED PROCESSOR'.
  3178         16  FILLER      PIC X(41)  VALUE  SPACES.
  3179
  3180     12  DTL-1.
  3181         16  FILLER              PIC X              VALUE SPACE.
  3182         16  DTL-CERT-NO         PIC X(11).
  3183         16  FILLER              PIC X              VALUE SPACE.
  3184         16  DTL-EFFECTIVE-DT.
  3185             20  DTL-EFF-MO      PIC XX.
  3186             20  FILLER          PIC X              VALUE '/'.
  3187             20  DTL-EFF-DA      PIC XX.
  3188             20  FILLER          PIC X              VALUE '/'.
  3189             20  DTL-EFF-YR      PIC XX.
  3190         16  FILLER              PIC X              VALUE SPACE.
  3191         16  DTL-CARR            PIC X.
  3192         16  FILLER              PIC X             VALUE SPACE.
  3193         16  DTL-GRPG            PIC X(6).
  3194         16  FILLER              PIC X             VALUE SPACE.
  3195         16  DTL-STAT            PIC XX.
  3196         16  FILLER              PIC X             VALUE SPACE.
  3197         16  DTL-ACCT            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* EL331.cbl
  3198         16  FILLER              PIC X             VALUE SPACE.
  3199         16  DTL-CL-NO           PIC X(7).
  3200         16  FILLER              PIC X             VALUE SPACE.
  3201         16  DTL-CL-TYPE         PIC XXXX.
  3202         16  FILLER              PIC X             VALUE SPACE.
  3203         16  DTL-CL-STATUS       PIC X(6).
  3204         16  FILLER              PIC X              VALUE SPACE.
  3205         16  DTL-CL-LN-KIND      PIC X(7).
  3206         16  FILLER              PIC X              VALUE SPACE.
  3207         16  DTL-CL-INCURRED     PIC X(8).
  3208         16  FILLER              PIC XXX            VALUE SPACE.
  3209         16  DTL-CL-PROCESSOR    PIC XXXX.
  3210         16  FILLER              PIC X(4)           VALUE SPACE.
  3211         16  DTL-EXC-MSG         PIC X(40).
  3212         16  FILLER              PIC XX             VALUE SPACE.
  3213
  3214     12  WS-EXC-MSG-CANCEL.
  3215         16  WS-EXC-MSG-DESC    PIC X(26)
  3216               VALUE ' XXXX COV CANCELLED AS OF '.
  3217         16  WS-EXC-MSG-CANCEL-DATE.
  3218             25  WS-EXC-C-MO    PIC XX.
  3219             25  FILLER         PIC X                VALUE '/'.
  3220             25  WS-EXC-C-DA    PIC XX.
  3221             25  FILLER         PIC X                VALUE '/'.
  3222             25  WS-EXC-C-YR    PIC XX.
  3223
  3224     12  WS-EXC-MSG-NO-NOTES.
  3225         16  WS-EXC-MSG-NO-DE    PIC X(21)
  3226               VALUE ' CERTIFICATE PENDING-'.
  3227         16  WS-EXC-MSG-NO-COPY  PIC X(15)
  3228               VALUE 'NOTES ATTACHED.'.
  3229
  3230     12  WS-EXC-MSG-CO-DELETE   PIC X(40)
  3231               VALUE ' COVERAGE DELETED - SEE CREDIT DEPT.    '.
  3232
  3233     12  WS-EXC-MSG-CE-DELETE.
  3234         16  WS-EXC-MSG-CE-DE    PIC X(21)
  3235               VALUE ' CERTIFICATE DELETED '.
  3236         16  WS-EXC-MSG-CE-COPY  PIC X(15)
  3237               VALUE SPACES.
  3238
  3239     12  WS-EXC-MSG-EE-EXPIRED.
  3240         16  WS-EXC-MSG-EE-DE    PIC X(21)
  3241               VALUE ' CERTIFICATE EXPIRED '.
  3242         16  WS-EXC-MSG-EE-COPY  PIC X(15)
  3243               VALUE SPACES.
  3244
  3245     12  WS-EXC-MSG-ADDED.
  3246         16  FILLER             PIC X(22) VALUE
  3247                     ' COVERAGE ADDED - AMT '.
  3248         16  WS-EXC-MSG-ADDED-AMT     PIC ZZZZZZ9.99.
  3249         16  FILLER             PIC X(6) VALUE ' TYPE-'.
  3250         16  WS-EXC-MSG-ADDED-TYPE    PIC XX.
  3251
  3252     12  WS-EXC-MSG-CHANGED-NEW.
  3253         16  FILLER            PIC X(22) VALUE
  3254                     ' COVERAGE CHANGED-NEW '.
  3255         16  WS-EXC-MSG-CHGD-AMT-NEW  PIC ZZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* EL331.cbl
  3256         16  FILLER            PIC X(6) VALUE ' TYPE-'.
  3257         16  WS-EXC-MSG-CHGD-TYPE-NEW PIC XX.
  3258
  3259     12  WS-EXC-MSG-CHANGED-OLD.
  3260         16  FILLER              PIC X(18) VALUE   SPACES.
  3261         16  FILLER              PIC X(04) VALUE
  3262                                       'OLD '.
  3263         16  WS-EXC-MSG-CHGD-AMT-OLD  PIC ZZZZZZ9.99.
  3264         16  FILLER                   PIC X(6) VALUE ' TYPE-'.
  3265         16  WS-EXC-MSG-CHGD-TYPE-OLD PIC XX.
  3266
  3267     12  WS-EXC-MSG-COPY.
  3268         16  FILLER              PIC X(20) VALUE
  3269                                       'CERT COPIED FROM ECS'.
  3270
  3271     12  FTG-1.
  3272         16  P-MATCHED-ONL       PIC ZZZ,ZZZ,ZZ9-.
  3273         16  FILLER              PIC X(35)
  3274                   VALUE  ' MATCHED / UPDATED (+)   '.
  3275
  3276     12  FTG-2.
  3277         16  P-LOADED-ECS        PIC ZZZ,ZZZ,ZZ9-.
  3278         16  FILLER              PIC X(35)
  3279                   VALUE  ' LOADED FROM OFFLINE (+) '.
  3280
  3281     12  FTG-3.
  3282         16  P-ONL-DELETED       PIC ZZZ,ZZZ,ZZ9-.
  3283         16  FILLER              PIC X(35)
  3284                   VALUE  ' ONLINE DELETED    (-)   '.
  3285         16  FILLER              PIC X(30)
  3286                   VALUE  ' CURRENT ELCERT RECORD COUNT--'.
  3287         16  P-ONL-EXIST         PIC ZZZ,ZZZ,ZZ9-.
  3288
  3289     12  FTG-4.
  3290         16  P-CLAIM-MATCH       PIC ZZZ,ZZZ,ZZ9-.
  3291         16  FILLER              PIC X(35)
  3292                   VALUE  ' HAVE ATTACHED CLAIMS    '.
  3293
  3294     12  FTG-5.
  3295         16  P-INACTIVE-CERTS    PIC ZZZ,ZZZ,ZZ9-.
  3296         16  FILLER              PIC X(35)
  3297                   VALUE  ' INACTIVE AND BYPASSED   '.
  3298
  3299     12  FTG-6.
  3300         16  P-ONL-READ          PIC ZZZ,ZZZ,ZZ9-.
  3301         16  FILLER              PIC X(35)
  3302                   VALUE  ' ONLINE CERTS READ       '.
  3303
  3304     12  FTG-7.
  3305         16  P-ECS-READ          PIC ZZZ,ZZZ,ZZ9-.
  3306         16  FILLER              PIC X(35)
  3307                   VALUE  ' OFFLINE CERTS READ      '.
  3308
  3309     12  FTG-8.
  3310         16  P-EXCP-ADD          PIC ZZZ,ZZZ,ZZ9-.
  3311         16  FILLER              PIC X(35)
  3312                   VALUE  ' COMP EXCEPTIONS ADDED'.
  3313
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* EL331.cbl
  3314     12  FTG-9.
  3315         16  P-EXCP-DEL          PIC ZZZ,ZZZ,ZZ9-.
  3316         16  FILLER              PIC X(35)
  3317                   VALUE  ' COMP EXCEPTIONS DELETED'.
  3318
  3319     12  FTG-10.
  3320         16  P-EXCP-TBL          PIC ZZZ,ZZZ,ZZ9-.
  3321         16  FILLER              PIC X(35)
  3322                   VALUE  ' ACCTS WITH COMM TABLES '.
  3323
  3324     12  FTG-11.
  3325         16  P-MAIL-DEL          PIC ZZZ,ZZZ,ZZ9-.
  3326         16  FILLER              PIC X(35)
  3327                   VALUE  ' INSURED ADDRESS MAIL RECS DELETED '.
  3328
  3329     12  FTG-12.
  3330         16  P-ACCT-READS        PIC ZZZ,ZZZ,ZZ9-.
  3331         16  FILLER              PIC X(35)
  3332                   VALUE  ' ACCOUNT MASTER MATCH ATTEMPTS '.
  3333
  3334     12  FTG-13.
  3335         16  P-ACT-READ          PIC ZZZ,ZZZ,ZZ9-.
  3336         16  FILLER              PIC X(35)
  3337                   VALUE  ' ERACCT RECORDS READ '.
  3338
  3339     12  FTG-14.
  3340         16  P-ACCT-MATCH        PIC ZZZ,ZZZ,ZZ9-.
  3341         16  FILLER              PIC X(35)
  3342                   VALUE  ' CERTS MATCHED TO ACCOUNT MASTER '.
  3343
  3344
* 3345                                 COPY ELCDTECX.
  3346******************************************************************06/05/98
  3347*                                                                *ELCDTECX
  3348*                            ELCDTECX.                           *   LV005
  3349*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3350*                            VMOD=2.015                          *ELCDTECX
  3351*                                                                *ELCDTECX
  3352*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  3353*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  3354*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  3355*                                                                *ELCDTECX
  3356******************************************************************ELCDTECX
  3357******************************************************************
  3358*                   C H A N G E   L O G
  3359*
  3360* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3361*-----------------------------------------------------------------
  3362*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3363* EFFECTIVE    NUMBER
  3364*-----------------------------------------------------------------
  3365* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  3366*                                  BENEFIT CODES FROM 300 TO 900
  3367* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  3368* 051304    2003080800002  SMVA  ADD REFUND METHOD
  3369* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  3370******************************************************************
  3371 01  DATE-CARD.                                                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3372     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  3373     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  3374     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  3375     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  3376     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  3377     12  EP-SW                       PIC  X.                      ELCDTECX
  3378         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  3379     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  3380         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  3381     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  3382     12  RUN-CENTURY.                                             ELCDTECX
  3383         16 RUN-CENTURY-N            PIC  99.                        CL**4
  3384     12  FILLER                      PIC  X.                         CL**4
  3385     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  3386     12  FILLER                      PIC  XXX.                    ELCDTECX
  3387     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  3388                                                                  ELCDTECX
  3389 01  FILLER                          PIC  X(7)                       CL**6
  3390                                          VALUE 'OPTIONS'.        ELCDTECX
  3391 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  3392     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  3393     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  3394     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  3395         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  3396         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  3397     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  3398     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  3399     12  FILLER                      PIC  X.                      ELCDTECX
  3400     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  3401     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  3402     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  3403     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  3404     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  3405     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  3406     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  3407     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  3408     12  FILLER                      PIC  X.                      ELCDTECX
  3409     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  3410     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  3411     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  3412     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  3413     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  3414     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  3415     12  FILLER                      PIC  X.                      ELCDTECX
  3416     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  3417     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  3418     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  3419     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  3420     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  3421     12  DTE-R78                     PIC  X.                      ELCDTECX
  3422     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  3423     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  3424     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  3425     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  3426     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  3427     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  3428     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  3429                                     PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3430         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  3431                                                 ' '.             ELCDTECX
  3432         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  3433         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  3434     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  3435         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  3436         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  3437     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  3438     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  3439                                     PIC  9.                         CL**4
  3440     12  DTE-SYSTEM.                                              ELCDTECX
  3441         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  3442         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  3443         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  3444         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  3445         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  3446         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  3447         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  3448         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  3449         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  3450         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  3451         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  3452         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  3453         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  3454         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  3455         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  3456         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  3457         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  3458         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  3459         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  3460         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  3461         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  3462         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  3463         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  3464         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  3465         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  3466         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  3467     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  3468         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  3469                                     PIC  X.                      ELCDTECX
  3470     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  3471                                                                  ELCDTECX
  3472 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  3473     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  3474     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  3475     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  3476*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  3477     12  FILLER                      PIC  X.                      ELCDTECX
  3478     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  3479     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  3480     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  3481     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  3482     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  3483     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  3484     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  3485                                                                  ELCDTECX
  3486     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  3487     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3488     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  3489     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  3490                                                                  ELCDTECX
  3491     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  3492     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  3493     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  3494     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  3495                                                                  ELCDTECX
  3496     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  3497     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  3498                                                                  ELCDTECX
  3499     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  3500     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  3501                                                                  ELCDTECX
  3502     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  3503                                                                  ELCDTECX
  3504 01  DATE-CARD-FACTORS.                                           ELCDTECX
  3505     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  3506     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  3507     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  3508     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  3509     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  3510     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  3511     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  3512                                                                  ELCDTECX
  3513 01  FILLER                          PIC  X(12)                   ELCDTECX
  3514                                          VALUE 'COMPANY NAME'.   ELCDTECX
  3515 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  3516     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  3517         16  CNT-ID                  PIC  X.                      ELCDTECX
  3518         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  3519                                                                  ELCDTECX
  3520 01  FILLER                          PIC  X(11)                   ELCDTECX
  3521                                          VALUE 'STATE NAMES'.    ELCDTECX
  3522 01  STATE-NAMES.                                                 ELCDTECX
  3523     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  3524         16  STATE-SUB               PIC  XX.                     ELCDTECX
  3525         16  STATE-PIC1.                                          ELCDTECX
  3526             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  3527             20  FILLER              PIC  XXX.                    ELCDTECX
  3528             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  3529             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  3530             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  3531             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  3532                                                                  ELCDTECX
  3533 01  FILLER                          PIC  X(13)                   ELCDTECX
  3534                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  3535 01  CARRIER-NAMES.                                               ELCDTECX
  3536     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  3537         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  3538         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  3539         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  3540         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3541         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3542         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3543*        16  FILLER                  PIC  X.                      ELCDTECX
  3544         16  CARRIER-SEC-PAY         PIC  X.
  3545             88  SEC-PAY-CARRIER          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3546                                                                  ELCDTECX
  3547 01  FILLER                          PIC  X(9)                       CL**6
  3548                                          VALUE 'INS TYPES'.      ELCDTECX
  3549 01  CLAS-INS-TYPES.                                              ELCDTECX
  3550*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  3551     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  3552         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  3553         16  CLAS-I-AB3.                                          ELCDTECX
  3554             20  FILLER              PIC  X.                      ELCDTECX
  3555             20  CLAS-I-AB2.                                      ELCDTECX
  3556                 24  FILLER          PIC  X.                      ELCDTECX
  3557                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  3558         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  3559             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  3560             20  FILLER              PIC  X.                         CL**4
  3561         16  CLAS-I-AB10.                                         ELCDTECX
  3562             20  FILLER              PIC  X(9).                   ELCDTECX
  3563             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  3564         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  3565         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  3566         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  3567         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  3568             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  3569         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  3570         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  3571         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  3572         16  CLAS-I-BEN-CATEGORY     PIC  X.
  3573         16  CLAS-I-REFUND-METHOD    PIC  X.
  3574         16  CLAS-I-MAX-BENEFITS     PIC 99.
  3575         16  FILLER                  PIC  XXX.
  3576                                                                  ELCDTECX
  3577 01  FILLER                          PIC  X(16)                   ELCDTECX
  3578                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  3579 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  3580     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  3581                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  3582         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  3583         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  3584         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  3585         16  CLAS-MORT-DESC.                                      ELCDTECX
  3586             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  3587             20  FILLER              PIC  XX.                        CL**5
  3588             20  CLAS-YEAR           PIC  X(4).                      CL**6
  3589             20  FILLER              PIC  X.                         CL**5
  3590             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  3591             20  FILLER              PIC  X.                         CL**5
  3592             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  3593             20  FILLER              PIC  X.                         CL**5
  3594             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  3595             20  FILLER              PIC  X(5).                      CL**6
  3596                                                                  ELCDTECX
  3597 01  FILLER                          PIC  X(15)                   ELCDTECX
  3598                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  3599 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  3600     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  3601         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  3602         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  3603         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3604         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  3605         16  FILLER                  PIC  X(4).                      CL**6
  3606                                                                  ELCDTECX
  3607 01  FILLER                          PIC  X(7)                       CL**6
  3608                                     VALUE 'INDEXES'.             ELCDTECX
  3609 01  CLAS-INDEX-TBL.                                              ELCDTECX
  3610     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  3611     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  3612     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  3613     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  3614     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  3615     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  3616     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  3617     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  3618     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  3619     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  3620     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  3621     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  3622     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  3623     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  3624     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  3625     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  3626     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  3627                                                                  ELCDTECX
  3628 01  CLAS-TYPE-MISC.                                              ELCDTECX
  3629     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  3630     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  3631     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  3632     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  3633     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  3634     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  3635     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  3636     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  3637     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  3638     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  3639     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  3640                                                                  ELCDTECX
  3641 01  FILLER                          PIC  X(13)                   ELCDTECX
  3642                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  3643 01  CLAS-MISC.                                                   ELCDTECX
  3644     12  DTE-FICH                    PIC  X.                      ELCDTECX
  3645         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  3646         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  3647         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  3648     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  3649     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  3650     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  3651     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  3652     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  3653     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  3654     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  3655     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  3656     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  3657     12  STATE-L                     PIC  XX.                     ELCDTECX
  3658     12  CLAS-CN                     PIC  99.                     ELCDTECX
  3659     12  CLAS-CO                     PIC  99.                     ELCDTECX
  3660     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  3661         16  DTE-F-1                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3662         16  DTE-F-2                 PIC  X.                      ELCDTECX
  3663     12  DTE-ABEND-WORK.                                          ELCDTECX
  3664         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  3665         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  3666                                                                  ELCDTECX
  3667 01  FILLER                          PIC  X(12)                   ELCDTECX
  3668                                     VALUE 'WORKING DATE'.        ELCDTECX
  3669 01  WS-DATE-AND-TIME.                                            ELCDTECX
  3670     12  WS-ACCEPT-DATE.                                          ELCDTECX
  3671         16  WS-AD-YY                PIC  99.                     ELCDTECX
  3672         16  WS-AD-MM                PIC  99.                     ELCDTECX
  3673         16  WS-AD-DD                PIC  99.                     ELCDTECX
  3674     12  WS-CURRENT-DATE.                                         ELCDTECX
  3675         16  WS-CD-MM                PIC  99.                     ELCDTECX
  3676         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3677         16  WS-CD-DD                PIC  99.                     ELCDTECX
  3678         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3679         16  WS-CD-YY                PIC  99.                     ELCDTECX
  3680     12  WS-TIME-OF-DAY.                                          ELCDTECX
  3681         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  3682         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  3683                                                                  ELCDTECX
  3684 01  FILLER                          PIC  X(12)                   ELCDTECX
  3685                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  3686 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  3687     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  3688         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  3689         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  3690         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  3691                                                                  ELCDTECX
  3692 01  FILLER                          PIC  X(10)                   ELCDTECX
  3693                                     VALUE 'STATE TLRS'.          ELCDTECX
  3694 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  3695     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  3696         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  3697         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  3698                                                                  ELCDTECX
  3699 01  FILLER                          PIC  X(13)                   ELCDTECX
  3700                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  3701 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  3702     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  3703         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  3704                                                                  ELCDTECX
  3705 01  FILLER                          PIC  X(13)                   ELCDTECX
  3706                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  3707 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  3708     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  3709     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  3710     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  3711                                     PIC  X.                         CL**5
  3712     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  3713     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  3714     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  3715     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  3716     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  3717     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  3718     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  3719     12  FILLER                      PIC  X(75).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* EL331.cbl
  3720******************************************************************ELCDTECX
  3721*01  MISC-CARR-PCT-DATA.                                          00001521
  3722*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3723*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3724*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3725*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3726*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3727*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3728******************************************************************ELCDTECX
  3729
* 3730                                 COPY ELCDTEVR.
  3731***************************************************************** 04/15/98
  3732*                                                                *ELCDTEVR
  3733*                                                                *ELCDTEVR
  3734*                            ELCDTEVR.                           *   LV003
  3735*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3736*                            VMOD=2.001                          *   CL**2
  3737*                                                                *ELCDTEVR
  3738*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  3739*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  3740*                                                                *ELCDTEVR
  3741******************************************************************ELCDTEVR
  3742 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  3743     05  WS-RUN-DATE.                                             ELCDTEVR
  3744         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3745         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  3746         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  3747             15  RUN-CC              PIC  99.                     ELCDTEVR
  3748             15  RUN-YR              PIC  99.                     ELCDTEVR
  3749         10  RUN-MO                  PIC  99.                     ELCDTEVR
  3750         10  RUN-DA                  PIC  99.                     ELCDTEVR
  3751     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  3752            WS-RUN-DATE              PIC 9(11).                      CL**2
  3753     05  WS-EP-DT.                                                ELCDTEVR
  3754         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3755         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  3756         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  3757             15  EP-CC               PIC  99.                     ELCDTEVR
  3758             15  EP-YR               PIC  99.                     ELCDTEVR
  3759         10  EP-MO                   PIC  99.                     ELCDTEVR
  3760         10  EP-DA                   PIC  99.                     ELCDTEVR
  3761     05  WS-EP-DT-N REDEFINES                                        CL**2
  3762            WS-EP-DT                 PIC 9(11).                      CL**2
  3763     05  WS-DTE-CONV-DT.                                             CL**4
  3764         10  FILLER                  PIC  9(03).                     CL**4
  3765         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  3766         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  3767             15  DTE-CONV-CC         PIC  99.                        CL**4
  3768             15  DTE-CONV-YR         PIC  99.                        CL**4
  3769         10  DTE-CONV-MO             PIC  99.                        CL**4
  3770         10  DTE-CONV-DA             PIC  99.                        CL**4
  3771     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  3772            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  3773 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  3774     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  3775         10  FILLER                            PIC 999.           ELCDTEVR
  3776         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  3777         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3778             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  3779             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  3780         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  3781         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  3782     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  3783            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  3784     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  3785         10  FILLER                            PIC 999.           ELCDTEVR
  3786         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  3787         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  3788         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  3789         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  3790     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  3791            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  3792 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  3793     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  3794         10  FILLER                            PIC 999.           ELCDTEVR
  3795         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  3796         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  3797             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  3798             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  3799         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  3800         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  3801     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  3802            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  3803     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  3804         10  FILLER                            PIC 999.           ELCDTEVR
  3805         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  3806         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  3807             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  3808             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  3809         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  3810         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  3811     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  3812            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  3813     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  3814         10  FILLER                            PIC 999.           ELCDTEVR
  3815         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  3816         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  3817             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  3818             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  3819         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  3820         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  3821     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  3822            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  3823 01  WS-RATE-RECORD.                                              ELCDTEVR
  3824         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  3825             10  FILLER                        PIC 999.           ELCDTEVR
  3826             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  3827             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  3828                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  3829                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  3830             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  3831             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  3832         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  3833                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  3834
* 3835                                 COPY ELCCRTVR.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3836***************************************************************** 04/24/98
  3837*                                                                *ELCCRTVR
  3838*                                                                *ELCCRTVR
  3839*                            ELCCRTVR                            *   LV003
  3840*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3841*                            VMOD=2.001                          *ELCCRTVR
  3842*                                                                *ELCCRTVR
  3843*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  3844*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  3845*                                                                *ELCCRTVR
  3846******************************************************************ELCCRTVR
  3847                                                                  ELCCRTVR
  3848 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  3849     05  WS-CR-DT.                                                ELCCRTVR
  3850         10  FILLER                PIC 999.                       ELCCRTVR
  3851         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  3852         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  3853             15  CR-CC             PIC 99.                        ELCCRTVR
  3854             15  CR-YR             PIC 99.                        ELCCRTVR
  3855         10  CR-MO                 PIC 99.                        ELCCRTVR
  3856         10  CR-DA                 PIC 99.                        ELCCRTVR
  3857     05  WS-CR-DT-N REDEFINES                                        CL**2
  3858            WS-CR-DT               PIC 9(11).                        CL**2
  3859     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  3860         10  FILLER                    PIC 999.                   ELCCRTVR
  3861         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3862         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  3863             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3864             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3865         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3866         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3867     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  3868            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  3869     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  3870         10  FILLER                    PIC 999.                   ELCCRTVR
  3871         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3872         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  3873             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3874             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3875         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3876         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3877     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  3878            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  3879     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  3880         10  FILLER                    PIC 999.                   ELCCRTVR
  3881         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  3882         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  3883             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  3884             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  3885         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  3886         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  3887     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  3888            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  3889     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  3890         10  FILLER                    PIC 999.                   ELCCRTVR
  3891         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3892         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  3893             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3894             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  3895         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  3896         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  3897     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  3898            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  3899     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  3900         10  FILLER                    PIC 999.                   ELCCRTVR
  3901         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3902         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  3903             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  3904             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  3905         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  3906         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  3907     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3908            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3909     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  3910         10  FILLER                    PIC 999.                   ELCCRTVR
  3911         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3912         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  3913             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  3914             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  3915         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  3916         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  3917     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  3918            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  3919     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  3920         10  FILLER                    PIC 999.                   ELCCRTVR
  3921         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3922         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  3923             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  3924             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  3925         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  3926         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  3927     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  3928            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  3929     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  3930         10  FILLER                    PIC 999.                   ELCCRTVR
  3931         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3932         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  3933             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  3934             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  3935         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  3936         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  3937     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3938            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3939     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  3940         10  FILLER                    PIC 999.                   ELCCRTVR
  3941         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3942         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  3943             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  3944             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  3945         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  3946         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  3947     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  3948          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  3949     05  WS-CR-DTH-DT.                                            ELCCRTVR
  3950         10  FILLER                    PIC 999.                   ELCCRTVR
  3951         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3952         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  3953             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  3954             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  3955         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  3956         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  3957     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  3958            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  3959     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  3960         10  FILLER                    PIC 999.                   ELCCRTVR
  3961         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3962         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  3963             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  3964             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  3965         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  3966         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  3967     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  3968            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  3969     05  WS-CR-DIS-DT.                                            ELCCRTVR
  3970         10  FILLER                    PIC 999.                   ELCCRTVR
  3971         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  3972         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  3973             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  3974             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  3975         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  3976         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  3977     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  3978            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  3979     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  3980         10  FILLER                    PIC 999.                   ELCCRTVR
  3981         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3982         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  3983             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  3984             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  3985         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  3986         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  3987     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  3988            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  3989     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  3990         10  FILLER                    PIC 999.                   ELCCRTVR
  3991         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  3992         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  3993             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  3994             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  3995         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  3996         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  3997     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  3998            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  3999     05  COPY-NDX                      PIC 9.                        CL**6
  4000     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  4001         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  4002             15  FILLER                PIC 999.                   ELCCRTVR
  4003             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  4004             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  4005                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  4006                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  4007             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  4008             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  4009         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* EL331.cbl
  4010                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  4011
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* EL331.cbl
  4013 PROCEDURE DIVISION.
  4014
  4015 00000-LOAD-DATE-CARD.
*                                      COPY ELCDTERX.
  4016******************************************************************04/15/98
  4017*                                                                *ELCDTERX
  4018*                                                                *ELCDTERX
  4019*                            ELCDTERX.                           *   LV002
  4020*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4021*                            VMOD=2.007                          *ELCDTERX
  4022*                                                                *ELCDTERX
  4023*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  4024*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  4025*      = ELCDTEFD)                                               *ELCDTERX
  4026*                                                                *ELCDTERX
  4027******************************************************************ELCDTERX
  4028                                                                  ELCDTERX
  4029     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  4030                                                                  ELCDTERX
  4031     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  4032     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  4033     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  4034                                                                  ELCDTERX
  4035     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  4036                                                                  ELCDTERX
  4037******************************************************************ELCDTERX
  4038*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  4039*          WARNING MESSAGES.                                      ELCDTERX
  4040******************************************************************ELCDTERX
  4041     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  4042         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  4043                                                                  ELCDTERX
  4044     OPEN INPUT DISK-DATE.                                        ELCDTERX
  4045                                                                  ELCDTERX
  4046     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  4047                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  4048                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  4049                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  4050                   CLAX-ID           CLAS-MISC                    ELCDTERX
  4051                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  4052                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  4053                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  4054                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  4055                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  4056                                                                  ELCDTERX
  4057     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  4058                                                                  ELCDTERX
  4059     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  4060                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  4061                                                                  ELCDTERX
  4062     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  4063     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  4064     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  4065     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  4066                                                                  ELCDTERX
  4067     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  4068         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  4069     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4070         ADD +1                 TO CLAS-CN.                       ELCDTERX
  4071                                                                  ELCDTERX
  4072     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  4073         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  4074     ELSE                                                         ELCDTERX
  4075         ADD +1                 TO CLAS-CO.                       ELCDTERX
  4076                                                                  ELCDTERX
  4077 0005-READ--CARD.                                                 ELCDTERX
  4078     READ DISK-DATE                                               ELCDTERX
  4079         AT END CLOSE DISK-DATE                                   ELCDTERX
  4080             GO TO 0060-READ--TEST.                               ELCDTERX
  4081                                                                  ELCDTERX
  4082     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  4083                                                                  ELCDTERX
  4084     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  4085         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  4086         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  4087         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  4088         GO TO 0005-READ--CARD.                                   ELCDTERX
  4089                                                                  ELCDTERX
  4090     IF DD-ID = 'CLAD'                                            ELCDTERX
  4091         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  4092         GO TO 0005-READ--CARD.                                   ELCDTERX
  4093                                                                  ELCDTERX
  4094     IF DD-ID = 'CLAX'                                            ELCDTERX
  4095         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  4096         GO TO 0005-READ--CARD.                                   ELCDTERX
  4097                                                                  ELCDTERX
  4098     IF DD-ID = 'CLAF'                                            ELCDTERX
  4099         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  4100         GO TO 0005-READ--CARD.                                   ELCDTERX
  4101                                                                  ELCDTERX
  4102     IF DD-ID = 'CLAC'                                            ELCDTERX
  4103         GO TO 0010-READ--CLAC.                                   ELCDTERX
  4104                                                                  ELCDTERX
  4105     IF DD-ID = 'CARR'                                            ELCDTERX
  4106         GO TO 0015-READ--CARR.                                   ELCDTERX
  4107                                                                  ELCDTERX
  4108     IF DD-ID = 'STAT'                                            ELCDTERX
  4109         GO TO 0020-READ--STAT.                                   ELCDTERX
  4110                                                                  ELCDTERX
  4111     IF DD-ID = 'BUSC'                                            ELCDTERX
  4112         GO TO 0025-READ--BUSC.                                   ELCDTERX
  4113                                                                  ELCDTERX
  4114     IF DD-ID = 'MORT'                                            ELCDTERX
  4115         GO TO 0030-READ--MORT.                                   ELCDTERX
  4116                                                                  ELCDTERX
  4117     IF DD-ID = 'CLAI'                                            ELCDTERX
  4118         GO TO 0040-READ--CLAI.                                   ELCDTERX
  4119                                                                  ELCDTERX
  4120     IF DD-ID = 'COLC'                                            ELCDTERX
  4121         GO TO 0065-READ--COLC.                                   ELCDTERX
  4122                                                                  ELCDTERX
  4123     IF DD-IDX NUMERIC AND                                        ELCDTERX
  4124        DD-IDA = 'CL'                                             ELCDTERX
  4125         GO TO 0035-READ--CLXX.                                   ELCDTERX
  4126                                                                  ELCDTERX
  4127     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4128        DD-IDA = 'PO'                                             ELCDTERX
  4129         GO TO 0050-READ--POXX.                                   ELCDTERX
  4130                                                                  ELCDTERX
  4131     IF DD-ID = 'OPCA'                                            ELCDTERX
  4132         GO TO 0070-READ--OPCA.                                   ELCDTERX
  4133                                                                  ELCDTERX
  4134     IF DD-ID = 'OPST'                                            ELCDTERX
  4135         GO TO 0072-READ--OPST.                                   ELCDTERX
  4136                                                                  ELCDTERX
  4137     IF DD-ID = 'OPBS'                                            ELCDTERX
  4138         GO TO 0074-READ--OPBS.                                   ELCDTERX
  4139                                                                  ELCDTERX
  4140     IF DD-ID = 'OPMS'                                            ELCDTERX
  4141         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  4142                                                                  ELCDTERX
  4143     GO TO 0005-READ--CARD.                                       ELCDTERX
  4144                                                                  ELCDTERX
  4145 0010-READ--CLAC.                                                 ELCDTERX
  4146     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4147     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4148     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4149     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4150     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4151     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4152     GO TO 0005-READ--CARD.                                       ELCDTERX
  4153                                                                  ELCDTERX
  4154 0015-READ--CARR.                                                 ELCDTERX
  4155     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4156     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4157        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  4158        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4159        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  4160        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4161        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4162        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4163        MOVE DD-CARR1-SECPAY-SW
  4164                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4165     END-IF
  4166                                                                  ELCDTERX
  4167     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4168     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4169        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  4170        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4171        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  4172        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4173        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4174        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4175        MOVE DD-CARR2-SECPAY-SW
  4176                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4177     END-IF
  4178                                                                  ELCDTERX
  4179                                                                  ELCDTERX
  4180     GO TO 0005-READ--CARD.                                       ELCDTERX
  4181                                                                  ELCDTERX
  4182 0020-READ--STAT.                                                 ELCDTERX
  4183     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4184     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4185        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4186         GO TO 0005-READ--CARD.                                   ELCDTERX
  4187                                                                  ELCDTERX
  4188     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  4189     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  4190     GO TO 0020-READ--STAT.                                       ELCDTERX
  4191                                                                  ELCDTERX
  4192 0025-READ--BUSC.                                                 ELCDTERX
  4193     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4194     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4195        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  4196         GO TO 0005-READ--CARD.                                   ELCDTERX
  4197                                                                  ELCDTERX
  4198     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  4199     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  4200     GO TO 0025-READ--BUSC.                                       ELCDTERX
  4201                                                                  ELCDTERX
  4202 0030-READ--MORT.                                                 ELCDTERX
  4203     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4204     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4205        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  4206         GO TO 0005-READ--CARD.                                   ELCDTERX
  4207                                                                  ELCDTERX
  4208     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  4209     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  4210     GO TO 0030-READ--MORT.                                       ELCDTERX
  4211                                                                  ELCDTERX
  4212 0035-READ--CLXX.                                                 ELCDTERX
  4213     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  4214          GO TO 0005-READ--CARD.                                  ELCDTERX
  4215                                                                  ELCDTERX
  4216     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  4217         DISPLAY '***********************************************'ELCDTERX
  4218         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  4219         DISPLAY '***********************************************'ELCDTERX
  4220         GO TO 0055-READ--STOP.                                   ELCDTERX
  4221                                                                  ELCDTERX
  4222     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  4223        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  4224         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  4225                                                                  ELCDTERX
  4226     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  4227        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  4228         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  4229                                                                  ELCDTERX
  4230*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  4231     GO TO 0005-READ--CARD.                                       ELCDTERX
  4232                                                                  ELCDTERX
  4233 0040-READ--CLAI.                                                 ELCDTERX
  4234     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4235     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4236        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  4237         GO TO 0005-READ--CARD.                                   ELCDTERX
  4238                                                                  ELCDTERX
  4239     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  4240     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  4241     GO TO 0040-READ--CLAI.                                       ELCDTERX
  4242                                                                  ELCDTERX
  4243 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4244     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  4245     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  4246                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  4247     PERFORM ABEND-PGM.                                           ELCDTERX
  4248                                                                  ELCDTERX
  4249 0050-READ--POXX.                                                 ELCDTERX
  4250     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  4251         GO TO 0005-READ--CARD.                                   ELCDTERX
  4252                                                                  ELCDTERX
  4253     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  4254         DISPLAY '***********************************************'ELCDTERX
  4255         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  4256         DISPLAY '***********************************************'ELCDTERX
  4257         GO TO 0055-READ--STOP.                                   ELCDTERX
  4258                                                                  ELCDTERX
  4259     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  4260     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  4261     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  4262     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  4263                                                                  ELCDTERX
  4264     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  4265         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  4266     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  4267         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  4268                                                                  ELCDTERX
  4269     GO TO 0005-READ--CARD.                                       ELCDTERX
  4270                                                                  ELCDTERX
  4271 0055-READ--STOP.                                                 ELCDTERX
  4272     GOBACK.                                                      ELCDTERX
  4273                                                                  ELCDTERX
  4274 0060-READ--TEST.                                                 ELCDTERX
  4275     IF DATX-COD        = SPACE  OR                               ELCDTERX
  4276        CLAX-ID         = SPACE  OR                               ELCDTERX
  4277        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  4278         GO TO 0045-READ--DUMP.                                   ELCDTERX
  4279                                                                  ELCDTERX
  4280     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  4281     GO TO 0079-READ--EXIT.                                       ELCDTERX
  4282                                                                  ELCDTERX
  4283 0065-READ--COLC.                                                 ELCDTERX
  4284     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  4285     GO TO 0005-READ--CARD.                                       ELCDTERX
  4286                                                                  ELCDTERX
  4287 0070-READ--OPCA.                                                 ELCDTERX
  4288                                                                  ELCDTERX
  4289     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4290                                                                  ELCDTERX
  4291     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  4292             OR                                                   ELCDTERX
  4293         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  4294         GO TO 0005-READ--CARD.                                   ELCDTERX
  4295                                                                  ELCDTERX
  4296     ADD 1                       TO INDEXCA.                      ELCDTERX
  4297     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  4298                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  4299     GO TO 0070-READ--OPCA.                                       ELCDTERX
  4300                                                                  ELCDTERX
  4301 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4302                                                                  ELCDTERX
  4303     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4304                                                                  ELCDTERX
  4305     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  4306             OR                                                   ELCDTERX
  4307         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4308         GO TO 0005-READ--CARD.                                   ELCDTERX
  4309                                                                  ELCDTERX
  4310     ADD 1                       TO INDEXST.                      ELCDTERX
  4311     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  4312                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  4313     GO TO 0072-READ--OPST.                                       ELCDTERX
  4314                                                                  ELCDTERX
  4315 0074-READ--OPBS.                                                 ELCDTERX
  4316                                                                  ELCDTERX
  4317     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4318                                                                  ELCDTERX
  4319     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  4320             OR                                                   ELCDTERX
  4321         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4322         GO TO 0005-READ--CARD.                                   ELCDTERX
  4323                                                                  ELCDTERX
  4324     ADD 1                       TO INDEXBS.                      ELCDTERX
  4325     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  4326     GO TO 0074-READ--OPBS.                                       ELCDTERX
  4327                                                                  ELCDTERX
  4328 0079-READ--EXIT.                                                 ELCDTERX
  4329*    EXIT.                                                        ELCDTERX
  4330******************************************************************ELCDTERX
  4331
  4332     MOVE BIN-RUN-DATE           TO  WS-EOM-DT.
  4333
  4334     MOVE WS-TIME                TO ME-START-TIME.
  4335     MOVE WS-CURRENT-DATE        TO ME-START-DATE.
  4336     MOVE ME-START-MO            TO ME-CNDS-MO.
  4337     MOVE ME-START-DA            TO ME-CNDS-DA.
  4338     MOVE ME-START-YR            TO ME-CNDS-YR.
  4339
  4340     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  4341
  4342     IF DTE-CLIENT = 'CID'
  4343         MOVE 'CILG331'          TO  WS-ME50-BAL-JOB
  4344     ELSE
  4345       IF DTE-CLIENT = 'AHL'
  4346         MOVE 'AHLG331'          TO  WS-ME50-BAL-JOB
  4347       ELSE
  4348         MOVE 'CIDCLG331'        TO  WS-ME50-BAL-JOB
  4349       END-IF
  4350     END-IF.
  4351
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* EL331.cbl
  4353
  4354 0000-MAINLINE.
  4355
  4356     PERFORM 7000-INITIALIZE    THRU 7000-EXIT.
  4357
  4358     PERFORM 2000-PROCESS-CERT  THRU 2000-EXIT
  4359         UNTIL NO-MORE-RECORDS OR
  4360               IO-ERROR-OCCURRED.
  4361
  4362     PERFORM 8000-FINALIZE THRU 8000-EXIT.
  4363
  4364     IF DTE-CLIENT EQUAL 'JAL' OR 'JAI'
  4365        DISPLAY ' CERTS WITHOUT PREM ...' NO-PREM-CT
  4366        DISPLAY ' CERTS WITHOUT PLANS ..' NO-PLAN-CODE-CT.
  4367
  4368     display ' epiq certs ' ws-epiq-cert-added
  4369
  4370     .
  4371 0000-EXIT.
  4372
  4373****************************************************************
  4374*     OPEN I/O (ERMEBL)   MONTH END BALANCE FILE ACCESSED      *
  4375*     THRU ME-CONTROL-PRIMARY.  STATISTICS FOR EL331 UPDATED   *
  4376*     IN MONTH-END RECORD EACH TIME RUN.                       *
  4377****************************************************************
  4378
  4379     OPEN I-O ERMEBL.
  4380
  4381     IF ERMEBL-FILE-STATUS NOT = ZERO AND '97'
  4382         MOVE 'N'                TO ME-UPDATE-FLAG.
  4383
  4384     MOVE DTE-CLIENT             TO ME-COMPANY.
  4385     MOVE MONTH-END-MOYR         TO ME-MOYR.
  4386
  4387     IF ME-DO-UPDATE
  4388         READ ERMEBL INVALID KEY
  4389         MOVE 'N'                TO ME-UPDATE-FLAG
  4390         CLOSE ERMEBL.
  4391
  4392     IF ME-DO-UPDATE
  4393*        MOVE ME-START-TIME      TO ME-331-START
  4394         MOVE ME-CNDS-DATE       TO ME-331-RUN-DT
  4395         ACCEPT WS-TIME-OF-DAY   FROM  TIME
  4396*        MOVE WS-TIME            TO ME-331-END
  4397         ADD 1                   TO ME-331-RUN-CT
  4398         MOVE 1                  TO ME-331-FLAG
  4399         REWRITE MONTH-END-BALANCES
  4400         CLOSE ERMEBL.
  4401
  4402     GOBACK.
  4403
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* EL331.cbl
  4405******************************************************************
  4406*  PROCESSING FLOW BASED UPON CERT CONTROL COMPARISON:           *
  4407*                                                                *
  4408* 1) ECS (BATCH CERT CONTROL) GREATER  ONL (ONLINE CERT CONTROL) *
  4409*    2300-PROCESS-N-READ-ONL                                     *
  4410*        2330-FIND-ASSOCIATED-CLAIM                              *
  4411*                                                                *
  4412*            -NO CLAIMS  7320-BLD-ONL-PRT-LINE                   *
  4413*                        7350-BLD-CLM-INFO                       *
  4414*                        7370-PRINT-DETAIL                       *
  4415*                        2280-DELETE-ERMAIL                      *
  4416*                        2270-DELETE-ERCOMM                      *
  4417*                        DELETE ONLINE CERT MASTER               *
  4418*                                                                *
  4419*            -CLAIMS     REWRITE ONLINE CERT MASTER              *
  4420*                        7320-BLD-ONL-PRT-LINE                   *
  4421*                        7350-BLD-CLM-INFO                       *
  4422*                        7370-PRINT-DETAIL                       *
  4423*                                                                *
  4424* 2) ECS (BATCH CERT CONTROL) EQUAL  ONL (ONLINE CERT CONTROL)   *
  4425*    2500-PROCESS-MATCHING                                       *
  4426*        2330-FIND-ASSOCIATED-CLAIM                              *
  4427*                                                                *
  4428*            -NO CLAIMS  2600-REWRITE-CERT                       *
  4429*                        REBUILDS ONLINE CERT FROM BATCH CERT    *
  4430*                                                                *
  4431*            -CLAIMS     2510-BUILD-PRINT (REFLECTS ACTIVITY)    *
  4432*                        2600-REWRITE-CERT                       *
  4433*                        REBUILDS ONLINE CERT FROM BATCH CERT    *
  4434*                                                                *
  4435* 3) ONL (ONLINE CERT CONTROL) GREATER  ECS (BATCH CERT CONTROL) *
  4436*    2800-ADD-NEW-CERT                                           *
  4437*        2830-MOVE-DATA                                          *
  4438*        2820-BUILD-NEW-KEY                                      *
  4439*        2200-MATCH-ACCT                                         *
  4440*        WRITE ONLINE CERT MASTER                                *
  4441******************************************************************
  4442
  4443 2000-PROCESS-CERT.
  4444
  4445     PERFORM 2100-READ-ECS-RECORDS   THRU 2100-EXIT.
  4446
  4447     IF WS-SAVED-ECS-KEY GREATER WS-SAVED-ONL-KEY
  4448         MOVE SPACES             TO WS-ONL-GE-SW
  4449         PERFORM 2300-PROCESS-N-READ-ONL THRU 2300-EXIT
  4450         UNTIL ONL-KEY-EQUAL-OR-GREATER.
  4451
  4452     IF NO-MORE-ECS-RECORDS  AND  NO-MORE-ONL-RECORDS
  4453          MOVE  'X'              TO WS-ALL-END-SW
  4454          GO TO 2000-EXIT.
  4455
  4456     IF WS-SAVED-ONL-KEY EQUAL WS-SAVED-ECS-KEY
  4457        PERFORM 2500-PROCESS-MATCHING  THRU 2500-EXIT.
  4458
  4459     if (ws-saved-onl-key > ws-saved-ecs-key)
  4460                  AND
  4461        ((not do-not-load)
  4462         or (CR-TEMP-EPIQ = 'EPIQ'))
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* EL331.cbl
  4463        ADD +1                   TO WS-LOADED-ECS
  4464        perform 2800-add-new-cert thru 2800-exit
  4465     end-if
  4466
  4467     .
  4468 2000-EXIT.
  4469      EXIT.
  4470
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* EL331.cbl
  4472*****************************************************************
  4473*  2100-READ-ECS-RECORDS                                        *
  4474*****************************************************************
  4475*  READ BATCH CERTIFICATE MASTER RECORD AND CALCULATE AN EXPIRY *
  4476*  DATE BASED UPON ISSUE DATE, COVERAGE TERM, CERTIFICATE TYPE, *
  4477*  AND ANY CLAIM ACTIVITY. THIS COMPUTED DATE IS COMPARED WITH  *
  4478*  THE RUN DATE PROVIDED THRU THE DATE CARD LOAD TO DETERMINE   *
  4479*  IF THE CERTIFICATE WILL BE LOADED BACK TO ONLINE. BENEFIT    *
  4480*  TYPES OF UNEXPIRED CERTS ARE VALIDATED AGAINST THE BENEFIT   *
  4481*  TABLE.                                                       *
  4482*  EXPIRY DATE EQUAL :                                          *
  4483*      1) CLAIMS PAID (EFFECTIVE DATE + LONGEST TERM + 36)      *
  4484*      2) NO CLAIMS   (EFFECTIVE DATE + LONGEST TERM + 12)      *
  4485*      3) O.B. CERTS  (EFFECTIVE DATE + LONGEST TERM + 36)      *
  4486*****************************************************************
  4487
  4488 2100-READ-ECS-RECORDS.
  4489
  4490     IF NO-MORE-ECS-RECORDS
  4491         GO TO 2100-EXIT.
  4492
  4493     READ ECSCRT01  AT END
  4494         MOVE 'X'                TO WS-ECS-END-SW
  4495         MOVE HIGH-VALUES        TO WS-SAVED-ECS-KEY
  4496         GO TO 2100-EXIT.
  4497
  4498     ADD  1                      TO WS-ECS-READ.
  4499     move spaces                 to ws-cert-load-sw
  4500
  4501     IF  CR-LF-CANCEL-EXIT-DATE  NOT NUMERIC
  4502          MOVE ZEROS             TO CR-LF-CANCEL-EXIT-DATE.
  4503
  4504     IF  CR-AH-CANCEL-EXIT-DATE  NOT NUMERIC
  4505          MOVE ZEROS             TO CR-AH-CANCEL-EXIT-DATE.
  4506
  4507     IF  CR-LF-CLAIM-EXIT-DATE  NOT NUMERIC
  4508          MOVE ZEROS             TO CR-LF-CLAIM-EXIT-DATE.
  4509
  4510     IF  CR-AH-SETTLEMENT-EXIT-DATE  NOT NUMERIC
  4511          MOVE ZEROS             TO CR-AH-SETTLEMENT-EXIT-DATE.
  4512
* 4513     COPY ELCCRTM1.
  4514******************************************************************04/15/98
  4515*                                                                *ELCCRTM1
  4516*                                                                *ELCCRTM1
  4517*                            ELCCRTM1                            *   LV003
  4518*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4519*                            VMOD=2.001                          *ELCCRTM1
  4520*                                                                *ELCCRTM1
  4521*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4522*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4523*                                                                *ELCCRTM1
  4524******************************************************************ELCCRTM1
  4525     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4526     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4527     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4528     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4529     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
  4530     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  4531     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4532     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4533     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4534                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4535     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  4536                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4537     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4538     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4539     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4540     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4541     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4542     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4543           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4544                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4545     END-PERFORM.                                                 ELCCRTM1
  4546                                                                  ELCCRTM1
  4547
  4548     IF DTE-CLIENT EQUAL 'HAN'
  4549        IF CR-GROUPING NOT EQUAL '010184'
  4550           MOVE CR-LNAME            TO WS-EFF-ACT-NAME
  4551           MOVE CR-ACCOUNT          TO WS-HAN-ACCOUNT
  4552           IF WS-NAME-EFF-DT NUMERIC
  4553              MOVE WS-HAN-ACCT-4-10 TO WS-NAME-ACCT
  4554*             MOVE CR-ACCOUNT       TO WS-NAME-ACCT
  4555              MOVE SPACES           TO WS-NAME-FILL
  4556              MOVE WS-EFF-ACT-NAME  TO CR-LNAME.
  4557
  4558     IF DTE-CLIENT EQUAL 'HAN'
  4559        IF CR-GROUPING EQUAL '010184'
  4560           MOVE CR-LNAME            TO WS-HI-LAST-NAME
  4561           MOVE CR-CERT-PRIME       TO WS-HI-CERT-4-10
  4562           MOVE WS-HI-LAST-NAME     TO CR-LNAME.
  4563
  4564     IF CR-LF-TERM NOT EQUAL ZERO
  4565         MOVE CR-LF-TERM         TO WS-WORK-TERM.
  4566
  4567     IF (CR-AH-TERM NOT EQUAL ZERO) AND
  4568        ((CR-AH-TERM GREATER CR-LF-TERM) OR
  4569         (WS-WORK-TERM EQUAL ZERO))
  4570           MOVE CR-AH-TERM       TO WS-WORK-TERM.
  4571
  4572     IF (CR-DTH-DT NOT EQUAL ZERO)
  4573        or (CR-DIS-DT NOT EQUAL ZERO)
  4574            COMPUTE WS-EXPIRE-MOS EQUAL
  4575                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 36
  4576       ELSE
  4577            COMPUTE WS-EXPIRE-MOS EQUAL
  4578                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 12.
  4579
  4580     IF WS-WORK-TERM EQUAL +1
  4581            COMPUTE WS-EXPIRE-MOS EQUAL
  4582                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 36.
  4583
  4584     IF DTE-CLIENT = 'LAP'  OR  'RMC'
  4585            COMPUTE WS-EXPIRE-MOS EQUAL
  4586                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 36.
  4587
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* EL331.cbl
  4588     IF DTE-CLIENT = 'CID'
  4589        IF (CR-ENTRY-BATCH (1:2) = 'BL' OR 'VA')
  4590           OR (CR-LF-EXIT-BATCH (1:2) = 'BL' OR 'VA')
  4591           OR (CR-AH-EXIT-BATCH (1:2) = 'BL' OR 'VA')
  4592           COMPUTE WS-EXPIRE-MOS =
  4593              (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 300
  4594        END-IF
  4595     END-IF
  4596
  4597     IF DTE-CLIENT = 'AHL'
  4598        COMPUTE WS-EXPIRE-MOS =
  4599           (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 300
  4600     END-IF
  4601
  4602     IF WS-EXPIRE-MOS < WS-CURRENT-MOS
  4603        IF (CR-ENTRY-CCYY = RUN-CCYY)
  4604           and (CR-ENTRY-MO = RUN-MO)
  4605           continue
  4606        ELSE
  4607           set do-not-load        to true
  4608        end-if
  4609     end-if
  4610
  4611     IF WS-EXPIRE-MOS LESS WS-CURRENT-MOS
  4612       IF DTE-CLIENT NOT = 'LGX' and 'CID' and 'DCC'
  4613           IF CR-ENTRY-CCYY = RUN-CCYY AND
  4614              CR-ENTRY-MO = RUN-MO
  4615               NEXT SENTENCE
  4616           ELSE
  4617               ADD 1 TO WS-INACTIVE-CERTS
  4618               GO TO 2100-READ-ECS-RECORDS.
  4619
  4620     PERFORM 2120-SAVE-ECS-KEY  THRU 2120-EXIT.
  4621
  4622     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  4623     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  4624
  4625 2100-LF-TYPE.
  4626
  4627     IF CR-LFTYP EQUAL ZERO
  4628         GO TO 2100-AH-TYPE.
  4629
  4630     IF CLAS-INDEXL GREATER CLAS-MAXL
  4631         DISPLAY LIFE-OVERRIDE-L6
  4632                 ' BENEFIT TYPE NOT FOUND IN TABLE EQUAL ',
  4633                 CR-LFTYP
  4634         MOVE 'BENEFIT TYPE NOT FOUND (SEE DISPLAY)'
  4635                                 TO WS-ABEND-MESSAGE
  4636         GO TO ABEND-PGM.
  4637
  4638     IF CR-LFTYP EQUAL CLAS-I-BEN (CLAS-INDEXL)
  4639         GO TO 2100-AH-TYPE.
  4640
  4641     ADD +1                      TO CLAS-INDEXL.
  4642     GO TO 2100-LF-TYPE.
  4643
  4644 2100-AH-TYPE.
  4645
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* EL331.cbl
  4646     IF CR-AHTYP EQUAL ZERO
  4647        GO TO 2100-EXIT.
  4648
  4649     IF CLAS-INDEXA GREATER CLAS-MAXA
  4650         DISPLAY AH-OVERRIDE-L6
  4651                 ' BENEFIT TYPE NOT FOUND IN TABLE EQUAL ',
  4652                 CR-AHTYP
  4653         MOVE 'BENEFIT TYPE NOT FOUND (SEE DISPLAY)'
  4654                                 TO WS-ABEND-MESSAGE
  4655         GO TO ABEND-PGM.
  4656
  4657     IF CR-AHTYP EQUAL CLAS-I-BEN (CLAS-INDEXA)
  4658            GO TO 2100-EXIT.
  4659
  4660     ADD +1                      TO CLAS-INDEXA.
  4661     GO TO 2100-AH-TYPE.
  4662
  4663 2100-EXIT.
  4664      EXIT.
  4665
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* EL331.cbl
  4667****************************************************
  4668*  2120-SAVE-ECS-KEY                               *
  4669****************************************************
  4670*  SAVE BATCH CERT MASTER KEY IN WS-SAVED-ECS-KEY  *
  4671****************************************************
  4672
  4673 2120-SAVE-ECS-KEY.
  4674
  4675     MOVE DTE-CLASIC-COMPANY-CD  TO WS-SAVED-B-COMP.
  4676     MOVE CR-CARRIER             TO WS-SAVED-B-CARR.
  4677     MOVE CR-GROUPING            TO WS-SAVED-B-GRPG.
  4678     MOVE CR-STATE               TO WS-SAVED-B-STAT.
  4679     MOVE CR-ACCOUNT             TO WS-SAVED-B-ACCT.
  4680     MOVE CR-CERT-NO             TO WS-SAVED-B-CERT.
  4681     MOVE CR-DT                  TO WS-SAVED-B-DATE
  4682                                    DC-GREG-DATE-CYMD.
  4683
  4684     MOVE 'L'                    TO DC-OPTION-CODE.
  4685     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  4686     MOVE DC-BIN-DATE-1          TO BIN-CR-DT.
  4687
  4688 2120-EXIT.
  4689      EXIT.
  4690
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* EL331.cbl
  4692****************************************************
  4693*  2200-MATCH-ACCT                                 *
  4694****************************************************
  4695*  IF ONLINE BILLING OPTION IS USED RETRIEVE THE   *
  4696*  ACCOUNT MASTER FILE RECORD ASSOCIATED WITH THE  *
  4697*  CERTIFICATE BEING PROCESSED. IF A MATCH OCCURS, *
  4698*  THE COMPENSATION STRUCTURES BETWEEN THE TWO     *
  4699*  RECORDS ARE COMPARED, IF ANY DIFFERENCES ARE    *
  4700*  DETECTED A COMPENSATION EXCEPTION RECORD IS     *
  4701*  CREATED. THIS RECORD WILL CONTAIN THE ORIGINAL  *
  4702*  COMPENSATION STRUCTURE THE CERTIFICATE WAS      *
  4703*  ISSUED UNDER.                                   *
  4704****************************************************
  4705
  4706 2200-MATCH-ACCT.
  4707     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  4708        DTE-SYS-G-AR-USED     EQUAL '1'
  4709         NEXT SENTENCE
  4710     ELSE
  4711         GO TO 2200-EXIT.
  4712
  4713     IF NO-MORE-ACT-RECORDS
  4714         GO TO 2200-EXIT.
  4715
  4716     IF CR-ACCT-CONTROL GREATER AM-CONTROL-A
  4717        PERFORM 2260-READ-ACCT THRU 2260-EXIT
  4718        GO TO 2200-MATCH-ACCT.
  4719
  4720     IF CR-ACCT-CONTROL LESS AM-CONTROL-A
  4721        GO TO 2200-EXIT.
  4722
  4723     IF BIN-CR-DT LESS AM-EFFECTIVE-DT  OR
  4724        BIN-CR-DT NOT LESS AM-EXPIRATION-DT
  4725           PERFORM 2260-READ-ACCT THRU 2260-EXIT
  4726           GO TO 2200-MATCH-ACCT.
  4727
  4728****************************************************
  4729*  MATCHED  *  CHECK COMPENSATION STRUCTURE        *
  4730****************************************************
  4731
  4732     IF NOT CR-POLICY-IS-DECLINED  AND
  4733        NOT CR-POLICY-IS-VOID      AND
  4734        NOT CR-POLICY-IS-REIN-ONLY
  4735         ADD 1 TO WS-ACCT-MATCH
  4736         PERFORM 2210-MATCH-LEVELS THRU 2250-EXIT.
  4737
  4738 2200-EXIT.
  4739      EXIT.
  4740
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* EL331.cbl
  4742****************************************************
  4743*  2210-MATCH-LEVELS.                              *
  4744****************************************************
  4745*  THE COMPENSATION STRUCTURES BETWEEN THE TWO     *
  4746*  RECORDS ARE COMPARED, IF ANY DIFFERENCES ARE    *
  4747*  DETECTED A COMPENSATION EXCEPTION RECORD        *
  4748*  IS CREATED. THIS RECORD WILL CONTAIN THE ORIG-  *
  4749*  INAL COMPENSATION STRUCTURE THE CERTIFICATE WAS *
  4750*  ISSUED UNDER.                                   *
  4751*                                                  *
  4752*  AM-COM-TYP =   O (OVERWRITE COMMISSION ON GROSS *
  4753*                  BUSINESS ONLY)                  *
  4754*                                                  *
  4755*  AM-COM-TYP =   P (OVERWRITE COMMISSION ON GROSS *
  4756*                  AND REINSURANCE BUSINESS)       *
  4757****************************************************
  4758
  4759 2210-MATCH-LEVELS.
  4760
  4761     MOVE 1                      TO NDX.
  4762     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  4763     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  4764     PERFORM 2100-LF-TYPE  THRU  2100-EXIT.
  4765
  4766 2220-GET-NEXT-LEVEL.
  4767
  4768     IF CR-AGT-TYPE (NDX)  =  AM-COM-TYP (NDX)
  4769         IF (AM-COM-TYP (NDX) NOT EQUAL 'O' AND 'P'
  4770              AND 'G' AND 'B' AND 'S')
  4771             GO TO 2230-GET-NEXT.
  4772
  4773     IF (AM-J-COM (NDX) NOT NUMERIC)   OR
  4774        (AM-L-COM (NDX) NOT NUMERIC)   OR
  4775        (AM-A-COM (NDX) NOT NUMERIC)
  4776          NEXT SENTENCE
  4777     ELSE
  4778          MOVE AM-L-COM (NDX)    TO  WS-L-COM
  4779          MOVE AM-J-COM (NDX)    TO  WS-J-COM
  4780          MOVE AM-A-COM (NDX)    TO  WS-A-COM
  4781          GO TO 2225-CHECK-NUMERIC.
  4782
  4783     IF CR-LFTYP = ZERO
  4784         GO TO 2224-CHECK-AH-TABLE.
  4785
  4786     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
  4787         GO TO 2221-JOINT-LIFE-COMM.
  4788
  4789     IF AM-L-COM (NDX) NUMERIC
  4790         MOVE AM-L-COM (NDX)    TO  WS-L-COM
  4791         GO TO 2224-CHECK-AH-TABLE.
  4792
  4793     MOVE AM-L-COMA (NDX)        TO  WS-CTBL-TABLE.
  4794     MOVE LIFE-OVERRIDE-L1       TO  WS-CTBL-BEN-TYPE.
  4795     MOVE CR-LFTYP               TO  WS-CTBL-BEN-CODE.
  4796     MOVE CR-LFAMT               TO  WS-COMM-CK-AMT.
  4797     MOVE CR-LF-TERM             TO  WS-CK-TERM.
  4798     MOVE CR-AGE                 TO  WS-CK-AGE.
  4799     PERFORM  2249-CTBL-PROCESS  THRU  2249-READ-CTBL-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* EL331.cbl
  4800     MOVE CT-RT (CINDX)          TO  WS-L-COM.
  4801     GO TO 2224-CHECK-AH-TABLE.
  4802
  4803 2221-JOINT-LIFE-COMM.
  4804
  4805     IF AM-J-COM (NDX) NUMERIC
  4806         MOVE AM-J-COM (NDX)    TO  WS-J-COM
  4807         GO TO 2224-CHECK-AH-TABLE.
  4808
  4809     MOVE AM-J-COMA (NDX)        TO  WS-CTBL-TABLE.
  4810     MOVE LIFE-OVERRIDE-L1       TO  WS-CTBL-BEN-TYPE.
  4811     MOVE CR-LFTYP               TO  WS-CTBL-BEN-CODE.
  4812     MOVE CR-LFAMT               TO  WS-COMM-CK-AMT.
  4813     MOVE CR-LF-TERM             TO  WS-CK-TERM.
  4814     MOVE CR-AGE                 TO  WS-CK-AGE.
  4815     PERFORM  2249-CTBL-PROCESS  THRU  2249-READ-CTBL-EXIT.
  4816     MOVE CT-RT (CINDX)          TO  WS-J-COM.
  4817
  4818 2224-CHECK-AH-TABLE.
  4819
  4820     IF CR-AHTYP = ZERO
  4821         GO TO 2225-CHECK-NUMERIC.
  4822
  4823     IF AM-A-COM (NDX) NUMERIC
  4824         MOVE AM-A-COM (NDX)     TO  WS-A-COM
  4825         GO TO 2225-CHECK-NUMERIC.
  4826
  4827     MOVE AM-A-COMA (NDX)        TO  WS-CTBL-TABLE.
  4828     MOVE AH-OVERRIDE-L1         TO  WS-CTBL-BEN-TYPE.
  4829     MOVE CR-AHTYP               TO  WS-CTBL-BEN-CODE.
  4830     MOVE CR-AHAMT               TO  WS-COMM-CK-AMT.
  4831     MOVE CR-AH-TERM             TO  WS-CK-TERM.
  4832     MOVE CR-AGE                 TO  WS-CK-AGE.
  4833     PERFORM  2249-CTBL-PROCESS  THRU  2249-READ-CTBL-EXIT.
  4834     MOVE CT-RT (CINDX)          TO  WS-A-COM.
  4835
  4836 2225-CHECK-NUMERIC.
  4837
  4838     IF DTE-CLIENT EQUAL 'WDS'
  4839        IF CR-COM-AGT (NDX) EQUAL '0000000001'
  4840           GO TO 2230-GET-NEXT.
  4841
  4842     IF (CR-COM-AGT  (NDX) NOT EQUAL AM-AGT (NDX)) OR
  4843        (CR-AGT-TYPE (NDX) NOT EQUAL AM-COM-TYP (NDX))
  4844           GO TO 2235-NO-MATCH.
  4845
  4846     IF CR-LFTYP EQUAL ZERO
  4847         NEXT SENTENCE
  4848     ELSE
  4849         IF ((CLAS-I-JOINT (CLAS-INDEXL) EQUAL 'J') AND
  4850             (CR-LCOM-L  (NDX) NOT EQUAL WS-J-COM ))
  4851         OR
  4852            ((CLAS-I-JOINT (CLAS-INDEXL) NOT EQUAL 'J') AND
  4853             (CR-LCOM-L  (NDX) NOT EQUAL WS-L-COM ))
  4854                 GO TO 2235-NO-MATCH.
  4855
  4856     IF CR-AHTYP EQUAL ZERO
  4857         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* EL331.cbl
  4858     ELSE
  4859         IF CR-LCOM-AH (NDX) NOT EQUAL WS-A-COM
  4860               GO TO 2235-NO-MATCH.
  4861
  4862 2230-GET-NEXT.
  4863
  4864     ADD 1                       TO NDX.
  4865
  4866     IF NDX GREATER 10
  4867        GO TO 2250-EXIT.
  4868
  4869     GO TO 2220-GET-NEXT-LEVEL.
  4870
  4871 2235-NO-MATCH.
  4872
  4873     MOVE SPACES                 TO COMMISSION-EXCEPTIONS.
  4874     MOVE 'CE'                   TO CE-RECORD-ID.
  4875     MOVE DTE-CLASIC-COMPANY-CD  TO CE-COMPANY-CD.
  4876     MOVE CR-CARRIER             TO CE-CARRIER.
  4877     MOVE CR-GROUPING            TO CE-GROUPING.
  4878     MOVE CR-STATE               TO CE-STATE.
  4879     MOVE CR-ACCOUNT             TO CE-ACCOUNT.
  4880
  4881     MOVE BIN-CR-DT              TO CE-CERT-EFF-DT.
  4882
  4883     MOVE CR-CERT-NO             TO CE-CERT-NO.
  4884     MOVE CR-COMPENSATION-LEVELS TO CE-COMP-STRUCTURE.
  4885
  4886     MOVE CR-LF-EXPIRE-DATE      TO DC-GREG-DATE-CYMD.
  4887
  4888     IF CR-LF-EXPIRE-DATE EQUAL ZERO
  4889          MOVE CR-AH-EXPIRE-DATE TO DC-GREG-DATE-CYMD.
  4890
  4891     MOVE 'L'                    TO DC-OPTION-CODE.
  4892     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  4893     MOVE DC-BIN-DATE-1          TO CE-CERT-EXPIRATION-DT.
  4894
  4895     WRITE COMMISSION-EXCEPTIONS.
  4896
  4897     IF CE-STATUS EQUAL '22'
  4898         GO TO 2245-SKIP-DUP.
  4899
  4900     IF CE-STAT-1  NOT EQUAL ZERO
  4901         MOVE CE-STATUS          TO  WS-ABEND-FILE-STATUS
  4902         MOVE 'ERROR OCCURED WRITE - ERCOMM'
  4903                                 TO  WS-ABEND-MESSAGE
  4904         GO TO ABEND-PGM.
  4905
  4906 2245-SKIP-DUP.
  4907
  4908     MOVE '1'                    TO CM-COMP-EXCP-SW.
  4909     ADD 1                       TO WS-EXCP-ADD.
  4910     GO TO 2250-EXIT.
  4911
  4912 2249-CTBL-PROCESS.
  4913
  4914     IF WS-CTBL-KEY = WS-LAST-CTBL-KEY
  4915         GO TO 2249-SEARCH-TABLE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* EL331.cbl
  4916
  4917     MOVE DTE-CLASIC-COMPANY-CD  TO  WS-CTBL-COMP-CD.
  4918
  4919 2249-READ-CTBL.
  4920
  4921     MOVE WS-CTBL-KEY            TO  CT-CONTROL-PRIMARY
  4922                                     WS-LAST-CTBL-KEY.
  4923
  4924     READ ERCTBL.
  4925
  4926     IF ERCTBL-FILE-STATUS     = '97'
  4927        MOVE '00' TO ERCTBL-FILE-STATUS.
  4928
  4929     IF ERCTBL-FILE-STATUS NOT = '00'
  4930        ADD  +1  TO  ERROR-COUNT
  4931***1**
  4932        MOVE 'ERCTBL-FILE-STATUS IS = ' TO DIS-LINE-REASON
  4933        MOVE ERCTBL-FILE-STATUS         TO DIS-LINE-REC
  4934        PERFORM 8600-DISPLAY-PRT THRU
  4935              8600-DISPLAY-EXIT
  4936***2**
  4937        MOVE 'WS-CTBL-KEY        IS = ' TO DIS-LINE-REASON
  4938        MOVE  WS-CTBL-KEY               TO DIS-LINE-REC
  4939        PERFORM 8600-DISPLAY-PRT THRU
  4940              8600-DISPLAY-EXIT
  4941***3**
  4942        MOVE 'CM-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4943        MOVE  CM-CONTROL-PRIMARY        TO DIS-LINE-REC
  4944        PERFORM 8600-DISPLAY-PRT THRU
  4945              8600-DISPLAY-EXIT
  4946***4**
  4947        MOVE 'CE-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4948        MOVE  CE-CONTROL-PRIMARY        TO DIS-LINE-REC
  4949        PERFORM 8600-DISPLAY-PRT THRU
  4950              8600-DISPLAY-EXIT
  4951***5**
  4952        MOVE 'AM-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4953        MOVE  AM-CONTROL-PRIMARY        TO DIS-LINE-REC
  4954        PERFORM 8600-DISPLAY-PRT THRU
  4955              8600-DISPLAY-EXIT
  4956***6**
  4957        MOVE 'CL-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4958        MOVE  CL-CONTROL-PRIMARY        TO DIS-LINE-REC
  4959        PERFORM 8600-DISPLAY-PRT THRU
  4960              8600-DISPLAY-EXIT
  4961***7**
  4962        MOVE  SPACES                    TO DIS-LINE-REASON
  4963        MOVE  SPACES                    TO DIS-LINE-REC
  4964        PERFORM 8600-DISPLAY-PRT THRU
  4965              8600-DISPLAY-EXIT
  4966
  4967         MOVE 'ERROR OCCURRED READ - ERCTBL'
  4968                                 TO  WS-ABEND-MESSAGE
  4969         MOVE ERCTBL-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  4970         DISPLAY 'WS-CTBL-KEY = ' WS-CTBL-KEY
  4971         GO TO 2100-READ-ECS-RECORDS.
  4972*        GO TO ABEND-PGM.
  4973
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* EL331.cbl
  4974 2249-SEARCH-TABLE.
  4975
  4976      MOVE +1                    TO  CINDX.
  4977
  4978      IF  WS-COMM-CK-AMT GREATER THAN CT-TBF (1)
  4979          ADD +9 TO CINDX
  4980          IF WS-COMM-CK-AMT GREATER THAN CT-TBF (2)
  4981              ADD +9 TO CINDX.
  4982
  4983      IF WS-CK-AGE GREATER THAN CT-AGE (1)
  4984          ADD +3 TO CINDX
  4985          IF WS-CK-AGE GREATER THAN CT-AGE (2)
  4986              ADD +3 TO CINDX.
  4987
  4988      IF WS-CK-TERM GREATER THAN CT-TRM (1)
  4989          ADD +1 TO CINDX
  4990          IF WS-CK-TERM GREATER THAN CT-TRM (2)
  4991              ADD +1 TO CINDX.
  4992
  4993      IF CT-RT (CINDX) NOT NUMERIC
  4994          MOVE WS-LAST-CTBL-KEY  TO  CT-CONTROL-PRIMARY
  4995          MOVE CT-RT-R (CINDX)   TO  WS-CTBL-TABLE
  4996          GO TO 2249-READ-CTBL.
  4997
  4998 2249-READ-CTBL-EXIT.
  4999      EXIT.
  5000
  5001 2250-EXIT.
  5002      EXIT.
  5003
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* EL331.cbl
  5005****************************************************
  5006*  2260-READ-ACCT                                  *
  5007****************************************************
  5008*  READ ACCOUNT MASTER FILE RECORD MATCHING THE    *
  5009*  ECS CERTIFICATE RECORD BEING PROCESSED.         *
  5010****************************************************
  5011
  5012 2260-READ-ACCT.
  5013
  5014     IF NO-MORE-ACT-RECORDS
  5015         GO TO 2260-EXIT.
  5016
  5017     READ ERACCT NEXT RECORD.
  5018
  5019     ADD 1 TO WS-ACT-READ.
  5020
  5021***  DISPLAY '*** ERACCT READ: ' AM-CARRIER '-' AM-GROUPING '-'
  5022***      AM-STATE '-' AM-ACCOUNT ' EXP: ' AM-EXPIRE-DT ' EFF: '
  5023***      AM-EFFECTIVE-DT '-' AM-EFFECT-DT '  CERT: ' CR-CARRIER
  5024***      '-' CR-GROUPING '-' CR-STATE '-' CR-ACCOUNT ' EFF: '
  5025***      CR-DT.
  5026
  5027     IF AM-STAT-1 EQUAL '1'
  5028         MOVE 'X'   TO WS-ACT-END-SW
  5029         GO TO 2260-EXIT.
  5030
  5031     IF AM-STAT-1 NOT EQUAL ZERO
  5032         MOVE 'ERROR OCCURED READ  - ERACCT'
  5033                                TO  WS-ABEND-MESSAGE
  5034         MOVE AM-STATUSF        TO  WS-ABEND-FILE-STATUS
  5035         GO TO ABEND-PGM.
  5036
  5037     IF AM-COMPANY-CD NOT EQUAL DTE-CLASIC-COMPANY-CD
  5038         MOVE 'X'               TO WS-ACT-END-SW
  5039         GO TO 2260-EXIT.
  5040
  5041 2260-EXIT.
  5042      EXIT.
  5043
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* EL331.cbl
  5045****************************************************
  5046*  2270-DELETE-ERCOMM                              *
  5047****************************************************
  5048*  DELETE COMPENSATION EXCEPTION RECORDS FOR CERT- *
  5049*  IFICATE MASTER RECORDS THAT HAVE EXPIRED.       *
  5050****************************************************
  5051
  5052 2270-DELETE-ERCOMM.
  5053
  5054     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  5055        DTE-SYS-G-AR-USED     EQUAL '1'
  5056          NEXT SENTENCE
  5057     ELSE
  5058        GO TO 2270-EXIT.
  5059
  5060     IF THIS-CERT-HAS-ERCOMM-ENTRY
  5061         MOVE CM-CONTROL-PRIMARY TO CE-CONTROL-PRIMARY
  5062     ELSE
  5063         GO TO 2270-EXIT.
  5064
  5065     READ ERCOMM.
  5066
  5067     IF CE-STATUS  EQUAL '23'
  5068         GO TO 2270-EXIT.
  5069
  5070     IF CE-STAT-1  NOT EQUAL ZERO
  5071        MOVE CE-STATUS           TO  WS-ABEND-FILE-STATUS
  5072        MOVE 'ERROR OCCURED READ - ERCOMM'
  5073                                 TO  WS-ABEND-MESSAGE
  5074        GO TO ABEND-PGM.
  5075
  5076     DELETE ERCOMM.
  5077
  5078     IF CE-STAT-1  NOT EQUAL ZERO
  5079        MOVE CE-STATUS           TO  WS-ABEND-FILE-STATUS
  5080        MOVE 'ERROR OCCURED DELETE - ERCOMM'
  5081                                 TO  WS-ABEND-MESSAGE
  5082        GO TO ABEND-PGM.
  5083
  5084     ADD 1                       TO WS-EXCP-DEL.
  5085
  5086 2270-EXIT.
  5087     EXIT.
  5088
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* EL331.cbl
  5090*****************************************************
  5091*  2280-DELETE-ERMAIL                               *
  5092*****************************************************
  5093*  DELETE NAME AND ADDRESS RECORDS FOR CERTIFICATE  *
  5094*  MASTER RECORDS THAT HAVE EXPIRED.                *
  5095*****************************************************
  5096
  5097 2280-DELETE-ERMAIL.
  5098
  5099     IF INSURED-ADDR-PRESENT
  5100         MOVE CM-CONTROL-PRIMARY TO MA-CONTROL-PRIMARY
  5101     ELSE
  5102         GO TO 2280-EXIT.
  5103
  5104     READ ERMAIL.
  5105
  5106     IF ERMAIL-FILE-STATUS EQUAL '23'
  5107         GO TO 2280-EXIT.
  5108
  5109     IF CFS-STAT-1 NOT EQUAL ZERO
  5110        MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  5111        MOVE 'ERROR OCCURED READ - ERMAIL'
  5112                                 TO  WS-ABEND-MESSAGE
  5113        GO TO ABEND-PGM.
  5114
  5115     DELETE ERMAIL.
  5116
  5117     IF CFS-STAT-1 NOT EQUAL ZERO
  5118        MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  5119        MOVE 'ERROR OCCURED DELETE - ERMAIL'
  5120                                 TO  WS-ABEND-MESSAGE
  5121        GO TO ABEND-PGM.
  5122
  5123     ADD 1                       TO WS-MAIL-DEL.
  5124
  5125 2280-EXIT.
  5126     EXIT.
  5127
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* EL331.cbl
  5129*****************************************************
  5130*  2300-PROCESS-N-READ-ONL.                         *
  5131*****************************************************
  5132*  THIS ROUTINE IS EXECUTED WHEN THE BATCH CERT     *
  5133*  MASTER CONTROL IS GREATER THAN THE ONLINE CERT   *
  5134*  MASTER CONTROL. THE ONLINE CERT MASTER WILL BE   *
  5135*  DELETED UNLESS IT IS AN OPEN-END CERT OR CLAIM   *
  5136*  PAYMENT ACTIVITY IS ASSOCIATED WITH THE CERT.    *
  5137*  DELETE ANY ASSOCIATED COMPENSATION EXCEPTION     *
  5138*  RECORDS(ERCOMM) AND NAME AND ADDRESS RECORDS     *
  5139*  (ERMAIL) ASSOCIATED WITH THE EXPIRED CERT MASTER *
  5140*  RECORD.                                          *
  5141*****************************************************
  5142
  5143 2300-PROCESS-N-READ-ONL.
  5144
  5145     MOVE ZEROS                  TO CM-STATUS.
  5146
  5147     IF DTE-CLIENT = 'MON'
  5148         GO TO 2300-PROCESS-N-READ-MON.
  5149
  5150*****COPY ELCCRTM2.
  5151
  5152     IF (NO-MATCH-FOUND)
  5153        IF (CERT-PEND-ISSUE-ERROR)
  5154            IF CM-NOTE-SW NOT EQUAL ' '
  5155                 MOVE WS-EXC-MSG-NO-NOTES   TO DTL-EXC-MSG
  5156                 MOVE WS-CURRENT-DATE       TO DC-GREG-DATE-1-EDIT
  5157                 MOVE '2'                   TO DC-OPTION-CODE
  5158                 PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5159                 MOVE DC-BIN-DATE-1         TO CM-LAST-MONTH-END
  5160                 PERFORM 4000-EXPIRE-DATE   THRU  4099-EXIT
  5161
  5162                 REWRITE CERTIFICATE-MASTER
  5163
  5164                 PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5165                 PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5166                 IF CM-STAT-1 NOT EQUAL ZERO
  5167                    MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5168                                    TO  WS-ABEND-MESSAGE
  5169                    MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5170                    GO TO ABEND-PGM
  5171                 ELSE
  5172                    GO TO 2301-READ-ONL-CERT.
  5173
  5174     IF (NO-MATCH-FOUND) AND
  5175        (NOT CM-OPEN-END)
  5176         PERFORM 2330-FIND-ASSOCIATED-CLAIM  THRU 2330-EXIT
  5177         IF (NO-ASSOCIATED-CLAIM) AND
  5178            (CM-CLAIM-ATTACHED-COUNT = 0)
  5179              MOVE SPACES                TO WS-EXC-MSG-CE-COPY
  5180              MOVE WS-EXC-MSG-CE-DELETE  TO DTL-EXC-MSG
  5181              PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5182              PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5183              PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5184              ADD +1                     TO WS-ONL-DELETED
  5185*             PERFORM 2280-DELETE-ERMAIL THRU 2280-EXIT
  5186              PERFORM 2270-DELETE-ERCOMM THRU 2270-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* EL331.cbl
  5187
  5188              DELETE ELCERTF
  5189
  5190              IF CM-STAT-1 NOT EQUAL ZERO
  5191                 MOVE 'ERROR OCCURED DELETE  - ELCERT'
  5192                                 TO  WS-ABEND-MESSAGE
  5193                 MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5194                 GO TO ABEND-PGM
  5195              ELSE
  5196                 NEXT SENTENCE
  5197         ELSE
  5198             MOVE '- COPY RETAINED'     TO WS-EXC-MSG-EE-COPY
  5199             MOVE WS-EXC-MSG-EE-EXPIRED TO DTL-EXC-MSG
  5200             IF (CM-CREDIT-INTERFACE-SW-1 EQUAL '3') AND
  5201                (CM-CLAIM-INTERFACE-SW    EQUAL '2') AND
  5202                (CM-CLAIM-ATTACHED-COUNT  EQUAL WS-CLM-CNT)
  5203                  NEXT SENTENCE
  5204               ELSE
  5205                  MOVE WS-CLM-CNT TO CM-CLAIM-ATTACHED-COUNT
  5206                  MOVE WS-CURRENT-DATE   TO DC-GREG-DATE-1-EDIT
  5207                  MOVE '2'               TO DC-OPTION-CODE
  5208                  PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5209                  MOVE DC-BIN-DATE-1     TO CM-LAST-MONTH-END
  5210                  PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT
  5211                  REWRITE CERTIFICATE-MASTER
  5212                  PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5213                  PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5214                  PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5215                  IF CM-STAT-1 NOT EQUAL ZERO
  5216                     MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5217                                     TO  WS-ABEND-MESSAGE
  5218                     MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5219                     GO TO ABEND-PGM.
  5220
  5221     GO TO 2301-READ-ONL-CERT.
  5222
  5223 2300-PROCESS-N-READ-MON.
  5224
  5225*****COPY ELCCRTM2.
  5226
  5227     IF (NO-MATCH-FOUND)
  5228        IF (CERT-PEND-ISSUE-ERROR)
  5229            IF CM-NOTE-SW NOT EQUAL ' '
  5230                 MOVE WS-EXC-MSG-NO-NOTES   TO DTL-EXC-MSG
  5231                 MOVE WS-CURRENT-DATE       TO DC-GREG-DATE-1-EDIT
  5232                 MOVE '2'                   TO DC-OPTION-CODE
  5233                 PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5234                 MOVE DC-BIN-DATE-1         TO CM-LAST-MONTH-END
  5235                 PERFORM 4000-EXPIRE-DATE   THRU  4099-EXIT
  5236
  5237                 REWRITE CERTIFICATE-MASTER
  5238
  5239                 PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5240                 PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5241                 IF CM-STAT-1 NOT EQUAL ZERO
  5242                    MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5243                                    TO  WS-ABEND-MESSAGE
  5244                    MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* EL331.cbl
  5245                    GO TO ABEND-PGM
  5246                 ELSE
  5247                    GO TO 2301-READ-ONL-CERT.
  5248
  5249     IF (NO-MATCH-FOUND) AND
  5250        (NOT CM-OPEN-END)
  5251         PERFORM 2330-FIND-ASSOCIATED-CLAIM  THRU 2330-EXIT
  5252         IF (NO-ASSOCIATED-CLAIM) AND
  5253            ((CM-CLAIM-ATTACHED-COUNT = 0) OR
  5254            (CM-GROUPING NOT NUMERIC))
  5255              MOVE SPACES                TO WS-EXC-MSG-CE-COPY
  5256              MOVE WS-EXC-MSG-CE-DELETE  TO DTL-EXC-MSG
  5257              PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5258              PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5259              PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5260              ADD +1                     TO WS-ONL-DELETED
  5261*             PERFORM 2280-DELETE-ERMAIL THRU 2280-EXIT
  5262              PERFORM 2270-DELETE-ERCOMM THRU 2270-EXIT
  5263
  5264              DELETE ELCERTF
  5265
  5266              IF CM-STAT-1 NOT EQUAL ZERO
  5267                 MOVE 'ERROR OCCURED DELETE  - ELCERT'
  5268                                 TO  WS-ABEND-MESSAGE
  5269                 MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5270                 GO TO ABEND-PGM
  5271              ELSE
  5272                 NEXT SENTENCE
  5273         ELSE
  5274             MOVE '- COPY RETAINED'     TO WS-EXC-MSG-EE-COPY
  5275             MOVE WS-EXC-MSG-EE-EXPIRED TO DTL-EXC-MSG
  5276             IF (CM-CREDIT-INTERFACE-SW-1 EQUAL '3') AND
  5277                (CM-CLAIM-INTERFACE-SW    EQUAL '2') AND
  5278                (CM-CLAIM-ATTACHED-COUNT  EQUAL WS-CLM-CNT)
  5279                  NEXT SENTENCE
  5280               ELSE
  5281                  MOVE WS-CLM-CNT TO CM-CLAIM-ATTACHED-COUNT
  5282                  MOVE WS-CURRENT-DATE   TO DC-GREG-DATE-1-EDIT
  5283                  MOVE '2'               TO DC-OPTION-CODE
  5284                  PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5285                  MOVE DC-BIN-DATE-1     TO CM-LAST-MONTH-END
  5286                  PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT
  5287                  REWRITE CERTIFICATE-MASTER
  5288                  PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5289                  PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5290                  PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5291                  IF CM-STAT-1 NOT EQUAL ZERO
  5292                     MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5293                                     TO  WS-ABEND-MESSAGE
  5294                     MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5295                     GO TO ABEND-PGM.
  5296
  5297 2301-READ-ONL-CERT.
  5298
  5299     READ ELCERTF  NEXT RECORD.
  5300
  5301     IF CM-STAT-1 EQUAL '1'
  5302         MOVE 'X'                TO WS-ONL-END-SW
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* EL331.cbl
  5303                                    WS-ONL-GE-SW
  5304         MOVE HIGH-VALUES        TO WS-SAVED-ONL-KEY
  5305         MOVE SPACE              TO WS-O-MATCH-SW
  5306         GO TO 2300-EXIT.
  5307
  5308     IF CM-STAT-1 NOT EQUAL ZERO
  5309         MOVE 'ERROR OCCURED READ NEXT - ELCERT'
  5310                                 TO  WS-ABEND-MESSAGE
  5311         MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  5312         GO TO ABEND-PGM.
  5313
  5314     IF CM-COMPANY-CD NOT EQUAL DTE-CLASIC-COMPANY-CD
  5315         MOVE 'X'                TO WS-ONL-END-SW
  5316                                    WS-ONL-GE-SW
  5317         MOVE HIGH-VALUES        TO WS-SAVED-ONL-KEY
  5318         MOVE SPACE              TO WS-O-MATCH-SW
  5319         GO TO 2300-EXIT.
  5320
  5321     IF CM-OPEN-END
  5322         GO TO 2301-READ-ONL-CERT.
  5323
  5324     MOVE SPACE                  TO WS-O-MATCH-SW.
  5325
  5326 2302-PROC-ONL-CERT.
  5327     ADD 1                        TO WS-ONL-READ.
  5328
  5329
  5330     IF CM-ADDL-CLP NOT NUMERIC
  5331        MOVE ZEROS                TO CM-ADDL-CLP
  5332     END-IF
  5333     IF CM-LF-CLP NOT NUMERIC
  5334        MOVE ZEROS               TO CM-LF-CLP
  5335     END-IF
  5336     IF CM-AH-CLP NOT NUMERIC
  5337        MOVE ZEROS               TO CM-AH-CLP
  5338     END-IF
  5339     IF CM-DDF-IU-RATE-UP NOT NUMERIC
  5340        MOVE ZEROS               TO CM-DDF-IU-RATE-UP
  5341     END-IF
  5342
  5343     IF CM-NH-INT-ON-REFS NOT NUMERIC
  5344         MOVE ZEROS               TO CM-NH-INT-ON-REFS.
  5345
  5346*****COPY ELCCRTM2.
  5347
  5348     MOVE CERTIFICATE-MASTER      TO WS-ONL-RECORD.
  5349
  5350     MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLM-CNT.
  5351     MOVE CM-CLAIM-INTERFACE-SW   TO WS-CM-ORIG.
  5352     MOVE CM-LOAN-NUMBER          TO WS-LN-NUMBER.
  5353     MOVE CM-LOAN-BALANCE         TO WS-LN-BALANCE.
  5354     MOVE CM-BENEFICIARY          TO WS-CM-BENEFICIARY.
  5355     MOVE CM-LAST-ADD-ON-DT       TO WS-LST-ADD-ON-DT.
  5356     MOVE CM-ENTRY-BATCH          TO WS-CM-ENTRY-BATCH.
  5357     MOVE CM-LF-EXIT-BATCH        TO WS-CM-LF-EXIT-BATCH.
  5358     MOVE CM-AH-EXIT-BATCH        TO WS-CM-AH-EXIT-BATCH.
  5359     MOVE CM-COMP-EXCP-SW         TO WS-ERCOMM-SW.
  5360     MOVE CM-INSURED-ADDRESS-SW   TO WS-CM-INSURED-ADDRESS-SW.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* EL331.cbl
  5361*    MOVE CM-CLAIM-DEDUCT-WITHHELD
  5362*                                 TO WS-CLAIM-DEDUCT-WITHHELD.
  5363*    MOVE CM-CANCEL-DEDUCT-WITHHELD
  5364*                                 TO WS-CANCEL-DEDUCT-WITHHELD.
  5365     MOVE CM-LF-DEATH-EXIT-DT     TO WS-LF-DEATH-EXIT-DT.
  5366     MOVE CM-LF-CURRENT-STATUS    TO WS-LF-CURRENT-STATUS.
  5367     MOVE CM-LF-STATUS-AT-DEATH   TO WS-LF-STATUS-AT-DEATH.
  5368     PERFORM 2370-SAVE-ONL-KEY    THRU 2370-EXIT.
  5369
  5370     IF WS-SAVED-ONL-KEY NOT LESS WS-SAVED-ECS-KEY
  5371         MOVE 'X'                 TO WS-ONL-GE-SW.
  5372
  5373 2300-EXIT.
  5374      EXIT.
  5375
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* EL331.cbl
  5377*****************************************************
  5378*  2330-FIND-ASSOCIATED-CLAIM                       *
  5379*****************************************************
  5380*  THIS ROUTINE WILL BROWSE THE CLAIM MASTER FILE   *
  5381*  THRU THE CERTIFICATE ALTERNATE INDEX AND ACCUM-  *
  5382*  ULATE A COUNT OF CLAIMS ASSOCIATED WITH THE CURR-*
  5383*  ENT CLAIM MASTER. THE LAST CLAIM MASTER FOUND IS *
  5384*  SAVED IN CLAIM-MASTER.                           *
  5385*****************************************************
  5386
  5387 2330-FIND-ASSOCIATED-CLAIM.
  5388
  5389     MOVE 'N'                   TO WS-CLAIM-SW.
  5390
  5391     IF DTE-SYS-E-CLASIC-CLAIMS EQUAL ZERO OR 'N'
  5392         GO TO 2330-EXIT.
  5393
  5394********************************************************
  5395*  BUILD CL-CONTROL-BY-CERT-NO AND WS-SEC-CLAIM-INDEX  *
  5396*  FROM THE CURRENT ONLINE CERT MASTER RECORD.         *
  5397********************************************************
  5398
  5399     MOVE CM-COMPANY-CD         TO CL-COMPANY-CD-A4
  5400                                   WS-S-CL-COMP.
  5401     MOVE CM-CERT-PRIME         TO CL-CERT-A4-PRIME
  5402                                   WS-S-CL-PRIM.
  5403     MOVE CM-CERT-SFX           TO CL-CERT-A4-SFX
  5404                                   WS-S-CL-SFX.
  5405     MOVE CM-GROUPING           TO WS-CL-GRPG.
  5406     MOVE CM-STATE              TO WS-CL-STAT.
  5407     MOVE CM-ACCOUNT            TO WS-CL-ACCT.
  5408     MOVE CM-CARRIER            TO WS-CL-CARR.
  5409     MOVE CM-CERT-EFF-DT        TO WS-CL-EFDT.
  5410
  5411     MOVE ZERO                  TO  WS-CLM-CNT.
  5412
  5413     START ELMSTR5
  5414                KEY EQUAL CL-CONTROL-BY-CERT-NO.
  5415***
  5416     IF CL-STATUS EQUAL '23'
  5417         GO TO 2350-CHECK-ELRETR.
  5418
  5419     IF CL-STAT-1 EQUAL ZERO
  5420         MOVE SPACE              TO WS-CLM-END-SW
  5421         PERFORM 2335-READNEXT-CLAIM  THRU 2335-EXIT
  5422             UNTIL NO-MORE-CLAIM-MATCH
  5423     ELSE
  5424         MOVE 'ERROR OCCURED START - ELMSTR'
  5425                                 TO  WS-ABEND-MESSAGE
  5426         MOVE CL-STATUS          TO  WS-ABEND-FILE-STATUS
  5427         GO TO ABEND-PGM.
  5428
  5429     IF ASSOCIATED-CLAIM
  5430         MOVE WS-LAST-CLAIM-MATCHED TO CLAIM-MASTER.
  5431
  5432 2330-EXIT.
  5433      EXIT.
  5434
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* EL331.cbl
  5436*****************************************************
  5437*  2335-READNEXT-CLAIM                              *
  5438*****************************************************
  5439*  READ CLAIM MASTER FILE AND CHECK KEYS FOR MATCH  *
  5440*****************************************************
  5441
  5442 2335-READNEXT-CLAIM.
  5443
  5444     READ ELMSTR5  NEXT  RECORD.
  5445
  5446     IF CL-STAT-1  EQUAL '1'
  5447         MOVE 'X'                TO WS-CLM-END-SW
  5448         GO TO 2335-EXIT.
  5449
  5450     IF CL-STAT-1  NOT  EQUAL '0'
  5451         MOVE 'ERROR OCCURED READNEXT - ELMSTR'
  5452                                 TO  WS-ABEND-MESSAGE
  5453         MOVE CL-STATUS          TO  WS-ABEND-FILE-STATUS
  5454         GO TO ABEND-PGM.
  5455
  5456     IF CL-CONTROL-BY-CERT-NO  NOT EQUAL WS-SEC-CLAIM-INDEX
  5457         MOVE  'X'               TO WS-CLM-END-SW
  5458     ELSE
  5459         IF CL-CERT-KEY-DATA EQUAL WS-CLAIM-MATCH-KEY
  5460             ADD +1              TO  WS-CLM-CNT
  5461             MOVE CLAIM-MASTER   TO WS-LAST-CLAIM-MATCHED
  5462             MOVE 'A'            TO WS-CLAIM-SW.
  5463
  5464 2335-EXIT.
  5465      EXIT.
  5466
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* EL331.cbl
  5468
  5469********************************************************
  5470*  BUILD RL-CONTROL-BY-CERT-NO AND WS-SEC-CLAIM-INDEX  *
  5471*  FROM THE CURRENT ONLINE CERT MASTER RECORD.         *
  5472********************************************************
  5473
  5474 2350-CHECK-ELRETR.
  5475     MOVE CM-COMPANY-CD         TO RL-COMPANY-CD-A4
  5476                                   WS-S-CL-COMP.
  5477     MOVE CM-CERT-PRIME         TO RL-CERT-A4-PRIME
  5478                                   WS-S-CL-PRIM.
  5479     MOVE CM-CERT-SFX           TO RL-CERT-A4-SFX
  5480                                   WS-S-CL-SFX.
  5481     MOVE CM-GROUPING           TO WS-CL-GRPG.
  5482     MOVE CM-STATE              TO WS-CL-STAT.
  5483     MOVE CM-ACCOUNT            TO WS-CL-ACCT.
  5484     MOVE CM-CARRIER            TO WS-CL-CARR.
  5485     MOVE CM-CERT-EFF-DT        TO WS-CL-EFDT.
  5486
  5487     MOVE ZERO                  TO WS-CLM-CNT.
  5488
  5489     START ELRETR5
  5490                KEY EQUAL RL-CONTROL-BY-CERT-NO.
  5491
  5492     IF ELRETR5-FILE-STATUS = '23'
  5493         GO TO 2330-EXIT.
  5494
  5495     IF ELRETR5-FILE-STATUS = ZERO
  5496         MOVE SPACE              TO WS-CLM-END-SW
  5497         PERFORM 2355-READNEXT-CLAIM  THRU 2355-EXIT
  5498             UNTIL NO-MORE-CLAIM-MATCH
  5499     ELSE
  5500         MOVE 'ERROR OCCURRED START - ELRETR'
  5501                                  TO WS-ABEND-MESSAGE
  5502         MOVE ELRETR5-FILE-STATUS TO WS-ABEND-FILE-STATUS
  5503         GO TO ABEND-PGM.
  5504
  5505     IF ASSOCIATED-CLAIM
  5506         MOVE WS-LAST-CLAIM-MATCHED TO CLAIM-MASTER.
  5507
  5508     GO TO 2330-EXIT.
  5509
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* EL331.cbl
  5511*****************************************************
  5512*  2355-READNEXT-CLAIM (ELRETR)                     *
  5513*****************************************************
  5514*  READ RETRIEVE FILE AND CHECK KEYS FOR MATCH      *
  5515*****************************************************
  5516
  5517 2355-READNEXT-CLAIM.
  5518
  5519     READ ELRETR5  NEXT  RECORD.
  5520
  5521     IF ELRETR5-STAT-1 = '1'
  5522         MOVE 'X'                TO WS-CLM-END-SW
  5523         GO TO 2355-EXIT.
  5524
  5525     IF ELRETR5-STAT-1 NOT = ZERO
  5526         MOVE 'ERROR OCCURRED READNEXT - ELMSTR'
  5527                                  TO WS-ABEND-MESSAGE
  5528         MOVE ELRETR5-FILE-STATUS TO WS-ABEND-FILE-STATUS
  5529         GO TO ABEND-PGM.
  5530
  5531     IF RL-CONTROL-BY-CERT-NO NOT = WS-SEC-CLAIM-INDEX
  5532         MOVE  'X'               TO WS-CLM-END-SW
  5533     ELSE
  5534         IF RL-CERT-KEY-DATA = WS-CLAIM-MATCH-KEY
  5535             ADD +1 TO WS-CLM-CNT
  5536             MOVE RETRIEVE-MASTER  TO WS-LAST-CLAIM-MATCHED
  5537             MOVE 'A'              TO WS-CLAIM-SW.
  5538
  5539 2355-EXIT.
  5540      EXIT.
  5541
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* EL331.cbl
  5543***********************************************************
  5544*  2370-SAVE-ONL-KEY                                      *
  5545***********************************************************
  5546*  STORE ONLINE CERT MASTER KEY IN WS-CM-CONTROL-PRIMARY  *
  5547*  AND BUILD WS-SAVED-ONL-KEY FOR COMPARISON.             *
  5548***********************************************************
  5549
  5550 2370-SAVE-ONL-KEY.
  5551
  5552     MOVE CM-CONTROL-PRIMARY     TO WS-CM-CONTROL-PRIMARY.
  5553     MOVE DTE-CLASIC-COMPANY-CD  TO WS-SAVED-O-COMP.
  5554     MOVE CM-CARRIER             TO WS-SAVED-O-CARR.
  5555     MOVE CM-GROUPING            TO WS-SAVED-O-GRPG.
  5556     MOVE CM-STATE               TO WS-SAVED-O-STAT.
  5557     MOVE CM-ACCOUNT             TO WS-SAVED-O-ACCT.
  5558     MOVE CM-CERT-NO             TO WS-SAVED-O-CERT.
  5559
  5560     MOVE SPACES                 TO DC-OPTION-CODE.
  5561     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
  5562     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  5563     MOVE DC-GREG-DATE-CYMD      TO WS-SAVED-O-DATE.
  5564
  5565 2370-EXIT.
  5566      EXIT.
  5567
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* EL331.cbl
  5569***********************************************************
  5570*  2500-PROCESS-MATCHING                                  *
  5571***********************************************************
  5572*  A MATCH HAS OCCURRED BETWEEN THE ONLINE AND BATCH      *
  5573*  CERT MASTER FILES. DETERMINE THE TYPE OF ACTIVITY IF   *
  5574*  ANY THAT HAS OCCURRED SINCE LAST MONTH-END AND REPORT  *
  5575*  IT.                                                    *
  5576***********************************************************
  5577
  5578 2500-PROCESS-MATCHING.
  5579     ADD 1                       TO WS-MATCHED-ONL.
  5580     MOVE 'M'                    TO WS-O-MATCH-SW.
  5581     MOVE SPACES                 TO WS-FIRST-TIME-SW.
  5582     MOVE SPACES                 TO WS-PRT-FULL-LINE-SW.
  5583
  5584*****************************************************************
  5585*****************************************************************
  5586*****    SPECIAL CODE FOR JAL AND JAI TO INFORM THEM OF     *****
  5587*****    ZERO CERTIFICATES COMING FROM THE BLAZER LOAN      *****
  5588*****    SYSTEM.                                            *****
  5589*****************************************************************
  5590*****************************************************************
  5591
  5592     IF DTE-CLIENT EQUAL 'JAL' OR 'JAI'
  5593        IF (CR-AHPRM + CR-LFPRM) LESS THAN +.05
  5594           ADD 1 TO NO-PREM-CT
  5595           DISPLAY 'NO PREMIUMS FOR CERT ' CR-FULL-CONTROL
  5596           IF ((CR-AHTYP EQUAL ZERO) AND (CR-LFTYP EQUAL ZERO))
  5597              DISPLAY 'NO PLAN CODES FOR CERT ' CR-FULL-CONTROL
  5598              ADD 1 TO NO-PLAN-CODE-CT
  5599              MOVE +1 TO CR-AHPRM CR-LFPRM
  5600           ELSE
  5601              IF CR-LFTYP EQUAL ZEROS
  5602                 MOVE +1 TO CR-AHPRM
  5603              ELSE
  5604                 IF CR-AHTYP EQUAL ZEROS
  5605                    MOVE +1 TO CR-LFPRM
  5606                 ELSE
  5607                    MOVE +1 TO CR-AHPRM CR-LFPRM.
  5608
  5609*****************************************************************
  5610*****************************************************************
  5611*****    SPECIAL CODE FOR JAL AND JAI TO INFORM THEM OF     *****
  5612*****    ZERO CERTIFICATES COMING FROM THE BLAZER LOAN      *****
  5613*****    SYSTEM.                                            *****
  5614*****************************************************************
  5615*****************************************************************
  5616
  5617*****************************************************************
  5618*  PREMIUM TOTAL LESS THAN (.05) EXIT ROUTINE (RE-ISSUED CERT)  *
  5619*****************************************************************
  5620
  5621*    IF (CR-AHPRM + CR-LFPRM) LESS +.05
  5622*        GO TO 2500-EXIT.
  5623
  5624*****************************************************************
  5625*  PROCESS OPTION (2) RE-ATTACHES CERT MASTER TO CLAIMS MASTER  *
  5626*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* EL331.cbl
  5627
  5628     IF DTE-CLIENT = 'MON'
  5629         NEXT SENTENCE
  5630     ELSE
  5631         IF DTE-PRC-OPT NOT EQUAL '2'
  5632             IF NO-CLAIM-ATTACHED
  5633                 PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5634                 GO TO 2500-EXIT.
  5635
  5636     PERFORM 2330-FIND-ASSOCIATED-CLAIM  THRU 2330-EXIT.
  5637
  5638     IF NO-ASSOCIATED-CLAIM
  5639         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5640         GO TO 2500-EXIT.
  5641
  5642     ADD 1                       TO WS-CLAIM-MATCH.
  5643
  5644*********************************************************
  5645*****  LIFE COVERAGE CANCELLED BUT NOW REINSTATED   *****
  5646*********************************************************
  5647
  5648     IF CR-LF-STATUS-AT-CANCEL EQUAL SPACE AND
  5649        CM-LF-CANCEL-DT NOT EQUAL LOW-VALUE
  5650           MOVE 'POLICY REINSTATED AFTER CANCEL' TO DTL-EXC-MSG
  5651           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5652           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5653           GO TO 2500-EXIT.
  5654
  5655*********************************************************
  5656*****  AH COVERAGE CANCELLED BUT NOW REINSTATED     *****
  5657*********************************************************
  5658
  5659     IF CR-AH-STATUS-AT-CANCEL EQUAL SPACE AND
  5660        CM-AH-CANCEL-DT NOT EQUAL LOW-VALUE
  5661           MOVE 'POLICY REINSTATED AFTER CANCEL' TO DTL-EXC-MSG
  5662           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5663           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5664           GO TO 2500-EXIT.
  5665
  5666*************************************
  5667*****  LIFE COVERAGE CANCELLED  *****
  5668*************************************
  5669
  5670     IF CR-LF-STATUS-AT-CANCEL NOT EQUAL SPACE AND
  5671        CM-LF-CANCEL-DT EQUAL LOW-VALUE
  5672           MOVE ' LIFE COV CANCELLED AS OF '
  5673                                   TO WS-EXC-MSG-DESC
  5674           MOVE CR-LF-CNC-MO       TO WS-EXC-C-MO
  5675           MOVE CR-LF-CNC-DA       TO WS-EXC-C-DA
  5676           MOVE CR-LF-CNC-YR       TO WS-EXC-C-YR
  5677           MOVE WS-EXC-MSG-CANCEL  TO DTL-EXC-MSG
  5678           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5679           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5680           GO TO 2500-EXIT.
  5681
  5682*************************************
  5683*****  AH COVERAGE CANCELLED    *****
  5684*************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* EL331.cbl
  5685
  5686     IF CR-AH-STATUS-AT-CANCEL NOT EQUAL SPACE AND
  5687        CM-AH-CANCEL-DT EQUAL LOW-VALUE
  5688           MOVE ' A&H  COV CANCELLED AS OF '
  5689                                   TO WS-EXC-MSG-DESC
  5690           MOVE CR-AH-CNC-MO       TO WS-EXC-C-MO
  5691           MOVE CR-AH-CNC-DA       TO WS-EXC-C-DA
  5692           MOVE CR-AH-CNC-YR       TO WS-EXC-C-YR
  5693           MOVE WS-EXC-MSG-CANCEL  TO DTL-EXC-MSG
  5694           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5695           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5696           GO TO 2500-EXIT.
  5697
  5698*************************************
  5699*****  LIFE COVERAGE DELETED    *****
  5700*************************************
  5701
  5702     IF CR-LFTYP EQUAL ZEROS AND
  5703        CM-LF-BENEFIT-CD NOT EQUAL ZERO
  5704         MOVE WS-EXC-MSG-CO-DELETE TO DTL-EXC-MSG
  5705         PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5706         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5707         GO TO 2500-EXIT.
  5708
  5709*************************************
  5710*****  AH COVERAGE DELETED      *****
  5711*************************************
  5712
  5713     IF CR-AHTYP EQUAL ZEROS AND
  5714        CM-AH-BENEFIT-CD NOT EQUAL ZERO
  5715         MOVE WS-EXC-MSG-CO-DELETE TO DTL-EXC-MSG
  5716         PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5717         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5718         GO TO 2500-EXIT.
  5719
  5720*************************************
  5721*****  COVERAGE ADDED FOR LIFE  *****
  5722*************************************
  5723
  5724     IF CERT-WAS-CREATED-FOR-CLAIM
  5725         IF CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1
  5726            MOVE CR-LFTYP         TO WS-EXC-MSG-ADDED-TYPE
  5727            MOVE CR-LFAMT         TO WS-EXC-MSG-ADDED-AMT
  5728            MOVE WS-EXC-MSG-ADDED TO DTL-EXC-MSG
  5729            PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5730            PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5731            GO TO 2500-EXIT.
  5732
  5733*************************************
  5734*****  COVERAGE ADDED FOR AH   *****
  5735*************************************
  5736
  5737     IF CERT-WAS-CREATED-FOR-CLAIM
  5738         IF CL-CLAIM-TYPE = AH-OVERRIDE-L1 or 'I' or 'G' or 'F'
  5739            MOVE CR-AHTYP         TO WS-EXC-MSG-ADDED-TYPE
  5740            MOVE CR-AHAMT         TO WS-EXC-MSG-ADDED-AMT
  5741            MOVE WS-EXC-MSG-ADDED TO DTL-EXC-MSG
  5742            PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* EL331.cbl
  5743            PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5744            GO TO 2500-EXIT.
  5745
  5746     IF (CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1) AND
  5747        (CR-LFTYP EQUAL CM-LF-BENEFIT-CD) AND
  5748        (CR-LFAMT EQUAL CM-LF-BENEFIT-AMT)
  5749          PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5750          GO TO 2500-EXIT.
  5751
  5752     IF (CL-CLAIM-TYPE = AH-OVERRIDE-L1 or 'I' or 'G' or 'F') AND
  5753        (CR-AHTYP  EQUAL CM-AH-BENEFIT-CD) AND
  5754        (CR-AHAMT  EQUAL CM-AH-BENEFIT-AMT)
  5755          PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5756          GO TO 2500-EXIT.
  5757
  5758     IF CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1
  5759         MOVE CM-LF-BENEFIT-AMT      TO WS-EXC-MSG-CHGD-AMT-NEW
  5760         MOVE CM-LF-BENEFIT-CD       TO WS-EXC-MSG-CHGD-TYPE-NEW
  5761         MOVE WS-EXC-MSG-CHANGED-NEW TO DTL-EXC-MSG
  5762         PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5763         MOVE CR-LFTYP               TO WS-EXC-MSG-CHGD-TYPE-OLD
  5764         MOVE CR-LFAMT               TO WS-EXC-MSG-CHGD-AMT-OLD
  5765         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT.
  5766
  5767     IF CL-CLAIM-TYPE = AH-OVERRIDE-L1 or 'I' or 'G' or 'F'
  5768         MOVE CM-AH-BENEFIT-AMT      TO WS-EXC-MSG-CHGD-AMT-NEW
  5769         MOVE CM-AH-BENEFIT-CD       TO WS-EXC-MSG-CHGD-TYPE-NEW
  5770         MOVE WS-EXC-MSG-CHANGED-NEW TO DTL-EXC-MSG
  5771         PERFORM 2510-BUILD-PRINT THRU 2510-EXIT
  5772         MOVE CR-AHTYP               TO WS-EXC-MSG-CHGD-TYPE-OLD
  5773         MOVE CR-AHAMT               TO WS-EXC-MSG-CHGD-AMT-OLD
  5774         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT.
  5775
  5776***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  5777***                                                            ***
  5778***  We found a condition where the claim type was blank       ***
  5779***  and the on-line cert had a pending status and it should   ***
  5780***  not have so we decided to re-build the on-line cert       ***
  5781***  based on the off-line cert. BTW, do-not-load means that   ***
  5782***  the cert is old and it thinks there isnt an on-line equal ***
  5783***                                                            ***
  5784***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  5785
  5786     if (cl-claim-type = ' ')
  5787        and (do-not-load)
  5788        and ((cm-lf-current-status = '2')
  5789           or (cm-ah-current-status = '2'))
  5790        PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5791        GO TO 2500-EXIT
  5792     end-if
  5793
  5794     if (cl-claim-type = ' ')
  5795        and (CR-TEMP-EPIQ = 'EPIQ')
  5796        and (CM-TEMP-EPIQ not = 'EQ')
  5797        move 'EQ'                to cm-temp-epiq
  5798        PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5799        go to 2500-exit
  5800     end-if
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* EL331.cbl
  5801
  5802     PERFORM 2530-PRINT-OLD THRU 2530-EXIT.
  5803
  5804 2500-EXIT.
  5805      EXIT.
  5806
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* EL331.cbl
  5808 2510-BUILD-PRINT.
  5809     IF NOT LINE-FULL
  5810         PERFORM 7300-BLD-ECS-PRT-LINE  THRU 7300-EXIT
  5811         PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT.
  5812
  5813     PERFORM 7370-PRINT-DETAIL THRU 7370-EXIT.
  5814
  5815 2510-EXIT.
  5816      EXIT.
  5817
  5818 2530-PRINT-OLD.
  5819
  5820     MOVE SPACES                 TO DTL-1.
  5821     MOVE WS-EXC-MSG-CHANGED-OLD TO DTL-EXC-MSG.
  5822     MOVE DTL-1                  TO P-DATA.
  5823     MOVE ' '                    TO X.
  5824     ADD  1                      TO WS-LINE-CNT.
  5825     PERFORM 7600-PRT-RTN   THRU 7600-EXIT.
  5826
  5827 2530-EXIT.
  5828      EXIT.
  5829
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* EL331.cbl
  5831***********************************************************
  5832*  2600-REWRITE-CERT                                      *
  5833***********************************************************
  5834*  REWRITE THE UPDATED ONLINE CERTIFICATE MASTER RECORD   *
  5835***********************************************************
  5836
  5837 2600-REWRITE-CERT.
  5838
  5839*****COPY ELCCRTM1.
  5840
  5841     MOVE CERTIFICATE-MASTER TO WS-BEFORE-CERT.
  5842
  5843     PERFORM 2830-MOVE-DATA  THRU 2830-EXIT.
  5844
  5845     IF MATCHED-REC
  5846         MOVE WS-LN-NUMBER        TO CM-LOAN-NUMBER
  5847         MOVE WS-LN-BALANCE       TO CM-LOAN-BALANCE
  5848         MOVE WS-CM-BENEFICIARY   TO CM-BENEFICIARY
  5849         MOVE WS-LST-ADD-ON-DT    TO CM-LAST-ADD-ON-DT
  5850         MOVE WS-CM-ENTRY-BATCH   TO CM-ENTRY-BATCH
  5851         MOVE WS-CM-LF-EXIT-BATCH TO CM-LF-EXIT-BATCH
  5852         MOVE WS-CM-AH-EXIT-BATCH TO CM-AH-EXIT-BATCH
  5853         MOVE WS-CLM-CNT          TO CM-CLAIM-ATTACHED-COUNT
  5854         MOVE WS-CM-INSURED-ADDRESS-SW
  5855                                  TO CM-INSURED-ADDRESS-SW
  5856*        MOVE WS-CLAIM-DEDUCT-WITHHELD
  5857*                                 TO CM-CLAIM-DEDUCT-WITHHELD
  5858*        MOVE WS-CANCEL-DEDUCT-WITHHELD
  5859*                                 TO CM-CANCEL-DEDUCT-WITHHELD
  5860         IF CM-CLAIM-ATTACHED-COUNT EQUAL ZERO
  5861               MOVE SPACE         TO CM-CLAIM-INTERFACE-SW
  5862           ELSE
  5863               MOVE '1'           TO CM-CLAIM-INTERFACE-SW.
  5864
  5865     IF MATCHED-REC
  5866         IF WS-LF-DEATH-EXIT-DT NOT LESS THAN WS-EOM-DT
  5867             MOVE WS-LF-DEATH-EXIT-DT
  5868                                  TO  CM-LF-DEATH-EXIT-DT
  5869             MOVE WS-LF-CURRENT-STATUS
  5870                                  TO  CM-LF-CURRENT-STATUS
  5871             MOVE WS-LF-STATUS-AT-DEATH
  5872                                  TO  CM-LF-STATUS-AT-DEATH.
  5873
  5874     IF ASSOCIATED-ERCOMM
  5875        MOVE ' '                  TO CM-COMP-EXCP-SW
  5876        PERFORM 2270-DELETE-ERCOMM THRU 2270-EXIT.
  5877
  5878     ADD 1 TO WS-ACCT-READS.
  5879     PERFORM 2200-MATCH-ACCT THRU 2200-EXIT.
  5880
  5881     PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT.
  5882
  5883     MOVE WS-CURRENT-DATE         TO DC-GREG-DATE-1-EDIT.
  5884     MOVE '2'                     TO DC-OPTION-CODE.
  5885     PERFORM 7100-DATE-RTN THRU 7100-EXIT.
  5886
  5887*****COPY ELCCRTM2.
  5888
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* EL331.cbl
  5889     IF WS-BEFORE-CERT NOT EQUAL CERTIFICATE-MASTER
  5890        MOVE DC-BIN-DATE-1        TO CM-LAST-MONTH-END
  5891        REWRITE CERTIFICATE-MASTER.
  5892
  5893     IF CM-STAT-1 NOT EQUAL ZERO
  5894          MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  5895          MOVE 'ERROR OCCURED REWRITE - ELCERT'
  5896                                  TO  WS-ABEND-MESSAGE
  5897         GO TO ABEND-PGM.
  5898
  5899     MOVE ZERO                    TO  WS-UPDATE-SW.
  5900
  5901 2600-EXIT.
  5902      EXIT.
  5903
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* EL331.cbl
  5905***********************************************************
  5906*  2800-ADD-NEW-CERT                                      *
  5907***********************************************************
  5908*  REWRITE THE UPDATED ONLINE CERTIFICATE MASTER RECORD   *
  5909***********************************************************
  5910
  5911 2800-ADD-NEW-CERT.
  5912
  5913     MOVE SPACES                 TO CERTIFICATE-MASTER.
  5914
  5915*****COPY ELCCRTM1.
  5916
  5917     PERFORM 2830-MOVE-DATA      THRU 2830-EXIT.
  5918     PERFORM 2820-BUILD-NEW-KEY  THRU 2820-EXIT.
  5919
  5920     ADD 1 TO WS-ACCT-READS.
  5921     PERFORM 2200-MATCH-ACCT THRU 2200-EXIT.
  5922
  5923     MOVE WS-CURRENT-DATE         TO DC-GREG-DATE-1-EDIT.
  5924     MOVE '2'                     TO DC-OPTION-CODE.
  5925     PERFORM 7100-DATE-RTN THRU 7100-EXIT.
  5926     MOVE DC-BIN-DATE-1           TO CM-LAST-MONTH-END
  5927     PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT.
  5928
  5929     WRITE CERTIFICATE-MASTER.
  5930
  5931     IF CM-STATUS EQUAL '22'
  5932         NEXT SENTENCE
  5933      ELSE
  5934       IF CM-STAT-1  NOT EQUAL ZERO
  5935         MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  5936         MOVE 'ERROR OCCURED WRITE - ELCERT'
  5937                                 TO  WS-ABEND-MESSAGE
  5938         GO TO ABEND-PGM.
  5939
  5940     MOVE  WS-ONL-RECORD         TO CERTIFICATE-MASTER.
  5941
  5942 2800-EXIT.
  5943      EXIT.
  5944
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* EL331.cbl
  5946***********************************************************
  5947*  2820-BUILD-NEW-KEY                                     *
  5948***********************************************************
  5949*  BUILD PRIMARY AND ALL ALTERNATE KEY FIELDS IN ONLINE   *
  5950*  CERT MASTER FROM BATCH CERT MASTER.                    *
  5951***********************************************************
  5952
  5953 2820-BUILD-NEW-KEY.
  5954
  5955     MOVE DTE-CLASIC-COMPANY-CD  TO CM-COMPANY-CD
  5956                                    CM-COMPANY-CD-A1
  5957                                    CM-COMPANY-CD-A2
  5958                                    CM-COMPANY-CD-A4
  5959                                    CM-COMPANY-CD-A5.
  5960
  5961     MOVE CR-CARRIER             TO CM-CARRIER.
  5962     MOVE CR-GROUPING            TO CM-GROUPING.
  5963     MOVE CR-STATE               TO CM-STATE.
  5964     MOVE CR-ACCOUNT             TO CM-ACCOUNT.
  5965     MOVE CR-CERT-NO             TO CM-CERT-NO
  5966                                    CM-CERT-NO-A4.
  5967
  5968     MOVE BIN-CR-DT              TO CM-CERT-EFF-DT.
  5969
  5970     IF CR-LNAME EQUAL SPACES
  5971         MOVE CR-CERT-NO         TO CR-LNAME.
  5972
  5973     MOVE CR-INIT                TO CM-INSURED-INITIAL2.
  5974     MOVE CR-1ST-INITIAL         TO CM-INSURED-INITIAL1.
  5975     MOVE CR-LNAME               TO CM-INSURED-LAST-NAME.
  5976
  5977     IF CR-MEMBER-NO NOT = SPACES
  5978         MOVE CR-MEMBER-NO       TO CM-MEMBER-NO.
  5979
  5980     INSPECT CR-MEMBER-NO
  5981         REPLACING ALL ' ' BY '0'.
  5982
  5983     IF CR-MEMBER-NO = ZEROS
  5984       IF DTE-CLIENT = 'MON'
  5985           MOVE CR-LNAME            TO WK-LAST-NAME
  5986           MOVE SPACES              TO WK-MEMB-ACCT
  5987                                       ERROR-FLAG
  5988           MOVE 1                   TO ACCT-SUB
  5989           PERFORM 2825-FILL-ACCT THRU 2825-EXIT
  5990               VARYING LST-NM-SUB FROM 1 BY 1
  5991                 UNTIL LST-NM-SUB GREATER 12
  5992           MOVE WK-MEMB-ACCT        TO CM-MEMB-ACCOUNT
  5993           MOVE CR-YR               TO CM-INSURED-INITIALS-A5
  5994           MOVE CR-MO               TO CM-PART-LAST-NAME-A5
  5995        ELSE
  5996           MOVE CR-STATE            TO CM-MEMB-STATE
  5997           MOVE CR-ACCT-PRIME       TO CM-MEMB-ACCOUNT
  5998           MOVE CR-LNAME            TO CM-PART-LAST-NAME-A5
  5999           MOVE CM-INSURED-INITIALS TO CM-INSURED-INITIALS-A5.
  6000
  6001     IF CR-SOC-SEC NOT = SPACES
  6002         MOVE CR-SOC-SEC         TO CM-SOC-SEC-NO.
  6003
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* EL331.cbl
  6004     INSPECT CR-SOC-SEC
  6005         REPLACING ALL ' ' BY '0'.
  6006
  6007     IF CR-SOC-SEC = ZEROS
  6008         MOVE CR-STATE           TO CM-SSN-STATE
  6009         MOVE CR-ACCT-PRIME      TO CM-SSN-ACCOUNT
  6010         MOVE CR-LNAME           TO CM-PART-LAST-NAME-A2
  6011         MOVE CM-INSURED-INITIALS TO CM-INSURED-INITIALS-A2.
  6012
  6013 2820-EXIT.
  6014      EXIT.
  6015
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* EL331.cbl
  6017 2825-FILL-ACCT.
  6018     IF ACCT-SUB GREATER 6
  6019         MOVE 12            TO LST-NM-SUB
  6020         GO TO 2825-EXIT.
  6021     IF WK-LAST-NAME-CHAR (LST-NM-SUB) NUMERIC
  6022         MOVE 'A'           TO ERROR-FLAG
  6023         GO TO 2825-EXIT.
  6024     IF WK-LAST-NAME-CHAR (LST-NM-SUB) ALPHABETIC AND
  6025        WK-LAST-NAME-CHAR (LST-NM-SUB) NOT = SPACE
  6026         MOVE WK-LAST-NAME-CHAR (LST-NM-SUB)
  6027                            TO WK-MEMB-ACCT-CHAR (ACCT-SUB)
  6028         ADD 1 TO ACCT-SUB.
  6029
  6030 2825-EXIT.
  6031      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 127
* EL331.cbl
  6033***********************************************************
  6034*  2830-MOVE-DATA                                         *
  6035***********************************************************
  6036*                                                         *
  6037*  BUILD ONLINE CERT MASTER RECORD FROM THE BATCH CERT    *
  6038*  MASTER RECORD.                                         *
  6039*                                                         *
  6040***********************************************************
  6041****  STRAIGHT MOVES FROM BATCH CERT TO ONLINE CERT    ****
  6042***********************************************************
  6043
  6044 2830-MOVE-DATA.
  6045
  6046     MOVE 'CM'                   TO CM-RECORD-ID.
  6047     MOVE LOW-VALUES             TO CM-STATUS-DATA.
  6048     MOVE SPACE                  TO CM-CLAIM-INTERFACE-SW.
  6049     MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
  6050                                    CM-CREDIT-INTERFACE-SW-2.
  6051     MOVE ZERO                   TO CM-CLAIM-ATTACHED-COUNT
  6052                                    CM-LOAN-BALANCE
  6053                                    CM-LF-REMAINING-AMT.
  6054
  6055     MOVE CR-LFRFND              TO CM-LF-ITD-CANCEL-AMT.
  6056     MOVE CR-DTHAMT              TO CM-LF-ITD-DEATH-AMT.
  6057     MOVE CR-AHRFND              TO CM-AH-ITD-CANCEL-AMT.
  6058     MOVE CR-RATING-CLASS        TO CM-RATE-CLASS.
  6059     if dte-client = 'AHL'
  6060        move cr-lf-class-cd      to cm-lf-class-cd
  6061        move cr-ah-class-cd      to cm-ah-class-cd
  6062     end-if
  6063
  6064     if cr-temp-epiq = 'EPIQ'
  6065        add 1 to ws-epiq-cert-added
  6066        MOVE 'EQ'                to cm-temp-epiq
  6067     else
  6068        move spaces              to cm-temp-epiq
  6069     end-if
  6070
  6071     MOVE CR-AH-DEV-CODE         TO CM-AH-DEV-CODE.
  6072     MOVE CR-LF-DEV-CODE         TO CM-LF-DEV-CODE.
  6073     MOVE CR-AH-DEV-PCT          TO CM-AH-DEV-PCT.
  6074     MOVE CR-LF-DEV-PCT          TO CM-LF-DEV-PCT.
  6075     MOVE CR-APR                 TO CM-LOAN-APR.
  6076     MOVE CR-PMT-EXTENSION-DAYS  TO CM-PMT-EXTENSION-DAYS
  6077     MOVE CR-PMT-FREQ            TO CM-PAY-FREQUENCY.
  6078     MOVE CR-LOAN-TERM           TO CM-LOAN-TERM
  6079     MOVE CR-LF-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
  6080     MOVE CR-LOAN-OFFICER        TO CM-LOAN-OFFICER.
  6081     MOVE CR-JOINT-NAME          TO CM-JOINT-INSURED-NAME.
  6082     MOVE CR-FNAME               TO CM-INSURED-FIRST-NAME.
  6083     MOVE CR-CLP-STATE           TO CM-CLP-STATE
  6084     if dte-client not = 'AHL'
  6085        MOVE CR-USER-FUTURE         TO CM-USER-RESERVED
  6086     end-if
  6087
  6088*    IF CR-CLAIM-DEDUCT-WITHHELD NUMERIC
  6089*        MOVE CR-CLAIM-DEDUCT-WITHHELD
  6090*                                 TO CM-CLAIM-DEDUCT-WITHHELD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 128
* EL331.cbl
  6091*    ELSE
  6092*        MOVE ZEROS               TO CM-CLAIM-DEDUCT-WITHHELD.
  6093*    IF CR-CANCEL-DEDUCT-WITHHELD NUMERIC
  6094*        MOVE CR-CANCEL-DEDUCT-WITHHELD
  6095*                                 TO CM-CANCEL-DEDUCT-WITHHELD
  6096*    ELSE
  6097*        MOVE ZEROS               TO CM-CANCEL-DEDUCT-WITHHELD.
  6098
  6099     MOVE CR-CSR-CODE             TO CM-CSR-CODE.
  6100     MOVE CR-USER-CODE            TO CM-USER-FIELD.
  6101     MOVE CR-UNDERWRITING-CODE    TO CM-UNDERWRITING-CODE.
  6102
  6103     IF CR-ADDL-CLP NOT NUMERIC
  6104        MOVE ZEROS                TO CR-ADDL-CLP
  6105     END-IF
  6106     IF CR-LF-CLP NOT NUMERIC
  6107        MOVE ZEROS                TO CR-LF-CLP
  6108     END-IF
  6109     IF CR-AH-CLP NOT NUMERIC
  6110        MOVE ZEROS                TO CR-AH-CLP
  6111     END-IF
  6112     IF DTE-CLIENT = 'DCC'
  6113        MOVE CR-ADDL-CLP         TO CM-ADDL-CLP
  6114        MOVE CR-LF-CLP           TO CM-LF-CLP
  6115        MOVE CR-AH-CLP           TO CM-AH-CLP
  6116        MOVE CR-DDF-IU-RATE-UP   TO CM-DDF-IU-RATE-UP
  6117     END-IF
  6118
  6119     IF CR-NH-INT-ON-REF     NUMERIC
  6120         MOVE CR-NH-INT-ON-REF    TO CM-NH-INT-ON-REFS
  6121     ELSE
  6122         MOVE ZEROS               TO CM-NH-INT-ON-REFS.
  6123
  6124     IF DTE-CLIENT EQUAL 'FIA'
  6125         INSPECT CR-LNAME REPLACING ALL '0' BY ' '
  6126         INSPECT CR-LNAME REPLACING ALL '{' BY ' '.
  6127
  6128     IF CR-LNAME IS EQUAL TO SPACES
  6129         NEXT SENTENCE
  6130     ELSE
  6131         MOVE CR-LNAME          TO CM-INSURED-LAST-NAME.
  6132
  6133     IF CR-MEMBER-NO IS EQUAL TO SPACES
  6134         MOVE CR-STATE          TO CM-MEMB-STATE
  6135         MOVE CR-ACCT-PRIME     TO CM-MEMB-ACCOUNT
  6136         MOVE CR-LNAME          TO CM-PART-LAST-NAME-A5
  6137         MOVE CM-INSURED-INITIALS TO CM-INSURED-INITIALS-A5
  6138     ELSE
  6139         MOVE CR-MEMBER-NO      TO CM-MEMBER-NO.
  6140
  6141     IF CM-POLICY-FORM-NO EQUAL SPACES
  6142         MOVE CR-POLICY-FORM-NO  TO CM-POLICY-FORM-NO.
  6143
  6144     IF CR-IND-GRP EQUAL '1' OR 'I'
  6145         MOVE 'I'                TO CM-IND-GRP-TYPE
  6146      ELSE
  6147         MOVE 'G'                TO CM-IND-GRP-TYPE.
  6148
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 129
* EL331.cbl
  6149     MOVE SPACE                  TO CM-PAYMENT-MODE.
  6150     MOVE WS-CM-ENTRY-BATCH      TO CM-ENTRY-BATCH.
  6151     MOVE CR-REIN-TABLE          TO CM-REIN-TABLE.
  6152     MOVE CR-REIN-SPEC           TO CM-SPECIAL-REIN-CODE.
  6153
  6154     MOVE SPACE                  TO CM-SKIP-CODE.
  6155     IF CR-SKIP = 01
  6156        MOVE '1'                 TO CM-SKIP-CODE.
  6157     IF CR-SKIP = 02
  6158        MOVE '2'                 TO CM-SKIP-CODE.
  6159     IF CR-SKIP = 03
  6160        MOVE '3'                 TO CM-SKIP-CODE.
  6161     IF CR-SKIP = 04
  6162        MOVE '4'                 TO CM-SKIP-CODE.
  6163     IF CR-SKIP = 05
  6164        MOVE '5'                 TO CM-SKIP-CODE.
  6165     IF CR-SKIP = 06
  6166        MOVE '6'                 TO CM-SKIP-CODE.
  6167     IF CR-SKIP = 07
  6168        MOVE '7'                 TO CM-SKIP-CODE.
  6169     IF CR-SKIP = 08
  6170        MOVE '8'                 TO CM-SKIP-CODE.
  6171     IF CR-SKIP = 09
  6172        MOVE '9'                 TO CM-SKIP-CODE.
  6173     IF CR-SKIP = 10
  6174        MOVE 'A'                 TO CM-SKIP-CODE.
  6175     IF CR-SKIP = 11
  6176        MOVE 'X'                 TO CM-SKIP-CODE.
  6177
  6178     MOVE ZERO                   TO CM-LIFE-COMM-PCT
  6179                                    CM-AH-COMM-PCT.
  6180
  6181     MOVE +1                     TO WS-LEVEL-INDEX.
  6182
  6183 2830-LOAD-COMM-PCTS.
  6184
  6185     IF (CR-AGT-TYPE (WS-LEVEL-INDEX) EQUAL 'C' OR 'D'
  6186                  OR 'F')
  6187         MOVE CR-LCOM-L (WS-LEVEL-INDEX)  TO CM-LIFE-COMM-PCT
  6188         MOVE CR-LCOM-AH (WS-LEVEL-INDEX) TO CM-AH-COMM-PCT
  6189         GO TO 2830-COMM-LOAD-END
  6190     ELSE
  6191         ADD +1 TO WS-LEVEL-INDEX
  6192         IF WS-LEVEL-INDEX GREATER +10
  6193             NEXT SENTENCE
  6194         ELSE
  6195              GO TO 2830-LOAD-COMM-PCTS.
  6196
  6197 2830-COMM-LOAD-END.
  6198
  6199**************************************
  6200*  PREMIUM TYPE (2) EQUAL O.B. COVERAGE *
  6201*  PREMIUM TYPE (3) EQUAL OPEN END   *
  6202**************************************
  6203***********************************************************
  6204****  MOVES FROM BATCH CERT TO ONLINE CERT ONLY FOR    ****
  6205****  SINGLE PREMIUM CERTS.                            ****
  6206***********************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 130
* EL331.cbl
  6207
  6208     IF MATCHED-REC
  6209       AND CM-PREMIUM-TYPE EQUAL ('2' OR '3')
  6210          GO TO 2830-OB-ADJUST-END.
  6211
  6212     IF MATCHED-REC   AND
  6213       (CR-LFPRM + CR-AHPRM) LESS +.05
  6214          GO TO 2830-OB-ADJUST-END.
  6215
  6216     MOVE CR-AGE                 TO CM-INSURED-ISSUE-AGE.
  6217     MOVE CR-JOINT-AGE           TO CM-INSURED-JOINT-AGE
  6218     MOVE CR-SEX                 TO CM-INSURED-SEX.
  6219     MOVE CR-LFTYP               TO CM-LF-BENEFIT-CD.
  6220     MOVE CR-LF-TERM             TO CM-LF-ORIG-TERM.
  6221     MOVE CR-LFAMT               TO CM-LF-BENEFIT-AMT.
  6222     MOVE CR-LFAMT-ALT           TO CM-LF-ALT-BENEFIT-AMT.
  6223     MOVE CR-LFPRM               TO CM-LF-PREMIUM-AMT.
  6224     MOVE CR-LFPRM-ALT           TO CM-LF-ALT-PREMIUM-AMT.
  6225     MOVE CR-LF-NSP-PRM          TO CM-LF-NSP-PREMIUM-AMT.
  6226     MOVE CR-AH-NSP-PRM          TO CM-AH-NSP-PREMIUM-AMT.
  6227     MOVE CR-LFPRM-RATE          TO CM-LF-PREMIUM-RATE.
  6228     MOVE CR-LFPRM-RATE-ALT      TO CM-LF-ALT-PREMIUM-RATE.
  6229     MOVE CR-LF-CRIT-PERIOD      TO CM-LF-CRITICAL-PERIOD.
  6230     MOVE CR-AH-CRIT-PERIOD      TO CM-AH-CRITICAL-PERIOD.
  6231     MOVE CR-AHTYP               TO CM-AH-BENEFIT-CD.
  6232     MOVE CR-AH-TERM             TO CM-AH-ORIG-TERM.
  6233     MOVE CR-AHAMT               TO CM-AH-BENEFIT-AMT.
  6234     MOVE CR-AHPRM               TO CM-AH-PREMIUM-AMT.
  6235     MOVE CR-AHPRM-RATE          TO CM-AH-PREMIUM-RATE.
  6236     MOVE CR-DISAMT              TO CM-AH-ITD-AH-PMT.
  6237     MOVE '1'                    TO CM-PREMIUM-TYPE.
  6238
  6239     IF DTE-CLIENT NOT = 'DCC'
  6240        MOVE ZERO                TO CM-LIVES
  6241     END-IF
  6242     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  6243     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  6244
  6245 2830-LF-OB-ADJUST.
  6246
  6247******************************************************************
  6248****  SEARCH BENEFIT TABLE TO DETERMINE BENEFITS PREMIUM TYPE  ***
  6249******************************************************************
  6250
  6251     IF CM-LF-BENEFIT-CD EQUAL ZERO
  6252        GO TO 2830-AH-OB-ADJUST.
  6253
  6254     IF CLAS-INDEXL GREATER CLAS-MAXL
  6255         GO TO 2830-AH-OB-ADJUST.
  6256
  6257     IF CM-LF-BENEFIT-CD EQUAL CLAS-I-BEN (CLAS-INDEXL)
  6258         PERFORM  4100-REVIEW-LIFE     THRU 4100-LF-EXIT
  6259            GO TO 2830-AH-OB-ADJUST.
  6260
  6261     ADD +1                      TO CLAS-INDEXL.
  6262     GO TO 2830-LF-OB-ADJUST.
  6263
  6264 2830-AH-OB-ADJUST.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 131
* EL331.cbl
  6265
  6266******************************************************************
  6267****  SEARCH BENEFIT TABLE TO DETERMINE BENEFITS PREMIUM TYPE  ***
  6268******************************************************************
  6269
  6270     IF CM-AH-BENEFIT-CD EQUAL ZERO
  6271        GO TO 2830-OB-ADJUST-END.
  6272
  6273     IF CLAS-INDEXA GREATER CLAS-MAXA
  6274         GO TO 2830-OB-ADJUST-END.
  6275
  6276     IF CM-AH-BENEFIT-CD EQUAL CLAS-I-BEN (CLAS-INDEXA)
  6277         PERFORM 4100-REVIEW-AH  THRU 4100-AH-EXIT
  6278            GO TO 2830-OB-ADJUST-END.
  6279
  6280     ADD +1                      TO CLAS-INDEXA.
  6281     GO TO 2830-AH-OB-ADJUST.
  6282
  6283 2830-OB-ADJUST-END.
  6284
  6285
  6286 2830-SUM-ADJUST-END.
  6287
  6288     IF CR-AH-LUMP-SUM-DISAB
  6289         MOVE CR-DTHAMT         TO CM-AH-ITD-LUMP-PMT
  6290     ELSE
  6291         MOVE ZEROS             TO CM-AH-ITD-LUMP-PMT.
  6292
  6293     MOVE 'L'                   TO DC-OPTION-CODE.
  6294     MOVE LOW-VALUE             TO CM-AH-PAID-THRU-DT.
  6295     MOVE CR-DIS-PTO-DT         TO DC-GREG-DATE-CYMD.
  6296
  6297     IF CR-DIS-PTO-DT NOT EQUAL ZERO
  6298         PERFORM 7100-DATE-RTN THRU 7100-EXIT
  6299         IF NO-CONVERSION-ERROR
  6300            MOVE DC-BIN-DATE-1  TO CM-AH-PAID-THRU-DT.
  6301
  6302     MOVE LOW-VALUE             TO CM-AH-CANCEL-DT
  6303                                   CM-LF-CANCEL-DT.
  6304
  6305     MOVE 'L'                   TO DC-OPTION-CODE.
  6306     MOVE CR-LF-CANC-DT         TO DC-GREG-DATE-CYMD.
  6307
  6308     IF CR-LF-CANC-DT NOT EQUAL ZERO
  6309         PERFORM 7100-DATE-RTN  THRU   7100-EXIT
  6310         IF NO-CONVERSION-ERROR
  6311            MOVE DC-BIN-DATE-1   TO CM-LF-CANCEL-DT.
  6312
  6313     MOVE 'L'                    TO DC-OPTION-CODE.
  6314     MOVE CR-AH-CANC-DT          TO DC-GREG-DATE-CYMD.
  6315
  6316     IF CR-AH-CANC-DT NOT EQUAL ZERO
  6317         PERFORM 7100-DATE-RTN  THRU   7100-EXIT
  6318         IF NO-CONVERSION-ERROR
  6319            MOVE DC-BIN-DATE-1   TO CM-AH-CANCEL-DT.
  6320
  6321     MOVE LOW-VALUE              TO CM-AH-SETTLEMENT-DT.
  6322
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 132
* EL331.cbl
  6323     IF CR-AH-LUMP-SUM-DISAB   OR
  6324        CR-AH-STATUS-AT-CANCEL EQUAL 6
  6325          IF CR-DIS-DT NOT EQUAL ZERO
  6326             MOVE CR-DIS-DT      TO DC-GREG-DATE-CYMD
  6327             MOVE 'L'            TO DC-OPTION-CODE
  6328             PERFORM 7100-DATE-RTN  THRU   7100-EXIT
  6329              IF NO-CONVERSION-ERROR
  6330                  MOVE DC-BIN-DATE-1 TO CM-AH-SETTLEMENT-DT.
  6331
  6332     MOVE CR-ENTRY-STATUS        TO CM-ENTRY-STATUS.
  6333
  6334     MOVE CR-LF-CURRENT-STATUS   TO  CM-LF-CURRENT-STATUS.
  6335     MOVE CR-LF-STATUS-AT-DEATH  TO  CM-LF-STATUS-AT-DEATH.
  6336     MOVE CR-LF-STATUS-AT-CANCEL TO  CM-LF-STATUS-AT-CANCEL.
  6337
  6338     MOVE CR-AH-CURRENT-STATUS   TO CM-AH-CURRENT-STATUS.
  6339     MOVE CR-AH-STATUS-AT-SETTLEMENT
  6340                                 TO CM-AH-STATUS-AT-SETTLEMENT.
  6341     MOVE CR-AH-STATUS-AT-CANCEL TO CM-AH-STATUS-AT-CANCEL.
  6342
  6343     MOVE 'L'                    TO DC-OPTION-CODE.
  6344     MOVE LOW-VALUES             TO CM-LF-DEATH-DT.
  6345     MOVE CR-DTH-DT              TO DC-GREG-DATE-CYMD.
  6346     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6347     IF NO-CONVERSION-ERROR
  6348         MOVE DC-BIN-DATE-1      TO CM-LF-DEATH-DT
  6349     ELSE
  6350         MOVE LOW-VALUES         TO CM-LF-DEATH-DT.
  6351
  6352     IF CR-LF-EXPIRE-DATE NOT NUMERIC
  6353         MOVE ZERO               TO CR-LF-EXPIRE-DATE.
  6354
  6355     MOVE 'L'                    TO DC-OPTION-CODE.
  6356     MOVE CR-LF-EXPIRE-DATE      TO DC-GREG-DATE-CYMD.
  6357
  6358     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6359     IF NO-CONVERSION-ERROR
  6360         MOVE DC-BIN-DATE-1      TO CM-LF-LOAN-EXPIRE-DT
  6361     ELSE
  6362         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
  6363
  6364     IF CR-AH-EXPIRE-DATE NOT NUMERIC
  6365         MOVE ZERO               TO CR-AH-EXPIRE-DATE.
  6366
  6367     MOVE 'L'                    TO DC-OPTION-CODE.
  6368     MOVE CR-AH-EXPIRE-DATE      TO DC-GREG-DATE-CYMD
  6369     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6370     IF NO-CONVERSION-ERROR
  6371         MOVE DC-BIN-DATE-1      TO CM-AH-LOAN-EXPIRE-DT
  6372     ELSE
  6373         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
  6374
  6375     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  6376         MOVE ZERO               TO CR-LOAN-1ST-PMT-DT.
  6377
  6378     MOVE '3'                    TO DC-OPTION-CODE.
  6379     MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD.
  6380     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 133
* EL331.cbl
  6381     IF NO-CONVERSION-ERROR
  6382         MOVE DC-BIN-DATE-1      TO CM-LOAN-1ST-PMT-DT
  6383     ELSE
  6384         MOVE LOW-VALUES         TO CM-LOAN-1ST-PMT-DT.
  6385
  6386     MOVE CR-LAST-ADD-ON-DT      TO CM-LAST-ADD-ON-DT.
  6387
  6388     MOVE 'L'                    TO DC-OPTION-CODE.
  6389     MOVE CR-ENTRY-DATE          TO DC-GREG-DATE-CYMD.
  6390     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6391     IF NO-CONVERSION-ERROR
  6392         MOVE DC-BIN-DATE-1      TO CM-ENTRY-DT
  6393     ELSE
  6394         MOVE LOW-VALUES         TO CM-ENTRY-DT.
  6395
  6396     IF CR-LF-CANCEL-EXIT-DATE NOT EQUAL ZEROS
  6397         MOVE CR-LF-CANCEL-EXIT-DATE TO DC-GREG-DATE-CYMD
  6398         MOVE  'L'                   TO DC-OPTION-CODE
  6399         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6400         IF NO-CONVERSION-ERROR
  6401             MOVE DC-BIN-DATE-1      TO CM-LF-CANCEL-EXIT-DT.
  6402
  6403     IF CR-AH-CANCEL-EXIT-DATE NOT EQUAL ZEROS
  6404         MOVE CR-AH-CANCEL-EXIT-DATE TO DC-GREG-DATE-CYMD
  6405         MOVE  'L'                   TO DC-OPTION-CODE
  6406         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6407         IF NO-CONVERSION-ERROR
  6408             MOVE DC-BIN-DATE-1      TO CM-AH-CANCEL-EXIT-DT.
  6409
  6410     IF CR-LF-CLAIM-EXIT-DATE NOT EQUAL ZEROS
  6411         MOVE CR-LF-CLAIM-EXIT-DATE  TO DC-GREG-DATE-CYMD
  6412         MOVE  'L'                  TO DC-OPTION-CODE
  6413         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6414         IF NO-CONVERSION-ERROR
  6415             MOVE DC-BIN-DATE-1     TO CM-LF-DEATH-EXIT-DT.
  6416
  6417     IF CR-AH-SETTLEMENT-EXIT-DATE NOT EQUAL ZEROS
  6418         MOVE CR-AH-SETTLEMENT-EXIT-DATE TO DC-GREG-DATE-CYMD
  6419         MOVE  'L'                  TO DC-OPTION-CODE
  6420         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6421         IF NO-CONVERSION-ERROR
  6422             MOVE DC-BIN-DATE-1     TO CM-AH-SETTLEMENT-EXIT-DT.
  6423
  6424 2830-EXIT.
  6425      EXIT.
  6426
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 134
* EL331.cbl
  6428 4000-EXPIRE-DATE.
  6429
  6430     IF CM-PREMIUM-TYPE  EQUAL '1'
  6431         GO TO 4099-EXIT.
  6432
  6433     IF CM-LF-ORIG-TERM  NOT NUMERIC
  6434         GO TO 4020-CHECK-AH.
  6435
  6436     IF CM-LF-ORIG-TERM  GREATER  +1
  6437         NEXT SENTENCE
  6438     ELSE
  6439         GO TO 4020-CHECK-AH.
  6440
  6441     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6442     MOVE CM-LF-ORIG-TERM        TO  DC-ELAPSED-MONTHS.
  6443     MOVE ZEROS                  TO  DC-ODD-DAYS-OVER.
  6444     MOVE ZEROS                  TO  DC-ELAPSED-DAYS.
  6445     MOVE '6'                    TO  DC-OPTION-CODE.
  6446
  6447     PERFORM 7100-DATE-RTN  THRU  7100-EXIT.
  6448
  6449     IF NO-CONVERSION-ERROR
  6450         MOVE DC-BIN-DATE-2      TO  CM-LF-LOAN-EXPIRE-DT
  6451     ELSE
  6452         MOVE LOW-VALUES         TO  CM-LF-LOAN-EXPIRE-DT.
  6453
  6454 4020-CHECK-AH.
  6455
  6456     IF CM-AH-ORIG-TERM  NOT NUMERIC
  6457         GO TO 4099-EXIT.
  6458
  6459     IF CM-AH-ORIG-TERM  GREATER  +1
  6460         NEXT SENTENCE
  6461     ELSE
  6462         GO TO 4099-EXIT.
  6463
  6464     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6465     MOVE CM-AH-ORIG-TERM        TO  DC-ELAPSED-MONTHS.
  6466     MOVE ZEROS                  TO  DC-ODD-DAYS-OVER.
  6467     MOVE ZEROS                  TO  DC-ELAPSED-DAYS.
  6468     MOVE '6'                    TO  DC-OPTION-CODE.
  6469
  6470     PERFORM 7100-DATE-RTN  THRU  7100-EXIT.
  6471
  6472     IF NO-CONVERSION-ERROR
  6473         MOVE DC-BIN-DATE-2      TO  CM-AH-LOAN-EXPIRE-DT
  6474     ELSE
  6475         MOVE LOW-VALUES         TO  CM-AH-LOAN-EXPIRE-DT.
  6476
  6477 4099-EXIT.
  6478     EXIT.
  6479******************************************************************
  6480****  SEARCH BENEFIT TABLE TO DETERMINE IF SUMMARY COVERAGE    ***
  6481******************************************************************
  6482
  6483 4100-REVIEW-LIFE.
  6484
  6485     IF CLAS-I-BAL (CLAS-INDEXL) EQUAL 'B'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 135
* EL331.cbl
  6486        MOVE '2'                 TO CM-PREMIUM-TYPE
  6487        GO TO 4100-LF-EXIT.
  6488
  6489     IF ((CR-LFTYP NOT EQUAL ZERO) AND
  6490         (CLAS-I-BAL (CLAS-INDEXL) EQUAL 'Z'))
  6491         NEXT SENTENCE
  6492      ELSE
  6493         GO TO 4100-LF-EXIT.
  6494
  6495     IF CR-LIVES NOT NUMERIC
  6496         MOVE ZERO               TO CR-LIVES.
  6497     IF CR-SUM-CAN-CNT-ITD NOT NUMERIC
  6498         MOVE ZERO               TO CR-SUM-CAN-CNT-ITD.
  6499
  6500     COMPUTE CM-LIVES EQUAL
  6501           CR-LIVES - CR-SUM-CAN-CNT-ITD.
  6502
  6503 4100-LF-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 136
* EL331.cbl
  6505 4100-REVIEW-AH.
  6506     IF CLAS-I-BAL (CLAS-INDEXA) EQUAL 'B'
  6507        MOVE '2'             TO CM-PREMIUM-TYPE
  6508        GO TO 4100-AH-EXIT.
  6509
  6510     IF ((CR-AHTYP NOT EQUAL ZERO) AND
  6511         (CLAS-I-BAL (CLAS-INDEXA) EQUAL 'Z'))
  6512         NEXT SENTENCE
  6513      ELSE
  6514         GO TO 4100-AH-EXIT.
  6515
  6516     IF CR-LIVES NOT NUMERIC
  6517         MOVE ZERO               TO CR-LIVES.
  6518     IF CR-SUM-CAN-CNT-ITD NOT NUMERIC
  6519         MOVE ZERO               TO CR-SUM-CAN-CNT-ITD.
  6520
  6521     COMPUTE CM-LIVES EQUAL
  6522           CR-LIVES - CR-SUM-CAN-CNT-ITD.
  6523
  6524 4100-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 137
* EL331.cbl
  6527****************************************************************
  6528*  7000-INITIALIZE                                             *
  6529****************************************************************
  6530*                                                              *
  6531*  1) IF CLASIC CLAIMS SYSTEM PRESENT   OPEN INPUT (ELMSTR5)   *
  6532*     ALTERNATE PATH (5) OF CLAIM MASTER FILE ACCESSED THRU    *
  6533*     CL-CONTROL-BY-CERT-NO.                                   *
  6534*                                                              *
  6535*  1A) IF CLASIC CLAIMS SYSTEM PRESENT  OPEN INPUT (ELRETR5)   *
  6536*     ALTERNATE PATH (5) OF RETRIEVE MSTR FILE ACCESSED THRU   *
  6537*     RL-CONTROL-BY-CERT-NO.                                   *
  6538*                                                              *
  6539*  2) OPEN I/O (ELCERTF)   ONLINE CERTIFICATE MASTER FILE      *
  6540*     ACCESSED THRU CM-CONTROL-PRIMARY AND ISSUE START TO SET  *
  6541*     VSAM POINTER.                                            *
  6542*                                                              *
  6543*  3) OPEN I/O (ERMAIL)   CERTIFICATE MASTER NAME AND ADDRESS  *
  6544*     FILE ACCESSED THRU MA-CONTROL-PRIMARY.                   *
  6545*                                                              *
  6546*  4) OPEN INPUT (ECSCRT01)   BATCH CERTIFICATE MASTER FILE.   *
  6547*                                                              *
  6548*  5) OPEN OUTPUT (PRNTR)   PRINT FILE.                        *
  6549*                                                              *
  6550*  6) OPEN INPUT (ERACCT)   ACCOUNT MASTER FILE ACCESSED THRU  *
  6551*     AM-CONTROL-PRIMARY AND ISSUE START TO SET VSAM POINTER.  *
  6552*                                                              *
  6553*  7) OPEN I/O (ERCOMM)   CERTIFICATE MASTER COMMISSION STRUC- *
  6554*     TURE ACCESSED THRU CE-CONTROL-PRIMARY. THE COMMISSION    *
  6555*     STRUCTURE OF THE CERTIFICATE VARIES FROM THE COMMISSION  *
  6556*     STRUCTURE FOR THE ASSOCIATED ACCOUNT MASTER.             *
  6557*                                                              *
  6558****************************************************************
  6559
  6560 7000-INITIALIZE.
  6561
  6562     IF DTE-SYS-E-CLASIC-CLAIMS EQUAL 'Y'
  6563         OPEN INPUT  ELMSTR5
  6564         IF (CL-STAT-1  NOT EQUAL '0') AND
  6565            (CL-STATUS NOT EQUAL '97')
  6566             MOVE 'ERROR OCCURED OPEN - ELMSTR'
  6567                                 TO  WS-ABEND-MESSAGE
  6568             MOVE CL-STATUS      TO  WS-ABEND-FILE-STATUS
  6569             GO TO ABEND-PGM
  6570         END-IF
  6571         OPEN INPUT  ELRETR5
  6572         IF ELRETR5-FILE-STATUS NOT = '00' AND '97'
  6573             MOVE 'ERROR OCCURRED OPEN - ELRETR'
  6574                                      TO WS-ABEND-MESSAGE
  6575             MOVE ELRETR5-FILE-STATUS TO WS-ABEND-FILE-STATUS
  6576             GO TO ABEND-PGM.
  6577
  6578     OPEN I-O    ELCERTF.
  6579
  6580     IF (CM-STAT-1  NOT EQUAL '0') AND
  6581        (CM-STATUS NOT EQUAL '97')
  6582         MOVE 'ERROR OCCURED OPEN - ELCERT'
  6583                                TO  WS-ABEND-MESSAGE
  6584         MOVE CM-STATUS         TO  WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 138
* EL331.cbl
  6585         GO TO ABEND-PGM.
  6586
  6587     MOVE LOW-VALUE             TO CM-CONTROL-PRIMARY.
  6588     MOVE DTE-CLASIC-COMPANY-CD TO CM-COMPANY-CD.
  6589
  6590     START ELCERTF
  6591            KEY NOT LESS CM-CONTROL-PRIMARY.
  6592
  6593     IF CM-STAT-1  NOT EQUAL '0'
  6594         MOVE 'ERROR OCCURED START - ELCERT'
  6595                                 TO  WS-ABEND-MESSAGE
  6596         MOVE CM-STATUS      TO  WS-ABEND-FILE-STATUS
  6597         GO TO ABEND-PGM.
  6598
  6599     OPEN I-O ERMAIL.
  6600
  6601     IF (CFS-STAT-1  NOT EQUAL '0') AND
  6602        (ERMAIL-FILE-STATUS NOT EQUAL '97')
  6603         MOVE 'ERROR OCCURED OPEN - ERMAIL'
  6604                                  TO  WS-ABEND-MESSAGE
  6605         MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  6606         GO TO ABEND-PGM.
  6607
  6608     OPEN INPUT ECSCRT01
  6609                ERCTBL.
  6610
  6611     IF ERCTBL-FILE-STATUS NOT = '00' AND '97'
  6612         MOVE 'ERROR OCCURED OPEN - ERCTBL'
  6613                                  TO  WS-ABEND-MESSAGE
  6614         MOVE ERCTBL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  6615         GO TO ABEND-PGM.
  6616
  6617     OPEN OUTPUT PRNTR
  6618                 ME50-EL331-BALANCE
  6619                 DISPLAY-PRT.
  6620
  6621     MOVE 1  TO WS-PAGE-CNT.
  6622
  6623     MOVE WS-CURRENT-DATE TO DIS-DATE.
  6624
  6625     PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
  6626
  6627     MOVE LOW-VALUES TO WS-SAVED-ECS-KEY
  6628                        WS-SAVED-ONL-KEY
  6629                        WS-CLAIM-MATCH-KEY
  6630                        WS-SEC-CLAIM-INDEX.
  6631
  6632     MOVE WS-CURRENT-DATE TO HD-RUN-DATE.
  6633
  6634     MOVE WS-CD-MM        TO WS-CURR-MO.
  6635     MOVE WS-CD-DD        TO WS-CURR-DA.
  6636     MOVE WS-CD-YY        TO WS-CURR-YR.
  6637
  6638     COMPUTE WS-CURRENT-MOS EQUAL (RUN-CCYY * 12) + RUN-MO.
  6639
  6640     MOVE ALPH-DATE     TO HD-DATE-FULL.
  6641     MOVE COMPANY-NAME  TO HD-COMP-NM.
  6642
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 139
* EL331.cbl
  6643     PERFORM 7500-HEADING-RTN  THRU 7500-EXIT.
  6644
  6645     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  6646        DTE-SYS-G-AR-USED     EQUAL '1'
  6647          NEXT SENTENCE
  6648     ELSE
  6649         GO TO 7000-EXIT.
  6650
  6651     OPEN INPUT ERACCT.
  6652
  6653     IF (AM-STAT-1  NOT EQUAL '0') AND
  6654        (AM-STATUSF NOT EQUAL '97')
  6655         MOVE 'ERROR OCCURED OPEN - ERACCT'
  6656                             TO  WS-ABEND-MESSAGE
  6657         MOVE AM-STATUSF     TO  WS-ABEND-FILE-STATUS
  6658         GO TO ABEND-PGM.
  6659
  6660     MOVE LOW-VALUES            TO AM-CONTROL-PRIMARY.
  6661     MOVE DTE-CLASIC-COMPANY-CD TO AM-COMPANY-CD.
  6662     START ERACCT
  6663            KEY NOT LESS AM-CONTROL-PRIMARY.
  6664
  6665     IF AM-STAT-1  NOT EQUAL '0'
  6666         MOVE 'ERROR OCCURED START - ERACCT'
  6667                                 TO  WS-ABEND-MESSAGE
  6668         MOVE AM-STATUSF     TO  WS-ABEND-FILE-STATUS
  6669         GO TO ABEND-PGM.
  6670
  6671     OPEN I-O ERCOMM.
  6672
  6673     IF (CE-STAT-1  NOT EQUAL '0') AND
  6674        (CE-STATUS NOT EQUAL '97')
  6675         MOVE 'ERROR OCCURED OPEN - ERCOMM'
  6676                                 TO  WS-ABEND-MESSAGE
  6677         MOVE CE-STATUS          TO  WS-ABEND-FILE-STATUS
  6678         GO TO ABEND-PGM.
  6679
  6680 7000-EXIT.
  6681      EXIT.
  6682
  6683 7100-DATE-RTN.
  6684     CALL 'ELDATCX'  USING DATE-CONVERSION-DATA.
  6685
  6686     IF DC-ERROR-CODE NOT EQUAL SPACE
  6687         MOVE  ZEROS             TO DC-CONVERSION-DATES.
  6688
  6689 7100-EXIT.
  6690      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 140
* EL331.cbl
  6692 7300-BLD-ECS-PRT-LINE.
  6693     MOVE CR-CERT-NO             TO DTL-CERT-NO.
  6694     MOVE CR-YR                  TO DTL-EFF-YR.
  6695     MOVE CR-MO                  TO DTL-EFF-MO.
  6696     MOVE CR-DA                  TO DTL-EFF-DA.
  6697     MOVE CR-CARRIER             TO DTL-CARR.
  6698     MOVE CR-GROUPING            TO DTL-GRPG.
  6699     MOVE CR-STATE               TO DTL-STAT.
  6700     MOVE CR-ACCOUNT             TO DTL-ACCT.
  6701     MOVE 'X'                    TO WS-PRT-FULL-LINE-SW.
  6702
  6703 7300-EXIT.
  6704      EXIT.
  6705
  6706 7320-BLD-ONL-PRT-LINE.
  6707     MOVE CM-CERT-NO             TO DTL-CERT-NO.
  6708
  6709     MOVE ' '                    TO DC-OPTION-CODE.
  6710     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
  6711     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6712     MOVE DC-GREG-DATE-1-EDIT    TO DTL-EFFECTIVE-DT.
  6713     MOVE CM-CARRIER             TO DTL-CARR.
  6714     MOVE CM-GROUPING            TO DTL-GRPG.
  6715     MOVE CM-STATE               TO DTL-STAT.
  6716     MOVE CM-ACCOUNT             TO DTL-ACCT.
  6717
  6718 7320-EXIT.
  6719      EXIT.
  6720
  6721 7350-BLD-CLM-INFO.
  6722     IF NO-ASSOCIATED-CLAIM
  6723        MOVE SPACES              TO  DTL-CL-NO
  6724                                     DTL-CL-TYPE
  6725                                     DTL-CL-STATUS
  6726                                     DTL-CL-LN-KIND
  6727                                     DTL-CL-INCURRED
  6728                                     DTL-CL-PROCESSOR
  6729        GO TO 7350-EXIT.
  6730
  6731     MOVE SPACES                 TO  DTL-CL-TYPE
  6732                                     DTL-CL-STATUS
  6733                                     DTL-CL-LN-KIND.
  6734
  6735     MOVE CL-CLAIM-NO            TO DTL-CL-NO.
  6736
  6737     evaluate true
  6738        when cl-claim-type = life-override-l1
  6739           move life-override-l2 to dtl-cl-type
  6740        when cl-claim-type = 'F'
  6741           move 'FL'             to dtl-cl-type
  6742        when cl-claim-type = 'I'
  6743           move 'IU'             to dtl-cl-type
  6744        when cl-claim-type =  'G'
  6745           MOVE 'GP'             to dtl-cl-type
  6746        when other
  6747           move ah-override-l2   to dtl-cl-type
  6748     end-evaluate
  6749
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 141
* EL331.cbl
  6750     IF CLAIM-IS-OPEN
  6751        MOVE ' OPEN '            TO DTL-CL-STATUS
  6752      ELSE
  6753        IF CLAIM-IS-CLOSED
  6754            MOVE 'CLOSED'        TO DTL-CL-STATUS.
  6755
  6756     IF SINGLE-PREMIUM
  6757        MOVE 'SNG PRM'           TO DTL-CL-LN-KIND
  6758       ELSE
  6759        IF O-B-COVERAGE
  6760            MOVE '  O.B. '       TO DTL-CL-LN-KIND
  6761         ELSE
  6762          IF OPEN-END-COVERAGE
  6763              MOVE 'OPN END'     TO DTL-CL-LN-KIND.
  6764
  6765     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  6766     MOVE ' '                    TO DC-OPTION-CODE.
  6767     PERFORM 7100-DATE-RTN   THRU 7100-EXIT.
  6768     MOVE DC-GREG-DATE-1-EDIT    TO DTL-CL-INCURRED.
  6769     MOVE CL-PROCESSOR-ID        TO DTL-CL-PROCESSOR.
  6770
  6771 7350-EXIT.
  6772      EXIT.
  6773
  6774 7370-PRINT-DETAIL.
  6775     MOVE DTL-1                  TO P-DATA.
  6776     MOVE '0'                    TO X.
  6777     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6778     ADD  2                      TO WS-LINE-CNT.
  6779
  6780     IF WS-LINE-CNT GREATER WS-MAX-LINES
  6781          PERFORM 7500-HEADING-RTN  THRU 7500-EXIT.
  6782
  6783     MOVE SPACES                 TO DTL-1.
  6784
  6785 7370-EXIT.
  6786      EXIT.
  6787
  6788 7500-HEADING-RTN.
  6789     MOVE  WS-PAGE-CNT           TO HD-PAGE-NO.
  6790     MOVE '1'                    TO X.
  6791     MOVE HEADING-1              TO P-DATA.
  6792     PERFORM 7600-PRT-RTN   THRU 7600-EXIT.
  6793
  6794     MOVE SPACES                 TO X.
  6795     MOVE HEADING-2              TO P-DATA.
  6796     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6797
  6798     MOVE SPACES                 TO X.
  6799     MOVE HEADING-3              TO P-DATA.
  6800     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6801
  6802     MOVE SPACES                 TO X.
  6803     MOVE HEADING-4              TO P-DATA.
  6804     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6805
  6806     MOVE SPACES                 TO  X.
  6807     MOVE HEADING-5              TO P-DATA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 142
* EL331.cbl
  6808     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6809
  6810     MOVE SPACES                 TO  X.
  6811     MOVE HEADING-6              TO P-DATA.
  6812     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6813
  6814     MOVE 16                     TO WS-LINE-CNT.
  6815     ADD 1 TO WS-PAGE-CNT.
  6816
  6817 7500-EXIT.
  6818      EXIT.
  6819
  6820 7600-PRT-RTN.
*                                      COPY ELCPRT2X.
  6821******************************************************************04/15/98
  6822*                                                                *ELCPRT2X
  6823*                                                                *ELCPRT2X
  6824*                            ELCPRT2X.                           *   LV002
  6825*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6826*                            VMOD=2.002                          *   CL**2
  6827*                                                                *ELCPRT2X
  6828*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
  6829*                                                                *ELCPRT2X
  6830*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
  6831*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
  6832*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
  6833*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
  6834*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
  6835*                                                                *ELCPRT2X
  6836*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
  6837*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
  6838******************************************************************ELCPRT2X
  6839                                                                  ELCPRT2X
  6840     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
  6841         FICH-OPEN   = SPACE                                      ELCPRT2X
  6842         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
  6843         OPEN OUTPUT FICH.                                        ELCPRT2X
  6844                                                                  ELCPRT2X
  6845     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
  6846         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
  6847             OPEN I-O ELREPT                                      ELCPRT2X
  6848             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
  6849                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
  6850                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
  6851                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
  6852                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
  6853                 GO TO ABEND-PGM                                  ELCPRT2X
  6854             ELSE                                                 ELCPRT2X
  6855                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
  6856                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  6857                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
  6858                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
  6859                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
  6860                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
  6861                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
  6862                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  6863                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
  6864                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 143
* EL331.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
  6865                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
  6866                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
  6867                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
  6868                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  6869                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
  6870                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
  6871                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
  6872                                                                  ELCPRT2X
  6873     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
  6874        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
  6875         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
  6876         GO TO ABEND-PGM.                                         ELCPRT2X
  6877                                                                  ELCPRT2X
  6878     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
  6879         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
  6880         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
  6881             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
  6882                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
  6883                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
  6884                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
  6885                     INVALID KEY                                  ELCPRT2X
  6886                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
  6887                         CLOSE ELREPT                             ELCPRT2X
  6888                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
  6889                                                                  ELCPRT2X
  6890     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
  6891         MOVE X                      TO  P-CTL                    ELCPRT2X
  6892         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
  6893                                                                  ELCPRT2X
  6894     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
  6895       MOVE X                        TO  P-CTL                    ELCPRT2X
  6896       IF P-CTL = ' '                                             ELCPRT2X
  6897         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
  6898       ELSE                                                       ELCPRT2X
  6899         IF P-CTL = '0'                                           ELCPRT2X
  6900           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
  6901         ELSE                                                     ELCPRT2X
  6902           IF P-CTL = '-'                                         ELCPRT2X
  6903             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
  6904           ELSE                                                   ELCPRT2X
  6905             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
  6906                                                                  ELCPRT2X
  6907     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
  6908                                                                  ELCPRT2X
  6909 DTE-REPORT-DELETE.                                               ELCPRT2X
  6910     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
  6911         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
  6912         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
  6913                                                                  ELCPRT2X
  6914     READ ELREPT   NEXT RECORD                                    ELCPRT2X
  6915           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
  6916                                                                  ELCPRT2X
  6917     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
  6918        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
  6919         DELETE ELREPT RECORD                                     ELCPRT2X
  6920         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
  6921                                                                  ELCPRT2X
  6922 DTE-DELETE-EXIT.                                                 ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 144
* EL331.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
  6923     EXIT.                                                        ELCPRT2X
  6924                                                                  ELCPRT2X
  6925 DTE-PRINT-EXIT.                                                  ELCPRT2X
  6926     EXIT.                                                        ELCPRT2X
  6927******************************************************************ELCPRT2X
  6928 7600-PRT-CLEAR.
  6929     MOVE SPACES                 TO P-DATA.
  6930     MOVE SPACES                 TO DTL-1.
  6931
  6932 7600-EXIT.
  6933      EXIT.
  6934
  6935 8000-FINALIZE.
  6936
  6937     DISPLAY ' '.
  6938     DISPLAY '* * * * * * * * * * * * * * * * * *'.
  6939     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
  6940     DISPLAY '* * * * * * * * * * * * * * * * * *'.
  6941     DISPLAY ' '.
  6942
  6943     PERFORM 8600-DISPLAY-HD  THRU
  6944               8600-HD-EXIT.
  6945
  6946     MOVE ' DISPLAY ERROR COUNT = '    TO DIS-LINE-REASON
  6947     MOVE ERROR-COUNT                TO  DIS-LINE-REC
  6948     PERFORM 8600-DISPLAY-PRT THRU
  6949               8600-DISPLAY-EXIT.
  6950
  6951     CLOSE  DISPLAY-PRT.
  6952
  6953
  6954     MOVE ALL '*'                TO  P-DATA.
  6955     PERFORM  7600-PRT-RTN   THRU 7600-EXIT.
  6956
  6957     MOVE WS-MATCHED-ONL         TO  P-MATCHED-ONL.
  6958     MOVE WS-LOADED-ECS          TO  P-LOADED-ECS.
  6959     MOVE WS-ONL-DELETED         TO  P-ONL-DELETED.
  6960     MOVE WS-CLAIM-MATCH         TO  P-CLAIM-MATCH.
  6961     MOVE WS-INACTIVE-CERTS      TO  P-INACTIVE-CERTS.
  6962     MOVE WS-ECS-READ            TO  P-ECS-READ.
  6963
  6964     MOVE WS-ECS-READ            TO  WS-ME50-BAL-AMT-LOW.
  6965     MOVE WS-ECS-READ            TO  WS-ME50-BAL-AMT-HIGH.
  6966     MOVE WS-BAL50-DESCRIPTION   TO WS-ME50-BAL-DESCRIP.
  6967     WRITE ME50-EL331-BALANCE-REC FROM WS-ME50-BALANCE-REC.
  6968
  6969     MOVE WS-ONL-READ            TO  P-ONL-READ.
  6970     MOVE WS-EXCP-ADD            TO  P-EXCP-ADD.
  6971     MOVE WS-EXCP-DEL            TO  P-EXCP-DEL.
  6972     MOVE WS-EXCP-TBL            TO  P-EXCP-TBL.
  6973     MOVE WS-MAIL-DEL            TO  P-MAIL-DEL.
  6974     MOVE WS-ACCT-READS          TO  P-ACCT-READS.
  6975     MOVE WS-ACT-READ            TO  P-ACT-READ.
  6976     MOVE WS-ACCT-MATCH          TO  P-ACCT-MATCH.
  6977
  6978     COMPUTE WS-ONL-EXIST EQUAL
  6979             WS-ONL-READ - WS-ONL-DELETED + WS-LOADED-ECS.
  6980
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 145
* EL331.cbl
  6981     MOVE  WS-ONL-EXIST          TO  P-ONL-EXIST.
  6982
  6983     MOVE '0'                    TO X.
  6984     MOVE FTG-1                  TO P-DATA.
  6985     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6986
  6987     MOVE '0'                    TO X.
  6988     MOVE FTG-2                  TO P-DATA.
  6989     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6990
  6991     MOVE '0'                    TO X.
  6992     MOVE FTG-3                  TO P-DATA.
  6993     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6994
  6995     MOVE '0'                    TO X.
  6996     MOVE FTG-4                  TO P-DATA.
  6997     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6998
  6999     MOVE '0'                    TO X.
  7000     MOVE FTG-5                  TO P-DATA.
  7001     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  7002
  7003     MOVE '0'                    TO X.
  7004     MOVE FTG-6                  TO P-DATA.
  7005     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  7006
  7007     MOVE '0'                     TO X.
  7008     MOVE FTG-7                   TO P-DATA.
  7009     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  7010
  7011     MOVE '0'                    TO X.
  7012     MOVE FTG-8                  TO P-DATA.
  7013     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  7014
  7015     MOVE '0'                    TO X.
  7016     MOVE FTG-9                  TO P-DATA.
  7017     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  7018
  7019     MOVE '0'                    TO X.
  7020     MOVE FTG-10                 TO P-DATA.
  7021     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  7022
  7023     MOVE '0'                    TO X.
  7024     MOVE FTG-11                 TO P-DATA.
  7025     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  7026
  7027     MOVE '0'                    TO X.
  7028     MOVE FTG-12                 TO P-DATA.
  7029     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  7030
  7031     MOVE '0'                    TO X.
  7032     MOVE FTG-13                 TO P-DATA.
  7033     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  7034
  7035     MOVE '0'                    TO X.
  7036     MOVE FTG-14                 TO P-DATA.
  7037     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  7038
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 146
* EL331.cbl
  7039     IF DTE-SYS-E-CLASIC-CLAIMS EQUAL 'Y'
  7040         CLOSE ELMSTR5
  7041         IF CL-STAT-1 NOT EQUAL ZERO
  7042             MOVE 'ERROR OCCURED OPEN - ELMSTR'
  7043                                 TO  WS-ABEND-MESSAGE
  7044             MOVE CL-STATUS      TO  WS-ABEND-FILE-STATUS
  7045             GO TO ABEND-PGM
  7046         END-IF
  7047         CLOSE ELRETR5
  7048         IF ELRETR5-FILE-STATUS NOT = ZERO
  7049             MOVE 'ERROR OCCURRED CLOSE - ELRETR'
  7050                                 TO  WS-ABEND-MESSAGE
  7051             MOVE ELRETR5-FILE-STATUS
  7052                                 TO  WS-ABEND-FILE-STATUS
  7053             GO TO ABEND-PGM.
  7054
  7055     CLOSE PRNTR
  7056           ME50-EL331-BALANCE
  7057           ECSCRT01
  7058           ELCERTF
  7059           ERCTBL.
  7060
  7061     IF CM-STAT-1  NOT EQUAL ZERO
  7062         MOVE 'ERROR OCCURED CLOSE - ELCERT'
  7063                                 TO  WS-ABEND-MESSAGE
  7064         MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  7065         GO TO ABEND-PGM.
  7066
  7067     CLOSE ERMAIL.
  7068
  7069     IF CFS-STAT-1 NOT EQUAL '0'
  7070         MOVE 'ERROR OCCURED CLOSE - ERMAIL'
  7071                                  TO  WS-ABEND-MESSAGE
  7072         MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  7073         GO TO ABEND-PGM.
  7074
  7075     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  7076        DTE-SYS-G-AR-USED     EQUAL '1'
  7077          NEXT SENTENCE
  7078     ELSE
  7079        GO TO 8000-CLOSE-OTHER.
  7080
  7081     CLOSE ERACCT.
  7082
  7083     IF AM-STAT-1  NOT EQUAL ZERO
  7084         MOVE 'ERROR OCCURED CLOSE - ERACCT'
  7085                             TO  WS-ABEND-MESSAGE
  7086         MOVE AM-STATUSF     TO  WS-ABEND-FILE-STATUS
  7087         GO TO ABEND-PGM.
  7088
  7089     CLOSE ERCOMM.
  7090
  7091     IF CE-STAT-1  NOT EQUAL ZERO
  7092         MOVE 'ERROR OCCURED CLOSE - ERCOMM'
  7093                             TO  WS-ABEND-MESSAGE
  7094         MOVE CE-STATUS      TO  WS-ABEND-FILE-STATUS
  7095         GO TO ABEND-PGM.
  7096
  7097 8000-CLOSE-OTHER.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 147
* EL331.cbl
*                               COPY ELCPRTCX.
  7098******************************************************************04/15/98
  7099*                                                                *ELCPRTCX
  7100*                                                                *ELCPRTCX
  7101*                            ELCPRTCX.                           *   LV003
  7102*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7103*                            VMOD=2.003                          *   CL**3
  7104*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
  7105*                                                                *ELCPRTCX
  7106* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  7107******************************************************************ELCPRTCX
  7108                                                                  ELCPRTCX
  7109      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
  7110          CLOSE FICH.                                             ELCPRTCX
  7111                                                                  ELCPRTCX
  7112      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
  7113          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
  7114          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
  7115          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
  7116          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
  7117          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
  7118          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
  7119          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
  7120          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
  7121              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  7122              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  7123              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  7124                  UPON CONSOLE                                    ELCPRTCX
  7125              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  7126                  UPON CONSOLE                                    ELCPRTCX
  7127            ELSE                                                  ELCPRTCX
  7128              DISPLAY '***************************************'   ELCPRTCX
  7129              DISPLAY '***************************************'   ELCPRTCX
  7130              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
  7131              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
  7132              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
  7133              DISPLAY '**                                   **'   ELCPRTCX
  7134              DISPLAY '***************************************'   ELCPRTCX
  7135              DISPLAY '***************************************'   ELCPRTCX
  7136              CLOSE ELREPT.                                       ELCPRTCX
  7137                                                                  ELCPRTCX
  7138      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
  7139          DISPLAY '***************************************'       ELCPRTCX
  7140          DISPLAY '***************************************'       ELCPRTCX
  7141          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  7142          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
  7143          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
  7144          DISPLAY '**                                   **'       ELCPRTCX
  7145          DISPLAY '***************************************'       ELCPRTCX
  7146          DISPLAY '***************************************'       ELCPRTCX
  7147          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  7148                                                                  ELCPRTCX
  7149      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
  7150          DISPLAY '***************************************'       ELCPRTCX
  7151          DISPLAY '***************************************'       ELCPRTCX
  7152          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  7153          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
  7154          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 148
* EL331.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
  7155          DISPLAY '**                                   **'       ELCPRTCX
  7156          DISPLAY '***************************************'       ELCPRTCX
  7157          DISPLAY '***************************************'       ELCPRTCX
  7158          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  7159                                                                  ELCPRTCX
  7160                                                                  ELCPRTCX
  7161******************************************************************ELCPRTCX
  7162
  7163 8000-EXIT.
  7164      EXIT.
  7165
  7166 8600-DIS-PRINT SECTION.
  7167
  7168 8600-DISPLAY-PRT.
  7169
  7170     IF  DIS-HEAD-SW =  'Y'
  7171       MOVE 'N' TO  DIS-HEAD-SW
  7172         PERFORM 8600-DISPLAY-HD THRU
  7173             8600-HD-EXIT
  7174           GO TO 8600-DISPLAY-EXIT.
  7175
  7176     IF  DIS-LINE-CNT GREATER THAN 59
  7177         PERFORM 8600-DISPLAY-HD THRU
  7178             8600-HD-EXIT.
  7179
  7180     MOVE   SPACES TO DIS-CC.
  7181     ADD +1 TO DIS-LINE-CNT.
  7182     WRITE  DISPLAY-REC FROM DISPLAY-LINE.
  7183     MOVE   SPACES TO DISPLAY-REC.
  7184     MOVE   SPACES TO DISPLAY-LINE.
  7185
  7186
  7187 8600-DISPLAY-EXIT.
  7188     EXIT.
  7189
  7190 8600-DIS-HEAD SECTION.
  7191
  7192 8600-DISPLAY-HD.
  7193
  7194     MOVE '1' TO  DISPLAY-CC.
  7195     MOVE ZEROS TO DIS-LINE-CNT.
  7196     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
  7197     ADD  +1  TO DIS-LINE-CNT.
  7198     MOVE ' ' TO  DISPLAY-CC.
  7199     MOVE   SPACES TO DISPLAY-REC.
  7200*    WRITE  DISPLAY-REC.
  7201     ADD +1 TO DIS-LINE-CNT.
  7202     WRITE  DISPLAY-REC FROM DISPLAY-HD-2.
  7203     ADD +1 TO DIS-LINE-CNT.
  7204     MOVE   SPACES TO DISPLAY-REC.
  7205     WRITE  DISPLAY-REC.
  7206
  7207
  7208
  7209 8600-HD-EXIT.
  7210     EXIT.
  7211 9999-PROGRAM-END.
  7212
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 149
* EL331.cbl
  7213     GOBACK.
  7214
  7216 ABEND-PGM SECTION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 150
* EL331.cbl
*                         COPY ELCABEND.
  7217***************************************************************** 04/14/98
  7218*                                                               * ELCABEND
  7219*                            ELCABEND.                          *    LV003
  7220*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7221*                            VMOD 2.002                              CL**2
  7222*                                                               * ELCABEND
  7223*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  7224*            AND THEN ABENDS.                                   * ELCABEND
  7225*                                                               * ELCABEND
  7226*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  7227*                                                               * ELCABEND
  7228***************************************************************** ELCABEND
  7229*APS-010.                                                         ELCABEND
  7230     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  7231     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  7232                                                                  ELCABEND
  7233     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  7234         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  7235         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  7236                                 UPON CONSOLE.                    ELCABEND
  7237                                                                  ELCABEND
  7238     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  7239         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  7240         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  7241                                 UPON CONSOLE.                    ELCABEND
  7242                                                                  ELCABEND
  7243     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  7244     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  7245                                 UPON CONSOLE.                    ELCABEND
  7246                                                                  ELCABEND
  7247     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  7248     CALL 'ABORTME'.
  7249                                                                  ELCABEND
  7250 APS-EXIT.                                                        ELCABEND
  7251     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       63728     Code:       22361
