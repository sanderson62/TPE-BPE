* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page   1
* ECS010.cbl
* Options: int("ECS010.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page   2
* ECS010.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61* 041508  CR2008030300004  PEMA  ADD POST CARD REFUND PROCESSING
    62* 042408  CR2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    63* 050808  IR2008050100002  PEMA  CHECK FOR LF AMT = ZERO
    64* 080808  IR2008080100002  PEMA  CHECK FOR AH AMT = ZERO
    65* 111208  IR2008111000001  PEMA  CORRECT BANK FEE CALC.
    66* 040109  CR2009031600001  AJRA  ADD VIN TO CERT TRLR.
    67* 093009  CR2009010500002  PEMA  CORRECT EARNED COMMISSION CALC
    68* 121609  CR2008112100001  AJRA  CORRECT AL, TX, VA STATE STAT EP
    69* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    70* 042110  CR2010010400006  PEMA  ADD PC FIELDS FOR EMERALD 032
    71* 072810  CR2010010400004  PEMA  FACT IN ORG PREM FOR VA ROA
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page   3
* ECS010.cbl
    72* 120710  CR2010101500002  PEMA  MN ROA AND MEAN
    73* 101110  CR2010012700001  PEMA  ADD DDF REFUND/UEP PROCESSING
    74* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    75* 120511  IR2011112300001  PEMA  CORRECT JOINT AH ONLY ISSUE
    76* 012711  IR2012010500001  PEMA  CORRECT UEP-CLP-FACT
    77* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    78* 032612  CR2011110200001  PEMA  AHL CHANGES
    79* 071112  IR2012070600001  PEMA  SPP CORRECTIONS
    80* 072512  CR2012060400001  PEMA  ADD NEW EXTRACT FOR CU DIRECT
    81* 011013  IR2013010700002  PEMA  CORRECT INCURRED DATE ISSUE
    82* 100413  IR2013100100001  PEMA  INCREASE PDEF OCCURS
    83* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    84* 051314  CR2014042900001  PEMA  ADD ACCT 1107201 TO FPB
    85* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    86* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
    87******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page   4
* ECS010.cbl
    89 ENVIRONMENT DIVISION.
    90 CONFIGURATION SECTION.
    91 SPECIAL-NAMES.
    92     C02 IS LCP-CH2
    93     C03 IS LCP-CH3
    94     C04 IS LCP-CH4
    95     C05 IS LCP-CH5
    96     C06 IS LCP-CH6
    97     C07 IS LCP-CH7
    98     C08 IS LCP-CH8
    99     C09 IS LCP-CH9
   100     C10 IS LCP-CH10
   101     C11 IS LCP-CH11
   102     C12 IS LCP-CH12
   103     S01 IS LCP-P01
   104     S02 IS LCP-P02.
   105
   106 INPUT-OUTPUT SECTION.
   107 FILE-CONTROL.
   108
   109     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
   110
   111     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
   112
   113     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
   114                             ACCESS IS SEQUENTIAL
   115                             ORGANIZATION IS INDEXED
   116                             FILE STATUS IS ERACCTT-FILE-STATUS
   117                             RECORD KEY IS AM-CONTROL-PRIMARY.
   118
   119     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
   120                             ACCESS IS DYNAMIC
   121                             ORGANIZATION IS INDEXED
   122                             FILE STATUS IS ERRTBL-FILE-STATUS
   123                             RECORD KEY IS RE-CONTROL-PRIMARY.
   124
   125     SELECT ERCTBL           ASSIGN TO ERCTBLT
   126                             ACCESS IS DYNAMIC
   127                             ORGANIZATION IS INDEXED
   128                             FILE STATUS IS ERCTBL-FILE-STATUS
   129                             RECORD KEY IS CT-CONTROL-PRIMARY.
   130
   131     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
   132                             ORGANIZATION INDEXED
   133                             ACCESS DYNAMIC
   134                             RECORD KEY ME-CONTROL-PRIMARY
   135                             FILE STATUS ERMEBL-FILE-STATUS.
   136
   137     SELECT ERRESC-IN        ASSIGN TO ERRESC
   138                             ORGANIZATION IS INDEXED
   139                             ACCESS IS DYNAMIC
   140                             RECORD KEY IS ERRESC-RECORD-KEY
   141                             FILE STATUS IS ERRESC-FILE-STATUS.
   142
   143     SELECT ELCRTT           ASSIGN TO ELCRTT
   144                             ACCESS IS DYNAMIC
   145                             ORGANIZATION IS INDEXED
   146                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page   5
* ECS010.cbl
   147                             RECORD KEY IS CS-CONTROL-PRIMARY.
   148
   149     SELECT ERAGTC           ASSIGN TO ERAGTC
   150                             ACCESS IS DYNAMIC
   151                             ORGANIZATION IS INDEXED
   152                             FILE STATUS IS ERAGTC-FILE-STATUS
   153                             RECORD KEY IS AG-CONTROL-PRIMARY.
   154
   155     SELECT ERPDEF           ASSIGN TO ERPDEF
   156                             ACCESS IS DYNAMIC
   157                             ORGANIZATION IS INDEXED
   158                             FILE STATUS IS ERPDEF-FILE-STATUS
   159                             RECORD KEY IS PD-CONTROL-PRIMARY.
   160
   161     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   162
   163     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   164
   165     SELECT NEW-DETAIL-EXTR  ASSIGN TO SYS014.
   166
   167     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   168
   169
   170     SELECT ME-ECS010-BALANCE
   171                             ASSIGN TO SYS012
   172                             ORGANIZATION IS LINE SEQUENTIAL.
   173
   174     SELECT ME50-ECS010-BALANCE
   175                             ASSIGN TO SYS013
   176                             ORGANIZATION IS LINE SEQUENTIAL.
   177
   178     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   179
   180     SELECT DISK-DATE        ASSIGN TO SYS019.
   181
   182     SELECT PRINT-COPY       ASSIGN TO SYS008.
   183
   184     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   185
   186     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page   6
* ECS010.cbl
   188 DATA DIVISION.
   189 FILE SECTION.
   190
   191 FD  PENDING-EXTRACT
   192     BLOCK CONTAINS 0 RECORDS
   193     RECORDING MODE F.
   194
*  195                             COPY ERCEXTD.
   196******************************************************************04/29/98
   197*                                                                *ERCEXTD
   198*                                                                *ERCEXTD
   199*                            ERCEXTD                             *   LV002
   200*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   201*                            VMOD=2.002                          *   CL**2
   202*                                                                *ERCEXTD
   203*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   204*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   205*                                                                *ERCEXTD
   206*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   207*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   208*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   209*                                                                *ERCEXTD
   210*         RECORD                                                 *ERCEXTD
   211*          TYPE          PROGRAM USING                           *ERCEXTD
   212*        --------        --------------------------------        *ERCEXTD
   213*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   214*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   215*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   216*                                                                *ERCEXTD
   217* -------------------------------------------------------------- *ERCEXTD
   218*                                                                *ERCEXTD
   219*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   220*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   221*                                                                *ERCEXTD
   222*   FILENAME = EREXTD                                            *ERCEXTD
   223*                                                                *ERCEXTD
   224******************************************************************ERCEXTD
   225                                                                  ERCEXTD
   226 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   227     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   228         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   229                                                                  ERCEXTD
   230     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   231         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   232         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   233         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   234                                                                  ERCEXTD
   235     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   236                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page   7
* ECS010.cbl
   238 FD  CERT-MASTER-IN
*  239                             COPY ECSCRIFD.
   240******************************************************************07/10/97
   241*                                                                *ECSCRIFD
   242*                            ECSCRIFD                            *   LV001
   243*                            VMOD 2.005                          *ECSCRIFD
   244*                                                                *ECSCRIFD
   245*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   246*                                                                *ECSCRIFD
   247******************************************************************ECSCRIFD
   248     BLOCK CONTAINS 0 RECORDS
   249     RECORDING MODE F.                                            ECSCRIFD
   250                                                                  ECSCRIFD
   251 01  CERT-IN-RECORD.                                              ECSCRIFD
   252                                                                  ECSCRIFD
   253     12  FILLER                            PIC XXX.               ECSCRIFD
   254     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   255     12  FILLER                            PIC X(66).             ECSCRIFD
   256     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   257     12  FILLER                            PIC X(20).             ECSCRIFD
   258     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   259     12  FILLER                            PIC X(14).             ECSCRIFD
   260     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   261     12  FILLER                            PIC X(39).             ECSCRIFD
   262     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   263     12  FILLER                            PIC X(45).             ECSCRIFD
   264     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   265     12  FILLER                            PIC X(35).             ECSCRIFD
   266     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   267     12  FILLER                            PIC X(41).             ECSCRIFD
   268     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   269     12  FILLER                            PIC X(48).             ECSCRIFD
   270     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   271     12  FILLER                            PIC X(9).              ECSCRIFD
   272     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   273     12  FILLER                            PIC X(120).            ECSCRIFD
   274     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   275     12  FILLER                            PIC X(73).             ECSCRIFD
   276     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   277     12  FILLER                            PIC X(464).            ECSCRIFD
   278                                                                  ECSCRIFD
   279******************************************************************ECSCRIFD
   280
   281 01  CI-RECORD.
   282     12  FILLER          PIC  X(03).
   283     12  CI-ACCOUNT-CONTROL.
   284         16  CI-CARRIER      PIC  X(01).
   285         16  CI-GROUPING     PIC  X(06).
   286         16  CI-STATE        PIC  X(02).
   287         16  CI-ACCOUNT      PIC  X(10).
   288     12  FILLER          PIC  X(06).
   289     12  CI-CERT-NO.
   290         16  CI-CERT     PIC X(10).
   291         16  CI-CERT-SFX PIC X.
   292     12  FILLER          PIC  X(1017).
   293
   294******************************************************
   295*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page   8
* ECS010.cbl
   296*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   297*   COMMERCIAL FEDERAL BANK
   298******************************************************
   299 01  CF-RECORD.
   300     12  FILLER          PIC X(759).
   301     12  CF-THIRD-AGENT  PIC X(10).
   302     12  FILLER          PIC X(7).
   303     12  CF-FOURTH-AGENT PIC X(10).
   304     12  FILLER          PIC X(270).
   305
   306******************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page   9
* ECS010.cbl
   308 FD  ERACCTT-IN.
   309
*  310                             COPY ERCACCT.
   311******************************************************************04/19/98
   312*                                                                *ERCACCT
   313*                                                                *ERCACCT
   314*                            ERCACCT                             *   LV031
   315*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   316*                            VMOD=2.031                          *ERCACCT
   317*                                                                *ERCACCT
   318*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   319*                                                                *ERCACCT
   320*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   321*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   322*                                                                *ERCACCT
   323*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   324*                                                                *ERCACCT
   325*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   326*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   327*                                                                *ERCACCT
   328*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   329*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   330*                                                                *ERCACCT
   331*   LOG = NO                                                     *ERCACCT
   332*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   333*                                                                *ERCACCT
   334*                                                                *ERCACCT
   335******************************************************************ERCACCT
   336*                   C H A N G E   L O G
   337*
   338* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   339*-----------------------------------------------------------------
   340*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   341* EFFECTIVE    NUMBER
   342*-----------------------------------------------------------------
   343* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   344* 092705    2005050300006  PEMA  ADD SPP LEASES
   345* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   346* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   347* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   348* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   349* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   350******************************************************************
   351                                                                  ERCACCT
   352 01  ACCOUNT-MASTER.                                              ERCACCT
   353     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   354         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   355                                                                  ERCACCT
   356     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   357         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   358         16  AM-MSTR-CNTRL.                                       ERCACCT
   359             20  AM-CONTROL-A.                                    ERCACCT
   360                 24  AM-CARRIER            PIC X.                 ERCACCT
   361                 24  AM-GROUPING.                                 ERCACCT
   362                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   363                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   364                 24  AM-STATE              PIC XX.                ERCACCT
   365                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  10
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   366                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   367                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   368             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   369                                           PIC X(19).             ERCACCT
   370             20  AM-CNTRL-B.                                      ERCACCT
   371                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   372                 24  FILLER                PIC X(4).              ERCACCT
   373             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   374                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   375                                                                  ERCACCT
   376     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   377         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   378         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   379         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   380         16  AM-VG-STATE                   PIC XX.                ERCACCT
   381         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   382         16  AM-VG-DATE.                                          ERCACCT
   383             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   384             20  FILLER                    PIC X(4).              ERCACCT
   385         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   386                                           PIC 9(11)      COMP-3. ERCACCT
   387     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   388         16  FILLER                        PIC X(10).
   389         16  AM-VG-KEY3.
   390             20  AM-VG3-ACCOUNT            PIC X(10).
   391             20  AM-VG3-EXP-DT             PIC XX.
   392         16  FILLER                        PIC X(4).
   393     12  AM-MAINT-INFORMATION.                                    ERCACCT
   394         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   395         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   396         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   397         16  FILLER                        PIC XX.                ERCACCT
   398                                                                  ERCACCT
   399     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   400     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   401                                                                  ERCACCT
   402     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   403         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   404         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   405                                                                  ERCACCT
   406     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   407     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   408                                                                  ERCACCT
   409     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   410     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   411                                                                  ERCACCT
   412     12  AM-NAME                           PIC X(30).             ERCACCT
   413     12  AM-PERSON                         PIC X(30).             ERCACCT
   414     12  AM-ADDRS                          PIC X(30).             ERCACCT
   415     12  AM-CITY.
   416         16  AM-ADDR-CITY                  PIC X(28).
   417         16  AM-ADDR-STATE                 PIC XX.
   418     12  AM-ZIP.                                                  ERCACCT
   419         16  AM-ZIP-PRIME.                                        ERCACCT
   420             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   421                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   422             20  FILLER                    PIC X(4).              ERCACCT
   423         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  11
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   424     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   425         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   426         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   427         16  FILLER                        PIC XXX.               ERCACCT
   428     12  AM-TEL-NO.                                               ERCACCT
   429         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   430         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   431         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   432     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   433         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   434         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   435                                                                  ERCACCT
   436     12  AM-COMM-STRUCTURE.                                       ERCACCT
   437         16  AM-DEFN-1.                                           ERCACCT
   438             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   439                 24  AM-AGT.                                      ERCACCT
   440                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   441                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   442                 24  AM-COM-TYP            PIC X.                 ERCACCT
   443                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   444                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   445                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   446                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   447                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   448                 24  AM-GL-CODES           PIC X.                 ERCACCT
   449                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   450                 24  FILLER                PIC X(01).             ERCACCT
   451         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   452             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   453                 24  FILLER                PIC X(11).             ERCACCT
   454                 24  AM-L-COMA             PIC XXX.               ERCACCT
   455                 24  AM-J-COMA             PIC XXX.               ERCACCT
   456                 24  AM-A-COMA             PIC XXX.               ERCACCT
   457                 24  FILLER                PIC X(6).              ERCACCT
   458                                                                  ERCACCT
   459     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   460         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   461                                                                  ERCACCT
   462     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   463                                                                  ERCACCT
   464     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   465         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   466         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   467     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   468         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   469         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   470     12  AM-GPCD                           PIC 99.                ERCACCT
   471     12  AM-IG                             PIC X.                 ERCACCT
   472         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   473         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   474     12  AM-STATUS                         PIC X.                 ERCACCT
   475         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   476         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   477         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   478         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   479         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   480         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   481     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  12
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   482     12  AM-ID-NO                          PIC X(11).             ERCACCT
   483                                                                  ERCACCT
   484     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   485     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   486     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   487     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   488     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   489     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   490     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   491     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   492     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   493                                                                  ERCACCT
   494     12  AM-USER-FIELDS.                                          ERCACCT
   495         16  AM-FLD-1                      PIC XX.                ERCACCT
   496         16  AM-FLD-2                      PIC XX.                ERCACCT
   497         16  AM-FLD-3                      PIC XX.                ERCACCT
   498         16  AM-FLD-4                      PIC XX.                ERCACCT
   499         16  AM-FLD-5                      PIC XX.                ERCACCT
   500                                                                  ERCACCT
   501     12  AM-1ST-PROD-DATE.                                        ERCACCT
   502         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   503         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   504         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   505     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   506     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   507         16  AM-PUR-YR                     PIC XX.                ERCACCT
   508         16  AM-PUR-MO                     PIC XX.                ERCACCT
   509         16  AM-PUR-DA                     PIC XX.                ERCACCT
   510     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   511     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   512     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   513     12  AM-INACTIVE-DATE.                                        ERCACCT
   514         16  AM-INA-MO                     PIC 99.                ERCACCT
   515         16  AM-INA-DA                     PIC 99.                ERCACCT
   516         16  AM-INA-YR                     PIC 99.                ERCACCT
   517     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   518                                                                  ERCACCT
   519     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   520     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   521                                                                  ERCACCT
   522     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   523         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   524         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   525         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   526         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   527                                                                  ERCACCT
   528     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   529         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   530         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   531                                                                  ERCACCT
   532     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   533                                                                  ERCACCT
   534     12  AM-OVER-SHORT.                                           ERCACCT
   535         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   536         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   537                                                                  ERCACCT
   538     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   539     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  13
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   540                                                                  ERCACCT
   541     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   542     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   543                                                                  ERCACCT
   544     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   545     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   546     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   547     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   548     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   549     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   550     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   551     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   552     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   553     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   554     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   555     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   556     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   557     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   558     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   559     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   560                                                                  ERCACCT
   561     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   562                                                                  ERCACCT
   563     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   564     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   565                                                                  ERCACCT
   566     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   567     12  AM-EARN-METHODS.                                         ERCACCT
   568         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   569             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   570             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   571             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   572             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   573         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   574             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   575             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   576             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   577             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   578         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   579             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   580             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   581             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   582             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   583             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   584             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   585                                                                  ERCACCT
   586     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   587     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   588     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   589                                                                  ERCACCT
   590     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   591     12  AM-RET-P-E                        PIC X.                 ERCACCT
   592     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   593     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   594     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   595     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   596         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   597         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  14
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   598     12  AM-RETRO-EARNINGS.                                       ERCACCT
   599         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   600         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   601         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   602     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   603         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   604         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   605     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   606         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   607         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   608         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   609     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   610     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   611                                                                  ERCACCT
   612     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   613         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   614         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   615         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   616         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   617         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   618                                                                  ERCACCT
   619     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   620                                                                  ERCACCT
   621     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   622                                                                  ERCACCT
   623     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   624         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   625                                                                  ERCACCT
   626     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   627         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   628         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   629                                                                  ERCACCT
   630     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   631         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   632                                                                  ERCACCT
   633     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   634         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   635         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   636                                                                  ERCACCT
   637     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   638                                                                  ERCACCT
   639     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   640     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   641     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   642     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   643     12  AM-DCC-UEF-STATE                  PIC XX.
   644     12  FILLER                            PIC XXX.
   645     12  AM-REPORT-CODE-3                  PIC X(10).
   646*    12  FILLER                            PIC X(22).             ERCACCT
   647                                                                  ERCACCT
   648     12  AM-RESERVE-DATE.                                         ERCACCT
   649         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   650         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   651         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   652                                                                  ERCACCT
   653     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   654     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   655         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  15
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   656         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   657         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   658         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   659                                                                  ERCACCT
   660     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   661         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   662         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   663         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   664         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   665                                                                  ERCACCT
   666     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   667         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   668             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   669             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   670             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   671             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   672             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   673             20  FILLER                    PIC XX.                ERCACCT
   674         16  FILLER                        PIC X(80).             ERCACCT
   675                                                                  ERCACCT
   676     12  AM-TRANSFER-DATA.                                        ERCACCT
   677         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   678             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   679             20  AM-TRNFROM-GROUPING.                             ERCACCT
   680                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   681                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   682             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   683             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   684                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   685                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   686             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   687         16  AM-TRANSFERRED-TO.                                   ERCACCT
   688             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   689             20  AM-TRNTO-GROUPING.                               ERCACCT
   690                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   691                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   692             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   693             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   694                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   695                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   696             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   697         16  FILLER                        PIC X(10).             ERCACCT
   698                                                                  ERCACCT
   699     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   700                                                                  ERCACCT
   701     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   702         16  AM-DEFN-1-SAVED.                                     ERCACCT
   703             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   704                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   705                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   706                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   707                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   708                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   709                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   710                 24  FILLER                PIC X.                 ERCACCT
   711                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   712                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   713                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  16
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   714         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   715             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   716                 24  FILLER                PIC X(11).             ERCACCT
   717                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   718                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   719                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   720                 24  FILLER                PIC X(6).              ERCACCT
   721                                                                  ERCACCT
   722     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   723         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   724            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   725            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   726            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   727                                                                  ERCACCT
   728     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   729     12  FILLER                            PIC X(120).            ERCACCT
   730                                                                  ERCACCT
   731     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   732         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   733         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   734             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   735             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   736                                                          COMP-3. ERCACCT
   737             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   738                                                          COMP-3. ERCACCT
   739         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   740             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   741             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   742                                                          COMP-3. ERCACCT
   743             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   744                                                          COMP-3. ERCACCT
   745                                                                  ERCACCT
   746     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   747         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   748         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   749         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   750         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   751             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   752                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   753                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   754             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   755                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   756                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   757             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   758                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   759                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   760         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   761             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   762                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   763                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   764                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   765             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   766                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   767                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   768             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   769                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   770                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   771                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  17
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   772     12  AM-COMMENTS.                                             ERCACCT
   773         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   774                                                                  ERCACCT
   775     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   776         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   777         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   778         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   779         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   780         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   781             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   782             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   783             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   784             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   785         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   786             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   787             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   788             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   789         16  FILLER                        PIC X(102).            ERCACCT
   790                                                                  ERCACCT
   791     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   792         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   793             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   794             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   795             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   796             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   797             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   798         16  FILLER                          PIC X(10).           ERCACCT
   799******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  18
* ECS010.cbl
   801 FD  ERRTBL-IN.
   802
*  803                             COPY ERCREIN.
   804******************************************************************07/27/93
   805*                                                                *ERCREIN
   806*                            ERCREIN                             *   LV009
   807*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   808*                            VMOD=2.010                          *   CL**9
   809*                                                                *ERCREIN
   810*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   811*                                                                *ERCREIN
   812*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   813*                                                                *ERCREIN
   814*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   815*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   816*                                                                *ERCREIN
   817*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   818*       ALTERNATE PATH = NONE                                    *ERCREIN
   819*                                                                *ERCREIN
   820*   LOG = NO                                                     *ERCREIN
   821*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   822*                                                                *ERCREIN
   823******************************************************************ERCREIN
   824*                   C H A N G E   L O G
   825*
   826* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   827*-----------------------------------------------------------------
   828*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   829* EFFECTIVE    NUMBER
   830*-----------------------------------------------------------------
   831* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   832* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   833******************************************************************
   834 01  REINSURANCE-RECORD.                                          ERCREIN
   835     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   836         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   837                                                                  ERCREIN
   838     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   839         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   840         16  RE-KEY.                                              ERCREIN
   841             20  RE-CODE                   PIC X.                 ERCREIN
   842                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   843                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   844             20  RE-TABLE                  PIC XXX.               ERCREIN
   845             20  FILLER                    PIC XXX.               ERCREIN
   846         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   847             20  FILLER                    PIC X.                 ERCREIN
   848             20  RE-COMPANY.                                      ERCREIN
   849                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   850                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   851                                                                  ERCREIN
   852     12  RE-MAINT-INFORMATION.                                    ERCREIN
   853         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   854         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   855         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   856         16  FILLER                        PIC X(10).             ERCREIN
   857                                                                  ERCREIN
   858     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  19
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   859         16  RE-100-COMP                   PIC 99.                ERCREIN
   860                                                                  ERCREIN
   861         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   862             20  RE-REI-COMP-NO.                                  ERCREIN
   863                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   864                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   865             20  RE-LF-QC                  PIC X.                 ERCREIN
   866             20  RE-AH-QC                  PIC X.                 ERCREIN
   867             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   868             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   869             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   870             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   871             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   872             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   873             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   874             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   875             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   876             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   877             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   878             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   879             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   880             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   881             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   882             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   883             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   884             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   885             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   886             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   887             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   888             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   889             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   890             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   891             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   892             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   893             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   894             20  RE-REMAINING              PIC X.                 ERCREIN
   895             20  RE-LF-RUNOFF-SW           PIC X.                      000
   896             20  RE-AH-RUNOFF-SW           PIC X.                      000
   897             20  FILLER                    PIC X(19).                  000
   898                                                                  ERCREIN
   899         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   900         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   901         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   902         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   903             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   904                                                                  ERCREIN
   905         16  FILLER                        PIC X(27).             ERCREIN
   906                                                                  ERCREIN
   907     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   908         16  RE-NAME                       PIC X(30).             ERCREIN
   909         16  RE-LF-PE                      PIC X.                 ERCREIN
   910         16  RE-AH-PE                      PIC X.                 ERCREIN
   911         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   912         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   913         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   914         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   915         16  RE-PRT-ST                     PIC X.                 ERCREIN
   916         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  20
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   917         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   918         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   919         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   920         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   921         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   922         16  RE-LF-COMM                    PIC X.                 ERCREIN
   923         16  RE-AH-COMM                    PIC X.                 ERCREIN
   924         16  RE-LF-TAX                     PIC X.                 ERCREIN
   925         16  RE-AH-TAX                     PIC X.                 ERCREIN
   926         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   927         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   928         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   929                                                                  ERCREIN
   930         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   931             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   932                                                                  ERCREIN
   933         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   934             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   935                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   936                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   937                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   938                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   939             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   940                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   941                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   942                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   943                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   944                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   945                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   946                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   947                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   948             20  FILLER                    PIC XXX.               ERCREIN
   949             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   950                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   951                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   952                                                                  ERCREIN
   953         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   954             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   955                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   956                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   957                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   958                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   959             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   960                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   961                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   962                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   963                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   964                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   965                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   966                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   967                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   968             20  FILLER                    PIC XXX.               ERCREIN
   969             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   970                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   971                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   972                                                                  ERCREIN
   973         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   974                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  21
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   975         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   976                                                                  ERCREIN
   977         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   978         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   979         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   980         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   981         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   982         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   983         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   984         16  RE-MORT-SW                    PIC X.                 ERCREIN
   985         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   986             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   987             88  RE-CEDED                          VALUE 'C'.        CL**2
   988             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   989             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   990                                                                  ERCREIN
   991         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   992             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   993         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   994             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   995         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   996             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   997         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   998             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   999         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  1000             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  1001                                                                     CL**3
  1002         16  RE-PRT-CRSV                   PIC X.                    CL**5
  1003                                                                     CL**5
  1004         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  1005                                                                     CL**8
  1006         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  1007                                                                     CL**8
  1008         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  1009                                                                     CL**9
  1010         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  1011             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  1012             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  1013
  1014         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  1015             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  1016                                                                     CL**9
  1017         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  1018         16  FILLER                        PIC X(2281).              CL**9
  1019                                                                  ERCREIN
  1020         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  1021                                                                  ERCREIN
  1022******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  22
* ECS010.cbl
  1024 FD  ERCTBL.
  1025
* 1026                             COPY ERCCTBL.
  1027******************************************************************04/29/98
  1028*                                                                *ERCCTBL
  1029*                                                                *ERCCTBL
  1030*                            ERCCTBL                             *   LV002
  1031*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1032*                            VMOD=2.003                              CL**2
  1033*                                                                *ERCCTBL
  1034*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1035*                                                                *ERCCTBL
  1036*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1037*                                                                *ERCCTBL
  1038*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1039*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1040*                                                                *ERCCTBL
  1041*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1042*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1043*                                                                *ERCCTBL
  1044*   LOG = NO                                                     *ERCCTBL
  1045*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1046*                                                                *ERCCTBL
  1047*                                                                *ERCCTBL
  1048******************************************************************ERCCTBL
  1049                                                                  ERCCTBL
  1050 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1051     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1052         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1053                                                                  ERCCTBL
  1054     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1055         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1056         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1057         16  CT-CNTRL-2.                                          ERCCTBL
  1058             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1059             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1060                                                                  ERCCTBL
  1061     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1062         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1063         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1064         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1065         16  FILLER                        PIC X(31).             ERCCTBL
  1066                                                                  ERCCTBL
  1067     12  CT-LIMITS.                                               ERCCTBL
  1068         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1069                                                                  ERCCTBL
  1070         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1071                                                                  ERCCTBL
  1072         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1073                                                                  ERCCTBL
  1074     12  CT-RATES.                                                ERCCTBL
  1075         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1076             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1077             20  CT-RT-R   REDEFINES                              ERCCTBL
  1078                 CT-RT                     PIC XXX.               ERCCTBL
  1079                                                                  ERCCTBL
  1080     12  FILLER                            PIC  X(42).            ERCCTBL
  1081                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  23
* ECS010.cbl
  1082******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  24
* ECS010.cbl
  1084 FD  ERMEBL-INOUT.
  1085
* 1086                             COPY ERCMEBL.
  1087******************************************************************04/29/98
  1088*                                                                 ERCMEBL
  1089*                                                                 ERCMEBL
  1090*                            ERCMEBL                             *   LV004
  1091*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  1092*                            VMOD 2.004                          *   CL**2
  1093*                                                                *ERCMEBL
  1094*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *ERCMEBL
  1095*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *ERCMEBL
  1096*                       4-6 OF THE FIELD NAMES) AND BY EL541     *ERCMEBL
  1097*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*ERCMEBL
  1098*                                                                *ERCMEBL
  1099*    FILE TYPE = VSAM, KSDS                                      *ERCMEBL
  1100*    RECORD SIZE = 765       RECFORM = FIXED                     *ERCMEBL
  1101*                                                                *ERCMEBL
  1102*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *ERCMEBL
  1103*    ALTERNATE PATHS = NONE        STARTING IN  3                *ERCMEBL
  1104*                                                                *ERCMEBL
  1105******************************************************************ERCMEBL
  1106                                                                  ERCMEBL
  1107 01  MONTH-END-BALANCES.                                          ERCMEBL
  1108     12  ME-RECORD-ID            PIC  XX.                         ERCMEBL
  1109     12  ME-CONTROL-PRIMARY.                                      ERCMEBL
  1110         16  ME-COMPANY          PIC  XXX.                        ERCMEBL
  1111         16  ME-MOYR             PIC  9999       COMP.            ERCMEBL
  1112     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1113     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1114     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1115     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1116     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1117     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1118     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1119     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1120     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1121     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1122     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1123     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1124     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.          ERCMEBL
  1125     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1126     12  ME-010-START            PIC  9(6)       COMP-3.          ERCMEBL
  1127     12  ME-010-END              PIC  9(6)       COMP-3.          ERCMEBL
  1128     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1129     12  ME-018-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1130     12  ME-018-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1131     12  ME-018-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1132     12  ME-018-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1133     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1134     12  ME-018-START            PIC  9(6)       COMP-3.          ERCMEBL
  1135     12  ME-018-END              PIC  9(6)       COMP-3.          ERCMEBL
  1136     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1137     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1138     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1139     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1140     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1141     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  25
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1142     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1143     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1144     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1145     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1146     12  ME-019-START            PIC  9(6)       COMP-3.          ERCMEBL
  1147     12  ME-019-END              PIC  9(6)       COMP-3.          ERCMEBL
  1148     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1149     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1150     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1151     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1152     12  ME-030-START            PIC  9(6)       COMP-3.          ERCMEBL
  1153     12  ME-030-END              PIC  9(6)       COMP-3.          ERCMEBL
  1154     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1155     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1156     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1157     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1158     12  ME-032-START            PIC  9(6)       COMP-3.          ERCMEBL
  1159     12  ME-032-END              PIC  9(6)       COMP-3.          ERCMEBL
  1160     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1161     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1162     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1163     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.          ERCMEBL
  1164     12  ME-035-START            PIC S9(6)       COMP-3.          ERCMEBL
  1165     12  ME-035-END              PIC S9(6)       COMP-3.          ERCMEBL
  1166     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1167     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1168     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1169     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1170     12  ME-038-START            PIC  9(6)       COMP-3.          ERCMEBL
  1171     12  ME-038-END              PIC  9(6)       COMP-3.          ERCMEBL
  1172     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1173     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1174     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1175     12  ME-041-START            PIC  9(6)       COMP-3.          ERCMEBL
  1176     12  ME-041-END              PIC  9(6)       COMP-3.          ERCMEBL
  1177     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1178     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1179     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1180     12  ME-050-START            PIC  9(6)       COMP-3.          ERCMEBL
  1181     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1182     12  ME-050-END              PIC  9(6)       COMP-3.          ERCMEBL
  1183     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1184     12  ME-061-PREM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1185     12  ME-061-COMM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1186     12  ME-061-OR               PIC S9(9)V99    COMP-3.          ERCMEBL
  1187     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1188     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1189     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.          ERCMEBL
  1190     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1191     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1192     12  ME-061-START            PIC  9(6)       COMP-3.          ERCMEBL
  1193     12  ME-061-END              PIC  9(6)       COMP-3.          ERCMEBL
  1194     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1195     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.          ERCMEBL
  1196     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1197     12  ME-080-START            PIC  9(6)       COMP-3.          ERCMEBL
  1198     12  ME-080-END              PIC  9(6)       COMP-3.          ERCMEBL
  1199     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  26
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1200     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1201     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1202     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1203     12  ME-315-START            PIC  9(6)       COMP-3.          ERCMEBL
  1204     12  ME-315-END              PIC  9(6)       COMP-3.          ERCMEBL
  1205     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1206     12  ME-331-FLAG             PIC  9.                          ERCMEBL
  1207     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1208     12  ME-331-START            PIC  9(6)       COMP-3.          ERCMEBL
  1209     12  ME-331-END              PIC  9(6)       COMP-3.          ERCMEBL
  1210     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1211     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.          ERCMEBL
  1212     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1213     12  ME-341-START            PIC  9(6)       COMP-3.          ERCMEBL
  1214     12  ME-341-END              PIC  9(6)       COMP-3.          ERCMEBL
  1215     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1216     12  ME-501-FLAG             PIC  9.                          ERCMEBL
  1217     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1218     12  ME-501-START            PIC  9(6)       COMP-3.          ERCMEBL
  1219     12  ME-501-END              PIC  9(6)       COMP-3.          ERCMEBL
  1220     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1221     12  ME-509-FLAG             PIC  9.                          ERCMEBL
  1222     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1223     12  ME-509-START            PIC  9(6)       COMP-3.          ERCMEBL
  1224     12  ME-509-END              PIC  9(6)       COMP-3.          ERCMEBL
  1225     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1226     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1227     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1228     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1229     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1230     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1231     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1232     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1233     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1234     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1235     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1236     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1237     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1238     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1239     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1240     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1241     12  ME-522-START            PIC  9(6)       COMP-3.          ERCMEBL
  1242     12  ME-522-END              PIC  9(6)       COMP-3.          ERCMEBL
  1243     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1244     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1245     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1246     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1247     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1248     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1249     12  ME-524-START            PIC  9(6)       COMP-3.          ERCMEBL
  1250     12  ME-524-END              PIC  9(6)       COMP-3.          ERCMEBL
  1251     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1252     12  ME-525-FLAG             PIC  9.                          ERCMEBL
  1253     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1254     12  ME-525-START            PIC  9(6)       COMP-3.          ERCMEBL
  1255     12  ME-525-END              PIC  9(6)       COMP-3.          ERCMEBL
  1256     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1257     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  27
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1258     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1259     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1260     12  ME-048-START            PIC  9(6)       COMP-3.          ERCMEBL
  1261     12  ME-048-END              PIC  9(6)       COMP-3.          ERCMEBL
  1262     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1263     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.             CL**2
  1264     12  FILLER                  PIC  X(88).                         CL**2
  1265******************************************************************ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  28
* ECS010.cbl
  1267 FD  CERT-MASTER-OUT
* 1268                             COPY ECSCROFD.
  1269******************************************************************07/10/97
  1270*                                                                *ECSCROFD
  1271*                            ECSCROFD                            *   LV001
  1272*                            VMOD=2.002                          *ECSCROFD
  1273*                                                                *ECSCROFD
  1274*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1275*                                                                *ECSCROFD
  1276******************************************************************ECSCROFD
  1277     RECORDING MODE F                                             ECSCROFD
  1278     LABEL RECORDS STANDARD                                       ECSCROFD
  1279     BLOCK CONTAINS 0 RECORDS
  1280     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1281 01  CERT-OUT-RECORD.                                             ECSCROFD
  1282     12  FILLER                            PIC  XXX.              ECSCROFD
  1283     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1284     12  FILLER                            PIC  X(1017).          ECSCROFD
  1285                                                                  ECSCROFD
  1286******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  29
* ECS010.cbl
  1288 FD  DETAIL-EXTR
  1289     BLOCK CONTAINS 0 RECORDS
  1290     RECORDING MODE F.
  1291
* 1292                             COPY ECSEXT01.
  1293******************************************************************04/29/98
  1294*                                                                *ECSEXT01
  1295*                            ECSEXT01                            *   LV015
  1296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1297*                            VMOD=2.015                          *ECSEXT01
  1298*                                                                *ECSEXT01
  1299*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1300*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1301*                                                                *ECSEXT01
  1302*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1303*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1304*                                                                *ECSEXT01
  1305*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1306*                                                                *ECSEXT01
  1307******************************************************************ECSEXT01
  1308******************************************************************
  1309*                   C H A N G E   L O G
  1310*
  1311* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1312*-----------------------------------------------------------------
  1313*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1314* EFFECTIVE    NUMBER
  1315*-----------------------------------------------------------------
  1316* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1317* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1318* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1319* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1320* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1321* 032612  CR2011110200001  PEMA  AHL CHANGES
  1322******************************************************************
  1323                                                                  ECSEXT01
  1324 01  DETAIL-EXTRACT.                                              ECSEXT01
  1325     02 DETAIL-FILE.                                              ECSEXT01
  1326     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1327         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1328                                                                  ECSEXT01
  1329     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1330                                                                  ECSEXT01
  1331     12  DE-REIN                           PIC X.                 ECSEXT01
  1332                                                                  ECSEXT01
  1333     12  DE-CONTROL.                                              ECSEXT01
  1334         16  DE-CNTRL1.                                           ECSEXT01
  1335             20  DE-CARRIER                PIC X.                 ECSEXT01
  1336             20  DE-GROUPING.                                     ECSEXT01
  1337                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1338                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1339             20  DE-STATE                  PIC XX.                ECSEXT01
  1340             20  DE-ACCOUNT.                                      ECSEXT01
  1341                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1342                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1343         16  DE-CNTRL2.                                           ECSEXT01
  1344             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1345             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  30
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1346                 24 DE-CERT-NO.                                   ECSEXT01
  1347                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1348                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1349                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1350                                                                  ECSEXT01
  1351     12  DE-TRANS                          PIC X.                 ECSEXT01
  1352         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1353         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1354         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1355         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1356         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1357         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1358         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1359         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1360         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1361         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1362                                                                  ECSEXT01
  1363     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1364     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1365                                                                  ECSEXT01
  1366     12  DE-NAME.                                                 ECSEXT01
  1367         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1368         16  DE-FNAME.                                            ECSEXT01
  1369             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1370             20  FILLER                    PIC X(9).              ECSEXT01
  1371         16  DE-INIT                       PIC X.                 ECSEXT01
  1372     12  DE-AGE                            PIC 99.                ECSEXT01
  1373     12  DE-SEX                            PIC X.                 ECSEXT01
  1374     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1375                                                                  ECSEXT01
  1376     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1377     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1378     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1379     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1380     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1381     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1382     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1383     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1384     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1385                                                                  ECSEXT01
  1386     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1387     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1388     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1389     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1390                                                                  ECSEXT01
  1391     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1392     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1393     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1394     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1395     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1396                                                                  ECSEXT01
  1397     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1398     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1399     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1400     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1401                                                                  ECSEXT01
  1402     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1403     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  31
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1404                                           PIC S9(5)V99   COMP-3.
  1405     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1406     12  FILLER REDEFINES DE-NUM-BILLED.
  1407         16  DE-CLP-STATE                  PIC XX.
  1408         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1409     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1410     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1411                                                                  ECSEXT01
  1412     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1413     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1414     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1415     12  DE-IG                             PIC X.                 ECSEXT01
  1416     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1417*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1418     12  DE-MEMBER-NO.                                            ECSEXT01
  1419         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1420         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1421         16  FILLER                        PIC X(03).             ECSEXT01
  1422     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1423                                                                  ECSEXT01
  1424     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1425         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1426                                                                  ECSEXT01
  1427     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1428     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1429                                                                  ECSEXT01
  1430     12  DE-REI-AREA.                                             ECSEXT01
  1431         16  DE-REI-COMP.                                         ECSEXT01
  1432             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1433             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1434         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1435         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1436         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1437         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1438         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1439         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1440         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1441                                                                  ECSEXT01
  1442     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1443     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1444         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1445         16  F                             PIC X.
  1446*    12  FILLER                            PIC X(5).              ECSEXT01
  1447                                                                  ECSEXT01
  1448     12  DE-BILLED-AREA.                                          ECSEXT01
  1449         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1450             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1451                                                                  ECSEXT01
  1452         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1453             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1454             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1455             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1456             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1457             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1458             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1459                                                                  ECSEXT01
  1460         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1461             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  32
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1462                                                                  ECSEXT01
  1463         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1464         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1465         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1466         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1467                                                                  ECSEXT01
  1468         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1469*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1470*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1471                                                                  ECSEXT01
  1472     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1473         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1474         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1475         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1476                                                                  ECSEXT01
  1477     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1478         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1479         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1480     12  DE-CANCEL-REASON                  PIC X.
  1481                                                                  ECSEXT01
  1482     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1483     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1484                                                                  ECSEXT01
  1485     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1486         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1487             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1488         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1489             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1490                                                                  ECSEXT01
  1491     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1492         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1493                                                                  ECSEXT01
  1494     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1495     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1496         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1497         16  FILLER                        PIC X.
  1498                                                                  ECSEXT01
  1499****************************************************************  ECSEXT01
  1500**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1501****************************************************************  ECSEXT01
  1502     12  DE-COMM-LEVELS.                                          ECSEXT01
  1503         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1504             20  DE-AGT.                                          ECSEXT01
  1505                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1506                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1507             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1508             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1509             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1510                                                                  ECSEXT01
  1511     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1512****************************************************************  ECSEXT01
  1513*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1514****************************************************************  ECSEXT01
  1515     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1516     12  FILLER                            PIC X(334).            ECSEXT01
  1517     12  DE-TYPE                           PIC X.                 ECSEXT01
  1518         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1519         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  33
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1520         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1521         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1522         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1523         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1524                                                                  ECSEXT01
  1525     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1526     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1527                                                                  ECSEXT01
  1528     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1529     12  DE-REPORTED.                                             ECSEXT01
  1530         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1531         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1532         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1533     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1534     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1535                                                                  ECSEXT01
  1536     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1537     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1538     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1539     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1540     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1541     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1542         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1543         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1544         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1545         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1546         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1547         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1548         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1549                                                                  ECSEXT01
  1550     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1551                                                                  ECSEXT01
  1552     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1553     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1554     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1555     12  FILLER                            PIC XX.                ECSEXT01
  1556     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1557                                                                  ECSEXT01
  1558     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1559     12  DE-BENEFICIARY                    PIC X(10).
  1560     12  filler redefines de-beneficiary.
  1561         16  de-birth-date                 pic 9(11)  comp-3.
  1562         16  f                             pic x(4).
  1563     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1564     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1565     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1566     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1567     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1568     12  DE-CLM-CLASS                      PIC XX.
  1569     12  DE-CLM-DEV                        PIC XXX.
  1570     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1571     12  de-xycor-cert-seq                 pic x(3).
  1572     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1573     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1574     12  DE-XYCOR-STATUS                   PIC X.
  1575     12  FILLER                            PIC X(4).              ECSEXT01
  1576                                                                  ECSEXT01
  1577     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  34
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1578                                                                  ECSEXT01
  1579****************************************************************  ECSEXT01
  1580*******               RESERVE EXTRACT                      *****  ECSEXT01
  1581****************************************************************  ECSEXT01
  1582     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1583     12  FILLER                            PIC X(334).            ECSEXT01
  1584                                                                  ECSEXT01
  1585     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1586         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1587         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1588                                                                  ECSEXT01
  1589     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1590     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1591     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1592                                                                  ECSEXT01
  1593     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1594                                                                  ECSEXT01
  1595     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1596     12  DE-RSV-REPORTED.                                         ECSEXT01
  1597         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1598         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1599         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1600     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1601                                                                  ECSEXT01
  1602     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1603     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1604     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1605                                                                  ECSEXT01
  1606     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1607     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1608     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1609                                                                  ECSEXT01
  1610     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1611                                                                  ECSEXT01
  1612     12  DE-RATE-CLASS                     PIC XX.
  1613     12  DE-DEV-CODE                       PIC XXX.
  1614     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1615     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1616     12  FILLER                            PIC X(58).             ECSEXT01
  1617                                                                  ECSEXT01
  1618     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1619******************************************************************ECSEXT01
  1620
  1621 FD  NEW-DETAIL-EXTR
  1622     BLOCK CONTAINS 0 RECORDS
  1623     RECORDING MODE F.
  1624
* 1625                                 COPY ECSEXX01.
  1626******************************************************************
  1627*                                                                *
  1628*                            ECSEXX01                            *
  1629*                            VMOD=2.015                          *
  1630*                                                                *
  1631*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *
  1632*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *
  1633*                                                                *
  1634*   FILE TYPE = SEQUENTIAL                                       *
  1635*   RECORD SIZE = 510  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  35
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1636*                                                                *
  1637*   KEY DATA =                                   START=5, LEN=36 *
  1638*                                                                *
  1639******************************************************************
  1640******************************************************************
  1641*                   C H A N G E   L O G
  1642*
  1643* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1644*-----------------------------------------------------------------
  1645*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1646* EFFECTIVE    NUMBER
  1647*-----------------------------------------------------------------
  1648*                                    TEMPORARY
  1649******************************************************************
  1650
  1651 01  NEW-DETAIL-EXTRACT.
  1652     02 NEW-DETAIL-FILE.
  1653     12  DX-RECORD-ID                      PIC XX.
  1654         88  VALID-DX-ID                      VALUE 'DX'.
  1655
  1656     12  DX-COMPANY-CD                     PIC X.
  1657
  1658     12  DX-REIN                           PIC X.
  1659
  1660     12  DX-CONTROL.
  1661         16  DX-CNTRL1.
  1662             20  DX-CARRIER                PIC X.
  1663             20  DX-GROUPING.
  1664                 24  DX-GROUP-PREFIX       PIC XXX.
  1665                 24  DX-GROUP-PRIME        PIC XXX.
  1666             20  DX-STATE                  PIC XX.
  1667             20  DX-ACCOUNT.
  1668                 24  DX-ACCT-PREFIX        PIC X(4).
  1669                 24  DX-ACCT-PRIME         PIC X(6).
  1670         16  DX-CNTRL2.
  1671             20  DX-EFF                    PIC 9(11)  COMP-3.
  1672             20  DX-CERT.
  1673                 24 DX-CERT-NO.
  1674                     28  DX-CRT-PREFIX     PIC XXX.
  1675                     28  DX-CRT-PRIME      PIC X(7).
  1676                 24  DX-CRT-SUF            PIC X.
  1677
  1678     12  DX-TRANS                          PIC X.
  1679         88  DX-ISSUE                         VALUE 'I'.
  1680         88  DX-RC-ISSUE                      VALUE '8'.
  1681         88  DX-CANCEL                        VALUE 'C'.
  1682         88  DX-RC-CANCEL                     VALUE '7'.
  1683         88  DX-CLAIM                         VALUE 'X'.
  1684         88  DX-RESTORE                       VALUE 'R'.
  1685         88  DX-RESERVE                       VALUE 'Y'.
  1686         88  DX-RR-RC-ISS                     VALUE 'J'.
  1687         88  DX-RR-RC-CNC                     VALUE 'K'.
  1688         88  DX-RR-RC-CLM                     VALUE 'L'.
  1689
  1690     12  DX-REPORT-CODX-1                  PIC X(10).
  1691     12  DX-REPORT-CODX-2                  PIC X(10).
  1692
  1693     12  DX-NAME.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  36
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1694         16  DX-LNAME                      PIC X(15).
  1695         16  DX-FNAME.
  1696             20  DX-1ST-INIT-FNAME         PIC X.
  1697             20  FILLER                    PIC X(9).
  1698         16  DX-INIT                       PIC X.
  1699     12  DX-AGE                            PIC 99.
  1700     12  DX-SEX                            PIC X.
  1701     12  DX-SOC-SEC-NO                     PIC X(11).
  1702
  1703     12  DX-LF-TYPE                        PIC XX.
  1704     12  DX-LF-TERM                        PIC 999        COMP-3.
  1705     12  DX-LF-BEN                         PIC S9(9)V99   COMP-3.
  1706     12  DX-LF-CNBEN                       PIC S9(9)V99   COMP-3.
  1707     12  DX-LF-PRM                         PIC S9(7)V99   COMP-3.
  1708     12  DX-LF-BEN-ALT                     PIC S9(9)V99   COMP-3.
  1709     12  DX-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3.
  1710     12  DX-LF-PRM-ALT                     PIC S9(7)V99   COMP-3.
  1711     12  DX-LF-RFND                        PIC S9(7)V99   COMP-3.
  1712
  1713     12  DX-LF-STAT-CDE                    PIC X.
  1714     12  DX-LF-PREV-STAT                   PIC X.
  1715     12  DX-LF-CANC-DTE                    PIC 9(11)      COMP-3.
  1716     12  DX-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3.
  1717
  1718     12  DX-AH-TYPE                        PIC XX.
  1719     12  DX-AH-TERM                        PIC 999        COMP-3.
  1720     12  DX-AH-BEN                         PIC S9(7)V99   COMP-3.
  1721     12  DX-AH-PRM                         PIC S9(7)V99   COMP-3.
  1722     12  DX-AH-RFND                        PIC S9(7)V99   COMP-3.
  1723
  1724     12  DX-AH-STAT-CDE                    PIC X.
  1725     12  DX-AH-PREV-STAT                   PIC X.
  1726     12  DX-AH-CANC-DTE                    PIC 9(11)  COMP-3.
  1727     12  DX-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.
  1728
  1729     12  DX-LIVES                          PIC S9(7)      COMP-3.
  1730     12  DX-ADDL-CLP REDEFINES DX-LIVES
  1731                                           PIC S9(5)V99   COMP-3.
  1732     12  DX-NUM-BILLED                     PIC S9(7)      COMP-3.
  1733     12  FILLER REDEFINES DX-NUM-BILLED.
  1734         16  DX-CLP-STATE                  PIC XX.
  1735         16  DX-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1736     12  DX-CANCEL-CNT-ITD                 PIC S999       COMP-3.
  1737     12  DX-CANCEL-CNT-YTD                 PIC S999       COMP-3.
  1738
  1739     12  DX-APR                            PIC S999V9(4)  COMP-3.
  1740     12  DX-PMT-FREQ                       PIC 99.
  1741     12  DX-ACC-GPCD                       PIC XX.
  1742     12  DX-IG                             PIC X.
  1743     12  DX-REMIT-TO                       PIC XX.
  1744*    12  DX-MEMBER-NO                      PIC X(12).
  1745     12  DX-MEMBER-NO.
  1746         16  DX-MASTER-POLICY              PIC X(06).
  1747         16  DX-ZIP                        PIC 9(05)    COMP-3.
  1748         16  FILLER                        PIC X(03).
  1749     12  DX-LN-OFFICER                     PIC XXX.
  1750
  1751     12  DX-AUTO-GEND-IND                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  37
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1752         88  DX-AUTO-GEND-REINS            VALUE 'R'.
  1753
  1754     12  DX-ENTRY-STATUS                   PIC X.
  1755     12  DX-ENTRY-DTE                      PIC 9(11)      COMP-3.
  1756
  1757     12  DX-REI-AREA.
  1758         16  DX-REI-COMP.
  1759             20  DX-REINCO                 PIC XXX.
  1760             20  DX-REINCO-SUB             PIC XXX.
  1761         16  DX-REI-LFAMT                  PIC S9(9)V99   COMP-3.
  1762         16  DX-REI-LFPRM                  PIC S9(7)V99   COMP-3.
  1763         16  DX-REI-LFRFND                 PIC S9(7)V99   COMP-3.
  1764         16  DX-REI-AHAMT                  PIC S9(7)V99   COMP-3.
  1765         16  DX-REI-AHPRM                  PIC S9(7)V99   COMP-3.
  1766         16  DX-REI-AHRFND                 PIC S9(7)V99   COMP-3.
  1767         16  DX-REI-CNAMT                  PIC S9(9)V99   COMP-3.
  1768
  1769     12  DX-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1770     12  FILLER REDEFINES DX-MOB-NET-TOT-FEES.
  1771         16  DX-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1772         16  F                             PIC X.
  1773*    12  FILLER                            PIC X(5).
  1774
  1775     12  DX-BILLED-AREA.
  1776         16  DX-GL-INTERFACE-CODES.
  1777             20  DX-GL-CODES               PIC X  OCCURS 10 TIMES.
  1778
  1779         16  DX-BILL-SW                    PIC X.
  1780             88  DX-RECORD-ON-HOLD            VALUE 'H'.
  1781             88  DX-RECORD-RETURNED           VALUE 'R'.
  1782             88  DX-RECORD-ENDORSED           VALUE 'E'.
  1783             88  DX-OVERRIDX-LIFE             VALUE 'L'.
  1784             88  DX-OVERRIDX-AH               VALUE 'A'.
  1785             88  DX-OVERRIDX-BOTH             VALUE 'B'.
  1786
  1787         16  DX-REFUND-SW                  PIC X.
  1788             88  DX-REFUND-CREATED            VALUE 'Y'.
  1789
  1790         16  DX-BILLED-LFPRM               PIC S9(7)V99   COMP-3.
  1791         16  DX-BILLED-LFRFND              PIC S9(7)V99   COMP-3.
  1792         16  DX-BILLED-AHPRM               PIC S9(7)V99   COMP-3.
  1793         16  DX-BILLED-AHRFND              PIC S9(7)V99   COMP-3.
  1794
  1795         16  DX-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES.
  1796*            88  DX-NO-PRE-BILL-GA            VALUE ' '.
  1797*            88  DX-BILLED-GA                 VALUE 'B'.
  1798
  1799     12  DX-BILL-STATUS                    PIC X.
  1800         88  DX-NO-PRE-BILL                   VALUE ' '.
  1801         88  DX-BILLED                        VALUE 'B'.
  1802         88  DX-REVERSE                       VALUE 'R'.
  1803
  1804     12  DX-REVERSE-REASONS.
  1805         16  DX-REVERSE-REASON-1           PIC X.
  1806         16  DX-REVERSE-REASON-2           PIC X.
  1807     12  DX-CANCEL-REASON                  PIC X.
  1808
  1809     12  DX-RECALC-CODE                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  38
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1810     12  DX-RECALC-TYPE                    PIC X.
  1811
  1812     12  DX-CHARGEBACK-CODES.
  1813         16  DX-LF-COMM-CHARGEBACK         PIC X.
  1814             88  DX-NO-LF-CHARGEBACK          VALUE 'N'.
  1815         16  DX-AH-COMM-CHARGEBACK         PIC X.
  1816             88  DX-NO-AH-CHARGEBACK          VALUE 'N'.
  1817
  1818     12  DX-UNDERWRITING-CODE              PIC X.
  1819         88  DX-POLICY-UNDERWRITTEN           VALUE 'Y'.
  1820
  1821     12  DX-NCL-POOL-CODE                  PIC XXX.
  1822     12  FILLER REDEFINES DX-NCL-POOL-CODE.
  1823         16  DX-LOAN-TERM                  PIC S999 COMP-3.
  1824         16  FILLER                        PIC X.
  1825
  1826****************************************************************
  1827**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT
  1828****************************************************************
  1829     12  DX-COMM-LEVELS.
  1830         16  DX-AGT-LEVELS     OCCURS  10  TIMES.
  1831             20  DX-AGT.
  1832                 24  DX-AGT-PREFIX         PIC X(4).
  1833                 24  DX-AGT-PRIME          PIC X(6).
  1834             20  DX-AGT-TYPE               PIC X.
  1835             20  DX-L-PC                   PIC S999V99    COMP-3.
  1836             20  DX-A-PC                   PIC S999V99    COMP-3.
  1837
  1838     12  DX-PROC-DT                        PIC 9(11)      COMP-3.
  1839****************************************************************
  1840*******                 CLAIM EXTRACT                      *****
  1841****************************************************************
  1842     02 DX-CLAIM-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1843     12  FILLER                            PIC X(334).
  1844     12  DX-TYPE                           PIC X.
  1845         88  DX-DTH                           VALUE '1'.
  1846         88  DX-AH                            VALUE '2'.
  1847         88  DX-OB-DTH                        VALUE '3'.
  1848         88  DX-OB-AH                         VALUE '4'.
  1849         88  DX-DEATH                         VALUES '1' '3'.
  1850         88  DX-DISABILITY                    VALUES '2' '4'.
  1851
  1852     12  DX-CLAIM-AMT                      PIC S9(9)V99   COMP-3.
  1853     12  DX-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3.
  1854
  1855     12  DX-INCUR                          PIC 9(11)      COMP-3.
  1856     12  DX-REPORTED.
  1857         16  DX-RPT-YR                     PIC 99.
  1858         16  DX-RPT-MO                     PIC 99.
  1859         16  DX-RPT-DA                     PIC 99.
  1860     12  DX-PAY                            PIC 9(11)      COMP-3.
  1861     12  DX-PAID-TO                        PIC 9(11)      COMP-3.
  1862
  1863     12  DX-CNUM                           PIC X(7).
  1864     12  DX-CHECK                          PIC X(7).
  1865     12  DX-PMT-TRAILER-SEQ                PIC S9(4)       COMP.
  1866     12  DX-DAYS-DISAB                     PIC 999.
  1867     12  DX-CLM-AGE                        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  39
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1868     12  DX-PAY-CODE                       PIC X.
  1869         88  DX-PARTIAL-PAYMENT               VALUE 'P'.
  1870         88  DX-FINAL-PAYMENT                 VALUE 'F'.
  1871         88  DX-LUMP-SUM-PAYMENT              VALUE 'S'.
  1872         88  DX-ADDITIONAL-PAYMENT            VALUE 'X'.
  1873         88  DX-CHARGEABLE-EXPENSE            VALUE 'E'.
  1874         88  DX-NON-CHARGEABLE-EXPENSE        VALUE 'E'.
  1875         88  DX-VOIDED-PAYMENT                VALUE 'V'.
  1876
  1877     12  DX-CLM-ERR                        PIC XX.
  1878
  1879     12  DX-ACC-NAME                       PIC X(30).
  1880     12  DX-ACC-EXP-DTE                    PIC 9(11)  COMP-3.
  1881     12  DX-ACC-EFF-DTE                    PIC 9(11)  COMP-3.
  1882     12  FILLER                            PIC XX.
  1883     12  DX-LOAN-OFFICER                   PIC XXX.
  1884
  1885     12  DX-LOAN-TYPE                      PIC X(02).
  1886     12  DX-BENEFICIARY                    PIC X(10).
  1887     12  filler redefines DX-beneficiary.
  1888         16  DX-birth-date                 pic 9(11)  comp-3.
  1889         16  f                             pic x(4).
  1890     12  DX-LOAN-CLASS                     PIC X(02).
  1891     12  DX-LOSS-CODE                      PIC X(06).
  1892     12  DX-ASSOCIATES                     PIC X(01).
  1893     12  DX-LEGAL-STATE                    PIC X(02).
  1894     12  DX-CLM-CAUSE                      PIC X(6).
  1895     12  DX-CLM-CLASS                      PIC XX.
  1896     12  DX-CLM-DEV                        PIC XXX.
  1897     12  DX-XYCOR-CLAIM-NO                 PIC X(9).
  1898     12  DX-xycor-cert-seq                 pic x(3).
  1899     12  DX-XYCOR-CHECK-NO                 PIC X(8).
  1900     12  DX-XYCOR-ACTION-CD                PIC XXX.
  1901     12  DX-XYCOR-STATUS                   PIC X.
  1902     12  FILLER                            PIC X(4).
  1903
  1904     12  DX-CLM-PROC-DT                    PIC 9(11)  COMP-3.
  1905
  1906****************************************************************
  1907*******               RESERVE EXTRACT                      *****
  1908****************************************************************
  1909     02 DX-RESERVE-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1910     12  FILLER                            PIC X(334).
  1911
  1912     12  DX-RESERVE-TYPE                   PIC X.
  1913         88  DX-LIFE-RSV                      VALUE '1' '3'.
  1914         88  DX-AH-RSV                        VALUE '2' '4'.
  1915
  1916     12  DX-IBNR                           PIC S9(7)V99   COMP-3.
  1917     12  DX-PAYCUR                         PIC S9(7)V99   COMP-3.
  1918     12  DX-FUTRSV                         PIC S9(7)V99   COMP-3.
  1919
  1920     12  DX-CLMNO                          PIC X(7).
  1921
  1922     12  DX-RSV-INCUR                      PIC 9(11)      COMP-3.
  1923     12  DX-RSV-REPORTED.
  1924         16  DX-RSV-RPT-YR                 PIC 99.
  1925         16  DX-RSV-RPT-MO                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  40
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1926         16  DX-RSV-RPT-DA                 PIC 99.
  1927     12  DX-RSV-PAYTO                      PIC 9(11)      COMP-3.
  1928
  1929     12  DX-REI-IBNR                       PIC S9(7)V99   COMP-3.
  1930     12  DX-REI-PAYCUR                     PIC S9(7)V99   COMP-3.
  1931     12  DX-REI-FUTRSV                     PIC S9(7)V99   COMP-3.
  1932
  1933     12  DX-RSV-ACC-NAME                   PIC X(30).
  1934     12  DX-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3.
  1935     12  DX-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3.
  1936
  1937     12  DX-MANUAL-RSV-SWITCH              PIC X.
  1938
  1939     12  DX-RATE-CLASS                     PIC XX.
  1940     12  DX-DEV-CODE                       PIC XXX.
  1941     12  DX-RSV-REM-TERM                   PIC S999       COMP-3.
  1942     12  DX-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1943     12  FILLER                            PIC X(58).
  1944
  1945     12  DX-RSV-PROC-DT                    PIC 9(11)  COMP-3.
  1946******************************************************************
  1947
  1948 FD  SUMMARY-EXTR
  1949     BLOCK CONTAINS 0 RECORDS
  1950     RECORDING MODE F.
  1951
* 1952                             COPY ECSEPC01.
  1953******************************************************************
  1954*                                                                *
  1955*                            ECSEPC01                            *
  1956*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1957*                            VMOD=2.008                          *
  1958*                                                                *
  1959*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1960*                                                                *
  1961*   FILE TYPE = SEQUENTIAL                                       *
  1962*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1963*                                                                *
  1964*   KEY DATA =                                  START=5, LEN=31  *
  1965*                                                                *
  1966*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1967*                                                                *
  1968******************************************************************
  1969
  1970 01  EP-RECORD.
  1971     02 EP-FILE.
  1972     12  EP-RECORD-ID                      PIC XX.
  1973         88  VALID-EP-ID                      VALUE 'EP'.
  1974
  1975     12  EP-COMPANY-CD                     PIC X.
  1976
  1977     12  EP-REIN                           PIC X.
  1978         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1979
  1980     12  EP-CONTROL.
  1981         16  EP-CNTRL-1.
  1982             20  EP-COMPANY.
  1983                 24  EP-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  41
* ECS010.cbl (/apps/test/cid1s/copy/ECSEPC01)
  1984                 24  EP-GROUPING.
  1985                     28  EP-GROUP-PREFIX   PIC XXX.
  1986                     28  EP-GROUP-PRIME    PIC XXX.
  1987             20  EP-STATE                  PIC XX.
  1988             20  EP-ACCOUNT.
  1989                 24  EP-ACCT-PREFIX        PIC X(4).
  1990                 24  EP-ACCT-PRIME         PIC X(6).
  1991         16  EP-CNTRL-2.
  1992             20  EP-DATES.
  1993                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1994                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1995
  1996     12  EP-REI-CO.
  1997         16  EP-REINCO                     PIC XXX.
  1998         16  EP-REINCO-SUB                 PIC XXX.
  1999
  2000     12  EP-RCD-TYPE                       PIC X.
  2001         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  2002         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  2003         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  2004         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2005         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2006         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  2007     12  EP-BEN-CODE                       PIC XX.
  2008     12  FILLER                            PIC X.
  2009
  2010     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  2011     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  2012     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2013
  2014     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  2015     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  2016     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2017
  2018     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  2019     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2020     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  2021     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2022
  2023     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  2024     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  2025     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  2026
  2027     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  2028     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  2029     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  2030
  2031     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  2032     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  2033     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  2034     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  2035     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  2036
  2037     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  2038     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  2039     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  2040
  2041     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  42
* ECS010.cbl (/apps/test/cid1s/copy/ECSEPC01)
  2042     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  2043     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  2044
  2045     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  2046         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  2047         16  EP-NEW-DATA-IND               PIC X(01).
  2048             88  EP-NEW-DATA                   VALUE 'Y'.
  2049         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  2050         16  FILLER                        PIC X(19).
  2051
  2052     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  2053     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  2054     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  2055
  2056     12  FILLER                            PIC XXX.
  2057
  2058     12  EP-UNDERWRITING-CODE              PIC X.
  2059         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  2060
  2061     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
  2062
  2063     12  FILLER                            PIC X(29).
  2064*    12  FILLER                            PIC X(34).
  2065
  2066     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  2067     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  2068     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  2069     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  2070     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  2071     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  2072
  2073     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  2074
  2075     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  2076     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  2077
  2078     12  EP-PURGE                          PIC X.
  2079         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2080
  2081     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  2082
  2083     02 EC-RECORD     REDEFINES     EP-FILE.
  2084     12  EC-RECORD-ID                      PIC XX.
  2085         88  VALID-EC-ID                      VALUE 'EC'.
  2086
  2087     12  EC-COMPANY-CD                     PIC X.
  2088
  2089     12  EC-REIN                           PIC X.
  2090         88  EC-REIN-EXTRACT                  VALUE 'R'.
  2091
  2092     12  EC-CONTROL.
  2093         16  EC-CARRIER                    PIC X.
  2094         16  EC-GROUPING.
  2095             20  EC-GROUP-PREFIX           PIC XXX.
  2096             20  EC-GROUP-PRIME            PIC XXX.
  2097         16  EC-STATE                      PIC XX.
  2098         16  EC-ACCOUNT.
  2099             20  EC-ACCT-PREFIX            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  43
* ECS010.cbl (/apps/test/cid1s/copy/ECSEPC01)
  2100             20  EC-ACCT-PRIME             PIC X(6).
  2101         16  EC-DATES.
  2102             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  2103             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  2104
  2105     12  EC-REI-CO.
  2106         16  EC-REINCO                     PIC XXX.
  2107         16  EC-REINCO-SUB                 PIC XXX.
  2108
  2109     12  EC-RCD-TYPE                       PIC X.
  2110         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  2111         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  2112         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  2113         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2114         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2115     12  EC-BEN-CODE                       PIC XX.
  2116     12  EC-SEQ-NBR                        PIC X.
  2117         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  2118         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  2119
  2120     12  EC-AGENTS-DATA.
  2121         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
  2122             20  EC-AGT-NO.
  2123                 24  EC-AGT-PREFIX         PIC X(4).
  2124                 24  EC-AGT-PRIME          PIC X(6).
  2125             20  EC-AGT-TYPE               PIC X.
  2126             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  2127             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  2128             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  2129             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  2130             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  2131
  2132     12  EC-UNDERWRITING-CODE              PIC X.
  2133         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  2134
  2135     12  EC-AGENTS-DATA-II.
  2136         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  2137             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  2138             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  2139
  2140     12  FILLER                            PIC X(7).
  2141
  2142     12  EC-PURGE                          PIC X.
  2143         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2144
  2145     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  2146
  2147******************************************************************
  2148
  2149 FD  ERRESC-IN.
* 2150                             COPY ERCRESC.
  2151******************************************************************04/29/98
  2152*                                                                *ERCRESC
  2153*                            ERCRESC                             *   LV002
  2154*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2155*                            VMOD=2.003                          *   CL**2
  2156*                                                                *ERCRESC
  2157*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  44
* ECS010.cbl (/apps/prod/cid1p/copy/ERCRESC)
  2158*                                                                *ERCRESC
  2159*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  2160*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  2161*                                                                *ERCRESC
  2162*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  2163*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  2164*                                                                *ERCRESC
  2165*   LOG = NO                                                     *ERCRESC
  2166*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  2167*                                                                *ERCRESC
  2168******************************************************************ERCRESC
  2169                                                                  ERCRESC
  2170 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  2171                                                                  ERCRESC
  2172     10  ERRESC-RECORD-KEY.                                       ERCRESC
  2173         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  2174         15  RESC-CARRIER              PIC   X.                   ERCRESC
  2175         15  RESC-GROUP                PIC   X(6).                ERCRESC
  2176         15  RESC-STATE                PIC   XX.                  ERCRESC
  2177         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  2178         15  RESC-AGENT                PIC   X(10).               ERCRESC
  2179         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  2180         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  2181*                                           YYYYMMDD              ERCRESC
  2182     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  2183                                                                  ERCRESC
  2184     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  2185         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  2186             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  2187             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  2188             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  2189                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  2190                                                                  ERCRESC
  2191     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  2192     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  2193     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  2194*                                          YYYYMMDD               ERCRESC
  2195 FD  ELCRTT.
  2196
* 2197                             COPY ELCCRTT.
  2198******************************************************************
  2199*                                                                *ELCCRTT
  2200*                            ELCCRTT.                            *
  2201*                                                                *ELCCRTT
  2202*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  2203*                                                                *ELCCRTT
  2204*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  2205*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  2206*                                                                *ELCCRTT
  2207*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  2208*                                                                *ELCCRTT
  2209*   LOG = YES                                                    *ELCCRTT
  2210*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  2211******************************************************************
  2212*                   C H A N G E   L O G
  2213*
  2214* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2215*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  45
* ECS010.cbl (/apps/test/cid1s/copy/ELCCRTT)
  2216*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2217* EFFECTIVE    NUMBER
  2218*-----------------------------------------------------------------
  2219* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2220* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  2221* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  2222* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2223* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2224* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2225* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2226******************************************************************
  2227                                                                  ELCCRTT
  2228 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  2229     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  2230         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  2231                                                                  ELCCRTT
  2232     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  2233         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  2234         16  CS-CARRIER                    PIC X.                 ELCCRTT
  2235         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  2236         16  CS-STATE                      PIC XX.                ELCCRTT
  2237         16  CS-ACCOUNT                    PIC X(10).
  2238         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  2239         16  CS-CERT-NO.                                          ELCCRTT
  2240             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  2241             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  2242         16  CS-TRAILER-TYPE               PIC X.
  2243             88  COMM-TRLR           VALUE 'A'.
  2244             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2245             88  CERT-DATA-TRLR      VALUE 'C'.
  2246                                                                  ELCCRTT
  2247     12  CS-DATA-AREA                      PIC X(516).
  2248
  2249     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2250         16  CS-BANK-COMMISSION-AREA.
  2251             20  CS-BANK-COMMS       OCCURS 10.
  2252                 24  CS-AGT                PIC X(10).
  2253                 24  CS-COM-TYP            PIC X.
  2254                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2255                 24  CS-RECALC-LV-INDIC    PIC X.
  2256                 24  FILLER                PIC X(10).
  2257
  2258         16  FILLER                        PIC X(256).
  2259
  2260     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2261****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2262
  2263         16  CS-MB-CLAIM-DATA OCCURS 24.
  2264             20  CS-CLAIM-NO               PIC X(7).
  2265             20  CS-CLAIM-TYPE             PIC X.
  2266                 88  CS-AH-CLM               VALUE 'A'.
  2267                 88  CS-IU-CLM               VALUE 'I'.
  2268                 88  CS-GP-CLM               VALUE 'G'.
  2269                 88  CS-LF-CLM               VALUE 'L'.
  2270                 88  CS-PR-CLM               VALUE 'P'.
  2271                 88  CS-FL-CLM               VALUE 'F'.
  2272             20  CS-INSURED-TYPE           PIC X.
  2273                 88  CS-PRIM-INSURED          VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  46
* ECS010.cbl (/apps/test/cid1s/copy/ELCCRTT)
  2274                 88  CS-CO-BORROWER           VALUE 'C'.
  2275             20  CS-BENEFIT-PERIOD         PIC 99.
  2276             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2277             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2278             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2279         16  FILLER                        PIC X(12).
  2280
  2281     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2282         16  CS-VIN-NUMBER                 PIC X(17).
  2283         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2284         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2285         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2286         16  FILLER                        PIC X(496).
  2287
  2288 FD  ERAGTC.
  2289
* 2290                             COPY ERCAGTC.
  2291******************************************************************
  2292*                                                                *
  2293*                                                                *
  2294*                            ERCAGTC                             *
  2295*                            VMOD=2.001                          *
  2296*                                                                *
  2297*   ONLINE CREDIT SYSTEM                                         *
  2298*                                                                *
  2299*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2300*                                                                *
  2301*   FILE TYPE = VSAM,KSDS                                        *
  2302*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2303*                                                                *
  2304*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2305*       ALTERNATE PATH = NONE                                    *
  2306*                                                                *
  2307*   LOG = NO                                                     *
  2308*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2309*                                                                *
  2310******************************************************************
  2311*                   C H A N G E   L O G
  2312*
  2313* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2314*-----------------------------------------------------------------
  2315*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2316* EFFECTIVE    NUMBER
  2317*-----------------------------------------------------------------
  2318* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2319* 111004                         NEW FILE AND COPYBOOK
  2320* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2321******************************************************************
  2322
  2323 01  AGENT-COMMISSIONS.
  2324     12  AG-RECORD-ID                          PIC XX.
  2325         88  VALID-CO-ID                          VALUE 'AG'.
  2326
  2327     12  AG-CONTROL-PRIMARY.
  2328         16  AG-COMPANY-CD                     PIC X.
  2329         16  AG-CONTROL.
  2330             20  AG-CTL-1.
  2331                 24  AG-CARR-GROUP.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  47
* ECS010.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2332                     28  AG-CARRIER            PIC X.
  2333                     28  AG-GROUPING           PIC X(6).
  2334                 24  AG-BANK                   PIC X(10).
  2335             20  AG-CTL-2.
  2336                 24  AG-EXP-DT                 PIC XX.
  2337         16  AG-TYPE                           PIC X.
  2338             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2339             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2340
  2341     12  AG-MAINT-INFORMATION.
  2342         16  AG-LAST-MAINT-DT                  PIC XX.
  2343         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2344         16  AG-LAST-MAINT-USER                PIC X(4).
  2345         16  FILLER                            PIC X(10).
  2346
  2347     12  AG-EFF-DT                             PIC XX.
  2348     12  AG-COMM-STRUCTURE.
  2349         16  AG-AGT-COMMS OCCURS 10.
  2350             20  AG-AGT                PIC X(10).
  2351             20  AG-COM-TYP            PIC X.
  2352             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2353             20  AG-RECALC-LV-INDIC    PIC X.
  2354             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2355             20  AG-LRCALC-LV-INDIC    PIC X.
  2356             20  FILLER                PIC X(05).
  2357
  2358     12  FILLER                  PIC X(145).
  2359******************************************************************
  2360
  2361 FD  ERPDEF.
  2362
* 2363                             COPY ERCPDEF.
  2364******************************************************************
  2365*                                                                *
  2366*                                                                *
  2367*                            ERCPDEF.                            *
  2368*                                                                *
  2369*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2370*                                                                *
  2371*    FILE TYPE = VSAM,KSDS                                       *
  2372*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2373*                                                                *
  2374*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2375*                                                                *
  2376*    LOG = YES                                                   *
  2377*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2378******************************************************************
  2379*                   C H A N G E   L O G
  2380*
  2381* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2382*-----------------------------------------------------------------
  2383*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2384* EFFECTIVE    NUMBER
  2385*-----------------------------------------------------------------
  2386* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2387* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2388******************************************************************
  2389 01  PRODUCT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  48
* ECS010.cbl (/apps/test/cid1s/copy/ERCPDEF)
  2390    12  PD-RECORD-ID                 PIC X(02).
  2391        88  VALID-PD-ID                  VALUE 'PD'.
  2392
  2393    12  PD-CONTROL-PRIMARY.
  2394        16  PD-COMPANY-CD            PIC X.
  2395        16  PD-STATE                 PIC XX.
  2396        16  PD-PRODUCT-CD            PIC XXX.
  2397        16  PD-FILLER                PIC X(7).
  2398        16  PD-BEN-TYPE              PIC X.
  2399        16  PD-BEN-CODE              PIC XX.
  2400        16  PD-PROD-EXP-DT           PIC XX.
  2401
  2402    12  FILLER                       PIC X(50).
  2403
  2404    12  PD-PRODUCT-DATA OCCURS 8.
  2405        16  PD-PROD-CODE             PIC X.
  2406            88  PD-PROD-LIFE           VALUE 'L'.
  2407            88  PD-PROD-PROP           VALUE 'P'.
  2408            88  PD-PROD-AH             VALUE 'A'.
  2409            88  PD-PROD-IU             VALUE 'I'.
  2410            88  PD-PROD-GAP            VALUE 'G'.
  2411            88  PD-PROD-FAML           VALUE 'F'.
  2412        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2413        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2414        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2415        16  PD-MAX-TERM              PIC S999        COMP-3.
  2416        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2417        16  FILLER                   PIC X.
  2418        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2419        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2420        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2421        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2422        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2423        16  PD-REC-CRIT-PERIOD       PIC 99.
  2424        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2425            20  PD-RECURRING-YN      PIC X.
  2426            20  FILLER               PIC X.
  2427        16  PD-RTW-MOS               PIC 99.
  2428        16  PD-MAX-EXTENSION         PIC 99.
  2429        16  FILLER                   PIC XX.
  2430
  2431    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2432
  2433    12  PD-TERM-LIMITS OCCURS 15.
  2434        16  PD-LOW-TERM              PIC S999        COMP-3.
  2435        16  PD-HI-TERM               PIC S999        COMP-3.
  2436
  2437*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2438    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2439        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2440        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2441
  2442    12  PD-EARN-FACTORS.
  2443        16  FILLER OCCURS 15.
  2444            20  FILLER OCCURS 15.
  2445                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2446
  2447    12  PD-PRODUCT-DESC              PIC X(80).
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  49
* ECS010.cbl (/apps/test/cid1s/copy/ERCPDEF)
  2448    12  PD-TRUNCATED                 PIC X.
  2449    12  FILLER                       PIC X(59).
  2450
  2451    12  PD-MAINT-INFORMATION.
  2452        16  PD-LAST-MAINT-DT         PIC X(02).
  2453        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2454        16  PD-LAST-MAINT-BY         PIC X(04).
  2455
  2456 FD  ME-ECS010-BALANCE
  2457     RECORDING MODE IS F
  2458     BLOCK CONTAINS 0 RECORDS.
  2459 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2460
  2461 FD  ME50-ECS010-BALANCE
  2462     RECORDING MODE IS F
  2463     BLOCK CONTAINS 0 RECORDS.
  2464 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2465
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  50
* ECS010.cbl
  2467 FD  DISK-DATE
* 2468                             COPY ELCDTEFD.
  2469******************************************************************04/15/98
  2470*                                                                *ELCDTEFD
  2471*                                                                *ELCDTEFD
  2472*                            ELCDTEFD.                           *   LV002
  2473*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2474*                            VMOD=2.007                          *   CL**2
  2475*                                                                *ELCDTEFD
  2476******************************************************************ELCDTEFD
  2477     BLOCK CONTAINS 0 RECORDS
  2478     RECORDING MODE F.                                            ELCDTEFD
  2479                                                                  ELCDTEFD
  2480 01  DATE-DISK.                                                   ELCDTEFD
  2481     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2482     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2483     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2484     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2485     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2486     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2487     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2488                                                                  ELCDTEFD
  2489 01  DATE-DISK-R.                                                 ELCDTEFD
  2490     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2491     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2492                                     PIC  X(32).                  ELCDTEFD
  2493                                                                  ELCDTEFD
  2494 01  DATE-DISK-T.                                                 ELCDTEFD
  2495     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2496     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2497                                     PIC  X(48).                  ELCDTEFD
  2498                                                                  ELCDTEFD
  2499 01  DATE-DISK-M.                                                 ELCDTEFD
  2500     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2501     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2502                                     PIC  X(48).                  ELCDTEFD
  2503                                                                  ELCDTEFD
  2504 01  DATE-DISK-P.                                                 ELCDTEFD
  2505     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2506     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2507     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2508     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2509         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2510                                     PIC  X.                      ELCDTEFD
  2511         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2512     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2513         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2514             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2515             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2516             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2517             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2518         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2519                                                                  ELCDTEFD
  2520 01  DATE-DISK-E.                                                 ELCDTEFD
  2521     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2522     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2523                                     PIC  X(4).                   ELCDTEFD
  2524                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  51
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2525 01  DATE-DISK-C.                                                 ELCDTEFD
  2526     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2527     12  DD-CARR1-SECPAY-SW          PIC  X.
  2528     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2529     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2530     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2531     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2532     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2533     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2534     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2535     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2536     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2537     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2538     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2539     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2540     12  DD-CARR2-SECPAY-SW          PIC  X.
  2541     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2542                                                                  ELCDTEFD
  2543 01  DATE-DISK-OPT.                                               ELCDTEFD
  2544     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2545     12  DD-TLR-DATA.                                             ELCDTEFD
  2546         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2547                                     PIC  X(03).                  ELCDTEFD
  2548     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2549         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2550                                     PIC  X(06).                  ELCDTEFD
  2551     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2552         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2553                                     PIC  X(07).                  ELCDTEFD
  2554         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2555     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2556                                     PIC  X(96).                  ELCDTEFD
  2557******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  52
* ECS010.cbl
  2559 FD  PRINT-COPY
* 2560                             COPY ELCPRTFD.
  2561******************************************************************04/15/98
  2562*                                                                *ELCPRTFD
  2563*                                                                *ELCPRTFD
  2564*                            ELCPRTFD.                           *   LV003
  2565*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2566*                            VMOD=2.006                          *ELCPRTFD
  2567******************************************************************ELCPRTFD
  2568     RECORDING MODE F                                             ELCPRTFD
  2569     LABEL RECORDS OMITTED                                        ELCPRTFD
  2570     BLOCK CONTAINS 0 RECORDS
  2571     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2572 01  PRT.                                                         ELCPRTFD
  2573     12  P-CTL               PIC  X.                                 CL**2
  2574     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2575******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  53
* ECS010.cbl
  2577 FD  MISMATCH-REPORT
  2578     RECORDING MODE F.
  2579
  2580 01  MISMATCH-RPT.
  2581     12  MR-CTL              PIC X.
  2582     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  54
* ECS010.cbl
  2584 FD  FICH
* 2585                             COPY ELCFCHFD.
  2586******************************************************************04/15/98
  2587*                                                                *ELCFCHFD
  2588*                            ELCFCHFD.                           *   LV003
  2589*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2590*                            VMOD=2.004                          *   CL**3
  2591*                                                                *ELCFCHFD
  2592******************************************************************ELCFCHFD
  2593     BLOCK CONTAINS 0 RECORDS
  2594     RECORDING MODE F.                                            ELCFCHFD
  2595                                                                  ELCFCHFD
  2596 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2597******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  55
* ECS010.cbl
  2599 FD  DISPLAY-PRT
  2600     RECORDING MODE IS F
  2601     LABEL RECORDS ARE STANDARD
  2602     BLOCK CONTAINS 0 RECORDS
  2603     RECORD CONTAINS 133 CHARACTERS.
  2604
  2605 01  DISPLAY-REC.
  2606     05  DISPLAY-CC           PIC X.
  2607     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  56
* ECS010.cbl
  2609 WORKING-STORAGE SECTION.
  2610 77  LCP-ASA                       PIC X.
  2611 77  FILLER  PIC X(32)  VALUE '********************************'.
  2612 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2613 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2614
  2615 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2616 77  ws-dcc-cnc-flag         pic x  value ' '.
  2617 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2618 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2619 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2620 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2621 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2622 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2623 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2624 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2625 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2626 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2627 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2628 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2629 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2630 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2631 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2632 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2633 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2634 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2635 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2636 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2637 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2638 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2639 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2640 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2641 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2642 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2643 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2644 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2645 77  UECLP-CLP-FACT          PIC S9(3)V9(7) COMP-3 VALUE +0.
  2646 77  EC-FACT                 PIC S9(3)V9(9) COMP-3 VALUE +0.
  2647 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2648 77  X                       PIC X.
  2649 77  DD-FLG                  PIC X               VALUE SPACE.
  2650 77  AGT-SW                  PIC X               VALUE SPACE.
  2651 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2652 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2653 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2654 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2655 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2656 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2657 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2658 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2659 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2660 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2661 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2662 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2663 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2664 77  SV-TRD-CERT             PIC X(11).
  2665 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2666 77  SV-TRD-ISDT             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  57
* ECS010.cbl
  2667 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2668*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2669*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
  2670 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2671 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2672 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2673 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2674 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2675 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2676 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2677 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2678 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2679 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2680 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2681 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2682 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2683 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2684 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2685 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2686 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2687 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2688 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2689 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2690 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2691 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2692 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2693 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2694 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2695 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2696 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2697 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2698 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2699 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2700 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2701 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2702 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2703 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2704 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2705 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2706 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2707 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2708 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2709 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2710 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2711 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2712 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2713 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2714 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2715 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2716 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2717 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2718 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2719 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2720 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2721 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2722 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2723 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2724 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  58
* ECS010.cbl
  2725 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2726 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2727 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
  2728 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2729 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2730 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2731 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2732 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2733 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2734 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2735 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2736 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2737 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2738 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2739 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2740 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2741 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2742 77  RTOT-AH-PRMB            PIC S9(11)V99 COMP-3 VALUE +0.
  2743 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2744 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2745 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2746 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2747 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2748 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2749 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2750 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2751 77  D1                      PIC S9(5) COMP-3 VALUE +0.
  2752 77  P1                      PIC S999 COMP-3 VALUE +0.
  2753 77  P2                      PIC S999 COMP-3 VALUE +0.
  2754 77  DD-IU-SW                    PIC X   VALUE ' '.
  2755     88  DD-IU-PRESENT                 VALUE 'Y'.
  2756 77  WS-DDF-ADMIN-FEES       PIC S9(5)V99 VALUE +0 COMP-3.
  2757 77  WS-DDF-CSO-ADMIN-FEE    PIC S9(5)V99 VALUE +0 COMP-3.
  2758 77  WS-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
  2759 77  WS-DDF-1ST-YR-TOT-EXP   PIC S9(5)V99 VALUE +0 COMP-3.
  2760 77  WS-FACT-CERT            PIC X(11)   VALUE SPACES.
  2761 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  2762 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  2763 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  2764 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  2765 77  WS-DDF-TERM             PIC S999     COMP-3 VALUE +0.
  2766 77  ws-dd-ben-type          pic x  value spaces.
  2767 77  ws-dd-ben-code          pic xx value spaces.
  2768
  2769 01  MONTH-END-DATA.
  2770     12  ME-START-DATE.
  2771         16  ME-START-MO         PIC 99.
  2772         16  FILLER              PIC X.
  2773         16  ME-START-DA         PIC 99.
  2774         16  FILLER              PIC X.
  2775         16  ME-START-YR         PIC 99.
  2776     12  ME-CNDS-DATE            PIC 9(6).
  2777     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2778         16  ME-CNDS-MO          PIC 99.
  2779         16  ME-CNDS-DA          PIC 99.
  2780         16  ME-CNDS-YR          PIC 99.
  2781     12  ME-START-TIME           PIC 9(6).
  2782     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  59
* ECS010.cbl
  2783         88  ME-DO-UPDATE        VALUE 'Y'.
  2784         88  ME-NO-UPDATE        VALUE 'N'.
  2785     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2786
  2787 01  WS-HOLD-FOR-NEW-EXTR        PIC X(510)  VALUE SPACES.
  2788 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2789     'Life Claims Paid'.
  2790
  2791 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2792     'A&H Claims Paid'.
  2793
  2794 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2795     'Output Certificate Master Records Prior Month'.
  2796
  2797 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2798     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2799
  2800 01  WS-ME-BALANCE-REC.
  2801     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2802     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2803     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2804     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2805     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2806     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2807     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2808
  2809 01  WS-ME50-BALANCE-REC.
  2810     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2811     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2812     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2813     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2814     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2815     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2816     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2817     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2818     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2819
  2820 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2821 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2822 01  WS-BANK-COMMISSIONS.
  2823     12  WS-BANK-COMMS           OCCURS 10.
  2824         16  WS-BNK-AGT          PIC X(10).
  2825         16  WS-BNK-TYPE         PIC X.
  2826         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2827         16  WS-BNK-RECALC       PIC X.
  2828         16  FILLER              PIC X(10).
  2829
  2830 01  PENDING-MATCH-CONTROL.
  2831     12  PENDING-ACCOUNT-CONTROL.
  2832         16  PEND-MATCH-CARRIER    PIC X.
  2833         16  PEND-MATCH-GROUPING   PIC X(6).
  2834         16  PEND-MATCH-STATE      PIC XX.
  2835         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2836     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2837     12  PEND-MATCH-CERT-NO.
  2838         16  PEND-MATCH-CERT       PIC X(10).
  2839         16  PEND-MATCH-CERT-SFX   PIC X.
  2840 01  PENDING-RECORD-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  60
* ECS010.cbl
  2841     88  ISSUE-TRANSACTION            VALUE '1'.
  2842     88  CANCEL-TRANSACTION           VALUE '2'.
  2843     88  CLAIM-TRANSACTION            VALUE '3'.
  2844     88  RESERVE-TRANSACTION          VALUE '4'.
  2845     88  UPDATE-TRANSACTION           VALUE '5'.
  2846
  2847 01  CLM-INCUR-REIN-DATE.
  2848     12  CIRD-CCYY.
  2849         16  CIRD-CC         PIC 99.
  2850         16  CIRD-YR         PIC 99.
  2851     12  CIRD-MO             PIC 99.
  2852
  2853 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2854
  2855 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2856
  2857 01  REIN-BILLING-TABLE.
  2858     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2859         16  RB-COMPANY      PIC X(6).
  2860         16  RB-COUNT        PIC S9(5)   COMP-3.
  2861
  2862 01  B-SUB                   PIC S9(4)   COMP.
  2863
  2864 01  BINARY-COUNTERS     COMP      SYNC.
  2865     12  IA                  PIC S999            VALUE +0.
  2866     12  IB                  PIC S999            VALUE +0.
  2867     12  SUB                 PIC S999            VALUE +0.
  2868     12  SUBM                PIC S999            VALUE +0.
  2869     12  SUB3                PIC S999            VALUE +0.
  2870     12  SUB4                PIC S999            VALUE +0.
  2871     12  SUB5                PIC S999            VALUE +0.
  2872     12  SUB6                PIC S999            VALUE +0.
  2873     12  SUB7                PIC S999            VALUE +0.
  2874     12  SUB8                PIC S999            VALUE +0.
  2875     12  SUB9                PIC S999            VALUE +0.
  2876     12  SUB10               PIC S999            VALUE +0.
  2877     12  SUB11               PIC S999            VALUE +0.
  2878     12  SUB12               PIC S999            VALUE +0.
  2879     12  SUB13               PIC S999            VALUE +0.
  2880     12  SUB14               PIC S999            VALUE +0.
  2881     12  SUB15               PIC S999            VALUE +0.
  2882     12  SUB16               PIC S999            VALUE +0.
  2883     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2884 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2885
  2886 01  WS.
  2887     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2888     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2889     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2890     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2891
  2892     12  WS-ABEND-CODE         PIC 9(4).
  2893     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2894         16  ABEND-CODE-1    PIC XX.
  2895         16  ABEND-CODE-2.
  2896             20  AC2-ONE     PIC X.
  2897             20  AC2-TWO     PIC X.
  2898
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  61
* ECS010.cbl
  2899     12  CTBL-SEARCH.
  2900         16  CTBL-COMP-CD    PIC X.
  2901         16  CTBL-TABLE-CD   PIC XXX.
  2902         16  CTBL-BEN-TYPE   PIC X.
  2903         16  CTBL-BEN-CODE   PIC XX.
  2904     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2905     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2906     12  WS-COMM-TERM        PIC S999            COMP-3.
  2907     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2908         88  CTBL-ERROR         VALUE '*'.
  2909
  2910     12  REIN-SPEC.
  2911         16  REIN-SPEC-A     PIC X.
  2912         16  REIN-SPEC-B     PIC X.
  2913         16  REIN-SPEC-C     PIC X.
  2914
  2915     12  WS-CHECK-NUMBER.
  2916         16  WS-CHECK-NO     PIC X(4).
  2917         16  FILLER          PIC XXX.
  2918
  2919     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  2920         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
  2921         88  AH-EARN-NET                         VALUE 'N'.
  2922
  2923     12  INTERMED                PIC S9(9)V9(6)  COMP-3.
  2924     12  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
  2925
  2926 01  max-pdef                    pic s9(5) comp-3 value +5000.
  2927 01  DCC-DDF-WORK-AREA.
  2928     05  F OCCURS 5000.
  2929         10  DD-STATE                 PIC XX.
  2930         10  DD-PRODUCT-CD            PIC XXX.
  2931         10  DD-FILLER                PIC X(7).
  2932         10  DD-BEN-TYPE              PIC X.
  2933         10  DD-BEN-CODE              PIC XX.
  2934         10  DD-PROD-EXP-DT           PIC XX.
  2935         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  2936         10  DD-PROD-DATA OCCURS 8.
  2937             15  DD-PROD-CODE         PIC X.
  2938             15  DD-MAX-BEN-AMT       PIC S9(7) COMP-3.
  2939         10  DD-EARN-FACTORS.
  2940             15  F OCCURS 15.
  2941                 20  F OCCURS 15.
  2942                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2943         10  DD-TRUNCATED        PIC X.
  2944
  2945 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2946 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2947 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2948 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2949 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2950 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  2951 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  2952 01  ERPDEF-FILE-STATUS      PIC XX VALUE ZEROS.
  2953
  2954 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2955 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2956 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  62
* ECS010.cbl
  2957 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2958
  2959 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  2960     12  WS-LF-CHARGEBACK-LEVELS.
  2961         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2962     12  WS-AH-CHARGEBACK-LEVELS.
  2963         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2964 01  WS-DCC-DDF-CB.
  2965     12  WS-DCC-DDF-CB-LEVELS.
  2966         16  WS-DDF-AH-CB         PIC X OCCURS 10.
  2967*****************************************************************
  2968*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2969*****************************************************************
  2970*RESIDENT STATE TAXES MASTER(ERRESC)
  2971*
  2972 01  WORK-AREAS.
  2973     12  WS-ERRESC-KEY.
  2974         16 WS-ERRESC-SEARCH-KEY.
  2975             20  WS-ERRESC-COMPANY-CD PIC  X.
  2976             20  WS-ERRESC-CARRIER    PIC  X.
  2977             20  WS-ERRESC-GROUP      PIC X(6).
  2978             20  WS-ERRESC-STATE      PIC XX.
  2979             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2980         16 WS-ERRESC-RESIDUAL-KEY.
  2981             20  WS-ERRESC-AGENT      PIC X(10).
  2982             20  WS-ERRESC-RES-STATE  PIC XX.
  2983             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2984*                                          YYYYMMDD
  2985     12  WS-YYYYMMDD-DT               PIC 9(8).
  2986     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2987     12  WS-SUB                       PIC    99  COMP-3.
  2988     12  WS-SUB1                      PIC    99  COMP-3.
  2989*****************************************************************
  2990*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2991*****************************************************************
  2992
  2993 01  COMM-WORK-AREAS.
  2994     12  FILLER              PIC  X(17)
  2995         VALUE 'COMMON WORK AREAS'.
  2996     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2997     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2998     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2999     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  3000     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  3001     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  3002     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  3003     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  3004     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  3005     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  3006     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  3007     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  3008     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  3009     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3010     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  3011     12  W-CERT-COUNT        PIC S9(08)  COMP.
  3012     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  3013     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  3014     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  63
* ECS010.cbl
  3015
  3016     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
  3017                                         COMP-3 VALUE ZEROS.
  3018     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  3019                                         COMP-3 VALUE ZEROS.
  3020     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  3021                                         COMP-3 VALUE ZEROS.
  3022     12  W-EDIT-FIELD        PIC ----------9.
  3023     12  W-EDIT-FIELD2       PIC ----------9.99.
  3024     12  W-EDIT-7            PIC Z(06)9.
  3025     12  W-FACTOR            PIC S9(09)V9(08)
  3026                                         COMP-3 VALUE ZEROS.
  3027     12  W-IBNR-1            PIC S9(07)V9(02)
  3028                                         COMP-3 VALUE ZEROS.
  3029     12  W-IBNR-2            PIC S9(07)V9(02)
  3030                                         COMP-3 VALUE ZEROS.
  3031     12  W-ISS-BEN           PIC S9(11)V9(02)
  3032                                         COMP-3 VALUE ZEROS.
  3033     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  3034                                         COMP-3 VALUE ZEROS.
  3035     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  3036     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  3037     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  3038     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  3039     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  3040     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  3041     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  3042     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  3043     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  3044     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  3045     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  3046     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  3047     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  3048     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3049     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  3050     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  3051                                         COMP-3 VALUE ZEROS.
  3052     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  3053     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3054     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3055     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3056     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3057     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  3058     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  3059     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  3060     12  W-POLICY-INACTIVE-CTR
  3061                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3062     12  W-POLICY-REISSUE-CTR
  3063                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3064     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  3065     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  3066     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  3067                                         COMP-3 VALUE ZEROS.
  3068     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  3069     12  W-WK-IBNR           PIC S9(07)V9(02)
  3070                                         COMP-3 VALUE ZEROS.
  3071
  3072     12  W-CLAIM-TYPE        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  64
* ECS010.cbl
  3073         88  W-A-H                              VALUE 'A'.
  3074         88  W-LIFE                             VALUE 'L'.
  3075     12  W-CUTOFF-DATE       PIC  9(08).
  3076     12  W-DIS-DT            PIC  XX.
  3077     12  W-DIS-PTO-DT        PIC  XX.
  3078     12  WK-LEVEL.
  3079         16  WK-AGT          PIC X(10).
  3080         16  WK-A-TYPE       PIC X.
  3081         16  WK-L-RT         PIC SV9(5)  COMP-3.
  3082         16  WK-J-RT         PIC SV9(5)  COMP-3.
  3083         16  WK-A-RT         PIC SV9(5)  COMP-3.
  3084         16  FILLER          PIC X(6).
  3085     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  3086         16  FILLER          PIC X(11).
  3087         16  WK-L-RTX        PIC X(3).
  3088         16  WK-J-RTX        PIC X(3).
  3089         16  WK-A-RTX        PIC X(3).
  3090         16  FILLER          PIC X(6).
  3091     12  WK-NEW-RATES.
  3092         16  WK-N-R      OCCURS 10.
  3093             20  WK-N-AGT    PIC X(10).
  3094             20  WK-N-TYPE   PIC X.
  3095             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  3096             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  3097     12  W-LIFE-YEARS-ZERO.
  3098         16  FILLER          PIC  X(06)         VALUE ZEROS.
  3099         16  FILLER          PIC  X(01)         VALUE SPACES.
  3100         16  FILLER          PIC  X(02)         VALUE ZEROS.
  3101         16  FILLER          PIC  X(01)         VALUE SPACES.
  3102         16  FILLER          PIC  X(01)         VALUE SPACES.
  3103         16  FILLER          PIC  X(01)         VALUE SPACES.
  3104         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3105         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3106         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3107         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3108         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3109         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3110         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3111         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3112         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3113         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3114         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3115         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3116         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3117         16  FILLER          PIC S9(09)V9(02) COMP-3
  3118                                                VALUE ZEROS.
  3119         16  FILLER          PIC S9(09)V9(02) COMP-3
  3120                                                VALUE ZEROS.
  3121         16  FILLER          PIC S9(09)V9(02) COMP-3
  3122                                                VALUE ZEROS.
  3123         16  FILLER          PIC S9(09)V9(02) COMP-3
  3124                                                VALUE ZEROS.
  3125         16  FILLER          PIC S9(11)V9(02) COMP-3
  3126                                                VALUE ZEROS.
  3127
  3128     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  3129         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  3130     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  65
* ECS010.cbl
  3131         88  W-REIN-PROCESS                     VALUE 'Y'.
  3132         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
  3133     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  3134         88  W-SELECTION-ON                     VALUE 'Y'.
  3135         88  W-SELECTION-OFF                    VALUE SPACES.
  3136     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  3137         88  W-RTRM-0                           VALUE 'Y'.
  3138         88  W-RTRM-NOT-0                       VALUE SPACES.
  3139     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  3140     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  3141         88  W-TABLE-USED                       VALUE 'Y'.
  3142         88  W-TABLE-NOT-USED                   VALUE SPACES.
  3143     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  3144         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  3145
  3146     12  W-VAL-ERRORS.
  3147         16  FILLER          PIC  X(40)
  3148             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  3149         16  FILLER          PIC  X(40)
  3150             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  3151         16  FILLER          PIC  X(40)
  3152             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  3153         16  FILLER          PIC  X(40)
  3154             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  3155         16  FILLER          PIC  X(40)
  3156             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  3157         16  FILLER          PIC  X(40)
  3158             VALUE 'RUN DATE EPEC - A&H - '.
  3159         16  FILLER          PIC  X(40)
  3160             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  3161         16  FILLER          PIC  X(40)
  3162             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  3163         16  FILLER          PIC  X(40)
  3164             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  3165     12  FILLER REDEFINES W-VAL-ERRORS.
  3166         16  W-VAL-ERROR OCCURS 9 TIMES
  3167                             PIC  X(40).
  3168
  3169     12  W-WORK-DATE         PIC  X(02).
  3170     12  SAVE-WK-NEW-RATES.
  3171         16  FILLER          PIC X(170).
  3172
  3173***   The following data area is for NCL only
  3174*    12  W-WORK-OB-DATA OCCURS 300.
  3175*    12  W-WORK-OB-DATA OCCURS 220.
  3176     12  W-WORK-OB-DATA OCCURS 900.
  3177         16  WS-OB-REIN-CO       PIC X(06).
  3178         16  WS-OB-LF-AH         PIC X.
  3179         16  WS-OB-BENEFIT-CODE  PIC XX.
  3180         16  WS-OB-EARNED OCCURS 3.
  3181             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  3182
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  66
* ECS010.cbl
  3184 01  EPEC-WORK-AREAS.
  3185     12  WE-REIN-CO          PIC X(6).
  3186     12  WE-LF-AH            PIC X.
  3187     12  WE-BEN-TYPE         PIC XX.
  3188     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  3189     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  3190     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  3191     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  3192     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  3193     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  3194     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  3195     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  3196     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  3197     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  3198     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  3199     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  3200     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  3201     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  3202     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  3203     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  3204     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  3205     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  3206     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  3207     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  3208     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  3209     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  3210     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  3211     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  3212     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  3213     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  3214     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  3215     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  3216     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  3217     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  3218     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  3219     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  3220     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  3221     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  3222     12  EPR-R78             PIC S9(7)V99    COMP-3.
  3223     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  3224     12  EPR-ST              PIC S9(7)V99    COMP-3.
  3225     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  3226     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  3227     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  3228     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  3229     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  3230     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  3231     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  3232     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  3233     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  3234     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  3235     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  3236     12  WX-SETTLEMENT-EXIT-DATE
  3237                             PIC  9(11)      COMP-3.
  3238     12  WX-STATUS-AT-CANCEL PIC  X(1).
  3239     12  WX-STATUS-AT-DEATH  PIC  X(1).
  3240     12  WX-STATUS-AT-SETTLEMENT
  3241                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  67
* ECS010.cbl
  3242     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  3243
  3244 01  EPEC-WORK.
  3245     12  EW-REIN-CO          PIC X(6).
  3246     12  EW-SUB-KEY.
  3247         16  EW-LF-AH        PIC X.
  3248         16  EW-BEN-TYPE     PIC XX.
  3249     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  3250     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3251     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  3252     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3253     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  3254     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3255     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  3256     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3257     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  3258     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  3259     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  3260     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  3261     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  3262     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  3263     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  3264     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  3265     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  3266     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  3267     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  3268     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  3269     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  3270     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  3271     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  3272     12  EW-AGENTS       OCCURS 10.
  3273         16  EW-AGT-NO       PIC X(10).
  3274         16  EW-AGT-TYPE     PIC X.
  3275         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  3276         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  3277         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  3278         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  3279         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  3280         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  3281         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  3282     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  3283     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  3284     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  3285     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  3286     12  EW-AGE              PIC S9(9)       COMP-3.
  3287     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  3288     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  3289     12  EW-LEVEL-USED       PIC X.
  3290
  3291 01  EPEC-TOTALS.
  3292     12  EPEC-LEVELS     OCCURS 900.
  3293*    12  EPEC-LEVELS     OCCURS 220.
  3294*    12  EPEC-LEVELS     OCCURS 300.
  3295         16  EPEC-REIN-CO          PIC X(6).
  3296         16  EPEC-SUB-KEY.
  3297             24  EPEC-LF-AH        PIC X.
  3298             24  EPEC-BEN-TYPE     PIC XX.
  3299*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  68
* ECS010.cbl
  3300         16  FILLER                PIC X(699).
  3301     12  EPEC-LEVELS-END           PIC X(6).
  3302
  3303 01  EPEC-UNDERWRITTEN-TOTALS.
  3304     12  EPEC-LEVELS-II  OCCURS 900.
  3305*    12  EPEC-LEVELS-II  OCCURS 220.
  3306*    12  EPEC-LEVELS-II  OCCURS 300.
  3307         16  EPEC-REIN-CO-II       PIC X(6).
  3308         16  EPEC-SUB-KEY-II.
  3309             24  EPEC-LF-AH-II     PIC X.
  3310             24  EPEC-BEN-TYPE-II  PIC XX.
  3311*        16  FILLER                PIC X(694).
  3312         16  FILLER                PIC X(699).
  3313     12  EPEC-LEVELS-END-II        PIC X(6).
  3314
  3315
  3316 01  FILLER                      PIC  X(11)
  3317                                 VALUE 'OPT RSV TBL'.
  3318*
  3319* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  3320*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  3321*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  3322*      EPEC-OPT-GRP  (108)
  3323*
  3324*      300 X 108 = 32400.
  3325*
  3326 01  EPEC-OPT-DATA-TABLE.
  3327*    12  FILLER                  PIC X(32400).
  3328*    12  FILLER                  PIC X(23760).
  3329     12  FILLER                  PIC X(97200).
  3330
  3331 01  FILLER                      PIC  X(16)
  3332                                 VALUE 'OPT RSV TBL UNDW'.
  3333 01  EPEC-UNDW-OPT-DATA-TABLE.
  3334*    12  FILLER                  PIC X(32400).
  3335*    12  FILLER                  PIC X(23760).
  3336     12  FILLER                  PIC X(97200).
  3337
  3338 01  FILLER                      PIC  X(16)
  3339                                 VALUE 'OPT RSV TBL WORK'.
  3340 01  EPEC-OPT-WORK-TABLE.
  3341*    12  EPEC-OPT-GRP        OCCURS 300.
  3342*    12  EPEC-OPT-GRP        OCCURS 220.
  3343     12  EPEC-OPT-GRP        OCCURS 900.
  3344         16  EPEC-REIN-CO-OPT
  3345                             PIC  X(06).
  3346         16  EPEC-SUB-KEY-OPT.
  3347             24  EPEC-LF-AH-OPT
  3348                             PIC  X(01).
  3349             24  EPEC-BEN-TYPE-OPT
  3350                             PIC  X(02).
  3351         16  EPEC-OPT-DATA.
  3352             20  EPEC-REIN-ONLY-IND
  3353                             PIC  X(01).
  3354                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  3355             20  EPEC-LINE-NOT-USED-IND
  3356                             PIC  X(01).
  3357                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  69
* ECS010.cbl
  3358             20  EPEC-LIFE-CTR-USED-IND
  3359                             PIC  X(01).
  3360                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  3361                 88  EPEC-LIFE-CTR-NOT-USED
  3362                                           VALUE ' '.
  3363             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  3364                             PIC S9(09)       COMP-3.
  3365             20  EPEC-EARNED-PREMIUM-AH
  3366                             PIC S9(09)V9(02) COMP-3.
  3367             20  EPEC-CLAIMS-MADE-PAID
  3368                             PIC S9(09)V9(02) COMP-3.
  3369             20  EPEC-CLM-EXP
  3370                             PIC S9(09)V9(02) COMP-3.
  3371             20  EPEC-LIFE-IBNR
  3372                             PIC S9(09)V9(02) COMP-3.
  3373             20  EPEC-REIN-ISS-BEN
  3374                             PIC S9(11)V9(02) COMP-3.
  3375
  3376 01  FILLER                  PIC X(09)
  3377                                 VALUE 'EOM TABLE'.
  3378
  3379 01  EOM-DATE-TABLE.
  3380     12  EOM-DATE            OCCURS 13
  3381                             PIC 9(08).
  3382
  3383 01  EPEC-SUBS.
  3384     12  EPEC-SUB-LEVELS OCCURS 31.
  3385         16  EPEC-SUB-REIN   PIC X(6).
  3386         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  3387         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  3388     12  EPEC-SUBS-END       PIC X(6).
  3389
  3390 01  SAVE-REIN-WORK.
  3391     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  3392     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  3393     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  3394     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  3395     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  3396
  3397 01  SAVE-REIN-TABLE.
  3398     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  3399         16  SR-TIME         PIC 9(6).
  3400         16  SR-ENTRY.
  3401             20  FILLER      PIC XX.
  3402             20  SR-CONTROL  PIC X(8).
  3403             20  FILLER      PIC X(3990).
  3404
  3405
* 3406                             COPY ECSRITAB.
  3407******************************************************************04/29/98
  3408*                                                                *ECSRITAB
  3409*                            ECSRITAB                            *   LV015
  3410*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  3411*                            VMOD=2.015                          *ECSRITAB
  3412*                                                                *ECSRITAB
  3413*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  3414*                                                                *ECSRITAB
  3415******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  70
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3416 01  REIN-WORK-AREAS.                                             ECSRITAB
  3417     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3418     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3419     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3420     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3421     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3422     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3423     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3424     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3425     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3426     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3427     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  3428         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  3429             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  3430             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  3431             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  3432     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3433     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3434     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3435     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3436     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3437     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3438     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3439     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3440     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3441     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3442     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3443     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3444     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3445     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3446     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3447     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3448     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3449     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3450     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3451     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3452     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3453     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3454     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3455                                                                  ECSRITAB
  3456 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3457     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3458         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3459         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3460             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3461             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3462         16  REIN-WORK-FLDS.                                      ECSRITAB
  3463             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3464             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3465             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3466             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3467             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3468             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3469             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3470             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3471             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3472             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3473             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  71
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3474             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3475             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3476             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3477             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3478             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3479             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3480             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3481             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3482             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3483             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3484             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3485             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3486             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3487             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3488             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3489             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3490             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3491     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3492                                                                  ECSRITAB
  3493     12  RWF-FIELDS.                                              ECSRITAB
  3494         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3495         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3496         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3497         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3498         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3499         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3500         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3501         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3502         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3503         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3504         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3505         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3506         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3507         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3508         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3509         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3510         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3511         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3512         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3513         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3514         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3515         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3516         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3517         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3518         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3519         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3520         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3521         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3522                                                                  ECSRITAB
  3523     12  WT-COMP-INFO.                                            ECSRITAB
  3524         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3525         16  WT-LF-QC                PIC X.                       ECSRITAB
  3526         16  WT-AH-QC                PIC X.                       ECSRITAB
  3527         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3528         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3529         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3530         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3531         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  72
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3532         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3533         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3534         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3535         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3536         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3537         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3538         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3539         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3540         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3541         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3542         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3543         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3544         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3545         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3546         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3547         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3548         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3549         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3550         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3551         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3552         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3553         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3554         16  WT-REMAINING            PIC X.                       ECSRITAB
  3555         16  FILLER                  PIC X(21).                   ECSRITAB
  3556                                                                  ECSRITAB
  3557 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3558     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3559     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3560     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3561     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3562     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3563     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3564     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3565     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3566     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3567     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3568     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3569     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3570     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3571     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3572     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3573     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3574     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3575     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3576     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3577     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3578     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3579     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3580     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3581     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3582                                                                  ECSRITAB
  3583     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3584         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3585     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3586         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3587     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3588         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3589     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  73
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3590         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3591     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3592         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3593     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3594         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3595                                                                  ECSRITAB
  3596     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3597         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3598         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3599         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3600         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3601         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3602         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3603         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3604         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3605         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3606         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3607         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3608         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3609         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3610         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3611         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3612         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3613         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3614         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3615         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3616         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3617         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3618         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3619         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3620     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3621     12  REIN-SEARCH.                                             ECSRITAB
  3622         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3623         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3624         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3625         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3626     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3627     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3628     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3629     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3630     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3631     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3632     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3633     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3634     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3635     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3636     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3637     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3638     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3639     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3640     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3641     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3642     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3643     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3644     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3645     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3646     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3647     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  74
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3648     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3649     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3650     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3651                                                                  ECSRITAB
  3652 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3653* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3654     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3655         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3656         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3657         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3658         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3659         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3660         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3661         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3662         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3663         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3664                                                                  ECSRITAB
  3665 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3666     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3667         16  RC2-REIN-CO.                                         ECSRITAB
  3668             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3669             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3670         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3671         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3672         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3673         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3674         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3675         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3676                                                                  ECSRITAB
  3677 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3678     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3679         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3680         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3681     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3682                                                                  ECSRITAB
  3683 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3684     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3685         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3686         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3687         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3688 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3689     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3690         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3691                                                                  ECSRITAB
  3692 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3693******************************************************************ECSRITAB
  3694
* 3695                             COPY ELCPSEVR.
  3696******************************************************************04/16/98
  3697*                                                                *ELCPSEVR
  3698*                                                                *ELCPSEVR
  3699*                            ELCPSEVR                            *   LV003
  3700*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3701*                            VMOD=2.001                          *ELCPSEVR
  3702*                                                                *ELCPSEVR
  3703*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3704*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3705*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  75
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3706******************************************************************ELCPSEVR
  3707                                                                  ELCPSEVR
  3708 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3709     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3710         10  FILLER               PIC 999.                        ELCPSEVR
  3711         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3712         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3713             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3714             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3715         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3716         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3717     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3718            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3719     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3720         10  FILLER              PIC 999.                         ELCPSEVR
  3721         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3722         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3723             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3724             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3725         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3726         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3727     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3728            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3729 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3730     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3731                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3732         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3733             15  FILLER              PIC 999.                     ELCPSEVR
  3734             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3735             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3736                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3737                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3738             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3739             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3740         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3741                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3742         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3743             15  FILLER              PIC 999.                     ELCPSEVR
  3744             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3745             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3746                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3747                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3748             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3749             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3750         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3751                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3752         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3753             15  FILLER              PIC 999.                     ELCPSEVR
  3754             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3755             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3756                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3757                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3758             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3759             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3760         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3761                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3762     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3763         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  76
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3764         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3765         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3766             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3767             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3768         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3769         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3770     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3771            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3772
* 3773                             COPY ELCEPCVR.
  3774******************************************************************05/15/98
  3775*                                                                *ELCEPCVR
  3776*                                                                *ELCEPCVR
  3777*                            ELCEPCVR                            *   LV003
  3778*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3779*                            VMOD=2.001                          *ELCEPCVR
  3780*                                                                *ELCEPCVR
  3781*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3782*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3783*                                                                *ELCEPCVR
  3784******************************************************************ELCEPCVR
  3785 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3786     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3787         10  FILLER            PIC 999.                           ELCEPCVR
  3788         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3789         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3790             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3791             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3792         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3793         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3794     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3795            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3796     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3797         10  FILLER            PIC 999.                              CL**5
  3798         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3799         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3800             15  EC-EXP-CC     PIC 99.                               CL**5
  3801             15  EC-EXP-YR     PIC 99.                               CL**5
  3802         10  EC-EXP-MO         PIC 99.                               CL**5
  3803         10  EC-EXP-DA         PIC 99.                               CL**5
  3804     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3805            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3806     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3807         10  FILLER            PIC 999.                           ELCEPCVR
  3808         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3809         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3810             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3811             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3812         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3813         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3814     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3815            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3816     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3817         10  FILLER            PIC 999.                              CL**5
  3818         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3819         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3820             15  EC-EFF-CC     PIC 99.                               CL**5
  3821             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  77
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3822         10  EC-EFF-MO         PIC 99.                               CL**5
  3823         10  EC-EFF-DA         PIC 99.                               CL**5
  3824     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3825            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3826     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3827         10  FILLER            PIC 999.                           ELCEPCVR
  3828         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3829         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3830             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3831             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3832         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3833         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3834     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3835            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3836     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3837         10  FILLER            PIC 999.                           ELCEPCVR
  3838         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3839         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3840             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3841             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3842         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3843         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3844     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3845            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3846     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3847         10  FILLER            PIC 999.                           ELCEPCVR
  3848         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3849         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3850             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3851             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3852         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3853         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3854     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3855            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3856     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3857         10  FILLER            PIC 999.                           ELCEPCVR
  3858         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3859         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3860             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3861             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3862         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3863         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3864     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3865            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3866     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3867         10  FILLER            PIC 999.                           ELCEPCVR
  3868         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3869         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3870             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3871             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3872         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3873         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3874     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3875            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3876
* 3877                             COPY ELCREINV.
  3878******************************************************************04/18/98
  3879*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  78
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3880*                                                                *ELCREINV
  3881*                            ELCREINV                            *   LV003
  3882*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3883*                            VMOD=2.001                          *ELCREINV
  3884*                                                                *ELCREINV
  3885*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3886*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3887*                                                                *ELCREINV
  3888******************************************************************ELCREINV
  3889                                                                  ELCREINV
  3890 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3891     05  WS-RE-LO-DATE.                                              CL**3
  3892         10 FILLER                     PIC 999.                      CL**3
  3893         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3894         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3895            15 RE-LO-CC                PIC 99.                       CL**3
  3896            15 RE-LO-YR                PIC 99.                       CL**3
  3897         10 RE-LO-MO                   PIC 99.                       CL**3
  3898         10 RE-LO-DA                   PIC 99.                       CL**3
  3899     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3900            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3901     05  WS-RE-HI-DATE.                                              CL**3
  3902         10 FILLER                     PIC 999.                      CL**3
  3903         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3904         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3905            15 RE-HI-CC                PIC 99.                       CL**3
  3906            15 RE-HI-YR                PIC 99.                       CL**3
  3907         10 RE-HI-MO                   PIC 99.                       CL**3
  3908         10 RE-HI-DA                   PIC 99.                       CL**3
  3909     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3910            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3911     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3912         10 FILLER                     PIC 999.                   ELCREINV
  3913         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3914         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3915            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3916            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3917         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3918         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3919     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3920            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3921     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3922         10  FILLER                    PIC 999.                   ELCREINV
  3923         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3924         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3925             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3926             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3927         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3928         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3929     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3930            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3931     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3932         10  FILLER                    PIC 999.                   ELCREINV
  3933         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3934         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3935             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3936             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3937         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  79
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3938         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3939     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3940            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3941
  3942 01  RC-REIN-HOLD-AREAS.
  3943     12  RC-REIN-LEVELS  OCCURS 30.
  3944         16  RC-REIN-COMP    PIC X(6).
  3945         16  RC-OLD-ISS      PIC X.
  3946         16  RC-NEW-ISS      PIC X.
  3947         16  RC-OLD-CNC      PIC X.
  3948         16  RC-NEW-CNC      PIC X.
  3949         16  RC-OLD-LF-CLM   PIC X.
  3950         16  RC-OLD-AH-CLM   PIC X.
  3951         16  RC-NEW-LF-CLM   PIC X.
  3952         16  RC-NEW-AH-CLM   PIC X.
  3953         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3954         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3955         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3956         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3957         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3958         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3959         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3960         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3961         16  RC-REIN-REM-SW  PIC X.
  3962     12  RC-REIN-LEVELS-END  PIC X(6).
  3963
  3964 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3965     12  TPC-COUNTERS    OCCURS 6.
  3966         16  TPL-ISS-PRM     PIC S9(9)V99.
  3967         16  TPA-ISS-PRM     PIC S9(9)V99.
  3968         16  TPL-CNC-PRM     PIC S9(9)V99.
  3969         16  TPA-CNC-PRM     PIC S9(9)V99.
  3970         16  TPL-ACCT-COM    PIC S9(9)V99.
  3971         16  TPA-ACCT-COM    PIC S9(9)V99.
  3972         16  TPL-CLAIMS      PIC S9(9)V99.
  3973         16  TPA-CLAIMS      PIC S9(9)V99.
  3974
  3975 01  HLD-DTS SYNC.
  3976     12  EOM-RUN-DATE        PIC 9(08).
  3977     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3978         16  EOM-CCYY.
  3979             20  EOM-CC      PIC 99.
  3980             20  EOM-YR      PIC 99.
  3981         16  EOM-MO          PIC 99.
  3982         16  EOM-DA          PIC 99.
  3983
  3984****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3985****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3986     12  OB-RUN-DATES OCCURS 2.
  3987         16  OB-CCYY         PIC 9(4).
  3988         16  OB-MO           PIC 99.
  3989         16  OB-DA           PIC 99.
  3990
  3991     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3992         88  OB-DATE-1-USED     VALUE '*'.
  3993     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3994         88  OB-DATE-2-USED     VALUE '*'.
  3995     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  80
* ECS010.cbl
  3996         88  OB-DATE-3-USED     VALUE '*'.
  3997     12  EARNING-START-DATE  PIC 9(08).
  3998     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3999         16  E-ERN-START-CC  PIC 99.
  4000         16  E-ERN-START-YR  PIC 99.
  4001         16  E-ERN-START-MO  PIC 99.
  4002         16  E-ERN-START-DA  PIC 99.
  4003     12  EARNING-STOP-DATE   PIC 9(08).
  4004     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  4005         16  E-ERN-STOP-CC   PIC 99.
  4006         16  E-ERN-STOP-YR   PIC 99.
  4007         16  E-ERN-STOP-MO   PIC 99.
  4008         16  E-ERN-STOP-DA   PIC 99.
  4009     12  STOP-LF-DATE        PIC 9(08).
  4010     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  4011         16  STOP-LF-CC      PIC 99.
  4012         16  STOP-LF-YR      PIC 99.
  4013         16  STOP-LF-MO      PIC 99.
  4014         16  STOP-LF-DA      PIC 99.
  4015     12  STOP-AH-DATE        PIC 9(08).
  4016     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  4017         16  STOP-AH-CC      PIC 99.
  4018         16  STOP-AH-YR      PIC 99.
  4019         16  STOP-AH-MO      PIC 99.
  4020         16  STOP-AH-DA      PIC 99.
  4021     12  BIN-VALUATION-DT    PIC XX.
  4022     12  BIN-EOM-RUN-DATE    PIC XX.
  4023     12  LAST-YRS-DATE       PIC 9(08).
  4024     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  4025         16  LYD-CCYY        PIC 9(04).
  4026         16  LYD-CCYR REDEFINES LYD-CCYY.
  4027             20  LYD-CC      PIC 99.
  4028             20  LYD-YR      PIC 99.
  4029         16  LYD-MO          PIC 99.
  4030         16  LYD-DA          PIC 99.
  4031     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  4032     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  4033         16  VAL-CC          PIC 99.
  4034         16  VAL-YR          PIC 99.
  4035         16  VAL-MO          PIC 99.
  4036         16  VAL-DA          PIC 99.
  4037     12  INCURRED-DATE       PIC 9(08).
  4038     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  4039         16  DTO-CC          PIC 99.
  4040         16  DTO-YR          PIC 99.
  4041         16  DTO-MO          PIC 99.
  4042         16  DTO-DA          PIC 99.
  4043     12  REPORTED-DATE.
  4044         16  RPT-YR          PIC 99.
  4045         16  RPT-MO          PIC 99.
  4046         16  RPT-DA          PIC 99.
  4047     12  PAYMENT-DATE        PIC 9(08).
  4048     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  4049         16  PAY-CC          PIC 99.
  4050         16  PAY-YR          PIC 99.
  4051         16  PAY-MO          PIC 99.
  4052         16  PAY-DA          PIC 99.
  4053     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  81
* ECS010.cbl
  4054     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  4055         16  PAYTO-CC        PIC 99.
  4056         16  PAYTO-YR        PIC 99.
  4057         16  PAYTO-MO        PIC 99.
  4058         16  PAYTO-DA        PIC 99.
  4059
  4060 01  AH-RES-STATE-TABLE.
  4061     12  FILLER              PIC X(42)       VALUE
  4062             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  4063     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  4064
  4065 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  4066     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  4067
  4068 01  BILLING-COUNTERS    COMP-3.
  4069     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  4070     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  4071     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  4072     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  4073     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  4074     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  4075     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  4076     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  4077     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  4078     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  4079     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  4080     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  4081     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  4082     12  BC-COMM             PIC S9(5)           VALUE +0.
  4083     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  4084     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  4085     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  4086     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  4087     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  4088     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  4089     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  4090     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  4091     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  4092     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  4093
  4094 01  FLAGS SYNC.
  4095     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  4096         88  CHECK-BILLED                        VALUE 'Y'.
  4097     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  4098         88  EOF-ON-TRANS                        VALUE '*'.
  4099     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  4100         88  EOF-ON-CERT                         VALUE '*'.
  4101     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  4102         88  PROCESSING-COMPLETED                VALUE '*'.
  4103     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  4104         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  4105     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  4106         88  PRINTING-CERT-CHANGES               VALUE '*'.
  4107     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  4108         88  STATUTORY-REQUIREMENT               VALUE '*'.
  4109     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  4110         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  4111     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  82
* ECS010.cbl
  4112         88  LIFE-FULLY-EARNED                   VALUE '*'.
  4113     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  4114         88  A-H-FULLY-EARNED                    VALUE '*'.
  4115     12  CNCL-FLG            PIC X               VALUE SPACE.
  4116     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  4117         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  4118         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  4119     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  4120         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  4121     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  4122         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  4123     12  EP-FLG              PIC X               VALUE SPACE.
  4124     12  END-FLG             PIC X               VALUE SPACE.
  4125     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  4126     12  PRIOR-CERT-IN-CNTRL.
  4127         16  PCIC-FIRST      PIC x(19)  value low-values.
  4128         16  pcic-dt         pic 9(11)  comp-3  value zeros.
  4129         16  pcic-cert-no    pic x(11)  value low-values.
  4130     12  ACCT-FLG            PIC X               VALUE SPACE.
  4131     12  STATE-FLG           PIC X               VALUE SPACE.
  4132     12  COMP-FLG            PIC X               VALUE SPACE.
  4133     12  CARR-FLG            PIC X               VALUE SPACE.
  4134     12  FINAL-FLG           PIC X               VALUE SPACE.
  4135     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  4136     12  REIN-FLG            PIC X               VALUE SPACE.
  4137     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  4138     12  REIN-RT-SW          PIC X               VALUE SPACE.
  4139
  4140 01  TEXAS-REG-WORK-AREAS   SYNC.
  4141     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  4142     12  TEX-FACT-2          PIC S999        COMP-3.
  4143     12  TEX-FACT-3          PIC S999        COMP-3.
  4144     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  4145     12  TEX-FACT-5          PIC S999        COMP-3.
  4146     12  TEX-FACT-6          PIC S999        COMP-3.
  4147     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  4148     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  4149     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  4150
  4151 01  NET-PAY-INTERFACE.
  4152     12  NP-APR              PIC S999V9(4)   COMP-3.
  4153     12  NP-ORIG             PIC S999        COMP-3.
  4154     12  NP-REM              PIC S999        COMP-3.
  4155     12  NP-OPT              PIC X.
  4156     12  NP-CAP              PIC S999        COMP-3.
  4157     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  4158     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  4159     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  4160     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  4161     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  4162     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  4163     12  NP-ACCOUNT          PIC X(10).
  4164
  4165 01  HOLDERS SYNC.
  4166     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  4167     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4168     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4169     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  83
* ECS010.cbl
  4170     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4171     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4172     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
  4173     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4174     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4175     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  4176     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  4177     12  TEMP-3              PIC S9(7)V99 COMP-3 VALUE +0.
  4178     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  4179     12  TEMP-5              PIC S9V9(9)  COMP-3 VALUE +0.
  4180     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  4181     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  4182     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  4183     12  REM-TRM1            PIC S999V99  COMP-3.
  4184     12  REM-TRM2            PIC S999V99  COMP-3.
  4185     12  REM-TRM3            PIC S999V99  COMP-3.
  4186     12  DCC-DDF-REM-TRM3    PIC S999V99  COMP-3.
  4187     12  TEM-TRM1            PIC S999V99  COMP-3.
  4188     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  4189     12  ORIG-TERM           PIC S999V99  COMP-3.
  4190     12  HLD-CONTROL.
  4191         16  HLD-CARRIER     PIC X               VALUE SPACES.
  4192         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  4193         16  HLD-STATE       PIC XX              VALUE SPACES.
  4194         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  4195     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  4196
  4197 01  DISPLAY-IBNR-LINE.
  4198     05  FILLER                  PIC X       VALUE SPACES.
  4199     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  4200     05  FILLER                  PIC XX      VALUE SPACES.
  4201     05  DIL-TYPE                PIC X       VALUE SPACES.
  4202     05  FILLER                  PIC X       VALUE SPACES.
  4203     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  4204     05  FILLER                  PIC XXX     VALUE SPACES.
  4205     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  4206
  4207 01  DISPLAY-HD-1.
  4208     05  FILLER      PIC X       VALUE SPACES.
  4209     05  FILLER      PIC X(50)   VALUE SPACES.
  4210     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  4211     05  FILLER      PIC X(51)   VALUE SPACES.
  4212     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4213
  4214 01  DISPLAY-HD-2.
  4215     05  FILLER                 PIC X       VALUE SPACE.
  4216     05  FILLER                 PIC X(57)   VALUE SPACES.
  4217     05  DIS-DATE               PIC X(8).
  4218     05  FILLER                 PIC X(66)   VALUE SPACES.
  4219
  4220 01  DISPLAY-LINE.
  4221     05  DL-FULL.
  4222         10  FILLER           PIC X       VALUE SPACE.
  4223         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  4224         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  4225
  4226 01  PRT-HDNGS SYNC.
  4227     12  TR-HD-1.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  84
* ECS010.cbl
  4228         16  FILLER      PIC X       VALUE '1'.
  4229         16  FILLER      PIC X(53)   VALUE SPACES.
  4230         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  4231         16  FILLER      PIC X(48)   VALUE SPACES.
  4232         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4233     12  TR-HD-2.
  4234         16  FILLER      PIC X       VALUE SPACE.
  4235         16  FILLER      PIC X(47)   VALUE SPACES.
  4236         16  TRHDNM      PIC X(30).
  4237         16  FILLER      PIC X(42)   VALUE SPACES.
  4238         16  TR-RN-DT    PIC X(8).
  4239     12  TR-HD-3.
  4240         16  FILLER      PIC X       VALUE SPACE.
  4241         16  FILLER      PIC X(53)   VALUE SPACES.
  4242         16  TR-MODAYR   PIC X(18).
  4243         16  FILLER      PIC X       VALUE SPACE.
  4244         16  TR-YRASK    PIC X       VALUE SPACE.
  4245         16  FILLER      PIC X(46)   VALUE SPACES.
  4246         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  4247         16  TR-PG       PIC ZZ,ZZ9.
  4248     12  TR-HD-4.
  4249         16  FILLER      PIC X       VALUE SPACE.
  4250         16  TR-AGCY     PIC X(30).
  4251     12  TR-HD-5.
  4252         16  FILLER      PIC X       VALUE SPACE.
  4253         16  TR-CARR     PIC X.
  4254         16  FILLER      PIC X       VALUE '-'.
  4255         16  TR-GROUP    PIC X(6).
  4256         16  FILLER      PIC X       VALUE '-'.
  4257         16  TR-ST-NO    PIC X(2).
  4258         16  FILLER      PIC X       VALUE '-'.
  4259         16  TR-AG-NO    PIC X(10).
  4260         16  FILLER      PIC X(23)   VALUE SPACES.
  4261         16  TR5-RP-TYP.
  4262             20  FILLER  PIC X(20)   VALUE
  4263                     '* * * * TRANSACTION '.
  4264             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  4265     12  TR-HD-6.
  4266         16  FILLER      PIC X       VALUE SPACE.
  4267         16  TR-CE-MO    PIC XX.
  4268         16  FILLER      PIC X       VALUE '-'.
  4269         16  TR-CE-DA    PIC XX.
  4270         16  FILLER      PIC X       VALUE '-'.
  4271         16  TR-CE-YR    PIC XX.
  4272         16  FILLER      PIC X(6)    VALUE '  TO  '.
  4273         16  TR-CX.
  4274             20  TR-CX-MO PIC XX.
  4275             20  HSHR1    PIC X.
  4276             20  TR-CX-DA PIC XX.
  4277             20  HSHR2    PIC X.
  4278             20  TR-CX-YR PIC XX.
  4279     12  TR-HD-7.
  4280         16  FILLER  PIC X      VALUE '0'.
  4281         16  FILLER  PIC X(24)  VALUE SPACES.
  4282         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  4283         16  TR-7-LF PIC X(6).
  4284         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  4285         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  85
* ECS010.cbl
  4286         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  4287         16  TR-7-AH PIC X(6).
  4288         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  4289         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  4290     12  TR-HD-8.
  4291         16  FILLER  PIC X      VALUE SPACE.
  4292         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  4293         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  4294         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  4295         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  4296         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  4297     12  TR-HD-9.
  4298         16  FILLER  PIC X      VALUE SPACE.
  4299         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  4300         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  4301         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  4302         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  4303         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  4304         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  4305     12  TR-TTL-HD.
  4306         16  FILLER      PIC X       VALUE '0'.
  4307         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  4308         16  FILLER      PIC XX      VALUE SPACES.
  4309         16  TTL-HD-DS   PIC X(60)   VALUE
  4310             'ECS010 CONTROL TOTALS'.
  4311
  4312 01  TR-DTL.
  4313     12  FILLER                  PIC X           VALUE SPACE.
  4314     12  TR-DTL1.
  4315         16  TRD-CERT            PIC X(11).
  4316         16  TRD-ISDT.
  4317             20  FILLER          PIC X           VALUE SPACE.
  4318             20  TRD-ISMO        PIC XX.
  4319             20  TRD-IS-S1       PIC X           VALUE '/'.
  4320             20  TRD-ISDA        PIC XX.
  4321             20  TRD-IS-S2       PIC X           VALUE '/'.
  4322             20  TRD-ISYR        PIC XX.
  4323             20  FILLER          PIC X           VALUE SPACE.
  4324         16  TRD-AGE             PIC XX.
  4325     12  TR-DTL2.
  4326         16  FILLER              PIC X           VALUE SPACE.
  4327         16  TRD-LFTYP           PIC XXX.
  4328         16  FILLER              PIC X           VALUE SPACE.
  4329         16  TRD-LFTRM           PIC ZZ9.
  4330         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4331         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4332         16  TRD-LFACTDT.
  4333             20  FILLER          PIC X           VALUE SPACE.
  4334             20  TRD-LFACTMO     PIC XX.
  4335             20  TRD-LF-S1       PIC X           VALUE '/'.
  4336             20  TRD-LFACTDA     PIC XX.
  4337             20  TRD-LF-S2       PIC X           VALUE '/'.
  4338             20  TRD-LFACTYR     PIC XX.
  4339             20  FILLER          PIC X           VALUE SPACE.
  4340         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  4341         16  FILLER              PIC X           VALUE SPACE.
  4342         16  TRD-LF-STATUS       PIC X.
  4343         16  FILLER              PIC X(4)        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  86
* ECS010.cbl
  4344         16  TRD-AHTYP           PIC XXX.
  4345         16  FILLER              PIC X           VALUE SPACE.
  4346         16  TRD-AHTRM           PIC ZZ9.
  4347         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4348         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4349         16  TRD-AHACTDT.
  4350             20  FILLER          PIC X           VALUE SPACE.
  4351             20  TRD-AHACTMO     PIC XX.
  4352             20  TRD-AH-S1       PIC X           VALUE '/'.
  4353             20  TRD-AHACTDA     PIC XX.
  4354             20  TRD-AH-S2       PIC X           VALUE '/'.
  4355             20  TRD-AHACTYR     PIC XX.
  4356             20  FILLER          PIC X           VALUE SPACE.
  4357         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  4358         16  FILLER              PIC X           VALUE SPACE.
  4359         16  TRD-AH-STATUS       PIC X.
  4360     12  TR-DTL3 REDEFINES TR-DTL2.
  4361         16  FILLER              PIC X(20).
  4362         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  4363         16  FILLER              PIC X.
  4364         16  TRD-IBNRX           PIC X(4).
  4365         16  FILLER              PIC X(2).
  4366         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  4367         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  4368                                 PIC X(11).
  4369         16  FILLER              PIC X.
  4370         16  TRD-PAYCURX         PIC X(8).
  4371         16  FILLER              PIC X(2).
  4372         16  TRD-FUTRSV-DATA.
  4373             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  4374             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  4375                                 PIC X(11).
  4376             20  FILLER          PIC X.
  4377             20  TRD-FUTRSVX     PIC X(6).
  4378         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  4379             20  TRD-BENEFIT-X   PIC X(10).
  4380             20  TRD-BENEFIT-CODE
  4381                                 PIC X(02).
  4382             20  FILLER          PIC X(06).
  4383         16  FILLER              PIC X(4).
  4384         16  TRD-RSV-DESC        PIC X(6).
  4385         16  TRD-RSV-ACTION      PIC X(21).
  4386
  4387 01  DET-PR-UREC.
  4388     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  4389     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  4390     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  4391     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  4392     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  4393     12  DET-SEX             PIC X.
  4394     12  FILLER              PIC X(9)     VALUE '   APR - '.
  4395     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  4396     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  4397     12  DET-PR-MEM          PIC X(12).
  4398     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  4399     12  DET-PR-SS           PIC X(11).
  4400     12  FILLER              PIC XXX      VALUE SPACES.
  4401     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  87
* ECS010.cbl
  4402
  4403 01  DET-PR-UREC-2.
  4404     12  FILLER              PIC X        VALUE SPACE.
  4405     12  DET-LF-DESC         PIC XX.
  4406     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4407     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4408     12  FILLER              PIC X(4)     VALUE ' TO '.
  4409     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4410     12  FILLER              PIC X        VALUE SPACE.
  4411     12  DET-AH-DESC         PIC XX.
  4412     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4413     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4414     12  FILLER              PIC X(4)     VALUE ' TO '.
  4415     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4416     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  4417     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4418     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  4419     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4420     12  FILLER              PIC X(5)     VALUE SPACES.
  4421     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4422
  4423 01  DET-PR-UREC-3.
  4424     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  4425     12  DET-IND-GRP         PIC X.
  4426     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  4427     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  4428     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  4429     12  DET-POL-FORM        PIC X(12).
  4430     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  4431     12  DET-LOAN-OFFICER    PIC XXX.
  4432     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  4433     12  DET-USER-CODE       PIC X.
  4434     12  FILLER              PIC X(8)     VALUE SPACES.
  4435     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4436
  4437 01  DET-PR-UREC-4.
  4438     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  4439     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4440     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  4441     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4442     12  FILLER              PIC X(37)    VALUE SPACES.
  4443     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4444
  4445 01  DET-PR-UREC-5.
  4446     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4447     12  DET-LF-BEN-CD       PIC XX.
  4448     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4449     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4450     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4451     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4452     12  FILLER              PIC X(30)    VALUE SPACES.
  4453     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4454
  4455 01  DET-PR-UREC-6.
  4456     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4457     12  DET-AH-BEN-CD       PIC XX.
  4458     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4459     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  88
* ECS010.cbl
  4460     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4461     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4462     12  FILLER              PIC X(30)    VALUE SPACES.
  4463     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4464
  4465 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4466     88  WS-CHANGE-REC              VALUE 'Y'.
  4467
  4468 01  TOTAL-PAGE-HD1.
  4469     12  FILLER              PIC X               VALUE SPACE.
  4470     12  TPH1-TYPE           PIC X(8).
  4471     12  TPH1-DESC.
  4472         16  TPH1-ST-CODE    PIC XX.
  4473         16  FILLER          PIC XXX.
  4474         16  TPH1-ST-DESC    PIC X(20).
  4475
  4476 01  TOTAL-PAGE-HD2.
  4477     12  FILLER              PIC X           VALUE SPACE.
  4478     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4479     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4480     12  FILLER              PIC X(9)        VALUE SPACES.
  4481     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4482     12  FILLER              PIC X(11)       VALUE SPACES.
  4483     12  FILLER              PIC X(3)        VALUE 'NET'.
  4484     12  FILLER              PIC X(11)       VALUE SPACES.
  4485     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4486     12  FILLER              PIC X(10)       VALUE SPACES.
  4487     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4488
  4489 01  TOTAL-PAGE-HD3.
  4490     12  FILLER              PIC X           VALUE SPACE.
  4491     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4492     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4493     12  FILLER              PIC X(10)       VALUE SPACES.
  4494     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4495     12  FILLER              PIC X(10)       VALUE SPACES.
  4496     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4497     12  FILLER              PIC X(7)        VALUE SPACES.
  4498     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4499     12  FILLER              PIC X(08)       VALUE SPACES.
  4500     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4501     12  FILLER              PIC X(11)       VALUE SPACES.
  4502     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4503
  4504 01  TOTAL-PAGE-DETAIL.
  4505     12  FILLER              PIC X(5).
  4506     12  TPD-DESC            PIC X(6).
  4507     12  FILLER              PIC X(3).
  4508     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4509     12  FILLER              PIC X(2).
  4510     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4511     12  FILLER              PIC X(2).
  4512     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4513     12  FILLER              PIC X(2).
  4514     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4515     12  FILLER              PIC X(2).
  4516     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4517     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  89
* ECS010.cbl
  4518     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4519     12  FILLER              PIC X(4).
  4520     12  TPD-LO-CERT         PIC X(6).
  4521     12  FILLER              PIC X(2).
  4522     12  TPD-HI-CERT         PIC X(6).
  4523*    12  FILLER              PIC X.
  4524*    12  TPD-LO-CERT         PIC X(8).
  4525*    12  FILLER              PIC X.
  4526*    12  TPD-HI-CERT         PIC X(8).
  4527
  4528 01  DUPE-CERT-TABLE.
  4529     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4530         16  DUPE-ENTRY      PIC X(36).
  4531         16  DUPE-STATUS     PIC X(01).
  4532         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4533         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4534
  4535 01  MISMATCH-HEADING-1.
  4536     12  FILLER              PIC X           VALUE '1'.
  4537     12  FILLER              PIC X(45)       VALUE SPACES.
  4538     12  FILLER              PIC X(42)       VALUE
  4539             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4540     12  FILLER              PIC X(35)       VALUE SPACES.
  4541     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4542
  4543 01  MISMATCH-HEADING-2.
  4544     12  FILLER              PIC X           VALUE '0'.
  4545     12  FILLER              PIC X(44)       VALUE
  4546             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4547     12  FILLER              PIC X(44)       VALUE
  4548             'YPE      CERT IN CONTROL                    '.
  4549     12  FILLER              PIC X(44)       VALUE
  4550             '        CERT OUT CONTROL           STATUS   '.
  4551
  4552 01  MISMATCH-DETAIL.
  4553     12  FILLER              PIC X           VALUE '0'.
  4554     12  FILLER              PIC X           VALUE SPACES.
  4555     12  DTL-MATCH-CONTROL   PIC X(36).
  4556     12  FILLER              PIC X(3)        VALUE SPACES.
  4557     12  DTL-REC-TYPE        PIC X.
  4558     12  FILLER              PIC X(2)        VALUE SPACES.
  4559     12  DTL-REC-TYPE-DESC   PIC X(3).
  4560     12  FILLER              PIC X(3)        VALUE SPACES.
  4561     12  DTL-CERT-IN-CONTROL
  4562                             PIC X(36).
  4563     12  FILLER              PIC X           VALUE SPACES.
  4564     12  DTL-CERT-OUT-CONTROL
  4565                             PIC X(36).
  4566     12  FILLER              PIC X           VALUE SPACES.
  4567     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4568     12  FILLER              PIC X(2)        VALUE SPACES.
  4569
  4570 01  MISMATCH-DETAIL-2.
  4571     12  FILLER              PIC X           VALUE ' '.
  4572     12  FILLER              PIC X           VALUE SPACES.
  4573     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4574             ' LIFE PREMIUM = '.
  4575     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  90
* ECS010.cbl
  4576     12  FILLER              PIC X           VALUE SPACES.
  4577     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4578             'LIFE ALT PREM = '.
  4579     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
  4580     12  FILLER              PIC XX          VALUE SPACES.
  4581     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4582             'A/H PREMIUM = '.
  4583     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4584     12  FILLER              PIC X(39)       VALUE SPACES.
  4585
  4586 01  MISMATCH-DETAIL-3.
  4587     12  FILLER              PIC X           VALUE ' '.
  4588     12  FILLER              PIC X           VALUE SPACES.
  4589     12  FILLER              PIC X(16)       VALUE
  4590             ' LIFE  REFUND = '.
  4591     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4592     12  FILLER              PIC X           VALUE SPACES.
  4593     12  FILLER              PIC X(16)       VALUE
  4594             'A & H  REFUND = '.
  4595     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4596     12  FILLER              PIC X(72)       VALUE SPACES.
  4597
  4598 01  MISMATCH-DETAIL-4.
  4599     12  FILLER              PIC X           VALUE ' '.
  4600     12  FILLER              PIC X           VALUE SPACES.
  4601     12  FILLER              PIC X(16)       VALUE
  4602             ' LIFE  CLAIM  = '.
  4603     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4604     12  FILLER              PIC X           VALUE SPACES.
  4605     12  FILLER              PIC X(16)       VALUE
  4606             'A & H  CLAIM  = '.
  4607     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4608     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  91
* ECS010.cbl
  4610*
  4611*
  4612* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  92
* ECS010.cbl
  4614 01  PB-STARTS-HERE              PIC X(48)
  4615       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4616
* 4617                             COPY ERCPNDB.
  4618******************************************************************
  4619*                                                                *
  4620*                                                                *
  4621*                            ERCPNDB.                            *
  4622*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4623*                            VMOD=2.025                          *
  4624*                                                                *
  4625*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4626*                                                                *
  4627******************************************************************
  4628*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4629*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4630******************************************************************
  4631*                                                                *
  4632*                                                                *
  4633*   FILE TYPE = VSAM,KSDS                                        *
  4634*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4635*                                                                *
  4636*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4637*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4638*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4639*                                                 RKP=13,LEN=36  *
  4640*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4641*                                      AND CHG-SEQ.)             *
  4642*                                                RKP=49,LEN=11   *
  4643*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4644*                                      AND CHG-SEQ.)             *
  4645*                                                RKP=60,LEN=15   *
  4646*                                                                *
  4647*   LOG = NO                                                     *
  4648*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4649******************************************************************
  4650******************************************************************
  4651*                   C H A N G E   L O G
  4652*
  4653* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4654*-----------------------------------------------------------------
  4655*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4656* EFFECTIVE    NUMBER
  4657*-----------------------------------------------------------------
  4658* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4659* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4660* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4661* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4662* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4663* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4664* 032306                   PEMA  ADD BOW LOAN NUMBER
  4665* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4666* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4667* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4668* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4669* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4670* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4671* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  93
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4672* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4673******************************************************************
  4674
  4675 01  PENDING-BUSINESS.
  4676     12  PB-RECORD-ID                     PIC XX.
  4677         88  VALID-PB-ID                        VALUE 'PB'.
  4678
  4679     12  PB-CONTROL-PRIMARY.
  4680         16  PB-COMPANY-CD                PIC X.
  4681         16  PB-ENTRY-BATCH               PIC X(6).
  4682         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4683         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4684
  4685     12  PB-CONTROL-BY-ACCOUNT.
  4686         16  PB-COMPANY-CD-A1             PIC X.
  4687         16  PB-CARRIER                   PIC X.
  4688         16  PB-GROUPING.
  4689             20  PB-GROUPING-PREFIX       PIC XXX.
  4690             20  PB-GROUPING-PRIME        PIC XXX.
  4691         16  PB-STATE                     PIC XX.
  4692         16  PB-ACCOUNT.
  4693             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4694             20  PB-ACCOUNT-PRIME         PIC X(6).
  4695         16  PB-CERT-EFF-DT               PIC XX.
  4696         16  PB-CERT-NO.
  4697             20  PB-CERT-PRIME            PIC X(10).
  4698             20  PB-CERT-SFX              PIC X.
  4699         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4700
  4701         16  PB-RECORD-TYPE               PIC X.
  4702             88  PB-MAILING-DATA                VALUE '0'.
  4703             88  PB-ISSUE                       VALUE '1'.
  4704             88  PB-CANCELLATION                VALUE '2'.
  4705             88  PB-BATCH-TRAILER               VALUE '9'.
  4706
  4707     12  PB-CONTROL-BY-ORIG-BATCH.
  4708         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4709         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4710         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4711         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4712
  4713     12  PB-CONTROL-BY-CSR.
  4714         16  PB-CSR-COMPANY-CD            PIC X.
  4715         16  PB-CSR-ID                    PIC X(4).
  4716         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4717         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4718         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4719******************************************************************
  4720*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4721******************************************************************
  4722
  4723     12  PB-LAST-MAINT-DT                 PIC XX.
  4724     12  PB-LAST-MAINT-BY                 PIC X(4).
  4725     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4726
  4727     12  PB-RECORD-BODY                   PIC X(375).
  4728
  4729     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  94
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4730         16  PB-CERT-ORIGIN               PIC X.
  4731             88  CLASIC-CREATED-CERT         VALUE '1'.
  4732         16  PB-I-NAME.
  4733             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4734             20  PB-I-INSURED-FIRST-NAME.
  4735                 24  PB-I-INSURED-1ST-INIT PIC X.
  4736                 24  FILLER                PIC X(9).
  4737             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4738         16  PB-I-AGE                     PIC S99   COMP-3.
  4739         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4740         16  PB-I-BIRTHDAY                PIC XX.
  4741         16  PB-I-INSURED-SEX             PIC X.
  4742             88  PB-SEX-MALE     VALUE 'M'.
  4743             88  PB-SEX-FEMALE   VALUE 'F'.
  4744
  4745         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4746         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4747         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4748         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4749         16  PB-I-SKIP-CODE               PIC X.
  4750             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4751             88  PB-SKIP-JULY              VALUE '1'.
  4752             88  PB-SKIP-AUGUST            VALUE '2'.
  4753             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4754             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4755             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4756             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4757             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4758             88  PB-SKIP-JUNE              VALUE '8'.
  4759             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4760             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4761             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4762         16  PB-I-TERM-TYPE               PIC X.
  4763             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4764             88  PB-PAID-WEEKLY            VALUE 'W'.
  4765             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4766             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4767             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4768         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4769         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4770         16  PB-I-DATA-ENTRY-SW           PIC X.
  4771             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4772             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4773             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4774             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4775         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4776         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4777*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4778         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4779         16  FILLER                       PIC X.
  4780
  4781         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4782             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4783             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4784                                                   '90' THRU '99'.
  4785         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4786                                          PIC XX.
  4787         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  95
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4788         16  PB-I-AMOUNT-FINANCED REDEFINES
  4789                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4790         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4791         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4792                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4793         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4794         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4795         16  PB-I-CLP-AMOUNT REDEFINES
  4796                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4797         16  PB-I-LF-CALC-FLAG            PIC X.
  4798             88 PB-COMP-LF-PREM               VALUE '?'.
  4799         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4800         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4801         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4802         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4803         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4804         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4805         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4806         16  PB-I-LF-ABBR                 PIC XXX.
  4807         16  PB-I-LF-INPUT-CD             PIC XX.
  4808
  4809         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4810             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4811             88  PB-INVALID-AH               VALUE '  ' '00'
  4812                                                   '90' THRU '99'.
  4813         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4814         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4815         16  PB-I-AH-CALC-FLAG            PIC X.
  4816             88 PB-COMP-AH-PREM                  VALUE '?'.
  4817         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4818         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4819         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4820         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4821         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4822         16  PB-I-AH-ABBR                 PIC XXX.
  4823         16  PB-I-AH-INPUT-CD             PIC XXX.
  4824
  4825         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4826         16  PB-I-REIN-TABLE              PIC XXX.
  4827         16  PB-I-BUSINESS-TYPE           PIC 99.
  4828         16  PB-I-INDV-GRP-CD             PIC X.
  4829         16  PB-I-MORT-CODE.
  4830             20  PB-I-TABLE               PIC X.
  4831             20  PB-I-INTEREST            PIC XX.
  4832             20  PB-I-MORT-TYP            PIC X.
  4833         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4834         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4835         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4836         16  PB-I-INDV-GRP-OVRD           PIC X.
  4837         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4838         16  PB-I-SIG-SW                  PIC X.
  4839             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4840         16  PB-I-RATE-CLASS              PIC XX.
  4841         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4842         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4843         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4844         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4845         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  96
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4846         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4847         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4848         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4849         16  PB-I-OB-FLAG                 PIC X.
  4850             88  PB-I-OB                      VALUE 'B'.
  4851             88  PB-I-SUMMARY                 VALUE 'Z'.
  4852         16  PB-I-ENTRY-STATUS            PIC X.
  4853             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4854                                              'M' '5' '9' '2'.
  4855             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4856             88  PB-I-POLICY-PENDING          VALUE '2'.
  4857             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4858             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4859             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4860             88  PB-I-REIN-ONLY               VALUE '9'.
  4861             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4862             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4863             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4864             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4865         16  PB-I-INT-CODE                PIC X.
  4866             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4867             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4868         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4869         16  PB-I-SOC-SEC-NO              PIC X(11).
  4870         16  PB-I-MEMBER-NO               PIC X(12).
  4871         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4872*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4873         16  PB-I-OLD-LOF                 PIC XXX.
  4874         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4875         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4876         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4877         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4878         16  PB-I-LIFE-INDICATOR          PIC X.
  4879             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4880         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4881         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4882                                          PIC S9(5)V99    COMP-3.
  4883         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4884             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4885             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4886         16  PB-I-1ST-PMT-DT              PIC XX.
  4887         16  PB-I-JOINT-INSURED.
  4888             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4889             20 PB-I-JOINT-FIRST-NAME.
  4890                24  PB-I-JOINT-FIRST-INIT PIC X.
  4891                24  FILLER                PIC X(9).
  4892             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4893*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4894         16  PB-I-BENEFICIARY-NAME.
  4895             20  PB-I-BANK-NUMBER         PIC X(10).
  4896             20  FILLER                   PIC X(15).
  4897         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4898         16  PB-I-REFERENCE               PIC X(12).
  4899         16  FILLER REDEFINES PB-I-REFERENCE.
  4900             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4901             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4902             20  PB-I-CLP-STATE           PIC XX.
  4903         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  97
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4904             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4905             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4906             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4907         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4908         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4909         16  PB-I-RESIDENT-STATE          PIC XX.
  4910         16  PB-I-RATE-CODE               PIC X(4).
  4911         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4912         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4913         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4914         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4915         16  PB-I-BANK-NOCHRGB            PIC 99.
  4916         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4917         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4918
  4919     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4920         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4921             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4922         16  PB-C-CANCEL-ORIGIN           PIC X.
  4923             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4924         16  PB-C-LF-CANCEL-DT            PIC XX.
  4925         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4926         16  PB-C-LF-CALC-REQ             PIC X.
  4927             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4928         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4929         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4930         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4931             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4932         16  PB-C-AH-CANCEL-DT            PIC XX.
  4933         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4934         16  PB-C-AH-CALC-REQ             PIC X.
  4935             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4936         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4937         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4938         16  PB-C-LAST-NAME               PIC X(15).
  4939         16  PB-C-REFUND-SW               PIC X.
  4940             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4941             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4942         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4943         16  PB-C-PAYEE-CODE              PIC X(6).
  4944         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4945         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4946         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4947         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4948         16  PB-C-REFERENCE               PIC X(12).
  4949         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4950         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4951         16  PB-C-POST-CARD-IND           PIC X.
  4952         16  PB-C-CANCEL-REASON           PIC X.
  4953         16  PB-C-REF-INTERFACE-SW        PIC X.
  4954         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4955         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4956         16  FILLER                       PIC X(01).
  4957*        16  FILLER                       PIC X(18).
  4958         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4959*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4960         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4961         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  98
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4962             20  PB-CI-INSURED-NAME.
  4963                 24  PB-CI-LAST-NAME      PIC X(15).
  4964                 24  PB-CI-INITIALS       PIC XX.
  4965             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4966             20  PB-CI-INSURED-SEX        PIC X.
  4967             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4968             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4969             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4970             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4971             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4972             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4973             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4974             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4975             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4976             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4977             20  PB-CI-RATE-CLASS         PIC XX.
  4978             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4979             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4980             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4981             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4982             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4983             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4984             20  PB-CI-LF-ABBR            PIC X(3).
  4985             20  PB-CI-AH-ABBR            PIC X(3).
  4986             20  PB-CI-OB-FLAG            PIC X.
  4987                 88  PB-CI-OB                VALUE 'B'.
  4988             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4989                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4990                                           'M' '4' '5' '9' '2'.
  4991                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4992                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4993                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4994                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4995                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4996                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4997                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4998                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4999                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5000                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5001                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5002                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5003             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5004                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5005                                           'M' '4' '5' '9' '2'.
  5006                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5007                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5008                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5009                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5010                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5011                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5012                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5013                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5014                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5015                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5016                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5017                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5018             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5019             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page  99
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5020             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5021             20  PB-CI-MEMBER-NO          PIC X(12).
  5022             20  PB-CI-INT-CODE           PIC X.
  5023                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5024                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5025             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5026             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5027             20  PB-CI-COMP-EXCP-SW       PIC X.
  5028                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5029                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5030             20  PB-CI-ENTRY-STATUS       PIC X.
  5031             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5032             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5033             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5034             20  PB-CI-DEATH-DT           PIC XX.
  5035             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5036             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5037             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5038             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5039             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5040             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5041             20  PB-CI-ENTRY-DT              PIC XX.
  5042             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5043             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5044             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5045             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5046             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5047             20  PB-CI-OLD-LOF               PIC XXX.
  5048*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5049             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5050             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5051             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5052             20  PB-CI-INDV-GRP-CD           PIC X.
  5053             20  PB-CI-BENEFICIARY-NAME.
  5054                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5055                 24  FILLER                  PIC X(15).
  5056             20  PB-CI-NOTE-SW               PIC X.
  5057             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5058             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5059             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5060             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5061             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5062             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5063             20  PB-CI-FIRST-NAME            PIC X(10).
  5064             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5065
  5066         16  FILLER                       PIC X(13).
  5067*032306  16  FILLER                       PIC X(27).
  5068*        16  FILLER                       PIC X(46).
  5069
  5070     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5071         16  FILLER                       PIC X(10).
  5072         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5073         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5074         16  PB-M-INSURED-MID-INIT        PIC X.
  5075         16  PB-M-INSURED-AGE             PIC 99.
  5076         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5077         16  PB-M-INSURED-SEX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 100
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5078         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5079         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5080         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5081         16  PB-M-INSURED-CITY-STATE.
  5082             20  PB-M-INSURED-CITY        PIC X(28).
  5083             20  PB-M-INSURED-STATE       PIC XX.
  5084         16  PB-M-INSURED-ZIP-CODE.
  5085             20  PB-M-INSURED-ZIP-PRIME.
  5086                 24  PB-M-INSURED-ZIP-1   PIC X.
  5087                     88  PB-M-CANADIAN-POST-CODE
  5088                                             VALUE 'A' THRU 'Z'.
  5089                 24  FILLER               PIC X(4).
  5090             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5091         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5092                                        PB-M-INSURED-ZIP-CODE.
  5093             20  PM-M-INS-CAN-POST1       PIC XXX.
  5094             20  PM-M-INS-CAN-POST2       PIC XXX.
  5095             20  FILLER                   PIC XXX.
  5096         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5097         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5098         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5099         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5100         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5101         16  PB-M-CRED-BENE-CITYST.
  5102             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5103             20  PB-M-CRED-BENE-STATE     PIC XX.
  5104
  5105         16  FILLER                       PIC X(92).
  5106
  5107     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5108         16  FILLER                       PIC X(10).
  5109         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5110         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5111         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5112         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5113         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5114         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5115         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5116         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5117         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5118         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5119         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5120         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5121         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5122         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5123         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5124         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5125         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5126         16  PB-ACCOUNT-NAME              PIC X(30).
  5127         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5128         16  PB-REFERENCE                 PIC X(12).
  5129         16  PB-B-RECEIVED-DT             PIC XX.
  5130         16  FILLER                       PIC X(234).
  5131
  5132     12  PB-RECORD-STATUS.
  5133         16  PB-CREDIT-SELECT-DT          PIC XX.
  5134         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5135         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 101
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5136         16  PB-BILLING-STATUS            PIC X.
  5137             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5138             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5139             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5140         16  PB-RECORD-BILL               PIC X.
  5141             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5142             88  PB-RECORD-RETURNED           VALUE 'R'.
  5143             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5144             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5145             88  PB-OVERRIDE-AH               VALUE 'A'.
  5146             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5147         16  PB-BATCH-ENTRY               PIC X.
  5148             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5149             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5150             88  PB-REISSUED-CERT             VALUE 'E'.
  5151             88  PB-MONTHLY-CERT              VALUE 'M'.
  5152             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5153             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5154             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5155         16  PB-FORCE-CODE                PIC X.
  5156             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5157             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5158             88  PB-CANCEL-FORCE              VALUE '8'.
  5159             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5160             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5161             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5162             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5163             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5164             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5165             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5166         16  PB-FATAL-FLAG                PIC X.
  5167             88  PB-FATAL-ERRORS              VALUE 'X'.
  5168         16  PB-FORCE-ER-CD               PIC X.
  5169             88  PB-FORCE-ERRORS              VALUE 'F'.
  5170             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5171         16  PB-WARN-ER-CD                PIC X.
  5172             88  PB-WARNING-ERRORS            VALUE 'W'.
  5173         16  FILLER                       PIC X.
  5174         16  PB-OUT-BAL-CD                PIC X.
  5175             88  PB-OUT-OF-BAL                VALUE 'O'.
  5176         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5177         16  PB-AH-OVERRIDE-L1            PIC X.
  5178         16  PB-INPUT-DT                  PIC XX.
  5179         16  PB-INPUT-BY                  PIC X(4).
  5180         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5181         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5182         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5183         16  PB-LF-EARNING-METHOD         PIC X.
  5184         16  PB-AH-EARNING-METHOD         PIC X.
  5185         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5186         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5187         16  PB-REIN-CD                   PIC XXX.
  5188         16  PB-LF-REFUND-TYPE            PIC X.
  5189         16  PB-AH-REFUND-TYPE            PIC X.
  5190         16  PB-ACCT-EFF-DT               PIC XX.
  5191         16  PB-ACCT-EXP-DT               PIC XX.
  5192         16  PB-COMPANY-ID                PIC X(3).
  5193         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 102
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5194         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5195         16  PB-SV-CARRIER                PIC X.
  5196         16  PB-SV-GROUPING               PIC X(6).
  5197         16  PB-SV-STATE                  PIC XX.
  5198         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5199         16  PB-GA-BILLING-INFO.
  5200             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5201                                          PIC XX.
  5202         16  PB-SV-REMIT-TO  REDEFINES
  5203             PB-GA-BILLING-INFO           PIC X(10).
  5204         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5205         16  PB-I-LOAN-OFFICER            PIC X(5).
  5206         16  PB-I-VIN                     PIC X(17).
  5207
  5208         16  FILLER                       PIC X(04).
  5209         16  IMNET-BYPASS-SW              PIC X.
  5210
  5211******************************************************************
  5212*                COMMON EDIT ERRORS                              *
  5213******************************************************************
  5214
  5215     12  PB-COMMON-ERRORS.
  5216         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5217                                           PIC S9(4)     COMP.
  5218
  5219******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 103
* ECS010.cbl
  5221 01  PC-STARTS-HERE              PIC X(48)
  5222       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  5223
* 5224                             COPY ERCPNDC.
  5225******************************************************************04/29/98
  5226*                                                                *ERCPNDC
  5227*                                                                *ERCPNDC
  5228*                            ERCPNDC                             *   LV003
  5229*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5230*                            VMOD=2.004                          *   CL**2
  5231*                                                                *ERCPNDC
  5232*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  5233*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  5234*                                                                *ERCPNDC
  5235*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  5236*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  5237*                                                                *ERCPNDC
  5238*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  5239*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  5240*                                                                *ERCPNDC
  5241*   LOG = YES                                                    *ERCPNDC
  5242*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  5243******************************************************************ERCPNDC
  5244                                                                  ERCPNDC
  5245 01  PENDING-CLAIMS.                                              ERCPNDC
  5246     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  5247         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  5248                                                                  ERCPNDC
  5249     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  5250         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  5251         16  PC-CARRIER                   PIC X.                  ERCPNDC
  5252         16  PC-GROUPING.                                         ERCPNDC
  5253             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  5254             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  5255         16  PC-STATE                     PIC XX.                 ERCPNDC
  5256         16  PC-ACCOUNT.                                          ERCPNDC
  5257             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  5258             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  5259         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  5260         16  PC-CERT-NO.                                          ERCPNDC
  5261             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  5262             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  5263         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  5264         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  5265                                                                  ERCPNDC
  5266         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  5267             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  5268             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  5269         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  5270                                                                  ERCPNDC
  5271     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  5272     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  5273     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  5274                                                                  ERCPNDC
  5275     12  PC-CLAIM-RECORD.                                         ERCPNDC
  5276         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  5277             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  5278             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 104
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5279             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  5280             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  5281         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  5282         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  5283         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  5284         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  5285         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  5286         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  5287         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  5288         16  FILLER                       PIC XX.                 ERCPNDC
  5289         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  5290             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  5291             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  5292             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  5293             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  5294             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  5295             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  5296             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  5297                                                                  ERCPNDC
  5298         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5299         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  5300         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  5301         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5302                                                                  ERCPNDC
  5303         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  5304         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  5305         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  5306                                                                  ERCPNDC
  5307         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  5308             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  5309                                                                  ERCPNDC
  5310         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  5311         16  FILLER                       PIC X(48).              ERCPNDC
  5312                                                                  ERCPNDC
  5313         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  5314             20  PC-CC-INSURED-NAME.                              ERCPNDC
  5315                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  5316                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  5317             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  5318             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  5319             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  5320             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  5321             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  5322             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  5323             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  5324             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  5325             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5326             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5327             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  5328             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  5329             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  5330                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  5331             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  5332                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5333                                               '4' '5' '9' '2'.   ERCPNDC
  5334                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5335                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5336                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 105
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5337                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5338                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5339                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5340                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5341                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5342                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  5343             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  5344                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5345                                               '4' '5' '9' '2'.   ERCPNDC
  5346                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5347                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5348                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  5349                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5350                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5351                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5352                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5353                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5354                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  5355             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  5356             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  5357             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  5358             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  5359             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  5360                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  5361                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  5362             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  5363             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  5364             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  5365             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  5366             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  5367             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  5368             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  5369             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  5370         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  5371         16  PC-CC-CLP-STATE              PIC XX.
  5372         16  FILLER                       PIC X(14).              ERCPNDC
  5373         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  5374         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  5375         16  FILLER                       PIC X(34).              ERCPNDC
  5376                                                                  ERCPNDC
  5377     12  PC-RECORD-STATUS.                                        ERCPNDC
  5378         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  5379         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  5380         16  FILLER                       PIC XX.                 ERCPNDC
  5381         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  5382             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  5383         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  5384             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  5385             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  5386                                                     '8'.         ERCPNDC
  5387         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  5388             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  5389             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  5390         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  5391             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  5392         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  5393         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  5394         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 106
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5395         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  5396             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  5397         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  5398         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  5399                                                                  ERCPNDC
  5400     12  PC-ERROR-FLAGS.                                          ERCPNDC
  5401         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  5402             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  5403         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  5404             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  5405                                                                  ERCPNDC
  5406     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  5407         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  5408                                                                  ERCPNDC
  5409     12  FILLER                           PIC X(25).              ERCPNDC
  5410                                                                  ERCPNDC
  5411******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 107
* ECS010.cbl
  5413 01  CC-STARTS-HERE              PIC X(48)
  5414       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  5415
* 5416                             COPY ERCCRTC.
  5417******************************************************************04/29/98
  5418*                                                                *ERCCRTC
  5419*                                                                *ERCCRTC
  5420*                            ERCCRTC                             *   LV003
  5421*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5422*                            VMOD=2.005                          *   CL**3
  5423*                                                                *ERCCRTC
  5424*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  5425*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  5426*                       ISSUES AND CANCELS)                      *ERCCRTC
  5427*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  5428*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  5429*                                                                *ERCCRTC
  5430*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  5431*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  5432*                                                                *ERCCRTC
  5433*   LOG = YES                                                    *ERCCRTC
  5434*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  5435******************************************************************ERCCRTC
  5436*                   C H A N G E   L O G
  5437*
  5438* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5439*-----------------------------------------------------------------
  5440*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5441* EFFECTIVE    NUMBER
  5442*-----------------------------------------------------------------
  5443* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5444******************************************************************
  5445 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5446     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5447         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5448                                                                  ERCCRTC
  5449     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5450         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5451         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5452         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5453         16  CC-STATE                     PIC XX.                 ERCCRTC
  5454         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5455         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5456         16  CC-CERT-NO.                                          ERCCRTC
  5457             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5458             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5459                                                                  ERCCRTC
  5460         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5461                                                                  ERCCRTC
  5462     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5463     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5464     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5465                                                                  ERCCRTC
  5466     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5467                                                                  ERCCRTC
  5468     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5469         16  FILLER                       PIC X(10).              ERCCRTC
  5470         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 108
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5471             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5472             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5473                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5474                 24  FILLER               PIC X(9).               ERCCRTC
  5475             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5476         16  CC-AGE                       PIC S99.                ERCCRTC
  5477         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5478         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5479         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5480             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5481             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5482         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5483             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5484             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5485                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5486                 24  FILLER               PIC X(9).               ERCCRTC
  5487             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5488         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5489         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5490         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5491         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5492         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5493         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5494         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5495         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5496         16  CC-OLD-LOF                   PIC XXX.
  5497*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5498         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5499         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5500         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5501         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5502         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5503         16  FILLER                       PIC X(3).               ERCCRTC
  5504         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5505         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5506         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5507         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5508         16  CC-LOAN-OFFICER              PIC X(5).
  5509         16  FILLER                       PIC XXX.                ERCCRTC
  5510     12  CC-RECORD-STATUS.                                        ERCCRTC
  5511         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5512         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5513     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5514         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5515         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5516         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5517         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5518     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5519     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5520         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5521             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5522         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5523             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5524     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5525         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5526         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5527         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5528         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 109
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5529                                                                  ERCCRTC
  5530     12  FILLER                           PIC X(05).              ERCCRTC
  5531******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 110
* ECS010.cbl
  5533 01  CR-STARTS-HERE              PIC X(48)
  5534       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5535
* 5536                             COPY ECSCRT01.
  5537******************************************************************
  5538*                                                                *
  5539*                            ECSCRT01                            *
  5540*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5541*                            VMOD=2.016                          *
  5542*                                                                *
  5543*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5544*                                                                *
  5545*   FILE TYPE = SEQUENTIAL
  5546*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5547*                                                                *
  5548*   KEY DATA =                         START=4, LEN=36           *
  5549*                                                                *
  5550*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5551*                                                                *
  5552******************************************************************
  5553******************************************************************
  5554*                   C H A N G E   L O G
  5555*
  5556* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5557*-----------------------------------------------------------------
  5558*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5559* EFFECTIVE    NUMBER
  5560*-----------------------------------------------------------------
  5561* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5562* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5563* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5564* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5565* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5566* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5567* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5568* 032612  CR2011110200001  PEMA  AHL CHANGES
  5569******************************************************************
  5570
  5571 01  CERTIFICATE-RECORD.
  5572     12  CR-RECORD-ID                      PIC XX.
  5573         88  VALID-CR-ID                      VALUE 'CR'.
  5574
  5575     12  CR-COMPANY-CD                     PIC X.
  5576
  5577     12  CR-FULL-CONTROL.
  5578         16  CR-CONTROL-1.
  5579             20  CR-ACCT-CONTROL.
  5580                 24  CR-CARRIER            PIC X.
  5581                 24  CR-GROUPING.
  5582                     28  CR-GROUP-PREFIX   PIC XXX.
  5583                     28  CR-GROUP-PRIME    PIC XXX.
  5584                 24  CR-STATE              PIC XX.
  5585                 24  CR-ACCOUNT.
  5586                     28  CR-ACCT-PREFIX    PIC X(4).
  5587                     28  CR-ACCT-PRIME     PIC X(6).
  5588             20  CR-DT                     PIC 9(11)  COMP-3.
  5589         16  CR-CERT-NO.
  5590             20  CR-CERT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 111
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5591                 24  CR-CERT-PREFIX        PIC X(3).
  5592                 24  CR-CERT-PRIME         PIC X(7).
  5593             20  CR-CERT-SFX               PIC X.
  5594
  5595     12  CR-INSUREDS-PROFILE.
  5596         16  CR-NAME.
  5597             20  CR-LNAME                  PIC X(15).
  5598             20  CR-FNAME.
  5599                 24  CR-1ST-INITIAL        PIC X.
  5600                 24  FILLER                PIC X(9).
  5601             20  CR-INIT                   PIC X.
  5602         16  CR-AGE                        PIC 99.
  5603         16  CR-SEX                        PIC X.
  5604             88  CR-SEX-MALE                  VALUE 'M'.
  5605             88  CR-SEX-FEMALE                VALUE 'F'.
  5606         16  CR-SOC-SEC                    PIC X(11).
  5607         16  CR-JOINT-NAME.
  5608             20  CR-JT-LNAME               PIC X(15).
  5609             20  CR-JT-FNAME.
  5610                 24  CR-JT-1ST-INIT        PIC X.
  5611                 24  FILLER                PIC X(9).
  5612             20  CR-JT-INIT                PIC X.
  5613         16  CR-JOINT-AGE                  PIC 99.
  5614
  5615         16  cr-ahl-ah-claim-no            pic x(9).
  5616         16  cr-ahl-ah-cert-seq            pic x(3).
  5617         16  cr-hst-proc-lf                pic x.
  5618         16  f                             pic x(7).
  5619
  5620     12  CR-LF-COVERAGE-DATA.
  5621         16  CR-LFTYP                      PIC XX.
  5622         16  CR-LF-TERM                    PIC S999       COMP-3.
  5623         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5624         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5625         16  CR-LF-DEV-CODE                PIC XXX.
  5626         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5627
  5628         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5629         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5630         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5631         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5632
  5633         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5634         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5635         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5636         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5637
  5638         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5639         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5640
  5641         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5642         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5643
  5644         16  CR-LF-REFUND-TYPE             PIC X.
  5645         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5646
  5647         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5648             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 112
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5649
  5650         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5651
  5652         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5653         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5654         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5655
  5656         16  cr-ahl-lf-claim-no            pic x(9).
  5657         16  cr-ahl-lf-cert-seq            pic x(3).
  5658         16  FILLER                        PIC XX.
  5659
  5660     12  CR-AH-COVERAGE-DATA.
  5661         16  CR-AHTYP                      PIC XX.
  5662         16  CR-AH-TERM                    PIC S999       COMP-3.
  5663         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5664         16  CR-AH-DEV-CODE                PIC XXX.
  5665         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5666
  5667         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5668         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5669         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5670         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5671
  5672         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5673         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5674
  5675         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5676         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5677
  5678         16  CR-AH-REFUND-TYPE             PIC X.
  5679         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5680
  5681         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5682             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5683
  5684         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5685
  5686         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5687         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5688         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5689
  5690         16  FILLER                        PIC XX.
  5691*        16  FILLER                        PIC X(8).
  5692
  5693     12  CR-LOAN-DATA.
  5694         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5695         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5696                                           PIC S9(5)V99   COMP-3.
  5697         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5698         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5699         16  CR-PMT-FREQ                   PIC 99.
  5700         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5701         16  CR-RATING-CLASS               PIC XX.
  5702         16  CR-POLICY-FORM-NO             PIC X(12).
  5703         16  CR-GRPTYP                     PIC XX.
  5704         16  CR-IND-GRP                    PIC X.
  5705             88  CR-INDIVIDUAL                VALUE '1'.
  5706             88  CR-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 113
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5707         16  CR-SKIP                       PIC 99.
  5708             88  NO-MONTHS-SKIPPED            VALUE 00.
  5709             88  SKIP-JULY                    VALUE 01.
  5710             88  SKIP-AUGUST                  VALUE 02.
  5711             88  SKIP-SEPTEMBER               VALUE 03.
  5712             88  SKIP-JULY-AUG                VALUE 04.
  5713             88  SKIP-AUG-SEPT                VALUE 05.
  5714             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5715             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5716             88  SKIP-JUNE                    VALUE 08.
  5717             88  SKIP-JUNE-JULY               VALUE 09.
  5718             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5719             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5720         16  CR-RESIDENT-STATE             PIC XX.
  5721         16  CR-RATE-CODE.
  5722             20  CR-LF-CLASS-CD            PIC XX.
  5723             20  CR-AH-CLASS-CD            PIC XX.
  5724         16  CR-MORT.
  5725             20  CR-TAB                    PIC X.
  5726             20  CR-INT                    PIC 99.
  5727             20  CR-GRP                    PIC X.
  5728         16  CR-MEMBER-NO                  PIC X(12).
  5729         16  CR-OLD-LOF                    PIC XXX.
  5730*        16  CR-LOAN-OFFICER               PIC XXX.
  5731         16  CR-REIN-TABLE                 PIC XXX.
  5732         16  CR-REIN-SPEC                  PIC X.
  5733         16  CR-LOAN-1ST-PMT-DT.
  5734             20  CR-1ST-PMT-YR             PIC 99.
  5735             20  CR-1ST-PMT-MO             PIC 99.
  5736             20  CR-1ST-PMT-DA             PIC 99.
  5737         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5738         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5739         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5740         16  CR-LAST-ADD-ON-DT             PIC XX.
  5741
  5742         16  CR-UNDERWRITING-CODE          PIC X.
  5743             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5744
  5745         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5746         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5747         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5748         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5749
  5750     12  CR-STATUS-INFORMATION.
  5751         16  CR-ENTRY-STATUS               PIC X.
  5752             88  CR-NORMAL-ENTRY              VALUE '1'.
  5753             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5754             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5755             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5756             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5757             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5758             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5759             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5760             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5761             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  5762                                                    '5' '9' 'P'.
  5763         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5764
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 114
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5765         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5766         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5767         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5768
  5769         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5770         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5771
  5772         16  CR-LF-CURRENT-STATUS          PIC X.
  5773             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5774             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5775             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5776             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5777             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5778             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5779             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5780             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5781             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5782             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5783             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5784             88  CR-LF-IS-VOID                VALUE 'V'.
  5785             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5786                                                    '4' '5' '9'.
  5787
  5788         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5789
  5790         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5791         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5792
  5793         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5794         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5795
  5796         16  CR-AH-CURRENT-STATUS          PIC X.
  5797             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5798             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5799             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5800             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5801             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5802             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5803             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5804             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5805             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5806             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5807             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5808             88  CR-AH-IS-VOID                VALUE 'V'.
  5809             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5810                                                    '4' '5' '9'.
  5811         16  CR-LOAN-OFFICER               PIC X(5).
  5812         16  CR-CANCEL-REASON              PIC X.
  5813         16  cr-xycor-lf-cov-code          pic x(4).
  5814         16  cr-xycor-ah-cov-code          pic x(4).
  5815         16  FILLER                        PIC X(6).
  5816
  5817     12  CR-DEATH-CLAIM-DATA.
  5818         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  5819
  5820         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5821         16  CR-DTH-RPT-DT.
  5822             20  CR-DTH-RPT-YR             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 115
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5823             20  CR-DTH-RPT-MO             PIC 99.
  5824             20  CR-DTH-RPT-DA             PIC 99.
  5825         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5826
  5827         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5828         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5829         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5830         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5831         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5832
  5833         16  CR-DTH-AGE                    PIC 99.
  5834         16  CR-DTH-PAY-CD                 PIC X.
  5835         16  CR-DEATH-CAUSE                PIC X(6).
  5836
  5837         16  FILLER                        PIC X(16).
  5838
  5839     12  CR-DISAB-CLAIM-DATA.
  5840         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5841
  5842         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5843         16  CR-DIS-RPT-DT.
  5844             20  CR-DIS-RPT-YR             PIC 99.
  5845             20  CR-DIS-RPT-MO             PIC 99.
  5846             20  CR-DIS-RPT-DA             PIC 99.
  5847         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5848         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5849
  5850         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5851         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5852         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5853         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5854         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5855
  5856         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5857         16  CR-DIS-PAY-CD                 PIC X.
  5858         16  FILLER                        PIC XX.
  5859
  5860         16  CR-DISAB-INCURRED-DETAIL.
  5861             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5862**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5863                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5864                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5865                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5866
  5867         16  CR-DISAB-CAUSE                PIC X(6).
  5868         16  FILLER                        PIC X(14).
  5869
  5870     12  CR-REMIT-TO                       PIC 99.
  5871
  5872     12  CR-COMPENSATION-LEVELS.
  5873         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5874             20  CR-COM-AGT.
  5875                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5876                 24  CR-COM-AGT-PRIME      PIC X(6).
  5877             20  CR-AGT-TYPE               PIC X.
  5878             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5879             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5880
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 116
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5881     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5882     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5883     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5884     12  CR-CLP-STATE                      PIC XX.
  5885     12  CR-POST-CARD-IND                  PIC X.
  5886     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5887     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5888     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5889     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5890     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5891     12  FILLER                            PIC X(07).
  5892
  5893     12  CR-CSR-CODE                       PIC XXX.
  5894
  5895     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5896     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5897
  5898     12  CR-MICROFILM-NUMBERS.
  5899*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5900         16  FILLER                        PIC X(5).
  5901     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5902
  5903     12  CR-USER-CODE                      PIC X.
  5904     12  CR-USER-FUTURE                    PIC X(9).
  5905
  5906     12  CR-BENEFICIARY.
  5907         16  CR-BANK-NO                    PIC X(10).
  5908         16  FILLER                        PIC X(15).
  5909
  5910     12  CR-ENTRY-BATCH                    PIC X(6).
  5911     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5912     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5913
  5914     12  CR-NOTE-SW                        PIC X.
  5915
  5916     12  CR-ORIGIN-INDICATOR               PIC X.
  5917         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5918         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5919
  5920     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5921     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5922     12  FILLER                            PIC X(33).
  5923
  5924******************************************************************
* 5925                             COPY ELCCRTVR.
  5926***************************************************************** 04/24/98
  5927*                                                                *ELCCRTVR
  5928*                                                                *ELCCRTVR
  5929*                            ELCCRTVR                            *   LV003
  5930*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5931*                            VMOD=2.001                          *ELCCRTVR
  5932*                                                                *ELCCRTVR
  5933*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5934*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  5935*                                                                *ELCCRTVR
  5936******************************************************************ELCCRTVR
  5937                                                                  ELCCRTVR
  5938 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 117
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5939     05  WS-CR-DT.                                                ELCCRTVR
  5940         10  FILLER                PIC 999.                       ELCCRTVR
  5941         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5942         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5943             15  CR-CC             PIC 99.                        ELCCRTVR
  5944             15  CR-YR             PIC 99.                        ELCCRTVR
  5945         10  CR-MO                 PIC 99.                        ELCCRTVR
  5946         10  CR-DA                 PIC 99.                        ELCCRTVR
  5947     05  WS-CR-DT-N REDEFINES                                        CL**2
  5948            WS-CR-DT               PIC 9(11).                        CL**2
  5949     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5950         10  FILLER                    PIC 999.                   ELCCRTVR
  5951         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5952         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5953             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5954             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5955         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5956         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5957     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5958            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5959     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5960         10  FILLER                    PIC 999.                   ELCCRTVR
  5961         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5962         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5963             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5964             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5965         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5966         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5967     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5968            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5969     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5970         10  FILLER                    PIC 999.                   ELCCRTVR
  5971         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5972         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5973             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5974             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5975         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5976         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5977     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5978            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5979     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5980         10  FILLER                    PIC 999.                   ELCCRTVR
  5981         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5982         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5983             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5984             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5985         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5986         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5987     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5988            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5989     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5990         10  FILLER                    PIC 999.                   ELCCRTVR
  5991         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5992         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  5993             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5994             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5995         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5996         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 118
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5997     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5998            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5999     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  6000         10  FILLER                    PIC 999.                   ELCCRTVR
  6001         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  6002         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  6003             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  6004             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  6005         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  6006         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  6007     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  6008            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  6009     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  6010         10  FILLER                    PIC 999.                   ELCCRTVR
  6011         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  6012         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  6013             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  6014             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  6015         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  6016         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  6017     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  6018            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  6019     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  6020         10  FILLER                    PIC 999.                   ELCCRTVR
  6021         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  6022         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  6023             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  6024             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  6025         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  6026         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  6027     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  6028            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  6029     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  6030         10  FILLER                    PIC 999.                   ELCCRTVR
  6031         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  6032         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  6033             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  6034             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  6035         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  6036         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  6037     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  6038          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  6039     05  WS-CR-DTH-DT.                                            ELCCRTVR
  6040         10  FILLER                    PIC 999.                   ELCCRTVR
  6041         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  6042         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  6043             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  6044             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  6045         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  6046         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  6047     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  6048            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  6049     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  6050         10  FILLER                    PIC 999.                   ELCCRTVR
  6051         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6052         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  6053             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  6054             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 119
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  6055         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  6056         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  6057     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  6058            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  6059     05  WS-CR-DIS-DT.                                            ELCCRTVR
  6060         10  FILLER                    PIC 999.                   ELCCRTVR
  6061         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  6062         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  6063             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  6064             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  6065         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  6066         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  6067     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  6068            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  6069     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  6070         10  FILLER                    PIC 999.                   ELCCRTVR
  6071         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6072         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  6073             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  6074             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  6075         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  6076         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  6077     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  6078            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  6079     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  6080         10  FILLER                    PIC 999.                   ELCCRTVR
  6081         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  6082         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  6083             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  6084             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  6085         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  6086         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  6087     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  6088            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  6089     05  COPY-NDX                      PIC 9.                        CL**6
  6090     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  6091         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  6092             15  FILLER                PIC 999.                   ELCCRTVR
  6093             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  6094             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  6095                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  6096                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  6097             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  6098             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  6099         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  6100                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  6101
  6102 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 120
* ECS010.cbl
* 6104                             COPY ELCDATE.
  6105******************************************************************06/11/98
  6106*                                                                *ELCDATE
  6107*                                                                *ELCDATE
  6108*                            ELCDATE.                            *   LV023
  6109*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  6110*                            VMOD=2.003                           ELCDATE
  6111*                                                                *ELCDATE
  6112*                                                                *ELCDATE
  6113*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  6114*                 LENGTH = 200                                   *   CL*19
  6115******************************************************************ELCDATE
  6116                                                                  ELCDATE
  6117 01  DATE-CONVERSION-DATA.                                        ELCDATE
  6118     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  6119     12  DC-OPTION-CODE                PIC X.                        CL*15
  6120         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  6121         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  6122         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  6123         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  6124         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  6125         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  6126         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  6127         88  FIND-CENTURY               VALUE '7'.                   CL*22
  6128         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  6129         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  6130         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  6131         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  6132         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  6133         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  6134         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  6135         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  6136         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  6137         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  6138         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  6139         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  6140         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  6141         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  6142         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  6143         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  6144         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  6145         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  6146         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  6147         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  6148         88  THREE-CHARACTER-BIN                                  ELCDATE
  6149                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  6150         88  GREGORIAN-TO-BIN                                        CL**2
  6151                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  6152         88  BIN-TO-GREGORIAN                                        CL**2
  6153                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  6154         88  JULIAN-TO-BINARY                                        CL**2
  6155                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  6156     12  DC-ERROR-CODE                 PIC X.                        CL*15
  6157         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  6158         88  DATE-CONVERSION-ERROR                                ELCDATE
  6159                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  6160         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  6161         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 121
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6162         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  6163         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  6164         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  6165         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  6166         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  6167         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  6168         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  6169         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  6170     12  DC-END-OF-MONTH               PIC X.                        CL*15
  6171         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  6172     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  6173         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  6174         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  6175         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  6176     12  FILLER                        PIC X.                        CL*15
  6177     12  DC-CONVERSION-DATES.                                        CL*15
  6178         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  6179         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  6180         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  6181         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  6182                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  6183             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  6184             20  SLASH1-1              PIC X.                        CL*15
  6185             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  6186             20  SLASH1-2              PIC X.                        CL*15
  6187             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  6188         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  6189         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  6190                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  6191             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  6192             20  SLASH2-1              PIC X.                        CL*15
  6193             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  6194             20  SLASH2-2              PIC X.                        CL*15
  6195             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  6196         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  6197         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  6198                     DC-GREG-DATE-1-YMD.                          ELCDATE
  6199             20  DC-YMD-YEAR           PIC 99.                       CL*15
  6200             20  DC-YMD-MONTH          PIC 99.                       CL*15
  6201             20  DC-YMD-DAY            PIC 99.                       CL*15
  6202         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  6203         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  6204                      DC-GREG-DATE-1-MDY.                         ELCDATE
  6205             20  DC-MDY-MONTH          PIC 99.                       CL*15
  6206             20  DC-MDY-DAY            PIC 99.                       CL*15
  6207             20  DC-MDY-YEAR           PIC 99.                       CL*15
  6208         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  6209             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  6210             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  6211             20  FILLER                PIC XX.                       CL*15
  6212             20  DC-ALPHA-CENTURY.                                   CL*15
  6213                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  6214             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  6215         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  6216         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  6217         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  6218         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  6219         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 122
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6220                                       PIC 9(05).                    CL*20
  6221         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  6222             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  6223             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  6224         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  6225         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  6226         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  6227     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  6228         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  6229         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  6230             20  FILLER                PIC 9(3).                     CL*15
  6231             20  HOLD-CEN-1-CCYY.                                    CL*15
  6232                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  6233                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  6234             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  6235             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  6236         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  6237             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  6238             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  6239             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  6240                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  6241                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  6242             20  FILLER                PIC 9(3).                     CL*15
  6243         16  HOLD-CENTURY-1-X.                                       CL*15
  6244             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  6245             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  6246                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  6247                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  6248             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  6249             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  6250         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  6251             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  6252             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  6253             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  6254                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  6255                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  6256             20  FILLER                PIC XXX.                      CL*23
  6257         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  6258         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  6259         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  6260         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  6261             20  DC-JULIAN-1-CCYY.                                   CL*15
  6262                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  6263                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  6264             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  6265         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  6266         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  6267             20  DC-JULIAN-2-CCYY.                                   CL*15
  6268                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  6269                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  6270             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  6271         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  6272             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  6273             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  6274             20  DC-EDITA-DAY          PIC 99.                       CL*15
  6275             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  6276             20  DC-EDITA-CCYY.                                      CL*15
  6277                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 123
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6278                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  6279         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  6280             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  6281             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  6282             20  DC-EDITB-DAY          PIC 99.                       CL*15
  6283             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  6284             20  DC-EDITB-CCYY.                                      CL*15
  6285                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  6286                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  6287         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  6288         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  6289                              DC-GREG-DATE-CYMD.                  ELCDATE
  6290             20  DC-CYMD-CEN           PIC 99.                       CL*15
  6291             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  6292             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  6293             20  DC-CYMD-DAY           PIC 99.                       CL*15
  6294         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  6295         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  6296                              DC-GREG-DATE-MDCY.                  ELCDATE
  6297             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  6298             20  DC-MDCY-DAY           PIC 99.                       CL*15
  6299             20  DC-MDCY-CEN           PIC 99.                       CL*15
  6300             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  6301    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  6302        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  6303    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  6304    12  FILLER                         PIC X(28).                    CL*26
* 6305                             COPY ELCFUNDT.
  6306***************************************************************** 12/03/98
  6307*                                                               * ELCFUNDT
  6308*                            ELCFUNDT.                          *    LV004
  6309*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  6310*                            VMOD=2.001                         * ELCFUNDT
  6311*                                                               * ELCFUNDT
  6312*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  6313*                                                               * ELCFUNDT
  6314***************************************************************** ELCFUNDT
  6315                                                                  ELCFUNDT
  6316                                                                  ELCFUNDT
  6317 01  FUNCTION-DATE.                                                  CL**2
  6318     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  6319     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  6320         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  6321         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  6322             15  WS-FN-CC          PIC 99.                           CL**3
  6323             15  WS-FN-YR          PIC 99.                           CL**3
  6324         10  WS-FN-MO              PIC 99.                           CL**3
  6325         10  WS-FN-DA              PIC 99.                           CL**3
  6326     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  6327     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  6328     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  6329     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  6330     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  6331         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  6332         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  6333         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  6334     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  6335     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 124
* ECS010.cbl
  6336
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 125
* ECS010.cbl
  6338 01  CPA-STARTS-HERE             PIC X(48)
  6339       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 6340                             COPY ELCCALC.
  6341******************************************************************04/15/98
  6342*                                                                *ELCCALC
  6343*                           ELCCALC.                            *    LV003
  6344*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6345*                            VMOD=2.025                          *   CL**3
  6346*                                                                *   CL**2
  6347*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  6348*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  6349*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  6350*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  6351*                                                                *   CL**2
  6352*  PASSED TO ELRTRM                                              *   CL**2
  6353*  -----------------                                             *   CL**2
  6354*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  6355*  ORIGINAL TERM                                                 *   CL**2
  6356*  BEGINNING DATE                                                *   CL**2
  6357*  ENDING DATE                                                   *   CL**2
  6358*  COMPANY I.D.                                                  *   CL**2
  6359*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  6360*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  6361*  FREE LOOK DAYS                                                *   CL**2
  6362*                                                                *   CL**2
  6363*  RETURNED FROM ELRTRM                                          *   CL**2
  6364*  ---------------------                                         *   CL**2
  6365*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  6366*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  6367*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  6368*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  6369*----------------------------------------------------------------*   CL**2
  6370*  PASSED TO ELRAMT                                              *   CL**2
  6371*  ----------------                                              *   CL**2
  6372*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  6373*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6374*  ORIGINAL AMOUNT                                               *   CL**2
  6375*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  6376*  A.P.R. - NET PAY ONLY                                         *   CL**2
  6377*  METHOD                                                            CL**2
  6378*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  6379*  COMPANY I.D.                                                  *   CL**2
  6380*  BENEFIT TYPE                                                  *   CL**2
  6381*                                                                *   CL**2
  6382*  RETURNED FROM ELRAMT                                          *   CL**2
  6383*  --------------------                                          *   CL**2
  6384*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  6385*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  6386*  REMAINING AMOUNT FACTOR                                           CL**2
  6387*----------------------------------------------------------------*   CL**2
  6388*  PASSED TO ELRESV                                              *   CL**2
  6389*  -----------------                                             *   CL**2
  6390*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  6391*  VALUATION DATE                                                *   CL**2
  6392*  PAID THRU DATE                                                *   CL**2
  6393*  BENEFIT                                                       *   CL**2
  6394*  INCURRED DATE                                                 *   CL**2
  6395*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 126
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6396*  ISSUE AGE                                                     *   CL**2
  6397*  TERM                                                          *   CL**2
  6398*  CDT PERCENT                                                   *   CL**2
  6399*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  6400* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  6401* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  6402* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  6403*                                                                *   CL**2
  6404*  RETURNED FROM ELRESV                                          *   CL**2
  6405*  --------------------                                          *   CL**2
  6406*  CDT TABLE USED                                                *   CL**2
  6407*  CDT FACTOR USED                                               *   CL**2
  6408*  PAY TO CURRENT RESERVE                                        *   CL**2
  6409*  I.B.N.R. - A/H ONLY                                           *   CL**2
  6410*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  6411*----------------------------------------------------------------*   CL**2
  6412*  PASSED TO ELRATE                                              *   CL**2
  6413*  ----------------                                              *   CL**2
  6414*  CERT ISSUE DATE                                               *   CL**2
  6415*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6416*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6417*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  6418*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6419*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6420*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6421*  DEVIATION CODE                                                *   CL**2
  6422*  ISSUE AGE                                                     *   CL**2
  6423*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6424*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6425*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  6426*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6427*  A.P.R.                                                        *   CL**2
  6428*  METHOD                                                            CL**2
  6429*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6430*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6431*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6432*  BENEFIT CODE                                                  *   CL**2
  6433*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6434*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  6435*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  6436*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  6437*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6438*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6439*                                                                *   CL**2
  6440*  RETURNED FROM ELRATE                                          *   CL**2
  6441*  --------------------                                          *   CL**2
  6442*  CALCULATED PREMIUM                                            *   CL**2
  6443*  PREMIUM RATE                                                  *   CL**2
  6444*  MORTALITY CODE                                                *   CL**2
  6445*  MAX ATTAINED AGE                                              *   CL**2
  6446*  MAX AGE                                                       *   CL**2
  6447*  MAX TERM                                                      *   CL**2
  6448*  MAX MONTHLY BENEFIT                                           *   CL**2
  6449*  MAX TOTAL BENIFIT                                             *   CL**2
  6450*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6451*----------------------------------------------------------------*   CL**2
  6452*  PASSED TO ELRFND                                              *   CL**2
  6453*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 127
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6454*  CERT ISSUE DATE                                               *   CL**2
  6455*  REFUND DATE                                                   *   CL**2
  6456*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6457*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6458*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6459*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6460*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6461*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6462*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6463*  DEVIATION CODE                                                *   CL**2
  6464*  ISSUE AGE                                                     *   CL**2
  6465*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6466*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6467*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6468*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6469*  A.P.R.                                                        *   CL**2
  6470*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6471*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6472*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6473*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6474*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6475*  BENEFIT CODE                                                  *   CL**2
  6476*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6477*                                                                *   CL**2
  6478*  RETURNED FROM ELRFND                                          *   CL**2
  6479*  --------------------                                          *   CL**2
  6480*  CALCULATED REFUND                                             *   CL**2
  6481*----------------------------------------------------------------*   CL**2
  6482*  PASSED TO ELEARN                                              *   CL**2
  6483*  ----------------                                              *   CL**2
  6484*  CERT ISSUE DATE                                               *   CL**2
  6485*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6486*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6487*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6488*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6489*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6490*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6491*  DEVIATION CODE                                                *   CL**2
  6492*  ISSUE AGE                                                     *   CL**2
  6493*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6494*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6495*  A.P.R.                                                        *   CL**2
  6496*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6497*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6498*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6499*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6500*  BENEFIT CODE                                                  *   CL**2
  6501*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6502*                                                                *   CL**2
  6503*  RETURNED FROM ELEARN                                          *   CL**2
  6504*  --------------------                                          *   CL**2
  6505*  INDICATED  EARNINGS                                           *   CL**2
  6506*----------------------------------------------------------------*   CL**2
  6507*                 LENGTH = 450                                   *   CL**2
  6508*                                                                *   CL**2
  6509******************************************************************   CL**2
  6510******************************************************************
  6511*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 128
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6512*
  6513* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6514*-----------------------------------------------------------------
  6515*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6516* EFFECTIVE    NUMBER
  6517*-----------------------------------------------------------------
  6518* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6519* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6520* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6521* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6522* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6523* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6524* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6525* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6526* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6527******************************************************************
  6528                                                                     CL**2
  6529 01  CALCULATION-PASS-AREA.                                          CL**2
  6530     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6531                                     COMP.                           CL**2
  6532                                                                     CL**2
  6533     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6534       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6535       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6536                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6537       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6538       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6539       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6540       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6541       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6542       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6543       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6544       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6545       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6546       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6547       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6548       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6549       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6550       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6551       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6552       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6553       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6554                                                                     CL**2
  6555     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6556       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6557***********************  INPUT AREAS ****************************    CL**2
  6558                                                                     CL**2
  6559     12  CP-CALCULATION-AREA.                                        CL**2
  6560         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6561         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6562         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6563         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6564         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6565           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6566                                                   'I' 'U'.          CL**2
  6567           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6568           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  6569         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 129
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6570         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6571         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6572         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6573         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6574                                     COMP-3.                         CL**2
  6575         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6576                                     COMP-3.                         CL**2
  6577         16  CP-CDT-METHOD         PIC X.                            CL**2
  6578           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6579           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6580           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6581         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6582           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6583           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6584         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6585                                     COMP-3.                         CL**2
  6586         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6587                                     COMP-3.                         CL**2
  6588         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6589                                     COMP-3.                         CL**2
  6590         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6591                                     COMP-3.                         CL**2
  6592         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6593                                     COMP-3.                         CL**2
  6594         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6595                                     COMP-3.                         CL**2
  6596         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6597                                     COMP-3.                         CL**2
  6598         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6599           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6600           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6601           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6602           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6603           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6604           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6605           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6606         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6607           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6608           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6609           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6610           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6611           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6612           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6613           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6614           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6615           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6616           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6617           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6618           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6619           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6620           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6621         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6622           88  CP-CLAIM                            VALUE '1'.        CL**2
  6623           88  CP-CANCEL                           VALUE '2'.        CL**2
  6624           88  CP-ISSUE                            VALUE '3'.        CL**2
  6625         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6626           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  6627           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 130
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6628           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6629           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6630           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6631           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6632           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6633           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6634           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6635           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6636           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6637           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6638           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6639           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6640           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6641           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6642           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6643           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6644                                                     'W' 'X'.        CL**2
  6645           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6646           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6647           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6648           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6649           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6650           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6651           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6652           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6653           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6654           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6655           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6656           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6657           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6658                                                                     CL**2
  6659         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6660                                     COMP-3.                         CL**2
  6661         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6662         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6663         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6664         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6665         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6666           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6667               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6668         16  CP-R78-OPTION         PIC X.                            CL**2
  6669           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6670           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6671                                                                     CL**2
  6672         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6673         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6674         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6675         16  CP-RATE-FILE          PIC X.                            CL**2
  6676         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6677                                     COMP-3.                         CL**2
  6678                                                                     CL**2
  6679         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6680         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6681                                                                     CL**2
  6682         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6683                                     COMP-3.
  6684         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  6685                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 131
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6686         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6687                                     COMP-3.                         CL**2
  6688         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6689                                     COMP-3.                         CL**2
  6690         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6691                                     COMP-3.
  6692         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6693                                  PIC S9(7)V99 COMP-3.
  6694                                                                     CL**2
  6695         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6696         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6697         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6698           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6699           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6700           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6701           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6702         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6703         16  CP-CARRIER            PIC X.                            CL**2
  6704         16  CP-REIN-FLAG          PIC X.                            CL**2
  6705         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6706           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6707                      '2' '3' '4' '5'.                               CL**2
  6708           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6709           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6710           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6711           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6712           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6713           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6714           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6715           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6716         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6717         16  CP-RATING-METHOD      PIC X.                            CL**2
  6718           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6719           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6720           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6721           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6722           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6723           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6724           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6725           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6726           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6727         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6728                                     COMP-3.                         CL**2
  6729         16  CP-BEN-CATEGORY       PIC X.
  6730         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6731         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6732                                   PIC S99V9(5) COMP-3.
  6733         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6734         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6735                                   PIC S99V9(5) COMP-3.
  6736         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6737         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6738         16  CP-EXPIRE-DT          PIC XX.
  6739         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6740         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6741         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6742         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  6743         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 132
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6744             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6745             88  CP-CALC-CLP              VALUE 'C'.
  6746         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6747         16  CP-CANCEL-REASON      PIC X.
  6748         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6749         16  CP-PMT-MODE           PIC X.
  6750         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6751         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6752         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6753         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6754         16  FILLER                PIC X.
  6755                                                                     CL**2
  6756***************    OUTPUT FROM ELRESV   ************************     CL**2
  6757                                                                     CL**2
  6758         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6759                                                                     CL**2
  6760         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6761                                     COMP-3.                         CL**2
  6762         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6763                                     COMP-3.                         CL**2
  6764         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6765                                     COMP-3.                         CL**2
  6766         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6767                                     COMP-3.                         CL**2
  6768         16  FILLER                PIC X(09).                        CL**2
  6769***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6770                                                                     CL**2
  6771         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6772                                     COMP-3.                         CL**2
  6773         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6774                                     COMP-3.                         CL**2
  6775         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6776                                     COMP-3.                         CL**2
  6777         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6778                                     COMP-3.                         CL**2
  6779         16  FILLER                PIC X(12).                        CL**2
  6780                                                                     CL**2
  6781***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6782                                                                     CL**2
  6783         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6784                                     COMP-3.                         CL**2
  6785         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6786                                     COMP-3.                         CL**2
  6787         16  FILLER                PIC X(12).                        CL**2
  6788                                                                     CL**2
  6789***************    OUTPUT FROM ELRATE   *************************    CL**2
  6790                                                                     CL**2
  6791         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6792                                     COMP-3.                         CL**2
  6793         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6794                                     COMP-3.                         CL**2
  6795         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6796         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6797             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6798         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6799                                     COMP-3.                         CL**2
  6800         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  6801         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 133
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6802         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6803                                   PIC S9(7)V99 COMP-3.
  6804         16  FILLER                PIC X(07).                        CL**2
  6805                                                                     CL**2
  6806***************    OUTPUT FROM ELRFND   *************************    CL**2
  6807                                                                     CL**2
  6808         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6809                                     COMP-3.                         CL**2
  6810         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6811           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6812           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6813           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6814           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6815           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6816           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6817           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6818           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6819           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6820           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6821           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6822           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6823           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6824           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6825         16  FILLER                PIC X(12).                        CL**2
  6826                                                                     CL**2
  6827***************    OUTPUT FROM ELEARN   *************************    CL**2
  6828                                                                     CL**2
  6829         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6830                                     COMP-3.                         CL**2
  6831         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6832                                     COMP-3.                         CL**2
  6833         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6834                                     COMP-3.                         CL**2
  6835         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6836                                     COMP-3.                         CL**2
  6837         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6838                                     COMP-3.                         CL**2
  6839         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6840                                     COMP-3.                         CL**2
  6841         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6842           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6843           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6844           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6845           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6846           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6847           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6848           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6849           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6850           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6851         16  FILLER                PIC X(12).                        CL**2
  6852                                                                     CL**2
  6853***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6854                                                                     CL**2
  6855         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6856                                     COMP-3.                         CL**2
  6857         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6858                                     COMP-3.                         CL**2
  6859         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 134
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6860                                                                     CL**2
  6861***************   MISC WORK AREAS    *****************************   CL**2
  6862         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6863                                     COMP-3.                         CL**2
  6864         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6865                                     COMP-3.                         CL**2
  6866         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6867                                     COMP-3.                         CL**2
  6868         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6869                                     COMP-3.                         CL**2
  6870         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6871                                     COMP-3.                         CL**2
  6872         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6873                                     COMP-3.                         CL**2
  6874         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6875             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6876             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6877             88  IO-ERROR                         VALUE 'E'.         CL**2
  6878                                                                     CL**2
  6879         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6880                                                                     CL**2
  6881         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6882                                                                     CL**2
  6883         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6884                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6885                                     COMP-3.                         CL**2
  6886                                                                     CL**2
  6887         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6888                                                                     CL**2
  6889         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6890                                     COMP-3.                         CL**2
  6891                                                                     CL**2
  6892         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6893                                     COMP-3.                         CL**2
  6894                                                                     CL**2
  6895         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6896                                     COMP-3.                         CL**2
  6897                                                                     CL**2
  6898         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6899                                     COMP-3.                         CL**2
  6900                                                                     CL**2
  6901         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6902                                     COMP-3.                         CL**2
  6903                                                                     CL**2
  6904         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6905                                     COMP-3.                         CL**2
  6906                                                                     CL**2
  6907         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6908                                     COMP-3.                         CL**2
  6909                                                                     CL**2
  6910         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6911             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6912                                                                     CL**2
  6913         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6914                                     COMP-3.                         CL**2
  6915         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6916                                     COMP-3.
  6917         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 135
* ECS010.cbl
  6918         16  FILLER                PIC X(15).                        CL**2
  6919******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 136
* ECS010.cbl
* 6921                             COPY ELCDTECX.
  6922******************************************************************06/05/98
  6923*                                                                *ELCDTECX
  6924*                            ELCDTECX.                           *   LV005
  6925*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6926*                            VMOD=2.015                          *ELCDTECX
  6927*                                                                *ELCDTECX
  6928*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6929*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6930*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6931*                                                                *ELCDTECX
  6932******************************************************************ELCDTECX
  6933******************************************************************
  6934*                   C H A N G E   L O G
  6935*
  6936* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6937*-----------------------------------------------------------------
  6938*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6939* EFFECTIVE    NUMBER
  6940*-----------------------------------------------------------------
  6941* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6942*                                  BENEFIT CODES FROM 300 TO 900
  6943* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6944* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6945******************************************************************
  6946 01  DATE-CARD.                                                   ELCDTECX
  6947     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6948     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6949     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6950     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6951     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6952     12  EP-SW                       PIC  X.                      ELCDTECX
  6953         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6954     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6955         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6956     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6957     12  RUN-CENTURY.                                             ELCDTECX
  6958         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6959     12  FILLER                      PIC  X.                         CL**4
  6960     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6961     12  FILLER                      PIC  XXX.                    ELCDTECX
  6962     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6963                                                                  ELCDTECX
  6964 01  FILLER                          PIC  X(7)                       CL**6
  6965                                          VALUE 'OPTIONS'.        ELCDTECX
  6966 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6967     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6968     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6969     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6970         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6971         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6972     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6973     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6974     12  FILLER                      PIC  X.                      ELCDTECX
  6975     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6976     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6977     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  6978     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 137
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6979     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6980     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6981     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6982     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6983     12  FILLER                      PIC  X.                      ELCDTECX
  6984     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6985     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6986     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6987     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6988     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6989     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6990     12  FILLER                      PIC  X.                      ELCDTECX
  6991     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6992     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6993     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6994     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6995     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6996     12  DTE-R78                     PIC  X.                      ELCDTECX
  6997     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6998     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6999     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  7000     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  7001     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  7002     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  7003     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  7004                                     PIC  X.                      ELCDTECX
  7005         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  7006                                                 ' '.             ELCDTECX
  7007         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  7008         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  7009     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  7010         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  7011         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  7012     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  7013     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  7014                                     PIC  9.                         CL**4
  7015     12  DTE-SYSTEM.                                              ELCDTECX
  7016         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  7017         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  7018         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  7019         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  7020         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  7021         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  7022         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  7023         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  7024         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  7025         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  7026         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  7027         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  7028         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  7029         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  7030         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  7031         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  7032         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  7033         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  7034         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  7035         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  7036         16  DTE-SYS-U               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 138
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7037         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  7038         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  7039         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  7040         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  7041         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  7042     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  7043         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  7044                                     PIC  X.                      ELCDTECX
  7045     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  7046                                                                  ELCDTECX
  7047 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  7048     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  7049     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  7050     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  7051*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  7052     12  FILLER                      PIC  X.                      ELCDTECX
  7053     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  7054     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  7055     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  7056     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  7057     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  7058     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  7059     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  7060                                                                  ELCDTECX
  7061     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  7062     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  7063     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  7064     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  7065                                                                  ELCDTECX
  7066     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  7067     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  7068     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  7069     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  7070                                                                  ELCDTECX
  7071     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  7072     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  7073                                                                  ELCDTECX
  7074     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  7075     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  7076                                                                  ELCDTECX
  7077     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  7078                                                                  ELCDTECX
  7079 01  DATE-CARD-FACTORS.                                           ELCDTECX
  7080     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  7081     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  7082     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  7083     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  7084     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  7085     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  7086     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  7087                                                                  ELCDTECX
  7088 01  FILLER                          PIC  X(12)                   ELCDTECX
  7089                                          VALUE 'COMPANY NAME'.   ELCDTECX
  7090 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  7091     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  7092         16  CNT-ID                  PIC  X.                      ELCDTECX
  7093         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  7094                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 139
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7095 01  FILLER                          PIC  X(11)                   ELCDTECX
  7096                                          VALUE 'STATE NAMES'.    ELCDTECX
  7097 01  STATE-NAMES.                                                 ELCDTECX
  7098     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  7099         16  STATE-SUB               PIC  XX.                     ELCDTECX
  7100         16  STATE-PIC1.                                          ELCDTECX
  7101             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  7102             20  FILLER              PIC  XXX.                    ELCDTECX
  7103             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  7104             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  7105             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  7106             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  7107                                                                  ELCDTECX
  7108 01  FILLER                          PIC  X(13)                   ELCDTECX
  7109                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  7110 01  CARRIER-NAMES.                                               ELCDTECX
  7111     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  7112         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  7113         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  7114         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  7115         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7116         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7117         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7118*        16  FILLER                  PIC  X.                      ELCDTECX
  7119         16  CARRIER-SEC-PAY         PIC  X.
  7120             88  SEC-PAY-CARRIER          VALUE 'Y'.
  7121                                                                  ELCDTECX
  7122 01  FILLER                          PIC  X(9)                       CL**6
  7123                                          VALUE 'INS TYPES'.      ELCDTECX
  7124 01  CLAS-INS-TYPES.                                              ELCDTECX
  7125*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  7126     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  7127         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  7128         16  CLAS-I-AB3.                                          ELCDTECX
  7129             20  FILLER              PIC  X.                      ELCDTECX
  7130             20  CLAS-I-AB2.                                      ELCDTECX
  7131                 24  FILLER          PIC  X.                      ELCDTECX
  7132                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  7133         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  7134             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  7135             20  FILLER              PIC  X.                         CL**4
  7136         16  CLAS-I-AB10.                                         ELCDTECX
  7137             20  FILLER              PIC  X(9).                   ELCDTECX
  7138             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  7139         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  7140         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  7141         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  7142         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  7143             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  7144         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  7145         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  7146         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  7147         16  CLAS-I-BEN-CATEGORY     PIC  X.
  7148         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  7149         16  FILLER                  PIC  X(05).
  7150                                                                  ELCDTECX
  7151 01  FILLER                          PIC  X(16)                   ELCDTECX
  7152                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 140
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7153 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  7154     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  7155                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  7156         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  7157         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  7158         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  7159         16  CLAS-MORT-DESC.                                      ELCDTECX
  7160             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  7161             20  FILLER              PIC  XX.                        CL**5
  7162             20  CLAS-YEAR           PIC  X(4).                      CL**6
  7163             20  FILLER              PIC  X.                         CL**5
  7164             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  7165             20  FILLER              PIC  X.                         CL**5
  7166             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  7167             20  FILLER              PIC  X.                         CL**5
  7168             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  7169             20  FILLER              PIC  X(5).                      CL**6
  7170                                                                  ELCDTECX
  7171 01  FILLER                          PIC  X(15)                   ELCDTECX
  7172                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  7173 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  7174     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  7175         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  7176         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  7177         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  7178         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  7179         16  FILLER                  PIC  X(4).                      CL**6
  7180                                                                  ELCDTECX
  7181 01  FILLER                          PIC  X(7)                       CL**6
  7182                                     VALUE 'INDEXES'.             ELCDTECX
  7183 01  CLAS-INDEX-TBL.                                              ELCDTECX
  7184     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  7185     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  7186     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  7187     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  7188     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  7189     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  7190     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  7191     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  7192     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  7193     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  7194     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  7195     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  7196     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  7197     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  7198     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  7199     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  7200     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  7201                                                                  ELCDTECX
  7202 01  CLAS-TYPE-MISC.                                              ELCDTECX
  7203     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  7204     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  7205     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  7206     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  7207     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  7208     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  7209     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  7210     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 141
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7211     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  7212     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  7213     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  7214                                                                  ELCDTECX
  7215 01  FILLER                          PIC  X(13)                   ELCDTECX
  7216                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  7217 01  CLAS-MISC.                                                   ELCDTECX
  7218     12  DTE-FICH                    PIC  X.                      ELCDTECX
  7219         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  7220         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  7221         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  7222     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  7223     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  7224     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  7225     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  7226     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  7227     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  7228     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  7229     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  7230     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  7231     12  STATE-L                     PIC  XX.                     ELCDTECX
  7232     12  CLAS-CN                     PIC  99.                     ELCDTECX
  7233     12  CLAS-CO                     PIC  99.                     ELCDTECX
  7234     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  7235         16  DTE-F-1                 PIC  X.                      ELCDTECX
  7236         16  DTE-F-2                 PIC  X.                      ELCDTECX
  7237     12  DTE-ABEND-WORK.                                          ELCDTECX
  7238         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  7239         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  7240                                                                  ELCDTECX
  7241 01  FILLER                          PIC  X(12)                   ELCDTECX
  7242                                     VALUE 'WORKING DATE'.        ELCDTECX
  7243 01  WS-DATE-AND-TIME.                                            ELCDTECX
  7244     12  WS-ACCEPT-DATE.                                          ELCDTECX
  7245         16  WS-AD-YY                PIC  99.                     ELCDTECX
  7246         16  WS-AD-MM                PIC  99.                     ELCDTECX
  7247         16  WS-AD-DD                PIC  99.                     ELCDTECX
  7248     12  WS-CURRENT-DATE.                                         ELCDTECX
  7249         16  WS-CD-MM                PIC  99.                     ELCDTECX
  7250         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7251         16  WS-CD-DD                PIC  99.                     ELCDTECX
  7252         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7253         16  WS-CD-YY                PIC  99.                     ELCDTECX
  7254     12  WS-TIME-OF-DAY.                                          ELCDTECX
  7255         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  7256         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  7257                                                                  ELCDTECX
  7258 01  FILLER                          PIC  X(12)                   ELCDTECX
  7259                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  7260 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  7261     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  7262         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  7263         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  7264         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  7265                                                                  ELCDTECX
  7266 01  FILLER                          PIC  X(10)                   ELCDTECX
  7267                                     VALUE 'STATE TLRS'.          ELCDTECX
  7268 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 142
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7269     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  7270         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  7271         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  7272                                                                  ELCDTECX
  7273 01  FILLER                          PIC  X(13)                   ELCDTECX
  7274                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  7275 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  7276     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  7277         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  7278                                                                  ELCDTECX
  7279 01  FILLER                          PIC  X(13)                   ELCDTECX
  7280                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  7281 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  7282     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  7283     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  7284     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  7285                                     PIC  X.                         CL**5
  7286     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  7287     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  7288     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  7289     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  7290     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  7291     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  7292     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  7293     12  FILLER                      PIC  X(75).                  ELCDTECX
  7294******************************************************************ELCDTECX
  7295*01  MISC-CARR-PCT-DATA.                                          00001521
  7296*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7297*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7298*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7299*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7300*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7301*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7302******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 143
* ECS010.cbl
* 7304                             COPY ELCDTEVR.
  7305***************************************************************** 04/15/98
  7306*                                                                *ELCDTEVR
  7307*                                                                *ELCDTEVR
  7308*                            ELCDTEVR.                           *   LV003
  7309*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7310*                            VMOD=2.001                          *   CL**2
  7311*                                                                *ELCDTEVR
  7312*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  7313*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  7314*                                                                *ELCDTEVR
  7315******************************************************************ELCDTEVR
  7316 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  7317     05  WS-RUN-DATE.                                             ELCDTEVR
  7318         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7319         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  7320         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  7321             15  RUN-CC              PIC  99.                     ELCDTEVR
  7322             15  RUN-YR              PIC  99.                     ELCDTEVR
  7323         10  RUN-MO                  PIC  99.                     ELCDTEVR
  7324         10  RUN-DA                  PIC  99.                     ELCDTEVR
  7325     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  7326            WS-RUN-DATE              PIC 9(11).                      CL**2
  7327     05  WS-EP-DT.                                                ELCDTEVR
  7328         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7329         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  7330         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  7331             15  EP-CC               PIC  99.                     ELCDTEVR
  7332             15  EP-YR               PIC  99.                     ELCDTEVR
  7333         10  EP-MO                   PIC  99.                     ELCDTEVR
  7334         10  EP-DA                   PIC  99.                     ELCDTEVR
  7335     05  WS-EP-DT-N REDEFINES                                        CL**2
  7336            WS-EP-DT                 PIC 9(11).                      CL**2
  7337     05  WS-DTE-CONV-DT.                                             CL**4
  7338         10  FILLER                  PIC  9(03).                     CL**4
  7339         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  7340         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  7341             15  DTE-CONV-CC         PIC  99.                        CL**4
  7342             15  DTE-CONV-YR         PIC  99.                        CL**4
  7343         10  DTE-CONV-MO             PIC  99.                        CL**4
  7344         10  DTE-CONV-DA             PIC  99.                        CL**4
  7345     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  7346            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  7347 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  7348     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  7349         10  FILLER                            PIC 999.           ELCDTEVR
  7350         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  7351         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  7352             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  7353             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  7354         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  7355         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  7356     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  7357            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  7358     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  7359         10  FILLER                            PIC 999.           ELCDTEVR
  7360         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  7361         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 144
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  7362         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  7363         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  7364     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  7365            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  7366 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  7367     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  7368         10  FILLER                            PIC 999.           ELCDTEVR
  7369         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  7370         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  7371             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  7372             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  7373         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  7374         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  7375     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  7376            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  7377     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  7378         10  FILLER                            PIC 999.           ELCDTEVR
  7379         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  7380         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  7381             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  7382             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  7383         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  7384         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  7385     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  7386            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  7387     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  7388         10  FILLER                            PIC 999.           ELCDTEVR
  7389         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  7390         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  7391             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  7392             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  7393         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  7394         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  7395     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  7396            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  7397 01  WS-RATE-RECORD.                                              ELCDTEVR
  7398         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  7399             10  FILLER                        PIC 999.           ELCDTEVR
  7400             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  7401             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  7402                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  7403                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  7404             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  7405             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  7406         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  7407                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 145
* ECS010.cbl
* 7409                             COPY ELCACCTV.
  7410******************************************************************04/14/98
  7411*                                                                *ELCACCTV
  7412*                            ELCACCTV                            *   LV002
  7413*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7414*                            VMOD=2.001                          *ELCACCTV
  7415*                                                                *ELCACCTV
  7416*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  7417*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  7418*                                                                *ELCACCTV
  7419*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  7420*                                                                *ELCACCTV
  7421******************************************************************ELCACCTV
  7422                                                                  ELCACCTV
  7423 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  7424                                                                  ELCACCTV
  7425     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  7426         10  FILLER            PIC 999.                           ELCACCTV
  7427         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  7428         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  7429             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  7430             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  7431         10  AM-EXP-MO         PIC 99.                               CL**5
  7432         10  AM-EXP-DA         PIC 99.                               CL**5
  7433     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7434            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7435     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7436         10  FILLER                    PIC 999.                   ELCACCTV
  7437         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7438         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7439             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7440             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7441         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7442         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7443     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7444            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7445     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7446         10  FILLER                    PIC 999.                   ELCACCTV
  7447         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7448         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7449             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7450             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7451         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7452         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7453     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7454            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7455     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7456         10 FILLER                     PIC 999.                   ELCACCTV
  7457         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7458         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7459            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7460            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7461         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7462         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7463     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7464            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7465     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7466         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 146
* ECS010.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7467         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7468         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7469            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7470            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7471         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7472         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7473     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7474            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7475     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7476         10  FILLER                    PIC 999.                   ELCACCTV
  7477         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7478         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7479             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7480             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7481         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7482         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7483     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7484            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7485     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7486         10  FILLER                    PIC 999.                   ELCACCTV
  7487         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7488         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7489             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7490             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7491         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7492         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7493     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7494            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7495     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7496         10  FILLER                    PIC 999.                   ELCACCTV
  7497         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7498         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7499             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7500             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7501         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7502         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7503     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7504            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7505     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7506         10  FILLER                    PIC 999.                   ELCACCTV
  7507         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7508         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7509             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7510             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7511         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7512         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7513     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7514            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 147
* ECS010.cbl
* 7516                             COPY ELCEXTVR.
  7517******************************************************************04/15/98
  7518*                                                                *ELCEXTVR
  7519*                                                                *ELCEXTVR
  7520*                             ELCEXTVR                           *   LV002
  7521*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7522*                            VMOD=2.001                          *ELCEXTVR
  7523*                                                                *ELCEXTVR
  7524*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7525*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7526*                                                                *ELCEXTVR
  7527******************************************************************ELCEXTVR
  7528 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7529     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7530         10  FILLER              PIC 999.                         ELCEXTVR
  7531         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7532         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7533             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7534             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7535         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7536         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7537     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7538            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7539 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7540     05  WS-DE-EFF.                                               ELCEXTVR
  7541         10  FILLER              PIC 999.                         ELCEXTVR
  7542         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7543         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7544             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7545             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7546         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7547         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7548     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7549            WS-DE-EFF            PIC 9(11).                          CL**2
  7550     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7551         10  FILLER              PIC 999.                         ELCEXTVR
  7552         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7553         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7554             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7555             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7556         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7557         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7558     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7559            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7560     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7561         10  FILLER                 PIC 999.                      ELCEXTVR
  7562         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7563         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7564             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7565             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7566         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7567         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7568     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7569            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7570     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7571         10  FILLER                 PIC 999.                      ELCEXTVR
  7572         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7573         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 148
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7574             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7575             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7576         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7577         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7578     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7579            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7580     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7581         10  FILLER                 PIC 999.                      ELCEXTVR
  7582         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7583         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7584             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7585             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7586         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7587         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7588     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7589            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7590     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7591         10  FILLER                 PIC 999.                      ELCEXTVR
  7592         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7593         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7594             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7595             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7596         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7597         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7598     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7599            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7600     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7601         10  FILLER                 PIC 999.                      ELCEXTVR
  7602         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7603         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7604             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7605             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7606         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7607         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7608     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7609            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7610     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7611         10  FILLER                 PIC 999.                         CL**5
  7612         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7613         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7614             15  DE-CP-CC           PIC 99.                          CL**5
  7615             15  DE-CP-YR           PIC 99.                          CL**5
  7616         10  DE-CP-MO               PIC 99.                          CL**5
  7617         10  DE-CP-DA               PIC 99.                          CL**5
  7618     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7619            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7620     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7621         10  FILLER                 PIC 999.                         CL**5
  7622         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7623         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7624             15  DE-RP-CC           PIC 99.                          CL**5
  7625             15  DE-RP-YR           PIC 99.                          CL**5
  7626         10  DE-RP-MO                      PIC 99.                   CL**5
  7627         10  DE-RP-DA                      PIC 99.                   CL**5
  7628     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7629            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7630     05  WS-DE-INCUR.                                             ELCEXTVR
  7631         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 149
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7632         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7633         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7634             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7635             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7636         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7637         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7638     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7639            WS-DE-INCUR             PIC 9(11).                       CL**2
  7640     05  WS-DE-PAY.                                               ELCEXTVR
  7641         10  FILLER                 PIC 999.                      ELCEXTVR
  7642         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7643         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7644             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7645             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7646         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7647         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7648     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7649            WS-DE-PAY               PIC 9(11).                       CL**2
  7650     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7651         10  FILLER                 PIC 999.                      ELCEXTVR
  7652         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7653         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7654             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7655             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7656         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7657         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7658     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7659            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7660     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7661         10 FILLER                  PIC 999.                      ELCEXTVR
  7662         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7663         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7664            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7665            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7666         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7667         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7668     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7669            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7670     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7671         10 FILLER                  PIC 999.                      ELCEXTVR
  7672         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7673         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7674            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7675            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7676         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7677         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7678     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7679            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7680     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7681         10  FILLER                 PIC 999.                      ELCEXTVR
  7682         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7683         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7684             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7685             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7686         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7687         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7688     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7689            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 150
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7690     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7691         10  FILLER                 PIC 999.                      ELCEXTVR
  7692         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7693         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7694             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7695             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7696         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7697         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7698     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7699            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7700     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7701         10  FILLER                        PIC 999.               ELCEXTVR
  7702         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7703         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7704                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7705             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7706             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7707         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7708         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7709     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7710            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7711     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7712         10  FILLER                        PIC 999.               ELCEXTVR
  7713         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7714         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7715                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7716             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7717             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7718         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7719         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7720     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7721            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7722                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 151
* ECS010.cbl
  7724 PROCEDURE DIVISION.
  7725
  7726 0000-START.
  7727
  7728******************************************************************
  7729***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7730******************************************************************
  7731
  7732*0003-LOAD-DATE-CARD.
* 7733                             COPY ELCDTERX.
  7734******************************************************************04/15/98
  7735*                                                                *ELCDTERX
  7736*                                                                *ELCDTERX
  7737*                            ELCDTERX.                           *   LV002
  7738*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7739*                            VMOD=2.007                          *ELCDTERX
  7740*                                                                *ELCDTERX
  7741*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7742*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7743*      = ELCDTEFD)                                               *ELCDTERX
  7744*                                                                *ELCDTERX
  7745******************************************************************ELCDTERX
  7746                                                                  ELCDTERX
  7747     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7748                                                                  ELCDTERX
  7749     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7750     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7751     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7752                                                                  ELCDTERX
  7753     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7754                                                                  ELCDTERX
  7755******************************************************************ELCDTERX
  7756*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7757*          WARNING MESSAGES.                                      ELCDTERX
  7758******************************************************************ELCDTERX
  7759     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7760         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7761                                                                  ELCDTERX
  7762     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7763                                                                  ELCDTERX
  7764     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7765                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7766                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7767                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7768                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7769                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7770                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7771                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7772                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7773                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7774                                                                  ELCDTERX
  7775     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7776                                                                  ELCDTERX
  7777     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7778                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7779                                                                  ELCDTERX
  7780     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7781     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 152
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7782     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7783     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7784                                                                  ELCDTERX
  7785     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7786         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7787     ELSE                                                         ELCDTERX
  7788         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7789                                                                  ELCDTERX
  7790     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7791         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7792     ELSE                                                         ELCDTERX
  7793         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7794                                                                  ELCDTERX
  7795 0005-READ--CARD.                                                 ELCDTERX
  7796     READ DISK-DATE                                               ELCDTERX
  7797         AT END CLOSE DISK-DATE                                   ELCDTERX
  7798             GO TO 0060-READ--TEST.                               ELCDTERX
  7799                                                                  ELCDTERX
  7800     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7801                                                                  ELCDTERX
  7802     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7803         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7804         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7805         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7806         GO TO 0005-READ--CARD.                                   ELCDTERX
  7807                                                                  ELCDTERX
  7808     IF DD-ID = 'CLAD'                                            ELCDTERX
  7809         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7810         GO TO 0005-READ--CARD.                                   ELCDTERX
  7811                                                                  ELCDTERX
  7812     IF DD-ID = 'CLAX'                                            ELCDTERX
  7813         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7814         GO TO 0005-READ--CARD.                                   ELCDTERX
  7815                                                                  ELCDTERX
  7816     IF DD-ID = 'CLAF'                                            ELCDTERX
  7817         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7818         GO TO 0005-READ--CARD.                                   ELCDTERX
  7819                                                                  ELCDTERX
  7820     IF DD-ID = 'CLAC'                                            ELCDTERX
  7821         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7822                                                                  ELCDTERX
  7823     IF DD-ID = 'CARR'                                            ELCDTERX
  7824         GO TO 0015-READ--CARR.                                   ELCDTERX
  7825                                                                  ELCDTERX
  7826     IF DD-ID = 'STAT'                                            ELCDTERX
  7827         GO TO 0020-READ--STAT.                                   ELCDTERX
  7828                                                                  ELCDTERX
  7829     IF DD-ID = 'BUSC'                                            ELCDTERX
  7830         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7831                                                                  ELCDTERX
  7832     IF DD-ID = 'MORT'                                            ELCDTERX
  7833         GO TO 0030-READ--MORT.                                   ELCDTERX
  7834                                                                  ELCDTERX
  7835     IF DD-ID = 'CLAI'                                            ELCDTERX
  7836         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7837                                                                  ELCDTERX
  7838     IF DD-ID = 'COLC'                                            ELCDTERX
  7839         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 153
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7840                                                                  ELCDTERX
  7841     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7842        DD-IDA = 'CL'                                             ELCDTERX
  7843         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7844                                                                  ELCDTERX
  7845     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7846        DD-IDA = 'PO'                                             ELCDTERX
  7847         GO TO 0050-READ--POXX.                                   ELCDTERX
  7848                                                                  ELCDTERX
  7849     IF DD-ID = 'OPCA'                                            ELCDTERX
  7850         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7851                                                                  ELCDTERX
  7852     IF DD-ID = 'OPST'                                            ELCDTERX
  7853         GO TO 0072-READ--OPST.                                   ELCDTERX
  7854                                                                  ELCDTERX
  7855     IF DD-ID = 'OPBS'                                            ELCDTERX
  7856         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7857                                                                  ELCDTERX
  7858     IF DD-ID = 'OPMS'                                            ELCDTERX
  7859         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7860                                                                  ELCDTERX
  7861     GO TO 0005-READ--CARD.                                       ELCDTERX
  7862                                                                  ELCDTERX
  7863 0010-READ--CLAC.                                                 ELCDTERX
  7864     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7865     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7866     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7867     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7868     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7869     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7870     GO TO 0005-READ--CARD.                                       ELCDTERX
  7871                                                                  ELCDTERX
  7872 0015-READ--CARR.                                                 ELCDTERX
  7873     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7874     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7875        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7876        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7877        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7878        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7879        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7880        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7881        MOVE DD-CARR1-SECPAY-SW
  7882                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7883     END-IF
  7884                                                                  ELCDTERX
  7885     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7886     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7887        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7888        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7889        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7890        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7891        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7892        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7893        MOVE DD-CARR2-SECPAY-SW
  7894                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7895     END-IF
  7896                                                                  ELCDTERX
  7897                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 154
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7898     GO TO 0005-READ--CARD.                                       ELCDTERX
  7899                                                                  ELCDTERX
  7900 0020-READ--STAT.                                                 ELCDTERX
  7901     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7902     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7903        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7904         GO TO 0005-READ--CARD.                                   ELCDTERX
  7905                                                                  ELCDTERX
  7906     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7907     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7908     GO TO 0020-READ--STAT.                                       ELCDTERX
  7909                                                                  ELCDTERX
  7910 0025-READ--BUSC.                                                 ELCDTERX
  7911     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7912     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7913        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7914         GO TO 0005-READ--CARD.                                   ELCDTERX
  7915                                                                  ELCDTERX
  7916     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7917     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7918     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7919                                                                  ELCDTERX
  7920 0030-READ--MORT.                                                 ELCDTERX
  7921     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7922     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7923        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7924         GO TO 0005-READ--CARD.                                   ELCDTERX
  7925                                                                  ELCDTERX
  7926     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7927     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7928     GO TO 0030-READ--MORT.                                       ELCDTERX
  7929                                                                  ELCDTERX
  7930 0035-READ--CLXX.                                                 ELCDTERX
  7931     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7932          GO TO 0005-READ--CARD.                                  ELCDTERX
  7933                                                                  ELCDTERX
  7934     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7935         DISPLAY '***********************************************'ELCDTERX
  7936         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7937         DISPLAY '***********************************************'ELCDTERX
  7938         GO TO 0055-READ--STOP.                                   ELCDTERX
  7939                                                                  ELCDTERX
  7940     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7941        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7942         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7943                                                                  ELCDTERX
  7944     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7945        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7946         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7947                                                                  ELCDTERX
  7948*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7949     GO TO 0005-READ--CARD.                                       ELCDTERX
  7950                                                                  ELCDTERX
  7951 0040-READ--CLAI.                                                 ELCDTERX
  7952     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7953     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7954        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7955         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 155
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7956                                                                  ELCDTERX
  7957     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7958     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7959     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7960                                                                  ELCDTERX
  7961 0045-READ--DUMP.                                                 ELCDTERX
  7962     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7963     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7964                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7965     PERFORM ABEND-PGM.                                           ELCDTERX
  7966                                                                  ELCDTERX
  7967 0050-READ--POXX.                                                 ELCDTERX
  7968     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7969         GO TO 0005-READ--CARD.                                   ELCDTERX
  7970                                                                  ELCDTERX
  7971     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7972         DISPLAY '***********************************************'ELCDTERX
  7973         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7974         DISPLAY '***********************************************'ELCDTERX
  7975         GO TO 0055-READ--STOP.                                   ELCDTERX
  7976                                                                  ELCDTERX
  7977     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7978     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7979     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7980     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7981                                                                  ELCDTERX
  7982     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7983         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7984     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7985         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7986                                                                  ELCDTERX
  7987     GO TO 0005-READ--CARD.                                       ELCDTERX
  7988                                                                  ELCDTERX
  7989 0055-READ--STOP.                                                 ELCDTERX
  7990     GOBACK.                                                      ELCDTERX
  7991                                                                  ELCDTERX
  7992 0060-READ--TEST.                                                 ELCDTERX
  7993     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7994        CLAX-ID         = SPACE  OR                               ELCDTERX
  7995        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7996         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7997                                                                  ELCDTERX
  7998     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7999     GO TO 0079-READ--EXIT.                                       ELCDTERX
  8000                                                                  ELCDTERX
  8001 0065-READ--COLC.                                                 ELCDTERX
  8002     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  8003     GO TO 0005-READ--CARD.                                       ELCDTERX
  8004                                                                  ELCDTERX
  8005 0070-READ--OPCA.                                                 ELCDTERX
  8006                                                                  ELCDTERX
  8007     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8008                                                                  ELCDTERX
  8009     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  8010             OR                                                   ELCDTERX
  8011         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  8012         GO TO 0005-READ--CARD.                                   ELCDTERX
  8013                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 156
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8014     ADD 1                       TO INDEXCA.                      ELCDTERX
  8015     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  8016                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  8017     GO TO 0070-READ--OPCA.                                       ELCDTERX
  8018                                                                  ELCDTERX
  8019 0072-READ--OPST.                                                 ELCDTERX
  8020                                                                  ELCDTERX
  8021     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8022                                                                  ELCDTERX
  8023     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  8024             OR                                                   ELCDTERX
  8025         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8026         GO TO 0005-READ--CARD.                                   ELCDTERX
  8027                                                                  ELCDTERX
  8028     ADD 1                       TO INDEXST.                      ELCDTERX
  8029     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  8030                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  8031     GO TO 0072-READ--OPST.                                       ELCDTERX
  8032                                                                  ELCDTERX
  8033 0074-READ--OPBS.                                                 ELCDTERX
  8034                                                                  ELCDTERX
  8035     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8036                                                                  ELCDTERX
  8037     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  8038             OR                                                   ELCDTERX
  8039         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8040         GO TO 0005-READ--CARD.                                   ELCDTERX
  8041                                                                  ELCDTERX
  8042     ADD 1                       TO INDEXBS.                      ELCDTERX
  8043     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  8044     GO TO 0074-READ--OPBS.                                       ELCDTERX
  8045                                                                  ELCDTERX
  8046 0079-READ--EXIT.                                                 ELCDTERX
  8047*    EXIT.                                                        ELCDTERX
  8048******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 157
* ECS010.cbl
  8050******************************************************************
  8051***           O P E N   F I L E S   R O U T I N E              ***
  8052******************************************************************
  8053
  8054     DISPLAY ' '.
  8055     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  8056         'ECS010 ******'
  8057     DISPLAY ' '.
  8058
  8059     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  8060     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  8061     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  8062     .
  8063 0080-OPEN-FILES.
  8064*    IF DTE-PGM-OPT = '1'
  8065*       open output detail-extr
  8066*    end-if
  8067     OPEN INPUT  PENDING-EXTRACT
  8068                 CERT-MASTER-IN
  8069                 ERACCTT-IN
  8070                 ERAGTC
  8071
  8072          I-O    ERMEBL-INOUT
  8073                 ELCRTT
  8074
  8075          OUTPUT SUMMARY-EXTR
  8076                 ME-ECS010-BALANCE
  8077                 ME50-ECS010-BALANCE
  8078                 DISPLAY-PRT
  8079                 MISMATCH-REPORT
  8080                 PRINT-COPY.
  8081     IF DTE-CLIENT = 'DCC'
  8082        OPEN INPUT ERPDEF
  8083     END-IF
  8084
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 158
* ECS010.cbl
  8086*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  8087     IF DTE-CLIENT NOT = 'DMD'
  8088         NEXT SENTENCE
  8089     ELSE
  8090         OPEN INPUT ERRESC-IN
  8091            IF ERRESC-FILE-STATUS   = '00' OR '97'
  8092                NEXT SENTENCE
  8093            ELSE
  8094                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  8095                MOVE 'ERROR OPENING ERRESC FILE'
  8096                                        TO WS-ABEND-MESSAGE
  8097                GO TO ABEND-PGM.
  8098*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  8099
  8100     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  8101         NEXT SENTENCE
  8102       ELSE
  8103         MOVE '11'                    TO ABEND-CODE-1
  8104         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  8105         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8106         GO TO ABEND-PGM.
  8107
  8108     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  8109        CONTINUE
  8110     ELSE
  8111        DISPLAY ' OPEN ERROR ELCRTT '
  8112        MOVE '31'                TO ABEND-CODE-1
  8113        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  8114        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8115        GO TO ABEND-PGM
  8116     END-IF
  8117
  8118     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  8119        CONTINUE
  8120     ELSE
  8121        DISPLAY ' OPEN ERROR ERAGTC '
  8122        MOVE '41'                TO ABEND-CODE-1
  8123        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  8124        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8125        GO TO ABEND-PGM
  8126     END-IF
  8127
  8128     IF ERPDEF-FILE-STATUS  = '00' OR '97'
  8129        CONTINUE
  8130     ELSE
  8131        DISPLAY ' OPEN ERROR ERPDEF '
  8132        MOVE '61'                TO ABEND-CODE-1
  8133        MOVE ERPDEF-FILE-STATUS  TO ABEND-CODE-2
  8134        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8135        GO TO ABEND-PGM
  8136     END-IF
  8137
  8138     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  8139         NEXT SENTENCE
  8140       ELSE
  8141         MOVE 'N'                     TO ME-UPDATE-FLAG.
  8142
  8143           if (dte-client = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 159
* ECS010.cbl
  8144              and (dte-pgm-opt = '1')
  8145              open output new-detail-extr
  8146           end-if
  8147
  8148     IF DTE-PGM-OPT = '1'
  8149         OPEN OUTPUT  CERT-MASTER-OUT
  8150                      DETAIL-EXTR
  8151     ELSE
  8152         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  8153         MOVE '*'                     TO TRANS-EOF-FLAG.
  8154
  8155     MOVE 'R'                         TO CP-RATE-FILE.
  8156     MOVE 'O'                         TO CP-IO-FUNCTION.
  8157     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  8158     IF IO-ERROR
  8159         MOVE 'ERROR OCCURED OPENING - ELRATE'
  8160                                      TO WS-ABEND-MESSAGE
  8161         MOVE 0302                    TO WS-RETURN-CODE
  8162         GO TO ABEND-PGM.
  8163
  8164******************************************************************
  8165***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  8166******************************************************************
  8167
  8168 0090-INITIALIZATION-ROUTINE.
  8169
  8170     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  8171     MOVE WS-TIME                     TO ME-START-TIME.
  8172     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  8173                                         TR-RN-DT.
  8174     MOVE ME-START-MO                 TO ME-CNDS-MO.
  8175     MOVE ME-START-DA                 TO ME-CNDS-DA.
  8176     MOVE ME-START-YR                 TO ME-CNDS-YR.
  8177     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  8178     MOVE COMPANY-NAME                TO TRHDNM.
  8179     MOVE ALPH-DATE                   TO TR-MODAYR.
  8180     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  8181     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  8182
  8183     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  8184     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8185     COMPUTE LYD-MO = LYD-MO - 1.
  8186     IF LYD-MO = ZERO
  8187         MOVE 12                      TO LYD-MO
  8188         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8189
  8190     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  8191
  8192
  8193     IF DTE-CLIENT = 'CID'
  8194         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  8195         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  8196     ELSE
  8197       IF DTE-CLIENT = 'AHL'
  8198         MOVE 'AHLGM15'          TO  WS-ME-BAL-JOB
  8199         MOVE 'AHLGM15'          TO  WS-ME50-BAL-JOB
  8200       ELSE
  8201         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 160
* ECS010.cbl
  8202         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  8203       END-IF
  8204     END-IF.
  8205
  8206     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  8207         GO TO 0090-CONTINUE.
  8208
  8209     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8210     MOVE -12                    TO DC-ELAPSED-MONTHS.
  8211     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8212     MOVE '6'                    TO DC-OPTION-CODE.
  8213     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8214
  8215     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8216         MOVE '**** WORK DATE CALC ERROR ****'
  8217                                 TO WS-ABEND-MESSAGE
  8218         MOVE '90'               TO ABEND-CODE-1
  8219         MOVE '0'                TO AC2-ONE
  8220         MOVE DC-ERROR-CODE      TO AC2-TWO
  8221         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8222         GO TO ABEND-PGM.
  8223
  8224     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  8225
  8226     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  8227     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  8228
  8229     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  8230             VARYING
  8231         SUBM FROM +2 BY +1
  8232             UNTIL
  8233         SUBM GREATER THAN +12.
  8234
  8235     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  8236
  8237     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  8238             VARYING
  8239         SUBM FROM +1 BY +1
  8240             UNTIL
  8241         SUBM GREATER THAN +13.
  8242
  8243     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8244*    MOVE -90                    TO DC-ELAPSED-DAYS.
  8245     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  8246                                    DC-ELAPSED-MONTHS.
  8247     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  8248     MOVE 1                      TO DC-END-OF-MONTH.
  8249     MOVE '6'                    TO DC-OPTION-CODE.
  8250     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8251
  8252     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8253         MOVE '**** CUT OFF DATE ERROR ****'
  8254                                 TO WS-ABEND-MESSAGE
  8255         MOVE '90'               TO ABEND-CODE-1
  8256         MOVE '0'                TO AC2-ONE
  8257         MOVE DC-ERROR-CODE      TO AC2-TWO
  8258         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8259         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 161
* ECS010.cbl
  8260
  8261     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  8262     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  8263
  8264 0090-CONTINUE.
  8265
  8266     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8267     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8268     MOVE +0                     TO DC-ELAPSED-DAYS.
  8269     MOVE '6'                    TO DC-OPTION-CODE.
  8270     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8271
  8272     IF NO-CONVERSION-ERROR
  8273        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  8274
  8275     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  8276     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8277     MOVE +0                     TO DC-ELAPSED-DAYS.
  8278     MOVE '6'                    TO DC-OPTION-CODE.
  8279     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8280
  8281     IF NO-CONVERSION-ERROR
  8282        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  8283
  8284     MOVE +0                     TO DC-ELAPSED-MONTHS
  8285                                    DC-ELAPSED-DAYS.
  8286
  8287     MOVE SPACES                 TO CERTIFICATE-RECORD.
  8288     MOVE 'CR'                   TO CR-RECORD-ID.
  8289     MOVE ZEROS                  TO
  8290               CR-AGE                  CR-JOINT-AGE
  8291               CR-LFTYP                CR-AHTYP
  8292               CR-LF-TERM              CR-AH-TERM
  8293               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  8294               CR-LF-TERM-IN-DAYS
  8295               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  8296               CR-LFAMT                CR-AHAMT
  8297               CR-LFPRM                CR-AHPRM
  8298               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  8299               CR-LFPRM-CALC           CR-AHPRM-CALC
  8300               CR-LFPRM-RATE           CR-AHPRM-RATE
  8301               CR-LFAMT-ALT
  8302               CR-LFPRM-ALT
  8303               CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
  8304               CR-LFPRM-RATE-ALT
  8305               CR-LFRFND               CR-AHRFND
  8306               CR-LFRFND-CALC          CR-AHRFND-CALC
  8307               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  8308               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  8309               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  8310               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  8311               CR-LIVES                CR-APR
  8312               CR-BILLED
  8313               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  8314               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  8315               CR-PMT-FREQ             CR-LOAN-TERM
  8316               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  8317               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 162
* ECS010.cbl
  8318               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  8319               CR-LF-CANC-DT           CR-AH-CANC-DT
  8320               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  8321               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  8322               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  8323               CR-DTH-DT               CR-DIS-DT
  8324               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  8325               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  8326                                       CR-DIS-PTO-DT
  8327               CR-DTHAMT               CR-DISAMT
  8328               CR-DTHAMT-YTD           CR-DISAMT-YTD
  8329               CR-DTHAMT-LAST          CR-DISAMT-LAST
  8330               CR-DTHEXP               CR-DISEXP
  8331               CR-DTHEXP-YTD           CR-DISEXP-YTD
  8332               CR-DTH-AGE              CR-DAYS-DISAB
  8333               CR-DIS-INCUR-DT (1)
  8334***            CR-CLAIM-DEDUCT-WITHHELD
  8335               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  8336               CR-INCUR-DISEXP (1)     CR-REMIT-TO
  8337               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  8338               CR-MOB-NET-TOT-FEES
  8339               CR-ADDL-CLP  CR-LF-CLP  CR-AH-CLP
  8340               CR-LF-RFND-CLP CR-AH-RFND-CLP.
  8341
  8342     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  8343                                       CR-DISAB-DETAIL-DATA (3)
  8344                                       CR-DISAB-DETAIL-DATA (4)
  8345                                       CR-DISAB-DETAIL-DATA (5).
  8346
  8347     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  8348
  8349     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  8350     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  8351        IA > +10
  8352        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  8353     END-PERFORM
  8354     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  8355
  8356     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  8357
  8358     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  8359                          EPEC-TOTALS      EPEC-SUBS
  8360                          EPEC-UNDERWRITTEN-TOTALS.
  8361
  8362     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  8363                          EPEC-LEVELS-END-II.
  8364     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  8365                          DUPE-CERT-TABLE.
  8366
  8367     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  8368     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  8369     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  8370                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  8371     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  8372                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  8373
  8374     IF RUN-DATE NOT = EP-DT
  8375         MOVE '*'                     TO TR-YRASK.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 163
* ECS010.cbl
  8376     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  8377     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  8378     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  8379     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  8380
  8381     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  8382         MOVE +1000                   TO DUP-MAX.
  8383
  8384     MOVE DTE-CLIENT                  TO ME-COMPANY.
  8385     MOVE MONTH-END-MOYR              TO ME-MOYR.
  8386     IF ME-DO-UPDATE
  8387         READ ERMEBL-INOUT INVALID KEY
  8388                       CLOSE ERMEBL-INOUT
  8389                       MOVE 'N'       TO ME-UPDATE-FLAG.
  8390
  8391     IF DTE-CLIENT = 'DCC'
  8392        MOVE 0 TO B-SUB
  8393        MOVE DTE-CLASIC-COMPANY-CD
  8394                                 TO PD-CONTROL-PRIMARY
  8395        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  8396        IF ERPDEF-FILE-STATUS = '00'
  8397           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  8398              READ ERPDEF NEXT RECORD
  8399              IF ERPDEF-FILE-STATUS = '00'
  8400                 ADD 1 TO B-SUB
  8401                 IF B-SUB > max-pdef
  8402                    DISPLAY ' DDF UEP TABLE BLEW ' b-sub
  8403                    GO TO ABEND-PGM
  8404                 END-IF
  8405                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  8406                 MOVE PD-PRODUCT-CD
  8407                                 TO DD-PRODUCT-CD (B-SUB)
  8408                 MOVE PD-BEN-TYPE
  8409                                 TO DD-BEN-TYPE (B-SUB)
  8410                 MOVE PD-BEN-CODE
  8411                                 TO DD-BEN-CODE (B-SUB)
  8412                 MOVE PD-PROD-EXP-DT
  8413                                 TO DD-PROD-EXP-DT (B-SUB)
  8414                 MOVE PD-1ST-YR-ADMIN-ALLOW
  8415                                 TO DD-1ST-YR-ALLOW (B-SUB)
  8416                 MOVE PD-TRUNCATED TO DD-TRUNCATED (B-SUB)
  8417                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  8418                    P2 > +8
  8419                    MOVE PD-PROD-CODE (P2)
  8420                                 TO DD-PROD-CODE (B-SUB P2)
  8421                    MOVE PD-MAX-AMT (P2)
  8422                                 TO DD-MAX-BEN-AMT (B-SUB P2)
  8423                 END-PERFORM
  8424                 MOVE PD-EARN-FACTORS
  8425                                 TO DD-EARN-FACTORS (B-SUB)
  8426              END-IF
  8427           END-PERFORM
  8428           display ' pdef table entries ' b-sub
  8429        END-IF
  8430        CLOSE ERPDEF
  8431     END-IF
  8432
  8433     GO TO 0150-READ-ACCOUNT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 164
* ECS010.cbl
  8434
  8435 0090-EXIT.
  8436     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 165
* ECS010.cbl
  8438 0095-GET-EOM-DATES.
  8439
  8440     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  8441     MOVE '6'                    TO DC-OPTION-CODE.
  8442     MOVE 1                      TO DC-ELAPSED-MONTHS
  8443                                    DC-END-OF-MONTH.
  8444     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8445     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8446
  8447     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8448         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  8449                                 TO WS-ABEND-MESSAGE
  8450         MOVE '90'               TO ABEND-CODE-1
  8451         MOVE '0'                TO AC2-ONE
  8452         MOVE DC-ERROR-CODE      TO AC2-TWO
  8453         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8454         GO TO ABEND-PGM.
  8455
  8456     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  8457                                     DC-BIN-DATE-1.
  8458     MOVE SPACES                 TO  DC-BIN-DATE-2.
  8459     MOVE ' '                    TO  DC-OPTION-CODE.
  8460     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8461
  8462     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8463         MOVE '**** YMD EOM DATE CALC ERROR ****'
  8464                                 TO WS-ABEND-MESSAGE
  8465         MOVE '90'               TO ABEND-CODE-1
  8466         MOVE '0'                TO AC2-ONE
  8467         MOVE DC-ERROR-CODE      TO AC2-TWO
  8468         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8469         GO TO ABEND-PGM.
  8470
  8471     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  8472
  8473 0095-EXIT.
  8474     EXIT.
  8475
  8476 0096-DISPLAY-EOM-DATES.
  8477
  8478     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  8479
  8480 0096-EXIT.
  8481     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 166
* ECS010.cbl
  8483******************************************************************
  8484***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  8485******************************************************************
  8486
  8487 0100-ACCT-MASTER-READ-ROUTINE.
  8488
  8489     IF EP-FLG = '1'
  8490        ADD +1                   TO BC-ACT-ACCTS
  8491        IF DTE-OPT-RESERVE-METHOD-AUTH
  8492           PERFORM 4700-CALC-OPT-IBNR
  8493                                 THRU 4700-EXIT
  8494        END-IF
  8495        PERFORM 4500-BUILD-EPEC-EXTRACT
  8496                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  8497     END-IF
  8498
  8499     IF TRANSACTION-WAS-PROCESSED
  8500         MOVE '1'                     TO ACCT-FLG
  8501                                         STATE-FLG
  8502                                         COMP-FLG
  8503                                         CARR-FLG
  8504                                         FINAL-FLG.
  8505
  8506 0150-READ-ACCOUNT-MASTER.
  8507
  8508     READ ERACCTT-IN AT END
  8509         GO TO 9930-EOJ-3.
  8510
  8511     ADD +1                            TO ERACCTT-READS.
  8512
* 8513     COPY ELCACCTI.
  8514******************************************************************04/14/98
  8515*                                                                *ELCACCTI
  8516*                            ELCACCTI                            *   LV003
  8517*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8518*                            VMOD=2.001                          *ELCACCTI
  8519*                                                                *ELCACCTI
  8520*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8521*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8522*                                                                *ELCACCTI
  8523*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8524*                                                                *ELCACCTI
  8525******************************************************************ELCACCTI
  8526     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8527     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8528     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8529     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8530     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8531     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8532     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8533     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8534     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8535
  8536     IF FIRST-ACCOUNT EQUAL +1
  8537        MOVE +0                  TO FIRST-ACCOUNT
  8538        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8539
  8540     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 167
* ECS010.cbl
  8541         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8542     ELSE
  8543     IF AM-GROUPING NOT = HLD-GROUPING
  8544         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8545     ELSE
  8546     IF AM-STATE NOT = HLD-STATE
  8547         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8548     ELSE
  8549     IF AM-ACCOUNT NOT = HLD-ACCT
  8550         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8551     ELSE
  8552     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8553
  8554     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8555        (AM-GROUPING NOT = HLD-GROUPING)
  8556         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8557
  8558 0190-PROCESS-NEW-ACCOUNT.
  8559
  8560     IF AM-CARRIER NOT = HLD-CARRIER
  8561         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8562
  8563     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8564     MOVE AM-CARRIER            TO TR-CARR.
  8565     MOVE AM-GROUPING           TO TR-GROUP.
  8566     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8567     MOVE AM-NAME               TO TR-AGCY.
  8568     MOVE AM-EFF-MO             TO TR-CE-MO.
  8569     MOVE AM-EFF-DA             TO TR-CE-DA.
  8570     MOVE AM-EFF-YR             TO TR-CE-YR.
  8571     MOVE AM-STATE              TO TR-ST-NO.
  8572     IF AM-EXPIRE-DT =  99999999999
  8573         MOVE 'CURRENT '        TO TR-CX
  8574     ELSE
  8575         MOVE AM-EXP-MO         TO TR-CX-MO
  8576         MOVE AM-EXP-DA         TO TR-CX-DA
  8577         MOVE AM-EXP-YR         TO TR-CX-YR
  8578         MOVE '-'               TO HSHR1  HSHR2.
  8579
  8580     ADD +1 TO BC-ACCTS.
  8581
  8582     IF AM-RECORD-ID = '**'
  8583         ADD +1 TO BC-NEW-ACCTS.
  8584     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8585         ADD +1 TO BC-ER-ACCTS.
  8586
  8587     MOVE ZEROS                 TO SV-LO-CERT
  8588                                   SV-HI-CERT.
  8589     MOVE SPACE                 TO TRANSACTION-FLAG
  8590                                   LST-TRD-CERT
  8591                                   LST-TRD-ISDT
  8592                                   OB-DATE-1-SWITCH
  8593                                   OB-DATE-2-SWITCH
  8594                                   OB-DATE-3-SWITCH.
  8595     MOVE +81                   TO LN-CNT.
  8596
  8597     IF DTE-CLIENT = 'DCC'
  8598        MOVE 'YYYYYYYYYY'        TO WS-DCC-DDF-CB-LEVELS
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 168
* ECS010.cbl
  8599        PERFORM VARYING SUB FROM +1 BY +1 UNTIL SUB > 10
  8600           IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  8601              MOVE ZEROS         TO AM-COMM-CHARGEBACK (SUB)
  8602           END-IF
  8603           IF AM-COMM-CHARGEBACK (SUB) = 99
  8604              MOVE 'N'           TO WS-DDF-AH-CB (SUB)
  8605           END-IF
  8606        END-PERFORM
  8607     END-IF
  8608     .
  8609 0199-READ-ACCOUNT-X.
  8610     EXIT.
  8611
  8612 0199A-CARRIER-TABLE-LOOKUP.
  8613
  8614     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8615            VARYING CLAS-INDEXCN FROM 1 BY 1
  8616         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8617               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8618
  8619     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8620         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8621         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8622                                 TO WS-ABEND-MESSAGE
  8623         MOVE 4004               TO WS-ABEND-CODE
  8624         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8625         GO TO ABEND-PGM.
  8626
  8627 0199A-LOOKUP-XIT.
  8628     EXIT.
  8629 0199B-SEARCH-CARRIER-TABLE.
  8630     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 169
* ECS010.cbl
  8632******************************************************************
  8633***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8634******************************************************************
  8635
  8636 0200-CERT-MASTER-READ-ROUTINE.
  8637
  8638     IF EOF-ON-CERT
  8639         GO TO 0299-READ-CERT-X.
  8640
  8641     IF FIRST-CERT EQUAL +1
  8642        MOVE +0                  TO FIRST-CERT
  8643        GO TO 0250-READ-CERT-MASTER.
  8644
  8645     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8646
  8647     PERFORM CERT-DATE-LOAD.
  8648
  8649     IF CR-IND-GRP = 'I'  OR  '1'
  8650         MOVE '1'                    TO CR-IND-GRP
  8651     ELSE
  8652         MOVE '2'                    TO CR-IND-GRP.
  8653
  8654     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8655         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8656     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8657         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8658
  8659************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8660     IF DTE-CLIENT NOT = 'NSL'
  8661         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8662                                      CR-AH-REI-RISK-PRM.
  8663******************************************************************
  8664
  8665**** IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8666****     MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8667     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8668         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8669
  8670     MOVE CR-STATE                   TO STATE-L.
  8671     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8672
  8673     IF CR-LFTYP NOT = ZERO
  8674         MOVE CR-LFTYP               TO CLAS-LOOK
  8675         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8676
  8677     IF CR-AHTYP NOT = ZERO
  8678         MOVE CR-AHTYP               TO CLAS-LOOK
  8679         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8680
  8681     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8682     MOVE 'L'                    TO DC-OPTION-CODE
  8683     MOVE +0                     TO DC-ELAPSED-MONTHS
  8684                                    DC-ELAPSED-DAYS
  8685     PERFORM 8000-DATE-CONVERT-ROUTINE
  8686                                 THRU 8099-DATE-CONVERT-X
  8687     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8688
  8689     IF (DTE-CLIENT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 170
* ECS010.cbl
  8690        AND (CR-AHTYP NOT = ZERO AND SPACES)
  8691        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8692        AND (CR-DCC-PRODUCT-CODE NOT = 'DDF')
  8693        PERFORM 0395-GET-CERT-TRLRS
  8694                                 THRU 0395-EXIT
  8695     END-IF
  8696
  8697     IF RUN-MO NOT = 01
  8698         GO TO 0250-READ-CERT-MASTER.
  8699
  8700     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8701                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8702
  8703     IF ((CR-LFTYP NOT = ZERO)  AND
  8704         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8705        ((CR-AHTYP NOT = ZERO)  AND
  8706         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8707           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8708
  8709     .
  8710 0250-READ-CERT-MASTER.
  8711
  8712     READ CERT-MASTER-IN
  8713               AT END GO TO 9920-EOJ-2.
  8714
  8715     ADD +1 TO CMIN-CNT.
  8716
  8717*     DISPLAY ' READ CERT ' CIR-CONTROL
  8718     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8719         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8720         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8721         DISPLAY 'SECOND - '  CIR-CONTROL
  8722         MOVE 0612                    TO WS-ABEND-CODE
  8723         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8724         GO TO ABEND-PGM.
  8725
  8726     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8727         DISPLAY 'DUPLICATE CERT ON FILE'  pcic-first ' '
  8728            pcic-dt ' ' pcic-cert-no
  8729         IF DTE-CLIENT EQUAL 'SEN' OR 'AHL'
  8730            GO TO 0250-READ-CERT-MASTER
  8731         ELSE
  8732            MOVE 'DUPLICATE CERT ON FILE'
  8733                                      TO WS-ABEND-MESSAGE
  8734            MOVE 0302                 TO WS-ABEND-CODE
  8735            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8736            GO TO ABEND-PGM.
  8737
  8738******************************************************
  8739*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8740*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8741*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8742******************************************************
  8743     IF DTE-CLIENT = 'CID'
  8744        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8745           IF (CF-THIRD-AGENT  = '0000713100') OR
  8746              (CF-FOURTH-AGENT = '0000713100')
  8747              CONTINUE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 171
* ECS010.cbl
  8748           ELSE
  8749              GO TO 0250-READ-CERT-MASTER
  8750           END-IF
  8751        ELSE
  8752           IF COMPANY-NAME = '        PEOPLES TRUST'
  8753              IF CI-ACCOUNT = '0000845800'
  8754                 CONTINUE
  8755              ELSE
  8756                 GO TO 0250-READ-CERT-MASTER
  8757              END-IF
  8758           ELSE
  8759              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8760                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8761                    (CF-FOURTH-AGENT = '0000681700')
  8762                    CONTINUE
  8763                 ELSE
  8764                    GO TO 0250-READ-CERT-MASTER
  8765                 END-IF
  8766              ELSE
  8767                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8768                    IF CI-ACCOUNT = '0001107200' or '0001107201'
  8769                       CONTINUE
  8770                    ELSE
  8771                       GO TO 0250-READ-CERT-MASTER
  8772                    END-IF
  8773                 END-IF
  8774              END-IF
  8775           END-IF
  8776        END-IF
  8777     END-IF
  8778
  8779******************************************************
  8780     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8781
  8782 0299-READ-CERT-X.
  8783     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 172
* ECS010.cbl
  8785******************************************************************
  8786***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8787******************************************************************
  8788
  8789 0300-READ-PENDING-TRANSACTIONS.
  8790
  8791     READ PENDING-EXTRACT
  8792                   AT END GO TO 9910-EOJ-1.
  8793
  8794     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8795
  8796     IF NOT ED-PENDING-BUSINESS  AND
  8797        NOT ED-PENDING-CLAIMS  AND
  8798        NOT ED-CERT-CHANGES
  8799           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8800                                               ED-RECORD-TYPE
  8801           MOVE 0301                        TO WS-ABEND-CODE
  8802           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8803           GO TO ABEND-PGM.
  8804
  8805     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8806
  8807     IF DTE-CLIENT = 'NCL'
  8808         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8809             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8810                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8811             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8812
  8813     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8814         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8815         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8816         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8817         MOVE 0603                    TO WS-ABEND-CODE
  8818         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8819         GO TO ABEND-PGM.
  8820
  8821     ADD +1 TO TR-CNT.
  8822
  8823     IF ISSUE-TRANSACTION   OR
  8824        CANCEL-TRANSACTION  OR
  8825        CLAIM-TRANSACTION   OR
  8826        RESERVE-TRANSACTION OR
  8827        UPDATE-TRANSACTION
  8828         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8829         GO TO 0330-MATCH-PENDING-TO-CERT.
  8830
  8831     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8832
  8833     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8834     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8835             PENDING-RECORD-TYPE ')'.
  8836
  8837     MOVE 0301                   TO WS-ABEND-CODE.
  8838     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8839     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 173
* ECS010.cbl
  8841 0310-SET-UP-MATCHING-KEY.
  8842
  8843     IF ED-PENDING-BUSINESS
  8844         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8845         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8846         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8847         MOVE PB-STATE           TO PEND-MATCH-STATE
  8848         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8849         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8850         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8851         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8852
  8853     IF ED-PENDING-CLAIMS
  8854         ADD +1                  TO W-PENDING-CLMS
  8855         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8856         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8857         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8858         MOVE PC-STATE           TO PEND-MATCH-STATE
  8859         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8860         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8861         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8862         IF PC-CLAIMS
  8863             MOVE '3'            TO PENDING-RECORD-TYPE
  8864         ELSE
  8865             IF PC-RESERVES
  8866                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8867
  8868     IF ED-CERT-CHANGES
  8869         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8870         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8871         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8872         MOVE CC-STATE           TO PEND-MATCH-STATE
  8873         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8874         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8875         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8876         MOVE '5'                TO PENDING-RECORD-TYPE.
  8877
  8878     MOVE ' '                    TO DC-OPTION-CODE.
  8879     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8880     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8881
  8882 0310-EXIT.
  8883     EXIT.
  8884
  8885******************************************************************
  8886***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8887******************************************************************
  8888
  8889 0330-MATCH-PENDING-TO-CERT.
  8890
  8891     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8892         GO TO 0390-CERT-MISMATCH-ERROR.
  8893
  8894     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8895*       DISPLAY ' EQUAL PEND ' PENDING-MATCH-CONTROL
  8896       IF CLAIM-TRANSACTION
  8897*         DISPLAY ' CLAIM '
  8898         IF NOT PC-CHARGEBLE-EXPENSE  AND
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 174
* ECS010.cbl
  8899            NOT PC-NON-CHARGEBLE-EXPENSE
  8900             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8901                                      OR
  8902                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8903                  GO TO 0390-CERT-MISMATCH-ERROR.
  8904
  8905     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8906       IF RESERVE-TRANSACTION
  8907*         DISPLAY ' RESV '
  8908         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8909                                  OR
  8910            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8911              GO TO 0390-CERT-MISMATCH-ERROR.
  8912
  8913     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8914         IF ISSUE-TRANSACTION
  8915*           DISPLAY ' ISSUE '
  8916             GO TO 0380-DUPLICATE-CERT-ERROR
  8917         ELSE
  8918             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8919
  8920     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8921         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8922         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8923                                               0299-READ-CERT-X
  8924         GO TO 0330-MATCH-PENDING-TO-CERT.
  8925
  8926     IF ISSUE-TRANSACTION
  8927         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8928     ELSE
  8929         GO TO 0390-CERT-MISMATCH-ERROR.
  8930
  8931 0350-MATCH-PENDING-TO-ACCOUNT.
  8932
  8933     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8934       ADD +1  TO ERROR-COUNT
  8935         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8936           TO  DL-FULL
  8937             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8938         MOVE    ' PENDING CONTROL = '
  8939           TO  DIS-LINE-REASON
  8940         MOVE  PENDING-MATCH-CONTROL
  8941           TO  DIS-LINE-REC
  8942             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8943         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8944           TO  DIS-LINE-REASON
  8945         MOVE  PENDING-MATCH-CONTROL
  8946           TO  DIS-LINE-REC
  8947             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8948         MOVE  SPACES
  8949           TO  DISPLAY-LINE
  8950             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8952         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8953         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8954         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8955         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8956         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8957         DISPLAY '    ACCOUNT CONTROL = '
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 175
* ECS010.cbl
  8958         AM-MSTR-CNTRL AM-EFFECT-DT
  8959         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID' OR 'AHL'
  8960            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8961            GO TO 0300-READ-PENDING-TRANSACTIONS
  8962         ELSE
  8963            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8964                                      TO WS-ABEND-MESSAGE
  8965            MOVE 0302 TO WS-ABEND-CODE
  8966            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8967            GO TO ABEND-PGM.
  8968
  8969     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8970         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8971                                              0199-READ-ACCOUNT-X
  8972         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8973
  8974     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8975        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8976         GO TO 0500-APPLY-PENDING-BUSINESS.
  8977
  8978     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8979                                       0199-READ-ACCOUNT-X.
  8980     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8981
  8982
  8983 0370-ACCOUNT-MISMATCH-ERROR.
  8984
  8985     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8986     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8987     MOVE 'MISMATCH ACCOUNT ERROR'
  8988                               TO WS-ABEND-MESSAGE.
  8989     MOVE 0302 TO WS-ABEND-CODE.
  8990         DISPLAY '******************************'
  8991         DISPLAY '***** ERROR LOCATION 009 *****'
  8992         DISPLAY '******************************'
  8993     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8994     GO TO ABEND-PGM.
  8995
  8996
  8997 0380-DUPLICATE-CERT-ERROR.
  8998
  8999     IF PB-I-OB  OR  PB-I-SUMMARY
  9000         GO TO 0300-READ-PENDING-TRANSACTIONS.
  9001
  9002     ADD +1 TO DUP-CNT.
  9003
  9004     IF DUP-CNT NOT GREATER THAN DUP-MAX
  9005         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  9006         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  9007                                         PB-I-LF-ALT-PREMIUM-AMT
  9008         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  9009         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  9010         GO TO 0300-READ-PENDING-TRANSACTIONS.
  9011
  9012     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  9013     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9014
  9015*    MOVE 0301 TO WS-ABEND-CODE.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 176
* ECS010.cbl
  9016*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9017*    GO TO ABEND-PGM.
  9018
  9019
  9020 0390-CERT-MISMATCH-ERROR.
  9021
  9022     IF ISSUE-TRANSACTION  OR
  9023        CANCEL-TRANSACTION  OR
  9024        CLAIM-TRANSACTION
  9025         ADD +1                  TO  MISMATCH-COUNT.
  9026
  9027     IF DTE-CLIENT  =  'CID'  OR  'CSO' OR 'AHL'
  9028       ADD  +1  TO  ERROR-COUNT
  9029         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  9030           TO  DL-FULL
  9031             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9032         MOVE    ' TRANS CONTROL = '
  9033           TO  DIS-LINE-REASON
  9034         MOVE  PENDING-MATCH-CONTROL
  9035           TO  DIS-LINE-REC
  9036             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9037         MOVE    ' TRANS TYPE    = '
  9038           TO  DIS-LINE-REASON
  9039         MOVE  PENDING-RECORD-TYPE
  9040           TO  DIS-LINE-REC
  9041             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9042         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  9043           TO  DL-FULL
  9044             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9045         MOVE    ' CERT IN CTL   = '
  9046           TO  DIS-LINE-REASON
  9047         MOVE  CIR-CONTROL
  9048           TO  DIS-LINE-REC
  9049             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9050         MOVE    ' BYPASSED TRANS  = '
  9051           TO  DIS-LINE-REASON
  9052         MOVE  PENDING-MATCH-CONTROL
  9053           TO  DIS-LINE-REC
  9054             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9055         MOVE  SPACES
  9056           TO  DISPLAY-LINE
  9057             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9058         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  9059
  9060     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  9061     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  9062
  9063     IF ISSUE-TRANSACTION
  9064         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  9065     ELSE
  9066         IF CANCEL-TRANSACTION
  9067             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  9068         ELSE
  9069             IF CLAIM-TRANSACTION
  9070                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  9071             ELSE
  9072                 IF RESERVE-TRANSACTION
  9073                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 177
* ECS010.cbl
  9074                 ELSE
  9075                     IF UPDATE-TRANSACTION
  9076                         MOVE 'CHG'
  9077                                 TO  DTL-REC-TYPE-DESC.
  9078
  9079     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  9080     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  9081     MOVE 'DROPPED'              TO  DTL-STATUS.
  9082
  9083     IF ISSUE-TRANSACTION
  9084         MOVE PB-I-LF-PREMIUM-AMT
  9085                                 TO  MD2-LF-PREM
  9086         MOVE PB-I-LF-ALT-PREMIUM-AMT
  9087                                 TO  MD2-LF-ALT-PREM
  9088         MOVE PB-I-AH-PREMIUM-AMT
  9089                                 TO  MD2-AH-PREM
  9090         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  9091         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  9092         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  9093     ELSE
  9094         IF CANCEL-TRANSACTION
  9095             MOVE PB-C-LF-CANCEL-AMT
  9096                                 TO  MD3-LF-REFUND
  9097             MOVE PB-C-AH-CANCEL-AMT
  9098                                 TO  MD3-AH-REFUND
  9099             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  9100             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  9101         ELSE
  9102             IF CLAIM-TRANSACTION
  9103                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  9104                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  9105                     MOVE ZEROS             TO MD4-AH-CLAIM
  9106                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  9107                 ELSE
  9108                     MOVE ZEROS             TO MD4-LF-CLAIM
  9109                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  9110                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  9111
  9112     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  9113         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  9114         MOVE MISMATCH-PAGE-NUMBER
  9115                                 TO  TR-PG
  9116         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  9117         MOVE MR-CTL             TO  X
  9118         MOVE X TO LCP-ASA
  9119         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9120             THRU LCP-WRITE-END-MISMATCH-RPT
  9121         MOVE TR-HD-2            TO  MISMATCH-RPT
  9122         MOVE MR-CTL             TO  X
  9123         MOVE X TO LCP-ASA
  9124         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9125             THRU LCP-WRITE-END-MISMATCH-RPT
  9126         MOVE TR-HD-3            TO  MISMATCH-RPT
  9127         MOVE MR-CTL             TO  X
  9128         MOVE X TO LCP-ASA
  9129         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9130             THRU LCP-WRITE-END-MISMATCH-RPT
  9131         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 178
* ECS010.cbl
  9132         MOVE MR-CTL             TO  X
  9133         MOVE X TO LCP-ASA
  9134         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9135             THRU LCP-WRITE-END-MISMATCH-RPT
  9136         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  9137
  9138     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  9139     MOVE MR-CTL                 TO  X.
  9140     ADD +2                      TO  MISMATCH-LINE-COUNT.
  9141
  9142     MOVE X TO LCP-ASA
  9143     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9144         THRU LCP-WRITE-END-MISMATCH-RPT.
  9145
  9146     IF ISSUE-TRANSACTION
  9147         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  9148         MOVE MR-CTL             TO  X
  9149         ADD +1                  TO  MISMATCH-LINE-COUNT
  9150         MOVE X TO LCP-ASA
  9151         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9152             THRU LCP-WRITE-END-MISMATCH-RPT.
  9153
  9154     IF CANCEL-TRANSACTION
  9155         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  9156         MOVE MR-CTL             TO  X
  9157         ADD +1                  TO  MISMATCH-LINE-COUNT
  9158         MOVE X TO LCP-ASA
  9159         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9160             THRU LCP-WRITE-END-MISMATCH-RPT.
  9161
  9162     IF CLAIM-TRANSACTION
  9163         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  9164         MOVE MR-CTL             TO  X
  9165         ADD +1                  TO  MISMATCH-LINE-COUNT
  9166         MOVE X TO LCP-ASA
  9167         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9168             THRU LCP-WRITE-END-MISMATCH-RPT.
  9169
  9170     MOVE SPACES                 TO  MISMATCH-RPT.
  9171
  9172     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9173
  9174 0395-GET-CERT-TRLRS.
  9175
  9176     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  9177     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  9178     MOVE CR-CARRIER             TO CS-CARRIER
  9179     MOVE CR-GROUPING            TO CS-GROUPING
  9180     MOVE CR-STATE               TO CS-STATE
  9181     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  9182     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  9183     MOVE CR-CERT-NO             TO CS-CERT-NO
  9184     MOVE 'A'                    TO CS-TRAILER-TYPE
  9185
  9186     READ ELCRTT
  9187
  9188     IF ELCRTT-FILE-STATUS = '00'
  9189        MOVE CS-BANK-COMMISSION-AREA
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 179
* ECS010.cbl
  9190                                 TO WS-BANK-COMMISSIONS
  9191     ELSE
  9192        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  9193           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
  9194           PERFORM ABEND-PGM
  9195        END-IF
  9196     END-IF
  9197
  9198     .
  9199 0395-EXIT.
  9200     EXIT.
  9201
  9202******************************************************************
  9203***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  9204******************************************************************
  9205
  9206 0400-WRITE-CERT-RECORD.
  9207*     DISPLAY ' MADE 400 WRITE ' CR-FULL-CONTROL
  9208
  9209     IF CERTIFICATE-RECORD = LOW-VALUES
  9210         GO TO 0499-WRITE-CERT-X.
  9211
  9212     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  9213         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  9214         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL (1:19)
  9215            ' ' cr-dt ' ' cr-cert-no
  9216         ADD  +1  TO  ERROR-COUNT
  9217         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  9218           TO  DL-FULL
  9219             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9220         MOVE    ' CERT. CONTROL = '
  9221           TO  DIS-LINE-REASON
  9222         MOVE  CR-FULL-CONTROL
  9223           TO  DIS-LINE-REC
  9224             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9225         MOVE  SPACES
  9226           TO  DISPLAY-LINE
  9227             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9228            if dte-pgm-opt = '1'
  9229               WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9230               ADD +1 TO CMOT-CNT
  9231            end-if
  9232            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  9233                                 thru 0299-READ-CERT-X
  9234               GO TO 0400-WRITE-CERT-RECORD.
  9235
  9236*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  9237
  9238     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  9239         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9240                                              0199-READ-ACCOUNT-X
  9241         GO TO 0400-WRITE-CERT-RECORD.
  9242
  9243     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  9244        CR-DT NOT LESS THAN AM-EXPIRE-DT
  9245         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9246                                              0199-READ-ACCOUNT-X
  9247         GO TO 0400-WRITE-CERT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 180
* ECS010.cbl
  9248
  9249*     DISPLAY ' BEFORE REIN '
  9250     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9251*     DISPLAY ' AFTER REIN '
  9252
  9253     IF CR-LFTYP = ZEROS  AND
  9254        CR-DTHEXP NOT = ZEROS
  9255         ADD +1                     TO W-LFTYP-99
  9256         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  9257         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9258
  9259     IF CR-AHTYP = ZEROS  AND
  9260        CR-DISEXP NOT = ZEROS
  9261         ADD +1                     TO W-AHTYP-99
  9262         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  9263         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9264
  9265*     DISPLAY ' BEFORE EP BUMP'
  9266     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  9267*     DISPLAY ' AFTER EP BUMP'
  9268
  9269      if (dte-client = 'DCC')
  9270         and (ws-dcc-cnc-flag = 'Y')
  9271         write new-detail-extract
  9272      end-if
  9273
  9274     IF CR-LFTYP = '99'
  9275         MOVE '00'                  TO CR-LFTYP.
  9276     IF CR-AHTYP = '99'
  9277         MOVE '00'                  TO CR-AHTYP.
  9278
  9279*    IF CR-ISS-MICROFILM-NO NOT NUMERIC
  9280*        MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
  9281
  9282     IF CR-NH-INT-ON-REF NOT NUMERIC
  9283         MOVE ZEROS                 TO CR-NH-INT-ON-REF
  9284     END-IF
  9285
  9286     IF  CR-POLICY-IS-ACTIVE
  9287         ADD +1                  TO W-POLICY-ACTIVE-CTR
  9288         IF  CR-POLICY-IS-REISSUE
  9289             OR CR-POLICY-IS-MONTHLY
  9290             ADD +1              TO W-POLICY-REISSUE-CTR
  9291         ELSE
  9292             IF  CR-POLICY-IS-REIN-ONLY
  9293                 ADD +1          TO W-POLICY-REIN-CTR
  9294             ELSE
  9295                 NEXT SENTENCE
  9296     ELSE
  9297         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  9298
  9299     IF DTE-PGM-OPT = '1'
  9300       IF REIN-IS-RISK-PREMIUM  AND
  9301          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  9302         IF NOT CR-POLICY-IS-REISSUE  AND
  9303            NOT CR-POLICY-IS-DECLINED  AND
  9304            NOT CR-POLICY-IS-VOID
  9305            AND NOT CR-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 181
* ECS010.cbl
  9306             MOVE '*'            TO RISK-PREM-FLAG
  9307             PERFORM 3100-REINSURE-ISSUE THRU
  9308                     3199-REINSURE-ISSUE-X.
  9309
* 9310     COPY ELCCRTM2.
  9311******************************************************************04/16/98
  9312*                                                                *ELCCRTM2
  9313*                                                                *ELCCRTM2
  9314*                            ELCCRTM2                            *   LV004
  9315*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9316*                            VMOD=2.001                          *ELCCRTM2
  9317*                                                                *ELCCRTM2
  9318*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  9319*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  9320*                                                                *ELCCRTM2
  9321******************************************************************ELCCRTM2
  9322     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  9323     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  9324     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  9325     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  9326     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  9327     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  9328                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  9329     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  9330     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  9331     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  9332     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  9333                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  9334     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  9335     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  9336     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  9337     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  9338     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  9339                                                                     CL**4
  9340     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  9341                UNTIL COPY-NDX > 5                                   CL**4
  9342           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  9343                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  9344     END-PERFORM.                                                 ELCCRTM2
  9345                                                                  ELCCRTM2
  9346
  9347     IF DTE-PGM-OPT = '1'
  9348         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9349         ADD +1 TO CMOT-CNT.
  9350
  9351     move zeros                  to ueclp-clp-fact
  9352     MOVE SPACE                  TO REIN-FLG WS-DCC-CNC-FLAG
  9353                                    RISK-REIN-FLAG
  9354                                    RISK-PREM-FLAG
  9355                                    RC-COMM-FLG.
  9356
  9357 0499-WRITE-CERT-X.
  9358     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 182
* ECS010.cbl
  9360******************************************************************
  9361***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  9362******************************************************************
  9363
  9364 0500-APPLY-PENDING-BUSINESS.
  9365
  9366     IF CANCEL-TRANSACTION
  9367*         DISPLAY ' CANCEL TRAN ' CIR-CONTROL
  9368         GO TO 0600-PROCESS-CANCELLATIONS.
  9369
  9370     IF CLAIM-TRANSACTION
  9371*        DISPLAY ' CLAIM TRAN ' CIR-CONTROL
  9372         GO TO 0700-PROCESS-CLAIMS.
  9373
  9374     IF RESERVE-TRANSACTION
  9375*        DISPLAY ' RESV TRAN ' CIR-CONTROL
  9376         GO TO 0800-PROCESS-RESERVES.
  9377
  9378     IF UPDATE-TRANSACTION
  9379*        DISPLAY ' UPD TRAN ' CIR-CONTROL
  9380         GO TO 0900-PROCESS-CERT-CHANGES.
  9381
  9382******************************************************************
  9383***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  9384******************************************************************
  9385
  9386 0505-PROCESS-ISSUES.
  9387
  9388     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  9389     PERFORM CERT-DATE-LOAD.
  9390
  9391     ADD +1                      TO  W-POL-ISSUES.
  9392
  9393     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  9394     MOVE PB-CARRIER             TO  CR-CARRIER.
  9395     MOVE PB-GROUPING            TO  CR-GROUPING.
  9396     MOVE PB-STATE               TO  CR-STATE.
  9397     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  9398     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  9399                                     WS-CR-BIN-DATE
  9400     MOVE ' '                    TO  DC-OPTION-CODE.
  9401     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9402     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  9403                                     WS-CR-DT-N.
  9404     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  9405
  9406*     DISPLAY ' PROC ISS ' CR-FULL-CONTROL
  9407     MOVE PB-I-NAME              TO  CR-NAME.
  9408     MOVE PB-I-AGE               TO  CR-AGE.
  9409     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  9410     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  9411
  9412     IF PB-I-JOINT-COVERAGE
  9413         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  9414         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  9415     ELSE
  9416        IF (DTE-CLIENT EQUAL 'BOA')  AND
  9417           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 183
* ECS010.cbl
  9418             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  9419
  9420     IF PB-I-SUMMARY  OR
  9421        DTE-CLIENT = 'DMD'
  9422         MOVE PB-I-LIVES         TO  CR-LIVES.
  9423
  9424     IF PB-I-NUM-BILLED NOT NUMERIC
  9425        MOVE ZEROS               TO PB-I-NUM-BILLED.
  9426
  9427     IF PB-I-STATE-TAX NOT NUMERIC
  9428        MOVE ZEROS               TO PB-I-STATE-TAX.
  9429
  9430     IF PB-I-MUNI-TAX NOT NUMERIC
  9431        MOVE ZEROS               TO PB-I-MUNI-TAX.
  9432     IF PB-I-TOT-FEES NOT NUMERIC
  9433        MOVE ZEROS               TO PB-I-TOT-FEES
  9434     END-IF
  9435     IF PB-I-ADDL-CLP NOT NUMERIC
  9436        MOVE ZEROS               TO PB-I-ADDL-CLP
  9437     END-IF
  9438
  9439     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  9440     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  9441     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  9442     MOVE PB-I-LF-CLP            TO  CR-LF-CLP
  9443     MOVE PB-I-AH-CLP            TO  CR-AH-CLP
  9444     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  9445     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  9446     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  9447     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  9448     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  9449     MOVE PB-I-LOAN-APR          TO  CR-APR.
  9450     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  9451     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  9452
  9453     IF PB-I-RATE-CLASS-OVRD = SPACES
  9454         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  9455     ELSE
  9456         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  9457
  9458     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  9459     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  9460
  9461     IF PB-I-INDV-GRP-OVRD = SPACES
  9462         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  9463     ELSE
  9464         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  9465
  9466     IF CR-IND-GRP = 'I'  OR  '1'
  9467         MOVE '1'                TO  CR-IND-GRP
  9468     ELSE
  9469         MOVE '2'                TO  CR-IND-GRP.
  9470
  9471     IF PB-I-SKIP-CODE = '1'
  9472         MOVE 01                 TO  CR-SKIP.
  9473     IF PB-I-SKIP-CODE = '2'
  9474         MOVE 02                 TO  CR-SKIP.
  9475     IF PB-I-SKIP-CODE = '3'
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 184
* ECS010.cbl
  9476         MOVE 03                 TO  CR-SKIP.
  9477     IF PB-I-SKIP-CODE = '4'
  9478         MOVE 04                 TO  CR-SKIP.
  9479     IF PB-I-SKIP-CODE = '5'
  9480         MOVE 05                 TO  CR-SKIP.
  9481     IF PB-I-SKIP-CODE = '6'
  9482         MOVE 06                 TO  CR-SKIP.
  9483     IF PB-I-SKIP-CODE = '7'
  9484         MOVE 07                 TO  CR-SKIP.
  9485     IF PB-I-SKIP-CODE = '8'
  9486         MOVE 08                 TO  CR-SKIP.
  9487     IF PB-I-SKIP-CODE = '9'
  9488         MOVE 09                 TO  CR-SKIP.
  9489     IF PB-I-SKIP-CODE = 'A'
  9490         MOVE 10                 TO  CR-SKIP.
  9491     IF PB-I-SKIP-CODE = 'X'
  9492         MOVE 11                 TO  CR-SKIP.
  9493
  9494     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  9495     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  9496     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  9497
  9498     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  9499         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  9500                                        REIN-SPEC-A
  9501                                        REIN-SPEC-B
  9502                                        REIN-SPEC-C
  9503         MOVE REIN-SPEC          TO CR-REIN-TABLE
  9504     ELSE
  9505         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  9506
  9507     IF DTE-CLIENT = 'DCC'
  9508        MOVE AM-DCC-PRODUCT-CODE TO CR-DCC-PRODUCT-CODE
  9509        IF CR-DCC-PRODUCT-CODE = 'DDF'
  9510           MOVE PB-I-DDF-IU-RATE-UP TO CR-DDF-IU-RATE-UP
  9511        END-IF
  9512     END-IF
  9513
  9514     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  9515     MOVE ' '                    TO  DC-OPTION-CODE.
  9516     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9517     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  9518
  9519     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  9520
  9521     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  9522         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  9523     ELSE
  9524         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  9525
  9526     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  9527         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  9528
  9529     IF PB-BATCH-ENTRY = SPACE  OR
  9530        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  9531         MOVE '1'                TO  CR-ENTRY-STATUS
  9532     ELSE
  9533         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 185
* ECS010.cbl
  9534
  9535     IF PB-POLICY-IS-DECLINED
  9536         MOVE 'D'                TO  CR-ENTRY-STATUS.
  9537
  9538     IF PB-POLICY-IS-VOIDED
  9539         MOVE 'V'                TO  CR-ENTRY-STATUS.
  9540
  9541***  IF DTE-CLIENT NOT = 'CRI'
  9542***      IF PB-I-PREM-ACCTNG-ONLY
  9543***          MOVE '1'            TO  CR-ENTRY-STATUS.
  9544
  9545     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  9546                                     WS-CR-ENTRY-DATE-N.
  9547
  9548*    IF PB-I-MICROFILM-NO NUMERIC
  9549*        MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
  9550
  9551     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9552        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9553        OR 'AHL'
  9554         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9555     END-IF
  9556
  9557*************************************************
  9558***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9559***  WAS CONVERTED TO 1056 BYTES.             ***
  9560*************************************************
  9561     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9562     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9563
  9564     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9565
  9566     MOVE CR-STATE               TO STATE-L.
  9567
  9568     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9569
  9570     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9571
  9572***************************************************
  9573***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9574***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9575***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9576***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9577***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9578***************************************************
  9579     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9580         IF CR-LF-POLICY-IS-RESTORE
  9581             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9582             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9583         ELSE
  9584         IF CR-LF-POLICY-IS-REISSUE
  9585             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9586             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9587         ELSE
  9588         IF CR-LF-IS-REIN-ONLY
  9589             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  9590             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9591         ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 186
* ECS010.cbl
  9592         IF CR-LF-IS-DECLINED
  9593             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9594             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9595         ELSE
  9596         IF CR-LF-IS-VOID
  9597             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  9598             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9599         ELSE
  9600         IF CR-LF-POLICY-IS-MONTHLY
  9601            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9602            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9603
  9604
  9605 0510-PROCESS-LIFE-ISSUE.
  9606
  9607     IF PB-INVALID-LIFE
  9608         GO TO 0520-PROCESS-A-H-ISSUE.
  9609
  9610     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9611     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9612     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9613
  9614     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9615     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9616     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9617     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9618     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9619     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9620
  9621     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9622     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9623     IF PB-I-LF-POLICY-FEE  NUMERIC
  9624         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9625     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9626     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9627
  9628     IF PB-I-LF-PREM-TAX NUMERIC
  9629        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9630     END-IF
  9631
  9632
  9633     IF PB-I-LF-REI-RATE NOT = ZEROS
  9634        IF DTE-CLIENT = 'DCC'
  9635           CONTINUE
  9636*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9637        ELSE
  9638           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9639           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9640                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9641        END-IF
  9642     END-IF
  9643
  9644     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9645         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9646         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9647         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  9648         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9649         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 187
* ECS010.cbl
  9650             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9651                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9652
  9653     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9654     MOVE ' '                    TO  DC-OPTION-CODE.
  9655     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9656     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9657                                     WS-CR-LF-EXPIRE-DATE-N.
  9658
  9659     IF CR-ENTRY-STATUS = 'P'
  9660         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  9661     ELSE
  9662         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9663
  9664     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9665     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9666     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9667     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9668     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9669
  9670     IF CR-LF-POLICY-IS-RESTORE
  9671         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9672     IF CR-LF-POLICY-IS-REISSUE
  9673         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9674     IF CR-LF-IS-REIN-ONLY
  9675         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9676
  9677     IF CR-LF-IS-DECLINED
  9678         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9679
  9680     IF CR-LF-IS-VOID
  9681         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9682     IF CR-LF-POLICY-IS-MONTHLY
  9683         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9684
  9685     ADD +1                      TO  W-LF-ISSUES.
  9686
  9687 0520-PROCESS-A-H-ISSUE.
  9688
  9689     IF PB-INVALID-AH
  9690         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9691
  9692     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9693     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9694     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9695
  9696     IF (NOT PB-I-JOINT-COVERAGE)
  9697        AND (CLAS-I-JOINT (CLAS-INDEXA) = 'J')
  9698        MOVE PB-I-JOINT-INSURED  TO CR-JOINT-NAME
  9699        MOVE PB-I-JOINT-AGE      TO CR-JOINT-AGE
  9700     END-IF
  9701
  9702     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9703     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9704     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9705     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9706     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9707
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 188
* ECS010.cbl
  9708     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9709     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9710     IF PB-I-AH-POLICY-FEE  NUMERIC
  9711         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  9712     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9713     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9714
  9715     IF PB-I-AH-PREM-TAX NUMERIC
  9716        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9717     END-IF
  9718
  9719     IF PB-I-AH-REI-RATE NOT = ZEROS
  9720        IF DTE-CLIENT = 'DCC'
  9721           CONTINUE
  9722        ELSE
  9723           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9724           COMPUTE CR-AH-NSP-PRM ROUNDED =
  9725             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9726        END-IF
  9727     END-IF
  9728
  9729     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9730        IF (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9731           MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9732           MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9733        END-IF
  9734        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9735     END-IF
  9736     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9737     MOVE ' '                    TO  DC-OPTION-CODE.
  9738     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9739     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9740                                     WS-CR-AH-EXPIRE-DATE-N.
  9741
  9742     IF CR-ENTRY-STATUS = 'P'
  9743         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9744     ELSE
  9745         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9746
  9747     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9748     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9749     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9750     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9751     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9752
  9753     IF CR-AH-POLICY-IS-RESTORE
  9754         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9755     IF CR-AH-POLICY-IS-REISSUE
  9756         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9757     IF CR-AH-IS-REIN-ONLY
  9758         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9759
  9760     IF CR-AH-IS-DECLINED
  9761         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9762
  9763     IF CR-AH-IS-VOID
  9764         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9765     IF CR-AH-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 189
* ECS010.cbl
  9766         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9767
  9768     ADD +1                      TO  W-AH-ISSUES.
  9769
  9770 0530-PROCESS-ISSUE-CONTINUED.
  9771
  9772     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9773     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9774     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9775     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9776
  9777     IF (DTE-CLIENT = 'DCC')
  9778        AND (CR-AHTYP NOT = '00' AND '  ')
  9779        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9780        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9781           PERFORM 0920-GET-BANK-FEES
  9782                                 THRU 0920-EXIT
  9783           PERFORM 0930-BUILD-CERT-TRLR
  9784                                 THRU 0930-EXIT
  9785           PERFORM 0395-GET-CERT-TRLRS
  9786                                 THRU 0395-EXIT
  9787     END-IF
  9788
  9789     IF DTE-CLIENT = 'DCC'
  9790        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
  9791           MOVE CR-LF-CLP        TO CR-LF-NSP-PRM
  9792        END-IF
  9793        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9794           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9795              (CR-LFPRM + CR-LFPRM-ALT) -
  9796              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9797        END-IF
  9798     END-IF
  9799
  9800     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9801        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9802        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9803     ELSE
  9804        IF DTE-CLIENT = 'DCC'
  9805           IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
  9806              OR (AM-DCC-PRODUCT-CODE = 'DDF')
  9807              MOVE CR-AH-CLP        TO CR-AH-NSP-PRM
  9808           END-IF
  9809           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9810              COMPUTE CR-AH-NSP-PRM ROUNDED = CR-AHPRM -
  9811              (CR-AHPRM * CR-LCOM-AH (1))
  9812           END-IF
  9813        END-IF
  9814     END-IF
  9815
  9816     IF DTE-CLIENT = 'DCC'
  9817         IF PB-I-VIN > SPACES
  9818             PERFORM 0950-BUILD-CERT-C-TRLR THRU 0950-EXIT
  9819         END-IF
  9820     END-IF.
  9821
  9822     IF CR-ENTRY-STATUS = 'P'
  9823         MOVE '1'                   TO CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 190
* ECS010.cbl
  9824
  9825     IF CR-POLICY-IS-REISSUE  OR
  9826        CR-POLICY-IS-REIN-ONLY OR
  9827        CR-POLICY-IS-DECLINED OR
  9828        CR-POLICY-IS-VOID
  9829        OR CR-POLICY-IS-MONTHLY
  9830         GO TO 0590-END-ISSUE-PROCESSING.
  9831
  9832     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9833     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9834        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9835     END-IF
  9836     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9837
  9838     IF NOT PB-INVALID-LIFE
  9839         COMPUTE H-LFCM ROUNDED =
  9840                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9841         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  9842         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9843
  9844     IF NOT PB-INVALID-AH
  9845        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9846           IF AM-DCC-PRODUCT-CODE NOT = 'DDF'
  9847              COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9848              + CR-ADDL-CLP)
  9849           ELSE
  9850              COMPUTE H-AHCM ROUNDED = CR-AHPRM - CR-AH-CLP
  9851              - CR-ADDL-CLP
  9852           END-IF
  9853        ELSE
  9854           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9855        END-IF
  9856        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9857        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9858     END-IF
  9859
  9860     ADD +1 TO BC-G-ISS.
  9861     ADD +1 TO BC-COMM.
  9862     ADD CR-LFPRM TO BC-NET-WRIT.
  9863     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9864        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9865     END-IF
  9866     ADD CR-AHPRM TO BC-NET-WRIT.
  9867
  9868     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9869        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9870        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9871     ELSE
  9872        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9873        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9874           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9875        END-IF
  9876     END-IF
  9877
  9878     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9879         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9880     ELSE
  9881         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 191
* ECS010.cbl
  9882
  9883 0590-END-ISSUE-PROCESSING.
  9884
  9885     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9886
  9887     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9888
  9889     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  9890        NOT CR-POLICY-IS-DECLINED  AND
  9891        NOT CR-POLICY-IS-VOID
  9892         MOVE 'Y' TO BILLED-SWITCH
  9893         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9894         IF DTE-CLIENT = 'DCC'
  9895            move detail-extract  to new-detail-extract
  9896            IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9897               compute dx-a-pc (1) = cr-ahprm - cr-lfprm-alt -
  9898                  cr-addl-clp
  9899            end-if
  9900            write new-detail-extract
  9901         end-if
  9902
  9903     IF NOT CR-POLICY-IS-REISSUE  AND
  9904        NOT CR-POLICY-IS-DECLINED  AND
  9905        NOT CR-POLICY-IS-VOID
  9906        AND NOT CR-POLICY-IS-MONTHLY
  9907         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9908
  9909     MOVE '*'                   TO TRANSACTION-FLAG.
  9910     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 192
* ECS010.cbl
  9912******************************************************************
  9913***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9914******************************************************************
  9915
  9916 0600-PROCESS-CANCELLATIONS.
  9917
  9918*     DISPLAY ' PROC CNC ' CR-FULL-CONTROL
  9919     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9920
  9921     IF AM-RECALC-COMM = ('Y' OR '1')
  9922        PERFORM 1600-RECALC-COMM-EXTR
  9923                                 THRU 1899-RECALC-COMM-EXTR-X
  9924        MOVE ' '                 TO RECALC-TYPE
  9925     END-IF
  9926
  9927     MOVE CR-LFRFND               TO LIFE-REFUND.
  9928     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9929     MOVE CR-AHRFND               TO A-H-REFUND.
  9930     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9931     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9932
  9933     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9934     IF CR-LFRFND NOT = ZEROS
  9935        IF CR-LFRFND-CALC = ZEROS
  9936           MOVE PB-C-LF-REF-CALC TO CR-LFRFND-CALC
  9937                                    LIFE-REFUND-CALC
  9938        ELSE
  9939           MOVE PB-C-LF-CANCEL-AMT TO CR-LFRFND-CALC
  9940        END-IF
  9941     END-IF
  9942
  9943     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9944
  9945     IF CR-AHRFND-CALC = ZEROS
  9946        MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9947                                    A-H-REFUND-CALC
  9948     ELSE
  9949        MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC
  9950     END-IF
  9951
  9952     IF PB-C-POST-CARD-IND = 'Y' OR 'N'
  9953        MOVE PB-C-POST-CARD-IND  TO CR-POST-CARD-IND
  9954     ELSE
  9955        MOVE SPACES              TO CR-POST-CARD-IND
  9956     END-IF
  9957
  9958*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9959*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9960*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9961*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9962
  9963     IF PB-C-NH-INT-ON-REFS NUMERIC
  9964        AND PB-C-NH-INT-ON-REFS NOT = ZEROS
  9965        MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
  9966     END-IF
  9967     MOVE PB-C-CANCEL-REASON      TO CR-CANCEL-REASON
  9968
  9969     IF PB-CI-STATE-TAX NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 193
* ECS010.cbl
  9970        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9971
  9972     IF PB-CI-MUNI-TAX NOT NUMERIC
  9973        MOVE ZEROS               TO PB-CI-MUNI-TAX.
  9974
  9975     IF CR-CANCEL-STATE-TAX NUMERIC
  9976         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9977       ELSE
  9978         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9979
  9980     IF CR-CANCEL-MUNI-TAX NUMERIC
  9981         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
  9982       ELSE
  9983         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9984
  9985     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9986                                    MONTHS-DIFF-AH.
  9987
  9988     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9989
  9990 0630-PROCESS-LIFE-CANCEL.
  9991
  9992     IF CR-LFTYP = ZERO  OR
  9993        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9994         MOVE ZEROS               TO H-LFCM
  9995         GO TO 0650-PROCESS-A-H-CANCEL.
  9996
  9997     IF CR-LFRFND = +0
  9998        AND CR-DTHAMT > ZEROS
  9999        AND CR-LF-CLAIM-EXIT-DATE > ZEROS
 10000        MOVE ZEROS               TO H-LFCM
 10001        MOVE 'LFCNC DROP'        TO TRD-LF-ACTION
 10002        MOVE CR-LF-CURRENT-STATUS TO TRD-LF-STATUS
 10003        GO TO 0650-PROCESS-A-H-CANCEL
 10004     END-IF
 10005
 10006     IF DTE-CLIENT = 'DCC'
 10007        IF PB-C-LF-RFND-CLP NUMERIC
 10008           MOVE PB-C-LF-RFND-CLP TO CR-LF-RFND-CLP
 10009        END-IF
 10010     END-IF
 10011
 10012     IF PB-C-LF-PREM-TAX NUMERIC
 10013        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
 10014     END-IF
 10015     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
 10016     MOVE ' '                     TO  DC-OPTION-CODE.
 10017     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10018     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
 10019                                      WS-CR-LF-CANC-DT-N.
 10020
 10021
 10022     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10023     MOVE ' '                    TO DC-OPTION-CODE
 10024     PERFORM 8000-DATE-CONVERT-ROUTINE
 10025                                 THRU 8099-DATE-CONVERT-X
 10026     IF CR-LF-CNC-ENT-DT NOT NUMERIC
 10027        MOVE ZEROS TO CR-LF-CNC-ENT-DT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 194
* ECS010.cbl
 10028     END-IF
 10029     IF NO-CONVERSION-ERROR
 10030        IF CR-LF-CNC-ENT-DT = ZEROS
 10031           MOVE DC-GREG-DATE-CYMD TO CR-LF-CNC-ENT-DT
 10032        END-IF
 10033     END-IF
 10034
 10035     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10036     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
 10037     MOVE '1'                     TO  DC-OPTION-CODE.
 10038     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10039     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10040                                      DC-ODD-DAYS-OVER
 10041                                      DC-ELAPSED-DAYS.
 10042     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10043     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 10044
 10045     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 10046         ADD  +1                  TO  MONTHS-DIFF-LF.
 10047
 10048     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 10049
 10050     MOVE  ZEROS                  TO  SUB.
 10051
 10052 0635-LIFE-CHARGEBACK-LOOP.
 10053
 10054     ADD    +1                    TO  SUB.
 10055
 10056     IF  SUB  GREATER THAN  +10
 10057         GO TO  0640-CONTINUE-LIFE-CANCEL.
 10058
 10059*** ON A REPOSSESSION FOR DDF ON LMBA AND CSO ADMIN
 10060*** WE FULLY EARN THE FEE
 10061     IF CR-CANCEL-REASON = 'R'
 10062        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10063           AND (AM-COM-TYP (SUB) = 'L' OR 'N')
 10064           MOVE 'N'              TO WS-LF-CHARGEBACK-SW (SUB)
 10065           GO TO  0635-LIFE-CHARGEBACK-LOOP
 10066        END-IF
 10067     END-IF
 10068
 10069     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10070         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10071         GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10072
 10073     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10074         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 10075
 10076     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 10077         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 10078
 10079     GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10080
 10081
 10082 0640-CONTINUE-LIFE-CANCEL.
 10083
 10084     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10085        SUBTRACT +1 FROM MONTHS-DIFF-LF.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 195
* ECS010.cbl
 10086
 10087     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
 10088
 10089     IF DTE-CLIENT = 'GIC'
 10090         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 10091             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
 10092                                     LIFE-REFUND-CALC.
 10093
 10094*    IF DTE-CLIENT = 'TMS'
 10095     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
 10096
 10097     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 10098         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10099     ELSE
 10100         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
 10101             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
 10102             MOVE '8'                  TO CR-LF-CURRENT-STATUS
 10103             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
 10104             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
 10105                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10106         ELSE
 10107             IF CR-LF-CURRENT-STATUS = '6'
 10108                 MOVE '8'              TO CR-LF-CURRENT-STATUS
 10109                 MOVE PB-C-LF-COMM-CHARGEBACK
 10110                                       TO CR-LF-COMM-CHARGEBACK
 10111                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
 10112                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
 10113
 10114*************************************************
 10115***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10116***  WAS CONVERTED TO 1056 BYTES.             ***
 10117*************************************************
 10118     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
 10119
 10120     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10121     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10122     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
 10123
 10124     COMPUTE H-LFCM ROUNDED =
 10125                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
 10126     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
 10127
 10128     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
 10129     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
 10130     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
 10131     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
 10132
 10133     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
 10134     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10135
 10136 0650-PROCESS-A-H-CANCEL.
 10137
 10138     IF CR-AHTYP = ZERO  OR
 10139        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
 10140         MOVE ZEROS               TO H-AHCM
 10141         GO TO 0660-PROCESS-CANCEL-CONTINUE.
 10142
 10143*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 196
* ECS010.cbl
 10144*    MOVE 'L'                   TO  DC-OPTION-CODE.
 10145*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10146*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 10147
 10148     IF DTE-CLIENT = 'DCC'
 10149        IF PB-C-AH-RFND-CLP NUMERIC
 10150           MOVE PB-C-AH-RFND-CLP TO CR-AH-RFND-CLP
 10151        END-IF
 10152     END-IF
 10153
 10154     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
 10155     MOVE ' '                     TO  DC-OPTION-CODE.
 10156     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10157     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
 10158                                      WS-CR-AH-CANC-DT-N.
 10159
 10160     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10161     MOVE ' '                    TO DC-OPTION-CODE
 10162     PERFORM 8000-DATE-CONVERT-ROUTINE
 10163                                 THRU 8099-DATE-CONVERT-X
 10164     IF CR-AH-CNC-ENT-DT NOT NUMERIC
 10165        MOVE ZEROS TO CR-AH-CNC-ENT-DT
 10166     END-IF
 10167     IF NO-CONVERSION-ERROR
 10168        IF CR-AH-CNC-ENT-DT = ZEROS
 10169           MOVE DC-GREG-DATE-CYMD TO CR-AH-CNC-ENT-DT
 10170        END-IF
 10171     END-IF
 10172
 10173     IF PB-C-AH-PREM-TAX NUMERIC
 10174        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
 10175     END-IF
 10176     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10177     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
 10178     MOVE '1'                     TO  DC-OPTION-CODE.
 10179     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10180     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10181                                      DC-ODD-DAYS-OVER
 10182                                      DC-ELAPSED-DAYS.
 10183     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10184     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 10185
 10186     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
 10187          ADD  +1                 TO  MONTHS-DIFF-AH.
 10188
 10189     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 10190                                      WS-DCC-DDF-CB-LEVELS
 10191     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
 10192        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
 10193     END-IF
 10194*    IF DTE-CLIENT = 'DCC'
 10195*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10196*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
 10197*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 10198*             (CR-BANK-NO = CR-COM-AGT (SUB))
 10199*             OR (SUB > +10)
 10200*          END-PERFORM
 10201*          IF CR-BANK-NO = CR-COM-AGT (SUB)
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 197
* ECS010.cbl
 10202*             MOVE CR-BANK-NOCHRGB-MONTHS
 10203*                                TO AM-COMM-CHARGEBACK (SUB)
 10204*          END-IF
 10205*       END-IF
 10206*    END-IF
 10207
 10208
 10209     MOVE 'Y'                     TO WS-FIRST-K
 10210     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
 10211     MOVE  ZEROS                  TO  SUB.
 10212
 10213 0653-A-H-CHARGEBACK-LOOP.
 10214
 10215     ADD    +1                    TO  SUB.
 10216
 10217     IF  SUB  GREATER THAN  +10
 10218         GO TO  0655-CONTINUE-A-H-CANCEL.
 10219
 10220     IF CR-CANCEL-REASON = 'R'
 10221        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10222           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 10223              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 10224              GO TO  0653-A-H-CHARGEBACK-LOOP
 10225           END-IF
 10226           IF AM-COM-TYP (SUB) = 'J'
 10227              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 10228              GO TO  0653-A-H-CHARGEBACK-LOOP
 10229           END-IF
 10230        END-IF
 10231     END-IF
 10232
 10233     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10234         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10235         GO TO  0653-A-H-CHARGEBACK-LOOP.
 10236
 10237     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10238         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 10239
 10240     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 10241         OR ((DTE-CLIENT = 'DCC')
 10242             AND (CR-AHRFND = ZEROS))
 10243         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
 10244
 10245     GO TO  0653-A-H-CHARGEBACK-LOOP.
 10246
 10247
 10248 0655-CONTINUE-A-H-CANCEL.
 10249
 10250     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10251        SUBTRACT +1 FROM MONTHS-DIFF-AH.
 10252
 10253     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
 10254
 10255     IF DTE-CLIENT = 'GIC'
 10256         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 10257             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
 10258                                     A-H-REFUND-CALC.
 10259
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 198
* ECS010.cbl
 10260*    IF DTE-CLIENT = 'TMS'
 10261     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
 10262*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
 10263
 10264
 10265     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 10266         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10267     ELSE
 10268         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
 10269             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
 10270             MOVE '8'                  TO CR-AH-CURRENT-STATUS
 10271             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
 10272             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
 10273                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10274         ELSE
 10275             IF CR-AH-CURRENT-STATUS = '7'
 10276                 MOVE '8'              TO CR-AH-CURRENT-STATUS
 10277                 MOVE PB-C-AH-COMM-CHARGEBACK
 10278                                       TO CR-AH-COMM-CHARGEBACK
 10279                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
 10280                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
 10281
 10282*************************************************
 10283***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10284***  WAS CONVERTED TO 1056 BYTES.             ***
 10285*************************************************
 10286     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
 10287
 10288     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
 10289     MOVE CR-AH-TERM                   TO TRD-AHTRM.
 10290     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
 10291
 10292     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10293        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 10294        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10295           COMPUTE CNC-FACT = CR-AH-RFND-CLP / CR-AH-CLP
 10296           MOVE CNC-FACT TO UECLP-CLP-FACT
 10297        END-IF
 10298        IF CR-CANCEL-REASON = 'R'
 10299           MOVE +1               TO CNC-FACT
 10300        END-IF
 10301        COMPUTE H-AHCM ROUNDED = CNC-FACT *
 10302           (CR-AHPRM - (CR-LFPRM-ALT
 10303           + CR-ADDL-CLP)) * -1
 10304     ELSE
 10305        COMPUTE H-AHCM ROUNDED =
 10306          (CR-AHRFND * ACCT-COMM-AH) * (-1)
 10307     END-IF
 10308
 10309     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
 10310
 10311     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
 10312     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
 10313     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
 10314     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
 10315
 10316     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
 10317     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 199
* ECS010.cbl
 10318
 10319 0660-PROCESS-CANCEL-CONTINUE.
 10320
 10321     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10322
 10323     IF CR-POLICY-IS-REIN-ONLY
 10324        GO TO 0660-CONT.
 10325
 10326     MOVE 'Y'                    TO BILLED-SWITCH.
 10327     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
 10328
 10329     MOVE 'Y' TO WS-DCC-CNC-FLAG
 10330     if dte-client = 'DCC'
 10331        MOVE DETAIL-EXTRACT      TO NEW-DETAIL-EXTRACT
 10332     end-if
 10333
 10334     IF CR-POLICY-IS-MONTHLY
 10335        GO TO 0660-CONT
 10336     END-IF
 10337
 10338     ADD +1                      TO BC-G-CNC.
 10339     ADD +1                      TO BC-COMM.
 10340     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
 10341     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
 10342     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
 10343     ADD H-LFCM                  TO TPL-ACCT-COM (1).
 10344     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
 10345     ADD H-AHCM                  TO TPA-ACCT-COM (1).
 10346
 10347     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 10348         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
 10349     ELSE
 10350         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
 10351
 10352     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
 10353         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
 10354     ELSE
 10355         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
 10356
 10357
 10358 0660-CONT.
 10359
 10360     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
 10361     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
 10362
 10363     IF CR-LFRFND NEGATIVE
 10364       IF CR-LFRFND + LIFE-REFUND = ZEROS
 10365           MOVE '*'                 TO REIN-VOID-LF-SW.
 10366     IF CR-AHRFND NEGATIVE
 10367       IF CR-AHRFND + A-H-REFUND = ZEROS
 10368           MOVE '*'                 TO REIN-VOID-AH-SW.
 10369
 10370     IF CR-LFRFND NOT = ZEROS
 10371       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10372           MOVE '*'                 TO REIN-ADDL-LF-SW.
 10373     IF CR-AHRFND NOT = ZEROS
 10374       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10375           MOVE '*'                 TO REIN-ADDL-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 200
* ECS010.cbl
 10376
 10377     IF CR-DT = CR-LF-CANC-DT
 10378       MOVE '*'                     TO REIN-CANCEL-LF-SW.
 10379     IF CR-DT = CR-AH-CANC-DT
 10380       MOVE '*'                     TO REIN-CANCEL-AH-SW.
 10381
 10382     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 10383
 10384     MOVE SPACES                    TO REIN-VOID-LF-SW
 10385                                       REIN-VOID-AH-SW
 10386                                       REIN-ADDL-LF-SW
 10387                                       REIN-ADDL-AH-SW.
 10388
 10389     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
 10390     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
 10391
 10392     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
 10393     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
 10394
 10395     IF (CR-LFTYP NOT = ZERO  AND
 10396        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 10397        (CR-AHTYP NOT = ZERO  AND
 10398        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 10399         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
 10400         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
 10401
 10402 0670-LIFE-CANCEL-VOID.
 10403
 10404     IF CR-LFTYP NOT = ZERO  AND
 10405        CR-LFRFND = ZERO  AND
 10406        PB-C-LF-CANCEL-AMT NEGATIVE
 10407         NEXT SENTENCE
 10408     ELSE
 10409         GO TO 0680-A-H-CANCEL-VOID.
 10410
 10411     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
 10412                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10413                                          CR-LF-CANC-DT
 10414                                          WS-CR-LF-CANC-DT-N
 10415                                          CR-LFRFND-CALC.
 10416
 10417     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
 10418
 10419     IF CR-LF-CANCEL-APPLIED
 10420         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
 10421         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
 10422     ELSE
 10423         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
 10424         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
 10425
 10426     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10427
 10428     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
 10429     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10430
 10431     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10432
 10433 0680-A-H-CANCEL-VOID.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 201
* ECS010.cbl
 10434
 10435     IF CR-AHTYP NOT = ZERO  AND
 10436        CR-AHRFND = ZERO  AND
 10437        PB-C-AH-CANCEL-AMT NEGATIVE
 10438         NEXT SENTENCE
 10439     ELSE
 10440         GO TO 0690-END-CANCEL-PROCESSING.
 10441
 10442     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
 10443                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10444                                        CR-AH-CANC-DT
 10445                                        WS-CR-AH-CANC-DT-N
 10446                                        CR-AHRFND-CALC.
 10447
 10448     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
 10449
 10450     IF CR-AH-CANCEL-APPLIED
 10451         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10452         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10453     ELSE
 10454         MOVE CR-AH-STATUS-AT-CANCEL
 10455                                    TO CR-AH-STATUS-AT-SETTLEMENT
 10456         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
 10457
 10458     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10459
 10460     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
 10461     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10462
 10463     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10464
 10465 0690-END-CANCEL-PROCESSING.
 10466
 10467     IF CR-LF-CANC-DT = ZEROS  AND
 10468        CR-AH-CANC-DT = ZEROS
 10469         MOVE ZEROS             TO CR-NH-INT-ON-REF
 10470     END-IF
 10471
 10472     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
 10473         NEXT SENTENCE
 10474     ELSE
 10475         MOVE 'X'               TO REIN-RT-SW
 10476         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
 10477         MOVE ' '               TO REIN-RT-SW.
 10478
 10479     MOVE '*'                   TO TRANSACTION-FLAG.
 10480     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10481
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 202
* ECS010.cbl
 10483******************************************************************
 10484***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
 10485******************************************************************
 10486
 10487 0700-PROCESS-CLAIMS.
 10488
 10489     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
 10490        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
 10491         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
 10492             PENDING-MATCH-CONTROL
 10493         MOVE 0301 TO WS-ABEND-CODE
 10494         DISPLAY '******************************'
 10495         DISPLAY '***** ERROR LOCATION 011 *****'
 10496         DISPLAY '******************************'
 10497         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10498         GO TO ABEND-PGM.
 10499
 10500     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10501
 10502     ADD +1                       TO  W-LF-CLAIMS.
 10503
 10504     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10505     MOVE ' '                     TO  DC-OPTION-CODE.
 10506     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10507     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10508
 10509     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10510     MOVE ' '                     TO  DC-OPTION-CODE.
 10511     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10512     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10513
 10514     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
 10515     MOVE ' '                     TO  DC-OPTION-CODE.
 10516     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10517     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
 10518
 10519     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10520     MOVE ' '                     TO  DC-OPTION-CODE.
 10521     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10522     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10523
 10524     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10525
 10526**** IF DTE-CLIENT = 'LAP'  OR  'RMC'
 10527****   MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
 10528****   IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
 10529****     IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
 10530****         MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
 10531****     ELSE
 10532****         ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
 10533
 10534     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10535         GO TO 0750-PROCESS-DISABILITY-CLAIM.
 10536
 10537******************************************************************
 10538***           P R O C E S S   D E A T H   C L A I M            ***
 10539******************************************************************
 10540
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 203
* ECS010.cbl
 10541     IF REIN-IS-RISK-PREMIUM
 10542       IF CR-DTH-DT = ZEROS
 10543           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
 10544           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10545           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
 10546
 10547     MOVE INCURRED-DATE            TO CR-DTH-DT
 10548                                      WS-CR-DTH-DT-N.
 10549
 10550     IF PC-CHARGEBLE-EXPENSE  OR
 10551        PC-NON-CHARGEBLE-EXPENSE
 10552         IF CR-LFTYP = '00'
 10553             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
 10554             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
 10555                     8399-LIFE-LOOKUP-X.
 10556
 10557     IF PC-CHARGEBLE-EXPENSE  OR
 10558        PC-NON-CHARGEBLE-EXPENSE
 10559         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
 10560         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
 10561         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
 10562         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
 10563         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
 10564         GO TO 0780-END-CLAIMS-PROCESSING.
 10565
 10566     ADD +1                       TO  CR-NUM-DTH-CLM.
 10567     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
 10568     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
 10569                                      WS-CR-DTH-PAY-DT-N.
 10570
 10571     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
 10572     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
 10573     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
 10574     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
 10575     IF CR-DTH-PAY-CD NOT = 'F'
 10576         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
 10577     INSPECT CR-DTH-PAY-CD
 10578         CONVERTING '12349' TO 'PFSXV'.
 10579     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
 10580
 10581     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
 10582         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
 10583       AND
 10584       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
 10585       OR
 10586        DTE-CLIENT = 'ACC' OR 'FDL')
 10587        NEXT SENTENCE
 10588     ELSE
 10589     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
 10590         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
 10591             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
 10592             MOVE '7'            TO CR-LF-CURRENT-STATUS
 10593             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
 10594                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
 10595
 10596     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10597     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10598     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 204
* ECS010.cbl
 10599     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
 10600         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
 10601     ELSE
 10602         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
 10603     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
 10604
 10605     IF NOT CR-POLICY-IS-REIN-ONLY
 10606         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
 10607
 10608 0720-CANCEL-AH-COVERAGE.
 10609
 10610     IF CR-AHTYP = ZEROS  OR
 10611        NOT CR-AH-POLICY-IS-ACTIVE
 10612         GO TO 0740-DEATH-CLAIM-VOID.
 10613
 10614     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
 10615     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
 10616     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
 10617                                           WS-CR-AH-CANC-DT-N.
 10618     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
 10619                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
 10620
 10621     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
 10622     MOVE CR-AH-TERM                    TO TRD-AHTRM.
 10623     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
 10624     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
 10625     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
 10626     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
 10627     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
 10628     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10629
 10630 0740-DEATH-CLAIM-VOID.
 10631
 10632     IF CR-DTHAMT = ZERO  AND
 10633        PC-CLAIM-PAYMENT NEGATIVE
 10634         NEXT SENTENCE
 10635     ELSE
 10636         GO TO 0780-END-CLAIMS-PROCESSING.
 10637
 10638     MOVE '*'                           TO DEATH-VOID-FLAG.
 10639
 10640     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
 10641                                        WS-CR-LF-CLAIM-EXIT-DATE-N
 10642                                           CR-NUM-DTH-CLM
 10643                                           CR-DTH-RPT-DT
 10644                                           CR-DTH-PAY-DT
 10645                                           WS-CR-DTH-PAY-DT-N
 10646*                                          CR-DTHAMT-YTD
 10647*                                          CR-DTHAMT-LAST
 10648                                           CR-DTH-AGE.
 10649     MOVE ' '                           TO CR-DTH-PAY-CD.
 10650
 10651     IF CR-LF-DEATH-CLAIM-APPLIED
 10652         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
 10653         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
 10654     ELSE
 10655         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
 10656         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 205
* ECS010.cbl
 10657
 10658     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
 10659     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10660
 10661     IF CR-AH-DEATH-CLAIM-APPLIED
 10662         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10663         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10664         MOVE ZEROS                     TO CR-AH-CANC-DT
 10665                                           WS-CR-AH-CANC-DT-N
 10666                                           CR-AH-CANCEL-EXIT-DATE
 10667                                       WS-CR-AH-CANCEL-EXIT-DATE-N
 10668         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
 10669         MOVE CR-AH-TERM                TO TRD-AHTRM
 10670         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
 10671         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
 10672
 10673     GO TO 0780-END-CLAIMS-PROCESSING.
 10674
 10675******************************************************************
 10676***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
 10677******************************************************************
 10678
 10679 0750-PROCESS-DISABILITY-CLAIM.
 10680
 10681     ADD +1                       TO W-AH-CLAIMS.
 10682
 10683     MOVE INCURRED-DATE           TO CR-DIS-DT
 10684                                     WS-CR-DIS-DT-N.
 10685
 10686     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10687
 10688     IF REIN-AH-CLM-MONTHS = +1
 10689         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10690     ELSE
 10691       IF REIN-AH-CLM-MONTHS = +2
 10692           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10693       ELSE
 10694         IF REIN-AH-CLM-MONTHS = +3
 10695             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10696         ELSE
 10697           IF REIN-AH-CLM-MONTHS = +4
 10698               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10699           ELSE
 10700               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10701
 10702     IF PC-CHARGEBLE-EXPENSE  OR
 10703        PC-NON-CHARGEBLE-EXPENSE
 10704         IF CR-AHTYP = '00'
 10705             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10706             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10707                     8499-A-H-LOOKUP-X.
 10708
 10709     IF PC-CHARGEBLE-EXPENSE  OR
 10710        PC-NON-CHARGEBLE-EXPENSE
 10711         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10712         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10713         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10714         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 206
* ECS010.cbl
 10715         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10716         GO TO 0780-END-CLAIMS-PROCESSING.
 10717
 10718     ADD +1                       TO CR-NUM-DIS-CLM.
 10719
 10720     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10721     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10722                                      WS-CR-DIS-PAY-DT-N.
 10723     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10724                                      WS-CR-DIS-PTO-DT-N.
 10725
 10726     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10727     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10728     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10729
 10730     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10731     IF CR-DIS-PAY-CD NOT = 'S'
 10732         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10733     INSPECT CR-DIS-PAY-CD
 10734         CONVERTING '12349' TO 'PFSXV'.
 10735     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10736
 10737     IF PC-LUMP-SUM-PAYMENT
 10738         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10739           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10740           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10741           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10742                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10743
 10744     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10745     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10746     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10747     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10748     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10749
 10750     IF NOT CR-POLICY-IS-REIN-ONLY
 10751         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10752
 10753     IF NOT PC-LUMP-SUM-PAYMENT
 10754         GO TO 0780-END-CLAIMS-PROCESSING.
 10755
 10756 0770-CANCEL-LF-COVERAGE.
 10757
 10758     IF CR-LFTYP = ZEROS  OR
 10759        NOT CR-LF-POLICY-IS-ACTIVE
 10760         GO TO 0780-END-CLAIMS-PROCESSING.
 10761
 10762     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10763     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10764     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10765                                           WS-CR-LF-CANC-DT-N.
 10766     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10767                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10768
 10769     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10770     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10771     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10772     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 207
* ECS010.cbl
 10773     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10774     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10775     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10776     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10777
 10778 0780-END-CLAIMS-PROCESSING.
 10779
 10780     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10781         MOVE DTO-MO               TO TRD-LFACTMO
 10782         MOVE DTO-DA               TO TRD-LFACTDA
 10783         MOVE DTO-YR               TO TRD-LFACTYR
 10784         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10785     ELSE
 10786         MOVE PAY-MO               TO TRD-AHACTMO
 10787         MOVE PAY-DA               TO TRD-AHACTDA
 10788         MOVE PAY-YR               TO TRD-AHACTYR
 10789         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10790
 10791     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10792
 10793     IF NOT CR-POLICY-IS-REIN-ONLY
 10794         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10795         ADD +1                    TO BC-G-CLM.
 10796
 10797     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10798
 10799     IF DEATH-CLAIM-VOIDED
 10800         MOVE ZEROS                TO CR-DTH-DT
 10801                                      WS-CR-DTH-DT-N.
 10802     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10803
 10804     MOVE '*'                      TO TRANSACTION-FLAG.
 10805     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10806
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 208
* ECS010.cbl
 10808 0790-TABLE-DISAB-PERIODS.
 10809
 10810     MOVE +1                       TO SUB14.
 10811     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10812
 10813     MOVE +1                       TO SUB14.
 10814
 10815**************************************************************
 10816**                                                          **
 10817**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10818**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10819**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10820**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10821**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10822**                                                          **
 10823**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10824**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10825**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10826**                                                          **
 10827**************************************************************
 10828
 10829 0791-TABLE-AH-AMOUNT.
 10830
 10831     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10832         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10833
 10834     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10835         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10836                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10837         IF REIN-IS-RISK-PREMIUM
 10838             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10839             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10840             IF SUB14 = +1
 10841               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10842             ELSE
 10843             IF SUB14 = +2
 10844               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10845             ELSE
 10846             IF SUB14 = +3
 10847               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10848             ELSE
 10849             IF SUB14 = +4
 10850               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10851             ELSE
 10852               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10853
 10854
 10855     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10856         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10857         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10858                                        +  CR-INCUR-DISEXP (SUB14)
 10859         IF PC-CHARGEBLE-EXPENSE  OR
 10860            PC-NON-CHARGEBLE-EXPENSE
 10861             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10862             GO TO 0791-TABLE-AH-EXIT
 10863         ELSE
 10864             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10865             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 209
* ECS010.cbl
 10866
 10867     ADD +1                       TO SUB14.
 10868
 10869     GO TO 0791-TABLE-AH-AMOUNT.
 10870
 10871 0791-TABLE-AH-EXIT.
 10872     EXIT.
 10873
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 210
* ECS010.cbl
 10875**************************************************************
 10876**                                                          **
 10877** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10878** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10879**                                                          **
 10880** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 10881** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 10882** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 10883** OCCURRENCE.                                              **
 10884**************************************************************
 10885 0792-MOVE-TABLE.
 10886
 10887     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 10888                                  WS-CR-DIS-INCUR-DT-N (1).
 10889     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 10890     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 10891
 10892     MOVE +2                   TO SUB14.
 10893     MOVE +3                   TO SUB15.
 10894     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 10895
 10896     MOVE DISABILITY-TBL-MAX   TO SUB14.
 10897
 10898     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10899                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 10900
 10901 0792-MOVE-TABLE-EXIT.
 10902     EXIT.
 10903
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 211
* ECS010.cbl
 10905**************************************************************
 10906**                                                          **
 10907**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 10908** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 10909** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 10910** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 10911** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 10912**************************************************************
 10913
 10914 0794-REVIEW-TABLE.
 10915
 10916     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10917         GO TO 0794-REVIEW-TABLE-EXIT.
 10918
 10919     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 10920         GO TO 0794-REVIEW-TABLE-EXIT.
 10921
 10922     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 10923        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 10924         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 10925         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 10926                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 10927         MOVE SUB14            TO SUB15
 10928         ADD +1                TO SUB15
 10929         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 10930         MOVE +1               TO SUB14
 10931         GO TO 0794-REVIEW-TABLE.
 10932
 10933     ADD +1                    TO SUB14.
 10934
 10935     GO TO 0794-REVIEW-TABLE.
 10936
 10937 0794-REVIEW-TABLE-EXIT.
 10938     EXIT.
 10939
 10940 0794A-BUMP-TBL.
 10941
 10942     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 10943         GO TO 0794A-BUMP-TBL-EXIT.
 10944
 10945     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 10946                             CR-DISAB-DETAIL-DATA (SUB14).
 10947     MOVE WS-CR-DIS-INCUR-DT-N (SUB15)
 10948                                 TO WS-CR-DIS-INCUR-DT-N (SUB14)
 10949
 10950     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 10951                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 10952                                  CR-INCUR-DISAMT (SUB15)
 10953                                  CR-INCUR-DISEXP (SUB15).
 10954
 10955     ADD +1                    TO SUB14
 10956                                  SUB15.
 10957     GO TO 0794A-BUMP-TBL.
 10958
 10959 0794A-BUMP-TBL-EXIT.
 10960     EXIT.
 10961
 10962 0795-DCC-NSP-LF.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 212
* ECS010.cbl
 10963
 10964     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 10965     MOVE 'L'                        TO DC-OPTION-CODE.
 10966     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10967     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 10968     MOVE SPACES                     TO CP-ACCT-FLD-5.
 10969     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 10970     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 10971     MOVE CR-APR                     TO CP-LOAN-APR.
 10972     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 10973     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 10974     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 10975     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 10976
 10977     MOVE '3'                        TO CP-PROCESS-TYPE.
 10978     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 10979     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 10980
 10981     IF CR-LFTYP = ZERO
 10982         GO TO 0795-EXIT
 10983     END-IF
 10984
 10985     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 10986         GO TO 0795-EXIT
 10987     END-IF
 10988     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 10989     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 10990     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 10991     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 10992                                        CP-RATING-BENEFIT-AMT.
 10993     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 10994     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 10995     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 10996     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 10997     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 10998     MOVE CR-STATE                   TO CP-STATE.
 10999     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 11000
 11001     IF CP-STATE-STD-ABBRV = 'OR'
 11002         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 11003
 11004     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 11005
 11006     IF CP-ERROR-RATE-NOT-FOUND  OR
 11007        CP-ERROR-RATE-IS-ZERO
 11008         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 11009                                     TO WS-ABEND-MESSAGE
 11010         MOVE 0302                   TO WS-ABEND-CODE
 11011         DISPLAY '******************************'
 11012         DISPLAY '***** ERROR LOCATION 018 *****'
 11013         DISPLAY '******************************'
 11014         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 11015         GO TO ABEND-PGM.
 11016
 11017     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 11018
 11019*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 11020*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 213
* ECS010.cbl
 11021
 11022     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 11023                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 11024
 11025     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 11026
 11027 0795-exit.
 11028     exit.
 11029
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 214
* ECS010.cbl
 11031******************************************************************
 11032***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 11033******************************************************************
 11034
 11035 0800-PROCESS-RESERVES.
 11036
 11037     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 11038       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 11039           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 11040
 11041     if (dte-client = 'AHL')
 11042        and (PC-AH-CLAIM OR PC-OB-AH-CLAIM)
 11043        and (cr-ahtyp (1:1) = 'M')
 11044        and ((pc-future-reserve-amt > zeros)
 11045            or (pc-ptc-reserve-amt > zeros))
 11046        compute pc-ibnr-reserve-amt =
 11047           (pc-future-reserve-amt + pc-ptc-reserve-amt) * .205
 11048        display ' using 205 of ptc and future ' cr-cert-no
 11049     end-if
 11050
 11051     if (dte-client = 'AHL')
 11052        and (PC-LF-CLAIM OR PC-OB-LF-CLAIM)
 11053        and (cr-lftyp (1:1) = 'M')
 11054        and (pc-ptc-reserve-amt > zeros)
 11055        compute pc-ibnr-reserve-amt = pc-ptc-reserve-amt * .217
 11056        display ' using 217 of ptc ' cr-cert-no
 11057     end-if
 11058
 11059     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 11060
 11061     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 11062     MOVE ' '                     TO  DC-OPTION-CODE.
 11063     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11064     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 11065
 11066     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 11067     MOVE ' '                     TO  DC-OPTION-CODE.
 11068     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11069     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 11070
 11071     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 11072     MOVE ' '                     TO  DC-OPTION-CODE.
 11073     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11074     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 11075
 11076     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11077
 11078     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 11079         ADD +1                     TO W-LF-RESERVES
 11080         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 11081         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 11082         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 11083         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 11084         MOVE INCURRED-DATE         TO CR-DTH-DT
 11085                                       WS-CR-DTH-DT-N
 11086         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 11087
 11088     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 215
* ECS010.cbl
 11089         ADD +1                     TO W-AH-RESERVES
 11090         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 11091         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 11092         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 11093         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 11094         MOVE INCURRED-DATE         TO CR-DIS-DT
 11095                                       WS-CR-DIS-DT-N
 11096         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 11097
 11098     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 11099     MOVE 'IBNR'                    TO TRD-IBNRX.
 11100     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 11101     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 11102     COMPUTE TRD-FUTRSV EQUAL
 11103            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 11104     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 11105     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 11106
 11107 0820-END-RESERVE-PROCESSING.
 11108
 11109     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11110
 11111     IF NOT CR-POLICY-IS-REIN-ONLY
 11112         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 11113                                            2499-BLD-RESERVE-X
 11114         ADD +1 TO BC-G-CRS.
 11115
 11116     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 11117
 11118     MOVE '*'                    TO TRANSACTION-FLAG.
 11119     GO TO 0300-READ-PENDING-TRANSACTIONS.
 11120
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 216
* ECS010.cbl
 11122******************************************************************
 11123***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 11124******************************************************************
 11125
 11126 0900-PROCESS-CERT-CHANGES.
 11127
 11128     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11129
 11130     IF CC-AGE NOT NUMERIC  OR
 11131        CC-AGE = CR-AGE
 11132         MOVE ZEROS TO CC-AGE.
 11133
 11134     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 11135        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 11136         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 11137
 11138     IF CC-INSURED-SEX NOT = 'M'  AND
 11139        CC-INSURED-SEX NOT = 'F'
 11140         MOVE SPACES TO CC-INSURED-SEX.
 11141
 11142     IF CC-LOAN-APR NOT NUMERIC  OR
 11143        CC-LOAN-APR = CR-APR
 11144         MOVE ZEROS TO CC-LOAN-APR.
 11145
 11146     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 11147        CC-PAY-FREQUENCY = CR-PMT-FREQ
 11148         MOVE ZEROS TO CC-PAY-FREQUENCY.
 11149
 11150     IF CC-IND-GRP-TYPE NOT = '1'  AND
 11151        CC-IND-GRP-TYPE NOT = '2'
 11152         MOVE SPACES TO CC-IND-GRP-TYPE.
 11153
 11154     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
 11155****    OR CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 11156         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 11157
 11158     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 11159        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 11160         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 11161
 11162     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 11163        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 11164        CR-LFTYP = ZEROS
 11165         MOVE ZEROS TO CC-LF-ORIG-TERM.
 11166
 11167     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 11168        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 11169        CR-AHTYP = ZEROS
 11170         MOVE ZEROS TO CC-AH-ORIG-TERM.
 11171
 11172     IF CR-BILLED NOT NUMERIC
 11173         MOVE ZEROS TO CR-BILLED.
 11174
 11175     IF CR-LIVES NOT NUMERIC
 11176         MOVE ZEROS TO CR-LIVES.
 11177
 11178     IF CC-LIVES NOT NUMERIC  OR
 11179        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 217
* ECS010.cbl
 11180         MOVE ZEROS TO CC-LIVES.
 11181
 11182     IF CC-BILLED NOT NUMERIC  OR
 11183        CC-BILLED = CR-BILLED
 11184         MOVE ZEROS TO CC-BILLED.
 11185
 11186     IF CC-INSURED-LAST-NAME NOT = SPACES
 11187         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 11188     IF CC-INSURED-FIRST-NAME NOT = SPACES
 11189         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 11190     IF CC-INSURED-INITIAL2 NOT = SPACES
 11191         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 11192     IF CC-JT-LAST-NAME NOT = SPACES
 11193         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 11194     IF CC-JT-FIRST-NAME NOT = SPACES
 11195         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 11196     IF CC-JT-INITIAL NOT = SPACES
 11197         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 11198
 11199     IF CC-AGE NOT = ZEROS
 11200         MOVE CC-AGE                 TO CR-AGE
 11201                                        DET-AGE
 11202     ELSE
 11203         MOVE ZEROS                  TO DET-AGE.
 11204
 11205     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 11206         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 11207                                        DET-JT-AGE
 11208     ELSE
 11209         MOVE ZEROS                  TO DET-JT-AGE.
 11210
 11211     IF CC-INSURED-SEX NOT = SPACES
 11212         MOVE CC-INSURED-SEX         TO CR-SEX
 11213                                        DET-SEX
 11214     ELSE
 11215         MOVE SPACE                  TO DET-SEX.
 11216
 11217     IF CC-MEMBER-NO NOT = SPACES
 11218         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 11219                                        DET-PR-MEM
 11220     ELSE
 11221         MOVE SPACES                 TO DET-PR-MEM.
 11222
 11223     IF CC-SOC-SEC-NO NOT = SPACES
 11224         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 11225                                        DET-PR-SS
 11226     ELSE
 11227         MOVE SPACES                 TO DET-PR-SS.
 11228
 11229     IF CC-LOAN-APR NOT = ZEROS
 11230         MOVE CC-LOAN-APR            TO CR-APR
 11231                                        DET-PR-APR
 11232     ELSE
 11233         MOVE ZEROS                  TO DET-PR-APR.
 11234
 11235     IF CC-AGE NOT = ZERO  OR
 11236        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 11237        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 218
* ECS010.cbl
 11238        CC-MEMBER-NO NOT = SPACES  OR
 11239        CC-SOC-SEC-NO NOT = SPACES  OR
 11240        CC-LOAN-APR NOT = ZERO
 11241         MOVE DET-PR-UREC            TO TR-DTL2
 11242         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11243         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11244
 11245     IF CC-LF-ORIG-TERM NOT = ZEROS
 11246         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 11247         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 11248                                        DET-N-LF-TERM
 11249     ELSE
 11250         MOVE ZEROS                  TO DET-O-LF-TERM
 11251                                        DET-N-LF-TERM.
 11252
 11253     IF CC-AH-ORIG-TERM NOT = ZEROS
 11254         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 11255         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 11256                                        DET-N-AH-TERM
 11257     ELSE
 11258         MOVE ZEROS                  TO DET-O-AH-TERM
 11259                                        DET-N-AH-TERM.
 11260
 11261     IF CC-LIVES NOT = ZEROS
 11262         MOVE CR-LIVES               TO DET-O-LIVES
 11263         MOVE CC-LIVES               TO CR-LIVES
 11264                                        DET-N-LIVES
 11265     ELSE
 11266         MOVE ZEROS                  TO DET-O-LIVES
 11267                                        DET-N-LIVES.
 11268
 11269     IF CC-BILLED NOT  = ZEROES
 11270         MOVE CC-BILLED              TO CR-BILLED.
 11271
 11272     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 11273        CC-AH-ORIG-TERM NOT = ZERO  OR
 11274        CC-LIVES NOT = ZERO
 11275         MOVE DET-PR-UREC-2          TO TR-DTL2
 11276         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11277         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11278
 11279     IF CC-IND-GRP-TYPE NOT = SPACES
 11280         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 11281                                        DET-IND-GRP
 11282     ELSE
 11283         MOVE SPACE                  TO DET-IND-GRP.
 11284
 11285     IF CC-PAY-FREQUENCY NOT = ZEROS
 11286         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 11287                                        DET-PMT-FREQ
 11288     ELSE
 11289         MOVE ZEROS                  TO DET-PMT-FREQ.
 11290
 11291     IF CC-POLICY-FORM-NO NOT = SPACES
 11292         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 11293                                        DET-POL-FORM
 11294     ELSE
 11295         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 219
* ECS010.cbl
 11296
 11297     IF CC-LOAN-OFFICER NOT = SPACES
 11298         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 11299                                        DET-LOAN-OFFICER
 11300     ELSE
 11301         MOVE SPACES                 TO DET-LOAN-OFFICER.
 11302
 11303     IF CC-USER-FIELD NOT = SPACES
 11304         MOVE CC-USER-FIELD          TO CR-USER-CODE
 11305                                        DET-USER-CODE
 11306     ELSE
 11307         MOVE SPACE                  TO DET-USER-CODE.
 11308
 11309     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 11310        CC-PAY-FREQUENCY NOT = ZEROS  OR
 11311        CC-POLICY-FORM-NO NOT = SPACES  OR
 11312        CC-LOAN-OFFICER NOT = SPACES  OR
 11313        CC-USER-FIELD NOT = SPACES
 11314         MOVE DET-PR-UREC-3          TO TR-DTL2
 11315         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11316         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11317
 11318**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 11319****     MOVE CC-CLAIM-DEDUCT-WITHHELD
 11320****                                 TO CR-CLAIM-DEDUCT-WITHHELD
 11321****                                    DET-CLM-DEDUCT
 11322**** ELSE
 11323****     MOVE ZEROS                  TO DET-CLM-DEDUCT.
 11324
 11325     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11326         MOVE CC-CANCEL-DEDUCT-WITHHELD
 11327                                     TO CR-CANCEL-DEDUCT-WITHHELD
 11328                                        DET-CAN-DEDUCT
 11329     ELSE
 11330         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 11331
 11332**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 11333     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11334         MOVE DET-PR-UREC-4          TO TR-DTL2
 11335         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11336         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11337
 11338     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 11339         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 11340
 11341     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 11342         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 11343
 11344     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 11345         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 11346
 11347     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 11348         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 11349
 11350     IF CC-LF-BENEFIT-CD NOT = SPACES
 11351         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 11352                                     DET-LF-BEN-CD
 11353     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 220
* ECS010.cbl
 11354         MOVE SPACES             TO DET-LF-BEN-CD.
 11355
 11356     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 11357         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 11358                                     DET-LF-PREM
 11359     ELSE
 11360         MOVE ZEROS              TO DET-LF-PREM.
 11361
 11362     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 11363         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 11364                                     DET-LF-BEN
 11365     ELSE
 11366         MOVE ZEROS              TO DET-LF-BEN.
 11367
 11368     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 11369        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 11370        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 11371         MOVE DET-PR-UREC-5          TO TR-DTL2
 11372         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11373         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11374
 11375     IF CC-AH-BENEFIT-CD NOT = SPACES
 11376         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 11377                                     DET-AH-BEN-CD
 11378     ELSE
 11379         MOVE SPACES             TO DET-AH-BEN-CD.
 11380
 11381     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 11382         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 11383                                     DET-AH-PREM
 11384     ELSE
 11385         MOVE ZEROS              TO DET-AH-PREM.
 11386
 11387     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 11388         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 11389                                     DET-AH-BEN
 11390     ELSE
 11391         MOVE ZEROS              TO DET-AH-BEN.
 11392
 11393     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 11394        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 11395        CC-AH-BENEFIT-AMT NOT = ZEROS
 11396         MOVE DET-PR-UREC-6          TO TR-DTL2
 11397         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11398         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11399
 11400 0910-END-CHANGE-PROCESSING.
 11401
 11402     IF CR-LNAME = ALL '*'
 11403         MOVE SPACES                 TO CR-LNAME.
 11404     IF CR-FNAME = ALL '*'
 11405         MOVE SPACES                 TO CR-FNAME.
 11406     IF CR-INIT = '*'
 11407         MOVE SPACES                 TO CR-INIT.
 11408     IF CR-SOC-SEC = ALL '*'
 11409         MOVE SPACES                 TO CR-SOC-SEC.
 11410     IF CR-JT-LNAME = ALL '*'
 11411         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 221
* ECS010.cbl
 11412     IF CR-JT-FNAME = ALL '*'
 11413         MOVE SPACES                 TO CR-JT-FNAME.
 11414     IF CR-JT-INIT = '*'
 11415         MOVE SPACES                 TO CR-JT-INIT.
 11416     IF CR-POLICY-FORM-NO = ALL '*'
 11417         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 11418     IF CR-MEMBER-NO = ALL '*'
 11419         MOVE SPACES                 TO CR-MEMBER-NO.
 11420     IF CR-LOAN-OFFICER = ALL '*'
 11421         MOVE SPACES                 TO CR-LOAN-OFFICER.
 11422     IF CR-USER-CODE = ALL '*'
 11423         MOVE SPACES                 TO CR-USER-CODE.
 11424
 11425     ADD +1 TO BC-G-CTN.
 11426     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 222
* ECS010.cbl
 11428 0920-GET-BANK-FEES.
 11429
 11430     IF CR-CERT-NO = '0008771354 '
 11431        DISPLAY ' MADE IT TO 0920 '
 11432     END-IF
 11433
 11434     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 11435     MOVE CR-CARRIER             TO AG-CARRIER
 11436     MOVE CR-GROUPING            TO AG-GROUPING
 11437     MOVE CR-BANK-NO             TO AG-BANK
 11438     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 11439     MOVE 'B'                    TO AG-TYPE
 11440
 11441*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 11442*       PERFORM 0925-BUILD-WORK-BNK-COMM
 11443*                                THRU 0925-EXIT
 11444*       GO TO 0920-EXIT
 11445*    END-IF
 11446
 11447     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 11448
 11449     IF CR-CERT-NO = '0008771354 '
 11450        DISPLAY ' MADE IT AFTER START '
 11451     END-IF
 11452
 11453     .
 11454 0920-READ-ERAGTC.
 11455
 11456     IF ERAGTC-FILE-STATUS = '00'
 11457        READ ERAGTC NEXT RECORD
 11458     IF CR-CERT-NO = '0008771354 '
 11459        DISPLAY ' MADE ONE READ '
 11460     END-IF
 11461
 11462        IF ERAGTC-FILE-STATUS = '00'
 11463           IF (CR-CARRIER         = AG-CARRIER)
 11464              AND (CR-GROUPING    = AG-GROUPING)
 11465              AND (CR-BANK-NO     = AG-BANK)
 11466              IF WS-CR-BIN-DATE  = AG-EXP-DT
 11467                 GO TO 0920-READ-ERAGTC
 11468              ELSE
 11469                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 11470                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 11471                    PERFORM 0925-BUILD-WORK-BNK-COMM
 11472                                 THRU 0925-EXIT
 11473                    MOVE AG-CONTROL-PRIMARY
 11474                                 TO WS-PREV-BANK-COMM-KEY
 11475                    GO TO 0920-EXIT
 11476                 END-IF
 11477              END-IF
 11478           END-IF
 11479        END-IF
 11480     END-IF
 11481
 11482     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 11483*    PERFORM 0925-BUILD-WORK-BNK-COMM
 11484
 11485     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 223
* ECS010.cbl
 11486        AND (PB-I-BANK-FEE NOT = ZEROS)
 11487        MOVE CR-BANK-NO          TO WS-BNK-AGT (1)
 11488        MOVE 'B'                 TO WS-BNK-TYPE (1)
 11489        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (1)
 11490        MOVE ' '                 TO WS-BNK-RECALC (1)
 11491        MOVE +2                  TO IB
 11492     END-IF
 11493
 11494     .
 11495 0920-EXIT.
 11496     EXIT.
 11497
 11498 0925-BUILD-WORK-BNK-COMM.
 11499
 11500     IF CR-CERT-NO = '0008771354 '
 11501        DISPLAY ' MADE IT TO 0925 '
 11502     END-IF
 11503
 11504     MOVE +1                     TO IA IB
 11505
 11506*    IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 11507*       AND (PB-I-BANK-FEE NOT = ZEROS)
 11508*       MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 11509*       MOVE 'B'                 TO WS-BNK-TYPE (IB)
 11510*       MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 11511*       MOVE ' '                 TO WS-BNK-RECALC (IB)
 11512*       ADD +1                   TO IB
 11513*    END-IF
 11514*    .
 11515*0925-BUILD-CONTINUE.
 11516
 11517     IF CR-CERT-NO = '00087735841'
 11518        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 11519        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 11520        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 11521     END-IF
 11522
 11523*    PERFORM VARYING IA FROM +2 BY +1 UNTIL
 11524     PERFORM VARYING IA FROM +1 BY +1 UNTIL
 11525        (IA > +10)
 11526        OR (IB > +10)
 11527        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 11528           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 11529           MOVE 'B'              TO WS-BNK-TYPE (IB)
 11530*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 11531           IF AG-SPP-FEES (IA) NOT NUMERIC
 11532              MOVE ZEROS         TO AG-SPP-FEES (IA)
 11533           END-IF
 11534           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 11535           MOVE AG-RECALC-LV-INDIC (IA)
 11536                                 TO WS-BNK-RECALC (IB)
 11537        ELSE
 11538           MOVE SPACES           TO WS-BNK-AGT (IB)
 11539                                    WS-BNK-TYPE (IB)
 11540                                    WS-BNK-RECALC (IB)
 11541           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 11542        END-IF
 11543        ADD +1                   TO IB
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 224
* ECS010.cbl
 11544     END-PERFORM
 11545
 11546     .
 11547 0925-EXIT.
 11548     EXIT.
 11549
 11550 0930-BUILD-CERT-TRLR.
 11551
 11552     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 11553     MOVE 'CS'                   TO CS-RECORD-ID
 11554     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 11555     MOVE CR-CARRIER             TO CS-CARRIER
 11556     MOVE CR-GROUPING            TO CS-GROUPING
 11557     MOVE CR-STATE               TO CS-STATE
 11558     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 11559     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 11560     MOVE CR-CERT-NO             TO CS-CERT-NO
 11561     MOVE 'A'                    TO CS-TRAILER-TYPE
 11562
 11563     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 11564
 11565     IF CS-AGT (1) NOT = SPACES AND ZEROS
 11566        WRITE CERTIFICATE-TRAILERS
 11567        IF ELCRTT-FILE-STATUS = '00'
 11568           CONTINUE
 11569        ELSE
 11570           IF ELCRTT-FILE-STATUS = '22'
 11571              READ ELCRTT
 11572              IF ELCRTT-FILE-STATUS = '00'
 11573                 MOVE WS-BANK-COMMISSIONS
 11574                                 TO CS-BANK-COMMISSION-AREA
 11575                 REWRITE CERTIFICATE-TRAILERS
 11576                 IF ELCRTT-FILE-STATUS NOT = '00'
 11577                    DISPLAY ' BAD REWRITE ELCRTT '
 11578                                 ELCRTT-FILE-STATUS
 11579                    PERFORM ABEND-PGM
 11580                 END-IF
 11581              ELSE
 11582                 DISPLAY ' BAD READ    ELCRTT '
 11583                                  ELCRTT-FILE-STATUS
 11584                 PERFORM ABEND-PGM
 11585              END-IF
 11586           ELSE
 11587              DISPLAY ' BAD WRITE ELCRTT '
 11588                                 ELCRTT-FILE-STATUS
 11589              PERFORM ABEND-PGM
 11590           END-IF
 11591        END-IF
 11592     END-IF
 11593
 11594     .
 11595 0930-EXIT.
 11596     EXIT.
 11597
 11598 0950-BUILD-CERT-C-TRLR.
 11599
 11600     MOVE SPACES                 TO CERTIFICATE-TRAILERS.
 11601     MOVE 'CS'                   TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 225
* ECS010.cbl
 11602     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD.
 11603     MOVE CR-CARRIER             TO CS-CARRIER.
 11604     MOVE CR-GROUPING            TO CS-GROUPING.
 11605     MOVE CR-STATE               TO CS-STATE.
 11606     MOVE CR-ACCOUNT             TO CS-ACCOUNT.
 11607     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT.
 11608     MOVE CR-CERT-NO             TO CS-CERT-NO.
 11609     MOVE 'C'                    TO CS-TRAILER-TYPE.
 11610
 11611     MOVE PB-I-VIN               TO CS-VIN-NUMBER.
 11612
 11613     WRITE CERTIFICATE-TRAILERS.
 11614     IF ELCRTT-FILE-STATUS = '00'
 11615        CONTINUE
 11616     ELSE
 11617        IF ELCRTT-FILE-STATUS = '22'
 11618           READ ELCRTT
 11619           IF ELCRTT-FILE-STATUS = '00'
 11620              MOVE PB-I-VIN      TO CS-VIN-NUMBER
 11621              REWRITE CERTIFICATE-TRAILERS
 11622              IF ELCRTT-FILE-STATUS NOT = '00'
 11623                 DISPLAY ' BAD REWRITE ELCRTT '
 11624                              ELCRTT-FILE-STATUS
 11625                 PERFORM ABEND-PGM
 11626              END-IF
 11627           ELSE
 11628              DISPLAY ' BAD READ    ELCRTT '
 11629                               ELCRTT-FILE-STATUS
 11630              PERFORM ABEND-PGM
 11631           END-IF
 11632        ELSE
 11633           DISPLAY ' BAD WRITE ELCRTT '
 11634                              ELCRTT-FILE-STATUS
 11635           PERFORM ABEND-PGM
 11636        END-IF
 11637     END-IF.
 11638
 11639     .
 11640 0950-EXIT.
 11641     EXIT.
 11642
 11643
 11644******************************************************************
 11645***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 11646******************************************************************
 11647
 11648 1000-SET-COMMISSION-STRUCTURE.
 11649
 11650     MOVE +1                     TO IA
 11651                                    IB.
 11652
 11653 1100-GET-COMMISSION-LEVEL.
 11654
 11655     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 11656
 11657     IF WK-AGT = '0000000000' OR SPACES
 11658         MOVE +0                 TO WK-L-RT
 11659                                    WK-J-RT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 226
* ECS010.cbl
 11660                                    WK-A-RT
 11661         GO TO 1200-SET-COMMISSION-LEVEL.
 11662
 11663 1110-LIFE-COMMISSION.
 11664
 11665     IF CR-LFTYP = ZERO  OR
 11666       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11667         MOVE +0 TO WK-L-RT
 11668                    WK-J-RT
 11669         GO TO 1130-A-H-COMMISSION.
 11670
 11671     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11672         GO TO 1120-JOINT-LIFE-COMMISSION.
 11673
 11674     IF WK-L-RT NUMERIC
 11675        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 11676         MOVE WK-L-RT                TO WS-COMMISSION
 11677         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11678         MOVE WS-COMMISSION          TO WK-L-RT
 11679         GO TO 1130-A-H-COMMISSION.
 11680
 11681     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11682     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11683     MOVE ZEROS                      TO WS-SUB1.
 11684     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11685
 11686     IF WS-SUB1 = ZEROS
 11687         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 11688     ELSE
 11689         MOVE WK-RATE                TO WK-L-RT
 11690         GO TO 1130-A-H-COMMISSION.
 11691
 11692     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11693
 11694     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11695     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11696     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11697     MOVE WK-RATE                    TO WK-L-RT.
 11698
 11699     GO TO 1130-A-H-COMMISSION.
 11700
 11701 1120-JOINT-LIFE-COMMISSION.
 11702
 11703     IF WK-J-RT NUMERIC
 11704        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 11705         MOVE WK-J-RT                TO WS-COMMISSION
 11706         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11707         MOVE WS-COMMISSION          TO WK-J-RT
 11708         GO TO 1130-A-H-COMMISSION.
 11709
 11710     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11711     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11712     MOVE ZEROS                      TO WS-SUB1.
 11713     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11714
 11715     IF WS-SUB1 = ZEROS
 11716         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 11717     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 227
* ECS010.cbl
 11718         MOVE WK-RATE                TO WK-J-RT
 11719         GO TO 1130-A-H-COMMISSION.
 11720
 11721     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11722
 11723     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11724     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11725     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11726     MOVE WK-RATE                    TO WK-J-RT.
 11727
 11728 1130-A-H-COMMISSION.
 11729
 11730     IF CR-AHTYP = ZERO  OR
 11731       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11732         MOVE +0 TO WK-A-RT
 11733         GO TO 1200-SET-COMMISSION-LEVEL.
 11734
 11735     IF WK-A-RT NUMERIC
 11736        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 11737         MOVE WK-A-RT                TO WS-COMMISSION
 11738         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11739         MOVE WS-COMMISSION          TO WK-A-RT
 11740         GO TO 1200-SET-COMMISSION-LEVEL.
 11741
 11742     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 11743     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 11744     MOVE ZEROS                      TO WS-SUB1.
 11745     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11746
 11747     IF WS-SUB1 = ZEROS
 11748         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 11749     ELSE
 11750         MOVE WK-RATE                TO WK-A-RT
 11751         GO TO 1200-SET-COMMISSION-LEVEL.
 11752
 11753     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11754
 11755     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 11756     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 11757     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11758     MOVE WK-RATE                    TO WK-A-RT.
 11759
 11760 1200-SET-COMMISSION-LEVEL.
 11761
 11762     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11763     IF WK-AGT = '0000000000' OR SPACES
 11764         MOVE SPACE                   TO WK-N-TYPE (IA)
 11765     ELSE
 11766         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11767
 11768     IF CR-LFTYP = ZERO
 11769         MOVE +0                      TO WK-L-RT1  (IA)
 11770     ELSE
 11771         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11772             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11773         ELSE
 11774             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11775
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 228
* ECS010.cbl
 11776     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11777
 11778     IF RC-COMM-FLG = 'X'
 11779        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11780*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11781*             AND (IA = +5))
 11782            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11783            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11784            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11785            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11786
 11787     IF IA LESS THAN +10
 11788         ADD +1 TO IA
 11789         GO TO 1100-GET-COMMISSION-LEVEL.
 11790
 11791     GO TO 1499-SET-COMM-X.
 11792
 11793 1300-READ-ERCTBL-FILE.
 11794
 11795     IF CTBL-SEARCH = LAST-CTBL
 11796         GO TO 1399-READ-ERCTBL-X.
 11797
 11798     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11799
 11800     IF COMM-OPEN-SW = ' '
 11801         MOVE 'X'                        TO COMM-OPEN-SW
 11802         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11803         OPEN INPUT ERCTBL
 11804         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11805             NEXT SENTENCE
 11806            ELSE
 11807             MOVE '41'                   TO ABEND-CODE-1
 11808             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11809             DISPLAY '******************************'
 11810             DISPLAY '***** ERROR LOCATION 012 *****'
 11811             DISPLAY '******************************'
 11812             DISPLAY '******************************'
 11813             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11814             GO TO ABEND-PGM.
 11815
 11816     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11817                                            LAST-CTBL.
 11818     READ ERCTBL.
 11819
 11820     IF ERCTBL-FILE-STATUS = '23'
 11821         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 11822                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11823                 ' CTBL: ' CTBL-SEARCH
 11824         MOVE '*'                TO CTBL-ERROR-SWITCH
 11825         MOVE '44'               TO ABEND-CODE-1
 11826         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11827         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11828         DISPLAY '******************************'
 11829         DISPLAY '***** ERROR LOCATION 013 *****'
 11830         DISPLAY '******************************'
 11831         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11832*        IF DTE-CLIENT NOT = 'NCL'
 11833         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 229
* ECS010.cbl
 11834           AND 'AHL'
 11835             GO TO ABEND-PGM
 11836         ELSE
 11837             NEXT SENTENCE
 11838     ELSE
 11839         IF ERCTBL-FILE-STATUS NOT = '00'
 11840             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11841             MOVE '44'               TO ABEND-CODE-1
 11842             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11843             DISPLAY '******************************'
 11844             DISPLAY '***** ERROR LOCATION 014 *****'
 11845             DISPLAY '******************************'
 11846             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11847             GO TO ABEND-PGM.
 11848
 11849     ADD +1                            TO ERCTBL-READS.
 11850
 11851 1399-READ-ERCTBL-X.
 11852     EXIT.
 11853
 11854 1400-GET-COMM-PERCENT.
 11855
 11856     IF CTBL-ERROR
 11857         MOVE ZEROS                      TO WK-RATE
 11858         GO TO 1489-GET-PERCENT-X.
 11859
 11860     MOVE +1 TO IB.
 11861     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11862        (CT-TBF (1) NOT EQUAL +9999999.99)
 11863         ADD +9 TO IB
 11864         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11865            (CT-TBF (2) NOT EQUAL +9999999.99)
 11866             ADD +9 TO IB.
 11867
 11868     IF CR-AGE GREATER CT-AGE (1)
 11869         ADD +3 TO IB
 11870         IF CR-AGE GREATER CT-AGE (2)
 11871             ADD +3 TO IB.
 11872
 11873     IF WS-COMM-TERM GREATER CT-TRM (1)
 11874         ADD +1 TO IB
 11875         IF WS-COMM-TERM GREATER CT-TRM (2)
 11876             ADD +1 TO IB.
 11877
 11878     IF CT-RT (IB) NOT NUMERIC
 11879         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 11880         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 11881         GO TO 1300-READ-ERCTBL-FILE.
 11882
 11883     MOVE CT-RT (IB) TO WK-RATE.
 11884
 11885 1489-GET-PERCENT-X.
 11886     EXIT.
 11887
 11888 1499-SET-COMM-X.
 11889     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 230
* ECS010.cbl
 11891******************************************************************
 11892***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 11893******************************************************************
 11894
 11895 1500-GET-ACCT-LEVEL-LF-COMM.
 11896
 11897     MOVE ZEROS                      TO ACCT-COMM-LF
 11898                                        ACCT-COMM-AH.
 11899
 11900     MOVE +1                         TO IA.
 11901
 11902 1510-ACCT-LEVEL-LOOP.
 11903
 11904     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11905         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 11906             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 11907             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 11908         ELSE
 11909             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 11910                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 11911
 11912     IF IA LESS THAN +10
 11913         ADD +1 TO IA
 11914         GO TO 1510-ACCT-LEVEL-LOOP.
 11915
 11916 1519-ACCT-LF-COMM-X.
 11917     EXIT.
 11918
 11919
 11920 1550-GET-ACCT-LEVEL-AH-COMM.
 11921
 11922     MOVE ZEROS                      TO ACCT-COMM-AH.
 11923
 11924     MOVE +1                         TO IA.
 11925
 11926 1555-ACCT-LEVEL-LOOP.
 11927
 11928     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11929         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 11930             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 11931
 11932     IF IA LESS THAN +10
 11933         ADD +1 TO IA
 11934         GO TO 1555-ACCT-LEVEL-LOOP.
 11935
 11936 1599-ACCT-AH-COMM-X.
 11937     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 231
* ECS010.cbl
 11939******************************************************************
 11940***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 11941******************************************************************
 11942
 11943 1600-RECALC-COMM-EXTR.
 11944
 11945     IF RC-COMM-FLG = 'X'  OR
 11946        (DTE-PGM-OPT = '2'  OR  '3')  OR
 11947        CR-POLICY-IS-DECLINED  OR
 11948        CR-POLICY-IS-VOID
 11949         GO TO 1899-RECALC-COMM-EXTR-X.
 11950
 11951     MOVE 'X'                           TO RC-COMM-FLG.
 11952
 11953     IF CR-ENTRY-DATE = EOM-RUN-DATE
 11954         GO TO 1899-RECALC-COMM-EXTR-X.
 11955
 11956     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 11957
 11958     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11959         GO TO 1899-RECALC-COMM-EXTR-X.
 11960
 11961     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 11962
 11963     PERFORM 1610-CK-DUPLICATE-ENTRIES
 11964         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 11965             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 11966
 11967     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11968         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 11969                                           WK-NEW-RATES
 11970         GO TO 1899-RECALC-COMM-EXTR-X.
 11971
 11972     MOVE +1                            TO SUB8.
 11973     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11974
 11975 1610-CK-DUPLICATE-ENTRIES.
 11976     PERFORM 1620-CK-DUPL-ENTR-NEW
 11977         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 11978             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 11979
 11980 1619-CK-DUPLICATE-ENTRIES-XIT.
 11981     EXIT.
 11982
 11983 1620-CK-DUPL-ENTR-NEW.
 11984     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 11985         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 11986         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 11987         MOVE +0                        TO CR-LCOM-L (SUB11)
 11988                                           CR-LCOM-AH (SUB11)
 11989         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 11990         MOVE 11                        TO SUB12.
 11991
 11992 1629-CK-DUPL-ENTR-NEW-XIT.
 11993     EXIT.
 11994
 11995 1700-REVERSE-OLD-COMM-LOOP.
 11996     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 232
* ECS010.cbl
 11997     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 11998
 11999     IF SUB8 LESS THAN +10
 12000         ADD +1 TO SUB8
 12001         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 12002
 12003     MOVE 'O' TO RECALC-TYPE.
 12004
 12005     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12006
 12007     GO TO 1800-MOVE-NEW-COMM-RATES.
 12008
 12009 1710-DO-R-C-EXTRACTS.
 12010
 12011     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12012
 12013     PERFORM 1720-CHECK-COMM-LEVELS
 12014         THRU 1729-CHECK-COMM-LEVELS-EXIT
 12015             VARYING SUB13 FROM +1 BY +1
 12016                 UNTIL SUB13 GREATER THAN 10.
 12017
 12018     MOVE '8'                           TO DE-TRANS.
 12019     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 12020*****PERFORM EXTRACT-DATE-RELOAD.
 12021     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 12022     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12023     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 12024     PERFORM EXTRACT-DATE-LOAD.
 12025     MOVE 'R'                           TO DE-REIN.
 12026     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 12027     MOVE +1                            TO SUB1.
 12028     PERFORM 3110-REINSURE-ISSUE-LOOP
 12029         THRU 3119-REINSURE-ISSUE-LOOP-END.
 12030
 12031     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 12032         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 12033                                       2259-END-CANCEL-BUILD
 12034         PERFORM 1720-CHECK-COMM-LEVELS
 12035             THRU 1729-CHECK-COMM-LEVELS-EXIT
 12036                 VARYING SUB13 FROM +1 BY +1
 12037                     UNTIL SUB13 GREATER THAN 10
 12038         MOVE '7'                       TO DE-TRANS
 12039         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 12040*********PERFORM EXTRACT-DATE-RELOAD
 12041         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12042         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 12043         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 12044         PERFORM EXTRACT-DATE-LOAD
 12045         MOVE 'R'                       TO DE-REIN
 12046         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12047         MOVE +1                        TO SUB1
 12048         PERFORM 3210-REINSURE-CANCEL-LOOP
 12049             THRU 3219-REINSURE-CANCEL-LOOP-END.
 12050
 12051 1719-DO-R-C-EXTRACTS-X.
 12052     EXIT.
 12053
 12054 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 233
* ECS010.cbl
 12055
 12056     IF  DE-AGT (SUB13)       =  SPACES  AND
 12057         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 12058         DE-L-PC (SUB13)      =  ZEROS   AND
 12059         DE-A-PC (SUB13)      =  ZEROS
 12060         MOVE '0000000000'        TO  DE-AGT (SUB13).
 12061
 12062 1729-CHECK-COMM-LEVELS-EXIT.
 12063     EXIT.
 12064
 12065 1800-MOVE-NEW-COMM-RATES.
 12066     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 12067     MOVE 'N'                           TO RECALC-TYPE.
 12068     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12069     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 12070                                           CR-COMPENSATION-LEVELS.
 12071     IF DTE-CLIENT = 'DCC'
 12072        IF CR-LF-NSP-PRM NOT = ZEROS
 12073           COMPUTE CR-LF-NSP-PRM ROUNDED =
 12074              (CR-LFPRM + CR-LFPRM-ALT) -
 12075              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12076        END-IF
 12077        IF (CR-AH-NSP-PRM NOT = ZEROS)
 12078           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 12079                                        NOT = 'G' AND 'L')
 12080           COMPUTE CR-AH-NSP-PRM ROUNDED =
 12081           CR-AHPRM -
 12082           (CR-AHPRM * CR-LCOM-AH (1))
 12083        END-IF
 12084     END-IF
 12085     .
 12086
 12087 1899-RECALC-COMM-EXTR-X.
 12088     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 234
* ECS010.cbl
 12090******************************************************************
 12091***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 12092******************************************************************
 12093
 12094 2000-INITIALIZE-DETAIL-EXTRACT.
 12095
 12096     MOVE SPACES                   TO DETAIL-EXTRACT.
 12097
 12098     MOVE 'DE'                     TO DE-RECORD-ID.
 12099     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 12100     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 12101
 12102     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 12103     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 12104
 12105     MOVE CR-NAME                  TO DE-NAME.
 12106     MOVE CR-AGE                   TO DE-AGE.
 12107     MOVE CR-SEX                   TO DE-SEX.
 12108     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 12109
 12110     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 12111     MOVE CR-LF-TERM               TO DE-LF-TERM
 12112     MOVE CR-LOAN-TERM             TO DE-LOAN-TERM.
 12113     MOVE CR-LFAMT                 TO DE-LF-BEN.
 12114     MOVE ZEROS                    TO DE-LF-CNBEN.
 12115     MOVE CR-LFPRM                 TO DE-LF-PRM.
 12116     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 12117     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 12118     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 12119     MOVE ZEROS                    TO DE-LF-RFND.
 12120
 12121     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 12122     MOVE ZEROS                    TO DE-LF-CANC-DTE
 12123                                      DE-LF-CANC-EXIT-DT.
 12124
 12125     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 12126     MOVE CR-AH-TERM               TO DE-AH-TERM.
 12127     MOVE CR-AHAMT                 TO DE-AH-BEN.
 12128     MOVE CR-AHPRM                 TO DE-AH-PRM.
 12129     MOVE ZEROS                    TO DE-AH-RFND.
 12130
 12131     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 12132     MOVE ZEROS                    TO DE-AH-CANC-DTE
 12133                                      DE-AH-CANC-EXIT-DT.
 12134     IF DTE-CLIENT = 'DCC'
 12135        IF CR-ENTRY-STATUS = 'M'
 12136           MOVE CR-MOB-NET-TOT-FEES TO DE-MOB-NET-TOT-FEES
 12137        ELSE
 12138           IF AM-DCC-PRODUCT-CODE = 'DDF'
 12139              MOVE CR-DDF-IU-RATE-UP TO DE-IU-RATE-UP
 12140           END-IF
 12141        END-IF
 12142     END-IF
 12143
 12144     IF DTE-CLIENT = 'DCC'
 12145        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 12146        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 12147     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 235
* ECS010.cbl
 12148        IF (CR-LFTYP NOT = ZERO   AND
 12149           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 12150           (CR-AHTYP NOT = ZERO  AND
 12151           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 12152           MOVE CR-LIVES           TO DE-LIVES
 12153           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 12154                                      DE-CANCEL-CNT-YTD
 12155        END-IF
 12156     END-IF
 12157
 12158     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12159     IF AM-ZIP-PRIME NUMERIC
 12160        MOVE AM-ZIP-PRIME          TO DE-ZIP
 12161      ELSE
 12162        MOVE ZEROS                 TO DE-ZIP.
 12163     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 12164
 12165     MOVE CR-APR                   TO DE-APR.
 12166     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 12167     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 12168     MOVE CR-IND-GRP               TO DE-IG.
 12169     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 12170     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12171
 12172     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 12173     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE
 12174     MOVE CR-CANCEL-REASON         TO DE-CANCEL-REASON
 12175
 12176     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 12177*    MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 12178
 12179     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 12180                                      DE-REI-AHAMT  DE-REI-AHPRM
 12181                                      DE-REI-LFRFND DE-REI-AHRFND
 12182                                      DE-REI-CNAMT.
 12183
 12184     MOVE +1                       TO SUB1.
 12185
 12186* THIS WAS ADDED SO I COULD PASS THE CLP TO ECS017
 12187* FOR DEALER DIRECT OTHERWISE THERE WAS NO WAY TO
 12188* CALC IT IN ECS017.
 12189     IF DTE-CLIENT = 'DCC'
 12190        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 12191           MOVE CR-LF-CLP          TO DE-REI-LFPRM
 12192           IF CR-ACCOUNT = '05500500DD'
 12193              DISPLAY ' LF CLP ' DE-CERT-NO ' ' DE-REI-LFPRM
 12194                ' ' DE-REI-LFRFND
 12195           END-IF
 12196        END-IF
 12197        IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 12198                      OR
 12199           ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 12200            AND (AM-DCC-PRODUCT-CODE = 'DDF'))
 12201           MOVE CR-AH-CLP          TO DE-REI-AHPRM
 12202           MOVE CR-AH-RFND-CLP     TO DE-REI-AHRFND
 12203        END-IF
 12204     END-IF
 12205
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 236
* ECS010.cbl
 12206
 12207     PERFORM EXTRACT-DATE-LOAD.
 12208
 12209     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 12210                                      WS-DE-INCUR-N
 12211                                      WS-DE-PAY-N
 12212                                      WS-DE-PAID-TO-N
 12213                                      WS-DE-ACC-EXP-DTE-N
 12214                                      WS-DE-ACC-EFF-DTE-N
 12215                                      WS-DE-RSV-INCUR-N
 12216                                      WS-DE-RSV-PAYTO-N
 12217                                      WS-DE-ACC-EXP-DTE-RSV-N
 12218                                      WS-DE-ACC-EFF-DTE-RSV-N.
 12219
 12220 2090-GL-CODE-LOOP.
 12221
 12222     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 12223
 12224     IF SUB1 LESS THAN +10
 12225         ADD +1 TO SUB1
 12226         GO TO 2090-GL-CODE-LOOP.
 12227
 12228     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 12229
 12230     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 12231
 12232     IF (DTE-CLIENT = 'DCC')
 12233        AND (CR-AHTYP NOT = SPACES AND ZEROS)
 12234        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 12235        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 12236        AND (RECALC-TYPE = SPACES)
 12237        MOVE +1                  TO IA
 12238*       IF CR-ACCOUNT = '05500500DD'
 12239**      IF CR-CERT-NO = '0008773536 '
 12240*          DISPLAY ' MADE IT TO 2000 '
 12241*          DISPLAY ' CERT AREA  REIN ' DE-REIN ' ' CR-CERT-NO
 12242*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12243*             (IB > +10)
 12244*             IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 12245*                MOVE IB TO DIL-BEN-CODE
 12246*                MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 12247*                MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 12248*                DISPLAY DISPLAY-IBNR-LINE
 12249*             END-IF
 12250*          END-PERFORM
 12251*          DISPLAY ' TRLR AREA  '
 12252*          DISPLAY ' CS CERT NO ' CS-CERT-NO
 12253*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12254*             (IB > +10)
 12255*             IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 12256*                MOVE IB TO DIL-BEN-CODE
 12257*                MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 12258*                MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 12259*                DISPLAY DISPLAY-IBNR-LINE
 12260*             END-IF
 12261*          END-PERFORM
 12262*       END-IF
 12263        PERFORM VARYING IB FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 237
* ECS010.cbl
 12264           IB > +10
 12265           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 12266              CONTINUE
 12267           ELSE
 12268              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 12269                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 12270                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 12271                 COMPUTE DE-A-PC (IB) =
 12272                        WS-BNK-SPP-FEES (IA) / +1000
 12273                 MOVE +0              TO DE-L-PC (IB)
 12274                 ADD +1               TO IA
 12275              END-IF
 12276*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 12277*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 12278*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
 12279*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 12280*                MOVE +0              TO DE-L-PC (IB)
 12281*                ADD +1               TO IA
 12282*             END-IF
 12283           END-IF
 12284        END-PERFORM
 12285     END-IF
 12286
 12287
 12288
 12289     .
 12290 2099-INIT-DTL-X.
 12291     EXIT.
 12292
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 238
* ECS010.cbl
 12294******************************************************************
 12295***            B U I L D   I S S U E   E X T R A C T           ***
 12296******************************************************************
 12297
 12298 2100-BUILD-ISSUE-EXTRACT.
 12299
 12300     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12301
 12302     MOVE 'I'                      TO DE-TRANS.
 12303
 12304     IF CHECK-BILLED
 12305         MOVE 'N' TO BILLED-SWITCH
 12306     ELSE
 12307         GO TO 2190-WRITE-ISSUE-EXTRACT.
 12308
 12309     MOVE +1                        TO SUB1.
 12310 2150-GA-BILL-LOOP.
 12311
 12312     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12313         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12314
 12315     IF SUB1 LESS THAN +5
 12316         ADD +1 TO SUB1
 12317         GO TO 2150-GA-BILL-LOOP.
 12318
 12319     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12320     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12321                                       DE-BILLED-LFRFND
 12322                                       DE-BILLED-AHPRM
 12323                                       DE-BILLED-AHRFND.
 12324
 12325     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12326         IF PB-LF-BILLED-AMTS = ZERO  AND
 12327            PB-AH-BILLED-AMTS = ZERO
 12328             MOVE ' '                    TO DE-BILL-STATUS
 12329         ELSE
 12330             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 12331                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 12332                 MOVE 'B'                TO DE-BILL-STATUS
 12333             ELSE
 12334                 MOVE 'R'                TO DE-BILL-STATUS
 12335                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 12336                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 12337     ELSE
 12338         MOVE 'B'                        TO DE-BILL-STATUS.
 12339
 12340 2190-WRITE-ISSUE-EXTRACT.
 12341
 12342     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12343
 12344 2199-BLD-ISSUE-X.
 12345     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 239
* ECS010.cbl
 12347******************************************************************
 12348***           B U I L D   C A N C E L   E X T R A C T          ***
 12349******************************************************************
 12350
 12351 2200-BUILD-CANCEL-EXTRACT.
 12352
 12353     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12354
 12355     MOVE 'C'                           TO DE-TRANS.
 12356
 12357     IF CR-LFTYP = ZERO
 12358         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12359
 12360     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 12361         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 12362             CR-LFRFND = +0
 12363              MOVE +0                   TO TEMP-5
 12364              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12365
 12366     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12367          IF CR-LFRFND = +0
 12368              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12369
 12370     MOVE +1 TO TEMP-5.
 12371     MOVE CR-LF-TERM             TO ORIG-TERM.
 12372     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 12373     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 12374     MOVE '1'                    TO W-VAL-SOURCE.
 12375     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 12376
 12377     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12378         MOVE CR-LFAMT TO DE-LF-CNBEN
 12379         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12380
 12381     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12382         GO TO 2220-BLD-DE-CANCEL-SUM.
 12383
 12384     IF REM-TRM3 = CR-LF-TERM
 12385         MOVE CR-LFAMT TO DE-LF-CNBEN
 12386         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12387
 12388     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 12389         GO TO 2210-BLD-DE-CANCEL-TEX.
 12390
 12391     IF DTE-CLIENT = 'NCL'
 12392         IF CR-DT LESS THAN 19910101
 12393             GO TO 2205-BLD-DE-CANCEL-BEN.
 12394
 12395     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 12396         GO TO 2230-BLD-DE-CANCEL-NP.
 12397
 12398     IF DTE-CLIENT = 'FUL'
 12399         GO TO 2240-BLD-DE-CANCEL-FUL.
 12400
 12401*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 12402     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 12403        (CR-RATING-CLASS NOT = 'L ')
 12404         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 240
* ECS010.cbl
 12405            (CR-LF-TERM GREATER THAN 060)  AND
 12406            (CR-DT GREATER THAN 19831031)
 12407              GO TO 2230-BLD-DE-CANCEL-NP.
 12408
 12409     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 12410         IF (CR-APR GREATER THAN ZERO)  AND
 12411            (CR-LF-TERM GREATER THAN 061)  AND
 12412            (CR-DT GREATER THAN 19830318)
 12413              GO TO 2230-BLD-DE-CANCEL-NP.
 12414
 12415     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 12416         IF (CR-APR GREATER THAN ZERO)  AND
 12417            (CR-LF-TERM GREATER THAN 062)  AND
 12418            (CR-DT GREATER THAN 19810831)  AND
 12419            (CR-DT LESS THAN 19830901)
 12420              GO TO 2230-BLD-DE-CANCEL-NP.
 12421
 12422     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 12423         IF (CR-APR GREATER THAN ZERO)  AND
 12424            (CR-LF-TERM GREATER THAN 060)  AND
 12425            (CR-DT GREATER THAN 19831231)
 12426              GO TO 2230-BLD-DE-CANCEL-NP.
 12427
 12428 2205-BLD-DE-CANCEL-BEN.
 12429
 12430     IF CR-LF-TERM EQUAL +0
 12431         MOVE +0          TO TEMP-5
 12432     ELSE
 12433         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 12434
 12435     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 12436
 12437     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12438
 12439 2210-BLD-DE-CANCEL-TEX.
 12440
 12441     DIVIDE CR-LFAMT BY CR-LF-TERM
 12442         GIVING TEX-FACT-1.
 12443     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 12444         GIVING TEX-FACT-2
 12445             REMAINDER TEX-FACT-3.
 12446     IF TEX-FACT-3 NOT = ZERO
 12447         ADD +1 TO TEX-FACT-2.
 12448     COMPUTE DE-LF-CNBEN =
 12449         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 12450
 12451     IF CR-LFAMT EQUAL +0
 12452         MOVE +0                  TO TEMP-5
 12453     ELSE
 12454         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12455
 12456     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12457
 12458 2220-BLD-DE-CANCEL-SUM.
 12459
 12460     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 12461     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 12462
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 241
* ECS010.cbl
 12463     IF CR-LFRFND NOT LESS CR-LFPRM
 12464         MOVE CR-LFAMT           TO DE-LF-CNBEN
 12465          GO TO 2250-CONTINUE-CANCEL-BUILD.
 12466
 12467     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 12468     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 12469     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12470         MOVE TEMP-7             TO DE-LF-CNBEN
 12471       ELSE
 12472         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 12473         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 12474
 12475     IF CR-LFAMT EQUAL +0
 12476         MOVE +0                  TO TEMP-5
 12477     ELSE
 12478         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 12479
 12480     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 12481         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12482
 12483 2230-BLD-DE-CANCEL-NP.
 12484
 12485     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 12486     MOVE 'L'                        TO  DC-OPTION-CODE.
 12487     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12488     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 12489
 12490     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 12491       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 12492       MOVE '3'                      TO  DC-OPTION-CODE
 12493       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12494       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 12495     ELSE
 12496       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 12497       MOVE '6'                      TO  DC-OPTION-CODE
 12498       MOVE +1                       TO  DC-ELAPSED-MONTHS
 12499       MOVE +0                       TO  DC-ELAPSED-DAYS
 12500       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12501       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 12502
 12503     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 12504     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 12505     MOVE CR-APR                     TO  CP-LOAN-APR.
 12506     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 12507     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 12508     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 12509     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 12510     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 12511     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 12512
 12513     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 12514     IF (DTE-CLIENT = 'DCC')
 12515        AND (AM-DCC-PRODUCT-CODE <> spaces)
 12516        if cr-clp-state = spaces
 12517           move cr-state         to cr-clp-state
 12518        end-if
 12519        if cr-lftyp not = '00' and '  ' and 'DD'
 12520           move 'L'              to ws-dd-ben-type
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 242
* ECS010.cbl
 12521           move cr-lftyp         to ws-dd-ben-code
 12522        else
 12523           move 'A'              to ws-dd-ben-type
 12524           move cr-ahtyp         to ws-dd-ben-code
 12525        end-if
 12526        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 12527           ((CR-clp-STATE = DD-STATE (D1))
 12528           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 12529           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 12530           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 12531           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 12532                           OR
 12533           D1 > max-pdef
 12534        END-PERFORM
 12535        IF D1 <= max-pdef
 12536           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12537              (P1 > +8)
 12538              OR (DD-PROD-CODE (D1 P1) = 'L')
 12539           END-PERFORM
 12540           IF P1 < +9
 12541              MOVE DD-MAX-BEN-AMT (D1 P1)
 12542                                 TO CP-R-MAX-TOT-BEN
 12543           END-IF
 12544        END-IF
 12545     END-IF
 12546
 12547     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 12548
 12549     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12550         COMPUTE DE-LF-CNBEN =
 12551                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 12552      ELSE
 12553          COMPUTE DE-LF-CNBEN ROUNDED =
 12554                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
 12555
 12556     IF CR-LFAMT EQUAL +0
 12557         MOVE +0                  TO TEMP-5
 12558     ELSE
 12559         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12560
 12561     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12562
 12563 2240-BLD-DE-CANCEL-FUL.
 12564
 12565     MOVE CR-APR                  TO NP-APR.
 12566     MOVE CR-LF-TERM              TO NP-ORIG.
 12567     MOVE REM-TRM3                TO NP-REM.
 12568     MOVE '2'                     TO NP-OPT.
 12569     MOVE CR-AHPRM                TO NP-AHPRM.
 12570     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 12571     MOVE CR-LFAMT                TO NP-BENEFIT.
 12572
 12573*    CALL 'FULNETRM'
 12574*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 12575*              NP-ACCOUNT NP-REMAINING.
 12576
 12577     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 12578
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 243
* ECS010.cbl
 12579     IF CR-LFAMT EQUAL +0
 12580         MOVE +0                  TO TEMP-5
 12581     ELSE
 12582         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12583
 12584 2250-CONTINUE-CANCEL-BUILD.
 12585
 12586     MOVE CR-LFRFND                   TO DE-LF-RFND.
 12587     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 12588     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
 12589                                         WS-DE-LF-CANC-DTE-N.
 12590     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 12591                                         WS-DE-LF-CANC-EXIT-DT-N.
 12592     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 12593
 12594
 12595     MOVE ZEROS                  TO DCC-DDF-REM-TRM3
 12596     IF (DTE-CLIENT = 'DCC')
 12597        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12598        AND (CR-AHTYP NOT = '00' AND '  ')
 12599        MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 12600        MOVE CR-AH-TERM          TO ORIG-TERM
 12601        MOVE CR-AH-CANC-DT       TO VALUATION-DT
 12602        MOVE '1'                 TO W-VAL-SOURCE
 12603        DISPLAY ' 2250 B4 RTRM ' REM-TRM1 ' ' cr-cert-no
 12604        PERFORM 8500-REMAINING-TERM-ROUTINE
 12605                                 THRU 8599-REM-TERM-X
 12606        DISPLAY ' 2250 AFTER RTRM ' REM-TRM1
 12607        MOVE REM-TRM1            TO DE-DCC-DDF-REM-TRM3
 12608     END-IF
 12609
 12610     MOVE CR-AHRFND                   TO DE-AH-RFND.
 12611
 12612     IF DTE-CLIENT = 'DCC'
 12613        IF DE-AH-RFND = ZEROS
 12614           MOVE ZEROS                 TO DE-ADDL-CLP
 12615        END-IF
 12616     END-IF
 12617
 12618     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 12619     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 12620                                         WS-DE-AH-CANC-DTE-N.
 12621     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 12622                                         WS-DE-AH-CANC-EXIT-DT-N.
 12623     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 12624
 12625     IF PB-LAST-MAINT-BY = 'E570'
 12626         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12627
 12628     IF CHECK-BILLED
 12629         MOVE 'N' TO BILLED-SWITCH
 12630     ELSE
 12631         GO TO 2259-END-CANCEL-BUILD.
 12632
 12633     MOVE +1                        TO SUB1.
 12634 2255-GA-BILL-LOOP.
 12635
 12636     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 244
* ECS010.cbl
 12637         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12638
 12639     IF SUB1 LESS THAN +5
 12640         ADD +1 TO SUB1
 12641         GO TO 2255-GA-BILL-LOOP.
 12642
 12643     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12644     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 12645     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12646                                       DE-BILLED-LFRFND
 12647                                       DE-BILLED-AHPRM
 12648                                       DE-BILLED-AHRFND.
 12649
 12650     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12651         IF PB-LF-BILLED-AMTS = ZERO  AND
 12652            PB-AH-BILLED-AMTS = ZERO
 12653             MOVE ' '                    TO DE-BILL-STATUS
 12654         ELSE
 12655             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 12656                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 12657                 MOVE 'B'                TO DE-BILL-STATUS
 12658             ELSE
 12659                 MOVE 'R'                TO DE-BILL-STATUS
 12660                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 12661                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 12662     ELSE
 12663         MOVE 'B'                        TO DE-BILL-STATUS.
 12664
 12665 2259-END-CANCEL-BUILD.
 12666     EXIT.
 12667
 12668 2290-WRITE-CANCEL-EXTRACT.
 12669
 12670     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12671
 12672 2299-BLD-CANCEL-X.
 12673     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 245
* ECS010.cbl
 12675******************************************************************
 12676***            B U I L D   C L A I M   E X T R A C T           ***
 12677******************************************************************
 12678
 12679 2300-BUILD-CLAIM-EXTRACT.
 12680
 12681     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12682
 12683     MOVE 'X'                       TO DE-TRANS.
 12684
 12685     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 12686
 12687     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 12688     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 12689
 12690     MOVE INCURRED-DATE             TO DE-INCUR
 12691                                       WS-DE-INCUR-N.
 12692     MOVE REPORTED-DATE             TO DE-REPORTED.
 12693     MOVE PAYMENT-DATE              TO DE-PAY
 12694                                       WS-DE-PAY-N.
 12695     MOVE PAY-TO-DATE               TO DE-PAID-TO
 12696                                       WS-DE-PAID-TO-N.
 12697
 12698     MOVE PC-CLAIM-NO               TO DE-CNUM.
 12699     MOVE PC-CHECK-NO               TO DE-CHECK.
 12700     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 12701     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 12702     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 12703     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 12704     INSPECT DE-PAY-CODE
 12705         CONVERTING '1234569' TO 'PFSXEEV'.
 12706
 12707     MOVE AM-NAME                   TO DE-ACC-NAME.
 12708     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 12709                                       WS-DE-ACC-EXP-DTE-N.
 12710     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 12711                                       WS-DE-ACC-EFF-DTE-N.
 12712     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 12713     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 12714
 12715     IF DE-DTH  OR  DE-OB-DTH
 12716         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 12717     ELSE
 12718         IF CR-AH-LUMP-SUM-DISAB
 12719             MOVE CR-AH-STATUS-AT-SETTLEMENT
 12720                                    TO DE-AH-PREV-STAT.
 12721
 12722     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12723         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12724
 12725 2390-WRITE-CLAIM-EXTRACT.
 12726
 12727     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12728
 12729 2399-BLD-CLAIM-X.
 12730     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 246
* ECS010.cbl
 12732******************************************************************
 12733***          B U I L D   R E S E R V E   E X T R A C T         ***
 12734******************************************************************
 12735
 12736 2400-BUILD-RESERVE-EXTRACT.
 12737
 12738     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12739
 12740     MOVE 'Y'                         TO DE-TRANS.
 12741     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 12742
 12743     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 12744     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 12745     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 12746     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 12747     MOVE PC-REMAINING-BENEFIT        TO DE-RSV-REM-BENEFIT
 12748     MOVE PC-REMAINING-TERM           TO DE-RSV-REM-TERM
 12749
 12750     IF DTE-CLIENT  =  'NCL'
 12751        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 12752            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 12753
 12754     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 12755
 12756     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 12757                                         WS-DE-ACC-EXP-DTE-RSV-N.
 12758
 12759     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 12760                                         WS-DE-ACC-EFF-DTE-RSV-N.
 12761
 12762     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 12763                                         WS-DE-RSV-INCUR-N.
 12764     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 12765     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 12766                                         WS-DE-RSV-PAYTO-N.
 12767
 12768     MOVE ZEROS                       TO DE-REI-IBNR
 12769                                         DE-REI-PAYCUR
 12770                                         DE-REI-FUTRSV.
 12771
 12772     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 12773
 12774     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12775         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12776
 12777 2490-WRITE-RESERVE-EXTRACT.
 12778
 12779     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12780
 12781 2499-BLD-RESERVE-X.
 12782     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 247
* ECS010.cbl
 12784******************************************************************
 12785***          W R I T E   D E T A I L   E X T R A C T S         ***
 12786******************************************************************
 12787
 12788 2500-WRITE-DETAIL-EXTRACTS.
 12789
 12790
 12791     MOVE  ZEROS            TO  SUB.
 12792
 12793     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 12794         GO TO 2520-WRITE-CONTINUE.
 12795
 12796 2510-ZERO-CHARGEBACK-LOOP.
 12797
 12798     ADD  +1                TO  SUB.
 12799
 12800     IF  SUB    GREATER  THAN     +10
 12801         GO TO  2520-WRITE-CONTINUE.
 12802
 12803*    DISPLAY ' CERT NO ' CR-CERT-NO
 12804*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 12805*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 12806
 12807
 12808     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 12809         MOVE  ZEROS            TO  DE-L-PC (SUB).
 12810
 12811     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 12812         OR ((CR-AH-REFUND-TYPE = 'G') AND (CR-AHRFND = ZEROS))
 12813         OR (WS-DDF-AH-CB (SUB) = 'N')
 12814         MOVE  ZEROS             TO DE-A-PC (SUB)
 12815     END-IF
 12816
 12817     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 12818
 12819 2520-WRITE-CONTINUE.
 12820
 12821     IF DTE-CLIENT NOT = 'HER'
 12822         GO TO 2590-WRITE-EXTRACTS.
 12823
 12824     IF DE-REINCO NOT = 'LNL'
 12825         GO TO 2590-WRITE-EXTRACTS.
 12826
 12827     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 12828         GO TO 2590-WRITE-EXTRACTS.
 12829
 12830     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 12831     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 12832     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 12833     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 12834     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 12835     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 12836     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 12837     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 12838     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 12839     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 12840
 12841     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 248
* ECS010.cbl
 12842     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 12843     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12844     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12845     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12846     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12847     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12848     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12849     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12850     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12851
 12852
 12853 2590-WRITE-EXTRACTS.
 12854
 12855     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12856                                     WS-DE-PROC-DT-N.
 12857
 12858     IF DTE-PGM-OPT = '1'
 12859         ADD +1                   TO DE-CNT
 12860*********PERFORM EXTRACT-DATE-RELOAD
 12861         WRITE DETAIL-EXTRACT.
 12862
 12863
 12864 2599-WRT-DETAIL-X.
 12865     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 249
* ECS010.cbl
 12867******************************************************************
 12868***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12869******************************************************************
 12870
 12871 3000-REINSURE-ROUTINE.
 12872
 12873     IF (CR-POLICY-IS-DECLINED) OR
 12874        (CR-POLICY-IS-VOID)
 12875        GO TO 3099-REINSURE-ROUTINE-X.
 12876
 12877     IF REIN-FLG = 'X'
 12878         GO TO 3099-REINSURE-ROUTINE-X.
 12879
 12880     MOVE 'X' TO REIN-FLG.
 12881
 12882     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 12883
 12884     IF CR-REIN-TABLE = SPACES OR ZEROS
 12885         GO TO 3030-RE-CALCULATE-REINSURANCE.
 12886
 12887******************************************************************
 12888***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 12889******************************************************************
 12890
 12891 3010-RR-READ-REIN.
 12892
 12893     IF REIN-OPEN-SW = ' '
 12894         MOVE 'X'                       TO REIN-OPEN-SW
 12895         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 12896         MOVE 'A'                       TO REIN-SRCH-CODE
 12897         OPEN INPUT ERRTBL-IN
 12898         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 12899             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 12900          ELSE
 12901             MOVE '21'                  TO ABEND-CODE-1
 12902             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 12903             DISPLAY '******************************'
 12904             DISPLAY '***** ERROR LOCATION 015 *****'
 12905             DISPLAY '******************************'
 12906             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12907             GO TO ABEND-PGM.
 12908
 12909     IF CR-REIN-TABLE = REIN-SRCH
 12910         GO TO 3019-RR-READ-REIN-X.
 12911
 12912     MOVE +0                            TO REIN-SUB-1.
 12913     MOVE 999999                        TO REIN-LOW-TIME.
 12914     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 12915
 12916 3011-RR-CHECK-REIN-SAVE-TABLE.
 12917
 12918     ADD +1                             TO REIN-SUB-1.
 12919     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 12920        REIN-SUB-1 GREATER THAN REIN-SUB-2
 12921         GO TO 3015-RR-READ-ERRTBL.
 12922
 12923     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 12924         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 250
* ECS010.cbl
 12925         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12926         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 12927         GO TO 3019-RR-READ-REIN-X.
 12928
 12929     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 12930         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 12931         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 12932
 12933     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 12934
 12935 3015-RR-READ-ERRTBL.
 12936
 12937     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 12938
 12939     READ ERRTBL-IN.
 12940
 12941     IF ERRTBL-FILE-STATUS  = '23'
 12942         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 12943                                           ' ' CR-FULL-CONTROL
 12944         MOVE '24'                      TO ABEND-CODE-1
 12945         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12946         DISPLAY '******************************'
 12947         DISPLAY '***** ERROR LOCATION 016 *****'
 12948         DISPLAY '******************************'
 12949         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12950         GO TO ABEND-PGM.
 12951
 12952     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 12953         NEXT SENTENCE
 12954       ELSE
 12955         MOVE '24'                      TO ABEND-CODE-1
 12956         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12957         DISPLAY '******************************'
 12958         DISPLAY '***** ERROR LOCATION 017 *****'
 12959         DISPLAY '******************************'
 12960         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12961         GO TO ABEND-PGM.
 12962
 12963     ADD +1                            TO ERRTBL-READS.
 12964
 12965     IF REIN-SUB-1 GREATER THAN REIN-MAX
 12966         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 12967         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12968         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 12969     ELSE
 12970         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 12971         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12972         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 12973         MOVE REIN-SUB-1               TO REIN-SUB-2.
 12974
 12975 3019-RR-READ-REIN-X.
 12976     EXIT.
 12977
 12978 3020-CALCULATE-REINSURANCE.
 12979
 12980*    IF DTE-CLIENT = '???'  AND
 12981*       (CR-REIN-TABLE = 'SE1')
 12982*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 251
* ECS010.cbl
 12983*        IF CR-STATE NOT = STATE-L
 12984*            MOVE CR-STATE             TO STATE-L
 12985*            PERFORM 8200-STATE-CODE-LOOKUP
 12986*                         THRU 8299-STATE-LOOKUP-X.
 12987
 12988
 12989*    IF DTE-CLIENT = 'DCC'
 12990*       IF CR-LF-NSP-PRM NOT = ZEROS
 12991*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 12992*             (CR-LFPRM + CR-LFPRM-ALT) -
 12993*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12994*       END-IF
 12995*       IF CR-AH-NSP-PRM NOT = ZEROS
 12996*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 12997*          CR-AHPRM -
 12998*          (CR-AHPRM * CR-LCOM-AH (1))
 12999*       END-IF
 13000*    END-IF
 13001
 13002
 13003     IF RE-REMAINING (1) = 'I'
 13004         MOVE '*'                      TO RISK-REIN-FLAG
 13005     ELSE
 13006         GO TO 3029-CONTINUE-REIN-CALC.
 13007
 13008     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 13009                                          REIN-CANCEL-AH-SW.
 13010     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 13011                                          REIN-LCNC-EARN-TERM
 13012                                          REIN-LF-CLM-MONTHS
 13013                                          REIN-EARN-AH-TERM
 13014                                          REIN-ACNC-EARN-TERM
 13015                                          REIN-AH-PRIOR-CLMS-PAID
 13016                                          REIN-AH-CLM-MONTHS
 13017                                          REIN-AH-CLM-MTH-1
 13018                                          REIN-AH-CLM-MTH-2
 13019                                          REIN-AH-CLM-MTH-3
 13020                                          REIN-AH-CLM-MTH-4
 13021                                          REIN-AH-CLM-MTH-5.
 13022
 13023*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 13024*    MOVE 'L'                          TO DC-OPTION-CODE.
 13025*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13026*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 13027
 13028     IF CR-LFTYP = ZEROS  OR  SPACES
 13029         GO TO 3023-CONTINUE.
 13030
 13031     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13032
 13033     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 13034       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13035           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 13036
 13037     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 13038       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 13039           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 13040
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 252
* ECS010.cbl
 13041     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13042     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13043
 13044     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 13045         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 13046     ELSE
 13047         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 13048
 13049     IF CR-LF-CANC-DT NOT = ZEROS
 13050         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 13051         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13052         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 13053         IF CR-DT = CR-LF-CANC-DT
 13054             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 13055
 13056     IF CR-DTH-DT NOT = ZEROS
 13057         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 13058         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13059         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 13060
 13061     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 13062
 13063
 13064 3023-CONTINUE.
 13065
 13066     IF CR-AHTYP = ZEROS  OR  SPACES
 13067        GO TO 3029-CONTINUE-REIN-CALC.
 13068
 13069     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13070
 13071     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 13072       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13073           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 13074
 13075     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 13076       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 13077           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 13078
 13079     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13080     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13081
 13082     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 13083         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 13084     ELSE
 13085         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 13086
 13087     IF CR-AH-CANC-DT NOT = ZEROS
 13088         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 13089         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13090         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 13091         IF CR-DT = CR-AH-CANC-DT
 13092             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 13093
 13094     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 13095         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 13096         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13097         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 13098
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 253
* ECS010.cbl
 13099     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 13100         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 13101         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13102         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 13103
 13104     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 13105         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 13106         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13107         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 13108
 13109     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 13110         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 13111         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13112         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 13113
 13114     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 13115         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 13116         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13117         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 13118
 13119     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 13120
 13121
 13122     GO TO 3029-CONTINUE-REIN-CALC.
 13123
 13124
 13125 3025-CALC-ELAPSED-MONTHS.
 13126
 13127     MOVE 'L'                          TO DC-OPTION-CODE.
 13128     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13129     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 13130     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 13131     MOVE '1'                          TO DC-OPTION-CODE.
 13132     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 13133     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 13134                                          DC-ODD-DAYS-OVER
 13135                                          DC-ELAPSED-DAYS.
 13136     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13137
 13138 3026-CALC-EXIT.
 13139     EXIT.
 13140
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 254
* ECS010.cbl
 13142 3029-CONTINUE-REIN-CALC.
 13143
*13144                             COPY ECSRTPFM.
 13145******************************************************************07/10/97
 13146*                                                                *ECSRTPFM
 13147*                            ECSRTPFM                            *   LV001
 13148*                            VMOD=2.002                          *ECSRTPFM
 13149*                                                                *ECSRTPFM
 13150******************************************************************ECSRTPFM
 13151                                                                  ECSRTPFM
 13152     IF    CR-LFAMT  NUMERIC                                      00000072
 13153           NEXT SENTENCE                                          00000073
 13154        ELSE                                                      00000074
 13155           MOVE ZEROS TO CR-LFAMT.                                00000075
 13156                                                                  00000076
 13157     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 13158           NEXT SENTENCE                                          00000078
 13159        ELSE                                                      00000079
 13160           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 13161                                                                  00000081
 13162                                                                  00000082
 13163     IF    CR-LFPRM  NUMERIC                                      00000083
 13164           NEXT SENTENCE                                          00000084
 13165        ELSE                                                      00000085
 13166           MOVE ZEROS TO CR-LFPRM.                                00000086
 13167                                                                  00000087
 13168     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 13169           NEXT SENTENCE                                          00000089
 13170        ELSE                                                      00000090
 13171           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 13172                                                                  00000092
 13173                                                                  00000093
 13174     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 13175           NEXT SENTENCE                                          00000095
 13176        ELSE                                                      00000096
 13177           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 13178                                                                  00000098
 13179     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 13180           NEXT SENTENCE                                          00000100
 13181        ELSE                                                      00000101
 13182           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 13183                                                                  00000103
 13184     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 13185           NEXT SENTENCE                                          00000105
 13186        ELSE                                                      00000106
 13187           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 13188                                                                  00000108
 13189     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 13190     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 13191     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 13192         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 13193     ELSE                                                         ECSRTPFM
 13194         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 13195     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 13196                                                                  ECSRTPFM
 13197     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 13198     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 13199     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 255
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 13200         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 13201     ELSE                                                         ECSRTPFM
 13202         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 13203     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 13204                                                                  ECSRTPFM
 13205     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 13206         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 13207             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 13208                                                                  ECSRTPFM
 13209
 13210     MOVE 'X'                  TO REIN-RT-SW.
 13211     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 13212     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 13213     MOVE ' '                  TO REIN-RT-SW.
 13214
 13215 3030-RE-CALCULATE-REINSURANCE.
 13216
 13217     IF AM-RECALC-REIN = 'Y'
 13218         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 13219            CR-REIN-SPEC = SPACE  AND
 13220            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 13221             PERFORM 3600-RC-REINSURANCE
 13222                 THRU 3799-RC-REINSURANCE-X.
 13223
 13224     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 13225         VARYING SUB1 FROM 1 BY 1
 13226             UNTIL REIN-COMP (SUB1) = SPACES.
 13227
 13228     GO TO 3099-REINSURE-ROUTINE-X.
 13229
 13230 3040-REIN-REC-CNT.
 13231
 13232     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 13233         GO TO 3049-RRC-XIT.
 13234
 13235     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 13236         VARYING B-SUB FROM 1 BY 1
 13237             UNTIL B-SUB GREATER THAN 50.
 13238
 13239 3049-RRC-XIT.
 13240     EXIT.
 13241
 13242 3050-REIN-COMP-ADD.
 13243
 13244     IF RB-COMPANY (B-SUB) = SPACES
 13245         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 13246     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 13247         MOVE 1   TO RB-COUNT (B-SUB)
 13248         MOVE +50 TO B-SUB.
 13249
 13250 3059-RCA-XIT.
 13251     EXIT.
 13252
 13253 3099-REINSURE-ROUTINE-X.
 13254     EXIT.
 13255
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 256
* ECS010.cbl
 13257******************************************************************
 13258***                R E I N S U R E   I S S U E S               ***
 13259******************************************************************
 13260
 13261 3100-REINSURE-ISSUE.
 13262
 13263     IF  REIN-COMP (1) = SPACES
 13264         GO TO 3199-REINSURE-ISSUE-X.
 13265
 13266     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 13267     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13268     MOVE 'I'      TO DE-TRANS.
 13269     MOVE 'R'      TO DE-REIN.
 13270*****PERFORM EXTRACT-DATE-RELOAD.
 13271     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13272     MOVE +1       TO SUB1.
 13273
 13274 3110-REINSURE-ISSUE-LOOP.
 13275
 13276     IF REIN-COMP (SUB1) = SPACES
 13277         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 13278
 13279     IF UPDATING-RISK-PREMIUMS
 13280       IF REIN-REM-SW (SUB1) NOT = 'I'
 13281         ADD +1 TO SUB1
 13282         GO TO 3110-REINSURE-ISSUE-LOOP.
 13283
 13284     IF REIN-REM-SW (SUB1) = 'Z'
 13285         ADD +1 TO SUB1
 13286         GO TO 3110-REINSURE-ISSUE-LOOP.
 13287
 13288     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13289     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13290     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13291     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13292     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13293     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13294
 13295     IF REIN-REM-SW (SUB1) NOT = 'I'
 13296         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13297
 13298     IF RWF-LFPRM = ZEROS  AND
 13299        RWF-AHPRM = ZEROS
 13300         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13301
 13302     IF RWF-LFPRM NOT = ZEROS
 13303         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 13304         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 13305
 13306     IF RWF-AHPRM NOT = ZEROS
 13307         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 13308         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 13309
 13310 3115-CONTINUE-ISSUE-LOOP.
 13311
 13312     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 13313     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 13314
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 257
* ECS010.cbl
 13315     IF DE-REI-LFAMT NOT = ZERO
 13316        OR DE-REI-LFPRM NOT = ZERO
 13317        OR DE-REI-AHAMT NOT = ZERO
 13318        OR DE-REI-AHPRM NOT = ZERO
 13319         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13320                 2599-WRT-DETAIL-X
 13321         ADD +1 TO BC-R-ISS.
 13322
 13323     ADD +1 TO SUB1.
 13324     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13325     PERFORM EXTRACT-DATE-LOAD.
 13326
 13327     GO TO 3110-REINSURE-ISSUE-LOOP.
 13328
 13329 3119-REINSURE-ISSUE-LOOP-END.
 13330     EXIT.
 13331
 13332 3190-REINSURE-ISSUE-PRINT.
 13333
 13334     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13335     IF RW-ACCUM-LF NOT = ZERO
 13336         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13337         MOVE CR-LF-TERM               TO TRD-LFTRM
 13338         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13339         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 13340     IF RW-ACCUM-AH NOT = ZERO
 13341         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13342         MOVE CR-AH-TERM               TO TRD-AHTRM
 13343         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13344         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 13345     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 13346         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13347
 13348 3199-REINSURE-ISSUE-X.
 13349     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 258
* ECS010.cbl
 13351******************************************************************
 13352***               R E I N S U R E   C A N C E L S              ***
 13353******************************************************************
 13354
 13355 3200-REINSURE-CANCEL.
 13356
 13357     IF REIN-COMP (1) = SPACES
 13358         GO TO 3299-REINSURE-CANCEL-X.
 13359
 13360     IF CR-LFRFND = ZERO
 13361        AND CR-AHRFND = ZERO
 13362         GO TO 3299-REINSURE-CANCEL-X.
 13363
 13364     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 13365             VARYING SUB1 FROM +1 BY +1 UNTIL
 13366                       REIN-COMP (SUB1) = SPACES.
 13367
 13368     IF REIN-RT-SW = 'X'
 13369         GO TO 3299-REINSURE-CANCEL-X.
 13370
 13371     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 13372     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13373     MOVE 'R'      TO DE-REIN.
 13374*****PERFORM EXTRACT-DATE-RELOAD.
 13375     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13376     MOVE +1       TO SUB1.
 13377
 13378 3210-REINSURE-CANCEL-LOOP.
 13379
 13380     IF REIN-COMP (SUB1) = SPACES
 13381         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 13382
 13383     IF REIN-REM-SW (SUB1) = 'Z'
 13384         ADD +1        TO SUB1
 13385         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13386         PERFORM EXTRACT-DATE-LOAD
 13387         GO TO 3210-REINSURE-CANCEL-LOOP.
 13388
 13389     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13390     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13391
 13392     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 13393     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 13394     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13395     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13396     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13397     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13398     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 13399     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 13400     COMPUTE DE-REI-CNAMT ROUNDED = RWF-LFAMT * TEMP-5.
 13401
 13402     IF REIN-REM-SW (SUB1) NOT = 'I'
 13403         GO TO 3215-CONTINUE-CANCEL-LOOP.
 13404
 13405     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13406        VOIDING-LF-CANCEL
 13407         NEXT SENTENCE
 13408     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 259
* ECS010.cbl
 13409         MOVE ZEROS             TO DE-REI-LFRFND.
 13410
 13411     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13412        VOIDING-AH-CANCEL
 13413         NEXT SENTENCE
 13414     ELSE
 13415         MOVE ZEROS             TO DE-REI-AHRFND.
 13416
 13417 3215-CONTINUE-CANCEL-LOOP.
 13418
 13419     IF RWF-LF-RUNOFF-SW = 'N'
 13420         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13421             MOVE ZEROS         TO DE-LF-TYPE
 13422                                   DE-REI-LFAMT
 13423                                   DE-REI-LFPRM
 13424                                   DE-REI-LFRFND
 13425                                   DE-REI-CNAMT.
 13426
 13427     IF RWF-AH-RUNOFF-SW = 'N'
 13428         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13429             MOVE ZEROS         TO DE-AH-TYPE
 13430                                   DE-REI-AHAMT
 13431                                   DE-REI-AHPRM
 13432                                   DE-REI-AHRFND.
 13433
 13434     IF DE-REI-LFAMT NOT = ZERO
 13435        OR DE-REI-LFPRM NOT = ZERO
 13436        OR DE-REI-AHAMT NOT = ZERO
 13437        OR DE-REI-AHPRM NOT = ZERO
 13438        OR DE-REI-LFRFND NOT = ZERO
 13439        OR DE-REI-AHRFND NOT = ZERO
 13440        OR DE-REI-CNAMT NOT = ZERO
 13441         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13442                                            2599-WRT-DETAIL-X
 13443         ADD +1 TO BC-R-CNC.
 13444
 13445     ADD +1 TO SUB1.
 13446     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13447     PERFORM EXTRACT-DATE-LOAD.
 13448     GO TO 3210-REINSURE-CANCEL-LOOP.
 13449
 13450 3219-REINSURE-CANCEL-LOOP-END.
 13451     EXIT.
 13452
 13453 3290-REINSURE-CANCEL-PRINT.
 13454
 13455     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13456     IF RW-ACCUM-LF NOT = ZERO
 13457         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13458         MOVE CR-LF-TERM               TO TRD-LFTRM
 13459         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13460         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 13461     IF RW-ACCUM-AH NOT = ZERO
 13462         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13463         MOVE CR-AH-TERM               TO TRD-AHTRM
 13464         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13465         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 13466     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 260
* ECS010.cbl
 13467         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13468
 13469 3299-REINSURE-CANCEL-X.
 13470     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 261
* ECS010.cbl
 13472******************************************************************
 13473***                R E I N S U R E   C L A I M S               ***
 13474******************************************************************
 13475
 13476 3300-REINSURE-CLAIM.
 13477
 13478*    IF DTE-CLIENT = '???'
 13479*       IF (REIN-RT-SW NOT = 'X')  AND
 13480*          (PC-PAYMENT-TYPE = '5' OR '6')
 13481*        GO TO 3399-REINSURE-CLAIM-X.
 13482
 13483     IF REIN-COMP (1) = SPACES
 13484         GO TO 3399-REINSURE-CLAIM-X.
 13485
 13486     IF REIN-RT-SW = 'X'
 13487         MOVE CR-DTHAMT   TO RW-LFCLMWK
 13488         ADD  CR-DTHEXP   TO RW-LFCLMWK
 13489         MOVE CR-DISAMT   TO RW-AHCLMWK
 13490         ADD  CR-DISEXP   TO RW-AHCLMWK
 13491     ELSE
 13492         IF PC-CLAIM-TYPE  = 1 OR 3
 13493             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 13494             MOVE +0                  TO RW-AHCLMWK
 13495         ELSE
 13496             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 13497             MOVE +0                  TO RW-LFCLMWK.
 13498
 13499     MOVE +0                          TO RW-LFCLM
 13500                                         RW-AHCLM.
 13501     IF RW-LFCLMWK = ZERO
 13502        AND RW-AHCLMWK = ZERO
 13503         GO TO 3399-REINSURE-CLAIM-X.
 13504
 13505     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 13506         VARYING SUB1 FROM +1 BY +1
 13507             UNTIL REIN-COMP (SUB1) = SPACES.
 13508
 13509     IF REIN-RT-SW = 'X'
 13510         GO TO 3399-REINSURE-CLAIM-X.
 13511
 13512     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 13513     MOVE ZEROS                TO RW-ACCUM-CLM.
 13514     MOVE 'R'                  TO DE-REIN.
 13515*****PERFORM EXTRACT-DATE-RELOAD.
 13516     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 13517     MOVE +1                   TO SUB1.
 13518
 13519 3310-REINSURE-CLAIM-LOOP.
 13520
 13521     IF REIN-COMP (SUB1) = SPACES
 13522         GO TO 3390-REINSURE-CLAIM-PRINT.
 13523
 13524     IF REIN-REM-SW (SUB1) = 'Z'
 13525         ADD +1        TO SUB1
 13526         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13527         PERFORM EXTRACT-DATE-LOAD
 13528         GO TO 3310-REINSURE-CLAIM-LOOP.
 13529
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 262
* ECS010.cbl
 13530     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13531     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13532
 13533     IF PC-CLAIM-TYPE  = 1 OR 3
 13534         IF RWF-LF-RUNOFF-SW = 'N'
 13535           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13536               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13537
 13538     IF PC-CLAIM-TYPE  = 2 OR 4
 13539         IF RWF-AH-RUNOFF-SW = 'N'
 13540           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13541               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13542
 13543     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13544     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13545     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13546     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13547
 13548     IF PC-CLAIM-TYPE  = 1 OR 3
 13549         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 13550         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 13551     ELSE
 13552         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 13553         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 13554
 13555     IF PC-CLAIM-TYPE = 1 OR 3
 13556         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 13557            AND DE-REI-CLAIM-AMT
 13558             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13559         ELSE
 13560             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 13561     ELSE
 13562         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 13563            AND DE-REI-CLAIM-AMT
 13564             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13565         ELSE
 13566             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 13567
 13568 3320-REINSURE-CLAIM-LOOP-GO.
 13569
 13570     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 13571     ADD +1                     TO BC-R-CLM.
 13572
 13573 3330-REINSURE-CLAIM-LOOP-ADD.
 13574
 13575     ADD +1                     TO SUB1.
 13576     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 13577     PERFORM EXTRACT-DATE-LOAD.
 13578     GO TO 3310-REINSURE-CLAIM-LOOP.
 13579
 13580 3390-REINSURE-CLAIM-PRINT.
 13581
 13582     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13583     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13584         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13585         MOVE CR-LF-TERM               TO TRD-LFTRM
 13586         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 13587         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 263
* ECS010.cbl
 13588     ELSE
 13589         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13590         MOVE CR-AH-TERM               TO TRD-AHTRM
 13591         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 13592         MOVE CR-DIS-MO        TO TRD-AHACTMO
 13593         MOVE CR-DIS-DA        TO TRD-AHACTDA
 13594         MOVE CR-DIS-YR        TO TRD-AHACTYR
 13595         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 13596         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 13597     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13598
 13599 3399-REINSURE-CLAIM-X.
 13600     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 264
* ECS010.cbl
 13602******************************************************************
 13603***              R E I N S U R E   R E S E R V E S             ***
 13604******************************************************************
 13605
 13606 3400-REINSURE-RESERVE.
 13607
 13608     IF REIN-COMP (1) = SPACES
 13609         GO TO 3499-REINSURE-RESERVE-X.
 13610
 13611     IF PC-CLAIM-TYPE = '1' OR '3'
 13612         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 13613         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 13614         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 13615         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 13616         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 13617     ELSE
 13618         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 13619         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 13620         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 13621         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 13622         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 13623
 13624     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 13625                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 13626     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 13627         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 13628          GO TO 3499-REINSURE-RESERVE-X.
 13629
 13630     IF DTE-CLIENT NOT = 'MIC'
 13631         GO TO 3405-REINSURE-RESERVE-CONT.
 13632
 13633     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13634         GO TO 3405-REINSURE-RESERVE-CONT.
 13635
 13636     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 13637     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 13638     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 13639     MOVE 'A'                        TO CP-BENEFIT-TYPE
 13640                                        CP-CLAIM-TYPE.
 13641     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 13642     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 13643     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 13644     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 13645     MOVE ZEROS                      TO CP-CDT-PERCENT.
 13646     MOVE '3'                        TO CP-CDT-METHOD.
 13647     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 13648     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 13649                                        CP-RATING-BENEFIT-AMT.
 13650     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 13651     MOVE 'O'                        TO CP-CLAIM-STATUS.
 13652
 13653 3405-REINSURE-RESERVE-CONT.
 13654
 13655     PERFORM 3500-REINSURE-CALC-RESERVE
 13656         THRU 3599-REINSURE-CALC-RESERVE-X
 13657             VARYING SUB1 FROM +1 BY +1
 13658                 UNTIL REIN-COMP (SUB1) = SPACES.
 13659
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 265
* ECS010.cbl
 13660     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 13661     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 13662     MOVE 'R'            TO DE-REIN.
 13663*****PERFORM EXTRACT-DATE-RELOAD.
 13664     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13665     MOVE +1             TO SUB1.
 13666
 13667 3410-REINSURE-RESERVE-LOOP.
 13668
 13669     IF REIN-COMP (SUB1) = SPACES
 13670         GO TO 3490-REINSURE-RESERVE-PRINT.
 13671
 13672     IF REIN-REM-SW (SUB1) = 'Z'
 13673         ADD +1 TO SUB1
 13674         GO TO 3410-REINSURE-RESERVE-LOOP.
 13675
 13676     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13677     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13678
 13679     IF PC-CLAIM-TYPE  = 1 OR 3
 13680         IF RWF-LF-RUNOFF-SW = 'N'
 13681           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13682               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13683
 13684     IF PC-CLAIM-TYPE  = 2 OR 4
 13685         IF RWF-AH-RUNOFF-SW = 'N'
 13686           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13687               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13688
 13689     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13690     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13691     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13692     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13693
 13694     IF PC-CLAIM-TYPE = 1 OR 3
 13695         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 13696         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 13697         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 13698     ELSE
 13699         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 13700         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 13701         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 13702
 13703     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 13704     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 13705     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 13706
 13707     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 13708        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 13709        OR DE-REI-FUTRSV
 13710         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13711                                            2599-WRT-DETAIL-X
 13712         ADD +1 TO BC-R-CRS.
 13713
 13714 3415-REINSURE-RESERVE-LOOP-ADD.
 13715
 13716     ADD +1 TO SUB1.
 13717     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 266
* ECS010.cbl
 13718     PERFORM EXTRACT-DATE-LOAD.
 13719     GO TO 3410-REINSURE-RESERVE-LOOP.
 13720
 13721 3490-REINSURE-RESERVE-PRINT.
 13722
 13723     IF RW-ACCUM-IBNR   = ZERO  AND
 13724        RW-ACCUM-PAYCUR = ZERO  AND
 13725        RW-ACCUM-FUTRSV = ZERO
 13726         GO TO 3499-REINSURE-RESERVE-X.
 13727
 13728     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13729     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 13730     MOVE 'IBNR'                    TO TRD-IBNRX.
 13731     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 13732     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 13733     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 13734     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 13735
 13736     IF PC-CLAIM-TYPE = 1
 13737         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 13738     ELSE
 13739         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 13740     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 13741
 13742     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13743
 13744 3499-REINSURE-RESERVE-X.
 13745     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 267
* ECS010.cbl
 13747******************************************************************
 13748***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 13749******************************************************************
 13750
 13751 3500-REINSURE-CALC-RESERVE.
 13752
 13753     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13754     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 13755                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 13756
 13757     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 13758        VARYING CO-SUB FROM 1 BY 1 UNTIL
 13759          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 13760       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 13761
 13762     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 13763        MOVE ZERO TO CO-SUB.
 13764
 13765     IF CO-SUB NOT = ZERO
 13766        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13767           IF PC-CLAIM-TYPE = '1' OR '3'
 13768             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13769                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13770
 13771     IF PC-CLAIM-TYPE  = 1 OR 3
 13772         IF RWF-LF-RUNOFF-SW = 'N'
 13773           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13774               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13775
 13776     IF CO-SUB NOT = ZERO
 13777        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13778           IF PC-CLAIM-TYPE = '2' OR '4'
 13779             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13780                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13781
 13782     IF PC-CLAIM-TYPE  = 2 OR 4
 13783         IF RWF-AH-RUNOFF-SW = 'N'
 13784           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13785               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13786
 13787     IF DTE-CLIENT NOT = 'MIC'
 13788         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13789
 13790     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13791         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13792
 13793     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 13794
 13795     IF CR-AHTYP = ZERO  OR
 13796        CO-SUB = ZERO
 13797         GO TO 3505-REIN-CALC-RESERVE-CONT
 13798     ELSE
 13799         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13800             GO TO 3505-REIN-CALC-RESERVE-CONT.
 13801
 13802     COMPUTE MAX-REM-TERM ROUNDED =
 13803                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 13804
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 268
* ECS010.cbl
 13805     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 13806         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13807
 13808     COMPUTE CP-ORIGINAL-TERM =
 13809                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 13810
 13811     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 13812
 13813     IF  CP-RETURN-CODE = ZERO
 13814         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 13815
 13816 3505-REIN-CALC-RESERVE-CONT.
 13817
 13818     IF SUB1 = RE-100-COMP
 13819         GO TO 3520-REIN-REMAINDER-RSRV.
 13820
 13821     IF CR-LFAMT NOT = ZERO  AND
 13822        RWF-LFAMT NOT = ZERO
 13823         IF DTE-CLIENT NOT = 'MIC'
 13824             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 13825                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13826             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 13827                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13828             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 13829                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13830         ELSE
 13831             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 13832             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 13833             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 13834
 13835     IF CR-AHAMT NOT = ZERO  AND
 13836        RWF-AHAMT NOT = ZERO
 13837         IF DTE-CLIENT NOT = 'MIC'
 13838             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 13839                         RWF-AHAMT) / CR-AHAMT
 13840             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 13841                         RWF-AHAMT) / CR-AHAMT
 13842             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 13843                         RWF-AHAMT) / CR-AHAMT
 13844         ELSE
 13845             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13846             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13847             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13848
 13849 3510-REINSURE-CALC-RESERVE-ADD.
 13850
 13851     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13852     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13853     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13854     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13855     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13856     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13857
 13858     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13859         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13860
 13861     IF CO-SUB = ZERO
 13862         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 269
* ECS010.cbl
 13863
 13864 3513-REIN-CHK-LF-RSRV-LIMIT.
 13865     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13866         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13867
 13868     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13869         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13870
 13871     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13872                                      (RWF-LFCLM +
 13873                                       RWF-DTH-PAYCUR +
 13874                                       RWF-DTH-FUTRSV).
 13875
 13876     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13877         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13878
 13879     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 13880
 13881     IF RWF-DTH-PAYCURL LESS THAN ZERO
 13882         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 13883         MOVE ZEROS TO RWF-DTH-PAYCURL.
 13884     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 13885         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 13886
 13887     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 13888
 13889     IF RWF-DTH-PAYCUR LESS THAN ZERO
 13890         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 13891         MOVE ZEROS TO RWF-DTH-PAYCUR.
 13892     IF RWF-DTH-FUTRSV LESS THAN ZERO
 13893         MOVE ZEROS TO RWF-DTH-FUTRSV.
 13894
 13895 3515-REIN-CHK-AH-RSRV-LIMIT.
 13896     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13897         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13898
 13899     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 13900         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 13901
 13902     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 13903                                      (RWF-AHCLM +
 13904                                       RWF-DIS-PAYCUR +
 13905                                       RWF-DIS-FUTRSV).
 13906
 13907     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13908         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13909
 13910     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 13911
 13912     IF RWF-DIS-PAYCURL LESS THAN ZERO
 13913         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 13914         MOVE ZEROS TO RWF-DIS-PAYCURL.
 13915     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 13916         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 13917
 13918     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 13919
 13920     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 270
* ECS010.cbl
 13921         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 13922         MOVE ZEROS TO RWF-DIS-PAYCUR.
 13923     IF RWF-DIS-FUTRSV LESS THAN ZERO
 13924         MOVE ZEROS TO RWF-DIS-FUTRSV.
 13925
 13926 3519-REINSURE-CALC-RESERVE-END.
 13927
 13928     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 13929        OR RWF-DTH-FUTRSV
 13930         MOVE 'X' TO REIN-LF-FLG (SUB1).
 13931
 13932     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 13933        OR RWF-DIS-FUTRSV
 13934         MOVE 'X' TO REIN-AH-FLG (SUB1).
 13935
 13936     GO TO 3540-CONT-REIN-CALC-RESERVE.
 13937
 13938 3520-REIN-REMAINDER-RSRV.
 13939
 13940     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 13941     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 13942     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 13943     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 13944     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 13945     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 13946
 13947     PERFORM 3530-REIN-SUB-RSRV
 13948         THRU 3539-REIN-SUB-RSRV-X
 13949             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 13950
 13951     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 13952
 13953 3530-REIN-SUB-RSRV.
 13954
 13955     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 13956     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 13957     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 13958     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 13959     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 13960     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 13961
 13962 3539-REIN-SUB-RSRV-X.
 13963     EXIT.
 13964
 13965 3540-CONT-REIN-CALC-RESERVE.
 13966
 13967     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 13968         MOVE 'X' TO REIN-BUS-FLAG.
 13969     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 13970
 13971 3599-REINSURE-CALC-RESERVE-X.
 13972     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 271
* ECS010.cbl
 13974******************************************************************
 13975***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 13976******************************************************************
 13977
 13978*REINSURANCE-CALCULATIONS.
*13979                             COPY ECSRIRTN.
 13980******************************************************************04/30/98
 13981*                                                                *ECSRIRTN
 13982*                            ECSRIRTN                            *   LV012
 13983*                            VMOD=2.025.                         *ECSRIRTN
 13984*                                                                *ECSRIRTN
 13985******************************************************************ECSRIRTN
 13986******************************************************************
 13987*                   C H A N G E   L O G
 13988*
 13989* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 13990*-----------------------------------------------------------------
 13991*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 13992* EFFECTIVE    NUMBER
 13993*-----------------------------------------------------------------
 13994* 062703                   PEMA  ADD DCC CLIENT ID TO
 13995*                                SPECIAL CEDED CLAIM CALC
 13996* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 13997* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
 13998                                                                  ECSRIRTN
 13999 REINSURE-CALC.                                                   ECSRIRTN
 14000                                                                  ECSRIRTN
 14001     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 14002     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14003     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 14004     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 14005                                   REIN-REM-SW (SUB1).            ECSRIRTN
 14006                                                                  ECSRIRTN
 14007     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 14008                                   WS-RWF-EP-STOP-DATE-N             CL*12
 14009                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 14010                                                                  ECSRIRTN
 14011     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 14012                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 14013                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 14014                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 14015                                                                  ECSRIRTN
 14016     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14017        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14018          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14019          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14020          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14021                                                                  ECSRIRTN
 14022     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14023        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14024         GO TO CALC-CONTINUED.                                    ECSRIRTN
 14025                                                                  ECSRIRTN
 14026     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 14027                                          WS-RWF-EP-STOP-DATE-N      CL*12
 14028                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 14029                                                                  ECSRIRTN
 14030     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 14031         GO TO CALC-CONTINUED.                                    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 272
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14032                                                                  ECSRIRTN
 14033     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 14034         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 14035                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 14036                                                                  ECSRIRTN
 14037     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 14038         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 14039                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 14040                                                                  ECSRIRTN
 14041 CALC-CONTINUED.                                                  ECSRIRTN
 14042                                                                  ECSRIRTN
 14043     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 14044     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 14045                                                                  ECSRIRTN
 14046     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 14047         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 14048     ELSE                                                         ECSRIRTN
 14049         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 14050     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 14051                                                                  ECSRIRTN
 14052     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 14053     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 14054     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 14055         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 14056     ELSE                                                         ECSRIRTN
 14057         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 14058     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 14059                                                                  ECSRIRTN
 14060     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 14061         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 14062         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 14063         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 14064         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 14065         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 14066         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 14067                                                                  ECSRIRTN
 14068     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14069         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 14070                                                                  ECSRIRTN
 14071     IF CR-DT LESS WT-LO-DATE                                        CL**2
 14072         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14073                                                                  ECSRIRTN
 14074     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 14075         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14076                                                                  ECSRIRTN
 14077     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 14078     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 14079                                                                  ECSRIRTN
 14080     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 14081         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 14082                                                                  ECSRIRTN
 14083     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 14084       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14085        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 14086        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14087           NEXT SENTENCE                                          ECSRIRTN
 14088       ELSE                                                       ECSRIRTN
 14089           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 273
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14090                       REIN-AH-FLG (SUB1).                        ECSRIRTN
 14091                                                                  ECSRIRTN
 14092     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14093         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14094            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 14095             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 14096                                                                  ECSRIRTN
 14097     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14098         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14099            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 14100             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 14101                                                                  ECSRIRTN
 14102     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 14103         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 14104             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 14105                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 14106             ELSE                                                 ECSRIRTN
 14107                 NEXT SENTENCE                                    ECSRIRTN
 14108         ELSE                                                     ECSRIRTN
 14109             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14110                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14111                                                                  ECSRIRTN
 14112     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 14113         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 14114             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 14115                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 14116             ELSE                                                 ECSRIRTN
 14117                 NEXT SENTENCE                                    ECSRIRTN
 14118         ELSE                                                     ECSRIRTN
 14119             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14120                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14121                                                                  ECSRIRTN
 14122     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 14123         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 14124                                                                  ECSRIRTN
 14125     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 14126         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 14127         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14128                                                                  ECSRIRTN
 14129     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 14130         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 14131                                                                  ECSRIRTN
 14132     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 14133         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 14134         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 14135                                                                  ECSRIRTN
 14136     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14137         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14138                                                                  ECSRIRTN
 14139     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14140         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14141                                                                  ECSRIRTN
 14142     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 14143                                                                  ECSRIRTN
 14144 REINSURE-CK-LIFE.                                                ECSRIRTN
 14145                                                                  ECSRIRTN
 14146     IF CR-LFTYP = ZERO                                           ECSRIRTN
 14147         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 274
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14148                                                                  ECSRIRTN
 14149     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 14150         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14151                                                                  ECSRIRTN
 14152     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14153         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 14154             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14155                                                                  ECSRIRTN
 14156     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14157                                                                  ECSRIRTN
 14158     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 14159         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 14160             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14161         ELSE                                                     ECSRIRTN
 14162             NEXT SENTENCE                                        ECSRIRTN
 14163     ELSE                                                         ECSRIRTN
 14164         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 14165             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14166                                                                  ECSRIRTN
 14167     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 14168         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 14169             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14170         ELSE                                                     ECSRIRTN
 14171             NEXT SENTENCE                                        ECSRIRTN
 14172     ELSE                                                         ECSRIRTN
 14173         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 14174             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14175                                                                  ECSRIRTN
 14176     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14177         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 14178             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14179                                                                  ECSRIRTN
 14180     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14181         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 14182            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14183                                                                  ECSRIRTN
 14184     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 14185         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 14186             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14187                                                                  ECSRIRTN
 14188     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 14189         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 14190            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14191                                                                  ECSRIRTN
 14192     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14193         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14194             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14195                                                                  ECSRIRTN
 14196     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 14197         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14198            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 14199            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 14200             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14201                                                                  ECSRIRTN
 14202     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 14203         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14204            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 14205             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 275
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14206                                                                  ECSRIRTN
 14207     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14208         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14209             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14210                                                                  ECSRIRTN
 14211     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14212         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 14213             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14214                                                                  ECSRIRTN
 14215     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 14216        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 14217           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 14218            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14219                                                                  ECSRIRTN
 14220     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14221         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14222            CR-IND-GRP = '1'                                      ECSRIRTN
 14223             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14224                                                                  ECSRIRTN
 14225     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 14226         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14227            CR-IND-GRP = '1'                                      ECSRIRTN
 14228             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14229                                                                  ECSRIRTN
 14230     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 14231         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14232            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 14233            CR-IND-GRP = '1'                                      ECSRIRTN
 14234             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14235                                                                  ECSRIRTN
 14236     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 14237         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14238            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14239            CR-IND-GRP = '1'                                      ECSRIRTN
 14240             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14241                                                                  ECSRIRTN
 14242     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14243         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 14244            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14245                                                                  ECSRIRTN
 14246     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14247        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 14248                                                                  ECSRIRTN
 14249     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 14250         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14251                                                                  ECSRIRTN
 14252     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 14253         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14254                                                                  ECSRIRTN
 14255     IF CR-LF-TERM  NUMERIC                                       00002331
 14256        NEXT SENTENCE                                             00002332
 14257     ELSE                                                         00002333
 14258        MOVE ZEROS               TO CR-LF-TERM                    00002334
 14259     END-IF
 14260                                                                  00002335
 14261     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 14262         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14263                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 276
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14264     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
 14265         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14266                                                                  ECSRIRTN
 14267     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14268                                                                  ECSRIRTN
 14269     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 14270         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14271                                                                  ECSRIRTN
 14272     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 14273         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14274                                                                  ECSRIRTN
 14275     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14276                                                                  ECSRIRTN
 14277 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 14278     EXIT.                                                        ECSRIRTN
 14279                                                                  ECSRIRTN
 14280 REINSURE-CK-AH.                                                  ECSRIRTN
 14281                                                                  ECSRIRTN
 14282     IF CR-AHTYP = ZERO                                           ECSRIRTN
 14283         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14284                                                                  ECSRIRTN
 14285     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 14286         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14287                                                                  ECSRIRTN
 14288     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14289         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 14290             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14291                                                                  ECSRIRTN
 14292     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14293                                                                  ECSRIRTN
 14294     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 14295         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 14296             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 14297         ELSE                                                     ECSRIRTN
 14298             NEXT SENTENCE                                        ECSRIRTN
 14299     ELSE                                                         ECSRIRTN
 14300         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 14301             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14302                                                                  ECSRIRTN
 14303     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14304         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 14305             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14306                                                                  ECSRIRTN
 14307     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14308         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 14309             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14310                                                                  ECSRIRTN
 14311     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14312         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 14313             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14314                                                                  ECSRIRTN
 14315     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14316         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14317             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14318                                                                  ECSRIRTN
 14319     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14320         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 14321            CR-IND-GRP = '1'                                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 277
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14322             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14323                                                                  ECSRIRTN
 14324     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14325         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14326             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14327                                                                  ECSRIRTN
 14328     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14329         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 14330            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14331                                                                  ECSRIRTN
 14332     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 14333         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 14334            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14335                                                                  ECSRIRTN
 14336     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 14337         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 14338             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14339                                                                  ECSRIRTN
 14340     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14341        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 14342                                                                  ECSRIRTN
 14343     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 14344         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14345                                                                  ECSRIRTN
 14346     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 14347         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14348                                                                  ECSRIRTN
 14349     IF CR-AH-TERM  NUMERIC                                       00002331
 14350        NEXT SENTENCE                                             00002332
 14351     ELSE                                                         00002333
 14352        MOVE ZEROS               TO CR-AH-TERM                    00002334
 14353     END-IF
 14354                                                                  00002335
 14355     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 14356         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14357                                                                  ECSRIRTN
 14358     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 14359         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14360                                                                  ECSRIRTN
 14361     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14362                                                                  ECSRIRTN
 14363     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 14364         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 14365             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 14366                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 14367                                                                  ECSRIRTN
 14368     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 14369         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 14370             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 14371                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 14372                                                                  ECSRIRTN
 14373     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 14374     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 14375                                                                  ECSRIRTN
 14376     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 14377         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 14378                                                                  ECSRIRTN
 14379     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 278
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14380         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
 14381                                                                  ECSRIRTN
 14382     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 14383                                                                  ECSRIRTN
 14384     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14385                                                                  ECSRIRTN
 14386     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 14387         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14388                                                                  ECSRIRTN
 14389     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14390         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14391                                                                  ECSRIRTN
 14392     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14393                                                                  ECSRIRTN
 14394 REINSURE-CK-AH-X.                                                ECSRIRTN
 14395     EXIT.                                                        ECSRIRTN
 14396                                                                  ECSRIRTN
 14397 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 14398                                                                  ECSRIRTN
 14399     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 14400        RS-AH-BEN = ZERO                                          ECSRIRTN
 14401         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14402                                                                  ECSRIRTN
 14403     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 14404        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14405         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14406                                                                  ECSRIRTN
 14407     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14408                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 14409                                                                  ECSRIRTN
 14410     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14411         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14412             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 14413                                     WT-AHBEN-HI.                 ECSRIRTN
 14414     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14415         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14416             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 14417                                     WT-AHMOA-HI.                 ECSRIRTN
 14418                                                                  ECSRIRTN
 14419     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14420     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14421                                                                  ECSRIRTN
 14422     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14423         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 14424                                                                  ECSRIRTN
 14425     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14426         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 14427                                                                  ECSRIRTN
 14428     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14429                                                                  ECSRIRTN
 14430     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14431         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 14432                                                                  ECSRIRTN
 14433     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 14434         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 14435                                       / RW-AHWRK                 ECSRIRTN
 14436       ELSE                                                       ECSRIRTN
 14437         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 279
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14438                                                                  ECSRIRTN
 14439     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 14440         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 14441                                       / RS-LIFE-BEN              ECSRIRTN
 14442       ELSE                                                       ECSRIRTN
 14443         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 14444                                                                  ECSRIRTN
 14445     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 14446        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 14447          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14448          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14449                                      / CR-AH-TERM.               ECSRIRTN
 14450                                                                  ECSRIRTN
 14451     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14452        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 14453          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14454          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14455               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14456            ELSE                                                  ECSRIRTN
 14457                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14458                                                                  ECSRIRTN
 14459     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14460        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 14461        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 14462          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14463          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14464                                      / CR-AH-TERM                ECSRIRTN
 14465         ELSE                                                     ECSRIRTN
 14466          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14467          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14468               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14469            ELSE                                                  ECSRIRTN
 14470                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14471                                                                  ECSRIRTN
 14472 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 14473     EXIT.                                                        ECSRIRTN
 14474                                                                  ECSRIRTN
 14475                                                                  ECSRIRTN
 14476 REIN-CALC-LIFE.                                                  ECSRIRTN
 14477                                                                  ECSRIRTN
 14478     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 14479         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 14480     ELSE                                                         ECSRIRTN
 14481         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 14482                                                                  ECSRIRTN
 14483     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 14484         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 14485     ELSE                                                         ECSRIRTN
 14486         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 14487           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 14488               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 14489           ELSE                                                   ECSRIRTN
 14490               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 14491                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 14492                                                                  ECSRIRTN
 14493 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 14494                                                                  ECSRIRTN
 14495     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 280
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14496                                                                  ECSRIRTN
 14497     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14498         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 14499                                                                  ECSRIRTN
 14500     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14501         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 14502         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14503                                                                  ECSRIRTN
 14504     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 14505         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 14506                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14507         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 14508                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14509     ELSE                                                         ECSRIRTN
 14510         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14511             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 14512             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 14513                                                                  ECSRIRTN
 14514     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 14515         (WT-LF-QC = '2' AND                                         CL**8
 14516          PGM-SUB = +50  AND                                         CL**8
 14517          DTE-CLIENT = 'LAP'))                                       CL**8
 14518          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 14519     ELSE                                                         ECSRIRTN
 14520         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 14521                                                                  ECSRIRTN
 14522     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14523         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 14524         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 14525         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 14526                                                                  ECSRIRTN
 14527     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 14528                                                                  ECSRIRTN
 14529 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 14530                                                                  ECSRIRTN
 14531     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14532         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 14533         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14534                                                                  ECSRIRTN
 14535     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 14536     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14537     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 14538                                       RW-LFPRM.                  ECSRIRTN
 14539                                                                  ECSRIRTN
 14540 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 14541                                                                  ECSRIRTN
 14542     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 14543                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14544                                                                  ECSRIRTN
 14545     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14546        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14547                                                                  ECSRIRTN
 14548     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 14549        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14550         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 14551     ELSE                                                         ECSRIRTN
 14552         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14553         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 281
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14554                                                                  ECSRIRTN
 14555                                                                  ECSRIRTN
 14556 REIN-CALC-LIFE-X.                                                ECSRIRTN
 14557     EXIT.                                                        ECSRIRTN
 14558                                                                  ECSRIRTN
 14559 REIN-CALC-AH.                                                    ECSRIRTN
 14560                                                                  ECSRIRTN
 14561     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14562         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14563             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 14564                                 WT-AHBEN-HI.                     ECSRIRTN
 14565                                                                  ECSRIRTN
 14566     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14567         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14568             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 14569                                 WT-AHMOA-HI.                     ECSRIRTN
 14570                                                                  ECSRIRTN
 14571     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14572     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14573                                                                  ECSRIRTN
 14574     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14575         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 14576                                                                  ECSRIRTN
 14577     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14578         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 14579                                                                  ECSRIRTN
 14580     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14581         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 14582                                                                  ECSRIRTN
 14583     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 14584         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 14585     ELSE                                                         ECSRIRTN
 14586         IF WT-REMAINING = 'L'                                    ECSRIRTN
 14587             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 14588         ELSE                                                     ECSRIRTN
 14589             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 14590             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 14591                                                                  ECSRIRTN
 14592 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 14593                                                                  ECSRIRTN
 14594     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14595         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 14596                                                                  ECSRIRTN
 14597     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14598         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 14599         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14600                                                                  ECSRIRTN
 14601     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 14602         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 14603                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14604         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 14605                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14606     ELSE                                                         ECSRIRTN
 14607         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 14608             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 14609             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 14610                                                                  ECSRIRTN
 14611     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 282
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14612         (WT-AH-QC = '2' AND                                         CL**8
 14613          PGM-SUB = +50  AND                                         CL**8
 14614          DTE-CLIENT = 'LAP'))                                       CL**8
 14615         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 14616     ELSE                                                         ECSRIRTN
 14617         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 14618                                                                  ECSRIRTN
 14619     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 14620         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 14621            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 14622                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 14623                                                                  ECSRIRTN
 14624     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14625         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 14626         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 14627         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 14628                                                                  ECSRIRTN
 14629     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 14630                                                                  ECSRIRTN
 14631 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 14632                                                                  ECSRIRTN
 14633     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14634         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 14635         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14636                                                                  ECSRIRTN
 14637     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14638     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14639     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14640                                    RW-AHPRM.                     ECSRIRTN
 14641                                                                  ECSRIRTN
 14642 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 14643                                                                  ECSRIRTN
 14644     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 14645                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14646                                                                  ECSRIRTN
 14647     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14648                                                                  ECSRIRTN
 14649     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 14650        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14651         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 14652     ELSE                                                         ECSRIRTN
 14653         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14654         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 14655                                                                  ECSRIRTN
 14656                                                                  ECSRIRTN
 14657 REIN-CALC-AH-X.                                                  ECSRIRTN
 14658     EXIT.                                                        ECSRIRTN
 14659                                                                  ECSRIRTN
 14660 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 14661                                                                  ECSRIRTN
 14662     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 14663     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 14664     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 14665     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 14666                                                                  ECSRIRTN
 14667     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 14668         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 14669                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 283
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14670     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
 14671        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 14672           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14673                                                                  ECSRIRTN
 14674     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 14675        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 14676           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14677                                                                  ECSRIRTN
 14678 REINSURE-CALC-X.                                                 ECSRIRTN
 14679                                                                  ECSRIRTN
 14680     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14681         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14682                                                                  ECSRIRTN
 14683     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14684                                                                  ECSRIRTN
 14685 REINSURE-SUBTRACT.                                               ECSRIRTN
 14686                                                                  ECSRIRTN
 14687     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 14688     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 14689     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 14690     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 14691                                                                  ECSRIRTN
 14692 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 14693     EXIT.                                                        ECSRIRTN
 14694                                                                  ECSRIRTN
 14695 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 14696                                                                  ECSRIRTN
 14697     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14698     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14699                                                                  ECSRIRTN
 14700     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14701         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 14702                                                                  ECSRIRTN
 14703     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14704         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14705                                                                  ECSRIRTN
 14706     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14707         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 14708             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 14709                                                                  ECSRIRTN
 14710     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14711         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 14712                                                                  ECSRIRTN
 14713     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14714         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 14715         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14716                                                                  ECSRIRTN
 14717     IF CR-LFPRM = ZERO                                           ECSRIRTN
 14718        MOVE ZERO                TO REIN-FACTOR
 14719     ELSE                                                         ECSRIRTN
 14720        IF DTE-CLIENT = 'GIC'  AND
 14721           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14722           MOVE +1.0             TO REIN-FACTOR
 14723        ELSE
 14724           IF DTE-CLIENT = 'DCC'
 14725              COMPUTE REIN-FACTOR = CR-LFRFND /
 14726                 (CR-LFPRM + CR-LFPRM-ALT)
 14727           ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 284
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14728              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 14729                 (CR-LFPRM + CR-LFPRM-ALT)
 14730            END-IF
 14731         END-IF
 14732     END-IF
 14733                                                                  ECSRIRTN
 14734     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14735         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14736             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14737                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 14738                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14739             ELSE                                                 ECSRIRTN
 14740                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14741                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14742                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 14743                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14744         ELSE                                                     ECSRIRTN
 14745             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14746                 compute rein-factor rounded =
 14747                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 14748                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
 14749                    rein-factor
 14750             ELSE                                                 ECSRIRTN
 14751*                COMPUTE RWF-LFRFND = REIN-FACTOR
 14752*                   * REIN-CALCED-LIFE *
 14753*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 14754                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14755                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14756                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 14757                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 14758                                                                  ECSRIRTN
 14759     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14760         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14761             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14762                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14763                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 14764             ELSE                                                 ECSRIRTN
 14765                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14766                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14767                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14768                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 14769                                                                  ECSRIRTN
 14770     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 14771                                                                  ECSRIRTN
 14772                                                                  ECSRIRTN
 14773 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 14774                                                                  ECSRIRTN
 14775     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14776       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 14777         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14778         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14779                                                                  ECSRIRTN
 14780     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14781       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 14782           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 14783           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 14784       ELSE                                                       ECSRIRTN
 14785           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 285
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14786               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 14787                                                                  ECSRIRTN
 14788     IF FLAT-CANCEL-LF                                            ECSRIRTN
 14789         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 14790         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14791                                                                  ECSRIRTN
 14792     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 14793         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14794         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14795                                                                  ECSRIRTN
 14796     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 14797     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14798     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 14799                                         RW-LFRFND.               ECSRIRTN
 14800                                                                  ECSRIRTN
 14801 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14802                                                                  ECSRIRTN
 14803     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 14804                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14805                                                                  ECSRIRTN
 14806     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14807        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14808                                                                  ECSRIRTN
 14809     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 14810        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14811         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 14812     ELSE                                                         ECSRIRTN
 14813         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14814         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 14815                                                                  ECSRIRTN
 14816                                                                  ECSRIRTN
 14817 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 14818                                                                  ECSRIRTN
 14819     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14820         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14821                                                                  ECSRIRTN
 14822     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14823         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 14824             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 14825                                                                  ECSRIRTN
 14826     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14827         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 14828         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 14829             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 14830                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14831         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14832                                                                  ECSRIRTN
 14833     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14834         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 14835                                                                  ECSRIRTN
 14836     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14837         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 14838         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14839                                                                  ECSRIRTN
 14840     IF CR-AHPRM = ZERO                                           ECSRIRTN
 14841        MOVE ZERO                TO REIN-FACTOR
 14842     ELSE
 14843        IF DTE-CLIENT = 'GIC'  AND
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 286
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14844           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14845            MOVE +1.0            TO REIN-FACTOR
 14846        ELSE
 14847           IF DTE-CLIENT = 'DCC'
 14848              COMPUTE REIN-FACTOR =
 14849                 CR-AHRFND / CR-AHPRM
 14850           ELSE
 14851              COMPUTE REIN-FACTOR ROUNDED =
 14852                                CR-AHRFND-CALC / CR-AHPRM
 14853           END-IF
 14854        END-IF
 14855     END-IF
 14856
 14857     IF CR-AHAMT NOT = ZERO
 14858        IF (DTE-CLIENT = 'DCC')
 14859           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14860           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14861        ELSE
 14862           IF WT-AH-QC = ('1' OR '4')
 14863              compute rein-factor rounded = rwf-ahamt / cr-ahamt
 14864              compute rwf-ahrfnd rounded =
 14865                 cr-ahrfnd * rein-factor
 14866           ELSE
 14867              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14868              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14869                       RWF-AHAMT) / CR-AHAMT
 14870           END-IF
 14871        END-IF
 14872     ELSE
 14873        IF RWF-AH-LIMIT = ZERO
 14874           IF WT-AH-QC = ('1' OR '4')
 14875              COMPUTE RWF-AHRFND ROUNDED =
 14876                       CR-AHRFND * WT-AH-PCT
 14877           ELSE
 14878              COMPUTE RWF-AHRFND =
 14879                            REIN-FACTOR * REIN-CALCED-AH
 14880              COMPUTE RWF-AHRFND ROUNDED =
 14881                       RWF-AHRFND * WT-AH-PCT
 14882           END-IF
 14883        END-IF
 14884     END-IF
 14885
 14886     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 14887                                                                  ECSRIRTN
 14888                                                                  ECSRIRTN
 14889 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 14890                                                                  ECSRIRTN
 14891     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14892       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 14893         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14894         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14895                                                                  ECSRIRTN
 14896     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14897       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 14898           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 14899           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 14900       ELSE                                                       ECSRIRTN
 14901           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 287
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14902               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 14903                                                                  ECSRIRTN
 14904     IF FLAT-CANCEL-AH                                            ECSRIRTN
 14905         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
 14906         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14907                                                                  ECSRIRTN
 14908     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 14909         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14910         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14911                                                                  ECSRIRTN
 14912     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14913     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14914     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14915                                    RW-AHRFND.                    ECSRIRTN
 14916                                                                  ECSRIRTN
 14917 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14918                                                                  ECSRIRTN
 14919     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 14920                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14921                                                                  ECSRIRTN
 14922     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14923                                                                  ECSRIRTN
 14924     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 14925        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14926         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 14927     ELSE                                                         ECSRIRTN
 14928         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14929         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 14930                                                                  ECSRIRTN
 14931                                                                  ECSRIRTN
 14932 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 14933                                                                  ECSRIRTN
 14934     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14935         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14936                                                                  ECSRIRTN
 14937     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14938         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14939                                                                  ECSRIRTN
 14940     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 14941                                                                  ECSRIRTN
 14942 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 14943                                                                  ECSRIRTN
 14944     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 14945     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 14946                                                                  ECSRIRTN
 14947     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 14948         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 14949             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14950                                                                  ECSRIRTN
 14951     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14952         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14953                                                                  ECSRIRTN
 14954     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14955         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14956                                                                  ECSRIRTN
 14957 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 14958                                                                  ECSRIRTN
 14959     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 288
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14960         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14961                                                                  ECSRIRTN
 14962     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14963                                                                  ECSRIRTN
 14964 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 14965                                                                  ECSRIRTN
 14966     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 14967     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 14968                                                                  ECSRIRTN
 14969 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 14970     EXIT.                                                        ECSRIRTN
 14971                                                                  ECSRIRTN
 14972 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 14973                                                                  ECSRIRTN
 14974     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14975         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 14976                                                                  ECSRIRTN
 14977 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 14978     EXIT.                                                        ECSRIRTN
 14979                                                                  ECSRIRTN
 14980 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 14981                                                                  ECSRIRTN
 14982     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14983     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14984                                                                  ECSRIRTN
 14985     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14986         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 14987                                                                  ECSRIRTN
 14988     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14989        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14990          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14991          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14992          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14993                                                                  ECSRIRTN
 14994     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14995        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14996          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 14997                                                                  ECSRIRTN
 14998     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 14999                                  RWF-AHCLML.                     ECSRIRTN
 15000                                                                  ECSRIRTN
 15001     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 15002         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15003                                                                  ECSRIRTN
 15004     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 15005         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15006                                                                  ECSRIRTN
 15007     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15008         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15009             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 15010                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 15011                                                                  ECSRIRTN
 15012     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 15013         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15014                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 15015                                                                  ECSRIRTN
 15016     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15017         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 289
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15018                                                                  ECSRIRTN
 15019     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15020         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15021             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
 15022                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 15023             ELSE                                                 ECSRIRTN
 15024                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 15025         ELSE                                                     ECSRIRTN
 15026             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 15027                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 15028                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 15029             ELSE                                                 ECSRIRTN
 15030                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 15031                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 15032                                                                  ECSRIRTN
 15033     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15034         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15035                                                                  ECSRIRTN
 15036     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 15037         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 15038            OR 'DCC'
 15039             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 15040                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 15041         ELSE                                                     ECSRIRTN
 15042             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 15043                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 15044                                                                  ECSRIRTN
 15045     IF CR-LFAMT = ZERO                                           ECSRIRTN
 15046         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 15047             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15048                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 15049                                                                  ECSRIRTN
 15050     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15051         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15052             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15053                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 15054                                                                  ECSRIRTN
 15055     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15056         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15057             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15058               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 15059                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15060                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15061                  ELSE                                            ECSRIRTN
 15062                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 15063                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15064              ELSE                                                ECSRIRTN
 15065                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 15066                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 15067                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 15068                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 15069                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15070                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 15071                                                                  ECSRIRTN
 15072     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15073                                                                  ECSRIRTN
 15074     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 15075                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 290
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15076                                                                  ECSRIRTN
 15077 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 15078                                                                  ECSRIRTN
 15079     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 15080         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15081                                                                  ECSRIRTN
 15082     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 15083         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 15084     ELSE                                                         ECSRIRTN
 15085         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 15086                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 15087                                                                  ECSRIRTN
 15088     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15089         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15090                                                                  ECSRIRTN
 15091     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15092         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 15093             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15094         ELSE                                                     ECSRIRTN
 15095             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 15096     ELSE                                                         ECSRIRTN
 15097         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 15098             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 15099             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15100         ELSE                                                     ECSRIRTN
 15101             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 15102             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 15103                                                                  ECSRIRTN
 15104                                                                  ECSRIRTN
 15105 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 15106                                                                  ECSRIRTN
 15107     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 15108         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 15109                                                                  ECSRIRTN
 15110     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15111         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15112                                                                  ECSRIRTN
 15113     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 15114         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 15115                                                                  ECSRIRTN
 15116     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 15117     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 15118                                                                  ECSRIRTN
 15119     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 15120             VARYING                                              ECSRIRTN
 15121         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 15122             UNTIL                                                ECSRIRTN
 15123         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 15124                                                                  ECSRIRTN
 15125     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15126         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 15127     ELSE                                                         ECSRIRTN
 15128         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 15129                                                                  ECSRIRTN
 15130 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 15131                                                                  ECSRIRTN
 15132     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 15133         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 291
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15134                                                                  ECSRIRTN
 15135     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15136       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 15137           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
 15138                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 15139               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15140                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15141               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 15142                                                                  ECSRIRTN
 15143     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15144       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 15145           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15146                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15147           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 15148                                                                  ECSRIRTN
 15149     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 15150         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15151                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15152                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 15153         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15154                                                                  ECSRIRTN
 15155     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15156         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15157                                                                  ECSRIRTN
 15158     IF INC-SUB = +1                                              ECSRIRTN
 15159         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15160     IF INC-SUB = +2                                              ECSRIRTN
 15161         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15162     IF INC-SUB = +3                                              ECSRIRTN
 15163         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15164     IF INC-SUB = +4                                              ECSRIRTN
 15165         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15166     IF INC-SUB = +5                                              ECSRIRTN
 15167         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15168                                                                  ECSRIRTN
 15169     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15170                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15171                                                                  ECSRIRTN
 15172     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15173         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15174                                                                  ECSRIRTN
 15175     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 15176              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 15177         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 15178     ELSE                                                         ECSRIRTN
 15179         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15180                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15181                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 15182                                                                  ECSRIRTN
 15183 CHECK-DISABS-EXIT.                                               ECSRIRTN
 15184      EXIT.                                                       ECSRIRTN
 15185                                                                  ECSRIRTN
 15186 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 15187                                                                  ECSRIRTN
 15188     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15189         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15190                                                                  ECSRIRTN
 15191     IF CO-SUB NOT = ZERO                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 292
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15192         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15193             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 15194                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 15195                                                                  ECSRIRTN
 15196     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15197         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15198             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 15199                                                                  ECSRIRTN
 15200 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 15201                                                                  ECSRIRTN
 15202     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 15203         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 15204         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 15205             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 15206                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 15207         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 15208         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15209                                                                  ECSRIRTN
 15210     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15211         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 15212                                                                  ECSRIRTN
 15213     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15214         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15215             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 15216                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15217             ELSE                                                 ECSRIRTN
 15218                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 15219         ELSE                                                     ECSRIRTN
 15220             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 15221                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 15222                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15223             ELSE                                                 ECSRIRTN
 15224                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 15225                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 15226                                                                  ECSRIRTN
 15227     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15228         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15229                                                                  ECSRIRTN
 15230     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15231         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 15232                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 15233     ELSE                                                         ECSRIRTN
 15234         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 15235             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15236                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 15237                                                                  ECSRIRTN
 15238     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15239         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15240             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15241                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 15242                                                                  ECSRIRTN
 15243     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15244         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15245             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15246               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 15247                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15248                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15249                  ELSE                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 293
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15250                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 15251                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15252              ELSE                                                ECSRIRTN
 15253                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
 15254                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 15255                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 15256                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 15257                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15258                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 15259                                                                  ECSRIRTN
 15260                                                                  ECSRIRTN
 15261     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 15262        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 15263                               '220000' OR '230000')              ECSRIRTN
 15264           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 15265               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 15266                                                                  ECSRIRTN
 15267     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15268                                                                  ECSRIRTN
 15269     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 15270                                                                  ECSRIRTN
 15271                                                                  ECSRIRTN
 15272 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 15273                                                                  ECSRIRTN
 15274     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15275         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15276                                                                  ECSRIRTN
 15277     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15278         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 15279         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15280                                                                  ECSRIRTN
 15281     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15282                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15283                                                                  ECSRIRTN
 15284     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15285         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15286                                                                  ECSRIRTN
 15287     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15288         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15289                                                                  ECSRIRTN
 15290     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 15291                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15292         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 15293                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 15294         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 15295     ELSE                                                         ECSRIRTN
 15296         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 15297         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 15298                                                                  ECSRIRTN
 15299                                                                  ECSRIRTN
 15300 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 15301                                                                  ECSRIRTN
 15302     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15303         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15304                                                                  ECSRIRTN
 15305     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15306         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15307                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 294
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15308     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 15309                                                                  ECSRIRTN
 15310 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 15311                                                                  ECSRIRTN
 15312     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 15313     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 15314                                                                  ECSRIRTN
 15315     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 15316         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 15317             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 15318                                                                  ECSRIRTN
 15319     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15320     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15321                                                                  ECSRIRTN
 15322     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15323         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15324                                                                  ECSRIRTN
 15325     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15326         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15327                                                                  ECSRIRTN
 15328 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 15329                                                                  ECSRIRTN
 15330     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 15331         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 15332                                                                  ECSRIRTN
 15333     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 15334                                                                  ECSRIRTN
 15335 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 15336                                                                  ECSRIRTN
 15337     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 15338     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 15339                                                                  ECSRIRTN
 15340 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 15341     EXIT.                                                        ECSRIRTN
 15342                                                                  ECSRIRTN
 15343 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 15344                                                                  ECSRIRTN
 15345     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 15346         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 15347                                                                  ECSRIRTN
 15348 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 15349     EXIT.                                                        ECSRIRTN
 15350                                                                  ECSRIRTN
 15351                                                                  ECSRIRTN
 15352 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 15353                                                                  ECSRIRTN
 15354     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 15355     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 15356     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 15357     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 15358                                                                  ECSRIRTN
 15359     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 15360         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 15361         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 15362         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 15363         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 15364         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 15365         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 295
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15366         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 15367         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 15368         REIN-AH-LIMIT (1).                                       ECSRIRTN
 15369                                                                  ECSRIRTN
 15370     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 15371         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 15372                                                                  ECSRIRTN
 15373     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 15374                                                                  ECSRIRTN
 15375 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 15376                                                                  ECSRIRTN
 15377     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 15378                                                                  ECSRIRTN
 15379 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 15380     EXIT.                                                        ECSRIRTN
 15381                                                                  ECSRIRTN
 15382 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 15383                                                                  ECSRIRTN
 15384     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 15385                                                                  ECSRIRTN
 15386     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 15387         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 15388                                                                  ECSRIRTN
 15389     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15390         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 15391             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 15392                                                                  ECSRIRTN
 15393     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15394         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 15395         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 15396         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 15397     ELSE                                                         ECSRIRTN
 15398         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 15399         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 15400         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 15401                                                                  ECSRIRTN
 15402     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 15403                                                                  ECSRIRTN
 15404     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 15405        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 15406         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 15407                                                                  ECSRIRTN
 15408     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 15409         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 15410                                                                  ECSRIRTN
 15411 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 15412     EXIT.                                                        ECSRIRTN
 15413                                                                  ECSRIRTN
 15414 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 15415                                                                  ECSRIRTN
 15416     CONTINUE.                                                    ECSRIRTN
 15417*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 15418 FIND-REI-CO-EXIT.                                                ECSRIRTN
 15419     EXIT.                                                        ECSRIRTN
 15420                                                                  ECSRIRTN
 15421 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 15422                                                                  ECSRIRTN
 15423     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 296
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15424         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15425                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15426                                                                  ECSRIRTN
 15427     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
 15428         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15429                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15430                                                                  ECSRIRTN
 15431     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 15432                                                                  ECSRIRTN
 15433     START ERRTBL-IN                                              ECSRIRTN
 15434           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 15435             INVALID KEY                                          ECSRIRTN
 15436               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 15437                                                                  ECSRIRTN
 15438     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 15439     MOVE 0 TO SUB1.                                              ECSRIRTN
 15440 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 15441                                                                  ECSRIRTN
 15442     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 15443                                                                  ECSRIRTN
 15444     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 15445        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 15446                                                                  ECSRIRTN
 15447     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 15448        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 15449        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 15450                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15451        GO TO ABEND-PGM.                                          ECSRIRTN
 15452                                                                  ECSRIRTN
 15453     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 15454        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 15455                                                                  ECSRIRTN
 15456     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 15457        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 15458                                                                  ECSRIRTN
 15459     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 15460        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 15461                                                                  ECSRIRTN
 15462     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 15463        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 15464                                                                  ECSRIRTN
 15465     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 15466        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15467                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 15468        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 296)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15469                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 15470        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 296)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15471                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 15472     END-PERFORM.                                                 ECSRIRTN
 15473     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 15474                                                                  ECSRIRTN
 15475     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 297
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15476        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 15477                                                                  ECSRIRTN
 15478     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15479        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
 15480                                                                  ECSRIRTN
 15481     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15482        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 15483                                                                  ECSRIRTN
 15484     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15485        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 15486                                                                  ECSRIRTN
 15487     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 15488        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 15489        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 15490        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 15491        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 15492        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 15493        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 15494          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 15495                                                                  ECSRIRTN
 15496     ADD +1 TO CO-SUB.                                            ECSRIRTN
 15497                                                                  ECSRIRTN
 15498     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 15499        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 15500        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 15501        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 15502        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15503                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15504        GO TO ABEND-PGM.                                          ECSRIRTN
 15505                                                                  ECSRIRTN
 15506     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 15507                                                                  ECSRIRTN
 15508     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 15509                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 15510     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 15511                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 15512     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 15513                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 15514                                                                  ECSRIRTN
 15515     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 15516         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 15517     ELSE                                                         ECSRIRTN
 15518         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 15519                                                                  ECSRIRTN
 15520     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 15521     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 15522     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 15523     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 15524                                                                  ECSRIRTN
 15525 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 15526                                                                  ECSRIRTN
 15527     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15528        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 15529                                                                  ECSRIRTN
 15530     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15531        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 15532                                                                  ECSRIRTN
 15533     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 298
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15534        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 15535                                                                  ECSRIRTN
 15536     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15537        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
 15538                                                                  ECSRIRTN
 15539     ADD +1 TO SUB1.                                              ECSRIRTN
 15540                                                                  ECSRIRTN
 15541     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 15542        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 15543        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15544                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15545        GO TO ABEND-PGM.                                          ECSRIRTN
 15546                                                                  ECSRIRTN
 15547     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 15548     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 15549     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 15550     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 15551     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 15552     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 15553     if re-state-exhibit-opt-f = 'Y'
 15554        move 'Y'         to rc2-ecs152-rpt (sub1)
 15555     else
 15556        move 'N'         to rc2-ecs152-rpt (sub1)
 15557     end-if
 15558                                                                  ECSRIRTN
 15559     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 15560                                                                  ECSRIRTN
 15561 REIN-BUILD-EXIT.                                                 ECSRIRTN
 15562     EXIT.                                                        ECSRIRTN
 15563                                                                  ECSRIRTN
 15564 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 15565                                                                  ECSRIRTN
 15566     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 15567                                                                  ECSRIRTN
 15568     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 15569                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 15570                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 15571                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 15572                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 15573                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 15574                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15575                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15576                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 15577                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 15578                                                                  ECSRIRTN
 15579 ZERO-RCT-EXIT.                                                   ECSRIRTN
 15580     EXIT.                                                        ECSRIRTN
 15581                                                                  ECSRIRTN
 15582 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 15583                                                                  ECSRIRTN
 15584     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 15585                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 15586     move spaces      to rc2-ecs152-rpt (co-sub)
 15587                                                                  ECSRIRTN
 15588     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 15589                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 15590                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 15591                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 299
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15592                                                                  ECSRIRTN
 15593 ZERO-RC2-EXIT.                                                   ECSRIRTN
 15594     EXIT.                                                        ECSRIRTN
 15595******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 300
* ECS010.cbl
 15597******************************************************************
 15598***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 15599******************************************************************
 15600
 15601 3600-RC-REINSURANCE.
 15602
 15603     IF DTE-PGM-OPT NOT = '1'
 15604         GO TO 3799-RC-REINSURANCE-X.
 15605
 15606     IF DTE-CLIENT = 'WSL'
 15607         IF CR-REIN-TABLE = '00A'
 15608             GO TO 3799-RC-REINSURANCE-X.
 15609
 15610     IF CR-REIN-TABLE = SPACES OR ZEROS
 15611         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15612
 15613 3610-CLEAR-RC-REIN.
 15614
 15615     MOVE SPACES TO RC-REIN-LEVELS (1).
 15616     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 15617                    RC-REIN-LFPRM (1)
 15618                    RC-REIN-AHAMT (1)
 15619                    RC-REIN-AHPRM (1)
 15620                    RC-REIN-LFRFND (1)
 15621                    RC-REIN-AHRFND (1)
 15622                    RC-REIN-LFCLM (1)
 15623                    RC-REIN-AHCLM (1).
 15624
 15625     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 15626         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 15627
 15628     MOVE +1 TO SUB1.
 15629     MOVE +0 TO SUB2.
 15630
 15631     GO TO 3630-RC-REIN-LOOP-1.
 15632
 15633 3620-CLEAR-RC-LEVELS.
 15634
 15635     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 15636
 15637
 15638 3630-RC-REIN-LOOP-1.
 15639
 15640     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 15641         ADD +1 TO SUB2
 15642         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 15643         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 15644         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 15645         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 15646         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 15647         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 15648         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 15649         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 15650         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 15651         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 15652
 15653     ADD +1 TO SUB1.
 15654     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 301
* ECS010.cbl
 15655         GO TO 3630-RC-REIN-LOOP-1.
 15656
 15657     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15658
 15659     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 15660     IF CR-REIN-TABLE = SPACES OR ZEROS
 15661         MOVE +1                     TO SUB1
 15662         GO TO 3710-RC-REIN-LOOP-2.
 15663
 15664     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 15665
 15666 3640-NSP-REIN-RATING-ROUTINE.
 15667
 15668     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 15669     MOVE 'L'                        TO DC-OPTION-CODE.
 15670     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15671     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 15672     MOVE SPACES                     TO CP-ACCT-FLD-5.
 15673     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 15674     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 15675     MOVE CR-APR                     TO CP-LOAN-APR.
 15676     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 15677     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 15678     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 15679     MOVE ZEROS                      TO CP-CLASS-CODE.
 15680
 15681     IF DTE-CLIENT = 'TIC'
 15682        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 15683            MOVE ZERO                TO CP-CLASS-CODE
 15684        ELSE
 15685            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 15686
 15687     MOVE '3'                        TO CP-PROCESS-TYPE.
 15688     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 15689     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 15690
 15691 3650-NSP-REIN-LIFE.
 15692
 15693     IF CR-LFTYP = ZERO
 15694         GO TO 3660-NSP-REIN-AH.
 15695     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 15696        OR (DTE-CLIENT = 'DCC')
 15697         GO TO 3660-NSP-REIN-AH.
 15698     IF DTE-CLIENT NOT = 'LBL'
 15699         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 15700             GO TO 3660-NSP-REIN-AH.
 15701
 15702     IF RE-NSP-ST-CD-LF NOT = STATE-L
 15703         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 15704         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15705
 15706     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 15707     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 15708     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 15709                                        CP-RATING-BENEFIT-AMT.
 15710     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 15711     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 15712     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 302
* ECS010.cbl
 15713     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 15714     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15715     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 15716     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15717
 15718     IF CP-STATE-STD-ABBRV = 'OR'
 15719         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 15720
 15721     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15722
 15723     IF CP-ERROR-RATE-NOT-FOUND  OR
 15724        CP-ERROR-RATE-IS-ZERO
 15725         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 15726                                     TO WS-ABEND-MESSAGE
 15727         MOVE 0302                   TO WS-ABEND-CODE
 15728         DISPLAY '******************************'
 15729         DISPLAY '***** ERROR LOCATION 018 *****'
 15730         DISPLAY '******************************'
 15731         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15732         GO TO ABEND-PGM.
 15733
 15734     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 15735
 15736*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 15737*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 15738
 15739     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 15740                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 15741
 15742     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 15743
 15744 3660-NSP-REIN-AH.
 15745
 15746     IF CR-AHTYP = ZERO
 15747         GO TO 3669-NSP-REIN-X.
 15748     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 15749        OR (DTE-CLIENT = 'DCC')
 15750         GO TO 3669-NSP-REIN-X.
 15751     IF DTE-CLIENT NOT = 'LBL'
 15752         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 15753             GO TO 3669-NSP-REIN-X.
 15754
 15755     IF RE-NSP-ST-CD-AH NOT = STATE-L
 15756         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 15757         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15758
 15759     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 15760     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 15761     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 15762                                        CP-RATING-BENEFIT-AMT.
 15763     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 15764     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 15765     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 15766     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 15767     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15768     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 15769     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15770
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 303
* ECS010.cbl
 15771     IF CP-STATE-STD-ABBRV = 'OR'
 15772         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 15773
 15774     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15775
 15776     IF CP-ERROR-RATE-NOT-FOUND  OR
 15777        CP-ERROR-RATE-IS-ZERO
 15778         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 15779                                     TO WS-ABEND-MESSAGE
 15780         MOVE 0302                   TO WS-ABEND-CODE
 15781         DISPLAY '******************************'
 15782         DISPLAY '***** ERROR LOCATION 019 *****'
 15783         DISPLAY '******************************'
 15784         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15785         GO TO ABEND-PGM.
 15786
 15787     COMPUTE CR-AH-NSP-PRM ROUNDED =
 15788             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 15789
 15790     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 15791
 15792 3669-NSP-REIN-X.
 15793     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 304
* ECS010.cbl
 15795******************************************************************
 15796***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 15797******************************************************************
 15798
 15799 3700-RC-REIN-PERF-CALC.
 15800
*15801                             COPY ECSRTPFM.
 15802******************************************************************07/10/97
 15803*                                                                *ECSRTPFM
 15804*                            ECSRTPFM                            *   LV001
 15805*                            VMOD=2.002                          *ECSRTPFM
 15806*                                                                *ECSRTPFM
 15807******************************************************************ECSRTPFM
 15808                                                                  ECSRTPFM
 15809     IF    CR-LFAMT  NUMERIC                                      00000072
 15810           NEXT SENTENCE                                          00000073
 15811        ELSE                                                      00000074
 15812           MOVE ZEROS TO CR-LFAMT.                                00000075
 15813                                                                  00000076
 15814     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 15815           NEXT SENTENCE                                          00000078
 15816        ELSE                                                      00000079
 15817           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 15818                                                                  00000081
 15819                                                                  00000082
 15820     IF    CR-LFPRM  NUMERIC                                      00000083
 15821           NEXT SENTENCE                                          00000084
 15822        ELSE                                                      00000085
 15823           MOVE ZEROS TO CR-LFPRM.                                00000086
 15824                                                                  00000087
 15825     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 15826           NEXT SENTENCE                                          00000089
 15827        ELSE                                                      00000090
 15828           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 15829                                                                  00000092
 15830                                                                  00000093
 15831     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 15832           NEXT SENTENCE                                          00000095
 15833        ELSE                                                      00000096
 15834           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 15835                                                                  00000098
 15836     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 15837           NEXT SENTENCE                                          00000100
 15838        ELSE                                                      00000101
 15839           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 15840                                                                  00000103
 15841     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 15842           NEXT SENTENCE                                          00000105
 15843        ELSE                                                      00000106
 15844           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15845                                                                  00000108
 15846     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15847     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15848     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15849         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15850     ELSE                                                         ECSRTPFM
 15851         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15852     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 305
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15853                                                                  ECSRTPFM
 15854     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15855     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15856     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15857         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15858     ELSE                                                         ECSRTPFM
 15859         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15860     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15861                                                                  ECSRTPFM
 15862     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15863         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15864             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15865                                                                  ECSRTPFM
 15866
 15867     IF CR-STATE NOT = STATE-L
 15868         MOVE CR-STATE               TO STATE-L
 15869         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15870
 15871     MOVE 'X'                     TO REIN-RT-SW.
 15872     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15873     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15874     MOVE ' '                     TO REIN-RT-SW.
 15875
 15876 3710-RC-REIN-LOOP-2.
 15877
 15878     IF REIN-COMP (SUB1) = SPACES
 15879         GO TO 3730-RC-REIN-EXTRACTS.
 15880
 15881     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 15882        ADD +1 TO SUB1
 15883         GO TO 3710-RC-REIN-LOOP-2.
 15884
 15885     MOVE +1 TO SUB2.
 15886
 15887 3720-RC-REIN-LOOP-3.
 15888
 15889     IF RC-REIN-COMP (SUB2) = SPACES
 15890         ADD +1 TO SUB1
 15891         GO TO 3710-RC-REIN-LOOP-2.
 15892
 15893     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 15894         ADD +1 TO SUB2
 15895         GO TO 3720-RC-REIN-LOOP-3.
 15896
 15897     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 15898        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 15899        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 15900        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 15901         MOVE 'X' TO RC-OLD-ISS (SUB2)
 15902         MOVE 'X' TO RC-NEW-ISS (SUB1).
 15903
 15904     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 15905        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 15906         MOVE 'X' TO RC-OLD-CNC (SUB2)
 15907         MOVE 'X' TO RC-NEW-CNC (SUB1).
 15908
 15909     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 15910         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 306
* ECS010.cbl
 15911         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 15912
 15913     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 15914         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 15915         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 15916
 15917     ADD +1 TO SUB2.
 15918     GO TO 3720-RC-REIN-LOOP-3.
 15919
 15920 3730-RC-REIN-EXTRACTS.
 15921
 15922     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 15923     MOVE 'R' TO DE-REIN.
 15924     MOVE 'J' TO DE-TRANS.
 15925*****PERFORM EXTRACT-DATE-RELOAD.
 15926     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 15927     MOVE +1 TO SUB1.
 15928
 15929 3740-RC-REIN-OLD-ISSUE.
 15930
 15931     IF RC-REIN-COMP (SUB1) = SPACES
 15932         MOVE +1 TO SUB1
 15933         GO TO 3745-RC-REIN-NEW-ISSUE.
 15934
 15935     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15936         ADD +1 TO SUB1
 15937         GO TO 3740-RC-REIN-OLD-ISSUE.
 15938
 15939     IF RC-OLD-ISS (SUB1) = 'X'
 15940         ADD +1 TO SUB1
 15941         GO TO 3740-RC-REIN-OLD-ISSUE.
 15942
 15943     IF RC-REIN-LFAMT (SUB1) = ZERO
 15944        AND RC-REIN-LFPRM (SUB1) = ZERO
 15945        AND RC-REIN-AHAMT (SUB1) = ZERO
 15946        AND RC-REIN-AHPRM (SUB1) = ZERO
 15947         ADD +1 TO SUB1
 15948         GO TO 3740-RC-REIN-OLD-ISSUE.
 15949
 15950     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 15951     PERFORM EXTRACT-DATE-LOAD.
 15952     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15953     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 15954     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 15955     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 15956     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 15957     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15958
 15959     ADD +1 TO BC-R-ISS.
 15960     ADD +1 TO SUB1.
 15961     GO TO 3740-RC-REIN-OLD-ISSUE.
 15962
 15963 3745-RC-REIN-NEW-ISSUE.
 15964
 15965     IF REIN-COMP (SUB1) = SPACES
 15966         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 15967                                         2259-END-CANCEL-BUILD
 15968         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 307
* ECS010.cbl
 15969         MOVE 'K'      TO DE-TRANS
 15970*********PERFORM EXTRACT-DATE-RELOAD
 15971         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15972         MOVE +1       TO SUB1
 15973         GO TO 3750-RC-REIN-OLD-CANCEL.
 15974
 15975     IF REIN-REM-SW (SUB1) = 'Z'
 15976         ADD +1 TO SUB1
 15977         GO TO 3745-RC-REIN-NEW-ISSUE.
 15978
 15979     IF RC-NEW-ISS (SUB1) = 'X'
 15980         ADD +1 TO SUB1
 15981         GO TO 3745-RC-REIN-NEW-ISSUE.
 15982
 15983     IF REIN-LFAMT (SUB1) = ZERO
 15984        AND REIN-LFPRM (SUB1) = ZERO
 15985        AND REIN-AHAMT (SUB1) = ZERO
 15986        AND REIN-AHPRM (SUB1) = ZERO
 15987         ADD +1 TO SUB1
 15988         GO TO 3745-RC-REIN-NEW-ISSUE.
 15989
 15990     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15991     PERFORM EXTRACT-DATE-LOAD.
 15992     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15993     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15994     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15995     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15996     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15997     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15998
 15999     ADD +1 TO BC-R-ISS.
 16000     ADD +1 TO SUB1.
 16001     GO TO 3745-RC-REIN-NEW-ISSUE.
 16002
 16003 3750-RC-REIN-OLD-CANCEL.
 16004
 16005     IF RC-REIN-COMP (SUB1) = SPACES
 16006         MOVE +1 TO SUB1
 16007         GO TO 3755-RC-REIN-NEW-CANCEL.
 16008
 16009     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16010         ADD +1 TO SUB1
 16011         GO TO 3750-RC-REIN-OLD-CANCEL.
 16012
 16013     IF RC-OLD-CNC (SUB1) = 'X'
 16014         ADD +1 TO SUB1
 16015         GO TO 3750-RC-REIN-OLD-CANCEL.
 16016
 16017     IF RC-REIN-LFRFND (SUB1) = ZERO
 16018        AND RC-REIN-AHRFND (SUB1) = ZERO
 16019         ADD +1 TO SUB1
 16020         GO TO 3750-RC-REIN-OLD-CANCEL.
 16021
 16022     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 16023     PERFORM EXTRACT-DATE-LOAD.
 16024     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 16025     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 16026     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 308
* ECS010.cbl
 16027     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16028
 16029     ADD +1 TO BC-R-CNC.
 16030     ADD +1 TO SUB1.
 16031     GO TO 3750-RC-REIN-OLD-CANCEL.
 16032
 16033 3755-RC-REIN-NEW-CANCEL.
 16034
 16035     IF REIN-COMP (SUB1) = SPACES
 16036         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 16037         MOVE 'R' TO DE-REIN
 16038         MOVE 'L' TO DE-TRANS
 16039*********PERFORM EXTRACT-DATE-RELOAD
 16040         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 16041         MOVE +1 TO SUB1
 16042         GO TO 3760-RC-REIN-OLD-CLAIM.
 16043
 16044     IF REIN-REM-SW (SUB1) = 'Z'
 16045         ADD +1 TO SUB1
 16046         GO TO 3755-RC-REIN-NEW-CANCEL.
 16047
 16048     IF RC-NEW-CNC (SUB1) = 'X'
 16049         ADD +1 TO SUB1
 16050         GO TO 3755-RC-REIN-NEW-CANCEL.
 16051
 16052     IF REIN-LFRFND (SUB1) = ZERO
 16053        AND REIN-AHRFND (SUB1) = ZERO
 16054         ADD +1 TO SUB1
 16055         GO TO 3755-RC-REIN-NEW-CANCEL.
 16056
 16057     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 16058     PERFORM EXTRACT-DATE-LOAD.
 16059     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 16060     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 16061     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 16062     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16063
 16064     ADD +1 TO BC-R-CNC.
 16065     ADD +1 TO SUB1.
 16066     GO TO 3755-RC-REIN-NEW-CANCEL.
 16067
 16068 3760-RC-REIN-OLD-CLAIM.
 16069
 16070     IF RC-REIN-COMP (SUB1) = SPACES
 16071         MOVE +1 TO SUB1
 16072         GO TO 3780-RC-REIN-NEW-CLAIM.
 16073
 16074     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16075         ADD +1 TO SUB1
 16076         GO TO 3760-RC-REIN-OLD-CLAIM.
 16077
 16078     IF RC-OLD-LF-CLM (SUB1) = 'X'
 16079         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16080
 16081     IF RC-REIN-LFCLM (SUB1) = ZERO
 16082         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16083
 16084     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 309
* ECS010.cbl
 16085     PERFORM EXTRACT-DATE-LOAD.
 16086     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16087     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16088     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16089     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16090     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16091     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16092     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 16093     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 16094     MOVE CR-DTH-PAY-DT TO DE-PAY
 16095                           WS-DE-PAY-N.
 16096
 16097     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16098         MOVE '3' TO DE-TYPE
 16099     ELSE
 16100         MOVE '1' TO DE-TYPE.
 16101
 16102     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16103
 16104     ADD +1 TO BC-R-CLM.
 16105
 16106 3770-RC-REIN-OLD-AH-CLM.
 16107
 16108     IF RC-OLD-AH-CLM (SUB1) = 'X'
 16109         ADD +1 TO SUB1
 16110         GO TO 3760-RC-REIN-OLD-CLAIM.
 16111
 16112     IF RC-REIN-AHCLM (SUB1) = ZERO
 16113         ADD +1 TO SUB1
 16114         GO TO 3760-RC-REIN-OLD-CLAIM.
 16115
 16116     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 16117     PERFORM EXTRACT-DATE-LOAD.
 16118     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16119     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16120     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16121     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16122     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16123     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16124     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 16125     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 16126     MOVE CR-DIS-PAY-DT TO DE-PAY
 16127                           WS-DE-PAY-N.
 16128
 16129     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16130         MOVE '4' TO DE-TYPE
 16131     ELSE
 16132         MOVE '2' TO DE-TYPE.
 16133
 16134     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16135
 16136     ADD +1 TO BC-R-CLM.
 16137     ADD +1 TO SUB1.
 16138
 16139     GO TO 3760-RC-REIN-OLD-CLAIM.
 16140
 16141 3780-RC-REIN-NEW-CLAIM.
 16142
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 310
* ECS010.cbl
 16143     IF REIN-COMP (SUB1) = SPACES
 16144         GO TO 3799-RC-REINSURANCE-X.
 16145
 16146     IF REIN-REM-SW (SUB1) = 'Z'
 16147         ADD +1 TO SUB1
 16148         GO TO 3780-RC-REIN-NEW-CLAIM.
 16149
 16150     IF RC-NEW-LF-CLM (SUB1) = 'X'
 16151         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16152
 16153     IF REIN-LFCLM (SUB1) = ZERO
 16154         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16155
 16156     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16157     PERFORM EXTRACT-DATE-LOAD.
 16158     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16159     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16160     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16161     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16162     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16163     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16164     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 16165     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 16166     MOVE CR-DTH-PAY-DT     TO DE-PAY
 16167                               WS-DE-PAY-N.
 16168
 16169     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16170         MOVE '3' TO DE-TYPE
 16171     ELSE
 16172         MOVE '1' TO DE-TYPE.
 16173
 16174     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16175
 16176     ADD +1 TO BC-R-CLM.
 16177
 16178 3790-RC-REIN-NEW-AH-CLM.
 16179
 16180     IF RC-NEW-AH-CLM (SUB1) = 'X'
 16181         ADD +1 TO SUB1
 16182         GO TO 3780-RC-REIN-NEW-CLAIM.
 16183
 16184     IF REIN-AHCLM (SUB1) = ZERO
 16185         ADD +1 TO SUB1
 16186         GO TO 3780-RC-REIN-NEW-CLAIM.
 16187
 16188     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16189     PERFORM EXTRACT-DATE-LOAD.
 16190     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16191     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16192     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16193     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16194     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16195     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16196     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 16197     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 16198     MOVE CR-DIS-PAY-DT     TO DE-PAY
 16199                               WS-DE-PAY-N.
 16200
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 311
* ECS010.cbl
 16201     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16202         MOVE '4' TO DE-TYPE
 16203     ELSE
 16204         MOVE '2' TO DE-TYPE.
 16205
 16206     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16207
 16208     ADD +1 TO BC-R-CLM.
 16209     ADD +1 TO SUB1.
 16210
 16211     GO TO 3780-RC-REIN-NEW-CLAIM.
 16212
 16213 3799-RC-REINSURANCE-X.
 16214     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 312
* ECS010.cbl
 16216******************************************************************
 16217***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 16218******************************************************************
 16219
 16220 4000-EP-BUMP-RTN.
 16221
 16222     IF AM-RECALC-COMM = ('Y' OR '1')
 16223        PERFORM 1600-RECALC-COMM-EXTR
 16224                                 THRU 1899-RECALC-COMM-EXTR-X
 16225        MOVE ' '                 TO RECALC-TYPE
 16226     END-IF
 16227
 16228     MOVE '1'    TO EP-FLG.
 16229     ADD +1      TO BC-G-CERTS.
 16230
 16231     MOVE CR-DT               TO HIGH-CERT.
 16232     IF CR-ACCT-CONTROL NOT = LOW-CTL
 16233         MOVE CR-DT           TO LOW-CERT
 16234         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 16235
 16236     IF CR-POLICY-IS-REIN-ONLY
 16237         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16238                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16239                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16240                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16241                              DTH-IBNR           DIS-IBNR
 16242                              DTH-PAYCUR         DIS-PAYCUR
 16243                              DTH-FUTRSV         DIS-FUTRSV
 16244         GO TO 4050-EP-DO-REINSURE.
 16245
 16246     MOVE CR-LFAMT       TO WE-LFAMT.
 16247     MOVE CR-LFPRM       TO WE-LFPRM.
 16248     IF CR-LFTYP NOT = ZEROS
 16249         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16250             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 16251             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 16252         ELSE
 16253             MOVE ZEROS               TO WE-LFAMT-ALT
 16254                                         WE-LFPRM-ALT.
 16255
 16256     MOVE SPACES         TO REIN-EP-FLG
 16257                            WE-REIN-CO.
 16258     MOVE CR-LFRFND      TO WE-LFRFND.
 16259     MOVE CR-DTHAMT      TO WE-DTHAMT.
 16260     ADD  CR-DTHEXP      TO WE-DTHAMT.
 16261     MOVE CR-DTHEXP      TO WE-DTHEXP.
 16262     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 16263     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 16264     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 16265     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 16266
 16267     MOVE CR-AHPRM       TO WE-AHPRM.
 16268     MOVE CR-AHAMT       TO WE-AHAMT.
 16269     MOVE CR-AHRFND      TO WE-AHRFND.
 16270     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 16271     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 16272     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 16273     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 313
* ECS010.cbl
 16274     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 16275     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 16276     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 16277
 16278     IF CR-POLICY-IS-RESTORE  OR
 16279        CR-POLICY-IS-REISSUE
 16280        OR CR-POLICY-IS-MONTHLY
 16281         MOVE ZEROS      TO WE-LFPRM
 16282                            WE-LFPRM-ALT
 16283                            WE-AHPRM.
 16284
 16285     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16286                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16287                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16288                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16289                              DTH-IBNR           DIS-IBNR
 16290                              DTH-PAYCUR         DIS-PAYCUR
 16291                              DTH-FUTRSV         DIS-FUTRSV.
 16292
 16293*     DISPLAY ' B4 4100 '
 16294     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16295*     DISPLAY ' AFTER 4100 '
 16296
 16297     IF CR-POLICY-IS-DECLINED  OR
 16298        CR-POLICY-IS-VOID
 16299         GO TO 4099-EP-BUMP-RTN-X.
 16300
 16301 4050-EP-DO-REINSURE.
 16302
 16303     MOVE 'R' TO REIN-EP-FLG.
 16304     MOVE +1  TO SUB5.
 16305
 16306 4090-EP-DO-REINSURE-LOOP.
 16307
 16308*     DISPLAY ' 4090 '
 16309     IF REIN-COMP (SUB5) = SPACES
 16310         MOVE SPACE TO REIN-EP-FLG
 16311         GO TO 4099-EP-BUMP-RTN-X.
 16312
 16313     IF REIN-REM-SW (SUB5) = 'Z'  OR
 16314        REIN-LF-AH-FLGS (SUB5) = SPACES
 16315         ADD +1 TO SUB5
 16316         GO TO 4090-EP-DO-REINSURE-LOOP.
 16317
 16318     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 16319        VARYING CO-SUB FROM 1 BY 1 UNTIL
 16320          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 16321          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 16322          (RCT-REIN-CO (CO-SUB) = SPACES).
 16323
 16324     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 16325        (RCT-REIN-CO (CO-SUB) = SPACES)
 16326        MOVE ZERO TO CO-SUB.
 16327
 16328*     DISPLAY ' 4090 A '
 16329*     DISPLAY ' AM RECALC ' AM-RECALC-COMM
 16330     ADD +1 TO BC-R-CERTS.
 16331     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 314
* ECS010.cbl
 16332     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 16333     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 16334
 16335     IF (DTE-CLIENT = 'DCC')
 16336        AND (CR-LFAMT + CR-LFAMT-ALT) > ZEROS
 16337*        DISPLAY ' B4 CEDE FACT '
 16338*        DISPLAY ' CR-LFAMT ' CR-LFAMT
 16339*        DISPLAY ' CR-LFAMT-ALT ' CR-LFAMT-ALT
 16340*        DISPLAY ' RWF-LFAMT ' RWF-LFAMT
 16341        COMPUTE WS-CEDE-FACT =
 16342           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16343*        DISPLAY ' AFTER CEDE FACT '
 16344        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16345           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16346                                     NOT = 'G' AND 'L')
 16347           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16348*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 16349*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 16350           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 16351           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 16352        END-IF
 16353     END-IF
 16354
 16355     MOVE RWF-LFPRM      TO WE-LFPRM.
 16356     MOVE RWF-LFAMT      TO WE-LFAMT.
 16357     MOVE RWF-LFRFND     TO WE-LFRFND.
 16358     MOVE RWF-LFCLM      TO WE-DTHAMT.
 16359     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 16360     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 16361     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 16362     MOVE +0             TO WE-LFAMT-ALT
 16363                            WE-LFPRM-ALT
 16364                            WE-DTHEXP
 16365                            WE-NUM-DTH-CLM.
 16366
 16367*     DISPLAY ' 4090 B '
 16368     IF (DTE-CLIENT EQUAL 'NSL') AND
 16369        (CR-REIN-TABLE EQUAL 'NAR')
 16370        CONTINUE
 16371     ELSE
 16372      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 16373       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 16374        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 16375            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16376        COMPUTE WE-LFAMT ROUNDED EQUAL
 16377                           CR-LFAMT * WS-CEDE-FACT
 16378        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 16379                           CR-LFAMT-ALT * WS-CEDE-FACT
 16380        IF (DTE-CLIENT = 'CID')
 16381           AND (CR-LF-NSP-PRM > +0)
 16382           AND (CR-ENTRY-DATE > 20031130)
 16383           AND (WT-LF-QC NOT = '1' AND '3')
 16384           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 16385              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16386           MOVE +0            TO WE-LFPRM-ALT
 16387        ELSE
 16388          IF (DTE-CLIENT = 'CID')
 16389             AND (CR-LF-NSP-PRM > +0)
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 315
* ECS010.cbl
 16390             AND (CR-ENTRY-DATE > 20030430)
 16391             AND (WT-LF-QC NOT = '1' AND '3')
 16392             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16393             MOVE +0            TO WE-LFPRM-ALT
 16394          ELSE
 16395             COMPUTE WE-LFPRM ROUNDED EQUAL
 16396                           CR-LFPRM * WS-CEDE-FACT
 16397             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 16398                           CR-LFPRM-ALT * WS-CEDE-FACT
 16399          END-IF
 16400        END-IF
 16401        IF (DTE-CLIENT = 'CID')
 16402           AND (CR-LF-NSP-PRM > +0)
 16403           AND (CR-LFRFND-CALC > +0)
 16404           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 16405           AND (WT-LF-QC NOT = '1' AND '4')
 16406           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 16407              (CR-LFPRM + CR-LFPRM-ALT)
 16408           COMPUTE WE-LFRFND =
 16409              REIN-FACTOR * REIN-CALCED-LIFE
 16410           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 16411              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16412*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 16413*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 16414*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16415        ELSE
 16416
 16417          IF (DTE-CLIENT = 'CID')
 16418           AND (CR-LF-NSP-PRM > +0)
 16419           AND (CR-LFRFND-CALC > +0)
 16420           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 16421           AND (WT-LF-QC NOT = '1' AND '4')
 16422           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16423           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 16424              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 16425
 16426          END-IF
 16427        END-IF
 16428       ELSE
 16429         MOVE +0 TO WS-CEDE-FACT
 16430       END-IF
 16431      END-IF
 16432     END-IF
 16433
 16434*     DISPLAY ' 4090 C '
 16435     IF DTE-CLIENT = 'DCC'
 16436        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16437           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16438                                   NOT = 'G' AND 'L')
 16439           AND (CR-AHAMT NOT = ZEROS)
 16440*        DISPLAY ' CR-AHAMT ' CR-AHAMT
 16441           COMPUTE WS-CEDE-FACT =
 16442               RWF-AHAMT / CR-AHAMT
 16443           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 16444*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 16445*          / CR-AHPRM * CR-AHRFND
 16446           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 16447           / CR-AHPRM) * CR-AH-NSP-PRM
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 316
* ECS010.cbl
 16448        END-IF
 16449     END-IF
 16450
 16451     MOVE RWF-AHPRM      TO WE-AHPRM.
 16452
 16453     MOVE RWF-AHAMT      TO WE-AHAMT
 16454     MOVE RWF-AHRFND     TO WE-AHRFND.
 16455     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 16456     MOVE +0             TO WE-DSPY-EXP
 16457                            WE-NUM-DIS-CLM.
 16458     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 16459     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 16460     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 16461
 16462     IF  RWF-LF-RUNOFF-SW = 'N'
 16463             OR
 16464         RWF-AH-RUNOFF-SW = 'N'
 16465         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 16466
 16467     IF  RWF-LF-RUNOFF-SW = 'N'
 16468         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 16469     ELSE
 16470         MOVE 99999999             TO STOP-LF-DATE.
 16471
 16472     IF  RWF-AH-RUNOFF-SW = 'N'
 16473         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 16474     ELSE
 16475         MOVE 99999999             TO STOP-AH-DATE.
 16476
 16477     IF CR-POLICY-IS-RESTORE  OR
 16478        CR-POLICY-IS-REISSUE
 16479        OR CR-POLICY-IS-MONTHLY
 16480         MOVE ZEROS      TO WE-LFPRM
 16481                            WE-LFPRM-ALT
 16482                            WE-AHPRM.
 16483
 16484*     DISPLAY ' B4 4100-EP-DO-LF '
 16485     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16486*     DISPLAY ' AFTER 4100-EP-DO-LF '
 16487
 16488     IF CO-SUB NOT = ZERO
 16489       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 16490         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 16491             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 16492
 16493     ADD +1 TO SUB5.
 16494     GO TO 4090-EP-DO-REINSURE-LOOP.
 16495
 16496 4099-EP-BUMP-RTN-X.
 16497     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 317
* ECS010.cbl
 16499******************************************************************
 16500***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 16501******************************************************************
 16502
 16503 4100-EP-DO-LF.
 16504
 16505     MOVE +0                         TO ISS-BEN  EPR-R78
 16506                                        CNC-BEN  EPR-PRO
 16507                                        ISS-PRM  EPR-ST
 16508                                        ISS-PRMTAX
 16509                                        CNC-PRM  ACTIVE-COUNT.
 16510     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 16511
 16512     IF CR-LFTYP = ZERO
 16513         GO TO 4200-EP-DO-AH.
 16514
 16515     IF REIN-EP-FLG = 'R'
 16516         IF REIN-LF-FLG (SUB5) = SPACE
 16517             GO TO 4200-EP-DO-AH.
 16518
 16519     IF CR-APR NOT NUMERIC
 16520         MOVE ZERO TO CR-APR.
 16521
 16522     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 16523     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 16524     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16525
 16526     IF CR-POLICY-IS-DECLINED  OR
 16527        CR-POLICY-IS-VOID
 16528         GO TO 4191-CONTINUE.
 16529
 16530     MOVE CR-LF-TERM             TO ORIG-TERM.
 16531     MOVE CLAS-INDEXL            TO W-NDX.
 16532
 16533     IF CR-DT GREATER EW-COV-DTE
 16534         MOVE CR-DT              TO EW-COV-DTE.
 16535
 16536     IF (NOT CR-POLICY-IS-RESTORE) AND
 16537        (NOT CR-POLICY-IS-REISSUE)
 16538        AND (NOT CR-POLICY-IS-MONTHLY)
 16539         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 16540         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16541             ADD CR-LIVES TO EW-ISS-CNT
 16542             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 16543                                    (ORIG-TERM * CR-LIVES)
 16544             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 16545             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16546             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16547                                   (ORIG-TERM * ISS-BEN)
 16548         ELSE
 16549             IF (DTE-CLIENT = 'DCC')
 16550                AND (CR-LFTYP = 'DD')
 16551                CONTINUE
 16552             ELSE
 16553                ADD +1 TO EW-ISS-CNT
 16554             END-IF
 16555             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16556             COMPUTE EW-AGE = EW-AGE + CR-AGE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 318
* ECS010.cbl
 16557             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16558             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16559                                   (ORIG-TERM * ISS-BEN).
 16560
 16561     MOVE RUN-DATE        TO VALUATION-DT.
 16562     MOVE '2'             TO W-VAL-SOURCE.
 16563
 16564     IF REIN-EP-FLG = 'R'
 16565         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 16566            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16567             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16568             MOVE '10'              TO W-VAL-SOURCE.
 16569
 16570     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16571
 16572     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 16573        (REM-TRM3 GREATER ZERO)
 16574        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16575            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16576                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16577            COMPUTE EW-REM-TERM = EW-REM-TERM +
 16578                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 16579          ELSE
 16580            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 16581            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 16582
 16583     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 16584
 16585     IF DTE-CLIENT = 'GIC'
 16586         IF REIN-EP-FLG NOT = 'R'  AND
 16587            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 16588            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 16589            MOVE CR-LFPRM-CALC TO ISS-PRM.
 16590
 16591     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 16592         GO TO 4105-EP-DO-LF-REIN-CHK.
 16593
 16594     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 16595             AND
 16596         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 16597             AND
 16598         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 16599                 OR
 16600             CR-LF-CANC-DT EQUAL ZEROS)
 16601             AND
 16602         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 16603                 OR
 16604             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16605         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 16606         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 16607                 VARYING
 16608             SUBM FROM +1 BY +1
 16609                 UNTIL
 16610             SUBM GREATER THAN +13.
 16611
 16612     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 16613     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 16614
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 319
* ECS010.cbl
 16615 4105-EP-DO-LF-REIN-CHK.
 16616
 16617     IF REIN-EP-FLG = 'R'  AND
 16618        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 16619         NEXT SENTENCE
 16620     ELSE
 16621         GO TO 4110-EP-DO-LF-CLM.
 16622
 16623     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 16624         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 16625             GO TO 4130-EP-DO-LF-EP.
 16626
 16627     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16628         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 16629             GO TO 4130-EP-DO-LF-EP.
 16630
 16631 4110-EP-DO-LF-CLM.
 16632
 16633     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 16634         NEXT  SENTENCE
 16635       ELSE
 16636         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 16637
 16638     ADD WE-DTHAMT      TO EW-CLM-AMT.
 16639     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 16640
 16641     IF CR-LF-STATUS-AT-DEATH = ' '
 16642         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 16643             GO TO 4115-EP-DO-LF-CLM-EPR.
 16644
 16645     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 16646     ADD +1             TO EW-CLM-CRT.
 16647
 16648 4115-EP-DO-LF-CLM-EPR.
 16649
 16650     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16651         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16652         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16653     END-IF
 16654     .
 16655 4120-EP-DO-LF-CNCL.
 16656
 16657     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 16658        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 16659         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16660             GO TO 4190-EP-DO-LF-COMM
 16661         ELSE
 16662             GO TO 4130-EP-DO-LF-EP.
 16663
 16664     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16665         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 16666         GO TO 4124-EP-DO-LF-CNCL-SUM.
 16667
 16668     IF CR-LFTYP NOT = 'DD'
 16669        ADD +1                    TO EW-CNC-CNT
 16670     END-IF
 16671
 16672     MOVE WE-LFRFND               TO CNC-PRM.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 320
* ECS010.cbl
 16673
 16674     IF DTE-CLIENT = 'GIC'
 16675         IF REIN-EP-FLG NOT = 'R'  AND
 16676            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16677             MOVE CR-LFRFND-CALC TO CNC-PRM.
 16678
 16679*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 16680*    MOVE 'L'                   TO  DC-OPTION-CODE.
 16681*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16682*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 16683
 16684     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 16685     MOVE 'L'                   TO  DC-OPTION-CODE.
 16686     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16687     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 16688
 16689     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 16690     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 16691     MOVE '1'                     TO  DC-OPTION-CODE.
 16692     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 16693     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 16694     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 16695                                      DC-ODD-DAYS-OVER
 16696                                      DC-ELAPSED-DAYS.
 16697     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16698     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 16699
 16700     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 16701         ADD  +1                  TO  MONTHS-DIFF-LF.
 16702
 16703     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16704
 16705     if (dte-client = 'AHL')
 16706        and (cr-lf-cancel-exit-date < 20120401)
 16707        go to 4120-continue-life-cancel
 16708     end-if
 16709
 16710     IF DTE-CLIENT = 'ACE'
 16711         GO TO 4120-CONTINUE-LIFE-CANCEL.
 16712
 16713     MOVE  ZEROS                  TO  SUB.
 16714
 16715 4120-LIFE-CHARGEBACK-LOOP.
 16716
 16717     ADD    +1                    TO  SUB.
 16718
 16719     IF  SUB  GREATER THAN  +10
 16720         GO TO  4120-CONTINUE-LIFE-CANCEL.
 16721
 16722     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 16723         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 16724         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16725
 16726     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 16727         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 16728
 16729     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 16730         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 321
* ECS010.cbl
 16731
 16732     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16733
 16734
 16735 4120-CONTINUE-LIFE-CANCEL.
 16736
 16737     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 16738     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 16739
 16740     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 16741         GO TO 4190-EP-DO-LF-COMM.
 16742
 16743     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16744         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16745         GO TO 4190-EP-DO-LF-COMM.
 16746
 16747     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16748     MOVE '3'           TO W-VAL-SOURCE.
 16749     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16750
 16751     IF REM-TRM3 = CR-LF-TERM
 16752         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16753         GO TO 4190-EP-DO-LF-COMM.
 16754
 16755     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16756         GO TO 4122-EP-DO-LF-CNCL-TEX.
 16757
 16758     IF DTE-CLIENT = 'NCL'
 16759         IF CR-DT LESS THAN 19910101
 16760             GO TO 4121-EP-DO-LF-CNC-BEN.
 16761
 16762     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16763         GO TO 4126-EP-DO-LF-CNCL-NP.
 16764
 16765     IF DTE-CLIENT = 'FUL'
 16766         GO TO 4128-EP-DO-LF-CNCL-FUL.
 16767
 16768*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16769     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16770        (CR-RATING-CLASS NOT = 'L ')
 16771         IF (CR-APR GREATER THAN ZERO)  AND
 16772            (CR-LF-TERM GREATER THAN 060)  AND
 16773            (CR-DT GREATER THAN 19831031)
 16774              GO TO 4126-EP-DO-LF-CNCL-NP.
 16775
 16776     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16777         IF (CR-APR GREATER THAN ZERO)  AND
 16778            (CR-LF-TERM GREATER THAN 061)  AND
 16779            (CR-DT GREATER THAN 19830318)
 16780              GO TO 4126-EP-DO-LF-CNCL-NP.
 16781
 16782     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16783         IF (CR-APR GREATER THAN ZERO)  AND
 16784            (CR-LF-TERM GREATER THAN 062)  AND
 16785            (CR-DT GREATER THAN 19810831)  AND
 16786            (CR-DT LESS THAN 19830901)
 16787              GO TO 4126-EP-DO-LF-CNCL-NP.
 16788
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 322
* ECS010.cbl
 16789     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16790         IF (CR-APR GREATER THAN ZERO)  AND
 16791            (CR-LF-TERM GREATER THAN 060)  AND
 16792            (CR-DT GREATER THAN 19831231)
 16793              GO TO 4126-EP-DO-LF-CNCL-NP.
 16794
 16795 4121-EP-DO-LF-CNC-BEN.
 16796
 16797     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 16798
 16799     COMPUTE TEMP-3 ROUNDED EQUAL
 16800         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
 16801
 16802     MOVE TEMP-3                 TO CNC-BEN.
 16803
 16804     GO TO 4190-EP-DO-LF-COMM.
 16805
 16806 4122-EP-DO-LF-CNCL-TEX.
 16807
 16808     DIVIDE WE-LFAMT BY CR-LF-TERM
 16809         GIVING TEX-FACT-1.
 16810     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 16811         GIVING TEX-FACT-2
 16812             REMAINDER TEX-FACT-3.
 16813     IF TEX-FACT-3 NOT = ZERO
 16814         ADD +1 TO TEX-FACT-2.
 16815
 16816     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 16817
 16818     GO TO 4190-EP-DO-LF-COMM.
 16819
 16820 4124-EP-DO-LF-CNCL-SUM.
 16821
 16822     IF WE-LFRFND = ZERO
 16823         GO TO 4130-EP-DO-LF-EP.
 16824
 16825     MOVE WE-LFRFND TO CNC-PRM.
 16826
 16827     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16828
 16829     IF WE-LFRFND NOT LESS WE-LFPRM
 16830         MOVE WE-LFAMT TO CNC-BEN
 16831          GO TO 4130-EP-DO-LF-EP.
 16832
 16833
 16834     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 16835
 16836     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16837         MOVE TEMP-7 TO CNC-BEN
 16838          GO TO 4130-EP-DO-LF-EP.
 16839
 16840     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16841     MOVE '4'           TO W-VAL-SOURCE.
 16842     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16843
 16844     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 16845         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 16846         GO TO 4130-EP-DO-LF-EP.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 323
* ECS010.cbl
 16847
 16848 4126-EP-DO-LF-CNCL-NP.
 16849
 16850     IF WE-LFAMT = ZERO
 16851        GO TO 4190-EP-DO-LF-COMM.
 16852
 16853     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 16854     MOVE 'L'                        TO  DC-OPTION-CODE.
 16855     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16856     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 16857
 16858     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 16859       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 16860       MOVE '3'                      TO  DC-OPTION-CODE
 16861       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16862       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 16863     ELSE
 16864       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 16865       MOVE '6'                      TO  DC-OPTION-CODE
 16866       MOVE +1                       TO  DC-ELAPSED-MONTHS
 16867       MOVE +0                       TO  DC-ELAPSED-DAYS
 16868       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16869       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 16870
 16871     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 16872     MOVE CR-APR                     TO  CP-LOAN-APR.
 16873     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16874     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16875     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16876     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16877     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16878     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16879
 16880
 16881     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 16882     IF (DTE-CLIENT = 'DCC')
 16883        AND (AM-DCC-PRODUCT-CODE <> spaces)
 16884        if cr-clp-state = spaces
 16885           move cr-state         to cr-clp-state
 16886        end-if
 16887        if cr-lftyp not = '00' and '  ' and 'DD'
 16888           move 'L'              to ws-dd-ben-type
 16889           move cr-lftyp         to ws-dd-ben-code
 16890        else
 16891           move 'A'              to ws-dd-ben-type
 16892           move cr-ahtyp         to ws-dd-ben-code
 16893        end-if
 16894        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 16895           ((CR-clp-STATE = DD-STATE (D1))
 16896           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 16897           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 16898           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 16899           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 16900                           OR
 16901           D1 > max-pdef
 16902        END-PERFORM
 16903        IF D1 <= max-pdef
 16904           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 324
* ECS010.cbl
 16905              (P1 > +8)
 16906              OR (DD-PROD-CODE (D1 P1) = 'L')
 16907           END-PERFORM
 16908           IF P1 < +9
 16909              MOVE DD-MAX-BEN-AMT (D1 P1)
 16910                                 TO CP-R-MAX-TOT-BEN
 16911           END-IF
 16912        END-IF
 16913     END-IF
 16914
 16915     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 16916
 16917     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16918       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 16919       GO TO 4130-EP-DO-LF-EP
 16920     ELSE
 16921       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 16922
 16923     GO TO 4190-EP-DO-LF-COMM.
 16924
 16925 4128-EP-DO-LF-CNCL-FUL.
 16926
 16927     IF WE-LFAMT = ZERO
 16928        GO TO 4190-EP-DO-LF-COMM.
 16929
 16930     MOVE CR-APR              TO NP-APR.
 16931     MOVE CR-LF-TERM          TO NP-ORIG.
 16932     MOVE REM-TRM3            TO NP-REM.
 16933     MOVE '2'                 TO NP-OPT.
 16934     MOVE CR-AHPRM            TO NP-AHPRM.
 16935     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 16936     MOVE CR-LFAMT            TO NP-BENEFIT.
 16937
 16938*    CALL 'FULNETRM'
 16939*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 16940*              NP-ACCOUNT NP-REMAINING.
 16941
 16942     MOVE NP-REMAINING TO CNC-BEN.
 16943
 16944     GO TO 4190-EP-DO-LF-COMM.
 16945
 16946 4130-EP-DO-LF-EP.
 16947
 16948     MOVE SPACE                  TO STATUTORY-SWITCH.
 16949
 16950     MOVE EOM-RUN-DATE TO VALUATION-DT.
 16951     MOVE '5'           TO W-VAL-SOURCE.
 16952
 16953     IF REIN-EP-FLG = 'R'
 16954       IF REIN-REM-SW (SUB5) = 'I'
 16955           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16956           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 16957           GO TO 4190-EP-DO-LF-COMM.
 16958
 16959     IF REIN-EP-FLG = 'R'
 16960         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 16961            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16962             MOVE '*'               TO LIFE-EARNED-SWITCH
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 325
* ECS010.cbl
 16963             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16964             MOVE '10'              TO W-VAL-SOURCE.
 16965
 16966     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16967
 16968     IF REM-TRM2 GREATER CR-LF-TERM
 16969         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16970         GO TO 4190-EP-DO-LF-COMM.
 16971
 16972     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16973         GO TO 4180-EP-DO-LF-EP-SUM.
 16974
 16975     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16976         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16977             IF REM-TRM2 NOT GREATER THAN +0
 16978                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16979                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16980                 GO TO 4190-EP-DO-LF-COMM
 16981             ELSE
 16982                 NEXT SENTENCE
 16983         ELSE
 16984             IF W-BAL-REMTRM NOT GREATER +0
 16985                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16986                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16987                 GO TO 4190-EP-DO-LF-COMM
 16988             ELSE
 16989                 NEXT SENTENCE
 16990     ELSE
 16991        IF DTE-CLIENT = 'NCL'  AND
 16992           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16993            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16994        ELSE
 16995         IF REM-TRM2 NOT GREATER +0  OR
 16996            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16997             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16998             GO TO 4190-EP-DO-LF-COMM.
 16999
 17000     MOVE +1 TO ACTIVE-COUNT.
 17001
 17002     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17003         GO TO 4140-EP-DO-LF-EP-TEX.
 17004
 17005     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17006         GO TO 4150-EP-DO-LF-EP-NP.
 17007
 17008*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 17009     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17010        (CR-RATING-CLASS NOT = 'L ')
 17011         IF (CR-APR GREATER THAN ZERO)  AND
 17012            (CR-LF-TERM GREATER THAN 060)  AND
 17013            (CR-DT GREATER THAN 19831031)
 17014             MOVE '*'             TO STATUTORY-SWITCH
 17015              GO TO 4150-EP-DO-LF-EP-NP.
 17016
 17017     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17018         IF (CR-APR GREATER THAN ZERO)  AND
 17019            (CR-LF-TERM GREATER THAN 061)  AND
 17020            (CR-DT GREATER THAN 19830318)
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 326
* ECS010.cbl
 17021             MOVE '*'             TO STATUTORY-SWITCH
 17022              GO TO 4150-EP-DO-LF-EP-NP.
 17023
 17024     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17025         IF (CR-APR GREATER THAN ZERO)  AND
 17026            (CR-LF-TERM GREATER THAN 062)  AND
 17027            (CR-DT GREATER THAN 19810831)  AND
 17028            (CR-DT LESS THAN 19830901)
 17029             MOVE '*'             TO STATUTORY-SWITCH
 17030              GO TO 4150-EP-DO-LF-EP-NP.
 17031
 17032     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17033         IF (CR-APR GREATER THAN ZERO)  AND
 17034            (CR-LF-TERM GREATER THAN 060)  AND
 17035            (CR-DT GREATER THAN 19831231)
 17036             MOVE '*'             TO STATUTORY-SWITCH
 17037              GO TO 4150-EP-DO-LF-EP-NP.
 17038
 17039     GO TO 4160-EP-DO-LF-EP-R78.
 17040
 17041 4140-EP-DO-LF-EP-TEX.
 17042
 17043     IF CR-PMT-FREQ = 0
 17044       DISPLAY '*************************************'
 17045       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 17046       DISPLAY '*************************************'
 17047       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 17048       DISPLAY '*************************************'
 17049       COMPUTE TEX-FACT-4 =
 17050          (CR-LF-TERM * CR-LF-TERM) +
 17051                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 17052     ELSE
 17053        COMPUTE TEX-FACT-4 =
 17054         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 17055
 17056     IF CR-PMT-FREQ = 0
 17057       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 17058           GIVING TEX-FACT-5
 17059               REMAINDER TEX-FACT-6
 17060     ELSE
 17061        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 17062            GIVING TEX-FACT-5
 17063                REMAINDER TEX-FACT-6.
 17064
 17065     IF CR-PMT-FREQ > 0
 17066        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 17067
 17068     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 17069     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 17070         (TEX-FACT-5 * CR-PMT-FREQ) +
 17071         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 17072     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 17073
 17074     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 17075
 17076     GO TO 4170-EP-DO-LF-EP-PRO.
 17077
 17078 4150-EP-DO-LF-EP-NP.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 327
* ECS010.cbl
 17079
 17080     IF WE-LFPRM = ZERO
 17081         GO TO 4160-EP-DO-LF-EP-R78.
 17082
 17083     if cr-apr = zeros
 17084        display ' found 0 apr cert ' cr-cert-no
 17085        go to 4160-ep-do-lf-ep-r78
 17086     end-if
 17087     IF DTE-CLIENT = 'CRI'
 17088       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 17089             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17090           GO TO 4160-EP-DO-LF-EP-R78.
 17091
 17092     IF DTE-CLIENT = 'AHL'
 17093        GO TO 4160-EP-DO-LF-EP-R78
 17094     END-IF
 17095
 17096     IF DTE-CLIENT = 'NCL'
 17097       IF CR-DT LESS THAN 19910101
 17098           GO TO 4160-EP-DO-LF-EP-R78.
 17099
 17100     IF REM-TRM1 = CR-LF-TERM
 17101         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17102         GO TO 4190-EP-DO-LF-COMM.
 17103
 17104     MOVE CR-APR TO NP-APR.
 17105     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17106     MOVE REM-TRM1 TO NP-REM.
 17107     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17108     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17109         MOVE CR-LOAN-TERM TO NP-ORIG.
 17110
 17111     MOVE 'R' TO NP-OPT.
 17112     CALL 'ECSNETRM'
 17113         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17114
 17115     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17116
 17117     IF STATUTORY-REQUIREMENT
 17118         MOVE EPR-R78                TO EPR-ST.
 17119
 17120 4160-EP-DO-LF-EP-R78.
 17121
 17122     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17123        (DTE-CLIENT EQUAL 'NCL')
 17124        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17125           (CR-MO EQUAL EOM-MO)
 17126           MOVE '*'            TO OB-DATE-1-SWITCH
 17127           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17128           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17129           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17130           COMPUTE WS-EPR-R78 (SUB3 1) =
 17131                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 17132           GO TO 4190-EP-DO-LF-COMM
 17133        ELSE
 17134        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17135           (CR-MO EQUAL OB-MO (1))
 17136           MOVE '*'            TO OB-DATE-2-SWITCH
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 328
* ECS010.cbl
 17137           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17138           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17139           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17140           COMPUTE WS-EPR-R78 (SUB3 2) =
 17141                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 17142           GO TO 4190-EP-DO-LF-COMM
 17143        ELSE
 17144        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17145           (CR-MO EQUAL OB-MO (2))
 17146           MOVE '*'            TO OB-DATE-3-SWITCH
 17147           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17148           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17149           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17150           COMPUTE WS-EPR-R78 (SUB3 3) =
 17151                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 17152           GO TO 4190-EP-DO-LF-COMM
 17153        ELSE
 17154           GO TO 4190-EP-DO-LF-COMM.
 17155
 17156     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17157
 17158     IF DTE-R78 = '1'
 17159         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17160     ELSE
 17161         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17162
 17163     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17164
 17165     IF REM-TRM1 GREATER THAN +0
 17166         COMPUTE TEMP-7 ROUNDED EQUAL
 17167             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17168     ELSE
 17169         MOVE WE-LFPRM                TO TEMP-7.
 17170
 17171     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17172         MOVE TEMP-7                 TO EPR-ST.
 17173
 17174     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17175         MOVE ZEROS                  TO TEMP-8
 17176         GO TO 4165-END-LF-EP-R78.
 17177
 17178     IF EPR-ST = ZEROS
 17179         MOVE TEMP-7                 TO EPR-ST.
 17180
 17181     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17182         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17183         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17184         IF DTE-R78 = '1'
 17185             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17186
 17187     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17188
 17189     COMPUTE TEMP-8 ROUNDED =
 17190               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17191
 17192 4165-END-LF-EP-R78.
 17193
 17194     IF EPR-R78 = ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 329
* ECS010.cbl
 17195         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17196     ELSE
 17197         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17198
 17199 4170-EP-DO-LF-EP-PRO.
 17200
 17201     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17202         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17203     ELSE
 17204         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17205
 17206     IF REM-TRM1 GREATER THAN +0
 17207         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17208     ELSE
 17209         MOVE WE-LFPRM                  TO TEMP-7.
 17210
 17211     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17212         MOVE ZEROS                     TO TEMP-8
 17213         GO TO 4175-END-LF-EP-PRO.
 17214
 17215     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17216         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17217             COMPUTE TEMP-5 ROUNDED =
 17218                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17219         ELSE
 17220             COMPUTE TEMP-5 ROUNDED =
 17221                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17222
 17223     COMPUTE TEMP-8 ROUNDED =
 17224                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 17225
 17226     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17227
 17228 4175-END-LF-EP-PRO.
 17229
 17230     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17231
 17232     GO TO 4185-EP-DO-LF-STATUTORY.
 17233
 17234 4180-EP-DO-LF-EP-SUM.
 17235
 17236     IF REM-TRM1 NOT GREATER +0
 17237         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 17238         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17239         GO TO 4190-EP-DO-LF-COMM.
 17240
 17241     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 17242
 17243     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17244         MOVE ZEROS                 TO TEMP-7
 17245     ELSE
 17246         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 17247                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 17248
 17249     IF TEMP-7 NOT GREATER ZERO
 17250         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17251             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 17252             GO TO 4190-EP-DO-LF-COMM
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 330
* ECS010.cbl
 17253         ELSE
 17254             MOVE ZEROS             TO TEMP-7.
 17255
 17256     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17257     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17258     IF DTE-R78 = '1'
 17259         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17260
 17261     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17262     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17263
 17264     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 17265
 17266     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 17267
 17268     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17269         GO TO 4185-EP-DO-LF-STATUTORY.
 17270
 17271     MOVE EPR-R78                  TO EPR-ST.
 17272
 17273     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17274         MOVE ZEROS                 TO TEMP-8
 17275     ELSE
 17276         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 17277                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 17278
 17279     IF TEMP-8 NOT GREATER ZERO
 17280         GO TO 4185-EP-DO-LF-STATUTORY.
 17281
 17282     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 17283                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 17284
 17285     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 17286                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 17287
 17288     COMPUTE EPR-ST ROUNDED = EPR-ST +
 17289                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 17290
 17291 4185-EP-DO-LF-STATUTORY.
 17292
 17293*07635      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17294*07636          MOVE EPR-R78                TO EPR-ST.
 17295     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 17296         MOVE EPR-PRO                TO EPR-ST.
 17297
 17298     IF DTE-CLIENT = 'AHL'
 17299        IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17300           MOVE EPR-R78          TO EPR-ST
 17301        ELSE
 17302           MOVE EPR-PRO          TO EPR-ST
 17303        END-IF
 17304     END-IF
 17305
 17306     IF (DTE-CLIENT = 'CID')
 17307        AND ((STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX')
 17308                   OR
 17309            ((STATE-ABBR (CLAS-INDEXS) = 'MN')
 17310            AND (CR-DT > 20091231)))
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 331
* ECS010.cbl
 17311        AND (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L')
 17312        AND (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 17313           GO TO 4187-EP-DO-LF-STAT-ROA
 17314     END-IF.
 17315
 17316     IF EPR-ST NOT = ZEROS
 17317         GO TO 4190-EP-DO-LF-COMM.
 17318
 17319     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17320         MOVE EPR-R78                TO EPR-ST
 17321     ELSE
 17322         MOVE EPR-PRO                TO EPR-ST.
 17323
 17324     GO TO 4190-EP-DO-LF-COMM.
 17325
 17326 4187-EP-DO-LF-STAT-ROA.
 17327     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 17328     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17329     MOVE 'L'                        TO DC-OPTION-CODE.
 17330     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17331     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17332     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17333        MOVE CR-LOAN-1ST-PMT-DT      TO  DC-GREG-DATE-1-YMD
 17334        MOVE '3'                     TO  DC-OPTION-CODE
 17335        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17336                              8099-DATE-CONVERT-X
 17337        MOVE DC-BIN-DATE-1           TO  CP-FIRST-PAY-DATE
 17338     ELSE
 17339        MOVE CP-CERT-EFF-DT          TO  DC-BIN-DATE-1
 17340        MOVE +1                      TO  DC-ELAPSED-MONTHS
 17341        MOVE +0                      TO  DC-ELAPSED-DAYS
 17342        MOVE '6'                     TO  DC-OPTION-CODE
 17343        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17344                              8099-DATE-CONVERT-X
 17345        MOVE DC-BIN-DATE-2           TO  CP-FIRST-PAY-DATE
 17346     END-IF.
 17347     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 17348     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 17349     MOVE SPACES                     TO CP-ACCT-FLD-5.
 17350     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 17351     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 17352     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 17353     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 17354     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 17355     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 17356     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 17357                                        CP-LOAN-TERM.
 17358     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 17359                                        CP-RATING-BENEFIT-AMT.
 17360     MOVE WS-REM-AMT                 TO CP-REMAINING-BENEFIT
 17361     MOVE CR-APR                     TO CP-LOAN-APR.
 17362     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 17363     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 17364     MOVE '6'                        TO CP-EARNING-METHOD.
 17365     MOVE '3'                        TO CP-PROCESS-TYPE.
 17366     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 17367     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 17368         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 332
* ECS010.cbl
 17369     ELSE
 17370         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 17371     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 17372     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 17373     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 17374     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 17375     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 17376     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 17377
 17378     IF CP-STATE-STD-ABBRV = 'OR'
 17379        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 17380     END-IF
 17381
 17382     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 17383        COMPUTE CP-ORIGINAL-BENEFIT =
 17384         (CR-LFAMT - CR-LFPRM)
 17385     END-IF
 17386
 17387     IF CP-TRUNCATED-LIFE
 17388        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 17389     END-IF
 17390
 17391     IF CP-TERM-IS-DAYS
 17392        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 17393     ELSE
 17394        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 17395     END-IF
 17396
 17397     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 17398
 17399     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 17400
 17401 4190-EP-DO-LF-COMM.
 17402
 17403     MOVE +0 TO SUB1.
 17404     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17405         10 TIMES.
 17406
 17407     IF REIN-EP-FLG NOT = 'R'  OR
 17408        CR-POLICY-IS-REIN-ONLY
 17409         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 17410         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 17411         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 17412         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 17413
 17414     ADD ISS-BEN TO EW-ISS-BEN.
 17415     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 17416     ADD CNC-BEN TO EW-CNC-BEN.
 17417     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 17418     ADD ISS-PRM TO EW-ISS-PRM.
 17419     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 17420     ADD CNC-PRM TO EW-CNC-PRM.
 17421     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 17422
 17423     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17424     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17425     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17426
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 333
* ECS010.cbl
 17427     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 17428        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 17429     END-IF
 17430     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 17431        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 17432     END-IF
 17433
 17434     COMPUTE ISS-PRMTAX rounded =
 17435        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 17436        (CNC-PRM * CR-LF-CNC-PREM-TAX)
 17437
 17438     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17439
 17440     IF LIFE-FULLY-EARNED
 17441         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17442                                            (ISS-PRM - EPR-R78)
 17443         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17444                                            (ISS-PRM - EPR-PRO)
 17445         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17446                                            (ISS-PRM - EPR-ST).
 17447
 17448     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17449         IF  REIN-EP-FLG NOT = 'R'
 17450                 OR
 17451             CR-POLICY-IS-REIN-ONLY
 17452             MOVE 'L'      TO W-CLAIM-TYPE
 17453             MOVE EPR-R78  TO W-OPT-R78
 17454             MOVE EPR-PRO  TO W-OPT-PRO
 17455             MOVE EPR-ST   TO W-OPT-ST
 17456             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17457             MOVE ZEROS    TO EW-CLM-IBNR
 17458         ELSE
 17459             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 17460                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 17461                 MOVE ZEROS      TO EW-CLM-IBNR
 17462             ELSE
 17463                 MOVE ZEROS      TO EW-CLM-IBNR
 17464     ELSE
 17465         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17466             ADD WE-DTH-IBNR
 17467                       TO EW-CLM-IBNR
 17468         ELSE
 17469             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 17470                     AND
 17471                 CR-DT GREATER THAN LAST-YRS-DATE
 17472                 COMPUTE  EW-CLM-IBNR
 17473                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 17474
 17475     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 17476     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 17477
 17478 4191-CONTINUE.
 17479
 17480     MOVE 'Y'          TO EW-LEVEL-USED.
 17481
 17482     IF CR-POLICY-UNDERWRITTEN
 17483         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17484         MOVE EPEC-OPT-WORK-TABLE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 334
* ECS010.cbl
 17485                              TO EPEC-UNDW-OPT-DATA-TABLE
 17486     ELSE
 17487         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 17488         MOVE EPEC-OPT-WORK-TABLE
 17489                              TO EPEC-OPT-DATA-TABLE.
 17490
 17491     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 335
* ECS010.cbl
 17493 4194-SLOT-INTO-EFFECTED-MONTHS.
 17494
 17495     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17496             AND
 17497         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17498             AND
 17499         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17500                 OR
 17501          CR-LF-CANC-DT EQUAL ZEROS)
 17502             AND
 17503         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 17504                 OR
 17505          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 17506         MOVE 'Y'                 TO W-TABLE-USED-SW
 17507         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17508             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17509                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17510                 + CR-LIVES
 17511         ELSE
 17512             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17513                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17514
 17515 4194-EXIT.
 17516     EXIT.
 17517
 17518 4196-CALC-REM-AMT.
 17519
 17520     IF CR-LFTYP = 'QD'
 17521        MOVE +15.0               TO CR-APR
 17522     END-IF
 17523
 17524     MOVE +0                     TO WS-REM-AMT
 17525     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 17526        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17527           COMPUTE WS-REM-AMT =
 17528             CR-LFAMT + CR-LFAMT-ALT
 17529        ELSE
 17530           MOVE CR-LFAMT         TO WS-REM-AMT
 17531        END-IF
 17532        GO TO 4199-EXIT
 17533     END-IF
 17534
 17535     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
 17536
 17537     IF REM-TRM1 = CR-LF-TERM
 17538        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17539           COMPUTE WS-REM-AMT =
 17540             CR-LFAMT + CR-LFAMT-ALT
 17541        ELSE
 17542           MOVE CR-LFAMT         TO WS-REM-AMT
 17543        END-IF
 17544        GO TO 4199-EXIT
 17545     END-IF
 17546
 17547     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17548        GO TO 4198-ORDINARY-REM
 17549     END-IF
 17550
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 336
* ECS010.cbl
 17551     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17552        GO TO 4198-CALC-TEXAS-REM
 17553     END-IF
 17554
 17555     IF CR-LFTYP = 'QD'
 17556        MOVE +15.0               TO CR-APR
 17557        MOVE 'N'                 TO
 17558                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17559        GO TO 4198-CALC-NET-PAY-REM
 17560     END-IF
 17561
 17562     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17563        GO TO 4198-CALC-NET-PAY-REM
 17564     END-IF
 17565
 17566     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17567        (CR-RATING-CLASS NOT = 'L ')
 17568         IF (CR-LF-TERM GREATER THAN +60) AND
 17569            (CR-DT GREATER THAN 19831031) AND
 17570            (CR-APR GREATER THAN ZERO)
 17571             GO TO 4198-CALC-NET-PAY-REM
 17572        END-IF
 17573     END-IF
 17574
 17575     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17576         IF (CR-LF-TERM GREATER THAN +61) AND
 17577            (CR-DT  GREATER THAN 19830318) AND
 17578            (CR-APR GREATER THAN ZERO)
 17579             GO TO 4198-CALC-NET-PAY-REM
 17580        END-IF
 17581     END-IF
 17582
 17583     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17584         IF (CR-LF-TERM GREATER THAN +62) AND
 17585            (CR-DT  GREATER THAN 19810831) AND
 17586            (CR-DT  LESS THAN 19830901) AND
 17587            (CR-APR GREATER THAN ZERO)
 17588             GO TO 4198-CALC-NET-PAY-REM
 17589        END-IF
 17590     END-IF
 17591
 17592     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17593         IF (CR-LF-TERM GREATER THAN +60) AND
 17594            (CR-DT  GREATER THAN 19831231) AND
 17595            (CR-APR GREATER THAN ZERO)
 17596             GO TO 4198-CALC-NET-PAY-REM
 17597        END-IF
 17598     END-IF
 17599
 17600     .
 17601 4198-ORDINARY-REM.
 17602
 17603     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17604         COMPUTE WS-REM-AMT ROUNDED =
 17605                  (INTERMED * REM-TRM2) + CR-LFAMT-ALT
 17606     ELSE
 17607         COMPUTE WS-REM-AMT ROUNDED = INTERMED * REM-TRM2
 17608     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 337
* ECS010.cbl
 17609
 17610     GO TO 4199-EXIT
 17611
 17612     .
 17613 4198-CALC-TEXAS-REM.
 17614
 17615     DIVIDE CR-LFAMT BY CR-LF-TERM
 17616         GIVING TEX-FACT-1.
 17617     DIVIDE REM-TRM2 BY CR-PMT-FREQ
 17618         GIVING TEX-FACT-2
 17619         REMAINDER TEX-FACT-3.
 17620
 17621     IF TEX-FACT-3 NOT = ZERO
 17622         ADD +1                  TO TEX-FACT-2
 17623     END-IF
 17624
 17625     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
 17626         MOVE CR-LFAMT           TO WS-REM-AMT
 17627     ELSE
 17628         COMPUTE WS-REM-AMT ROUNDED =
 17629             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
 17630     END-IF
 17631
 17632     GO TO 4199-EXIT
 17633
 17634     .
 17635 4198-CALC-NET-PAY-REM.
 17636
 17637     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17638     MOVE 'L'                        TO DC-OPTION-CODE.
 17639     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17640     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17641
 17642     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17643        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 17644        MOVE '3'                 TO  DC-OPTION-CODE
 17645        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17646                                  8099-DATE-CONVERT-X
 17647        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 17648     ELSE
 17649        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 17650        MOVE +1                  TO  DC-ELAPSED-MONTHS
 17651        MOVE +0                  TO  DC-ELAPSED-DAYS
 17652        MOVE '6'                 TO  DC-OPTION-CODE
 17653        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17654                                  8099-DATE-CONVERT-X
 17655        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 17656     END-IF
 17657
 17658     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17659        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
 17660     ELSE
 17661        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
 17662     END-IF
 17663     MOVE CR-APR                 TO  CP-LOAN-APR
 17664     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
 17665     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
 17666     MOVE REM-TRM2               TO  CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 338
* ECS010.cbl
 17667     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17668                                 TO CP-SPECIAL-CALC-CD
 17669     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
 17670                                 TO  CP-BENEFIT-TYPE
 17671     MOVE CLAS-I-EP (CLAS-INDEXL)
 17672                                 TO  CP-EARNING-METHOD
 17673
 17674     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 17675     IF (DTE-CLIENT = 'DCC')
 17676        AND (AM-DCC-PRODUCT-CODE <> spaces)
 17677        if cr-clp-state = spaces
 17678           move cr-state         to cr-clp-state
 17679        end-if
 17680        if cr-lftyp not = '00' and '  ' and 'DD'
 17681           move 'L'              to ws-dd-ben-type
 17682           move cr-lftyp         to ws-dd-ben-code
 17683        else
 17684           move 'A'              to ws-dd-ben-type
 17685           move cr-ahtyp         to ws-dd-ben-code
 17686        end-if
 17687        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 17688           ((CR-clp-STATE = DD-STATE (D1))
 17689           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 17690           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 17691           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 17692           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 17693                           OR
 17694           D1 > max-pdef
 17695        END-PERFORM
 17696        IF D1 <= max-pdef
 17697           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17698              (P1 > +8)
 17699              OR (DD-PROD-CODE (D1 P1) = 'L')
 17700           END-PERFORM
 17701           IF P1 < +9
 17702              MOVE DD-MAX-BEN-AMT (D1 P1)
 17703                                 TO CP-R-MAX-TOT-BEN
 17704           END-IF
 17705        END-IF
 17706     END-IF
 17707
 17708     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 17709
 17710     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
 17711
 17712     .
 17713 4199-EXIT.
 17714     EXIT.
 17715
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 339
* ECS010.cbl
 17717******************************************************************
 17718***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 17719******************************************************************
 17720
 17721 4200-EP-DO-AH.
 17722
 17723     MOVE +0                         TO ISS-BEN  EPR-R78
 17724                                        CNC-BEN  EPR-PRO
 17725                                        ISS-PRM  EPR-ST
 17726                                        CNC-PRM
 17727                                        WX-CLM-AMT
 17728                                        WX-CLM-EXP
 17729                                        WX-CLM-CNT
 17730                                        WX-CLM-CRT
 17731                                        WX-ACTIVE-COUNT
 17732                                        ISS-PRMTAX
 17733                                        WX-CNC-CNT.
 17734     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 17735
 17736     IF CR-AHTYP = ZERO
 17737         GO TO 4295-EP-DO-COUNT.
 17738
 17739     IF REIN-EP-FLG = 'R'
 17740         IF REIN-AH-FLG (SUB5) = SPACE
 17741             GO TO 4295-EP-DO-COUNT.
 17742
 17743     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 17744     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 17745     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17746
 17747     IF CR-POLICY-IS-DECLINED  OR
 17748        CR-POLICY-IS-VOID
 17749         GO TO 4290-CONTINUE.
 17750
 17751     MOVE CR-AH-TERM           TO ORIG-TERM.
 17752
 17753     IF CR-DT GREATER EW-COV-DTE
 17754         MOVE CR-DT            TO EW-COV-DTE.
 17755
 17756     IF NOT CR-POLICY-IS-RESTORE  AND
 17757        NOT CR-POLICY-IS-REISSUE
 17758        AND NOT CR-POLICY-IS-MONTHLY
 17759         MOVE WE-AHAMT         TO ISS-BEN
 17760         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 17761         COMPUTE EW-AGE = EW-AGE + CR-AGE
 17762         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17763         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17764                                   (ORIG-TERM * ISS-BEN).
 17765
 17766     MOVE CLAS-INDEXA     TO W-NDX.
 17767     MOVE RUN-DATE        TO VALUATION-DT
 17768     MOVE '6'             TO W-VAL-SOURCE.
 17769
 17770     IF REIN-EP-FLG = 'R'
 17771         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 17772            EARNING-STOP-DATE LESS THAN VALUATION-DT
 17773             MOVE EARNING-STOP-DATE TO VALUATION-DT
 17774             MOVE '10'              TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 340
* ECS010.cbl
 17775
 17776     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17777
 17778     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 17779        (REM-TRM3 GREATER ZERO)
 17780        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17781            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 17782                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 17783            COMPUTE EW-REM-TERM = EW-REM-TERM +
 17784                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 17785          ELSE
 17786            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 17787            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 17788
 17789     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 17790         GO TO 4210-BY-OPT-LOGIC.
 17791
 17792     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 17793             AND
 17794         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 17795             AND
 17796         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 17797                 OR
 17798          CR-AH-CANC-DT EQUAL ZEROS)
 17799         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 17800         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 17801                 VARYING
 17802             SUBM FROM +1 BY +1
 17803                 UNTIL
 17804             SUBM GREATER THAN +13.
 17805
 17806     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 17807     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 17808
 17809 4210-BY-OPT-LOGIC.
 17810
 17811     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17812         ADD CR-LIVES TO EW-ISS-CNT
 17813         MOVE WE-AHPRM TO ISS-PRM
 17814         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 17815                                (ORIG-TERM * CR-LIVES)
 17816         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 17817         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17818         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17819                                   (ORIG-TERM * ISS-BEN)
 17820         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 17821         GO TO 4225-CONTINUE.
 17822
 17823     IF (NOT CR-POLICY-IS-RESTORE) AND
 17824        (NOT CR-POLICY-IS-REISSUE)
 17825        AND (NOT CR-POLICY-IS-MONTHLY)
 17826        ADD +1 TO EW-ISS-CNT.
 17827
 17828     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 17829
 17830     .
 17831 4225-CONTINUE.
 17832
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 341
* ECS010.cbl
 17833     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 17834         NEXT  SENTENCE
 17835       ELSE
 17836         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 17837
 17838     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 17839     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 17840     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 17841     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 17842     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 17843     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 17844
 17845     MOVE +0           TO SUB1.
 17846
 17847     IF DTE-CLIENT = 'DCC'
 17848        IF CR-AH-CANC-DT NOT = ZEROS
 17849           MOVE CR-AH-TERM       TO ORIG-TERM
 17850           MOVE CR-AH-CANC-DT    TO VALUATION-DT
 17851           MOVE AH-OVERRIDE-L1   TO WE-LF-AH
 17852           MOVE '1'              TO W-VAL-SOURCE
 17853           PERFORM 8500-REMAINING-TERM-ROUTINE
 17854                                 THRU 8599-REM-TERM-X
 17855           DISPLAY ' 4225 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 17856        END-IF
 17857     END-IF
 17858
 17859     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17860         10 TIMES.
 17861     MOVE +0                     TO SUB16
 17862     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 17863        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 17864
 17865     IF REIN-EP-FLG NOT = 'R'  OR
 17866        CR-POLICY-IS-REIN-ONLY
 17867         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 17868         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 17869         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 17870         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 17871
 17872     ADD ISS-BEN TO EW-ISS-BEN.
 17873     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 17874     ADD CNC-BEN TO EW-CNC-BEN.
 17875     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 17876     ADD ISS-PRM TO EW-ISS-PRM.
 17877     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 17878     ADD CNC-PRM TO EW-CNC-PRM.
 17879     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 17880
 17881     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17882     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17883     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17884
 17885     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 17886        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 17887     END-IF
 17888     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 17889        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 17890     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 342
* ECS010.cbl
 17891     COMPUTE ISS-PRMTAX rounded =
 17892        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 17893        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 17894     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17895
 17896     IF A-H-FULLY-EARNED
 17897         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17898                                            (ISS-PRM - EPR-R78)
 17899         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17900                                            (ISS-PRM - EPR-PRO)
 17901         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17902                                            (ISS-PRM - EPR-ST).
 17903
 17904     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17905         IF  REIN-EP-FLG NOT = 'R'
 17906                 OR
 17907             CR-POLICY-IS-REIN-ONLY
 17908             MOVE 'A'      TO W-CLAIM-TYPE
 17909             MOVE EPR-R78  TO W-OPT-R78
 17910             MOVE EPR-PRO  TO W-OPT-PRO
 17911             MOVE EPR-ST   TO W-OPT-ST
 17912             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17913             MOVE ZEROS    TO EW-CLM-IBNR
 17914         ELSE
 17915             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 17916                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 17917                 MOVE ZEROS TO EW-CLM-IBNR
 17918             ELSE
 17919                 MOVE ZEROS TO EW-CLM-IBNR
 17920     ELSE
 17921         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17922             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 17923         ELSE
 17924             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 17925                 IF  CR-AH-POLICY-IS-ACTIVE
 17926                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 17927                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 17928                 ELSE
 17929                     NEXT SENTENCE
 17930             ELSE
 17931                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 17932                     COMPUTE  EW-CLM-IBNR
 17933                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 17934
 17935     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 17936     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 17937
 17938 4290-CONTINUE.
 17939*     DISPLAY ' 4290 '
 17940
 17941     MOVE 'Y'          TO EW-LEVEL-USED.
 17942
 17943     IF CR-POLICY-UNDERWRITTEN
 17944         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17945         MOVE EPEC-OPT-WORK-TABLE
 17946                              TO EPEC-UNDW-OPT-DATA-TABLE
 17947     ELSE
 17948         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 343
* ECS010.cbl
 17949         MOVE EPEC-OPT-WORK-TABLE
 17950                              TO EPEC-OPT-DATA-TABLE.
 17951
 17952
 17953 4295-EP-DO-COUNT.
 17954
 17955     IF REIN-EP-FLG = 'R'
 17956         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 17957     ELSE
 17958         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
 17959
 17960     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 344
* ECS010.cbl
 17962 4296-SLOT-INTO-EFFECTED-MONTHS.
 17963
 17964     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17965             AND
 17966         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17967             AND
 17968         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17969                 OR
 17970          CR-AH-CANC-DT EQUAL ZEROS)
 17971         MOVE 'Y'                 TO W-TABLE-USED-SW
 17972         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17973             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17974                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17975                 + CR-LIVES
 17976         ELSE
 17977             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17978                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17979
 17980 4296-EXIT.
 17981     EXIT.
 17982
 17983 4299-EPBX.
 17984     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 345
* ECS010.cbl
 17986******************************************************************
 17987***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 17988******************************************************************
 17989
 17990 4300-EP-COMM-LOOP.
 17991
 17992     IF DTE-CLIENT = 'DMD'
 17993         GO TO 4350-EP-COMM-LOOP-X.
 17994
 17995     ADD +1                         TO SUB1.
 17996     MOVE ZEROS                     TO SUB16.
 17997
 17998     IF CR-ADDL-CLP NOT NUMERIC
 17999        MOVE ZEROS               TO CR-ADDL-CLP
 18000     END-IF
 18001     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 18002         GO TO 4350-EP-COMM-LOOP-X.
 18003
 18004 4300-AGENT-LOOP.
 18005
 18006     ADD +1                         TO SUB16.
 18007
 18008     IF SUB16 GREATER THAN WS-LOOP-MAX
 18009         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18010         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18011         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18012                                     TO WS-ABEND-MESSAGE
 18013         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18014         MOVE 4001                   TO WS-ABEND-CODE
 18015         GO TO ABEND-PGM.
 18016
 18017     IF EW-AGT-NO (SUB16) = SPACES
 18018         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 18019         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 18020     ELSE
 18021         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 18022            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 18023             NEXT SENTENCE
 18024         ELSE
 18025             GO TO 4300-AGENT-LOOP.
 18026
 18027     IF EW-LF-AH = AH-OVERRIDE-L1
 18028         GO TO 4350-EP-COMM-LOOP-A.
 18029
 18030     IF (DTE-CLIENT = 'DCC')
 18031        AND (REIN-EP-FLG = 'R')
 18032        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18033        AND (WE-LFPRM NOT = ZEROS)
 18034        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 18035           COMPUTE ISS-WK ROUNDED =
 18036              CR-LF-NSP-PRM * CR-LCOM-L (SUB1)
 18037        ELSE
 18038           COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 18039               (CR-LFAMT + CR-LFAMT-ALT)
 18040           COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 18041              * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 18042        END-IF
 18043     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 346
* ECS010.cbl
 18044        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18045                             OR 'J' OR 'N'
 18046           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 18047        ELSE
 18048           IF CR-AGT-TYPE (SUB1) = 'A'
 18049              COMPUTE ISS-WK ROUNDED =
 18050                   CR-LF-CLP * CR-LCOM-L (SUB1)
 18051           ELSE
 18052              IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18053                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D')
 18054                 COMPUTE ISS-WK ROUNDED =
 18055                      CR-LF-CLP * CR-LCOM-L (SUB1)
 18056              ELSE
 18057                 COMPUTE ISS-WK  ROUNDED = ISS-PRM
 18058                    * CR-LCOM-L (SUB1)
 18059              END-IF
 18060           END-IF
 18061        END-IF
 18062     END-IF
 18063
 18064     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18065
 18066     MOVE ZEROS                  TO CNC-WK
 18067                                    CNC-FACT
 18068     IF DTE-CLIENT EQUAL 'XXX'
 18069         IF NOT CR-NO-LF-CHARGEBACK
 18070            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 18071            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 18072                                + CNC-WK
 18073            GO TO 4300-CONTINUE-LOOP.
 18074
 18075     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18076        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18077
 18078      IF (DTE-CLIENT = 'DCC')
 18079         AND (REIN-EP-FLG = 'R')
 18080         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18081         AND (WE-LFRFND NOT = ZEROS)
 18082         IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 18083            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18084            COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18085               CR-LCOM-L (SUB1)
 18086            IF CR-ACCOUNT = '05500500DD'
 18087               DISPLAY ' REIN P D ' CNC-FACT ' ' CNC-WK
 18088            END-IF
 18089         ELSE
 18090            COMPUTE WS-CEDE-FACT = RWF-LFAMT / CR-LFAMT
 18091            COMPUTE CNC-WK ROUNDED = (CR-LFRFND * WS-CEDE-FACT)
 18092               * CR-LCOM-L (SUB1)
 18093         END-IF
 18094      ELSE
 18095        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18096                              OR 'L' OR 'J' OR 'K')
 18097           AND (CNC-PRM > +0)
 18098           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18099           IF CR-CANCEL-REASON = 'R'
 18100              MOVE 1             TO CNC-FACT
 18101           END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 347
* ECS010.cbl
 18102           COMPUTE CNC-WK = CNC-FACT *
 18103              (CR-LCOM-L (SUB1) * +1000)
 18104*       ELSE
 18105*        IF (CR-AGT-TYPE (SUB1) = 'N')
 18106*          AND (CNC-PRM > +0)
 18107*          PERFORM 4380-REF-CSO-ADMIN-FEE
 18108*                                THRU 4380-EXIT
 18109*          COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18110*          COMPUTE CNC-WK = CNC-FACT *
 18111*             ((CR-LCOM-L (SUB1) * +1000) - 30)
 18112*       ELSE
 18113*          IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 18114*              AND (CR-AHTYP NOT = '00' AND '  ')
 18115*             AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 18116*             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18117*             COMPUTE CNC-WK = CNC-FACT *
 18118*                (CR-AHPRM - (CR-LFPRM-ALT
 18119*                + CR-ADDL-CLP))
 18120         ELSE
 18121            IF (CR-AGT-TYPE (SUB1) = 'A')
 18122                      OR
 18123              ((CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18124                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'))
 18125              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18126              COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18127                CR-LCOM-L (SUB1)
 18128            ELSE
 18129               COMPUTE CNC-WK  ROUNDED =
 18130                 CNC-PRM * CR-LCOM-L (SUB1)
 18131            END-IF
 18132         END-IF
 18133*       END-IF
 18134      END-IF
 18135        COMPUTE EW-CNC-COM (SUB16) =
 18136                                  EW-CNC-COM (SUB16) + CNC-WK
 18137     END-IF
 18138
 18139     if (ws-dcc-cnc-flag = 'Y')
 18140        and (rein-ep-flg not = 'R')
 18141        move cnc-wk              to dx-l-pc (sub1)
 18142     end-if
 18143
 18144     .
 18145 4300-CONTINUE-LOOP.
 18146
 18147*     DISPLAY ' 4300 CONTINUE '
 18148     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18149               OR
 18150        ((ISS-WK - CNC-WK) = ZEROS)
 18151        MOVE ZEROS              TO COMM-WK
 18152     ELSE
 18153        COMPUTE EC-FACT ROUNDED =
 18154           EPR-R78 / (ISS-PRM - CNC-PRM)
 18155        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18156     END-IF
 18157
 18158     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18159
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 348
* ECS010.cbl
 18160     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18161               OR
 18162        ((ISS-WK - CNC-WK) = ZEROS)
 18163        MOVE ZEROS              TO COMM-WK
 18164     ELSE
 18165        COMPUTE EC-FACT ROUNDED =
 18166           EPR-PRO / (ISS-PRM - CNC-PRM)
 18167        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18168     END-IF
 18169     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18170
 18171     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18172               OR
 18173        ((ISS-WK - CNC-WK) = ZEROS)
 18174        MOVE ZEROS              TO COMM-WK
 18175     ELSE
 18176        COMPUTE EC-FACT ROUNDED =
 18177           EPR-ST / (ISS-PRM - CNC-PRM)
 18178        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18179     END-IF
 18180
 18181     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18182
 18183     IF LIFE-FULLY-EARNED
 18184         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18185                                                CR-LCOM-L (SUB1)
 18186         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18187                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18188         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18189                                                CR-LCOM-L (SUB1)
 18190         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18191                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18192
 18193     GO TO 4350-EP-COMM-LOOP-X.
 18194
 18195 4350-EP-COMM-LOOP-A.
 18196
 18197     IF (DTE-CLIENT = 'DCC')
 18198        AND (REIN-EP-FLG = 'R')
 18199        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18200        AND (WE-AHPRM NOT = ZEROS)
 18201
 18202        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
 18203           COMPUTE ISS-WK ROUNDED =
 18204              CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18205        ELSE
 18206           COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18207           COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 18208              * CR-LCOM-AH (SUB1)
 18209        END-IF
 18210     ELSE
 18211        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18212                                    OR 'J' OR 'N'
 18213           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 18214        ELSE
 18215           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 18216             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 18217              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 349
* ECS010.cbl
 18218              + CR-ADDL-CLP)
 18219           ELSE
 18220              IF (CR-AGT-TYPE (SUB1) = 'M')
 18221                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18222                              = 'G' OR 'L')
 18223                 COMPUTE ISS-WK ROUNDED =
 18224                    CR-LFPRM-ALT * CR-LCOM-AH (SUB1)
 18225              ELSE
 18226                 IF CR-AGT-TYPE (SUB1) = 'A'
 18227                    COMPUTE ISS-WK ROUNDED =
 18228                      CR-AH-CLP * CR-LCOM-AH (SUB1)
 18229                 ELSE
 18230                    IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18231                       AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) =
 18232                                     'D')
 18233                       COMPUTE ISS-WK ROUNDED =
 18234                         CR-AH-CLP * CR-LCOM-AH (SUB1)
 18235                    ELSE
 18236                       COMPUTE ISS-WK  ROUNDED =
 18237                         ISS-PRM * CR-LCOM-AH (SUB1)
 18238                    END-IF
 18239                 END-IF
 18240              END-IF
 18241           END-IF
 18242        END-IF
 18243     END-IF
 18244
 18245     COMPUTE EW-ISS-COM (SUB16) =
 18246             EW-ISS-COM (SUB16) + ISS-WK.
 18247
 18248     MOVE ZEROS                  TO CNC-WK
 18249     IF DTE-CLIENT EQUAL 'XXX'
 18250         IF NOT CR-NO-LF-CHARGEBACK
 18251           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 18252           COMPUTE EW-CNC-COM (SUB16) =
 18253                   EW-CNC-COM (SUB16) + CNC-WK
 18254           GO TO 4300-CONTINUE-LOOP-AH.
 18255
 18256     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18257        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18258        EVALUATE TRUE
 18259           WHEN DTE-CLIENT = 'DCC'
 18260             AND (REIN-EP-FLG = 'R')
 18261             AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18262             AND (WE-AHRFND NOT = ZEROS)
 18263             IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18264                COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18265                COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18266                           CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18267             ELSE
 18268                COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18269                COMPUTE CNC-WK ROUNDED = (CR-AHRFND
 18270                * WS-CEDE-FACT) * CR-LCOM-AH (SUB1)
 18271             END-IF
 18272           WHEN (CR-AGT-TYPE (SUB1) = 'C')
 18273             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18274             AND (CNC-PRM > +0)
 18275             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 350
* ECS010.cbl
 18276           WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18277             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18278             AND (CNC-PRM > +0)
 18279             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18280           WHEN (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18281                              OR 'L' OR 'J' OR 'K')
 18282             AND (CNC-PRM > +0)
 18283             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18284             IF CR-CANCEL-REASON = 'R'
 18285                MOVE 1             TO CNC-FACT
 18286             END-IF
 18287             COMPUTE CNC-WK = CNC-FACT *
 18288                (CR-LCOM-AH (SUB1) * +1000)
 18289
 18290           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18291             AND (CNC-PRM > +0)
 18292             AND (CNC-PRM = ISS-PRM)
 18293             COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000)
 18294
 18295           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18296             AND (CNC-PRM > +0)
 18297             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18298           WHEN (CR-AGT-TYPE (SUB1) = 'M')
 18299              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18300                              = 'G' OR 'L')
 18301              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18302              COMPUTE CNC-WK = CNC-FACT *
 18303                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18304           WHEN CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18305              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18306              IF (CR-CANCEL-REASON = 'R')
 18307                 AND (CNC-PRM > +0)
 18308                 MOVE +1      TO CNC-FACT
 18309              END-IF
 18310              COMPUTE CNC-WK = CNC-FACT *
 18311              (CR-AHPRM - (CR-LFPRM-ALT
 18312                 + CR-ADDL-CLP))
 18313           WHEN (CR-AGT-TYPE (SUB1) = 'A')
 18314                      OR
 18315              ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18316               AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18317               COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18318               COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18319                  CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18320            WHEN OTHER COMPUTE CNC-WK  ROUNDED =
 18321                      CNC-PRM * CR-LCOM-AH (SUB1)
 18322        END-EVALUATE
 18323        COMPUTE EW-CNC-COM (SUB16) =
 18324           EW-CNC-COM (SUB16) + CNC-WK
 18325     END-IF
 18326
 18327     if (ws-dcc-cnc-flag = 'Y')
 18328        and (rein-ep-flg not = 'R')
 18329        move cnc-wk              to dx-a-pc (sub1)
 18330     end-if
 18331
 18332*      IF (DTE-CLIENT = 'DCC')
 18333*         AND (REIN-EP-FLG = 'R')
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 351
* ECS010.cbl
 18334*         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18335*         AND (WE-AHRFND NOT = ZEROS)
 18336*         IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18337*            COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18338*            COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18339*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18340*         ELSE
 18341*            COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18342*            COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 18343*            * CR-LCOM-AH (SUB1)
 18344*         END-IF
 18345*      ELSE
 18346*        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18347*                              OR 'L' OR 'J' OR 'K')
 18348*           AND (CNC-PRM > +0)
 18349*           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18350*           IF CR-CANCEL-REASON = 'R'
 18351*              MOVE 1             TO CNC-FACT
 18352*           END-IF
 18353*           COMPUTE CNC-WK = CNC-FACT *
 18354*              (CR-LCOM-AH (SUB1) * +1000)
 18355*        ELSE
 18356*          IF CR-AGT-TYPE (SUB1) = 'N'
 18357*             PERFORM 4380-REF-CSO-ADMIN-FEE
 18358*                                 THRU 4380-EXIT
 18359**            MOVE CNC-WK         TO DE-A-PC (SUB1)
 18360**            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18361**            IF CNC-PRM NOT = ISS-PRM
 18362**               COMPUTE CNC-WK = CNC-FACT *
 18363**               ((CR-LCOM-AH (SUB1) * +1000) - 30)
 18364**            ELSE
 18365**               COMPUTE CNC-WK = CNC-FACT *
 18366**               (CR-LCOM-AH (SUB1) * +1000)
 18367**            END-IF
 18368*          ELSE
 18369*           IF (CR-AGT-TYPE (SUB1) = 'M')
 18370*              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18371*                              = 'G' OR 'L')
 18372*              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18373*              COMPUTE CNC-WK = CNC-FACT *
 18374*                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18375*           ELSE
 18376*              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18377*                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18378*                 IF CR-CANCEL-REASON = 'R'
 18379*                    MOVE +1      TO CNC-FACT
 18380*                 END-IF
 18381*                 COMPUTE CNC-WK = CNC-FACT *
 18382*                 (CR-AHPRM - (CR-LFPRM-ALT
 18383*                    + CR-ADDL-CLP))
 18384*              ELSE
 18385*                 IF (CR-AGT-TYPE (SUB1) = 'A')
 18386*                           OR
 18387*                    ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18388*                    AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18389*                    COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18390*                    COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18391*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 352
* ECS010.cbl
 18392*                 ELSE
 18393*                    COMPUTE CNC-WK  ROUNDED =
 18394*                      CNC-PRM * CR-LCOM-AH (SUB1)
 18395*                 END-IF
 18396*              END-IF
 18397*           END-IF
 18398*          END-IF
 18399*        END-IF
 18400**       END-IF
 18401*      END-IF
 18402*        COMPUTE EW-CNC-COM (SUB16) =
 18403*           EW-CNC-COM (SUB16) + CNC-WK
 18404*     END-IF
 18405
 18406     .
 18407 4300-CONTINUE-LOOP-AH.
 18408
 18409     IF (AM-DCC-PRODUCT-CODE = 'DDF')
 18410        AND (WS-DDF-AH-CB (SUB1) = 'Y')
 18411        AND (AM-COMM-CHARGEBACK (SUB1) NUMERIC)
 18412        AND (AM-COMM-CHARGEBACK (SUB1) NOT = 0)
 18413        IF (ORIG-TERM - REM-TRM1) > AM-COMM-CHARGEBACK (SUB1)
 18414           MOVE 'N'              TO WS-DDF-AH-CB (SUB1)
 18415        END-IF
 18416     END-IF
 18417
 18418*     DISPLAY ' 4300-CONTINUE-LOOP-AH '
 18419     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18420                OR
 18421        ((ISS-WK - CNC-WK) = ZEROS)
 18422        MOVE ZEROS          TO COMM-WK
 18423     ELSE
 18424        COMPUTE EC-FACT ROUNDED =
 18425           EPR-R78 / (ISS-PRM - CNC-PRM)
 18426        IF WS-DDF-AH-CB (SUB1) = 'N'
 18427           MOVE ISS-WK           TO COMM-WK
 18428        ELSE
 18429           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18430        END-IF
 18431     END-IF
 18432
 18433     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18434
 18435     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18436                OR
 18437        ((ISS-WK - CNC-WK) = ZEROS)
 18438        MOVE ZEROS          TO COMM-WK
 18439     ELSE
 18440        COMPUTE EC-FACT ROUNDED =
 18441           EPR-PRO / (ISS-PRM - CNC-PRM)
 18442        IF WS-DDF-AH-CB (SUB1) = 'N'
 18443           MOVE ISS-WK           TO COMM-WK
 18444        ELSE
 18445           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18446        END-IF
 18447     END-IF
 18448
 18449     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 353
* ECS010.cbl
 18450
 18451     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18452                OR
 18453        ((ISS-WK - CNC-WK) = ZEROS)
 18454        MOVE ZEROS          TO COMM-WK
 18455     ELSE
 18456        EVALUATE TRUE
 18457           WHEN (CR-AGT-TYPE (SUB1) = 'I' OR 'C')
 18458              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18459                 PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18460                 COMPUTE COMM-WK = ISS-WK - CNC-WK
 18461           WHEN CR-AGT-TYPE (SUB1) = 'N'
 18462             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18463              COMPUTE COMM-WK = ISS-WK - CNC-WK
 18464           WHEN (AM-DCC-PRODUCT-CODE = 'DDF')
 18465              AND (WS-DDF-AH-CB  (SUB1) = 'N')
 18466              MOVE ISS-WK TO COMM-WK
 18467           WHEN OTHER
 18468              COMPUTE EC-FACT ROUNDED =
 18469                EPR-ST / (ISS-PRM - CNC-PRM)
 18470              COMPUTE COMM-WK ROUNDED = EC-FACT
 18471                 * (ISS-WK - CNC-WK)
 18472        END-EVALUATE
 18473     END-IF
 18474
 18475     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18476
 18477     IF A-H-FULLY-EARNED
 18478         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18479                                                CR-LCOM-AH (SUB1)
 18480         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18481                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18482         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18483                                                CR-LCOM-AH (SUB1)
 18484         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18485                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18486
 18487 4350-EP-COMM-LOOP-X.
 18488     EXIT.
 18489
 18490******************************************************************
 18491***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 18492******************************************************************
 18493
 18494 4375-EP-BANK-COMM.
 18495*     DISPLAY ' 4375 '
 18496
 18497     IF CS-AGT (SUB1) = SPACES OR ZEROS
 18498        GO TO 4375-EXIT
 18499     END-IF
 18500     .
 18501 4375-BANK-LOOP.
 18502
 18503     ADD +1                      TO SUB16
 18504
 18505     IF EW-LF-AH NOT = AH-OVERRIDE-L1
 18506        GO TO 4375-EXIT
 18507     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 354
* ECS010.cbl
 18508
 18509     IF SUB16 GREATER THAN WS-LOOP-MAX
 18510         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 18511         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18512         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18513                                     TO WS-ABEND-MESSAGE
 18514         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18515         MOVE 4001                   TO WS-ABEND-CODE
 18516         PERFORM ABEND-PGM
 18517     END-IF
 18518
 18519     IF EW-AGT-NO (SUB16) = SPACES
 18520        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 18521        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 18522     ELSE
 18523        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 18524           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 18525           CONTINUE
 18526        ELSE
 18527           GO TO 4375-BANK-LOOP
 18528        END-IF
 18529     END-IF
 18530
 18531     IF CS-COM-TYP  (SUB1) = 'B'
 18532        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 18533     END-IF
 18534
 18535     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18536
 18537     MOVE ZEROS                  TO CNC-WK
 18538                                    CNC-FACT
 18539
 18540     IF (CS-COM-TYP (SUB1) = 'B')
 18541        AND (CNC-PRM > +0)
 18542        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18543        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 18544     END-IF
 18545
 18546     COMPUTE EW-CNC-COM (SUB16) =
 18547                  EW-CNC-COM (SUB16) + CNC-WK
 18548
 18549     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18550                OR
 18551        ((ISS-WK - CNC-WK) = ZEROS)
 18552        MOVE ZEROS          TO COMM-WK
 18553     ELSE
 18554        COMPUTE EC-FACT ROUNDED =
 18555           EPR-R78 / (ISS-PRM - CNC-PRM)
 18556        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18557     END-IF
 18558
 18559     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18560
 18561     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18562                OR
 18563        ((ISS-WK - CNC-WK) = ZEROS)
 18564        MOVE ZEROS          TO COMM-WK
 18565     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 355
* ECS010.cbl
 18566        COMPUTE EC-FACT ROUNDED =
 18567           EPR-PRO / (ISS-PRM - CNC-PRM)
 18568        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18569     END-IF
 18570
 18571     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18572
 18573     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18574                OR
 18575        ((ISS-WK - CNC-WK) = ZEROS)
 18576        MOVE ZEROS          TO COMM-WK
 18577     ELSE
 18578        COMPUTE EC-FACT ROUNDED =
 18579           EPR-ST / (ISS-PRM - CNC-PRM)
 18580        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18581     END-IF
 18582
 18583     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18584
 18585     IF A-H-FULLY-EARNED
 18586        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 18587        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18588                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18589        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18590                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 18591     END-IF
 18592
 18593     .
 18594 4375-EXIT.
 18595     EXIT.
 18596
 18597
 18598 4376-DCC-DDF-SPEC.
 18599
 18600     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18601                                 THRU 4910-EXIT
 18602
 18603     display ' acct - cert ' cr-account ' ' cr-cert-no
 18604     display ' orig term rem term ' orig-term ' ' rem-trm1
 18605     display ' agt type ' cr-agt-type (sub1)
 18606     COMPUTE CP-MONTH =
 18607        FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18608     IF CP-MONTH = 0
 18609        MOVE 12 TO CP-MONTH
 18610     END-IF
 18611
 18612     EVALUATE TRUE
 18613        WHEN CR-AGT-TYPE (SUB1) = 'N'
 18614           PERFORM 4380-REF-CSO-ADMIN-FEE
 18615                                 THRU 4380-EXIT
 18616        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18617           AND (CR-CANCEL-REASON = 'R')
 18618              COMPUTE CNC-WK = CR-LCOM-AH (SUB1) * +1000
 18619        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18620           EVALUATE TRUE
 18621              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18622                 OR (NOT DD-IU-PRESENT)
 18623                 if ueclp-clp-fact = zeros
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 356
* ECS010.cbl
 18624                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18625                       / CR-AH-CLP
 18626                 end-if
 18627                 COMPUTE CNC-WK = UECLP-CLP-FACT *
 18628                    (CR-LCOM-AH (SUB1) * +1000)
 18629               WHEN ((ORIG-TERM - REM-TRM1) < 13)
 18630                  AND (DD-IU-PRESENT)
 18631                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18632                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18633                     WS-LO-UEF) * 3/12
 18634                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18635                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18636                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18637                    (CR-LCOM-AH (SUB1) * +1000)
 18638                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
 18639                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18640                    (CR-LCOM-AH (SUB1) * +1000) * WS-HI-UEF)
 18641                     * (CP-MONTH - 3) / 9
 18642              WHEN (ORIG-TERM - REM-TRM1) > 12
 18643                 COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000) *
 18644                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
 18645                    CP-MONTH / 12)
 18646           END-EVALUATE
 18647        WHEN CR-AGT-TYPE (SUB1) = 'C'
 18648           EVALUATE TRUE
 18649              WHEN CR-CANCEL-REASON = 'R'
 18650                 COMPUTE CNC-WK =  (CR-AHPRM - (CR-AH-CLP
 18651                    + CR-ADDL-CLP))
 18652              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18653                 OR (NOT DD-IU-PRESENT)
 18654                   if ueclp-clp-fact = zeros
 18655                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18656                       / CR-AH-CLP
 18657                   end-if
 18658                    COMPUTE CNC-WK = UECLP-CLP-FACT *
 18659                       (CR-AHPRM - (CR-AH-CLP
 18660                       + CR-ADDL-CLP))
 18661              WHEN (ORIG-TERM - REM-TRM1) < 13
 18662                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18663                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18664                     WS-LO-UEF) * 3/12
 18665                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18666                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18667                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18668                       (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 18669                  DISPLAY ' UECOMMO3 ' WS-COMM-MO3
 18670                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18671                    (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP) *
 18672                    WS-HI-UEF) * (CP-MONTH - 3) / 9
 18673              WHEN (ORIG-TERM - REM-TRM1) > 12
 18674                 COMPUTE CNC-WK = (CR-AHPRM - CR-AH-CLP -
 18675                    CR-ADDL-CLP) * (WS-HI-UEF - (WS-HI-UEF -
 18676                    WS-LO-UEF) * CP-MONTH / 12)
 18677           END-EVALUATE
 18678     END-EVALUATE
 18679
 18680     .
 18681 4376-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 357
* ECS010.cbl
 18682     EXIT.
 18683
 18684
 18685
 18686 4380-REF-CSO-ADMIN-FEE.
 18687
 18688*    IF CR-AH-CANC-DT NOT = ZEROS
 18689*       DISPLAY ' DDF 4380 REMTRM1 B4 ' CR-CERT-NO ' ' REM-TRM1
 18690*       MOVE CR-AH-TERM          TO ORIG-TERM
 18691*       MOVE CR-AH-CANC-DT       TO VALUATION-DT
 18692*       MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 18693*       MOVE '1'                 TO W-VAL-SOURCE
 18694*       PERFORM 8500-REMAINING-TERM-ROUTINE
 18695*                                THRU 8599-REM-TERM-X
 18696*       DISPLAY ' DDF 4380 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 18697*    END-IF
 18698
 18699     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18700                                 THRU 4910-EXIT
 18701
 18702     DISPLAY ' MADE IT TO 4380 ' CR-CERT-NO ' ' CR-AH-TERM ' '
 18703        REM-TRM1 ' ' ISS-WK ' ' WS-HI-UEF ' ' WS-LO-UEF
 18704
 18705     MOVE ZEROS                  TO CNC-WK
 18706
 18707     EVALUATE TRUE
 18708        WHEN (REM-TRM1 = 0)
 18709           OR (CR-CANCEL-REASON = 'R')
 18710           DISPLAY ' REM TERM = 0 OR REPO'
 18711           MOVE 0                TO CNC-WK
 18712
 18713        WHEN REM-TRM1 = ORIG-TERM
 18714           DISPLAY ' REM TERM  = ORIG TERM '
 18715           MOVE ISS-WK           TO CNC-WK
 18716
 18717        WHEN (ORIG-TERM - REM-TRM1) < 4
 18718           DISPLAY ' ORIG TERM - REM TRM < 4 '
 18719           COMPUTE CP-MONTH =
 18720              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18721           IF CP-MONTH = 0
 18722              MOVE 12 TO CP-MONTH
 18723           END-IF
 18724           DISPLAY ' CP MONTH ' CP-MONTH
 18725           COMPUTE W-FACTOR ROUNDED = ISS-WK -
 18726              (DD-1ST-YR-ALLOW (D1)
 18727              * CP-MONTH / 3) - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18728              * (1 - WS-HI-UEF) * CP-MONTH / 12
 18729           COMPUTE CNC-WK = W-FACTOR * 1
 18730
 18731**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
 18732
 18733        WHEN (ORIG-TERM - REM-TRM1) < 13
 18734           DISPLAY ' ORIG TERM - REM TRM < 13 '
 18735           COMPUTE CP-MONTH =
 18736              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18737           IF CP-MONTH = 0
 18738              MOVE 12 TO CP-MONTH
 18739           END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 358
* ECS010.cbl
 18740           DISPLAY ' CP MONTH ' CP-MONTH
 18741           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18742              DD-1ST-YR-ALLOW (D1))
 18743              - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18744              * (1 - WS-hi-UEF) * CP-MONTH / 12
 18745           COMPUTE CNC-WK = W-FACTOR * 1
 18746
 18747****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
 18748
 18749        WHEN OTHER
 18750           DISPLAY ' OTHER '
 18751           COMPUTE CP-MONTH =
 18752              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18753           IF CP-MONTH = 0
 18754              MOVE 12 TO CP-MONTH
 18755           END-IF
 18756           DISPLAY ' CP MONTH ' CP-MONTH
 18757           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18758              DD-1ST-YR-ALLOW (D1))
 18759              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
 18760              * CP-MONTH / 12)
 18761           COMPUTE CNC-WK = W-FACTOR * 1
 18762     END-EVALUATE
 18763
 18764     DISPLAY ' UE ADMIN FEE ' CR-ACCOUNT ' ' CR-CERT-NO
 18765        ' ' CNC-WK
 18766
 18767     .
 18768 4380-EXIT.
 18769     EXIT.
 18770
 18771******************************************************************
 18772******************************************************************
 18773******************************************************************
 18774******************************************************************
 18775******************************************************************
 18776******************************************************************
 18777******************************************************************
 18778******************************************************************
 18779******************************************************************
 18780******************************************************************
 18781***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 18782******************************************************************
 18783
 18784 S-4100-EP-DO-LF.
 18785
 18786     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 18787                                        EPR-PRO
 18788                                        EPR-ST.
 18789
 18790     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 18791     MOVE 'L'                    TO DC-OPTION-CODE.
 18792     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18793
 18794     MOVE +0                     TO DC-ELAPSED-MONTHS.
 18795     MOVE -1                     TO DC-ELAPSED-DAYS.
 18796     MOVE '6'                    TO DC-OPTION-CODE.
 18797     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 359
* ECS010.cbl
 18798
 18799     MOVE +0                     TO DC-ELAPSED-MONTHS
 18800                                    DC-ELAPSED-DAYS.
 18801
 18802     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 18803     MOVE ' '                    TO DC-OPTION-CODE.
 18804     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18805
 18806     IF NO-CONVERSION-ERROR
 18807        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 18808     ELSE
 18809         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 18810                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 18811                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 18812         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 18813                                     TO WS-ABEND-MESSAGE
 18814         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18815         MOVE 4001                   TO WS-ABEND-CODE
 18816         GO TO ABEND-PGM.
 18817
 18818     IF CR-LFTYP = ZERO
 18819         GO TO S-4200-EP-DO-AH.
 18820
 18821     IF REIN-LF-FLG (SUB5) = SPACE
 18822         GO TO S-4200-EP-DO-AH.
 18823
 18824     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 18825     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 18826     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 18827
 18828     MOVE CR-LF-TERM             TO ORIG-TERM.
 18829     MOVE CLAS-INDEXL            TO W-NDX.
 18830
 18831 S-4120-EP-DO-LF-CNCL.
 18832
 18833     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 18834        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 18835         GO TO S-4130-EP-DO-LF-EP.
 18836
 18837     COMPUTE EARNED-BY-CANCEL =
 18838                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 18839
 18840 S-4130-EP-DO-LF-EP.
 18841
 18842     MOVE SPACE                  TO STATUTORY-SWITCH.
 18843
 18844     MOVE EARNING-START-DATE     TO VALUATION-DT.
 18845     MOVE '9'                    TO W-VAL-SOURCE.
 18846     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 18847
 18848     IF REM-TRM2 GREATER CR-LF-TERM
 18849         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18850         GO TO S-4190-EP-DO-LF-COMM.
 18851
 18852     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 18853         GO TO S-4180-EP-DO-LF-EP-SUM.
 18854
 18855     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 360
* ECS010.cbl
 18856         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 18857             IF REM-TRM2 NOT GREATER THAN +0
 18858                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18859                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18860                 GO TO S-4190-EP-DO-LF-COMM
 18861             ELSE
 18862                 NEXT SENTENCE
 18863         ELSE
 18864             IF W-BAL-REMTRM NOT GREATER +0
 18865                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18866                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18867                 GO TO S-4190-EP-DO-LF-COMM
 18868             ELSE
 18869                 NEXT SENTENCE
 18870     ELSE
 18871        IF (DTE-CLIENT EQUAL 'NCL') AND
 18872           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 18873             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18874        ELSE
 18875         IF REM-TRM2 NOT GREATER +0  OR
 18876            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 18877             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18878             GO TO S-4190-EP-DO-LF-COMM.
 18879
 18880     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 18881         GO TO S-4140-EP-DO-LF-EP-TEX.
 18882
 18883     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 18884         GO TO S-4150-EP-DO-LF-EP-NP.
 18885
 18886*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 18887     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 18888        (CR-RATING-CLASS NOT = 'L ')
 18889         IF (CR-APR GREATER THAN ZERO)  AND
 18890            (CR-LF-TERM GREATER THAN 060)  AND
 18891            (CR-DT GREATER THAN 19831031)
 18892             MOVE '*'             TO STATUTORY-SWITCH
 18893              GO TO S-4150-EP-DO-LF-EP-NP.
 18894
 18895     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 18896         IF (CR-APR GREATER THAN ZERO)  AND
 18897            (CR-LF-TERM GREATER THAN 061)  AND
 18898            (CR-DT GREATER THAN 19830318)
 18899             MOVE '*'             TO STATUTORY-SWITCH
 18900              GO TO S-4150-EP-DO-LF-EP-NP.
 18901
 18902     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 18903         IF (CR-APR GREATER THAN ZERO)  AND
 18904            (CR-LF-TERM GREATER THAN 062)  AND
 18905            (CR-DT GREATER THAN 19810831)  AND
 18906            (CR-DT LESS THAN 19830901)
 18907             MOVE '*'             TO STATUTORY-SWITCH
 18908              GO TO S-4150-EP-DO-LF-EP-NP.
 18909
 18910     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 18911         IF (CR-APR GREATER THAN ZERO)  AND
 18912            (CR-LF-TERM GREATER THAN 060)  AND
 18913            (CR-DT GREATER THAN 19831231)
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 361
* ECS010.cbl
 18914             MOVE '*'             TO STATUTORY-SWITCH
 18915              GO TO S-4150-EP-DO-LF-EP-NP.
 18916
 18917     GO TO S-4160-EP-DO-LF-EP-R78.
 18918
 18919 S-4140-EP-DO-LF-EP-TEX.
 18920
 18921     COMPUTE TEX-FACT-4 =
 18922         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 18923     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 18924         GIVING TEX-FACT-5
 18925             REMAINDER TEX-FACT-6.
 18926     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 18927     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 18928         (TEX-FACT-5 * CR-PMT-FREQ) +
 18929         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 18930     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 18931
 18932     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 18933
 18934     GO TO S-4170-EP-DO-LF-EP-PRO.
 18935
 18936 S-4150-EP-DO-LF-EP-NP.
 18937
 18938     IF WE-LFPRM = ZERO
 18939         GO TO S-4160-EP-DO-LF-EP-R78.
 18940
 18941     IF DTE-CLIENT = 'CRI'
 18942       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 18943             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 18944           GO TO S-4160-EP-DO-LF-EP-R78.
 18945
 18946     IF DTE-CLIENT = 'NCL'
 18947       IF CR-DT LESS THAN 19910101
 18948           GO TO S-4160-EP-DO-LF-EP-R78.
 18949
 18950     IF REM-TRM1 = CR-LF-TERM
 18951         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18952         GO TO S-4190-EP-DO-LF-COMM.
 18953
 18954     MOVE CR-APR TO NP-APR.
 18955     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 18956     MOVE REM-TRM1 TO NP-REM.
 18957     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 18958     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 18959         MOVE CR-LOAN-TERM TO NP-ORIG.
 18960     MOVE 'R' TO NP-OPT.
 18961     CALL 'ECSNETRM'
 18962         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 18963
 18964     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 18965
 18966     IF STATUTORY-REQUIREMENT
 18967         MOVE EPR-R78                TO EPR-ST.
 18968
 18969 S-4160-EP-DO-LF-EP-R78.
 18970
 18971     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 362
* ECS010.cbl
 18972        (DTE-CLIENT EQUAL 'NCL')
 18973        IF (CR-CCYY EQUAL EOM-CCYY) AND
 18974           (CR-MO EQUAL EOM-MO)
 18975           MOVE '*'            TO OB-DATE-1-SWITCH
 18976           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18977           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18978           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18979           COMPUTE WS-EPR-R78 (SUB3 1) =
 18980                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 18981           GO TO S-4190-EP-DO-LF-COMM
 18982        ELSE
 18983        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 18984           (CR-MO EQUAL OB-MO (1))
 18985           MOVE '*'            TO OB-DATE-2-SWITCH
 18986           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18987           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18988           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18989           COMPUTE WS-EPR-R78 (SUB3 2) =
 18990                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 18991           GO TO S-4190-EP-DO-LF-COMM
 18992        ELSE
 18993        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 18994           (CR-MO EQUAL OB-MO (2))
 18995           MOVE '*'            TO OB-DATE-3-SWITCH
 18996           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18997           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18998           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18999           COMPUTE WS-EPR-R78 (SUB3 3) =
 19000                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 19001           GO TO S-4190-EP-DO-LF-COMM
 19002        ELSE
 19003           GO TO S-4190-EP-DO-LF-COMM.
 19004
 19005     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 19006
 19007     IF DTE-R78 = '1'
 19008         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 19009     ELSE
 19010         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19011
 19012     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 19013
 19014     IF REM-TRM1 GREATER THAN +0
 19015         COMPUTE TEMP-7 ROUNDED EQUAL
 19016             WE-LFPRM - (WE-LFPRM * TEMP-4)
 19017     ELSE
 19018         MOVE WE-LFPRM                TO TEMP-7.
 19019
 19020     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19021         MOVE TEMP-7                 TO EPR-ST.
 19022
 19023     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19024         MOVE ZEROS                  TO TEMP-8
 19025         GO TO S-4165-END-LF-EP-R78.
 19026
 19027     IF EPR-ST NOT = ZEROS
 19028         MOVE TEMP-7                 TO EPR-ST.
 19029
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 363
* ECS010.cbl
 19030     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19031         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 19032         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 19033         IF DTE-R78 = '1'
 19034             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 19035
 19036     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 19037
 19038     COMPUTE TEMP-8 ROUNDED =
 19039               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 19040
 19041 S-4165-END-LF-EP-R78.
 19042
 19043     IF EPR-R78 = ZEROS
 19044         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 19045     ELSE
 19046         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 19047
 19048 S-4170-EP-DO-LF-EP-PRO.
 19049
 19050     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19051         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 19052     ELSE
 19053         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19054
 19055     IF REM-TRM1 GREATER THAN +0
 19056         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 19057     ELSE
 19058         MOVE WE-LFPRM                  TO TEMP-7.
 19059
 19060     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19061         MOVE ZEROS                     TO TEMP-8
 19062         GO TO S-4175-END-LF-EP-PRO.
 19063
 19064     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19065         IF DTE-CLIENT = 'MIC' OR 'MCC'
 19066             COMPUTE TEMP-5 ROUNDED =
 19067                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 19068         ELSE
 19069             COMPUTE TEMP-5 ROUNDED =
 19070                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 19071
 19072     COMPUTE TEMP-8 ROUNDED =
 19073                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 19074
 19075     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 19076
 19077 S-4175-END-LF-EP-PRO.
 19078
 19079     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 19080
 19081     GO TO S-4185-EP-DO-LF-STATUTORY.
 19082
 19083 S-4180-EP-DO-LF-EP-SUM.
 19084
 19085     IF REM-TRM1 NOT GREATER +0
 19086         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 19087         MOVE EPR-R78 TO EPR-PRO  EPR-ST
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 364
* ECS010.cbl
 19088         GO TO S-4190-EP-DO-LF-COMM.
 19089
 19090     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19091         MOVE ZEROS                 TO TEMP-7
 19092     ELSE
 19093         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 19094                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 19095
 19096     IF TEMP-7 NOT GREATER ZERO
 19097         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19098             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 19099             GO TO S-4190-EP-DO-LF-COMM
 19100         ELSE
 19101             MOVE ZEROS             TO TEMP-7.
 19102
 19103     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 19104     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19105     IF DTE-R78 = '1'
 19106         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19107
 19108     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19109     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19110
 19111     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 19112
 19113     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 19114
 19115     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19116         GO TO S-4185-EP-DO-LF-STATUTORY.
 19117
 19118     MOVE EPR-R78                  TO EPR-ST.
 19119
 19120     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19121         MOVE ZEROS                 TO TEMP-8
 19122     ELSE
 19123         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 19124                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 19125
 19126     IF TEMP-8 NOT GREATER ZERO
 19127         GO TO S-4185-EP-DO-LF-STATUTORY.
 19128
 19129     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 19130                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 19131
 19132     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 19133                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 19134
 19135     COMPUTE EPR-ST ROUNDED = EPR-ST +
 19136                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 19137
 19138 S-4185-EP-DO-LF-STATUTORY.
 19139
 19140*08472      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19141*08473          MOVE EPR-R78                TO EPR-ST.
 19142
 19143     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 19144         MOVE EPR-PRO                TO EPR-ST.
 19145
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 365
* ECS010.cbl
 19146     IF (DTE-CLIENT = 'CID') AND
 19147        (STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX') AND
 19148        (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L') AND
 19149        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 19150           GO TO S-4187-EP-DO-LF-STAT-ROA
 19151     END-IF.
 19152
 19153     IF EPR-ST NOT = ZEROS
 19154         GO TO S-4190-EP-DO-LF-COMM.
 19155
 19156     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 19157         MOVE EPR-R78                TO EPR-ST
 19158     ELSE
 19159         MOVE EPR-PRO                TO EPR-ST.
 19160
 19161     GO TO S-4190-EP-DO-LF-COMM.
 19162
 19163 S-4187-EP-DO-LF-STAT-ROA.
 19164     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 19165     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19166     MOVE 'L'                        TO DC-OPTION-CODE.
 19167     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19168     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19169     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 19170        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 19171        MOVE '3'                 TO  DC-OPTION-CODE
 19172        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19173                              8099-DATE-CONVERT-X
 19174        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 19175     ELSE
 19176        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 19177        MOVE +1                  TO  DC-ELAPSED-MONTHS
 19178        MOVE +0                  TO  DC-ELAPSED-DAYS
 19179        MOVE '6'                 TO  DC-OPTION-CODE
 19180        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19181                              8099-DATE-CONVERT-X
 19182        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 19183     END-IF
 19184     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 19185     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 19186     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19187     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19188     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19189     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19190     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19191     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 19192     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 19193     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 19194                                        CP-LOAN-TERM.
 19195     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 19196                                        CP-RATING-BENEFIT-AMT.
 19197     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 19198         MOVE ZEROS                  TO CP-REMAINING-BENEFIT
 19199     ELSE
 19200         MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
 19201     END-IF.
 19202     MOVE CR-APR                     TO CP-LOAN-APR.
 19203     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 366
* ECS010.cbl
 19204     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 19205     MOVE '6'                        TO CP-EARNING-METHOD.
 19206     MOVE '3'                        TO CP-PROCESS-TYPE.
 19207     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 19208     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19209         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19210     ELSE
 19211         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19212     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 19213     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 19214     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 19215     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19216     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19217     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 19218
 19219
 19220     IF CP-STATE-STD-ABBRV = 'OR'
 19221        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 19222     END-IF
 19223
 19224     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 19225        COMPUTE CP-ORIGINAL-BENEFIT =
 19226         (CR-LFAMT - CR-LFPRM)
 19227     END-IF
 19228
 19229     IF CP-TRUNCATED-LIFE
 19230        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 19231     END-IF
 19232
 19233     IF CP-TERM-IS-DAYS
 19234        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 19235     ELSE
 19236        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 19237     END-IF
 19238
 19239     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 19240
 19241     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 19242
 19243 S-4190-EP-DO-LF-COMM.
 19244
 19245     IF EARNED-BY-CANCEL = ZEROS
 19246         GO TO S-4195-LF-COMM-CONTINUE.
 19247
 19248     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19249         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19250
 19251     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19252         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19253
 19254     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19255         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19256
 19257 S-4195-LF-COMM-CONTINUE.
 19258
 19259     MOVE +0 TO SUB1.
 19260     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19261         10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 367
* ECS010.cbl
 19262
 19263     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19264     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19265     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19266
 19267     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19268     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19269     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19270
 19271     MOVE 'Y'          TO EW-LEVEL-USED.
 19272
 19273     IF CR-POLICY-UNDERWRITTEN
 19274         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19275
 19276     ELSE
 19277         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19278
 19279     GO TO S-4200-EP-DO-AH.
 19280
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 368
* ECS010.cbl
 19282******************************************************************
 19283***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 19284******************************************************************
 19285
 19286 S-4200-EP-DO-AH.
 19287
 19288     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 19289                                        EPR-PRO
 19290                                        EPR-ST.
 19291
 19292     IF CR-AHTYP = ZERO
 19293         GO TO S-4299-EPBX.
 19294
 19295     IF REIN-AH-FLG (SUB5) = SPACE
 19296         GO TO S-4299-EPBX.
 19297
 19298     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 19299     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 19300     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 19301
 19302     MOVE CR-AH-TERM           TO ORIG-TERM.
 19303     MOVE CLAS-INDEXA          TO W-NDX.
 19304
 19305     MOVE EARNING-START-DATE     TO VALUATION-DT.
 19306     MOVE '9'                    TO W-VAL-SOURCE.
 19307     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 19308
 19309 S-4220-EP-DO-AH-CNCL.
 19310
 19311     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 19312         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 19313
 19314 S-4230-EP-DO-AH-EP.
 19315
 19316     IF REM-TRM2 GREATER CR-AH-TERM
 19317         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19318         GO TO S-4290-EP-DO-AH-COMM.
 19319
 19320     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 19321         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 19322
 19323 S-4235-CHECK-OB-AH-NCL.
 19324
 19325     IF (DTE-CLIENT EQUAL 'NCL') AND
 19326        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 19327           MOVE WE-AHPRM         TO EPR-R78
 19328                                    EPR-PRO
 19329                                    EPR-ST
 19330        IF (CR-CCYY EQUAL EOM-CCYY) AND
 19331           (CR-MO EQUAL EOM-MO)
 19332           MOVE '*'            TO OB-DATE-1-SWITCH
 19333           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19334           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19335           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19336           COMPUTE WS-EPR-R78 (SUB3 1) =
 19337                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 19338            GO TO S-4290-EP-DO-AH-COMM
 19339        ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 369
* ECS010.cbl
 19340        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19341           (CR-MO EQUAL OB-MO (1))
 19342           MOVE '*'            TO OB-DATE-2-SWITCH
 19343           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19344           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19345           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19346           COMPUTE WS-EPR-R78 (SUB3 2) =
 19347                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 19348            GO TO S-4290-EP-DO-AH-COMM
 19349        ELSE
 19350        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19351           (CR-MO EQUAL OB-MO (2))
 19352           MOVE '*'            TO OB-DATE-3-SWITCH
 19353           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19354           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19355           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19356           COMPUTE WS-EPR-R78 (SUB3 3) =
 19357                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 19358            GO TO S-4290-EP-DO-AH-COMM
 19359        ELSE
 19360            GO TO S-4290-EP-DO-AH-COMM.
 19361
 19362     IF REM-TRM2 NOT GREATER +0
 19363         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19364         GO TO S-4290-EP-DO-AH-COMM.
 19365
 19366     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19367         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19368         GO TO S-4290-EP-DO-AH-COMM.
 19369
 19370     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 19371     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19372     IF DTE-R78 = '1'
 19373         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19374     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19375
 19376     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19377         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 19378     ELSE
 19379         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 19380
 19381     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 19382     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19383
 19384     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 19385     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 19386
 19387     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 19388
 19389*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 19390*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 19391
 19392     MOVE SPACES TO STATUTORY-SWITCH-AH.
 19393
 19394     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 19395        (CR-DT GREATER THAN  19921231)
 19396         IF CR-AH-TERM GREATER THAN  +61
 19397             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 370
* ECS010.cbl
 19398             MOVE '*' TO STATUTORY-SWITCH-AH
 19399             GO TO S-4245-EP-DO-AH-EP-AN
 19400         ELSE
 19401             GO TO S-4250-EP-DO-AH-STATUTORY.
 19402
 19403     IF AH-EARN-METHOD EQUAL 'N'
 19404         GO TO S-4240-EP-DO-AH-EP-NP.
 19405
 19406     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 19407         MOVE 'A' TO AH-EARN-METHOD
 19408         GO TO S-4245-EP-DO-AH-EP-AN.
 19409
 19410     GO TO S-4250-EP-DO-AH-STATUTORY.
 19411
 19412 S-4240-EP-DO-AH-EP-NP.
 19413
 19414     IF WE-AHPRM = ZERO
 19415         GO TO S-4250-EP-DO-AH-STATUTORY.
 19416
 19417     IF CR-APR GREATER THAN +0
 19418         NEXT SENTENCE
 19419     ELSE
 19420         GO TO S-4250-EP-DO-AH-STATUTORY.
 19421
 19422     IF DTE-CLIENT = 'NCL'
 19423       IF CR-DT LESS THAN 19910101
 19424           GO TO S-4250-EP-DO-AH-STATUTORY.
 19425
 19426     IF REM-TRM1 = CR-AH-TERM
 19427         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19428         GO TO S-4290-EP-DO-AH-COMM.
 19429
 19430     MOVE CR-APR TO NP-APR.
 19431     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 19432     MOVE REM-TRM1 TO NP-REM.
 19433     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 19434     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 19435         MOVE CR-LOAN-TERM TO NP-ORIG.
 19436     MOVE 'R' TO NP-OPT.
 19437     CALL 'ECSNETRM'
 19438         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19439
 19440     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 19441
 19442     GO TO S-4250-EP-DO-AH-STATUTORY.
 19443
 19444 S-4245-EP-DO-AH-EP-AN.
 19445     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19446     MOVE 'L'                        TO DC-OPTION-CODE.
 19447     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19448     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19449     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19450     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19451     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19452     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19453     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19454     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19455     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 371
* ECS010.cbl
 19456     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19457                                        CP-RATING-BENEFIT-AMT.
 19458     IF CP-STATE-STD-ABBRV = 'OR'
 19459         COMPUTE CP-RATING-BENEFIT-AMT =
 19460                                  CR-AHAMT * REM-TRM1.
 19461     MOVE CR-APR                     TO CP-LOAN-APR.
 19462     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19463     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 19464     MOVE '3'                        TO CP-PROCESS-TYPE.
 19465     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19466     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19467
 19468     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19469         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19470     ELSE
 19471         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19472
 19473     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19474     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19475     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19476     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19477     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19478     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19479
 19480     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19481
 19482     IF CP-ERROR-RATE-NOT-FOUND  OR
 19483        CP-ERROR-RATE-IS-ZERO  OR
 19484        CP-ERROR-IN-DATES
 19485         GO TO S-4250-EP-DO-AH-STATUTORY.
 19486
 19487     COMPUTE EPR-R78 ROUNDED =
 19488             (REM-TRM1 * WE-AHAMT / +100 *
 19489               CP-PREMIUM-RATE)
 19490              / CR-AHPRM-CALC * CR-AHPRM
 19491
 19492     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19493
 19494     IF STATUTORY-REQUIREMENT-AH
 19495         MOVE EPR-R78                TO EPR-ST
 19496         GO TO S-4290-EP-DO-AH-COMM.
 19497
 19498 S-4250-EP-DO-AH-STATUTORY.
 19499     IF (DTE-CLIENT EQUAL 'CID') AND
 19500        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 19501         GO TO S-4267-EP-DO-AH-STAT-ROA
 19502     END-IF.
 19503
 19504 S-4250-EP-DO-AH-STATUTORY-VA.
 19505
 19506     MOVE EPR-R78                    TO EPR-ST.
 19507
 19508     MOVE +0                         TO SUB1.
 19509
 19510 S-4255-EP-AH-STAT-LOOP.
 19511     ADD +1 TO SUB1.
 19512
 19513     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 372
* ECS010.cbl
 19514         MOVE EPR-PRO                TO EPR-ST
 19515     ELSE
 19516         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 19517             GO TO S-4255-EP-AH-STAT-LOOP.
 19518
 19519     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 19520         CR-DT GREATER THAN 19831031)
 19521                    OR
 19522        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 19523         CR-DT GREATER THAN 19820629)
 19524                    OR
 19525        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 19526         CR-DT GREATER THAN 19830831)
 19527             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19528
 19529     IF DTE-CLIENT = 'CSO'  OR  'CID'
 19530       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 19531         IF CR-DT LESS THAN 19970101
 19532             MOVE EPR-R78            TO EPR-ST
 19533         ELSE
 19534             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19535
 19536     GO TO S-4290-EP-DO-AH-COMM.
 19537
 19538 S-4267-EP-DO-AH-STAT-ROA.
 19539     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19540     MOVE 'L'                        TO DC-OPTION-CODE.
 19541     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19542     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19543     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19544     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19545     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19546     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19547     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19548     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19549     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 19550     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19551                                        CP-RATING-BENEFIT-AMT.
 19552     IF CP-STATE-STD-ABBRV = 'OR'
 19553         COMPUTE CP-RATING-BENEFIT-AMT =
 19554                                  CR-AHAMT * REM-TRM1.
 19555     MOVE CR-APR                     TO CP-LOAN-APR.
 19556     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19557     MOVE 'A'                        TO CP-EARNING-METHOD.
 19558     MOVE '3'                        TO CP-PROCESS-TYPE.
 19559     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19560     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19561     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19562         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19563     ELSE
 19564         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19565     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19566     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19567     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19568     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19569     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19570     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19571
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 373
* ECS010.cbl
 19572     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19573
 19574     IF CP-ERROR-RATE-NOT-FOUND  OR
 19575        CP-ERROR-RATE-IS-ZERO  OR
 19576        CP-ERROR-IN-DATES
 19577         GO TO S-4250-EP-DO-AH-STATUTORY-VA.
 19578
 19579     COMPUTE EPR-ST ROUNDED =
 19580             (REM-TRM1 * WE-AHAMT / +100 *
 19581               CP-PREMIUM-RATE)
 19582              / CR-AHPRM-CALC * CR-AHPRM
 19583
 19584     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 19585
 19586     GO TO S-4290-EP-DO-AH-COMM.
 19587
 19588 S-4290-EP-DO-AH-COMM.
 19589
 19590     IF EARNED-BY-CANCEL = ZEROS
 19591         GO TO S-4295-AH-COMM-CONTINUE.
 19592
 19593     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19594         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19595
 19596     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19597         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19598
 19599     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19600         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19601
 19602 S-4295-AH-COMM-CONTINUE.
 19603
 19604     MOVE +0           TO SUB1.
 19605     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19606         10 TIMES.
 19607
 19608     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19609     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19610     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19611
 19612     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19613     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19614     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19615
 19616     MOVE 'Y'          TO EW-LEVEL-USED.
 19617
 19618     IF CR-POLICY-UNDERWRITTEN
 19619         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19620     ELSE
 19621         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19622
 19623
 19624 S-4299-EPBX.
 19625     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 374
* ECS010.cbl
 19627******************************************************************
 19628***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 19629******************************************************************
 19630
 19631 S-4300-EP-COMM-LOOP.
 19632
 19633     ADD +1 TO SUB1.
 19634     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 19635         GO TO S-4399-EP-COMM-LOOP-X.
 19636
 19637     IF EW-LF-AH = AH-OVERRIDE-L1
 19638         GO TO S-4350-EP-COMM-LOOP-A.
 19639
 19640*    IF CR-AGT-TYPE (SUB1) = 'K'
 19641*       COMPUTE COMM-WK =
 19642     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 19643     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19644     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19645                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19646
 19647     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 19648     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19649     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19650                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19651
 19652     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 19653     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19654
 19655     GO TO S-4399-EP-COMM-LOOP-X.
 19656
 19657 S-4350-EP-COMM-LOOP-A.
 19658
 19659     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 19660     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19661     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19662                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19663
 19664     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 19665     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19666     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19667                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19668
 19669     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 19670     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19671
 19672 S-4399-EP-COMM-LOOP-X.
 19673     EXIT.
 19674
 19675******************************************************************
 19676******************************************************************
 19677******************************************************************
 19678******************************************************************
 19679******************************************************************
 19680******************************************************************
 19681******************************************************************
 19682******************************************************************
 19683******************************************************************
 19684******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 375
* ECS010.cbl
 19686******************************************************************
 19687***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 19688******************************************************************
 19689
 19690 4400-EP-FIND-TAB-ENT.
 19691
 19692     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19693         GO TO 4490-EP-FIND-TAB-SUB.
 19694     MOVE +1 TO SUB9.
 19695
 19696 4450-EP-FIND-TAB-LOOP.
 19697
 19698     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19699         GO TO 4490-EP-FIND-TAB-SUB.
 19700     IF EPEC-SUB-REIN (SUB9) = ZEROS
 19701         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 19702         GO TO 4490-EP-FIND-TAB-SUB.
 19703
 19704     ADD +1 TO SUB9.
 19705     IF SUB9 GREATER THAN +31
 19706         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 19707         MOVE 0201 TO WS-ABEND-CODE
 19708         DISPLAY '******************************'
 19709         DISPLAY '***** ERROR LOCATION 020 *****'
 19710         DISPLAY '******************************'
 19711         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19712         GO TO ABEND-PGM.
 19713
 19714     GO TO 4450-EP-FIND-TAB-LOOP.
 19715
 19716 4490-EP-FIND-TAB-SUB.
 19717
 19718     IF WE-LF-AH = LIFE-OVERRIDE-L1
 19719         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 19720             ADD +1 TO SUB10
 19721             MOVE SUB10 TO SUB3
 19722             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 19723         ELSE
 19724             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 19725
 19726     IF WE-LF-AH = AH-OVERRIDE-L1
 19727         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 19728             ADD +1 TO SUB10
 19729             MOVE SUB10 TO SUB3
 19730             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 19731         ELSE
 19732             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 19733
 19734*    IF SUB3 GREATER THAN +220
 19735*    IF SUB3 GREATER THAN +300
 19736     IF SUB3 GREATER THAN +900
 19737         DISPLAY 'SUB3 VALUE IS - ' SUB3
 19738         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 19739         MOVE 0202 TO WS-ABEND-CODE
 19740         DISPLAY '******************************'
 19741         DISPLAY '***** ERROR LOCATION 021 *****'
 19742         DISPLAY '******************************'
 19743         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 376
* ECS010.cbl
 19744         GO TO ABEND-PGM.
 19745
 19746     IF CR-POLICY-UNDERWRITTEN
 19747         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 19748         MOVE EPEC-UNDW-OPT-DATA-TABLE
 19749                                     TO EPEC-OPT-WORK-TABLE
 19750     ELSE
 19751         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 19752         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19753
 19754     MOVE WE-REIN-CO         TO EW-REIN-CO
 19755                                EPEC-REIN-CO (SUB3)
 19756                                EPEC-REIN-CO-II (SUB3).
 19757     MOVE WE-LF-AH           TO EW-LF-AH
 19758                                EPEC-LF-AH (SUB3)
 19759                                EPEC-LF-AH-II (SUB3).
 19760     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 19761                                EPEC-BEN-TYPE (SUB3)
 19762                                EPEC-BEN-TYPE-II (SUB3).
 19763
 19764 4499-EP-FIND-TAB-ENT-X.
 19765     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 377
* ECS010.cbl
 19767******************************************************************
 19768***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 19769******************************************************************
 19770
 19771 4500-BUILD-EPEC-EXTRACT.
 19772
 19773     IF (DTE-CLIENT = 'DCC')
 19774*       AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 19775        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 19776     END-IF
 19777
 19778     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 19779         VARYING SUB2 FROM +1 BY +1
 19780             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 19781
 19782     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 19783
 19784     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 19785
 19786
 19787 4510-BUILD-EPEC-EXT.
 19788
 19789     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 19790     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 19791     IF EW-LEVEL-USED = 'Y'
 19792         MOVE SPACE                     TO W-UNDERWRITING-SW
 19793         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19794                 4518-BUILD-EPEC-RCD-X.
 19795
 19796     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 19797     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 19798     IF EW-LEVEL-USED = 'Y'
 19799         MOVE '*'                       TO W-UNDERWRITING-SW
 19800         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19801                 4518-BUILD-EPEC-RCD-X.
 19802
 19803     GO TO 4519-BUILD-EPEC-EXT-X.
 19804
 19805 4511-BUILD-EPEC-RECORD.
 19806
 19807     MOVE SPACES                        TO EP-RECORD.
 19808     MOVE 'EP'                          TO EP-RECORD-ID.
 19809     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 19810     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 19811     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 19812     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 19813                                           WS-EP-EFF-DTE-N.
 19814     MOVE EW-REIN-CO                    TO EP-REI-CO.
 19815     IF EP-REI-CO NOT = SPACES
 19816         MOVE 'R'                       TO EP-REIN.
 19817     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 19818     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 19819
 19820     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 19821     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 19822     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 19823
 19824     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 378
* ECS010.cbl
 19825     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
 19826     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 19827
 19828     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 19829     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 19830     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 19831     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 19832
 19833     IF DTE-CLIENT NOT = 'NCL'
 19834         GO TO 4512-BUILD-EPEC-CONTINUE.
 19835
 19836     IF W-UNDERWRITTEN-DATA
 19837         GO TO 4512-BUILD-EPEC-CONTINUE.
 19838
 19839     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 19840         GO TO 4512-BUILD-EPEC-CONTINUE.
 19841
 19842     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 19843        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 19844        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 19845         NEXT SENTENCE
 19846     ELSE
 19847         GO TO 4512-BUILD-EPEC-CONTINUE.
 19848
 19849     IF OB-DATE-1-USED  OR
 19850        OB-DATE-2-USED  OR
 19851        OB-DATE-3-USED
 19852         NEXT SENTENCE
 19853     ELSE
 19854         GO TO 4512-BUILD-EPEC-CONTINUE.
 19855
 19856     IF OB-DATE-1-USED
 19857         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 19858             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19859                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 19860             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19861                                   EW-EPR-ST
 19862             GO TO 4512-BUILD-EPEC-CONTINUE
 19863         ELSE
 19864             GO TO 4512-BUILD-EPEC-CONTINUE.
 19865
 19866     IF OB-DATE-2-USED
 19867         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 19868             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19869                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 19870             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19871                                   EW-EPR-ST
 19872             GO TO 4512-BUILD-EPEC-CONTINUE
 19873         ELSE
 19874             GO TO 4512-BUILD-EPEC-CONTINUE.
 19875
 19876     IF OB-DATE-3-USED
 19877         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 19878             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19879                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 19880             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19881                                   EW-EPR-ST
 19882             GO TO 4512-BUILD-EPEC-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 379
* ECS010.cbl
 19883         ELSE
 19884             GO TO 4512-BUILD-EPEC-CONTINUE.
 19885
 19886 4512-BUILD-EPEC-CONTINUE.
 19887
 19888     MOVE EW-EPR-R78                    TO EP-PRM-78.
 19889     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 19890     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 19891
 19892     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 19893     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 19894     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 19895
 19896     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 19897
 19898     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 19899     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 19900     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 19901
 19902     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 19903     MOVE ZEROS                         TO EP-CLM-PV.
 19904
 19905     if (dte-client = 'AHL')
 19906        and (ep-rcd-type = 'A')
 19907        and (ep-ben-code (1:1) = 'M')
 19908*       display ' Using spec calc ' ep-account ' ' ew-clm-ibnr
 19909        continue
 19910     else
 19911        IF EP-RCD-TYPE = 'A' OR 'U'
 19912           IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 19913              PERFORM 4599A-CALC-IBNR
 19914                                 THRU 4599A-CALC-EXIT
 19915           end-if
 19916        end-if
 19917     end-if
 19918
 19919     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 19920
 19921     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 19922     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 19923
 19924     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 19925
 19926     IF EW-ISS-CNT = ZERO
 19927         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 19928                                           EP-AVG-AGE
 19929       ELSE
 19930         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 19931                                EW-ORIG-TERM / EW-ISS-CNT
 19932         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 19933
 19934     IF EW-INFORCE-CNT = ZERO
 19935         MOVE ZERO                      TO EP-AVG-REM-TERM
 19936       ELSE
 19937         COMPUTE EP-AVG-REM-TERM ROUNDED =
 19938                             EW-REM-TERM / EW-INFORCE-CNT.
 19939
 19940     IF EW-ISS-BEN = ZERO
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 380
* ECS010.cbl
 19941         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 19942                                           EP-WEIGHTED-AGE
 19943       ELSE
 19944         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 19945                                  EW-TERM-BEN / EW-ISS-BEN
 19946         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 19947                                   EW-AGE-BEN / EW-ISS-BEN.
 19948
 19949     MOVE ZEROS                         TO
 19950         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 19951         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
 19952
 19953     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 19954                                           WS-EP-HI-COV-DT-N.
 19955     MOVE HIGH-CERT                     TO EP-HI-CERT
 19956                                           WS-EP-HI-CERT-N.
 19957     MOVE LOW-CERT                      TO EP-LO-CERT
 19958                                           WS-EP-LO-CERT-N.
 19959     IF DTE-PGM-OPT = '3'
 19960         MOVE 'P'                       TO EP-PURGE.
 19961
 19962     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 19963         GO TO 4514-CONTINUE.
 19964
 19965     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 19966
 19967     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 19968         MOVE +1                 TO EP-LIFE-YEARS
 19969     ELSE
 19970         MOVE ZEROS              TO W-LIFE-YEARS
 19971         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 19972                 VARYING
 19973             SUBM FROM +1 BY +1
 19974                 UNTIL
 19975             SUBM GREATER THAN +13
 19976         COMPUTE W-LIFE-YEARS-INT ROUNDED
 19977             = W-LIFE-YEARS / 12
 19978             - (EPEC-LIFE-CTR (SUB2 1)
 19979             + EPEC-LIFE-CTR (SUB2 13)) / 24
 19980         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 19981         IF  EP-LIFE-YEARS LESS THAN +1
 19982             MOVE +1             TO EP-LIFE-YEARS.
 19983
 19984 4514-CONTINUE.
 19985
 19986     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4900-WRT-SUMMARY-X.
 19987
 19988     MOVE SPACES                        TO EC-RECORD.
 19989     MOVE '1'                           TO WS-SEQ-NBR.
 19990     MOVE +0                            TO SUB3.
 19991     MOVE +0                            TO SUB4.
 19992     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 19993         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 19994         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 19995
 19996     GO TO 4518-BUILD-EPEC-RCD-X.
 19997
 19998 4515-DETERMINE-LIFE-YEARS.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 381
* ECS010.cbl
 19999
 20000     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 20001
 20002 4515-EXIT.
 20003     EXIT.
 20004
 20005 4518-BUILD-EPEC-RCD-X.
 20006     EXIT.
 20007
 20008 4519-BUILD-EPEC-EXT-X.
 20009     EXIT.
 20010
 20011 4520-BUILD-EPEC-LOAD-COMM.
 20012
 20013     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 20014
 20015     ADD +1 TO SUB3  SUB4.
 20016     MOVE ZEROS                  TO LEVELS-BUILT.
 20017
 20018 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20019
 20020     IF SUB4 GREATER THAN WS-LOOP-MAX
 20021         IF AGT-SW = 'X'
 20022             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20023                 THRU 4900-WRT-SUMMARY-X
 20024             MOVE ' '            TO AGT-SW
 20025             MOVE WS-LOOP-MAX    TO  SUB4
 20026             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 20027         ELSE
 20028             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 20029
 20030     IF LEVELS-BUILT EQUAL +5
 20031         IF AGT-SW = 'X'
 20032             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20033                 THRU 4900-WRT-SUMMARY-X
 20034             MOVE ' '            TO AGT-SW
 20035             MOVE ZEROS          TO LEVELS-BUILT
 20036             ADD 1 TO WS-SEQ-NBR
 20037             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 20038             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 20039                     4540-BUILD-CLEAR-X
 20040                 VARYING SUB3 FROM +1 BY +1
 20041                 UNTIL SUB3 GREATER THAN +5
 20042             MOVE +1             TO SUB3
 20043             GO TO 4531-BUILD-EPEC-LOAD-COMM
 20044         ELSE
 20045             MOVE +1             TO SUB3
 20046             MOVE ZEROS          TO LEVELS-BUILT
 20047             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 20048
 20049     IF SUB4 GREATER THAN WS-LOOP-MAX
 20050         IF AGT-SW = 'X'
 20051             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20052                 THRU 4900-WRT-SUMMARY-X
 20053             MOVE ' '                   TO AGT-SW
 20054             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 20055         ELSE
 20056             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 382
* ECS010.cbl
 20057
 20058 4531-BUILD-EPEC-LOAD-COMM.
 20059
 20060     IF (EW-AGT-NO (SUB4) = SPACES)
 20061                  OR
 20062        ((EW-ISS-COM (SUB4) = ZEROS) AND
 20063         (EW-CNC-COM (SUB4) = ZEROS) AND
 20064         (EW-ECR-R78 (SUB4) = ZEROS) AND
 20065         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 20066         (EW-ECR-PRO (SUB4) = ZEROS) AND
 20067         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
 20068         (EW-ECR-ST (SUB4) = ZEROS))
 20069         PERFORM 4540-BUILD-EPEC-CLEAR
 20070             THRU 4540-BUILD-CLEAR-X
 20071         ADD +1 TO SUB4
 20072         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20073
 20074     MOVE 'X'                           TO AGT-SW.
 20075     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 20076     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 20077     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 20078     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 20079     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 20080     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 20081     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 20082     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 20083     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 20084
 20085     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 20086
 20087     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20088
 20089 4539-BUILD-EPEC-LOAD-COMM-X.
 20090     EXIT.
 20091
 20092 4540-BUILD-EPEC-CLEAR.
 20093
 20094     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 20095     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 20096     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 20097                                           EC-CNC-COMM (SUB3)
 20098                                           EC-COMM-78 (SUB3)
 20099                                           EC-COMM-PR (SUB3)
 20100                                           EC-COMM-ST (SUB3)
 20101                                           EC-COMM-78-ADJ (SUB3)
 20102                                           EC-COMM-PR-ADJ (SUB3).
 20103
 20104 4540-BUILD-CLEAR-X.
 20105     EXIT.
 20106
 20107 4541-CALC-IBNR.
 20108
 20109     MOVE +0                    TO TOT-AH-IBNR
 20110                                   TOT-AH-PRM
 20111                                   TOT-AH-PD-CLMS
 20112                                   TOT-AH-CLMRSV
 20113                                   TOT-LF-IBNR
 20114                                   TOT-LF-PRM
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 383
* ECS010.cbl
 20115                                   TOT-LF-PD-CLMS
 20116                                   TOT-LF-CLMRSV
 20117
 20118     MOVE +0                    TO RTOT-AH-IBNR
 20119                                   RTOT-AH-PRM
 20120                                   RTOT-AH-PRMB
 20121                                   RTOT-AH-PD-CLMS
 20122                                   RTOT-AH-CLMRSV
 20123                                   RTOT-LF-IBNR
 20124                                   RTOT-LF-PRM
 20125                                   RTOT-LF-PD-CLMS
 20126                                   RTOT-LF-CLMRSV
 20127
 20128     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20129        (SUB2 > +900)
 20130        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20131*       IF W-UNDERWRITTEN-DATA
 20132*          MOVE EPEC-LEVELS-II (SUB2)
 20133*                                TO EPEC-WORK
 20134*       ELSE
 20135           MOVE EPEC-LEVELS (SUB2)
 20136                                 TO EPEC-WORK
 20137*       END-IF
 20138*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20139           IF EW-REIN-CO = SPACES
 20140              CONTINUE
 20141*             IF EW-LF-AH = 'L'
 20142*                COMPUTE TOT-LF-PRM = TOT-LF-PRM
 20143*                   + EW-EPR-ST
 20144*                COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 20145*                   + EW-CLM-AMT
 20146*                COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 20147*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20148*             ELSE
 20149*                COMPUTE TOT-AH-PRM = TOT-AH-PRM
 20150*                   + EW-EPR-ST
 20151*                COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 20152*                   + EW-CLM-AMT
 20153*                COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 20154*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20155           ELSE
 20156              DISPLAY ' ACCUM IBNR STUFF ' EW-REIN-CO ' '
 20157                 EW-LF-AH ' ' EW-BEN-TYPE
 20158              IF EW-LF-AH = 'L'
 20159                 COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 20160                    + EW-EPR-ST
 20161                 COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 20162                    + EW-CLM-AMT
 20163                 COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 20164                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20165              ELSE
 20166                 COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 20167                    + EW-EPR-ST
 20168                 IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20169                    COMPUTE RTOT-AH-PRMB = RTOT-AH-PRMB
 20170                       + EW-EPR-ST
 20171                 END-IF
 20172                 COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 384
* ECS010.cbl
 20173                    + EW-CLM-AMT
 20174                 COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 20175                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20176              END-IF
 20177           END-IF
 20178*       END-IF
 20179     END-PERFORM
 20180
 20181*    COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 20182*       - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 20183*    IF TOT-AH-IBNR < ZEROS
 20184*       COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 20185*    END-IF
 20186*    COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 20187*       - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 20188*    IF TOT-LF-IBNR < ZEROS
 20189*       COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 20190*    END-IF
 20191
 20192     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 20193        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
 20194     IF RTOT-AH-IBNR < ZEROS
 20195        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 20196     END-IF
 20197     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 20198        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 20199     IF RTOT-LF-IBNR < ZEROS
 20200        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 20201     END-IF
 20202
 20203     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20204        (SUB2 > +900)
 20205        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20206*       IF W-UNDERWRITTEN-DATA
 20207*          MOVE EPEC-LEVELS-II (SUB2)
 20208*                                TO EPEC-WORK
 20209*       ELSE
 20210           MOVE EPEC-LEVELS (SUB2)
 20211                                 TO EPEC-WORK
 20212*       END-IF
 20213*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20214           IF EW-REIN-CO = SPACES
 20215              CONTINUE
 20216*             IF EW-LF-AH = 'L'
 20217*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20218*                   / TOT-LF-PRM
 20219*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20220*                   * RTOT-LF-IBNR
 20221**                  * TOT-LF-IBNR
 20222*             ELSE
 20223*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20224*                   / TOT-AH-PRM
 20225*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20226*                   * RTOT-AH-IBNR
 20227**                  * TOT-AH-IBNR
 20228*             END-IF
 20229           ELSE
 20230              DISPLAY ' AFTER ACCUM IBNR STUFF ' EW-REIN-CO ' '
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 385
* ECS010.cbl
 20231                 EW-LF-AH ' ' EW-BEN-TYPE ' '
 20232                    EW-EPR-ST ' ' RTOT-AH-PRM
 20233              IF EW-LF-AH = 'L'
 20234                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20235                    / RTOT-LF-PRM
 20236                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20237                    * RTOT-LF-IBNR
 20238              ELSE
 20239                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20240                    / RTOT-AH-PRMB
 20241                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20242                    * RTOT-AH-IBNR
 20243              END-IF
 20244              IF (EW-ISS-PRM - EW-CNC-PRM) = EW-EPR-ST
 20245                 move zeros to ew-clm-ibnr
 20246              end-if
 20247           END-IF
 20248*       END-IF
 20249*       IF W-UNDERWRITTEN-DATA
 20250*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 20251*       ELSE
 20252           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 20253*       END-IF
 20254     END-PERFORM
 20255
 20256     .
 20257 4541-EXIT.
 20258     EXIT.
 20259
 20260 4545-BUILD-BASE.
 20261
 20262     MOVE 'EC'                   TO EC-RECORD-ID.
 20263     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 20264     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 20265     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 20266     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 20267                                    WS-EC-EFF-DTE.
 20268     MOVE EW-REIN-CO             TO EC-REI-CO.
 20269     IF EC-REI-CO NOT = SPACES
 20270         MOVE 'R'                TO EC-REIN.
 20271     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 20272     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 20273     IF DTE-PGM-OPT = '3'
 20274         MOVE 'P'                TO EC-PURGE.
 20275     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 20276
 20277 4545-BUILD-BASE-X.
 20278     EXIT.
 20279
 20280******************************************************************
 20281***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 20282******************************************************************
 20283
 20284 4550-CLEAR-EPEC-TOTALS.
 20285
 20286     MOVE LOW-CERT             TO SV-LO-CERT.
 20287     MOVE HIGH-CERT            TO SV-HI-CERT.
 20288     MOVE SPACES               TO LOW-CTL.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 386
* ECS010.cbl
 20289     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 20290
 20291     MOVE +1                   TO SUB9.
 20292     MOVE +0                   TO SUB10.
 20293     MOVE ZERO                 TO EW-REIN-CO
 20294                                  EW-BEN-TYPE.
 20295     MOVE SPACE                TO EP-FLG
 20296                                  EW-LF-AH
 20297                                  EW-LEVEL-USED
 20298                                  W-TABLE-USED-SW.
 20299
 20300     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 20301                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 20302                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 20303                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 20304                                  EW-EPR-R78     EW-EPR-R78-ADJ
 20305                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 20306                                  EW-EPR-ST      EW-EPR-ST-ADJ
 20307                                  EW-CLM-AMT     EW-COV-DTE
 20308                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 20309                                  EW-CLM-FUTRSV  EW-CLM-CNT
 20310                                  EW-CLM-CRT     EW-ISS-CNT
 20311                                  EW-CNC-CNT     EW-AGE
 20312                                  EW-ORIG-TERM   EW-INFORCE-CNT
 20313                                  EW-AGE-BEN     EW-TERM-BEN
 20314                                  EW-ISS-PRM-TAX
 20315                                  EW-REM-TERM.
 20316
 20317     MOVE +1 TO SUB1.
 20318     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
 20319     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 20320         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 20321     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 20322                                    EPEC-UNDW-OPT-DATA-TABLE.
 20323     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 20324         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 20325
 20326     PERFORM 4590-INIT-OB THRU 4590-EXIT
 20327         VARYING SUB3 FROM +1 BY +1
 20328*        UNTIL SUB3 GREATER THAN +300.
 20329*        UNTIL SUB3 GREATER THAN +220.
 20330         UNTIL SUB3 GREATER THAN +900.
 20331
 20332     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 20333
 20334 4555-CLEAR-EPEC-COMM.
 20335
 20336     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 20337                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 20338                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 20339                EW-ECR-ST  (SUB1).
 20340     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 20341                                    EW-AGT-TYPE (SUB1).
 20342
 20343     ADD +1 TO SUB1.
 20344
 20345 4560-CLEAR-EPEC-ALL.
 20346
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 387
* ECS010.cbl
 20347     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 20348                                    EPEC-LEVELS-II (SUB1).
 20349     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 20350
 20351 4570-CLEAR-EPEC-SUB-A.
 20352
 20353     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 20354     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 20355*        UNTIL SUB2 GREATER +300.
 20356         UNTIL SUB2 GREATER +900.
 20357
 20358 4580-CLEAR-EPEC-SUB-B.
 20359
 20360     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 20361     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 20362
 20363 4589-CLEAR-EPEC-TOTALS-X.
 20364     EXIT.
 20365
 20366 4590-INIT-OB.
 20367
 20368     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 20369     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 20370     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 20371
 20372 4590-EXIT.
 20373     EXIT.
 20374
 20375 4599-BUILD-EPEC-EXTRACT-X.
 20376     EXIT.
 20377
 20378*********************************************************
 20379*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 20380*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 20381*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 20382*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 20383*  IN THE DATE CARD.                                    *
 20384*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 20385*********************************************************
 20386
 20387 4599A-CALC-IBNR.
 20388
 20389     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 20390        (((EP-PRM-78 + EP-PRM-78-ADJ)
 20391                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 20392         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 20393                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 20394                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 20395
 20396     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 20397         MOVE ZEROS                 TO EW-CLM-IBNR
 20398         GO TO 4599A-CALC-EXIT.
 20399
 20400     IF EP-REIN = 'R'
 20401         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 20402
 20403     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20404
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 388
* ECS010.cbl
 20405 4599A-CALC-EXIT.
 20406      EXIT.
 20407 4599B-SEARCH.
 20408      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 389
* ECS010.cbl
 20410******************************************************************
 20411***         CALCULATE OPTIONAL METHOD I B N R                  ***
 20412******************************************************************
 20413
 20414 4600-GET-OPT-IBNR.
 20415
 20416     IF  CR-POLICY-IS-ACTIVE
 20417         IF  CR-POLICY-IS-REISSUE
 20418             OR CR-POLICY-IS-MONTHLY
 20419             IF  W-LIFE
 20420                 GO TO 4600-EXIT
 20421             ELSE
 20422                 NEXT SENTENCE
 20423         ELSE
 20424             NEXT SENTENCE
 20425     ELSE
 20426         IF  W-LIFE
 20427             GO TO 4600-EXIT.
 20428
 20429     IF  W-LIFE
 20430         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 20431     ELSE
 20432         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 20433
 20434 4600-EXIT.
 20435     EXIT.
 20436
 20437 4620-DETERMINE-LIFE-IBNR.
 20438
 20439     IF  CR-LF-POLICY-IS-ACTIVE
 20440         ADD +1                  TO W-LF-ACTIVE
 20441         IF  CR-LF-POLICY-IS-REISSUE
 20442             OR CR-LF-POLICY-IS-MONTHLY
 20443             MOVE ZEROS          TO W-WK-IBNR
 20444             ADD +1              TO W-LF-REISSUE
 20445             GO TO 4620-EXIT
 20446         ELSE
 20447             NEXT SENTENCE
 20448     ELSE
 20449         ADD +1                  TO W-LF-INACTIVE
 20450         MOVE ZEROS              TO W-WK-IBNR
 20451         GO TO 4620-EXIT.
 20452
 20453     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 20454         MOVE ZEROS              TO W-WK-IBNR
 20455         ADD +1                  TO W-LF-CALC-B
 20456         GO TO 4620-EXIT.
 20457
 20458     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20459                 AND
 20460             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 20461                 AND
 20462             W-BAL-REMTRM NOT GREATER THAN ZERO)
 20463             OR
 20464         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20465                 AND
 20466             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 20467                 AND
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 390
* ECS010.cbl
 20468             REM-TRM2 NOT GREATER THAN ZERO)
 20469         MOVE ZEROS              TO W-WK-IBNR
 20470         ADD +1                  TO W-LF-BALLOON
 20471         GO TO 4620-EXIT
 20472     ELSE
 20473         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 20474                 AND
 20475             REM-TRM2 NOT GREATER THAN ZERO)
 20476             ADD +1              TO W-LF-REMTERM-0
 20477             MOVE ZEROS          TO W-WK-IBNR
 20478             GO TO 4620-EXIT.
 20479
 20480     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 20481
 20482     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 20483         ADD +1                  TO W-LF-REMAMT-0
 20484         MOVE ZEROS              TO W-WK-IBNR
 20485         GO TO 4620-EXIT.
 20486
 20487     IF  AM-LIFE-IBNR-PCT NUMERIC
 20488             AND
 20489         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 20490         COMPUTE W-WK-IBNR ROUNDED
 20491             = CP-REMAINING-AMT
 20492             / 1000
 20493             * AM-LIFE-IBNR-PCT
 20494     ELSE
 20495         COMPUTE W-WK-IBNR ROUNDED
 20496             = CP-REMAINING-AMT
 20497             / 1000
 20498             * COMPANY-IBNR-LIFE-FACTOR.
 20499
 20500     IF  CR-LF-IS-REIN-ONLY
 20501         ADD +1                  TO W-LF-REIN
 20502     ELSE
 20503         ADD +1                  TO W-LF-DATA-USED
 20504         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 20505         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 20506         IF  CR-LFTYP = '01'
 20507             ADD CP-REMAINING-AMT
 20508                                 TO W-01-REMAMT
 20509             ADD +1              TO W-01-DATA-USED
 20510         ELSE
 20511         IF  CR-LFTYP = '02'
 20512             ADD CP-REMAINING-AMT
 20513                                 TO W-02-REMAMT
 20514             ADD +1              TO W-02-DATA-USED
 20515         ELSE
 20516         IF  CR-LFTYP = '03'
 20517             ADD CP-REMAINING-AMT
 20518                                 TO W-03-REMAMT
 20519             ADD +1              TO W-03-DATA-USED
 20520         ELSE
 20521         IF  CR-LFTYP = '04'
 20522             ADD CP-REMAINING-AMT
 20523                                 TO W-04-REMAMT
 20524             ADD +1              TO W-04-DATA-USED
 20525         ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 391
* ECS010.cbl
 20526         IF  CR-LFTYP = '05'
 20527             ADD CP-REMAINING-AMT
 20528                                 TO W-05-REMAMT
 20529             ADD +1              TO W-05-DATA-USED
 20530         ELSE
 20531         IF  CR-LFTYP = '06'
 20532             ADD CP-REMAINING-AMT
 20533                                 TO W-06-REMAMT
 20534             ADD +1              TO W-06-DATA-USED
 20535         ELSE
 20536         IF  CR-LFTYP = '30'
 20537             ADD CP-REMAINING-AMT
 20538                                 TO W-30-REMAMT
 20539             ADD +1              TO W-30-DATA-USED
 20540         ELSE
 20541         IF  CR-LFTYP = '31'
 20542             ADD CP-REMAINING-AMT
 20543                                 TO W-31-REMAMT
 20544             ADD +1              TO W-31-DATA-USED
 20545         ELSE
 20546             ADD CP-REMAINING-AMT
 20547                                 TO W-XX-REMAMT
 20548             ADD +1              TO W-XX-DATA-USED.
 20549
 20550     IF  CR-POLICY-IS-REIN-ONLY
 20551             OR
 20552         CR-LF-IS-REIN-ONLY
 20553         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20554         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20555         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 20556     ELSE
 20557         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 20558
 20559 4620-EXIT.
 20560     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 392
* ECS010.cbl
 20562 4640-GET-A-H-EARNED-PREMIUM.
 20563
 20564     IF  CR-AH-POLICY-IS-ACTIVE
 20565         ADD +1                  TO W-AH-ACTIVE
 20566         IF  CR-AH-POLICY-IS-REISSUE
 20567             OR CR-AH-POLICY-IS-MONTHLY
 20568             ADD +1              TO W-AH-REISSUE
 20569         ELSE
 20570             NEXT SENTENCE
 20571     ELSE
 20572         ADD +1                  TO W-AH-INACTIVE.
 20573
 20574     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 20575         ADD +1                  TO W-AH-CALC-B
 20576         GO TO 4640-EXIT.
 20577
 20578     IF  REM-TRM2 NOT GREATER THAN ZEROS
 20579         MOVE 'Y'                TO W-RTRM-0-SW
 20580     ELSE
 20581         MOVE SPACES             TO W-RTRM-0-SW.
 20582
 20583     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 20584
 20585****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 20586******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 20587******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 20588******        THAT CLAIM.
 20589
 20590     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 20591
 20592     IF  CR-POLICY-IS-REIN-ONLY
 20593              OR
 20594         CR-AH-IS-REIN-ONLY
 20595         ADD +1                  TO W-AH-REIN
 20596         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20597         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20598         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20599         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20600         GO TO 4640-EXIT.
 20601
 20602     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20603                                    W-EPEC-EP-IN.
 20604     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20605                                    W-CLAIMS-MADE-PAID-IN.
 20606     ADD +1                      TO W-AH-DATA-USED.
 20607     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 20608     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 20609
 20610     IF  W-CLMAMT GREATER THAN ZEROS
 20611         ADD +1                  TO W-AH-CLAIM-CTR
 20612         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 20613
 20614     IF  W-RTRM-0
 20615             AND
 20616         NOT CR-POLICY-IS-REIN-ONLY
 20617             AND
 20618         NOT CR-AH-IS-REIN-ONLY
 20619         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 393
* ECS010.cbl
 20620         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 20621         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 20622         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 20623         ADD +1                  TO W-AH-REMTERM-0.
 20624
 20625 4640-EXIT.
 20626     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 394
* ECS010.cbl
 20628 4650-DETERMINE-CLM-AMT-AH.
 20629
 20630     MOVE ZEROS                  TO W-CLMAMT.
 20631
 20632     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 20633             OR
 20634         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 20635         GO TO 4650-EXIT.
 20636
 20637     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 20638             AND
 20639         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 20640         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 20641         MOVE 'L'                    TO DC-OPTION-CODE
 20642         PERFORM 8000-DATE-CONVERT-ROUTINE
 20643             THRU 8099-DATE-CONVERT-X
 20644         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 20645         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 20646         MOVE 'L'                    TO DC-OPTION-CODE
 20647         PERFORM 8000-DATE-CONVERT-ROUTINE
 20648             THRU 8099-DATE-CONVERT-X
 20649         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 20650         IF  DATE-CONVERSION-ERROR
 20651             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 20652             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 20653             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 20654             MOVE 0303               TO WS-ABEND-CODE
 20655             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 20656             GO TO ABEND-PGM
 20657         ELSE
 20658             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 20659             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 20660             MOVE '1'                TO DC-OPTION-CODE
 20661             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 20662                                        DC-ELAPSED-DAYS
 20663             PERFORM 8000-DATE-CONVERT-ROUTINE
 20664                 THRU 8099-DATE-CONVERT-X
 20665             IF  DATE-CONVERSION-ERROR
 20666                 DISPLAY 'DIS TO PTO DATE ERROR '
 20667                     CR-FULL-CONTROL
 20668                 MOVE 'DIS TO PTO DATE ERROR '
 20669                                     TO WS-ABEND-MESSAGE
 20670                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 20671                 MOVE 0303           TO WS-ABEND-CODE
 20672                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 20673                 GO TO ABEND-PGM
 20674             ELSE
 20675                 COMPUTE W-CLMAMT ROUNDED
 20676                     = CR-AHAMT
 20677                     * (DC-ELAPSED-DAYS / 30)
 20678                 GO TO 4650-EXIT.
 20679
 20680     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 20681             OR
 20682         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 20683         GO TO 4650-EXIT.
 20684
 20685     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 395
* ECS010.cbl
 20686         = CR-AHAMT * 3.
 20687
 20688     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 20689         MOVE CR-DISAMT          TO W-CLMAMT
 20690     ELSE
 20691         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 20692
 20693     IF  NOT CR-POLICY-IS-REIN-ONLY
 20694              AND
 20695         NOT CR-AH-IS-REIN-ONLY
 20696         ADD +1          TO W-CLM-EXCEPT-CNT
 20697         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 20698
 20699 4650-EXIT.
 20700     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 396
* ECS010.cbl
 20702 4660-DETERMINE-EARNED-PREMIUM.
 20703
 20704     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 20705
 20706     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 20707
 20708     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 20709
 20710     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 20711         MOVE ZEROS              TO W-EARNED-PREMIUM
 20712         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 20713         MOVE '7'                TO W-VAL-SOURCE
 20714         PERFORM 8500-REMAINING-TERM-ROUTINE
 20715             THRU 8599-REM-TERM-X
 20716         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 20717         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 20718         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 20719         MOVE EPR-R78            TO W-OPT-R78
 20720         MOVE EPR-PRO            TO W-OPT-PRO
 20721         MOVE EPR-ST             TO W-OPT-ST
 20722         PERFORM 4670-CALC-EP THRU 4670-EXIT
 20723         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 20724     ELSE
 20725         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 20726
 20727     COMPUTE W-EARNED-PREMIUM ROUNDED
 20728         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 20729
 20730     IF  W-EARNED-PREMIUM LESS THAN ZERO
 20731         ADD +1                  TO W-EP-LESS-THAN-0
 20732         MOVE ZERO               TO W-EARNED-PREMIUM.
 20733
 20734 4660-EXIT.
 20735     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 397
* ECS010.cbl
 20737 4666-SAVE-AHCR-DATA.
 20738
 20739     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 20740                                    WX-STATUS-AT-SETTLEMENT.
 20741
 20742     MOVE ZEROS                  TO WX-CANC-DT
 20743                                    WX-EOM-RUN-DATE
 20744                                    WX-SETTLEMENT-EXIT-DATE.
 20745
 20746     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 20747         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 20748         MOVE CR-AH-STATUS-AT-CANCEL
 20749                                 TO WX-STATUS-AT-CANCEL
 20750         MOVE ZEROS              TO CR-AH-CANC-DT
 20751                                    WS-CR-AH-CANC-DT-N
 20752         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 20753
 20754     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20755         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 20756                                 TO WX-SETTLEMENT-EXIT-DATE
 20757         MOVE CR-AH-STATUS-AT-SETTLEMENT
 20758                                 TO WX-STATUS-AT-SETTLEMENT
 20759         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 20760                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20761         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 20762
 20763     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 20764     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 20765
 20766 4666-EXIT.
 20767     EXIT.
 20768
 20769 4668-RESTORE-AHCR-DATA.
 20770
 20771     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 20772         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 20773                                    WS-CR-AH-CANC-DT-N
 20774         MOVE WX-STATUS-AT-CANCEL
 20775                                 TO CR-AH-STATUS-AT-CANCEL.
 20776
 20777     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20778         MOVE WX-SETTLEMENT-EXIT-DATE
 20779                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 20780                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20781         MOVE WX-STATUS-AT-SETTLEMENT
 20782                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 20783
 20784     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 20785
 20786 4668-EXIT.
 20787     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 398
* ECS010.cbl
 20789 4670-CALC-EP.
 20790
 20791     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 20792         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 20793         ADD W-EARNED-PREMIUM    TO W-WY-EP
 20794         GO TO 4670-EXIT.
 20795
 20796     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 20797         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 20798         ADD W-EARNED-PREMIUM    TO W-VA-EP
 20799         GO TO 4670-EXIT.
 20800
 20801***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 20802
 20803     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 20804         COMPUTE W-EARNED-PREMIUM
 20805             = (W-OPT-PRO + W-OPT-R78) / +2
 20806         ADD W-EARNED-PREMIUM    TO W-M-EP
 20807     ELSE
 20808         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 20809             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 20810             ADD W-EARNED-PREMIUM
 20811                                 TO W-R-EP
 20812         ELSE
 20813             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 20814                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 20815                 ADD W-EARNED-PREMIUM
 20816                                 TO W-P-EP
 20817             ELSE
 20818                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 20819                     COMPUTE W-EARNED-PREMIUM ROUNDED
 20820                         = (W-OPT-PRO * +.6667)
 20821                         + (W-OPT-R78 * +.3333)
 20822                     ADD W-EARNED-PREMIUM
 20823                                 TO W-1-EP
 20824                 ELSE
 20825                     ADD +1      TO W-OTHERS-COUNT
 20826                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 20827
 20828 4670-EXIT.
 20829     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 399
* ECS010.cbl
 20831 4680-CALC-REMAINING-AMT-LF.
 20832
 20833     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 20834     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 20835     MOVE CR-APR                 TO CP-LOAN-APR.
 20836     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 20837
 20838     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 20839         MOVE +1                 TO CR-PMT-FREQ.
 20840
 20841     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 20842
 20843     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 20844     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 20845                                    CP-RATING-BENEFIT-AMT.
 20846     IF CP-STATE-STD-ABBRV = 'OR'
 20847         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 20848     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 20849     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 20850     MOVE ZEROS                  TO CP-REMAINING-AMT
 20851                                    CP-REMAINING-AMT-PRV
 20852                                    CP-RETURN-CODE
 20853                                    CP-RETURN-CODE-2.
 20854
 20855     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 20856     IF (DTE-CLIENT = 'DCC')
 20857        AND (AM-DCC-PRODUCT-CODE <> spaces)
 20858        if cr-clp-state = spaces
 20859           move cr-state         to cr-clp-state
 20860        end-if
 20861        if cr-lftyp not = '00' and '  ' and 'DD'
 20862           move 'L'              to ws-dd-ben-type
 20863           move cr-lftyp         to ws-dd-ben-code
 20864        else
 20865           move 'A'              to ws-dd-ben-type
 20866           move cr-ahtyp         to ws-dd-ben-code
 20867        end-if
 20868        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 20869           ((CR-clp-STATE = DD-STATE (D1))
 20870           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 20871           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 20872           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 20873           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 20874                           OR
 20875           D1 > max-pdef
 20876        END-PERFORM
 20877        IF D1 <= max-pdef
 20878           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 20879              (P1 > +8)
 20880              OR (DD-PROD-CODE (D1 P1) = 'L')
 20881           END-PERFORM
 20882           IF P1 < +9
 20883              MOVE DD-MAX-BEN-AMT (D1 P1)
 20884                                 TO CP-R-MAX-TOT-BEN
 20885           END-IF
 20886        END-IF
 20887     END-IF
 20888
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 400
* ECS010.cbl
 20889     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 20890
 20891     IF  CP-RETURN-CODE NOT = ZERO
 20892         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 20893                             TO WS-ABEND-MESSAGE
 20894         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 20895         MOVE 2001           TO WS-ABEND-CODE
 20896         GO TO ABEND-PGM.
 20897
 20898 4680-EXIT.
 20899     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 401
* ECS010.cbl
 20901******************************************************************
 20902***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 20903******************************************************************
 20904
 20905 4700-CALC-OPT-IBNR.
 20906
 20907     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 20908     MOVE SPACE                  TO W-UNDERWRITING-SW.
 20909
 20910     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20911             VARYING
 20912         SUB2 FROM +1 BY +1
 20913             UNTIL
 20914*        SUB2 GREATER THAN 300.
 20915*        SUB2 GREATER THAN 220.
 20916         SUB2 GREATER THAN 900.
 20917
 20918     MOVE EPEC-UNDW-OPT-DATA-TABLE
 20919                                 TO EPEC-OPT-WORK-TABLE.
 20920     MOVE '*'                    TO W-UNDERWRITING-SW.
 20921
 20922     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20923             VARYING
 20924         SUB2 FROM +1 BY +1
 20925             UNTIL
 20926*        SUB2 GREATER THAN 300.
 20927*        SUB2 GREATER THAN 220.
 20928         SUB2 GREATER THAN 900.
 20929
 20930 4700-EXIT.
 20931     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 402
* ECS010.cbl
 20933 4710-PROCESS-THRU-EPEC-TABLE.
 20934
 20935     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 20936         GO TO 4710-EXIT.
 20937
 20938     IF  W-UNDERWRITTEN-DATA
 20939         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 20940     ELSE
 20941         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 20942
 20943     IF EW-LEVEL-USED NOT = 'Y'
 20944         GO TO 4710-EXIT.
 20945
 20946     IF  EW-REIN-CO GREATER THAN SPACES
 20947         MOVE 'Y'                TO W-REIN-PROCESS-SW
 20948         IF  EPEC-REIN-ONLY-DATA (SUB2)
 20949             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 20950             IF  W-WK-IBNR GREATER THAN ZEROS
 20951                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20952                 GO TO 4710-EXIT
 20953             ELSE
 20954                 GO TO 4710-EXIT
 20955         ELSE
 20956             IF  EW-CLM-IBNR GREATER THAN ZEROS
 20957                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20958                 GO TO 4710-EXIT
 20959             ELSE
 20960                 GO TO 4710-EXIT.
 20961
 20962     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 20963
 20964     IF  EW-LF-AH EQUAL 'L'
 20965         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 20966             GO TO 4710-EXIT
 20967         ELSE
 20968             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 20969             ADD W-WK-IBNR       TO W-LIFE-IBNR
 20970     ELSE
 20971         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 20972                 GREATER THAN ZEROS
 20973             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 20974             ADD W-WK-IBNR       TO W-AH-IBNR
 20975         ELSE
 20976             GO TO 4710-EXIT.
 20977
 20978     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 20979     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 20980     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 20981
 20982     IF  W-UNDERWRITTEN-DATA
 20983         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 20984     ELSE
 20985         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 20986
 20987
 20988     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20989     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 20990
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 403
* ECS010.cbl
 20991 4710-EXIT.
 20992     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 404
* ECS010.cbl
 20994 4720-PROCESS-LIFE.
 20995
 20996     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 20997
 20998 4720-EXIT.
 20999     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 405
* ECS010.cbl
 21001 4730-PROCESS-A-H.
 21002
 21003     IF  AM-TARGET-LOSS-RATIO NUMERIC
 21004             AND
 21005         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 21006         MOVE AM-TARGET-LOSS-RATIO
 21007                                 TO W-TARGET-LOSS-RATIO
 21008     ELSE
 21009         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 21010             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 21011                                 TO W-TARGET-LOSS-RATIO
 21012             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 21013
 21014     IF  W-NOT-REIN-PROCESS
 21015         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 21016         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 21017
 21018     COMPUTE W-IBNR-1 ROUNDED
 21019         = EPEC-EARNED-PREMIUM-AH (SUB2)
 21020         * COMPANY-IBNR-AH-FACTOR
 21021         * W-TARGET-LOSS-RATIO.
 21022
 21023     COMPUTE W-IBNR-2 ROUNDED
 21024         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 21025         * W-TARGET-LOSS-RATIO)
 21026         - EPEC-CLAIMS-MADE-PAID (SUB2).
 21027
 21028     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 21029         MOVE W-IBNR-1           TO W-WK-IBNR
 21030         IF  W-NOT-REIN-PROCESS
 21031             ADD +1              TO W-AH-IBNR-1-CNT
 21032             ADD W-IBNR-1        TO W-AH-IBNR-1
 21033         ELSE
 21034             NEXT SENTENCE
 21035     ELSE
 21036         MOVE W-IBNR-2           TO W-WK-IBNR
 21037         IF  W-NOT-REIN-PROCESS
 21038             ADD +1              TO W-AH-IBNR-2-CNT
 21039             ADD W-IBNR-2        TO W-AH-IBNR-2.
 21040
 21041 4730-EXIT.
 21042     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 406
* ECS010.cbl
 21044 4735-GET-BUSINESS-ADJUSTMENT.
 21045
 21046     IF  CR-GRPTYP NOT NUMERIC
 21047         MOVE '99'               TO INDEXBS
 21048     ELSE
 21049         MOVE CR-GRPTYP          TO INDEXBS.
 21050
 21051     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 21052             AND
 21053         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 21054             NOT EQUAL ZEROS
 21055             AND
 21056         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 21057             NOT EQUAL +1.0000
 21058         MOVE INDEXBS           TO W-EDIT-7
 21059         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 21060             = W-TARGET-LOSS-RATIO
 21061             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 21062
 21063 4735-EXIT.
 21064     EXIT.
 21065
 21066 4740-CREATE-DETAIL-EXTR.
 21067
 21068     IF DTE-PGM-OPT NOT = '1'
 21069         GO TO 4740-EXIT.
 21070
 21071     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 21072         GO TO 4740-EXIT.
 21073
 21074     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 21075     MOVE ZEROS                  TO REPORTED-DATE
 21076                                    PAY-TO-DATE.
 21077
 21078     MOVE SPACES                 TO TR-DTL2.
 21079     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 21080
 21081     MOVE EOM-YR                 TO TRD-ISYR.
 21082     MOVE EOM-MO                 TO TRD-ISMO.
 21083     MOVE EOM-DA                 TO TRD-ISDA.
 21084     MOVE ZERO                   TO TRD-AGE.
 21085
 21086     IF  EW-LF-AH EQUAL 'L'
 21087         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 21088     ELSE
 21089         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 21090
 21091     MOVE SPACES                 TO TRD-PAYCURX
 21092                                    TRD-PAYCUR-SPACE
 21093                                    TRD-FUTRSV-SPACE
 21094                                    TRD-FUTRSVX.
 21095
 21096     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 21097     MOVE 'IBNR'                 TO TRD-IBNRX.
 21098     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 21099     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 21100
 21101     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 407
* ECS010.cbl
 21102         IF  W-REIN-IN-PROCESS
 21103             MOVE ' ACCT/BEN REIN RSV UW'
 21104                                 TO TRD-RSV-ACTION
 21105         ELSE
 21106             MOVE ' ACCT/BEN RESERVES UW'
 21107                                 TO TRD-RSV-ACTION
 21108     ELSE
 21109         IF  W-REIN-IN-PROCESS
 21110             MOVE ' ACCT/BEN REIN RSV'
 21111                                 TO TRD-RSV-ACTION
 21112         ELSE
 21113             MOVE ' ACCT/BEN RESERVES'
 21114                                 TO TRD-RSV-ACTION.
 21115
 21116     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 21117
 21118     MOVE SPACES                 TO DETAIL-EXTRACT.
 21119
 21120     IF  W-REIN-IN-PROCESS
 21121         MOVE EW-REIN-CO         TO DE-REI-COMP
 21122         MOVE 'R'                TO DE-REIN
 21123         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 21124         MOVE ZEROS              TO DE-IBNR
 21125     ELSE
 21126         MOVE EW-CLM-IBNR        TO DE-IBNR
 21127         MOVE ZEROS              TO DE-REI-IBNR.
 21128
 21129     MOVE 'DE'                   TO DE-RECORD-ID.
 21130     MOVE 'Y'                    TO DE-TRANS.
 21131     MOVE 'IBNRRSV'              TO DE-CLMNO.
 21132     MOVE '1'                    TO DE-ENTRY-STATUS.
 21133     MOVE 'ACTBENIBNR'           TO DE-CERT.
 21134
 21135     MOVE EOM-RUN-DATE           TO DE-EFF
 21136                                    WS-DE-EFF-N
 21137                                    DE-ENTRY-DTE
 21138                                    WS-DE-ENTRY-DTE-N.
 21139     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 21140                                    WS-DE-RSV-INCUR-N.
 21141
 21142     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 21143     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 21144     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 21145                                    WS-DE-ACC-EXP-DTE-RSV-N.
 21146     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 21147                                    WS-DE-ACC-EFF-DTE-RSV-N.
 21148
 21149     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 21150     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 21151     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 21152     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 21153     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 21154*    MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 21155     MOVE AM-IG                  TO DE-IG.
 21156
 21157     IF W-UNDERWRITTEN-DATA
 21158         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 21159     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 408
* ECS010.cbl
 21160         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 21161
 21162     IF  EW-LF-AH EQUAL 'L'
 21163         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 21164         MOVE '1'                TO DE-RESERVE-TYPE
 21165         MOVE ZEROS              TO DE-AH-TYPE
 21166     ELSE
 21167         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 21168         MOVE '2'                TO DE-RESERVE-TYPE
 21169         MOVE ZEROS              TO DE-LF-TYPE.
 21170
 21171     MOVE SPACES                 TO DE-NAME
 21172                                    DE-ACC-GPCD
 21173                                    DE-AH-STAT-CDE
 21174                                    DE-LF-STAT-CDE
 21175                                    DE-MEMBER-NO
 21176                                    DE-NAME
 21177                                    DE-SEX.
 21178     MOVE ZEROS                  TO DE-AGE
 21179                                    DE-AH-BEN
 21180                                    DE-AH-CANC-DTE
 21181                                    WS-DE-AH-CANC-DTE-N
 21182                                    DE-AH-CANC-EXIT-DT
 21183                                    WS-DE-AH-CANC-EXIT-DT-N
 21184                                    DE-AH-PRM
 21185                                    DE-AH-RFND
 21186                                    DE-AH-TERM
 21187                                    DE-APR
 21188                                    DE-CANCEL-CNT-ITD
 21189                                    DE-CANCEL-CNT-YTD
 21190                                    DE-FUTRSV
 21191                                    DE-LF-BEN
 21192                                    DE-LF-BEN-ALT
 21193                                    DE-LF-CANC-DTE
 21194                                    WS-DE-LF-CANC-DTE-N
 21195                                    DE-LF-CANC-EXIT-DT
 21196                                    WS-DE-LF-CANC-EXIT-DT-N
 21197                                    DE-LF-CNBEN
 21198                                    DE-LF-CNBEN-ALT
 21199                                    DE-LF-PRM
 21200                                    DE-LF-PRM-ALT
 21201                                    DE-LF-RFND
 21202                                    DE-LF-TERM
 21203                                    DE-LOAN-TERM
 21204                                    DE-LIVES
 21205                                    DE-PAYCUR
 21206                                    DE-PMT-FREQ
 21207                                    DE-REI-AHAMT
 21208                                    DE-REI-AHPRM
 21209                                    DE-REI-AHRFND
 21210                                    DE-REI-CNAMT
 21211                                    DE-REI-FUTRSV
 21212                                    DE-REI-LFAMT
 21213                                    DE-REI-LFPRM
 21214                                    DE-REI-LFRFND
 21215                                    DE-REI-PAYCUR
 21216                                    DE-RSV-REPORTED
 21217                                    DE-RSV-PAYTO
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 409
* ECS010.cbl
 21218                                    WS-DE-RSV-PAYTO-N
 21219                                    DE-MOB-NET-TOT-FEES
 21220                                    DE-SOC-SEC-NO.
 21221
 21222     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 21223
 21224     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 21225         THRU 2599-WRT-DETAIL-X.
 21226     ADD +1                      TO BC-G-CRS.
 21227
 21228 4740-EXIT.
 21229     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 410
* ECS010.cbl
 21231 4750-UPDATE-REIN.
 21232
 21233     COMPUTE SUB3 = SUB2 + 1.
 21234
 21235     IF  W-UNDERWRITTEN-DATA
 21236         MOVE EPEC-SUB-KEY-II (SUB2)
 21237                                 TO W-SUB-KEY
 21238     ELSE
 21239         MOVE EPEC-SUB-KEY (SUB2)
 21240                                 TO W-SUB-KEY.
 21241
 21242     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 21243             VARYING
 21244         SUB3 FROM SUB3 BY +1
 21245             UNTIL
 21246         SUB3 GREATER THAN +900
 21247*        SUB3 GREATER THAN +220
 21248*        SUB3 GREATER THAN +300
 21249             OR
 21250         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 21251
 21252 4750-EXIT.
 21253     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 411
* ECS010.cbl
 21255 4755-MATCH-REIN-EPEC.
 21256
 21257     IF  W-UNDERWRITTEN-DATA
 21258         MOVE EPEC-LEVELS-II (SUB3)
 21259                                 TO EPEC-WORK
 21260     ELSE
 21261         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 21262
 21263     IF  EPEC-LINE-NOT-USED (SUB3)
 21264         GO TO 4755-EXIT.
 21265
 21266     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 21267             OR
 21268         EW-REIN-CO EQUAL SPACES
 21269         GO TO 4755-EXIT.
 21270
 21271     IF  W-ISS-BEN GREATER THAN ZEROS
 21272         IF  EPEC-REIN-ONLY-DATA (SUB3)
 21273             COMPUTE W-FACTOR ROUNDED
 21274                 = (EW-ISS-BEN
 21275                 - EPEC-REIN-ISS-BEN (SUB3))
 21276                 / W-ISS-BEN
 21277         ELSE
 21278             COMPUTE W-FACTOR ROUNDED
 21279                 = EW-ISS-BEN
 21280                 / W-ISS-BEN.
 21281
 21282     COMPUTE EW-CLM-IBNR ROUNDED
 21283         = EW-CLM-IBNR
 21284         + (W-WK-IBNR * W-FACTOR).
 21285
 21286     IF  W-UNDERWRITTEN-DATA
 21287         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 21288     ELSE
 21289         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 21290
 21291 4755-EXIT.
 21292     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 412
* ECS010.cbl
 21294 4760-PROCESS-REIN-ONLY.
 21295
 21296     MOVE ZEROS                  TO W-WK-IBNR.
 21297
 21298     IF  EPEC-LINE-NOT-USED (SUB2)
 21299         GO TO 4760-EXIT.
 21300
 21301     IF  EW-LF-AH EQUAL 'L'
 21302         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 21303             GO TO 4760-EXIT
 21304         ELSE
 21305             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 21306             ADD W-WK-IBNR       TO EW-CLM-IBNR
 21307     ELSE
 21308         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 21309             GO TO 4760-EXIT
 21310         ELSE
 21311             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 21312             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 21313
 21314 4760-EXIT.
 21315     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 413
* ECS010.cbl
 21317 4770-CREATE-REIN-DETAIL.
 21318
 21319     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 21320     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 21321
 21322 4770-EXIT.
 21323     EXIT.
 21324
 21325 4799-EXIT.
 21326     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 414
* ECS010.cbl
 21328 4800-CALC-EARNED-PREMIUM-AH.
 21329
 21330     MOVE +0                         TO CNC-BEN  EPR-R78
 21331                                        ISS-PRM  EPR-PRO
 21332                                        CNC-PRM  EPR-ST
 21333                                        WX-CLM-AMT
 21334                                        WX-CLM-EXP
 21335                                        WX-CLM-CNT
 21336                                        WX-CLM-CRT
 21337                                        WX-CNC-CNT
 21338                                        ISS-PRMTAX
 21339                                        WX-ACTIVE-COUNT.
 21340     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 21341
 21342     MOVE WE-AHPRM TO ISS-PRM.
 21343
 21344     IF DTE-CLIENT = 'GIC'
 21345         IF REIN-EP-FLG NOT = 'R'  AND
 21346            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 21347            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 21348            MOVE CR-AHPRM-CALC TO ISS-PRM.
 21349
 21350     IF REIN-EP-FLG = 'R'  AND
 21351        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 21352         NEXT SENTENCE
 21353     ELSE
 21354         GO TO 4810-EP-DO-AH-CLM.
 21355
 21356     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 21357         IF WE-DSPY-AMT NOT = +0
 21358             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21359             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21360             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21361             ADD +1             TO WX-CLM-CNT.
 21362
 21363     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21364         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 21365             GO TO 4830-EP-DO-AH-EP.
 21366
 21367     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 21368         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 21369             GO TO 4830-EP-DO-AH-EP.
 21370
 21371     GO TO 4815-EP-DO-AH-CLM-EPR.
 21372
 21373 4810-EP-DO-AH-CLM.
 21374
 21375     IF WE-DSPY-AMT NOT = +0
 21376         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21377         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21378         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21379         ADD +1             TO WX-CLM-CNT.
 21380
 21381 4815-EP-DO-AH-CLM-EPR.
 21382
 21383     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21384         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 21385
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 415
* ECS010.cbl
 21386 4820-EP-DO-AH-CNCL.
 21387
 21388     IF CR-AH-STATUS-AT-CANCEL = ' '
 21389         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 21390            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21391             GO TO 4899-EXIT
 21392         ELSE
 21393             GO TO 4830-EP-DO-AH-EP.
 21394
 21395     IF (DTE-CLIENT = 'DCC')
 21396        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21397        IF CR-AHRFND NOT = ZEROS
 21398           ADD +1                TO WX-CNC-CNT
 21399        END-IF
 21400     ELSE
 21401        ADD +1                   TO WX-CNC-CNT
 21402     END-IF
 21403
 21404     MOVE WE-AHRFND TO CNC-PRM.
 21405
 21406*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 21407*    MOVE 'L'                   TO  DC-OPTION-CODE.
 21408*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21409*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 21410
 21411     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 21412     MOVE 'L'                   TO  DC-OPTION-CODE.
 21413     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21414     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 21415
 21416     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 21417     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 21418     MOVE '1'                     TO  DC-OPTION-CODE.
 21419     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 21420     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 21421                                      DC-ODD-DAYS-OVER
 21422                                      DC-ELAPSED-DAYS.
 21423     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21424     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 21425
 21426     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 21427         ADD  +1                  TO  MONTHS-DIFF-AH.
 21428
 21429     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21430                                      WS-DCC-DDF-CB-LEVELS
 21431
 21432     if (dte-client = 'AHL')
 21433        and (cr-ah-cancel-exit-date < 20120401)
 21434        go to 4820-continue-ah-cancel
 21435     end-if
 21436
 21437     IF DTE-CLIENT = 'ACE'
 21438         GO TO 4820-CONTINUE-AH-CANCEL.
 21439
 21440     MOVE  ZEROS                  TO  SUB.
 21441
 21442 4820-AH-CHARGEBACK-LOOP.
 21443
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 416
* ECS010.cbl
 21444     ADD    +1                    TO  SUB.
 21445
 21446     IF  SUB  GREATER THAN  +10
 21447         GO TO  4820-CONTINUE-AH-CANCEL.
 21448
 21449     IF CR-CANCEL-REASON = 'R'
 21450        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 21451           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 21452              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 21453              GO TO  4820-AH-CHARGEBACK-LOOP
 21454           END-IF
 21455           IF AM-COM-TYP (SUB) = 'J'
 21456              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 21457              GO TO  4820-AH-CHARGEBACK-LOOP
 21458           END-IF
 21459        END-IF
 21460     END-IF
 21461
 21462     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 21463         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 21464         GO TO  4820-AH-CHARGEBACK-LOOP.
 21465
 21466     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 21467         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 21468
 21469     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 21470         OR (CR-AHRFND = ZEROS)
 21471         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 21472     END-IF
 21473
 21474     GO TO  4820-AH-CHARGEBACK-LOOP.
 21475
 21476
 21477 4820-CONTINUE-AH-CANCEL.
 21478
 21479     IF DTE-CLIENT = 'GIC'
 21480         IF REIN-EP-FLG NOT = 'R'  AND
 21481            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21482            MOVE CR-AHRFND-CALC TO CNC-PRM.
 21483
 21484     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 21485     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 21486
 21487     IF CR-AH-LUMP-SUM-DISAB
 21488         GO TO 4899-EXIT.
 21489
 21490     MOVE WE-AHAMT TO CNC-BEN.
 21491
 21492     GO TO 4899-EXIT.
 21493
 21494 4825-EP-DO-AH-CNCL-SUM.
 21495
 21496     IF WE-DSPY-AMT NOT = +0
 21497         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21498         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21499         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21500         ADD +1             TO WX-CLM-CNT.
 21501
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 417
* ECS010.cbl
 21502     IF WE-AHRFND = ZERO
 21503        GO TO 4830-EP-DO-AH-EP.
 21504
 21505     MOVE WE-AHRFND TO CNC-PRM.
 21506
 21507     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 21508
 21509     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21510                                      WS-DCC-DDF-CB-LEVELS
 21511
 21512     IF WE-AHRFND NOT LESS WE-AHPRM
 21513         MOVE WE-AHAMT TO CNC-BEN
 21514          GO TO 4830-EP-DO-AH-EP.
 21515
 21516     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 21517     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 21518     MOVE TEMP-7 TO CNC-BEN.
 21519
 21520 4830-EP-DO-AH-EP.
 21521
 21522     MOVE EOM-RUN-DATE TO VALUATION-DT.
 21523     MOVE '8'           TO W-VAL-SOURCE.
 21524
 21525     IF REIN-EP-FLG = 'R'
 21526       IF REIN-REM-SW (SUB5) = 'I'
 21527           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 21528           GO TO 4899-EXIT.
 21529
 21530     IF REIN-EP-FLG = 'R'
 21531         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 21532            EARNING-STOP-DATE LESS THAN VALUATION-DT
 21533             MOVE '*'               TO A-H-EARNED-SWITCH
 21534             MOVE EARNING-STOP-DATE TO VALUATION-DT
 21535             MOVE '10'              TO W-VAL-SOURCE.
 21536
 21537     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 21538
 21539     IF REM-TRM2 GREATER CR-AH-TERM
 21540         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21541         GO TO 4899-EXIT.
 21542
 21543     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 21544         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 21545*
 21546 4835-CHECK-OB-AH-NCL.
 21547
 21548     IF (DTE-CLIENT EQUAL 'NCL') AND
 21549        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 21550           MOVE WE-AHPRM         TO EPR-R78
 21551                                    EPR-PRO
 21552                                    EPR-ST
 21553        IF (CR-CCYY EQUAL EOM-CCYY) AND
 21554           (CR-MO EQUAL EOM-MO)
 21555           MOVE '*'            TO OB-DATE-1-SWITCH
 21556           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21557           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21558           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21559           COMPUTE WS-EPR-R78 (SUB3 1) =
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 418
* ECS010.cbl
 21560                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 21561           GO TO 4899-EXIT
 21562        ELSE
 21563        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 21564           (CR-MO EQUAL OB-MO (1))
 21565           MOVE '*'            TO OB-DATE-2-SWITCH
 21566           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21567           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21568           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21569           COMPUTE WS-EPR-R78 (SUB3 2) =
 21570                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 21571           GO TO 4899-EXIT
 21572        ELSE
 21573        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 21574           (CR-MO EQUAL OB-MO (2))
 21575           MOVE '*'            TO OB-DATE-3-SWITCH
 21576           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21577           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21578           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21579           COMPUTE WS-EPR-R78 (SUB3 3) =
 21580                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 21581           GO TO 4899-EXIT
 21582        ELSE
 21583           GO TO 4899-EXIT.
 21584
 21585     IF REM-TRM2 NOT GREATER +0
 21586         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21587         GO TO 4899-EXIT.
 21588
 21589     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21590         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21591         GO TO 4899-EXIT.
 21592
 21593     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21594         MOVE +1 TO WX-ACTIVE-COUNT
 21595     ELSE
 21596         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 21597
 21598     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 21599     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 21600     IF DTE-R78 = '1'
 21601         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 21602     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 21603
 21604     IF DTE-CLIENT = 'MIC' OR 'MCC'
 21605         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 21606     ELSE
 21607         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 21608
 21609     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 21610     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21611
 21612     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 21613     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 21614
 21615     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 21616
 21617*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 419
* ECS010.cbl
 21618*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 21619
 21620     MOVE SPACES TO STATUTORY-SWITCH-AH.
 21621
 21622     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 21623        (CR-DT GREATER THAN  19921231)
 21624        AND (DTE-CLIENT NOT = 'DCC' AND 'AHL')
 21625         IF CR-AH-TERM GREATER THAN  +61
 21626             MOVE 'A' TO AH-EARN-METHOD
 21627             MOVE '*' TO STATUTORY-SWITCH-AH
 21628             GO TO 4845-EP-DO-AH-EP-AN
 21629         ELSE
 21630             GO TO 4860-EP-DO-AH-STATUTORY.
 21631
 21632     IF (AH-EARN-METHOD EQUAL 'N')
 21633                  OR
 21634        ((DTE-CLIENT = 'DCC')
 21635         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21636         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA)
 21637                                    NOT = 'G' AND 'D'))
 21638         GO TO 4840-EP-DO-AH-EP-NP
 21639     END-IF
 21640
 21641     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 21642         MOVE 'A' TO AH-EARN-METHOD
 21643         GO TO 4845-EP-DO-AH-EP-AN.
 21644
 21645     GO TO 4860-EP-DO-AH-STATUTORY.
 21646
 21647 4840-EP-DO-AH-EP-NP.
 21648
 21649     IF WE-AHPRM = ZERO
 21650         GO TO 4860-EP-DO-AH-STATUTORY.
 21651
 21652     IF CR-APR GREATER THAN +0
 21653         NEXT SENTENCE
 21654     ELSE
 21655         GO TO 4860-EP-DO-AH-STATUTORY.
 21656
 21657     IF DTE-CLIENT = 'NCL'
 21658       IF CR-DT LESS THAN 19910101
 21659           GO TO 4860-EP-DO-AH-STATUTORY.
 21660
 21661     IF REM-TRM1 = CR-AH-TERM
 21662         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21663         GO TO 4899-EXIT.
 21664
 21665     MOVE CR-APR TO NP-APR.
 21666     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 21667     MOVE REM-TRM1 TO NP-REM.
 21668     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 21669     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 21670         MOVE CR-LOAN-TERM TO NP-ORIG.
 21671
 21672     IF (DTE-CLIENT = 'DCC')
 21673        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21674        MOVE 'S'                 TO NP-OPT
 21675     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 420
* ECS010.cbl
 21676        MOVE 'R'                 TO NP-OPT
 21677     END-IF
 21678
 21679
 21680*    MOVE 'R' TO NP-OPT.
 21681     CALL 'ECSNETRM'
 21682         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 21683
 21684     IF (DTE-CLIENT = 'DCC')
 21685        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21686        COMPUTE EPR-ST ROUNDED =
 21687           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21688        GO TO 4899-EXIT
 21689     ELSE
 21690        COMPUTE EPR-R78 ROUNDED =
 21691           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21692     END-IF
 21693
 21694     GO TO 4860-EP-DO-AH-STATUTORY.
 21695
 21696 4845-EP-DO-AH-EP-AN.
 21697     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21698     MOVE 'L'                        TO DC-OPTION-CODE.
 21699     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21700     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21701     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21702     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21703     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21704     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21705     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21706     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21707     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21708     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21709                                        CP-RATING-BENEFIT-AMT.
 21710     IF CP-STATE-STD-ABBRV = 'OR'
 21711         COMPUTE CP-RATING-BENEFIT-AMT =
 21712                                  CR-AHAMT * REM-TRM1.
 21713     MOVE CR-APR                     TO CP-LOAN-APR.
 21714     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21715     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 21716     MOVE '3'                        TO CP-PROCESS-TYPE.
 21717     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21718     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21719     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21720         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21721     ELSE
 21722         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21723     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21724     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21725     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21726     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21727     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21728     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21729
 21730     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21731
 21732     IF CP-ERROR-RATE-NOT-FOUND  OR
 21733        CP-ERROR-RATE-IS-ZERO  OR
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 421
* ECS010.cbl
 21734        CP-ERROR-IN-DATES
 21735         GO TO 4860-EP-DO-AH-STATUTORY.
 21736
 21737     COMPUTE EPR-R78 ROUNDED =
 21738             (REM-TRM1 * WE-AHAMT / +100 *
 21739               CP-PREMIUM-RATE)
 21740              / CR-AHPRM-CALC * CR-AHPRM
 21741
 21742     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21743
 21744     IF STATUTORY-REQUIREMENT-AH
 21745         MOVE EPR-R78                TO EPR-ST
 21746         GO TO 4899-EXIT.
 21747
 21748 4860-EP-DO-AH-STATUTORY.
 21749     IF (DTE-CLIENT EQUAL 'CID') AND
 21750        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 21751         GO TO 4867-EP-DO-AH-STAT-ROA
 21752     END-IF.
 21753
 21754 4860-EP-DO-AH-STATUTORY-VA.
 21755
 21756     IF (DTE-CLIENT = 'DCC')
 21757        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21758        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21759        AND (CLAS-I-BEN (CLAS-INDEXA) NOT = '55' AND '56')
 21760        MOVE EPR-R78             TO EPR-ST
 21761        GO TO 4899-EXIT
 21762     END-IF
 21763
 21764     IF (DTE-CLIENT = 'DCC')
 21765        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21766        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21767        AND (CLAS-I-BEN (CLAS-INDEXA) = '55' OR '56')
 21768        MOVE +1.0000                TO TEMP-6
 21769        IF REM-TRM1 < +9
 21770           COMPUTE TEMP-6 =
 21771              ((9 - (9 - REM-TRM1)) - 1)
 21772              * +.125
 21773        END-IF
 21774        COMPUTE EPR-ST ROUNDED = WE-AHPRM - (WE-AHPRM * TEMP-6)
 21775        MOVE EPR-ST              TO EPR-R78
 21776                                    EPR-PRO
 21777        GO TO 4899-EXIT
 21778     END-IF
 21779
 21780     MOVE EPR-R78                    TO EPR-ST.
 21781
 21782***  WE WANT R78 IN AH STAT FOR AHL
 21783
 21784     IF DTE-CLIENT = 'AHL'
 21785        GO TO 4899-EXIT
 21786     END-IF
 21787
 21788     MOVE +0                         TO SUB1.
 21789
 21790 4865-EP-AH-STAT-LOOP.
 21791     ADD +1 TO SUB1.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 422
* ECS010.cbl
 21792
 21793     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 21794         MOVE EPR-PRO                TO EPR-ST
 21795     ELSE
 21796         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 21797             GO TO 4865-EP-AH-STAT-LOOP.
 21798
 21799     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 21800         CR-DT GREATER THAN 19831031)  OR
 21801
 21802        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 21803         CR-DT GREATER THAN 19820629)  OR
 21804
 21805        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 21806         CR-DT GREATER THAN 19830831)  OR
 21807
 21808        (STATE-ABBR (CLAS-INDEXS) = 'MN'  AND
 21809         CR-DT GREATER THAN 20091231)
 21810
 21811         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21812
 21813     IF DTE-CLIENT = 'CSO'  OR  'CID'
 21814       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 21815         IF CR-DT LESS THAN 19970101
 21816             MOVE EPR-R78            TO EPR-ST
 21817         ELSE
 21818             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21819
 21820     IF DTE-CLIENT = 'DCC'
 21821        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 21822           MOVE EPR-PRO          TO EPR-ST
 21823        ELSE
 21824           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 21825        END-IF
 21826     END-IF
 21827
 21828     IF (DTE-CLIENT = 'DCC')
 21829        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 21830        CONTINUE
 21831     ELSE
 21832        GO TO 4899-EXIT
 21833     END-IF
 21834
 21835*    MOVE ' '                    TO DD-IU-SW
 21836
 21837     MOVE +0                     TO WS-DDF-ADMIN-FEES
 21838                                    WS-DDF-CSO-ADMIN-FEE
 21839                                    WS-DDF-1ST-YR-TOT-EXP
 21840                                    WS-COMM-AND-MFEE
 21841
 21842     PERFORM VARYING D1 FROM +2 BY +1 UNTIL
 21843        D1 > +10
 21844        IF (CR-AGT-TYPE (D1) = 'L' OR 'N')
 21845           AND (CR-LCOM-AH (D1) NUMERIC)
 21846           COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
 21847              + (CR-LCOM-AH (D1) * +1000)
 21848        END-IF
 21849        IF (CR-AGT-TYPE (D1) = 'N')
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 423
* ECS010.cbl
 21850           AND (CR-LCOM-AH (D1) NUMERIC)
 21851           COMPUTE WS-DDF-CSO-ADMIN-FEE = WS-DDF-CSO-ADMIN-FEE
 21852              + (CR-LCOM-AH (D1) * +1000)
 21853        END-IF
 21854        IF (CR-AGT-TYPE (D1) = 'I' )
 21855           AND (CR-LCOM-AH (D1) NUMERIC)
 21856           COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 21857              + (CR-LCOM-AH (D1) * +1000)
 21858        END-IF
 21859        IF (CR-AGT-TYPE (D1) = 'J' OR 'L')
 21860           AND (CR-LCOM-AH (D1) NUMERIC)
 21861           COMPUTE WS-DDF-1ST-YR-TOT-EXP = WS-DDF-1ST-YR-TOT-EXP
 21862              + (CR-LCOM-AH (D1) * +1000)
 21863        END-IF
 21864     END-PERFORM
 21865
 21866     MOVE WS-DDF-ADMIN-FEES      TO CP-DDF-ADMIN-FEES
 21867     MOVE WS-DDF-CSO-ADMIN-FEE   TO CP-DDF-CSO-ADMIN-FEE
 21868
 21869     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 21870                                 THRU 4910-EXIT
 21871
 21872     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21873        + WS-DDF-1ST-YR-TOT-EXP
 21874
 21875     COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 21876        (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 21877     MOVE WS-LO-UEF              TO CP-DDF-LO-FACT
 21878     MOVE WS-HI-UEF              TO CP-DDF-HI-FACT
 21879
 21880     MOVE 'D'                    TO CP-EARNING-METHOD
 21881     MOVE 'G'                    TO CP-DDF-SPEC-CALC
 21882     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
 21883     MOVE CR-AH-CLP              TO CP-DDF-CLP
 21884     MOVE WS-COMM-AND-MFEE       TO CP-DDF-COMM-AND-MFEE
 21885     MOVE DD-1ST-YR-ALLOW (D1)   TO CP-DDF-YR1AF
 21886
 21887     IF REIN-EP-FLG = 'R'
 21888        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21889        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21890        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21891     END-IF
 21892
 21893     IF DD-IU-PRESENT
 21894        MOVE 'I'              TO CP-EARNING-METHOD
 21895     END-IF
 21896
 21897     MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21898                                 CP-CLP-RATE-UP
 21899
 21900
 21901     display ' cert no ' cr-cert-no
 21902     display ' rate up ' cp-iu-rate-up
 21903     display ' addl clp ' cr-addl-clp
 21904     display ' ah clp  ' cr-ah-clp
 21905     display ' orig prem ' cp-original-premium
 21906
 21907     IF (CP-CALC-GROSS-FEE)
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 424
* ECS010.cbl
 21908        AND (CP-IU-RATE-UP NOT = ZEROS)
 21909        COMPUTE CP-IU-RATE-UP =
 21910           CP-IU-RATE-UP / (1 - ((CR-ADDL-CLP + CR-AH-CLP)
 21911           / CP-ORIGINAL-PREMIUM))
 21912     END-IF
 21913
 21914     display ' here 4 '
 21915     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 21916     MOVE REM-TRM1                   TO CP-REMAINING-TERM
 21917
 21918     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21919        + WS-DDF-1ST-YR-TOT-EXP
 21920
 21921     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 21922
 21923     COMPUTE EPR-ST = WE-AHPRM - CP-CALC-REFUND
 21924
 21925     IF CP-DDF-SPEC-CALC = 'C'
 21926        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21927     ELSE
 21928        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21929        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21930        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21931        MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21932        CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 21933        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21934     END-IF
 21935
 21936     display ' here 6 '
 21937     GO TO 4899-EXIT
 21938
 21939     .
 21940 4867-EP-DO-AH-STAT-ROA.
 21941     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21942     MOVE 'L'                        TO DC-OPTION-CODE.
 21943     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21944     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21945     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21946     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21947     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21948     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21949     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21950     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21951     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21952     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21953                                        CP-RATING-BENEFIT-AMT.
 21954     IF CP-STATE-STD-ABBRV = 'OR'
 21955         COMPUTE CP-RATING-BENEFIT-AMT =
 21956                                  CR-AHAMT * REM-TRM1.
 21957     MOVE CR-APR                     TO CP-LOAN-APR.
 21958     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21959     MOVE 'A'                        TO CP-EARNING-METHOD.
 21960     MOVE '3'                        TO CP-PROCESS-TYPE.
 21961     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21962     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21963     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21964         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21965     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 425
* ECS010.cbl
 21966         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21967     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21968     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21969     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21970     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21971     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21972     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21973
 21974     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21975
 21976     IF CP-ERROR-RATE-NOT-FOUND  OR
 21977        CP-ERROR-RATE-IS-ZERO  OR
 21978        CP-ERROR-IN-DATES
 21979         GO TO 4860-EP-DO-AH-STATUTORY-VA.
 21980
 21981     COMPUTE EPR-ST ROUNDED =
 21982             (REM-TRM1 * WE-AHAMT / +100 *
 21983               CP-PREMIUM-RATE)
 21984              / CR-AHPRM-CALC * CR-AHPRM
 21985
 21986     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 21987
 21988     GO TO 4899-EXIT.
 21989
 21990 4899-EXIT.
 21991     EXIT.
 21992******************************************************************
 21993***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 21994******************************************************************
 21995
 21996 4900-WRITE-SUMMARY-EXTRACTS.
 21997
 21998     IF DTE-CLIENT = 'HER'
 21999         IF EP-RECORD-ID = 'EC'  AND
 22000            EP-REINCO = 'LNL'
 22001             GO TO 4900-WRT-SUMMARY-X.
 22002
 22003     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 22004                                     WS-EP-RUN-DTE-N.
 22005
 22006     IF W-UNDERWRITTEN-DATA
 22007         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
 22008     ELSE
 22009         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 22010
 22011     IF  DTE-OPT-RESERVE-METHOD-AUTH
 22012         IF VALID-EP-ID
 22013             MOVE 'Y'             TO EP-NEW-DATA-IND.
 22014
 22015     WRITE EP-RECORD.
 22016
 22017     ADD +1                       TO EP-CNT.
 22018
 22019 4900-WRT-SUMMARY-X.
 22020     EXIT.
 22021
 22022 4910-DCC-DFF-FACT-LOOKUP.
 22023
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 426
* ECS010.cbl
 22024     IF CR-CERT-NO = WS-FACT-CERT
 22025        go to 4910-exit
 22026     end-if
 22027
 22028     if cr-clp-state = spaces
 22029        move cr-state            to cr-clp-state
 22030     end-if
 22031     MOVE ' ' TO DD-IU-SW
 22032     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 22033        ((CR-clp-STATE = DD-STATE (D1))
 22034        AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 22035        AND ('A'           = DD-BEN-TYPE   (D1))
 22036        AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 22037        AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 22038                        OR
 22039        D1 > max-pdef
 22040     END-PERFORM
 22041     IF D1 > max-pdef
 22042        DISPLAY ' COULD NOT FIND REFUND FACTORS '
 22043           CR-ACCOUNT ' ' CR-CERT-NO ' ' CR-AHTYP
 22044        GO TO 4910-EXIT
 22045     END-IF
 22046
 22047     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 22048        (P1 > +8)
 22049        OR (DD-PROD-CODE (D1 P1) = 'I')
 22050     END-PERFORM
 22051     IF P1 < +9
 22052        display ' setting iu present to true '
 22053        SET DD-IU-PRESENT        TO TRUE
 22054     END-IF
 22055
 22056     MOVE CR-AH-TERM             TO WS-DDF-TERM
 22057     IF (CR-LOAN-TERM > WS-DDF-TERM)
 22058        AND (DD-TRUNCATED (D1) = 'Y')
 22059        MOVE CR-LOAN-TERM        TO WS-DDF-TERM
 22060        DISPLAY ' FOUND TRUNCATED ' CR-CERT-NO
 22061     END-IF
 22062
 22063     EVALUATE TRUE
 22064        WHEN WS-DDF-TERM > +168
 22065           MOVE 15               TO P1
 22066        WHEN WS-DDF-TERM > +156
 22067           MOVE 14               TO P1
 22068        WHEN WS-DDF-TERM > +144
 22069           MOVE 13               TO P1
 22070        WHEN WS-DDF-TERM > +132
 22071           MOVE 12               TO P1
 22072        WHEN WS-DDF-TERM > +120
 22073           MOVE 11               TO P1
 22074        WHEN WS-DDF-TERM > +108
 22075           MOVE 10               TO P1
 22076        WHEN WS-DDF-TERM > +96
 22077           MOVE 9                TO P1
 22078        WHEN WS-DDF-TERM > +84
 22079           MOVE 8                TO P1
 22080        WHEN WS-DDF-TERM > +72
 22081           MOVE 7                TO P1
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 427
* ECS010.cbl
 22082        WHEN WS-DDF-TERM > +60
 22083           MOVE 6                TO P1
 22084        WHEN WS-DDF-TERM > +48
 22085           MOVE 5                TO P1
 22086        WHEN WS-DDF-TERM > +36
 22087           MOVE 4                TO P1
 22088        WHEN WS-DDF-TERM > +24
 22089           MOVE 3                TO P1
 22090        WHEN WS-DDF-TERM > +12
 22091           MOVE 2                TO P1
 22092        WHEN OTHER
 22093           MOVE 1                TO P1
 22094     END-EVALUATE
 22095
 22096     EVALUATE TRUE
 22097*       WHEN ((CR-AH-TERM - REM-TRM1) < +13)
 22098*          AND (DD-IU-PRESENT)
 22099*          MOVE 2                TO P2
 22100*       WHEN (CR-AH-TERM - REM-TRM1) < +13
 22101*          MOVE 1                TO P2
 22102        WHEN (CR-AH-TERM - REM-TRM1) < +25
 22103           MOVE 2                TO P2
 22104        WHEN (CR-AH-TERM - REM-TRM1) < +37
 22105           MOVE 3                TO P2
 22106        WHEN (CR-AH-TERM - REM-TRM1) < +49
 22107           MOVE 4                TO P2
 22108        WHEN (CR-AH-TERM - REM-TRM1) < +61
 22109           MOVE 5                TO P2
 22110        WHEN (CR-AH-TERM - REM-TRM1) < +73
 22111           MOVE 6                TO P2
 22112        WHEN (CR-AH-TERM - REM-TRM1) < +85
 22113           MOVE 7                TO P2
 22114        WHEN (CR-AH-TERM - REM-TRM1) < +97
 22115           MOVE 8                TO P2
 22116        WHEN (CR-AH-TERM - REM-TRM1) < +109
 22117           MOVE 9                TO P2
 22118        WHEN (CR-AH-TERM - REM-TRM1) < +121
 22119           MOVE 10               TO P2
 22120        WHEN (CR-AH-TERM - REM-TRM1) < +133
 22121           MOVE 11               TO P2
 22122        WHEN (CR-AH-TERM - REM-TRM1) < +145
 22123           MOVE 12               TO P2
 22124        WHEN (CR-AH-TERM - REM-TRM1) < +157
 22125           MOVE 13               TO P2
 22126        WHEN (CR-AH-TERM - REM-TRM1) < +169
 22127           MOVE 14               TO P2
 22128        WHEN OTHER
 22129           DISPLAY ' COULD BE TROUBLE ' CR-CERT-NO
 22130           MOVE 15               TO P2
 22131     END-EVALUATE
 22132
 22133     MOVE CR-CERT-NO             TO WS-FACT-CERT
 22134     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
 22135                                 TO WS-LO-UEF
 22136     MOVE DD-UEP-FACTOR (D1 P1 P2)
 22137                                 TO WS-HI-UEF
 22138
 22139     .
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 428
* ECS010.cbl
 22140 4910-EXIT.
 22141     EXIT.
 22142
 22143******************************************************************
 22144***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 22145******************************************************************
 22146
 22147 5000-DATE-RANGE-BREAK.
 22148
 22149     IF NO-TRANSACTION-WAS-PROCESSED
 22150         GO TO 5099-DATE-RANGE-BREAK-X.
 22151
 22152     ADD +1  TO RANGE-CNT.
 22153     MOVE +1 TO SUB6.
 22154     MOVE +2 TO SUB7.
 22155     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22156     IF LN-CNT GREATER +50
 22157         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22158                 8750-PRT-RANGE-HEADING.
 22159
 22160     MOVE SPACES                     TO PRT.
 22161     PERFORM 8800-PRINT-ROUTINE.
 22162     MOVE 'DATE RANGE'               TO TPH2-DESC.
 22163     MOVE '  TOTALS'                 TO TPH3-DESC.
 22164     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22165     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22166     PERFORM 5900-CLEAR-TOTAL-PAGES
 22167         THRU 5999-CLEAR-TOTAL-PAGES-X
 22168             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22169
 22170 5099-DATE-RANGE-BREAK-X.
 22171     EXIT.
 22172
 22173 5100-ACCOUNT-BREAK.
 22174
 22175     IF RANGE-CNT NOT = +0
 22176         PERFORM 5000-DATE-RANGE-BREAK
 22177             THRU 5099-DATE-RANGE-BREAK-X
 22178     ELSE
 22179         MOVE +1 TO SUB6
 22180         MOVE +2 TO SUB7
 22181         PERFORM 5800-ADD-PAGES-LEVELS
 22182             THRU 5899-ADD-PAGES-LEVELS-X
 22183         PERFORM 5900-CLEAR-TOTAL-PAGES
 22184             THRU 5999-CLEAR-TOTAL-PAGES-X
 22185                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22186
 22187     MOVE +0 TO RANGE-CNT.
 22188     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 22189         VARYING B-SUB FROM 1 BY 1
 22190             UNTIL B-SUB GREATER THAN 50  OR
 22191                   RB-COMPANY (B-SUB) = SPACES.
 22192     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 22193         VARYING B-SUB FROM 1 BY 1
 22194             UNTIL B-SUB GREATER THAN 50.
 22195
 22196     IF ACCT-FLG = SPACE
 22197         GO TO 5199-ACCOUNT-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 429
* ECS010.cbl
 22198
 22199     MOVE SPACE TO ACCT-FLG.
 22200     MOVE +2 TO SUB6.
 22201     MOVE +3 TO SUB7.
 22202     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22203     IF LN-CNT GREATER +50
 22204         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22205                 8725-PRT-ACCT-HEADING.
 22206
 22207     MOVE SPACES                     TO PRT.
 22208     PERFORM 8800-PRINT-ROUTINE.
 22209     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 22210     MOVE ' TOTALS'                  TO TPH3-DESC.
 22211     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22212     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22213     PERFORM 5900-CLEAR-TOTAL-PAGES
 22214         THRU 5999-CLEAR-TOTAL-PAGES-X
 22215             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 22216
 22217 5199-ACCOUNT-BREAK-X.
 22218     EXIT.
 22219
 22220 5200-STATE-BREAK.
 22221
 22222     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 22223     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22224     MOVE +3 TO SUB6.
 22225     MOVE +4 TO SUB7.
 22226     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22227
 22228     IF STATE-FLG = SPACE
 22229         GO TO 5299-STATE-BREAK-X.
 22230
 22231     MOVE SPACE         TO STATE-FLG.
 22232     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22233     MOVE 'STATE'       TO TPH1-TYPE.
 22234     MOVE HLD-STATE     TO STATE-L.
 22235
 22236     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 22237
 22238     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 22239         MOVE SPACES          TO TPH1-DESC
 22240         MOVE HLD-STATE       TO TPH1-ST-CODE
 22241         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 22242     ELSE
 22243         MOVE SPACES TO TPH1-DESC
 22244         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 22245         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 22246
 22247     MOVE 'STATE'  TO TPH2-DESC.
 22248     MOVE 'TOTALS' TO TPH3-DESC.
 22249     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22250     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22251     PERFORM 5900-CLEAR-TOTAL-PAGES
 22252         THRU 5999-CLEAR-TOTAL-PAGES-X
 22253             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 22254
 22255 5299-STATE-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 430
* ECS010.cbl
 22256     EXIT.
 22257
 22258 5300-COMP-BREAK.
 22259
 22260     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 22261     MOVE +4 TO SUB6.
 22262     MOVE +5 TO SUB7.
 22263     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22264
 22265     IF COMP-FLG = SPACE
 22266         GO TO 5399-COMP-BREAK-X.
 22267
 22268     MOVE ' ' TO COMP-FLG.
 22269     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22270     MOVE 'COMPANY'                   TO TPH1-TYPE.
 22271     MOVE HLD-GROUPING                TO TPH1-DESC.
 22272     MOVE 'COMPANY'                   TO TPH2-DESC.
 22273     MOVE ' TOTALS'                   TO TPH3-DESC.
 22274     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22275     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22276     PERFORM 5900-CLEAR-TOTAL-PAGES
 22277         THRU 5999-CLEAR-TOTAL-PAGES-X
 22278             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 22279
 22280 5399-COMP-BREAK-X.
 22281     EXIT.
 22282
 22283 5400-CARR-BREAK.
 22284
 22285     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 22286     MOVE +5 TO SUB6.
 22287     MOVE +6 TO SUB7.
 22288     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22289
 22290     IF CARR-FLG = SPACE
 22291         GO TO 5499-CARR-BREAK-X.
 22292
 22293     MOVE ' ' TO CARR-FLG.
 22294     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22295     MOVE 'CARRIER'               TO TPH1-TYPE.
 22296     MOVE HLD-CARRIER             TO TPH1-DESC.
 22297     MOVE 'CARRIER'               TO TPH2-DESC.
 22298     MOVE ' TOTALS'               TO TPH3-DESC.
 22299     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22300     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22301     PERFORM 5900-CLEAR-TOTAL-PAGES
 22302         THRU 5999-CLEAR-TOTAL-PAGES-X
 22303             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 22304
 22305 5499-CARR-BREAK-X.
 22306     EXIT.
 22307
 22308 5500-FINAL-BREAK.
 22309
 22310     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 22311
 22312     IF FINAL-FLG = SPACE
 22313         GO TO 5599-FINAL-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 431
* ECS010.cbl
 22314
 22315     IF DTE-FICH = '1'
 22316         MOVE '2'  TO  DTE-FICH.
 22317     MOVE +6 TO SUB6.
 22318     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22319     MOVE SPACES   TO TPH1-TYPE.
 22320     MOVE SPACES   TO TPH1-DESC.
 22321     MOVE 'FINAL'  TO TPH2-DESC.
 22322     MOVE 'TOTALS' TO TPH3-DESC.
 22323     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22324     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22325
 22326 5599-FINAL-BREAK-X.
 22327     EXIT.
 22328
 22329 5800-ADD-PAGES-LEVELS.
 22330
 22331     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 22332     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 22333     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 22334     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 22335     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 22336     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 22337     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 22338     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 22339
 22340 5899-ADD-PAGES-LEVELS-X.
 22341     EXIT.
 22342
 22343 5900-CLEAR-TOTAL-PAGES.
 22344
 22345     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 22346             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 22347             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 22348             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 22349
 22350 5999-CLEAR-TOTAL-PAGES-X.
 22351     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 432
* ECS010.cbl
 22353******************************************************************
 22354***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 22355******************************************************************
 22356
 22357 6000-TOTAL-PAGE-HEADINGS.
 22358
 22359     MOVE TOTAL-PAGE-HD1 TO PRT.
 22360     PERFORM 8800-PRINT-ROUTINE.
 22361
 22362 6100-ACCT-TOTAL-HEADINGS.
 22363
 22364     MOVE TOTAL-PAGE-HD2 TO PRT.
 22365     MOVE '0' TO P-CTL.
 22366     PERFORM 8800-PRINT-ROUTINE.
 22367     MOVE TOTAL-PAGE-HD3 TO PRT.
 22368     MOVE ' ' TO P-CTL.
 22369     PERFORM 8800-PRINT-ROUTINE.
 22370     PERFORM 8800-PRINT-ROUTINE.
 22371     MOVE +81 TO LN-CNT.
 22372
 22373 6199-PAGE-HEADINGS-X.
 22374     EXIT.
 22375
 22376 6500-PRINT-TOTAL-PAGE.
 22377
 22378     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22379     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 22380     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22381
 22382     IF SUB6 = 6 AND ME-DO-UPDATE
 22383         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 22384
 22385     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22386
 22387     IF SUB6 = 6 AND ME-DO-UPDATE
 22388         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 22389
 22390     COMPUTE TPD-NET-PRM =
 22391         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 22392
 22393     IF SUB6 = 6 AND ME-DO-UPDATE
 22394         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 22395         GIVING ME-010-NET-L.
 22396
 22397     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22398
 22399     IF SUB6 = 6 AND ME-DO-UPDATE
 22400         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 22401
 22402     COMPUTE TPD-PREM-COMP =
 22403         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 22404                            - TPL-ACCT-COM (SUB6).
 22405     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22406
 22407     IF SUB6 = 6 AND ME-DO-UPDATE
 22408         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 22409
 22410     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 433
* ECS010.cbl
 22411         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 22412         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 22413         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22414     END-IF.
 22415
 22416     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22417     PERFORM 8800-PRINT-ROUTINE.
 22418     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22419     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 22420     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22421     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22422
 22423     IF SUB6 = 6 AND ME-DO-UPDATE
 22424         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 22425         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 22426
 22427     COMPUTE TPD-NET-PRM =
 22428         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22429
 22430     IF SUB6 = 6 AND ME-DO-UPDATE
 22431         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 22432         GIVING ME-010-NET-AH.
 22433
 22434     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22435
 22436     IF SUB6 = 6 AND ME-DO-UPDATE
 22437         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 22438
 22439     COMPUTE TPD-PREM-COMP =
 22440         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22441                            - TPA-ACCT-COM (SUB6).
 22442     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22443
 22444     IF SUB6 = 6 AND ME-DO-UPDATE
 22445         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 22446
 22447     IF SUB6 = 6
 22448         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 22449         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 22450         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22451     END-IF.
 22452
 22453     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22454     PERFORM 8800-PRINT-ROUTINE.
 22455
 22456     MOVE 'TOTAL' TO TPD-DESC.
 22457
 22458     COMPUTE TPD-ISS-PRM =
 22459         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 22460
 22461     COMPUTE TPD-CNC-PRM =
 22462         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 22463
 22464     COMPUTE TPD-NET-PRM =
 22465         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22466         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22467
 22468     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 434
* ECS010.cbl
 22469         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 22470
 22471     COMPUTE TPD-PREM-COMP =
 22472         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22473         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22474         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 22475
 22476     COMPUTE TPD-CLAIMS =
 22477         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 22478
 22479     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 22480         NEXT SENTENCE
 22481     ELSE
 22482         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 22483         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 22484         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22485*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 22486*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 22487*        MOVE ZEROS               TO SV-LO-CERT
 22488*                                    SV-HI-CERT.
 22489
 22490     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 22491     MOVE '0'                     TO P-CTL.
 22492     PERFORM 8800-PRINT-ROUTINE.
 22493     PERFORM 8800-PRINT-ROUTINE.
 22494
 22495 6599-TOTAL-PAGE-PRINT-X.
 22496     EXIT.
 22497*
 22498*
 22499*
 22500**START***********************************************************
 22501*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 22502*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 22503******************************************************************
 22504*
 22505 6650-GET-RES-STATE-COMM.
 22506*6650-BROWSE-FORWARD.
 22507
 22508     IF DTE-CLIENT NOT = 'DMD'
 22509         GO TO 6700-COMM-EXIT.
 22510
 22511     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 22512     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 22513     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 22514     MOVE CR-STATE            TO WS-ERRESC-STATE.
 22515     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 22516     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 22517     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 22518     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 22519
 22520     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 22521
 22522*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 22523*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 22524*VALUE OF PB-CERT-EFF-DT
 22525*
 22526     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 435
* ECS010.cbl
 22527
 22528     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 22529
 22530     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22531         GO TO 6700-COMM-EXIT.
 22532
 22533*GET RECORD WHERE POSITIONED
 22534
 22535 6650-READ-ERRESC-NEXT.
 22536     READ ERRESC-IN NEXT RECORD.
 22537
 22538     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22539         GO TO 6700-COMM-EXIT.
 22540
 22541*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 22542
 22543     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 22544        NEXT SENTENCE
 22545     ELSE
 22546         GO TO 6700-COMM-EXIT.
 22547
 22548     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 22549         NEXT SENTENCE
 22550     ELSE
 22551         GO TO 6650-READ-ERRESC-NEXT.
 22552
 22553*  CR-DT  = WS-YYYYMMDD-DT
 22554*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 22555*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 22556
 22557     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 22558         GO TO 6700-COMM-EXIT.
 22559
 22560* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 22561
 22562     MOVE ZEROS               TO WS-SUB WS-SUB1.
 22563
 22564     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 22565
 22566     IF WS-SUB1 IS GREATER THAN ZERO
 22567         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 22568             PERFORM 6680-SET-TABLE-CODE
 22569         ELSE
 22570             PERFORM 6680-SET-COMMISSION.
 22571
 22572     GO TO 6700-COMM-EXIT.
 22573
 22574 6680-SET-TABLE-CODE.
 22575     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 22576        MOVE ZEROS             TO WS-SUB1
 22577     ELSE
 22578* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 22579* TO COMPUTE AH COMMISSION.
 22580        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 22581        MOVE CR-AH-TERM        TO WS-COMM-TERM
 22582        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 22583        MOVE RESC-COMMISSION-TAB (WS-SUB)
 22584                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 436
* ECS010.cbl
 22585        PERFORM 6680-READ-CTBL-TABLE
 22586        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 22587           MOVE ZEROS          TO WS-SUB1.
 22588
 22589 6680-READ-CTBL-TABLE.
 22590*
 22591* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 22592* TO COMPUTE LIFE COMMISSION
 22593
 22594     IF CR-AHTYP = ZERO
 22595        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 22596        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 22597        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 22598
 22599     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 22600
 22601     IF ERCTBL-FILE-STATUS EQUAL '00'
 22602* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 22603        IF CR-AHTYP NOT = ZERO
 22604             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 22605             MOVE CR-AH-TERM        TO WS-COMM-TERM
 22606             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22607             MOVE WK-RATE           TO WS-COMMISSION
 22608                                       PB-I-AH-COMMISSION
 22609        ELSE
 22610* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 22611             MOVE CR-LFAMT    TO COMM-CK-AMT
 22612             MOVE CR-LF-TERM  TO WS-COMM-TERM
 22613             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22614             MOVE WK-RATE     TO WS-COMMISSION
 22615                                 PB-I-LIFE-COMMISSION.
 22616
 22617 6680-SET-COMMISSION.
 22618     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 22619           MOVE ZEROS         TO WS-SUB1
 22620       ELSE
 22621           MOVE RESC-COMMISSION-PER (WS-SUB)
 22622                              TO WS-COMMISSION WK-RATE
 22623           IF CR-AHTYP NOT = ZERO
 22624                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 22625           ELSE
 22626                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 22627
 22628 6680-SEARCH-CATEGORY.
 22629     ADD +1 TO WS-SUB.
 22630
 22631     IF WS-SUB IS GREATER THAN +12
 22632         GO TO 6680-EXIT.
 22633
 22634     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 22635          MOVE WS-SUB         TO WS-SUB1
 22636          GO TO 6680-EXIT.
 22637
 22638     GO TO 6680-SEARCH-CATEGORY.
 22639
 22640 6680-EXIT.
 22641     EXIT.
 22642
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 437
* ECS010.cbl
 22643 6700-COMM-EXIT.
 22644     EXIT.
 22645*
 22646*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22647
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 438
* ECS010.cbl
 22649******************************************************************
 22650***         C L I E N T   B I L L I N G   R O U T I N E        ***
 22651******************************************************************
 22652
 22653 7000-CLIENT-BILLING-ROUTINE.
 22654*
 22655*
 22656* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 22657
 22658     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 22659                BC-G-ISS      BC-G-CNC   BC-G-CLM
 22660                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 22661                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 22662                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 22663                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 22664                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 22665
 22666 7099-BILL-X.
 22667     EXIT.
 22668
 22669
 22670 7500-ADD-UP-REIN-CO.
 22671
 22672     IF RB-COMPANY (B-SUB) NOT = SPACES
 22673         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 22674
 22675 7599-ADD-UP-REIN-X.
 22676     EXIT.
 22677
 22678 7900-CLEAR-BILLING-TABLE.
 22679
 22680     MOVE SPACES TO RB-COMPANY (B-SUB).
 22681     MOVE 0      TO RB-COUNT (B-SUB).
 22682
 22683 7999-CLEAR-BILLING-X.
 22684     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 439
* ECS010.cbl
 22686******************************************************************
 22687***         M I S C E L L A N E O U S   R O U T I N E S        ***
 22688******************************************************************
 22689
 22690 8000-DATE-CONVERT-ROUTINE.
 22691
 22692     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 22693
 22694 8099-DATE-CONVERT-X.
 22695     EXIT.
 22696
 22697 8000R-CONVERT-STOP-DATE.
 22698
 22699     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 22700     MOVE 'L'                     TO DC-OPTION-CODE.
 22701     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22702     MOVE +0                      TO DC-ELAPSED-MONTHS.
 22703     MOVE -1                      TO DC-ELAPSED-DAYS.
 22704     MOVE '6'                     TO DC-OPTION-CODE.
 22705     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22706     MOVE +0                      TO DC-ELAPSED-MONTHS
 22707                                     DC-ELAPSED-DAYS.
 22708     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 22709     MOVE ' '                     TO DC-OPTION-CODE.
 22710     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22711
 22712     IF NO-CONVERSION-ERROR
 22713         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 22714     ELSE
 22715         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 22716                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 22717                 '  STOP DATE: ' RWF-EP-STOP-DATE
 22718         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 22719                                  TO WS-ABEND-MESSAGE
 22720         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 22721         MOVE 4002                TO WS-ABEND-CODE
 22722         GO TO ABEND-PGM.
 22723
 22724 8099R-STOP-DATE-X.
 22725     EXIT.
 22726
 22727
 22728 8100-GET-RATE.
 22729
 22730     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22731
 22732 8199-GET-RATE-X.
 22733     EXIT.
 22734
 22735
 22736 8200-STATE-CODE-LOOKUP.
 22737
 22738     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 22739        CLAS-INDEXS NOT = ZERO
 22740         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 22741             GO TO 8299-STATE-LOOKUP-X.
 22742
 22743     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 440
* ECS010.cbl
 22744
 22745 8250-STATE-LOOKUP-LOOP.
 22746
 22747     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 22748         MOVE 0302 TO WS-ABEND-CODE
 22749         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 22750         DISPLAY '******************************'
 22751         DISPLAY '***** ERROR LOCATION 022 *****'
 22752         DISPLAY '******************************'
 22753         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22754         GO TO ABEND-PGM.
 22755
 22756     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 22757         ADD +1 TO CLAS-INDEXS
 22758         GO TO 8250-STATE-LOOKUP-LOOP.
 22759
 22760 8299-STATE-LOOKUP-X.
 22761     EXIT.
 22762
 22763
 22764 8300-LIFE-TYPE-LOOKUP.
 22765
 22766     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 22767        CLAS-INDEXL NOT = ZERO
 22768         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 22769             GO TO 8399-LIFE-LOOKUP-X.
 22770
 22771     MOVE CLAS-STARTL TO CLAS-INDEXL.
 22772
 22773 8350-LIFE-LOOKUP-LOOP.
 22774
 22775     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 22776         MOVE 0401 TO WS-ABEND-CODE
 22777         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22778         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22779         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22780         DISPLAY '******************************'
 22781         DISPLAY '***** ERROR LOCATION 023 *****'
 22782         DISPLAY '******************************'
 22783         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22784         IF DTE-CLIENT = 'NCL'
 22785                      OR 'CID' OR 'AHL'
 22786             MOVE CLAS-STARTL      TO CLAS-INDEXL
 22787             MOVE '05'             TO CLAS-LOOK
 22788             GO TO 8350-LIFE-LOOKUP-LOOP
 22789         ELSE
 22790             GO TO ABEND-PGM.
 22791
 22792     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 22793         ADD +1 TO CLAS-INDEXL
 22794         GO TO 8350-LIFE-LOOKUP-LOOP.
 22795
 22796     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 22797         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 22798
 22799 8399-LIFE-LOOKUP-X.
 22800     EXIT.
 22801
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 441
* ECS010.cbl
 22802
 22803 8400-A-H-TYPE-LOOKUP.
 22804
 22805     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 22806        CLAS-INDEXA NOT = ZERO
 22807         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 22808             GO TO 8499-A-H-LOOKUP-X.
 22809
 22810     MOVE CLAS-STARTA TO CLAS-INDEXA.
 22811
 22812 8450-A-H-LOOKUP-LOOP.
 22813
 22814     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 22815         MOVE 0402 TO WS-ABEND-CODE
 22816         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22817         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22818         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22819         DISPLAY '******************************'
 22820         DISPLAY '***** ERROR LOCATION 024 *****'
 22821         DISPLAY '******************************'
 22822         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22823         IF DTE-CLIENT = 'NCL'
 22824             MOVE CLAS-STARTA      TO CLAS-INDEXA
 22825             MOVE '05'             TO CLAS-LOOK
 22826             GO TO 8450-A-H-LOOKUP-LOOP
 22827         ELSE
 22828             GO TO ABEND-PGM.
 22829
 22830     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 22831         ADD +1 TO CLAS-INDEXA
 22832         GO TO 8450-A-H-LOOKUP-LOOP.
 22833
 22834 8499-A-H-LOOKUP-X.
 22835     EXIT.
 22836
 22837 8500-REMAINING-TERM-ROUTINE.
 22838
 22839     MOVE ZEROS                      TO CP-REMAINING-TERM
 22840                                        CP-REMAINING-TERM-1
 22841                                        CP-REMAINING-TERM-2
 22842                                        CP-REMAINING-TERM-3
 22843                                        CP-RETURN-CODE
 22844                                        CP-RETURN-CODE-2
 22845                                        REM-TRM1
 22846                                        REM-TRM2
 22847                                        REM-TRM3
 22848                                        TEM-TRM1.
 22849     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 22850
 22851     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 22852     MOVE 'L'                        TO DC-OPTION-CODE.
 22853     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22854
 22855     IF  NO-CONVERSION-ERROR
 22856         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 22857     ELSE
 22858         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 22859                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 442
* ECS010.cbl
 22860         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22861         MOVE 3001                   TO WS-ABEND-CODE
 22862         GO TO ABEND-PGM.
 22863
 22864     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 22865
 22866     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 22867         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22868
 22869     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 22870         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 22871         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 22872                                        DC-ELAPSED-DAYS
 22873         MOVE '3'                    TO DC-OPTION-CODE
 22874         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22875                 8099-DATE-CONVERT-X
 22876         IF  NO-CONVERSION-ERROR
 22877             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 22878         ELSE
 22879             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 22880
 22881     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 22882         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22883
 22884     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 22885         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 22886         MOVE +1                     TO DC-ELAPSED-MONTHS
 22887         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 22888         MOVE '6'                    TO DC-OPTION-CODE
 22889         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22890                 8099-DATE-CONVERT-X
 22891         IF  NO-CONVERSION-ERROR
 22892             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 22893             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 22894         ELSE
 22895             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 22896                                     TO WS-ABEND-MESSAGE
 22897             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 22898             MOVE 3002               TO WS-ABEND-CODE
 22899             GO TO ABEND-PGM.
 22900
 22901     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 22902     MOVE 'L'                        TO DC-OPTION-CODE.
 22903     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22904
 22905     IF  NO-CONVERSION-ERROR
 22906         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 22907     ELSE
 22908         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 22909             W-VAL-ERROR (W-VAL-SOURCE)
 22910         DISPLAY '   KEY - ' CR-FULL-CONTROL
 22911             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 22912             DC-ERROR-CODE
 22913         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 22914         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 22915             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 22916             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 22917             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 443
* ECS010.cbl
 22918*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 22919*                                    TO WS-ABEND-MESSAGE
 22920*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22921*        MOVE 3003                   TO WS-ABEND-CODE
 22922*        GO TO ABEND-PGM.
 22923
 22924     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 22925     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 22926     MOVE '3'                        TO CP-PROCESS-TYPE.
 22927     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 22928     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 22929     MOVE SPACES                     TO CP-ACCT-FLD-5.
 22930
 22931*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 22932*                                    TO CP-REM-TERM-METHOD.
 22933
 22934     IF  DTE-CLIENT = 'FIM'
 22935         MOVE '5'                    TO CP-REM-TERM-METHOD.
 22936
 22937     IF DTE-CLIENT = 'FLI' OR 'FLU'
 22938         IF WE-LF-AH = AH-OVERRIDE-L1
 22939             MOVE '2'                TO CP-REM-TERM-METHOD
 22940         ELSE
 22941             IF CR-LFTYP = '01' OR '03'
 22942                 MOVE '4'            TO CP-REM-TERM-METHOD
 22943             ELSE
 22944                 IF CR-LFTYP = '02' OR '04'
 22945                     MOVE '2'        TO CP-REM-TERM-METHOD.
 22946
 22947     IF  DTE-CLIENT = 'CSL'
 22948         IF  CR-CARRIER = '2'
 22949             IF  CR-LFTYP = '07' OR  '08'
 22950                 MOVE '4'            TO CP-REM-TERM-METHOD.
 22951
 22952     IF  DTE-CLIENT = 'POS'
 22953         IF  CR-CARRIER = '1'
 22954             MOVE '1'                TO CP-REM-TERM-METHOD
 22955         ELSE
 22956             MOVE '2'                TO CP-REM-TERM-METHOD.
 22957
 22958     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 22959         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 22960
 22961     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 22962         GO TO 8540-CALC-REM-TERM-AH.
 22963
 22964 8520-CALC-REM-TERM-LIFE.
 22965
 22966     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 22967     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 22968     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 22969*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 22970     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 22971                                        CP-LOAN-TERM.
 22972
 22973     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22974             AND
 22975         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 444
* ECS010.cbl
 22976         ADD +1                      TO CP-ORIGINAL-TERM
 22977                                        CP-LOAN-TERM.
 22978
 22979     IF  CP-TERM-IS-DAYS
 22980         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 22981     ELSE
 22982         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 22983
 22984     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 22985
 22986     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 22987         ADD +1                      TO W-ORGTRM-0-LF
 22988         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 22989             CR-FULL-CONTROL
 22990         GO TO 8599-REM-TERM-X.
 22991
 22992     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 22993
 22994     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 22995         ADD +1                      TO W-RET-CODE-LF
 22996         GO TO 8599-REM-TERM-X.
 22997*
 22998*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 22999*                                    TO WS-ABEND-MESSAGE
 23000*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 23001*        MOVE 2002                   TO WS-ABEND-CODE
 23002*        GO TO ABEND-PGM.
 23003
 23004     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 23005             AND
 23006         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 23007         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 23008         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 23009         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 23010
 23011     IF  CP-REMAINING-TERM-1 NEGATIVE
 23012         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 23013
 23014     IF  CP-REMAINING-TERM-2 NEGATIVE
 23015         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 23016
 23017     IF DTE-CLIENT = 'NCL'
 23018         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 23019                                        CP-REMAINING-TERM-3.
 23020
 23021     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 23022     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 23023     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 23024     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 23025
 23026     GO TO 8599-REM-TERM-X.
 23027
 23028 8520-EXIT.
 23029     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 445
* ECS010.cbl
 23031 8540-CALC-REM-TERM-AH.
 23032
 23033     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 23034     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 23035     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 23036     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 23037                                        CP-LOAN-TERM.
 23038     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 23039
 23040     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 23041
 23042     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 23043         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 23044             CR-FULL-CONTROL
 23045         ADD +1                      TO W-ORGTRM-0-AH
 23046         GO TO 8599-REM-TERM-X.
 23047
 23048     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 23049
 23050     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 23051         ADD +1                      TO W-RET-CODE-AH
 23052         GO TO 8599-REM-TERM-X.
 23053*
 23054*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 23055*                                    TO WS-ABEND-MESSAGE
 23056*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 23057*        MOVE 2001                   TO WS-ABEND-CODE
 23058*        GO TO ABEND-PGM.
 23059
 23060     IF DTE-CLIENT = 'NCL'
 23061         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 23062                                        CP-REMAINING-TERM-3.
 23063
 23064     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 23065     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 23066     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 23067     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 23068
 23069 8599-REM-TERM-X.
 23070     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 446
* ECS010.cbl
 23072
 23073******************************************************************
 23074***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 23075******************************************************************
 23076
 23077 8600-DISPLAY-PRT.
 23078
 23079     IF  DIS-LINE-CNT GREATER THAN 59
 23080         PERFORM 8600-DISPLAY-HD THRU
 23081             8600-HD-EXIT.
 23082
 23083     ADD  1  TO DIS-LINE-CNT.
 23084     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 23085     MOVE  SPACES TO DISPLAY-REC
 23086                     DISPLAY-LINE.
 23087
 23088 8600-DISPLAY-EXIT.
 23089     EXIT.
 23090
 23091
 23092 8600-DISPLAY-HD.
 23093
 23094     MOVE '1'  TO  DISPLAY-CC.
 23095     MOVE ZEROS TO DIS-LINE-CNT.
 23096     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 23097     ADD +1 TO DIS-LINE-CNT.
 23098     MOVE ' '  TO  DISPLAY-CC.
 23099     MOVE SPACES TO DISPLAY-REC.
 23100     WRITE DISPLAY-REC.
 23101     ADD +1 TO DIS-LINE-CNT.
 23102     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 23103     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 23104     ADD +1 TO DIS-LINE-CNT.
 23105     MOVE SPACES TO DISPLAY-REC.
 23106     ADD +1 TO DIS-LINE-CNT.
 23107     WRITE DISPLAY-REC.
 23108
 23109 8600-HD-EXIT.
 23110     EXIT.
 23111
 23112******************************************************************
 23113***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 23114******************************************************************
 23115
 23116 8600-SETUP-DETAIL-LINE.
 23117
 23118     MOVE SPACES                TO TR-DTL2.
 23119
 23120     MOVE CR-CERT-NO            TO TRD-CERT.
 23121     MOVE CR-YR                 TO TRD-ISYR.
 23122     MOVE CR-MO                 TO TRD-ISMO.
 23123     MOVE CR-DA                 TO TRD-ISDA.
 23124     MOVE CR-AGE                TO TRD-AGE.
 23125
 23126 8689-SETUP-DETAIL-X.
 23127     EXIT.
 23128
 23129 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 447
* ECS010.cbl
 23130
 23131     IF LN-CNT GREATER THAN LN-MX
 23132         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 23133                 8799-PRT-HEADINGS-X.
 23134     MOVE TRD-CERT TO SV-TRD-CERT.
 23135     MOVE TRD-ISDT TO SV-TRD-ISDT.
 23136
 23137     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 23138         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 23139
 23140     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 23141     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 23142     MOVE TR-DTL TO PRT.
 23143
 23144     IF NOT WS-CHANGE-REC
 23145         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 23146     ELSE
 23147         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 23148
 23149     PERFORM 8800-PRINT-ROUTINE.
 23150
 23151 8699-PRT-DETAIL-X.
 23152     EXIT.
 23153
 23154 8700-PRINT-REPORT-HEADINGS.
 23155     ADD +1 TO PG-CNT.
 23156     MOVE PG-CNT TO TR-PG.
 23157     MOVE +0 TO LN-CNT.
 23158     MOVE TR-HD-1 TO PRT.
 23159     PERFORM 8800-PRINT-ROUTINE.
 23160     MOVE TR-HD-2 TO PRT.
 23161     PERFORM 8800-PRINT-ROUTINE.
 23162     MOVE TR-HD-3 TO PRT.
 23163     PERFORM 8800-PRINT-ROUTINE.
 23164     ADD +1 TO LN-CNT.
 23165
 23166 8725-PRT-ACCT-HEADING.
 23167     MOVE TR-HD-4 TO PRT.
 23168     PERFORM 8800-PRINT-ROUTINE.
 23169     MOVE TR-HD-5 TO PRT.
 23170     PERFORM 8800-PRINT-ROUTINE.
 23171
 23172 8750-PRT-RANGE-HEADING.
 23173     MOVE TR-HD-6 TO PRT.
 23174     PERFORM 8800-PRINT-ROUTINE.
 23175
 23176 8775-PRT-COLUMN-HEADINGS.
 23177     MOVE TR-HD-7 TO PRT.
 23178     PERFORM 8800-PRINT-ROUTINE.
 23179     MOVE TR-HD-8 TO PRT.
 23180     PERFORM 8800-PRINT-ROUTINE.
 23181     MOVE TR-HD-9 TO PRT.
 23182     PERFORM 8800-PRINT-ROUTINE.
 23183     PERFORM 8800-PRINT-ROUTINE.
 23184
 23185 8799-PRT-HEADINGS-X.
 23186     EXIT.
 23187
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 448
* ECS010.cbl
 23188 8800-PRINT-ROUTINE.
 23189     MOVE P-CTL TO X.
 23190     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 23191     ADD +1 TO LN-CNT.
 23192     MOVE SPACES TO PRT.
 23193
 23194 8900-PRINT-A-LINE.
*23195                             COPY ELCPRT2.
 23196******************************************************************04/15/98
 23197*                                                                *ELCPRT2
 23198*                                                                *ELCPRT2
 23199*                            ELCPRT2                             *   LV005
 23200*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 23201*                            VMOD=2.002                          *   CL**5
 23202*                                                                *   CL**4
 23203******************************************************************   CL**4
 23204                                                                     CL**4
 23205     IF DTE-FICH NOT = SPACE AND                                     CL**4
 23206        FICH-OPEN    = SPACE                                         CL**4
 23207         MOVE 'X'                TO  FICH-OPEN                       CL**4
 23208         OPEN OUTPUT FICH.                                           CL**4
 23209                                                                     CL**4
 23210     IF DTE-FICH NOT = SPACE                                         CL**4
 23211         MOVE X                  TO  P-CTL                           CL**4
 23212         WRITE FICH-REC FROM PRT.                                    CL**4
 23213                                                                     CL**4
 23214     IF DTE-FICH = SPACE OR '2'                                      CL**4
 23215       MOVE X                    TO  P-CTL                           CL**4
 23216       IF P-CTL = ' '                                                CL**4
 23217         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 23218       ELSE                                                          CL**4
 23219         IF P-CTL = '0'                                              CL**4
 23220           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 23221         ELSE                                                        CL**4
 23222           IF P-CTL = '-'                                            CL**4
 23223             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 23224           ELSE                                                      CL**4
 23225             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 23226                                                                     CL**4
 23227******************************************************************   CL**4
 23228
 23229 8999-PRT-LINE-X.
 23230     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 449
* ECS010.cbl
 23232******************************************************************
 23233***          E N D   O F   J O B   P R O C E S S I N G         ***
 23234******************************************************************
 23235
 23236 9910-EOJ-1.
 23237     IF TR-CNT = ZERO
 23238         IF (DTE-PGM-OPT = '2' OR '3') OR
 23239            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 23240                          'ITY' OR 'DAC' OR 'FLC')
 23241             NEXT SENTENCE
 23242         ELSE
 23243             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 23244             MOVE 0703                    TO WS-ABEND-CODE
 23245             DISPLAY '******************************'
 23246             DISPLAY '***** ERROR LOCATION 025 *****'
 23247             DISPLAY '******************************'
 23248             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 23249             GO TO ABEND-PGM.
 23250
 23251     MOVE '*'         TO TRANS-EOF-FLAG.
 23252     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 23253
 23254     IF EOF-ON-CERT
 23255         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23256         GO TO 9940-EOJ-FIN.
 23257
 23258     GO TO 0330-MATCH-PENDING-TO-CERT.
 23259
 23260 9920-EOJ-2.
 23261     MOVE '*'         TO CERT-EOF-FLAG.
 23262     MOVE HIGH-VALUES TO CIR-CONTROL.
 23263
 23264     IF EOF-ON-TRANS
 23265         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23266         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 23267         GO TO 9940-EOJ-FIN.
 23268
 23269     GO TO 0299-READ-CERT-X.
 23270
 23271 9930-EOJ-3.
 23272     IF PROCESSING-COMPLETED
 23273         GO TO 9950-EOJ-FIN-GO.
 23274
 23275     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 23276     MOVE 'MISSING ACCOUNT MASTER'
 23277                               TO WS-ABEND-MESSAGE.
 23278     MOVE 0302                 TO WS-ABEND-CODE.
 23279     DISPLAY '******************************'
 23280     DISPLAY '***** ERROR LOCATION 026 *****'
 23281     DISPLAY '******************************'
 23282     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 23283     GO TO ABEND-PGM.
 23284
 23285 9940-EOJ-FIN.
 23286     MOVE '*'        TO PROCESSING-FLAG.
 23287     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 23288
 23289     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 450
* ECS010.cbl
 23290             0199-READ-ACCOUNT-X.
 23291     GO TO 9940-EOJ-FIN.
 23292
 23293 9950-EOJ-FIN-GO.
 23294     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 23295     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 23296*
 23297*
 23298* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 23299     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 23300
 23301 9960-NO-TOTS.
 23302
 23303     MOVE +15                    TO LN-CNT.
 23304     MOVE CMIN-CNT               TO TTL-PT-CNT.
 23305     IF ME-DO-UPDATE
 23306         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 23307
 23308     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 23309     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 23310     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 23311
 23312
 23313     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23314     MOVE TR-TTL-HD              TO PRT.
 23315     PERFORM 8800-PRINT-ROUTINE.
 23316     ADD +1 TO LN-CNT.
 23317     MOVE TR-CNT                TO TTL-PT-CNT.
 23318     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 23319     MOVE TR-TTL-HD             TO PRT.
 23320     PERFORM 8800-PRINT-ROUTINE.
 23321     ADD +1 TO LN-CNT.
 23322
 23323     IF DUP-CNT = ZERO
 23324         GO TO 9969-CHECK-MISMATCHED-TOTS.
 23325
 23326     MOVE DUP-CNT                 TO TTL-PT-CNT.
 23327
 23328     IF ME-DO-UPDATE
 23329         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 23330
 23331     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 23332     MOVE TR-TTL-HD               TO PRT.
 23333     PERFORM 8800-PRINT-ROUTINE.
 23334     PERFORM 8800-PRINT-ROUTINE.
 23335     ADD +1 TO LN-CNT.
 23336
 23337     MOVE '1'                           TO  DTL-REC-TYPE.
 23338     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 23339     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 23340     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 23341                                        TO  DTL-CERT-OUT-CONTROL.
 23342     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 23343     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 23344     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 23345
 23346     MOVE +1 TO SUB3.
 23347 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 451
* ECS010.cbl
 23348
 23349     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 23350         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 23351         MOVE MISMATCH-PAGE-NUMBER
 23352                                 TO  TR-PG
 23353         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 23354         MOVE MR-CTL             TO  X
 23355         MOVE X TO LCP-ASA
 23356         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23357             THRU LCP-WRITE-END-MISMATCH-RPT
 23358         MOVE TR-HD-2            TO  MISMATCH-RPT
 23359         MOVE MR-CTL             TO  X
 23360         MOVE X TO LCP-ASA
 23361         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23362             THRU LCP-WRITE-END-MISMATCH-RPT
 23363         MOVE TR-HD-3            TO  MISMATCH-RPT
 23364         MOVE MR-CTL             TO  X
 23365         MOVE X TO LCP-ASA
 23366         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23367             THRU LCP-WRITE-END-MISMATCH-RPT
 23368         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 23369         MOVE MR-CTL             TO  X
 23370         MOVE X TO LCP-ASA
 23371         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23372             THRU LCP-WRITE-END-MISMATCH-RPT
 23373         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 23374
 23375     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 23376
 23377     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 23378     MOVE MR-CTL                        TO  X.
 23379     ADD +2                             TO  MISMATCH-LINE-COUNT.
 23380
 23381     MOVE X TO LCP-ASA
 23382     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23383         THRU LCP-WRITE-END-MISMATCH-RPT.
 23384
 23385     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 23386     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 23387
 23388     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 23389     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 23390
 23391     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 23392     IF  DUPE-STATUS (SUB3)  =  '2'
 23393         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 23394     IF  DUPE-STATUS (SUB3)  =  '5'
 23395         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 23396     IF  DUPE-STATUS (SUB3)  =  'M'
 23397         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 23398     IF  DUPE-STATUS (SUB3)  =  '9'
 23399         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 23400     IF  DUPE-STATUS (SUB3)  =  'D'
 23401         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 23402     IF  DUPE-STATUS (SUB3)  =  'V'
 23403         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 23404     IF  DUPE-STATUS (SUB3)  =  'P'
 23405         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 452
* ECS010.cbl
 23406
 23407     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23408     MOVE MR-CTL                        TO  X.
 23409     ADD +1                             TO  MISMATCH-LINE-COUNT.
 23410
 23411     MOVE X TO LCP-ASA
 23412     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23413         THRU LCP-WRITE-END-MISMATCH-RPT.
 23414
 23415     IF SUB3 LESS THAN DUP-CNT
 23416         ADD +1 TO SUB3
 23417         GO TO 9965-PRT-DUPES.
 23418
 23419 9969-CHECK-MISMATCHED-TOTS.
 23420
 23421     IF W-MM-LF-PRM = ZEROS  AND
 23422        W-MM-AH-PRM = ZEROS  AND
 23423        W-MM-LF-RFD = ZEROS  AND
 23424        W-MM-AH-RFD = ZEROS  AND
 23425        W-MM-LF-CLM = ZEROS  AND
 23426        W-MM-AH-CLM = ZEROS
 23427         GO TO 9970-FIN-TOTS.
 23428
 23429     MOVE SPACES                        TO  MISMATCH-RPT.
 23430     MOVE '0'                           TO  MR-CTL  X.
 23431     MOVE X TO LCP-ASA
 23432     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23433         THRU LCP-WRITE-END-MISMATCH-RPT.
 23434
 23435     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 23436     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23437     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 23438
 23439     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 23440     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 23441     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 23442
 23443     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23444     MOVE '0'                           TO  MR-CTL  X.
 23445     MOVE X TO LCP-ASA
 23446     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23447         THRU LCP-WRITE-END-MISMATCH-RPT.
 23448
 23449     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 23450     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23451     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 23452
 23453     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 23454     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 23455     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 23456
 23457     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23458     MOVE '0'                           TO  MR-CTL  X.
 23459     MOVE X TO LCP-ASA
 23460     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23461         THRU LCP-WRITE-END-MISMATCH-RPT.
 23462
 23463     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 453
* ECS010.cbl
 23464     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 23465     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 23466
 23467     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 23468     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 23469     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 23470
 23471     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23472     MOVE '0'                           TO  MR-CTL  X.
 23473     MOVE X TO LCP-ASA
 23474     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23475         THRU LCP-WRITE-END-MISMATCH-RPT.
 23476
 23477 9970-FIN-TOTS.
 23478
 23479     MOVE CMOT-CNT                TO TTL-PT-CNT.
 23480
 23481     IF ME-DO-UPDATE
 23482         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 23483
 23484     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23485     MOVE TR-TTL-HD               TO PRT.
 23486     PERFORM 8800-PRINT-ROUTINE.
 23487
 23488     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 23489     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 23490     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 23491     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 23492
 23493     MOVE DE-CNT                  TO TTL-PT-CNT.
 23494     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 23495     MOVE TR-TTL-HD               TO PRT.
 23496     PERFORM 8800-PRINT-ROUTINE.
 23497
 23498     MOVE EP-CNT                  TO TTL-PT-CNT.
 23499     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 23500     MOVE TR-TTL-HD               TO PRT.
 23501     PERFORM 8800-PRINT-ROUTINE.
 23502     PERFORM 8800-PRINT-ROUTINE.
 23503
 23504     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 23505     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 23506     MOVE TR-TTL-HD               TO PRT.
 23507     PERFORM 8800-PRINT-ROUTINE.
 23508
 23509     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 23510     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 23511     MOVE TR-TTL-HD               TO PRT.
 23512     PERFORM 8800-PRINT-ROUTINE.
 23513
 23514     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 23515     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 23516     MOVE TR-TTL-HD               TO PRT.
 23517     PERFORM 8800-PRINT-ROUTINE.
 23518
 23519     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 23520         GO TO 9990-FINAL-CLOSE.
 23521
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 454
* ECS010.cbl
 23522**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 23523**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 23524**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 23525**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 23526
 23527     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 23528     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 23529     MOVE TR-TTL-HD               TO PRT.
 23530     PERFORM 8800-PRINT-ROUTINE.
 23531
 23532     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 23533     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 23534     MOVE TR-TTL-HD               TO PRT.
 23535     PERFORM 8800-PRINT-ROUTINE.
 23536
 23537     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 23538     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 23539     MOVE TR-TTL-HD               TO PRT.
 23540     PERFORM 8800-PRINT-ROUTINE.
 23541
 23542     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 23543     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 23544     MOVE TR-TTL-HD               TO PRT.
 23545     PERFORM 8800-PRINT-ROUTINE.
 23546
 23547     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 23548     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 23549     MOVE TR-TTL-HD               TO PRT.
 23550     PERFORM 8800-PRINT-ROUTINE.
 23551
 23552     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 23553     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23554     MOVE TR-TTL-HD               TO PRT.
 23555     PERFORM 8800-PRINT-ROUTINE.
 23556
 23557     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 23558     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23559     MOVE TR-TTL-HD               TO PRT.
 23560     PERFORM 8800-PRINT-ROUTINE.
 23561
 23562     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 23563     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 23564     MOVE TR-TTL-HD               TO PRT.
 23565     PERFORM 8800-PRINT-ROUTINE.
 23566
 23567     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 23568     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23569     MOVE TR-TTL-HD               TO PRT.
 23570     PERFORM 8800-PRINT-ROUTINE.
 23571
 23572     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 23573     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23574     MOVE TR-TTL-HD               TO PRT.
 23575     PERFORM 8800-PRINT-ROUTINE.
 23576
 23577     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 23578     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23579     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 455
* ECS010.cbl
 23580     PERFORM 8800-PRINT-ROUTINE.
 23581
 23582     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 23583     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23584     MOVE TR-TTL-HD               TO PRT.
 23585     PERFORM 8800-PRINT-ROUTINE.
 23586
 23587     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 23588     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 23589     MOVE TR-TTL-HD               TO PRT.
 23590     PERFORM 8800-PRINT-ROUTINE.
 23591
 23592     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 23593     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 23594     MOVE TR-TTL-HD               TO PRT.
 23595     PERFORM 8800-PRINT-ROUTINE.
 23596
 23597     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 23598     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 23599     MOVE TR-TTL-HD               TO PRT.
 23600     PERFORM 8800-PRINT-ROUTINE.
 23601
 23602     MOVE W-AH-REIN               TO TTL-PT-CNT.
 23603     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 23604     MOVE TR-TTL-HD               TO PRT.
 23605     PERFORM 8800-PRINT-ROUTINE.
 23606
 23607     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 23608     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 23609     MOVE TR-TTL-HD               TO PRT.
 23610     PERFORM 8800-PRINT-ROUTINE.
 23611
 23612     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 23613     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 23614     MOVE TR-TTL-HD               TO PRT.
 23615     PERFORM 8800-PRINT-ROUTINE.
 23616
 23617     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 23618     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23619     MOVE TR-TTL-HD               TO PRT.
 23620     PERFORM 8800-PRINT-ROUTINE.
 23621
 23622     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 23623     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 23624     MOVE TR-TTL-HD               TO PRT.
 23625     PERFORM 8800-PRINT-ROUTINE.
 23626
 23627     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 23628     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 23629     MOVE TR-TTL-HD               TO PRT.
 23630     PERFORM 8800-PRINT-ROUTINE.
 23631
 23632     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 23633     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23634     MOVE TR-TTL-HD               TO PRT.
 23635     PERFORM 8800-PRINT-ROUTINE.
 23636
 23637     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 456
* ECS010.cbl
 23638     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 23639     MOVE TR-TTL-HD               TO PRT.
 23640     PERFORM 8800-PRINT-ROUTINE.
 23641
 23642     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 23643     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 23644     MOVE TR-TTL-HD               TO PRT.
 23645     PERFORM 8800-PRINT-ROUTINE.
 23646
 23647     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 23648     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 23649     MOVE TR-TTL-HD               TO PRT.
 23650     PERFORM 8800-PRINT-ROUTINE.
 23651
 23652     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 23653     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 23654     MOVE TR-TTL-HD               TO PRT.
 23655     PERFORM 8800-PRINT-ROUTINE.
 23656
 23657     MOVE W-LF-REIN               TO TTL-PT-CNT.
 23658     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 23659     MOVE TR-TTL-HD               TO PRT.
 23660     PERFORM 8800-PRINT-ROUTINE.
 23661
 23662     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 23663     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 23664     MOVE TR-TTL-HD               TO PRT.
 23665     PERFORM 8800-PRINT-ROUTINE.
 23666
 23667     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 23668     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23669     MOVE TR-TTL-HD               TO PRT.
 23670     PERFORM 8800-PRINT-ROUTINE.
 23671
 23672     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 23673     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 23674     MOVE TR-TTL-HD               TO PRT.
 23675     PERFORM 8800-PRINT-ROUTINE.
 23676
 23677     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 23678     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 23679     MOVE TR-TTL-HD               TO PRT.
 23680     PERFORM 8800-PRINT-ROUTINE.
 23681
 23682     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 23683     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 23684     MOVE TR-TTL-HD               TO PRT.
 23685     PERFORM 8800-PRINT-ROUTINE.
 23686
 23687     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 23688     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 23689     MOVE TR-TTL-HD               TO PRT.
 23690     PERFORM 8800-PRINT-ROUTINE.
 23691
 23692     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 23693     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23694     MOVE TR-TTL-HD               TO PRT.
 23695     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 457
* ECS010.cbl
 23696
 23697     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 23698     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 23699     MOVE TR-TTL-HD               TO PRT.
 23700     PERFORM 8800-PRINT-ROUTINE.
 23701
 23702     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 23703     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 23704     MOVE TR-TTL-HD               TO PRT.
 23705     PERFORM 8800-PRINT-ROUTINE.
 23706
 23707     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 23708     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 23709     MOVE TR-TTL-HD               TO PRT.
 23710     PERFORM 8800-PRINT-ROUTINE.
 23711
 23712     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 23713     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 23714     MOVE TR-TTL-HD               TO PRT.
 23715     PERFORM 8800-PRINT-ROUTINE.
 23716
 23717     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 23718     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 23719     MOVE TR-TTL-HD               TO PRT.
 23720     PERFORM 8800-PRINT-ROUTINE.
 23721
 23722     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 23723     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 23724                                  TO TTL-HD-DS.
 23725     MOVE TR-TTL-HD               TO PRT.
 23726     PERFORM 8800-PRINT-ROUTINE.
 23727
 23728     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 23729     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 23730                                  TO TTL-HD-DS.
 23731     MOVE TR-TTL-HD               TO PRT.
 23732     PERFORM 8800-PRINT-ROUTINE.
 23733
 23734     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 23735     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 23736                                  TO TTL-HD-DS.
 23737     MOVE TR-TTL-HD               TO PRT.
 23738     PERFORM 8800-PRINT-ROUTINE.
 23739
 23740     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 23741     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 23742                                  TO TTL-HD-DS.
 23743     MOVE TR-TTL-HD               TO PRT.
 23744     PERFORM 8800-PRINT-ROUTINE.
 23745
 23746     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 23747     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 23748                                  TO TTL-HD-DS.
 23749     MOVE TR-TTL-HD               TO PRT.
 23750     PERFORM 8800-PRINT-ROUTINE.
 23751
 23752     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 23753     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 458
* ECS010.cbl
 23754                                  TO TTL-HD-DS.
 23755     MOVE TR-TTL-HD               TO PRT.
 23756     PERFORM 8800-PRINT-ROUTINE.
 23757
 23758     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23759     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 23760     MOVE TR-TTL-HD               TO PRT.
 23761     PERFORM 8800-PRINT-ROUTINE.
 23762
 23763     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23764     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 23765     MOVE TR-TTL-HD               TO PRT.
 23766     PERFORM 8800-PRINT-ROUTINE.
 23767
 23768     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 23769     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 23770     MOVE TR-TTL-HD               TO PRT.
 23771     PERFORM 8800-PRINT-ROUTINE.
 23772
 23773     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 23774     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 23775     MOVE TR-TTL-HD               TO PRT.
 23776     PERFORM 8800-PRINT-ROUTINE.
 23777
 23778     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 23779     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 23780     MOVE TR-TTL-HD               TO PRT.
 23781     PERFORM 8800-PRINT-ROUTINE.
 23782
 23783     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 23784     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 23785     MOVE TR-TTL-HD               TO PRT.
 23786     PERFORM 8800-PRINT-ROUTINE.
 23787
 23788     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 23789     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 23790     MOVE TR-TTL-HD               TO PRT.
 23791     PERFORM 8800-PRINT-ROUTINE.
 23792
 23793     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 23794     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 23795     MOVE TR-TTL-HD               TO PRT.
 23796     PERFORM 8800-PRINT-ROUTINE.
 23797
 23798     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 23799     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 23800     MOVE TR-TTL-HD               TO PRT.
 23801     PERFORM 8800-PRINT-ROUTINE.
 23802
 23803     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 23804     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 23805     MOVE TR-TTL-HD               TO PRT.
 23806     PERFORM 8800-PRINT-ROUTINE.
 23807
 23808     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 23809     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 23810     MOVE TR-TTL-HD               TO PRT.
 23811     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 459
* ECS010.cbl
 23812
 23813     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 23814     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 23815     MOVE TR-TTL-HD               TO PRT.
 23816     PERFORM 8800-PRINT-ROUTINE.
 23817
 23818     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 23819     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 23820     MOVE TR-TTL-HD               TO PRT.
 23821     PERFORM 8800-PRINT-ROUTINE.
 23822
 23823     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 23824     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 23825     MOVE TR-TTL-HD               TO PRT.
 23826     PERFORM 8800-PRINT-ROUTINE.
 23827
 23828     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 23829     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 23830     MOVE TR-TTL-HD               TO PRT.
 23831     PERFORM 8800-PRINT-ROUTINE.
 23832
 23833     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 23834     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 23835     MOVE TR-TTL-HD               TO PRT.
 23836     PERFORM 8800-PRINT-ROUTINE.
 23837
 23838     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 23839     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 23840     MOVE TR-TTL-HD               TO PRT.
 23841     PERFORM 8800-PRINT-ROUTINE.
 23842
 23843     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 23844     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 23845     MOVE TR-TTL-HD               TO PRT.
 23846     PERFORM 8800-PRINT-ROUTINE.
 23847
 23848     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 23849     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 23850     MOVE TR-TTL-HD               TO PRT.
 23851     PERFORM 8800-PRINT-ROUTINE.
 23852
 23853     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 23854     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 23855     MOVE TR-TTL-HD               TO PRT.
 23856     PERFORM 8800-PRINT-ROUTINE.
 23857
 23858     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 23859     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 23860     MOVE TR-TTL-HD               TO PRT.
 23861     PERFORM 8800-PRINT-ROUTINE.
 23862
 23863     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 23864     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 23865     MOVE TR-TTL-HD               TO PRT.
 23866     PERFORM 8800-PRINT-ROUTINE.
 23867
 23868     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 23869     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 460
* ECS010.cbl
 23870     MOVE TR-TTL-HD               TO PRT.
 23871     PERFORM 8800-PRINT-ROUTINE.
 23872
 23873     MOVE W-1-EP                  TO TTL-PT-CNT.
 23874     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 23875     MOVE TR-TTL-HD               TO PRT.
 23876     PERFORM 8800-PRINT-ROUTINE.
 23877
 23878     MOVE W-P-EP                  TO TTL-PT-CNT.
 23879     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 23880     MOVE TR-TTL-HD               TO PRT.
 23881     PERFORM 8800-PRINT-ROUTINE.
 23882
 23883     MOVE W-M-EP                  TO TTL-PT-CNT.
 23884     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 23885     MOVE TR-TTL-HD               TO PRT.
 23886     PERFORM 8800-PRINT-ROUTINE.
 23887
 23888     MOVE W-R-EP                  TO TTL-PT-CNT.
 23889     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 23890     MOVE TR-TTL-HD               TO PRT.
 23891     PERFORM 8800-PRINT-ROUTINE.
 23892
 23893     MOVE W-WY-EP                 TO TTL-PT-CNT.
 23894     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 23895     MOVE TR-TTL-HD               TO PRT.
 23896     PERFORM 8800-PRINT-ROUTINE.
 23897
 23898     MOVE W-VA-EP                 TO TTL-PT-CNT.
 23899     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 23900     MOVE TR-TTL-HD               TO PRT.
 23901     PERFORM 8800-PRINT-ROUTINE.
 23902
 23903     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 23904     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 23905     MOVE TR-TTL-HD               TO PRT.
 23906     PERFORM 8800-PRINT-ROUTINE.
 23907
 23908     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 23909     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23910     MOVE TR-TTL-HD               TO PRT.
 23911     PERFORM 8800-PRINT-ROUTINE.
 23912
 23913     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 23914     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23915     MOVE TR-TTL-HD               TO PRT.
 23916     PERFORM 8800-PRINT-ROUTINE.
 23917
 23918     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 23919     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23920     MOVE TR-TTL-HD               TO PRT.
 23921     PERFORM 8800-PRINT-ROUTINE.
 23922
 23923     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 23924     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23925     MOVE TR-TTL-HD               TO PRT.
 23926     PERFORM 8800-PRINT-ROUTINE.
 23927
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 461
* ECS010.cbl
 23928     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23929     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 23930     MOVE TR-TTL-HD               TO PRT.
 23931     PERFORM 8800-PRINT-ROUTINE.
 23932
 23933     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 23934     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 23935     MOVE TR-TTL-HD               TO PRT.
 23936     PERFORM 8800-PRINT-ROUTINE.
 23937
 23938     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23939     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 23940     MOVE TR-TTL-HD               TO PRT.
 23941     PERFORM 8800-PRINT-ROUTINE.
 23942
 23943     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 23944     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 23945     MOVE TR-TTL-HD               TO PRT.
 23946     PERFORM 8800-PRINT-ROUTINE.
 23947
 23948 9990-FINAL-CLOSE.
*23949                             COPY ELCPRTC.
 23950******************************************************************04/15/98
 23951*                                                                *ELCPRTC
 23952*                                                                *ELCPRTC
 23953*                            ELCPRTC.                            *   LV003
 23954*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 23955*                            VMOD=2.002                          *   CL**2
 23956*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 23957*                                                                *ELCPRTC
 23958* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 23959******************************************************************ELCPRTC
 23960                                                                  ELCPRTC
 23961      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 23962          CLOSE FICH.                                             ELCPRTC
 23963                                                                  ELCPRTC
 23964******************************************************************ELCPRTC
 23965
 23966     IF DTE-CLIENT = 'DMD'
 23967         CLOSE ERRESC-IN.
 23968
 23969     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 23970
 23971     DISPLAY ' '.
 23972     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23973     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 23974     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23975     DISPLAY ' '.
 23976
 23977     MOVE    ' DISPLAY ERROR COUNT = '
 23978       TO  DIS-LINE-REASON.
 23979     MOVE  ERROR-COUNT
 23980       TO  DIS-LINE-REC.
 23981         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 23982
 23983     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 23984           DISPLAY-PRT
 23985           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 462
* ECS010.cbl
 23986           ME50-ECS010-BALANCE
 23987           PENDING-EXTRACT  SUMMARY-EXTR.
 23988
 23989     if (dte-client = 'DCC')
 23990        and (dte-pgm-opt = '1')
 23991        close new-detail-extr
 23992     end-if
 23993
 23994     IF DTE-PGM-OPT = '1'
 23995         CLOSE CERT-MASTER-OUT
 23996               DETAIL-EXTR
 23997     end-if
 23998
 23999     IF ERACCTT-FILE-STATUS NOT = '00'
 24000         MOVE '12'                TO ABEND-CODE-1
 24001         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 24002         DISPLAY '******************************'
 24003         DISPLAY '***** ERROR LOCATION 027 *****'
 24004         DISPLAY '******************************'
 24005         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24006           GO TO ABEND-PGM.
 24007
 24008     IF COMM-OPEN-SW = 'X'
 24009         CLOSE ERCTBL
 24010         IF ERCTBL-FILE-STATUS NOT = '00'
 24011             MOVE '42'               TO ABEND-CODE-1
 24012             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 24013             DISPLAY '******************************'
 24014             DISPLAY '***** ERROR LOCATION 028 *****'
 24015             DISPLAY '******************************'
 24016             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24017             GO TO ABEND-PGM.
 24018
 24019     IF REIN-OPEN-SW = 'X'
 24020         CLOSE ERRTBL-IN
 24021         IF ERRTBL-FILE-STATUS NOT = '00'
 24022             MOVE '22'               TO ABEND-CODE-1
 24023             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 24024             DISPLAY '******************************'
 24025             DISPLAY '***** ERROR LOCATION 029 *****'
 24026             DISPLAY '******************************'
 24027             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24028             GO TO ABEND-PGM.
 24029
 24030     MOVE 'C'                         TO CP-IO-FUNCTION.
 24031     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 24032     IF IO-ERROR
 24033         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 24034                                      TO WS-ABEND-MESSAGE
 24035         MOVE 0302                    TO WS-RETURN-CODE
 24036         DISPLAY '******************************'
 24037         DISPLAY '***** ERROR LOCATION 030 *****'
 24038         DISPLAY '******************************'
 24039         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24040         GO TO ABEND-PGM.
 24041
 24042     IF ME-DO-UPDATE
 24043           MOVE ME-START-TIME        TO ME-010-START
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 463
* ECS010.cbl
 24044           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 24045           ACCEPT WS-TIME-OF-DAY   FROM TIME
 24046           MOVE WS-TIME              TO ME-010-END
 24047           ADD 1 TO ME-010-RUN-CT
 24048           REWRITE MONTH-END-BALANCES
 24049           DISPLAY 'MONTH-END BALANCES POSTED'
 24050           CLOSE ERMEBL-INOUT
 24051     ELSE
 24052         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 24053
 24054     GO TO 9999-END-THE-JOB.
 24055
 24056 CERT-DATE-LOAD.
*24057     COPY ELCCRTM1.
 24058******************************************************************04/15/98
 24059*                                                                *ELCCRTM1
 24060*                                                                *ELCCRTM1
 24061*                            ELCCRTM1                            *   LV003
 24062*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24063*                            VMOD=2.001                          *ELCCRTM1
 24064*                                                                *ELCCRTM1
 24065*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 24066*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 24067*                                                                *ELCCRTM1
 24068******************************************************************ELCCRTM1
 24069     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 24070     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 24071     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 24072     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 24073     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 24074     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 24075     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 24076     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 24077     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 24078                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 24079     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 24080                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 24081     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 24082     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 24083     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 24084     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 24085     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 24086     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 24087           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 24088                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 24089     END-PERFORM.                                                 ELCCRTM1
 24090                                                                  ELCCRTM1
 24091
 24092 EXTRACT-DATE-LOAD.
*24093     COPY ELCEXTM1.
 24094******************************************************************04/15/98
 24095*                                                                *ELCEXTM1
 24096*                                                                *ELCEXTM1
 24097*                            ELCEXTM1                            *   LV010
 24098*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 24099*                            VMOD=2.001                          *ELCEXTM1
 24100*                                                                *ELCEXTM1
 24101*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 464
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 24102*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 24103*                                                                *ELCEXTM1
 24104******************************************************************ELCEXTM1
 24105                                                                  ELCEXTM1
 24106     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 24107     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 24108     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 24109     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 24110     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 24111     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 24112                                                                     CL**9
 24113     EVALUATE TRUE                                                   CL**5
 24114        WHEN DE-ISSUE      OR                                        CL**8
 24115             DE-RC-ISSUE   OR                                        CL**8
 24116             DE-RR-RC-ISS  OR                                        CL**8
 24117             DE-CANCEL     OR                                        CL**8
 24118             DE-RC-CANCEL  OR                                        CL**8
 24119             DE-RR-RC-CNC                                            CL**8
 24120           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 24121                                                                     CL**9
 24122        WHEN DE-CLAIM      OR                                        CL**8
 24123             DE-RR-RC-CLM                                            CL**6
 24124           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 24125           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 24126           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 24127           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 24128           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 24129           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 24130                                                                     CL**9
 24131        WHEN DE-RESERVE                                              CL**9
 24132           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 24133           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 24134           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 24135                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 24136           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 24137                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 24138           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 24139     END-EVALUATE.                                                   CL**9
 24140                                                                     CL**9
 24141
 24142 EXTRACT-DATE-RELOAD.
*24143     COPY ELCEXTM2.
 24144******************************************************************04/15/98
 24145*                                                                *ELCEXTM2
 24146*                                                                *ELCEXTM2
 24147*                            ELCEXTM2                            *   LV011
 24148*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 24149*                            VMOD=2.001                          *ELCEXTM2
 24150*                                                                *ELCEXTM2
 24151*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 24152*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 24153*                                                                *   CL**9
 24154******************************************************************ELCEXTM2
 24155                                                                  ELCEXTM2
 24156     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 24157     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 24158     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 24159     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 465
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 24160     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 24161     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
 24162                                                                     CL*10
 24163     EVALUATE TRUE                                                   CL*10
 24164        WHEN DE-ISSUE      OR                                        CL*10
 24165             DE-RC-ISSUE   OR                                        CL*10
 24166             DE-RR-RC-ISS  OR                                        CL*10
 24167             DE-CANCEL     OR                                        CL*10
 24168             DE-RC-CANCEL  OR                                        CL*10
 24169             DE-RR-RC-CNC                                            CL*10
 24170           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 24171                                                                     CL*10
 24172        WHEN DE-CLAIM      OR                                        CL*10
 24173             DE-RR-RC-CLM                                            CL**7
 24174           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 24175           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 24176           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 24177           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 24178           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 24179           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 24180                                                                     CL*10
 24181        WHEN DE-RESERVE                                              CL**7
 24182            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 24183            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 24184            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 24185                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 24186            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 24187                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 24188            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 24189     END-EVALUATE.                                                   CL**5
 24190                                                                  ELCEXTM2
 24191
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 466
* ECS010.cbl
 24193 ABEND-PGM.
 24194     DISPLAY '******************************'
 24195     DISPLAY '***** ABEND PGM **************'
 24196     DISPLAY '******************************'
*24197                             COPY ELCABEND.
 24198***************************************************************** 04/14/98
 24199*                                                               * ELCABEND
 24200*                            ELCABEND.                          *    LV003
 24201*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24202*                            VMOD 2.002                              CL**2
 24203*                                                               * ELCABEND
 24204*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 24205*            AND THEN ABENDS.                                   * ELCABEND
 24206*                                                               * ELCABEND
 24207*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 24208*                                                               * ELCABEND
 24209***************************************************************** ELCABEND
 24210*APS-010.                                                         ELCABEND
 24211     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 24212     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 24213                                                                  ELCABEND
 24214     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 24215         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24216         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24217                                 UPON CONSOLE.                    ELCABEND
 24218                                                                  ELCABEND
 24219     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 24220         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24221         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24222                                 UPON CONSOLE.                    ELCABEND
 24223                                                                  ELCABEND
 24224     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24225     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24226                                 UPON CONSOLE.                    ELCABEND
 24227                                                                  ELCABEND
 24228     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 24229     CALL 'ABORTME'.
 24230                                                                  ELCABEND
 24231 APS-EXIT.                                                        ELCABEND
 24232     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 467
* ECS010.cbl
 24234 9999-END-THE-JOB.
 24235
 24236     DISPLAY ' '.
 24237     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 24238         'ECS010 ******'
 24239     DISPLAY ' '.
 24240     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 468
* ECS010.cbl
 24241/
 24242 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 24243     IF LCP-ASA = '+'
 24244         WRITE MISMATCH-RPT AFTER 0 LINE
 24245     ELSE
 24246     IF LCP-ASA = ' '
 24247         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 24248     ELSE
 24249     IF LCP-ASA = '0'
 24250         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 24251     ELSE
 24252     IF LCP-ASA = '-'
 24253         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 24254     ELSE
 24255     IF LCP-ASA = '1'
 24256         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 24257     ELSE
 24258     IF LCP-ASA = '2'
 24259         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 24260     ELSE
 24261     IF LCP-ASA = '3'
 24262         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 24263     ELSE
 24264     IF LCP-ASA = '4'
 24265         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 24266     ELSE
 24267     IF LCP-ASA = '5'
 24268         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 24269     ELSE
 24270     IF LCP-ASA = '6'
 24271         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 24272     ELSE
 24273     IF LCP-ASA = '7'
 24274         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 24275     ELSE
 24276     IF LCP-ASA = '8'
 24277         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 24278     ELSE
 24279     IF LCP-ASA = '9'
 24280         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 24281     ELSE
 24282     IF LCP-ASA = 'A'
 24283         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 24284     ELSE
 24285     IF LCP-ASA = 'B'
 24286         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 24287     ELSE
 24288     IF LCP-ASA = 'C'
 24289         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 24290     ELSE
 24291     IF LCP-ASA = 'V'
 24292         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 24293     ELSE
 24294     IF LCP-ASA = 'W'
 24295         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 24296     ELSE
 24297     DISPLAY 'ASA CODE ERROR'.
 24298 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 11-Jul-14 14:22 Page 469
* ECS010.cbl
 24299     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  296
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     5860356     Code:      138941
