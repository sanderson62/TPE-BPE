* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* EL596.cbl
* Options: int("EL596.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL596.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL596.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL596.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2****************************************************************
     3 IDENTIFICATION DIVISION.
     4 PROGRAM-ID. EL596.
     5
     6*AUTHOR.     Pablo
     7*            Colleyville, TX.
     8*DATE-COMPILED.
     9
    10*SECURITY.   *****************************************************
    11*            *                                                   *
    12*            *   THIS PROGRAM IS THE PROPERTY OF CSO.            *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* EL596.cbl
    14*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    15*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    16*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    17*            *                                                   *
    18*            *****************************************************
    19
    20*REMARKS.
    21***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    22***                                                            ***
    23***  This program reads through all the Check records on the   ***
    24***  CheckApproval DB in table ChkApp_Check on server NTCSO2   ***
    25***  with a maintained date > prev cycle date and <=           ***
    26***  current cycle date and company                            ***
    27***  = datefile company with a checktype of 1(refund  ) and    ***
    28***  approval status of 1,3 or 5(approved,denied,manual).      ***
    29***  For the 1's and 5's we update the erchek record with      ***
    30***  approval info and create interface records to feed corp   ***
    31***  finance and write erpyaj records to Logic. For the 3's we ***
    32***  just update erchek with a denied status. All status' are  ***
    33***  reported.                                                 ***
    34***                                                            ***
    35***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    36
    37 ENVIRONMENT DIVISION.
    38 CONFIGURATION SECTION.
    39 INPUT-OUTPUT SECTION.
    40 FILE-CONTROL.
    41
    42     SELECT ERCHEK       ASSIGN TO ERCHEK
    43                         ACCESS IS DYNAMIC
    44                         ORGANIZATION IS INDEXED
    45                         FILE STATUS IS ERCHEK-FILE-STATUS
    46                         RECORD KEY IS CH-CONTROL-PRIMARY.
    47
    48     SELECT ERPYAJ       ASSIGN TO ERPYAJ
    49                         ACCESS IS DYNAMIC
    50                         ORGANIZATION IS INDEXED
    51                         FILE STATUS IS ERPYAJ-FILE-STATUS
    52                         RECORD KEY IS PY-CONTROL-PRIMARY.
    53
    54     SELECT ERPNDB       ASSIGN TO ERPNDB2
    55                         ACCESS IS DYNAMIC
    56                         ORGANIZATION IS INDEXED
    57                         FILE STATUS IS ERPNDB-FILE-STATUS
    58                         RECORD KEY IS PB-CONTROL-BY-ACCOUNT.
    59
    60     SELECT FREE-FILE-NRM    ASSIGN TO SYS021
    61        ORGANIZATION IS LINE SEQUENTIAL.
    62
    63     SELECT FREE-FILE-MAN    ASSIGN TO SYS022
    64        ORGANIZATION IS LINE SEQUENTIAL.
    65     SELECT FREE-FILE-VOID   ASSIGN TO SYS023
    66        ORGANIZATION IS LINE SEQUENTIAL.
    67     SELECT PRNTR           ASSIGN TO SYS008.
    68     SELECT FICH            ASSIGN TO SYS020.
    69     SELECT DISK-DATE    ASSIGN TO SYS019.
    70
    71 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* EL596.cbl
    72 FILE SECTION.
    73
    74 FD  ERCHEK.
*   75                                 COPY ERCCHEK.
    76******************************************************************04/29/98
    77*                                                                *ERCCHEK
    78*                                                                *ERCCHEK
    79*                            ERCCHEK                             *   LV002
    80*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    81*                            VMOD=2.008                          *   CL**2
    82*                                                                *ERCCHEK
    83*   FILE DESCRIPTION = CHECK RECORDS                             *ERCCHEK
    84*                                                                *ERCCHEK
    85*   FILE TYPE = VSAM,KSDS                                        *ERCCHEK
    86*   RECORD SIZE = 600    RECFORM = FIXED                         *ERCCHEK
    87*                                                                *ERCCHEK
    88*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *ERCCHEK
    89*       ALTERNATE INDEX = NONE                                   *ERCCHEK
    90*                                                                *ERCCHEK
    91*   LOG = YES                                                    *ERCCHEK
    92*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCHEK
    93******************************************************************ERCCHEK
    94*                   C H A N G E   L O G
    95*
    96* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    97*-----------------------------------------------------------------
    98*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    99* EFFECTIVE    NUMBER
   100*-----------------------------------------------------------------
   101* 021414    2003053000001  PEMA  changes for auto chk request
   102******************************************************************
   103 01  CHECK-RECORDS.                                               ERCCHEK
   104     12  CH-RECORD-ID                      PIC XX.                ERCCHEK
   105         88  VALID-CH-ID                      VALUE 'CH'.         ERCCHEK
   106                                                                  ERCCHEK
   107     12  CH-CONTROL-PRIMARY.                                      ERCCHEK
   108         16  CH-COMPANY-CD                 PIC X.                 ERCCHEK
   109         16  CH-CARRIER                    PIC X.                 ERCCHEK
   110         16  CH-GROUPING                   PIC X(6).              ERCCHEK
   111         16  CH-STATE                      PIC XX.                ERCCHEK
   112         16  CH-ACCOUNT                    PIC X(10).             ERCCHEK
   113         16  CH-CERT-EFF-DT                PIC XX.                ERCCHEK
   114         16  CH-CERT-NO.                                          ERCCHEK
   115             20  CH-CERT-PRIME             PIC X(10).             ERCCHEK
   116             20  CH-CERT-SFX               PIC X.                 ERCCHEK
   117         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.    ERCCHEK
   118                                                                  ERCCHEK
   119     12  CH-RECORDED-DT                    PIC XX.                ERCCHEK
   120     12  CH-RECORDED-BY                    PIC X(4).              ERCCHEK
   121     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.  ERCCHEK
   122                                                                  ERCCHEK
   123     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.  ERCCHEK
   124     12  CH-CHECK-NO                       PIC X(7).              ERCCHEK
   125     12  CH-REASON-FOR-CHECK               PIC X(25).             ERCCHEK
   126     12  CH-CHECK-WRITTEN-DT               PIC XX.                ERCCHEK
   127     12  FILLER                            PIC X.                 ERCCHEK
   128                                                                  ERCCHEK
   129     12  CH-PAYEE-INFO.                                           ERCCHEK
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* EL596.cbl (/apps/prod/cid1p/copy/ERCCHEK)
   130         16  CH-PAYEE-NAME-1               PIC X(30).             ERCCHEK
   131         16  CH-PAYEE-NAME-2               PIC X(30).             ERCCHEK
   132         16  CH-PAYEE-ADDRESS-1            PIC X(30).             ERCCHEK
   133         16  CH-PAYEE-ADDRESS-2            PIC X(30).             ERCCHEK
   134         16  CH-PAYEE-CITY-ST.
   135             20  CH-PAYEE-CITY             PIC X(28).
   136             20  CH-PAYEE-STATE            PIC XX.
   137         16  CH-PAYEE-ZIP-CODE.                                   ERCCHEK
   138             20  CH-PAYEE-ZIP.                                    ERCCHEK
   139                 24  CH-ZIP-PRI-1ST        PIC X.                 ERCCHEK
   140                     88  CH-CANADIAN-POST-CODE                    ERCCHEK
   141                                           VALUES 'A' THRU 'Z'.   ERCCHEK
   142                 24  FILLER                PIC X(4).              ERCCHEK
   143             20  CH-PAYEE-ZIP-EXT          PIC X(4).              ERCCHEK
   144         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE. ERCCHEK
   145             20  CH-CAN-POSTAL-1           PIC XXX.               ERCCHEK
   146             20  CH-CAN-POSTAL-2           PIC XXX.               ERCCHEK
   147             20  FILLER                    PIC XXX.               ERCCHEK
   148                                                                  ERCCHEK
   149     12  CH-CHECK-STUB-TEXT.                                      ERCCHEK
   150         16  CH-STUB-LINE-1                PIC X(30).             ERCCHEK
   151         16  CH-TEXT-LINE-1                PIC X(50).             ERCCHEK
   152         16  CH-TEXT-LINE-2                PIC X(50).             ERCCHEK
   153         16  CH-TEXT-LINE-3                PIC X(40).             ERCCHEK
   154     12  CH-RETURN-TO                      PIC X(30).             ERCCHEK
   155                                                                  ERCCHEK
   156     12  CH-COMPENSATION-CONTROL.                                 ERCCHEK
   157         16  CH-COMP-CARRIER               PIC X.                 ERCCHEK
   158         16  CH-COMP-GROUPING              PIC X(6).              ERCCHEK
   159         16  CH-COMP-FIN-RESP              PIC X(10).             ERCCHEK
   160         16  CH-COMP-ACCOUNT               PIC X(10).             ERCCHEK
   161                                                                  ERCCHEK
   162     12  CH-CREDIT-SELECT-DT               PIC XX.                ERCCHEK
   163     12  CH-CREDIT-ACCEPT-DT               PIC XX.                ERCCHEK
   164     12  CH-PAYEE-CODE                     PIC X(6).              ERCCHEK
   165                                                                  ERCCHEK
   166     12  CH-VOID-DATA.                                            ERCCHEK
   167         20  CH-VOID-DT                    PIC XX.                ERCCHEK
   168         20  CH-VOID-BY                    PIC X(4).              ERCCHEK
   169         20  CH-VOID-REASON                PIC X(25).             ERCCHEK
   170                                                                  ERCCHEK
   171     12  CH-APPROVAL-DATA.
   172         20  CH-APPROVAL-DT                PIC XX.
   173         20  CH-APPROVAL-STATUS            PIC X.
   174             88  CH-IN-LIMBO                  VALUE ' '.
   175             88  CH-APPROV-PENDING            VALUE 'P' '2'.
   176             88  CH-APPROVED                  VALUE 'A'.
   177             88  CH-DENIED                    VALUE 'D'.
   178         20  CH-APPROVED-BY                PIC XXXX.
   179     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.    ERCCHEK
   180             88  PAYMENT-NOT-QUEUED           VALUE ZERO.         ERCCHEK
   181     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.    ERCCHEK
   182                                                                  ERCCHEK
   183     12  ch-released-dt                    pic xx.
   184     12  ch-check-cashed-dt                pic xx.
   185     12  FILLER                            PIC X.
   186*    12  CH-CHECK-REFERENCE                PIC X(12).             ERCCHEK
   187     12  CH-CHECK-ORIGIN-SW                PIC X.                 ERCCHEK
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* EL596.cbl (/apps/prod/cid1p/copy/ERCCHEK)
   188             88  CH-REFUND-CHECK              VALUE 'R'.          ERCCHEK
   189             88  CH-MAINT-CHECK               VALUE 'M'.          ERCCHEK
   190                                                                  ERCCHEK
   191     12  CH-CANC-DT                        PIC XX.                ERCCHEK
   192     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.  ERCCHEK
   193     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.  ERCCHEK
   194                                                                  ERCCHEK
   195     12  CH-INSURED-NAME                   PIC X(28).             ERCCHEK
   196                                                                  ERCCHEK
   197     12  ch-released-by                    pic x(4).
   198     12  ch-csr                            pic x(4).
   199     12  ch-deduct-commission              pic x.
   200         88  ch-deduct-comm                  value 'Y'.
   201         88  ch-do-not-deduct-comm           value 'N'.
   202                                                                  ERCCHEK
   203     12  FILLER                            PIC X(11).
   204*    12  CH-LETTER-TABLE.                                         ERCCHEK
   205*        16  CH-LETTERS OCCURS 3 TIMES                            ERCCHEK
   206*                       INDEXED BY CH-LT-NDX                      ERCCHEK
   207*                                          PIC X(04).             ERCCHEK
   208                                                                  ERCCHEK
   209     12  FILLER                            PIC X(07).             ERCCHEK
   210                                                                  ERCCHEK
   211
   212 FD  ERPYAJ.
*  213                                 COPY ERCPYAJ.
   214******************************************************************04/29/98
   215*                                                                *ERCPYAJ
   216*                            ERCPYAJ                             *   LV003
   217*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   218*                            VMOD=2.015                          *   CL**2
   219*                                                                *ERCPYAJ
   220*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *ERCPYAJ
   221*                                                                *ERCPYAJ
   222*                                                                *ERCPYAJ
   223*   FILE TYPE = VSAM,KSDS                                        *ERCPYAJ
   224*   RECORD SIZE = 200  RECFORM = FIXED                           *ERCPYAJ
   225*                                                                *ERCPYAJ
   226*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *ERCPYAJ
   227*       ALTERNATE PATHS = NONE                                   *ERCPYAJ
   228*                                                                *ERCPYAJ
   229*   LOG = YES                                                    *ERCPYAJ
   230*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPYAJ
   231******************************************************************ERCPYAJ
   232******************************************************************
   233*                   C H A N G E   L O G
   234*
   235* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   236*-----------------------------------------------------------------
   237*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   238* EFFECTIVE    NUMBER
   239*-----------------------------------------------------------------
   240* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
   241* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
   242******************************************************************
   243                                                                  ERCPYAJ
   244 01  PENDING-PAY-ADJ.                                             ERCPYAJ
   245     12  PY-RECORD-ID                     PIC XX.                 ERCPYAJ
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* EL596.cbl (/apps/prod/cid1p/copy/ERCPYAJ)
   246         88  VALID-PY-ID                        VALUE 'PY'.       ERCPYAJ
   247                                                                  ERCPYAJ
   248     12  PY-CONTROL-PRIMARY.                                      ERCPYAJ
   249         16  PY-COMPANY-CD                PIC X.                  ERCPYAJ
   250         16  PY-CARRIER                   PIC X.                  ERCPYAJ
   251         16  PY-GROUPING                  PIC X(6).               ERCPYAJ
   252         16  PY-FIN-RESP                  PIC X(10).              ERCPYAJ
   253         16  PY-ACCOUNT                   PIC X(10).              ERCPYAJ
   254         16  PY-PRODUCER REDEFINES PY-ACCOUNT                     ERCPYAJ
   255                                          PIC X(10).              ERCPYAJ
   256         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCPYAJ
   257         16  PY-RECORD-TYPE               PIC X.                  ERCPYAJ
   258             88  PY-REMIT-RECEIVED            VALUE 'R'.          ERCPYAJ
   259             88  PY-DEPOSIT                   VALUE 'D'.          ERCPYAJ
   260             88  PY-CHARGE-TO-AGENT           VALUE 'C'.          ERCPYAJ
   261             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.          ERCPYAJ
   262             88  PY-ADJ-DEPOSIT               VALUE 'T'.          ERCPYAJ
   263             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.          ERCPYAJ
   264             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.          ERCPYAJ
   265             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.          ERCPYAJ
   266             88  PY-ADD-TO-BALANCE            VALUE 'Z'.          ERCPYAJ
   267             88  PY-FICA-ENTRY                VALUE 'F'.          ERCPYAJ
   268             88  PY-REMIT-IND-GROUPING        VALUE 'G'.          ERCPYAJ
   269             88  PY-POLICY-FEE                VALUE 'W'.          ERCPYAJ
   270             88  PY-DUE-PREM-ADJ              VALUE 'P'.
   271                                                                  ERCPYAJ
   272     12  PY-PYMT-TYPE                     PIC X.                  ERCPYAJ
   273             88  PY-NEW-BUS-PYMT              VALUE 'B'.          ERCPYAJ
   274             88  PY-REINS-PYMT                VALUE 'R'.          ERCPYAJ
   275             88  PY-EXP-PYMT                  VALUE 'E'.          ERCPYAJ
   276                                                                  ERCPYAJ
   277     12  PY-BIL-INV                       PIC X(6).               ERCPYAJ
   278     12  PY-REF-NO                        PIC X(12).              ERCPYAJ
   279                                                                  ERCPYAJ
   280     12  PY-LAST-MAINT-DT                 PIC XX.                 ERCPYAJ
   281     12  PY-LAST-MAINT-BY                 PIC X(4).               ERCPYAJ
   282     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPYAJ
   283                                                                  ERCPYAJ
   284     12  PY-PYADJ-RECORD.                                         ERCPYAJ
   285         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.   ERCPYAJ
   286         16  PY-ENTRY-COMMENT             PIC X(30).              ERCPYAJ
   287         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.               000
   288             20  PY-GL-ACCOUNT            PIC X(10).                   000
   289             20  PY-GL-STATE              PIC X(02).                   000
   290             20  PY-GL-CANC-SW            PIC X(01).                   000
   291                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.                   000
   292                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.                   000
   293             20  PY-GL-COMMENT            PIC X(10).                   000
   294             20  FILLER      REDEFINES PY-GL-COMMENT.                  000
   295                 24  PY-GL-CHECK-NO       PIC 9(06).                   000
   296                 24  FILLER               PIC X(04).                   000
   297             20  FILLER                   PIC X(07).                   ERC
   298         16  PY-SAVE-ACCOUNT              PIC X(10).              ERCPYAJ
   299         16  PY-SAVE-TYPE                 PIC X(01).              ERCPYAJ
   300                                                                  ERCPYAJ
   301         16  PY-LETTERS.                                          ERCPYAJ
   302             20  PY-LETTER OCCURS 3 TIMES                         ERCPYAJ
   303                           INDEXED BY PY-LET-NDX                  ERCPYAJ
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* EL596.cbl (/apps/prod/cid1p/copy/ERCPYAJ)
   304                                          PIC X(04).              ERCPYAJ
   305                                                                  ERCPYAJ
   306         16  PY-ERCOMP-TYPE               PIC X.
   307             88  PY-ACCOUNT-TYPE              VALUE 'A'.
   308             88  PY-GA-TYPE                   VALUE 'G'.
   309             88  PY-BANK-TYPE                 VALUE 'B'.
   310         16  FILLER                       PIC X(05).
   311                                                                  ERCPYAJ
   312     12  PY-RECORD-STATUS.                                        ERCPYAJ
   313         16  PY-CREDIT-SELECT-DT          PIC XX.                 ERCPYAJ
   314         16  PY-CREDIT-ACCEPT-DT          PIC XX.                 ERCPYAJ
   315         16  PY-BILLED-DATE               PIC XX.                 ERCPYAJ
   316         16  PY-REPORTED-DT               PIC XX.                 ERCPYAJ
   317         16  PY-PMT-APPLIED               PIC X.                  ERCPYAJ
   318             88  PY-ACCOUNT-PMT               VALUE 'A'.          ERCPYAJ
   319             88  PY-GA-PMT                    VALUE 'G'.          ERCPYAJ
   320             88  PY-OVWRITE-PMT               VALUE 'O'.          ERCPYAJ
   321             88  PY-NON-AR-PMT                VALUE 'N'.          ERCPYAJ
   322         16  FILLER                       PIC X(5).               ERCPYAJ
   323         16  PY-INPUT-DT                  PIC XX.                 ERCPYAJ
   324         16  PY-CHECK-NUMBER              PIC X(6).               ERCPYAJ
   325         16  PY-VOID-SW                   PIC X.                  ERCPYAJ
   326             88  PY-CHECK-VOIDED              VALUE 'V'.          ERCPYAJ
   327         16  PY-CHECK-ORIGIN-SW           PIC X.                  ERCPYAJ
   328             88  PY-BILLING-CHECK             VALUE 'B'.          ERCPYAJ
   329             88  PY-REFUND-CHECK              VALUE 'R'.          ERCPYAJ
   330             88  PY-GA-CHECK                  VALUE 'G'.          ERCPYAJ
   331             88  PY-CHECK-WRITTEN             VALUE 'W'.          ERCPYAJ
   332             88  PY-CHECK-REVERSAL            VALUE 'V'.          ERCPYAJ
   333         16  PY-CHECK-WRITTEN-DT          PIC XX.                 ERCPYAJ
   334         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.         ERCPYAJ
   335         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.         ERCPYAJ
   336         16  PY-BILL-FLAG                 PIC X.                  ERCPYAJ
   337             88  PY-BILLED                    VALUE 'B'.          ERCPYAJ
   338         16  PY-AR-FLAG                   PIC X.                  ERCPYAJ
   339             88  PY-AR-CYCLE                  VALUE 'C'.          ERCPYAJ
   340             88  PY-AR-MONTH-END              VALUE 'M'.          ERCPYAJ
   341         16  PY-AR-DATE                   PIC XX.                 ERCPYAJ
   342                                                                  ERCPYAJ
   343     12  PY-GL-CODES.                                             ERCPYAJ
   344         16  PY-GL-DB                     PIC X(14).              ERCPYAJ
   345         16  PY-GL-CR                     PIC X(14).              ERCPYAJ
   346         16  PY-GL-FLAG                   PIC X.                  ERCPYAJ
   347         16  PY-GL-DATE                   PIC XX.                 ERCPYAJ
   348                                                                  ERCPYAJ
   349     12  PY-CANCEL-FEE-FLAG               PIC X(2).               ERCPYAJ
   350     12  FILLER                           PIC X(3).               ERCPYAJ
   351******************************************************************ERCPYAJ
   352
   353
   354 FD  ERPNDB.
*  355                                 COPY ERCPNDB.
   356******************************************************************
   357*                                                                *
   358*                                                                *
   359*                            ERCPNDB.                            *
   360*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   361*                            VMOD=2.025                          *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* EL596.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   362*                                                                *
   363*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   364*                                                                *
   365******************************************************************
   366*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   367*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   368******************************************************************
   369*                                                                *
   370*                                                                *
   371*   FILE TYPE = VSAM,KSDS                                        *
   372*   RECORD SIZE = 585  RECFORM = FIXED                           *
   373*                                                                *
   374*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   375*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   376*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   377*                                                 RKP=13,LEN=36  *
   378*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   379*                                      AND CHG-SEQ.)             *
   380*                                                RKP=49,LEN=11   *
   381*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   382*                                      AND CHG-SEQ.)             *
   383*                                                RKP=60,LEN=15   *
   384*                                                                *
   385*   LOG = NO                                                     *
   386*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   387******************************************************************
   388******************************************************************
   389*                   C H A N G E   L O G
   390*
   391* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   392*-----------------------------------------------------------------
   393*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   394* EFFECTIVE    NUMBER
   395*-----------------------------------------------------------------
   396* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   397* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   398* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   399* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   400* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   401* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   402* 032306                   PEMA  ADD BOW LOAN NUMBER
   403* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   404* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   405* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   406* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   407* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   408* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
   409* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   410* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   411* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
   412******************************************************************
   413
   414 01  PENDING-BUSINESS.
   415     12  PB-RECORD-ID                     PIC XX.
   416         88  VALID-PB-ID                        VALUE 'PB'.
   417
   418     12  PB-CONTROL-PRIMARY.
   419         16  PB-COMPANY-CD                PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* EL596.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   420         16  PB-ENTRY-BATCH               PIC X(6).
   421         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   422         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   423
   424     12  PB-CONTROL-BY-ACCOUNT.
   425         16  PB-COMPANY-CD-A1             PIC X.
   426         16  PB-CARRIER                   PIC X.
   427         16  PB-GROUPING.
   428             20  PB-GROUPING-PREFIX       PIC XXX.
   429             20  PB-GROUPING-PRIME        PIC XXX.
   430         16  PB-STATE                     PIC XX.
   431         16  PB-ACCOUNT.
   432             20  PB-ACCOUNT-PREFIX        PIC X(4).
   433             20  PB-ACCOUNT-PRIME         PIC X(6).
   434         16  PB-CERT-EFF-DT               PIC XX.
   435         16  PB-CERT-NO.
   436             20  PB-CERT-PRIME            PIC X(10).
   437             20  PB-CERT-SFX              PIC X.
   438         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   439
   440         16  PB-RECORD-TYPE               PIC X.
   441             88  PB-MAILING-DATA                VALUE '0'.
   442             88  PB-ISSUE                       VALUE '1'.
   443             88  PB-CANCELLATION                VALUE '2'.
   444             88  PB-BATCH-TRAILER               VALUE '9'.
   445
   446     12  PB-CONTROL-BY-ORIG-BATCH.
   447         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   448         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   449         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   450         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   451
   452     12  PB-CONTROL-BY-CSR.
   453         16  PB-CSR-COMPANY-CD            PIC X.
   454         16  PB-CSR-ID                    PIC X(4).
   455         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   456         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   457         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   458******************************************************************
   459*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   460******************************************************************
   461
   462     12  PB-LAST-MAINT-DT                 PIC XX.
   463     12  PB-LAST-MAINT-BY                 PIC X(4).
   464     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   465
   466     12  PB-RECORD-BODY                   PIC X(375).
   467
   468     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   469         16  PB-CERT-ORIGIN               PIC X.
   470             88  CLASIC-CREATED-CERT         VALUE '1'.
   471         16  PB-I-NAME.
   472             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   473             20  PB-I-INSURED-FIRST-NAME.
   474                 24  PB-I-INSURED-1ST-INIT PIC X.
   475                 24  FILLER                PIC X(9).
   476             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   477         16  PB-I-AGE                     PIC S99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* EL596.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   478         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   479         16  PB-I-BIRTHDAY                PIC XX.
   480         16  PB-I-INSURED-SEX             PIC X.
   481             88  PB-SEX-MALE     VALUE 'M'.
   482             88  PB-SEX-FEMALE   VALUE 'F'.
   483
   484         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   485         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   486         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   487         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   488         16  PB-I-SKIP-CODE               PIC X.
   489             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   490             88  PB-SKIP-JULY              VALUE '1'.
   491             88  PB-SKIP-AUGUST            VALUE '2'.
   492             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   493             88  PB-SKIP-JULY-AUG          VALUE '4'.
   494             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   495             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   496             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   497             88  PB-SKIP-JUNE              VALUE '8'.
   498             88  PB-SKIP-JUNE-JULY         VALUE '9'.
   499             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   500             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   501         16  PB-I-TERM-TYPE               PIC X.
   502             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   503             88  PB-PAID-WEEKLY            VALUE 'W'.
   504             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   505             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   506             88  PB-PAID-13-YEARLY         VALUE 'T'.
   507         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   508         16  PB-I-POLICY-FORM-NO          PIC X(12).
   509         16  PB-I-DATA-ENTRY-SW           PIC X.
   510             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   511             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   512             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   513             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   514         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   515         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   516*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   517         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   518         16  FILLER                       PIC X.
   519
   520         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   521             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   522             88  PB-INVALID-LIFE             VALUE '  ' '00'
   523                                                   '90' THRU '99'.
   524         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   525                                          PIC XX.
   526         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   527         16  PB-I-AMOUNT-FINANCED REDEFINES
   528                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   529         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   530         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   531                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   532         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   533         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   534         16  PB-I-CLP-AMOUNT REDEFINES
   535                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* EL596.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   536         16  PB-I-LF-CALC-FLAG            PIC X.
   537             88 PB-COMP-LF-PREM               VALUE '?'.
   538         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   539         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   540         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   541         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   542         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   543         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   544         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   545         16  PB-I-LF-ABBR                 PIC XXX.
   546         16  PB-I-LF-INPUT-CD             PIC XX.
   547
   548         16  PB-I-AH-BENEFIT-CD           PIC XX.
   549             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   550             88  PB-INVALID-AH               VALUE '  ' '00'
   551                                                   '90' THRU '99'.
   552         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   553         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   554         16  PB-I-AH-CALC-FLAG            PIC X.
   555             88 PB-COMP-AH-PREM                  VALUE '?'.
   556         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
   557         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   558         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
   559         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   560         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   561         16  PB-I-AH-ABBR                 PIC XXX.
   562         16  PB-I-AH-INPUT-CD             PIC XXX.
   563
   564         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   565         16  PB-I-REIN-TABLE              PIC XXX.
   566         16  PB-I-BUSINESS-TYPE           PIC 99.
   567         16  PB-I-INDV-GRP-CD             PIC X.
   568         16  PB-I-MORT-CODE.
   569             20  PB-I-TABLE               PIC X.
   570             20  PB-I-INTEREST            PIC XX.
   571             20  PB-I-MORT-TYP            PIC X.
   572         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   573         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   574         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   575         16  PB-I-INDV-GRP-OVRD           PIC X.
   576         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   577         16  PB-I-SIG-SW                  PIC X.
   578             88  PB-POLICY-SIGNED             VALUE 'Y'.
   579         16  PB-I-RATE-CLASS              PIC XX.
   580         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   581         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   582         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   583         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   584         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   585         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   586         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   587         16  PB-I-BENEFIT-TYPE            PIC XXX.
   588         16  PB-I-OB-FLAG                 PIC X.
   589             88  PB-I-OB                      VALUE 'B'.
   590             88  PB-I-SUMMARY                 VALUE 'Z'.
   591         16  PB-I-ENTRY-STATUS            PIC X.
   592             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   593                                              'M' '5' '9' '2'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* EL596.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   594             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   595             88  PB-I-POLICY-PENDING          VALUE '2'.
   596             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   597             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   598             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
   599             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   600             88  PB-I-REIN-ONLY               VALUE '9'.
   601             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   602             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   603             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   604             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   605         16  PB-I-INT-CODE                PIC X.
   606             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   607             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   608         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   609         16  PB-I-SOC-SEC-NO              PIC X(11).
   610         16  PB-I-MEMBER-NO               PIC X(12).
   611         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   612*        16  PB-I-LOAN-OFFICER            PIC XXX.
   613         16  PB-I-OLD-LOF                 PIC XXX.
   614         16  PB-I-LF-EXPIRE-DT            PIC XX.
   615         16  PB-I-AH-EXPIRE-DT            PIC XX.
   616         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   617         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   618         16  PB-I-LIFE-INDICATOR          PIC X.
   619             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   620         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   621         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
   622                                          PIC S9(5)V99    COMP-3.
   623         16  PB-I-MAIL-ADDRS-SW           PIC X.
   624             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   625             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   626         16  PB-I-1ST-PMT-DT              PIC XX.
   627         16  PB-I-JOINT-INSURED.
   628             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   629             20 PB-I-JOINT-FIRST-NAME.
   630                24  PB-I-JOINT-FIRST-INIT PIC X.
   631                24  FILLER                PIC X(9).
   632             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   633*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   634         16  PB-I-BENEFICIARY-NAME.
   635             20  PB-I-BANK-NUMBER         PIC X(10).
   636             20  FILLER                   PIC X(15).
   637         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   638         16  PB-I-REFERENCE               PIC X(12).
   639         16  FILLER REDEFINES PB-I-REFERENCE.
   640             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   641             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   642             20  PB-I-CLP-STATE           PIC XX.
   643         16  PB-I-UNDERWRITING-STATUS     PIC X.
   644             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   645             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   646             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   647         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   648         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
   649         16  PB-I-RESIDENT-STATE          PIC XX.
   650         16  PB-I-RATE-CODE               PIC X(4).
   651         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* EL596.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   652         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   653         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   654         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
   655         16  PB-I-BANK-NOCHRGB            PIC 99.
   656         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
   657         16  PB-I-JOINT-BIRTHDAY          PIC XX.
   658
   659     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
   660         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
   661             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
   662         16  PB-C-CANCEL-ORIGIN           PIC X.
   663             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
   664         16  PB-C-LF-CANCEL-DT            PIC XX.
   665         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   666         16  PB-C-LF-CALC-REQ             PIC X.
   667             88 PB-COMP-LF-CANCEL            VALUE '?'.
   668         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
   669         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
   670         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
   671             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
   672         16  PB-C-AH-CANCEL-DT            PIC XX.
   673         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   674         16  PB-C-AH-CALC-REQ             PIC X.
   675             88 PB-COMP-AH-CANCEL            VALUE '?'.
   676         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
   677         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
   678         16  PB-C-LAST-NAME               PIC X(15).
   679         16  PB-C-REFUND-SW               PIC X.
   680             88  PB-C-REFUND-CREATED          VALUE 'Y'.
   681             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
   682         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
   683         16  PB-C-PAYEE-CODE              PIC X(6).
   684         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
   685         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
   686         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
   687         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
   688         16  PB-C-REFERENCE               PIC X(12).
   689         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   690         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   691         16  PB-C-POST-CARD-IND           PIC X.
   692         16  PB-C-CANCEL-REASON           PIC X.
   693         16  PB-C-REF-INTERFACE-SW        PIC X.
   694         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
   695         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
   696         16  FILLER                       PIC X(01).
   697*        16  FILLER                       PIC X(18).
   698         16  PB-C-POLICY-FORM-NO          PIC X(12).
   699*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
   700         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
   701         16  PB-CANCELED-CERT-DATA.
   702             20  PB-CI-INSURED-NAME.
   703                 24  PB-CI-LAST-NAME      PIC X(15).
   704                 24  PB-CI-INITIALS       PIC XX.
   705             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
   706             20  PB-CI-INSURED-SEX        PIC X.
   707             20  PB-CI-LF-TERM            PIC S999        COMP-3.
   708             20  PB-CI-LF-BENEFIT-CD      PIC XX.
   709             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* EL596.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   710             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
   711             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   712             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
   713             20  PB-CI-AH-TERM            PIC S999        COMP-3.
   714             20  PB-CI-AH-BENEFIT-CD      PIC XX.
   715             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
   716             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   717             20  PB-CI-RATE-CLASS         PIC XX.
   718             20  PB-CI-RATE-DEV-LF        PIC XXX.
   719             20  PB-CI-RATE-DEV-AH        PIC XXX.
   720             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
   721             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
   722             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
   723             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
   724             20  PB-CI-LF-ABBR            PIC X(3).
   725             20  PB-CI-AH-ABBR            PIC X(3).
   726             20  PB-CI-OB-FLAG            PIC X.
   727                 88  PB-CI-OB                VALUE 'B'.
   728             20  PB-CI-LF-POLICY-STATUS   PIC X.
   729                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
   730                                           'M' '4' '5' '9' '2'.
   731                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
   732                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
   733                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
   734                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
   735                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
   736                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
   737                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   738                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
   739                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   740                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
   741                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
   742                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
   743                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
   744             20  PB-CI-AH-POLICY-STATUS   PIC X.
   745                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
   746                                           'M' '4' '5' '9' '2'.
   747                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
   748                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
   749                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
   750                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
   751                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
   752                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
   753                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   754                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
   755                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   756                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
   757                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
   758                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
   759                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
   760             20  PB-CI-PAY-FREQUENCY      PIC 99.
   761             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
   762             20  PB-CI-SOC-SEC-NO         PIC X(11).
   763             20  PB-CI-MEMBER-NO          PIC X(12).
   764             20  PB-CI-INT-CODE           PIC X.
   765                 88  PB-CI-ADD-ON                  VALUE 'A'.
   766                 88  PB-CI-SIMPLE                  VALUE 'S'.
   767             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* EL596.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   768             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
   769             20  PB-CI-COMP-EXCP-SW       PIC X.
   770                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
   771                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
   772             20  PB-CI-ENTRY-STATUS       PIC X.
   773             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
   774             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
   775             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
   776             20  PB-CI-DEATH-DT           PIC XX.
   777             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
   778             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
   779             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   780             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   781             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
   782             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
   783             20  PB-CI-ENTRY-DT              PIC XX.
   784             20  PB-CI-ENTRY-BATCH           PIC X(6).
   785             20  PB-CI-LF-EXPIRE-DT          PIC XX.
   786             20  PB-CI-AH-EXPIRE-DT          PIC XX.
   787             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
   788             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
   789             20  PB-CI-OLD-LOF               PIC XXX.
   790*            20  PB-CI-LOAN-OFFICER          PIC XXX.
   791             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
   792             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
   793             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
   794             20  PB-CI-INDV-GRP-CD           PIC X.
   795             20  PB-CI-BENEFICIARY-NAME.
   796                 24  PB-CI-BANK-NUMBER       PIC X(10).
   797                 24  FILLER                  PIC X(15).
   798             20  PB-CI-NOTE-SW               PIC X.
   799             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
   800             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
   801             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
   802             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
   803             20  PB-CI-LOAN-OFFICER          PIC X(5).
   804             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
   805             20  PB-CI-FIRST-NAME            PIC X(10).
   806             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
   807
   808         16  FILLER                       PIC X(13).
   809*032306  16  FILLER                       PIC X(27).
   810*        16  FILLER                       PIC X(46).
   811
   812     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
   813         16  FILLER                       PIC X(10).
   814         16  PB-M-INSURED-LAST-NAME       PIC X(15).
   815         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
   816         16  PB-M-INSURED-MID-INIT        PIC X.
   817         16  PB-M-INSURED-AGE             PIC 99.
   818         16  PB-M-INSURED-BIRTHDAY        PIC XX.
   819         16  PB-M-INSURED-SEX             PIC X.
   820         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
   821         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
   822         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
   823         16  PB-M-INSURED-CITY-STATE.
   824             20  PB-M-INSURED-CITY        PIC X(28).
   825             20  PB-M-INSURED-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* EL596.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   826         16  PB-M-INSURED-ZIP-CODE.
   827             20  PB-M-INSURED-ZIP-PRIME.
   828                 24  PB-M-INSURED-ZIP-1   PIC X.
   829                     88  PB-M-CANADIAN-POST-CODE
   830                                             VALUE 'A' THRU 'Z'.
   831                 24  FILLER               PIC X(4).
   832             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
   833         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
   834                                        PB-M-INSURED-ZIP-CODE.
   835             20  PM-M-INS-CAN-POST1       PIC XXX.
   836             20  PM-M-INS-CAN-POST2       PIC XXX.
   837             20  FILLER                   PIC XXX.
   838         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
   839         16  PB-M-JOINT-BIRTHDAY          PIC XX.
   840         16  PB-M-CRED-BENE-NAME          PIC X(30).
   841         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
   842         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
   843         16  PB-M-CRED-BENE-CITYST.
   844             20  PB-M-CRED-BENE-CITY      PIC X(28).
   845             20  PB-M-CRED-BENE-STATE     PIC XX.
   846
   847         16  FILLER                       PIC X(92).
   848
   849     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
   850         16  FILLER                       PIC X(10).
   851         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   852         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   853         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   854         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   855         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   856         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   857         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   858         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   859         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   860         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   861         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   862         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   863         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   864         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   865         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   866         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   867         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   868         16  PB-ACCOUNT-NAME              PIC X(30).
   869         16  PB-PREM-REF-RPT-FLAG         PIC X.
   870         16  PB-REFERENCE                 PIC X(12).
   871         16  PB-B-RECEIVED-DT             PIC XX.
   872         16  FILLER                       PIC X(234).
   873
   874     12  PB-RECORD-STATUS.
   875         16  PB-CREDIT-SELECT-DT          PIC XX.
   876         16  PB-CREDIT-ACCEPT-DT          PIC XX.
   877         16  PB-BILLED-DT                 PIC XX.
   878         16  PB-BILLING-STATUS            PIC X.
   879             88  PB-ENTRY-REVERSED            VALUE 'R'.
   880             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
   881             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
   882         16  PB-RECORD-BILL               PIC X.
   883             88  PB-RECORD-ON-HOLD            VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* EL596.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   884             88  PB-RECORD-RETURNED           VALUE 'R'.
   885             88  PB-RECORD-ENDORSED           VALUE 'E'.
   886             88  PB-OVERRIDE-LIFE             VALUE 'L'.
   887             88  PB-OVERRIDE-AH               VALUE 'A'.
   888             88  PB-OVERRIDE-BOTH             VALUE 'B'.
   889         16  PB-BATCH-ENTRY               PIC X.
   890             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
   891             88  PB-REIN-ONLY-CERT            VALUE 'R'.
   892             88  PB-REISSUED-CERT             VALUE 'E'.
   893             88  PB-CASH-CERT                 VALUE 'C'.
   894             88  PB-MONTHLY-CERT              VALUE 'M'.
   895             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
   896             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
   897             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
   898         16  PB-FORCE-CODE                PIC X.
   899             88  PB-FORCE-OFF                 VALUE ' ' '0'.
   900             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
   901             88  PB-CANCEL-FORCE              VALUE '8'.
   902             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
   903             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
   904             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
   905             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
   906             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
   907             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
   908             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
   909         16  PB-FATAL-FLAG                PIC X.
   910             88  PB-FATAL-ERRORS              VALUE 'X'.
   911         16  PB-FORCE-ER-CD               PIC X.
   912             88  PB-FORCE-ERRORS              VALUE 'F'.
   913             88  PB-UNFORCED-ERRORS           VALUE 'X'.
   914         16  PB-WARN-ER-CD                PIC X.
   915             88  PB-WARNING-ERRORS            VALUE 'W'.
   916         16  FILLER                       PIC X.
   917         16  PB-OUT-BAL-CD                PIC X.
   918             88  PB-OUT-OF-BAL                VALUE 'O'.
   919         16  PB-LIFE-OVERRIDE-L1          PIC X.
   920         16  PB-AH-OVERRIDE-L1            PIC X.
   921         16  PB-INPUT-DT                  PIC XX.
   922         16  PB-INPUT-BY                  PIC X(4).
   923         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
   924         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
   925         16  PB-TOLERANCE-REJECT-SW       PIC X.
   926         16  PB-LF-EARNING-METHOD         PIC X.
   927         16  PB-AH-EARNING-METHOD         PIC X.
   928         16  PB-LF-TERM-CALC-METHOD       PIC X.
   929         16  PB-AH-TERM-CALC-METHOD       PIC X.
   930         16  PB-REIN-CD                   PIC XXX.
   931         16  PB-LF-REFUND-TYPE            PIC X.
   932         16  PB-AH-REFUND-TYPE            PIC X.
   933         16  PB-ACCT-EFF-DT               PIC XX.
   934         16  PB-ACCT-EXP-DT               PIC XX.
   935         16  PB-COMPANY-ID                PIC X(3).
   936         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
   937         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
   938         16  PB-SV-CARRIER                PIC X.
   939         16  PB-SV-GROUPING               PIC X(6).
   940         16  PB-SV-STATE                  PIC XX.
   941         16  PB-CONFIRMATION-REPT-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* EL596.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   942         16  PB-GA-BILLING-INFO.
   943             20  PB-GA-BILL-DT OCCURS 5 TIMES
   944                                          PIC XX.
   945         16  PB-SV-REMIT-TO  REDEFINES
   946             PB-GA-BILLING-INFO           PIC X(10).
   947         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
   948         16  PB-I-LOAN-OFFICER            PIC X(5).
   949         16  PB-I-VIN                     PIC X(17).
   950
   951         16  FILLER                       PIC X(04).
   952         16  IMNET-BYPASS-SW              PIC X.
   953
   954******************************************************************
   955*                COMMON EDIT ERRORS                              *
   956******************************************************************
   957
   958     12  PB-COMMON-ERRORS.
   959         16  PB-COMMON-ERROR    OCCURS 10 TIMES
   960                                           PIC S9(4)     COMP.
   961
   962******************************************************************
   963
   964 FD  FREE-FILE-NRM
   965     BLOCK CONTAINS 0 RECORDS
   966     RECORDING MODE F.
   967
   968 01  FREE-NRM-RECORD             PIC X(400).
   969
   970 FD  FREE-FILE-MAN
   971     BLOCK CONTAINS 0 RECORDS
   972     RECORDING MODE F.
   973
   974 01  FREE-MAN-RECORD             PIC X(400).
   975
   976 FD  FREE-FILE-VOID
   977     BLOCK CONTAINS 0 RECORDS
   978     RECORDING MODE F.
   979
   980 01  FREE-VOIDS-RECORD           PIC X(32).
   981
   982 FD  PRNTR
*                                      COPY ELCPRTFD.
   983******************************************************************04/15/98
   984*                                                                *ELCPRTFD
   985*                                                                *ELCPRTFD
   986*                            ELCPRTFD.                           *   LV003
   987*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   988*                            VMOD=2.006                          *ELCPRTFD
   989******************************************************************ELCPRTFD
   990     RECORDING MODE F                                             ELCPRTFD
   991     LABEL RECORDS OMITTED                                        ELCPRTFD
   992     BLOCK CONTAINS 0 RECORDS
   993     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   994 01  PRT.                                                         ELCPRTFD
   995     12  P-CTL               PIC  X.                                 CL**2
   996     12  P-DATA              PIC  X(132).                         ELCPRTFD
   997******************************************************************ELCPRTFD
   998
   999 FD  FICH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* EL596.cbl
*                                      COPY ELCFCHFD.
  1000******************************************************************04/15/98
  1001*                                                                *ELCFCHFD
  1002*                            ELCFCHFD.                           *   LV003
  1003*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1004*                            VMOD=2.004                          *   CL**3
  1005*                                                                *ELCFCHFD
  1006******************************************************************ELCFCHFD
  1007     BLOCK CONTAINS 0 RECORDS
  1008     RECORDING MODE F.                                            ELCFCHFD
  1009                                                                  ELCFCHFD
  1010 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  1011******************************************************************ELCFCHFD
  1012
  1013 FD  DISK-DATE
* 1014                                 COPY ELCDTEFD.
  1015******************************************************************04/15/98
  1016*                                                                *ELCDTEFD
  1017*                                                                *ELCDTEFD
  1018*                            ELCDTEFD.                           *   LV002
  1019*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1020*                            VMOD=2.007                          *   CL**2
  1021*                                                                *ELCDTEFD
  1022******************************************************************ELCDTEFD
  1023     BLOCK CONTAINS 0 RECORDS
  1024     RECORDING MODE F.                                            ELCDTEFD
  1025                                                                  ELCDTEFD
  1026 01  DATE-DISK.                                                   ELCDTEFD
  1027     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1028     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1029     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1030     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1031     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1032     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1033     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1034                                                                  ELCDTEFD
  1035 01  DATE-DISK-R.                                                 ELCDTEFD
  1036     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1037     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1038                                     PIC  X(32).                  ELCDTEFD
  1039                                                                  ELCDTEFD
  1040 01  DATE-DISK-T.                                                 ELCDTEFD
  1041     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1042     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1043                                     PIC  X(48).                  ELCDTEFD
  1044                                                                  ELCDTEFD
  1045 01  DATE-DISK-M.                                                 ELCDTEFD
  1046     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1047     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1048                                     PIC  X(48).                  ELCDTEFD
  1049                                                                  ELCDTEFD
  1050 01  DATE-DISK-P.                                                 ELCDTEFD
  1051     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1052     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1053     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1054     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1055         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1056                                     PIC  X.                      ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* EL596.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1057         16  FILLER                  PIC  X(46).                  ELCDTEFD
  1058     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1059         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1060             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1061             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1062             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1063             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1064         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1065                                                                  ELCDTEFD
  1066 01  DATE-DISK-E.                                                 ELCDTEFD
  1067     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1068     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1069                                     PIC  X(4).                   ELCDTEFD
  1070                                                                  ELCDTEFD
  1071 01  DATE-DISK-C.                                                 ELCDTEFD
  1072     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1073     12  DD-CARR1-SECPAY-SW          PIC  X.
  1074     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1075     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1076     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1077     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1078     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1079     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1080     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1081     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1082     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1083     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1084     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1085     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1086     12  DD-CARR2-SECPAY-SW          PIC  X.
  1087     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1088                                                                  ELCDTEFD
  1089 01  DATE-DISK-OPT.                                               ELCDTEFD
  1090     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1091     12  DD-TLR-DATA.                                             ELCDTEFD
  1092         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1093                                     PIC  X(03).                  ELCDTEFD
  1094     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1095         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1096                                     PIC  X(06).                  ELCDTEFD
  1097     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1098         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1099                                     PIC  X(07).                  ELCDTEFD
  1100         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1101     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1102                                     PIC  X(96).                  ELCDTEFD
  1103******************************************************************ELCDTEFD
  1104
  1105 working-storage section.
  1106
* 1107 EXEC SQL
* 1108    INCLUDE SQLCA
* 1109 END-EXEC
  1110 01 SQLCA.
  1111     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
  1112     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
  1113     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
  1114     05  SQLERRM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* EL596.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
  1115         49  SQLERRML    PIC S9(4) COMP-5.
  1116         49  SQLERRMC    PIC X(70).
  1117     05  SQLERRP         PIC X(8).
  1118     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
  1119     05  SQLWARN.
  1120         10  SQLWARN0    PIC X.
  1121         10  SQLWARN1    PIC X.
  1122         10  SQLWARN2    PIC X.
  1123         10  SQLWARN3    PIC X.
  1124         10  SQLWARN4    PIC X.
  1125         10  SQLWARN5    PIC X.
  1126         10  SQLWARN6    PIC X.
  1127         10  SQLWARN7    PIC X.
  1128     05  SQLEXT.
  1129         10  SQLWARN8    PIC X.
  1130         10  SQLWARN9    PIC X.
  1131         10  SQLWARN10   PIC X.
  1132         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
  1133     05  SQLSTATE    PIC X(5).
  1134
  1135 77  ws-recs-out                 pic 9(7) value zeros.
  1136 77  ws-recs-in                  pic 9(7) value zeros.
  1137 77  eof-sw                      pic x value ' '.
  1138     88  end-of-input               value 'Y'.
  1139 77  erchek-file-status          pic xx value low-values.
  1140 77  erpyaj-file-status          pic xx  value low-values.
  1141 77  erpndb-file-status          pic xx  value low-values.
  1142 77  s1                          pic s999 comp-3 value +0.
  1143 77  s2                          pic s999 comp-3 value +0.
  1144 77  ws-bin-start-dt             pic xx  value low-values.
  1145 77  ws-bin-end-dt               pic xx  value low-values.
  1146 77  ws-current-bin-dt           pic xx  value low-values.
  1147 77  WS-PMT-AMT                  PIC S9(7)V99 COMP-3 VALUE +0.
  1148 77  WS-VOID-SW                  PIC X  VALUE SPACES.
  1149     88  PREV-VOID                      VALUE 'Y'.
  1150 77  LCP-ONCTR-01                PIC S9(8) COMP-3 VALUE ZERO.
  1151 77  ws-total-paid               pic s9(9)v99 comp-3 value +0.
  1152 77  ws-total-paid-nrm           pic s9(9)v99 comp-3 value +0.
  1153 77  ws-total-cnt-nrm            pic 9(5)  value zeros.
  1154 77  ws-total-paid-man           pic s9(9)v99 comp-3 value +0.
  1155 77  ws-total-cnt-man            pic 9(5)  value zeros.
  1156 77  ws-total-voids              pic s9(9)v99 comp-3 value +0.
  1157 77  ws-total-cnt-voids          pic 9(5)  value zeros.
  1158 77  ws-erchek-sw                pic x  value spaces.
  1159     88  erchek-found              value 'Y'.
  1160 77  WS-NEXT-CYCLE-BIN-DATE      pic xx value low-values.
  1161 77  ws-good-checks              pic s999 comp-3 value +0.
  1162 77  ws-check-pndb-file          pic x  value ' '.
  1163     88  check-pndb-file            value 'Y'.
  1164 77  ws-erchek-file-sw           pic x value ' '.
  1165     88  end-of-erchek              value 'Y'.
  1166 01  WS-TRANSACTION-RECORD       PIC X(400).
  1167 01  WS-CHECK-DES-RECORD         PIC X(400).
  1168 01  WS-DISTRIBUTION-RECORD      PIC X(400).
  1169 01  WS-PAYEE-ADDRESS-RECORD     PIC X(400).
  1170 01  ws-work-amt-alpha           pic x(10).
  1171 01  ws-work-amt-num redefines ws-work-amt-alpha
  1172                                 pic 9(8)v99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* EL596.cbl
  1173 01  ws-seq-alpha                pic x(7).
  1174 01  ws-seq-no redefines ws-seq-alpha
  1175                                 pic 9(7).
  1176 01  PGM-SUB                     PIC S999 COMP  VALUE +317.
  1177 01  WS-ABEND-AREA.
  1178     05  WS-ABEND-FILE-STATUS    PIC X(02).
  1179     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
  1180     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
  1181     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
  1182 01  f.
  1183     05  ws-current-key          pic x(33)  value low-values.
  1184     05  ws-check-key            pic x(9).
  1185     05  ws-check-key-num redefines ws-check-key
  1186                                 pic 9(9).
  1187     05  FILLER                      COMP-3.
  1188         10  CT-CURR-LF-PMTS-AMT     PIC S9(9)V99  VALUE +0.
  1189         10  CT-CURR-LF-PMTS-CNT     PIC S9(7)     VALUE +0.
  1190
  1191         10  CT-CURR-LF-PMTS-AMT-BM        PIC S9(9)V99  VALUE +0.
  1192         10  CT-CURR-LF-PMTS-CNT-BM        PIC S9(7)     VALUE +0.
  1193     05  WS-SAVE-PRINT-RECORD        PIC X(133)      VALUE SPACES.
  1194     05  X                           PIC X           VALUE SPACE.
  1195     05  WS-HEADING-SW               PIC S9          VALUE ZERO.
  1196     05  WS-PRINT-SW                 PIC S9          VALUE ZERO.
  1197     05  WS-LINE-COUNT           PIC S9(3)       VALUE +99.
  1198     05  WS-LINE-COUNT-MAX       PIC S9(3)       VALUE +60.
  1199     05  WS-PAGE                 PIC S9(5)       VALUE ZERO.
  1200     05  ws-comp-cd.
  1201         10  filler              pic x  value low-values.
  1202         10  ws-company-cd       pic x.
  1203     05  ws-company-cd-num redefines ws-comp-cd
  1204                                 pic s9(4) comp.
  1205
  1206 01  filler.
  1207     05  ws-vouch-cert-no        pic x(11) value spaces.
  1208     05  ws-vouch-name           pic x(28) value spaces.
  1209     05  ws-work-voucher.
  1210         10  ws-vouch-reason     pic x(4).
  1211         10  ws-vouch-cert-and-name
  1212                                 pic x(26).
  1213
  1214 01  WS-PREV-STATE               PIC XX     VALUE SPACES.
  1215 01  WS-PREV-KEY.
  1216     05  WS-PREV-CARRIER         PIC X      VALUE LOW-VALUES.
  1217     05  WS-PREV-CLAIM-NO        PIC X(7)   VALUE LOW-VALUES.
  1218     05  WS-PREV-CERT-NO         PIC X(11)  VALUE LOW-VALUES.
  1219 01  WS-COMP-KEY.
  1220     05  WS-COMP-CARRIER         PIC X.
  1221     05  WS-COMP-CLAIM-NO        PIC X(7).
  1222     05  WS-COMP-CERT-NO         PIC X(11).
  1223 01  WS-INVOICE-NO.
  1224     05  WS-INVOICE-MM           PIC 99.
  1225     05  WS-INVOICE-DD           PIC 99.
  1226     05  WS-INVOICE-CRT-NO       PIC X(8).
  1227 01  WS-REC-GRP-CD.
  1228     05  WS-REC-GRP-DA           PIC X.
  1229     05  WS-REC-GRP-SEQ-NO       PIC 999    VALUE 000.
  1230
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* EL596.cbl
  1231 EXEC SQL
  1232    BEGIN DECLARE SECTION
  1233 END-EXEC
  1234
  1235 01  svr                         pic x(32).
  1236 01  usr                         pic x(32).
  1237 01  pass                        pic x(32).
  1238 01  usr-pass                    pic x(64).
  1239 01  ws-disp-code                pic s9(11).
  1240 01  ws-begin-dt                 pic x(10).
  1241 01  ws-end-dt                   pic x(10).
  1242 01  ws-compid                   pic xxx.
  1243
  1244***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  1245***                                                            ***
  1246***  These indicators are used to determine if a variable      ***
  1247***  is passed nulls from sql. The indicator will be -1        ***
  1248***  if the value on sql is nulls and +0 if the value is       ***
  1249***  something other than nulls. Here is an example on how     ***
  1250***  to use the indicator variables.                           ***
  1251***                                                            ***
  1252***     EXEC SQL                                               ***
  1253***        fetch checkapp into                                 ***
  1254***           :db-app-status :nu-app-status,                   ***
  1255***           :db-app-by     :nu-app-by,                       ***
  1256***           :db-app-date   :nu-app-date,                     ***
  1257***           :db-app-batch  :nu-app-batch                     ***
  1258***     END-EXEC                                               ***
  1259***                                                            ***
  1260***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  1261
  1262 01  indicator-vaiables-for-nulls.
  1263     05  nu-checkno              pic s9(4) comp value +0.
  1264     05  nu-checkdate            pic s9(4) comp value +0.
  1265     05  nu-checkstatus          pic s9(4) comp value +0.
  1266     05  nu-fincar               pic s9(4) comp value +0.
  1267     05  nu-fingrp               pic s9(4) comp value +0.
  1268     05  nu-finresp              pic s9(4) comp value +0.
  1269     05  nu-finacct              pic s9(4) comp value +0.
  1270     05  nu-app-status           pic s9(4) comp value +0.
  1271     05  nu-app-by               pic s9(4) comp value +0.
  1272     05  nu-app-date             pic s9(4) comp value +0.
  1273     05  nu-app-batch            pic s9(4) comp value +0.
  1274
  1275 01  daily-check-request-rec.
  1276     05  db-checkkey             pic x(9).
  1277     05  db-compid               pic xxx.
  1278     05  db-carrier              pic x.
  1279     05  db-grouping             pic x(6).
  1280     05  db-state                pic xx.
  1281     05  db-account              pic x(10).
  1282     05  db-effdate              pic x(25).
  1283     05  db-certificate          pic x(10).
  1284     05  db-cert-sfx             pic x.
  1285     05  db-seq-no               pic x(7).
  1286     05  db-type                 pic x(7).
  1287     05  db-amount               pic x(10).
  1288     05  db-checkno              pic x(15).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* EL596.cbl
  1289     05  db-checkdate            pic x(25).
  1290     05  db-checkstatus          pic 9(5).
  1291     05  db-releasebatch         pic x(5).
  1292     05  db-releasedt            pic x(25).
  1293     05  db-releaseby            pic x(4).
  1294     05  db-payeename1           pic x(30).
  1295     05  db-payeename2           pic x(30).
  1296     05  db-payeeaddr1           pic x(30).
  1297     05  db-payeeaddr2           pic x(30).
  1298     05  db-payeecity            pic x(30).
  1299     05  db-payeest              pic xx.
  1300     05  db-payeezip             pic x(11).
  1301     05  db-fincar               pic x.
  1302     05  db-fingrp               pic x(6).
  1303     05  db-finresp              pic x(10).
  1304     05  db-finacct              pic x(10).
  1305     05  db-preparer             pic x(4).
  1306     05  db-app-status           pic x(10).
  1307     05  db-app-by               pic x(20).
  1308     05  db-app-date             pic x(25).
  1309     05  db-app-batch            pic x(10).
  1310     05  db-return-to            pic x(30).
  1311
  1312 EXEC SQL
  1313    END DECLARE SECTION
  1314 END-EXEC
  1315
  1316 01  ws-user-seq-no             pic 9(7) value zeros.
  1317 01  ws-user-defined.
  1318     05  ws-user-reason         pic xxx.
  1319     05  ws-user-cert-no        pic x(11).
  1320     05  ws-user-name           pic x(28).
  1321
  1322 01  WS-INT-USER-DEFINED        PIC X(24).
  1323
  1324 01  ws-void-record-out.
  1325     05  vr-bank-code            pic xxx.
  1326     05  vr-check-no             pic x(10).
  1327     05  vr-check-dt             pic x(8).
  1328     05  vr-void-option          pic x.
  1329     05  vr-void-reason          pic x(10).
  1330
* 1331                                 COPY ELCVOCH.
  1332******************************************************************ERCCHEK
  1333*                   C H A N G E   L O G
  1334*
  1335* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1336*-----------------------------------------------------------------
  1337*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1338* EFFECTIVE    NUMBER
  1339*-----------------------------------------------------------------
  1340* 021414    2003053000001  PEMA  changes for auto chk request
  1341******************************************************************
  1342******************************************************************
  1343 01  TRANSACTION-RECORD.
  1344     12  TR-RECORD-ID            PIC X.
  1345         88  VALID-TR-ID             VALUE 'T'.
  1346     12  TR-REC-GRP-CODE         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* EL596.cbl (/apps/prod/cid1p/copy/ELCVOCH)
  1347     12  TR-VENDOR-ID            PIC X(10).
  1348     12  TR-CHECK-TYPE           PIC X.
  1349     12  FILLER                  PIC X(10).
  1350     12  TR-TRAN-TYPE            PIC X.
  1351     12  TR-CSO                  PIC XXX.
  1352     12  FILLER                  PIC XXX.
  1353     12  TR-USER-DEFINED         PIC X(24).
  1354     12  TR-INVOICE-NO           PIC X(12).
  1355     12  FILLER                  PIC X(12).
  1356     12  TR-INVOICE-DATE         PIC X(8).
  1357     12  TR-INVOICE-AMT          PIC 9(8)V99.
  1358     12  TR-INVOICE-AMT-SIGN     PIC X.
  1359     12  TR-NON-DIS-AMT          PIC 9(8)V99.
  1360     12  TR-NON-DIS-AMT-SIGN     PIC X.
  1361     12  TR-TERMS-CODE           PIC XXX.
  1362     12  FILLER                  PIC X(16).
  1363     12  TR-DIS-PCT              PIC 99V99.
  1364     12  TR-DIS-AMT              PIC 9(8)V99.
  1365     12  TR-DIS-AMT-SIGN         PIC X.
  1366     12  TR-JOB-CODE             PIC X(6).
  1367     12  TR-SUNDRY               PIC X(30).
  1368     12  TR-VOUCHER-REF          PIC X(30).
  1369     12  TR-PRE-PMT-BANK-CD      PIC XXX.
  1370     12  TR-PRE-PMT-CHECK-NO     PIC X(10).
  1371     12  TR-PRE-PMT-CHECK-DT     PIC X(8).
  1372     12  FILLER                  PIC X(18).
  1373     12  TR-TAX-PCT              PIC 99V99.
  1374     12  TR-TAX-ADJ              PIC 9(8)V99.
  1375     12  TR-TAX-ADJ-SIGN         PIC X.
  1376     12  TR-TAX-AMT              PIC 9(8)V99.
  1377     12  TR-TAX-AMT-SIGN         PIC X.
  1378     12  FILLER                  PIC X(124).
  1379 01  CHECK-DES-RECORD.
  1380     12  CD-RECORD-ID            PIC X.
  1381         88  VALID-CD-ID             VALUE 'F'.
  1382     12  CD-REC-GRP-CODE         PIC X(4).
  1383     12  CD-VENDOR-ID            PIC X(10).
  1384     12  CD-INVOICE-NO           PIC X(12).
  1385     12  CD-SEQ-NO               PIC 999.
  1386     12  FILLER OCCURS 4.
  1387         16  CD-DESC             PIC X(66).
  1388         16  CD-INVOICE-AMT      PIC 9(8)V99.
  1389         16  CD-INVOICE-AMT-SIGN PIC X.
  1390         16  FILLER              PIC X.
  1391     12  FILLER                  PIC X(58).
  1392 01  DISTRIBUTION-RECORD.
  1393     12  DR-RECORD-ID            PIC X.
  1394         88  VALID-DR-ID             VALUE 'D'.
  1395     12  DR-REC-GRP-CODE         PIC X(4).
  1396     12  DR-VENDOR-ID            PIC X(10).
  1397     12  DR-INVOICE-NO           PIC X(12).
  1398     12  DR-SEQ-NO               PIC 999.
  1399     12  FILLER OCCURS 3.
  1400         16  DR-DIST-TYPE        PIC X.
  1401         16  DR-ACCT-NO          PIC X(22).
  1402         16  DR-ACCT-STATE       PIC XX.
  1403         16  DR-SOURCE           PIC X(6).
  1404         16  DR-AUTH-CODE        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* EL596.cbl (/apps/prod/cid1p/copy/ELCVOCH)
  1405         16  DR-SUSPENSE         PIC X(15).
  1406         16  DR-INVOICE-AMT      PIC 9(8)V99.
  1407         16  DR-INVOICE-AMT-SIGN PIC X.
  1408         16  DR-USE-TAX-AMT      PIC 9(8)V99.
  1409         16  DR-USE-TAX-AMT-SIGN PIC X.
  1410         16  FILLER              PIC X(42).
  1411     12  FILLER                  PIC X(55).
  1412 01  PAYEE-ADDRESS-RECORD.
  1413     12  PR-RECORD-ID            PIC X.
  1414         88  VALID-PR-ID             VALUE 'A'.
  1415     12  PR-REC-GRP-CODE         PIC X(4).
  1416     12  PR-VENDOR-ID            PIC X(10).
  1417     12  PR-INVOICE-NO           PIC X(12).
  1418     12  PR-PAYEE-NAME           PIC X(50).
  1419     12  FILLER OCCURS 4.
  1420         16  PR-ADDRESS          PIC X(50).
  1421     12  FILLER                  PIC X(35).
  1422     12  FILLER                  PIC X(88).
  1423 01  ALPHA-1099-RECORD.
  1424     12  AR-RECORD-ID            PIC X.
  1425         88  VALID-AR-ID             VALUE '1'.
  1426     12  AR-REC-GRP-CODE         PIC X(4).
  1427     12  AR-VENDOR-ID            PIC X(10).
  1428     12  AR-INVOICE-NO           PIC X(12).
  1429     12  AR-CATEGORY             PIC X(4).
  1430     12  AR-TAX-ID-TYPE          PIC X.
  1431     12  AR-TAX-ID-NO            PIC X(9).
  1432     12  FILLER                  PIC X(20).
  1433     12  AR-ACCUM-BY-ACCT        PIC X.
  1434     12  AR-ALPHA-DATA           PIC X(80).
  1435     12  FILLER OCCURS 20.
  1436         16  AR-INVOICE-AMT      PIC 9(8)V99.
  1437         16  AR-INVOICE-AMT-SIGN PIC X.
  1438     12  FILLER                  PIC X(38).
  1439 01  VOUCH-ADDR-1099-RECORD.
  1440     12  VR-RECORD-ID            PIC X.
  1441         88  VALID-VR-ID             VALUE '2'.
  1442     12  VR-REC-GRP-CODE         PIC X(4).
  1443     12  VR-VENDOR-ID            PIC X(10).
  1444     12  VR-INVOICE-NO           PIC X(12).
  1445     12  VR-CATEGORY             PIC X(4).
  1446     12  FILLER OCCURS 2.
  1447         16  VR-VENDOR-NAME      PIC X(40).
  1448     12  FILLER OCCURS 2.
  1449         16  VR-VENDOR-ADDRESS   PIC X(40).
  1450     12  VR-ADDRESS-TYPE         PIC X.
  1451     12  FILLER                  PIC X(208).
  1452
* 1453                                 COPY ELCFUNDT.
  1454***************************************************************** 12/03/98
  1455*                                                               * ELCFUNDT
  1456*                            ELCFUNDT.                          *    LV004
  1457*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  1458*                            VMOD=2.001                         * ELCFUNDT
  1459*                                                               * ELCFUNDT
  1460*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  1461*                                                               * ELCFUNDT
  1462***************************************************************** ELCFUNDT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* EL596.cbl (/apps/prod/cid1p/copy/ELCFUNDT)
  1463                                                                  ELCFUNDT
  1464                                                                  ELCFUNDT
  1465 01  FUNCTION-DATE.                                                  CL**2
  1466     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  1467     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  1468         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  1469         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  1470             15  WS-FN-CC          PIC 99.                           CL**3
  1471             15  WS-FN-YR          PIC 99.                           CL**3
  1472         10  WS-FN-MO              PIC 99.                           CL**3
  1473         10  WS-FN-DA              PIC 99.                           CL**3
  1474     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  1475     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  1476     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  1477     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  1478     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  1479         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  1480         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  1481         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  1482     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  1483     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
  1484
* 1485                                 COPY ELCDTECX.
  1486******************************************************************06/05/98
  1487*                                                                *ELCDTECX
  1488*                            ELCDTECX.                           *   LV005
  1489*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1490*                            VMOD=2.015                          *ELCDTECX
  1491*                                                                *ELCDTECX
  1492*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1493*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1494*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1495*                                                                *ELCDTECX
  1496******************************************************************ELCDTECX
  1497******************************************************************
  1498*                   C H A N G E   L O G
  1499*
  1500* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1501*-----------------------------------------------------------------
  1502*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1503* EFFECTIVE    NUMBER
  1504*-----------------------------------------------------------------
  1505* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1506*                                  BENEFIT CODES FROM 300 TO 900
  1507* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1508* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1509* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1510******************************************************************
  1511 01  DATE-CARD.                                                   ELCDTECX
  1512     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1513     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1514     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1515     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1516     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1517     12  EP-SW                       PIC  X.                      ELCDTECX
  1518         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1519     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1520         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* EL596.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1521     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1522     12  RUN-CENTURY.                                             ELCDTECX
  1523         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1524     12  FILLER                      PIC  X.                         CL**4
  1525     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1526     12  FILLER                      PIC  XXX.                    ELCDTECX
  1527     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1528                                                                  ELCDTECX
  1529 01  FILLER                          PIC  X(7)                       CL**6
  1530                                          VALUE 'OPTIONS'.        ELCDTECX
  1531 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1532     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1533     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1534     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1535         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1536         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1537     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1538     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1539     12  FILLER                      PIC  X.                      ELCDTECX
  1540     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1541     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1542     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1543     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1544     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1545     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1546     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1547     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1548     12  FILLER                      PIC  X.                      ELCDTECX
  1549     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1550     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1551     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1552     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1553     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1554     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1555     12  FILLER                      PIC  X.                      ELCDTECX
  1556     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1557     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1558     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1559     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1560     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1561     12  DTE-R78                     PIC  X.                      ELCDTECX
  1562     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1563     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1564     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1565     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1566     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1567     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1568     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1569                                     PIC  X.                      ELCDTECX
  1570         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1571                                                 ' '.             ELCDTECX
  1572         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1573         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1574     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1575         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1576         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1577     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1578     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* EL596.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1579                                     PIC  9.                         CL**4
  1580     12  DTE-SYSTEM.                                              ELCDTECX
  1581         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1582         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1583         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1584         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1585         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1586         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1587         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1588         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1589         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1590         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1591         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1592         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1593         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1594         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1595         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1596         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1597         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1598         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1599         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1600         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1601         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1602         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1603         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1604         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1605         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1606         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1607     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1608         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1609                                     PIC  X.                      ELCDTECX
  1610     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1611                                                                  ELCDTECX
  1612 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1613     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1614     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1615     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1616*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1617     12  FILLER                      PIC  X.                      ELCDTECX
  1618     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1619     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1620     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1621     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1622     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1623     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1624     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1625                                                                  ELCDTECX
  1626     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1627     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1628     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1629     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1630                                                                  ELCDTECX
  1631     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1632     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1633     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1634     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1635                                                                  ELCDTECX
  1636     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* EL596.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1637     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1638                                                                  ELCDTECX
  1639     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1640     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1641                                                                  ELCDTECX
  1642     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1643                                                                  ELCDTECX
  1644 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1645     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1646     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1647     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1648     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1649     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1650     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1651     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1652                                                                  ELCDTECX
  1653 01  FILLER                          PIC  X(12)                   ELCDTECX
  1654                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1655 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1656     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1657         16  CNT-ID                  PIC  X.                      ELCDTECX
  1658         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1659                                                                  ELCDTECX
  1660 01  FILLER                          PIC  X(11)                   ELCDTECX
  1661                                          VALUE 'STATE NAMES'.    ELCDTECX
  1662 01  STATE-NAMES.                                                 ELCDTECX
  1663     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1664         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1665         16  STATE-PIC1.                                          ELCDTECX
  1666             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1667             20  FILLER              PIC  XXX.                    ELCDTECX
  1668             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1669             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1670             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1671             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1672                                                                  ELCDTECX
  1673 01  FILLER                          PIC  X(13)                   ELCDTECX
  1674                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1675 01  CARRIER-NAMES.                                               ELCDTECX
  1676     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1677         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1678         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1679         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1680         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1681         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1682         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1683*        16  FILLER                  PIC  X.                      ELCDTECX
  1684         16  CARRIER-SEC-PAY         PIC  X.
  1685             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1686                                                                  ELCDTECX
  1687 01  FILLER                          PIC  X(9)                       CL**6
  1688                                          VALUE 'INS TYPES'.      ELCDTECX
  1689 01  CLAS-INS-TYPES.                                              ELCDTECX
  1690*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1691     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1692         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1693         16  CLAS-I-AB3.                                          ELCDTECX
  1694             20  FILLER              PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* EL596.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1695             20  CLAS-I-AB2.                                      ELCDTECX
  1696                 24  FILLER          PIC  X.                      ELCDTECX
  1697                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1698         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1699             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1700             20  FILLER              PIC  X.                         CL**4
  1701         16  CLAS-I-AB10.                                         ELCDTECX
  1702             20  FILLER              PIC  X(9).                   ELCDTECX
  1703             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1704         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1705         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1706         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1707         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1708             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1709         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1710         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1711         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1712         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1713         16  CLAS-I-REFUND-METHOD    PIC  X.
  1714         16  CLAS-I-MAX-BENEFITS     PIC 99.
  1715         16  FILLER                  PIC  XXX.
  1716                                                                  ELCDTECX
  1717 01  FILLER                          PIC  X(16)                   ELCDTECX
  1718                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1719 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1720     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1721                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1722         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1723         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1724         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1725         16  CLAS-MORT-DESC.                                      ELCDTECX
  1726             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1727             20  FILLER              PIC  XX.                        CL**5
  1728             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1729             20  FILLER              PIC  X.                         CL**5
  1730             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1731             20  FILLER              PIC  X.                         CL**5
  1732             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1733             20  FILLER              PIC  X.                         CL**5
  1734             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1735             20  FILLER              PIC  X(5).                      CL**6
  1736                                                                  ELCDTECX
  1737 01  FILLER                          PIC  X(15)                   ELCDTECX
  1738                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1739 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1740     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1741         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1742         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1743         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1744         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1745         16  FILLER                  PIC  X(4).                      CL**6
  1746                                                                  ELCDTECX
  1747 01  FILLER                          PIC  X(7)                       CL**6
  1748                                     VALUE 'INDEXES'.             ELCDTECX
  1749 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1750     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1751     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1752     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* EL596.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1753     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1754     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1755     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1756     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1757     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1758     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1759     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1760     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1761     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1762     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1763     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1764     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1765     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1766     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1767                                                                  ELCDTECX
  1768 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1769     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1770     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1771     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1772     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1773     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1774     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1775     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1776     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1777     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1778     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1779     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1780                                                                  ELCDTECX
  1781 01  FILLER                          PIC  X(13)                   ELCDTECX
  1782                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1783 01  CLAS-MISC.                                                   ELCDTECX
  1784     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1785         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1786         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1787         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1788     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1789     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1790     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1791     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1792     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1793     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1794     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1795     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1796     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1797     12  STATE-L                     PIC  XX.                     ELCDTECX
  1798     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1799     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1800     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1801         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1802         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1803     12  DTE-ABEND-WORK.                                          ELCDTECX
  1804         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1805         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1806                                                                  ELCDTECX
  1807 01  FILLER                          PIC  X(12)                   ELCDTECX
  1808                                     VALUE 'WORKING DATE'.        ELCDTECX
  1809 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1810     12  WS-ACCEPT-DATE.                                          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* EL596.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1811         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1812         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1813         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1814     12  WS-CURRENT-DATE.                                         ELCDTECX
  1815         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1816         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1817         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1818         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1819         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1820     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1821         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1822         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1823                                                                  ELCDTECX
  1824 01  FILLER                          PIC  X(12)                   ELCDTECX
  1825                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1826 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1827     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1828         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1829         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1830         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1831                                                                  ELCDTECX
  1832 01  FILLER                          PIC  X(10)                   ELCDTECX
  1833                                     VALUE 'STATE TLRS'.          ELCDTECX
  1834 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1835     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1836         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1837         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1838                                                                  ELCDTECX
  1839 01  FILLER                          PIC  X(13)                   ELCDTECX
  1840                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1841 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1842     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1843         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1844                                                                  ELCDTECX
  1845 01  FILLER                          PIC  X(13)                   ELCDTECX
  1846                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1847 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1848     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1849     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1850     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1851                                     PIC  X.                         CL**5
  1852     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1853     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1854     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1855     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1856     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1857     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1858     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1859     12  FILLER                      PIC  X(75).                  ELCDTECX
  1860******************************************************************ELCDTECX
  1861*01  MISC-CARR-PCT-DATA.                                          00001521
  1862*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1863*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1864*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1865*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1866*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1867*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1868******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* EL596.cbl
* 1869                                 COPY ELCDTEVR.
  1870***************************************************************** 04/15/98
  1871*                                                                *ELCDTEVR
  1872*                                                                *ELCDTEVR
  1873*                            ELCDTEVR.                           *   LV003
  1874*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1875*                            VMOD=2.001                          *   CL**2
  1876*                                                                *ELCDTEVR
  1877*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1878*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1879*                                                                *ELCDTEVR
  1880******************************************************************ELCDTEVR
  1881 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1882     05  WS-RUN-DATE.                                             ELCDTEVR
  1883         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1884         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1885         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1886             15  RUN-CC              PIC  99.                     ELCDTEVR
  1887             15  RUN-YR              PIC  99.                     ELCDTEVR
  1888         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1889         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1890     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1891            WS-RUN-DATE              PIC 9(11).                      CL**2
  1892     05  WS-EP-DT.                                                ELCDTEVR
  1893         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1894         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1895         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1896             15  EP-CC               PIC  99.                     ELCDTEVR
  1897             15  EP-YR               PIC  99.                     ELCDTEVR
  1898         10  EP-MO                   PIC  99.                     ELCDTEVR
  1899         10  EP-DA                   PIC  99.                     ELCDTEVR
  1900     05  WS-EP-DT-N REDEFINES                                        CL**2
  1901            WS-EP-DT                 PIC 9(11).                      CL**2
  1902     05  WS-DTE-CONV-DT.                                             CL**4
  1903         10  FILLER                  PIC  9(03).                     CL**4
  1904         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1905         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1906             15  DTE-CONV-CC         PIC  99.                        CL**4
  1907             15  DTE-CONV-YR         PIC  99.                        CL**4
  1908         10  DTE-CONV-MO             PIC  99.                        CL**4
  1909         10  DTE-CONV-DA             PIC  99.                        CL**4
  1910     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1911            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1912 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1913     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1914         10  FILLER                            PIC 999.           ELCDTEVR
  1915         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1916         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1917             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1918             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1919         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1920         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1921     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1922            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1923     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1924         10  FILLER                            PIC 999.           ELCDTEVR
  1925         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1926         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* EL596.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1927         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1928         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1929     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1930            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1931 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1932     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1933         10  FILLER                            PIC 999.           ELCDTEVR
  1934         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1935         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1936             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1937             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1938         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1939         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1940     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1941            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1942     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1943         10  FILLER                            PIC 999.           ELCDTEVR
  1944         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1945         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1946             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1947             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1948         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1949         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1950     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1951            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1952     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1953         10  FILLER                            PIC 999.           ELCDTEVR
  1954         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1955         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1956             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1957             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1958         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1959         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1960     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1961            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1962 01  WS-RATE-RECORD.                                              ELCDTEVR
  1963         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1964             10  FILLER                        PIC 999.           ELCDTEVR
  1965             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1966             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1967                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1968                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1969             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1970             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1971         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1972                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* 1973                                 copy ELCDATE.
  1974******************************************************************06/11/98
  1975*                                                                *ELCDATE
  1976*                                                                *ELCDATE
  1977*                            ELCDATE.                            *   LV023
  1978*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1979*                            VMOD=2.003                           ELCDATE
  1980*                                                                *ELCDATE
  1981*                                                                *ELCDATE
  1982*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1983*                 LENGTH = 200                                   *   CL*19
  1984******************************************************************ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  36
* EL596.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1985                                                                  ELCDATE
  1986 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1987     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1988     12  DC-OPTION-CODE                PIC X.                        CL*15
  1989         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1990         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1991         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1992         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1993         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1994         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1995         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1996         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1997         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1998         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1999         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  2000         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  2001         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  2002         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  2003         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  2004         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  2005         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  2006         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  2007         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  2008         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  2009         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  2010         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  2011         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  2012         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  2013         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  2014         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  2015         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  2016         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  2017         88  THREE-CHARACTER-BIN                                  ELCDATE
  2018                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  2019         88  GREGORIAN-TO-BIN                                        CL**2
  2020                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  2021         88  BIN-TO-GREGORIAN                                        CL**2
  2022                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  2023         88  JULIAN-TO-BINARY                                        CL**2
  2024                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  2025     12  DC-ERROR-CODE                 PIC X.                        CL*15
  2026         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  2027         88  DATE-CONVERSION-ERROR                                ELCDATE
  2028                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  2029         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  2030         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  2031         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  2032         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  2033         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  2034         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  2035         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  2036         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  2037         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  2038         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  2039     12  DC-END-OF-MONTH               PIC X.                        CL*15
  2040         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  2041     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  2042         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  37
* EL596.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2043         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  2044         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  2045     12  FILLER                        PIC X.                        CL*15
  2046     12  DC-CONVERSION-DATES.                                        CL*15
  2047         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  2048         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  2049         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  2050         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  2051                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  2052             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  2053             20  SLASH1-1              PIC X.                        CL*15
  2054             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  2055             20  SLASH1-2              PIC X.                        CL*15
  2056             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  2057         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  2058         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  2059                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  2060             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  2061             20  SLASH2-1              PIC X.                        CL*15
  2062             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  2063             20  SLASH2-2              PIC X.                        CL*15
  2064             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  2065         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  2066         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  2067                     DC-GREG-DATE-1-YMD.                          ELCDATE
  2068             20  DC-YMD-YEAR           PIC 99.                       CL*15
  2069             20  DC-YMD-MONTH          PIC 99.                       CL*15
  2070             20  DC-YMD-DAY            PIC 99.                       CL*15
  2071         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  2072         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  2073                      DC-GREG-DATE-1-MDY.                         ELCDATE
  2074             20  DC-MDY-MONTH          PIC 99.                       CL*15
  2075             20  DC-MDY-DAY            PIC 99.                       CL*15
  2076             20  DC-MDY-YEAR           PIC 99.                       CL*15
  2077         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  2078             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  2079             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  2080             20  FILLER                PIC XX.                       CL*15
  2081             20  DC-ALPHA-CENTURY.                                   CL*15
  2082                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  2083             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  2084         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  2085         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  2086         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  2087         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  2088         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  2089                                       PIC 9(05).                    CL*20
  2090         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  2091             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  2092             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  2093         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  2094         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  2095         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  2096     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  2097         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  2098         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  2099             20  FILLER                PIC 9(3).                     CL*15
  2100             20  HOLD-CEN-1-CCYY.                                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  38
* EL596.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2101                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  2102                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  2103             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  2104             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  2105         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  2106             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  2107             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  2108             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  2109                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  2110                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  2111             20  FILLER                PIC 9(3).                     CL*15
  2112         16  HOLD-CENTURY-1-X.                                       CL*15
  2113             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  2114             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  2115                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  2116                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  2117             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  2118             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  2119         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  2120             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  2121             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  2122             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  2123                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  2124                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  2125             20  FILLER                PIC XXX.                      CL*23
  2126         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  2127         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  2128         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  2129         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  2130             20  DC-JULIAN-1-CCYY.                                   CL*15
  2131                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  2132                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  2133             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  2134         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  2135         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  2136             20  DC-JULIAN-2-CCYY.                                   CL*15
  2137                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  2138                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  2139             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  2140         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  2141             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  2142             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  2143             20  DC-EDITA-DAY          PIC 99.                       CL*15
  2144             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  2145             20  DC-EDITA-CCYY.                                      CL*15
  2146                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  2147                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  2148         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  2149             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  2150             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  2151             20  DC-EDITB-DAY          PIC 99.                       CL*15
  2152             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  2153             20  DC-EDITB-CCYY.                                      CL*15
  2154                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  2155                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  2156         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  2157         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  2158                              DC-GREG-DATE-CYMD.                  ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  39
* EL596.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2159             20  DC-CYMD-CEN           PIC 99.                       CL*15
  2160             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  2161             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  2162             20  DC-CYMD-DAY           PIC 99.                       CL*15
  2163         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  2164         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  2165                              DC-GREG-DATE-MDCY.                  ELCDATE
  2166             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  2167             20  DC-MDCY-DAY           PIC 99.                       CL*15
  2168             20  DC-MDCY-CEN           PIC 99.                       CL*15
  2169             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  2170    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  2171        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  2172    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  2173    12  FILLER                         PIC X(28).                    CL*26
  2174
  2175 01  ws-heading1.
  2176     05  filler                  pic x(127)  value '1
  2177-     '                                   DAILY REFUND CHECK REQUE
  2178-     'ST                                            EL596  '.
  2179
  2180 01  ws-heading2.
  2181     05  filler                  pic x(45) value spaces.
  2182     05  WS-H2-CLIENT-NAME       PIC X(75) VALUE SPACES.
  2183     05  WS-H2-DATE              PIC X(8).
  2184
  2185 01  ws-heading3.
  2186     05  filler                  pic x(53) value spaces.
  2187     05  WS-H3-DATE              PIC X(67) VALUE SPACES.
  2188     05  FILLER                  PIC X(5)  VALUE 'PAGE '.
  2189     05  WS-H3-PAGE              PIC ZZ,ZZ9.
  2190
  2191 01  ws-heading4.
  2192     05  filler                  pic x(106)   value '-CAR  GROUP
  2193-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   REL DATE
  2194-        '  REL BY  APPRV DT  APPRV BY   AMOUNT'.
  2195
  2196 01  ws-detail1.
  2197     05  filler                  pic xx value '0 '.
  2198     05  ws-d1-carr              pic x(4).
  2199     05  ws-d1-grp               pic x(7).
  2200     05  ws-d1-state             pic x(4).
  2201     05  ws-d1-account           pic x(12).
  2202     05  ws-d1-eff-dt            pic x(12).
  2203     05  ws-d1-cert-no           pic x(14).
  2204     05  ws-d1-chk-type          pic x(5).
  2205     05  ws-d1-rel-dt            pic x(12).
  2206     05  ws-d1-rel-by            pic x(6).
  2207     05  ws-d1-apprv-dt          pic x(12).
  2208     05  ws-d1-apprv-by          pic x(8).
  2209*    05  ws-d1-chk-amt           pic x(10).
  2210     05  ws-d1-chk-amt           pic $$$,$$9.99.
  2211     05  filler                  pic xx.
  2212     05  ws-d1-message           pic x(20).
  2213
  2214 01  ws-detail2.
  2215     05  filler                  pic x(12) value '    PAYEE - '.
  2216     05  ws-d2-addr-line         pic x(120) value spaces.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  40
* EL596.cbl
  2217
  2218 01  ws-detail3.
  2219     05  filler                  pic x(21) value
  2220        '    VOID INFO - DATE '.
  2221     05  ws-d3-void-dt           pic x(10) value spaces.
  2222     05  filler                  pic x(4)  value ' BY '.
  2223     05  ws-d3-void-by           pic x(4).
  2224     05  filler                  pic x(9)  value '  CHK NO '.
  2225     05  ws-d3-chk-no            pic x(7)  value spaces.
  2226     05  filler                  pic x(11) value '  CHK DATE '.
  2227     05  ws-d3-chk-dt            pic x(10) value spaces.
  2228     05  filler                  pic x(8)  value ' REASON '.
  2229     05  ws-d3-void-reason       pic x(30) value spaces.
  2230
  2231 01  ws-total1.
  2232     05  filler                  pic x(5) value '-    '.
  2233     05  ws-t1-cnt               pic zzzz9  value zeros.
  2234     05  ws-t1-chks              pic x(24)  value spaces.
  2235     05  ws-t1-amount            pic $$,$$$,$$9.99 value zeros.
  2236
  2237 LINKAGE SECTION.
  2238
  2239 01  PARM.
  2240     05  PARM-LENGTH      PIC S9(4)   COMP.
  2241     05  START-DATE       PIC X(8).
  2242     05  END-DATE         PIC X(8).
  2243
  2244 PROCEDURE DIVISION USING PARM.
* 2245                                 COPY ELCDTERX.
  2246******************************************************************04/15/98
  2247*                                                                *ELCDTERX
  2248*                                                                *ELCDTERX
  2249*                            ELCDTERX.                           *   LV002
  2250*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2251*                            VMOD=2.007                          *ELCDTERX
  2252*                                                                *ELCDTERX
  2253*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  2254*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  2255*      = ELCDTEFD)                                               *ELCDTERX
  2256*                                                                *ELCDTERX
  2257******************************************************************ELCDTERX
  2258                                                                  ELCDTERX
  2259     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  2260                                                                  ELCDTERX
  2261     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  2262     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  2263     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  2264                                                                  ELCDTERX
  2265     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  2266                                                                  ELCDTERX
  2267******************************************************************ELCDTERX
  2268*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  2269*          WARNING MESSAGES.                                      ELCDTERX
  2270******************************************************************ELCDTERX
  2271     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  2272         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  2273                                                                  ELCDTERX
  2274     OPEN INPUT DISK-DATE.                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  41
* EL596.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2275                                                                  ELCDTERX
  2276     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  2277                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  2278                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  2279                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  2280                   CLAX-ID           CLAS-MISC                    ELCDTERX
  2281                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  2282                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  2283                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  2284                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  2285                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  2286                                                                  ELCDTERX
  2287     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  2288                                                                  ELCDTERX
  2289     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  2290                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  2291                                                                  ELCDTERX
  2292     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  2293     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  2294     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  2295     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  2296                                                                  ELCDTERX
  2297     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  2298         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  2299     ELSE                                                         ELCDTERX
  2300         ADD +1                 TO CLAS-CN.                       ELCDTERX
  2301                                                                  ELCDTERX
  2302     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  2303         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  2304     ELSE                                                         ELCDTERX
  2305         ADD +1                 TO CLAS-CO.                       ELCDTERX
  2306                                                                  ELCDTERX
  2307 0005-READ--CARD.                                                 ELCDTERX
  2308     READ DISK-DATE                                               ELCDTERX
  2309         AT END CLOSE DISK-DATE                                   ELCDTERX
  2310             GO TO 0060-READ--TEST.                               ELCDTERX
  2311                                                                  ELCDTERX
  2312     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  2313                                                                  ELCDTERX
  2314     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  2315         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  2316         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  2317         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  2318         GO TO 0005-READ--CARD.                                   ELCDTERX
  2319                                                                  ELCDTERX
  2320     IF DD-ID = 'CLAD'                                            ELCDTERX
  2321         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  2322         GO TO 0005-READ--CARD.                                   ELCDTERX
  2323                                                                  ELCDTERX
  2324     IF DD-ID = 'CLAX'                                            ELCDTERX
  2325         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  2326         GO TO 0005-READ--CARD.                                   ELCDTERX
  2327                                                                  ELCDTERX
  2328     IF DD-ID = 'CLAF'                                            ELCDTERX
  2329         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  2330         GO TO 0005-READ--CARD.                                   ELCDTERX
  2331                                                                  ELCDTERX
  2332     IF DD-ID = 'CLAC'                                            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  42
* EL596.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2333         GO TO 0010-READ--CLAC.                                   ELCDTERX
  2334                                                                  ELCDTERX
  2335     IF DD-ID = 'CARR'                                            ELCDTERX
  2336         GO TO 0015-READ--CARR.                                   ELCDTERX
  2337                                                                  ELCDTERX
  2338     IF DD-ID = 'STAT'                                            ELCDTERX
  2339         GO TO 0020-READ--STAT.                                   ELCDTERX
  2340                                                                  ELCDTERX
  2341     IF DD-ID = 'BUSC'                                            ELCDTERX
  2342         GO TO 0025-READ--BUSC.                                   ELCDTERX
  2343                                                                  ELCDTERX
  2344     IF DD-ID = 'MORT'                                            ELCDTERX
  2345         GO TO 0030-READ--MORT.                                   ELCDTERX
  2346                                                                  ELCDTERX
  2347     IF DD-ID = 'CLAI'                                            ELCDTERX
  2348         GO TO 0040-READ--CLAI.                                   ELCDTERX
  2349                                                                  ELCDTERX
  2350     IF DD-ID = 'COLC'                                            ELCDTERX
  2351         GO TO 0065-READ--COLC.                                   ELCDTERX
  2352                                                                  ELCDTERX
  2353     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2354        DD-IDA = 'CL'                                             ELCDTERX
  2355         GO TO 0035-READ--CLXX.                                   ELCDTERX
  2356                                                                  ELCDTERX
  2357     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2358        DD-IDA = 'PO'                                             ELCDTERX
  2359         GO TO 0050-READ--POXX.                                   ELCDTERX
  2360                                                                  ELCDTERX
  2361     IF DD-ID = 'OPCA'                                            ELCDTERX
  2362         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2363                                                                  ELCDTERX
  2364     IF DD-ID = 'OPST'                                            ELCDTERX
  2365         GO TO 0072-READ--OPST.                                   ELCDTERX
  2366                                                                  ELCDTERX
  2367     IF DD-ID = 'OPBS'                                            ELCDTERX
  2368         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2369                                                                  ELCDTERX
  2370     IF DD-ID = 'OPMS'                                            ELCDTERX
  2371         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2372                                                                  ELCDTERX
  2373     GO TO 0005-READ--CARD.                                       ELCDTERX
  2374                                                                  ELCDTERX
  2375 0010-READ--CLAC.                                                 ELCDTERX
  2376     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2377     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2378     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2379     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2380     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2381     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2382     GO TO 0005-READ--CARD.                                       ELCDTERX
  2383                                                                  ELCDTERX
  2384 0015-READ--CARR.                                                 ELCDTERX
  2385     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2386     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2387        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2388        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2389        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2390        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  43
* EL596.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2391        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2392        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2393        MOVE DD-CARR1-SECPAY-SW
  2394                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2395     END-IF
  2396                                                                  ELCDTERX
  2397     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2398     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2399        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2400        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2401        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2402        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2403        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2404        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2405        MOVE DD-CARR2-SECPAY-SW
  2406                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2407     END-IF
  2408                                                                  ELCDTERX
  2409                                                                  ELCDTERX
  2410     GO TO 0005-READ--CARD.                                       ELCDTERX
  2411                                                                  ELCDTERX
  2412 0020-READ--STAT.                                                 ELCDTERX
  2413     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2414     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2415        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2416         GO TO 0005-READ--CARD.                                   ELCDTERX
  2417                                                                  ELCDTERX
  2418     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2419     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2420     GO TO 0020-READ--STAT.                                       ELCDTERX
  2421                                                                  ELCDTERX
  2422 0025-READ--BUSC.                                                 ELCDTERX
  2423     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2424     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2425        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2426         GO TO 0005-READ--CARD.                                   ELCDTERX
  2427                                                                  ELCDTERX
  2428     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2429     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2430     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2431                                                                  ELCDTERX
  2432 0030-READ--MORT.                                                 ELCDTERX
  2433     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2434     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2435        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2436         GO TO 0005-READ--CARD.                                   ELCDTERX
  2437                                                                  ELCDTERX
  2438     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2439     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2440     GO TO 0030-READ--MORT.                                       ELCDTERX
  2441                                                                  ELCDTERX
  2442 0035-READ--CLXX.                                                 ELCDTERX
  2443     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2444          GO TO 0005-READ--CARD.                                  ELCDTERX
  2445                                                                  ELCDTERX
  2446     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2447         DISPLAY '***********************************************'ELCDTERX
  2448         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  44
* EL596.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2449         DISPLAY '***********************************************'ELCDTERX
  2450         GO TO 0055-READ--STOP.                                   ELCDTERX
  2451                                                                  ELCDTERX
  2452     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2453        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2454         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2455                                                                  ELCDTERX
  2456     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2457        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2458         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2459                                                                  ELCDTERX
  2460*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2461     GO TO 0005-READ--CARD.                                       ELCDTERX
  2462                                                                  ELCDTERX
  2463 0040-READ--CLAI.                                                 ELCDTERX
  2464     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2465     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2466        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2467         GO TO 0005-READ--CARD.                                   ELCDTERX
  2468                                                                  ELCDTERX
  2469     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2470     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2471     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2472                                                                  ELCDTERX
  2473 0045-READ--DUMP.                                                 ELCDTERX
  2474     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2475     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2476                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2477     PERFORM ABEND-PGM.                                           ELCDTERX
  2478                                                                  ELCDTERX
  2479 0050-READ--POXX.                                                 ELCDTERX
  2480     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2481         GO TO 0005-READ--CARD.                                   ELCDTERX
  2482                                                                  ELCDTERX
  2483     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2484         DISPLAY '***********************************************'ELCDTERX
  2485         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2486         DISPLAY '***********************************************'ELCDTERX
  2487         GO TO 0055-READ--STOP.                                   ELCDTERX
  2488                                                                  ELCDTERX
  2489     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2490     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2491     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2492     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2493                                                                  ELCDTERX
  2494     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2495         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2496     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2497         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2498                                                                  ELCDTERX
  2499     GO TO 0005-READ--CARD.                                       ELCDTERX
  2500                                                                  ELCDTERX
  2501 0055-READ--STOP.                                                 ELCDTERX
  2502     GOBACK.                                                      ELCDTERX
  2503                                                                  ELCDTERX
  2504 0060-READ--TEST.                                                 ELCDTERX
  2505     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2506        CLAX-ID         = SPACE  OR                               ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  45
* EL596.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2507        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2508         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2509                                                                  ELCDTERX
  2510     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2511     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2512                                                                  ELCDTERX
  2513 0065-READ--COLC.                                                 ELCDTERX
  2514     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2515     GO TO 0005-READ--CARD.                                       ELCDTERX
  2516                                                                  ELCDTERX
  2517 0070-READ--OPCA.                                                 ELCDTERX
  2518                                                                  ELCDTERX
  2519     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2520                                                                  ELCDTERX
  2521     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2522             OR                                                   ELCDTERX
  2523         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2524         GO TO 0005-READ--CARD.                                   ELCDTERX
  2525                                                                  ELCDTERX
  2526     ADD 1                       TO INDEXCA.                      ELCDTERX
  2527     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2528                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2529     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2530                                                                  ELCDTERX
  2531 0072-READ--OPST.                                                 ELCDTERX
  2532                                                                  ELCDTERX
  2533     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2534                                                                  ELCDTERX
  2535     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2536             OR                                                   ELCDTERX
  2537         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2538         GO TO 0005-READ--CARD.                                   ELCDTERX
  2539                                                                  ELCDTERX
  2540     ADD 1                       TO INDEXST.                      ELCDTERX
  2541     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2542                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2543     GO TO 0072-READ--OPST.                                       ELCDTERX
  2544                                                                  ELCDTERX
  2545 0074-READ--OPBS.                                                 ELCDTERX
  2546                                                                  ELCDTERX
  2547     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2548                                                                  ELCDTERX
  2549     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2550             OR                                                   ELCDTERX
  2551         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2552         GO TO 0005-READ--CARD.                                   ELCDTERX
  2553                                                                  ELCDTERX
  2554     ADD 1                       TO INDEXBS.                      ELCDTERX
  2555     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2556     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2557                                                                  ELCDTERX
  2558 0079-READ--EXIT.                                                 ELCDTERX
  2559*    EXIT.                                                        ELCDTERX
  2560******************************************************************ELCDTERX
  2561
  2562 0000-begin.
  2563
  2564     display ' Begin Program '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  46
* EL596.cbl
  2565     perform 0010-init           thru 0010-exit
  2566     perform 0020-connect        thru 0020-exit
  2567
  2568     EXEC SQL
  2569        SET AUTOCOMMIT OFF
  2570     END-EXEC
  2571
  2572     perform 0025-open-files     thru 0025-exit
  2573     perform 0030-open-cursor    thru 0030-exit
  2574     perform 0040-process-input  thru 0040-exit until
  2575        end-of-input
  2576*      or ws-recs-in > 10000
  2577
  2578     perform 0080-finish-up      thru 0080-exit
  2579     perform 0100-process-voids  thru 0100-exit
  2580     perform 0120-print-totals   thru 0120-exit
  2581     perform 0090-close-files    thru 0090-exit
  2582
  2583     display ' End Program '
  2584     display ' records inserted    ' ws-recs-out
  2585     display ' table records read  ' ws-recs-in
  2586     goback
  2587
  2588     .
  2589 0010-init.
  2590
  2591     move dte-client             to ws-compid
  2592     MOVE start-date             TO DC-GREG-DATE-CYMD
  2593     MOVE 'L'                    TO DC-OPTION-CODE
  2594     MOVE +0                     TO DC-ELAPSED-MONTHS
  2595                                    DC-ELAPSED-DAYS
  2596     PERFORM 0800-date-convert   thru 0800-exit
  2597     if no-conversion-error
  2598        move dc-greg-date-a-edit to ws-begin-dt
  2599        move dc-bin-date-1       to ws-bin-start-dt
  2600     else
  2601        display ' Begin date invalid ' start-date
  2602           ' ' dc-error-code
  2603        perform abend-pgm
  2604     end-if
  2605
  2606     MOVE end-date               TO DC-GREG-DATE-CYMD
  2607     MOVE 'L'                    TO DC-OPTION-CODE
  2608     MOVE +0                     TO DC-ELAPSED-MONTHS
  2609                                    DC-ELAPSED-DAYS
  2610     PERFORM 0800-date-convert   thru 0800-exit
  2611     if no-conversion-error
  2612        move dc-greg-date-a-edit to ws-end-dt
  2613        move dc-bin-date-1       to ws-bin-end-dt
  2614     else
  2615        display ' End date invalid ' end-date
  2616           ' ' dc-error-code
  2617        perform abend-pgm
  2618     end-if
  2619
  2620     move 'NTCSO2_ChkApprv'      to svr
  2621     move 'sa'                   to usr
  2622     move 'ntcso2'               to pass
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  47
* EL596.cbl
  2623
  2624*    move 'NTSQLTST2'            to svr
  2625*    move 'sa'                   to usr
  2626*    move 'sql2008r2'            to pass
  2627
  2628     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2629     DISPLAY ' WS-FN-DATE ' WS-FN-DATE
  2630     MOVE WS-FN-DATE             TO DC-GREG-DATE-CYMD
  2631     MOVE 'L'                    TO DC-OPTION-CODE
  2632     PERFORM 0800-DATE-CONVERT   THRU 0800-EXIT
  2633     IF NO-CONVERSION-ERROR
  2634        move dc-greg-date-1-alpha to ws-h3-date
  2635        MOVE DC-BIN-DATE-1       TO WS-CURRENT-BIN-DT
  2636        DISPLAY ' DAY OF WEEK = ' DC-DAY-OF-WEEK
  2637        MOVE +1                  TO DC-ELAPSED-DAYS
  2638        IF DC-DAY-OF-WEEK = 6
  2639           ADD +2                TO DC-ELAPSED-DAYS
  2640        ELSE
  2641           IF DC-DAY-OF-WEEK = 7
  2642              ADD +1             TO DC-ELAPSED-DAYS
  2643           END-IF
  2644        END-IF
  2645        DISPLAY ' ELAPSED DAYS ' DC-ELAPSED-DAYS
  2646        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
  2647        MOVE '6'                 TO DC-OPTION-CODE
  2648        PERFORM 0800-DATE-CONVERT THRU 0800-EXIT
  2649        IF NO-CONVERSION-ERROR
  2650           MOVE DC-BIN-DATE-2    TO WS-NEXT-CYCLE-BIN-DATE
  2651        ELSE
  2652           DISPLAY ' PROBLEMS CONVERTING NEXT DATE '
  2653           PERFORM ABEND-PGM
  2654        END-IF
  2655     ELSE
  2656        DISPLAY 'BAD CURRENT DATE ' WS-FN-DATE
  2657        PERFORM ABEND-PGM
  2658     END-IF
  2659
  2660     MOVE SPACES                 TO TRANSACTION-RECORD
  2661                                    CHECK-DES-RECORD
  2662                                    DISTRIBUTION-RECORD
  2663                                    PAYEE-ADDRESS-RECORD
  2664
  2665     MOVE 'T'                    TO TR-RECORD-ID
  2666     MOVE 'F'                    TO CD-RECORD-ID
  2667     MOVE 'D'                    TO DR-RECORD-ID
  2668     MOVE 'A'                    TO PR-RECORD-ID
  2669     MOVE WS-FN-DA (2:1)         TO WS-REC-GRP-DA
  2670     if dte-client = 'CID'
  2671        MOVE 'CIDMISCVEN'           TO TR-VENDOR-ID
  2672                                    CD-VENDOR-ID
  2673                                    DR-VENDOR-ID
  2674                                    PR-VENDOR-ID
  2675     else
  2676        MOVE 'MISVEN'               TO TR-VENDOR-ID
  2677                                    CD-VENDOR-ID
  2678                                    DR-VENDOR-ID
  2679                                    PR-VENDOR-ID
  2680     end-if
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  48
* EL596.cbl
  2681
  2682     MOVE 'P'                    TO TR-CHECK-TYPE
  2683     MOVE 'R'                    TO TR-TRAN-TYPE
  2684     IF DTE-CLIENT = 'AHL'
  2685         MOVE 'AHL'              TO TR-CSO
  2686     ELSE
  2687         MOVE 'CSO'              TO TR-CSO
  2688     END-IF
  2689
  2690     STRING WS-FN-MO WS-FN-DA WS-FN-CCYR DELIMITED BY SIZE
  2691        INTO TR-INVOICE-DATE
  2692     END-STRING
  2693
  2694     MOVE 'IMM'                  TO TR-TERMS-CODE
  2695     MOVE 001                    TO CD-SEQ-NO
  2696                                    DR-SEQ-NO
  2697     MOVE 'E'                    TO DR-DIST-TYPE (1)
  2698     MOVE 'AP'                   TO DR-SOURCE (1)
  2699     MOVE 'S'                    TO DR-SUSPENSE (1) (1:1)
  2700     MOVE ZEROS                  TO TR-NON-DIS-AMT
  2701                                    TR-DIS-PCT
  2702                                    TR-DIS-AMT
  2703                                    TR-TAX-PCT
  2704                                    TR-TAX-ADJ
  2705                                    TR-TAX-AMT
  2706                                    DR-USE-TAX-AMT (1)
  2707
  2708     MOVE '+'                    TO TR-NON-DIS-AMT-SIGN
  2709                                    TR-DIS-AMT-SIGN
  2710                                    TR-TAX-ADJ-SIGN
  2711                                    TR-TAX-AMT-SIGN
  2712                                    DR-USE-TAX-AMT-SIGN (1)
  2713
  2714     MOVE TRANSACTION-RECORD     TO WS-TRANSACTION-RECORD
  2715     MOVE CHECK-DES-RECORD       TO WS-CHECK-DES-RECORD
  2716     MOVE DISTRIBUTION-RECORD    TO WS-DISTRIBUTION-RECORD
  2717     MOVE PAYEE-ADDRESS-RECORD   TO WS-PAYEE-ADDRESS-RECORD
  2718
  2719     MOVE +99                    TO WS-LINE-COUNT
  2720
  2721     MOVE WS-CURRENT-DATE        TO WS-H2-DATE
  2722     MOVE COMPANY-NAME           TO WS-H2-CLIENT-NAME
  2723
  2724     .
  2725 0010-exit.
  2726     exit.
  2727
  2728 0020-connect.
  2729
  2730     display 'Begin connect to DB '
  2731     string
  2732         usr delimited space
  2733         "." delimited size
  2734         pass delimited space into usr-pass
  2735     end-string
  2736
  2737*    display ' svr usr pass ' svr ' ' usr-pass
  2738
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  49
* EL596.cbl
  2739     EXEC SQL
  2740        CONNECT TO :svr USER :usr-pass
  2741     END-EXEC
  2742
  2743     if sqlcode not = 0
  2744        display "Error: cannot connect "
  2745        display sqlcode
  2746        display sqlerrmc
  2747        perform abend-pgm
  2748     end-if
  2749
  2750     display " connect to DB successful "
  2751
  2752     .
  2753 0020-exit.
  2754     exit.
  2755
  2756 0025-open-files.
  2757
  2758     open i-o erchek
  2759*    open input erchek
  2760     if erchek-file-status not = '00'
  2761        display ' error-open-erchek ' erchek-file-status
  2762        perform abend-pgm
  2763     end-if
  2764
  2765     open i-o erpyaj
  2766*    open input erpyaj
  2767     if erpyaj-file-status not = '00'
  2768        display ' error-open-erpyaj ' erpyaj-file-status
  2769        perform abend-pgm
  2770     end-if
  2771
  2772     open i-o erpndb
  2773*    open input erpndb
  2774     if erpndb-file-status not = '00'
  2775        display ' error-open-erpndb ' erpndb-file-status
  2776        perform abend-pgm
  2777     end-if
  2778
  2779     open output prntr
  2780                 free-file-NRM FREE-FILE-MAN
  2781
  2782     .
  2783 0025-exit.
  2784     exit.
  2785
  2786 0030-open-cursor.
  2787
  2788*    display ' declare cursor ' ws-begin-dt ' ' ws-end-dt
  2789
  2790***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2791***                                                            ***
  2792***  The dates on the sql table have values in the time        ***
  2793***  so I convert it to a string and just use mm/dd/yyyy       ***
  2794***  to perform the comparison.                                ***
  2795***                                                            ***
  2796***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  50
* EL596.cbl
  2797
  2798     EXEC SQL
  2799        DECLARE
  2800           checkapp cursor for
  2801        SELECT
  2802           CheckKey,
  2803           Company,
  2804           CertCarrier,
  2805           CertGroup,
  2806           CertState,
  2807           CertAccount,
  2808           CertEffDate,
  2809           CertNumber,
  2810           CertNumberSuf,
  2811           CheckSeqNbr,
  2812           CheckType,
  2813           CheckAmount,
  2814           CheckNumber,
  2815           CheckDate,
  2816           CheckStatus,
  2817           ReleaseBatchNbr,
  2818           ReleaseDate,
  2819           ReleasedBy,
  2820           PayeeName1,
  2821           PayeeName2,
  2822           PayeeAddress1,
  2823           PayeeAddress2,
  2824           PayeeCity,
  2825           PayeeState,
  2826           PayeeZIP,
  2827           CompCarrier,
  2828           CompGroup,
  2829           CompFinResp,
  2830           CompAccount,
  2831           Preparer,
  2832           ApprovalStatus,
  2833           MaintainedBy,
  2834           MaintainedDate,
  2835           ApprovalBatch,
  2836           ReturnTo
  2837        FROM
  2838           ChkApp_Check
  2839        WHERE
  2840           Company = :ws-compid
  2841                      and
  2842           CheckType = '1'
  2843                      and
  2844           convert(varchar(10), MaintainedDate, 101)
  2845                               > :ws-begin-dt
  2846                      and
  2847           convert(varchar(10), MaintainedDate, 101)
  2848                               <= :ws-end-dt
  2849                      and
  2850           (ApprovalStatus = '1'
  2851            or ApprovalStatus = '3'
  2852            or ApprovalStatus = '5')
  2853     END-EXEC
  2854
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  51
* EL596.cbl
  2855     if sqlcode not = 0
  2856        display "Error: cannot declare cursor "
  2857        display ' sql retrun code ' sqlcode
  2858        display ' sql err mess    ' sqlerrmc
  2859        perform 0085-disconnect  thru 0085-exit
  2860        perform abend-pgm
  2861     end-if
  2862
  2863     EXEC SQL
  2864        open checkapp
  2865     END-EXEC
  2866
  2867     if sqlcode not = 0
  2868        display "Error: cannot open cursor "
  2869        display ' sql retrun code ' sqlcode
  2870        display ' sql err mess    ' sqlerrmc
  2871        perform 0085-disconnect  thru 0085-exit
  2872        perform abend-pgm
  2873     end-if
  2874
  2875     .
  2876 0030-exit.
  2877     exit.
  2878
  2879 0040-process-input.
  2880
  2881     perform until sqlcode not = 0
  2882        EXEC SQL
  2883           fetch checkapp into
  2884              :db-checkkey,
  2885              :db-compid,
  2886              :db-carrier,
  2887              :db-grouping,
  2888              :db-state,
  2889              :db-account,
  2890              :db-effdate,
  2891              :db-certificate,
  2892              :db-cert-sfx,
  2893              :db-seq-no,
  2894              :db-type,
  2895              :db-amount,
  2896              :db-checkno :nu-checkno,
  2897              :db-checkdate :nu-checkdate,
  2898              :db-checkstatus :nu-checkstatus,
  2899              :db-releasebatch,
  2900              :db-releasedt,
  2901              :db-releaseby,
  2902              :db-payeename1,
  2903              :db-payeename2,
  2904              :db-payeeaddr1,
  2905              :db-payeeaddr2,
  2906              :db-payeecity,
  2907              :db-payeest,
  2908              :db-payeezip,
  2909              :db-fincar :nu-fincar,
  2910              :db-fingrp :nu-fingrp,
  2911              :db-finresp :nu-finresp,
  2912              :db-finacct :nu-finacct,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  52
* EL596.cbl
  2913              :db-preparer,
  2914              :db-app-status :nu-app-status,
  2915              :db-app-by :nu-app-by,
  2916              :db-app-date :nu-app-date,
  2917              :db-app-batch :nu-app-batch,
  2918              :db-return-to
  2919        END-EXEC
  2920
  2921        if sqlcode not = 0 and 100
  2922           display "Error: cannot read row " ws-recs-in
  2923           display ' sql return code ' sqlcode
  2924           display ' sql err mess    ' sqlerrmc
  2925           perform 0085-disconnect  thru 0085-exit
  2926           perform abend-pgm
  2927        end-if
  2928
  2929        if (sqlcode = 0)
  2930           and (nu-checkstatus = -1)
  2931           add 1                 to ws-recs-in
  2932           perform 0045-process-record
  2933                                 thru 0045-exit
  2934        end-if
  2935     end-perform
  2936
  2937     if sqlcode = 100
  2938        display ' Normal end of record set '
  2939        display ' number of records        ' ws-recs-in
  2940     end-if
  2941
  2942     set end-of-input            to true
  2943
  2944     EXEC SQL
  2945         close checkapp
  2946     END-EXEC
  2947
  2948     if sqlcode not = 0
  2949        display "Error: cannot close cursor "
  2950        display ' sql retrun code ' sqlcode
  2951        display ' sql err mess    ' sqlerrmc
  2952        perform 0085-disconnect  thru 0085-exit
  2953     end-if
  2954
  2955     .
  2956 0040-exit.
  2957     exit.
  2958
  2959 0045-process-record.
  2960
  2961***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2962***                                                            ***
  2963***  First, read erchek.                                       ***
  2964***   If not found - report and go to next record.             ***
  2965***   If found - create g/l records, update sql table with     ***
  2966***     check status, update erchek rec with approval data,    ***
  2967***     write print line and create erpyaj record.             ***
  2968***                                                            ***
  2969***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2970
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  53
* EL596.cbl
  2971     move dte-clasic-company-cd  to ch-company-cd
  2972     move db-carrier             to ch-carrier
  2973     move db-grouping            to ch-grouping
  2974     move db-state               to ch-state
  2975     move db-account             to ch-account
  2976     move db-certificate         to ch-cert-prime
  2977     move db-cert-sfx            to ch-cert-sfx
  2978
  2979     string db-effdate (1:4)
  2980            db-effdate (6:2)
  2981            db-effdate (9:2)
  2982        delimited by size into dc-greg-date-cymd-r
  2983     end-string
  2984     move 'L'                    to dc-option-code
  2985     perform 0800-date-convert   thru 0800-exit
  2986     if no-conversion-error
  2987        move dc-bin-date-1       to ch-cert-eff-dt
  2988     else
  2989        display ' error cvtdte eff dt ' db-effdate ' '
  2990           dc-error-code
  2991     end-if
  2992     move zeros                  to ws-seq-alpha
  2993     move +7                     to s2
  2994     perform varying s1 from +7 by -1 until s1 < +1
  2995        if db-seq-no (s1:1) numeric
  2996           move db-seq-no (s1:1) to ws-seq-alpha (s2:1)
  2997           subtract +1 from s2
  2998        end-if
  2999     end-perform
  3000
  3001     move ws-seq-no              to ch-sequence-no
  3002     move ' '                    to ws-erchek-sw
  3003
  3004*    display ' dte   **' db-effdate '**'
  3005*    display ' carrier ' ch-carrier
  3006*    display ' group   ' ch-grouping
  3007*    display ' state   ' ch-state
  3008*    display ' acct    ' ch-account
  3009*    display ' cert  **' ch-cert-no '**'
  3010*    display ' seq     ' ch-sequence-no
  3011     read erchek
  3012
  3013     if erchek-file-status = '00'
  3014        move spaces              to ws-d1-message
  3015        set erchek-found to true
  3016        if db-app-status = '1' or '5'
  3017           perform 0300-g-l-processing
  3018                                 thru 0300-exit
  3019           perform 0050-update-table
  3020                                 thru 0050-exit
  3021        end-if
  3022        if db-app-status = '1' or '3' or '5'
  3023           perform 0055-update-erchek
  3024                                 thru 0055-exit
  3025           move '**  D E N I E D   **'
  3026                                 to ws-d1-message
  3027        end-if
  3028        if db-app-status = '1' or '5'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  54
* EL596.cbl
  3029           perform 0500-BUILD-ERPYAJ-RECORD
  3030                                 thru 0500-exit
  3031           move 'I N T E R F A C E D '
  3032                                 to ws-d1-message
  3033        end-if
  3034     else
  3035        move '**ERROR** NOT FOUND '
  3036                                 to ws-d1-message
  3037     end-if
  3038
  3039     perform 0200-create-rpt     thru 0200-exit
  3040
  3041     .
  3042 0045-EXIT.
  3043     EXIT.
  3044
  3045 0050-update-table.
  3046
  3047*    go to 0050-exit
  3048
  3049     move 001                    to db-checkstatus
  3050
  3051     EXEC SQL
  3052        UPDATE
  3053           ChkApp_Check
  3054        SET
  3055           CheckStatus = :db-checkstatus
  3056        WHERE
  3057           CheckKey = :db-checkkey
  3058     END-EXEC
  3059
  3060     if sqlcode not = 0
  3061        display "Error: cannot update table   "
  3062        display ' sql retrun code ' sqlcode
  3063        display ' sql err mess    ' sqlerrmc
  3064        perform 0085-disconnect  thru 0085-exit
  3065        perform abend-pgm
  3066     end-if
  3067
  3068     .
  3069 0050-exit.
  3070     exit.
  3071
  3072 0055-update-erchek.
  3073
  3074     move ' '                    to ws-check-pndb-file
  3075     move +0                     to ws-good-checks
  3076     if db-app-status = '3'
  3077        move 'D'                 to ch-approval-status
  3078        set check-pndb-file      to true
  3079        move ch-control-primary  to ws-current-key
  3080     else
  3081        move 'A'                 to ch-approval-status
  3082     end-if
  3083
  3084     move function UPPER-CASE(db-app-by)
  3085                                 to ch-approved-by
  3086
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  55
* EL596.cbl
  3087     string db-app-date (1:4)
  3088            db-app-date (6:2)
  3089            db-app-date (9:2)
  3090        delimited by size into dc-greg-date-cymd-r
  3091     end-string
  3092     move 'L'                    to dc-option-code
  3093     PERFORM 0800-date-convert   thru 0800-exit
  3094     if no-conversion-error
  3095        move dc-bin-date-1       to ch-approval-dt
  3096     else
  3097        move WS-CURRENT-BIN-DT   to ch-approval-dt
  3098        display ' apprv date invalid ' db-app-date
  3099           ' ' dc-error-code
  3100     end-if
  3101*    move '00'                   to erchek-file-status
  3102     rewrite check-records
  3103     if erchek-file-status not = '00'
  3104        display ' error-erchek-rewrite ' erchek-file-status ' '
  3105           ch-cert-no ' ' db-checkkey
  3106        perform 0085-disconnect  thru 0085-exit
  3107        perform abend-pgm
  3108     end-if
  3109
  3110     if check-pndb-file
  3111        perform 0060-browse-erchek
  3112                                 thru 0060-exit
  3113        if ws-good-checks = zeros
  3114           perform 0070-update-erpndb
  3115                                 thru 0070-exit
  3116        end-if
  3117     end-if
  3118
  3119     .
  3120 0055-exit.
  3121     exit.
  3122
  3123 0060-browse-erchek.
  3124
  3125     move ws-current-key         to ch-control-primary
  3126     move +0                     to ch-sequence-no
  3127     start erchek key >= ch-control-primary
  3128     if erchek-file-status not = '00'
  3129        display ' error-erchek-start ' erchek-file-status
  3130           ' ' ws-current-key (2:19) ws-current-key (23:11)
  3131        perform 0085-disconnect  thru 0085-exit
  3132        go to abend-pgm
  3133     end-if
  3134
  3135     .
  3136 0060-read-next.
  3137
  3138     read erchek next record
  3139     if (erchek-file-status = '10' or '23')
  3140        or (ch-company-cd not = dte-clasic-company-cd)
  3141        go to 0060-exit
  3142     else
  3143        if erchek-file-status not = '00'
  3144           display ' error-erchek-readnext ' erchek-file-status
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  56
* EL596.cbl
  3145              ' ' ws-current-key (2:19) ws-current-key (23:11)
  3146           perform 0085-disconnect  thru 0085-exit
  3147           go to abend-pgm
  3148        end-if
  3149     end-if
  3150
  3151     if ch-control-primary (1:33) not = ws-current-key
  3152        go to 0060-exit
  3153     end-if
  3154
  3155     if (ch-amount-paid > zeros)
  3156        and (ch-void-dt not = low-values)
  3157        and (ch-approval-status not = 'D')
  3158        add +1 to ws-good-checks
  3159     end-if
  3160
  3161     go to 0060-read-next
  3162
  3163     .
  3164 0060-exit.
  3165     exit.
  3166
  3167 0070-update-erpndb.
  3168
  3169     move ws-current-key         to pb-control-by-account
  3170     move +0                     to pb-alt-chg-seq-no
  3171     move '2'                    to pb-record-type
  3172     read erpndb
  3173     if erpndb-file-status = '00'
  3174        move ' '                 to pb-c-refund-sw
  3175*       move '00'                to erpndb-file-status
  3176        rewrite pending-business
  3177        if erpndb-file-status not = '00'
  3178           display ' error-erpndb-rewrite ' erpndb-file-status
  3179              ' ' ws-current-key (2:19) ws-current-key (23:11)
  3180           perform 0085-disconnect  thru 0085-exit
  3181           go to abend-pgm
  3182        end-if
  3183     end-if
  3184
  3185     .
  3186 0070-exit.
  3187     exit.
  3188
  3189 0080-finish-up.
  3190
  3191     display ' Begin Disconnect '
  3192     EXEC SQL
  3193         commit work release
  3194     END-EXEC
  3195     if sqlcode not = 0
  3196        display "Error: commit release "
  3197        display ' sql return code ' sqlcode
  3198        display ' sql err mess    ' sqlerrmc
  3199     end-if
  3200
  3201     .
  3202 0080-exit.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  57
* EL596.cbl
  3203     exit.
  3204
  3205 0085-disconnect.
  3206
  3207     display ' Begin Disconnect '
  3208     EXEC SQL
  3209         DISCONNECT ALL
  3210     END-EXEC
  3211
  3212     if sqlcode not = 0
  3213        display "Error: on disconnect  "
  3214        display ' sql return code ' sqlcode
  3215        display ' sql err mess    ' sqlerrmc
  3216     end-if
  3217
  3218     .
  3219 0085-exit.
  3220     exit.
  3221
  3222 0090-close-files.
  3223
  3224     close erpyaj
  3225           erpndb
  3226           erchek
  3227           prntr
  3228           free-file-nrm
  3229           free-file-man
  3230           free-file-void
  3231
  3232     .
  3233 0090-exit.
  3234     exit.
  3235
  3236 0100-process-voids.
  3237
  3238     open output free-file-void
  3239     move dte-clasic-company-cd  to ch-control-primary
  3240     start erchek key >= ch-control-primary
  3241     if (erchek-file-status = '10' or '23')
  3242        or (ch-company-cd not = dte-clasic-company-cd)
  3243        set end-of-erchek to true
  3244        go to 0100-exit
  3245     else
  3246        if erchek-file-status not = '00'
  3247           display ' error erchek start ' erchek-file-status
  3248           go to abend-pgm
  3249        end-if
  3250     end-if
  3251
  3252         .
  3253 0100-find-voids.
  3254
  3255     read erchek next record
  3256     if (erchek-file-status = '10' or '23')
  3257        or (ch-company-cd not = dte-clasic-company-cd)
  3258        set end-of-erchek to true
  3259     else
  3260        if erchek-file-status not = '00'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  58
* EL596.cbl
  3261           display ' error erchek readnext ' erchek-file-status
  3262           go to abend-pgm
  3263        end-if
  3264     end-if
  3265
  3266     if end-of-erchek
  3267        go to 0100-exit
  3268     end-if
  3269
  3270*    if ch-void-dt not = low-values
  3271     if (ch-void-dt > ws-bin-start-dt)
  3272        and (ch-void-dt <= ws-bin-end-dt)
  3273        perform 0110-create-void-int
  3274                                 thru 0110-exit
  3275     end-if
  3276
  3277     go to 0100-find-voids
  3278
  3279     .
  3280 0100-exit.
  3281     exit.
  3282
  3283 0110-create-void-int.
  3284
  3285     move spaces                 to ws-void-record-out
  3286     if dte-client = 'CID'
  3287        move 'SNB'               to vr-bank-code
  3288     else
  3289        move 'FNB'               to vr-bank-code
  3290     end-if
  3291     move '000'                  to vr-check-no (1:3)
  3292     move ch-check-no            to vr-check-no (4:7)
  3293     move 'X'                    to vr-void-option
  3294*    move ch-void-reason         to vr-void-reason
  3295
  3296     move ch-check-written-dt    to dc-bin-date-1
  3297     move ' '                    to dc-option-code
  3298     PERFORM 0800-DATE-CONVERT   THRU 0800-EXIT
  3299     IF NO-CONVERSION-ERROR
  3300        string dc-edita-month
  3301               dc-edita-day
  3302               dc-edita-ccyy
  3303           delimited by size into vr-check-dt
  3304        end-string
  3305     end-if
  3306
  3307     write FREE-VOIDS-RECORD from ws-void-record-out
  3308
  3309     perform 0115-void-report    thru 0115-exit
  3310
  3311     .
  3312 0110-exit.
  3313     exit.
  3314
  3315 0115-void-report.
  3316
  3317     move ch-carrier             to ws-d1-carr
  3318     move ch-grouping            to ws-d1-grp
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  59
* EL596.cbl
  3319     move ch-state               to ws-d1-state
  3320     move ch-account             to ws-d1-account
  3321
  3322     move ch-cert-eff-dt         to dc-bin-date-1
  3323     move ' '                    to dc-option-code
  3324     PERFORM 0800-DATE-CONVERT   THRU 0800-EXIT
  3325     IF NO-CONVERSION-ERROR
  3326        move dc-greg-date-a-edit to ws-d1-eff-dt
  3327     end-if
  3328
  3329     move ch-cert-no             to ws-d1-cert-no
  3330
  3331     move 'REF'                  to ws-d1-chk-type
  3332     move ch-approval-dt         to dc-bin-date-1
  3333     move ' '                    to dc-option-code
  3334     PERFORM 0800-DATE-CONVERT   THRU 0800-EXIT
  3335     IF NO-CONVERSION-ERROR
  3336        move dc-greg-date-a-edit to ws-d1-apprv-dt
  3337     end-if
  3338     move ch-approved-by         to ws-d1-apprv-by
  3339     move ch-amount-paid         to ws-d1-chk-amt
  3340
  3341     move '**    V O I D     **'
  3342                                 to ws-d1-message
  3343
  3344     MOVE WS-DETAIL1             TO PRT
  3345     perform write-a-line
  3346     move spaces                 to ws-d2-addr-line
  3347     string ch-payee-name-1  '  ' ch-payee-name-2   '  '
  3348         ch-payee-address-1  '  ' ch-payee-address-2   '  '
  3349         ch-payee-city       '  ' ch-payee-state      '  '
  3350         ch-payee-zip
  3351        delimited by '   ' into ws-d2-addr-line
  3352     end-string
  3353     MOVE WS-DETAIL2             TO PRT
  3354     perform write-a-line
  3355
  3356
  3357     move ch-void-dt             to dc-bin-date-1
  3358     move ' '                    to dc-option-code
  3359     PERFORM 0800-DATE-CONVERT   THRU 0800-EXIT
  3360     IF NO-CONVERSION-ERROR
  3361        move dc-greg-date-a-edit to ws-d3-void-dt
  3362     end-if
  3363
  3364     move ch-void-by             to ws-d3-void-by
  3365     move ch-check-no            to ws-d3-chk-no
  3366
  3367     move ch-check-written-dt    to dc-bin-date-1
  3368     move ' '                    to dc-option-code
  3369     PERFORM 0800-DATE-CONVERT   THRU 0800-EXIT
  3370     IF NO-CONVERSION-ERROR
  3371        move dc-greg-date-a-edit to ws-d3-chk-dt
  3372     end-if
  3373     move ch-void-reason         to ws-d3-void-reason
  3374
  3375     MOVE WS-DETAIL3             TO PRT
  3376     perform write-a-line
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  60
* EL596.cbl
  3377
  3378     compute ws-total-cnt-voids =
  3379        ws-total-cnt-voids + 1
  3380
  3381     compute ws-total-voids =
  3382        ws-total-voids + ch-amount-paid
  3383
  3384     .
  3385 0115-exit.
  3386     exit.
  3387
  3388 0120-print-totals.
  3389
  3390     move ws-total-cnt-nrm       to ws-t1-cnt
  3391     move ' Standard Checks, Total '
  3392                                 to ws-t1-chks
  3393     move ws-total-paid-nrm      to ws-t1-amount
  3394     MOVE WS-total1              TO PRT
  3395     perform write-a-line
  3396
  3397     move spaces                 to ws-total1
  3398     move ws-total-cnt-man       to ws-t1-cnt
  3399     move ' Manual   Checks, Total '
  3400                                 to ws-t1-chks
  3401     move ws-total-paid-man      to ws-t1-amount
  3402     MOVE WS-total1              TO PRT
  3403     perform write-a-line
  3404
  3405     move spaces                 to ws-total1
  3406     compute ws-t1-cnt = ws-total-cnt-nrm + ws-total-cnt-man
  3407     move ' Total    Checks, Total '
  3408                                 to ws-t1-chks
  3409     compute ws-t1-amount =
  3410        ws-total-paid-nrm + ws-total-paid-man
  3411     MOVE WS-total1              TO PRT
  3412     perform write-a-line
  3413
  3414     move spaces                 to ws-total1
  3415     move ws-total-cnt-voids     to ws-t1-cnt
  3416     move ' Total    Voids,  Total '
  3417                                 to ws-t1-chks
  3418     move ws-total-voids         to ws-t1-amount
  3419     MOVE WS-total1              TO PRT
  3420     perform write-a-line
  3421
  3422     .
  3423 0120-exit.
  3424     exit.
  3425
  3426 0200-create-rpt.
  3427
  3428     move db-carrier             to ws-d1-carr
  3429     move db-grouping            to ws-d1-grp
  3430     move db-state               to ws-d1-state
  3431     move db-account             to ws-d1-account
  3432
  3433     string db-effdate (6:2)     '/'
  3434            db-effdate (9:2)     '/'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  61
* EL596.cbl
  3435            db-effdate (1:4)     '  '
  3436        delimited by size into ws-d1-eff-dt
  3437     end-string
  3438
  3439     string db-certificate db-cert-sfx
  3440        delimited by size into ws-d1-cert-no
  3441     end-string
  3442
  3443     move 'REF'                  to ws-d1-chk-type
  3444     string db-releasedt (6:2)     '/'
  3445            db-releasedt (9:2)     '/'
  3446            db-releasedt (1:4)     '  '
  3447        delimited by size into ws-d1-rel-dt
  3448     end-string
  3449
  3450     move db-releaseby           to ws-d1-rel-by
  3451
  3452     string db-app-date (6:2)     '/'
  3453            db-app-date (9:2)     '/'
  3454            db-app-date (1:4)     '  '
  3455        delimited by size into ws-d1-apprv-dt
  3456     end-string
  3457     move db-app-by              to ws-d1-apprv-by
  3458     move +10                    to s2
  3459     move zeros                  to ws-work-amt-alpha
  3460     perform varying s1 from +10 by -1 until s1 < +1
  3461        if db-amount (s1:1) numeric
  3462           move db-amount (s1:1) to ws-work-amt-alpha (s2:1)
  3463           subtract +1 from s2
  3464        end-if
  3465     end-perform
  3466     if erchek-found
  3467        if db-app-status = '1'
  3468           compute ws-total-cnt-nrm =
  3469              ws-total-cnt-nrm + 1
  3470           compute ws-total-paid-nrm =
  3471              ws-total-paid-nrm + ws-work-amt-num
  3472        else
  3473           if db-app-status = '5'
  3474              compute ws-total-cnt-man =
  3475                 ws-total-cnt-man + 1
  3476              compute ws-total-paid-man =
  3477                 ws-total-paid-man + ws-work-amt-num
  3478           end-if
  3479        end-if
  3480     end-if
  3481     move ws-work-amt-num        to ws-d1-chk-amt
  3482*    move db-amount              to ws-d1-chk-amt
  3483     MOVE WS-DETAIL1             TO PRT
  3484     perform write-a-line
  3485     move spaces                 to ws-d2-addr-line
  3486     string db-payeename1   '  ' db-payeename2   '  '
  3487         db-payeeaddr1      '  ' db-payeeaddr2   '  '
  3488         db-payeecity       '  ' db-payeest      '  '
  3489         db-payeezip
  3490        delimited by '   ' into ws-d2-addr-line
  3491     end-string
  3492     MOVE WS-DETAIL2             TO PRT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  62
* EL596.cbl
  3493     perform write-a-line
  3494
  3495     .
  3496 0200-exit.
  3497     exit.
  3498
  3499 0300-G-L-PROCESSING.
  3500
  3501***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3502***                                                            ***
  3503***  Keep in mind we may have to combine records if there      ***
  3504***  are 2+ checks going to the same person for the same       ***
  3505***  certificate number.                                       ***
  3506***                                                            ***
  3507***  if there is a break in the key                            ***
  3508***     perform 0400-create-freedom thru 0400-exit             ***
  3509***     move new key to prev key                               ***
  3510***  end-if                                                    ***
  3511***                                                            ***
  3512***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3513
  3514     MOVE WS-FN-MO               TO WS-INVOICE-MM
  3515     MOVE WS-FN-DA               TO WS-INVOICE-DD
  3516     MOVE ch-cert-no (4:8)       TO WS-INVOICE-CRT-NO
  3517     move '00'                   to dr-acct-state (1)
  3518
  3519     MOVE WS-INVOICE-NO          TO TR-INVOICE-NO
  3520                                    CD-INVOICE-NO
  3521                                    DR-INVOICE-NO
  3522                                    PR-INVOICE-NO
  3523
  3524     COMPUTE WS-PMT-AMT = WS-PMT-AMT + ch-amount-paid
  3525     MOVE WS-PMT-AMT             TO TR-INVOICE-AMT
  3526                                    CD-INVOICE-AMT (1)
  3527                                    DR-INVOICE-AMT (1)
  3528
  3529
  3530     IF WS-PMT-AMT < ZEROS
  3531        MOVE '-'                 TO TR-INVOICE-AMT-SIGN
  3532                                    CD-INVOICE-AMT-SIGN (1)
  3533                                    DR-INVOICE-AMT-SIGN (1)
  3534                                    DR-INVOICE-AMT-SIGN (2)
  3535     ELSE
  3536        MOVE '+'                 TO TR-INVOICE-AMT-SIGN
  3537                                    CD-INVOICE-AMT-SIGN (1)
  3538                                    DR-INVOICE-AMT-SIGN (1)
  3539     END-IF
  3540
  3541     move ch-stub-line-1         to tr-sundry
  3542
  3543     move 'REF '                 to ws-work-voucher
  3544     move ch-cert-no             to ws-vouch-cert-no
  3545     inspect ws-vouch-cert-no replacing leading zeros
  3546        by spaces
  3547
  3548     perform varying s1 from +1 by +1 until
  3549        (s1 > +11)
  3550        or (ws-vouch-cert-no (s1:1)) <> ' '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  63
* EL596.cbl
  3551     end-perform
  3552
  3553     inspect ch-insured-name
  3554        replacing all low-values by spaces
  3555     move ch-insured-name        to ws-vouch-name
  3556
  3557     string ws-vouch-cert-no (s1:11 - s1 + 1) ' '
  3558            ws-vouch-name
  3559        delimited by size into ws-vouch-cert-and-name
  3560     end-string
  3561
  3562     move ws-work-voucher        to tr-voucher-ref
  3563
  3564     move zeros                  to ws-check-key
  3565     move +9                     to s2
  3566
  3567     perform varying s1 from +9 by -1 until s1 < +1
  3568        if db-checkkey (s1:1) numeric
  3569           move db-checkkey (s1:1) to ws-check-key (s2:1)
  3570           subtract +1 from s2
  3571        end-if
  3572     end-perform
  3573
  3574     move ws-check-key-num       to ws-user-seq-no
  3575
  3576     if ch-return-to (1:4) = spaces
  3577        move 'ENC '              to ch-return-to
  3578     end-if
  3579
  3580     string ch-comp-fin-resp    ' '
  3581            ch-return-to (1:4)  ' '
  3582            ws-user-seq-no
  3583        delimited by size into tr-user-defined
  3584     end-string
  3585
  3586     STRING ' INSURED : ' ch-insured-name
  3587        DELIMITED BY SIZE INTO CD-DESC (1)
  3588     END-STRING
  3589
  3590     MOVE ch-payee-name-1        TO PR-PAYEE-NAME
  3591
  3592     MOVE ch-payee-address-1     TO PR-ADDRESS (1)
  3593
  3594     MOVE ch-payee-address-2     TO PR-ADDRESS (2)
  3595     MOVE SPACES                 TO PR-ADDRESS (3)
  3596     STRING ch-payee-city ' ' ch-payee-state ' '
  3597        ch-payee-zip-code
  3598        DELIMITED BY '  ' INTO PR-ADDRESS (3)
  3599     END-STRING
  3600     MOVE SPACES                 TO PR-ADDRESS (4)
  3601     IF PR-PAYEE-NAME = SPACES
  3602        MOVE ch-payee-name-2     TO PR-PAYEE-NAME
  3603     END-IF
  3604     IF PR-ADDRESS (2) = SPACES
  3605        MOVE PR-ADDRESS (3)      TO PR-ADDRESS (2)
  3606        MOVE SPACES              TO PR-ADDRESS (3)
  3607     END-IF
  3608
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  64
* EL596.cbl
  3609     MOVE '777777777'            TO DR-SUSPENSE (1) (2:9)
  3610
  3611     perform 0400-create-freedom thru 0400-exit
  3612
  3613     .
  3614 0300-EXIT.
  3615     EXIT.
  3616 0400-CREATE-FREEDOM.
  3617
  3618     display ' made it to 0400 '
  3619     ADD 1                       TO WS-REC-GRP-SEQ-NO
  3620     MOVE WS-REC-GRP-CD          TO TR-REC-GRP-CODE
  3621                                    CD-REC-GRP-CODE
  3622                                    DR-REC-GRP-CODE
  3623                                    PR-REC-GRP-CODE
  3624
  3625     if db-app-status = '5'
  3626        WRITE FREE-MAN-RECORD FROM TRANSACTION-RECORD
  3627     else
  3628        WRITE FREE-NRM-RECORD FROM TRANSACTION-RECORD
  3629     end-if
  3630
  3631***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3632***                                                            ***
  3633***  Dist type of E is for Expense                             ***
  3634***  Dist type of P is for Payables and the acct # is checking ***
  3635***  account number.                                           ***
  3636***                                                            ***
  3637***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3638
  3639
  3640     MOVE 'E'                    TO DR-DIST-TYPE (1)
  3641     if dte-client = 'AHL'
  3642        MOVE '1825011300A10000000000'
  3643                                 TO DR-ACCT-NO (1)
  3644     else
  3645        MOVE '1825011300020000000000'
  3646                                 TO DR-ACCT-NO (1)
  3647     end-if
  3648     move ch-comp-fin-resp       to dr-suspense (1)
  3649     if db-app-status = '5'
  3650        WRITE FREE-MAN-RECORD FROM DISTRIBUTION-RECORD
  3651     else
  3652        WRITE FREE-NRM-RECORD FROM DISTRIBUTION-RECORD
  3653     end-if
  3654
  3655     MOVE 'P'                    TO DR-DIST-TYPE (1)
  3656     if dte-client = 'AHL'
  3657        MOVE '1108121010000000000000'
  3658                                 TO DR-ACCT-NO (1)
  3659     else
  3660        MOVE '1108124700000000000000'
  3661                                 TO DR-ACCT-NO (1)
  3662     end-if
  3663     MOVE '00'                   TO DR-ACCT-STATE (1)
  3664     MOVE SPACES                 TO DR-SUSPENSE (1)
  3665     if db-app-status = '5'
  3666        WRITE FREE-MAN-RECORD FROM DISTRIBUTION-RECORD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  65
* EL596.cbl
  3667     else
  3668        WRITE FREE-NRM-RECORD FROM DISTRIBUTION-RECORD
  3669     end-if
  3670
  3671     if db-app-status = '5'
  3672        WRITE FREE-MAN-RECORD FROM PAYEE-ADDRESS-RECORD
  3673     else
  3674        WRITE FREE-NRM-RECORD FROM PAYEE-ADDRESS-RECORD
  3675     end-if
  3676
  3677     MOVE WS-TRANSACTION-RECORD  TO TRANSACTION-RECORD
  3678     MOVE WS-CHECK-DES-RECORD    TO CHECK-DES-RECORD
  3679     MOVE WS-DISTRIBUTION-RECORD TO DISTRIBUTION-RECORD
  3680     MOVE WS-PAYEE-ADDRESS-RECORD
  3681                                 TO PAYEE-ADDRESS-RECORD
  3682
  3683     ADD +1                      TO CT-CURR-LF-PMTS-CNT
  3684     ADD WS-PMT-AMT              TO CT-CURR-LF-PMTS-AMT
  3685
  3686     display ' about to write a line '
  3687
  3688     MOVE +0                     TO WS-PMT-AMT
  3689     MOVE ' '                    TO WS-VOID-SW
  3690
  3691     .
  3692 0400-EXIT.
  3693     EXIT.
  3694
  3695 0500-BUILD-ERPYAJ-RECORD.
  3696
  3697     MOVE SPACES                 TO PENDING-PAY-ADJ
  3698     MOVE 'PY'                   TO PY-RECORD-ID
  3699     MOVE ch-company-cd          TO PY-COMPANY-CD
  3700     move ch-comp-carrier        to py-carrier
  3701     move ch-comp-grouping       to py-grouping
  3702     move ch-comp-fin-resp       to py-fin-resp
  3703     move ch-comp-account        to py-account
  3704     move +0                     to py-file-seq-no
  3705
  3706     move 'C'                    to py-record-type
  3707     MOVE CH-AMOUNT-PAID         TO PY-ENTRY-AMT
  3708     move '1825011300'           to py-gl-account
  3709     move 'REFUND CHK'           TO py-gl-comment
  3710     MOVE ch-released-by         TO PY-LAST-MAINT-BY
  3711     MOVE 181000                 TO PY-LAST-MAINT-HHMMSS
  3712*    MOVE WS-NEXT-CYCLE-BIN-DATE TO PY-LAST-MAINT-DT
  3713*                                   PY-INPUT-DT
  3714     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
  3715                                    PY-INPUT-DT
  3716     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  3717                                    PY-REPORTED-DT
  3718                                    PY-CHECK-WRITTEN-DT
  3719                                    PY-BILLED-DATE
  3720                                    PY-AR-DATE
  3721                                    PY-GL-DATE
  3722     MOVE clasic-credit-eom-dt   TO PY-CREDIT-SELECT-DT
  3723     MOVE 'R'                    TO PY-CHECK-ORIGIN-SW
  3724
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  66
* EL596.cbl
  3725     .
  3726 0500-write-rec.
  3727
  3728     add +1 to py-file-seq-no
  3729*    move '00'                   to erpyaj-file-status
  3730     write pending-pay-adj
  3731     if erpyaj-file-status = '22'
  3732        go to 0500-write-rec
  3733     else
  3734        if erpyaj-file-status not = '00'
  3735           display ' error-erpyaj-write ' erpyaj-file-status
  3736           perform abend-pgm
  3737        end-if
  3738     end-if
  3739
  3740     .
  3741 0500-EXIT.
  3742     EXIT.
  3743
  3744 0800-DATE-CONVERT.
  3745
  3746     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
  3747
  3748 0800-exit.
  3749     EXIT.
  3750
  3751 WRITE-A-LINE SECTION.
*                                    COPY ELCWAL.
  3752***************************************************************** 04/16/98
  3753*                                                               * ELCWAL
  3754*                                                               * ELCWAL
  3755*                            ELCWAL.                            *    LV002
  3756*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3757*                            VMOD=2.002                         *    CL**2
  3758*                                                               * ELCWAL
  3759* THIS SECTION CONTROLS THE PAGE HEADINGS AND PRINTER WRITES.   * ELCWAL
  3760***************************************************************** ELCWAL
  3761 WAL-010.                                                         ELCWAL
  3762     IF WS-LINE-COUNT GREATER WS-LINE-COUNT-MAX                   ELCWAL
  3763         PERFORM WRITE-HEADINGS.                                  ELCWAL
  3764                                                                  ELCWAL
  3765     IF P-CTL = '1'                                               ELCWAL
  3766         MOVE +1  TO  WS-LINE-COUNT                               ELCWAL
  3767       ELSE                                                       ELCWAL
  3768         IF P-CTL = ' '                                           ELCWAL
  3769             ADD +1  TO  WS-LINE-COUNT                            ELCWAL
  3770           ELSE                                                   ELCWAL
  3771             IF P-CTL = '0'                                       ELCWAL
  3772                 ADD +2  TO  WS-LINE-COUNT                        ELCWAL
  3773               ELSE                                               ELCWAL
  3774                 ADD +3  TO  WS-LINE-COUNT.                       ELCWAL
  3775                                                                  ELCWAL
  3776     PERFORM WRITE-PRINTER.                                       ELCWAL
  3777                                                                  ELCWAL
  3778 WAL-EXIT.                                                        ELCWAL
  3779     EXIT.                                                        ELCWAL
  3780
  3781 WRITE-HEADINGS SECTION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  67
* EL596.cbl
  3782 WHS-010.
  3783     display ' made it to whs 010 '
  3784
  3785     ADD +1  TO  WS-PAGE.
  3786     MOVE WS-PAGE                TO WS-H3-PAGE
  3787     MOVE PRT                    TO WS-SAVE-PRINT-RECORD
  3788     MOVE ZERO                   TO WS-LINE-COUNT
  3789
  3790     MOVE WS-HEADING1            TO PRT
  3791     MOVE '1'                    TO X
  3792     PERFORM WRITE-PRINTER
  3793
  3794     MOVE WS-HEADING2            TO PRT
  3795     MOVE ' '                    TO X
  3796     PERFORM WRITE-PRINTER
  3797
  3798     MOVE WS-HEADING3            TO PRT
  3799     MOVE ' '                    TO X
  3800     PERFORM WRITE-PRINTER
  3801
  3802     MOVE WS-HEADING4            TO PRT
  3803     MOVE ' '                    TO X
  3804     PERFORM WRITE-PRINTER
  3805
  3806     MOVE +6                     TO WS-LINE-COUNT
  3807
  3808     .
  3809 WHS-020.
*               COPY ELCWHS2.
  3810***************************************************************** 04/19/98
  3811*                                                               * ELCWHS2
  3812*                            ELCWHS2.                           *    LV004
  3813*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  3814*                            VMOD=2.002                         *    CL**4
  3815*****************************************************************.ELCWHS2
  3816*                                                               * ELCWHS2
  3817     MOVE WS-SAVE-PRINT-RECORD   TO  PRT.                         ELCWHS2
  3818     MOVE '-'                    TO  P-CTL.                          CL**3
  3819                                                                  ELCWHS2
  3820 WHS-EXIT.                                                        ELCWHS2
  3821     EXIT.                                                        ELCWHS2
  3822                                                                  ELCWHS2
  3823
  3824 WRITE-PRINTER SECTION.
*                             COPY ELCWPS.
  3825***************************************************************** 04/19/98
  3826*                                                               * ELCWPS
  3827*                            ELCWPS.                            *    LV002
  3828*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3829*                            VMOD=2.002                         *    CL**2
  3830*                                                               * ELCWPS
  3831*   THIS SECTION CONTROLS THE WRITES TO THE PRINTER.            * ELCWPS
  3832*****************************************************************.ELCWPS
  3833*                                                               * ELCWPS
  3834 WPS-010.                                                         ELCWPS
  3835     MOVE P-CTL                  TO  X.                           ELCWPS
  3836                                                                  ELCWPS
  3837
  3838 WPS-020.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  68
* EL596.cbl
*               COPY ELCPRT2.
  3839******************************************************************04/15/98
  3840*                                                                *ELCPRT2
  3841*                                                                *ELCPRT2
  3842*                            ELCPRT2                             *   LV005
  3843*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  3844*                            VMOD=2.002                          *   CL**5
  3845*                                                                *   CL**4
  3846******************************************************************   CL**4
  3847                                                                     CL**4
  3848     IF DTE-FICH NOT = SPACE AND                                     CL**4
  3849        FICH-OPEN    = SPACE                                         CL**4
  3850         MOVE 'X'                TO  FICH-OPEN                       CL**4
  3851         OPEN OUTPUT FICH.                                           CL**4
  3852                                                                     CL**4
  3853     IF DTE-FICH NOT = SPACE                                         CL**4
  3854         MOVE X                  TO  P-CTL                           CL**4
  3855         WRITE FICH-REC FROM PRT.                                    CL**4
  3856                                                                     CL**4
  3857     IF DTE-FICH = SPACE OR '2'                                      CL**4
  3858       MOVE X                    TO  P-CTL                           CL**4
  3859       IF P-CTL = ' '                                                CL**4
  3860         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  3861       ELSE                                                          CL**4
  3862         IF P-CTL = '0'                                              CL**4
  3863           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  3864         ELSE                                                        CL**4
  3865           IF P-CTL = '-'                                            CL**4
  3866             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  3867           ELSE                                                      CL**4
  3868             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  3869                                                                     CL**4
  3870******************************************************************   CL**4
  3871
  3872 abend-pgm section.
  3873
  3874     call 'ABORTME'
  3875     goback.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      124932     Code:       21098
