* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page   1
* EL517.cbl
* Options: int("EL517.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL517.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL517.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL517.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL517 .
     5*              PROGRAM CONVERTED BY
     6*              COBOL CONVERSION AID PO 5785-ABJ
     7*              CONVERSION DATE 06/08/94 08:12:06.
     8*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     9*                            VMOD=2.040.
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page   2
* EL517.cbl
    14*DATE-COMPILED.
    15
    16*SECURITY.   *****************************************************
    17*            *                                                   *
    18*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    19*            *                                                   *
    20*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    21*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    22*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    23*            *                                                   *
    24*            *****************************************************
    25
    26*REMARKS.
    27*          THIS PROGRAM IS THE BATCH EDIT ROUTINE
    28*          FOR THE ON-LINE CREDIT SYSTEM PENDING BUSINESS
    29******************************************************************
    30*                   C H A N G E   L O G
    31*
    32* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    33*-----------------------------------------------------------------
    34*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    35* EFFECTIVE    NUMBER
    36*-----------------------------------------------------------------
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38* 062904    2001061800003  PEMA  ADD CLM TYPE I AND G
    39* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    40*                                IS OPEN OR CNC DT < PD THRU
    41*                                ALSO ADD ALTERNATE KEY CLAUSE
    42* 111204    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    43* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    44* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    45* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    46* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
    47* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFUND
    48* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    49* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    50* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    51* 061412  CR2011022800001  AJRA  NAPERSOFT
    52* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    53* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    54* 101112  CR2011022800001  AJRA  FIX CERT PEND CANCEL ERROR MSG
    55* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    56* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    57******************************************************************
    58
    59 ENVIRONMENT DIVISION.
    60
    61 INPUT-OUTPUT SECTION.
    62
    63 FILE-CONTROL.
    64
    65     SELECT DISK-DATE        ASSIGN TO SYS019-UT-3380-S-SYS019.
    66
    67     SELECT ELCNTL           ASSIGN TO SYS021-3380-ELCNTL
    68                             ORGANIZATION IS INDEXED
    69                             ACCESS IS DYNAMIC
    70                             RECORD KEY IS CF-CONTROL-PRIMARY
    71                             FILE STATUS IS ELCNTL-FILE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page   3
* EL517.cbl
    72
    73     SELECT ERPNDB           ASSIGN TO SYS022-3380-ERPNDB
    74                             ORGANIZATION IS INDEXED
    75                             ACCESS IS SEQUENTIAL
    76                             RECORD KEY IS PB-CONTROL-PRIMARY
    77                             ALTERNATE RECORD KEY IS
    78                                 PB-CONTROL-BY-ACCOUNT
    79                             FILE STATUS IS ERPNDB-FILE-STATUS.
    80
    81     SELECT ERREIN           ASSIGN TO SYS022-3380-ERREIN
    82                             ORGANIZATION IS INDEXED
    83                             ACCESS IS DYNAMIC
    84                             RECORD KEY IS RE-CONTROL-PRIMARY
    85                             FILE STATUS IS ERREIN-FILE-STATUS.
    86
    87     SELECT ELCERT
*                                  COPY ELCCERTS.
    88******************************************************************04/15/98
    89*                                                                *ELCCERTS
    90*                            ELCCERTS.                           *   LV002
    91*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    92*                            VMOD=2.001                          *ELCCERTS
    93*                                                                *ELCCERTS
    94*           SELECT STATEMENT FOR THE CERTIFICATE MASTER          *ELCCERTS
    95*                                                                *ELCCERTS
    96*  NO  CID  MODS  TO  COPYBOOK  ELCCERTS                         *ELCCERTS
    97******************************************************************ELCCERTS
    98                                                                  ELCCERTS
    99         ASSIGN TO SYS022-3380-ELCERT                             ELCCERTS
   100         ORGANIZATION IS INDEXED                                  ELCCERTS
   101         ACCESS IS DYNAMIC                                        ELCCERTS
   102         RECORD KEY IS CM-CONTROL-PRIMARY                         ELCCERTS
   103         FILE STATUS IS ELCERT-FILE-STATUS.                       ELCCERTS
   104                                                                  ELCCERTS
   105
   106     SELECT ELMSTR           ASSIGN TO SYS023-3380-ELMSTR5
   107                             ORGANIZATION IS INDEXED
   108                             ACCESS IS DYNAMIC
   109                             RECORD KEY IS CL-CONTROL-BY-CERT-NO
   110                             FILE STATUS IS ELMSTR-FILE-STATUS.
   111
   112     SELECT ERCTBL           ASSIGN TO SYS022-3380-ERCTBL
   113                             ORGANIZATION IS INDEXED
   114                             ACCESS IS DYNAMIC
   115                             RECORD KEY IS CT-CONTROL-PRIMARY
   116                             FILE STATUS IS ERCTBL-FILE-STATUS.
   117
   118     SELECT ERACCT           ASSIGN TO SYS022-3380-ERACCT2
   119                             ORGANIZATION IS INDEXED
   120                             ACCESS IS DYNAMIC
   121                             RECORD KEY IS AM-CONTROL-BY-VAR-GRP
   122                             FILE STATUS IS ERACCT-FILE-STATUS.
   123
   124     SELECT ELCERR           ASSIGN TO SYS022-3380-ELERRS
   125                             ORGANIZATION IS INDEXED
   126                             ACCESS IS DYNAMIC
   127                             RECORD KEY IS EM-CONTROL-PRIMARY
   128                             FILE STATUS IS ELCERR-FILE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page   4
* EL517.cbl
   129
   130     SELECT ERPNDM           ASSIGN TO SYS022-3380-ERPNDM
   131                             ORGANIZATION IS INDEXED
   132                             ACCESS IS DYNAMIC
   133                             RECORD KEY IS PM-CONTROL-PRIMARY
   134                             FILE STATUS IS ERPNDM-FILE-STATUS.
   135
   136     SELECT ERMAIL           ASSIGN TO SYS022-3380-ERMAIL
   137                             ORGANIZATION IS INDEXED
   138                             ACCESS IS DYNAMIC
   139                             RECORD KEY IS MA-CONTROL-PRIMARY
   140                             FILE STATUS IS ERMAIL-FILE-STATUS.
   141
   142     SELECT ERPLAN           ASSIGN TO SYS022-3380-ERPLAN
   143                             ORGANIZATION IS INDEXED
   144                             ACCESS IS DYNAMIC
   145                             RECORD KEY IS PL-CONTROL-PRIMARY
   146                             FILE STATUS IS ERPLAN-FILE-STATUS.
   147
   148     SELECT ERFORM           ASSIGN TO SYS022-3380-ERFORM
   149                             ORGANIZATION IS INDEXED
   150                             ACCESS IS DYNAMIC
   151                             RECORD KEY IS FO-CONTROL-PRIMARY
   152                             FILE STATUS IS ERFORM-FILE-STATUS.
   153
   154     SELECT PRINT-FILE       ASSIGN TO SYS008-UR-1403-S-SYS008.
   155
   156     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
   157
   158     SELECT ELREPT           ASSIGN TO SYS010-3380-ELREPT
   159                             ORGANIZATION IS INDEXED
   160                             ACCESS IS DYNAMIC
   161                             RECORD KEY IS RF-CONTROL-PRIMARY
   162                             FILE STATUS IS DTE-VSAM-FLAGS.
   163
   164     SELECT ERRESS           ASSIGN TO SYS021-3380-ERRESS
   165                             ORGANIZATION IS INDEXED
   166                             ACCESS IS DYNAMIC
   167                             RECORD KEY IS ERRESS-PRIMARY-KEY
   168                             FILE STATUS IS ERRESS-FILE-STATUS.
   169
   170     SELECT ERRESC           ASSIGN TO SYS021-3380-ERRESC
   171                             ORGANIZATION IS INDEXED
   172                             ACCESS IS DYNAMIC
   173                             RECORD KEY IS ERRESC-RECORD-KEY
   174                             FILE STATUS IS ERRESC-FILE-STATUS.
   175
   176     SELECT ERCOMP           ASSIGN TO             ERCOMP
   177                             ORGANIZATION IS INDEXED
   178                             ACCESS IS DYNAMIC
   179                             RECORD KEY IS CO-CONTROL-PRIMARY
   180                             FILE STATUS IS ERCOMP-FILE-STATUS.
   181
   182     SELECT ERLOFC           ASSIGN TO             ERLOFC
   183                             ORGANIZATION IS INDEXED
   184                             ACCESS IS DYNAMIC
   185                             RECORD KEY IS LO-CONTROL-PRIMARY
   186                             FILE STATUS IS ERLOFC-FILE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page   5
* EL517.cbl
   187
   188     SELECT ERBXRF           ASSIGN TO             ERBXRF
   189                             ORGANIZATION IS INDEXED
   190                             ACCESS IS DYNAMIC
   191                             RECORD KEY IS BK-CONTROL-PRIMARY
   192                             FILE STATUS IS ERBXRF-FILE-STATUS.
   193
   194     SELECT ERAGTC           ASSIGN TO             ERAGTC
   195                             ORGANIZATION IS INDEXED
   196                             ACCESS IS DYNAMIC
   197                             RECORD KEY IS AG-CONTROL-PRIMARY
   198                             FILE STATUS IS ERAGTC-FILE-STATUS.
   199
   200     SELECT ELCRTT           ASSIGN TO             ELCRTT
   201                             ORGANIZATION IS INDEXED
   202                             ACCESS IS DYNAMIC
   203                             RECORD KEY IS CS-CONTROL-PRIMARY
   204                             FILE STATUS IS ELCRTT-FILE-STATUS.
   205
   206     SELECT ERPDEF           ASSIGN TO ERPDEF
   207                             ACCESS IS DYNAMIC
   208                             ORGANIZATION IS INDEXED
   209                             FILE STATUS IS ERPDEF-FILE-STATUS
   210                             RECORD KEY IS PD-CONTROL-PRIMARY.
   211
   212     SELECT ELSTAT           ASSIGN TO ELSTAT
   213                             ACCESS IS DYNAMIC
   214                             ORGANIZATION IS INDEXED
   215                             FILE STATUS IS ELSTAT-FILE-STATUS
   216                             RECORD KEY IS SF-CONTROL-PRIMARY.
   217
   218     SELECT ELCRTO           ASSIGN TO ELCRTO
   219                             ACCESS IS DYNAMIC
   220                             ORGANIZATION IS INDEXED
   221                             FILE STATUS IS ELCRTO-FILE-STATUS
   222                             RECORD KEY IS OC-CONTROL-PRIMARY.
   223
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page   6
* EL517.cbl
   225 DATA DIVISION.
   226
   227 FILE SECTION.
   228
   229 FD  DISK-DATE
*                                      COPY ELCDTEFD.
   230******************************************************************04/15/98
   231*                                                                *ELCDTEFD
   232*                                                                *ELCDTEFD
   233*                            ELCDTEFD.                           *   LV002
   234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   235*                            VMOD=2.007                          *   CL**2
   236*                                                                *ELCDTEFD
   237******************************************************************ELCDTEFD
   238     BLOCK CONTAINS 0 RECORDS
   239     RECORDING MODE F.                                            ELCDTEFD
   240                                                                  ELCDTEFD
   241 01  DATE-DISK.                                                   ELCDTEFD
   242     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   243     12  FILLER                      PIC  X(14).                  ELCDTEFD
   244     12  DD-CR1                      PIC  9.                      ELCDTEFD
   245     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   246     12  DD-CR2                      PIC  9.                      ELCDTEFD
   247     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   248     12  FILLER                      PIC  X(20).                  ELCDTEFD
   249                                                                  ELCDTEFD
   250 01  DATE-DISK-R.                                                 ELCDTEFD
   251     12  FILLER                      PIC  X(4).                   ELCDTEFD
   252     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   253                                     PIC  X(32).                  ELCDTEFD
   254                                                                  ELCDTEFD
   255 01  DATE-DISK-T.                                                 ELCDTEFD
   256     12  FILLER                      PIC  X(4).                   ELCDTEFD
   257     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   258                                     PIC  X(48).                  ELCDTEFD
   259                                                                  ELCDTEFD
   260 01  DATE-DISK-M.                                                 ELCDTEFD
   261     12  FILLER                      PIC  X(4).                   ELCDTEFD
   262     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   263                                     PIC  X(48).                  ELCDTEFD
   264                                                                  ELCDTEFD
   265 01  DATE-DISK-P.                                                 ELCDTEFD
   266     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   267     12  DD-IDX                      PIC  99.                     ELCDTEFD
   268     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   269     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   270         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   271                                     PIC  X.                      ELCDTEFD
   272         16  FILLER                  PIC  X(46).                  ELCDTEFD
   273     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   274         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   275             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   276             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   277             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   278             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   279         16  FILLER                  PIC  X(16).                  ELCDTEFD
   280                                                                  ELCDTEFD
   281 01  DATE-DISK-E.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page   7
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   282     12  FILLER                      PIC  X(4).                   ELCDTEFD
   283     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   284                                     PIC  X(4).                   ELCDTEFD
   285                                                                  ELCDTEFD
   286 01  DATE-DISK-C.                                                 ELCDTEFD
   287     12  FILLER                      PIC  X(7).                   ELCDTEFD
   288     12  DD-CARR1-SECPAY-SW          PIC  X.
   289     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   290     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   291     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   292     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   293     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   294     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   295     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   296     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   297     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   298     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   299     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   300     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   301     12  DD-CARR2-SECPAY-SW          PIC  X.
   302     12  FILLER                      PIC  X(7).                   ELCDTEFD
   303                                                                  ELCDTEFD
   304 01  DATE-DISK-OPT.                                               ELCDTEFD
   305     12  FILLER                      PIC  X(04).                  ELCDTEFD
   306     12  DD-TLR-DATA.                                             ELCDTEFD
   307         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   308                                     PIC  X(03).                  ELCDTEFD
   309     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   310         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   311                                     PIC  X(06).                  ELCDTEFD
   312     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   313         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   314                                     PIC  X(07).                  ELCDTEFD
   315         16  FILLER                  PIC  X(05).                  ELCDTEFD
   316     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   317                                     PIC  X(96).                  ELCDTEFD
   318******************************************************************ELCDTEFD
   319
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page   8
* EL517.cbl
   321 FD  ELCNTL.
*  322                                 COPY ELCCNTL.
   323******************************************************************
   324*                                                                *
   325*                                                                *
   326*                            ELCCNTL.                            *
   327*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   328*                            VMOD=2.059                          *
   329*                                                                *
   330*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   331*                                                                *
   332*   FILE TYPE = VSAM,KSDS                                        *
   333*   RECORD SIZE = 750  RECFORM = FIXED                           *
   334*                                                                *
   335*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   336*       ALTERNATE INDEX = NONE                                   *
   337*                                                                *
   338*   LOG = YES                                                    *
   339*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   340******************************************************************
   341*                   C H A N G E   L O G
   342*
   343* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   344*-----------------------------------------------------------------
   345*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   346* EFFECTIVE    NUMBER
   347*-----------------------------------------------------------------
   348* 082503                   PEMA  ADD BENEFIT GROUP
   349* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   350* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   351* 092705    2005050300006  PEMA  ADD SPP LEASES
   352* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   353* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   354* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FOR AK
   355* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH CLAIM
   356* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   357* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   358* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   359* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   360******************************************************************
   361*
   362 01  CONTROL-FILE.
   363     12  CF-RECORD-ID                       PIC XX.
   364         88  VALID-CF-ID                        VALUE 'CF'.
   365
   366     12  CF-CONTROL-PRIMARY.
   367         16  CF-COMPANY-ID                  PIC XXX.
   368         16  CF-RECORD-TYPE                 PIC X.
   369             88  CF-COMPANY-MASTER              VALUE '1'.
   370             88  CF-PROCESSOR-MASTER            VALUE '2'.
   371             88  CF-STATE-MASTER                VALUE '3'.
   372             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   373             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   374             88  CF-CARRIER-MASTER              VALUE '6'.
   375             88  CF-MORTALITY-MASTER            VALUE '7'.
   376             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   377             88  CF-TERMINAL-MASTER             VALUE '9'.
   378             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page   9
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   379             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   380             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   381             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   382             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   383             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   384             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   385             88  CF-REMINDERS-MASTER            VALUE 'R'.
   386             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   387         16  CF-ACCESS-CD-GENL              PIC X(4).
   388         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   389             20  CF-PROCESSOR               PIC X(4).
   390         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   391             20  CF-STATE-CODE              PIC XX.
   392             20  FILLER                     PIC XX.
   393         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   394             20  FILLER                     PIC XX.
   395             20  CF-HI-BEN-IN-REC           PIC XX.
   396         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   397             20  FILLER                     PIC XXX.
   398             20  CF-CARRIER-CNTL            PIC X.
   399         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   400             20  FILLER                     PIC XX.
   401             20  CF-HI-TYPE-IN-REC          PIC 99.
   402         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   403             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   404                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   405             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   406             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   407         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   408             20  FILLER                     PIC X.
   409             20  CF-CUSTOM-REPORT-NO        PIC 999.
   410         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   411             20  FILLER                     PIC XX.
   412             20  CF-MORTGAGE-PLAN           PIC XX.
   413         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   414
   415     12  CF-LAST-MAINT-DT                   PIC XX.
   416     12  CF-LAST-MAINT-BY                   PIC X(4).
   417     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   418
   419     12  CF-RECORD-BODY                     PIC X(728).
   420
   421
   422****************************************************************
   423*             COMPANY MASTER RECORD                            *
   424****************************************************************
   425
   426     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   427         16  CF-COMPANY-ADDRESS.
   428             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   429             20  CF-CL-IN-CARE-OF           PIC X(30).
   430             20  CF-CL-ADDR-LINE-1          PIC X(30).
   431             20  CF-CL-ADDR-LINE-2          PIC X(30).
   432             20  CF-CL-CITY-STATE           PIC X(30).
   433             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   434             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   435         16  CF-COMPANY-CD                  PIC X.
   436         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  10
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   437         16  CF-SECURITY-OPTION             PIC X.
   438             88  ALL-SECURITY                   VALUE '1'.
   439             88  COMPANY-VERIFY                 VALUE '2'.
   440             88  PROCESSOR-VERIFY               VALUE '3'.
   441             88  NO-SECURITY                    VALUE '4'.
   442             88  ALL-BUT-TERM                   VALUE '5'.
   443         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   444             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   445         16  CF-LGX-INTERFACE-CNTL          PIC X.
   446             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   447         16  CF-INFORCE-LOCATION            PIC X.
   448             88  CERTS-ARE-ONLINE               VALUE '1'.
   449             88  CERTS-ARE-OFFLINE              VALUE '2'.
   450             88  NO-CERTS-AVAILABLE             VALUE '3'.
   451         16  CF-LOWER-CASE-LETTERS          PIC X.
   452         16  CF-CERT-ACCESS-CONTROL         PIC X.
   453             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   454             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   455             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   456             88  CF-ACCNT-CNTL                  VALUE '3'.
   457             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   458
   459         16  CF-FORMS-PRINTER-ID            PIC X(4).
   460         16  CF-CHECK-PRINTER-ID            PIC X(4).
   461
   462         16  CF-LGX-CREDIT-USER             PIC X.
   463             88  CO-IS-NOT-USER                 VALUE 'N'.
   464             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   465
   466         16 CF-CREDIT-CALC-CODES.
   467             20  CF-CR-REM-TERM-CALC PIC X.
   468               88  CR-EARN-AFTER-15TH           VALUE '1'.
   469               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   470               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   471               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   472               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   473               88  CR-EARN-AFTER-14TH           VALUE '6'.
   474               88  CR-EARN-AFTER-16TH           VALUE '7'.
   475             20  CF-CR-R78-METHOD           PIC X.
   476               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   477               88  DONT-USE-PLUS-ONE            VALUE '1'.
   478
   479         16  CF-CLAIM-CONTROL-COUNTS.
   480             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   481                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   482
   483             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   484                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   485
   486             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   487                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   488
   489             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   490                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   491
   492         16  CF-CURRENT-MONTH-END           PIC XX.
   493
   494         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  11
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   495             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   496             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   497             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   498             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   499                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   500                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   501             20  CF-CO-PREM-REJECT-SW       PIC X.
   502                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   503                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   504             20  CF-CO-REF-REJECT-SW        PIC X.
   505                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   506                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   507
   508         16  CF-CO-REPORTING-DT             PIC XX.
   509         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   510         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   511           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   512           88  CF-CO-MONTH-END                  VALUE '1'.
   513
   514         16  CF-LGX-CLAIM-USER              PIC X.
   515             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   516             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   517
   518         16  CF-CREDIT-EDIT-CONTROLS.
   519             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   520             20  CF-MIN-AGE                 PIC 99.
   521             20  CF-DEFAULT-AGE             PIC 99.
   522             20  CF-MIN-TERM                PIC S999      COMP-3.
   523             20  CF-MAX-TERM                PIC S999      COMP-3.
   524             20  CF-DEFAULT-SEX             PIC X.
   525             20  CF-JOINT-AGE-INPUT         PIC X.
   526                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   527             20  CF-BIRTH-DATE-INPUT        PIC X.
   528                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   529             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   530                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   531                 88  CF-ZERO-CARRIER            VALUE '1'.
   532                 88  CF-ZERO-GROUPING           VALUE '2'.
   533                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   534             20  CF-EDIT-SW                 PIC X.
   535                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   536             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   537             20  CF-CR-PR-METHOD            PIC X.
   538               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   539               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   540             20  FILLER                     PIC X.
   541
   542         16  CF-CREDIT-MISC-CONTROLS.
   543             20  CF-REIN-TABLE-SW           PIC X.
   544                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   545             20  CF-COMP-TABLE-SW           PIC X.
   546                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   547             20  CF-EXPERIENCE-RETENTION-AGE
   548                                            PIC S9        COMP-3.
   549             20  CF-CONVERSION-DT           PIC XX.
   550             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   551             20  CF-RUN-FREQUENCY-SW        PIC X.
   552                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  12
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   553                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   554
   555             20  CF-CR-CHECK-NO-CONTROL.
   556                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   557                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   558                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   559                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   560                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   561                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   562
   563                 24  CF-CR-CHECK-COUNT       REDEFINES
   564                     CF-CR-CHECK-COUNTER      PIC X(4).
   565
   566                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   567                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   568
   569                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   570                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   571                 24  CF-MAIL-PROCESSING       PIC X.
   572                     88  MAIL-PROCESSING          VALUE 'Y'.
   573
   574         16  CF-MISC-SYSTEM-CONTROL.
   575             20  CF-SYSTEM-C                 PIC X.
   576                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   577             20  CF-SYSTEM-D                 PIC X.
   578                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   579             20  CF-SOC-SEC-NO-SW            PIC X.
   580                 88  SOC-SEC-NO-USED             VALUE '1'.
   581             20  CF-MEMBER-NO-SW             PIC X.
   582                 88  MEMBER-NO-USED              VALUE '1'.
   583             20  CF-TAX-ID-NUMBER            PIC X(11).
   584             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   585             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   586                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   587                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   588                 88  CF-ALL-APPROVED             VALUE 'Y'.
   589                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   590             20  CF-SYSTEM-E                 PIC X.
   591                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   592
   593         16  CF-LGX-LIFE-USER               PIC X.
   594             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   595             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   596
   597         16  CF-CR-MONTH-END-DT             PIC XX.
   598
   599         16  CF-FILE-MAINT-DATES.
   600             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   601                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   602             20  CF-LAST-BATCH       REDEFINES
   603                 CF-LAST-BATCH-NO               PIC X(4).
   604             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   605             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   606             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   607             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   608             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   609             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   610             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  13
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   611             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   612             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   613             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   614
   615         16  CF-NEXT-COMPANY-ID             PIC XXX.
   616         16  FILLER                         PIC X.
   617
   618         16  CF-ALT-MORT-CODE               PIC X(4).
   619         16  CF-MEMBER-CAPTION              PIC X(10).
   620
   621         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   622             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   623             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   624             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   625             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   626             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   627
   628         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   629
   630         16  CF-LIFE-OVERRIDE-L1            PIC X.
   631         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   632         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   633         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   634
   635         16  CF-AH-OVERRIDE-L1              PIC X.
   636         16  CF-AH-OVERRIDE-L2              PIC XX.
   637         16  CF-AH-OVERRIDE-L6              PIC X(6).
   638         16  CF-AH-OVERRIDE-L12             PIC X(12).
   639
   640         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   641         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   642
   643         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   644         16  CF-AR-LAST-EL860-DT            PIC XX.
   645         16  CF-MP-MONTH-END-DT             PIC XX.
   646
   647         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   648         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   649             88  CF-CLAIM-PAID-TO               VALUE '1'.
   650
   651         16  CF-AR-MONTH-END-DT             PIC XX.
   652
   653         16  CF-CRDTCRD-USER                PIC X.
   654             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   655             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   656
   657         16  CF-CC-MONTH-END-DT             PIC XX.
   658
   659         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   660
   661         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   662             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   663             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   664             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   665         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   666         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   667         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
   668         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  14
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   669             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   670             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   671         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   672         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   673         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   674             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   675         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   676
   677         16  CF-CL-ZIP-CODE.
   678             20  CF-CL-ZIP-PRIME.
   679                 24  CF-CL-ZIP-1ST          PIC X.
   680                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   681                 24  FILLER                 PIC X(4).
   682             20  CF-CL-ZIP-PLUS4            PIC X(4).
   683         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   684             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   685             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   686             20  FILLER                     PIC XXX.
   687
   688         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   689         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   690         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   691         16  CF-CO-OPTION-START-DATE        PIC XX.
   692         16  CF-REM-TRM-CALC-OPTION         PIC X.
   693           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   694                                                      '3' '4'.
   695           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   696           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   697           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   698           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   699           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   700           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   701
   702         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   703
   704         16  CF-PAYMENT-APPROVAL-LEVELS.
   705             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   706             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   707             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   708             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   709             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   710             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   711
   712         16  CF-END-USER-REPORTING-USER     PIC X.
   713             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   714             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   715
   716         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   717             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   718             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   719
   720         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   721
   722         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   723         16  FILLER                         PIC X.
   724
   725         16  CF-CREDIT-ARCHIVE-CNTL.
   726             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  15
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   727             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   728             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   729
   730         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   731
   732         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   733             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   734             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   735
   736         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   737             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   738             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   739
   740         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   741
   742         16  CF-CO-ACH-ID-CODE              PIC  X.
   743             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
   744             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
   745             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
   746         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
   747         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
   748         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
   749         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
   750         16  CF-CO-ACH-RECV-NAME            PIC X(23).
   751         16  CF-CO-ACH-RECV-NO              PIC X(08).
   752         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
   753         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
   754         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
   755                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
   756         16  CF-CO-ACH-TRACE-SPACE REDEFINES
   757                 CF-CO-ACH-TRACE-NO         PIC X(4).
   758
   759         16  CF-CO-OVER-SHORT.
   760             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
   761             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
   762
   763*         16  FILLER                         PIC X(102).
   764         16  CF-PAYMENT-APPROVAL-LEVELS-2.
   765             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
   766             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
   767
   768         16  CF-AH-APPROVAL-DAYS.
   769             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
   770             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
   771             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
   772             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
   773
   774         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
   775
   776         16  FILLER                         PIC X(79).
   777****************************************************************
   778*             PROCESSOR/USER RECORD                            *
   779****************************************************************
   780
   781     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   782         16  CF-PROCESSOR-NAME              PIC X(30).
   783         16  CF-PROCESSOR-PASSWORD          PIC X(11).
   784         16  CF-PROCESSOR-TITLE             PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  16
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   785         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
   786                 88  MESSAGE-YES                VALUE 'Y'.
   787                 88  MESSAGE-NO                 VALUE ' ' 'N'.
   788
   789*****************************************************
   790****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
   791****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
   792****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
   793****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
   794*****************************************************
   795
   796         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
   797             20  CF-ADMINISTRATION-CONTROLS PIC XX.
   798             20  CF-APPLICATION-FORCE       PIC X.
   799             20  CF-INDIVIDUAL-APP.
   800                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
   801                     28  CF-BROWSE-APP      PIC X.
   802                     28  CF-UPDATE-APP      PIC X.
   803
   804         16  CF-CURRENT-TERM-ON             PIC X(4).
   805         16  CF-PROCESSOR-LIMITS-CLAIMS.
   806             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
   807             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
   808             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
   809             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
   810             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
   811             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
   812             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
   813         16  CF-PROCESSOR-CARRIER           PIC X.
   814             88  NO-CARRIER-SECURITY            VALUE ' '.
   815         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
   816             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
   817         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
   818             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
   819         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
   820             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
   821
   822         16  CF-PROC-SYS-ACCESS-SW.
   823             20  CF-PROC-CREDIT-CLAIMS-SW.
   824                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
   825                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
   826                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
   827                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
   828             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
   829                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
   830                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
   831             20  CF-PROC-LIFE-GNRLDGR-SW.
   832                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
   833                     88  ACCESS-TO-LIFE             VALUE 'Y'.
   834                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
   835                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
   836             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
   837                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
   838                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
   839         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
   840             CF-PROC-SYS-ACCESS-SW              PIC X(4).
   841             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
   842         16  CF-PROCESSOR-PRINTER               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  17
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   843
   844         16  CF-APPROVAL-LEVEL                  PIC X.
   845             88  APPROVAL-LEVEL-1                   VALUE '1'.
   846             88  APPROVAL-LEVEL-2                   VALUE '2'.
   847             88  APPROVAL-LEVEL-3                   VALUE '3'.
   848             88  APPROVAL-LEVEL-4                   VALUE '4'.
   849
   850         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
   851
   852         16  CF-LANGUAGE-TYPE                   PIC X.
   853             88  CF-LANG-IS-ENG                     VALUE 'E'.
   854             88  CF-LANG-IS-FR                      VALUE 'F'.
   855
   856         16  CF-CSR-IND                         PIC X.
   857         16  FILLER                             PIC X(239).
   858
   859****************************************************************
   860*             PROCESSOR/REMINDERS RECORD                       *
   861****************************************************************
   862
   863     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
   864         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
   865             20  CF-START-REMIND-DT         PIC XX.
   866             20  CF-END-REMIND-DT           PIC XX.
   867             20  CF-REMINDER-TEXT           PIC X(50).
   868         16  FILLER                         PIC X(296).
   869
   870
   871****************************************************************
   872*             STATE MASTER RECORD                              *
   873****************************************************************
   874
   875     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   876         16  CF-STATE-ABBREVIATION          PIC XX.
   877         16  CF-STATE-NAME                  PIC X(25).
   878         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
   879         16  CF-ST-CALC-QUOTE-TOLERANCE.
   880             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
   881             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
   882             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
   883             20  CF-ST-CLAIM-REJECT-SW      PIC X.
   884                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
   885                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
   886             20  CF-ST-PREM-REJECT-SW       PIC X.
   887                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
   888                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
   889             20  CF-ST-REF-REJECT-SW        PIC X.
   890                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
   891                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
   892         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
   893         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
   894         16  CF-ST-REFUND-RULES.
   895             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
   896             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
   897             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
   898         16  CF-ST-FST-PMT-EXTENSION.
   899             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
   900             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  18
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   901                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
   902                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
   903                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
   904                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
   905         16  CF-ST-STATE-CALL.
   906             20  CF-ST-CALL-UNEARNED        PIC X.
   907             20  CF-ST-CALL-RPT-CNTL        PIC X.
   908             20  CF-ST-CALL-RATE-DEV        PIC XXX.
   909         16  CF-REPLACEMENT-LAW-SW          PIC X.
   910             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
   911             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
   912         16  CF-REPLACEMENT-LETTER          PIC X(4).
   913         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
   914         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
   915         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
   916         16  CF-ST-SPLIT-PAYMENT            PIC X.
   917         16  FILLER                         PIC X.
   918         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
   919             20  CF-ST-BENEFIT-CD           PIC XX.
   920             20  CF-ST-BENEFIT-KIND         PIC X.
   921                 88  CF-ST-LIFE-KIND            VALUE 'L'.
   922                 88  CF-ST-AH-KIND              VALUE 'A'.
   923             20  CF-ST-REM-TERM-CALC        PIC X.
   924                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
   925                 88  ST-EARN-AFTER-15TH         VALUE '1'.
   926                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
   927                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
   928                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
   929                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
   930                 88  ST-EARN-AFTER-14TH         VALUE '6'.
   931                 88  ST-EARN-AFTER-16TH         VALUE '7'.
   932
   933             20  CF-ST-REFUND-CALC          PIC X.
   934                 88  ST-REFUND-NOT-USED         VALUE SPACE.
   935                 88  ST-REFD-BY-R78             VALUE '1'.
   936                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
   937                 88  ST-REFD-AS-CALIF           VALUE '3'.
   938                 88  ST-REFD-AS-TEXAS           VALUE '4'.
   939                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
   940                 88  ST-REFD-ANTICIPATION       VALUE '6'.
   941                 88  ST-REFD-UTAH               VALUE '7'.
   942                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
   943                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
   944                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
   945
   946             20  CF-ST-EARNING-CALC         PIC X.
   947                 88  ST-EARNING-NOT-USED        VALUE SPACE.
   948                 88  ST-EARN-BY-R78             VALUE '1'.
   949                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
   950                 88  ST-EARN-AS-CALIF           VALUE '3'.
   951                 88  ST-EARN-AS-TEXAS           VALUE '4'.
   952                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
   953                 88  ST-EARN-ANTICIPATION       VALUE '6'.
   954                 88  ST-EARN-MEAN               VALUE '8'.
   955                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
   956
   957             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
   958                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  19
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   959                 88  ST-OVRD-BY-R78             VALUE '1'.
   960                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
   961                 88  ST-OVRD-AS-CALIF           VALUE '3'.
   962                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
   963                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
   964                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
   965                 88  ST-OVRD-MEAN               VALUE '8'.
   966                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
   967             20  FILLER                     PIC X.
   968
   969         16  CF-ST-COMMISSION-CAPS.
   970             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
   971             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
   972             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
   973             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
   974         16  CF-COMM-CAP-LIMIT-TO           PIC X.
   975                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
   976
   977         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
   978
   979         16  CF-ST-STATUTORY-INTEREST.
   980             20  CF-ST-STAT-DATE-FROM       PIC X.
   981                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
   982                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
   983             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
   984             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
   985             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
   986             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
   987             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
   988
   989         16  CF-ST-OVER-SHORT.
   990             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
   991             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
   992
   993         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
   994
   995         16  CF-ST-RT-CALC                  PIC X.
   996
   997         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
   998         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
   999         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1000         16  CF-ST-RF-LR-CALC               PIC X.
  1001         16  CF-ST-RF-LL-CALC               PIC X.
  1002         16  CF-ST-RF-LN-CALC               PIC X.
  1003         16  CF-ST-RF-AH-CALC               PIC X.
  1004         16  CF-ST-RF-CP-CALC               PIC X.
  1005*        16  FILLER                         PIC X(206).
  1006*CIDMOD         16  FILLER                         PIC X(192).
  1007         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1008             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1009         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1010         16  CF-ST-VFY-2ND-BENE             PIC X.
  1011         16  CF-ST-CAUSAL-STATE             PIC X.
  1012         16  FILLER                         PIC X(185).
  1013
  1014****************************************************************
  1015*             BENEFIT MASTER RECORD                            *
  1016****************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  20
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1017
  1018     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1019         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1020             20  CF-BENEFIT-CODE            PIC XX.
  1021             20  CF-BENEFIT-NUMERIC  REDEFINES
  1022                 CF-BENEFIT-CODE            PIC XX.
  1023             20  CF-BENEFIT-ALPHA           PIC XXX.
  1024             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1025             20  CF-BENEFIT-COMMENT         PIC X(10).
  1026
  1027             20  CF-LF-COVERAGE-TYPE        PIC X.
  1028                 88  CF-REDUCING                VALUE 'R'.
  1029                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1030
  1031             20  CF-SPECIAL-CALC-CD         PIC X.
  1032                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1033                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1034                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1035                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1036                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1037                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1038                 88  CF-FARM-PLAN               VALUE 'F'.
  1039                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1040                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1041                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1042                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1043                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1044                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1045                 88  CF-PRUDENTIAL              VALUE 'P'.
  1046                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1047                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1048                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1049                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1050                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1051                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1052
  1053             20  CF-JOINT-INDICATOR         PIC X.
  1054                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1055
  1056*            20  FILLER                     PIC X(12).
  1057             20  FILLER                     PIC X(11).
  1058             20  CF-BENEFIT-CATEGORY        PIC X.
  1059             20  CF-LOAN-TYPE               PIC X(8).
  1060
  1061             20  CF-CO-REM-TERM-CALC        PIC X.
  1062                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1063                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1064                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1065                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1066                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1067
  1068             20  CF-CO-EARNINGS-CALC        PIC X.
  1069                 88  CO-EARN-BY-R78             VALUE '1'.
  1070                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1071                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1072                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1073                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1074                 88  CO-EARN-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  21
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1075                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1076                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1077
  1078             20  CF-CO-REFUND-CALC          PIC X.
  1079                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1080                 88  CO-REFD-BY-R78             VALUE '1'.
  1081                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1082                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1083                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1084                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1085                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1086                 88  CO-REFD-MEAN               VALUE '8'.
  1087                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1088                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1089                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1090
  1091             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1092                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1093                 88  CO-OVRD-BY-R78             VALUE '1'.
  1094                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1095                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1096                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1097                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1098                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1099                 88  CO-OVRD-MEAN               VALUE '8'.
  1100                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1101
  1102             20  CF-CO-BEN-I-G-CD           PIC X.
  1103                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1104                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1105                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1106
  1107         16  FILLER                         PIC X(304).
  1108
  1109
  1110****************************************************************
  1111*             CARRIER MASTER RECORD                            *
  1112****************************************************************
  1113
  1114     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1115         16  CF-ADDRESS-DATA.
  1116             20  CF-MAIL-TO-NAME            PIC X(30).
  1117             20  CF-IN-CARE-OF              PIC X(30).
  1118             20  CF-ADDRESS-LINE-1          PIC X(30).
  1119             20  CF-ADDRESS-LINE-2          PIC X(30).
  1120             20  CF-CITY-STATE              PIC X(30).
  1121             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1122             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1123
  1124         16  CF-CLAIM-NO-CONTROL.
  1125             20  CF-CLAIM-NO-METHOD         PIC X.
  1126                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1127                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1128                 88  CLAIM-NO-SEQ               VALUE '3'.
  1129                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1130             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1131                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1132                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  22
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1133                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1134
  1135         16  CF-CHECK-NO-CONTROL.
  1136             20  CF-CHECK-NO-METHOD         PIC X.
  1137                 88  CHECK-NO-MANUAL            VALUE '1'.
  1138                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1139                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1140                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1141             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1142                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1143
  1144         16  CF-DOMICILE-STATE              PIC XX.
  1145
  1146         16  CF-EXPENSE-CONTROLS.
  1147             20  CF-EXPENSE-METHOD          PIC X.
  1148                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1149                 88  DOLLARS-PER-PMT            VALUE '2'.
  1150                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1151                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1152             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1153             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1154
  1155         16  CF-CORRESPONDENCE-CONTROL.
  1156             20  CF-LETTER-RESEND-OPT       PIC X.
  1157                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1158                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1159             20  FILLER                     PIC X(4).
  1160
  1161         16  CF-RESERVE-CONTROLS.
  1162             20  CF-MANUAL-SW               PIC X.
  1163                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1164             20  CF-FUTURE-SW               PIC X.
  1165                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1166             20  CF-PTC-SW                  PIC X.
  1167                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1168             20  CF-IBNR-SW                 PIC X.
  1169                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1170             20  CF-PTC-LF-SW               PIC X.
  1171                 88  CF-LF-PTC-USED             VALUE '1'.
  1172             20  CF-CDT-ACCESS-METHOD       PIC X.
  1173                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1174                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1175                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1176             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1177
  1178         16  CF-CLAIM-CALC-METHOD           PIC X.
  1179             88  360-PLUS-MONTHS                VALUE '1'.
  1180             88  365-PLUS-MONTHS                VALUE '2'.
  1181             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1182             88  360-DAILY                      VALUE '4'.
  1183             88  365-DAILY                      VALUE '5'.
  1184
  1185         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1186         16  FILLER                         PIC X(11).
  1187
  1188         16  CF-LIMIT-AMOUNTS.
  1189             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1190             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  23
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1191             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1192             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1193             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1194             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1195             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1196             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1197             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1198             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1199
  1200         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1201         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1202         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1203
  1204         16  CF-ZIP-CODE.
  1205             20  CF-ZIP-PRIME.
  1206                 24  CF-ZIP-1ST             PIC X.
  1207                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1208                 24  FILLER                 PIC X(4).
  1209             20  CF-ZIP-PLUS4               PIC X(4).
  1210         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1211             20  CF-CAN-POSTAL-1            PIC XXX.
  1212             20  CF-CAN-POSTAL-2            PIC XXX.
  1213             20  FILLER                     PIC XXX.
  1214
  1215         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1216         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1217         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1218
  1219         16  CF-RATING-SWITCH               PIC X.
  1220             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1221             88  CF-NO-RATING                   VALUE 'N'.
  1222
  1223         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1224
  1225         16  CF-CARRIER-OVER-SHORT.
  1226             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1227             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1228
  1229         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1230         16  CF-SECPAY-SWITCH               PIC X.
  1231             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1232             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1233         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1234         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1235         16  FILLER                         PIC X(444).
  1236*        16  FILLER                         PIC X(452).
  1237
  1238
  1239****************************************************************
  1240*             MORTALITY MASTER RECORD                          *
  1241****************************************************************
  1242
  1243     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1244         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1245                                INDEXED BY CF-MORT-NDX.
  1246             20  CF-MORT-TABLE              PIC X(5).
  1247             20  CF-MORT-TABLE-TYPE         PIC X.
  1248                 88  CF-MORT-JOINT              VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  24
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1249                 88  CF-MORT-SINGLE             VALUE 'S'.
  1250                 88  CF-MORT-COMBINED           VALUE 'C'.
  1251                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1252                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1253             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1254             20  CF-MORT-AGE-METHOD         PIC XX.
  1255                 88  CF-AGE-LAST                VALUE 'AL'.
  1256                 88  CF-AGE-NEAR                VALUE 'AN'.
  1257             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1258             20  CF-MORT-ADJUSTMENT-DIRECTION
  1259                                            PIC X.
  1260                 88  CF-MINUS                   VALUE '-'.
  1261                 88  CF-PLUS                    VALUE '+'.
  1262             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1263             20  CF-MORT-JOINT-CODE         PIC X.
  1264                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1265             20  CF-MORT-PC-Q               PIC X.
  1266                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1267             20  CF-MORT-TABLE-CODE         PIC X(4).
  1268             20  CF-MORT-COMMENTS           PIC X(15).
  1269             20  FILLER                     PIC X(14).
  1270
  1271         16  FILLER                         PIC X(251).
  1272
  1273
  1274****************************************************************
  1275*             BUSSINESS TYPE MASTER RECORD                     *
  1276****************************************************************
  1277
  1278     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1279* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1280* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1281* AND RECORD 05 IS TYPES 81-99
  1282         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1283             20  CF-BUSINESS-TITLE          PIC  X(19).
  1284             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1285                                            PIC S9V9(4) COMP-3.
  1286             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1287             20  FILLER                     PIC  X.
  1288         16  FILLER                         PIC  X(248).
  1289
  1290
  1291****************************************************************
  1292*             TERMINAL MASTER RECORD                           *
  1293****************************************************************
  1294
  1295     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1296
  1297         16  CF-COMPANY-TERMINALS.
  1298             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1299                                  PIC X(4).
  1300         16  FILLER               PIC X(248).
  1301
  1302
  1303****************************************************************
  1304*             LIFE EDIT MASTER RECORD                          *
  1305****************************************************************
  1306
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  25
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1307     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1308         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1309             20  CF-LIFE-CODE-IN            PIC XX.
  1310             20  CF-LIFE-CODE-OUT           PIC XX.
  1311         16  FILLER                         PIC X(248).
  1312
  1313
  1314****************************************************************
  1315*             AH EDIT MASTER RECORD                            *
  1316****************************************************************
  1317
  1318     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1319         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1320             20  CF-AH-CODE-IN              PIC XXX.
  1321             20  CF-AH-CODE-OUT             PIC XX.
  1322         16  FILLER                         PIC X(248).
  1323
  1324
  1325****************************************************************
  1326*             CREDIBILITY TABLES                               *
  1327****************************************************************
  1328
  1329     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1330         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1331                             INDEXED BY CF-CRDB-NDX.
  1332             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1333             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1334             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1335         16  FILLER                         PIC  X(332).
  1336
  1337
  1338****************************************************************
  1339*             REPORT CUSTOMIZATION RECORD                      *
  1340****************************************************************
  1341
  1342     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1343         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1344             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1345             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1346             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1347**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1348****       A T-TRANSFER.                                   ****
  1349             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1350
  1351         16  FILLER                         PIC XX.
  1352
  1353         16  CF-CARRIER-CNTL-OPT.
  1354             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1355                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1356                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1357             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1358                                            PIC X.
  1359         16  CF-GROUP-CNTL-OPT.
  1360             20  CF-GROUP-OPT-SEQ           PIC 9.
  1361                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1362                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1363             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1364                                            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  26
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1365         16  CF-STATE-CNTL-OPT.
  1366             20  CF-STATE-OPT-SEQ           PIC 9.
  1367                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1368                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1369             20  CF-STATE-SELECT OCCURS 3 TIMES
  1370                                            PIC XX.
  1371         16  CF-ACCOUNT-CNTL-OPT.
  1372             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1373                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1374                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1375             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1376                                            PIC X(10).
  1377         16  CF-BUS-TYP-CNTL-OPT.
  1378             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1379                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1380                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1381             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1382                                            PIC XX.
  1383         16  CF-LF-TYP-CNTL-OPT.
  1384             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1385                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1386                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1387             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1388                                            PIC XX.
  1389         16  CF-AH-TYP-CNTL-OPT.
  1390             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1391                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1392                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1393             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1394                                            PIC XX.
  1395         16  CF-REPTCD1-CNTL-OPT.
  1396             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1397                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1398                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1399             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1400                                            PIC X(10).
  1401         16  CF-REPTCD2-CNTL-OPT.
  1402             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1403                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1404                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1405             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1406                                            PIC X(10).
  1407         16  CF-USER1-CNTL-OPT.
  1408             20  CF-USER1-OPT-SEQ           PIC 9.
  1409                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1410                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1411             20  CF-USER1-SELECT OCCURS 3 TIMES
  1412                                            PIC X(10).
  1413         16  CF-USER2-CNTL-OPT.
  1414             20  CF-USER2-OPT-SEQ           PIC 9.
  1415                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1416                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1417             20  CF-USER2-SELECT OCCURS 3 TIMES
  1418                                            PIC X(10).
  1419         16  CF-USER3-CNTL-OPT.
  1420             20  CF-USER3-OPT-SEQ           PIC 9.
  1421                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1422                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  27
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1423             20  CF-USER3-SELECT OCCURS 3 TIMES
  1424                                            PIC X(10).
  1425         16  CF-USER4-CNTL-OPT.
  1426             20  CF-USER4-OPT-SEQ           PIC 9.
  1427                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1428                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1429             20  CF-USER4-SELECT OCCURS 3 TIMES
  1430                                            PIC X(10).
  1431         16  CF-USER5-CNTL-OPT.
  1432             20  CF-USER5-OPT-SEQ           PIC 9.
  1433                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1434                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1435             20  CF-USER5-SELECT OCCURS 3 TIMES
  1436                                            PIC X(10).
  1437         16  CF-REINS-CNTL-OPT.
  1438             20  CF-REINS-OPT-SEQ           PIC 9.
  1439                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1440                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1441             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1442                 24  CF-REINS-PRIME         PIC XXX.
  1443                 24  CF-REINS-SUB           PIC XXX.
  1444
  1445         16  CF-AGENT-CNTL-OPT.
  1446             20  CF-AGENT-OPT-SEQ           PIC 9.
  1447                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1448                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1449             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1450                                            PIC X(10).
  1451
  1452         16  FILLER                         PIC X(43).
  1453
  1454         16  CF-LOSS-RATIO-SELECT.
  1455             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1456             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1457         16  CF-ENTRY-DATE-SELECT.
  1458             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1459             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1460         16  CF-EFFECTIVE-DATE-SELECT.
  1461             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1462             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1463
  1464         16  CF-EXCEPTION-LIST-IND          PIC X.
  1465             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1466
  1467         16  FILLER                         PIC X(318).
  1468
  1469****************************************************************
  1470*                  EXCEPTION REPORTING RECORD                  *
  1471****************************************************************
  1472
  1473     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1474         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1475             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1476
  1477         16  CF-COMBINED-LIFE-AH-OPT.
  1478             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1479             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1480             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  28
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1481             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1482
  1483         16  CF-LIFE-OPT.
  1484             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1485             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1486             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1487             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1488             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1489             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1490             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1491             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1492             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1493             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1494
  1495         16  CF-AH-OPT.
  1496             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1497             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1498             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1499             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1500             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1501             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1502             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1503             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1504             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1505             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1506
  1507         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1508             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1509             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1510             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1511
  1512         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1513
  1514         16  FILLER                         PIC X(673).
  1515
  1516
  1517****************************************************************
  1518*             MORTGAGE SYSTEM PLAN RECORD                      *
  1519****************************************************************
  1520
  1521     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1522         16  CF-PLAN-TYPE                   PIC X.
  1523             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1524             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1525             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1526         16  CF-PLAN-ABBREV                 PIC XXX.
  1527         16  CF-PLAN-DESCRIPT               PIC X(10).
  1528         16  CF-PLAN-NOTES                  PIC X(20).
  1529         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1530         16  CF-PLAN-UNDERWRITING.
  1531             20  CF-PLAN-TERM-DATA.
  1532                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1533                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1534             20  CF-PLAN-AGE-DATA.
  1535                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1536                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1537                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1538             20  CF-PLAN-BENEFIT-DATA.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  29
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1539                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1540                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1541                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1542                                            PIC S9(7)V99  COMP-3.
  1543         16  CF-PLAN-POLICY-FORMS.
  1544             20  CF-POLICY-FORM             PIC X(12).
  1545             20  CF-MASTER-APPLICATION      PIC X(12).
  1546             20  CF-MASTER-POLICY           PIC X(12).
  1547         16  CF-PLAN-RATING.
  1548             20  CF-RATE-CODE               PIC X(5).
  1549             20  CF-SEX-RATING              PIC X.
  1550                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1551                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1552             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1553             20  CF-SUB-STD-TYPE            PIC X.
  1554                 88  CF-PCT-OF-PREM            VALUE '1'.
  1555                 88  CF-PCT-OF-BENE            VALUE '2'.
  1556         16  CF-PLAN-PREM-TOLERANCES.
  1557             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1558             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1559         16  CF-PLAN-PYMT-TOLERANCES.
  1560             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1561             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1562         16  CF-PLAN-MISC-DATA.
  1563             20  FILLER                     PIC X.
  1564             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1565             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1566         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1567         16  CF-PLAN-IND-GRP                PIC X.
  1568             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1569                                                     '1'.
  1570             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1571                                                     '2'.
  1572         16  CF-MIB-SEARCH-SW               PIC X.
  1573             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1574             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1575             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1576             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1577         16  CF-ALPHA-SEARCH-SW             PIC X.
  1578             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1579             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1580             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1581             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1582             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1583             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1584             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1585             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1586             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1587             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1588                                                     'A' 'B' 'C'
  1589                                                     'X' 'Y' 'Z'.
  1590         16  CF-EFF-DT-RULE-SW              PIC X.
  1591             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1592             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1593             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1594             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1595             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1596         16  FILLER                         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  30
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1597         16  CF-HEALTH-QUESTIONS            PIC X.
  1598             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1599         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1600         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1601         16  CF-PLAN-SNGL-JNT               PIC X.
  1602             88  CF-COMBINED-PLAN              VALUE 'C'.
  1603             88  CF-JNT-PLAN                   VALUE 'J'.
  1604             88  CF-SNGL-PLAN                  VALUE 'S'.
  1605         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1606         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1607         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1608         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1609         16  CF-RERATE-CNTL                 PIC  X.
  1610             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1611             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1612             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1613             88  CF-AUTO-RECALC                 VALUE '4'.
  1614         16  CF-BENEFIT-TYPE                PIC  X.
  1615             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1616             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1617         16  CF-POLICY-FEE                  PIC S999V99
  1618                                                    COMP-3.
  1619         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1620         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1621         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1622         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1623         16  FILLER                         PIC  X(32).
  1624         16  CF-TERMINATION-FORM            PIC  X(04).
  1625         16  FILLER                         PIC  X(08).
  1626         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1627                                                       COMP-3.
  1628         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1629         16  CF-ISSUE-LETTER                PIC  X(4).
  1630         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1631         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1632             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1633             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1634         16  CF-MP-REFUND-CALC              PIC X.
  1635             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1636             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1637             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1638             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1639             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1640             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1641             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1642             88  CF-MP-REFD-MEAN                VALUE '8'.
  1643         16  CF-ALT-RATE-CODE               PIC  X(5).
  1644
  1645
  1646         16  FILLER                         PIC X(498).
  1647****************************************************************
  1648*             MORTGAGE COMPANY MASTER RECORD                   *
  1649****************************************************************
  1650
  1651     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1652         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1653         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1654             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  31
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1655             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1656             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1657             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1658             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1659
  1660         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1661         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1662         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1663         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1664         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1665
  1666         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1667             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1668         16  CF-MP-RECON-USE-IND            PIC X(1).
  1669             88  CF-MP-USE-RECON             VALUE 'Y'.
  1670         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1671             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1672         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1673             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1674             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1675         16  FILLER                         PIC X(1).
  1676         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1677             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1678         16  CF-MORTG-MIB-VERSION           PIC X.
  1679             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1680             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1681             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1682         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1683             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1684                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1685             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1686                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1687             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1688                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1689             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1690                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1691             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1692                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1693             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1694                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1695         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1696         16  FILLER                         PIC X(7).
  1697         16  CF-MORTG-DESTINATION-SYMBOL.
  1698             20  CF-MORTG-MIB-COMM          PIC X(5).
  1699             20  CF-MORTG-MIB-TERM          PIC X(5).
  1700         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1701             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1702         16  FILLER                         PIC X(03).
  1703         16  CF-MP-CHECK-NO-CONTROL.
  1704             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1705                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  1706                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1707                                                ' ' LOW-VALUES.
  1708                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1709                                               VALUE '3'.
  1710         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1711         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1712         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  32
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1713             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1714                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1715             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1716                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1717             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1718                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1719             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1720                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1721             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1722                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1723             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1724                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1725         16  CF-MORTG-BILLING-AREA.
  1726             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1727                                            PIC X.
  1728         16  CF-MORTG-MONTH-END-DT          PIC XX.
  1729         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  1730         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  1731         16  CF-MORTG-MIB-DEST-SW           PIC X.
  1732             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  1733             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  1734         16  FILLER                         PIC X.
  1735         16  CF-MORTG-LABEL-CONTROL         PIC X.
  1736             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  1737             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  1738         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  1739         16  FILLER                         PIC X(8).
  1740         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  1741         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  1742         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  1743         16  CF-ACH-COMPANY-ID.
  1744             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  1745                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  1746                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  1747                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  1748             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  1749         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  1750             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  1751         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  1752             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  1753             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  1754         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  1755         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  1756         16  FILLER                         PIC X(536).
  1757
  1758****************************************************************
  1759*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  1760****************************************************************
  1761
  1762     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  1763         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  1764             20  CF-FEMALE-HEIGHT.
  1765                 24  CF-FEMALE-FT           PIC 99.
  1766                 24  CF-FEMALE-IN           PIC 99.
  1767             20  CF-FEMALE-MIN-WT           PIC 999.
  1768             20  CF-FEMALE-MAX-WT           PIC 999.
  1769         16  FILLER                         PIC X(428).
  1770
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  33
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1771     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  1772         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  1773             20  CF-MALE-HEIGHT.
  1774                 24  CF-MALE-FT             PIC 99.
  1775                 24  CF-MALE-IN             PIC 99.
  1776             20  CF-MALE-MIN-WT             PIC 999.
  1777             20  CF-MALE-MAX-WT             PIC 999.
  1778         16  FILLER                         PIC X(428).
  1779******************************************************************
  1780*             AUTOMATIC ACTIVITY RECORD                          *
  1781******************************************************************
  1782     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  1783         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  1784             20  CF-SYS-ACTIVE-SW           PIC X(01).
  1785             20  CF-SYS-LETTER-ID           PIC X(04).
  1786             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  1787             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  1788             20  CF-SYS-RESET-SW            PIC X(01).
  1789             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  1790             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  1791
  1792         16  FILLER                         PIC X(50).
  1793
  1794         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  1795             20  CF-USER-ACTIVE-SW          PIC X(01).
  1796             20  CF-USER-LETTER-ID          PIC X(04).
  1797             20  CF-USER-RESEND-DAYS        PIC 9(03).
  1798             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  1799             20  CF-USER-RESET-SW           PIC X(01).
  1800             20  CF-USER-REPORT-DAYS        PIC 9(03).
  1801             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  1802             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  1803
  1804         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  34
* EL517.cbl
  1806 FD  ERPNDB.
* 1807                                  COPY ERCPNDB.
  1808******************************************************************
  1809*                                                                *
  1810*                                                                *
  1811*                            ERCPNDB.                            *
  1812*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1813*                            VMOD=2.025                          *
  1814*                                                                *
  1815*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  1816*                                                                *
  1817******************************************************************
  1818*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  1819*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  1820******************************************************************
  1821*                                                                *
  1822*                                                                *
  1823*   FILE TYPE = VSAM,KSDS                                        *
  1824*   RECORD SIZE = 585  RECFORM = FIXED                           *
  1825*                                                                *
  1826*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  1827*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  1828*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  1829*                                                 RKP=13,LEN=36  *
  1830*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  1831*                                      AND CHG-SEQ.)             *
  1832*                                                RKP=49,LEN=11   *
  1833*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  1834*                                      AND CHG-SEQ.)             *
  1835*                                                RKP=60,LEN=15   *
  1836*                                                                *
  1837*   LOG = NO                                                     *
  1838*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1839******************************************************************
  1840******************************************************************
  1841*                   C H A N G E   L O G
  1842*
  1843* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1844*-----------------------------------------------------------------
  1845*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1846* EFFECTIVE    NUMBER
  1847*-----------------------------------------------------------------
  1848* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1849* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1850* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  1851* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1852* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  1853* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1854* 032306                   PEMA  ADD BOW LOAN NUMBER
  1855* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  1856* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  1857* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1858* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1859* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  1860* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  1861* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1862* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1863******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  35
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1864
  1865 01  PENDING-BUSINESS.
  1866     12  PB-RECORD-ID                     PIC XX.
  1867         88  VALID-PB-ID                        VALUE 'PB'.
  1868
  1869     12  PB-CONTROL-PRIMARY.
  1870         16  PB-COMPANY-CD                PIC X.
  1871         16  PB-ENTRY-BATCH               PIC X(6).
  1872         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  1873         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  1874
  1875     12  PB-CONTROL-BY-ACCOUNT.
  1876         16  PB-COMPANY-CD-A1             PIC X.
  1877         16  PB-CARRIER                   PIC X.
  1878         16  PB-GROUPING.
  1879             20  PB-GROUPING-PREFIX       PIC XXX.
  1880             20  PB-GROUPING-PRIME        PIC XXX.
  1881         16  PB-STATE                     PIC XX.
  1882         16  PB-ACCOUNT.
  1883             20  PB-ACCOUNT-PREFIX        PIC X(4).
  1884             20  PB-ACCOUNT-PRIME         PIC X(6).
  1885         16  PB-CERT-EFF-DT               PIC XX.
  1886         16  PB-CERT-NO.
  1887             20  PB-CERT-PRIME            PIC X(10).
  1888             20  PB-CERT-SFX              PIC X.
  1889         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  1890
  1891         16  PB-RECORD-TYPE               PIC X.
  1892             88  PB-MAILING-DATA                VALUE '0'.
  1893             88  PB-ISSUE                       VALUE '1'.
  1894             88  PB-CANCELLATION                VALUE '2'.
  1895             88  PB-BATCH-TRAILER               VALUE '9'.
  1896
  1897     12  PB-CONTROL-BY-ORIG-BATCH.
  1898         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  1899         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  1900         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  1901         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  1902
  1903     12  PB-CONTROL-BY-CSR.
  1904         16  PB-CSR-COMPANY-CD            PIC X.
  1905         16  PB-CSR-ID                    PIC X(4).
  1906         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  1907         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  1908         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  1909******************************************************************
  1910*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  1911******************************************************************
  1912
  1913     12  PB-LAST-MAINT-DT                 PIC XX.
  1914     12  PB-LAST-MAINT-BY                 PIC X(4).
  1915     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1916
  1917     12  PB-RECORD-BODY                   PIC X(375).
  1918
  1919     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  1920         16  PB-CERT-ORIGIN               PIC X.
  1921             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  36
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1922         16  PB-I-NAME.
  1923             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  1924             20  PB-I-INSURED-FIRST-NAME.
  1925                 24  PB-I-INSURED-1ST-INIT PIC X.
  1926                 24  FILLER                PIC X(9).
  1927             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  1928         16  PB-I-AGE                     PIC S99   COMP-3.
  1929         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  1930         16  PB-I-BIRTHDAY                PIC XX.
  1931         16  PB-I-INSURED-SEX             PIC X.
  1932             88  PB-SEX-MALE     VALUE 'M'.
  1933             88  PB-SEX-FEMALE   VALUE 'F'.
  1934
  1935         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  1936         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  1937         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  1938         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1939         16  PB-I-SKIP-CODE               PIC X.
  1940             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1941             88  PB-SKIP-JULY              VALUE '1'.
  1942             88  PB-SKIP-AUGUST            VALUE '2'.
  1943             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1944             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1945             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1946             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1947             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1948             88  PB-SKIP-JUNE              VALUE '8'.
  1949             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1950             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1951             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1952         16  PB-I-TERM-TYPE               PIC X.
  1953             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1954             88  PB-PAID-WEEKLY            VALUE 'W'.
  1955             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1956             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1957             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1958         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1959         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1960         16  PB-I-DATA-ENTRY-SW           PIC X.
  1961             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1962             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1963             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1964             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1965         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1966         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1967*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1968         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1969         16  FILLER                       PIC X.
  1970
  1971         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1972             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1973             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1974                                                   '90' THRU '99'.
  1975         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1976                                          PIC XX.
  1977         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1978         16  PB-I-AMOUNT-FINANCED REDEFINES
  1979                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  37
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1980         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1981         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1982                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1983         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1984         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1985         16  PB-I-CLP-AMOUNT REDEFINES
  1986                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1987         16  PB-I-LF-CALC-FLAG            PIC X.
  1988             88 PB-COMP-LF-PREM               VALUE '?'.
  1989         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1990         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1991         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1992         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  1993         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1994         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  1995         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  1996         16  PB-I-LF-ABBR                 PIC XXX.
  1997         16  PB-I-LF-INPUT-CD             PIC XX.
  1998
  1999         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2000             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2001             88  PB-INVALID-AH               VALUE '  ' '00'
  2002                                                   '90' THRU '99'.
  2003         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2004         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2005         16  PB-I-AH-CALC-FLAG            PIC X.
  2006             88 PB-COMP-AH-PREM                  VALUE '?'.
  2007         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2008         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2009         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2010         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2011         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2012         16  PB-I-AH-ABBR                 PIC XXX.
  2013         16  PB-I-AH-INPUT-CD             PIC XXX.
  2014
  2015         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2016         16  PB-I-REIN-TABLE              PIC XXX.
  2017         16  PB-I-BUSINESS-TYPE           PIC 99.
  2018         16  PB-I-INDV-GRP-CD             PIC X.
  2019         16  PB-I-MORT-CODE.
  2020             20  PB-I-TABLE               PIC X.
  2021             20  PB-I-INTEREST            PIC XX.
  2022             20  PB-I-MORT-TYP            PIC X.
  2023         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2024         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2025         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2026         16  PB-I-INDV-GRP-OVRD           PIC X.
  2027         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2028         16  PB-I-SIG-SW                  PIC X.
  2029             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2030         16  PB-I-RATE-CLASS              PIC XX.
  2031         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2032         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2033         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2034         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2035         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2036         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2037         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  38
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2038         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2039         16  PB-I-OB-FLAG                 PIC X.
  2040             88  PB-I-OB                      VALUE 'B'.
  2041             88  PB-I-SUMMARY                 VALUE 'Z'.
  2042         16  PB-I-ENTRY-STATUS            PIC X.
  2043             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2044                                              'M' '5' '9' '2'.
  2045             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2046             88  PB-I-POLICY-PENDING          VALUE '2'.
  2047             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2048             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2049             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2050             88  PB-I-REIN-ONLY               VALUE '9'.
  2051             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2052             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2053             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2054             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2055         16  PB-I-INT-CODE                PIC X.
  2056             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2057             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2058         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2059         16  PB-I-SOC-SEC-NO              PIC X(11).
  2060         16  PB-I-MEMBER-NO               PIC X(12).
  2061         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2062*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2063         16  PB-I-OLD-LOF                 PIC XXX.
  2064         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2065         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2066         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2067         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2068         16  PB-I-LIFE-INDICATOR          PIC X.
  2069             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2070         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2071         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2072                                          PIC S9(5)V99    COMP-3.
  2073         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2074             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2075             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2076         16  PB-I-1ST-PMT-DT              PIC XX.
  2077         16  PB-I-JOINT-INSURED.
  2078             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2079             20 PB-I-JOINT-FIRST-NAME.
  2080                24  PB-I-JOINT-FIRST-INIT PIC X.
  2081                24  FILLER                PIC X(9).
  2082             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2083*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2084         16  PB-I-BENEFICIARY-NAME.
  2085             20  PB-I-BANK-NUMBER         PIC X(10).
  2086             20  FILLER                   PIC X(15).
  2087         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2088         16  PB-I-REFERENCE               PIC X(12).
  2089         16  FILLER REDEFINES PB-I-REFERENCE.
  2090             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2091             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2092             20  PB-I-CLP-STATE           PIC XX.
  2093         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2094             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2095             88  PB-I-POLICY-DECLINED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  39
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2096             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2097         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2098         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2099         16  PB-I-RESIDENT-STATE          PIC XX.
  2100         16  PB-I-RATE-CODE               PIC X(4).
  2101         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2102         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2103         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2104         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2105         16  PB-I-BANK-NOCHRGB            PIC 99.
  2106         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2107         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2108
  2109     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2110         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2111             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2112         16  PB-C-CANCEL-ORIGIN           PIC X.
  2113             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2114         16  PB-C-LF-CANCEL-DT            PIC XX.
  2115         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2116         16  PB-C-LF-CALC-REQ             PIC X.
  2117             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2118         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2119         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2120         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2121             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2122         16  PB-C-AH-CANCEL-DT            PIC XX.
  2123         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2124         16  PB-C-AH-CALC-REQ             PIC X.
  2125             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2126         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2127         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2128         16  PB-C-LAST-NAME               PIC X(15).
  2129         16  PB-C-REFUND-SW               PIC X.
  2130             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2131             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2132         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2133         16  PB-C-PAYEE-CODE              PIC X(6).
  2134         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2135         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2136         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2137         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2138         16  PB-C-REFERENCE               PIC X(12).
  2139         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2140         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2141         16  PB-C-POST-CARD-IND           PIC X.
  2142         16  PB-C-CANCEL-REASON           PIC X.
  2143         16  PB-C-REF-INTERFACE-SW        PIC X.
  2144         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2145         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2146         16  FILLER                       PIC X(01).
  2147*        16  FILLER                       PIC X(18).
  2148         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2149*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2150         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2151         16  PB-CANCELED-CERT-DATA.
  2152             20  PB-CI-INSURED-NAME.
  2153                 24  PB-CI-LAST-NAME      PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  40
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2154                 24  PB-CI-INITIALS       PIC XX.
  2155             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2156             20  PB-CI-INSURED-SEX        PIC X.
  2157             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2158             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2159             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2160             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2161             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2162             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2163             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2164             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2165             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2166             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2167             20  PB-CI-RATE-CLASS         PIC XX.
  2168             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2169             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2170             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2171             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2172             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2173             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2174             20  PB-CI-LF-ABBR            PIC X(3).
  2175             20  PB-CI-AH-ABBR            PIC X(3).
  2176             20  PB-CI-OB-FLAG            PIC X.
  2177                 88  PB-CI-OB                VALUE 'B'.
  2178             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2179                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2180                                           'M' '4' '5' '9' '2'.
  2181                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2182                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2183                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2184                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2185                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2186                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2187                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2188                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2189                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2190                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2191                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2192                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2193             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2194                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2195                                           'M' '4' '5' '9' '2'.
  2196                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2197                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2198                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2199                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2200                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2201                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2202                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2203                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2204                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2205                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2206                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2207                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2208             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2209             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2210             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2211             20  PB-CI-MEMBER-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  41
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2212             20  PB-CI-INT-CODE           PIC X.
  2213                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2214                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2215             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2216             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2217             20  PB-CI-COMP-EXCP-SW       PIC X.
  2218                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2219                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2220             20  PB-CI-ENTRY-STATUS       PIC X.
  2221             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2222             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2223             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2224             20  PB-CI-DEATH-DT           PIC XX.
  2225             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2226             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2227             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2228             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2229             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2230             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2231             20  PB-CI-ENTRY-DT              PIC XX.
  2232             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2233             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2234             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2235             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2236             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2237             20  PB-CI-OLD-LOF               PIC XXX.
  2238*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2239             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2240             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2241             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2242             20  PB-CI-INDV-GRP-CD           PIC X.
  2243             20  PB-CI-BENEFICIARY-NAME.
  2244                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2245                 24  FILLER                  PIC X(15).
  2246             20  PB-CI-NOTE-SW               PIC X.
  2247             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2248             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2249             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2250             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2251             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2252             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2253             20  PB-CI-FIRST-NAME            PIC X(10).
  2254             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2255
  2256         16  FILLER                       PIC X(13).
  2257*032306  16  FILLER                       PIC X(27).
  2258*        16  FILLER                       PIC X(46).
  2259
  2260     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2261         16  FILLER                       PIC X(10).
  2262         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2263         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2264         16  PB-M-INSURED-MID-INIT        PIC X.
  2265         16  PB-M-INSURED-AGE             PIC 99.
  2266         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2267         16  PB-M-INSURED-SEX             PIC X.
  2268         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2269         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  42
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2270         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2271         16  PB-M-INSURED-CITY-STATE.
  2272             20  PB-M-INSURED-CITY        PIC X(28).
  2273             20  PB-M-INSURED-STATE       PIC XX.
  2274         16  PB-M-INSURED-ZIP-CODE.
  2275             20  PB-M-INSURED-ZIP-PRIME.
  2276                 24  PB-M-INSURED-ZIP-1   PIC X.
  2277                     88  PB-M-CANADIAN-POST-CODE
  2278                                             VALUE 'A' THRU 'Z'.
  2279                 24  FILLER               PIC X(4).
  2280             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2281         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2282                                        PB-M-INSURED-ZIP-CODE.
  2283             20  PM-M-INS-CAN-POST1       PIC XXX.
  2284             20  PM-M-INS-CAN-POST2       PIC XXX.
  2285             20  FILLER                   PIC XXX.
  2286         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2287         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2288         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2289         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2290         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2291         16  PB-M-CRED-BENE-CITYST.
  2292             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2293             20  PB-M-CRED-BENE-STATE     PIC XX.
  2294
  2295         16  FILLER                       PIC X(92).
  2296
  2297     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2298         16  FILLER                       PIC X(10).
  2299         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2300         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2301         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2302         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2303         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2304         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2305         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2306         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2307         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2308         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2309         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2310         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2311         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2312         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2313         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2314         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2315         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2316         16  PB-ACCOUNT-NAME              PIC X(30).
  2317         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2318         16  PB-REFERENCE                 PIC X(12).
  2319         16  PB-B-RECEIVED-DT             PIC XX.
  2320         16  FILLER                       PIC X(234).
  2321
  2322     12  PB-RECORD-STATUS.
  2323         16  PB-CREDIT-SELECT-DT          PIC XX.
  2324         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2325         16  PB-BILLED-DT                 PIC XX.
  2326         16  PB-BILLING-STATUS            PIC X.
  2327             88  PB-ENTRY-REVERSED            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  43
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2328             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2329             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2330         16  PB-RECORD-BILL               PIC X.
  2331             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2332             88  PB-RECORD-RETURNED           VALUE 'R'.
  2333             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2334             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2335             88  PB-OVERRIDE-AH               VALUE 'A'.
  2336             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2337         16  PB-BATCH-ENTRY               PIC X.
  2338             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2339             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2340             88  PB-REISSUED-CERT             VALUE 'E'.
  2341             88  PB-MONTHLY-CERT              VALUE 'M'.
  2342             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2343             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2344             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2345         16  PB-FORCE-CODE                PIC X.
  2346             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2347             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2348             88  PB-CANCEL-FORCE              VALUE '8'.
  2349             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2350             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2351             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2352             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2353             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2354             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2355             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2356         16  PB-FATAL-FLAG                PIC X.
  2357             88  PB-FATAL-ERRORS              VALUE 'X'.
  2358         16  PB-FORCE-ER-CD               PIC X.
  2359             88  PB-FORCE-ERRORS              VALUE 'F'.
  2360             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2361         16  PB-WARN-ER-CD                PIC X.
  2362             88  PB-WARNING-ERRORS            VALUE 'W'.
  2363         16  FILLER                       PIC X.
  2364         16  PB-OUT-BAL-CD                PIC X.
  2365             88  PB-OUT-OF-BAL                VALUE 'O'.
  2366         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2367         16  PB-AH-OVERRIDE-L1            PIC X.
  2368         16  PB-INPUT-DT                  PIC XX.
  2369         16  PB-INPUT-BY                  PIC X(4).
  2370         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2371         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2372         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2373         16  PB-LF-EARNING-METHOD         PIC X.
  2374         16  PB-AH-EARNING-METHOD         PIC X.
  2375         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2376         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2377         16  PB-REIN-CD                   PIC XXX.
  2378         16  PB-LF-REFUND-TYPE            PIC X.
  2379         16  PB-AH-REFUND-TYPE            PIC X.
  2380         16  PB-ACCT-EFF-DT               PIC XX.
  2381         16  PB-ACCT-EXP-DT               PIC XX.
  2382         16  PB-COMPANY-ID                PIC X(3).
  2383         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2384         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2385         16  PB-SV-CARRIER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  44
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2386         16  PB-SV-GROUPING               PIC X(6).
  2387         16  PB-SV-STATE                  PIC XX.
  2388         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2389         16  PB-GA-BILLING-INFO.
  2390             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2391                                          PIC XX.
  2392         16  PB-SV-REMIT-TO  REDEFINES
  2393             PB-GA-BILLING-INFO           PIC X(10).
  2394         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2395         16  PB-I-LOAN-OFFICER            PIC X(5).
  2396         16  PB-I-VIN                     PIC X(17).
  2397
  2398         16  FILLER                       PIC X(04).
  2399         16  IMNET-BYPASS-SW              PIC X.
  2400
  2401******************************************************************
  2402*                COMMON EDIT ERRORS                              *
  2403******************************************************************
  2404
  2405     12  PB-COMMON-ERRORS.
  2406         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2407                                           PIC S9(4)     COMP.
  2408
  2409******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  45
* EL517.cbl
  2411 FD  ERREIN.
* 2412                                  COPY ERCREIN.
  2413******************************************************************07/27/93
  2414*                                                                *ERCREIN
  2415*                            ERCREIN                             *   LV009
  2416*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2417*                            VMOD=2.010                          *   CL**9
  2418*                                                                *ERCREIN
  2419*   ONLINE CREDIT SYSTEM                                         *ERCREIN
  2420*                                                                *ERCREIN
  2421*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
  2422*                                                                *ERCREIN
  2423*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
  2424*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
  2425*                                                                *ERCREIN
  2426*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
  2427*       ALTERNATE PATH = NONE                                    *ERCREIN
  2428*                                                                *ERCREIN
  2429*   LOG = NO                                                     *ERCREIN
  2430*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
  2431*                                                                *ERCREIN
  2432******************************************************************ERCREIN
  2433*                   C H A N G E   L O G
  2434*
  2435* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2436*-----------------------------------------------------------------
  2437*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2438* EFFECTIVE    NUMBER
  2439*-----------------------------------------------------------------
  2440* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  2441* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  2442******************************************************************
  2443 01  REINSURANCE-RECORD.                                          ERCREIN
  2444     12  RE-RECORD-ID                      PIC XX.                ERCREIN
  2445         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
  2446                                                                  ERCREIN
  2447     12  RE-CONTROL-PRIMARY.                                      ERCREIN
  2448         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
  2449         16  RE-KEY.                                              ERCREIN
  2450             20  RE-CODE                   PIC X.                 ERCREIN
  2451                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
  2452                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
  2453             20  RE-TABLE                  PIC XXX.               ERCREIN
  2454             20  FILLER                    PIC XXX.               ERCREIN
  2455         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
  2456             20  FILLER                    PIC X.                 ERCREIN
  2457             20  RE-COMPANY.                                      ERCREIN
  2458                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
  2459                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
  2460                                                                  ERCREIN
  2461     12  RE-MAINT-INFORMATION.                                    ERCREIN
  2462         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
  2463         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
  2464         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
  2465         16  FILLER                        PIC X(10).             ERCREIN
  2466                                                                  ERCREIN
  2467     12  RE-TABLE-DATA.                                           ERCREIN
  2468         16  RE-100-COMP                   PIC 99.                ERCREIN
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  46
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2469                                                                  ERCREIN
  2470         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
  2471             20  RE-REI-COMP-NO.                                  ERCREIN
  2472                 24  RE-REI-COMP           PIC XXX.               ERCREIN
  2473                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
  2474             20  RE-LF-QC                  PIC X.                 ERCREIN
  2475             20  RE-AH-QC                  PIC X.                 ERCREIN
  2476             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2477             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2478             20  RE-LFAGE-LO               PIC 99.                ERCREIN
  2479             20  RE-LFAGE-HI               PIC 99.                ERCREIN
  2480             20  RE-AHAGE-LO               PIC 99.                ERCREIN
  2481             20  RE-AHAGE-HI               PIC 99.                ERCREIN
  2482             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
  2483             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
  2484             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
  2485             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
  2486             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2487             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2488             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
  2489             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
  2490             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
  2491             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
  2492             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2493             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2494             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2495             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2496             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2497             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2498             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2499             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2500             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
  2501             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
  2502             20  RE-INTERACTIVE            PIC X.                 ERCREIN
  2503             20  RE-REMAINING              PIC X.                 ERCREIN
  2504             20  RE-LF-RUNOFF-SW           PIC X.                      000
  2505             20  RE-AH-RUNOFF-SW           PIC X.                      000
  2506             20  FILLER                    PIC X(19).                  000
  2507                                                                  ERCREIN
  2508         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
  2509         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
  2510         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
  2511         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
  2512             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
  2513                                                                  ERCREIN
  2514         16  FILLER                        PIC X(27).             ERCREIN
  2515                                                                  ERCREIN
  2516     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
  2517         16  RE-NAME                       PIC X(30).             ERCREIN
  2518         16  RE-LF-PE                      PIC X.                 ERCREIN
  2519         16  RE-AH-PE                      PIC X.                 ERCREIN
  2520         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2521         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2522         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2523         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2524         16  RE-PRT-ST                     PIC X.                 ERCREIN
  2525         16  RE-PRT-OW                     PIC X.                 ERCREIN
  2526         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  47
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2527         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
  2528         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
  2529         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
  2530         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
  2531         16  RE-LF-COMM                    PIC X.                 ERCREIN
  2532         16  RE-AH-COMM                    PIC X.                 ERCREIN
  2533         16  RE-LF-TAX                     PIC X.                 ERCREIN
  2534         16  RE-AH-TAX                     PIC X.                 ERCREIN
  2535         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
  2536         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2537         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2538                                                                  ERCREIN
  2539         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
  2540             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
  2541                                                                  ERCREIN
  2542         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
  2543             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
  2544                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2545                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2546                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2547                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2548             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
  2549                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
  2550                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
  2551                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2552                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
  2553                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2554                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2555                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2556                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2557             20  FILLER                    PIC XXX.               ERCREIN
  2558             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2559                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2560                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2561                                                                  ERCREIN
  2562         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
  2563             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
  2564                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2565                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2566                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2567                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2568             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
  2569                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
  2570                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
  2571                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2572                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
  2573                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2574                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2575                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2576                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2577             20  FILLER                    PIC XXX.               ERCREIN
  2578             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2579                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2580                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2581                                                                  ERCREIN
  2582         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
  2583                                                                  ERCREIN
  2584         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  48
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2585                                                                  ERCREIN
  2586         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2587         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2588         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2589         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2590         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2591         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2592         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
  2593         16  RE-MORT-SW                    PIC X.                 ERCREIN
  2594         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
  2595             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
  2596             88  RE-CEDED                          VALUE 'C'.        CL**2
  2597             88  RE-ASSUMED                        VALUE 'A'.        CL**2
  2598             88  RE-PHANTOM                        VALUE 'P'.        CL**2
  2599                                                                  ERCREIN
  2600         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
  2601             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
  2602         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
  2603             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
  2604         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
  2605             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
  2606         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
  2607             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
  2608         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  2609             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  2610                                                                     CL**3
  2611         16  RE-PRT-CRSV                   PIC X.                    CL**5
  2612                                                                     CL**5
  2613         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  2614                                                                     CL**8
  2615         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  2616                                                                     CL**8
  2617         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  2618                                                                     CL**9
  2619         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  2620             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  2621             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  2622
  2623         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  2624             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  2625                                                                     CL**9
  2626         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  2627         16  FILLER                        PIC X(2281).              CL**9
  2628                                                                  ERCREIN
  2629         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  2630                                                                  ERCREIN
  2631******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  49
* EL517.cbl
  2633 FD  ELCERT.
* 2634                                  COPY ELCCERT.
  2635******************************************************************04/15/98
  2636*                                                                *ELCCERT
  2637*                            ELCCERT.                            *   LV002
  2638*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2639*                            VMOD=2.013                          *   CL**2
  2640*                                                                *ELCCERT
  2641*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
  2642*                                                                *ELCCERT
  2643*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
  2644*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
  2645*                                                                *ELCCERT
  2646*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
  2647*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
  2648*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
  2649*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
  2650*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
  2651*                                                                *ELCCERT
  2652*   LOG = YES                                                    *ELCCERT
  2653*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
  2654******************************************************************
  2655*                   C H A N G E   L O G
  2656*
  2657* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2658*-----------------------------------------------------------------
  2659*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2660* EFFECTIVE    NUMBER
  2661*-----------------------------------------------------------------
  2662* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2663* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2664* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2665* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2666* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2667* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2668* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2669* 032612  CR2011110200001  PEMA  AHL CHANGES
  2670******************************************************************
  2671                                                                  ELCCERT
  2672 01  CERTIFICATE-MASTER.                                          ELCCERT
  2673     12  CM-RECORD-ID                      PIC XX.                ELCCERT
  2674         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
  2675                                                                  ELCCERT
  2676     12  CM-CONTROL-PRIMARY.                                      ELCCERT
  2677         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
  2678         16  CM-CARRIER                    PIC X.                 ELCCERT
  2679         16  CM-GROUPING.                                         ELCCERT
  2680             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
  2681             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
  2682         16  CM-STATE                      PIC XX.                ELCCERT
  2683         16  CM-ACCOUNT.                                          ELCCERT
  2684             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
  2685             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
  2686         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
  2687         16  CM-CERT-NO.                                          ELCCERT
  2688             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
  2689             20  CM-CERT-SFX               PIC X.                 ELCCERT
  2690                                                                  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  50
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2691     12  CM-CONTROL-BY-NAME.                                      ELCCERT
  2692         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
  2693         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
  2694         16  CM-INSURED-INITIALS.                                 ELCCERT
  2695             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
  2696             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
  2697                                                                  ELCCERT
  2698     12  CM-CONTROL-BY-SSN.                                       ELCCERT
  2699         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
  2700         16  CM-SOC-SEC-NO.                                       ELCCERT
  2701             20  CM-SSN-STATE              PIC XX.                ELCCERT
  2702             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
  2703             20  CM-SSN-LN3.                                      ELCCERT
  2704                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
  2705                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
  2706                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
  2707                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
  2708                                                                  ELCCERT
  2709     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
  2710         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
  2711         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
  2712                                                                  ELCCERT
  2713     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
  2714         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
  2715         16  CM-MEMBER-NO.                                        ELCCERT
  2716             20  CM-MEMB-STATE             PIC XX.                ELCCERT
  2717             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
  2718             20  CM-MEMB-LN4.                                     ELCCERT
  2719                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
  2720                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
  2721                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
  2722                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
  2723                                                                  ELCCERT
  2724     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
  2725         16  CM-INSURED-FIRST-NAME.                               ELCCERT
  2726             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
  2727             20  FILLER                    PIC X(9).              ELCCERT
  2728         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
  2729         16  CM-INSURED-SEX                PIC X.                 ELCCERT
  2730             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
  2731             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
  2732         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
  2733         16  CM-JOINT-INSURED-NAME.                               ELCCERT
  2734             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
  2735             20  CM-JT-FIRST-NAME.                                ELCCERT
  2736                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
  2737                 24  FILLER                PIC X(9).              ELCCERT
  2738             20  CM-JT-INITIAL             PIC X.                 ELCCERT
  2739                                                                  ELCCERT
  2740     12  CM-LIFE-DATA.                                            ELCCERT
  2741         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
  2742         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2743         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2744         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
  2745         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
  2746         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2747         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
  2748         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  51
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2749         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
  2750         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2751         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2752         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2753         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2754         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2755         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2756         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2757         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
  2758         16  FILLER                        PIC XX.                ELCCERT
  2759                                                                  ELCCERT
  2760     12  CM-AH-DATA.                                              ELCCERT
  2761         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
  2762         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2763         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2764         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
  2765         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2766         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2767         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2768         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2769         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2770         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
  2771         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
  2772         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
  2773             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
  2774         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2775         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2776         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
  2777         16  FILLER                        PIC X.                 ELCCERT
  2778                                                                  ELCCERT
  2779     12  CM-LOAN-INFORMATION.                                     ELCCERT
  2780         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
  2781         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2782                                           PIC S9(5)V99  COMP-3.
  2783         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
  2784         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
  2785         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
  2786         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
  2787         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
  2788         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
  2789         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
  2790         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
  2791         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
  2792         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
  2793             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
  2794             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
  2795         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
  2796             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
  2797             20  CM-RATE-CODE              PIC X(4).              ELCCERT
  2798             20  FILLER                    PIC XX.                ELCCERT
  2799         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
  2800             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
  2801             20  FILLER                    PIC XXX.               ELCCERT
  2802         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
  2803         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
  2804             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
  2805         16  CM-POST-CARD-IND              PIC X.
  2806         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  52
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2807         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
  2808             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
  2809             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
  2810             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
  2811         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
  2812             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
  2813             88  CM-GROUP                     VALUE 'G'.          ELCCERT
  2814         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
  2815             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
  2816             88  SKIP-JULY                    VALUE '1'.          ELCCERT
  2817             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
  2818             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
  2819             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
  2820             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
  2821             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
  2822             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
  2823             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
  2824             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
  2825             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
  2826             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
  2827         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
  2828             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
  2829             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
  2830             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
  2831             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
  2832             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
  2833         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
  2834         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
  2835         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
  2836*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
  2837         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
  2838         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
  2839         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2840         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2841         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
  2842                                                                  ELCCERT
  2843     12  CM-STATUS-DATA.                                          ELCCERT
  2844         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
  2845         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
  2846                                                                  ELCCERT
  2847         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2848         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
  2849         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2850                                                                  ELCCERT
  2851         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
  2852         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
  2853         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
  2854                                                                  ELCCERT
  2855         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
  2856             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2857                                                'M' '4' '5' '9'.  ELCCERT
  2858             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2859             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
  2860             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2861             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2862             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2863             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2864             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  53
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2865             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2866             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2867             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2868             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
  2869             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
  2870                                                                  ELCCERT
  2871         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2872         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
  2873         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2874                                                                  ELCCERT
  2875         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
  2876         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
  2877         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
  2878                                                                  ELCCERT
  2879         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
  2880             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2881                                                'M' '4' '5' '9'.  ELCCERT
  2882             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2883             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
  2884             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2885             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2886             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2887             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2888             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
  2889             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2890             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2891             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2892             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
  2893             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
  2894                                                                  ELCCERT
  2895         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
  2896             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
  2897             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
  2898             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
  2899         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
  2900                                                                  ELCCERT
  2901         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
  2902         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
  2903         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
  2904         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
  2905                                                                  ELCCERT
  2906     12  CM-NOTE-SW                        PIC X.                 ELCCERT
  2907         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
  2908         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
  2909         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
  2910         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
  2911         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2912         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2913         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2914         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2915     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
  2916         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
  2917         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
  2918     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
  2919         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
  2920         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
  2921                                                                  ELCCERT
  2922*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  54
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2923     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2924     12  FILLER                            PIC X.
  2925                                                                  ELCCERT
  2926*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2927     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2928     12  FILLER                            PIC X.
  2929*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2930     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
  2931                                                                  ELCCERT
  2932     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
  2933         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
  2934         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
  2935         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
  2936         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
  2937         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
  2938     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
  2939         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
  2940         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
  2941         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
  2942         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
  2943         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
  2944         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
  2945         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
  2946         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
  2947                                                                  ELCCERT
  2948     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
  2949         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
  2950         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
  2951                                                                  ELCCERT
  2952     12  CM-USER-FIELD                     PIC X.                 ELCCERT
  2953     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2954     12  CM-CLP-STATE                      PIC XX.
  2955     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2956     12  CM-USER-RESERVED                  PIC XXX.
  2957     12  FILLER REDEFINES CM-USER-RESERVED.
  2958         16  CM-AH-CLASS-CD                PIC XX.
  2959         16  F                             PIC X.
  2960******************************************************************ELCCERT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  55
* EL517.cbl
  2962 FD  ELMSTR.
* 2963                                  COPY ELCMSTR.
  2964******************************************************************04/15/98
  2965*                                                                *ELCMSTR
  2966*                            ELCMSTR.                            *   LV002
  2967*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2968*                            VMOD=2.012                          *   CL**2
  2969*                                                                *ELCMSTR
  2970*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
  2971*                                                                *ELCMSTR
  2972*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
  2973*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
  2974*                                                                *ELCMSTR
  2975*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
  2976*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
  2977*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
  2978*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
  2979*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
  2980*                                                 RKP=75,LEN=21  *ELCMSTR
  2981*                                                                *ELCMSTR
  2982*   **** NOTE ****                                               *ELCMSTR
  2983*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
  2984*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
  2985*                                                                *ELCMSTR
  2986*   LOG = YES                                                    *ELCMSTR
  2987*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
  2988******************************************************************
  2989*                   C H A N G E   L O G
  2990*
  2991* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2992*-----------------------------------------------------------------
  2993*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2994* EFFECTIVE    NUMBER
  2995*-----------------------------------------------------------------
  2996* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2997* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  2998* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  2999******************************************************************ELCMSTR
  3000 01  CLAIM-MASTER.                                                ELCMSTR
  3001     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
  3002         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
  3003                                                                  ELCMSTR
  3004     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
  3005         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
  3006         16  CL-CARRIER              PIC X.                       ELCMSTR
  3007         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
  3008         16  CL-CERT-NO.                                          ELCMSTR
  3009             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
  3010             20  CL-CERT-SFX         PIC X.                       ELCMSTR
  3011                                                                  ELCMSTR
  3012     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
  3013         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
  3014         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
  3015         16  CL-INSURED-NAME.                                     ELCMSTR
  3016             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
  3017             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
  3018                                                                  ELCMSTR
  3019     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  56
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3020         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
  3021         16  CL-SOC-SEC-NO.                                       ELCMSTR
  3022             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
  3023             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
  3024             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
  3025                                                                  ELCMSTR
  3026     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
  3027         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
  3028         16  CL-CERT-NO-A4.                                       ELCMSTR
  3029             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
  3030             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
  3031                                                                  ELCMSTR
  3032     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
  3033         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
  3034         16  CL-CCN-A5.                                           ELCMSTR
  3035             20  CL-CCN.                                          ELCMSTR
  3036                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
  3037                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
  3038             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
  3039                                                                  ELCMSTR
  3040     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
  3041         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
  3042         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
  3043             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
  3044             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
  3045             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
  3046         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
  3047         16  FILLER                  PIC X(5).                    ELCMSTR
  3048                                                                  ELCMSTR
  3049     12  CL-PROCESSING-INFO.                                      ELCMSTR
  3050         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
  3051         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
  3052             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
  3053             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
  3054         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
  3055*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
  3056*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
  3057*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
  3058*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
  3059*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
  3060         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
  3061             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
  3062             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
  3063             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
  3064         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
  3065         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
  3066         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
  3067         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
  3068         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
  3069         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
  3070         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
  3071         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
  3072         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
  3073         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
  3074         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
  3075             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
  3076             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
  3077             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  57
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3078         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
  3079                                                                  ELCMSTR
  3080         16  CL-PRIME-CERT-NO.                                    ELCMSTR
  3081             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
  3082             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
  3083                                                                  ELCMSTR
  3084         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
  3085             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
  3086             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
  3087                                                                  ELCMSTR
  3088         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
  3089         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
  3090         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
  3091                                                                  ELCMSTR
  3092         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
  3093         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
  3094         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
  3095             88  FINAL-PAID             VALUE '1'.                ELCMSTR
  3096             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
  3097             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
  3098             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
  3099             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
  3100             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
  3101         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
  3102         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
  3103         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
  3104             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
  3105         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3106         16  FILLER                  PIC X.
  3107                                                                  ELCMSTR
  3108     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
  3109         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
  3110             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
  3111             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
  3112             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
  3113         16  CL-CERT-KEY-DATA.                                    ELCMSTR
  3114             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
  3115             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
  3116             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
  3117             20  CL-CERT-ACCOUNT.                                 ELCMSTR
  3118                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
  3119                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
  3120             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
  3121                                                                  ELCMSTR
  3122     12  CL-STATUS-CONTROLS.                                      ELCMSTR
  3123         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
  3124             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
  3125             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
  3126         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
  3127             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
  3128             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
  3129         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
  3130         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
  3131         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
  3132         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
  3133         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
  3134         16  CL-CRITICAL-PERIOD      PIC 99.
  3135*        16  FILLER                  PIC XX.                      ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  58
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3136         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
  3137         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
  3138         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
  3139         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
  3140             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
  3141             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
  3142             88  LETTER-SENT            VALUE '2'.                ELCMSTR
  3143             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
  3144             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
  3145             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
  3146             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
  3147             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
  3148             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
  3149         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
  3150         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
  3151         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
  3152         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
  3153         16  CL-DENIAL-TYPE          PIC X.
  3154             88  CL-TYPE-DENIAL          VALUE '1'.
  3155             88  CL-TYPE-RESCISSION      VALUE '2'.
  3156             88  CL-TYPE-REFORMATION     VALUE '3'.
  3157             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3158             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3159         16  CL-CRIT-PER-RECURRENT   PIC X.
  3160         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3161         16  CL-RTW-DT               PIC XX.
  3162                                                                  ELCMSTR
  3163     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
  3164         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
  3165             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
  3166             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
  3167             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
  3168         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
  3169         16  FILLER                  PIC XX.                      ELCMSTR
  3170         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
  3171         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
  3172             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3173                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
  3174             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3175                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
  3176             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
  3177                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
  3178             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
  3179                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
  3180             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
  3181                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
  3182             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3183                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
  3184             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3185                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
  3186                                                                  ELCMSTR
  3187     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
  3188         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
  3189         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
  3190                                                                  ELCMSTR
  3191     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
  3192                                                                  ELCMSTR
  3193     12  CL-PROCESS-ERRORS.                                       ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  59
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3194         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
  3195             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
  3196         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
  3197             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
  3198                                                                  ELCMSTR
  3199     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
  3200                                                                  ELCMSTR
  3201     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
  3202         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
  3203         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
  3204         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
  3205         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
  3206                                                                  ELCMSTR
  3207     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
  3208         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
  3209         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
  3210         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
  3211         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
  3212                                                                  ELCMSTR
  3213     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
  3214     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
  3215     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
  3216                                                                  ELCMSTR
  3217     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
  3218     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
  3219     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
  3220     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
  3221                                                                  ELCMSTR
  3222     12  CL-YESNOSW                  PIC X.                       ELCMSTR
  3223     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3224         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3225         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3226         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3227     12  cl-insured-claim            pic x.
  3228         88  cl-claim-on-primary         value 'P'.
  3229         88  cl-claim-on-secondary       value 'S'.
  3230     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  60
* EL517.cbl
  3232 FD  ERCTBL.
* 3233                                 COPY ERCCTBL.
  3234******************************************************************04/29/98
  3235*                                                                *ERCCTBL
  3236*                                                                *ERCCTBL
  3237*                            ERCCTBL                             *   LV002
  3238*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3239*                            VMOD=2.003                              CL**2
  3240*                                                                *ERCCTBL
  3241*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  3242*                                                                *ERCCTBL
  3243*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  3244*                                                                *ERCCTBL
  3245*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  3246*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  3247*                                                                *ERCCTBL
  3248*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  3249*       ALTERNATE PATH = NONE                                    *ERCCTBL
  3250*                                                                *ERCCTBL
  3251*   LOG = NO                                                     *ERCCTBL
  3252*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  3253*                                                                *ERCCTBL
  3254*                                                                *ERCCTBL
  3255******************************************************************ERCCTBL
  3256                                                                  ERCCTBL
  3257 01  COMM-TABLE-RECORD.                                           ERCCTBL
  3258     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  3259         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  3260                                                                  ERCCTBL
  3261     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  3262         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  3263         16  CT-TABLE                      PIC XXX.               ERCCTBL
  3264         16  CT-CNTRL-2.                                          ERCCTBL
  3265             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  3266             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  3267                                                                  ERCCTBL
  3268     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  3269         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  3270         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  3271         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  3272         16  FILLER                        PIC X(31).             ERCCTBL
  3273                                                                  ERCCTBL
  3274     12  CT-LIMITS.                                               ERCCTBL
  3275         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  3276                                                                  ERCCTBL
  3277         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  3278                                                                  ERCCTBL
  3279         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  3280                                                                  ERCCTBL
  3281     12  CT-RATES.                                                ERCCTBL
  3282         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  3283             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  3284             20  CT-RT-R   REDEFINES                              ERCCTBL
  3285                 CT-RT                     PIC XXX.               ERCCTBL
  3286                                                                  ERCCTBL
  3287     12  FILLER                            PIC  X(42).            ERCCTBL
  3288                                                                  ERCCTBL
  3289******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  61
* EL517.cbl
  3290
  3291 FD  ERACCT.
* 3292                                 COPY ERCACCT.
  3293******************************************************************04/19/98
  3294*                                                                *ERCACCT
  3295*                                                                *ERCACCT
  3296*                            ERCACCT                             *   LV031
  3297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
  3298*                            VMOD=2.031                          *ERCACCT
  3299*                                                                *ERCACCT
  3300*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
  3301*                                                                *ERCACCT
  3302*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
  3303*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
  3304*                                                                *ERCACCT
  3305*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
  3306*                                                                *ERCACCT
  3307*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
  3308*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
  3309*                                                                *ERCACCT
  3310*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
  3311*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
  3312*                                                                *ERCACCT
  3313*   LOG = NO                                                     *ERCACCT
  3314*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
  3315*                                                                *ERCACCT
  3316*                                                                *ERCACCT
  3317******************************************************************ERCACCT
  3318*                   C H A N G E   L O G
  3319*
  3320* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3321*-----------------------------------------------------------------
  3322*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3323* EFFECTIVE    NUMBER
  3324*-----------------------------------------------------------------
  3325* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3326* 092705    2005050300006  PEMA  ADD SPP LEASES
  3327* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3328* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3329* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3330* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3331* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3332******************************************************************
  3333                                                                  ERCACCT
  3334 01  ACCOUNT-MASTER.                                              ERCACCT
  3335     12  AM-RECORD-ID                      PIC XX.                ERCACCT
  3336         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
  3337                                                                  ERCACCT
  3338     12  AM-CONTROL-PRIMARY.                                      ERCACCT
  3339         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
  3340         16  AM-MSTR-CNTRL.                                       ERCACCT
  3341             20  AM-CONTROL-A.                                    ERCACCT
  3342                 24  AM-CARRIER            PIC X.                 ERCACCT
  3343                 24  AM-GROUPING.                                 ERCACCT
  3344                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
  3345                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
  3346                 24  AM-STATE              PIC XX.                ERCACCT
  3347                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  62
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3348                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
  3349                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
  3350             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
  3351                                           PIC X(19).             ERCACCT
  3352             20  AM-CNTRL-B.                                      ERCACCT
  3353                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
  3354                 24  FILLER                PIC X(4).              ERCACCT
  3355             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
  3356                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
  3357                                                                  ERCACCT
  3358     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
  3359         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
  3360         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
  3361         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
  3362         16  AM-VG-STATE                   PIC XX.                ERCACCT
  3363         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
  3364         16  AM-VG-DATE.                                          ERCACCT
  3365             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
  3366             20  FILLER                    PIC X(4).              ERCACCT
  3367         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
  3368                                           PIC 9(11)      COMP-3. ERCACCT
  3369     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3370         16  FILLER                        PIC X(10).
  3371         16  AM-VG-KEY3.
  3372             20  AM-VG3-ACCOUNT            PIC X(10).
  3373             20  AM-VG3-EXP-DT             PIC XX.
  3374         16  FILLER                        PIC X(4).
  3375     12  AM-MAINT-INFORMATION.                                    ERCACCT
  3376         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
  3377         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
  3378         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
  3379         16  FILLER                        PIC XX.                ERCACCT
  3380                                                                  ERCACCT
  3381     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
  3382     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
  3383                                                                  ERCACCT
  3384     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
  3385         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
  3386         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
  3387                                                                  ERCACCT
  3388     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
  3389     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
  3390                                                                  ERCACCT
  3391     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
  3392     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
  3393                                                                  ERCACCT
  3394     12  AM-NAME                           PIC X(30).             ERCACCT
  3395     12  AM-PERSON                         PIC X(30).             ERCACCT
  3396     12  AM-ADDRS                          PIC X(30).             ERCACCT
  3397     12  AM-CITY.
  3398         16  AM-ADDR-CITY                  PIC X(28).
  3399         16  AM-ADDR-STATE                 PIC XX.
  3400     12  AM-ZIP.                                                  ERCACCT
  3401         16  AM-ZIP-PRIME.                                        ERCACCT
  3402             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
  3403                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
  3404             20  FILLER                    PIC X(4).              ERCACCT
  3405         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  63
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3406     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
  3407         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
  3408         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
  3409         16  FILLER                        PIC XXX.               ERCACCT
  3410     12  AM-TEL-NO.                                               ERCACCT
  3411         16  AM-AREA-CODE                  PIC 999.               ERCACCT
  3412         16  AM-TEL-PRE                    PIC 999.               ERCACCT
  3413         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
  3414     12  AM-TEL-LOC                        PIC X.                 ERCACCT
  3415         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
  3416         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
  3417                                                                  ERCACCT
  3418     12  AM-COMM-STRUCTURE.                                       ERCACCT
  3419         16  AM-DEFN-1.                                           ERCACCT
  3420             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
  3421                 24  AM-AGT.                                      ERCACCT
  3422                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
  3423                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
  3424                 24  AM-COM-TYP            PIC X.                 ERCACCT
  3425                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
  3426                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
  3427                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
  3428                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
  3429                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
  3430                 24  AM-GL-CODES           PIC X.                 ERCACCT
  3431                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
  3432                 24  FILLER                PIC X(01).             ERCACCT
  3433         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
  3434             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
  3435                 24  FILLER                PIC X(11).             ERCACCT
  3436                 24  AM-L-COMA             PIC XXX.               ERCACCT
  3437                 24  AM-J-COMA             PIC XXX.               ERCACCT
  3438                 24  AM-A-COMA             PIC XXX.               ERCACCT
  3439                 24  FILLER                PIC X(6).              ERCACCT
  3440                                                                  ERCACCT
  3441     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
  3442         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
  3443                                                                  ERCACCT
  3444     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
  3445                                                                  ERCACCT
  3446     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
  3447         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
  3448         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
  3449     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
  3450         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
  3451         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
  3452     12  AM-GPCD                           PIC 99.                ERCACCT
  3453     12  AM-IG                             PIC X.                 ERCACCT
  3454         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
  3455         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
  3456     12  AM-STATUS                         PIC X.                 ERCACCT
  3457         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
  3458         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
  3459         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
  3460         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3461         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3462         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3463     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  64
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3464     12  AM-ID-NO                          PIC X(11).             ERCACCT
  3465                                                                  ERCACCT
  3466     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
  3467     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
  3468     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
  3469     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3470     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3471     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3472     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3473     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3474     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3475                                                                  ERCACCT
  3476     12  AM-USER-FIELDS.                                          ERCACCT
  3477         16  AM-FLD-1                      PIC XX.                ERCACCT
  3478         16  AM-FLD-2                      PIC XX.                ERCACCT
  3479         16  AM-FLD-3                      PIC XX.                ERCACCT
  3480         16  AM-FLD-4                      PIC XX.                ERCACCT
  3481         16  AM-FLD-5                      PIC XX.                ERCACCT
  3482                                                                  ERCACCT
  3483     12  AM-1ST-PROD-DATE.                                        ERCACCT
  3484         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
  3485         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
  3486         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
  3487     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
  3488     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
  3489         16  AM-PUR-YR                     PIC XX.                ERCACCT
  3490         16  AM-PUR-MO                     PIC XX.                ERCACCT
  3491         16  AM-PUR-DA                     PIC XX.                ERCACCT
  3492     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3493     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3494     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
  3495     12  AM-INACTIVE-DATE.                                        ERCACCT
  3496         16  AM-INA-MO                     PIC 99.                ERCACCT
  3497         16  AM-INA-DA                     PIC 99.                ERCACCT
  3498         16  AM-INA-YR                     PIC 99.                ERCACCT
  3499     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
  3500                                                                  ERCACCT
  3501     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3502     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3503                                                                  ERCACCT
  3504     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  3505         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  3506         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  3507         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  3508         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  3509                                                                  ERCACCT
  3510     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  3511         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  3512         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  3513                                                                  ERCACCT
  3514     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  3515                                                                  ERCACCT
  3516     12  AM-OVER-SHORT.                                           ERCACCT
  3517         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  3518         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  3519                                                                  ERCACCT
  3520     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3521     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  65
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3522                                                                  ERCACCT
  3523     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  3524     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  3525                                                                  ERCACCT
  3526     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  3527     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  3528     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  3529     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  3530     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  3531     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  3532     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  3533     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  3534     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3535     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  3536     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  3537     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  3538     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3539     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3540     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3541     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  3542                                                                  ERCACCT
  3543     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  3544                                                                  ERCACCT
  3545     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  3546     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  3547                                                                  ERCACCT
  3548     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  3549     12  AM-EARN-METHODS.                                         ERCACCT
  3550         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  3551             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  3552             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  3553             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  3554             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3555         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  3556             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  3557             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  3558             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  3559             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3560         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  3561             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  3562             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  3563             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  3564             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  3565             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  3566             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  3567                                                                  ERCACCT
  3568     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  3569     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  3570     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  3571                                                                  ERCACCT
  3572     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  3573     12  AM-RET-P-E                        PIC X.                 ERCACCT
  3574     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  3575     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  3576     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  3577     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  3578         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  3579         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  66
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3580     12  AM-RETRO-EARNINGS.                                       ERCACCT
  3581         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  3582         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  3583         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  3584     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  3585         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  3586         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  3587     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  3588         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  3589         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  3590         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  3591     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  3592     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  3593                                                                  ERCACCT
  3594     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  3595         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  3596         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  3597         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  3598         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  3599         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  3600                                                                  ERCACCT
  3601     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3602                                                                  ERCACCT
  3603     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3604                                                                  ERCACCT
  3605     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  3606         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  3607                                                                  ERCACCT
  3608     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  3609         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  3610         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  3611                                                                  ERCACCT
  3612     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  3613         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  3614                                                                  ERCACCT
  3615     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  3616         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  3617         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  3618                                                                  ERCACCT
  3619     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  3620                                                                  ERCACCT
  3621     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  3622     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3623     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3624     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3625     12  AM-DCC-UEF-STATE                  PIC XX.
  3626     12  FILLER                            PIC XXX.
  3627     12  AM-REPORT-CODE-3                  PIC X(10).
  3628*    12  FILLER                            PIC X(22).             ERCACCT
  3629                                                                  ERCACCT
  3630     12  AM-RESERVE-DATE.                                         ERCACCT
  3631         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  3632         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  3633         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  3634                                                                  ERCACCT
  3635     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  3636     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  3637         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  67
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3638         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
  3639         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  3640         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  3641                                                                  ERCACCT
  3642     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  3643         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  3644         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  3645         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  3646         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  3647                                                                  ERCACCT
  3648     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  3649         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  3650             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  3651             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  3652             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  3653             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  3654             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  3655             20  FILLER                    PIC XX.                ERCACCT
  3656         16  FILLER                        PIC X(80).             ERCACCT
  3657                                                                  ERCACCT
  3658     12  AM-TRANSFER-DATA.                                        ERCACCT
  3659         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  3660             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  3661             20  AM-TRNFROM-GROUPING.                             ERCACCT
  3662                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  3663                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  3664             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  3665             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  3666                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  3667                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  3668             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  3669         16  AM-TRANSFERRED-TO.                                   ERCACCT
  3670             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  3671             20  AM-TRNTO-GROUPING.                               ERCACCT
  3672                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  3673                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  3674             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  3675             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  3676                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  3677                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  3678             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  3679         16  FILLER                        PIC X(10).             ERCACCT
  3680                                                                  ERCACCT
  3681     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  3682                                                                  ERCACCT
  3683     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  3684         16  AM-DEFN-1-SAVED.                                     ERCACCT
  3685             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  3686                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  3687                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  3688                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3689                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3690                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3691                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  3692                 24  FILLER                PIC X.                 ERCACCT
  3693                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  3694                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  3695                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  68
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3696         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
  3697             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  3698                 24  FILLER                PIC X(11).             ERCACCT
  3699                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  3700                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  3701                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  3702                 24  FILLER                PIC X(6).              ERCACCT
  3703                                                                  ERCACCT
  3704     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  3705         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  3706            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  3707            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  3708            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  3709                                                                  ERCACCT
  3710     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  3711     12  FILLER                            PIC X(120).            ERCACCT
  3712                                                                  ERCACCT
  3713     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  3714         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  3715         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  3716             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  3717             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3718                                                          COMP-3. ERCACCT
  3719             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3720                                                          COMP-3. ERCACCT
  3721         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  3722             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  3723             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3724                                                          COMP-3. ERCACCT
  3725             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3726                                                          COMP-3. ERCACCT
  3727                                                                  ERCACCT
  3728     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  3729         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  3730         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  3731         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  3732         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  3733             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  3734                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  3735                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  3736             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  3737                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  3738                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  3739             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  3740                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  3741                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  3742         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  3743             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  3744                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  3745                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  3746                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  3747             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  3748                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  3749                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  3750             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  3751                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  3752                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  3753                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  69
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3754     12  AM-COMMENTS.                                             ERCACCT
  3755         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  3756                                                                  ERCACCT
  3757     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  3758         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  3759         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  3760         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  3761         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  3762         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  3763             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  3764             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  3765             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  3766             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  3767         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  3768             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  3769             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  3770             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  3771         16  FILLER                        PIC X(102).            ERCACCT
  3772                                                                  ERCACCT
  3773     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  3774         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  3775             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  3776             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  3777             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  3778             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  3779             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  3780         16  FILLER                          PIC X(10).           ERCACCT
  3781******************************************************************ERCACCT
  3782
  3783 FD  ELCERR.
* 3784                                 COPY ELCERRS.
  3785******************************************************************04/15/98
  3786*                                                                *ELCERRS
  3787*                                                                *ELCERRS
  3788*                            ELCERRS.                            *   LV002
  3789*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3790*                            VMOD 2.002                          *   CL**2
  3791*                                                                *ELCERRS
  3792*   FILE DESCRIPTION = SYSTEM ERROR MESSAGES                     *ELCERRS
  3793*                                                                *ELCERRS
  3794*   FILE TYPE = VSAM,KSDS                                        *ELCERRS
  3795*   RECORD SIZE = 72    RECFORM = FIX                            *ELCERRS
  3796*                                                                *ELCERRS
  3797*   BASE CLUSTER NAME = ELERRS                   RKP=2,LEN=4     *ELCERRS
  3798*       ALTERNATE PATH  = NOT USED                               *ELCERRS
  3799*                                                                *ELCERRS
  3800*   LOG = NO                                                     *ELCERRS
  3801*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCERRS
  3802******************************************************************ELCERRS
  3803 01  ERROR-MESSAGE-FILE.                                          ELCERRS
  3804     12  EM-RECORD-ID                PIC XX.                      ELCERRS
  3805         88  VALID-EM-ID                VALUE 'EM'.               ELCERRS
  3806                                                                  ELCERRS
  3807     12  EM-CONTROL-PRIMARY.                                      ELCERRS
  3808         16  EM-MESSAGE-NUMBER       PIC 9(4).                    ELCERRS
  3809                                                                  ELCERRS
  3810     12  EM-ERROR-TEXT.                                           ELCERRS
  3811         16  EM-ERROR-TEXT-PREFIX    PIC X(6).                    ELCERRS
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  70
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRS)
  3812         16  FILLER                  PIC X(59).                   ELCERRS
  3813                                                                  ELCERRS
  3814     12  EM-ERROR-SEVERITY           PIC X.                       ELCERRS
  3815         88  ERROR-IS-NOTE              VALUE 'N'.                ELCERRS
  3816         88  ERROR-IS-WARNING           VALUE 'W'.                ELCERRS
  3817         88  ERROR-IS-FORCABLE          VALUE 'F'.                ELCERRS
  3818         88  ERROR-IS-FATAL             VALUE 'X'.                ELCERRS
  3819                                                                  ELCERRS
  3820******************************************************************ELCERRS
  3821
  3822 FD  ERPNDM.
* 3823                                 COPY ERCPNDM.
  3824******************************************************************
  3825*                                                                *
  3826*                                                                *
  3827*                            ERCPNDM                             *
  3828*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3829*                            VMOD=2.003                          *
  3830*                                                                *
  3831*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  3832*                                                                *
  3833*   FILE TYPE = VSAM,KSDS                                        *
  3834*   RECORD SIZE = 374   RECFORM = FIX                            *
  3835*                                                                *
  3836*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  3837*   ALTERNATE PATH    = NOT USED                                 *
  3838*                                                                *
  3839*   LOG = YES                                                    *
  3840*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3841******************************************************************
  3842*                   C H A N G E   L O G
  3843*
  3844* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3845*-----------------------------------------------------------------
  3846*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3847* EFFECTIVE    NUMBER
  3848*-----------------------------------------------------------------
  3849* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3850* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  3851* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3852******************************************************************
  3853
  3854 01  PENDING-MAILING-DATA.
  3855     12  PM-RECORD-ID                      PIC XX.
  3856         88  VALID-MA-ID                       VALUE 'PM'.
  3857
  3858     12  PM-CONTROL-PRIMARY.
  3859         16  PM-COMPANY-CD                 PIC X.
  3860         16  PM-ENTRY-BATCH                PIC X(6).
  3861         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  3862         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  3863
  3864     12  FILLER                            PIC X(14).
  3865
  3866     12  PM-ACCESS-CONTROL.
  3867         16  PM-SOURCE-SYSTEM              PIC XX.
  3868             88  PM-FROM-CREDIT                VALUE 'CR'.
  3869             88  PM-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  71
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3870             88  PM-FROM-WARRANTY              VALUE 'WA'.
  3871             88  PM-FROM-OTHER                 VALUE 'OT'.
  3872         16  PM-RECORD-ADD-DT              PIC XX.
  3873         16  PM-RECORD-ADDED-BY            PIC XXXX.
  3874         16  PM-LAST-MAINT-DT              PIC XX.
  3875         16  PM-LAST-MAINT-BY              PIC XXXX.
  3876         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3877
  3878     12  PM-PROFILE-INFO.
  3879         16  PM-QUALIFY-CODE-1             PIC XX.
  3880         16  PM-QUALIFY-CODE-2             PIC XX.
  3881         16  PM-QUALIFY-CODE-3             PIC XX.
  3882         16  PM-QUALIFY-CODE-4             PIC XX.
  3883         16  PM-QUALIFY-CODE-5             PIC XX.
  3884
  3885         16  PM-INSURED-LAST-NAME          PIC X(15).
  3886         16  PM-INSURED-FIRST-NAME         PIC X(10).
  3887         16  PM-INSURED-MIDDLE-INIT        PIC X.
  3888         16  PM-INSURED-ISSUE-AGE          PIC 99.
  3889         16  PM-INSURED-BIRTH-DT           PIC XX.
  3890         16  PM-INSURED-SEX                PIC X.
  3891             88  PM-SEX-MALE                   VALUE 'M'.
  3892             88  PM-SEX-FEMALE                 VALUE 'F'.
  3893         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  3894
  3895         16  PM-ADDRESS-CORRECTED          PIC X.
  3896         16  PM-JOINT-BIRTH-DT             PIC XX.
  3897*        16  FILLER                        PIC X(12).
  3898
  3899         16  PM-ADDRESS-LINE-1             PIC X(30).
  3900         16  PM-ADDRESS-LINE-2             PIC X(30).
  3901         16  PM-CITY-STATE.
  3902             20  PM-CITY                   PIC X(28).
  3903             20  PM-STATE                  PIC XX.
  3904         16  PM-ZIP.
  3905             20  PM-ZIP-CODE.
  3906                 24  PM-ZIP-1              PIC X.
  3907                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3908                 24  FILLER                PIC X(4).
  3909             20  PM-ZIP-PLUS4              PIC X(4).
  3910         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  3911             20  PM-CAN-POST1              PIC XXX.
  3912             20  PM-CAN-POST2              PIC XXX.
  3913             20  FILLER                    PIC XXX.
  3914
  3915         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  3916
  3917         16  FILLER                        PIC X(03).
  3918
  3919     12  PM-CRED-BENE-INFO.
  3920         16  PM-CRED-BENE-NAME             PIC X(25).
  3921         16  PM-CRED-BENE-ADDR             PIC X(30).
  3922         16  PM-CRED-BENE-ADDR2            PIC X(30).
  3923         16  PM-CRED-BENE-CTYST.
  3924             20  PM-CRED-BENE-CITY         PIC X(28).
  3925             20  PM-CRED-BENE-STATE        PIC XX.
  3926         16  PM-CRED-BENE-ZIP.
  3927             20  PM-CB-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  72
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3928                 24  PM-CB-ZIP-1           PIC X.
  3929                     88  PM-CB-CANADIAN-POST-CODE
  3930                                  VALUE 'A' THRU 'Z'.
  3931                 24  FILLER                PIC X(4).
  3932             20  PM-CB-ZIP-PLUS4           PIC X(4).
  3933         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  3934             20  PM-CB-CAN-POST1           PIC XXX.
  3935             20  PM-CB-CAN-POST2           PIC XXX.
  3936             20  FILLER                    PIC XXX.
  3937     12  PM-POST-CARD-MAIL-DATA.
  3938         16  PM-MAIL-DATA OCCURS 7.
  3939             20  PM-MAIL-TYPE              PIC X.
  3940                 88  PM-12MO-MAILING           VALUE '1'.
  3941                 88  PM-EXP-MAILING            VALUE '2'.
  3942             20  PM-MAIL-STATUS            PIC X.
  3943                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  3944                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  3945                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  3946             20  PM-MAIL-DATE              PIC XX.
  3947     12  FILLER                            PIC XX.
  3948     12  FILLER                            PIC X(12).
  3949*    12  FILLER                            PIC X(30).
  3950
  3951******************************************************************
  3952
  3953 FD  ERMAIL.
* 3954                                 COPY ERCMAIL.
  3955******************************************************************
  3956*                                                                *
  3957*                                                                *
  3958*                            ERCMAIL                             *
  3959*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3960*                            VMOD=2.003                          *
  3961*                                                                *
  3962*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3963*                                                                *
  3964*   FILE TYPE = VSAM,KSDS                                        *
  3965*   RECORD SIZE = 374   RECFORM = FIX                            *
  3966*                                                                *
  3967*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3968*   ALTERNATE PATH    = NOT USED                                 *
  3969*                                                                *
  3970*   LOG = YES                                                    *
  3971*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3972******************************************************************
  3973*                   C H A N G E   L O G
  3974*
  3975* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3976*-----------------------------------------------------------------
  3977*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3978* EFFECTIVE    NUMBER
  3979*-----------------------------------------------------------------
  3980* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3981* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3982* 111108                   PEMA  ADD CRED BENE ADDR2
  3983******************************************************************
  3984
  3985 01  MAILING-DATA.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  73
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  3986     12  MA-RECORD-ID                      PIC XX.
  3987         88  VALID-MA-ID                       VALUE 'MA'.
  3988
  3989     12  MA-CONTROL-PRIMARY.
  3990         16  MA-COMPANY-CD                 PIC X.
  3991         16  MA-CARRIER                    PIC X.
  3992         16  MA-GROUPING.
  3993             20  MA-GROUPING-PREFIX        PIC XXX.
  3994             20  MA-GROUPING-PRIME         PIC XXX.
  3995         16  MA-STATE                      PIC XX.
  3996         16  MA-ACCOUNT.
  3997             20  MA-ACCOUNT-PREFIX         PIC X(4).
  3998             20  MA-ACCOUNT-PRIME          PIC X(6).
  3999         16  MA-CERT-EFF-DT                PIC XX.
  4000         16  MA-CERT-NO.
  4001             20  MA-CERT-PRIME             PIC X(10).
  4002             20  MA-CERT-SFX               PIC X.
  4003
  4004     12  FILLER                            PIC XX.
  4005
  4006     12  MA-ACCESS-CONTROL.
  4007         16  MA-SOURCE-SYSTEM              PIC XX.
  4008             88  MA-FROM-CREDIT                VALUE 'CR'.
  4009             88  MA-FROM-VSI                   VALUE 'VS'.
  4010             88  MA-FROM-WARRANTY              VALUE 'WA'.
  4011             88  MA-FROM-OTHER                 VALUE 'OT'.
  4012         16  MA-RECORD-ADD-DT              PIC XX.
  4013         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4014         16  MA-LAST-MAINT-DT              PIC XX.
  4015         16  MA-LAST-MAINT-BY              PIC XXXX.
  4016         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4017
  4018     12  MA-PROFILE-INFO.
  4019         16  MA-QUALIFY-CODE-1             PIC XX.
  4020         16  MA-QUALIFY-CODE-2             PIC XX.
  4021         16  MA-QUALIFY-CODE-3             PIC XX.
  4022         16  MA-QUALIFY-CODE-4             PIC XX.
  4023         16  MA-QUALIFY-CODE-5             PIC XX.
  4024
  4025         16  MA-INSURED-LAST-NAME          PIC X(15).
  4026         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4027         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4028         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4029         16  MA-INSURED-BIRTH-DT           PIC XX.
  4030         16  MA-INSURED-SEX                PIC X.
  4031             88  MA-SEX-MALE                   VALUE 'M'.
  4032             88  MA-SEX-FEMALE                 VALUE 'F'.
  4033         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4034
  4035         16  MA-ADDRESS-CORRECTED          PIC X.
  4036         16  MA-JOINT-BIRTH-DT             PIC XX.
  4037*        16  FILLER                        PIC X(12).
  4038
  4039         16  MA-ADDRESS-LINE-1             PIC X(30).
  4040         16  MA-ADDRESS-LINE-2             PIC X(30).
  4041         16  MA-CITY-STATE.
  4042             20  MA-CITY                   PIC X(28).
  4043             20  MA-ADDR-STATE             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  74
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  4044         16  MA-ZIP.
  4045             20  MA-ZIP-CODE.
  4046                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4047                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4048                 24  FILLER                PIC X(4).
  4049             20  MA-ZIP-PLUS4              PIC X(4).
  4050         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4051             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4052             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4053             20  FILLER                    PIC X(3).
  4054
  4055         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4056
  4057         16  FILLER                        PIC XXX.
  4058*        16  FILLER                        PIC X(10).
  4059
  4060
  4061     12  MA-CRED-BENE-INFO.
  4062         16  MA-CRED-BENE-NAME                 PIC X(25).
  4063         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4064         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4065         16  MA-CRED-BENE-CTYST.
  4066             20  MA-CRED-BENE-CITY             PIC X(28).
  4067             20  MA-CRED-BENE-STATE            PIC XX.
  4068         16  MA-CRED-BENE-ZIP.
  4069             20  MA-CB-ZIP-CODE.
  4070                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  4071                     88  MA-CB-CANADIAN-POST-CODE
  4072                                           VALUE 'A' THRU 'Z'.
  4073                 24  FILLER                    PIC X(4).
  4074             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4075         16  MA-CB-CANADIAN-POSTAL-CODE
  4076                            REDEFINES MA-CRED-BENE-ZIP.
  4077             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4078             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4079             20  FILLER                        PIC X(3).
  4080     12  MA-POST-CARD-MAIL-DATA.
  4081         16  MA-MAIL-DATA OCCURS 7.
  4082             20  MA-MAIL-TYPE              PIC X.
  4083                 88  MA-12MO-MAILING           VALUE '1'.
  4084                 88  MA-EXP-MAILING            VALUE '2'.
  4085             20  MA-MAIL-STATUS            PIC X.
  4086                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4087                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4088                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4089             20  MA-MAIL-DATE              PIC XX.
  4090     12  FILLER                            PIC XX.
  4091     12  FILLER                            PIC XX.
  4092*    12  FILLER                            PIC X(30).
  4093******************************************************************
  4094
  4095 FD  ERPLAN.
* 4096                                 COPY ERCPLAN.
  4097******************************************************************04/29/98
  4098*                                                                *ERCPLAN
  4099*                                                                *ERCPLAN
  4100*                            ERCPLAN                             *   LV003
  4101*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  75
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4102*                            VMOD=2.003                          *   CL**2
  4103*                                                                *ERCPLAN
  4104*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
  4105*                                                                *ERCPLAN
  4106*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
  4107*   PLAN MASTER                                                  *ERCPLAN
  4108*                                                                *ERCPLAN
  4109*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
  4110*                                                                *ERCPLAN
  4111*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
  4112*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
  4113*                                                                *ERCPLAN
  4114*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
  4115*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
  4116*                                                                *ERCPLAN
  4117*   LOG = NO                                                     *ERCPLAN
  4118*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
  4119*                                                                *ERCPLAN
  4120*                                                                *ERCPLAN
  4121******************************************************************ERCPLAN
  4122                                                                  ERCPLAN
  4123 01  PLAN-MASTER.                                                 ERCPLAN
  4124     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
  4125         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
  4126                                                                  ERCPLAN
  4127     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
  4128         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
  4129         16  PL-MSTR-CNTRL.                                       ERCPLAN
  4130             20  PL-CONTROL-A.                                    ERCPLAN
  4131                 24  PL-CARRIER            PIC X.                 ERCPLAN
  4132                 24  PL-GROUPING           PIC X(6).              ERCPLAN
  4133                 24  PL-STATE              PIC XX.                ERCPLAN
  4134                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
  4135             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
  4136             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
  4137             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
  4138                                                                  ERCPLAN
  4139     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
  4140         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
  4141         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
  4142         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
  4143         16  PL-VG-STATE                   PIC XX.                ERCPLAN
  4144         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
  4145         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
  4146         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
  4147         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
  4148                                                                  ERCPLAN
  4149     12  PL-MAINT-INFORMATION.                                    ERCPLAN
  4150         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
  4151         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
  4152         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
  4153         16  FILLER                        PIC XX.                ERCPLAN
  4154                                                                  ERCPLAN
  4155     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
  4156         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
  4157         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
  4158             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
  4159             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  76
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4160             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
  4161             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
  4162                                                                  ERCPLAN
  4163     12  FILLER                            PIC X(30).             ERCPLAN
  4164                                                                  ERCPLAN
  4165     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
  4166         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
  4167         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
  4168         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
  4169     12  FILLER                            PIC X(24).             ERCPLAN
  4170     12  PL-TOLERANCES.                                           ERCPLAN
  4171         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
  4172         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
  4173         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
  4174         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
  4175         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4176         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4177     12  PL-OVER-SHORT.                                           ERCPLAN
  4178         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
  4179         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
  4180     12  FILLER                            PIC X(24).             ERCPLAN
  4181     12  PLAN-MISC.                                               ERCPLAN
  4182         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
  4183         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4184         16  PL-IG                         PIC X.                 ERCPLAN
  4185         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
  4186         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
  4187         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
  4188         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
  4189         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
  4190         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
  4191         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
  4192         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4193                                                                  ERCPLAN
  4194         16  FILLER                        PIC X(99).             ERCPLAN
  4195******************************************************************ERCPLAN
  4196 FD  ERFORM.
* 4197                                 COPY ERCFORM.
  4198******************************************************************04/29/98
  4199*                                                                *ERCFORM
  4200*                                                                *ERCFORM
  4201*                            ERCFORM.                            *   LV002
  4202*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4203*                            VMOD=2.003                          *   CL**2
  4204*                                                                *ERCFORM
  4205*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *ERCFORM
  4206*                                                                *ERCFORM
  4207*    FILE TYPE = VSAM,KSDS                                       *ERCFORM
  4208*    RECORD SIZE = 500  RECFORM = FIXED                          *ERCFORM
  4209*                                                                *ERCFORM
  4210*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *ERCFORM
  4211*                                                                *ERCFORM
  4212*    LOG = YES                                                   *ERCFORM
  4213*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCFORM
  4214******************************************************************ERCFORM
  4215 01  FORM-MASTER.                                                 ERCFORM
  4216    12  FO-RECORD-ID                 PIC X(02).                   ERCFORM
  4217        88  VALID-FO-ID                  VALUE 'FO'.              ERCFORM
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  77
* EL517.cbl (/apps/prod/cid1p/copy/ERCFORM)
  4218                                                                  ERCFORM
  4219    12  FO-CONTROL-PRIMARY.                                       ERCFORM
  4220        16  FO-COMPANY-CD            PIC X(01).                   ERCFORM
  4221        16  FO-STATE                 PIC X(02).                   ERCFORM
  4222        16  FO-FORM-ID               PIC X(12).                   ERCFORM
  4223        16  FO-FORM-EXP-DT           PIC X(02).                   ERCFORM
  4224                                                                  ERCFORM
  4225    12  FO-POLICY-FORM-DATA.                                      ERCFORM
  4226        16  FO-IND-GRP-CD            PIC X(01).                   ERCFORM
  4227        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.      ERCFORM
  4228        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4229        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4230        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4231        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4232        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4233        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4234        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.      ERCFORM
  4235        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.      ERCFORM
  4236        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).                   ERCFORM
  4237        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4238        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4239        16  FO-DIS-DEF-TYPE          PIC 9(02).                   ERCFORM
  4240        16  FO-DISMEMBERMENT-CD      PIC X(01).                   ERCFORM
  4241        16  FO-APP-CERT-USE-CD       PIC X(01).                   ERCFORM
  4242                                                                  ERCFORM
  4243    12  FILLER                       PIC X(29).                   ERCFORM
  4244                                                                  ERCFORM
  4245    12  FO-FORM-PLAN-TABLE.                                       ERCFORM
  4246        16  FO-FORM-PLANS     OCCURS 40 TIMES.                    ERCFORM
  4247            20  FO-PLAN-TYPE         PIC X(01).                   ERCFORM
  4248            20  FO-PLAN-ID           PIC X(02).                   ERCFORM
  4249            20  FO-PLAN-TERM         PIC 9(03).                   ERCFORM
  4250            20  FO-PLAN-REFUND-METHOD                             ERCFORM
  4251                                     PIC X.                       ERCFORM
  4252                                                                  ERCFORM
  4253    12  FILLER                       PIC X(30).                   ERCFORM
  4254                                                                  ERCFORM
  4255    12  FO-COMMENTS-AREA.                                         ERCFORM
  4256        16  FO-COMMENT-LINE-1        PIC X(78).                   ERCFORM
  4257                                                                  ERCFORM
  4258    12  FILLER                       PIC X(20).                   ERCFORM
  4259                                                                  ERCFORM
  4260    12  FO-MAINT-INFORMATION.                                     ERCFORM
  4261        16  FO-LAST-MAINT-DT         PIC X(02).                   ERCFORM
  4262        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.      ERCFORM
  4263        16  FO-LAST-MAINT-BY         PIC X(04).                   ERCFORM
  4264
  4265 FD  PRINT-FILE
* 4266                                 COPY ELCPRTFD.
  4267******************************************************************04/15/98
  4268*                                                                *ELCPRTFD
  4269*                                                                *ELCPRTFD
  4270*                            ELCPRTFD.                           *   LV003
  4271*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4272*                            VMOD=2.006                          *ELCPRTFD
  4273******************************************************************ELCPRTFD
  4274     RECORDING MODE F                                             ELCPRTFD
  4275     LABEL RECORDS OMITTED                                        ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  78
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTFD)
  4276     BLOCK CONTAINS 0 RECORDS
  4277     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  4278 01  PRT.                                                         ELCPRTFD
  4279     12  P-CTL               PIC  X.                                 CL**2
  4280     12  P-DATA              PIC  X(132).                         ELCPRTFD
  4281******************************************************************ELCPRTFD
  4282 FD  FICH
* 4283                                 COPY ELCFCHFD.
  4284******************************************************************04/15/98
  4285*                                                                *ELCFCHFD
  4286*                            ELCFCHFD.                           *   LV003
  4287*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4288*                            VMOD=2.004                          *   CL**3
  4289*                                                                *ELCFCHFD
  4290******************************************************************ELCFCHFD
  4291     BLOCK CONTAINS 0 RECORDS
  4292     RECORDING MODE F.                                            ELCFCHFD
  4293                                                                  ELCFCHFD
  4294 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  4295******************************************************************ELCFCHFD
  4296
  4297 FD  ELREPT.
* 4298                                 COPY ELCREPT.
  4299******************************************************************04/15/98
  4300*                                                                *ELCREPT
  4301*                                                                *ELCREPT
  4302*                            ELCREPT.                            *   LV002
  4303*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4304*                            VMOD=2.002                          *   CL**2
  4305*                                                                *ELCREPT
  4306*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
  4307*                                                                *ELCREPT
  4308*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
  4309*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
  4310*                                                                *ELCREPT
  4311*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
  4312*       ALTERNATE PATH  = NOT USED                               *ELCREPT
  4313*                                                                *ELCREPT
  4314*   LOG = NO                                                     *ELCREPT
  4315*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
  4316******************************************************************ELCREPT
  4317 01  REPORT-SAVE-FILE.                                            ELCREPT
  4318     12  RF-RECORD-ID                PIC XX.                      ELCREPT
  4319         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
  4320                                                                  ELCREPT
  4321     12  RF-CONTROL-PRIMARY.                                      ELCREPT
  4322         16  RF-COMPANY-CD           PIC X.                       ELCREPT
  4323         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
  4324             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
  4325             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
  4326         16  RF-REPORT-ID.                                        ELCREPT
  4327             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
  4328                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
  4329                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
  4330             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
  4331         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
  4332     12  RF-REPORT-LINE-133.                                      ELCREPT
  4333         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  79
* EL517.cbl (/apps/prod/cid1p/copy/ELCREPT)
  4334         16  RF-DATA-133             PIC X(132).                  ELCREPT
  4335         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
  4336             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
  4337             20  FILLER              PIC X(52).                   ELCREPT
  4338         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
  4339             20  FILLER              PIC X(53).                   ELCREPT
  4340             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
  4341     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
  4342         16  FILLER                  PIC X.                       ELCREPT
  4343         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
  4344         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
  4345         16  FILLER                  PIC X(115).                  ELCREPT
  4346         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
  4347******************************************************************ELCREPT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  80
* EL517.cbl
  4349
  4350 FD  ERRESS.
* 4351                                 COPY ERCRESS.
  4352******************************************************************04/29/98
  4353*                                                                *ERCRESS
  4354*                            ERCRESS                             *   LV002
  4355*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4356*                            VMOD=2.002                          *   CL**2
  4357*                                                                *ERCRESS
  4358*   CREDIT RESIDENT STATE TAXES MASTER                          * ERCRESS
  4359*                                                                *ERCRESS
  4360*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *ERCRESS
  4361*   VSAM RESIDENT STATE TAX MASTER                              * ERCRESS
  4362*                                                                *ERCRESS
  4363*   FILE DESCRIPTION = ER.TEST.ERRESS                           * ERCRESS
  4364*                                                                *ERCRESS
  4365*   FILE TYPE = VSAM,KSDS                                        *ERCRESS
  4366*   RECORD SIZE = 0047 RECFORM = FIXED                           *ERCRESS
  4367*                                                                *ERCRESS
  4368*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *ERCRESS
  4369*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *ERCRESS
  4370*                                                                *ERCRESS
  4371*   LOG = NO                                                     *ERCRESS
  4372*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESS
  4373*                                                                *ERCRESS
  4374*                                                                *ERCRESS
  4375******************************************************************ERCRESS
  4376                                                                  ERCRESS
  4377 01  RESIDENT-STATE-TAX-MASTER.                                   ERCRESS
  4378                                                                  ERCRESS
  4379     10  ERRESS-PRIMARY-KEY.                                      ERCRESS
  4380         15  RES-COMPANY-CD        PIC X.                         ERCRESS
  4381         15  RES-RESIDENT-STATE    PIC XX.                        ERCRESS
  4382         15  RES-COVERAGE-CATEGORY PIC X.                         ERCRESS
  4383         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.               ERCRESS
  4384*                                      YYYYMMDD                   ERCRESS
  4385*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C                   ERCRESS
  4386                                                                  ERCRESS
  4387     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.                      ERCRESS
  4388                                                                  ERCRESS
  4389         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4390         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4391         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4392         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4393                                                                  ERCRESS
  4394     10 RES-RECALC-SW              PIC   X.                       ERCRESS
  4395         88 RECALC                VALUE 'Y'.                      ERCRESS
  4396         88 NO-RECALC             VALUE 'N'.                      ERCRESS
  4397     10  RES-MAINT-BY              PIC X(4).                      ERCRESS
  4398     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.            ERCRESS
  4399     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.            ERCRESS
  4400*                                      YYYYMMDD                   ERCRESS
  4401
  4402 FD  ERRESC.
* 4403                                 COPY ERCRESC.
  4404******************************************************************04/29/98
  4405*                                                                *ERCRESC
  4406*                            ERCRESC                             *   LV002
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  81
* EL517.cbl (/apps/prod/cid1p/copy/ERCRESC)
  4407*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4408*                            VMOD=2.003                          *   CL**2
  4409*                                                                *ERCRESC
  4410*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  4411*                                                                *ERCRESC
  4412*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  4413*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  4414*                                                                *ERCRESC
  4415*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  4416*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  4417*                                                                *ERCRESC
  4418*   LOG = NO                                                     *ERCRESC
  4419*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  4420*                                                                *ERCRESC
  4421******************************************************************ERCRESC
  4422                                                                  ERCRESC
  4423 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  4424                                                                  ERCRESC
  4425     10  ERRESC-RECORD-KEY.                                       ERCRESC
  4426         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  4427         15  RESC-CARRIER              PIC   X.                   ERCRESC
  4428         15  RESC-GROUP                PIC   X(6).                ERCRESC
  4429         15  RESC-STATE                PIC   XX.                  ERCRESC
  4430         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  4431         15  RESC-AGENT                PIC   X(10).               ERCRESC
  4432         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  4433         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  4434*                                           YYYYMMDD              ERCRESC
  4435     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  4436                                                                  ERCRESC
  4437     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  4438         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  4439             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  4440             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  4441             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  4442                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  4443                                                                  ERCRESC
  4444     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  4445     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  4446     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  4447*                                          YYYYMMDD               ERCRESC
  4448
  4449 FD  ERCOMP.
* 4450                                 COPY ERCCOMP.
  4451******************************************************************
  4452*                                                                *
  4453*                                                                *
  4454*                            ERCCOMP                             *
  4455*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4456*                            VMOD=2.019                          *
  4457*                                                                *
  4458*   ONLINE CREDIT SYSTEM                                         *
  4459*                                                                *
  4460*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4461*                                                                *
  4462*   FILE TYPE = VSAM,KSDS                                        *
  4463*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4464*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  82
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4465*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4466*       ALTERNATE PATH = NONE                                    *
  4467*                                                                *
  4468*   LOG = NO                                                     *
  4469*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4470*                                                                *
  4471******************************************************************
  4472*                   C H A N G E   L O G
  4473*
  4474* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4475*-----------------------------------------------------------------
  4476*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4477* EFFECTIVE    NUMBER
  4478*-----------------------------------------------------------------
  4479* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4480* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4481* 092205    2005050300006  PEMA  ADD LEASE FEE
  4482* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4483* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4484* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4485* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4486* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4487* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4488******************************************************************
  4489
  4490 01  COMPENSATION-MASTER.
  4491     12  CO-RECORD-ID                          PIC XX.
  4492         88  VALID-CO-ID                          VALUE 'CO'.
  4493
  4494     12  CO-CONTROL-PRIMARY.
  4495         16  CO-COMPANY-CD                     PIC X.
  4496         16  CO-CONTROL.
  4497             20  CO-CTL-1.
  4498                 24  CO-CARR-GROUP.
  4499                     28  CO-CARRIER            PIC X.
  4500                     28  CO-GROUPING.
  4501                         32  CO-GROUP-PREFIX   PIC XXX.
  4502                         32  CO-GROUP-PRIME    PIC XXX.
  4503                 24  CO-RESP-NO.
  4504                     28  CO-RESP-PREFIX        PIC X(4).
  4505                     28  CO-RESP-PRIME         PIC X(6).
  4506             20  CO-CTL-2.
  4507                 24  CO-ACCOUNT.
  4508                     28  CO-ACCT-PREFIX        PIC X(4).
  4509                     28  CO-ACCT-PRIME         PIC X(6).
  4510         16  CO-TYPE                           PIC X.
  4511             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4512             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4513             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4514
  4515     12  CO-MAINT-INFORMATION.
  4516         16  CO-LAST-MAINT-DT                  PIC XX.
  4517         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4518         16  CO-LAST-MAINT-USER                PIC X(4).
  4519     12  FILLER                                PIC XX.
  4520     12  CO-STMT-TYPE                          PIC XXX.
  4521     12  CO-COMP-TYPE                          PIC X.
  4522         88  CO-COMP-IS-SPPDD                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  83
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4523     12  CO-STMT-OWNER                         PIC X(4).
  4524     12  CO-BALANCE-CONTROL                    PIC X.
  4525         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4526         88  CO-NO-BALANCE                        VALUE 'N'.
  4527
  4528     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4529         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4530         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4531         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4532
  4533     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4534         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4535         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4536
  4537     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4538     12  CO-GA-DIRECT-DEP                      PIC X.
  4539     12  CO-FUTURE-SPACE                       PIC X.
  4540         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4541
  4542     12  CO-ACCT-NAME                          PIC X(30).
  4543     12  CO-MAIL-NAME                          PIC X(30).
  4544     12  CO-ADDR-1                             PIC X(30).
  4545     12  CO-ADDR-2                             PIC X(30).
  4546     12  CO-ADDR-3.
  4547         16  CO-ADDR-CITY                      PIC X(27).
  4548         16  CO-ADDR-STATE                     PIC XX.
  4549     12  CO-CSO-1099                           PIC X.
  4550     12  CO-ZIP.
  4551         16  CO-ZIP-PRIME.
  4552             20  CO-ZIP-PRI-1ST                PIC X.
  4553                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4554             20  FILLER                        PIC X(4).
  4555         16  CO-ZIP-PLUS4                      PIC X(4).
  4556     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4557         16  CO-CAN-POSTAL-1                   PIC XXX.
  4558         16  CO-CAN-POSTAL-2                   PIC XXX.
  4559         16  FILLER                            PIC XXX.
  4560     12  CO-SOC-SEC                            PIC X(13).
  4561     12  CO-TELEPHONE.
  4562         16  CO-AREA-CODE                      PIC XXX.
  4563         16  CO-PREFIX                         PIC XXX.
  4564         16  CO-PHONE                          PIC X(4).
  4565
  4566     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4567
  4568     12  CO-AR-BAL-LEVEL                       PIC X.
  4569         88  CO-AR-REF-LVL                        VALUE '1'.
  4570         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4571         88  CO-AR-BILL-LVL                       VALUE '2'.
  4572         88  CO-AR-AGT-LVL                        VALUE '3'.
  4573         88  CO-AR-FR-LVL                         VALUE '4'.
  4574
  4575     12  CO-AR-NORMAL-PRINT                    PIC X.
  4576         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4577         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4578
  4579     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4580
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  84
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4581     12  CO-AR-REPORTING                       PIC X.
  4582         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4583         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4584
  4585     12  CO-AR-PULL-CHECK                      PIC X.
  4586         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4587         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4588
  4589     12  CO-AR-BALANCE-PRINT                   PIC X.
  4590         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4591
  4592     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4593         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4594         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4595         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4596
  4597     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4598
  4599     12  CO-USER-CODE                          PIC X.
  4600     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4601
  4602******************************************************************
  4603*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4604*    THE LAST MONTH END RUN.
  4605******************************************************************
  4606
  4607     12  CO-LAST-ACTIVITY-DATE.
  4608         16  CO-ACT-YEAR                       PIC 99.
  4609         16  CO-ACT-MONTH                      PIC 99.
  4610         16  CO-ACT-DAY                        PIC 99.
  4611
  4612     12  CO-LAST-STMT-DT.
  4613         16  CO-LAST-STMT-YEAR                 PIC 99.
  4614         16  CO-LAST-STMT-MONTH                PIC 99.
  4615         16  CO-LAST-STMT-DAY                  PIC 99.
  4616
  4617     12  CO-MO-END-TOTALS.
  4618         16  CO-MONTHLY-TOTALS.
  4619             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4620             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4621             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4622             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4623             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4624
  4625         16  CO-AGING-TOTALS.
  4626             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4627             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4628             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4629             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4630
  4631         16  CO-YTD-TOTALS.
  4632             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4633             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4634
  4635         16  CO-OVER-UNDER-TOTALS.
  4636             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4637             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4638
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  85
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4639     12  CO-MISCELLANEOUS-TOTALS.
  4640         16  CO-FICA-TOTALS.
  4641             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4642             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4643
  4644         16  CO-CLAIM-TOTALS.
  4645             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4646             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4647
  4648******************************************************************
  4649*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4650*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4651******************************************************************
  4652
  4653     12  CO-CURRENT-TOTALS.
  4654         16  CO-CURRENT-LAST-STMT-DT.
  4655             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4656             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4657             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4658
  4659         16  CO-CURRENT-MONTHLY-TOTALS.
  4660             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4661             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4662             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4663             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4664             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4665
  4666         16  CO-CURRENT-AGING-TOTALS.
  4667             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4668             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4669             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4670             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4671
  4672         16  CO-CURRENT-YTD-TOTALS.
  4673             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4674             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4675
  4676     12  CO-PAID-COMM-TOTALS.
  4677         16  CO-YTD-PAID-COMMS.
  4678             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4679             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4680
  4681     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4682         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4683         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4684
  4685     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4686         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4687         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4688         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4689         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4690         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4691         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4692         88  CO-FINAL-LETTER                  VALUE 'F'.
  4693         88  CO-RECONCILING                   VALUE 'R'.
  4694         88  CO-PHONE-CALL                    VALUE 'P'.
  4695         88  CO-LEGAL                         VALUE 'L'.
  4696         88  CO-COLLECTION-AGENCY             VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  86
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4697         88  CO-WRITE-OFF                     VALUE 'W'.
  4698         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4699
  4700     12  CO-CSR-CODE                       PIC X(4).
  4701
  4702     12  CO-GA-STATUS-INFO.
  4703         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4704         16  CO-GA-TERMINATION-DT          PIC XX.
  4705         16  CO-GA-STATUS-CODE             PIC X.
  4706             88  CO-GA-ACTIVE                 VALUE 'A'.
  4707             88  CO-GA-INACTIVE               VALUE 'I'.
  4708             88  CO-GA-PENDING                VALUE 'P'.
  4709         16  CO-GA-COMMENTS.
  4710             20  CO-GA-COMMENT-1           PIC X(40).
  4711             20  CO-GA-COMMENT-2           PIC X(40).
  4712             20  CO-GA-COMMENT-3           PIC X(40).
  4713             20  CO-GA-COMMENT-4           PIC X(40).
  4714
  4715     12  CO-RPTCD2                         PIC X(10).
  4716     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4717         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4718         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4719
  4720     12  CO-TYPE-AGENT                     PIC X(01).
  4721         88  CO-CORPORATION                   VALUE 'C'.
  4722         88  CO-PARTNERSHIP                   VALUE 'P'.
  4723         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4724         88  CO-TRUST                         VALUE 'T'.
  4725         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4726
  4727     12  CO-FAXNO.
  4728         16  CO-FAX-AREA-CODE                  PIC XXX.
  4729         16  CO-FAX-PREFIX                     PIC XXX.
  4730         16  CO-FAX-PHONE                      PIC X(4).
  4731
  4732     12  CO-BANK-INFORMATION.
  4733         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4734         16  CO-BANK-TRANSIT-NON REDEFINES
  4735             CO-BANK-TRANSIT-NO                PIC 9(8).
  4736
  4737         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4738     12  CO-MISC-DEDUCT-INFO REDEFINES
  4739                  CO-BANK-INFORMATION.
  4740         16  CO-MD-GL-ACCT                     PIC X(10).
  4741         16  CO-MD-DIV                         PIC XX.
  4742         16  CO-MD-CENTER                      PIC X(4).
  4743         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4744         16  CO-CREATE-AP-CHECK                PIC X.
  4745         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4746         16  FILLER                            PIC XXX.
  4747     12  CO-ACH-STATUS                         PIC X.
  4748         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4749         88  CO-ACH-PENDING                        VALUE 'P'.
  4750
  4751     12  CO-BILL-SW                            PIC X.
  4752     12  CO-CONTROL-NAME                       PIC X(30).
  4753     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4754     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  87
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4755     12  CO-CLP-STATE                          PIC XX.
  4756     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4757     12  CO-SPP-REFUND-EDIT                    PIC X.
  4758
  4759******************************************************************
  4760
  4761 FD  ERLOFC.
* 4762                                 COPY ERCLOFC.
  4763******************************************************************12/04/92
  4764*                                                                *ERCLOFC
  4765*                                                                *ERCLOFC
  4766*                            ERCLOFC                             *   LV002
  4767*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4768*                            VMOD=2.003                          *   CL**2
  4769*                                                                *ERCLOFC
  4770*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *ERCLOFC
  4771*                                                                *ERCLOFC
  4772*   FILE TYPE = VSAM,KSDS                                        *ERCLOFC
  4773*   RECORD SIZE = 670   RECFORM = FIX                            *ERCLOFC
  4774*                                                                *ERCLOFC
  4775*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *ERCLOFC
  4776*                                                                *ERCLOFC
  4777*   LOG = YES                                                    *ERCLOFC
  4778*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCLOFC
  4779*                                                                *ERCLOFC
  4780******************************************************************ERCLOFC
  4781                                                                  ERCLOFC
  4782 01  LOAN-OFFICER-MASTER.                                         ERCLOFC
  4783     12  LO-RECORD-ID                PIC XX.                      ERCLOFC
  4784         88  VALID-LO-ID                VALUE 'LO'.               ERCLOFC
  4785                                                                  ERCLOFC
  4786     12  LO-CONTROL-PRIMARY.                                      ERCLOFC
  4787         16  LO-COMPANY-CD           PIC X.                       ERCLOFC
  4788         16  LO-CARRIER              PIC X.                       ERCLOFC
  4789         16  LO-GROUPING.                                         ERCLOFC
  4790             20  LO-GROUPING-PREFIX  PIC XXX.                     ERCLOFC
  4791             20  LO-GROUPING-PRIME   PIC XXX.                     ERCLOFC
  4792         16  LO-STATE                PIC XX.                      ERCLOFC
  4793         16  LO-ACCOUNT.                                          ERCLOFC
  4794             20  LO-ACCOUNT-PREFIX   PIC X(4).                    ERCLOFC
  4795             20  LO-ACCOUNT-PRIME    PIC X(6).                    ERCLOFC
  4796         16  LO-OFFICER-CODE         PIC X(5).
  4797                                                                  ERCLOFC
  4798     12  LO-OFFICER-NAME             PIC X(30).                   ERCLOFC
  4799                                                                  ERCLOFC
  4800     12  LO-LAST-MAINT-DT            PIC XX.                      ERCLOFC
  4801     12  LO-LAST-USER                PIC X(4).                    ERCLOFC
  4802     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.            ERCLOFC
  4803                                                                  ERCLOFC
  4804     12  LO-COMP-CONTROL             PIC X.                       ERCLOFC
  4805             88  LO-SHOW-COMP           VALUE 'Y'.                ERCLOFC
  4806             88  LO-SUPPRESS-COMP       VALUE 'N'.                ERCLOFC
  4807     12  LO-DETAIL-CONTROL           PIC X.                       ERCLOFC
  4808             88  LO-PRINT-DETAIL        VALUE 'D'.                ERCLOFC
  4809             88  LO-PRINT-SUMMARY       VALUE 'S'.                ERCLOFC
  4810                                                                  ERCLOFC
  4811     12  LO-SV-CARRIER               PIC X.                       ERCLOFC
  4812     12  LO-SV-GROUPING              PIC X(6).                    ERCLOFC
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  88
* EL517.cbl (/apps/prod/cid1p/copy/ERCLOFC)
  4813     12  LO-SV-STATE                 PIC XX.                      ERCLOFC
  4814                                                                  ERCLOFC
  4815     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.               CL**2
  4816     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.            CL**2
  4817                                                                  ERCLOFC
  4818     12  LO-OFFICER-INFO.                                         ERCLOFC
  4819         16  FILLER OCCURS 12 TIMES.                              ERCLOFC
  4820             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.            ERCLOFC
  4821             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.            ERCLOFC
  4822             20  LO-LF-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4823             20  LO-LF-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4824             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4825             20  LO-AH-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4826             20  LO-AH-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4827             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4828     12  FILLER                      PIC X(198).
  4829******************************************************************ERCLOFC
  4830
  4831 FD  ERBXRF.
* 4832                                 COPY ERCBXRF.
  4833******************************************************************04/29/98
  4834*                                                                *ERCBXRF
  4835*                                                                *ERCBXRF
  4836*                            ERCBXRF                             *   LV002
  4837*                                                                *ERCBXRF
  4838*   ONLINE CREDIT SYSTEM                                         *ERCBXRF
  4839*                                                                *ERCBXRF
  4840*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *ERCBXRF
  4841*                                                                *ERCBXRF
  4842*   FILE TYPE = VSAM,KSDS                                        *ERCBXRF
  4843*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE                ERCBXRF
  4844*                                                                *ERCBXRF
  4845*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *ERCBXRF
  4846*       ALTERNATE PATH = NONE                                    *ERCBXRF
  4847*                                                                *ERCBXRF
  4848*   LOG = NO                                                     *ERCBXRF
  4849*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCBXRF
  4850*                                                                *ERCBXRF
  4851******************************************************************ERCBXRF
  4852                                                                  ERCBXRF
  4853 01  BANK-CROSS-REFERENCE.                                        ERCBXRF
  4854     12  BK-RECORD-ID                PIC XX.                      ERCBXRF
  4855         88  VALID-BK-ID             VALUE 'BK'.                  ERCBXRF
  4856                                                                  ERCBXRF
  4857     12  BK-CONTROL-PRIMARY.                                      ERCBXRF
  4858         16  BK-COMPANY-CD           PIC X.                       ERCBXRF
  4859         16  BK-CARRIER              PIC X.                       ERCBXRF
  4860         16  BK-GROUPING             PIC X(6).                    ERCBXRF
  4861         16  BK-BANK-NO              PIC X(10).                   ERCBXRF
  4862                                                                  ERCBXRF
  4863     12  BK-MAINT-INFORMATION.                                    ERCBXRF
  4864         16  BK-LAST-MAINT-DT        PIC XX.                      ERCBXRF
  4865         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.           ERCBXRF
  4866         16  BK-LAST-MAINT-USER      PIC X(4).                    ERCBXRF
  4867         16  FILLER                  PIC X(9).                    ERCBXRF
  4868                                                                  ERCBXRF
  4869     12  FILLER                      PIC X(37).                   ERCBXRF
  4870                                                                  ERCBXRF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  89
* EL517.cbl (/apps/prod/cid1p/copy/ERCBXRF)
  4871     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.             ERCBXRF
  4872                                                                  ERCBXRF
  4873     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES                  ERCBXRF
  4874                            DEPENDING ON BK-BANK-POINTER-CNT.     ERCBXRF
  4875         16  BK-AM-ACCOUNT           PIC X(10).                   ERCBXRF
  4876         16  BK-AM-EXP-DT            PIC XX.                      ERCBXRF
  4877         16  BK-AM-EFF-DT            PIC XX.                      ERCBXRF
  4878         16  BK-AM-STATE             PIC XX.                      ERCBXRF
  4879         16  FILLER                  PIC X(20).                   ERCBXRF
  4880                                                                  ERCBXRF
  4881******************************************************************ERCBXRF
  4882
  4883 FD  ERAGTC.
* 4884                                 COPY ERCAGTC.
  4885******************************************************************
  4886*                                                                *
  4887*                                                                *
  4888*                            ERCAGTC                             *
  4889*                            VMOD=2.001                          *
  4890*                                                                *
  4891*   ONLINE CREDIT SYSTEM                                         *
  4892*                                                                *
  4893*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  4894*                                                                *
  4895*   FILE TYPE = VSAM,KSDS                                        *
  4896*   RECORD SIZE = 450   RECFORM = FIXED                          *
  4897*                                                                *
  4898*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  4899*       ALTERNATE PATH = NONE                                    *
  4900*                                                                *
  4901*   LOG = NO                                                     *
  4902*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4903*                                                                *
  4904******************************************************************
  4905*                   C H A N G E   L O G
  4906*
  4907* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4908*-----------------------------------------------------------------
  4909*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4910* EFFECTIVE    NUMBER
  4911*-----------------------------------------------------------------
  4912* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  4913* 111004                         NEW FILE AND COPYBOOK
  4914* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  4915******************************************************************
  4916
  4917 01  AGENT-COMMISSIONS.
  4918     12  AG-RECORD-ID                          PIC XX.
  4919         88  VALID-CO-ID                          VALUE 'AG'.
  4920
  4921     12  AG-CONTROL-PRIMARY.
  4922         16  AG-COMPANY-CD                     PIC X.
  4923         16  AG-CONTROL.
  4924             20  AG-CTL-1.
  4925                 24  AG-CARR-GROUP.
  4926                     28  AG-CARRIER            PIC X.
  4927                     28  AG-GROUPING           PIC X(6).
  4928                 24  AG-BANK                   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  90
* EL517.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  4929             20  AG-CTL-2.
  4930                 24  AG-EXP-DT                 PIC XX.
  4931         16  AG-TYPE                           PIC X.
  4932             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  4933             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  4934
  4935     12  AG-MAINT-INFORMATION.
  4936         16  AG-LAST-MAINT-DT                  PIC XX.
  4937         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4938         16  AG-LAST-MAINT-USER                PIC X(4).
  4939         16  FILLER                            PIC X(10).
  4940
  4941     12  AG-EFF-DT                             PIC XX.
  4942     12  AG-COMM-STRUCTURE.
  4943         16  AG-AGT-COMMS OCCURS 10.
  4944             20  AG-AGT                PIC X(10).
  4945             20  AG-COM-TYP            PIC X.
  4946             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  4947             20  AG-RECALC-LV-INDIC    PIC X.
  4948             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  4949             20  AG-LRCALC-LV-INDIC    PIC X.
  4950             20  FILLER                PIC X(05).
  4951
  4952     12  FILLER                  PIC X(145).
  4953******************************************************************
  4954
  4955 FD  ELCRTT.
* 4956                                 COPY ELCCRTT.
  4957******************************************************************
  4958*                                                                *ELCCRTT
  4959*                            ELCCRTT.                            *
  4960*                                                                *ELCCRTT
  4961*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  4962*                                                                *ELCCRTT
  4963*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  4964*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  4965*                                                                *ELCCRTT
  4966*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  4967*                                                                *ELCCRTT
  4968*   LOG = YES                                                    *ELCCRTT
  4969*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  4970******************************************************************
  4971*                   C H A N G E   L O G
  4972*
  4973* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4974*-----------------------------------------------------------------
  4975*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4976* EFFECTIVE    NUMBER
  4977*-----------------------------------------------------------------
  4978* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4979* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  4980* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  4981* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4982* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4983******************************************************************
  4984                                                                  ELCCRTT
  4985 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  4986     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  91
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  4987         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  4988                                                                  ELCCRTT
  4989     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  4990         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  4991         16  CS-CARRIER                    PIC X.                 ELCCRTT
  4992         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  4993         16  CS-STATE                      PIC XX.                ELCCRTT
  4994         16  CS-ACCOUNT                    PIC X(10).
  4995         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  4996         16  CS-CERT-NO.                                          ELCCRTT
  4997             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  4998             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  4999         16  CS-TRAILER-TYPE               PIC X.
  5000             88  COMM-TRLR           VALUE 'A'.
  5001             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5002             88  CERT-DATA-TRLR      VALUE 'C'.
  5003                                                                  ELCCRTT
  5004     12  CS-DATA-AREA                      PIC X(516).
  5005
  5006     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5007         16  CS-BANK-COMMISSION-AREA.
  5008             20  CS-BANK-COMMS       OCCURS 10.
  5009                 24  CS-AGT                PIC X(10).
  5010                 24  CS-COM-TYP            PIC X.
  5011                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5012                 24  CS-RECALC-LV-INDIC    PIC X.
  5013                 24  FILLER                PIC X(10).
  5014
  5015         16  FILLER                        PIC X(256).
  5016
  5017     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5018****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5019****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5020         16  CS-MB-CLAIM-DATA OCCURS 2.
  5021             20  FILLER OCCURS 10.
  5022                 24  CS-CLAIM-TYPE         PIC X.
  5023                     88  CS-AH-CLM           VALUE 'A'.
  5024                     88  CS-IU-CLM           VALUE 'I'.
  5025                     88  CS-GP-CLM           VALUE 'G'.
  5026                     88  CS-LF-CLM           VALUE 'L'.
  5027                     88  CS-PR-CLM           VALUE 'P'.
  5028                 24  CS-BANK               PIC S999 COMP-3.
  5029                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5030                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5031                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5032         16  FILLER                        PIC X(216).
  5033
  5034     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5035         16  CS-VIN-NUMBER                 PIC X(17).
  5036         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5037         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5038         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5039         16  FILLER                        PIC X(496).
  5040
  5041******************************************************************ELCCRTT
  5042
  5043 FD  ERPDEF.
  5044
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  92
* EL517.cbl
* 5045                                 COPY ERCPDEF.
  5046******************************************************************
  5047*                                                                *
  5048*                                                                *
  5049*                            ERCPDEF.                            *
  5050*                                                                *
  5051*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5052*                                                                *
  5053*    FILE TYPE = VSAM,KSDS                                       *
  5054*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5055*                                                                *
  5056*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5057*                                                                *
  5058*    LOG = YES                                                   *
  5059*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5060******************************************************************
  5061 01  PRODUCT-MASTER.
  5062    12  PD-RECORD-ID                 PIC X(02).
  5063        88  VALID-PD-ID                  VALUE 'PD'.
  5064
  5065    12  PD-CONTROL-PRIMARY.
  5066        16  PD-COMPANY-CD            PIC X.
  5067        16  PD-STATE                 PIC XX.
  5068        16  PD-PRODUCT-CD            PIC XXX.
  5069        16  PD-FILLER                PIC X(7).
  5070        16  PD-BEN-TYPE              PIC X.
  5071        16  PD-BEN-CODE              PIC XX.
  5072        16  PD-PROD-EXP-DT           PIC XX.
  5073
  5074    12  FILLER                       PIC X(50).
  5075
  5076    12  PD-PRODUCT-DATA OCCURS 8.
  5077        16  PD-PROD-CODE             PIC X.
  5078            88  PD-PROD-LIFE           VALUE 'L'.
  5079            88  PD-PROD-PROP           VALUE 'P'.
  5080            88  PD-PROD-AH             VALUE 'A'.
  5081            88  PD-PROD-IU             VALUE 'I'.
  5082            88  PD-PROD-GAP            VALUE 'G'.
  5083        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5084        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5085        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5086        16  PD-MAX-TERM              PIC S999        COMP-3.
  5087        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5088        16  FILLER                   PIC X.
  5089        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5090        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5091        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5092        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5093        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5094        16  PD-REC-CRIT-PERIOD       PIC X.
  5095        16  PD-RTW-MOS               PIC 99.
  5096        16  FILLER                   PIC X(5).
  5097
  5098    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5099
  5100    12  PD-TERM-LIMITS OCCURS 15.
  5101        16  PD-LOW-TERM              PIC S999        COMP-3.
  5102        16  PD-HI-TERM               PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  93
* EL517.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  5103
  5104*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5105    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5106        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5107        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5108
  5109    12  PD-EARN-FACTORS.
  5110        16  FILLER OCCURS 15.
  5111            20  FILLER OCCURS 15.
  5112                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5113
  5114    12  PD-PRODUCT-DESC              PIC X(80).
  5115    12  PD-TRUNCATED                 PIC X.
  5116    12  FILLER                       PIC X(59).
  5117
  5118    12  PD-MAINT-INFORMATION.
  5119        16  PD-LAST-MAINT-DT         PIC X(02).
  5120        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5121        16  PD-LAST-MAINT-BY         PIC X(04).
  5122
  5123 FD  ELSTAT.
  5124
* 5125                                 COPY ELCSTATE.
  5126******************************************************************
  5127*                                                                *
  5128*                                                                *
  5129*                            ELCSTATE.                           *
  5130*                                                                *
  5131*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  5132*                                                                *
  5133*   FILE TYPE = VSAM,KSDS                                        *
  5134*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5135*                                                                *
  5136*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  5137*       ALTERNATE INDEX = NONE                                   *
  5138*                                                                *
  5139*   LOG = YES                                                    *
  5140*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5141******************************************************************
  5142*                   C H A N G E   L O G
  5143*
  5144* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5145*-----------------------------------------------------------------
  5146*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5147* EFFECTIVE    NUMBER
  5148*-----------------------------------------------------------------
  5149* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  5150******************************************************************
  5151*
  5152 01  STATE-FILE.
  5153     12  SF-RECORD-ID                       PIC XX.
  5154         88  VALID-CF-ID                        VALUE 'SF'.
  5155
  5156     12  SF-CONTROL-PRIMARY.
  5157         16  SF-COMPANY-ID                  PIC XXX.
  5158         16  SF-CARRIER-CODE                PIC X.
  5159         16  SF-GROUPING                    PIC X(6).
  5160         16  SF-STATE-CODE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  94
* EL517.cbl (/apps/prod/cid1p/copy/ELCSTATE)
  5161         16  SF-EXPIRE-DATE                 PIC 9(8).
  5162
  5163****************************************************************
  5164*             STATE CONTROLS
  5165****************************************************************
  5166
  5167     12  SF-LAST-MAINT-DT                   PIC XX.
  5168     12  SF-LAST-MAINT-BY                   PIC X(4).
  5169     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5170
  5171     12  SF-STATE-RT-CONTROLS.
  5172         16  SF-ST-RT-CALC                  PIC X.
  5173
  5174     12  SF-ST-TAX-CONTROLS.
  5175         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5176         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5177         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5178
  5179     12  SF-ST-REFUND-OPTIONS.
  5180         16  SF-ST-RF-LR-CALC               PIC X.
  5181         16  SF-ST-RF-LL-CALC               PIC X.
  5182         16  SF-ST-RF-LN-CALC               PIC X.
  5183         16  SF-ST-RF-AH-CALC               PIC X.
  5184         16  SF-ST-RF-CP-CALC               PIC X.
  5185
  5186     12  SF-ST-UNEARN-PREM-OPTIONS.
  5187         16  SF-ST-LUEP-R78                 PIC X.
  5188         16  SF-ST-LUEP-PRO                 PIC X.
  5189         16  SF-ST-LUEP-ST                  PIC X.
  5190         16  SF-ST-LUEP-DOM                 PIC X.
  5191         16  SF-ST-AUEP-R78                 PIC X.
  5192         16  SF-ST-AUEP-PRO                 PIC X.
  5193         16  SF-ST-AUEP-ST                  PIC X.
  5194         16  SF-ST-AUEP-DOM                 PIC X.
  5195         16  SF-ST-CUEP-R78                 PIC X.
  5196         16  SF-ST-CUEP-PRO                 PIC X.
  5197         16  SF-ST-CUEP-ST                  PIC X.
  5198         16  SF-ST-CUEP-DOM                 PIC X.
  5199
  5200     12  SF-ST-EARN-PREM-OPTIONS.
  5201         16  SF-ST-LEP-R78                  PIC X.
  5202         16  SF-ST-LEP-PRO                  PIC X.
  5203         16  SF-ST-LEP-ST                   PIC X.
  5204         16  SF-ST-LEP-DOM                  PIC X.
  5205         16  SF-ST-AEP-R78                  PIC X.
  5206         16  SF-ST-AEP-PRO                  PIC X.
  5207         16  SF-ST-AEP-ST                   PIC X.
  5208         16  SF-ST-AEP-DOM                  PIC X.
  5209         16  SF-ST-CEP-R78                  PIC X.
  5210         16  SF-ST-CEP-PRO                  PIC X.
  5211         16  SF-ST-CEP-ST                   PIC X.
  5212         16  SF-ST-CEP-DOM                  PIC X.
  5213
  5214     12  SF-FOR-FUTURE-USE                  PIC X(179).
  5215
  5216 FD  ELCRTO.
  5217
* 5218                                 COPY ELCCRTO.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  95
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5219******************************************************************
  5220*                                                                *
  5221*                            ELCCRTO.                            *
  5222*                                                                *
  5223*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5224*                                                                *
  5225*   FILE TYPE = VSAM,KSDS                                        *
  5226*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5227*                                                                *
  5228*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5229*                                                                *
  5230*   LOG = YES                                                    *
  5231*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5232******************************************************************
  5233*                   C H A N G E   L O G
  5234*
  5235* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5236*-----------------------------------------------------------------
  5237*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5238* EFFECTIVE    NUMBER
  5239*-----------------------------------------------------------------
  5240* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5241* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5242* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5243* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5244* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5245******************************************************************
  5246
  5247 01  ORIGINAL-CERTIFICATE.
  5248     12  OC-RECORD-ID                      PIC XX.
  5249         88  VALID-OC-ID                      VALUE 'OC'.
  5250
  5251     12  OC-CONTROL-PRIMARY.
  5252         16  OC-COMPANY-CD                 PIC X.
  5253         16  OC-CARRIER                    PIC X.
  5254         16  OC-GROUPING                   PIC X(6).
  5255         16  OC-STATE                      PIC XX.
  5256         16  OC-ACCOUNT                    PIC X(10).
  5257         16  OC-CERT-EFF-DT                PIC XX.
  5258         16  OC-CERT-NO.
  5259             20  OC-CERT-PRIME             PIC X(10).
  5260             20  OC-CERT-SFX               PIC X.
  5261         16  OC-RECORD-TYPE                PIC X.
  5262         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5263
  5264     12  OC-LAST-MAINT-DT                  PIC XX.
  5265     12  OC-LAST-MAINT-BY                  PIC X(4).
  5266     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5267
  5268     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5269     12  FILLER                            PIC X(49).
  5270
  5271     12  OC-ORIG-REC.
  5272         16  OC-INS-LAST-NAME              PIC X(15).
  5273         16  OC-INS-FIRST-NAME             PIC X(10).
  5274         16  OC-INS-MIDDLE-INIT            PIC X.
  5275         16  OC-INS-AGE                    PIC S999     COMP-3.
  5276         16  OC-JNT-LAST-NAME              PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  96
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5277         16  OC-JNT-FIRST-NAME             PIC X(10).
  5278         16  OC-JNT-MIDDLE-INIT            PIC X.
  5279         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5280         16  OC-LF-BENCD                   PIC XX.
  5281         16  OC-LF-TERM                    PIC S999      COMP-3.
  5282         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5283         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5284         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5285         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5286         16  OC-LF-EXP-DT                  PIC XX.
  5287         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5288         16  OC-LF-CANCEL-DT               PIC XX.
  5289         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5290         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5291         16  OC-AH-BENCD                   PIC XX.
  5292         16  OC-AH-TERM                    PIC S999      COMP-3.
  5293         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5294         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5295         16  OC-AH-EXP-DT                  PIC XX.
  5296         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5297         16  OC-AH-CP                      PIC 99.
  5298         16  OC-AH-CANCEL-DT               PIC XX.
  5299         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5300         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5301         16  OC-CRED-BENE-NAME             PIC X(25).
  5302         16  OC-1ST-PMT-DT                 PIC XX.
  5303         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5304         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5305         16  OC-ISSUE-TRAN-IND             PIC X.
  5306         16  OC-CANCEL-TRAN-IND            PIC X.
  5307         16  FILLER                        PIC X(211).
  5308
  5309     12  FILLER                            PIC X(50).
  5310
  5311******************************************************************
  5312
  5313 WORKING-STORAGE SECTION.
  5314 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  5315 77  FILLER   PIC X(32) VALUE '********************************'.
  5316 77  FILLER   PIC X(32) VALUE '**   EL517 WORKING STORAGE    **'.
  5317 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.040 *********'.
  5318
  5319 77  ELCNTL-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5320 77  ERPLAN-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5321 77  ERACCT-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5322 77  ERFORM-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5323
  5324 77  WS-ZERO                PIC S9        COMP-3   VALUE ZERO.
  5325 77  WS-RETURN-CODE         PIC S9(4)     COMP     VALUE ZERO.
  5326 77  WS-ABEND-MESSAGE       PIC X(80)              VALUE SPACES.
  5327 77  WS-ABEND-FILE-STATUS   PIC XX                 VALUE ZERO.
  5328 77  PGM-SUB                PIC S9(4)     COMP     VALUE +517.
  5329 77  SUB-X                  PIC S9(4)     COMP     VALUE   +0.
  5330 77  X                      PIC X                  VALUE ' '.
  5331 77  OLC-REPORT-NAME        PIC X(6)               VALUE 'EL517 '.
  5332
  5333 01  TRAN-CT                PIC 9(5)               VALUE 0.
  5334 01  TRAN-CX REDEFINES TRAN-CT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  97
* EL517.cbl
  5335     12  FILLER             PIC XX.
  5336     12  TCX                PIC 999.
  5337 01  SEQ-NO                 PIC 9999               VALUE 0.
  5338 01  RPND                   PIC 9(5)               VALUE 0.
  5339 01  WPND                   PIC 9(5)               VALUE 0.
  5340 01  RREI                   PIC 9(5)               VALUE 0.
  5341 01  RCTB                   PIC 9(5)               VALUE 0.
  5342 01  RACC                   PIC 9(5)               VALUE 0.
  5343 01  RCER                   PIC 9(5)               VALUE 0.
  5344 01  RCNT                   PIC 9(5)               VALUE 0.
  5345 01  WCER                   PIC 9(5)               VALUE 0.
  5346 01  ERPNDM-OPEN            PIC X                  VALUE SPACES.
  5347 01  ERMAIL-OPEN            PIC X                  VALUE SPACES.
  5348 01  ELMSTR-OPEN            PIC X                  VALUE SPACES.
  5349 01  ELCRTT-OPEN            PIC X                  VALUE SPACES.
  5350 01  ELCRTO-OPEN            PIC X                  VALUE SPACES.
  5351 01  WS-AH-CLAIM-RESCINDED  PIC X                  VALUE 'N'.
  5352 01  EMSG.
  5353     12  WS-FILE-ERROR-MESSAGE.
  5354         16  FILLER              PIC X(24)   VALUE
  5355             'ERROR OCCURED OPENING - '.
  5356         16  WS-FEM-FILE-NAME    PIC X(8).
  5357
  5358 01  CMSG.
  5359     12  WS-FILE-ERROR-MESSAGE.
  5360         16  FILLER              PIC X(24)   VALUE
  5361             'ERROR OCCURED CLOSING - '.
  5362         16  WS-CEM-FILE-NAME    PIC X(8).
  5363
  5364 01  RMSG.
  5365     12  WS-FILE-ERROR-MESSAGE.
  5366         16  FILLER              PIC X(24)   VALUE
  5367             'ERROR OCCURED READING - '.
  5368         16  WS-REM-FILE-NAME    PIC X(8).
  5369
  5370 01  HDG1.
  5371     12  FILLER                  PIC X(50)       VALUE ' '.
  5372     12  FILLER                  PIC X(28)       VALUE
  5373                   'PENDING BUSINESS FILE EDIT '.
  5374     12  ER-ONLY                 PIC X(47)       VALUE
  5375          'NEW ITEMS AND FATAL ERRORS ONLY'.
  5376     12  FILLER                  PIC X(7)        VALUE 'EL517A'.
  5377
  5378 01  HDG2.
  5379     12  FILLER              PIC X(52)              VALUE SPACE.
  5380     12  H2-COMP             PIC X(30).
  5381     12  FILLER              PIC X(42)              VALUE SPACE.
  5382     12  H2-DATE             PIC X(8).
  5383
  5384 01  HDG3.
  5385     12  FILLER              PIC X(54)              VALUE SPACE.
  5386     12  H3-DATE             PIC X(18).
  5387     12  FILLER              PIC X(49)              VALUE SPACE.
  5388
  5389 01  SUM1.
  5390     12  FILLER              PIC XX                 VALUE ' '.
  5391     12  SUM-TOT             PIC ZZ,ZZZ.
  5392     12  FILLER              PIC X(3)               VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  98
* EL517.cbl
  5393     12  FILLER              PIC X(30)              VALUE
  5394          'ITEMS EDITED'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page  99
* EL517.cbl
  5396
  5397 01  WX-AREA.
  5398     12  PH-COBOL            PIC X.
  5399     12  HOLD-ELCNTL         PIC X(750) OCCURS 11 TIMES.
  5400
  5401 01  STATUS-SWITCH.
  5402     12  ELCNTL-FILE-STATUS       PIC XX VALUE SPACES.
  5403     12  ERPNDB-FILE-STATUS       PIC XX VALUE SPACES.
  5404     12  ERREIN-FILE-STATUS       PIC XX VALUE SPACES.
  5405     12  ELCERT-FILE-STATUS       PIC XX VALUE SPACES.
  5406     12  ELMSTR-FILE-STATUS       PIC XX VALUE SPACES.
  5407     12  ERMAIL-FILE-STATUS       PIC XX VALUE SPACES.
  5408     12  ERPLAN-FILE-STATUS       PIC XX VALUE SPACES.
  5409     12  ERFORM-FILE-STATUS       PIC XX VALUE SPACES.
  5410     12  ERPNDM-FILE-STATUS       PIC XX VALUE SPACES.
  5411     12  ERCTBL-FILE-STATUS       PIC XX VALUE SPACES.
  5412     12  ERACCT-FILE-STATUS.
  5413         16  ERACCT-FILE-STAT-1   PIC X  VALUE ' '.
  5414         16  ERACCT-FILE-STAT-2   PIC X  VALUE ' '.
  5415     12  ELCERR-FILE-STATUS       PIC XX VALUE SPACES.
  5416     12  ERRESS-FILE-STATUS       PIC XX VALUE SPACES.
  5417     12  ERRESC-FILE-STATUS       PIC XX VALUE SPACES.
  5418     12  ERCOMP-FILE-STATUS       PIC XX VALUE SPACES.
  5419     12  ERLOFC-FILE-STATUS       PIC XX VALUE SPACES.
  5420     12  ERBXRF-FILE-STATUS       PIC XX VALUE SPACES.
  5421     12  ERAGTC-FILE-STATUS       PIC XX VALUE SPACES.
  5422     12  ELCRTT-FILE-STATUS       PIC XX VALUE SPACES.
  5423     12  ERPDEF-FILE-STATUS       PIC XX VALUE SPACES.
  5424     12  ELSTAT-FILE-STATUS       PIC XX VALUE SPACES.
  5425     12  ELCRTO-FILE-STATUS       PIC XX VALUE SPACES.
  5426
  5427     12  EMI-WARNING-CTR          PIC S999  COMP-3  VALUE +0.
  5428     12  EMI-FORCABLE-CTR         PIC S999  COMP-3  VALUE +0.
  5429     12  EMI-FATAL-CTR            PIC S999  COMP-3  VALUE +0.
  5430     12  WS-SW-1                  PIC X  VALUE ' '.
  5431     12  WS-SW-2                  PIC X  VALUE ' '.
  5432
  5433     12  WS-COMPUTED-TOTALS      COMP-3.
  5434         16  WS-LF-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5435         16  WS-LF-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5436         16  WS-AH-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5437         16  WS-AH-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5438         16  WS-LF-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5439         16  WS-LF-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5440         16  WS-AH-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5441         16  WS-AH-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5442         16  WS-ISSUE-CNT        PIC 9(5)      VALUE ZEROS COMP-3.
  5443         16  WS-CANCEL-CNT       PIC 9(5)      VALUE ZEROS COMP-3.
  5444     12  WS-LGX-CLAIM-USER       PIC X         VALUE SPACES.
  5445         88  CO-HAS-CLAIMS                     VALUE '2'.
  5446
  5447     12  EIBDATE                 PIC S9(7)     COMP-3.
  5448
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 100
* EL517.cbl
  5450
  5451* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
* 5452     COPY ELC50W1.
  5453******************************************************************04/19/98
  5454*                                                                *ELC50W1
  5455*                                                                *ELC50W1
  5456*                             ELC50W1                            *   LV005
  5457*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  5458*                            VMOD=2.004                          *   CL**5
  5459*                                                                *ELC50W1
  5460*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *ELC50W1
  5461*                                                                *ELC50W1
  5462*                                                                *ELC50W1
  5463******************************************************************ELC50W1
  5464                                                                  ELC50W1
  5465     12  WK-WORK-AREA.                                            ELC50W1
  5466         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.          ELC50W1
  5467         16  WK-LAST-CARRIER          PIC X   VALUE ' '.          ELC50W1
  5468         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.          ELC50W1
  5469         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.          ELC50W1
  5470         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5471         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5472         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5473         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5474         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5475         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5476         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.          ELC50W1
  5477         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.          ELC50W1
  5478         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.          ELC50W1
  5479         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.          ELC50W1
  5480         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE. ELC50W1
  5481         16  WK-CREDIT-EDIT-CONTROLS.                             ELC50W1
  5482             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.       ELC50W1
  5483             20  WK-MIN-AGE           PIC 99  VALUE 00.           ELC50W1
  5484             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.           ELC50W1
  5485             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5486             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5487             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.           ELC50W1
  5488         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.     ELC50W1
  5489         16  WK-SAVE-REIN-DATA.                                   ELC50W1
  5490             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.      ELC50W1
  5491             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.      ELC50W1
  5492             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.      ELC50W1
  5493         16  WK-ENTRY-SW              PIC X    VALUE ' '.         ELC50W1
  5494             88  ENTRY-FROM-EL6311       VALUE '6'.               ELC50W1
  5495         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.         ELC50W1
  5496         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.      ELC50W1
  5497     12  WK-RECORD-ADDRESSES.                                     ELC50W1
  5498         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5499         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5500         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5501         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5502         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5503         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5504         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5505         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5506     12  WK-OVER-SHORT-AREA.                                      ELC50W1
  5507         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.   CL**2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 101
* EL517.cbl (/apps/prod/cid1p/copy/ELC50W1)
  5508         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.   CL**2
  5509         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  5510             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  5511         16  FILLER                   PIC X(5) VALUE SPACES.         CL**3
  5512
  5513         16  WK-CONV-GREG.
  5514             24  WCG-CENT             PIC XX.
  5515             24  WCG-REST             PIC X(4).
  5516         16  WORK-GREGORIAN-DATE.
  5517             24  WK-GREG-CENT         PIC XX.
  5518             24  WK-GREG-DATE-YYMMDD.
  5519                 28  WK-GREG-YYMM     PIC X(4).
  5520                 28  WK-GREG-DD       PIC XX.
  5521
  5522         16  WORK-SELECT-DATE.
  5523             24  WK-SELECT-CENT           PIC XX.
  5524             24  WK-SELECT-DATE-YYMMDD.
  5525                 28  WK-SELECT-GREG-YYMM  PIC X(4).
  5526                 28  FILLER               PIC XX.
  5527
  5528         16  WK-FORM-NO.
  5529             24  WK-FORM-BANK-ID       PIC X(5).
  5530             24  WK-FORM-UNDRWRTR      PIC X(1).
  5531             24  WK-FORM-MASTER-POL-NO PIC X(6).
  5532
  5533         16  WK-MEMBER-NO.
  5534             24  WK-MEMBER-1-6        PIC X(6).
  5535             24  WK-MEMBER-7-12       PIC X(6).
  5536
  5537         16  WK-FULL-CERT-NO.
  5538             24  WK-CERT-POS-1-2      PIC X(2).
  5539             24  WK-CERT-POS-3        PIC X(1).
  5540             24  WK-CERT-POS-4        PIC X(1).
  5541             24  WK-CERT-POS-5-6      PIC X(2).
  5542             24  WK-CERT-POS-7        PIC X(1).
  5543             24  WK-CERT-POS-8-11     PIC X(4).
  5544
  5545         16  WK-VALID-RATE-CODE      PIC X VALUE ' '.
  5546             88  VALID-RATE-CODE     VALUE 'Y'.
  5547             88  FOUND-TO-BE-INVALID VALUE 'N'.
  5548
  5549     12  WK-BATCH-NO.
  5550         16  WK-BATCH-PREFIX          PIC XXX       VALUE SPACES.
  5551         16  FILLER                   PIC XXX       VALUE SPACES.
  5552
* 5553                                  COPY ELCEDITC.
  5554******************************************************************04/15/98
  5555*                                                                *ELCEDITC
  5556*                                                                *ELCEDITC
  5557*                            ELCEDITC                            *   LV002
  5558*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5559*                            VMOD=2.012                          *   CL**2
  5560*                                                                *ELCEDITC
  5561*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *ELCEDITC
  5562*                     EL6313, EL050 AND EL517.                   *ELCEDITC
  5563*                                                                *ELCEDITC
  5564******************************************************************ELCEDITC
  5565******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 102
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5566*                   C H A N G E   L O G
  5567*
  5568* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5569*-----------------------------------------------------------------
  5570*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5571* EFFECTIVE    NUMBER
  5572*-----------------------------------------------------------------
  5573* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5574******************************************************************
  5575                                                                  ELCEDITC
  5576     12  EDIT-CRITERIA-DATA.                                      ELCEDITC
  5577         16  EC-CO-MONTH-END-DT       PIC XX.                     ELCEDITC
  5578         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5579         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
  5580         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5581         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5582         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.       ELCEDITC
  5583         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.       ELCEDITC
  5584         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5585         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5586         16  EC-CO-REM-TERM-CALC      PIC X.                      ELCEDITC
  5587               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.     ELCEDITC
  5588               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.     ELCEDITC
  5589               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.     ELCEDITC
  5590               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.     ELCEDITC
  5591                                                                  ELCEDITC
  5592         16  EC-BR-LF-EARNINGS-CALC    PIC X.                     ELCEDITC
  5593               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5594               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5595               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5596               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.    ELCEDITC
  5597               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.    ELCEDITC
  5598               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5599               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5600               88  EC-BR-LF-EARN-MEAN               VALUE '8'.    ELCEDITC
  5601               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.    ELCEDITC
  5602               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5603                                                                  ELCEDITC
  5604         16  EC-BR-AH-EARNINGS-CALC    PIC X.                     ELCEDITC
  5605               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5606               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5607               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5608               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.    ELCEDITC
  5609               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5610               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5611               88  EC-BR-AH-EARN-MEAN               VALUE '8'.    ELCEDITC
  5612               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5613                                                                  ELCEDITC
  5614         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5615                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5616                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5617                                                                  ELCEDITC
  5618         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5619                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5620                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.  ELCEDITC
  5621                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.  ELCEDITC
  5622                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.  ELCEDITC
  5623                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.  ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 103
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5624                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.  ELCEDITC
  5625                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5626                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.  ELCEDITC
  5627                                                                  ELCEDITC
  5628         16  EC-BR-LF-COVERAGE-TYPE    PIC X.                     ELCEDITC
  5629               88  EC-BR-REDUCING                   VALUE 'R'.    ELCEDITC
  5630               88  EC-BR-LEVEL                      VALUE 'L' 'P'.ELCEDITC
  5631                                                                  ELCEDITC
  5632         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).                  ELCEDITC
  5633         16  EC-BR-LF-DESC             PIC X(10).                 ELCEDITC
  5634         16  EC-BR-AH-DESC             PIC X(10).                 ELCEDITC
  5635         16  EC-BR-LF-COMMENT          PIC X(10).                 ELCEDITC
  5636         16  EC-BR-AH-COMMENT          PIC X(10).                 ELCEDITC
  5637                                                                  ELCEDITC
  5638         16  EC-BR-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5639               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5640               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5641               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5642               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5643                                                                  ELCEDITC
  5644         16  EC-BR-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5645               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5646               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5647               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5648               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5649                                                                  ELCEDITC
  5650         16  EC-BR-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5651                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5652                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5653                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5654                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5655                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5656                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5657                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5658                                                                  ELCEDITC
  5659         16  EC-BR-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5660                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5661                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5662                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5663                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5664                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5665                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5666                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5667                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5668                                                                  ELCEDITC
  5669         16  EC-BR-LF-BEN-I-G-CD       PIC X.                     ELCEDITC
  5670                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5671                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5672                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5673                                                                  ELCEDITC
  5674         16  EC-BR-AH-BEN-I-G-CD       PIC X.                     ELCEDITC
  5675                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5676                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5677                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5678                                                                  ELCEDITC
  5679         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5680         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5681         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 104
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5682         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5683                                                                  ELCEDITC
  5684         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.       ELCEDITC
  5685         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.                      ELCEDITC
  5686                 88  EC-ST-EXT-NO-CHG               VALUE ' '.    ELCEDITC
  5687                 88  EC-ST-EXT-CHG-LF               VALUE '1'.    ELCEDITC
  5688                 88  EC-ST-EXT-CHG-AH               VALUE '2'.    ELCEDITC
  5689                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.    ELCEDITC
  5690                                                                  ELCEDITC
  5691         16  EC-ST-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5692               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5693               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5694               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5695               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5696               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5697                                                                  ELCEDITC
  5698         16  EC-ST-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5699               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5700               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5701               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5702               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5703               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5704                                                                  ELCEDITC
  5705         16  EC-ST-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5706                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5707                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5708                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5709                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5710                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5711                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5712                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5713                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5714                                                                  ELCEDITC
  5715         16  EC-ST-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5716                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5717                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5718                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5719                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5720                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5721                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5722                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5723                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5724                                                                  ELCEDITC
  5725         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5726         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5727         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5728         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5729         16  EC-AM-EXPIRATION-DT       PIC XX.                    ELCEDITC
  5730         16  EC-AM-EFFECTIVE-DT        PIC XX.                    ELCEDITC
  5731         16  EC-AM-CLASS-CD            PIC XX.                    ELCEDITC
  5732         16  EC-AM-LF-DEVIATION        PIC XXX.                   ELCEDITC
  5733         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5734         16  EC-AM-AH-DEVIATION        PIC XXX.                   ELCEDITC
  5735         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5736         16  EC-AM-PHONE-NO            PIC X(10).                 ELCEDITC
  5737                                                                  ELCEDITC
  5738         16  EC-AM-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5739                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 105
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5740                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5741                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5742                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5743                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5744                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5745                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5746                                                                  ELCEDITC
  5747         16  EC-AM-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5748                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5749                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5750                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5751                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.    ELCEDITC
  5752                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5753                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5754                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5755                                                                  ELCEDITC
  5756         16  EC-AM-BEN-I-G-CD          PIC X.                     ELCEDITC
  5757                 88  WK-AM-I-G-NOT-USED             VALUE ' '.    ELCEDITC
  5758                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.    ELCEDITC
  5759                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.    ELCEDITC
  5760                                                                  ELCEDITC
  5761         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5762         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5763         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5764         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5765         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5766         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5767         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5768         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5769         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5770                                                                  ELCEDITC
  5771         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5772         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5773         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5774         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5775         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5776         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5777         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5778         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5779         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5780         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5781         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5782         16  EC-RT-LF-NSP-ST           PIC XX.                    ELCEDITC
  5783         16  EC-RT-AH-NSP-ST           PIC XX.                    ELCEDITC
  5784         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5785         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5786                                                                  ELCEDITC
  5787         16  EC-CM-LF-PRIOR-STATUS     PIC X.                     ELCEDITC
  5788             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5789                                             'M' '5' '9' '2'.     ELCEDITC
  5790             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5791             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5792             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5793             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5794             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5795             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5796             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5797             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 106
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5798             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5799             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5800                                                                  ELCEDITC
  5801         16  EC-CM-AH-PRIOR-STATUS     PIC X.                     ELCEDITC
  5802             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5803                                             'M' '5' '9' '2'.     ELCEDITC
  5804             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5805             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5806             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5807             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5808             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5809             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5810             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5811             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
  5812             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5813             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5814                                                                  ELCEDITC
  5815         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5816         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5817         16  EC-CM-LF-CANCEL-DT        PIC XX.                    ELCEDITC
  5818         16  EC-CM-AH-CANCEL-DT        PIC XX.                    ELCEDITC
  5819         16  EC-CM-DEATH-DT            PIC XX.                    ELCEDITC
  5820                                                                  ELCEDITC
  5821*DMD CUSTOM CODING FIELDS BELOW                                   ELCEDITC
  5822*POPULATED BY CF-RATING-SWITCH AT EL050 TIME                      ELCEDITC
  5823         16  EC-BR-DMD-RATING-SW       PIC X.                     ELCEDITC
  5824                 88  EC-DMD-AH-RATING            VALUE 'Y'.       ELCEDITC
  5825                 88  EC-DMD-LF-RATING            VALUE 'Y'.       ELCEDITC
  5826                 88  NO-DMD-RATING               VALUE 'N'.       ELCEDITC
  5827                                                                  ELCEDITC
  5828         16  EC-NEW-CERT               PIC X(11).                 ELCEDITC
  5829         16  EC-NEW-STATE              PIC XX.                    ELCEDITC
  5830         16  FILLER                    PIC X.                     ELCEDITC
  5831*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.                 ELCEDITC
  5832         16  OVER-SHORT-EDIT-FIELDS.                              ELCEDITC
  5833             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5834             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5835             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5836             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5837             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5838             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5839             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5840             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5841             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5842         16  FILLER                    PIC X(71).                 ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 107
* EL517.cbl
* 5844                                  COPY ELC50WS.
  5845*****************************************************************
  5846*                                                               *
  5847*                            ELC50WS.                           *
  5848*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5849*                            VMOD=2.061.                        *
  5850*                                                               *
  5851*   THIS IS THE WORKING STORAGE FOR EL050                       *
  5852*                                   EL517                       *
  5853*****************************************************************
  5854******************************************************************
  5855*                   C H A N G E   L O G
  5856*
  5857* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5858*-----------------------------------------------------------------
  5859*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5860* EFFECTIVE    NUMBER
  5861*-----------------------------------------------------------------
  5862* 123102                   PEMA  ADD DCC PROCESSING
  5863* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
  5864* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
  5865* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5866* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5867* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  5868* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  5869* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  5870* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
  5871* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  5872* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  5873* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
  5874* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  5875* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  5876* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  5877* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  5878* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
  5879* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5880* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
  5881* 030309  CR2009021700001  PEMA  ADD ER-2883
  5882* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
  5883* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5884* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  5885* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  5886* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
  5887* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  5888* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  5889* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  5890* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5891* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  5892* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  5893* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  5894* 061412  CR2011022800001  AJRA  NAPERSOFT
  5895* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5896* 012213  CR2013011600001  PEMA  ADD ERROR 3058
  5897* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  5898*-----------------------------------------------------------------
  5899
  5900 01  WORK-AREAS.
  5901
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 108
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  5902*****************************************************************
  5903*        WORKING STORAGE AREA FOR CLIENT-MON                    *
  5904*****************************************************************
  5905
  5906     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
  5907     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
  5908     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
  5909     12  WS-NAME-EDIT-WORK-AREA.
  5910         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
  5911         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
  5912             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
  5913         16  WS-WORK-NAME.
  5914             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
  5915             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
  5916             20  FILLER           PIC X(10)     VALUE SPACES.
  5917         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
  5918             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
  5919
  5920*****************************************************************
  5921*        END OF WORKING STORAGE FOR CLIENT-MON                  *
  5922*****************************************************************
  5923
  5924     12  WS-ERRESC-KEY.
  5925         16 WS-ERRESC-SEARCH-KEY.
  5926             20  WS-ERRESC-COMPANY-CD PIC  X.
  5927             20  WS-ERRESC-CARRIER    PIC  X.
  5928             20  WS-ERRESC-GROUP      PIC X(6).
  5929             20  WS-ERRESC-STATE      PIC XX.
  5930             20  WS-ERRESC-ACCOUNT    PIC X(10).
  5931         16 WS-ERRESC-RESIDUAL-KEY.
  5932             20  WS-ERRESC-AGENT      PIC X(10).
  5933             20  WS-ERRESC-RES-STATE  PIC XX.
  5934             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  5935*                                          YYYYMMDD
  5936     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  5937     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
  5938
  5939*RESIDENT STATE TAX MASTER(ERRESS)
  5940*
  5941     12  WS-ERRESS-KEY.
  5942         16  WS-ERRESS-COMPANY-CD      PIC  X.
  5943         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
  5944         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
  5945         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
  5946*                                          YYYYMMDD
  5947
  5948     12  WS-CONTRACT-DATE              PIC 9(8).
  5949*                                          YYYYMMDD
  5950     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
  5951     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
  5952         16 WS-YEAR-YY                 PIC   9999.
  5953         16 FILLER                     PIC 9(4).
  5954*                                          YYYYMMDD
  5955     12  WS-SAVE-ERRESS-KEY            PIC X(9).
  5956     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
  5957     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
  5958     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
  5959
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 109
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  5960     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
  5961         88  DPRB-1ST-TIME                      VALUE ' '.
  5962
  5963*****************************************************************
  5964*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
  5965*****************************************************************
  5966
  5967     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
  5968     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
  5969     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
  5970     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
  5971     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
  5972     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
  5973     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
  5974     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
  5975     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
  5976     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
  5977         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
  5978         88 NO-AH-COVERAGE           VALUE '  ' '00'.
  5979     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
  5980         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
  5981         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
  5982     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
  5983
  5984     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
  5985     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
  5986
  5987     12  WS-R78-METHOD            PIC X         VALUE SPACES.
  5988     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
  5989     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  5990     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  5991     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  5992     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  5993     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  5994     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  5995     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  5996     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  5997     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  5998     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  5999     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
  6000     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
  6001     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
  6002     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
  6003     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  6004     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  6005     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  6006     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  6007     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  6008     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  6009     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  6010     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  6011     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  6012     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  6013     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  6014     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  6015     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  6016     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  6017     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 110
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6018     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  6019     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  6020     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  6021     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
  6022     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
  6023     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
  6024     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
  6025     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
  6026     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
  6027     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
  6028     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
  6029     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
  6030     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
  6031     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
  6032     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
  6033     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
  6034     12  WS-IG-OVRD               PIC X         VALUE SPACES.
  6035     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
  6036     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
  6037     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
  6038     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
  6039     12  WS-2671-SW               PIC X         VALUE SPACE.
  6040     12  WS-2672-SW               PIC X         VALUE SPACE.
  6041     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
  6042         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
  6043     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
  6044         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
  6045     12  W-BROWSE-SW              PIC X         VALUE SPACE.
  6046
  6047     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
  6048         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
  6049         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
  6050         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
  6051         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
  6052
  6053     12  WS-CREDIT-EDIT-CONTROLS.
  6054         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
  6055         16  WS-MIN-AGE           PIC 99                VALUE  0.
  6056         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
  6057         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6058         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6059         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
  6060
  6061     12  WS-AGE-FIELDS.
  6062         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
  6063         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
  6064         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
  6065         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
  6066
  6067     12  WS-SAVE-ALLOWABLE-BENEFIT.
  6068         16  WS-SAVE-BENEFIT-CODE       PIC XX.
  6069         16  WS-SAVE-BENEFIT-TYPE       PIC X.
  6070         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
  6071         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
  6072         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
  6073         16  FILLER                      PIC XX.
  6074
  6075     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 111
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6076     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
  6077     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
  6078     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
  6079     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
  6080     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
  6081     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
  6082     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
  6083     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6084     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6085
  6086     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
  6087     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
  6088     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6089     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
  6090     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
  6091     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
  6092     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
  6093     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
  6094         88  WS-REDUCING              VALUE 'R'.
  6095         88  WS-LEVEL                 VALUE 'L' 'P'.
  6096     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
  6097
  6098     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
  6099     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
  6100     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6101     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
  6102     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
  6103     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
  6104     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
  6105     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
  6106     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
  6107
  6108     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
  6109     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
  6110     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
  6111     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6112     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
  6113     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6114     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
  6115     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
  6116     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
  6117     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
  6118     12  WS-ACCT-SIG-SW.
  6119         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
  6120         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
  6121     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6122     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6123     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
  6124     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
  6125     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
  6126     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6127     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
  6128     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6129     12  WS-INITIALS.
  6130         16  WS-INIT-1            PIC X         VALUE SPACES.
  6131         16  WS-INIT-2            PIC X         VALUE SPACES.
  6132
  6133     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 112
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6134     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
  6135     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
  6136     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
  6137     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
  6138*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
  6139     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
  6140     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
  6141     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
  6142     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6143     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6144     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
  6145     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
  6146     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
  6147     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
  6148     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
  6149     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
  6150     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
  6151     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
  6152     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6153     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6154     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
  6155     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6156     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6157     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6158     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6159     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6160     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6161******** FLA
  6162     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6163     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6164     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6165     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6166     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6167********
  6168     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
  6169     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
  6170     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
  6171     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
  6172     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
  6173     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
  6174     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
  6175     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
  6176     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
  6177     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
  6178
  6179     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
  6180         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
  6181                                         '0' THRU '9'.
  6182
  6183     12  NUMBER-OF-MONTHS.
  6184         16  SK-MO OCCURS 12 TIMES PIC X.
  6185
  6186     12  WS-WORK-DATE.
  6187         16  WS-YEAR            PIC 99    VALUE 00.
  6188         16  WS-MONTH           PIC 99    VALUE 00.
  6189         16  WS-DAY             PIC 99    VALUE 00.
  6190
  6191     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 113
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6192     12  WS-WORK-CRIT-DEV       REDEFINES
  6193         WS-WORK-LF-CRIT-PER    PIC X(03).
  6194
  6195     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
  6196     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
  6197
  6198     12  WS-WORK-DATE-FROM.
  6199         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
  6200         16  FILLER             PIC X  VALUE SPACE.
  6201         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
  6202         16  FILLER             PIC X         VALUE SPACE.
  6203         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
  6204
  6205     12  WS-WORK-DATE-THRU.
  6206         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
  6207         16  FILLER             PIC X         VALUE SPACE.
  6208         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
  6209         16  FILLER             PIC X         VALUE SPACE.
  6210         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
  6211
  6212     12  WS-LF-INPUT-CD.
  6213         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
  6214         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
  6215
  6216     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
  6217     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
  6218         16  WS-AH-INPUT-CD-1   PIC X.
  6219         16  WS-AH-INPUT-CD-2-3 PIC XX.
  6220
  6221     12  WS-SWITCHES.
  6222         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
  6223         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
  6224             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
  6225         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
  6226             88  BANK-ACCT-FOUND          VALUE 'Y'.
  6227         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
  6228             88  AGENT-MASTER-FOUND       VALUE 'Y'.
  6229         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
  6230             88  BXRF-MASTER-FOUND        VALUE 'Y'.
  6231         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
  6232             88  COMP-MASTER-FOUND        VALUE 'Y'.
  6233         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
  6234             88  LOFC-MASTER-FOUND        VALUE 'Y'.
  6235         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
  6236             88  PDEF-MASTER-FOUND        VALUE 'Y'.
  6237         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
  6238             88  STAT-MASTER-FOUND        VALUE 'Y'.
  6239         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
  6240             88  PLAN-MASTER-FOUND        VALUE 'Y'.
  6241         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
  6242             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
  6243         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
  6244             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
  6245         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
  6246             88  FORM-MASTER-FOUND        VALUE 'Y'.
  6247         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
  6248             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
  6249         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 114
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6250             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
  6251         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
  6252             88  PROCESS-FORM-EDITS       VALUE 'Y'.
  6253         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
  6254             88  NO-BENEFIT-FOUND         VALUE 'N'.
  6255         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
  6256             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
  6257         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
  6258             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
  6259         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6260             88  AH-BENEFIT-FOUND         VALUE ' '.
  6261             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
  6262         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6263             88  LF-BENEFIT-FOUND         VALUE ' '.
  6264             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
  6265         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
  6266             88  NO-STATE-RECORD          VALUE '1'.
  6267         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
  6268             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
  6269         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
  6270             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
  6271         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
  6272             88  CERT-WAS-FOUND           VALUE ' '.
  6273             88  CERT-WAS-NOT-FOUND       VALUE '1'.
  6274         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
  6275             88  BROWSE-STARTED           VALUE 'Y'.
  6276         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
  6277             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
  6278         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
  6279             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
  6280         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
  6281             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
  6282         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
  6283             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
  6284         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
  6285             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
  6286         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
  6287             88  APP-CERT-USED            VALUE 'Y' 'A'.
  6288         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
  6289             88  CTBL-TABLE-FOUND         VALUE 'Y'.
  6290             88  FIRST-TIME-THROUGH       VALUE '1'.
  6291             88  CTBL-NOT-FOUND           VALUE '2'.
  6292
  6293         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
  6294             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
  6295
  6296         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
  6297             88  DLO-ERROR-FOUND          VALUE 'Y'.
  6298
  6299********FLA
  6300     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
  6301     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
  6302********
  6303     12  RC-SW-1                  PIC X           VALUE '0'.
  6304     12  RC-SW-2                  PIC X           VALUE '0'.
  6305     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
  6306     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
  6307     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 115
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6308     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
  6309     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
  6310     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
  6311     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
  6312     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
  6313     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
  6314     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
  6315     12  LIT-SPACES               PIC X           VALUE SPACES.
  6316     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
  6317     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
  6318     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
  6319     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
  6320     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6321     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6322     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
  6323         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
  6324         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
  6325     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
  6326         88  SKIP-ADDR-EDIT         VALUE 'Y'.
  6327
  6328 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
  6329     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
  6330     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
  6331 01  WS-CRI-SSN-WORK-AREA.
  6332     05  WS-CRI-SOC-SEC-NO.
  6333         10  WS-SS-REPT-CD       PIC X(5).
  6334         10  WS-SS-LAST-NAME     PIC X(5).
  6335         10  WS-SS-INITIAL       PIC X.
  6336
  6337     05  WS-CRI-REPORT-CODE.
  6338         10  FILLER              PIC X(5).
  6339         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
  6340
  6341     05  WS-CRI-LAST-NAME.
  6342         10  WS-CRI-NAME-MOVE    PIC X(5).
  6343         10  FILLER              PIC X(10).
  6344
  6345 01  WS-NUM-TABLE                PIC X(26)  VALUE
  6346     '12345678012345070923456789'.
  6347 01  FILLER REDEFINES WS-NUM-TABLE.
  6348     05  WS-NUM OCCURS 26        PIC 9.
  6349 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
  6350 01  V1                          PIC S999 COMP-3.
  6351 01  V2                          PIC S999 COMP-3.
  6352 01  V3                          PIC S999 COMP-3.
  6353 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
  6354 01  FILLER REDEFINES WS-WORK-VIN.
  6355     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
  6356 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
  6357 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
  6358 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
  6359 01  WS-HEX-WORK.
  6360     05  FILLER                  PIC X  VALUE LOW-VALUES.
  6361     05  WS-HEX-BYTE             PIC X.
  6362 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
  6363 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
  6364
  6365 01  WS-WORK-HIN-ROW-B.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 116
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6366     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
  6367
  6368 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
  6369 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
  6370     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
  6371 01  WS-ROW-D-TABLE.
  6372     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
  6373
  6374 01  WS-HIN-TABLE-B.
  6375     05  F                       PIC XX VALUE 'A2'.
  6376     05  F                       PIC XX VALUE 'B3'.
  6377     05  F                       PIC XX VALUE 'C4'.
  6378     05  F                       PIC XX VALUE 'D5'.
  6379     05  F                       PIC XX VALUE 'E6'.
  6380     05  F                       PIC XX VALUE 'F7'.
  6381     05  F                       PIC XX VALUE 'G8'.
  6382     05  F                       PIC XX VALUE 'H9'.
  6383     05  F                       PIC XX VALUE 'I1'.
  6384     05  F                       PIC XX VALUE 'J2'.
  6385     05  F                       PIC XX VALUE 'K3'.
  6386     05  F                       PIC XX VALUE 'L4'.
  6387     05  F                       PIC XX VALUE 'M5'.
  6388     05  F                       PIC XX VALUE 'N6'.
  6389     05  F                       PIC XX VALUE 'O0'.
  6390     05  F                       PIC XX VALUE 'P7'.
  6391     05  F                       PIC XX VALUE 'Q0'.
  6392     05  F                       PIC XX VALUE 'R8'.
  6393     05  F                       PIC XX VALUE 'S9'.
  6394     05  F                       PIC XX VALUE 'T2'.
  6395     05  F                       PIC XX VALUE 'U3'.
  6396     05  F                       PIC XX VALUE 'V4'.
  6397     05  F                       PIC XX VALUE 'W5'.
  6398     05  F                       PIC XX VALUE 'X6'.
  6399     05  F                       PIC XX VALUE 'Y7'.
  6400     05  F                       PIC XX VALUE 'Z8'.
  6401 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
  6402     05  WS-VAL-IN               PIC X.
  6403     05  WS-VAL-OUT              PIC 9.
  6404 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
  6405
  6406 01  WS-COMPARE-BINARY-DATES.
  6407     05  WS-971231                PIC XX VALUE X'92FF'.
  6408     05  WS-931231                PIC XX VALUE X'8CFF'.
  6409     05  WS-791231                PIC XX VALUE X'77FF'.
  6410     05  WS-771001                PIC XX VALUE X'74A1'.
  6411     05  WS-820301                PIC XX VALUE X'7B41'.
  6412     05  WS-831031                PIC XX VALUE X'7DBF'.
  6413     05  WS-831231                PIC XX VALUE X'7DFF'.
  6414     05  WS-810831                PIC XX VALUE X'7A7F'.
  6415     05  WS-830901                PIC XX VALUE X'7D81'.
  6416
  6417 01  FILE-ACCESS-IDS.
  6418     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
  6419     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
  6420     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
  6421     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
  6422     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
  6423     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 117
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6424     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
  6425     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
  6426     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
  6427     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
  6428     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
  6429     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
  6430     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
  6431     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
  6432     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
  6433     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
  6434     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
  6435
  6436 01  DD-IU-SW                    PIC X   VALUE ' '.
  6437     88  DD-IU-PRESENT                 VALUE 'Y'.
  6438
  6439 01  ACCESS-KEYS.
  6440     12  ELMSTR-KEY.
  6441         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
  6442         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
  6443     12  W-CLAIM-KEY.
  6444         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
  6445         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
  6446
  6447     12  ELCNTL-KEY.
  6448         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
  6449         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
  6450         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
  6451         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
  6452
  6453     12  ELCERT-KEY.
  6454         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
  6455         16  CERT-CARRIER         PIC X       VALUE SPACE.
  6456         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
  6457         16  CERT-STATE           PIC XX      VALUE SPACES.
  6458         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
  6459         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
  6460         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
  6461
  6462     12  ELCERT2-KEY.
  6463         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
  6464         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
  6465
  6466     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
  6467
  6468     12  ELCERT-SAVE.
  6469         16  FILLER                      PIC XX    VALUE SPACES.
  6470
  6471         16  WCS-CONTROL-PRIMARY.
  6472             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
  6473             20  WCS-CARRIER             PIC X     VALUE SPACE.
  6474             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
  6475             20  WCS-STATE               PIC XX    VALUE SPACES.
  6476             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
  6477             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
  6478             20  WCS-CERT-NO.
  6479                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
  6480                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
  6481
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 118
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6482         16  CS-CONTROL-BY-NAME.
  6483             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
  6484             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
  6485             20  CS-INSURED-INITIALS.
  6486                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
  6487                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
  6488
  6489         16  CS-CONTROL-BY-SSN.
  6490             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
  6491             20  CS-SOC-SEC-NO.
  6492                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
  6493                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
  6494                 24  CS-SSN-LN3.
  6495                     28 CS-INSURED-INITIALS-A2   PIC XX
  6496                                     VALUE SPACES.
  6497                     28 CS-PART-LAST-NAME-A2     PIC X
  6498                                     VALUE SPACE.
  6499
  6500         16  CS-CONTROL-BY-CERT-NO.
  6501             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
  6502             20  CS-CERT-NO-A4           PIC X(11)
  6503                                     VALUE SPACES.
  6504
  6505         16  CS-CONTROL-BY-MEMB.
  6506             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
  6507             20  CS-MEMBER-NO.
  6508                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
  6509                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
  6510                 24  CS-MEMB-LN4.
  6511                     28 CS-INSURED-INITIALS-A5   PIC XX
  6512                                      VALUE SPACES.
  6513                     28 CS-PART-LAST-NAME-A5     PIC XX
  6514                                      VALUE SPACES.
  6515
  6516         16  FILLER              PIC X(360) VALUE SPACES.
  6517
  6518     12  ERACCT-KEY.
  6519         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
  6520         16  ACCT-CARRIER         PIC X     VALUE SPACES.
  6521         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
  6522         16  ACCT-STATE           PIC X(02) VALUE SPACES.
  6523         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
  6524         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
  6525
  6526     12  ERCOMP-KEY.
  6527         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
  6528         16  COMP-CARRIER         PIC X     VALUE SPACES.
  6529         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
  6530         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
  6531         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
  6532         16  COMP-TYPE            PIC X     VALUE SPACES.
  6533
  6534     12  ERLOFC-KEY.
  6535         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6536         16  LOFC-CARRIER         PIC X     VALUE SPACES.
  6537         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
  6538         16  LOFC-STATE           PIC XX    VALUE SPACES.
  6539         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 119
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6540         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
  6541
  6542     12  WS-ELCRTT-KEY.
  6543         16  WS-ELCRTT-PRIMARY       PIC X(33).
  6544         16  WS-ELCRTT-REC-TYPE      PIC X(1).
  6545
  6546     12  ERBXRF-KEY.
  6547         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
  6548         16  BXRF-CARRIER         PIC X     VALUE SPACES.
  6549         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
  6550         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
  6551
  6552     12  ERAGTC-KEY.
  6553         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6554         16  AGTC-CARRIER         PIC X     VALUE SPACES.
  6555         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
  6556         16  AGTC-BANK            PIC X(10) VALUE SPACES.
  6557         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
  6558         16  AGTC-TYPE            PIC X     VALUE SPACES.
  6559
  6560     12  ERPLAN-KEY.
  6561         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6562         16  PLAN-CARRIER         PIC X     VALUE SPACES.
  6563         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
  6564         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
  6565         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
  6566         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
  6567         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
  6568         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
  6569
  6570     12  ERFORM-KEY.
  6571         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6572         16  FORM-STATE           PIC X(2)  VALUE SPACES.
  6573         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
  6574         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
  6575
  6576     12  ERREIN-KEY.
  6577         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
  6578         16  REIN-TYPE            PIC X     VALUE SPACES.
  6579         16  REIN-TABLE-CO.
  6580             20  REIN-CODE-1      PIC X     VALUE SPACE.
  6581             20  REIN-CODE-2      PIC X     VALUE SPACE.
  6582             20  REIN-CODE-3      PIC X     VALUE SPACE.
  6583         16  FILLER               PIC X(3)  VALUE SPACES.
  6584
  6585     12  ERCTBL-KEY.
  6586         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6587         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
  6588         16  CTBL-CNTRL-2.
  6589             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
  6590             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
  6591
  6592     12  ELCRTO-KEY.
  6593         16  ELCRTO-COMPANY-CD       PIC X.
  6594         16  ELCRTO-CARRIER          PIC X.
  6595         16  ELCRTO-GROUPING         PIC X(6).
  6596         16  ELCRTO-STATE            PIC XX.
  6597         16  ELCRTO-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 120
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6598         16  ELCRTO-CERT-EFF-DT      PIC XX.
  6599         16  ELCRTO-CERT-NO.
  6600             20  ELCRTO-CERT-PRIME   PIC X(10).
  6601             20  ELCRTO-CERT-SFX     PIC X.
  6602         16  ELCRTO-RECORD-TYPE      PIC X.
  6603         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
  6604
  6605
  6606     12  WS-ACCESS.
  6607         16  FILLER               PIC XX    VALUE SPACES.
  6608         16  WS-BEN-CD            PIC XX    VALUE SPACES.
  6609
  6610     12  WS-CARR-ACCESS.
  6611         16  FILLER               PIC X(3)  VALUE SPACES.
  6612         16  WS-CARR              PIC X     VALUE SPACE.
  6613*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
  6614*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
  6615     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
  6616         88  WS-DMD-LF-RATING   VALUE 'Y'.
  6617         88  WS-DMD-AH-RATING   VALUE 'Y'.
  6618         88  WS-DMD-NO-RATING   VALUE 'N'.
  6619
  6620
  6621     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
  6622         88  WS-LF-CASH            VALUE 'MJ' 'MS'
  6623                                         'NJ' 'NL'
  6624                                         'PJ' 'PL'
  6625                                         'SJ' 'SL'.
  6626     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
  6627         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
  6628                                         'NI' 'NJ' 'NL' 'NU'
  6629                                         'PJ' 'PL' 'PI' 'PU'
  6630                                         'SI' 'SJ' 'SL' 'SU'
  6631                                         'MX' 'MY' 'MZ'.
  6632
  6633 01  ERPDEF-KEY-SAVE             PIC X(18).
  6634 01  ERPDEF-KEY.
  6635     12  ERPDEF-COMPANY-CD       PIC X.
  6636     12  ERPDEF-STATE            PIC XX.
  6637     12  ERPDEF-PROD-CD          PIC XXX.
  6638     12  F                       PIC X(7).
  6639     12  ERPDEF-BEN-TYPE         PIC X.
  6640     12  ERPDEF-BEN-CODE         PIC XX.
  6641     12  ERPDEF-EXP-DT           PIC XX.
  6642
  6643 01  ELSTAT-KEY-SAVE             PIC X(20).
  6644 01  ELSTAT-KEY.
  6645     12  ELSTAT-COMPANY-ID       PIC XXX.
  6646     12  ELSTAT-CARRIER          PIC X.
  6647     12  ELSTAT-GROUP            PIC X(6).
  6648     12  ELSTAT-STATE            PIC XX.
  6649     12  ELSTAT-EXP-DT           PIC 9(8).
  6650
  6651 01  WS-ERROR-VALUES.
  6652     12  ER-1570                     PIC S9(4)   VALUE +1570.
  6653     12  ER-1571                     PIC S9(4)   VALUE +1571.
  6654     12  ER-1575                     PIC S9(4)   VALUE +1575.
  6655     12  ER-1891                     PIC S9(4)   VALUE +1891.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 121
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6656     12  ER-1892                     PIC S9(4)   VALUE +1892.
  6657     12  ER-1893                     PIC S9(4)   VALUE +1893.
  6658     12  ER-1894                     PIC S9(4)   VALUE +1894.
  6659     12  ER-1895                     PIC S9(4)   VALUE +1895.
  6660     12  ER-1896                     PIC S9(4)   VALUE +1896.
  6661     12  ER-1897                     PIC S9(4)   VALUE +1897.
  6662     12  ER-1898                     PIC S9(4)   VALUE +1898.
  6663     12  ER-1899                     PIC S9(4)   VALUE +1899.
  6664     12  ER-1900                     PIC S9(4)   VALUE +1900.
  6665     12  ER-1901                     PIC S9(4)   VALUE +1901.
  6666     12  ER-1902                     PIC S9(4)   VALUE +1902.
  6667     12  ER-1903                     PIC S9(4)   VALUE +1903.
  6668     12  ER-1904                     PIC S9(4)   VALUE +1904.
  6669     12  ER-1905                     PIC S9(4)   VALUE +1905.
  6670     12  ER-1906                     PIC S9(4)   VALUE +1906.
  6671     12  ER-1907                     PIC S9(4)   VALUE +1907.
  6672     12  ER-1909                     PIC S9(4)   VALUE +1909.
  6673     12  ER-1910                     PIC S9(4)   VALUE +1910.
  6674     12  ER-1911                     PIC S9(4)   VALUE +1911.
  6675     12  ER-1912                     PIC S9(4)   VALUE +1912.
  6676     12  ER-1913                     PIC S9(4)   VALUE +1913.
  6677     12  ER-1914                     PIC S9(4)   VALUE +1914.
  6678     12  ER-1915                     PIC S9(4)   VALUE +1915.
  6679     12  ER-1916                     PIC S9(4)   VALUE +1916.
  6680     12  ER-1917                     PIC S9(4)   VALUE +1917.
  6681     12  ER-1918                     PIC S9(4)   VALUE +1918.
  6682     12  ER-1919                     PIC S9(4)   VALUE +1919.
  6683     12  ER-1920                     PIC S9(4)   VALUE +1920.
  6684     12  ER-1921                     PIC S9(4)   VALUE +1921.
  6685     12  ER-1922                     PIC S9(4)   VALUE +1922.
  6686     12  ER-1923                     PIC S9(4)   VALUE +1923.
  6687     12  ER-1924                     PIC S9(4)   VALUE +1924.
  6688     12  ER-1925                     PIC S9(4)   VALUE +1925.
  6689     12  ER-1926                     PIC S9(4)   VALUE +1926.
  6690     12  ER-1927                     PIC S9(4)   VALUE +1927.
  6691     12  ER-2393                     PIC S9(4)   VALUE +2393.
  6692     12  ER-2600                     PIC S9(4)   VALUE +2600.
  6693     12  ER-2601                     PIC S9(4)   VALUE +2601.
  6694     12  ER-2602                     PIC S9(4)   VALUE +2602.
  6695     12  ER-2603                     PIC S9(4)   VALUE +2603.
  6696     12  ER-2604                     PIC S9(4)   VALUE +2604.
  6697     12  ER-2605                     PIC S9(4)   VALUE +2605.
  6698     12  ER-2606                     PIC S9(4)   VALUE +2606.
  6699     12  ER-2607                     PIC S9(4)   VALUE +2607.
  6700     12  ER-2608                     PIC S9(4)   VALUE +2608.
  6701     12  ER-2609                     PIC S9(4)   VALUE +2609.
  6702     12  ER-2610                     PIC S9(4)   VALUE +2610.
  6703     12  ER-2611                     PIC S9(4)   VALUE +2611.
  6704     12  ER-2612                     PIC S9(4)   VALUE +2612.
  6705     12  ER-2613                     PIC S9(4)   VALUE +2613.
  6706     12  ER-2614                     PIC S9(4)   VALUE +2614.
  6707     12  ER-2615                     PIC S9(4)   VALUE +2615.
  6708     12  ER-2616                     PIC S9(4)   VALUE +2616.
  6709     12  ER-2617                     PIC S9(4)   VALUE +2617.
  6710     12  ER-2618                     PIC S9(4)   VALUE +2618.
  6711     12  ER-2619                     PIC S9(4)   VALUE +2619.
  6712     12  ER-2620                     PIC S9(4)   VALUE +2620.
  6713     12  ER-2621                     PIC S9(4)   VALUE +2621.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 122
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6714     12  ER-2622                     PIC S9(4)   VALUE +2622.
  6715     12  ER-2623                     PIC S9(4)   VALUE +2623.
  6716     12  ER-2624                     PIC S9(4)   VALUE +2624.
  6717     12  ER-2625                     PIC S9(4)   VALUE +2625.
  6718     12  ER-2626                     PIC S9(4)   VALUE +2626.
  6719     12  ER-2627                     PIC S9(4)   VALUE +2627.
  6720     12  ER-2628                     PIC S9(4)   VALUE +2628.
  6721     12  ER-2629                     PIC S9(4)   VALUE +2629.
  6722     12  ER-2630                     PIC S9(4)   VALUE +2630.
  6723     12  ER-2631                     PIC S9(4)   VALUE +2631.
  6724     12  ER-2632                     PIC S9(4)   VALUE +2632.
  6725     12  ER-2633                     PIC S9(4)   VALUE +2633.
  6726     12  ER-2634                     PIC S9(4)   VALUE +2634.
  6727     12  ER-2635                     PIC S9(4)   VALUE +2635.
  6728     12  ER-2636                     PIC S9(4)   VALUE +2636.
  6729     12  ER-2637                     PIC S9(4)   VALUE +2637.
  6730     12  ER-2638                     PIC S9(4)   VALUE +2638.
  6731     12  ER-2639                     PIC S9(4)   VALUE +2639.
  6732     12  ER-2640                     PIC S9(4)   VALUE +2640.
  6733     12  ER-2641                     PIC S9(4)   VALUE +2641.
  6734     12  ER-2642                     PIC S9(4)   VALUE +2642.
  6735     12  ER-2643                     PIC S9(4)   VALUE +2643.
  6736     12  ER-2644                     PIC S9(4)   VALUE +2644.
  6737     12  ER-2645                     PIC S9(4)   VALUE +2645.
  6738     12  ER-2646                     PIC S9(4)   VALUE +2646.
  6739     12  ER-2647                     PIC S9(4)   VALUE +2647.
  6740     12  ER-2648                     PIC S9(4)   VALUE +2648.
  6741     12  ER-2649                     PIC S9(4)   VALUE +2649.
  6742     12  ER-2650                     PIC S9(4)   VALUE +2650.
  6743     12  ER-2651                     PIC S9(4)   VALUE +2651.
  6744     12  ER-2652                     PIC S9(4)   VALUE +2652.
  6745     12  ER-2653                     PIC S9(4)   VALUE +2653.
  6746     12  ER-2654                     PIC S9(4)   VALUE +2654.
  6747     12  ER-2655                     PIC S9(4)   VALUE +2655.
  6748     12  ER-2656                     PIC S9(4)   VALUE +2656.
  6749     12  ER-2657                     PIC S9(4)   VALUE +2657.
  6750     12  ER-2658                     PIC S9(4)   VALUE +2658.
  6751     12  ER-2659                     PIC S9(4)   VALUE +2659.
  6752     12  ER-2660                     PIC S9(4)   VALUE +2660.
  6753     12  ER-2661                     PIC S9(4)   VALUE +2661.
  6754     12  ER-2662                     PIC S9(4)   VALUE +2662.
  6755     12  ER-2663                     PIC S9(4)   VALUE +2663.
  6756     12  ER-2664                     PIC S9(4)   VALUE +2664.
  6757     12  ER-2665                     PIC S9(4)   VALUE +2665.
  6758     12  ER-2666                     PIC S9(4)   VALUE +2666.
  6759     12  ER-2667                     PIC S9(4)   VALUE +2667.
  6760     12  ER-2668                     PIC S9(4)   VALUE +2668.
  6761     12  ER-2669                     PIC S9(4)   VALUE +2669.
  6762     12  ER-2670                     PIC S9(4)   VALUE +2670.
  6763     12  ER-2671                     PIC S9(4)   VALUE +2671.
  6764     12  ER-2672                     PIC S9(4)   VALUE +2672.
  6765     12  ER-2673                     PIC S9(4)   VALUE +2673.
  6766     12  ER-2674                     PIC S9(4)   VALUE +2674.
  6767     12  ER-2675                     PIC S9(4)   VALUE +2675.
  6768     12  ER-2676                     PIC S9(4)   VALUE +2676.
  6769     12  ER-2677                     PIC S9(4)   VALUE +2677.
  6770     12  ER-2678                     PIC S9(4)   VALUE +2678.
  6771     12  ER-2679                     PIC S9(4)   VALUE +2679.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 123
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6772     12  ER-2680                     PIC S9(4)   VALUE +2680.
  6773     12  ER-2681                     PIC S9(4)   VALUE +2681.
  6774     12  ER-2682                     PIC S9(4)   VALUE +2682.
  6775     12  ER-2683                     PIC S9(4)   VALUE +2683.
  6776     12  ER-2684                     PIC S9(4)   VALUE +2684.
  6777     12  ER-2685                     PIC S9(4)   VALUE +2685.
  6778     12  ER-2686                     PIC S9(4)   VALUE +2686.
  6779     12  ER-2687                     PIC S9(4)   VALUE +2687.
  6780     12  ER-2688                     PIC S9(4)   VALUE +2688.
  6781     12  ER-2689                     PIC S9(4)   VALUE +2689.
  6782     12  ER-2690                     PIC S9(4)   VALUE +2690.
  6783     12  ER-2691                     PIC S9(4)   VALUE +2691.
  6784     12  ER-2692                     PIC S9(4)   VALUE +2692.
  6785     12  ER-2693                     PIC S9(4)   VALUE +2693.
  6786     12  ER-2694                     PIC S9(4)   VALUE +2694.
  6787     12  ER-2695                     PIC S9(4)   VALUE +2695.
  6788     12  ER-2696                     PIC S9(4)   VALUE +2696.
  6789     12  ER-2697                     PIC S9(4)   VALUE +2697.
  6790     12  ER-2698                     PIC S9(4)   VALUE +2698.
  6791     12  ER-2699                     PIC S9(4)   VALUE +2699.
  6792     12  ER-2700                     PIC S9(4)   VALUE +2700.
  6793     12  ER-2701                     PIC S9(4)   VALUE +2701.
  6794     12  ER-2702                     PIC S9(4)   VALUE +2702.
  6795     12  ER-2703                     PIC S9(4)   VALUE +2703.
  6796     12  ER-2704                     PIC S9(4)   VALUE +2704.
  6797     12  ER-2707                     PIC S9(4)   VALUE +2707.
  6798     12  ER-2720                     PIC S9(4)   VALUE +2720.
  6799     12  ER-2709                     PIC S9(4)   VALUE +2709.
  6800     12  ER-2717                     PIC S9(4)   VALUE +2717.
  6801     12  ER-2718                     PIC S9(4)   VALUE +2718.
  6802     12  ER-2719                     PIC S9(4)   VALUE +2719.
  6803     12  ER-2721                     PIC S9(4)   VALUE +2721.
  6804     12  ER-2722                     PIC S9(4)   VALUE +2722.
  6805     12  ER-2723                     PIC S9(4)   VALUE +2723.
  6806     12  ER-2724                     PIC S9(4)   VALUE +2724.
  6807     12  ER-2725                     PIC S9(4)   VALUE +2725.
  6808     12  ER-2726                     PIC S9(4)   VALUE +2726.
  6809     12  ER-2727                     PIC S9(4)   VALUE +2727.
  6810     12  ER-2728                     PIC S9(4)   VALUE +2728.
  6811     12  ER-2729                     PIC S9(4)   VALUE +2729.
  6812     12  ER-2730                     PIC S9(4)   VALUE +2730.
  6813     12  ER-2731                     PIC S9(4)   VALUE +2731.
  6814     12  ER-2732                     PIC S9(4)   VALUE +2732.
  6815     12  ER-2733                     PIC S9(4)   VALUE +2733.
  6816     12  ER-2734                     PIC S9(4)   VALUE +2734.
  6817     12  ER-2735                     PIC S9(4)   VALUE +2735.
  6818     12  ER-2736                     PIC S9(4)   VALUE +2736.
  6819     12  ER-2737                     PIC S9(4)   VALUE +2737.
  6820     12  ER-2738                     PIC S9(4)   VALUE +2738.
  6821     12  ER-2739                     PIC S9(4)   VALUE +2739.
  6822     12  ER-2740                     PIC S9(4)   VALUE +2740.
  6823     12  ER-2741                     PIC S9(4)   VALUE +2741.
  6824     12  ER-2742                     PIC S9(4)   VALUE +2742.
  6825     12  ER-2743                     PIC S9(4)   VALUE +2743.
  6826     12  ER-2744                     PIC S9(4)   VALUE +2744.
  6827     12  ER-2745                     PIC S9(4)   VALUE +2745.
  6828     12  ER-2746                     PIC S9(4)   VALUE +2746.
  6829     12  ER-2747                     PIC S9(4)   VALUE +2747.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 124
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6830     12  ER-2748                     PIC S9(4)   VALUE +2748.
  6831     12  ER-2749                     PIC S9(4)   VALUE +2749.
  6832     12  ER-2750                     PIC S9(4)   VALUE +2750.
  6833     12  ER-2751                     PIC S9(4)   VALUE +2751.
  6834     12  ER-2752                     PIC S9(4)   VALUE +2752.
  6835     12  ER-2753                     PIC S9(4)   VALUE +2753.
  6836     12  ER-2754                     PIC S9(4)   VALUE +2754.
  6837     12  ER-2755                     PIC S9(4)   VALUE +2755.
  6838     12  ER-2756                     PIC S9(4)   VALUE +2756.
  6839     12  ER-2757                     PIC S9(4)   VALUE +2757.
  6840     12  ER-2758                     PIC S9(4)   VALUE +2758.
  6841     12  ER-2759                     PIC S9(4)   VALUE +2759.
  6842     12  ER-2760                     PIC S9(4)   VALUE +2760.
  6843     12  ER-2761                     PIC S9(4)   VALUE +2761.
  6844     12  ER-2762                     PIC S9(4)   VALUE +2762.
  6845     12  ER-2763                     PIC S9(4)   VALUE +2763.
  6846     12  ER-2764                     PIC S9(4)   VALUE +2764.
  6847     12  ER-2765                     PIC S9(4)   VALUE +2765.
  6848     12  ER-2766                     PIC S9(4)   VALUE +2766.
  6849     12  ER-2767                     PIC S9(4)   VALUE +2767.
  6850     12  ER-2768                     PIC S9(4)   VALUE +2768.
  6851     12  ER-2769                     PIC S9(4)   VALUE +2769.
  6852     12  ER-2770                     PIC S9(4)   VALUE +2770.
  6853     12  ER-2771                     PIC S9(4)   VALUE +2771.
  6854     12  ER-2772                     PIC S9(4)   VALUE +2772.
  6855     12  ER-2773                     PIC S9(4)   VALUE +2773.
  6856     12  ER-2774                     PIC S9(4)   VALUE +2774.
  6857     12  ER-2775                     PIC S9(4)   VALUE +2775.
  6858     12  ER-2776                     PIC S9(4)   VALUE +2776.
  6859     12  ER-2777                     PIC S9(4)   VALUE +2777.
  6860     12  ER-2778                     PIC S9(4)   VALUE +2778.
  6861     12  ER-2779                     PIC S9(4)   VALUE +2779.
  6862     12  ER-2780                     PIC S9(4)   VALUE +2780.
  6863     12  ER-2781                     PIC S9(4)   VALUE +2781.
  6864     12  ER-2782                     PIC S9(4)   VALUE +2782.
  6865     12  ER-2783                     PIC S9(4)   VALUE +2783.
  6866     12  ER-2786                     PIC S9(4)   VALUE +2786.
  6867     12  ER-2787                     PIC S9(4)   VALUE +2787.
  6868     12  ER-2788                     PIC S9(4)   VALUE +2788.
  6869     12  ER-2789                     PIC S9(4)   VALUE +2789.
  6870     12  ER-2792                     PIC S9(4)   VALUE +2792.
  6871     12  ER-2793                     PIC S9(4)   VALUE +2793.
  6872     12  ER-2794                     PIC S9(4)   VALUE +2794.
  6873     12  ER-2795                     PIC S9(4)   VALUE +2795.
  6874     12  ER-2796                     PIC S9(4)   VALUE +2796.
  6875     12  ER-2798                     PIC S9(4)   VALUE +2798.
  6876     12  ER-2799                     PIC S9(4)   VALUE +2799.
  6877     12  ER-2869                     PIC S9(4)   VALUE +2869.
  6878     12  ER-2879                     PIC S9(4)   VALUE +2879.
  6879     12  ER-2881                     PIC S9(4)   VALUE +2881.
  6880     12  ER-2883                     PIC S9(4)   VALUE +2883.
  6881     12  ER-2882                     PIC S9(4)   VALUE +2882.
  6882     12  ER-2884                     PIC S9(4)   VALUE +2884.
  6883     12  ER-2885                     PIC S9(4)   VALUE +2885.
  6884     12  ER-2886                     PIC S9(4)   VALUE +2886.
  6885     12  ER-2887                     PIC S9(4)   VALUE +2887.
  6886     12  ER-2888                     PIC S9(4)   VALUE +2888.
  6887     12  ER-2889                     PIC S9(4)   VALUE +2889.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 125
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6888     12  ER-2890                     PIC S9(4)   VALUE +2890.
  6889     12  ER-2891                     PIC S9(4)   VALUE +2891.
  6890     12  ER-2892                     PIC S9(4)   VALUE +2892.
  6891     12  ER-2963                     PIC S9(4)   VALUE +2963.
  6892     12  ER-2964                     PIC S9(4)   VALUE +2964.
  6893     12  ER-2965                     PIC S9(4)   VALUE +2965.
  6894     12  ER-2969                     PIC S9(4)   VALUE +2969.
  6895     12  ER-3006                     PIC S9(4)   VALUE +3006.
  6896     12  ER-3049                     PIC S9(4)   VALUE +3049.
  6897     12  ER-3050                     PIC S9(4)   VALUE +3050.
  6898     12  ER-3052                     PIC S9(4)   VALUE +3052.
  6899     12  ER-3054                     PIC S9(4)   VALUE +3054.
  6900     12  ER-3057                     PIC S9(4)   VALUE +3057.
  6901     12  ER-3058                     PIC S9(4)   VALUE +3058.
  6902     12  ER-3780                     PIC S9(4)   VALUE +3780.
  6903     12  ER-3781                     PIC S9(4)   VALUE +3781.
  6904     12  ER-3782                     PIC S9(4)   VALUE +3782.
  6905     12  ER-3789                     PIC S9(4)   VALUE +3789.
  6906     12  ER-3790                     PIC S9(4)   VALUE +3790.
  6907     12  ER-3825                     PIC S9(4)   VALUE +3825.
  6908     12  ER-3826                     PIC S9(4)   VALUE +3826.
  6909     12  ER-3843                     PIC S9(4)   VALUE +3843.
  6910     12  ER-7812                     PIC S9(4)   VALUE +7812.
  6911     12  ER-7813                     PIC S9(4)   VALUE +7813.
  6912     12  ER-7814                     PIC S9(4)   VALUE +7814.
  6913     12  ER-7815                     PIC S9(4)   VALUE +7815.
  6914     12  ER-7816                     PIC S9(4)   VALUE +7816.
  6915     12  ER-7817                     PIC S9(4)   VALUE +7817.
  6916     12  ER-7818                     PIC S9(4)   VALUE +7818.
  6917     12  ER-7819                     PIC S9(4)   VALUE +7819.
  6918     12  ER-7820                     PIC S9(4)   VALUE +7820.
  6919     12  ER-7823                     PIC S9(4)   VALUE +7823.
  6920     12  ER-7825                     PIC S9(4)   VALUE +7825.
  6921     12  ER-8002                     PIC S9(4)   VALUE +8002.
  6922     12  ER-8030                     PIC S9(4)   VALUE +8030.
  6923     12  ER-8036                     PIC S9(4)   VALUE +8036.
  6924     12  ER-8037                     PIC S9(4)   VALUE +8037.
  6925     12  ER-8038                     PIC S9(4)   VALUE +8038.
  6926     12  ER-8039                     PIC S9(4)   VALUE +8039.
  6927     12  ER-8040                     PIC S9(4)   VALUE +8040.
  6928     12  ER-8041                     PIC S9(4)   VALUE +8041.
  6929     12  ER-8042                     PIC S9(4)   VALUE +8042.
  6930     12  ER-8043                     PIC S9(4)   VALUE +8043.
  6931     12  ER-8044                     PIC S9(4)   VALUE +8044.
  6932     12  ER-8045                     PIC S9(4)   VALUE +8045.
  6933     12  ER-8046                     PIC S9(4)   VALUE +8046.
  6934     12  ER-8050                     PIC S9(4)   VALUE +8050.
  6935     12  ER-8067                     PIC S9(4)   VALUE +8067.
  6936     12  ER-8068                     PIC S9(4)   VALUE +8068.
  6937     12  ER-8069                     PIC S9(4)   VALUE +8069.
  6938     12  ER-8070                     PIC S9(4)   VALUE +8070.
  6939     12  ER-8071                     PIC S9(4)   VALUE +8071.
  6940     12  ER-8072                     PIC S9(4)   VALUE +8072.
  6941     12  ER-8074                     PIC S9(4)   VALUE +8074.
  6942     12  ER-8075                     PIC S9(4)   VALUE +8075.
  6943     12  ER-8076                     PIC S9(4)   VALUE +8076.
  6944     12  ER-8077                     PIC S9(4)   VALUE +8077.
  6945     12  ER-8078                     PIC S9(4)   VALUE +8078.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 126
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6946     12  ER-8079                     PIC S9(4)   VALUE +8079.
  6947     12  ER-8080                     PIC S9(4)   VALUE +8080.
  6948     12  ER-8081                     PIC S9(4)   VALUE +8081.
  6949     12  ER-8082                     PIC S9(4)   VALUE +8082.
  6950     12  ER-8083                     PIC S9(4)   VALUE +8083.
  6951     12  ER-8084                     PIC S9(4)   VALUE +8084.
  6952     12  ER-8085                     PIC S9(4)   VALUE +8085.
  6953     12  ER-8086                     PIC S9(4)   VALUE +8086.
  6954     12  ER-8087                     PIC S9(4)   VALUE +8087.
  6955     12  ER-8088                     PIC S9(4)   VALUE +8088.
  6956     12  ER-8089                     PIC S9(4)   VALUE +8089.
  6957     12  ER-8090                     PIC S9(4)   VALUE +8090.
  6958     12  ER-8091                     PIC S9(4)   VALUE +8091.
  6959     12  ER-8092                     PIC S9(4)   VALUE +8092.
  6960     12  ER-8093                     PIC S9(4)   VALUE +8093.
  6961     12  ER-8094                     PIC S9(4)   VALUE +8094.
  6962     12  ER-8095                     PIC S9(4)   VALUE +8095.
  6963     12  ER-8096                     PIC S9(4)   VALUE +8096.
  6964     12  ER-8097                     PIC S9(4)   VALUE +8097.
  6965     12  ER-8098                     PIC S9(4)   VALUE +8098.
  6966     12  ER-8099                     PIC S9(4)   VALUE +8099.
  6967     12  ER-8109                     PIC S9(4)   VALUE +8109.
  6968     12  ER-8110                     PIC S9(4)   VALUE +8110.
  6969     12  ER-8111                     PIC S9(4)   VALUE +8111.
  6970     12  ER-8112                     PIC S9(4)   VALUE +8112.
  6971     12  ER-8113                     PIC S9(4)   VALUE +8113.
  6972     12  ER-8114                     PIC S9(4)   VALUE +8114.
  6973     12  ER-8116                     PIC S9(4)   VALUE +8116.
  6974     12  ER-8148                     PIC S9(4)   VALUE +8148.
  6975     12  ER-8152                     PIC S9(4)   VALUE +8152.
  6976     12  ER-8300                     PIC S9(4)   VALUE +8300.
  6977     12  ER-8301                     PIC S9(4)   VALUE +8301.
  6978     12  ER-8302                     PIC S9(4)   VALUE +8302.
  6979     12  ER-8303                     PIC S9(4)   VALUE +8303.
  6980     12  ER-8304                     PIC S9(4)   VALUE +8304.
  6981     12  ER-8310                     PIC S9(4)   VALUE +8310.
  6982     12  ER-8311                     PIC S9(4)   VALUE +8311.
  6983     12  ER-8312                     PIC S9(4)   VALUE +8312.
  6984     12  ER-8313                     PIC S9(4)   VALUE +8313.
  6985     12  ER-8314                     PIC S9(4)   VALUE +8314.
  6986     12  ER-8315                     PIC S9(4)   VALUE +8315.
  6987     12  ER-8316                     PIC S9(4)   VALUE +8316.
  6988     12  ER-8317                     PIC S9(4)   VALUE +8317.
  6989     12  ER-9236                     PIC S9(4)   VALUE +9236.
  6990     12  ER-9501                     PIC S9(4)   VALUE +9501.
  6991     12  ER-9503                     PIC S9(4)   VALUE +9503.
  6992     12  ER-9263                     PIC S9(4)   VALUE +9263.
  6993     12  ER-9999                     PIC S9(4)   VALUE +9999.
  6994******************************************************************
  6995***************   END OF ELC50WS     ****************************
  6996******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 127
* EL517.cbl
  6998 01  HOLD-WORK     PIC X(2000)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 128
* EL517.cbl
  7000*DLB001
  7001 01  WS-DLB-MASTER-POLICY-FORM.
  7002     12  DMPF-PROCESS-TYPE         PIC X.
  7003         88  DMPF-OPEN-FILES                   VALUE 'O'.
  7004         88  DMPF-REG-PROCESS                  VALUE 'P'.
  7005         88  DMPF-CLOSE-FILES                  VALUE 'C'.
  7006     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  7007     12  DMPF-RETURN-CODE          PIC XX.
  7008         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  7009         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  7010         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  7011         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  7012         88  DMPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7013         88  DMPF-OPEN-ERROR                   VALUE 'Z2'.
  7014         88  DMPF-CLOSE-ERROR                  VALUE 'Z3'.
  7015
  7016*DLB002
  7017 01  WS-DLB-INTERNAL-POLICY-FORM.
  7018     12  DIPF-PROCESS-TYPE         PIC X.
  7019         88  DIPF-OPEN-FILES                   VALUE 'O'.
  7020         88  DIPF-REG-PROCESS                  VALUE 'P'.
  7021         88  DIPF-CLOSE-FILES                  VALUE 'C'.
  7022     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  7023     12  DIPF-RETURN-CODE          PIC XX.
  7024         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  7025         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  7026         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  7027         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  7028         88  DIPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7029         88  DIPF-OPEN-ERROR                   VALUE 'Z2'.
  7030         88  DIPF-CLOSE-ERROR                  VALUE 'Z3'.
  7031
  7032*DLB003
  7033 01  WS-DLB-VALID-BANK-ID.
  7034     12  DVBI-PROCESS-TYPE         PIC X.
  7035         88  DVBI-OPEN-FILES                   VALUE 'O'.
  7036         88  DVBI-REG-PROCESS                  VALUE 'P'.
  7037         88  DVBI-CLOSE-FILES                  VALUE 'C'.
  7038     12  DVBI-BANK-ID              PIC X(5).
  7039     12  DVBI-BANK-ID-TYPE         PIC X.
  7040         88  DVBI-BILLING-BANK                 VALUE 'B'.
  7041         88  DVBI-PLAN-BANK                    VALUE 'P'.
  7042         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  7043         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  7044         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  7045     12  DVBI-RETURN-CODE          PIC XX.
  7046         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  7047         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  7048         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  7049         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  7050         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  7051         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  7052         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  7053         88  DVBI-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7054         88  DVBI-OPEN-ERROR                   VALUE 'Z2'.
  7055         88  DVBI-CLOSE-ERROR                  VALUE 'Z3'.
  7056
  7057*DLB007
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 129
* EL517.cbl
  7058 01  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  7059     12  DCUA-PROCESS-TYPE         PIC X.
  7060         88  DCUA-OPEN-FILES                   VALUE 'O'.
  7061         88  DCUA-REG-PROCESS                  VALUE 'P'.
  7062         88  DCUA-CLOSE-FILES                  VALUE 'C'.
  7063     12  DCUA-RES-STATE            PIC XX.
  7064     12  DCUA-BEN-TYPE             PIC XX.
  7065     12  DCUA-SYS-IDENT            PIC X.
  7066         88  DCUA-CLAIM                        VALUE 'C'.
  7067         88  DCUA-PREMIUM                      VALUE 'P'.
  7068     12  DCUA-COVERAGE-RULE        PIC X.
  7069     12  DCUA-CLIENT-ID            PIC X(10).
  7070     12  DCUA-EFF-DATE             PIC X(8).
  7071     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  7072     12  DCUA-RETURN-CODE          PIC XX.
  7073         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7074         88  DCUA-OPEN-ERROR                   VALUE 'Z2'.
  7075         88  DCUA-CLOSE-ERROR                  VALUE 'Z3'.
  7076     12  DCUA-CERT-NUMBER          PIC X(11).
  7077     12  DCUA-UNDRWRTR-CODE        PIC XX.
  7078     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  7079
  7080*DLB011
  7081 01  WS-DLB-PREM-RATES-BEN-TYPE.
  7082     12  DPRB-PROCESS-TYPE         PIC X.
  7083         88  DPRB-OPEN-FILES                   VALUE 'O'.
  7084         88  DPRB-REG-PROCESS                  VALUE 'P'.
  7085         88  DPRB-CLOSE-FILES                  VALUE 'C'.
  7086     12  DPRB-RATE-CODE            PIC X(4).
  7087     12  DPRB-COVERAGE-CATEG       PIC X.
  7088     12  DPRB-RETURN-CODE          PIC XX.
  7089         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7090         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  7091         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  7092         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  7093         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  7094         88  DPRB-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7095         88  DPRB-OPEN-ERROR                   VALUE 'Z2'.
  7096         88  DPRB-CLOSE-ERROR                  VALUE 'Z3'.
  7097     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  7098     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  7099     12  DPRB-BEN-TYPE             PIC XX.
  7100
  7101*DLB017
  7102 01  WS-DLB-VALID-RATE-CODE.
  7103     12  DVRC-PROCESS-TYPE         PIC X.
  7104         88  DVRC-OPEN-FILES                   VALUE 'O'.
  7105         88  DVRC-REG-PROCESS                  VALUE 'P'.
  7106         88  DVRC-CLOSE-FILES                  VALUE 'C'.
  7107     12  DVRC-RATE-CODE            PIC X(4).
  7108     12  DVRC-RETURN-CODE          PIC XX.
  7109         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7110         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  7111         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  7112         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  7113         88  DVRC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7114         88  DVRC-OPEN-ERROR                   VALUE 'Z2'.
  7115         88  DVRC-CLOSE-ERROR                  VALUE 'Z3'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 130
* EL517.cbl
  7116
  7117*DLB019
  7118 01  WS-DLB-ORIG-COV-CAT.
  7119     12  DOCC-PROCESS-TYPE         PIC X.
  7120         88  DOCC-OPEN-FILES                   VALUE 'O'.
  7121         88  DOCC-REG-PROCESS                  VALUE 'P'.
  7122         88  DOCC-CLOSE-FILES                  VALUE 'C'.
  7123     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  7124     12  DOCC-RETURN-CODE          PIC XX.
  7125     12  DOCC-ORIG-COV-CAT         PIC X.
  7126     12  DOCC-UNDERWRITER          PIC XX.
  7127     12  DOCC-UNDW-GROUP-CODE      PIC X.
  7128     12  DOCC-CREDIT-IND           PIC X.
  7129     12  DOCC-PRODUCT-CD           PIC XX.
  7130     12  DOCC-TERM                 PIC XXX.
  7131
  7132*DLB021
  7133 01  WS-DLB-VALID-LOAN-OFFICER.
  7134     12  DVLO-LOAN-OFFICER         PIC X(3).
  7135     12  THIS REDEFINES DVLO-LOAN-OFFICER.
  7136         16  DVLO-BILL-TYPE        PIC X.
  7137         16  DVLO-BILL-SOURCE      PIC X.
  7138         16  DVLO-BATCH-TYPE       PIC X.
  7139     12  DVLO-RETURN-CODE          PIC XX.
  7140         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  7141         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  7142         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  7143         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  7144         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  7145         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  7146
  7147*DLB022
  7148 01  WS-DLB-VALID-STATE-CODE.
  7149     12  DVSC-PROCESS-TYPE         PIC X.
  7150         88  DVSC-OPEN-FILES                   VALUE 'O'.
  7151         88  DVSC-REG-PROCESS                  VALUE 'P'.
  7152         88  DVSC-CLOSE-FILES                  VALUE 'C'.
  7153     12  DVSC-STATE-CODE           PIC XX.
  7154     12  DVSC-RETURN-CODE          PIC XX.
  7155         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7156         88  DVSC-NO-STATE-INPUT               VALUE '01'.
  7157         88  DVSC-STATE-NOT-FOUND              VALUE '02'.
  7158         88  DVSC-STATE-INACTIVE               VALUE '03'.
  7159         88  DVSC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7160         88  DVSC-OPEN-ERROR                   VALUE 'Z2'.
  7161         88  DVSC-CLOSE-ERROR                  VALUE 'Z3'.
  7162
  7163*DLB023
  7164 01  WS-DLB-VALID-CODE-VALUES.
  7165     12  DVCV-PROCESS-TYPE         PIC X.
  7166         88  DVCV-OPEN-FILES                   VALUE 'O'.
  7167         88  DVCV-REG-PROCESS                  VALUE 'P'.
  7168         88  DVCV-CLOSE-FILES                  VALUE 'C'.
  7169     12  DVCV-SYSTEM-ID            PIC XX.
  7170         88  DVCV-CLAIMS                       VALUE 'CL'.
  7171         88  DVCV-CREDIT                       VALUE 'CR'.
  7172     12  DVCV-RECORD-TYPE          PIC XX.
  7173         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 131
* EL517.cbl
  7174         88  DVCV-EOB-CODE                     VALUE 'EO'.
  7175         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  7176         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  7177         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  7178         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  7179         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  7180         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  7181     12  DVCV-RECORD-KEY           PIC X(6).
  7182     12  DVCV-RETURN-CODE          PIC XX.
  7183         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  7184         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  7185         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  7186         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  7187         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  7188         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  7189         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  7190         88  DVCV-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7191         88  DVCV-OPEN-ERROR                   VALUE 'Z2'.
  7192         88  DVCV-CLOSE-ERROR                  VALUE 'Z3'.
  7193     12  DVCV-CODE-DESC            PIC X(60).
  7194     12  DVCV-GEN-DESC-1           PIC X(20).
  7195     12  DVCV-GEN-DESC-2           PIC X(20).
  7196     12  DVCV-GEN-DESC-3           PIC X(20).
  7197
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 132
* EL517.cbl
  7199
  7200 01  PARMLIST.
  7201     02  ELCNTL-POINTER            PIC S9(4)  COMP VALUE +0.
  7202     02  ERACCT-POINTER            PIC S9(4)  COMP VALUE +0.
  7203     02  ERCTBL-POINTER            PIC S9(4)  COMP VALUE +0.
  7204**9/17/98: COMMENT OUT ERPLAN-POINTER.  NO LONGER USED BY LOGIC.
  7205**
  7206**   02  ERPLAN-POINTER            PIC S9(4)  COMP VALUE +0.
  7207     02  ERFORM-POINTER            PIC S9(4)  COMP VALUE +0.
  7208
  7209 01  PLAN-RECORDS.
  7210     12  LINK-LIFE-PLAN-RECORD    PIC X(420) VALUE SPACES.
  7211     12  LINK-AH-PLAN-RECORD      PIC X(420) VALUE SPACES.
  7212
* 7213                                  COPY ELCDATE.
  7214******************************************************************06/11/98
  7215*                                                                *ELCDATE
  7216*                                                                *ELCDATE
  7217*                            ELCDATE.                            *   LV023
  7218*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  7219*                            VMOD=2.003                           ELCDATE
  7220*                                                                *ELCDATE
  7221*                                                                *ELCDATE
  7222*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  7223*                 LENGTH = 200                                   *   CL*19
  7224******************************************************************ELCDATE
  7225                                                                  ELCDATE
  7226 01  DATE-CONVERSION-DATA.                                        ELCDATE
  7227     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  7228     12  DC-OPTION-CODE                PIC X.                        CL*15
  7229         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  7230         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  7231         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  7232         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  7233         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  7234         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  7235         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  7236         88  FIND-CENTURY               VALUE '7'.                   CL*22
  7237         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  7238         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  7239         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  7240         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  7241         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  7242         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  7243         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  7244         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  7245         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  7246         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  7247         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  7248         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  7249         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  7250         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  7251         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  7252         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  7253         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  7254         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  7255         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  7256         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 133
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7257         88  THREE-CHARACTER-BIN                                  ELCDATE
  7258                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  7259         88  GREGORIAN-TO-BIN                                        CL**2
  7260                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  7261         88  BIN-TO-GREGORIAN                                        CL**2
  7262                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  7263         88  JULIAN-TO-BINARY                                        CL**2
  7264                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  7265     12  DC-ERROR-CODE                 PIC X.                        CL*15
  7266         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  7267         88  DATE-CONVERSION-ERROR                                ELCDATE
  7268                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  7269         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  7270         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  7271         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  7272         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  7273         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  7274         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  7275         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  7276         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  7277         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  7278         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  7279     12  DC-END-OF-MONTH               PIC X.                        CL*15
  7280         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  7281     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  7282         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  7283         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  7284         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  7285     12  FILLER                        PIC X.                        CL*15
  7286     12  DC-CONVERSION-DATES.                                        CL*15
  7287         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  7288         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  7289         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  7290         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  7291                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  7292             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  7293             20  SLASH1-1              PIC X.                        CL*15
  7294             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  7295             20  SLASH1-2              PIC X.                        CL*15
  7296             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  7297         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  7298         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  7299                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  7300             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  7301             20  SLASH2-1              PIC X.                        CL*15
  7302             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  7303             20  SLASH2-2              PIC X.                        CL*15
  7304             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  7305         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  7306         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  7307                     DC-GREG-DATE-1-YMD.                          ELCDATE
  7308             20  DC-YMD-YEAR           PIC 99.                       CL*15
  7309             20  DC-YMD-MONTH          PIC 99.                       CL*15
  7310             20  DC-YMD-DAY            PIC 99.                       CL*15
  7311         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  7312         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  7313                      DC-GREG-DATE-1-MDY.                         ELCDATE
  7314             20  DC-MDY-MONTH          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 134
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7315             20  DC-MDY-DAY            PIC 99.                       CL*15
  7316             20  DC-MDY-YEAR           PIC 99.                       CL*15
  7317         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  7318             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  7319             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  7320             20  FILLER                PIC XX.                       CL*15
  7321             20  DC-ALPHA-CENTURY.                                   CL*15
  7322                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  7323             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  7324         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  7325         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  7326         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  7327         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  7328         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  7329                                       PIC 9(05).                    CL*20
  7330         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  7331             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  7332             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  7333         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  7334         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  7335         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  7336     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  7337         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  7338         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  7339             20  FILLER                PIC 9(3).                     CL*15
  7340             20  HOLD-CEN-1-CCYY.                                    CL*15
  7341                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  7342                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  7343             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  7344             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  7345         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  7346             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  7347             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  7348             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  7349                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  7350                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  7351             20  FILLER                PIC 9(3).                     CL*15
  7352         16  HOLD-CENTURY-1-X.                                       CL*15
  7353             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  7354             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  7355                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  7356                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  7357             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  7358             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  7359         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  7360             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  7361             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  7362             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  7363                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  7364                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  7365             20  FILLER                PIC XXX.                      CL*23
  7366         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  7367         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  7368         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  7369         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  7370             20  DC-JULIAN-1-CCYY.                                   CL*15
  7371                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  7372                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 135
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7373             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  7374         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  7375         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  7376             20  DC-JULIAN-2-CCYY.                                   CL*15
  7377                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  7378                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  7379             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  7380         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  7381             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  7382             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  7383             20  DC-EDITA-DAY          PIC 99.                       CL*15
  7384             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  7385             20  DC-EDITA-CCYY.                                      CL*15
  7386                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  7387                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  7388         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  7389             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  7390             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  7391             20  DC-EDITB-DAY          PIC 99.                       CL*15
  7392             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  7393             20  DC-EDITB-CCYY.                                      CL*15
  7394                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  7395                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  7396         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  7397         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  7398                              DC-GREG-DATE-CYMD.                  ELCDATE
  7399             20  DC-CYMD-CEN           PIC 99.                       CL*15
  7400             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  7401             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  7402             20  DC-CYMD-DAY           PIC 99.                       CL*15
  7403         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  7404         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  7405                              DC-GREG-DATE-MDCY.                  ELCDATE
  7406             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  7407             20  DC-MDCY-DAY           PIC 99.                       CL*15
  7408             20  DC-MDCY-CEN           PIC 99.                       CL*15
  7409             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  7410    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  7411        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  7412    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  7413    12  FILLER                         PIC X(28).                    CL*26
  7414
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 136
* EL517.cbl
* 7416                                  COPY ELCCALC.
  7417******************************************************************04/15/98
  7418*                                                                *ELCCALC
  7419*                           ELCCALC.                            *    LV003
  7420*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7421*                            VMOD=2.025                          *   CL**3
  7422*                                                                *   CL**2
  7423*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  7424*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  7425*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  7426*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  7427*                                                                *   CL**2
  7428*  PASSED TO ELRTRM                                              *   CL**2
  7429*  -----------------                                             *   CL**2
  7430*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  7431*  ORIGINAL TERM                                                 *   CL**2
  7432*  BEGINNING DATE                                                *   CL**2
  7433*  ENDING DATE                                                   *   CL**2
  7434*  COMPANY I.D.                                                  *   CL**2
  7435*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  7436*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  7437*  FREE LOOK DAYS                                                *   CL**2
  7438*                                                                *   CL**2
  7439*  RETURNED FROM ELRTRM                                          *   CL**2
  7440*  ---------------------                                         *   CL**2
  7441*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  7442*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  7443*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  7444*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  7445*----------------------------------------------------------------*   CL**2
  7446*  PASSED TO ELRAMT                                              *   CL**2
  7447*  ----------------                                              *   CL**2
  7448*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  7449*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7450*  ORIGINAL AMOUNT                                               *   CL**2
  7451*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  7452*  A.P.R. - NET PAY ONLY                                         *   CL**2
  7453*  METHOD                                                            CL**2
  7454*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  7455*  COMPANY I.D.                                                  *   CL**2
  7456*  BENEFIT TYPE                                                  *   CL**2
  7457*                                                                *   CL**2
  7458*  RETURNED FROM ELRAMT                                          *   CL**2
  7459*  --------------------                                          *   CL**2
  7460*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  7461*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  7462*  REMAINING AMOUNT FACTOR                                           CL**2
  7463*----------------------------------------------------------------*   CL**2
  7464*  PASSED TO ELRESV                                              *   CL**2
  7465*  -----------------                                             *   CL**2
  7466*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  7467*  VALUATION DATE                                                *   CL**2
  7468*  PAID THRU DATE                                                *   CL**2
  7469*  BENEFIT                                                       *   CL**2
  7470*  INCURRED DATE                                                 *   CL**2
  7471*  REPORTED DATE                                                 *   CL**2
  7472*  ISSUE AGE                                                     *   CL**2
  7473*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 137
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7474*  CDT PERCENT                                                   *   CL**2
  7475*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  7476* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  7477* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  7478* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  7479*                                                                *   CL**2
  7480*  RETURNED FROM ELRESV                                          *   CL**2
  7481*  --------------------                                          *   CL**2
  7482*  CDT TABLE USED                                                *   CL**2
  7483*  CDT FACTOR USED                                               *   CL**2
  7484*  PAY TO CURRENT RESERVE                                        *   CL**2
  7485*  I.B.N.R. - A/H ONLY                                           *   CL**2
  7486*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  7487*----------------------------------------------------------------*   CL**2
  7488*  PASSED TO ELRATE                                              *   CL**2
  7489*  ----------------                                              *   CL**2
  7490*  CERT ISSUE DATE                                               *   CL**2
  7491*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7492*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7493*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  7494*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7495*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7496*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7497*  DEVIATION CODE                                                *   CL**2
  7498*  ISSUE AGE                                                     *   CL**2
  7499*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7500*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7501*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  7502*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7503*  A.P.R.                                                        *   CL**2
  7504*  METHOD                                                            CL**2
  7505*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7506*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7507*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7508*  BENEFIT CODE                                                  *   CL**2
  7509*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7510*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  7511*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  7512*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  7513*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  7514*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  7515*                                                                *   CL**2
  7516*  RETURNED FROM ELRATE                                          *   CL**2
  7517*  --------------------                                          *   CL**2
  7518*  CALCULATED PREMIUM                                            *   CL**2
  7519*  PREMIUM RATE                                                  *   CL**2
  7520*  MORTALITY CODE                                                *   CL**2
  7521*  MAX ATTAINED AGE                                              *   CL**2
  7522*  MAX AGE                                                       *   CL**2
  7523*  MAX TERM                                                      *   CL**2
  7524*  MAX MONTHLY BENEFIT                                           *   CL**2
  7525*  MAX TOTAL BENIFIT                                             *   CL**2
  7526*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  7527*----------------------------------------------------------------*   CL**2
  7528*  PASSED TO ELRFND                                              *   CL**2
  7529*  ----------------                                              *   CL**2
  7530*  CERT ISSUE DATE                                               *   CL**2
  7531*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 138
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7532*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7533*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7534*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7535*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7536*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7537*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7538*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7539*  DEVIATION CODE                                                *   CL**2
  7540*  ISSUE AGE                                                     *   CL**2
  7541*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7542*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7543*  PROCESS TYPE (CANCEL)                                         *   CL**2
  7544*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7545*  A.P.R.                                                        *   CL**2
  7546*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  7547*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  7548*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7549*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7550*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7551*  BENEFIT CODE                                                  *   CL**2
  7552*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7553*                                                                *   CL**2
  7554*  RETURNED FROM ELRFND                                          *   CL**2
  7555*  --------------------                                          *   CL**2
  7556*  CALCULATED REFUND                                             *   CL**2
  7557*----------------------------------------------------------------*   CL**2
  7558*  PASSED TO ELEARN                                              *   CL**2
  7559*  ----------------                                              *   CL**2
  7560*  CERT ISSUE DATE                                               *   CL**2
  7561*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7562*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7563*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7564*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7565*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7566*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7567*  DEVIATION CODE                                                *   CL**2
  7568*  ISSUE AGE                                                     *   CL**2
  7569*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7570*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7571*  A.P.R.                                                        *   CL**2
  7572*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  7573*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7574*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7575*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7576*  BENEFIT CODE                                                  *   CL**2
  7577*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7578*                                                                *   CL**2
  7579*  RETURNED FROM ELEARN                                          *   CL**2
  7580*  --------------------                                          *   CL**2
  7581*  INDICATED  EARNINGS                                           *   CL**2
  7582*----------------------------------------------------------------*   CL**2
  7583*                 LENGTH = 450                                   *   CL**2
  7584*                                                                *   CL**2
  7585******************************************************************   CL**2
  7586******************************************************************
  7587*                   C H A N G E   L O G
  7588*
  7589* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 139
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7590*-----------------------------------------------------------------
  7591*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7592* EFFECTIVE    NUMBER
  7593*-----------------------------------------------------------------
  7594* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  7595* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7596* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  7597* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  7598* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  7599* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7600* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  7601* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  7602* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7603******************************************************************
  7604                                                                     CL**2
  7605 01  CALCULATION-PASS-AREA.                                          CL**2
  7606     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  7607                                     COMP.                           CL**2
  7608                                                                     CL**2
  7609     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  7610       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  7611       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  7612                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  7613       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  7614       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  7615       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  7616       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  7617       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  7618       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  7619       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  7620       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  7621       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  7622       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  7623       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  7624       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  7625       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  7626       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  7627       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  7628       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  7629       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  7630                                                                     CL**2
  7631     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  7632       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  7633***********************  INPUT AREAS ****************************    CL**2
  7634                                                                     CL**2
  7635     12  CP-CALCULATION-AREA.                                        CL**2
  7636         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  7637         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  7638         16  CP-VALUATION-DT       PIC XX.                           CL**2
  7639         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  7640         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  7641           88  CP-AH                               VALUE 'A' 'D'     CL**2
  7642                                                   'I' 'U'.          CL**2
  7643           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  7644           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  7645         16  CP-INCURRED-DT        PIC XX.                           CL**2
  7646         16  CP-REPORTED-DT        PIC XX.                           CL**2
  7647         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 140
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7648         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  7649         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  7650                                     COMP-3.                         CL**2
  7651         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  7652                                     COMP-3.                         CL**2
  7653         16  CP-CDT-METHOD         PIC X.                            CL**2
  7654           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  7655           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  7656           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  7657         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  7658           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  7659           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  7660         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  7661                                     COMP-3.                         CL**2
  7662         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  7663                                     COMP-3.                         CL**2
  7664         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  7665                                     COMP-3.                         CL**2
  7666         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  7667                                     COMP-3.                         CL**2
  7668         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7669                                     COMP-3.                         CL**2
  7670         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  7671                                     COMP-3.                         CL**2
  7672         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  7673                                     COMP-3.                         CL**2
  7674         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  7675           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  7676           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  7677           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  7678           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  7679           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  7680           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  7681           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  7682         16  CP-EARNING-METHOD     PIC X.                            CL**2
  7683           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  7684           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  7685           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7686           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7687           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7688           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7689           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  7690           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7691           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  7692           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7693           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  7694           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  7695           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  7696           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  7697         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  7698           88  CP-CLAIM                            VALUE '1'.        CL**2
  7699           88  CP-CANCEL                           VALUE '2'.        CL**2
  7700           88  CP-ISSUE                            VALUE '3'.        CL**2
  7701         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  7702           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  7703           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  7704           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  7705           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 141
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7706           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  7707           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  7708           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  7709           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  7710           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  7711           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  7712           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  7713           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  7714           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  7715           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  7716           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  7717           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  7718           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  7719           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  7720                                                     'W' 'X'.        CL**2
  7721           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  7722           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  7723           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  7724           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  7725           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  7726           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  7727           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  7728           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  7729           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  7730           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  7731           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  7732           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  7733           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  7734                                                                     CL**2
  7735         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  7736                                     COMP-3.                         CL**2
  7737         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  7738         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  7739         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  7740         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  7741         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  7742           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  7743               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  7744         16  CP-R78-OPTION         PIC X.                            CL**2
  7745           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  7746           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  7747                                                                     CL**2
  7748         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  7749         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  7750         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  7751         16  CP-RATE-FILE          PIC X.                            CL**2
  7752         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  7753                                     COMP-3.                         CL**2
  7754                                                                     CL**2
  7755         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  7756         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  7757                                                                     CL**2
  7758         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  7759                                     COMP-3.
  7760         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  7761                                   PIC S9(5)V99 COMP-3.
  7762         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  7763                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 142
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7764         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7765                                     COMP-3.                         CL**2
  7766         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  7767                                     COMP-3.
  7768         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  7769                                  PIC S9(7)V99 COMP-3.
  7770                                                                     CL**2
  7771         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  7772         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  7773         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  7774           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  7775           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  7776           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  7777           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  7778         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  7779         16  CP-CARRIER            PIC X.                            CL**2
  7780         16  CP-REIN-FLAG          PIC X.                            CL**2
  7781         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  7782           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  7783                      '2' '3' '4' '5'.                               CL**2
  7784           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  7785           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  7786           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  7787           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  7788           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  7789           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  7790           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  7791           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  7792         16  CP-SIG-SWITCH         PIC X.                            CL**2
  7793         16  CP-RATING-METHOD      PIC X.                            CL**2
  7794           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  7795           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  7796           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7797           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7798           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7799           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7800           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  7801           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7802           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7803         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  7804                                     COMP-3.                         CL**2
  7805         16  CP-BEN-CATEGORY       PIC X.
  7806         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7807         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  7808                                   PIC S99V9(5) COMP-3.
  7809         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7810         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  7811                                   PIC S99V9(5) COMP-3.
  7812         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  7813         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  7814         16  CP-EXPIRE-DT          PIC XX.
  7815         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  7816         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  7817         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  7818         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  7819         16  CP-DDF-SPEC-CALC      PIC X.
  7820             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  7821             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 143
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7822         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  7823         16  CP-CANCEL-REASON      PIC X.
  7824         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  7825         16  CP-PMT-MODE           PIC X.
  7826         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  7827         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  7828         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  7829         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  7830         16  FILLER                PIC X.
  7831                                                                     CL**2
  7832***************    OUTPUT FROM ELRESV   ************************     CL**2
  7833                                                                     CL**2
  7834         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  7835                                                                     CL**2
  7836         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  7837                                     COMP-3.                         CL**2
  7838         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  7839                                     COMP-3.                         CL**2
  7840         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  7841                                     COMP-3.                         CL**2
  7842         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  7843                                     COMP-3.                         CL**2
  7844         16  FILLER                PIC X(09).                        CL**2
  7845***************    OUTPUT FROM ELRTRM   *************************    CL**2
  7846                                                                     CL**2
  7847         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  7848                                     COMP-3.                         CL**2
  7849         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  7850                                     COMP-3.                         CL**2
  7851         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  7852                                     COMP-3.                         CL**2
  7853         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  7854                                     COMP-3.                         CL**2
  7855         16  FILLER                PIC X(12).                        CL**2
  7856                                                                     CL**2
  7857***************    OUTPUT FROM ELRAMT   *************************    CL**2
  7858                                                                     CL**2
  7859         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  7860                                     COMP-3.                         CL**2
  7861         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  7862                                     COMP-3.                         CL**2
  7863         16  FILLER                PIC X(12).                        CL**2
  7864                                                                     CL**2
  7865***************    OUTPUT FROM ELRATE   *************************    CL**2
  7866                                                                     CL**2
  7867         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  7868                                     COMP-3.                         CL**2
  7869         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  7870                                     COMP-3.                         CL**2
  7871         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  7872         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  7873             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  7874         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  7875                                     COMP-3.                         CL**2
  7876         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  7877         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  7878         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  7879                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 144
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7880         16  FILLER                PIC X(07).                        CL**2
  7881                                                                     CL**2
  7882***************    OUTPUT FROM ELRFND   *************************    CL**2
  7883                                                                     CL**2
  7884         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  7885                                     COMP-3.                         CL**2
  7886         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  7887           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  7888           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  7889           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  7890           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  7891           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7892           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  7893           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  7894           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  7895           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7896           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  7897           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  7898           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  7899           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  7900           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  7901         16  FILLER                PIC X(12).                        CL**2
  7902                                                                     CL**2
  7903***************    OUTPUT FROM ELEARN   *************************    CL**2
  7904                                                                     CL**2
  7905         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  7906                                     COMP-3.                         CL**2
  7907         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  7908                                     COMP-3.                         CL**2
  7909         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  7910                                     COMP-3.                         CL**2
  7911         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  7912                                     COMP-3.                         CL**2
  7913         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  7914                                     COMP-3.                         CL**2
  7915         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  7916                                     COMP-3.                         CL**2
  7917         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  7918           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  7919           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  7920           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  7921           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  7922           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7923           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  7924           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  7925           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  7926           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7927         16  FILLER                PIC X(12).                        CL**2
  7928                                                                     CL**2
  7929***************    OUTPUT FROM ELPMNT   *************************    CL**2
  7930                                                                     CL**2
  7931         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  7932                                     COMP-3.                         CL**2
  7933         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  7934                                     COMP-3.                         CL**2
  7935         16  FILLER                PIC X(12).                        CL**2
  7936                                                                     CL**2
  7937***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 145
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7938         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  7939                                     COMP-3.                         CL**2
  7940         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  7941                                     COMP-3.                         CL**2
  7942         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  7943                                     COMP-3.                         CL**2
  7944         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  7945                                     COMP-3.                         CL**2
  7946         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7947                                     COMP-3.                         CL**2
  7948         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7949                                     COMP-3.                         CL**2
  7950         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  7951             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  7952             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  7953             88  IO-ERROR                         VALUE 'E'.         CL**2
  7954                                                                     CL**2
  7955         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  7956                                                                     CL**2
  7957         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  7958                                                                     CL**2
  7959         16  CP-RESERVE-REMAINING-TERM                               CL**2
  7960                                   PIC S9(4)V9    VALUE ZERO         CL**2
  7961                                     COMP-3.                         CL**2
  7962                                                                     CL**2
  7963         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  7964                                                                     CL**2
  7965         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  7966                                     COMP-3.                         CL**2
  7967                                                                     CL**2
  7968         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  7969                                     COMP-3.                         CL**2
  7970                                                                     CL**2
  7971         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  7972                                     COMP-3.                         CL**2
  7973                                                                     CL**2
  7974         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  7975                                     COMP-3.                         CL**2
  7976                                                                     CL**2
  7977         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  7978                                     COMP-3.                         CL**2
  7979                                                                     CL**2
  7980         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  7981                                     COMP-3.                         CL**2
  7982                                                                     CL**2
  7983         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  7984                                     COMP-3.                         CL**2
  7985                                                                     CL**2
  7986         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  7987             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  7988                                                                     CL**2
  7989         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  7990                                     COMP-3.                         CL**2
  7991         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  7992                                     COMP-3.
  7993         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  7994         16  FILLER                PIC X(15).                        CL**2
  7995******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 146
* EL517.cbl
  7996
* 7997                                  COPY ELCDTECX.
  7998******************************************************************06/05/98
  7999*                                                                *ELCDTECX
  8000*                            ELCDTECX.                           *   LV005
  8001*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8002*                            VMOD=2.015                          *ELCDTECX
  8003*                                                                *ELCDTECX
  8004*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  8005*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  8006*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  8007*                                                                *ELCDTECX
  8008******************************************************************ELCDTECX
  8009******************************************************************
  8010*                   C H A N G E   L O G
  8011*
  8012* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8013*-----------------------------------------------------------------
  8014*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8015* EFFECTIVE    NUMBER
  8016*-----------------------------------------------------------------
  8017* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  8018*                                  BENEFIT CODES FROM 300 TO 900
  8019* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  8020* 051304    2003080800002  SMVA  ADD REFUND METHOD
  8021******************************************************************
  8022 01  DATE-CARD.                                                   ELCDTECX
  8023     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  8024     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  8025     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  8026     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  8027     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  8028     12  EP-SW                       PIC  X.                      ELCDTECX
  8029         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  8030     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  8031         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  8032     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  8033     12  RUN-CENTURY.                                             ELCDTECX
  8034         16 RUN-CENTURY-N            PIC  99.                        CL**4
  8035     12  FILLER                      PIC  X.                         CL**4
  8036     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  8037     12  FILLER                      PIC  XXX.                    ELCDTECX
  8038     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  8039                                                                  ELCDTECX
  8040 01  FILLER                          PIC  X(7)                       CL**6
  8041                                          VALUE 'OPTIONS'.        ELCDTECX
  8042 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  8043     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  8044     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  8045     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  8046         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  8047         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  8048     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  8049     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  8050     12  FILLER                      PIC  X.                      ELCDTECX
  8051     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  8052     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  8053     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 147
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8054     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  8055     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  8056     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  8057     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  8058     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  8059     12  FILLER                      PIC  X.                      ELCDTECX
  8060     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  8061     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  8062     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  8063     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  8064     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  8065     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  8066     12  FILLER                      PIC  X.                      ELCDTECX
  8067     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  8068     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  8069     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  8070     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  8071     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  8072     12  DTE-R78                     PIC  X.                      ELCDTECX
  8073     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  8074     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  8075     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  8076     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  8077     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  8078     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  8079     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  8080                                     PIC  X.                      ELCDTECX
  8081         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  8082                                                 ' '.             ELCDTECX
  8083         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  8084         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  8085     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  8086         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  8087         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  8088     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  8089     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  8090                                     PIC  9.                         CL**4
  8091     12  DTE-SYSTEM.                                              ELCDTECX
  8092         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  8093         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  8094         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  8095         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  8096         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  8097         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  8098         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  8099         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  8100         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  8101         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  8102         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  8103         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  8104         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  8105         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  8106         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  8107         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  8108         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  8109         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  8110         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  8111         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 148
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8112         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  8113         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  8114         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  8115         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  8116         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  8117         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  8118     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  8119         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  8120                                     PIC  X.                      ELCDTECX
  8121     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  8122                                                                  ELCDTECX
  8123 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  8124     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  8125     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  8126     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  8127*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  8128     12  FILLER                      PIC  X.                      ELCDTECX
  8129     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  8130     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  8131     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  8132     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  8133     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  8134     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  8135     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  8136                                                                  ELCDTECX
  8137     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  8138     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  8139     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  8140     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  8141                                                                  ELCDTECX
  8142     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  8143     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  8144     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  8145     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  8146                                                                  ELCDTECX
  8147     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  8148     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  8149                                                                  ELCDTECX
  8150     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  8151     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  8152                                                                  ELCDTECX
  8153     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  8154                                                                  ELCDTECX
  8155 01  DATE-CARD-FACTORS.                                           ELCDTECX
  8156     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  8157     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  8158     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  8159     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  8160     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  8161     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  8162     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  8163                                                                  ELCDTECX
  8164 01  FILLER                          PIC  X(12)                   ELCDTECX
  8165                                          VALUE 'COMPANY NAME'.   ELCDTECX
  8166 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  8167     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  8168         16  CNT-ID                  PIC  X.                      ELCDTECX
  8169         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 149
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8170                                                                  ELCDTECX
  8171 01  FILLER                          PIC  X(11)                   ELCDTECX
  8172                                          VALUE 'STATE NAMES'.    ELCDTECX
  8173 01  STATE-NAMES.                                                 ELCDTECX
  8174     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  8175         16  STATE-SUB               PIC  XX.                     ELCDTECX
  8176         16  STATE-PIC1.                                          ELCDTECX
  8177             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  8178             20  FILLER              PIC  XXX.                    ELCDTECX
  8179             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  8180             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  8181             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  8182             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  8183                                                                  ELCDTECX
  8184 01  FILLER                          PIC  X(13)                   ELCDTECX
  8185                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  8186 01  CARRIER-NAMES.                                               ELCDTECX
  8187     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  8188         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  8189         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  8190         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  8191         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8192         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8193         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8194*        16  FILLER                  PIC  X.                      ELCDTECX
  8195         16  CARRIER-SEC-PAY         PIC  X.
  8196             88  SEC-PAY-CARRIER          VALUE 'Y'.
  8197                                                                  ELCDTECX
  8198 01  FILLER                          PIC  X(9)                       CL**6
  8199                                          VALUE 'INS TYPES'.      ELCDTECX
  8200 01  CLAS-INS-TYPES.                                              ELCDTECX
  8201*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  8202     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  8203         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  8204         16  CLAS-I-AB3.                                          ELCDTECX
  8205             20  FILLER              PIC  X.                      ELCDTECX
  8206             20  CLAS-I-AB2.                                      ELCDTECX
  8207                 24  FILLER          PIC  X.                      ELCDTECX
  8208                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  8209         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  8210             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  8211             20  FILLER              PIC  X.                         CL**4
  8212         16  CLAS-I-AB10.                                         ELCDTECX
  8213             20  FILLER              PIC  X(9).                   ELCDTECX
  8214             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  8215         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  8216         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  8217         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  8218         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  8219             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  8220         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  8221         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  8222         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  8223         16  CLAS-I-BEN-CATEGORY     PIC  X.
  8224         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  8225         16  FILLER                  PIC  X(05).
  8226                                                                  ELCDTECX
  8227 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 150
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8228                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  8229 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  8230     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  8231                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  8232         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  8233         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  8234         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  8235         16  CLAS-MORT-DESC.                                      ELCDTECX
  8236             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  8237             20  FILLER              PIC  XX.                        CL**5
  8238             20  CLAS-YEAR           PIC  X(4).                      CL**6
  8239             20  FILLER              PIC  X.                         CL**5
  8240             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  8241             20  FILLER              PIC  X.                         CL**5
  8242             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  8243             20  FILLER              PIC  X.                         CL**5
  8244             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  8245             20  FILLER              PIC  X(5).                      CL**6
  8246                                                                  ELCDTECX
  8247 01  FILLER                          PIC  X(15)                   ELCDTECX
  8248                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  8249 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  8250     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  8251         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  8252         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  8253         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  8254         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  8255         16  FILLER                  PIC  X(4).                      CL**6
  8256                                                                  ELCDTECX
  8257 01  FILLER                          PIC  X(7)                       CL**6
  8258                                     VALUE 'INDEXES'.             ELCDTECX
  8259 01  CLAS-INDEX-TBL.                                              ELCDTECX
  8260     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  8261     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  8262     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  8263     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  8264     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  8265     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  8266     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  8267     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  8268     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  8269     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  8270     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  8271     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  8272     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  8273     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  8274     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  8275     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  8276     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  8277                                                                  ELCDTECX
  8278 01  CLAS-TYPE-MISC.                                              ELCDTECX
  8279     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  8280     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  8281     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  8282     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  8283     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  8284     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  8285     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 151
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8286     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  8287     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  8288     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  8289     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  8290                                                                  ELCDTECX
  8291 01  FILLER                          PIC  X(13)                   ELCDTECX
  8292                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  8293 01  CLAS-MISC.                                                   ELCDTECX
  8294     12  DTE-FICH                    PIC  X.                      ELCDTECX
  8295         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  8296         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  8297         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  8298     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  8299     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  8300     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  8301     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  8302     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  8303     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  8304     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  8305     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  8306     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  8307     12  STATE-L                     PIC  XX.                     ELCDTECX
  8308     12  CLAS-CN                     PIC  99.                     ELCDTECX
  8309     12  CLAS-CO                     PIC  99.                     ELCDTECX
  8310     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  8311         16  DTE-F-1                 PIC  X.                      ELCDTECX
  8312         16  DTE-F-2                 PIC  X.                      ELCDTECX
  8313     12  DTE-ABEND-WORK.                                          ELCDTECX
  8314         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  8315         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  8316                                                                  ELCDTECX
  8317 01  FILLER                          PIC  X(12)                   ELCDTECX
  8318                                     VALUE 'WORKING DATE'.        ELCDTECX
  8319 01  WS-DATE-AND-TIME.                                            ELCDTECX
  8320     12  WS-ACCEPT-DATE.                                          ELCDTECX
  8321         16  WS-AD-YY                PIC  99.                     ELCDTECX
  8322         16  WS-AD-MM                PIC  99.                     ELCDTECX
  8323         16  WS-AD-DD                PIC  99.                     ELCDTECX
  8324     12  WS-CURRENT-DATE.                                         ELCDTECX
  8325         16  WS-CD-MM                PIC  99.                     ELCDTECX
  8326         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8327         16  WS-CD-DD                PIC  99.                     ELCDTECX
  8328         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8329         16  WS-CD-YY                PIC  99.                     ELCDTECX
  8330     12  WS-TIME-OF-DAY.                                          ELCDTECX
  8331         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  8332         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  8333                                                                  ELCDTECX
  8334 01  FILLER                          PIC  X(12)                   ELCDTECX
  8335                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  8336 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  8337     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  8338         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  8339         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  8340         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  8341                                                                  ELCDTECX
  8342 01  FILLER                          PIC  X(10)                   ELCDTECX
  8343                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 152
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8344 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  8345     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  8346         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  8347         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  8348                                                                  ELCDTECX
  8349 01  FILLER                          PIC  X(13)                   ELCDTECX
  8350                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  8351 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  8352     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  8353         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  8354                                                                  ELCDTECX
  8355 01  FILLER                          PIC  X(13)                   ELCDTECX
  8356                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  8357 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  8358     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  8359     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  8360     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  8361                                     PIC  X.                         CL**5
  8362     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  8363     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  8364     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  8365     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  8366     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  8367     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  8368     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  8369     12  FILLER                      PIC  X(75).                  ELCDTECX
  8370******************************************************************ELCDTECX
  8371*01  MISC-CARR-PCT-DATA.                                          00001521
  8372*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8373*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8374*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8375*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8376*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8377*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8378******************************************************************ELCDTECX
  8379
* 8380                                  COPY ELCDTEVR.
  8381***************************************************************** 04/15/98
  8382*                                                                *ELCDTEVR
  8383*                                                                *ELCDTEVR
  8384*                            ELCDTEVR.                           *   LV003
  8385*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8386*                            VMOD=2.001                          *   CL**2
  8387*                                                                *ELCDTEVR
  8388*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  8389*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  8390*                                                                *ELCDTEVR
  8391******************************************************************ELCDTEVR
  8392 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  8393     05  WS-RUN-DATE.                                             ELCDTEVR
  8394         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8395         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  8396         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  8397             15  RUN-CC              PIC  99.                     ELCDTEVR
  8398             15  RUN-YR              PIC  99.                     ELCDTEVR
  8399         10  RUN-MO                  PIC  99.                     ELCDTEVR
  8400         10  RUN-DA                  PIC  99.                     ELCDTEVR
  8401     05  WS-RUN-DATE-N REDEFINES                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 153
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8402            WS-RUN-DATE              PIC 9(11).                      CL**2
  8403     05  WS-EP-DT.                                                ELCDTEVR
  8404         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8405         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  8406         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  8407             15  EP-CC               PIC  99.                     ELCDTEVR
  8408             15  EP-YR               PIC  99.                     ELCDTEVR
  8409         10  EP-MO                   PIC  99.                     ELCDTEVR
  8410         10  EP-DA                   PIC  99.                     ELCDTEVR
  8411     05  WS-EP-DT-N REDEFINES                                        CL**2
  8412            WS-EP-DT                 PIC 9(11).                      CL**2
  8413     05  WS-DTE-CONV-DT.                                             CL**4
  8414         10  FILLER                  PIC  9(03).                     CL**4
  8415         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  8416         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  8417             15  DTE-CONV-CC         PIC  99.                        CL**4
  8418             15  DTE-CONV-YR         PIC  99.                        CL**4
  8419         10  DTE-CONV-MO             PIC  99.                        CL**4
  8420         10  DTE-CONV-DA             PIC  99.                        CL**4
  8421     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  8422            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  8423 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  8424     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  8425         10  FILLER                            PIC 999.           ELCDTEVR
  8426         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  8427         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  8428             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  8429             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  8430         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  8431         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  8432     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  8433            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  8434     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  8435         10  FILLER                            PIC 999.           ELCDTEVR
  8436         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  8437         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  8438         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  8439         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  8440     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  8441            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  8442 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  8443     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  8444         10  FILLER                            PIC 999.           ELCDTEVR
  8445         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  8446         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  8447             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  8448             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  8449         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  8450         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  8451     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  8452            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  8453     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  8454         10  FILLER                            PIC 999.           ELCDTEVR
  8455         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  8456         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  8457             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  8458             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  8459         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 154
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8460         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  8461     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  8462            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  8463     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  8464         10  FILLER                            PIC 999.           ELCDTEVR
  8465         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  8466         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  8467             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  8468             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  8469         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  8470         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  8471     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  8472            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  8473 01  WS-RATE-RECORD.                                              ELCDTEVR
  8474         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  8475             10  FILLER                        PIC 999.           ELCDTEVR
  8476             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  8477             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  8478                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  8479                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  8480             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  8481             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  8482         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  8483                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  8484
* 8485                                  COPY ELCREINV.
  8486******************************************************************04/18/98
  8487*                                                                *ELCREINV
  8488*                                                                *ELCREINV
  8489*                            ELCREINV                            *   LV003
  8490*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8491*                            VMOD=2.001                          *ELCREINV
  8492*                                                                *ELCREINV
  8493*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  8494*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  8495*                                                                *ELCREINV
  8496******************************************************************ELCREINV
  8497                                                                  ELCREINV
  8498 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  8499     05  WS-RE-LO-DATE.                                              CL**3
  8500         10 FILLER                     PIC 999.                      CL**3
  8501         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  8502         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  8503            15 RE-LO-CC                PIC 99.                       CL**3
  8504            15 RE-LO-YR                PIC 99.                       CL**3
  8505         10 RE-LO-MO                   PIC 99.                       CL**3
  8506         10 RE-LO-DA                   PIC 99.                       CL**3
  8507     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  8508            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  8509     05  WS-RE-HI-DATE.                                              CL**3
  8510         10 FILLER                     PIC 999.                      CL**3
  8511         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  8512         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  8513            15 RE-HI-CC                PIC 99.                       CL**3
  8514            15 RE-HI-YR                PIC 99.                       CL**3
  8515         10 RE-HI-MO                   PIC 99.                       CL**3
  8516         10 RE-HI-DA                   PIC 99.                       CL**3
  8517     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 155
* EL517.cbl (/apps/prod/cid1p/copy/ELCREINV)
  8518            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  8519     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  8520         10 FILLER                     PIC 999.                   ELCREINV
  8521         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  8522         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  8523            15 RE-CLM-CC               PIC 99.                    ELCREINV
  8524            15 RE-CLM-YR               PIC 99.                    ELCREINV
  8525         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  8526         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  8527     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  8528            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  8529     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  8530         10  FILLER                    PIC 999.                   ELCREINV
  8531         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  8532         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  8533             15  RE-EARN-CC            PIC 99.                    ELCREINV
  8534             15  RE-EARN-YR            PIC 99.                    ELCREINV
  8535         10  RE-EARN-MO                PIC 99.                    ELCREINV
  8536         10  RE-EARN-DA                PIC 99.                    ELCREINV
  8537     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  8538            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  8539     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  8540         10  FILLER                    PIC 999.                   ELCREINV
  8541         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  8542         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  8543             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  8544             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  8545         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  8546         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  8547     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  8548            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  8549
* 8550                                  COPY ELCACCTV.
  8551******************************************************************04/14/98
  8552*                                                                *ELCACCTV
  8553*                            ELCACCTV                            *   LV002
  8554*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8555*                            VMOD=2.001                          *ELCACCTV
  8556*                                                                *ELCACCTV
  8557*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  8558*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  8559*                                                                *ELCACCTV
  8560*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  8561*                                                                *ELCACCTV
  8562******************************************************************ELCACCTV
  8563                                                                  ELCACCTV
  8564 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  8565                                                                  ELCACCTV
  8566     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  8567         10  FILLER            PIC 999.                           ELCACCTV
  8568         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  8569         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  8570             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  8571             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  8572         10  AM-EXP-MO         PIC 99.                               CL**5
  8573         10  AM-EXP-DA         PIC 99.                               CL**5
  8574     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  8575            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 156
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8576     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  8577         10  FILLER                    PIC 999.                   ELCACCTV
  8578         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  8579         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  8580             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  8581             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  8582         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  8583         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  8584     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  8585            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  8586     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  8587         10  FILLER                    PIC 999.                   ELCACCTV
  8588         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  8589         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  8590             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  8591             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  8592         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  8593         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  8594     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  8595            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  8596     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  8597         10 FILLER                     PIC 999.                   ELCACCTV
  8598         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  8599         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  8600            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  8601            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  8602         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  8603         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  8604     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  8605            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  8606     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  8607         10 FILLER                     PIC 999.                   ELCACCTV
  8608         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  8609         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  8610            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  8611            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  8612         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  8613         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  8614     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  8615            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  8616     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  8617         10  FILLER                    PIC 999.                   ELCACCTV
  8618         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  8619         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  8620             15  AM-AN-CC              PIC 99.                    ELCACCTV
  8621             15  AM-AN-YR              PIC 99.                    ELCACCTV
  8622         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  8623         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  8624     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  8625            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  8626     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  8627         10  FILLER                    PIC 999.                   ELCACCTV
  8628         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  8629         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  8630             15  AM-HI-CC              PIC 99.                    ELCACCTV
  8631             15  AM-HI-YR              PIC 99.                    ELCACCTV
  8632         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  8633         10  AM-HI-DA                  PIC 99.                    ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 157
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8634     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  8635            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  8636     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  8637         10  FILLER                    PIC 999.                   ELCACCTV
  8638         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  8639         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  8640             15  AM-LO-CC              PIC 99.                    ELCACCTV
  8641             15  AM-LO-YR              PIC 99.                    ELCACCTV
  8642         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  8643         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  8644     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  8645            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  8646     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  8647         10  FILLER                    PIC 999.                   ELCACCTV
  8648         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  8649         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  8650             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  8651             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  8652         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  8653         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  8654     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  8655            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 158
* EL517.cbl
* 8657                                  COPY ELCDIFRD.
  8658******************************************************************04/15/98
  8659*                                                                *ELCDIFRD
  8660*                                                                *ELCDIFRD
  8661*                            ELCDIFRD.                           *   LV003
  8662*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8663*                            VMOD=2.004                          *   CL**3
  8664*                                                                *ELCDIFRD
  8665*   WORKING STORAGE FOR REFUND DIFFERENCES                       *ELCDIFRD
  8666*                                                                *ELCDIFRD
  8667******************************************************************ELCDIFRD
  8668*                                                                 ELCDIFRD
  8669  01  WS-DIFFERENCE-CALCULATION.                                  ELCDIFRD
  8670        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8671        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8672        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8673        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8674        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8675        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8676        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8677        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8678        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8679        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8680        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 159
* EL517.cbl
* 8682                                  COPY ELCERRWS.
  8683******************************************************************04/15/98
  8684*                                                                *ELCERRWS
  8685*                                                                *ELCERRWS
  8686*                            ELCERRWS                            *   LV002
  8687*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8688*                            VMOD=2.005                          *   CL**2
  8689*                                                                *ELCERRWS
  8690*                                                                *ELCERRWS
  8691*    WORKING STORAGE FOR ERROR MESSAGES ROUTINE ELCERRPD         *ELCERRWS
  8692*                                                                *ELCERRWS
  8693******************************************************************ELCERRWS
  8694                                                                  ELCERRWS
  8695 01  W-ERROR-WORK.                                                ELCERRWS
  8696     12  E-CLIENT-ID             PIC X(03)   VALUE SPACES.        ELCERRWS
  8697     12  CLIENT-ABL              PIC X(03)   VALUE 'ABL'.         ELCERRWS
  8698     12  CLIENT-AIG              PIC X(03)   VALUE 'AIG'.         ELCERRWS
  8699     12  CLIENT-AUK              PIC X(03)   VALUE 'AUK'.         ELCERRWS
  8700     12  CLIENT-CIG              PIC X(03)   VALUE 'CIG'.         ELCERRWS
  8701     12  CLIENT-CUK              PIC X(03)   VALUE 'CUK'.         ELCERRWS
  8702     12  CLIENT-LAP              PIC X(03)   VALUE 'LAP'.         ELCERRWS
  8703     12  CLIENT-NCB              PIC X(03)   VALUE 'NCB'.         ELCERRWS
  8704     12  CLIENT-TIC              PIC X(03)   VALUE 'TIC'.         ELCERRWS
  8705     12  CLIENT-TMS              PIC X(03)   VALUE 'TMS'.         ELCERRWS
  8706     12  CLIENT-LBL              PIC X(03)   VALUE 'LBL'.         ELCERRWS
  8707     12  CLIENT-HAN              PIC X(03)   VALUE 'HAN'.         ELCERRWS
  8708     12  CLIENT-JHL              PIC X(03)   VALUE 'JHL'.         ELCERRWS
  8709     12  CLIENT-HER              PIC X(03)   VALUE 'HER'.         ELCERRWS
  8710     12  CLIENT-NCX              PIC X(03)   VALUE 'NCX'.         ELCERRWS
  8711     12  CLIENT-DCC              PIC X(03)   VALUE 'DCC'.
  8712     12  CLIENT-CID              PIC X(03)   VALUE 'CID'.
  8713                                                                  ELCERRWS
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 160
* EL517.cbl
  8715
  8716 PROCEDURE DIVISION.
  8717
  8718 00000-LOAD-DATE-CARD.
*                                      COPY ELCDTERX.
  8719******************************************************************04/15/98
  8720*                                                                *ELCDTERX
  8721*                                                                *ELCDTERX
  8722*                            ELCDTERX.                           *   LV002
  8723*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8724*                            VMOD=2.007                          *ELCDTERX
  8725*                                                                *ELCDTERX
  8726*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  8727*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  8728*      = ELCDTEFD)                                               *ELCDTERX
  8729*                                                                *ELCDTERX
  8730******************************************************************ELCDTERX
  8731                                                                  ELCDTERX
  8732     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  8733                                                                  ELCDTERX
  8734     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  8735     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  8736     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  8737                                                                  ELCDTERX
  8738     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  8739                                                                  ELCDTERX
  8740******************************************************************ELCDTERX
  8741*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  8742*          WARNING MESSAGES.                                      ELCDTERX
  8743******************************************************************ELCDTERX
  8744     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  8745         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  8746                                                                  ELCDTERX
  8747     OPEN INPUT DISK-DATE.                                        ELCDTERX
  8748                                                                  ELCDTERX
  8749     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  8750                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  8751                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  8752                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  8753                   CLAX-ID           CLAS-MISC                    ELCDTERX
  8754                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  8755                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  8756                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  8757                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  8758                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  8759                                                                  ELCDTERX
  8760     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  8761                                                                  ELCDTERX
  8762     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  8763                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  8764                                                                  ELCDTERX
  8765     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  8766     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  8767     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  8768     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  8769                                                                  ELCDTERX
  8770     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  8771         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 161
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8772     ELSE                                                         ELCDTERX
  8773         ADD +1                 TO CLAS-CN.                       ELCDTERX
  8774                                                                  ELCDTERX
  8775     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  8776         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  8777     ELSE                                                         ELCDTERX
  8778         ADD +1                 TO CLAS-CO.                       ELCDTERX
  8779                                                                  ELCDTERX
  8780 0005-READ--CARD.                                                 ELCDTERX
  8781     READ DISK-DATE                                               ELCDTERX
  8782         AT END CLOSE DISK-DATE                                   ELCDTERX
  8783             GO TO 0060-READ--TEST.                               ELCDTERX
  8784                                                                  ELCDTERX
  8785     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  8786                                                                  ELCDTERX
  8787     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  8788         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  8789         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  8790         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  8791         GO TO 0005-READ--CARD.                                   ELCDTERX
  8792                                                                  ELCDTERX
  8793     IF DD-ID = 'CLAD'                                            ELCDTERX
  8794         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  8795         GO TO 0005-READ--CARD.                                   ELCDTERX
  8796                                                                  ELCDTERX
  8797     IF DD-ID = 'CLAX'                                            ELCDTERX
  8798         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  8799         GO TO 0005-READ--CARD.                                   ELCDTERX
  8800                                                                  ELCDTERX
  8801     IF DD-ID = 'CLAF'                                            ELCDTERX
  8802         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  8803         GO TO 0005-READ--CARD.                                   ELCDTERX
  8804                                                                  ELCDTERX
  8805     IF DD-ID = 'CLAC'                                            ELCDTERX
  8806         GO TO 0010-READ--CLAC.                                   ELCDTERX
  8807                                                                  ELCDTERX
  8808     IF DD-ID = 'CARR'                                            ELCDTERX
  8809         GO TO 0015-READ--CARR.                                   ELCDTERX
  8810                                                                  ELCDTERX
  8811     IF DD-ID = 'STAT'                                            ELCDTERX
  8812         GO TO 0020-READ--STAT.                                   ELCDTERX
  8813                                                                  ELCDTERX
  8814     IF DD-ID = 'BUSC'                                            ELCDTERX
  8815         GO TO 0025-READ--BUSC.                                   ELCDTERX
  8816                                                                  ELCDTERX
  8817     IF DD-ID = 'MORT'                                            ELCDTERX
  8818         GO TO 0030-READ--MORT.                                   ELCDTERX
  8819                                                                  ELCDTERX
  8820     IF DD-ID = 'CLAI'                                            ELCDTERX
  8821         GO TO 0040-READ--CLAI.                                   ELCDTERX
  8822                                                                  ELCDTERX
  8823     IF DD-ID = 'COLC'                                            ELCDTERX
  8824         GO TO 0065-READ--COLC.                                   ELCDTERX
  8825                                                                  ELCDTERX
  8826     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8827        DD-IDA = 'CL'                                             ELCDTERX
  8828         GO TO 0035-READ--CLXX.                                   ELCDTERX
  8829                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 162
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8830     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8831        DD-IDA = 'PO'                                             ELCDTERX
  8832         GO TO 0050-READ--POXX.                                   ELCDTERX
  8833                                                                  ELCDTERX
  8834     IF DD-ID = 'OPCA'                                            ELCDTERX
  8835         GO TO 0070-READ--OPCA.                                   ELCDTERX
  8836                                                                  ELCDTERX
  8837     IF DD-ID = 'OPST'                                            ELCDTERX
  8838         GO TO 0072-READ--OPST.                                   ELCDTERX
  8839                                                                  ELCDTERX
  8840     IF DD-ID = 'OPBS'                                            ELCDTERX
  8841         GO TO 0074-READ--OPBS.                                   ELCDTERX
  8842                                                                  ELCDTERX
  8843     IF DD-ID = 'OPMS'                                            ELCDTERX
  8844         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  8845                                                                  ELCDTERX
  8846     GO TO 0005-READ--CARD.                                       ELCDTERX
  8847                                                                  ELCDTERX
  8848 0010-READ--CLAC.                                                 ELCDTERX
  8849     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8850     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8851     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8852     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8853     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8854     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8855     GO TO 0005-READ--CARD.                                       ELCDTERX
  8856                                                                  ELCDTERX
  8857 0015-READ--CARR.                                                 ELCDTERX
  8858     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8859     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8860        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  8861        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8862        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  8863        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8864        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8865        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8866        MOVE DD-CARR1-SECPAY-SW
  8867                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8868     END-IF
  8869                                                                  ELCDTERX
  8870     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8871     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8872        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  8873        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8874        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  8875        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8876        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8877        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8878        MOVE DD-CARR2-SECPAY-SW
  8879                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8880     END-IF
  8881                                                                  ELCDTERX
  8882                                                                  ELCDTERX
  8883     GO TO 0005-READ--CARD.                                       ELCDTERX
  8884                                                                  ELCDTERX
  8885 0020-READ--STAT.                                                 ELCDTERX
  8886     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8887     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 163
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8888        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8889         GO TO 0005-READ--CARD.                                   ELCDTERX
  8890                                                                  ELCDTERX
  8891     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  8892     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  8893     GO TO 0020-READ--STAT.                                       ELCDTERX
  8894                                                                  ELCDTERX
  8895 0025-READ--BUSC.                                                 ELCDTERX
  8896     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8897     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  8898        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8899         GO TO 0005-READ--CARD.                                   ELCDTERX
  8900                                                                  ELCDTERX
  8901     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  8902     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  8903     GO TO 0025-READ--BUSC.                                       ELCDTERX
  8904                                                                  ELCDTERX
  8905 0030-READ--MORT.                                                 ELCDTERX
  8906     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8907     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8908        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  8909         GO TO 0005-READ--CARD.                                   ELCDTERX
  8910                                                                  ELCDTERX
  8911     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  8912     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  8913     GO TO 0030-READ--MORT.                                       ELCDTERX
  8914                                                                  ELCDTERX
  8915 0035-READ--CLXX.                                                 ELCDTERX
  8916     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  8917          GO TO 0005-READ--CARD.                                  ELCDTERX
  8918                                                                  ELCDTERX
  8919     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  8920         DISPLAY '***********************************************'ELCDTERX
  8921         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  8922         DISPLAY '***********************************************'ELCDTERX
  8923         GO TO 0055-READ--STOP.                                   ELCDTERX
  8924                                                                  ELCDTERX
  8925     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  8926        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  8927         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  8928                                                                  ELCDTERX
  8929     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  8930        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  8931         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  8932                                                                  ELCDTERX
  8933*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  8934     GO TO 0005-READ--CARD.                                       ELCDTERX
  8935                                                                  ELCDTERX
  8936 0040-READ--CLAI.                                                 ELCDTERX
  8937     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8938     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8939        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  8940         GO TO 0005-READ--CARD.                                   ELCDTERX
  8941                                                                  ELCDTERX
  8942     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  8943     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  8944     GO TO 0040-READ--CLAI.                                       ELCDTERX
  8945                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 164
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8946 0045-READ--DUMP.                                                 ELCDTERX
  8947     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  8948     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  8949                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  8950     PERFORM ABEND-PGM.                                           ELCDTERX
  8951                                                                  ELCDTERX
  8952 0050-READ--POXX.                                                 ELCDTERX
  8953     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  8954         GO TO 0005-READ--CARD.                                   ELCDTERX
  8955                                                                  ELCDTERX
  8956     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  8957         DISPLAY '***********************************************'ELCDTERX
  8958         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  8959         DISPLAY '***********************************************'ELCDTERX
  8960         GO TO 0055-READ--STOP.                                   ELCDTERX
  8961                                                                  ELCDTERX
  8962     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  8963     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  8964     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  8965     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  8966                                                                  ELCDTERX
  8967     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  8968         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  8969     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  8970         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  8971                                                                  ELCDTERX
  8972     GO TO 0005-READ--CARD.                                       ELCDTERX
  8973                                                                  ELCDTERX
  8974 0055-READ--STOP.                                                 ELCDTERX
  8975     GOBACK.                                                      ELCDTERX
  8976                                                                  ELCDTERX
  8977 0060-READ--TEST.                                                 ELCDTERX
  8978     IF DATX-COD        = SPACE  OR                               ELCDTERX
  8979        CLAX-ID         = SPACE  OR                               ELCDTERX
  8980        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  8981         GO TO 0045-READ--DUMP.                                   ELCDTERX
  8982                                                                  ELCDTERX
  8983     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  8984     GO TO 0079-READ--EXIT.                                       ELCDTERX
  8985                                                                  ELCDTERX
  8986 0065-READ--COLC.                                                 ELCDTERX
  8987     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  8988     GO TO 0005-READ--CARD.                                       ELCDTERX
  8989                                                                  ELCDTERX
  8990 0070-READ--OPCA.                                                 ELCDTERX
  8991                                                                  ELCDTERX
  8992     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8993                                                                  ELCDTERX
  8994     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  8995             OR                                                   ELCDTERX
  8996         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  8997         GO TO 0005-READ--CARD.                                   ELCDTERX
  8998                                                                  ELCDTERX
  8999     ADD 1                       TO INDEXCA.                      ELCDTERX
  9000     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  9001                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  9002     GO TO 0070-READ--OPCA.                                       ELCDTERX
  9003                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 165
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  9004 0072-READ--OPST.                                                 ELCDTERX
  9005                                                                  ELCDTERX
  9006     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9007                                                                  ELCDTERX
  9008     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  9009             OR                                                   ELCDTERX
  9010         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  9011         GO TO 0005-READ--CARD.                                   ELCDTERX
  9012                                                                  ELCDTERX
  9013     ADD 1                       TO INDEXST.                      ELCDTERX
  9014     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  9015                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  9016     GO TO 0072-READ--OPST.                                       ELCDTERX
  9017                                                                  ELCDTERX
  9018 0074-READ--OPBS.                                                 ELCDTERX
  9019                                                                  ELCDTERX
  9020     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9021                                                                  ELCDTERX
  9022     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  9023             OR                                                   ELCDTERX
  9024         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  9025         GO TO 0005-READ--CARD.                                   ELCDTERX
  9026                                                                  ELCDTERX
  9027     ADD 1                       TO INDEXBS.                      ELCDTERX
  9028     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  9029     GO TO 0074-READ--OPBS.                                       ELCDTERX
  9030                                                                  ELCDTERX
  9031 0079-READ--EXIT.                                                 ELCDTERX
  9032*    EXIT.                                                        ELCDTERX
  9033******************************************************************ELCDTERX
  9034
  9035     MOVE DTE-CLIENT TO E-CLIENT-ID.
  9036
  9037     MOVE WS-CD-YY               TO DC-MDY-YEAR.
  9038     MOVE WS-CD-DD               TO DC-MDY-DAY.
  9039     MOVE WS-CD-MM               TO DC-MDY-MONTH.
  9040
  9041     MOVE 4                      TO DC-OPTION-CODE.
  9042     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9043     MOVE DC-JULIAN-DATE         TO EIBDATE.
  9044     MOVE LOW-VALUES             TO WK-RECORD-ADDRESSES.
  9045     MOVE WORK-AREAS             TO HOLD-WORK.
  9046
  9047     IF DTE-PRC-OPT = '2'
  9048         MOVE 'FULL FILE EDIT' TO ER-ONLY.
  9049
  9050     OPEN INPUT ELCNTL.
  9051     IF ELCNTL-FILE-STATUS   = '00' OR '97'
  9052         NEXT SENTENCE
  9053       ELSE
  9054         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9055         MOVE 'ELCNTL'           TO WS-FEM-FILE-NAME
  9056         MOVE EMSG               TO WS-ABEND-MESSAGE
  9057         GO TO ABEND-PGM.
  9058
  9059     OPEN  I-O ERPNDB.
  9060     IF ERPNDB-FILE-STATUS   = '00' OR '97'
  9061         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 166
* EL517.cbl
  9062       ELSE
  9063         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9064         MOVE 'ERPNDB'           TO WS-FEM-FILE-NAME
  9065         MOVE EMSG               TO WS-ABEND-MESSAGE
  9066         GO TO ABEND-PGM.
  9067
  9068     MOVE LOW-VALUES            TO PB-CONTROL-PRIMARY.
  9069     MOVE DTE-CLASIC-COMPANY-CD TO PB-COMPANY-CD.
  9070
  9071     START ERPNDB KEY NOT LESS THAN PB-CONTROL-PRIMARY.
  9072
  9073     IF ERPNDB-FILE-STATUS NOT = '00'
  9074         GO TO 9999-DONE.
  9075
  9076     OPEN INPUT ERREIN.
  9077     IF ERREIN-FILE-STATUS   = '00' OR '97'
  9078         NEXT SENTENCE
  9079       ELSE
  9080         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9081         MOVE 'ERREIN'           TO WS-FEM-FILE-NAME
  9082         MOVE EMSG               TO WS-ABEND-MESSAGE
  9083         GO TO ABEND-PGM.
  9084
  9085     IF DTE-CLIENT = 'DCC'
  9086        OPEN INPUT ERPDEF ELSTAT
  9087        IF ERPDEF-FILE-STATUS   = '00' OR '97'
  9088           CONTINUE
  9089        ELSE
  9090           MOVE ERPDEF-FILE-STATUS
  9091                                 TO WS-ABEND-FILE-STATUS
  9092           MOVE 'ERPDEF'         TO WS-FEM-FILE-NAME
  9093           MOVE EMSG             TO WS-ABEND-MESSAGE
  9094           GO TO ABEND-PGM
  9095        END-IF
  9096        IF ELSTAT-FILE-STATUS   = '00' OR '97'
  9097           CONTINUE
  9098        ELSE
  9099           MOVE ELSTAT-FILE-STATUS
  9100                                 TO WS-ABEND-FILE-STATUS
  9101           MOVE 'ELSTAT'         TO WS-FEM-FILE-NAME
  9102           MOVE EMSG             TO WS-ABEND-MESSAGE
  9103           GO TO ABEND-PGM
  9104        END-IF
  9105     END-IF
  9106
  9107     OPEN I-O   ELCERT.
  9108******************************************************************
  9109*                                                                *
  9110*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  9111*    REVIEW AND CORRRECTION SUB-SYSTEM.                          *
  9112*                                                                *
  9113*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
  9114*                                                                *
  9115*               EL631 - EL6311 - EL6312 - EL6313                 *
  9116*                                                                *
  9117******************************************************************
  9118
  9119     IF ELCERT-FILE-STATUS  = '00' OR '97'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 167
* EL517.cbl
  9120         NEXT SENTENCE
  9121       ELSE
  9122         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9123         MOVE 'ELCERT'              TO WS-FEM-FILE-NAME
  9124         MOVE EMSG                  TO WS-ABEND-MESSAGE
  9125         GO TO ABEND-PGM.
  9126
  9127     OPEN INPUT ERCTBL.
  9128     IF ERCTBL-FILE-STATUS   = '00' OR '97'
  9129         NEXT SENTENCE
  9130       ELSE
  9131         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9132         MOVE 'ERCTBL'           TO WS-FEM-FILE-NAME
  9133         MOVE EMSG               TO WS-ABEND-MESSAGE
  9134         GO TO ABEND-PGM.
  9135
  9136     OPEN INPUT ERACCT.
  9137     IF ERACCT-FILE-STATUS   = '00' OR '97'
  9138         NEXT SENTENCE
  9139       ELSE
  9140         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9141         MOVE 'ERACCT'           TO WS-FEM-FILE-NAME
  9142         MOVE EMSG               TO WS-ABEND-MESSAGE
  9143         GO TO ABEND-PGM.
  9144
  9145     OPEN INPUT ERCOMP.
  9146     IF ERCOMP-FILE-STATUS   = '00' OR '97'
  9147         NEXT SENTENCE
  9148       ELSE
  9149         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9150         MOVE 'ERCOMP'           TO WS-FEM-FILE-NAME
  9151         MOVE EMSG               TO WS-ABEND-MESSAGE
  9152         GO TO ABEND-PGM.
  9153
  9154     OPEN INPUT ERLOFC
  9155     IF ERLOFC-FILE-STATUS   = '00' OR '97'
  9156        CONTINUE
  9157     ELSE
  9158        MOVE ERLOFC-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9159        MOVE 'ERLOFC'            TO WS-FEM-FILE-NAME
  9160        MOVE EMSG                TO WS-ABEND-MESSAGE
  9161        GO TO ABEND-PGM
  9162     END-IF
  9163
  9164     OPEN INPUT ERBXRF.
  9165     IF ERBXRF-FILE-STATUS   = '00' OR '97'
  9166         NEXT SENTENCE
  9167       ELSE
  9168         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9169         MOVE 'ERBXRF'           TO WS-FEM-FILE-NAME
  9170         MOVE EMSG               TO WS-ABEND-MESSAGE
  9171         GO TO ABEND-PGM.
  9172
  9173     OPEN INPUT ERAGTC.
  9174     IF ERAGTC-FILE-STATUS   = '00' OR '97'
  9175         NEXT SENTENCE
  9176       ELSE
  9177         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 168
* EL517.cbl
  9178         MOVE 'ERAGTC'           TO WS-FEM-FILE-NAME
  9179         MOVE EMSG               TO WS-ABEND-MESSAGE
  9180         GO TO ABEND-PGM.
  9181
  9182     OPEN INPUT ERPLAN.
  9183     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  9184        NEXT SENTENCE
  9185     ELSE
  9186        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9187        MOVE 'ERPLAN '           TO WS-FEM-FILE-NAME
  9188        MOVE EMSG                TO WS-ABEND-MESSAGE
  9189        GO TO ABEND-PGM.
  9190
  9191     OPEN INPUT ERFORM.
  9192     IF ERFORM-FILE-STATUS  = '00' OR '97' OR '9+'
  9193        OR '9%'
  9194        NEXT SENTENCE
  9195     ELSE
  9196        MOVE ERFORM-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9197        MOVE 'ERFORM '           TO WS-FEM-FILE-NAME
  9198        MOVE EMSG                TO WS-ABEND-MESSAGE
  9199        GO TO ABEND-PGM.
  9200
  9201     OPEN INPUT ELCERR.
  9202     IF ELCERR-FILE-STATUS   = '00' OR '97'
  9203         NEXT SENTENCE
  9204       ELSE
  9205         MOVE ELCERR-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9206         MOVE 'ELCERR'           TO WS-FEM-FILE-NAME
  9207         MOVE EMSG               TO WS-ABEND-MESSAGE
  9208         GO TO ABEND-PGM.
  9209
  9210     MOVE 'R'                     TO CP-RATE-FILE.
  9211     MOVE 'O'                     TO CP-IO-FUNCTION.
  9212     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  9213
  9214     IF IO-ERROR
  9215        MOVE SPACE                TO WS-ABEND-FILE-STATUS
  9216        MOVE 'ELRATE'             TO WS-FEM-FILE-NAME
  9217        MOVE EMSG                 TO WS-ABEND-MESSAGE
  9218        GO TO ABEND-PGM.
  9219
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 169
* EL517.cbl
  9221*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  9222*
  9223     IF DTE-CLIENT NOT = 'DMD'
  9224         GO TO 0100-READ-PENDING.
  9225
  9226     OPEN INPUT ERRESS ERRESC.
  9227
  9228     IF ERRESS-FILE-STATUS   = '00' OR '97'
  9229         NEXT SENTENCE
  9230     ELSE
  9231         MOVE ERRESS-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9232         MOVE 'ERRESS'           TO WS-FEM-FILE-NAME
  9233         MOVE EMSG               TO WS-ABEND-MESSAGE
  9234         GO TO ABEND-PGM.
  9235
  9236     IF ERRESC-FILE-STATUS   = '00' OR '97'
  9237         NEXT SENTENCE
  9238     ELSE
  9239         MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9240         MOVE 'ERRESC'           TO WS-FEM-FILE-NAME
  9241         MOVE EMSG               TO WS-ABEND-MESSAGE
  9242         GO TO ABEND-PGM.
  9243
  9244     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
  9245     MOVE 'O'                    TO DMPF-PROCESS-TYPE.
  9246     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
  9247     IF DMPF-RETURN-CODE EQUAL 'Z2'
  9248         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9249         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
  9250         MOVE EMSG               TO WS-ABEND-MESSAGE
  9251         GO TO ABEND-PGM.
  9252
  9253     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
  9254     MOVE 'O'                    TO DIPF-PROCESS-TYPE.
  9255     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
  9256     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9257         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9258         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
  9259         MOVE EMSG               TO WS-ABEND-MESSAGE
  9260         GO TO ABEND-PGM.
  9261
  9262     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
  9263     MOVE 'O'                    TO DVBI-PROCESS-TYPE.
  9264     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
  9265     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9266         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9267         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
  9268         MOVE EMSG               TO WS-ABEND-MESSAGE
  9269         GO TO ABEND-PGM.
  9270
  9271     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9272     MOVE 'O'                    TO DCUA-PROCESS-TYPE.
  9273     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9274     IF DCUA-RETURN-CODE EQUAL 'Z2'
  9275         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9276         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
  9277         MOVE EMSG               TO WS-ABEND-MESSAGE
  9278         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 170
* EL517.cbl
  9279
  9280     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
  9281     MOVE 'O'                    TO DPRB-PROCESS-TYPE.
  9282     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
  9283     IF DPRB-RETURN-CODE EQUAL 'Z2'
  9284         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9285         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
  9286         MOVE EMSG               TO WS-ABEND-MESSAGE
  9287         GO TO ABEND-PGM.
  9288
  9289     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
  9290     MOVE 'O'                    TO DVRC-PROCESS-TYPE.
  9291     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
  9292     IF DVRC-RETURN-CODE EQUAL 'Z2'
  9293         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9294         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
  9295         MOVE EMSG               TO WS-ABEND-MESSAGE
  9296         GO TO ABEND-PGM.
  9297
  9298     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
  9299     MOVE 'O'                    TO DVSC-PROCESS-TYPE.
  9300     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
  9301     IF DVSC-RETURN-CODE EQUAL 'Z2'
  9302         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9303         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
  9304         MOVE EMSG               TO WS-ABEND-MESSAGE
  9305         GO TO ABEND-PGM.
  9306
  9307*
  9308*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  9309*
  9310 0100-READ-PENDING.
  9311
  9312     MOVE HOLD-WORK TO WORK-AREAS.
  9313
  9314     MOVE ZEROS                  TO EMI-WARNING-CTR
  9315                                    EMI-FORCABLE-CTR
  9316                                    EMI-FATAL-CTR.
  9317 0101-READ-PENDING.
  9318     READ ERPNDB.
  9319     ADD 1 TO RPND.
  9320
  9321     IF DTE-CLASIC-COMPANY-CD NOT = PB-COMPANY-CD-A1
  9322         GO TO 9999-DONE.
  9323
  9324     IF ERPNDB-FILE-STATUS NOT = '00'
  9325         GO TO 9999-DONE.
  9326
  9327     MOVE LIFE-OVERRIDE-L1       TO PB-LIFE-OVERRIDE-L1.
  9328     MOVE AH-OVERRIDE-L1         TO PB-AH-OVERRIDE-L1.
  9329     MOVE PB-ENTRY-BATCH         TO WK-BATCH-NO.
  9330
  9331     IF PB-BATCH-TRAILER
  9332         GO TO 9999-REWRITE-RECORD.
  9333
  9334     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  9335        GO TO 0100-READ-PENDING.
  9336
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 171
* EL517.cbl
  9337     IF PB-BILLED-DT NOT EQUAL LOW-VALUES
  9338        PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9339        GO TO 0100-READ-PENDING.
  9340
  9341     IF WK-BATCH-PREFIX = '#CL'
  9342        GO TO 0100-READ-PENDING.
  9343
  9344     IF DTE-PRC-OPT = '2'
  9345         NEXT SENTENCE
  9346     ELSE
  9347         IF NOT PB-FATAL-ERRORS
  9348             PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9349             GO TO 0100-READ-PENDING.
  9350
  9351     ADD 1 TO TRAN-CT.
  9352
  9354 0000-PROCEDURE-DIV.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 172
* EL517.cbl
*                           COPY ELC50PD.
  9355******************************************************************04/22/98
  9356*                                                                *ELC50PD
  9357*                            ELC50PD                             *   LV012
  9358*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**8
  9359*                            VMOD=2.188                          *   CL**7
  9360*                                                                *ELC50PD
  9361******************************************************************
  9362*                   C H A N G E   L O G
  9363*
  9364* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  9365*-----------------------------------------------------------------
  9366*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  9367* EFFECTIVE    NUMBER
  9368*-----------------------------------------------------------------
  9369* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  9370* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  9371* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  9372*                             2709 AND 2718
  9373* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  9374* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  9375* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  9376* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  9377* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  9378*                                IS OPEN OR CNC DT < PD THRU
  9379* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  9380* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  9381* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  9382* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  9383* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  9384* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  9385* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  9386* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
  9387* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  9388* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  9389* 020906                   PEMA  EXPAND LOAN OFFICER
  9390* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  9391* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  9392* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  9393* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  9394* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  9395* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  9396* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  9397* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  9398* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  9399* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  9400* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  9401* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  9402* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  9403* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  9404* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  9405* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  9406* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  9407* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  9408* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  9409* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST PMT
  9410* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUMS
  9411* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 173
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9412* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  9413* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  9414* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  9415*                                UPDATE VIN ON CERT TRAILER
  9416* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  9417* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISAB ONLY
  9418* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  9419* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  9420* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9421* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  9422* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONLY
  9423* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  9424* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  9425* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  9426* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  9427* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  9428* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  9429* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  9430* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  9431* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  9432* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  9433* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  9434* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  9435* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  9436* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  9437* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  9438* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  9439* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9440* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  9441* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  9442* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  9443* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  9444* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  9445* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  9446* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  9447* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  9448* 032912  CR2011110200001  PEMA  AHL CHANGES
  9449* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  9450* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  9451* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  9452* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  9453* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  9454* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  9455* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  9456* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  9457* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  9458* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  9459* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  9460* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  9461* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  9462* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  9463******************************************************************ELC50PD
  9464************* PROCEDURE DIVISION FOR EL050 & EL517 ***************ELC50PD
  9465******************************************************************ELC50PD
  9466                                                                  ELC50PD
  9467     INITIALIZE  WS-CRI-SSN-WORK-AREA.                            ELC50PD
  9468                                                                  ELC50PD
  9469     MOVE SPACES                 TO PB-FATAL-FLAG                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 174
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9470                                    PB-FORCE-ER-CD                ELC50PD
  9471                                    PB-WARN-ER-CD                 ELC50PD
  9472                                    PB-OUT-BAL-CD.                ELC50PD
  9473                                                                  ELC50PD
  9474     MOVE SPACE                  TO WS-IG-OVRD-AH                 ELC50PD
  9475                                    WS-IG-OVRD-LF                 ELC50PD
  9476                                    WS-IG-OVRD-AM                 ELC50PD
  9477                                    WS-IG-OVRD                    ELC50PD
  9478                                    WS-IG-OVRD-AH-PL              ELC50PD
  9479                                    WS-IG-OVRD-LF-PL              ELC50PD
  9480                                    WS-IG-OVRD-AH-BEN             ELC50PD
  9481                                    WS-IG-OVRD-LF-BEN.            ELC50PD
  9482                                                                  ELC50PD
  9483******************************************************************ELC50PD
  9484*************       INITIALIZE COMMON ERRORS       ***************ELC50PD
  9485******************************************************************ELC50PD
  9486                                                                  ELC50PD
  9487     MOVE +0                     TO PB-NO-OF-ERRORS.              ELC50PD
  9488     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.             ELC50PD
  9489                                                                  ELC50PD
  9490******************************************************************ELC50PD
  9491                                                                  ELC50PD
  9492     MOVE EIBDATE                TO DC-JULIAN-DATE.               ELC50PD
  9493     SET JULIAN-TO-BIN           TO TRUE.                         ELC50PD
  9494*    MOVE 5                      TO DC-OPTION-CODE.               ELC50PD
  9495     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
  9496     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.            ELC50PD
  9497                                                                  ELC50PD
  9498     MOVE ZERO                   TO  SUB4.                        ELC50PD
  9499                                                                  ELC50PD
  9500 0040-INITIALIZE-GA-BILL-DT.                                      ELC50PD
  9501                                                                  ELC50PD
  9502     ADD +1                      TO  SUB4.                        ELC50PD
  9503                                                                  ELC50PD
  9504     IF  SUB4 GREATER THAN +5                                     ELC50PD
  9505         GO TO 0050-CHECK-CNTL-FOUND.                             ELC50PD
  9506                                                                  ELC50PD
  9507     IF  PB-GA-BILL-DT (SUB4) = SPACES                            ELC50PD
  9508         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).        ELC50PD
  9509                                                                  ELC50PD
  9510     GO TO 0040-INITIALIZE-GA-BILL-DT.                            ELC50PD
  9511                                                                  ELC50PD
  9512 0050-CHECK-CNTL-FOUND.                                           ELC50PD
  9513                                                                  ELC50PD
  9514     IF WK-CNTL-RECORD-FOUND-SW = 'Y'                             ELC50PD
  9515        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC      ELC50PD
  9516                                         WS-AH-REM-TERM-CALC      ELC50PD
  9517                                         EC-CO-REM-TERM-CALC      ELC50PD
  9518        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD            ELC50PD
  9519        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP          ELC50PD
  9520        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM          ELC50PD
  9521                                         WS-TOL-AH-CLAIM          ELC50PD
  9522        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM           ELC50PD
  9523                                         WS-TOL-AH-PREM           ELC50PD
  9524                                         EC-CO-TOL-PREM           ELC50PD
  9525        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND         ELC50PD
  9526                                         WS-TOL-AH-REFUND         ELC50PD
  9527                                         EC-CO-TOL-REFUND         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 175
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9528        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT     ELC50PD
  9529                                         WS-AH-REFUND-OVS-AMT     ELC50PD
  9530                                         EC-CO-OVR-SHT-AMT        ELC50PD
  9531        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT       ELC50PD
  9532                                         WS-TOL-AH-PREM-PCT       ELC50PD
  9533                                         EC-CO-TOL-PREM-PCT       ELC50PD
  9534        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT     ELC50PD
  9535                                         WS-TOL-AH-REFUND-PCT     ELC50PD
  9536                                         EC-CO-TOL-REFUND-PCT     ELC50PD
  9537        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT     ELC50PD
  9538                                         WS-AH-REFUND-OVS-PCT     ELC50PD
  9539                                         EC-CO-OVR-SHT-PCT        ELC50PD
  9540        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW         ELC50PD
  9541        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW        ELC50PD
  9542        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS  ELC50PD
  9543        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM        ELC50PD
  9544        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM           ELC50PD
  9545        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM           ELC50PD
  9546        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE            ELC50PD
  9547        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR           ELC50PD
  9548        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG       ELC50PD
  9549        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG        ELC50PD
  9550        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION   ELC50PD
  9551        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END     ELC50PD
  9552                                         EC-CO-MONTH-END-DT       ELC50PD
  9553        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT        ELC50PD
  9554          GO TO 0100-READ-ACCT.                                   ELC50PD
  9555                                                                  ELC50PD
  9556     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
  9557     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
  9558     MOVE '1'                    TO CNTL-REC-TYPE.                ELC50PD
  9559     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
  9560                                                                  ELC50PD
  9561     MOVE '1' TO RC-SW-1.                                         ELC50PD
  9562     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
  9563     IF NOT CF-COMPANY-MASTER                                     ELC50PD
  9564         MOVE ZEROS             TO WK-CO-TOL-PREM                 ELC50PD
  9565                                   WK-CO-TOL-CLAIM                ELC50PD
  9566                                   WK-CO-TOL-REFUND               ELC50PD
  9567                                   WK-REFUND-OVS-AMT              ELC50PD
  9568                                   WK-REFUND-OVS-PCT              ELC50PD
  9569                                   WK-CO-TOL-PREM-PCT             ELC50PD
  9570                                   WK-CO-TOL-REFUND-PCT           ELC50PD
  9571                                   WK-DEFAULT-APR                 ELC50PD
  9572                                   WK-CO-MAX-CAP                  ELC50PD
  9573        MOVE SPACES             TO WK-CR-REM-TERM-CALC            ELC50PD
  9574                                   WK-CR-R78-METHOD               ELC50PD
  9575                                   WK-CO-REF-REJECT-SW            ELC50PD
  9576                                   WK-CO-PREM-REJECT-SW           ELC50PD
  9577                                   WK-REM-TRM-CALC-OPTION         ELC50PD
  9578                                   WK-BIRTH-DATE-INPUT            ELC50PD
  9579                                   WK-JOINT-AGE-INPUT             ELC50PD
  9580        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT              ELC50PD
  9581        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS        ELC50PD
  9582        INITIALIZE    WK-CREDIT-EDIT-CONTROLS                     ELC50PD
  9583        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW        ELC50PD
  9584          GO TO 0099-COMPANY-NOT-FOUND.                           ELC50PD
  9585                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 176
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9586     IF CF-CO-TOL-PREM-PCT NOT NUMERIC                            ELC50PD
  9587        MOVE +0                    TO CF-CO-TOL-PREM-PCT.         ELC50PD
  9588     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC                          ELC50PD
  9589        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.       ELC50PD
  9590     IF CF-CO-TOL-CAP NOT NUMERIC                                 ELC50PD
  9591        MOVE +0                    TO CF-CO-TOL-CAP.              ELC50PD
  9592     IF CF-DEFAULT-APR NOT NUMERIC                                ELC50PD
  9593        MOVE +0                    TO CF-DEFAULT-APR.             ELC50PD
  9594                                                                  ELC50PD
  9595     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.        ELC50PD
  9596     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.           ELC50PD
  9597     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.              ELC50PD
  9598     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.            ELC50PD
  9599     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.             ELC50PD
  9600     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.           ELC50PD
  9601     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.       ELC50PD
  9602     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.         ELC50PD
  9603     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.        ELC50PD
  9604     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.       ELC50PD
  9605     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.    ELC50PD
  9606     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.             ELC50PD
  9607                                                                  ELC50PD
  9608     IF CF-CO-OVR-SHT-AMT NUMERIC AND                             ELC50PD
  9609          CF-CO-OVR-SHT-AMT > +0                                  ELC50PD
  9610        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.            ELC50PD
  9611                                                                  ELC50PD
  9612     IF CF-CO-OVR-SHT-PCT NUMERIC AND                             ELC50PD
  9613          CF-CO-OVR-SHT-PCT > +0                                  ELC50PD
  9614        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.            ELC50PD
  9615                                                                  ELC50PD
  9616     IF CF-VALID-REM-TRM-OPTION                                   ELC50PD
  9617         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION    ELC50PD
  9618     ELSE                                                         ELC50PD
  9619         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.     ELC50PD
  9620                                                                  ELC50PD
  9621     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.        ELC50PD
  9622     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.         ELC50PD
  9623     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.          ELC50PD
  9624     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.    ELC50PD
  9625                                                                  ELC50PD
  9626     GO TO 0050-CHECK-CNTL-FOUND.                                 ELC50PD
  9627                                                                  ELC50PD
  9628 0099-COMPANY-NOT-FOUND.                                          ELC50PD
  9629                                                                  ELC50PD
  9630     MOVE ER-2616                TO WS-ERROR.                     ELC50PD
  9631     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
  9632                                                                  ELC50PD
  9633 0100-READ-ACCT.                                                  ELC50PD
  9634                                                                  ELC50PD
  9635     MOVE SPACES                 TO DATE-RANGE-SW.                ELC50PD
  9636                                                                  ELC50PD
  9637     IF WK-ACCT-ADDR = ZEROS                                      ELC50PD
  9638        GO TO 0102-ACCT-GETMAIN.                                  ELC50PD
  9639                                                                  ELC50PD
  9640     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.               ELC50PD
  9641     SET ERACCT-FILE-ADDRESSED   TO TRUE.                         ELC50PD
  9642     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
  9643                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 177
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9644     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9645        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9646        GO TO 0105-READ-ACCT
  9647     END-IF
  9648                                                                  ELC50PD
  9649     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9650        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9651           GO TO 0105-READ-ACCT.                                  ELC50PD
  9652                                                                  ELC50PD
  9653     IF PB-STATE NOT = SPACES                                     ELC50PD
  9654        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9655           GO TO 0105-READ-ACCT.                                  ELC50PD
  9656                                                                  ELC50PD
  9657     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9658        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9659           GO TO 0105-READ-ACCT.                                  ELC50PD
  9660                                                                  ELC50PD
  9661     MOVE 'X'                 TO DATE-RANGE-SW.                   ELC50PD
  9662                                                                  ELC50PD
  9663     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9664        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9665        GO TO 0105-READ-ACCT.                                     ELC50PD
  9666                                                                  ELC50PD
  9667     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9668        GO TO 0105-READ-ACCT.                                     ELC50PD
  9669                                                                  ELC50PD
  9670     GO TO 0180-ACCOUNT-FOUND.                                    ELC50PD
  9671                                                                  ELC50PD
  9672 0102-ACCT-GETMAIN.                                               ELC50PD
  9673     PERFORM 8560-GETMAIN THRU 8560-EXIT.                         ELC50PD
  9674     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.                 ELC50PD
  9675                                                                  ELC50PD
  9676 0105-READ-ACCT.                                                  ELC50PD
  9677     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.                 ELC50PD
  9678     MOVE PB-CARRIER             TO ACCT-CARRIER.                 ELC50PD
  9679     MOVE PB-GROUPING            TO ACCT-GROUPING.                ELC50PD
  9680     MOVE PB-STATE               TO ACCT-STATE.                   ELC50PD
  9681     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.                 ELC50PD
  9682     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.                  ELC50PD
  9683                                                                  ELC50PD
  9684     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.            ELC50PD
  9685                                                                  ELC50PD
  9686     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.         ELC50PD
  9687                                                                  ELC50PD
  9688 0110-FIND-ACCT-TOLERANCES-LOOP.                                  ELC50PD
  9689
  9690     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.             ELC50PD
  9691                                                                  ELC50PD
  9692     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9693        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9694        GO TO 0199-ACCT-NOT-FOUND
  9695     END-IF
  9696     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9697        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9698           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9699                                                                  ELC50PD
  9700     IF PB-STATE NOT = SPACES                                     ELC50PD
  9701        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 178
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9702           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9703                                                                  ELC50PD
  9704     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9705        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9706           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9707                                                                  ELC50PD
  9708     MOVE 'X'                    TO DATE-RANGE-SW.                ELC50PD
  9709                                                                  ELC50PD
  9710     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9711        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9712        GO TO 0199-ACCT-NOT-FOUND.                                ELC50PD
  9713                                                                  ELC50PD
  9714     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9715        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.                     ELC50PD
  9716                                                                  ELC50PD
  9717 0180-ACCOUNT-FOUND.                                              ELC50PD
  9718
  9719     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9720     MOVE AM-CARRIER             TO PB-SV-CARRIER.                ELC50PD
  9721     MOVE AM-STATE               TO PB-SV-STATE.                  ELC50PD
  9722     MOVE AM-GROUPING            TO PB-SV-GROUPING.               ELC50PD
  9723                                                                  ELC50PD
  9724     IF AM-CANCEL-FEE  NOT NUMERIC                                ELC50PD
  9725        MOVE ZEROS TO AM-CANCEL-FEE.                              ELC50PD
  9726                                                                  ELC50PD
  9727     IF AM-MAX-MON-BEN NOT NUMERIC                                ELC50PD
  9728        MOVE ZEROS TO AM-MAX-MON-BEN.                             ELC50PD
  9729                                                                  ELC50PD
  9730     IF AM-MAX-TOT-BEN NOT NUMERIC                                ELC50PD
  9731        MOVE ZEROS TO AM-MAX-TOT-BEN.                             ELC50PD
  9732                                                                  ELC50PD
  9733     IF AM-CLP-TOL-PCT NOT NUMERIC
  9734        MOVE +0                  TO AM-CLP-TOL-PCT
  9735     END-IF
  9736     IF AM-SPP-LEASE-COMM NOT NUMERIC
  9737        MOVE +0                  TO AM-SPP-LEASE-COMM
  9738     END-IF
  9739     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9740        MOVE ER-2611             TO   WS-ERROR                    ELC50PD
  9741        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9742                                                                  ELC50PD
  9743     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9744        MOVE ER-2621             TO   WS-ERROR                    ELC50PD
  9745        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9746                                                                  ELC50PD
  9747     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)                      ELC50PD
  9748        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)               ELC50PD
  9749        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)                    ELC50PD
  9750        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)                      ELC50PD
  9751         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.            ELC50PD
  9752                                                                  ELC50PD
  9753     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.         ELC50PD
  9754     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.           ELC50PD
  9755     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.         ELC50PD
  9756     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.           ELC50PD
  9757     IF AM-CLP-TOL-PCT NOT = ZEROS
  9758        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  9759     END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 179
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9760     IF AM-SPP-LEASE-COMM NOT = ZEROS
  9761        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  9762     END-IF
  9763
  9764
  9765
  9766
  9767*    IF PB-COMPANY-ID = 'DCC'
  9768*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  9769*                                   WS-ADMIN-FEES
  9770*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  9771*          (SUB5 > +10)
  9772*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9773*             AND (AM-A-COM (SUB5) NUMERIC)
  9774*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9775*                + (AM-A-COM (SUB5) * 1000)
  9776*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  9777*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  9778*                + (AM-A-COM (SUB5) * 1000)
  9779*             END-IF
  9780*             IF AM-COM-TYP (SUB5) = 'N'
  9781*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  9782*                + (AM-A-COM (SUB5) * 1000)
  9783*             END-IF
  9784*          END-IF
  9785*       END-PERFORM
  9786*    END-IF
  9787
  9788     IF (PB-COMPANY-ID = 'DCC')
  9789        AND (PB-ISSUE)
  9790        MOVE +0                  TO WS-ACCT-ADDL-CLP
  9791        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  9792           (SUB5 > +10)
  9793           MOVE +0 TO WS-WK-RATE
  9794           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9795              IF (AM-A-COM (SUB5) NUMERIC)
  9796                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  9797                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  9798              ELSE
  9799                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  9800                 IF PB-ISSUE
  9801                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9802                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  9803                 ELSE
  9804                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9805                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  9806                 END-IF
  9807                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  9808                 MOVE ZEROS             TO WS-SUB1
  9809                                           WS-COMMISSION
  9810                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  9811                 MOVE '0530'               TO CTBL-SW
  9812                 MOVE ' '                  TO WS-CTBL-READ-SW
  9813                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9814                 IF FIRST-TIME-THROUGH
  9815                    MOVE 'AA'              TO CTBL-BEN-CODE
  9816                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9817                 END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 180
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9818                 IF CTBL-TABLE-FOUND
  9819                    IF PB-ISSUE
  9820                       COMPUTE WS-COMM-CK-AMT =
  9821                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9822                    ELSE
  9823                       COMPUTE WS-COMM-CK-AMT =
  9824                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9825                    END-IF
  9826                    PERFORM 8800-GET-COMP-RATE
  9827                              THRU 8800-EXIT
  9828                 END-IF
  9829              END-IF
  9830              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9831                + (WS-WK-RATE * 1000)
  9832           END-IF
  9833        END-PERFORM
  9834     END-IF
  9835
  9836     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
  9837         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.           ELC50PD
  9838                                                                  ELC50PD
  9839     IF PB-COMPANY-ID EQUAL 'NCL'                                 ELC50PD
  9840         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  9841     END-IF
  9842                                                                  ELC50PD
  9843     GO TO 0200-READ-CERT.                                        ELC50PD
  9844                                                                  ELC50PD
  9845 0199-ACCT-NOT-FOUND.                                             ELC50PD
  9846                                                                  ELC50PD
  9847     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9848                                                                  ELC50PD
  9849     IF DATE-RANGE-SW NOT = SPACES                                ELC50PD
  9850        MOVE ER-2601             TO WS-ERROR                      ELC50PD
  9851        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9852     ELSE                                                         ELC50PD
  9853        MOVE ER-2619             TO WS-ERROR                      ELC50PD
  9854        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9855                                                                  ELC50PD
  9856     GO TO 9990-RETURN.                                           ELC50PD
  9857                                                                  ELC50PD
  9858 0200-READ-CERT.                                                  ELC50PD
  9859                                                                  ELC50PD
  9860     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.                 ELC50PD
  9861     MOVE PB-SV-CARRIER          TO CERT-CARRIER.                 ELC50PD
  9862     MOVE PB-SV-GROUPING         TO CERT-GROUPING.                ELC50PD
  9863     MOVE PB-SV-STATE            TO CERT-STATE.                   ELC50PD
  9864     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.                 ELC50PD
  9865     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.                  ELC50PD
  9866     MOVE PB-CERT-NO             TO CERT-CERT-NO.                 ELC50PD
  9867                                                                  ELC50PD
  9868     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.                ELC50PD
  9869                                                                  ELC50PD
  9870     IF CERT-WAS-NOT-FOUND                                        ELC50PD
  9871        GO TO 0299-CERT-NOT-FOUND.                                ELC50PD
  9872                                                                  ELC50PD
  9873     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION            ELC50PD
  9874        MOVE ER-2759             TO WS-ERROR                      ELC50PD
  9875        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 181
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9876        GO TO 0298-UNLOCK-RETURN.                                 ELC50PD
  9877                                                                  ELC50PD
  9878     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION                   ELC50PD
  9879         MOVE ER-2758            TO WS-ERROR                      ELC50PD
  9880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
  9881         GO TO 0298-UNLOCK-RETURN.                                ELC50PD
  9882                                                                  ELC50PD
  9883     IF PB-ISSUE                                                  ELC50PD
  9884        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')           ELC50PD
  9885           IF CERT-WAS-CREATED-FOR-CLAIM                          ELC50PD
  9886              NEXT SENTENCE                                       ELC50PD
  9887            ELSE                                                  ELC50PD
  9888              MOVE ER-2626       TO WS-ERROR                      ELC50PD
  9889              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
  9890              GO TO 0298-UNLOCK-RETURN.                           ELC50PD
  9891                                                                  ELC50PD
  9892     IF NOT PB-CANCELLATION                                       ELC50PD
  9893        GO TO 0300-CONTINUE-EDIT.                                 ELC50PD
  9894                                                                  ELC50PD
  9895     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.             ELC50PD
  9896     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.              ELC50PD
  9897     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  9898     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.           ELC50PD
  9899     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.           ELC50PD
  9900     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.            ELC50PD
  9901                                                                  ELC50PD
  9902     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.               ELC50PD
  9903     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.         ELC50PD
  9904     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.        ELC50PD
  9905     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.        ELC50PD
  9906     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.    ELC50PD
  9907     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.    ELC50PD
  9908     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.           ELC50PD
  9909     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.           ELC50PD
  9910     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.       ELC50PD
  9911                                                                  ELC50PD
  9912     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.               ELC50PD
  9913     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.         ELC50PD
  9914     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.        ELC50PD
  9915     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.        ELC50PD
  9916     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.           ELC50PD
  9917     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.           ELC50PD
  9918     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.       ELC50PD
  9919                                                                  ELC50PD
  9920     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.            ELC50PD
  9921     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.               ELC50PD
  9922                                                                  ELC50PD
  9923     MOVE CM-CREDIT-INTERFACE-SW-1                                ELC50PD
  9924                                  TO PB-CI-CREDIT-INTERFACE-SW-1. ELC50PD
  9925     MOVE CM-CREDIT-INTERFACE-SW-2                                ELC50PD
  9926                                  TO PB-CI-CREDIT-INTERFACE-SW-2. ELC50PD
  9927                                                                  ELC50PD
  9928     IF CM-O-B-COVERAGE                                           ELC50PD
  9929         MOVE 'B'                 TO PB-CI-OB-FLAG.               ELC50PD
  9930                                                                  ELC50PD
  9931     IF CM-LIVES NOT NUMERIC                                      ELC50PD
  9932         MOVE ZERO                TO CM-LIVES.                    ELC50PD
  9933                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 182
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9934     IF CM-BILLED NOT NUMERIC                                     ELC50PD
  9935         MOVE ZERO                TO CM-BILLED.                   ELC50PD
  9936                                                                  ELC50PD
  9937     IF CM-CREDIT-INTERFACE-SW-2 = SPACE                          ELC50PD
  9938         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS      ELC50PD
  9939         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS      ELC50PD
  9940         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT    ELC50PD
  9941         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT    ELC50PD
  9942         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT         ELC50PD
  9943         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.        ELC50PD
  9944         MOVE CM-LIVES             TO PB-CI-LIVES                 ELC50PD
  9945*The next line causes a problem with my change  I dont think it is needed
  9946*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.     ELC50PD
  9947                                                                  ELC50PD
  9948     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.      ELC50PD
  9949     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.      ELC50PD
  9950     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.      ELC50PD
  9951     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.      ELC50PD
  9952     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.         ELC50PD
  9953     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.         ELC50PD
  9954                                                                  ELC50PD
  9955     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.             ELC50PD
  9956     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.             ELC50PD
  9957     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.     ELC50PD
  9958     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.      ELC50PD
  9959                                                                  ELC50PD
  9960     IF CM-LIFE-COMM-PCT NUMERIC                                  ELC50PD
  9961         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION         ELC50PD
  9962     ELSE                                                         ELC50PD
  9963         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.        ELC50PD
  9964                                                                  ELC50PD
  9965     IF CM-AH-COMM-PCT NUMERIC                                    ELC50PD
  9966         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION           ELC50PD
  9967     ELSE                                                         ELC50PD
  9968         MOVE ZEROS              TO PB-CI-AH-COMMISSION.          ELC50PD
  9969                                                                  ELC50PD
  9970     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.         ELC50PD
  9971                                                                  ELC50PD
  9972     IF CM-LOAN-APR       NOT NUMERIC                             ELC50PD
  9973           MOVE ZERO               TO CM-LOAN-APR.                ELC50PD
  9974                                                                  ELC50PD
  9975     IF CM-PAY-FREQUENCY  NOT NUMERIC                             ELC50PD
  9976           MOVE ZERO               TO CM-PAY-FREQUENCY.           ELC50PD
  9977                                                                  ELC50PD
  9978     IF CM-LOAN-TERM      NOT NUMERIC                             ELC50PD
  9979           MOVE ZERO               TO CM-LOAN-TERM.               ELC50PD
  9980                                                                  ELC50PD
  9981     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC                          ELC50PD
  9982           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.         ELC50PD
  9983                                                                  ELC50PD
  9984     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC                        ELC50PD
  9985           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.      ELC50PD
  9986                                                                  ELC50PD
  9987     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.        ELC50PD
  9988     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.             ELC50PD
  9989     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.            ELC50PD
  9990     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.         ELC50PD
  9991     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 183
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9992     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.         ELC50PD
  9993     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.         ELC50PD
  9994     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.      ELC50PD
  9995     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.             ELC50PD
  9996     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.          ELC50PD
  9997     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.         ELC50PD
  9998     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD           ELC50PD
  9999                                                                  ELC50PD
 10000     IF CM-STATE = CM-SSN-STATE                                   ELC50PD
 10001         MOVE SPACES               TO PB-CI-SOC-SEC-NO.           ELC50PD
 10002                                                                  ELC50PD
 10003     IF CM-STATE NOT = CM-MEMB-STATE                              ELC50PD
 10004         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.            ELC50PD
 10005                                                                  ELC50PD
 10006     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.         ELC50PD
 10007                                                                  ELC50PD
 10008     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
 10009        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
 10010        IF CM-ADDL-CLP NOT NUMERIC
 10011           MOVE +0               TO CM-ADDL-CLP
 10012        END-IF
 10013        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
 10014        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10015           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
 10016        END-IF
 10017     END-IF
 10018
 10019     IF PB-COMPANY-ID = 'DCC'
 10020        MOVE +0                  TO WS-ADMIN-FEES
 10021                                    WS-CSO-ADMIN-FEE
 10022                                    WS-COMM-AND-MFEE
 10023                                    WS-1ST-YR-ALLOW
 10024        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
 10025           (SUB5 > +10)
 10026           MOVE +0 TO WS-WK-RATE
 10027           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
 10028              IF (AM-A-COM (SUB5) NUMERIC)
 10029                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
 10030                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
 10031              ELSE
 10032                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
 10033                 IF PB-ISSUE
 10034                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10035                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10036                 ELSE
 10037                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10038                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
 10039                 END-IF
 10040                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10041                 MOVE ZEROS             TO WS-SUB1
 10042                                           WS-COMMISSION
 10043                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
 10044                 MOVE '0530'               TO CTBL-SW
 10045                 MOVE ' '                  TO WS-CTBL-READ-SW
 10046                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10047                 IF FIRST-TIME-THROUGH
 10048                    MOVE 'AA'              TO CTBL-BEN-CODE
 10049                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 184
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10050                 END-IF
 10051                 IF CTBL-TABLE-FOUND
 10052                    IF PB-ISSUE
 10053                       COMPUTE WS-COMM-CK-AMT =
 10054                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
 10055                    ELSE
 10056                       COMPUTE WS-COMM-CK-AMT =
 10057                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
 10058                    END-IF
 10059                    PERFORM 8800-GET-COMP-RATE
 10060                              THRU 8800-EXIT
 10061                 END-IF
 10062              END-IF
 10063              IF AM-COM-TYP (SUB5) = 'I'
 10064                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 10065                   + (WS-WK-RATE * 1000)
 10066              END-IF
 10067              IF AM-COM-TYP (SUB5) = 'N'
 10068                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
 10069                   + (WS-WK-RATE * 1000)
 10070              END-IF
 10071              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
 10072                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
 10073                   + (WS-WK-RATE * 1000)
 10074              END-IF
 10075              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
 10076                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 10077                   + (WS-WK-RATE * 1000)
 10078              END-IF
 10079           END-IF
 10080        END-PERFORM
 10081     END-IF
 10082
 10083     GO TO 0300-CONTINUE-EDIT.                                    ELC50PD
 10084                                                                  ELC50PD
 10085 0298-UNLOCK-RETURN.                                              ELC50PD
 10086      PERFORM 9250-UNLOCK-RETURN                                  ELC50PD
 10087      GO TO 9990-RETURN.                                          ELC50PD
 10088                                                                  ELC50PD
 10089 0299-CERT-NOT-FOUND.                                             ELC50PD
 10090                                                                  ELC50PD
 10091     MOVE '1'                     TO CERT-STATUS-SW.              ELC50PD
 10092                                                                  ELC50PD
 10093     IF PB-COMPANY-ID = 'UCL'                                     ELC50PD
 10094         IF WS-ERROR = ER-2799                                    ELC50PD
 10095             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 10096                                                                  ELC50PD
 10097     IF NOT PB-CANCELLATION                                       ELC50PD
 10098         GO TO 0300-CONTINUE-EDIT.                                ELC50PD
 10099                                                                  ELC50PD
 10100     MOVE ER-2726                  TO  WS-ERROR.                  ELC50PD
 10101     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.                ELC50PD
 10102     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.        ELC50PD
 10103     MOVE ZEROS                  TO PB-CI-INSURED-AGE             ELC50PD
 10104                                    PB-CI-LF-TERM                 ELC50PD
 10105                                    PB-C-LF-REM-TERM              ELC50PD
 10106                                    PB-CI-AH-TERM                 ELC50PD
 10107                                    PB-C-AH-REM-TERM              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 185
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10108                                    PB-CI-LF-BENEFIT-CD           ELC50PD
 10109                                    PB-CI-LF-BENEFIT-AMT          ELC50PD
 10110                                    PB-CI-LF-ALT-BENEFIT-AMT      ELC50PD
 10111                                    PB-CI-LF-PREMIUM-AMT          ELC50PD
 10112                                    PB-CI-LF-ALT-PREMIUM-AMT      ELC50PD
 10113                                    PB-CI-AH-BENEFIT-CD           ELC50PD
 10114                                    PB-CI-AH-BENEFIT-AMT          ELC50PD
 10115                                    PB-CI-AH-PREMIUM-AMT          ELC50PD
 10116                                    PB-CI-PAY-FREQUENCY           ELC50PD
 10117                                    PB-CI-LOAN-APR                ELC50PD
 10118                                    PB-CI-LOAN-TERM               ELC50PD
 10119                                    PB-CI-LIFE-COMMISSION         ELC50PD
 10120                                    PB-CI-AH-COMMISSION           ELC50PD
 10121                                    PB-CI-CURR-SEQ                ELC50PD
 10122                                    PB-CI-AH-CANCEL-AMT           ELC50PD
 10123                                    PB-CI-LF-CANCEL-AMT           ELC50PD
 10124                                    PB-CI-RATE-DEV-PCT-LF         ELC50PD
 10125                                    PB-CI-RATE-DEV-PCT-AH         ELC50PD
 10126                                    PB-CI-EXTENTION-DAYS          ELC50PD
 10127                                    PB-CI-TERM-IN-DAYS            ELC50PD
 10128                                    PB-CI-LIVES                   ELC50PD
 10129                                    PB-CI-LF-CRIT-PER             ELC50PD
 10130                                    PB-CI-AH-CRIT-PER
 10131                                    PB-CI-ADDL-CLP
 10132                                    PB-CI-DDF-IU-RATE-UP.
 10133                                                                  ELC50PD
 10134     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT         ELC50PD
 10135                                    PB-CI-AH-SETTLEMENT-DT        ELC50PD
 10136                                    PB-CI-DEATH-DT                ELC50PD
 10137                                    PB-CI-LF-PRIOR-CANCEL-DT      ELC50PD
 10138                                    PB-CI-AH-PRIOR-CANCEL-DT      ELC50PD
 10139                                    PB-CI-ENTRY-DT                ELC50PD
 10140                                    PB-CI-LF-EXPIRE-DT            ELC50PD
 10141                                    PB-CI-AH-EXPIRE-DT            ELC50PD
 10142                                    PB-CI-LOAN-1ST-PMT-DT.        ELC50PD
 10143                                                                  ELC50PD
 10144     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 10145        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT               ELC50PD
 10146        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.              ELC50PD
 10147                                                                  ELC50PD
 10148     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 10149                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 186
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10151                                                                  ELC50PD
 10152 0300-CONTINUE-EDIT.                                              ELC50PD
 10153                                                                  ELC50PD
 10154     IF PB-ISSUE                                                  ELC50PD
 10155        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10156            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.       ELC50PD
 10157                                                                  ELC50PD
 10158     IF PB-ISSUE                                                  ELC50PD
 10159        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10160            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.       ELC50PD
 10161                                                                  ELC50PD
 10162     IF PB-ISSUE                                                  ELC50PD
 10163       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR                     ELC50PD
 10164          (AM-NO-AH-ONLY)                                         ELC50PD
 10165           IF PB-I-AH-BENEFIT-CD NOT = ZEROS                      ELC50PD
 10166               IF PB-I-LIFE-BENEFIT-CD = ZEROS                    ELC50PD
 10167                   MOVE ER-2679 TO WS-ERROR                       ELC50PD
 10168                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 10169                                                                  ELC50PD
 10170     IF PB-ISSUE                                                  ELC50PD
 10171        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD            ELC50PD
 10172        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD            ELC50PD
 10173        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT              ELC50PD
 10174     ELSE                                                         ELC50PD
 10175        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD            ELC50PD
 10176        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD            ELC50PD
 10177        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.             ELC50PD
 10178                                                                  ELC50PD
 10179     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10180                                    PLAN-MASTER-LIFE-SW           ELC50PD
 10181                                    FORM-MASTER-SW                ELC50PD
 10182                                    WS-APP-CERT-SW.               ELC50PD
 10183                                                                  ELC50PD
 10184     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM             ELC50PD
 10185                                    WS-PL-TOL-LF-REFUND           ELC50PD
 10186                                    WS-PL-REF-OVS-AMT             ELC50PD
 10187                                    WS-PL-TOL-LF-PREM-PCT         ELC50PD
 10188                                    WS-PL-TOL-LF-REFUND-PCT       ELC50PD
 10189                                    WS-PL-REF-OVS-PCT             ELC50PD
 10190                                    WS-PL-TOL-LF-CLAIM.           ELC50PD
 10191                                                                  ELC50PD
 10192     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10193       IF PB-ISSUE                                                ELC50PD
 10194         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS          ELC50PD
 10195             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT           ELC50PD
 10196             IF FORM-MASTER-FOUND                                 ELC50PD
 10197                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.       ELC50PD
 10198                                                                  ELC50PD
 10199     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10200        GO TO 0310-FIND-AH-BENEFIT-RECORD.                        ELC50PD
 10201                                                                  ELC50PD
 10202********************** MON CODE **********************            ELC50PD
 10203     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 10204     IF PB-ISSUE                                                  ELC50PD
 10205     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26') ELC50PD
 10206        AND (PB-I-LOAN-APR NOT NUMERIC OR                         ELC50PD
 10207             PB-I-LOAN-APR = ZERO)                                ELC50PD
 10208               MOVE 14.0         TO PB-I-LOAN-APR.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 187
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10209******************************************************            ELC50PD
 10210                                                                  ELC50PD
 10211     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10212       IF PB-ISSUE                                                ELC50PD
 10213           IF FORM-MASTER-FOUND                                   ELC50PD
 10214             IF FO-DISMEMBERMENT-CD = 'Y'  AND                    ELC50PD
 10215                AM-DISMBR-COVERAGE                                ELC50PD
 10216                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD         ELC50PD
 10217                 IF WS-LF-INPUT-CD-1 NOT = 'B'                    ELC50PD
 10218                   MOVE '8'            TO  WS-LF-INPUT-CD-1       ELC50PD
 10219                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD       ELC50PD
 10220                                           PB-I-LIFE-BENEFIT-CD.  ELC50PD
 10221                                                                  ELC50PD
 10222     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10223                                                                  ELC50PD
 10224     IF WK-LIFE-BEN-ADDR NOT = ZEROS                              ELC50PD
 10225         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 10226         SET ELCNTL-FILE-ADDRESSED   TO TRUE                      ELC50PD
 10227         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10228         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT          ELC50PD
 10229         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10230           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10231             GO TO 0301-LIFE-BENEFIT-SEARCH                       ELC50PD
 10232         ELSE                                                     ELC50PD
 10233             NEXT SENTENCE                                        ELC50PD
 10234     ELSE                                                         ELC50PD
 10235         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10236                                                                  ELC50PD
 10237     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10238     MOVE '4'                    TO CNTL-REC-TYPE.                ELC50PD
 10239     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10240     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10241                                                                  ELC50PD
 10242     MOVE '1' TO RC-SW-2.                                         ELC50PD
 10243     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10244                                                                  ELC50PD
 10245     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10246        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10247         GO TO 0305-BENEFIT-NOT-FOUND.                            ELC50PD
 10248                                                                  ELC50PD
 10249     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.             ELC50PD
 10250                                                                  ELC50PD
 10251 0301-LIFE-BENEFIT-SEARCH.                                        ELC50PD
 10252                                                                  ELC50PD
 10253     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10254                                                                  ELC50PD
 10255     IF NO-BENEFIT-FOUND                                          ELC50PD
 10256        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10257                                                                  ELC50PD
 10258     IF WS-BEN-CD = '99'                                          ELC50PD
 10259        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10260                                                                  ELC50PD
 10261     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10262         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10263             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10264                                                                  ELC50PD
 10265     MOVE +1                     TO SUB5.                         ELC50PD
 10266     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 188
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10267                                                                  ELC50PD
 10268* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10269* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10270     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10271         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10272                                                                  ELC50PD
 10273 0302-EDIT-ACCT-LF-BENEFITS.                                      ELC50PD
 10274                                                                  ELC50PD
 10275     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1          ELC50PD
 10276        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)                 ELC50PD
 10277           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10278                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10279           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10280                                                                  ELC50PD
 10281     IF SUB5 LESS THAN +20                                        ELC50PD
 10282        ADD +1                   TO SUB5                          ELC50PD
 10283        GO TO 0302-EDIT-ACCT-LF-BENEFITS.                         ELC50PD
 10284                                                                  ELC50PD
 10285     MOVE +1                     TO SUB5.                         ELC50PD
 10286                                                                  ELC50PD
 10287     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10288        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10289                                                                  ELC50PD
 10290 0303-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10291                                                                  ELC50PD
 10292     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1      ELC50PD
 10293        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)             ELC50PD
 10294           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10295                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10296           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10297                                                                  ELC50PD
 10298     IF SUB5 LESS THAN +30                                        ELC50PD
 10299        ADD +1                   TO SUB5                          ELC50PD
 10300        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10301                                                                  ELC50PD
 10302     MOVE +1                     TO SUB5.                         ELC50PD
 10303                                                                  ELC50PD
 10304 03XX-EDIT-FOR-NINETY-LF.                                         ELC50PD
 10305                                                                  ELC50PD
 10306***************************************************************   ELC50PD
 10307*                                                             *   ELC50PD
 10308*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10309*                                                             *   ELC50PD
 10310*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10311*      92 = ALL GROUP REDUCING BENEFITS                       *   ELC50PD
 10312*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *   ELC50PD
 10313*      94 = ALL GROUP LEVEL BENEFITS                          *   ELC50PD
 10314*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10315*           BENEFIT CONTROLS.                                 *   ELC50PD
 10316*      99 = ALL BENEFITS                                      *   ELC50PD
 10317*                                                             *   ELC50PD
 10318***************************************************************   ELC50PD
 10319                                                                  ELC50PD
 10320     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10321                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10322                                                                  ELC50PD
 10323     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10324       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 189
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10325        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10326        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10327                                                                  ELC50PD
 10328     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')                       ELC50PD
 10329       AND                                                        ELC50PD
 10330        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10331        IF CF-REDUCING (SUB3)                                     ELC50PD
 10332           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10333              OR                                                  ELC50PD
 10334           ((AM-IG = '1') AND                                     ELC50PD
 10335           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10336              OR                                                  ELC50PD
 10337           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10338           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10339           (AM-IG NOT = '2'))                                     ELC50PD
 10340              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10341                                                                  ELC50PD
 10342     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')                       ELC50PD
 10343       AND                                                        ELC50PD
 10344        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10345        IF CF-REDUCING (SUB3)                                     ELC50PD
 10346           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10347              OR                                                  ELC50PD
 10348           ((AM-IG = '2') AND                                     ELC50PD
 10349           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10350              OR                                                  ELC50PD
 10351           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10352           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10353           (AM-IG NOT = '1'))                                     ELC50PD
 10354              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10355                                                                  ELC50PD
 10356     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')                       ELC50PD
 10357       AND                                                        ELC50PD
 10358        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10359        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10360           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10361              OR                                                  ELC50PD
 10362           ((AM-IG = '1') AND                                     ELC50PD
 10363           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10364              OR                                                  ELC50PD
 10365           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10366           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10367            (AM-IG NOT = '2'))                                    ELC50PD
 10368              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10369                                                                  ELC50PD
 10370     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')                       ELC50PD
 10371       AND                                                        ELC50PD
 10372        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10373        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10374           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10375              OR                                                  ELC50PD
 10376           ((AM-IG = '2') AND                                     ELC50PD
 10377           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10378              OR                                                  ELC50PD
 10379           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10380           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10381           (AM-IG NOT = '1'))                                     ELC50PD
 10382              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 190
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10383                                                                  ELC50PD
 10384     IF SUB5 LESS THAN +20                                        ELC50PD
 10385        ADD +1                   TO SUB5                          ELC50PD
 10386        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10387                                                                  ELC50PD
 10388     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10389                                                                  ELC50PD
 10390     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10391        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.                       ELC50PD
 10392                                                                  ELC50PD
 10393     MOVE +1                     TO SUB5.                         ELC50PD
 10394                                                                  ELC50PD
 10395 03XX-EDIT-DMD-EXTRA-NINETY-LF.                                   ELC50PD
 10396                                                                  ELC50PD
 10397     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10398                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10399                                                                  ELC50PD
 10400     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10401       AND                                                        ELC50PD
 10402        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10403        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10404                                                                  ELC50PD
 10405     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')                   ELC50PD
 10406       AND                                                        ELC50PD
 10407        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10408        IF CF-REDUCING (SUB3)                                     ELC50PD
 10409           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10410              OR                                                  ELC50PD
 10411           ((AM-IG = '1') AND                                     ELC50PD
 10412           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10413              OR                                                  ELC50PD
 10414           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10415           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10416           (AM-IG NOT = '2'))                                     ELC50PD
 10417              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10418                                                                  ELC50PD
 10419     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')                   ELC50PD
 10420       AND                                                        ELC50PD
 10421        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10422        IF CF-REDUCING (SUB3)                                     ELC50PD
 10423           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10424              OR                                                  ELC50PD
 10425           ((AM-IG = '2') AND                                     ELC50PD
 10426           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10427              OR                                                  ELC50PD
 10428           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10429           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10430           (AM-IG NOT = '1'))                                     ELC50PD
 10431              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10432                                                                  ELC50PD
 10433     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')                   ELC50PD
 10434       AND                                                        ELC50PD
 10435        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10436        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10437           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10438              OR                                                  ELC50PD
 10439           ((AM-IG = '1') AND                                     ELC50PD
 10440           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 191
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10441              OR                                                  ELC50PD
 10442           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10443           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10444            (AM-IG NOT = '2'))                                    ELC50PD
 10445              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10446                                                                  ELC50PD
 10447     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')                   ELC50PD
 10448       AND                                                        ELC50PD
 10449        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10450        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10451           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10452              OR                                                  ELC50PD
 10453           ((AM-IG = '2') AND                                     ELC50PD
 10454           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10455              OR                                                  ELC50PD
 10456           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10457           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10458           (AM-IG NOT = '1'))                                     ELC50PD
 10459              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10460                                                                  ELC50PD
 10461     IF SUB5 LESS THAN +30                                        ELC50PD
 10462        ADD +1                   TO SUB5                          ELC50PD
 10463        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.                      ELC50PD
 10464                                                                  ELC50PD
 10465     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10466                                                                  ELC50PD
 10467 03XX-EDIT-FOR-NINETY-LF-CONT.                                    ELC50PD
 10468                                                                  ELC50PD
 10469     MOVE +99                    TO SUB5.                         ELC50PD
 10470                                                                  ELC50PD
 10471     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10472        IF PB-ISSUE                                               ELC50PD
 10473           MOVE ER-1924          TO  WS-ERROR                     ELC50PD
 10474           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10475                                                                  ELC50PD
 10476     GO TO 0304-LIFE-BENEFIT-FOUND.                               ELC50PD
 10477                                                                  ELC50PD
 10478 03XX-GET-LIFE-ERPLAN.                                            ELC50PD
 10479                                                                  ELC50PD
 10480     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10481        GO TO 03XX-ERPLAN-LIFE-GETMAIN.                           ELC50PD
 10482                                                                  ELC50PD
 10483     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10484     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10485     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10486     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 10487     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10488                                    PLAN-MASTER-LIFE-SW.          ELC50PD
 10489     GO TO XXXX-CHECK-LF-PLAN-KEY.                                ELC50PD
 10490                                                                  ELC50PD
 10491 03XX-ERPLAN-LIFE-GETMAIN.                                        ELC50PD
 10492                                                                  ELC50PD
 10493     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10494     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10495                                                                  ELC50PD
 10496 03XX-ERPLAN-LIFE-READ.                                           ELC50PD
 10497                                                                  ELC50PD
 10498     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 192
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10499     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10500     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10501     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10502     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10503     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.            ELC50PD
 10504     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10505     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10506                                 TO PLAN-REVISION-NO.             ELC50PD
 10507                                                                  ELC50PD
 10508     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10509     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.          ELC50PD
 10510                                                                  ELC50PD
 10511     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10512       IF NOT LF-PLAN-MASTER-FOUND                                ELC50PD
 10513         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10514            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10515             MOVE  ER-1921         TO  WS-ERROR                   ELC50PD
 10516             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10517             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10518                                                                  ELC50PD
 10519     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 10520        GO TO 0304-LIFE-BENEFIT-FOUND.                            ELC50PD
 10521                                                                  ELC50PD
 10522 XXXX-CHECK-LF-PLAN-KEY.                                          ELC50PD
 10523                                                                  ELC50PD
 10524     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10525        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10526        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10527        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10528        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10529        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR        ELC50PD
 10530        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10531        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10532        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10533          GO TO 03XX-ERPLAN-LIFE-READ.                            ELC50PD
 10534                                                                  ELC50PD
 10535     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.          ELC50PD
 10536                                                                  ELC50PD
 10537     IF  PB-CANCELLATION                                          ELC50PD
 10538         GO TO  0303-LF-ACCT-BEN-FOUND.                           ELC50PD
 10539                                                                  ELC50PD
 10540     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10541        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND        ELC50PD
 10542           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)       ELC50PD
 10543           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO        ELC50PD
 10544              MOVE ER-2644             TO WS-ERROR                ELC50PD
 10545              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10546           ELSE                                                   ELC50PD
 10547              NEXT SENTENCE                                       ELC50PD
 10548        ELSE                                                      ELC50PD
 10549           IF PB-COMPANY-ID NOT = 'NCL'                           ELC50PD
 10550              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS          ELC50PD
 10551                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.    ELC50PD
 10552                                                                  ELC50PD
 10553 0303-LF-ACCT-BEN-FOUND.                                          ELC50PD
 10554                                                                  ELC50PD
 10555     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.             ELC50PD
 10556                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 193
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10557     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10558        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.         ELC50PD
 10559                                                                  ELC50PD
 10560     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10561        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10562        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.           ELC50PD
 10563                                                                  ELC50PD
 10564     IF PL-TOL-PREM-AMT GREATER THAN +0                           ELC50PD
 10565        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.            ELC50PD
 10566                                                                  ELC50PD
 10567     IF PL-TOL-REF-AMT GREATER THAN +0                            ELC50PD
 10568        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.          ELC50PD
 10569                                                                  ELC50PD
 10570     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10571        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.        ELC50PD
 10572                                                                  ELC50PD
 10573     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10574        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.      ELC50PD
 10575                                                                  ELC50PD
 10576     IF PL-TOL-CLM-AMT GREATER THAN +0                            ELC50PD
 10577        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.           ELC50PD
 10578                                                                  ELC50PD
 10579     IF PL-OVER-SHORT-AMT NUMERIC  AND                            ELC50PD
 10580                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10581        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.            ELC50PD
 10582                                                                  ELC50PD
 10583     IF PL-OVER-SHORT-PCT NUMERIC  AND                            ELC50PD
 10584                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10585        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.            ELC50PD
 10586                                                                  ELC50PD
 10587     IF PL-SALES-TAX NUMERIC AND                                  ELC50PD
 10588                          PL-SALES-TAX > +0                       ELC50PD
 10589         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.              ELC50PD
 10590                                                                  ELC50PD
 10591     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10592        MOVE PL-IG               TO WS-IG-OVRD-LF-PL              ELC50PD
 10593                                    WS-IG-OVRD-AM.                ELC50PD
 10594                                                                  ELC50PD
 10595 0304-LIFE-BENEFIT-FOUND.                                         ELC50PD
 10596                                                                  ELC50PD
 10597     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.     ELC50PD
 10598                                                                  ELC50PD
 10599     IF PB-ISSUE                                                  ELC50PD
 10600        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR             ELC50PD
 10601     ELSE                                                         ELC50PD
 10602        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.           ELC50PD
 10603                                                                  ELC50PD
 10604     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.     ELC50PD
 10605     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.   ELC50PD
 10606     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.   ELC50PD
 10607     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.       ELC50PD
 10608     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC      ELC50PD
 10609                                         WS-LF-REFUND-CALC.       ELC50PD
 10610                                                                  ELC50PD
 10611     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 10612        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.    ELC50PD
 10613                                                                  ELC50PD
 10614     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 194
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10615        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.  ELC50PD
 10616
 10617     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
 10618                                                                  ELC50PD
 10619     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.  ELC50PD
 10620     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.ELC50PD
 10621     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.     ELC50PD
 10622     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.  ELC50PD
 10623     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.    ELC50PD
 10624     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10625                                                                  ELC50PD
 10626     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 10627        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 10628         NEXT SENTENCE                                            ELC50PD
 10629     ELSE                                                         ELC50PD
 10630         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 10631            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'              ELC50PD
 10632               MOVE WS-SAVE-BENEFIT-REM-TERM                      ELC50PD
 10633                                      TO WS-AM-LF-BENE-REM-TERM   ELC50PD
 10634                                         EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10635                                                                  ELC50PD
 10636     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.        ELC50PD
 10637     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.           ELC50PD
 10638                                                                  ELC50PD
 10639     GO TO 0310-FIND-AH-BENEFIT-RECORD.                           ELC50PD
 10640                                                                  ELC50PD
 10641 0305-BENEFIT-NOT-FOUND.                                          ELC50PD
 10642                                                                  ELC50PD
 10643     MOVE '1'                    TO LF-BENEFIT-ERROR.             ELC50PD
 10644     MOVE ER-2604                TO WS-ERROR.                     ELC50PD
 10645     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 10646                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 195
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10648                                                                  ELC50PD
 10649 0310-FIND-AH-BENEFIT-RECORD.                                     ELC50PD
 10650                                                                  ELC50PD
 10651     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10652                                    PLAN-MASTER-AH-SW.            ELC50PD
 10653                                                                  ELC50PD
 10654     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM             ELC50PD
 10655                                    WS-PL-TOL-AH-REFUND           ELC50PD
 10656                                    WS-AH-PL-REF-OVS-AMT          ELC50PD
 10657                                    WS-PL-TOL-AH-PREM-PCT         ELC50PD
 10658                                    WS-PL-TOL-AH-REFUND-PCT       ELC50PD
 10659                                    WS-AH-PL-REF-OVS-PCT          ELC50PD
 10660                                    WS-PL-TOL-AH-CLAIM.           ELC50PD
 10661     MOVE ' '                    TO WS-AH-DCC-TRUNC
 10662                                                                  ELC50PD
 10663                                                                  ELC50PD
 10664     if pb-issue
 10665        IF PB-I-AH-INPUT-CD EQUAL ZEROS
 10666           MOVE SPACES              TO PB-I-AH-INPUT-CD
 10667        end-if
 10668        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
 10669           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
 10670           GO TO 0399-BENEFIT-NOT-FOUND
 10671        end-if
 10672     end-if
 10673                                                                  ELC50PD
 10674     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10675        GO TO 0400-FIND-CARRIER.                                  ELC50PD
 10676                                                                  ELC50PD
 10677     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10678                                                                  ELC50PD
 10679     IF WK-AH-BEN-ADDR NOT = ZEROS                                ELC50PD
 10680         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 10681         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 10682         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10683         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10684           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10685             GO TO 0311-AH-BENEFIT-SEARCH                         ELC50PD
 10686         ELSE                                                     ELC50PD
 10687             NEXT SENTENCE                                        ELC50PD
 10688     ELSE                                                         ELC50PD
 10689         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10690                                                                  ELC50PD
 10691     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10692     MOVE '5'                    TO CNTL-REC-TYPE.                ELC50PD
 10693     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10694     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10695                                                                  ELC50PD
 10696     MOVE '2' TO RC-SW-2.                                         ELC50PD
 10697     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10698                                                                  ELC50PD
 10699     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10700        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10701          GO TO 0399-BENEFIT-NOT-FOUND.                           ELC50PD
 10702                                                                  ELC50PD
 10703     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.               ELC50PD
 10704                                                                  ELC50PD
 10705 0311-AH-BENEFIT-SEARCH.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 196
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10706                                                                  ELC50PD
 10707     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10708                                                                  ELC50PD
 10709     IF NO-BENEFIT-FOUND                                          ELC50PD
 10710         GO TO 0399-BENEFIT-NOT-FOUND.                            ELC50PD
 10711                                                                  ELC50PD
 10712     IF WS-BEN-CD = '99'                                          ELC50PD
 10713        GO TO 0399-BENEFIT-NOT-FOUND.                             ELC50PD
 10714                                                                  ELC50PD
 10715     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 10716         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10717             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10718                                                                  ELC50PD
 10719     MOVE +1                     TO SUB5.                         ELC50PD
 10720     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10721                                                                  ELC50PD
 10722* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10723* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10724     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10725         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10726                                                                  ELC50PD
 10727 0312-EDIT-ACCT-AH-BENEFITS.                                      ELC50PD
 10728                                                                  ELC50PD
 10729     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1                ELC50PD
 10730        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)                     ELC50PD
 10731           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10732                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10733           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10734                                                                  ELC50PD
 10735     IF SUB5 LESS THAN +20                                        ELC50PD
 10736        ADD +1                   TO SUB5                          ELC50PD
 10737        GO TO 0312-EDIT-ACCT-AH-BENEFITS.                         ELC50PD
 10738                                                                  ELC50PD
 10739     MOVE +1                     TO SUB5.                         ELC50PD
 10740                                                                  ELC50PD
 10741     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10742        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10743                                                                  ELC50PD
 10744 0313-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10745                                                                  ELC50PD
 10746     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1            ELC50PD
 10747        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)                 ELC50PD
 10748           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10749                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10750           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10751                                                                  ELC50PD
 10752     IF SUB5 LESS THAN +30                                        ELC50PD
 10753        ADD +1                   TO SUB5                          ELC50PD
 10754        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10755                                                                  ELC50PD
 10756     MOVE +1                     TO SUB5.                         ELC50PD
 10757                                                                  ELC50PD
 10758 03XX-EDIT-FOR-NINETY-AH.                                         ELC50PD
 10759                                                                  ELC50PD
 10760***************************************************************   ELC50PD
 10761*                                                             *   ELC50PD
 10762*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10763*                                                             *   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 197
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10764*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10765*      92 = ALL GROUP REDUCING BENEFITS.                      *   ELC50PD
 10766*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10767*           BENEFIT CONTROLS.                                 *   ELC50PD
 10768*      99 = ALL BENEFITS.                                     *   ELC50PD
 10769*                                                             *   ELC50PD
 10770***************************************************************   ELC50PD
 10771                                                                  ELC50PD
 10772     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10773                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10774                                                                  ELC50PD
 10775     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10776       AND                                                        ELC50PD
 10777        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10778        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10779                                                                  ELC50PD
 10780     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'                         ELC50PD
 10781       AND                                                        ELC50PD
 10782        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10783           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10784              OR                                                  ELC50PD
 10785           ((AM-IG = '1') AND                                     ELC50PD
 10786           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10787              OR                                                  ELC50PD
 10788           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10789           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10790           (AM-IG NOT = '2'))                                     ELC50PD
 10791              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10792                                                                  ELC50PD
 10793     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'                         ELC50PD
 10794       AND                                                        ELC50PD
 10795        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10796           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10797              OR                                                  ELC50PD
 10798           ((AM-IG = '2') AND                                     ELC50PD
 10799           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10800              OR                                                  ELC50PD
 10801           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10802           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10803           (AM-IG NOT = '1'))                                     ELC50PD
 10804              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10805                                                                  ELC50PD
 10806     IF SUB5 LESS THAN +20                                        ELC50PD
 10807        ADD +1                   TO SUB5                          ELC50PD
 10808        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10809                                                                  ELC50PD
 10810     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10811        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.                       ELC50PD
 10812                                                                  ELC50PD
 10813     MOVE +1                    TO SUB5.                          ELC50PD
 10814                                                                  ELC50PD
 10815 03XX-EDIT-DMD-EXTRA-NINETY-AH.                                   ELC50PD
 10816                                                                  ELC50PD
 10817     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10818                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10819                                                                  ELC50PD
 10820     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10821       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 198
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10822        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10823        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10824                                                                  ELC50PD
 10825     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'                     ELC50PD
 10826       AND                                                        ELC50PD
 10827        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10828           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10829              OR                                                  ELC50PD
 10830           ((AM-IG = '1') AND                                     ELC50PD
 10831           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10832              OR                                                  ELC50PD
 10833           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10834           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10835           (AM-IG NOT = '2'))                                     ELC50PD
 10836              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10837                                                                  ELC50PD
 10838     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'                     ELC50PD
 10839       AND                                                        ELC50PD
 10840        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10841           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10842              OR                                                  ELC50PD
 10843           ((AM-IG = '2') AND                                     ELC50PD
 10844           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10845              OR                                                  ELC50PD
 10846           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10847           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10848           (AM-IG NOT = '1'))                                     ELC50PD
 10849              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10850                                                                  ELC50PD
 10851     IF SUB5 LESS THAN +30                                        ELC50PD
 10852        ADD +1                   TO SUB5                          ELC50PD
 10853        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.                      ELC50PD
 10854                                                                  ELC50PD
 10855 03XX-EDIT-FOR-NINETY-AH-CONT.                                    ELC50PD
 10856                                                                  ELC50PD
 10857     MOVE +99                    TO SUB5.                         ELC50PD
 10858                                                                  ELC50PD
 10859     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10860                                                                  ELC50PD
 10861     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10862        IF PB-ISSUE                                               ELC50PD
 10863           MOVE ER-1925          TO  WS-ERROR                     ELC50PD
 10864           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10865                                                                  ELC50PD
 10866     GO TO 0314-A-H-BENEFIT-FOUND.                                ELC50PD
 10867                                                                  ELC50PD
 10868 03XX-GET-AH-ERPLAN.                                              ELC50PD
 10869                                                                  ELC50PD
 10870     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10871         GO TO 03XX-ERPLAN-AH-GETMAIN.                            ELC50PD
 10872                                                                  ELC50PD
 10873     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10874     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10875     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10876     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 10877     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10878                                    PLAN-MASTER-AH-SW.            ELC50PD
 10879*****GO TO XXXX-CHECK-AH-PLAN-KEY.                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 199
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10880     GO TO 03XX-ERPLAN-AH-READ.                                   ELC50PD
 10881                                                                  ELC50PD
 10882 03XX-ERPLAN-AH-GETMAIN.                                          ELC50PD
 10883                                                                  ELC50PD
 10884     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10885     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10886                                                                  ELC50PD
 10887 03XX-ERPLAN-AH-READ.                                             ELC50PD
 10888                                                                  ELC50PD
 10889     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10890     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10891     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10892     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10893     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10894     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.            ELC50PD
 10895     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10896     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10897                                 TO PLAN-REVISION-NO.             ELC50PD
 10898                                                                  ELC50PD
 10899     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10900     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.            ELC50PD
 10901                                                                  ELC50PD
 10902     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10903       IF NOT AH-PLAN-MASTER-FOUND                                ELC50PD
 10904         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10905            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10906             MOVE  ER-1922         TO  WS-ERROR                   ELC50PD
 10907             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10908             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10909                                                                  ELC50PD
 10910     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 10911        GO TO 0314-A-H-BENEFIT-FOUND.                             ELC50PD
 10912                                                                  ELC50PD
 10913 XXXX-CHECK-AH-PLAN-KEY.                                          ELC50PD
 10914                                                                  ELC50PD
 10915     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10916        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10917        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10918        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10919        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10920        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR          ELC50PD
 10921        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10922        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10923        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10924          GO TO 03XX-ERPLAN-AH-READ.                              ELC50PD
 10925                                                                  ELC50PD
 10926     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.            ELC50PD
 10927                                                                  ELC50PD
 10928     IF  PB-CANCELLATION                                          ELC50PD
 10929         GO TO  0313-AH-ACCT-BEN-FOUND.                           ELC50PD
 10930                                                                  ELC50PD
 10931     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10932       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND         ELC50PD
 10933          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)        ELC50PD
 10934          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO         ELC50PD
 10935             MOVE ER-2644             TO WS-ERROR                 ELC50PD
 10936             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 10937          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 200
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10938             NEXT SENTENCE                                        ELC50PD
 10939       ELSE                                                       ELC50PD
 10940          IF PB-COMPANY-ID NOT = 'NCL'                            ELC50PD
 10941             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS           ELC50PD
 10942                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.     ELC50PD
 10943                                                                  ELC50PD
 10944 0313-AH-ACCT-BEN-FOUND.                                          ELC50PD
 10945                                                                  ELC50PD
 10946     MOVE PL-REVISION-NO         TO WS-AH-REVISION.               ELC50PD
 10947                                                                  ELC50PD
 10948     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10949        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.         ELC50PD
 10950                                                                  ELC50PD
 10951     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10952        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10953        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.           ELC50PD
 10954                                                                  ELC50PD
 10955     IF PL-TOL-PREM-AMT NOT EQUAL +0                              ELC50PD
 10956        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.            ELC50PD
 10957                                                                  ELC50PD
 10958     IF PL-TOL-REF-AMT NOT EQUAL +0                               ELC50PD
 10959        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.          ELC50PD
 10960                                                                  ELC50PD
 10961     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10962        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.        ELC50PD
 10963                                                                  ELC50PD
 10964     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10965        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.      ELC50PD
 10966                                                                  ELC50PD
 10967     IF PL-TOL-CLM-AMT NOT EQUAL +0                               ELC50PD
 10968        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.           ELC50PD
 10969                                                                  ELC50PD
 10970     IF PL-OVER-SHORT-AMT NUMERIC AND                             ELC50PD
 10971                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10972        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.         ELC50PD
 10973                                                                  ELC50PD
 10974     IF PL-OVER-SHORT-PCT NUMERIC AND                             ELC50PD
 10975                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10976        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.           ELC50PD
 10977                                                                  ELC50PD
 10978     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10979        MOVE PL-IG               TO WS-IG-OVRD-AH-PL              ELC50PD
 10980        IF WS-IG-OVRD-AM EQUAL SPACES                             ELC50PD
 10981            MOVE PL-IG           TO WS-IG-OVRD-AM.                ELC50PD
 10982                                                                  ELC50PD
 10983 0314-A-H-BENEFIT-FOUND.                                          ELC50PD
 10984                                                                  ELC50PD
 10985     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.     ELC50PD
 10986                                                                  ELC50PD
 10987     IF PB-ISSUE                                                  ELC50PD
 10988        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR             ELC50PD
 10989       ELSE                                                       ELC50PD
 10990        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.           ELC50PD
 10991                                                                  ELC50PD
 10992     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.   ELC50PD
 10993     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.   ELC50PD
 10994     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.       ELC50PD
 10995     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 201
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10996                                         WS-AH-REFUND-CALC.       ELC50PD
 10997                                                                  ELC50PD
 10998     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 10999        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.    ELC50PD
 11000                                                                  ELC50PD
 11001     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 11002        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.  ELC50PD
 11003
 11004     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
 11005                                                                  ELC50PD
 11006     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.  ELC50PD
 11007     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.ELC50PD
 11008     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.     ELC50PD
 11009     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.  ELC50PD
 11010     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.    ELC50PD
 11011     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.  ELC50PD
 11012                                                                  ELC50PD
 11013     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 11014        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 11015         NEXT SENTENCE                                            ELC50PD
 11016     ELSE                                                         ELC50PD
 11017         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 11018            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'             ELC50PD
 11019                MOVE WS-SAVE-BENEFIT-REM-TERM                     ELC50PD
 11020                                      TO WS-AM-AH-BENE-REM-TERM   ELC50PD
 11021                                         EC-BR-AH-REM-TERM-CALC.  ELC50PD
 11022                                                                  ELC50PD
 11023     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.        ELC50PD
 11024     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.           ELC50PD
 11025                                                                  ELC50PD
 11026     GO TO 0400-FIND-CARRIER.                                     ELC50PD
 11027                                                                  ELC50PD
 11028 0399-BENEFIT-NOT-FOUND.                                          ELC50PD
 11029                                                                  ELC50PD
 11030     MOVE '1'                    TO AH-BENEFIT-ERROR.             ELC50PD
 11031     MOVE ER-2605                TO WS-ERROR.                     ELC50PD
 11032     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11033                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 202
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11035                                                                  ELC50PD
 11036 0400-FIND-CARRIER.                                               ELC50PD
 11037                                                                  ELC50PD
 11038     MOVE PB-SV-CARRIER          TO WS-CARR.                      ELC50PD
 11039                                                                  ELC50PD
 11040     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11041     MOVE ZEROS                  TO CNTL-SEQ-NO.                  ELC50PD
 11042     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  ELC50PD
 11043     MOVE '6'                    TO CNTL-REC-TYPE.                ELC50PD
 11044                                                                  ELC50PD
 11045*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD                   ELC50PD
 11046     MOVE SPACE                  TO WS-DMD-RATING-SW              ELC50PD
 11047                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11048                                                                  ELC50PD
 11049     MOVE '2'                    TO RC-SW-1.                      ELC50PD
 11050     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
 11051                                                                  ELC50PD
 11052     IF NOT CF-CARRIER-MASTER                                     ELC50PD
 11053        GO TO 0400-CARRIER-NOT-FOUND.                             ELC50PD
 11054                                                                  ELC50PD
 11055 0400-BUILD-CARR-TOL.                                             ELC50PD
 11056                                                                  ELC50PD
 11057     IF CF-CR-TOL-PREM NUMERIC AND                                ELC50PD
 11058        CF-CR-TOL-PREM GREATER THAN +0                            ELC50PD
 11059        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11060                                    WS-TOL-AH-PREM.               ELC50PD
 11061                                                                  ELC50PD
 11062     IF CF-CR-TOL-REFUND NUMERIC AND                              ELC50PD
 11063        CF-CR-TOL-REFUND GREATER THAN +0                          ELC50PD
 11064        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND              ELC50PD
 11065                                    WS-TOL-AH-REFUND.             ELC50PD
 11066                                                                  ELC50PD
 11067     IF CF-CR-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11068        CF-CR-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11069        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11070                                    WS-AH-REFUND-OVS-AMT.         ELC50PD
 11071                                                                  ELC50PD
 11072     IF CF-CR-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11073        CF-CR-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11074        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11075                                    WS-AH-REFUND-OVS-PCT.         ELC50PD
 11076                                                                  ELC50PD
 11077     IF CF-CR-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11078        CF-CR-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11079        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT            ELC50PD
 11080                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11081                                                                  ELC50PD
 11082     IF CF-CR-TOL-REFUND-PCT NUMERIC AND                          ELC50PD
 11083        CF-CR-TOL-REFUND-PCT GREATER THAN +0                      ELC50PD
 11084        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT         ELC50PD
 11085                                     WS-TOL-AH-REFUND-PCT.        ELC50PD
 11086                                                                  ELC50PD
 11087     IF CF-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 11088         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW              ELC50PD
 11089                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11090                                                                  ELC50PD
 11091     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
 11092     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 203
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11093        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
 11094     END-IF
 11095     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
 11096        MOVE +0                  TO CF-CARRIER-LEASE-COMM
 11097     END-IF
 11098     IF WS-TOL-CLP-PCT = ZEROS
 11099        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
 11100     END-IF
 11101
 11102     IF WS-SPP-LEASE-COMM = ZEROS
 11103        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
 11104     END-IF
 11105
 11106     GO TO 0400-FIND-ERPDEF.
 11107                                                                  ELC50PD
 11108 0400-CARRIER-NOT-FOUND.                                          ELC50PD
 11109                                                                  ELC50PD
 11110     MOVE ER-2602                TO WS-ERROR.                     ELC50PD
 11111     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11112                                                                  ELC50PD
 11113 0400-FIND-ERPDEF.
 11114
 11115     IF PB-COMPANY-ID = 'DCC'
 11116        AND AM-DCC-PRODUCT-CODE = 'DDF'
 11117        CONTINUE
 11118     ELSE
 11119        GO TO 0400-FIND-ERCOMP
 11120     END-IF
 11121
 11122     MOVE ' '                    TO PDEF-MASTER-SW
 11123     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
 11124     MOVE PB-STATE               TO ERPDEF-STATE
 11125     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
 11126     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 11127     IF PB-ISSUE
 11128        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
 11129     ELSE
 11130        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 11131     END-IF
 11132     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
 11133     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 11134     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
 11135     IF PDEF-MASTER-FOUND
 11136        MOVE 'N'                 TO PDEF-MASTER-SW
 11137        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11138        IF PDEF-MASTER-FOUND
 11139           IF (ERPDEF-KEY-SAVE (1:16) =
 11140                        PD-CONTROL-PRIMARY (1:16))
 11141              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11142              CONTINUE
 11143           ELSE
 11144              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11145              IF (ERPDEF-KEY-SAVE (1:16) =
 11146                        PD-CONTROL-PRIMARY (1:16))
 11147                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11148                 CONTINUE
 11149              ELSE
 11150                 MOVE 'N'        TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 204
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11151              END-IF
 11152           END-IF
 11153        END-IF
 11154        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 11155     END-IF
 11156     IF PDEF-MASTER-FOUND
 11157        IF PD-TRUNCATED = 'Y'
 11158           MOVE 'T'              TO WS-AH-DCC-TRUNC
 11159        END-IF
 11160     END-IF
 11161
 11162     .
 11163 0400-FIND-ERCOMP.
 11164
 11165     IF PB-COMPANY-ID = 'DCC'
 11166        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11167           (WS-SUB1 > +10)
 11168           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
 11169                 OR 'A' OR 'N'
 11170              MOVE PB-COMPANY-CD TO COMP-COMP-CD
 11171              MOVE PB-CARRIER    TO COMP-CARRIER
 11172              MOVE PB-GROUPING   TO COMP-GROUPING
 11173              MOVE LOW-VALUES    TO COMP-ACCOUNT
 11174              MOVE AM-AGT (WS-SUB1)
 11175                                 TO COMP-FIN-RESP
 11176              MOVE 'G'           TO COMP-TYPE
 11177              PERFORM 8582-READ-COMPENSATION-MASTER
 11178                                 THRU 8582-EXIT
 11179              IF COMP-MASTER-FOUND
 11180                 IF CO-GA-INACTIVE
 11181                    MOVE ER-2763 TO WS-ERROR
 11182                    PERFORM 9900-ERROR-FORMAT
 11183                                 THRU 9900-EXIT
 11184                    MOVE +11     TO WS-SUB1
 11185                 END-IF
 11186                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11187                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11188                    MOVE ER-2788 TO WS-ERROR
 11189                    PERFORM 9900-ERROR-FORMAT
 11190                                 THRU 9900-EXIT
 11191                    MOVE +11     TO WS-SUB1
 11192                 END-IF
 11193              END-IF
 11194           END-IF
 11195        END-PERFORM
 11196     END-IF
 11197
 11198     IF PB-COMPANY-ID = 'DCC'
 11199        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
 11200           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
 11201                                    WS-CLP-STATE
 11202        ELSE
 11203           MOVE SPACES           TO PB-I-CLP-STATE
 11204                                    WS-CLP-STATE
 11205        END-IF
 11206     END-IF
 11207
 11208     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 205
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11209        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
 11210        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 11211        CONTINUE
 11212     ELSE
 11213        GO TO 0400-FIND-STATE-RECORD
 11214     END-IF
 11215
 11216     MOVE SPACES                 TO WS-CLP-STATE
 11217     MOVE +0                     TO WS-BANK-FEE
 11218                                    WS-BANK-LFEE
 11219                                    WS-BANK-NOCHRGB
 11220
 11221     MOVE LOW-VALUES             TO COMP-FIN-RESP
 11222
 11223     IF (PB-ISSUE)
 11224        AND (PB-I-BANK-NUMBER NOT =
 11225            SPACES AND ZEROS AND LOW-VALUES)
 11226        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
 11227     ELSE
 11228        IF (PB-CANCELLATION)
 11229           AND (PB-CI-BANK-NUMBER NOT =
 11230                SPACES AND ZEROS AND LOW-VALUES)
 11231           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
 11232        END-IF
 11233     END-IF
 11234
 11235     IF COMP-FIN-RESP NOT = LOW-VALUES
 11236        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
 11237        MOVE PB-CARRIER          TO COMP-CARRIER
 11238        MOVE PB-GROUPING         TO COMP-GROUPING
 11239        MOVE LOW-VALUES          TO COMP-ACCOUNT
 11240        MOVE 'B'                 TO COMP-TYPE
 11241        PERFORM 8582-READ-COMPENSATION-MASTER
 11242                                 THRU 8582-EXIT
 11243        IF COMP-MASTER-FOUND
 11244           IF CO-MAX-BANK-FEE NOT NUMERIC
 11245              MOVE +0            TO CO-MAX-BANK-FEE
 11246           END-IF
 11247           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
 11248              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
 11249           END-IF
 11250           IF CO-GA-INACTIVE
 11251              MOVE ER-2763       TO WS-ERROR
 11252              PERFORM 9900-ERROR-FORMAT
 11253                                 THRU 9900-EXIT
 11254           END-IF
 11255           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11256              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11257              MOVE ER-2788 TO WS-ERROR
 11258              PERFORM 9900-ERROR-FORMAT
 11259                                 THRU 9900-EXIT
 11260              MOVE +11     TO WS-SUB1
 11261           END-IF
 11262           IF WS-AH-BEN-CATEGORY = 'G'
 11263              MOVE CO-MAX-BANK-FEE
 11264                                 TO WS-BANK-FEE
 11265                                    PB-I-BANK-FEE
 11266           ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 206
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11267              MOVE CO-MAX-BANK-FEE-LEASE
 11268                                 TO WS-BANK-LFEE
 11269                                    PB-I-BANK-FEE
 11270           END-IF
 11271           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
 11272              AND (WS-AH-REFUND-CALC = 'G'))
 11273                        OR
 11274              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
 11275              AND (WS-AH-REFUND-CALC NOT = 'G'))
 11276              CONTINUE
 11277           ELSE
 11278              MOVE ER-2789 TO WS-ERROR
 11279              PERFORM 9900-ERROR-FORMAT
 11280                                 THRU 9900-EXIT
 11281           END-IF
 11282           MOVE CO-CLP-STATE     TO WS-CLP-STATE
 11283                                    PB-I-CLP-STATE
 11284           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
 11285           MOVE CO-CARRIER       TO BXRF-CARRIER
 11286           MOVE CO-GROUPING      TO BXRF-GROUPING
 11287           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
 11288           MOVE BXRF-MAX-REC-LENGTH
 11289                                 TO BXRF-REC-LENGTH
 11290           PERFORM 8584-READ-BANK-CROSS-REF
 11291                                 THRU 8584-EXIT
 11292           IF BXRF-MASTER-FOUND
 11293              MOVE ' '           TO BANK-ACCT-SW
 11294              MOVE BK-BANK-POINTER-CNT
 11295                                 TO BK-BANK-POINTER-CNT
 11296              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11297                 (WS-SUB1 > BK-BANK-POINTER-CNT)
 11298                 OR (BANK-ACCT-FOUND)
 11299                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
 11300                    AND (BK-AM-EXP-DT (WS-SUB1)
 11301                                 > PB-CERT-EFF-DT)
 11302                    AND (BK-AM-EFF-DT (WS-SUB1)
 11303                                 NOT > PB-CERT-EFF-DT)
 11304                    SET BANK-ACCT-FOUND TO TRUE
 11305                 END-IF
 11306              END-PERFORM
 11307              IF NOT BANK-ACCT-FOUND
 11308                 MOVE ZEROS      TO WS-BANK-FEE
 11309                                    WS-BANK-LFEE
 11310                 MOVE ER-2869    TO WS-ERROR
 11311                 PERFORM 9900-ERROR-FORMAT
 11312                                 THRU 9900-EXIT
 11313              ELSE
 11314                 PERFORM 5000-PROCESS-REPS
 11315                                 THRU 5000-EXIT
 11316                 IF AGENT-MASTER-FOUND
 11317                    MOVE +0      TO WS-BANK-FEE
 11318                                    WS-BANK-LFEE
 11319*                   MOVE AG-SPP-FEES (1)
 11320*                                TO PB-I-BANK-FEE
 11321*                                   WS-BANK-FEE
 11322                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11323                       (WS-SUB1 > +10)
 11324                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 207
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11325                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
 11326                       END-IF
 11327                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
 11328                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
 11329                       END-IF
 11330                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
 11331                          AG-SPP-FEES (WS-SUB1)
 11332                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
 11333                          AG-SPP-LFEES (WS-SUB1)
 11334                    END-PERFORM
 11335                    IF WS-AH-BEN-CATEGORY = 'G'
 11336                       MOVE WS-BANK-FEE
 11337                                 TO PB-I-BANK-FEE
 11338                    ELSE
 11339                       MOVE WS-BANK-LFEE
 11340                                 TO PB-I-BANK-FEE
 11341                    END-IF
 11342                 END-IF
 11343              END-IF
 11344           END-IF
 11345        ELSE
 11346           MOVE ER-2879          TO WS-ERROR
 11347           PERFORM 9900-ERROR-FORMAT
 11348                                 THRU 9900-EXIT
 11349        END-IF
 11350     ELSE
 11351        MOVE ER-2879             TO WS-ERROR
 11352        PERFORM 9900-ERROR-FORMAT
 11353                                 THRU 9900-EXIT
 11354     END-IF
 11355
 11356     IF WS-AH-BEN-CATEGORY = 'G'
 11357        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11358        + WS-BANK-FEE
 11359     ELSE
 11360        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11361        + WS-BANK-LFEE
 11362     END-IF
 11363
 11364     .
 11365 0400-FIND-STATE-RECORD.                                          ELC50PD
 11366                                                                  ELC50PD
 11367     IF WK-STATE-ADDR NOT = ZEROS                                 ELC50PD
 11368         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP                ELC50PD
 11369         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 11370         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 11371         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT           CL**2
 11372         IF PB-SV-STATE = CF-STATE-CODE                           ELC50PD
 11373             GO TO 0405-CONTINUE-EDIT                             ELC50PD
 11374         ELSE                                                     ELC50PD
 11375             NEXT SENTENCE                                        ELC50PD
 11376     ELSE                                                         ELC50PD
 11377         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 11378                                                                  ELC50PD
 11379     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11380     MOVE PB-SV-STATE            TO CNTL-ACCESS.                  ELC50PD
 11381     MOVE '3'                    TO CNTL-REC-TYPE.                ELC50PD
 11382     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 208
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11383                                                                  ELC50PD
 11384     MOVE '3'                    TO RC-SW-2.                      ELC50PD
 11385     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 11386                                                                  ELC50PD
 11387     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR                    ELC50PD
 11388        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR                     ELC50PD
 11389        PB-SV-STATE   NOT = CF-STATE-CODE)                        ELC50PD
 11390        MOVE ZEROS               TO WS-TOL-LF-CLAIM               ELC50PD
 11391                                    WS-TOL-AH-CLAIM               ELC50PD
 11392                                    WS-MINIMUM-REFUND             ELC50PD
 11393                                    WS-TOL-LF-PREM                ELC50PD
 11394                                    WS-TOL-AH-PREM                ELC50PD
 11395                                    WS-TOL-LF-REFUND              ELC50PD
 11396                                    WS-TOL-AH-REFUND              ELC50PD
 11397                                    EC-ST-TOL-PREM-PCT            ELC50PD
 11398                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11399                                    WS-TOL-AH-PREM-PCT            ELC50PD
 11400                                    EC-ST-TOL-REFUND-PCT          ELC50PD
 11401                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11402                                    WS-TOL-AH-REFUND-PCT          ELC50PD
 11403                                    EC-ST-TOL-PREM                ELC50PD
 11404                                    EC-ST-TOL-REFUND              ELC50PD
 11405                                    EC-ST-FST-PMT-DAYS-MAX        ELC50PD
 11406                                    WS-FREE-LOOK-PERIOD           ELC50PD
 11407                                    WS-ST-LF-PREM-TAX
 11408                                    WS-ST-AH-PREM-TAX-I
 11409                                    WS-ST-AH-PREM-TAX-G
 11410                                    WS-BANK-FEE
 11411                                    WS-BANK-LFEE
 11412                                    WS-TOL-CLP-PCT
 11413                                    WS-SPP-LEASE-COMM
 11414        MOVE SPACES              TO WS-STATE-ABBREVIATION         ELC50PD
 11415                                    EC-ST-FST-PMT-DAYS-CHG        ELC50PD
 11416                                    WS-LF-REM-TERM-CALC           ELC50PD
 11417                                    WS-LF-REFUND-CALC             ELC50PD
 11418                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11419                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11420                                    WS-AH-REM-TERM-CALC           ELC50PD
 11421                                    WS-AH-REFUND-CALC
 11422                                    WS-LF-BEN-CATEGORY
 11423                                    WS-AH-BEN-CATEGORY
 11424                                    WS-CLP-STATE
 11425                                    WS-ST-REFUND-CLAIM-FLAG
 11426                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11427                                    EC-ST-AH-REFUND-CALC          ELC50PD
 11428          GO TO 0499-STATE-NOT-FOUND.                             ELC50PD
 11429                                                                  ELC50PD
 11430     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.                ELC50PD
 11431                                                                  ELC50PD
 11432 0405-CONTINUE-EDIT.                                              ELC50PD
 11433
 11434     if pb-company-id = 'AHL'
 11435        continue
 11436     else
 11437        IF PB-CERT-PRIME NOT NUMERIC
 11438           MOVE ER-2722          TO WS-ERROR
 11439           PERFORM 9900-ERROR-FORMAT
 11440                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 209
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11441        end-if
 11442     END-IF
 11443
 11444*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11445*       MOVE +0                  TO SUB3
 11446*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
 11447*       IF SUB3 > +0
 11448*          MOVE ER-2722          TO WS-ERROR
 11449*          PERFORM 9900-ERROR-FORMAT
 11450*                                THRU 9900-EXIT
 11451*       END-IF
 11452*    END-IF
 11453
 11454
 11455*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11456*       IF PB-CERT-PRIME NOT NUMERIC
 11457*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
 11458*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
 11459*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
 11460*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
 11461*
 11462*          MOVE ER-2722          TO WS-ERROR
 11463*          PERFORM 9900-ERROR-FORMAT
 11464*                                THRU 9900-EXIT
 11465*       END-IF
 11466*    END-IF
 11467
 11468     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.        ELC50PD
 11469                                                                  ELC50PD
 11470     IF CF-ST-TOL-CLAIM NOT = ZEROS                               ELC50PD
 11471        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM               ELC50PD
 11472                                    WS-TOL-AH-CLAIM.              ELC50PD
 11473                                                                  ELC50PD
 11474     IF CF-ST-REFUND-MIN NOT NUMERIC                              ELC50PD
 11475        MOVE ZEROS               TO CF-ST-REFUND-MIN.             ELC50PD
 11476                                                                  ELC50PD
 11477     IF CF-ST-REFUND-MIN NOT = ZEROS                              ELC50PD
 11478        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.            ELC50PD
 11479                                                                  ELC50PD
 11480     IF CF-ST-TOL-PREM  NOT = ZEROS                               ELC50PD
 11481        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11482                                    WS-TOL-AH-PREM                ELC50PD
 11483        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.           ELC50PD
 11484                                                                  ELC50PD
 11485     IF CF-ST-TOL-REFUND NOT = ZEROS                              ELC50PD
 11486        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND              ELC50PD
 11487                                    WS-TOL-AH-REFUND              ELC50PD
 11488        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.             ELC50PD
 11489                                                                  ELC50PD
 11490     IF CF-ST-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11491        CF-ST-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11492        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11493                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 11494                                    EC-ST-OVR-SHT-AMT.            ELC50PD
 11495                                                                  ELC50PD
 11496     IF CF-ST-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11497        CF-ST-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11498        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 210
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11499                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11500                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11501                                                                  ELC50PD
 11502     IF CF-ST-TOL-REF-PCT NUMERIC AND                             ELC50PD
 11503        CF-ST-TOL-REF-PCT GREATER THAN +0                         ELC50PD
 11504        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT          ELC50PD
 11505                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11506                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 11507                                                                  ELC50PD
 11508     IF CF-ST-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11509        CF-ST-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11510        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11511                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 11512                                    EC-ST-OVR-SHT-PCT.            ELC50PD
 11513                                                                  ELC50PD
 11514     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.               ELC50PD
 11515     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.             ELC50PD
 11516                                                                  ELC50PD
 11517     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC                        ELC50PD
 11518          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11519                                                                  ELC50PD
 11520     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11521     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.       ELC50PD
 11522
 11523     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.          ELC50PD
 11524                                                                  ELC50PD
 11525     IF CF-ST-LF-PREM-TAX NUMERIC
 11526        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11527     END-IF
 11528     IF CF-ST-AH-PREM-TAX-I NUMERIC
 11529        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11530     END-IF
 11531     IF CF-ST-AH-PREM-TAX-G NUMERIC
 11532        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11533     END-IF
 11534
 11535     IF CF-ST-REF-AH-DEATH-IND > SPACES
 11536         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 11537     END-IF.
 11538
 11539     IF WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 11540        GO TO 0410-CHECK-AH.                                      ELC50PD
 11541                                                                  ELC50PD
 11542     IF CF-ST-RT-CALC NOT = SPACES
 11543        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11544                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11545     END-IF
 11546
 11547     IF WS-LF-COVERAGE-TYPE = 'R'
 11548        IF WS-LF-EARNINGS-CALC = '5'
 11549           IF CF-ST-RF-LN-CALC > '0'
 11550              MOVE CF-ST-RF-LN-CALC
 11551                                 TO WS-LF-REFUND-CALC
 11552                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11553           END-IF
 11554        ELSE
 11555           IF CF-ST-RF-LR-CALC > '0'
 11556              MOVE CF-ST-RF-LR-CALC
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 211
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11557                                 TO WS-LF-REFUND-CALC
 11558                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11559           END-IF
 11560        END-IF
 11561     ELSE
 11562        IF CF-ST-RF-LL-CALC > '0'
 11563           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 11564                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11565        END-IF
 11566     END-IF
 11567
 11568     IF CF-ST-RT-CALC NOT = SPACES
 11569        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11570                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11571     END-IF
 11572
 11573     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11574     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.               ELC50PD
 11575                                                                  ELC50PD
 11576     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11577                                                                  ELC50PD
 11578     IF NO-BENEFIT-FOUND                                          ELC50PD
 11579        GO TO 0410-CHECK-AH.                                      ELC50PD
 11580                                                                  ELC50PD
 11581     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11582        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 11583                                 TO EC-ST-LF-REM-TERM-CALC
 11584                                    WS-LF-REM-TERM-CALC           ELC50PD
 11585     END-IF
 11586                                                                  ELC50PD
 11587     IF CF-ST-REFUND-CALC (SUB3) > '0'                            ELC50PD
 11588        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11589                                 TO WS-LF-REFUND-CALC             ELC50PD
 11590                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11591     END-IF
 11592*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.  ELC50PD
 11593                                                                  ELC50PD
 11594     .                                                            ELC50PD
 11595 0410-CHECK-AH.                                                   ELC50PD
 11596                                                                  ELC50PD
 11597     IF WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 11598        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11599                                                                  ELC50PD
 11600     IF CF-ST-RT-CALC NOT = SPACES
 11601        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 11602                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11603     END-IF
 11604
 11605     IF WS-AH-SPECIAL-CALC-CD = 'C'
 11606        IF CF-ST-RF-CP-CALC > '0'
 11607           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 11608                                    EC-ST-AH-REFUND-CALC
 11609        END-IF
 11610     ELSE
 11611        IF CF-ST-RF-AH-CALC > '0'
 11612           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 11613                                    EC-ST-AH-REFUND-CALC
 11614        END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 212
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11615     END-IF
 11616     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11617     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE                ELC50PD
 11618                                                                  ELC50PD
 11619     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11620                                                                  ELC50PD
 11621     IF NO-BENEFIT-FOUND                                          ELC50PD
 11622        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11623                                                                  ELC50PD
 11624     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11625        MOVE CF-ST-REM-TERM-CALC (SUB3)                           ELC50PD
 11626                                 TO WS-AH-REM-TERM-CALC           ELC50PD
 11627                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11628     END-IF
 11629                                                                  ELC50PD
 11630     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'                   ELC50PD
 11631        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11632                                 TO WS-AH-REFUND-CALC             ELC50PD
 11633                                    EC-ST-AH-REFUND-CALC
 11634     END-IF
 11635                                                                  ELC50PD
 11636*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.  ELC50PD
 11637                                                                  ELC50PD
 11638     GO TO 0500-SET-ACCOUNT.                                      ELC50PD
 11639                                                                  ELC50PD
 11640 0499-STATE-NOT-FOUND.                                            ELC50PD
 11641                                                                  ELC50PD
 11642     MOVE ER-2603                TO WS-ERROR.                     ELC50PD
 11643     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11644                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 213
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11646                                                                  ELC50PD
 11647 0500-SET-ACCOUNT.                                                ELC50PD
 11648
 11649*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 11650
 11651     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11652        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 11653        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 11654        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 11655        MOVE '3'                 TO CNTL-REC-TYPE
 11656        MOVE +0                  TO CNTL-SEQ-NO
 11657
 11658        MOVE '3'                 TO RC-SW-2
 11659        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 11660
 11661        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 11662           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 11663           WS-CLP-STATE  NOT = CF-STATE-CODE)
 11664           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 11665                                    WS-ST-AH-PREM-TAX-I
 11666                                    WS-ST-AH-PREM-TAX-G
 11667        ELSE
 11668           IF CF-ST-LF-PREM-TAX NUMERIC
 11669              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11670           END-IF
 11671           IF CF-ST-AH-PREM-TAX-I NUMERIC
 11672              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11673           END-IF
 11674           IF CF-ST-AH-PREM-TAX-G NUMERIC
 11675              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11676           END-IF
 11677        END-IF
 11678        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 11679     END-IF
 11680
 11681*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 11682*  FOR DCC ONLY
 11683
 11684     IF PB-COMPANY-ID = 'DCC'
 11685
 11686     MOVE ' '                    TO STAT-MASTER-SW
 11687     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 11688     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 11689     MOVE PB-GROUPING            TO ELSTAT-GROUP
 11690     MOVE PB-STATE               TO ELSTAT-STATE
 11691     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11692        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 11693     END-IF
 11694
 11695     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11696     SET BIN-TO-GREG             TO TRUE
 11697     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 11698     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 11699     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 11700
 11701     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 11702     IF STAT-MASTER-FOUND
 11703        MOVE 'N'                 TO STAT-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 214
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11704        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11705        IF STAT-MASTER-FOUND
 11706           IF (ELSTAT-KEY-SAVE (1:12) =
 11707                        SF-CONTROL-PRIMARY (1:12))
 11708              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11709                 MOVE 'F'        TO STAT-MASTER-SW
 11710              ELSE
 11711                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11712                 IF (STAT-MASTER-FOUND)
 11713                    AND (ELSTAT-KEY-SAVE (1:12) =
 11714                        SF-CONTROL-PRIMARY (1:12))
 11715                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11716                    MOVE 'F'     TO STAT-MASTER-SW
 11717                 END-IF
 11718              END-IF
 11719           END-IF
 11720        END-IF
 11721     END-IF
 11722
 11723     IF STAT-MASTER-SW = 'F'
 11724        IF SF-ST-LF-PREM-TAX NUMERIC
 11725           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11726        END-IF
 11727        IF SF-ST-AH-PREM-TAX-I NUMERIC
 11728           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11729        END-IF
 11730        IF SF-ST-AH-PREM-TAX-G NUMERIC
 11731           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11732        END-IF
 11733     END-IF
 11734
 11735     END-IF
 11736
 11737     IF (PB-COMPANY-ID = 'DCC')
 11738        AND (PB-ISSUE)
 11739        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11740        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 11741        AND (AM-GPCD = 06)
 11742        MOVE 'Y'                 TO WS-GOOD-HIN
 11743        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11744           MOVE PB-I-VIN         TO WS-WORK-VIN
 11745           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11746              (V1 > 16)
 11747              IF WS-WORK-VIN (V1:1) NUMERIC
 11748                 MOVE WS-WORK-VIN-N (V1)
 11749                                 TO WS-ROW-B-VAL (V1)
 11750              ELSE
 11751                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 11752                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 11753                    OR (V2 > 26)
 11754                 END-PERFORM
 11755                 IF V2 < 27
 11756                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 11757                 ELSE
 11758                    MOVE 'N'     TO WS-GOOD-HIN
 11759                 END-IF
 11760              END-IF
 11761              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 215
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11762                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 11763              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 11764                 WS-ROW-D-VAL (V1)
 11765           END-PERFORM
 11766           MOVE ZEROS            TO WS-VIN-REMAINDER
 11767           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 11768             REMAINDER WS-VIN-REMAINDER
 11769           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 11770              CONTINUE
 11771           ELSE
 11772              MOVE 'N'           TO WS-GOOD-HIN
 11773           END-IF
 11774        ELSE
 11775           MOVE 'N'              TO WS-GOOD-HIN
 11776        END-IF
 11777        IF WS-GOOD-HIN NOT = 'Y'
 11778           MOVE ER-3826           TO WS-ERROR
 11779           PERFORM 9900-ERROR-FORMAT
 11780                                 THRU 9900-EXIT
 11781        END-IF
 11782     END-IF
 11783
 11784     IF (PB-COMPANY-ID = 'DCC')
 11785        AND (PB-ISSUE)
 11786        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11787        AND (AM-GPCD NOT = 06)
 11788        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11789          MOVE PB-I-VIN          TO WS-WORK-VIN
 11790          MOVE +8                TO V2
 11791          MOVE ZEROS             TO WS-VIN-TOTAL
 11792          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11793           (V1 > 17)
 11794             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 11795                MOVE ER-3825     TO WS-ERROR
 11796                PERFORM 9900-ERROR-FORMAT
 11797                                 THRU 9900-EXIT
 11798             ELSE
 11799                IF V1 = 8
 11800                   MOVE 10       TO V2
 11801                END-IF
 11802                IF V1 = 9
 11803                   MOVE 0        TO V2
 11804                END-IF
 11805                IF V1 = 10
 11806                   MOVE 9        TO V2
 11807                END-IF
 11808                IF WS-WORK-VIN (V1:1) NUMERIC
 11809                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11810                    + (WS-WORK-VIN-N (V1) * V2)
 11811                ELSE
 11812                   MOVE WS-WORK-VIN (V1:1)
 11813                                 TO WS-HEX-BYTE
 11814                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 11815                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11816                    + (WS-NUM (V3) * V2)
 11817                END-IF
 11818                COMPUTE V2 = V2 - 1
 11819             END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 216
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11820          END-PERFORM
 11821          MOVE ZEROS TO WS-VIN-REMAINDER
 11822          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 11823             REMAINDER WS-VIN-REMAINDER
 11824          IF ((WS-WORK-VIN (9:1) = 'X')
 11825             AND (WS-VIN-REMAINDER = 10))
 11826                     OR
 11827             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 11828             CONTINUE
 11829          ELSE
 11830             MOVE ER-3826        TO WS-ERROR
 11831             PERFORM 9900-ERROR-FORMAT
 11832                                 THRU 9900-EXIT
 11833          END-IF
 11834        ELSE
 11835          MOVE ER-3826           TO WS-ERROR
 11836          PERFORM 9900-ERROR-FORMAT
 11837                                 THRU 9900-EXIT
 11838        END-IF
 11839     END-IF
 11840
 11841
 11842
 11843******************************************************************ELC50PD
 11844******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM       ELC50PD
 11845******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND    ELC50PD
 11846******* METHODS.                                                  ELC50PD
 11847******************************************************************ELC50PD
 11848     IF PB-COMPANY-ID EQUAL TO 'NCL'                              ELC50PD
 11849        IF PB-CANCELLATION                                        ELC50PD
 11850           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)       ELC50PD
 11851              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))    ELC50PD
 11852                PERFORM 3350-GET-ERFORM THRU 3350-EXIT            ELC50PD
 11853                IF FORM-MASTER-FOUND                              ELC50PD
 11854                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.   ELC50PD
 11855******************************************************************ELC50PD
 11856                                                                  ELC50PD
 11857     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.               ELC50PD
 11858     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.               ELC50PD
 11859                                                                  ELC50PD
 11860     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.          ELC50PD
 11861     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.           ELC50PD
 11862     MOVE AM-STATUS              TO WS-ACCT-STATUS.               ELC50PD
 11863     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.          ELC50PD
 11864                                                                  ELC50PD
 11865                                                                  ELC50PD
 11866     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.        ELC50PD
 11867     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.               ELC50PD
 11868     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.          ELC50PD
 11869                                                                  ELC50PD
 11870     IF AM-LF-OB-RATE NOT NUMERIC                                 ELC50PD
 11871         MOVE ZERO               TO AM-LF-OB-RATE.                ELC50PD
 11872                                                                  ELC50PD
 11873     IF AM-LF-OB-RATE-JNT NOT NUMERIC                             ELC50PD
 11874         MOVE ZERO               TO AM-LF-OB-RATE-JNT.            ELC50PD
 11875                                                                  ELC50PD
 11876     IF AM-AH-OB-RATE NOT NUMERIC                                 ELC50PD
 11877         MOVE ZERO               TO AM-AH-OB-RATE.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 217
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11878                                                                  ELC50PD
 11879     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 11880         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT              ELC50PD
 11881     ELSE                                                         ELC50PD
 11882         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.             ELC50PD
 11883                                                                  ELC50PD
 11884     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.             ELC50PD
 11885                                                                  ELC50PD
 11886     IF WS-IG-OVRD-AM  EQUAL SPACE                                ELC50PD
 11887         MOVE AM-IG              TO WS-IG-OVRD-AM.                ELC50PD
 11888                                                                  ELC50PD
 11889     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE                          ELC50PD
 11890         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH              ELC50PD
 11891                                       WS-IG-OVRD                 ELC50PD
 11892     ELSE                                                         ELC50PD
 11893         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE                     ELC50PD
 11894             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH              ELC50PD
 11895                                       WS-IG-OVRD                 ELC50PD
 11896         ELSE                                                     ELC50PD
 11897             MOVE AM-IG             TO WS-IG-OVRD-AH              ELC50PD
 11898                                       WS-IG-OVRD.                ELC50PD
 11899                                                                  ELC50PD
 11900     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE                          ELC50PD
 11901         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF              ELC50PD
 11902                                       WS-IG-OVRD                 ELC50PD
 11903     ELSE                                                         ELC50PD
 11904         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE                     ELC50PD
 11905             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF              ELC50PD
 11906                                       WS-IG-OVRD                 ELC50PD
 11907         ELSE                                                     ELC50PD
 11908             MOVE AM-IG             TO WS-IG-OVRD-LF              ELC50PD
 11909                                       WS-IG-OVRD.                ELC50PD
 11910                                                                  ELC50PD
 11911     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11912     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11913     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11914     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.         ELC50PD
 11915     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 11916                                                                  ELC50PD
 11917     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.               ELC50PD
 11918     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.               ELC50PD
 11919     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.           ELC50PD
 11920     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.         ELC50PD
 11921                                                                  ELC50PD
 11922     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.           ELC50PD
 11923     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.         ELC50PD
 11924     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.             ELC50PD
 11925     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.           ELC50PD
 11926     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.          ELC50PD
 11927     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.                ELC50PD
 11928     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.                ELC50PD
 11929                                                                  ELC50PD
 11930     IF WS-ACCT-AH-DEV-PCT > +0                                   ELC50PD
 11931        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT       ELC50PD
 11932     ELSE                                                         ELC50PD
 11933        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.      ELC50PD
 11934                                                                  ELC50PD
 11935     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 218
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11936        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.      ELC50PD
 11937     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
 11938        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.      ELC50PD
 11939                                                                  ELC50PD
 11940        IF AM-EARN-METHOD-L = 'S'                                 ELC50PD
 11941            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11942                                        WS-LF-REFUND-CALC.        ELC50PD
 11943                                                                  ELC50PD
 11944        IF AM-EARN-METHOD-R = 'S'                                 ELC50PD
 11945            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11946                                        WS-LF-REFUND-CALC.        ELC50PD
 11947                                                                  ELC50PD
 11948     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11949         IF AM-EARN-METHOD-R = 'R'                                ELC50PD
 11950            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11951                                    WS-LF-REFUND-CALC.            ELC50PD
 11952     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11953         IF AM-EARN-METHOD-R = 'P'                                ELC50PD
 11954            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11955                                    WS-LF-REFUND-CALC.            ELC50PD
 11956     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11957         IF AM-EARN-METHOD-L = 'R'                                ELC50PD
 11958            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11959                                    WS-LF-REFUND-CALC.            ELC50PD
 11960     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11961         IF AM-EARN-METHOD-L = 'P'                                ELC50PD
 11962            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11963                                    WS-LF-REFUND-CALC.            ELC50PD
 11964     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11965         IF AM-EARN-METHOD-R = 'A'                                ELC50PD
 11966            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11967                                    WS-LF-REFUND-CALC.            ELC50PD
 11968     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11969         IF AM-EARN-METHOD-R = 'M'                                ELC50PD
 11970            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11971                                    WS-LF-REFUND-CALC.            ELC50PD
 11972     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11973         IF AM-EARN-METHOD-L = 'A'                                ELC50PD
 11974            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11975                                    WS-LF-REFUND-CALC.            ELC50PD
 11976     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11977         IF AM-EARN-METHOD-L = 'M'                                ELC50PD
 11978            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11979                                    WS-LF-REFUND-CALC.            ELC50PD
 11980                                                                  ELC50PD
 11981     IF AM-EARN-METHOD-A = 'R'                                    ELC50PD
 11982        MOVE '1'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11983                                    WS-AH-REFUND-CALC.            ELC50PD
 11984     IF AM-EARN-METHOD-A = 'P'                                    ELC50PD
 11985        MOVE '2'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11986                                    WS-AH-REFUND-CALC.            ELC50PD
 11987     IF AM-EARN-METHOD-A = 'C'                                    ELC50PD
 11988        MOVE '3'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11989                                    WS-AH-REFUND-CALC.            ELC50PD
 11990     IF AM-EARN-METHOD-A = 'A'                                    ELC50PD
 11991        MOVE '6'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11992                                    WS-AH-REFUND-CALC.            ELC50PD
 11993     IF AM-EARN-METHOD-A = 'M'                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 219
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11994        MOVE '8'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11995                                    WS-AH-REFUND-CALC.            ELC50PD
 11996     IF AM-EARN-METHOD-A = 'N'                                    ELC50PD
 11997        MOVE '5'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11998                                    WS-AH-REFUND-CALC.            ELC50PD
 11999     IF AM-EARN-METHOD-A = 'S'                                    ELC50PD
 12000        MOVE '9'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12001                                    WS-AH-REFUND-CALC.            ELC50PD
 12002                                                                  ELC50PD
 12003     IF AM-TOL-PREM NOT = ZEROS                                   ELC50PD
 12004        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM                ELC50PD
 12005                                    WS-TOL-AH-PREM.               ELC50PD
 12006                                                                  ELC50PD
 12007     IF AM-OVR-SHT-AMT NUMERIC AND                                ELC50PD
 12008                  AM-OVR-SHT-AMT > 0                              ELC50PD
 12009        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT          ELC50PD
 12010                                    EC-AM-LF-OVR-SHT-AMT          ELC50PD
 12011                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 12012                                    EC-AM-AH-OVR-SHT-AMT.         ELC50PD
 12013                                                                  ELC50PD
 12014     IF AM-OVR-SHT-PCT NUMERIC AND                                ELC50PD
 12015                    AM-OVR-SHT-PCT > 0                            ELC50PD
 12016        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT          ELC50PD
 12017                                    EC-AM-LF-OVR-SHT-PCT          ELC50PD
 12018                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 12019                                    EC-AM-AH-OVR-SHT-PCT.         ELC50PD
 12020                                                                  ELC50PD
 12021     IF AM-TOL-REF-PCT NUMERIC AND                                ELC50PD
 12022                  AM-TOL-REF-PCT > 0                              ELC50PD
 12023        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT          ELC50PD
 12024                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 12025                                                                  ELC50PD
 12026     IF AM-TOL-REF  NOT = ZEROS  AND                              ELC50PD
 12027                  AM-TOL-REF NUMERIC                              ELC50PD
 12028        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND              ELC50PD
 12029                                    EC-AM-LF-TOL-REFUND           ELC50PD
 12030                                    WS-TOL-AH-REFUND              ELC50PD
 12031                                    EC-AM-AH-TOL-REFUND.          ELC50PD
 12032                                                                  ELC50PD
 12033     IF AM-TOL-CLM  NOT = ZEROS                                   ELC50PD
 12034        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM               ELC50PD
 12035                                    WS-TOL-AH-CLAIM.              ELC50PD
 12036                                                                  ELC50PD
 12037     IF AM-CLP-TOL-PCT NOT NUMERIC
 12038        MOVE +0                  TO AM-CLP-TOL-PCT
 12039     END-IF
 12040
 12041     IF AM-SPP-LEASE-COMM NOT NUMERIC
 12042        MOVE +0                  TO AM-SPP-LEASE-COMM
 12043     END-IF
 12044
 12045     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0                        ELC50PD
 12046        MOVE WS-PL-TOL-LF-PREM-PCT                                ELC50PD
 12047                                 TO WS-TOL-LF-PREM-PCT.           ELC50PD
 12048                                                                  ELC50PD
 12049     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0                        ELC50PD
 12050        MOVE WS-PL-TOL-AH-PREM-PCT                                ELC50PD
 12051                                 TO WS-TOL-AH-PREM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 220
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12052                                                                  ELC50PD
 12053     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12054        MOVE WS-PL-TOL-LF-REFUND-PCT                              ELC50PD
 12055                                 TO WS-TOL-LF-REFUND-PCT.         ELC50PD
 12056                                                                  ELC50PD
 12057     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12058        MOVE WS-PL-TOL-AH-REFUND-PCT                              ELC50PD
 12059                                 TO WS-TOL-AH-REFUND-PCT.         ELC50PD
 12060                                                                  ELC50PD
 12061     IF WS-PL-REF-OVS-AMT > +0                                    ELC50PD
 12062        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.           ELC50PD
 12063                                                                  ELC50PD
 12064     IF WS-PL-REF-OVS-PCT > +0                                    ELC50PD
 12065        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT            ELC50PD
 12066                                                                  ELC50PD
 12067     IF WS-PL-TOL-LF-PREM NOT EQUAL +0                            ELC50PD
 12068        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.               ELC50PD
 12069     IF WS-PL-TOL-AH-PREM NOT EQUAL +0                            ELC50PD
 12070        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.               ELC50PD
 12071     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0                          ELC50PD
 12072        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.             ELC50PD
 12073     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0                          ELC50PD
 12074        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.             ELC50PD
 12075     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0                           ELC50PD
 12076        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.              ELC50PD
 12077     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0                           ELC50PD
 12078        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.              ELC50PD
 12079                                                                  ELC50PD
 12080     IF WS-AH-PL-REF-OVS-AMT > +0                                 ELC50PD
 12081        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.        ELC50PD
 12082                                                                  ELC50PD
 12083     IF WS-AH-PL-REF-OVS-PCT > +0                                 ELC50PD
 12084        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.        ELC50PD
 12085                                                                  ELC50PD
 12086     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.            ELC50PD
 12087     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.            ELC50PD
 12088                                                                  ELC50PD
 12089     IF PB-CANCELLATION                                           ELC50PD
 12090        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12091                                                                  ELC50PD
 12092     MOVE +1 TO SUB1.                                             ELC50PD
 12093     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.                ELC50PD
 12094     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.                ELC50PD
 12095                                                                  ELC50PD
 12096     IF CF-COMPANY-ID = 'DMD'                                     ELC50PD
 12097       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES                 ELC50PD
 12098         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD                 ELC50PD
 12099        ELSE                                                      ELC50PD
 12100         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.                ELC50PD
 12101                                                                  ELC50PD
 12102  0525-FIND-ACCT-COMM.                                            ELC50PD
 12103     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'              ELC50PD
 12104        NEXT SENTENCE                                             ELC50PD
 12105      ELSE                                                        ELC50PD
 12106         ADD +1 TO SUB1                                           ELC50PD
 12107         IF SUB1 LESS +11                                         ELC50PD
 12108            GO TO 0525-FIND-ACCT-COMM                             ELC50PD
 12109          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 221
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12110             GO TO 0560-EDIT-CONTINUE.                            ELC50PD
 12111                                                                  ELC50PD
 12112     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.              ELC50PD
 12113     MOVE ZERO                   TO PB-I-AH-COMMISSION            ELC50PD
 12114                                    PB-I-LIFE-COMMISSION.         ELC50PD
 12115***  IF PB-COMPANY-ID = 'CRI'                                        CL**9
 12116     IF PB-PREM-ACCTNG-ONLY                                          CL**9
 12117         GO TO 0560-EDIT-CONTINUE.                                   CL**9
 12118                                                                  ELC50PD
 12119     MOVE '0530' TO CTBL-SW.                                      ELC50PD
 12120     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12121                                                                  ELC50PD
 12122                                                                  ELC50PD
 12123 0530-GET-AH-COMP.                                                ELC50PD
 12124     IF NO-AH-COVERAGE  OR                                        ELC50PD
 12125        NO-AH-BENEFIT-MATCH                                       ELC50PD
 12126           GO TO 0540-NEXT-READ-STEP.                             ELC50PD
 12127                                                                  ELC50PD
 12128     IF AM-A-COM (SUB1) NUMERIC                                   ELC50PD
 12129        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12130         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION                 ELC50PD
 12131         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE                 ELC50PD
 12132         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT      ELC50PD
 12133         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION            ELC50PD
 12134     ELSE                                                         ELC50PD
 12135          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE                 ELC50PD
 12136          MOVE PB-I-AH-TERM      TO WS-WORK-TERM                  ELC50PD
 12137          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE                 ELC50PD
 12138          MOVE ZEROS             TO WS-SUB1                       ELC50PD
 12139                                    WS-COMMISSION                 ELC50PD
 12140          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT     ELC50PD
 12141          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE                    ELC50PD
 12142          IF WS-COMMISSION > ZEROS                                ELC50PD
 12143             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION            ELC50PD
 12144             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12145          END-IF                                                  ELC50PD
 12146          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT             ELC50PD
 12147          IF CTBL-TABLE-FOUND                                     ELC50PD
 12148             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *       ELC50PD
 12149                                        PB-I-AH-TERM              ELC50PD
 12150             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT            ELC50PD
 12151             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION         ELC50PD
 12152             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12153          ELSE                                                    ELC50PD
 12154             IF FIRST-TIME-THROUGH                                ELC50PD
 12155                 GO TO 0530-GET-AH-COMP                           ELC50PD
 12156             ELSE                                                 ELC50PD
 12157                 MOVE ER-2609                TO WS-ERROR          ELC50PD
 12158                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           CL**2
 12159                                                                  ELC50PD
 12160 0540-NEXT-READ-STEP.                                             ELC50PD
 12161     MOVE '0540' TO CTBL-SW.                                      ELC50PD
 12162     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12163                                                                  ELC50PD
 12164 0540-GET-LF-COMP.                                                ELC50PD
 12165     IF NO-LIFE-COVERAGE  OR                                      ELC50PD
 12166        NO-LF-BENEFIT-MATCH                                       ELC50PD
 12167           GO TO 0560-EDIT-CONTINUE.                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 222
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12168                                                                  ELC50PD
 12169     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12170        IF AM-J-COM (SUB1) NUMERIC                                ELC50PD
 12171           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 12172           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12173           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12174           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12175           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12176        ELSE                                                      ELC50PD
 12177           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12178           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12179           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12180           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12181                                        WS-COMMISSION             ELC50PD
 12182           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12183           IF WS-COMMISSION > ZEROS                               ELC50PD
 12184              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12185              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12186           END-IF                                                 ELC50PD
 12187           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12188           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12189           IF CTBL-TABLE-FOUND                                    ELC50PD
 12190              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12191              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12192              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
 12193              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12194           ELSE                                                   ELC50PD
 12195              IF FIRST-TIME-THROUGH                               ELC50PD
 12196                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12197              ELSE                                                ELC50PD
 12198                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12199                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT        ELC50PD
 12200                  GO TO 0560-EDIT-CONTINUE.                          CL**2
 12201                                                                  ELC50PD
 12202     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'                        ELC50PD
 12203        IF AM-L-COM (SUB1) NUMERIC                                ELC50PD
 12204           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 12205           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12206           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12207           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12208           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12209        ELSE                                                      ELC50PD
 12210           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12211           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12212           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12213           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12214                                        WS-COMMISSION             ELC50PD
 12215           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12216           IF WS-COMMISSION IS GREATER THAN ZEROS                 ELC50PD
 12217              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12218              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12219           END-IF                                                 ELC50PD
 12220           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12221           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12222           IF CTBL-TABLE-FOUND                                    ELC50PD
 12223              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12224              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12225              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 223
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12226              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12227           ELSE                                                   ELC50PD
 12228              IF FIRST-TIME-THROUGH                               ELC50PD
 12229                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12230              ELSE                                                ELC50PD
 12231                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12232                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          CL**2
 12233                                                                  ELC50PD
 12234*    GO TO 0560-EDIT-CONTINUE.                                    ELC50PD
 12235                                                                  ELC50PD
 12236 0560-EDIT-CONTINUE.                                              ELC50PD
 12237
 12238     MOVE ZEROS                  TO WS-LF-PMF-COMM
 12239                                    WS-AH-PMF-COMM
 12240*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 12241*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 12242
 12243     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 12244        (SUB1 > +10)
 12245        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 12246           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 12247           MOVE '0530'           TO CTBL-SW
 12248           MOVE ' '              TO WS-CTBL-READ-SW
 12249           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 12250           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 12251           MOVE '0540'           TO CTBL-SW
 12252           MOVE ' '              TO WS-CTBL-READ-SW
 12253           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 12254        END-IF
 12255     END-PERFORM
 12256
 12257     GO TO 0564-EDIT-CONTINUE
 12258
 12259     .
 12260 0561-CHECK-AH.
 12261
 12262     IF (NO-AH-COVERAGE)
 12263        OR (NO-AH-BENEFIT-MATCH)
 12264        CONTINUE
 12265     ELSE
 12266        IF (AM-A-COM (SUB1) NUMERIC)
 12267           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12268           IF (AM-COM-TYP (SUB1) = 'A')
 12269              AND (WS-AH-PMF-COMM = ZEROS)
 12270              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 12271           END-IF
 12272           CONTINUE
 12273        ELSE
 12274           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 12275           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 12276           MOVE PB-AH-OVERRIDE-L1
 12277                                 TO CTBL-BEN-TYPE
 12278           MOVE ZEROS            TO WS-SUB1
 12279                                    WS-COMMISSION
 12280           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 12281           PERFORM 8300-READ-CTBL-TABLE
 12282                                 THRU 8300-EXIT
 12283           IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 224
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12284              IF (AM-COM-TYP (SUB1) = 'A')
 12285                 AND (WS-AH-PMF-COMM = ZEROS)
 12286                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 12287                                        PB-I-AH-TERM
 12288                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12289                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 12290              END-IF
 12291              CONTINUE
 12292           ELSE
 12293              IF FIRST-TIME-THROUGH
 12294                 GO TO 0561-CHECK-AH
 12295              ELSE
 12296                 MOVE ER-2609    TO WS-ERROR
 12297                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12298              END-IF
 12299           END-IF
 12300        END-IF
 12301     END-IF
 12302
 12303     .
 12304 0561-EXIT.
 12305     EXIT.
 12306
 12307 0563-CHECK-LF.
 12308
 12309     IF (NO-LIFE-COVERAGE)
 12310        OR (NO-LF-BENEFIT-MATCH)
 12311        CONTINUE
 12312     ELSE
 12313        IF WS-LF-JOINT-INDICATOR = 'J'
 12314           IF AM-J-COM (SUB1) NUMERIC
 12315              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12316              IF (AM-COM-TYP (SUB1) = 'A')
 12317                 AND (WS-LF-PMF-COMM = ZEROS)
 12318                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 12319              END-IF
 12320              CONTINUE
 12321           ELSE
 12322              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12323              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12324              MOVE PB-LIFE-OVERRIDE-L1
 12325                                 TO CTBL-BEN-TYPE
 12326              MOVE ZEROS         TO WS-SUB1
 12327                                    WS-COMMISSION
 12328              MOVE AM-J-COMA (SUB1)
 12329                                 TO CTBL-TABLE
 12330              PERFORM 8300-READ-CTBL-TABLE
 12331                                 THRU 8300-EXIT
 12332              IF CTBL-TABLE-FOUND
 12333                 IF (AM-COM-TYP (SUB1) = 'A')
 12334                    AND (WS-LF-PMF-COMM = ZEROS)
 12335                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 12336                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12337                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 12338                 END-IF
 12339                 CONTINUE
 12340              ELSE
 12341                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 225
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12342                    GO TO 0563-CHECK-LF
 12343                 ELSE
 12344                    MOVE ER-2609 TO WS-ERROR
 12345                    PERFORM 9900-ERROR-FORMAT
 12346                                 THRU 9900-EXIT
 12347*                   GO TO 0560-EDIT-CONTINUE
 12348                 END-IF
 12349              END-IF
 12350           END-IF
 12351        ELSE
 12352           IF AM-L-COM (SUB1) NUMERIC
 12353              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12354              IF (AM-COM-TYP (SUB1) = 'A')
 12355                 AND (WS-LF-PMF-COMM = ZEROS)
 12356                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 12357              END-IF
 12358              CONTINUE
 12359           ELSE
 12360              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12361              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12362              MOVE PB-LIFE-OVERRIDE-L1
 12363                                 TO CTBL-BEN-TYPE
 12364              MOVE ZEROS         TO WS-SUB1
 12365                                    WS-COMMISSION
 12366              MOVE AM-L-COMA (SUB1)
 12367                                 TO CTBL-TABLE
 12368              PERFORM 8300-READ-CTBL-TABLE
 12369                                 THRU 8300-EXIT
 12370              IF CTBL-TABLE-FOUND
 12371                 CONTINUE
 12372              ELSE
 12373                 IF FIRST-TIME-THROUGH
 12374                    GO TO 0563-CHECK-LF
 12375                 ELSE
 12376                    MOVE ER-2609 TO WS-ERROR
 12377                    PERFORM 9900-ERROR-FORMAT
 12378                                 THRU 9900-EXIT
 12379                 END-IF
 12380              END-IF
 12381           END-IF
 12382        END-IF
 12383     END-IF
 12384
 12385     .
 12386 0563-EXIT.
 12387     EXIT.
 12388
 12389 0564-EDIT-CONTINUE.
 12390                                                                  ELC50PD
 12391     IF  PB-COMPANY-ID EQUAL 'DMD'                                ELC50PD
 12392         IF PB-I-NUM-BILLED EQUAL ZEROS                           ELC50PD
 12393            MOVE ER-8148       TO WS-ERROR                        ELC50PD
 12394            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12395                                                                  ELC50PD
 12396*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE                     ELC50PD
 12397*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1                  ELC50PD
 12398*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2                  ELC50PD
 12399*         SET ELAPSED-BETWEEN-BIN TO TRUE                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 226
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12400*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 12401*         IF NO-CONVERSION-ERROR                                  ELC50PD
 12402*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12        ELC50PD
 12403*         ELSE                                                    ELC50PD
 12404*             IF PB-COMPANY-ID EQUAL 'HAN'                        ELC50PD
 12405*                 MOVE ZEROS     TO PB-I-AGE.                     ELC50PD
 12406
 12407     IF PB-I-BIRTHDAY > LOW-VALUES
 12408        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 12409        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12410        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12411        PERFORM 8500-DATE-CONVERT
 12412                                 THRU 8500-EXIT
 12413        IF NO-CONVERSION-ERROR
 12414           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12415           IF PB-I-AGE > ZEROS
 12416              IF WS-WORK-AGE NOT = PB-I-AGE
 12417                 MOVE ER-9501    TO WS-ERROR
 12418                 PERFORM 9900-ERROR-FORMAT
 12419                                 THRU 9900-EXIT
 12420              END-IF
 12421           ELSE
 12422              MOVE WS-WORK-AGE   TO PB-I-AGE
 12423           END-IF
 12424        END-IF
 12425     END-IF
 12426
 12427     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 12428                                   WS-INS-AGE-SET
 12429     IF PB-I-AGE = ZEROS                                          ELC50PD
 12430        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'                  ELC50PD
 12431           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 12432                                   WS-INS-AGE-SET
 12433           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.                      ELC50PD
 12434                                                                  ELC50PD
 12435     MOVE PB-I-AGE              TO WS-EDIT-AGE                    ELC50PD
 12436                                   WS-AH-EDIT-AGE.                ELC50PD
 12437                                                                  ELC50PD
 12438     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12439        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 12440        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12441        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12442        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12443        IF NO-CONVERSION-ERROR
 12444           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12445           IF PB-I-JOINT-AGE > 0
 12446              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 12447                 MOVE ER-9503    TO WS-ERROR
 12448                 PERFORM 9900-ERROR-FORMAT
 12449                                 THRU 9900-EXIT
 12450              END-IF
 12451           ELSE
 12452              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 12453           END-IF
 12454        ELSE
 12455           MOVE ZEROS            TO PB-I-JOINT-AGE
 12456        END-IF
 12457     END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 227
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12458
 12459     IF PB-I-JOINT-AGE NOT NUMERIC                                ELC50PD
 12460        MOVE ZERO               TO PB-I-JOINT-AGE.                ELC50PD
 12461                                                                  ELC50PD
 12462     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 12463                                   WS-JNT-AGE-SET
 12464     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 12465        IF (WS-LF-JOINT-INDICATOR = 'J')  OR                      ELC50PD
 12466           (WS-AH-JOINT-INDICATOR = 'J')                          ELC50PD
 12467           IF PB-I-JOINT-AGE = ZEROS                              ELC50PD
 12468               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 12469                                          WS-JNT-AGE-SET
 12470               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 12471           END-IF
 12472        END-IF
 12473     END-IF
 12474                                                                  ELC50PD
 12475     MOVE ' ' TO PB-I-LIFE-INDICATOR
 12476     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12477        MOVE 'J'                TO PB-I-LIFE-INDICATOR            ELC50PD
 12478        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12479            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12480                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12481                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12482            ELSE                                                  ELC50PD
 12483                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12484                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE            ELC50PD
 12485                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12486                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12487                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12488                                                                  ELC50PD
 12489     IF WS-AH-JOINT-INDICATOR = 'J'                               ELC50PD
 12490        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12491            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12492                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12493                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12494            ELSE                                                  ELC50PD
 12495                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12496                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE         ELC50PD
 12497                                           WS-EDIT-AGE
 12498                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12499                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12500                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12501                                                                  ELC50PD
 12502******************************************************************ELC50PD
 12503*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS         ELC50PD
 12504******************************************************************ELC50PD
 12505                                                                  ELC50PD
 12506     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12507        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12508        NEXT SENTENCE                                             ELC50PD
 12509     ELSE                                                         ELC50PD
 12510        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR                      ELC50PD
 12511          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND               ELC50PD
 12512           (WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12513            WS-AH-JOINT-INDICATOR = 'J')  AND                     ELC50PD
 12514           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                      ELC50PD
 12515            MOVE ER-2627             TO WS-ERROR                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 228
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12516            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12517                                                                  ELC50PD
 12518     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12519        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12520         NEXT SENTENCE                                            ELC50PD
 12521     ELSE                                                         ELC50PD
 12522         IF WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12523            WS-AH-JOINT-INDICATOR = 'J'                           ELC50PD
 12524             IF PB-I-JOINT-INSURED = SPACES                       ELC50PD
 12525                 IF PB-COMPANY-ID NOT = 'JAL'                     ELC50PD
 12526                     MOVE ER-2696    TO WS-ERROR                  ELC50PD
 12527                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.    ELC50PD
 12528                                                                  ELC50PD
 12529     IF PB-COMPANY-ID NOT = 'BOA'                                 ELC50PD
 12530        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12531           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12532           IF (PB-I-JOINT-AGE NOT = ZEROS OR                      ELC50PD
 12533               PB-I-JOINT-INSURED NOT = SPACES)                   ELC50PD
 12534                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12535                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12536                                                                  ELC50PD
 12537     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 12538        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12539           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12540            IF PB-I-JOINT-AGE NOT = ZEROS                         ELC50PD
 12541                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12542                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12543                                                                  ELC50PD
 12544     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12545        IF PB-I-SIG-SW = 'J'                                      ELC50PD
 12546           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND                ELC50PD
 12547              WS-AH-JOINT-INDICATOR NOT = 'J'                     ELC50PD
 12548              MOVE ER-2675       TO WS-ERROR                      ELC50PD
 12549              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12550                                                                  ELC50PD
 12551     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12552        IF PB-I-SIG-SW = 'S'                                      ELC50PD
 12553           IF WS-LF-JOINT-INDICATOR = 'J'  OR                     ELC50PD
 12554              WS-AH-JOINT-INDICATOR = 'J'                         ELC50PD
 12555              MOVE ER-2676       TO WS-ERROR                      ELC50PD
 12556              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12557                                                                  ELC50PD
 12558     IF PB-COMPANY-ID = 'CVL'                                     ELC50PD
 12559         IF (WS-AH-JOINT-INDICATOR = 'J') AND                     ELC50PD
 12560            (WS-LF-JOINT-INDICATOR NOT = 'J')                     ELC50PD
 12561              MOVE ER-2783           TO WS-ERROR                  ELC50PD
 12562              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12563
 12564     IF (WS-LF-JOINT-INDICATOR = 'J')
 12565        AND (WS-AH-JOINT-INDICATOR = 'J')
 12566        AND (PB-I-LF-TERM > 120)
 12567        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 12568        MOVE ER-2783             TO WS-ERROR
 12569        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12570     END-IF
 12571
 12572     MOVE SPACE                  TO PB-I-INDV-GRP-CD.             ELC50PD
 12573                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 229
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12574     IF PB-I-INDV-GRP-OVRD = 'I'                                  ELC50PD
 12575        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12577        MOVE 'I'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12578                                                                  ELC50PD
 12579     IF PB-I-INDV-GRP-OVRD = 'G'                                  ELC50PD
 12580        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12582        MOVE 'G'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12583                                                                  ELC50PD
 12584     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'                           ELC50PD
 12585        NEXT SENTENCE                                             ELC50PD
 12586     ELSE                                                         ELC50PD
 12587        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.             ELC50PD
 12588                                                                  ELC50PD
 12589     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD                           ELC50PD
 12590        IF WS-ERROR = ER-2666                                     ELC50PD
 12591           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)        ELC50PD
 12592           SUBTRACT +1           FROM PB-NO-OF-ERRORS.            ELC50PD
 12593
 12594     IF PB-COMPANY-ID = 'CID'
 12595        IF PB-STATE = 'UT' OR 'MO'
 12596           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 12597                 OR '76' OR '77')
 12598                      OR
 12599               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 12600                   OR '41' OR '42' OR '63' OR '64' OR '65'
 12601                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 12602                   OR '2K' OR '2L'))
 12603              AND PB-I-INDV-GRP-CD = 'I'
 12604              MOVE ER-2721             TO WS-ERROR
 12605              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12606           END-IF
 12607        END-IF
 12608     END-IF
 12609                                                                  ELC50PD
 12610     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 12611     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 12612        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 12613     ELSE
 12614        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 12615     END-IF
 12616
 12617*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 12618*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 12619     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW            ELC50PD
 12620                                    ACCOUNT-AH-CK-SW.             ELC50PD
 12621                                                                  ELC50PD
 12622     IF PB-REISSUED-CERT       OR                                 ELC50PD
 12623        PB-REIN-ONLY-CERT      OR                                 ELC50PD
 12624        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 12625        PB-POLICY-IS-VOIDED                                       ELC50PD
 12626*       OR PB-MONTHLY-CERT
 12627         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12628                                                                  ELC50PD
 12629     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12630        IF WS-EDIT-AGE           > +65
 12631           MOVE ER-2709          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 230
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12632           PERFORM 9900-ERROR-FORMAT
 12633                                 THRU 9900-EXIT
 12634        ELSE
 12635           IF WS-EDIT-AGE        > +55
 12636              MOVE ER-2718       TO WS-ERROR
 12637              PERFORM 9900-ERROR-FORMAT
 12638                                 THRU 9900-EXIT
 12639           END-IF
 12640        END-IF
 12641
 12642     IF PB-COMPANY-ID = 'DCC'
 12643        IF WS-EDIT-AGE           > +65
 12644           MOVE ER-2709          TO WS-ERROR
 12645           PERFORM 9900-ERROR-FORMAT
 12646                                 THRU 9900-EXIT
 12647        END-IF
 12648     END-IF
 12649     .
 12650
 12651 0565-LIFE-PLAN-LIMIT-EDITS.                                      ELC50PD
 12652                                                                  ELC50PD
 12653     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 12654        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 12655                                    EC-AM-LF-MAX-TOT-BEN
 12656        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12657                                                                  ELC50PD
 12658     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 12659                                                                  ELC50PD
 12660     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12661         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12662             GO TO 0580-AH-PLAN-LIMIT-EDITS.                      ELC50PD
 12663                                                                  ELC50PD
 12664     IF NO-LF-BENEFIT-MATCH          OR                           ELC50PD
 12665        WS-LF-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12666        WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12667        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12668                                                                  ELC50PD
 12669     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.           ELC50PD
 12670     MOVE +1                     TO SUB2.                         ELC50PD
 12671                                                                  ELC50PD
 12672     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12673        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
 12674           MOVE +5   TO SUB2                                      ELC50PD
 12675           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12676              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12677              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12678              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW                    ELC50PD
 12679              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12680                                                                  ELC50PD
 12681     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 12682                                                                  ELC50PD
 12683     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 12684                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 12685                                                                  ELC50PD
 12686 0568-CHECK-LIFE-ATT-AGE.                                         ELC50PD
 12687                                                                  ELC50PD
 12688
 12689     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 231
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12690        PL-ATT-AGE > +0
 12691        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 12692     END-IF
 12693
 12694
 12695
 12696*    IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12697*       PL-ATT-AGE > +0
 12698*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE          ELC50PD
 12699*       IF PB-I-BIRTHDAY > LOW-VALUES
 12700*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12701*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 12702*          MOVE ZERO             TO DC-ELAPSED-DAYS
 12703*          SET BIN-PLUS-ELAPSED  TO TRUE
 12704*          PERFORM 8500-DATE-CONVERT
 12705*                                THRU 8500-EXIT
 12706*          IF NO-CONVERSION-ERROR
 12707*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 12708*             MOVE ER-2669       TO WS-ERROR
 12709*             PERFORM 9900-ERROR-FORMAT
 12710*                                THRU 9900-EXIT
 12711*          END-IF
 12712*       ELSE
 12713*          IF WS-ATT-AGE >= PL-ATT-AGE
 12714*             MOVE ER-2669       TO WS-ERROR                      ELC50PD
 12715*             PERFORM 9900-ERROR-FORMAT
 12716*                                THRU 9900-EXIT
 12717*          END-IF
 12718*       END-IF
 12719*    END-IF
 12720
 12721     .
 12722 0570-CHECK-LIFE-LIMITS.                                          ELC50PD
 12723                                                                  ELC50PD
 12724     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12725        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12726           IF SUB2 GREATER THAN +4                                ELC50PD
 12727              MOVE ER-2637 TO WS-ERROR                            ELC50PD
 12728              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12729              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12730                                                                  ELC50PD
 12731     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12732        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12733            SUB2 GREATER THAN +8                                  ELC50PD
 12734             MOVE 'U'         TO PB-BATCH-ENTRY                   ELC50PD
 12735             MOVE ER-2637     TO WS-ERROR                         ELC50PD
 12736             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12737             GO TO 0575-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12738                                                                  ELC50PD
 12739     IF SUB2 > +8
 12740        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12741           AND (PB-I-SIG-SW = 'Y')
 12742           CONTINUE
 12743        ELSE
 12744           MOVE ER-2637          TO WS-ERROR
 12745           PERFORM 9900-ERROR-FORMAT
 12746                                 THRU 9900-EXIT
 12747        END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 232
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12748        GO TO 0580-AH-PLAN-LIMIT-EDITS
 12749     END-IF
 12750
 12751     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.                ELC50PD
 12752     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.               ELC50PD
 12753     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.            ELC50PD
 12754                                                                  ELC50PD
 12755     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)               ELC50PD
 12756        ADD +1  TO SUB2                                           ELC50PD
 12757        GO TO 0570-CHECK-LIFE-LIMITS.                             ELC50PD
 12758                                                                  ELC50PD
 12759     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12760         GO TO 0570-CHECK-NCL-LIFE-LIMITS.                        ELC50PD
 12761                                                                  ELC50PD
 12762     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 12763        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 12764        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12765           AND (PB-I-SIG-SW = 'Y')
 12766           CONTINUE
 12767        ELSE
 12768           MOVE ER-2637          TO WS-ERROR
 12769           PERFORM 9900-ERROR-FORMAT
 12770                                 THRU 9900-EXIT
 12771        END-IF
 12772     END-IF
 12773
 12774     GO TO 0580-AH-PLAN-LIMIT-EDITS.                              ELC50PD
 12775                                                                  ELC50PD
 12776                                                                  ELC50PD
 12777 0570-CHECK-NCL-LIFE-LIMITS.                                      ELC50PD
 12778                                                                  ELC50PD
 12779     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND      ELC50PD
 12780        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)      ELC50PD
 12781         GO TO 0575-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12782                                                                  ELC50PD
 12783     IF APP-CERT-USED                                             ELC50PD
 12784         IF SUB2  LESS THAN  +5                                   ELC50PD
 12785             MOVE +5          TO SUB2                             ELC50PD
 12786             GO TO 0570-CHECK-LIFE-LIMITS.                        ELC50PD
 12787                                                                  ELC50PD
 12788     MOVE ER-2637             TO WS-ERROR.                        ELC50PD
 12789     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12790                                                                  ELC50PD
 12791     MOVE 'U'                 TO PB-BATCH-ENTRY.                  ELC50PD
 12792                                                                  ELC50PD
 12793 0575-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12794                                                                  ELC50PD
 12795     IF NOT APP-CERT-USED                                         ELC50PD
 12796         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12797                                                                  ELC50PD
 12798     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12799        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12800        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12801        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12802         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12803                                                                  ELC50PD
 12804     IF SUB2 GREATER THAN +4                                      ELC50PD
 12805         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 233
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12806            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 12807            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 12808            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 12809             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 12810             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12811             GO TO 0580-AH-PLAN-LIMIT-EDITS                       ELC50PD
 12812         ELSE                                                     ELC50PD
 12813             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 12814                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 12815                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 12816                                                                  ELC50PD
 12817     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 12818       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 12819          NOT PB-I-POLICY-DECLINED                                ELC50PD
 12820           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 12821           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 12822           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12823                                                                  ELC50PD
 12824                                                                  ELC50PD
 12825 0580-AH-PLAN-LIMIT-EDITS.                                        ELC50PD
 12826                                                                  ELC50PD
 12827     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12828        IF PB-I-AH-BENEFIT-AMT > +1250
 12829           MOVE ER-2702          TO WS-ERROR
 12830           PERFORM 9900-ERROR-FORMAT
 12831                                 THRU 9900-EXIT
 12832        END-IF
 12833     END-IF
 12834
 12835     IF (PB-COMPANY-ID = 'DCC')
 12836        AND (PB-MONTHLY-CERT)
 12837        IF PB-I-AH-BENEFIT-AMT > +3000
 12838           MOVE ER-2881          TO WS-ERROR
 12839           PERFORM 9900-ERROR-FORMAT
 12840                                 THRU 9900-EXIT
 12841        END-IF
 12842     END-IF
 12843
 12844     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 12845        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 12846        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12847                                                                  ELC50PD
 12848     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 12849                                                                  ELC50PD
 12850     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12851         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12852             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 12853                                                                  ELC50PD
 12854     IF NO-AH-BENEFIT-MATCH          OR                           ELC50PD
 12855        WS-AH-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12856        WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12857        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12858                                                                  ELC50PD
 12859     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.             ELC50PD
 12860     MOVE +1                     TO SUB2.                         ELC50PD
 12861                                                                  ELC50PD
 12862     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12863        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 234
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12864           MOVE +5 TO SUB2                                        ELC50PD
 12865           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12866              (PL-LM-MOA (SUB2) EQUAL +0) AND                     ELC50PD
 12867              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12868              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12869              MOVE 'NO ' TO ACCOUNT-AH-CK-SW                      ELC50PD
 12870              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12871                                                                  ELC50PD
 12872     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 12873                                                                  ELC50PD
 12874 0590-CHECK-AH-ATT-AGE.                                           ELC50PD
 12875                                                                  ELC50PD
 12876     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12877        PL-ATT-AGE GREATER THAN +0                                ELC50PD
 12878        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 12879     END-IF
 12880*       IF WS-ATT-AGE >= PL-ATT-AGE
 12881*          MOVE ER-3054          TO WS-ERROR                      ELC50PD
 12882*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 12883     .
 12884 0597-CHECK-AH-LIMITS.                                            ELC50PD
 12885                                                                  ELC50PD
 12886     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12887        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12888           IF SUB2 GREATER THAN +4                                ELC50PD
 12889              MOVE ER-2638       TO WS-ERROR                      ELC50PD
 12890              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12891              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12892                                                                  ELC50PD
 12893     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12894        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12895            SUB2 GREATER THAN +8                                  ELC50PD
 12896             MOVE 'U'            TO PB-BATCH-ENTRY                ELC50PD
 12897             MOVE ER-2638        TO WS-ERROR                      ELC50PD
 12898             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12899             GO TO 0599-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12900                                                                  ELC50PD
 12901     IF SUB2 > +8
 12902        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12903           AND (PB-I-SIG-SW = 'Y')
 12904           CONTINUE
 12905        ELSE
 12906           MOVE ER-2638          TO WS-ERROR
 12907           PERFORM 9900-ERROR-FORMAT
 12908                                 THRU 9900-EXIT
 12909        END-IF
 12910        GO TO 3000-CONTINUE-EDIT
 12911     END-IF
 12912                                                                  ELC50PD
 12913     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12914        IF WS-ERROR = ER-2638                                     ELC50PD
 12915           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12916                                                                  ELC50PD
 12917     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.             ELC50PD
 12918     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.            ELC50PD
 12919     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.         ELC50PD
 12920     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.         ELC50PD
 12921                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 235
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12922     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)            ELC50PD
 12923        ADD +1                   TO SUB2                          ELC50PD
 12924        GO TO 0597-CHECK-AH-LIMITS.                               ELC50PD
 12925                                                                  ELC50PD
 12926     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12927         GO TO 0597-CHECK-NCL-AH-LIMITS.                          ELC50PD
 12928                                                                  ELC50PD
 12929     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 12930        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 12931        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12932                                 > PL-LM-AMT (SUB2))
 12933        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12934           AND (PB-I-SIG-SW = 'Y')
 12935           CONTINUE
 12936        ELSE
 12937           MOVE ER-2638          TO WS-ERROR
 12938           PERFORM 9900-ERROR-FORMAT
 12939                                 THRU 9900-EXIT
 12940        END-IF
 12941     END-IF
 12942                                                                  ELC50PD
 12943     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 12944         IF  WS-ERROR    EQUAL    ER-2638                         ELC50PD
 12945             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2) ELC50PD
 12946                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT   ELC50PD
 12947                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)  ELC50PD
 12948                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS              ELC50PD
 12949                MOVE  ER-1910    TO  WS-ERROR                     ELC50PD
 12950                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 12951                                                                  ELC50PD
 12952     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12953        IF WS-ERROR = ER-2638                                     ELC50PD
 12954            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)      ELC50PD
 12955            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS                  ELC50PD
 12956            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12957                                                                  ELC50PD
 12958     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 12959                                                                  ELC50PD
 12960 0597-CHECK-NCL-AH-LIMITS.                                        ELC50PD
 12961                                                                  ELC50PD
 12962     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND     ELC50PD
 12963        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  ANDELC50PD
 12964        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                     ELC50PD
 12965                            NOT GREATER THAN PL-LM-AMT (SUB2))    ELC50PD
 12966         GO TO 0599-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12967                                                                  ELC50PD
 12968     IF APP-CERT-USED                                             ELC50PD
 12969         IF SUB2  LESS THAN  +5                                   ELC50PD
 12970             MOVE +5             TO SUB2                          ELC50PD
 12971             GO TO 0597-CHECK-AH-LIMITS.                          ELC50PD
 12972                                                                  ELC50PD
 12973     MOVE ER-2638                TO WS-ERROR.                     ELC50PD
 12974     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12975                                                                  ELC50PD
 12976     MOVE 'U'                    TO PB-BATCH-ENTRY.               ELC50PD
 12977                                                                  ELC50PD
 12978 0599-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12979                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 236
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12980     IF NOT APP-CERT-USED                                         ELC50PD
 12981         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12982                                                                  ELC50PD
 12983     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12984        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12985        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12986        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12987         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12988                                                                  ELC50PD
 12989     IF SUB2 GREATER THAN +4                                      ELC50PD
 12990         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
 12991            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 12992            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 12993            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 12994             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 12995             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12996             GO TO 3000-CONTINUE-EDIT                             ELC50PD
 12997         ELSE                                                     ELC50PD
 12998             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 12999                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 13000                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 13001                                                                  ELC50PD
 13002     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 13003       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 13004          NOT PB-I-POLICY-DECLINED                                ELC50PD
 13005           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 13006           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 13007           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 13008                                                                  ELC50PD
 13009******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 237
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13011                                                                  ELC50PD
 13012 3000-CONTINUE-EDIT.                                              ELC50PD
 13013                                                                  ELC50PD
 13014     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.            ELC50PD
 13015     MOVE AM-CSR-CODE            TO PB-CSR-ID.                    ELC50PD
 13016     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.           ELC50PD
 13017     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.          ELC50PD
 13018     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.      ELC50PD
 13019                                                                  ELC50PD
 13020     IF BROWSE-STARTED                                            ELC50PD
 13021        PERFORM 9990-RETURN THRU 9990-EXIT                        ELC50PD
 13022        MOVE SPACES              TO WS-BROWSE-STARTED-SW.         ELC50PD
 13023                                                                  ELC50PD
 13024     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT                  ELC50PD
 13025        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1                 ELC50PD
 13026        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2                 ELC50PD
 13027        SET ELAPSED-BETWEEN-BIN  TO TRUE                          ELC50PD
 13028*       MOVE 1                   TO DC-OPTION-CODE                ELC50PD
 13029        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13030        IF DATE-CONVERSION-ERROR                                  ELC50PD
 13031           MOVE ER-2622          TO WS-ERROR                      ELC50PD
 13032           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13033        ELSE                                                      ELC50PD
 13034           IF DC-ELAPSED-MONTHS   GREATER THAN +2                 ELC50PD
 13035              MOVE ER-2623       TO WS-ERROR                      ELC50PD
 13036              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13037           ELSE                                                   ELC50PD
 13038              MOVE ER-2622       TO WS-ERROR                      ELC50PD
 13039              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 13040                                                                  ELC50PD
 13041     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.                ELC50PD
 13042     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.                ELC50PD
 13043     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13044*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13045     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13046     IF DATE-CONVERSION-ERROR                                     ELC50PD
 13047        GO TO 3005-EDIT-CONTINUE                                  ELC50PD
 13048     ELSE                                                         ELC50PD
 13049        IF DC-ELAPSED-DAYS GREATER +180                           ELC50PD
 13050           MOVE ER-2613          TO WS-ERROR                      ELC50PD
 13051           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13052        ELSE                                                      ELC50PD
 13053           IF DC-ELAPSED-DAYS GREATER +90                         ELC50PD
 13054              MOVE ER-2612       TO WS-ERROR                      ELC50PD
 13055              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13056           ELSE                                                   ELC50PD
 13057             IF DC-ELAPSED-DAYS GREATER +60                       ELC50PD
 13058                MOVE ER-2614     TO WS-ERROR                      ELC50PD
 13059                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 13060                                                                  ELC50PD
 13061 3005-EDIT-CONTINUE.                                              ELC50PD
 13062                                                                  ELC50PD
 13063     IF PB-CANCELLATION                                           ELC50PD
 13064         GO TO 3700-EDIT-CANCEL.                                     CL**2
 13065                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 238
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13067******************************************************************ELC50PD
 13068*                  E D I T   I S S U E                           *ELC50PD
 13069******************************************************************ELC50PD
 13070                                                                  ELC50PD
 13071 3020-EDIT-ISSUE.                                                 ELC50PD
 13072                                                                  ELC50PD
 13073      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.           ELC50PD
 13074      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.      ELC50PD
 13075      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.        ELC50PD
 13076      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.        ELC50PD
 13077      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.                  ELC50PD
 13078                                                                  ELC50PD
 13079     IF PB-ISSUE-FORCE
 13080        OR PB-ISSUE-DATE-FORCED
 13081        OR PB-FORCE-OFF
 13082        OR PB-OVERCHARGE-FORCE
 13083        CONTINUE
 13084     ELSE
 13085        MOVE ER-2670             TO WS-ERROR
 13086        PERFORM 9900-ERROR-FORMAT
 13087                                 THRU 9900-EXIT
 13088     END-IF
 13089
 13090     .
 13091 3022-SET-POLICY-STATUS.                                          ELC50PD
 13092                                                                  ELC50PD
 13093     MOVE '2'                    TO PB-I-ENTRY-STATUS.            ELC50PD
 13094                                                                  ELC50PD
 13095     IF (PB-REISSUED-CERT)
 13096             OR
 13097        ((PB-COMPANY-ID NOT = 'DCC')
 13098         AND (PB-MONTHLY-CERT))
 13099         MOVE '5'                TO PB-I-ENTRY-STATUS
 13100         MOVE 'E'                TO PB-BATCH-ENTRY
 13101     END-IF
 13102
 13103     IF PB-COMPANY-ID = 'DCC'
 13104        IF PB-MONTHLY-CERT
 13105           MOVE 'M'              TO PB-I-ENTRY-STATUS
 13106        END-IF
 13107     END-IF
 13108     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 13109         MOVE 'D'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13110     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 13111         MOVE 'V'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13112     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 13113         MOVE 'U'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13114     IF PB-REIN-ONLY-CERT                                         ELC50PD
 13115         MOVE '9'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13116     IF PB-PREM-ACCTNG-ONLY                                       ELC50PD
 13117         MOVE 'P'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13118                                                                  ELC50PD
 13119     MOVE SPACE                  TO PB-I-OB-FLAG.                 ELC50PD
 13120                                                                  ELC50PD
 13121     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE                 ELC50PD
 13122         MOVE ER-2665            TO WS-ERROR                      ELC50PD
 13123         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13124         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 239
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13125                                                                  ELC50PD
 13126     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 13127        AND WS-AH-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13128           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13129                                                                  ELC50PD
 13130     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 13131        AND WS-LF-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13132           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13133                                                                  ELC50PD
 13134     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13135         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF     ELC50PD
 13136         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH     ELC50PD
 13137         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF       ELC50PD
 13138         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH       ELC50PD
 13139         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE         ELC50PD
 13140         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 13141         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 13142     END-IF
 13143                                                                  ELC50PD
 13144     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13145        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)                ELC50PD
 13146         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.            ELC50PD
 13147                                                                  ELC50PD
 13148     IF (ACCOUNT-MAST-FOUND)
 13149        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 13150        IF PB-REISSUED-CERT
 13151           CONTINUE
 13152        ELSE
 13153           MOVE ER-2608          TO WS-ERROR
 13154           PERFORM 9900-ERROR-FORMAT
 13155                                 THRU 9900-EXIT
 13156         END-IF
 13157     END-IF
 13158                                                                  ELC50PD
 13159     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 13160        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER           ELC50PD
 13161        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.       ELC50PD
 13162                                                                  ELC50PD
 13163**********   DMD CUSTOM CODE FOLLOWS  **********                  ELC50PD
 13164 3024-EDIT-DMD-FIELDS.                                            ELC50PD
 13165     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 13166        GO TO 3025-EDIT-REINSURANCE.                              ELC50PD
 13167                                                                  ELC50PD
 13168*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE          ELC50PD
 13169*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL      ELC50PD
 13170*** ERROR IF THEY ARE NOT EQUAL.                                  ELC50PD
 13171                                                                  ELC50PD
 13172     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.              ELC50PD
 13173     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13174     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13175     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.              CL**3
 13176**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.         CL**3
 13177                                                                  ELC50PD
 13178     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.              ELC50PD
 13179     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13180     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13181     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.           CL**3
 13182**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.           CL**3
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 240
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13183                                                                  ELC50PD
 13184     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM               ELC50PD
 13185        MOVE ER-8116               TO WS-ERROR                    ELC50PD
 13186        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13187                                                                  ELC50PD
 13188     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.             ELC50PD
 13189                                                                  ELC50PD
 13190     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER       ELC50PD
 13191                                      WK-FULL-CERT-NO.            ELC50PD
 13192     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.             ELC50PD
 13193                                                                  ELC50PD
 13194     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.             ELC50PD
 13195                                                                  ELC50PD
 13196     IF PB-VALID-LIFE                                             ELC50PD
 13197        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE               ELC50PD
 13198     ELSE                                                         ELC50PD
 13199        IF PB-VALID-AH                                            ELC50PD
 13200          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.              ELC50PD
 13201                                                                  ELC50PD
 13202                                                                  ELC50PD
 13203     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.         ELC50PD
 13204     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.              ELC50PD
 13205     MOVE SPACES                   TO DCUA-CERT-NUMBER            ELC50PD
 13206                                      DCUA-UNDRWRTR-CODE          ELC50PD
 13207                                      DCUA-UNDRWRTR-GROUP-CODE    ELC50PD
 13208                                      DCUA-RETURN-CODE.           ELC50PD
 13209                                                                  ELC50PD
 13210****************************************************************  ELC50PD
 13211*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***  ELC50PD
 13212***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***  ELC50PD
 13213***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***  ELC50PD
 13214***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***  ELC50PD
 13215***   TO THIS RECORD.                                        ***  ELC50PD
 13216****************************************************************  ELC50PD
 13217     MOVE ' '                      TO WS-DLO-ERROR-SW.            ELC50PD
 13218     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.                        ELC50PD
 13219     IF DCUA-SUCCESSFUL-PROCESS                                   ELC50PD
 13220        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13221                                                                  ELC50PD
 13222     IF DCUA-RETURN-CODE EQUAL '01'                               ELC50PD
 13223        MOVE ER-8110               TO WS-ERROR                    ELC50PD
 13224        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13225        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13226        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13227                                                                  ELC50PD
 13228     IF DCUA-RETURN-CODE EQUAL '02'                               ELC50PD
 13229        MOVE ER-8111               TO WS-ERROR                    ELC50PD
 13230        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13231        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13232        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13233                                                                  ELC50PD
 13234     IF DCUA-RETURN-CODE EQUAL '03'                               ELC50PD
 13235        MOVE ER-8074               TO WS-ERROR                    ELC50PD
 13236        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13237        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13238        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13239                                                                  ELC50PD
 13240     IF DCUA-RETURN-CODE EQUAL '04'                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 241
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13241        MOVE ER-8075               TO WS-ERROR                    ELC50PD
 13242        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13243        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13244        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13245                                                                  ELC50PD
 13246     IF DCUA-RETURN-CODE EQUAL '05'                               ELC50PD
 13247        MOVE ER-8076               TO WS-ERROR                    ELC50PD
 13248        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13249        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13250        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13251                                                                  ELC50PD
 13252     IF DCUA-RETURN-CODE EQUAL '06'                               ELC50PD
 13253        MOVE ER-8077               TO WS-ERROR                    ELC50PD
 13254        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13255        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13256        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13257                                                                  ELC50PD
 13258     IF DCUA-RETURN-CODE EQUAL '07'                               ELC50PD
 13259        MOVE ER-8078               TO WS-ERROR                    ELC50PD
 13260        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13261        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13262        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13263                                                                  ELC50PD
 13264     IF DCUA-RETURN-CODE EQUAL 'E1'                               ELC50PD
 13265        MOVE ER-8079               TO WS-ERROR                    ELC50PD
 13266        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13267        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13268        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13269                                                                  ELC50PD
 13270     IF DCUA-RETURN-CODE EQUAL 'E2'                               ELC50PD
 13271        MOVE ER-8080               TO WS-ERROR                    ELC50PD
 13272        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13273        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13274        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13275                                                                  ELC50PD
 13276     IF DCUA-RETURN-CODE EQUAL 'E3'                               ELC50PD
 13277        MOVE ER-8098               TO WS-ERROR                    ELC50PD
 13278        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13280        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13281                                                                  ELC50PD
 13282     IF DCUA-RETURN-CODE EQUAL 'C1'                               ELC50PD
 13283        MOVE ER-8099               TO WS-ERROR                    ELC50PD
 13284        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13285        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13286        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13287                                                                  ELC50PD
 13288     IF DCUA-RETURN-CODE EQUAL 'U1'                               ELC50PD
 13289        MOVE ER-8109               TO WS-ERROR                    ELC50PD
 13290        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13291        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13292        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13293                                                                  ELC50PD
 13294     IF DCUA-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13295        MOVE ER-8112               TO WS-ERROR                    ELC50PD
 13296        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13297        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13298        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 242
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13299                                                                  ELC50PD
 13300     IF DCUA-RETURN-CODE EQUAL 'N2'                               ELC50PD
 13301        MOVE ER-8113               TO WS-ERROR                    ELC50PD
 13302        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13303        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13304        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13305                                                                  ELC50PD
 13306     IF DCUA-RETURN-CODE EQUAL 'N3'                               ELC50PD
 13307        MOVE ER-8114               TO WS-ERROR                    ELC50PD
 13308        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13310        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13311                                                                  ELC50PD
 13312     MOVE 'Y'                      TO WS-DLO-ERROR-SW.            ELC50PD
 13313     MOVE ER-8097                  TO WS-ERROR.                   ELC50PD
 13314     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.                  ELC50PD
 13315     GO TO 3024-EDIT-DL7-CONT.                                    ELC50PD
 13316                                                                  ELC50PD
 13317 3024-EDIT-DL7-CONT.                                              ELC50PD
 13318                                                                  ELC50PD
 13319     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.               ELC50PD
 13320     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.                ELC50PD
 13321     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE                          ELC50PD
 13322        NEXT SENTENCE                                             ELC50PD
 13323     ELSE                                                         ELC50PD
 13324        MOVE ER-9263               TO WS-ERROR                    ELC50PD
 13325        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13326                                                                  ELC50PD
 13327******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS      ELC50PD
 13328******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...              ELC50PD
 13329     IF DCUA-CERT-NUMBER = PB-CERT-NO                             ELC50PD
 13330        NEXT SENTENCE                                             ELC50PD
 13331     ELSE                                                         ELC50PD
 13332        MOVE ER-8039               TO WS-ERROR                    ELC50PD
 13333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13334                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 243
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13336****************************************************************  ELC50PD
 13337*** VALIDATE STATE  : DLO022                                 ***  ELC50PD
 13338****************************************************************  ELC50PD
 13339     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.            ELC50PD
 13340     MOVE SPACES                   TO DVSC-RETURN-CODE.           ELC50PD
 13341                                                                  ELC50PD
 13342     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.                       ELC50PD
 13343     IF DVSC-SUCCESSFUL-EDIT                                      ELC50PD
 13344        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13345                                                                  ELC50PD
 13346     IF DVSC-RETURN-CODE EQUAL '01'                               ELC50PD
 13347        MOVE ER-8300               TO WS-ERROR                    ELC50PD
 13348        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13349        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13350                                                                  ELC50PD
 13351     IF DVSC-RETURN-CODE EQUAL '02'                               ELC50PD
 13352        MOVE ER-8301               TO WS-ERROR                    ELC50PD
 13353        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13354        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13355                                                                  ELC50PD
 13356     IF DVSC-RETURN-CODE EQUAL '03'                               ELC50PD
 13357        MOVE ER-8302               TO WS-ERROR                    ELC50PD
 13358        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13359        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13360                                                                  ELC50PD
 13361     IF DVSC-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13362        MOVE ER-8304               TO WS-ERROR                    ELC50PD
 13363        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13364        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13365                                                                  ELC50PD
 13366     MOVE ER-8303                  TO WS-ERROR                    ELC50PD
 13367     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13368                                                                  ELC50PD
 13369 3024-EDIT-DL22-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 244
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13371****************************************************************  ELC50PD
 13372*** VALIDATE LOAN OFFICER : DLO021                           ***  ELC50PD
 13373****************************************************************  ELC50PD
 13374                                                                  ELC50PD
 13375     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.         ELC50PD
 13376     MOVE SPACES                    TO DVLO-RETURN-CODE.          ELC50PD
 13377     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.                       ELC50PD
 13378     IF DVLO-SUCCESSFUL-EDIT                                      ELC50PD
 13379        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13380                                                                  ELC50PD
 13381     IF DVLO-RETURN-CODE EQUAL '01'                               ELC50PD
 13382        MOVE ER-8081               TO WS-ERROR                    ELC50PD
 13383        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13384        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13385                                                                  ELC50PD
 13386     IF DVLO-RETURN-CODE EQUAL '02'                               ELC50PD
 13387        MOVE ER-8082               TO WS-ERROR                    ELC50PD
 13388        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13389        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13390                                                                  ELC50PD
 13391     IF DVLO-RETURN-CODE EQUAL '03'                               ELC50PD
 13392        MOVE ER-8083               TO WS-ERROR                    ELC50PD
 13393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13394        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13395                                                                  ELC50PD
 13396     IF DVLO-RETURN-CODE EQUAL '04'                               ELC50PD
 13397        MOVE ER-8084               TO WS-ERROR                    ELC50PD
 13398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13399        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13400                                                                  ELC50PD
 13401     IF DVLO-RETURN-CODE EQUAL '05'                               ELC50PD
 13402        MOVE ER-8085               TO WS-ERROR                    ELC50PD
 13403        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13404        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13405                                                                  ELC50PD
 13406     MOVE ER-7825                  TO WS-ERROR                    ELC50PD
 13407     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13408     GO TO 3024-EDIT-DL21-CONT.                                   ELC50PD
 13409                                                                  ELC50PD
 13410 3024-EDIT-DL21-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 245
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13412                                                                  ELC50PD
 13413****************************************************************  ELC50PD
 13414*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***  ELC50PD
 13415****************************************************************  ELC50PD
 13416                                                                  ELC50PD
 13417     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.                 ELC50PD
 13418     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.      ELC50PD
 13419     MOVE SPACES                 TO DIPF-RETURN-CODE.             ELC50PD
 13420     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.                       ELC50PD
 13421     IF DIPF-SUCCESSFUL-EDIT                                      ELC50PD
 13422        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13423                                                                  ELC50PD
 13424     IF DIPF-RETURN-CODE EQUAL '01'                               ELC50PD
 13425        MOVE ER-8086               TO WS-ERROR                    ELC50PD
 13426        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13427        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13428                                                                  ELC50PD
 13429     IF DIPF-RETURN-CODE EQUAL '02'                               ELC50PD
 13430        MOVE ER-8087               TO WS-ERROR                    ELC50PD
 13431        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13432        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13433                                                                  ELC50PD
 13434     IF DIPF-RETURN-CODE EQUAL '03'                               ELC50PD
 13435        MOVE ER-8088               TO WS-ERROR                    ELC50PD
 13436        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13437        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13438                                                                  ELC50PD
 13439     MOVE ER-8095                  TO WS-ERROR                    ELC50PD
 13440     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13441     GO TO 3024-EDIT-DL02-CONT.                                   ELC50PD
 13442                                                                  ELC50PD
 13443 3024-EDIT-DL02-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 246
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13445                                                                  ELC50PD
 13446****************************************************************  ELC50PD
 13447*** VALIDATE BANK ID : DLO003                                ***  ELC50PD
 13448****************************************************************  ELC50PD
 13449                                                                  ELC50PD
 13450     MOVE WK-GREG-CENT           TO WCG-CENT.                     ELC50PD
 13451     MOVE WK-GREG-YYMM           TO WCG-REST.                     ELC50PD
 13452     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG                         ELC50PD
 13453        MOVE ER-8040               TO WS-ERROR                    ELC50PD
 13454        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13455                                                                  ELC50PD
 13456     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.                  ELC50PD
 13457     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.                ELC50PD
 13458     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.           ELC50PD
 13459     MOVE SPACES                 TO  DVBI-RETURN-CODE.            ELC50PD
 13460     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.                  ELC50PD
 13461     IF DVBI-SUCCESSFUL-EDIT                                      ELC50PD
 13462        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13463                                                                  ELC50PD
 13464     IF DVBI-RETURN-CODE EQUAL '01'                               ELC50PD
 13465        MOVE ER-8089               TO WS-ERROR                    ELC50PD
 13466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13467        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13468                                                                  ELC50PD
 13469     IF DVBI-RETURN-CODE EQUAL '02'                               ELC50PD
 13470        MOVE ER-8090               TO WS-ERROR                    ELC50PD
 13471        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13472        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13473                                                                  ELC50PD
 13474     IF DVBI-RETURN-CODE EQUAL '03'                               ELC50PD
 13475        MOVE ER-8091               TO WS-ERROR                    ELC50PD
 13476        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13477        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13478                                                                  ELC50PD
 13479     IF DVBI-RETURN-CODE EQUAL '04'                               ELC50PD
 13480        MOVE ER-8092               TO WS-ERROR                    ELC50PD
 13481        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13482        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13483                                                                  ELC50PD
 13484     IF DVBI-RETURN-CODE EQUAL '05'                               ELC50PD
 13485        MOVE ER-8093               TO WS-ERROR                    ELC50PD
 13486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13487        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13488                                                                  ELC50PD
 13489     IF DVBI-RETURN-CODE EQUAL '06'                               ELC50PD
 13490        MOVE ER-8094               TO WS-ERROR                    ELC50PD
 13491        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13492        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13493                                                                  ELC50PD
 13494     MOVE ER-8096                  TO WS-ERROR                    ELC50PD
 13495     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13496     GO TO 3024-EDIT-DL03-CONT.                                   ELC50PD
 13497                                                                  ELC50PD
 13498 3024-EDIT-DL03-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 247
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13500                                                                  ELC50PD
 13501     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR               ELC50PD
 13502        NEXT SENTENCE                                             ELC50PD
 13503     ELSE                                                         ELC50PD
 13504        MOVE ER-8042               TO WS-ERROR                    ELC50PD
 13505        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13506                                                                  ELC50PD
 13507     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.     ELC50PD
 13508     MOVE SPACES                 TO  DMPF-RETURN-CODE.            ELC50PD
 13509     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.                       ELC50PD
 13510                                                                  ELC50PD
 13511     IF DMPF-RETURN-CODE = '01'                                   ELC50PD
 13512        MOVE ER-8067               TO WS-ERROR                    ELC50PD
 13513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13514        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13515                                                                  ELC50PD
 13516     IF DMPF-RETURN-CODE = '02'                                   ELC50PD
 13517        MOVE ER-8068               TO WS-ERROR                    ELC50PD
 13518        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13519        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13520                                                                  ELC50PD
 13521     IF DMPF-RETURN-CODE = '03'                                   ELC50PD
 13522        MOVE ER-8069               TO WS-ERROR                    ELC50PD
 13523        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13524        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13525                                                                  ELC50PD
 13526     IF DMPF-RETURN-CODE = 'E1'                                   ELC50PD
 13527        MOVE ER-8070               TO WS-ERROR                    ELC50PD
 13528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13529        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13530                                                                  ELC50PD
 13531     IF DMPF-RETURN-CODE = 'N1'                                   ELC50PD
 13532        MOVE ER-8071               TO WS-ERROR                    ELC50PD
 13533        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13534        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13535                                                                  ELC50PD
 13536     IF DMPF-RETURN-CODE NOT = 'OK'                               ELC50PD
 13537        MOVE ER-8072               TO WS-ERROR                    ELC50PD
 13538        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13539                                                                  ELC50PD
 13540 3024-EDIT-DL01-CONT.                                             ELC50PD
 13541******************************************************************ELC50PD
 13542***  VALIDATES RATE CODES : DLO017                             ***ELC50PD
 13543******************************************************************ELC50PD
 13544                                                                  ELC50PD
 13545      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.            ELC50PD
 13546      MOVE SPACES                   TO DVRC-RETURN-CODE.          ELC50PD
 13547      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.                      ELC50PD
 13548      IF DVRC-SUCCESSFUL-EDIT                                     ELC50PD
 13549        MOVE 'Y'                   TO WK-VALID-RATE-CODE          ELC50PD
 13550        GO TO 3024-CHECK-VALID-RATE.                              ELC50PD
 13551                                                                  ELC50PD
 13552      MOVE 'N'                     TO WK-VALID-RATE-CODE.         ELC50PD
 13553                                                                  ELC50PD
 13554      IF DVRC-RETURN-CODE EQUAL '01'                              ELC50PD
 13555         MOVE ER-7817                   TO WS-ERROR               ELC50PD
 13556         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13557         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 248
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13558                                                                  ELC50PD
 13559      IF DVRC-RETURN-CODE EQUAL '02'                              ELC50PD
 13560         MOVE ER-7818                   TO WS-ERROR               ELC50PD
 13561         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13562         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13563                                                                  ELC50PD
 13564      IF DVRC-RETURN-CODE EQUAL '03'                              ELC50PD
 13565         MOVE ER-7819                   TO WS-ERROR               ELC50PD
 13566         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13567         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13568                                                                  ELC50PD
 13569       MOVE ER-7820                     TO WS-ERROR.              ELC50PD
 13570       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13571       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13572                                                                  ELC50PD
 13573******************************************************************ELC50PD
 13574***  GET PREMIUM RATES : DLO011                                ***ELC50PD
 13575******************************************************************ELC50PD
 13576                                                                  ELC50PD
 13577 3024-CHECK-VALID-RATE.                                           ELC50PD
 13578                                                                  ELC50PD
 13579     IF VALID-RATE-CODE                                           ELC50PD
 13580        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE              ELC50PD
 13581        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG         ELC50PD
 13582        MOVE SPACES                TO DPRB-RETURN-CODE            ELC50PD
 13583        PERFORM 7740-CALL-DL11 THRU 7740-EXIT                     ELC50PD
 13584     ELSE                                                         ELC50PD
 13585         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13586                                                                  ELC50PD
 13587      IF DPRB-SUCCESSFUL-PROCESS                                  ELC50PD
 13588         IF PB-VALID-LIFE                                         ELC50PD
 13589             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE           ELC50PD
 13590             GO TO 3025-EDIT-REINSURANCE                          ELC50PD
 13591         ELSE                                                     ELC50PD
 13592             IF PB-VALID-AH                                       ELC50PD
 13593                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE           ELC50PD
 13594                 GO TO 3025-EDIT-REINSURANCE.                     ELC50PD
 13595                                                                  ELC50PD
 13596      IF DPRB-RETURN-CODE EQUAL '01'                              ELC50PD
 13597         MOVE ER-7812                   TO WS-ERROR               ELC50PD
 13598         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13599         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13600                                                                  ELC50PD
 13601      IF DPRB-RETURN-CODE EQUAL '02'                              ELC50PD
 13602         MOVE ER-7813                   TO WS-ERROR               ELC50PD
 13603         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13604         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13605                                                                  ELC50PD
 13606      IF DPRB-RETURN-CODE EQUAL '03'                              ELC50PD
 13607         MOVE ER-7814                   TO WS-ERROR               ELC50PD
 13608         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13609         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13610                                                                  ELC50PD
 13611      IF DPRB-RETURN-CODE EQUAL '04'                              ELC50PD
 13612         IF NOT DPRB-1ST-TIME                                     ELC50PD
 13613            MOVE ER-7815                   TO WS-ERROR            ELC50PD
 13614            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 13615            GO TO 3025-EDIT-REINSURANCE                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 249
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13616          ELSE                                                    ELC50PD
 13617         IF PB-VALID-LIFE                                         ELC50PD
 13618            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13619          ELSE                                                    ELC50PD
 13620            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13621         END-IF                                                   ELC50PD
 13622         MOVE SPACES                TO DOCC-RETURN-CODE           ELC50PD
 13623         MOVE 'X'                   TO DPRB-1ST-TIME-SW           ELC50PD
 13624         PERFORM 7755-CALL-DL19 THRU 7755-EXIT                    ELC50PD
 13625         IF DOCC-RETURN-CODE = 'OK'                               ELC50PD
 13626             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4          ELC50PD
 13627             GO TO 3024-CHECK-VALID-RATE                          ELC50PD
 13628           ELSE                                                   ELC50PD
 13629             MOVE ER-7823               TO WS-ERROR               ELC50PD
 13630             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT            ELC50PD
 13631             GO TO 3025-EDIT-REINSURANCE.                         ELC50PD
 13632                                                                  ELC50PD
 13633       MOVE ER-7816                     TO WS-ERROR.              ELC50PD
 13634       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13635       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13636                                                                  ELC50PD
 13637**********   DMD CUSTOM CODE ABOVE    **********                  ELC50PD
 13638                                                                  ELC50PD
 13639 3025-EDIT-REINSURANCE.                                           ELC50PD
 13640     IF PB-I-SPECIAL-REIN-CODE = SPACE                            ELC50PD
 13641         GO TO 3027-EDIT-CONTINUE.                                ELC50PD
 13642                                                                  ELC50PD
 13643     MOVE LOW-VALUES               TO ERREIN-KEY.                 ELC50PD
 13644     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.               ELC50PD
 13645     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1                 ELC50PD
 13646                                      REIN-CODE-2                 ELC50PD
 13647                                      REIN-CODE-3.                ELC50PD
 13648     MOVE 'A'                      TO REIN-TYPE.                  ELC50PD
 13649                                                                  ELC50PD
 13650     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.            ELC50PD
 13651                                                                  ELC50PD
 13652     MOVE '3026' TO REIN-SW.                                      ELC50PD
 13653     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13654                                                                  ELC50PD
 13655     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13656     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13657         GO TO 3026-NO-SPEC-TABLE.                                ELC50PD
 13658                                                                  ELC50PD
 13659     MOVE RE-TABLE              TO WK-REIN-TABLE.                 ELC50PD
 13660     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13661                                   WS-NSP-ST-CD-LF.               ELC50PD
 13662     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13663                                   WS-NSP-ST-CD-AH.               ELC50PD
 13664                                                                  ELC50PD
 13665     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13666                                                                  ELC50PD
 13667 3026-NO-SPEC-TABLE.                                              ELC50PD
 13668                                                                  ELC50PD
 13669     MOVE ER-2664                TO WS-ERROR.                     ELC50PD
 13670     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13671     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13672                                                                  ELC50PD
 13673 3027-EDIT-CONTINUE.                                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 250
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13674                                                                  ELC50PD
 13675     IF PB-I-REIN-TABLE = SPACES                                  ELC50PD
 13676       GO TO 3040-EDIT-CONTINUE.                                  ELC50PD
 13677                                                                  ELC50PD
 13678     IF PB-I-REIN-TABLE = WK-REIN-TABLE                           ELC50PD
 13679          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF               ELC50PD
 13680          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH               ELC50PD
 13681           GO TO 3040-EDIT-CONTINUE.                              ELC50PD
 13682                                                                  ELC50PD
 13683     MOVE LOW-VALUES            TO ERREIN-KEY.                    ELC50PD
 13684     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.                  ELC50PD
 13685     MOVE 'A'                   TO REIN-TYPE.                     ELC50PD
 13686     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.                 ELC50PD
 13687                                                                  ELC50PD
 13688     MOVE '3028'                TO REIN-SW.                       ELC50PD
 13689     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13690                                                                  ELC50PD
 13691     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13692     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13693         GO TO 3028-NO-REIN-TABLE.                                ELC50PD
 13694                                                                  ELC50PD
 13695     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.                 ELC50PD
 13696     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13697                                   WS-NSP-ST-CD-LF.               ELC50PD
 13698     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13699                                   WS-NSP-ST-CD-AH.               ELC50PD
 13700                                                                  ELC50PD
 13701     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13702                                                                  ELC50PD
 13703 3028-NO-REIN-TABLE.                                              ELC50PD
 13704                                                                  ELC50PD
 13705     MOVE ER-2615                TO WS-ERROR.                     ELC50PD
 13706     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13707     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13708                                                                  ELC50PD
 13709 3040-EDIT-CONTINUE.                                              ELC50PD
 13710                                                                  ELC50PD
 13711     IF PB-I-LF-PREM-CALC NOT NUMERIC                             ELC50PD
 13712         MOVE ZEROS              TO PB-I-LF-PREM-CALC.            ELC50PD
 13713                                                                  ELC50PD
 13714     IF PB-I-AH-PREM-CALC NOT NUMERIC                             ELC50PD
 13715         MOVE ZEROS              TO PB-I-AH-PREM-CALC.            ELC50PD
 13716                                                                  ELC50PD
 13717     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13718        AND (NOT PB-MONTHLY-CERT)
 13719        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')     ELC50PD
 13720            MOVE '001'           TO PB-I-LF-TERM                  ELC50PD
 13721            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13722                                                                  ELC50PD
 13723     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13724        AND (NOT PB-MONTHLY-CERT)
 13725        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')     ELC50PD
 13726            MOVE '001'           TO PB-I-AH-TERM                  ELC50PD
 13727            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13728                                                                  ELC50PD
 13729 3040-EDIT-1ST-PMT-DT.                                            ELC50PD
 13730
 13731     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 251
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13732     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 13733         MOVE ZEROS TO PB-I-EXTENTION-DAYS.                       ELC50PD
 13734                                                                  ELC50PD
 13735******************************************************************ELC50PD
 13736*                                                                *ELC50PD
 13737*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *ELC50PD
 13738*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *ELC50PD
 13739*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *ELC50PD
 13740*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *ELC50PD
 13741*                                                                *ELC50PD
 13742******************************************************************ELC50PD
 13743                                                                  ELC50PD
 13744     IF PB-EFF-DT-PROCESSING                                      ELC50PD
 13745        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13746                                    PB-I-LF-EXPIRE-DT             ELC50PD
 13747                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13748        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13749        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1                 ELC50PD
 13750        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13751        MOVE +1                  TO DC-ELAPSED-MONTHS             ELC50PD
 13752        SET BIN-PLUS-ELAPSED     TO TRUE                          ELC50PD
 13753*       MOVE 6                   TO DC-OPTION-CODE                ELC50PD
 13754        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13755        IF NO-CONVERSION-ERROR                                    ELC50PD
 13756           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.              ELC50PD
 13757                                                                  ELC50PD
 13758******************************************************************ELC50PD
 13759*                                                                *ELC50PD
 13760*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *ELC50PD
 13761*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *ELC50PD
 13762*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13763*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *ELC50PD
 13764*                                                                *ELC50PD
 13765******************************************************************ELC50PD
 13766                                                                  ELC50PD
 13767     IF PB-EXT-DAYS-PROCESSING                                    ELC50PD
 13768          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT          ELC50PD
 13769                                         PB-I-LF-EXPIRE-DT        ELC50PD
 13770                                         PB-I-AH-EXPIRE-DT        ELC50PD
 13771          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1            ELC50PD
 13772          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 13773          MOVE +1                     TO DC-ELAPSED-MONTHS        ELC50PD
 13774          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS          ELC50PD
 13775          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13776*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 13777          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13778          IF NO-CONVERSION-ERROR                                  ELC50PD
 13779             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.         ELC50PD
 13780                                                                  ELC50PD
 13781******************************************************************ELC50PD
 13782*                                                                *ELC50PD
 13783*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *ELC50PD
 13784*        BASED ON THE OLDEST EXPIRE DATE.                        *ELC50PD
 13785*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13786*        (EXPIRE DATE - (TERM -1))  *  -1.                        ELC50PD
 13787*                                                                *ELC50PD
 13788******************************************************************ELC50PD
 13789                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 252
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13790     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13791        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT       ELC50PD
 13792           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13793              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13794              MOVE PB-I-AH-TERM      TO WS-TERM                   ELC50PD
 13795           ELSE                                                   ELC50PD
 13796              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13797              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13798        ELSE                                                      ELC50PD
 13799           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13800              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13801              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13802           ELSE                                                   ELC50PD
 13803              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13804              MOVE PB-I-AH-TERM      TO WS-TERM.                  ELC50PD
 13805                                                                  ELC50PD
 13806     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13807        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13808        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13809        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1                 ELC50PD
 13810        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13811                                    DC-ODD-DAYS-OVER              ELC50PD
 13812          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1          ELC50PD
 13813          SET BIN-PLUS-ELAPSED    TO TRUE                         ELC50PD
 13814*         MOVE 6                  TO DC-OPTION-CODE               ELC50PD
 13815          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13816          IF NO-CONVERSION-ERROR                                  ELC50PD
 13817             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.            ELC50PD
 13818                                                                  ELC50PD
 13819******************************************************************ELC50PD
 13820*                                                                *ELC50PD
 13821*            1ST PAYMENT DATE PROCESSING                         *ELC50PD
 13822*                                                                *ELC50PD
 13823******************************************************************ELC50PD
 13824                                                                  ELC50PD
 13825     IF PB-1ST-PMT-DT-PROCESSING                                  ELC50PD
 13826        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT             ELC50PD
 13827                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13828        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.          ELC50PD
 13829                                                                  ELC50PD
 13830     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT              ELC50PD
 13831         NEXT SENTENCE                                            ELC50PD
 13832     ELSE                                                         ELC50PD
 13833         MOVE ER-2680                 TO WS-ERROR                 ELC50PD
 13834         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13835         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 13836                                                                  ELC50PD
 13837     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 13838     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.                ELC50PD
 13839     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13840*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13841     MOVE ZEROS                  TO DC-ELAPSED-MONTHS             ELC50PD
 13842                                    DC-ELAPSED-DAYS               ELC50PD
 13843                                    DC-ODD-DAYS-OVER.             ELC50PD
 13844                                                                  ELC50PD
 13845     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13846                                                                  ELC50PD
 13847     IF DATE-CONVERSION-ERROR                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 253
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13848        GO TO 3060-ORIG-TERM-CHECK.                               ELC50PD
 13849                                                                  ELC50PD
 13850     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 13851
 13852     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13853        AND (WS-LF-COVERAGE-TYPE = 'L')
 13854        IF (DC-ELAPSED-MONTHS > 1)
 13855                      OR
 13856           ((DC-ELAPSED-MONTHS = 1)
 13857           AND (DC-ODD-DAYS-OVER > 0))
 13858           MOVE ER-2882          TO WS-ERROR
 13859           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13860        END-IF
 13861     END-IF
 13862
 13863     if dc-elapsed-months > 0
 13864        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 13865        + dc-odd-days-over
 13866     end-if
 13867
 13868     IF PB-EXT-DAYS-PROCESSING
 13869        CONTINUE
 13870     ELSE
 13871        IF DC-ELAPSED-MONTHS = +0
 13872           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 13873        ELSE
 13874           IF (WS-LF-EARNINGS-CALC = '4')
 13875              AND (DC-ELAPSED-MONTHS > ZERO)
 13876              AND (DC-ELAPSED-DAYS > ZERO)
 13877              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 13878           ELSE
 13879              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 13880                                 THRU 6499-EXIT
 13881              MOVE WS-ODD-DAYS-OVER
 13882                                 TO PB-I-EXTENTION-DAYS
 13883           END-IF
 13884        END-IF
 13885     END-IF
 13886
 13887******************************************************************ELC50PD
 13888*                                                                *ELC50PD
 13889*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *ELC50PD
 13890*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *ELC50PD
 13891*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *ELC50PD
 13892*            AND ANY ODD DAYS.                                   *ELC50PD
 13893*                                                                *ELC50PD
 13894******************************************************************ELC50PD
 13895                                                                  ELC50PD
 13896     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -                  ELC50PD
 13897                              (EC-ST-FST-PMT-DAYS-MAX + 32)       ELC50PD
 13898     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13899        IF DC-ELAPSED-DAYS > ZEROS
 13900           MOVE ER-2681          TO WS-ERROR
 13901           PERFORM 9900-ERROR-FORMAT
 13902                                 THRU 9900-EXIT
 13903        END-IF
 13904     END-IF
 13905                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 254
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13906     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13907        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX     ELC50PD
 13908           MOVE ER-2681          TO WS-ERROR                      ELC50PD
 13909           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 13910                                                                  ELC50PD
 13911     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 13912        (PB-I-LF-TERM NOT = ZERO) AND                             ELC50PD
 13913         NOT NO-LIFE-COVERAGE                                     ELC50PD
 13914          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1                 ELC50PD
 13915          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1           ELC50PD
 13916          IF WS-LF-EARNINGS-CALC = '4'
 13917             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 13918             PB-I-PAY-FREQUENCY
 13919          END-IF
 13920          MOVE ZERO              TO DC-ELAPSED-DAYS               ELC50PD
 13921                                    DC-ODD-DAYS-OVER              ELC50PD
 13922          MOVE 1                 TO DC-END-OF-MONTH               ELC50PD
 13923          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13924*         MOVE 6                 TO DC-OPTION-CODE                ELC50PD
 13925          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13926          IF NO-CONVERSION-ERROR                                  ELC50PD
 13927             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT        ELC50PD
 13928             IF (WS-LF-EARNINGS-CALC = 'B') AND                   ELC50PD
 13929                (WS-LF-SPECIAL-CALC-CD = 'L')                     ELC50PD
 13930                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1         ELC50PD
 13931                  MOVE ZERO           TO DC-ELAPSED-DAYS          ELC50PD
 13932                  MOVE +1             TO DC-ELAPSED-MONTHS        ELC50PD
 13933                  SET BIN-PLUS-ELAPSED  TO TRUE                   ELC50PD
 13934*                 MOVE 6              TO DC-OPTION-CODE           ELC50PD
 13935                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT        ELC50PD
 13936                  IF NO-CONVERSION-ERROR                          ELC50PD
 13937                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.     ELC50PD
 13938                                                                  ELC50PD
 13939* okay, i had to move the new att age edit down here because the
 13940* expiration date could get recalculated and i need the exp date
 13941
 13942
 13943     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 13944        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 13945        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13946        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13947           AND ZEROS
 13948           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13949           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13950           SET ELAPSED-BETWEEN-BIN TO TRUE
 13951           PERFORM 8500-DATE-CONVERT
 13952                                 THRU 8500-EXIT
 13953           IF NO-CONVERSION-ERROR
 13954              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 13955                 MOVE ER-2669       TO WS-ERROR
 13956*                PERFORM 9900-ERROR-FORMAT
 13957*                                THRU 9900-EXIT
 13958              END-IF
 13959           END-IF
 13960        ELSE
 13961           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13962           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 13963              MOVE ER-2669       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 255
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13964*             PERFORM 9900-ERROR-FORMAT
 13965*                                THRU 9900-EXIT
 13966           ELSE
 13967              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 13968                 MOVE ER-1570    TO WS-ERROR
 13969                 PERFORM 9900-ERROR-FORMAT
 13970                                 THRU 9900-EXIT
 13971              END-IF
 13972           END-IF
 13973        END-IF
 13974
 13975        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13976           AND ZEROS
 13977           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 13978           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13979           SET ELAPSED-BETWEEN-BIN TO TRUE
 13980           PERFORM 8500-DATE-CONVERT
 13981                                 THRU 8500-EXIT
 13982           IF NO-CONVERSION-ERROR
 13983              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 13984                 MOVE ER-2669       TO WS-ERROR
 13985*                PERFORM 9900-ERROR-FORMAT
 13986*                                THRU 9900-EXIT
 13987              END-IF
 13988           END-IF
 13989        ELSE
 13990           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13991             (PB-I-LF-TERM / 12)
 13992           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 13993              MOVE ER-2669       TO WS-ERROR
 13994*             PERFORM 9900-ERROR-FORMAT
 13995*                                THRU 9900-EXIT
 13996           ELSE
 13997              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 13998                 MOVE ER-1571    TO WS-ERROR
 13999                 PERFORM 9900-ERROR-FORMAT
 14000                                 THRU 9900-EXIT
 14001              END-IF
 14002           END-IF
 14003        END-IF
 14004        IF WS-ERROR = ER-2669
 14005           PERFORM 9900-ERROR-FORMAT
 14006                                 THRU 9900-EXIT
 14007        END-IF
 14008
 14009     END-IF
 14010
 14011     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 14012        (PB-I-AH-TERM NOT = ZERO) AND                             ELC50PD
 14013         NOT NO-AH-COVERAGE                                       ELC50PD
 14014          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 14015             AND (PB-COMPANY-ID = 'DCC')
 14016             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 14017             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 14018          ELSE
 14019             IF WS-LF-EARNINGS-CALC = '4'
 14020                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 14021                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 256
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14022                PB-I-PAY-FREQUENCY
 14023             ELSE
 14024                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 14025                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 14026             END-IF
 14027          END-IF
 14028          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 14029                                         DC-ODD-DAYS-OVER         ELC50PD
 14030          MOVE 1                      TO DC-END-OF-MONTH          ELC50PD
 14031          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 14032*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 14033          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 14034          IF NO-CONVERSION-ERROR                                  ELC50PD
 14035             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.       ELC50PD
 14036
 14037     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 14038        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 14039        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14040        IF PB-I-BIRTHDAY > LOW-VALUES
 14041           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14042           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14043           SET ELAPSED-BETWEEN-BIN TO TRUE
 14044           PERFORM 8500-DATE-CONVERT
 14045                                 THRU 8500-EXIT
 14046           IF NO-CONVERSION-ERROR
 14047              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14048                 MOVE ER-3054       TO WS-ERROR
 14049*                PERFORM 9900-ERROR-FORMAT
 14050*                                THRU 9900-EXIT
 14051              END-IF
 14052           END-IF
 14053        ELSE
 14054           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14055           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 14056              MOVE ER-3054       TO WS-ERROR
 14057*             PERFORM 9900-ERROR-FORMAT
 14058*                                THRU 9900-EXIT
 14059           END-IF
 14060        END-IF
 14061
 14062        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14063           AND ZEROS
 14064           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 14065           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14066           SET ELAPSED-BETWEEN-BIN TO TRUE
 14067           PERFORM 8500-DATE-CONVERT
 14068                                 THRU 8500-EXIT
 14069           IF NO-CONVERSION-ERROR
 14070              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14071                 MOVE ER-3054       TO WS-ERROR
 14072*                PERFORM 9900-ERROR-FORMAT
 14073*                                THRU 9900-EXIT
 14074              END-IF
 14075           END-IF
 14076        ELSE
 14077           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14078             (PB-I-AH-TERM / 12)
 14079           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 257
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14080              MOVE ER-3054       TO WS-ERROR
 14081*             PERFORM 9900-ERROR-FORMAT
 14082*                                THRU 9900-EXIT
 14083           END-IF
 14084        END-IF
 14085        IF WS-ERROR = ER-3054
 14086           PERFORM 9900-ERROR-FORMAT
 14087                                 THRU 9900-EXIT
 14088        END-IF
 14089
 14090     END-IF
 14091
 14092     MOVE SPACE                       TO DC-END-OF-MONTH.         ELC50PD
 14093                                                                  ELC50PD
 14094     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14095        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14096                                                                     CL**6
 14097     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14098       AND                                                        ELC50PD
 14099        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14100        NEXT SENTENCE                                             ELC50PD
 14101     ELSE                                                            CL**6
 14102        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14103                                                                     CL**6
 14104     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT             ELC50PD
 14105        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14106        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2                 ELC50PD
 14107     ELSE                                                         ELC50PD
 14108        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14109        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.                ELC50PD
 14110                                                                  ELC50PD
 14111     SET ELAPSED-BETWEEN-BIN TO TRUE.                             ELC50PD
 14112*    MOVE '1'      TO DC-OPTION-CODE                              ELC50PD
 14113     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                     ELC50PD
 14114     IF (NO-CONVERSION-ERROR)
 14115        AND (DC-ELAPSED-MONTHS > +1)
 14116        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 14117        MOVE ER-2668   TO WS-ERROR                                ELC50PD
 14118        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14119                                                                  ELC50PD
 14120 3040-EDIT-EXTENSION-DAYS.                                        ELC50PD
 14121                                                                  ELC50PD
 14122     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 14123        AND (PB-COMPANY-ID NOT EQUAL 'CSL')                       ELC50PD
 14124         GO TO 3050-EDIT-TERM-IN-DAYS                             ELC50PD
 14125     ELSE                                                         ELC50PD
 14126         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.             ELC50PD
 14127                                                                  ELC50PD
 14128     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 14129         MOVE ZEROS             TO PB-I-EXTENTION-DAYS            ELC50PD
 14130     ELSE                                                         ELC50PD
 14131        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)         ELC50PD
 14132           AND (WS-LF-EARNINGS-CALC NOT = '4')                    ELC50PD
 14133           MOVE ER-2681         TO WS-ERROR                       ELC50PD
 14134           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14135                                                                  ELC50PD
 14136     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR                        ELC50PD
 14137        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 258
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14138        (PB-I-AH-EXPIRE-DT = LOW-VALUES)                          ELC50PD
 14139         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 14140                                                                  ELC50PD
 14141     GO TO 3060-ORIG-TERM-CHECK.                                  ELC50PD
 14142                                                                  ELC50PD
 14143 3050-EDIT-TERM-IN-DAYS.                                          ELC50PD
 14144                                                                  ELC50PD
 14145     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.          ELC50PD
 14146                                                                  ELC50PD
 14147     IF PB-I-TERM-IN-DAYS NOT NUMERIC                             ELC50PD
 14148         MOVE ZEROS              TO PB-I-TERM-IN-DAYS             ELC50PD
 14149     ELSE                                                         ELC50PD
 14150         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO               ELC50PD
 14151            MOVE ER-2682         TO WS-ERROR                      ELC50PD
 14152            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14153                                                                  ELC50PD
 14154     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM        ELC50PD
 14155                                       REMAINDER WS-WORK-TERM.    ELC50PD
 14156     IF WS-WORK-TERM GREATER THAN ZERO                            ELC50PD
 14157         ADD +1 TO PB-I-LF-TERM.                                  ELC50PD
 14158                                                                  ELC50PD
 14159     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14160         MOVE ER-2684            TO WS-ERROR                      ELC50PD
 14161         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14162                                                                  ELC50PD
 14163                                                                  ELC50PD
 14164 3060-ORIG-TERM-CHECK.                                            ELC50PD
 14165                                                                  ELC50PD
 14166******************************************************************ELC50PD
 14167*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS                ELC50PD
 14168******************************************************************ELC50PD
 14169                                                                  ELC50PD
 14170     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14171        NEXT SENTENCE                                             ELC50PD
 14172     ELSE                                                         ELC50PD
 14173        IF NOT NO-LIFE-COVERAGE                                   ELC50PD
 14174           IF PB-I-LF-TERM NUMERIC                                ELC50PD
 14175              AND (PB-I-LF-TERM GREATER THAN ZERO)                ELC50PD
 14176              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)     ELC50PD
 14177              AND (PB-I-LF-TERM NOT GREATER THAN +360)            ELC50PD
 14178                  NEXT SENTENCE                                   ELC50PD
 14179           ELSE                                                   ELC50PD
 14180              MOVE ER-2647       TO WS-ERROR                      ELC50PD
 14181              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14182                                                                  ELC50PD
 14183     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14184         IF PB-I-AH-TERM NUMERIC                                  ELC50PD
 14185            AND (PB-I-AH-TERM GREATER THAN ZERO)                  ELC50PD
 14186            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)       ELC50PD
 14187            AND (PB-I-AH-TERM NOT GREATER THAN +360)              ELC50PD
 14188             NEXT SENTENCE                                        ELC50PD
 14189          ELSE                                                    ELC50PD
 14190              MOVE ER-2658       TO WS-ERROR                      ELC50PD
 14191              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14192                                                                  ELC50PD
 14193     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14194        GO TO 3070-LOAN-TERM-CHECK.                                  CL**6
 14195                                                                     CL**6
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 259
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14196     IF POLICY-HAS-AH                                             ELC50PD
 14197       AND                                                        ELC50PD
 14198        POLICY-HAS-LIFE                                           ELC50PD
 14199       AND                                                        ELC50PD
 14200        PB-I-LF-TERM NUMERIC                                      ELC50PD
 14201       AND                                                        ELC50PD
 14202        PB-I-AH-TERM NUMERIC                                      ELC50PD
 14203        NEXT SENTENCE                                             ELC50PD
 14204     ELSE                                                         ELC50PD
 14205        GO TO 3070-LOAN-TERM-CHECK.                               ELC50PD
 14206                                                                  ELC50PD
 14207     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).   ELC50PD
 14208     IF WS-TEX-FACT-2 LESS THAN +0                                ELC50PD
 14209        MULTIPLY +1 BY WS-TEX-FACT-2.                             ELC50PD
 14210                                                                  ELC50PD
 14211     IF WS-TEX-FACT-2 GREATER THAN +1                             ELC50PD
 14212        MOVE ER-2668             TO WS-ERROR                      ELC50PD
 14213        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14214                                                                  ELC50PD
 14215 3070-LOAN-TERM-CHECK.                                            ELC50PD
 14216                                                                  ELC50PD
 14217     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14218         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14219            GO TO 3125-EDIT-PMT-FREQ.                             ELC50PD
 14220
 14221*    IF PB-COMPANY-ID NOT = 'DCC'
 14222*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 14223*          AND 'V' AND 'W' AND 'X'
 14224*          GO TO 3125-EDIT-PMT-FREQ
 14225*       END-IF
 14226*    ELSE
 14227*       IF WS-AH-DCC-TRUNC = 'T'
 14228*          CONTINUE
 14229*       ELSE
 14230*          GO TO 3125-EDIT-PMT-FREQ
 14231*       END-IF
 14232*    END-IF
 14233
 14234
 14235
 14236     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14237                    OR
 14238        ((PB-COMPANY-ID = 'DCC')
 14239        AND (WS-AH-DCC-TRUNC = 'T'))
 14240        CONTINUE
 14241     ELSE
 14242        GO TO 3125-EDIT-PMT-FREQ
 14243     END-IF
 14244
 14245     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 14246         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 14247                                                                  ELC50PD
 14248     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND          ELC50PD
 14249        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND          ELC50PD
 14250*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND          ELC50PD
 14251        PB-I-LOAN-TERM NOT GREATER THAN +360                      ELC50PD
 14252         NEXT SENTENCE                                            ELC50PD
 14253     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 260
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14254         MOVE ER-2648            TO WS-ERROR                      ELC50PD
 14255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14256                                                                  ELC50PD
 14257     if  PB-I-LOAN-TERM > WS-MAX-TERM
 14258        MOVE ER-3058             TO WS-ERROR
 14259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14260     end-if
 14261                                                                  ELC50PD
 14262     IF WS-STATE-ABBREVIATION = 'NC'
 14263        IF PB-I-LOAN-TERM > +59
 14264           CONTINUE
 14265        ELSE
 14266           MOVE ER-2792          TO WS-ERROR
 14267           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50
 14268        END-IF
 14269     END-IF
 14270                                                                  ELC50PD
 14271     .
 14272 3125-EDIT-PMT-FREQ.                                              ELC50PD
 14273
 14274     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14275         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14276            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14277
 14278     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14279                    OR
 14280        ((PB-COMPANY-ID = 'DCC')
 14281        AND (WS-AH-DCC-TRUNC = 'T'))
 14282                    OR
 14283         (PB-COMPANY-ID = 'AHL')
 14284        CONTINUE
 14285     ELSE
 14286        IF (PB-I-LOAN-TERM > ZEROS)
 14287           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 14288           MOVE ER-1575          TO WS-ERROR
 14289           PERFORM 9900-ERROR-FORMAT
 14290                                 THRU 9900-EXIT
 14291        END-IF
 14292     END-IF
 14293
 14294     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 14295         IF PB-I-PAY-FREQUENCY  NOT = ZEROS                       ELC50PD
 14296            MOVE ER-2653         TO WS-ERROR                      ELC50PD
 14297            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14298            GO TO 3127-EDIT-LOAN-OFFICER                          ELC50PD
 14299         ELSE                                                     ELC50PD
 14300            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14301                                                                  ELC50PD
 14302     IF PB-I-PAY-FREQUENCY = ZERO OR 1                            ELC50PD
 14303         MOVE ER-2655            TO WS-ERROR                      ELC50PD
 14304         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14305         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14306                                                                  ELC50PD
 14307     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM              ELC50PD
 14308         MOVE ER-2654            TO WS-ERROR                      ELC50PD
 14309         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14310         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14311                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 261
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14312     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY                    ELC50PD
 14313         GIVING WS-TEX-FACT-2                                     ELC50PD
 14314             REMAINDER WS-TEX-FACT-3.                             ELC50PD
 14315                                                                  ELC50PD
 14316*    IF WS-TEX-FACT-3 NOT = ZERO                                  ELC50PD
 14317*       MOVE ER-2654             TO WS-ERROR                      ELC50PD
 14318*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14319                                                                  ELC50PD
 14320                                                                  ELC50PD
 14321 3127-EDIT-LOAN-OFFICER.                                          ELC50PD
 14322                                                                  ELC50PD
 14323     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 14324        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 14325           MOVE ER-2690          TO WS-ERROR
 14326           PERFORM 9900-ERROR-FORMAT
 14327                                 THRU 9900-EXIT
 14328        ELSE
 14329           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 14330           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 14331           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 14332           MOVE PB-SV-STATE      TO LOFC-STATE
 14333           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 14334           MOVE PB-I-LOAN-OFFICER
 14335                                 TO LOFC-CODE
 14336           PERFORM 8586-READ-LOAN-OFFICER
 14337                                 THRU 8586-EXIT
 14338           IF (NOT LOFC-MASTER-FOUND)
 14339              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 14340              MOVE ER-3006       TO WS-ERROR
 14341              PERFORM 9900-ERROR-FORMAT
 14342                                 THRU 9900-EXIT
 14343           END-IF
 14344        END-IF
 14345     END-IF
 14346
 14347     .
 14348 3129-EDIT-APR.                                                   ELC50PD
 14349                                                                  ELC50PD
 14350     IF (WS-LF-BENEFIT-CD = ZERO)
 14351        OR (NO-LF-BENEFIT-MATCH)
 14352        IF PB-COMPANY-ID NOT = 'DCC'
 14353           GO TO 3130-EDIT-AGE
 14354*       ELSE
 14355*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14356*             GO TO 3130-EDIT-AGE
 14357*          END-IF
 14358        END-IF
 14359     END-IF
 14360                                                                  ELC50PD
 14361     IF (WS-STATE-ABBREVIATION = 'OH')                            ELC50PD
 14362         AND (PB-I-RATE-CLASS NOT = 'L ')
 14363         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14364         AND (PB-CERT-EFF-DT GREATER WS-831031)                   ELC50PD
 14365         GO TO 3129-APR-CONT.                                     ELC50PD
 14366                                                                  ELC50PD
 14367     IF (WS-STATE-ABBREVIATION = 'RI')                            ELC50PD
 14368         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14369         AND (PB-CERT-EFF-DT GREATER WS-831231)                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 262
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14370         GO TO 3129-APR-CONT.                                     ELC50PD
 14371                                                                  ELC50PD
 14372     IF (WS-STATE-ABBREVIATION = 'UT')                            ELC50PD
 14373         AND (PB-I-LF-TERM GREATER THAN 62)                       ELC50PD
 14374         AND (PB-CERT-EFF-DT GREATER WS-810831)                   ELC50PD
 14375         AND (PB-CERT-EFF-DT LESS WS-830901)                      ELC50PD
 14376         GO TO 3129-APR-CONT.                                     ELC50PD
 14377                                                                  ELC50PD
 14378     IF PB-COMPANY-ID = 'LAP'                                     ELC50PD
 14379        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'                 ELC50PD
 14380           IF PB-I-LOAN-APR GREATER THAN ZEROS                    ELC50PD
 14381              MOVE ER-2656         TO WS-ERROR                    ELC50PD
 14382              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14383              GO TO 3130-EDIT-AGE.                                ELC50PD
 14384                                                                  ELC50PD
 14385     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14386        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14387        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 14388        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14389        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 14390        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 14391         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14392                                                                  ELC50PD
 14393 3129-APR-CONT.                                                   ELC50PD
 14394     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR                         ELC50PD
 14395         (WS-LF-SPECIAL-CALC-CD = 'M'))                           ELC50PD
 14396         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14397                                                                  ELC50PD
 14398     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 14399         WS-AH-BENEFIT-CD (1:1) = 'S')
 14400        AND (PB-COMPANY-ID = 'DCC')
 14401        AND (PB-I-LOAN-APR = ZERO)
 14402        MOVE ER-2657             TO WS-ERROR
 14403        PERFORM 9900-ERROR-FORMAT
 14404                                 THRU 9900-EXIT
 14405        GO TO 3130-EDIT-AGE
 14406     END-IF
 14407
 14408     IF PB-I-LOAN-APR = ZERO
 14409        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 14410     END-IF
 14411                                                                  ELC50PD
 14412     IF PB-I-LOAN-APR = ZERO                                      ELC50PD
 14413        MOVE ER-2656             TO WS-ERROR                      ELC50PD
 14414        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 14415        GO TO 3130-EDIT-AGE.                                      ELC50PD
 14416                                                                  ELC50PD
 14417*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 14418     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000            ELC50PD
 14419        MOVE ER-2657             TO WS-ERROR                      ELC50PD
 14420        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14421                                                                  ELC50PD
 14422 3130-EDIT-AGE.                                                   ELC50PD
 14423                                                                  ELC50PD
 14424******************************************************************ELC50PD
 14425*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *ELC50PD
 14426******************************************************************ELC50PD
 14427                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 263
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14428     IF NOT NO-LIFE-COVERAGE                                      ELC50PD
 14429        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14430           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99     ELC50PD
 14431               MOVE ER-2628             TO WS-ERROR               ELC50PD
 14432               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14433                                                                  ELC50PD
 14434     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14435        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14436           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99  ELC50PD
 14437               MOVE ER-2628         TO WS-ERROR                   ELC50PD
 14438               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14439                                                                  ELC50PD
 14440 3133-SEX-CODE.                                                   ELC50PD
 14441     IF PB-I-INSURED-SEX = SPACE OR ZERO                          ELC50PD
 14442         IF WS-DEFAULT-SEX = 'M'                                  ELC50PD
 14443             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX              ELC50PD
 14444          ELSE                                                    ELC50PD
 14445             IF WS-DEFAULT-SEX = 'F'                              ELC50PD
 14446             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.             ELC50PD
 14447                                                                  ELC50PD
 14448     IF PB-I-INSURED-SEX = '1'                                    ELC50PD
 14449         MOVE 'M' TO PB-I-INSURED-SEX.                            ELC50PD
 14450                                                                  ELC50PD
 14451     IF PB-I-INSURED-SEX = '2'                                    ELC50PD
 14452         MOVE 'F' TO PB-I-INSURED-SEX.                            ELC50PD
 14453                                                                  ELC50PD
 14454 3134-SIG-SW-EDIT.                                                ELC50PD
 14455     IF PB-I-SIG-SW = SPACE                                       ELC50PD
 14456         MOVE 'N'                TO  PB-I-SIG-SW.                 ELC50PD
 14457                                                                  ELC50PD
 14458     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 14459         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '         ELC50PD
 14460             NEXT SENTENCE                                        ELC50PD
 14461         ELSE                                                     ELC50PD
 14462             MOVE ER-1923        TO  WS-ERROR                     ELC50PD
 14463             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14464     ELSE                                                         ELC50PD
 14465     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14466         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '                ELC50PD
 14467             NEXT SENTENCE                                        ELC50PD
 14468         ELSE                                                     ELC50PD
 14469             MOVE ER-2606        TO  WS-ERROR                     ELC50PD
 14470             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14471     ELSE                                                         ELC50PD
 14472     IF PB-COMPANY-ID = 'TMS'                                     ELC50PD
 14473         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'                       ELC50PD
 14474             NEXT SENTENCE                                        ELC50PD
 14475         ELSE                                                     ELC50PD
 14476             MOVE ER-2689        TO  WS-ERROR                     ELC50PD
 14477             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14478     ELSE                                                         ELC50PD
 14479         IF PB-I-SIG-SW = 'Y' OR 'N'                              ELC50PD
 14480             NEXT SENTENCE                                        ELC50PD
 14481         ELSE                                                     ELC50PD
 14482             MOVE ER-2651        TO  WS-ERROR                     ELC50PD
 14483             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14484                                                                  ELC50PD
 14485     IF PB-COMPANY-ID = 'FLA'                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 264
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14486         IF (WS-EDIT-AGE GREATER 54  OR                           ELC50PD
 14487             WS-AH-EDIT-AGE GREATER 54)  AND                      ELC50PD
 14488            PB-I-SIG-SW = 'N'                                     ELC50PD
 14489            MOVE ER-2651         TO  WS-ERROR                     ELC50PD
 14490            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14491                                                                  ELC50PD
 14492 3135-NAME-EDIT.                                                  ELC50PD
 14493                                                                  ELC50PD
 14494     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 14495        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 14496        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 14497           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 14498                                 TO PB-I-JOINT-FIRST-NAME
 14499        END-PERFORM
 14500     END-IF
 14501
 14502     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 14503        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 14504        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 14505           MOVE PB-I-JOINT-LAST-NAME (2:14)
 14506                                 TO PB-I-JOINT-LAST-NAME
 14507        END-PERFORM
 14508     END-IF
 14509
 14510     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 14511        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 14512        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 14513           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 14514                                 TO PB-I-INSURED-FIRST-NAME
 14515        END-PERFORM
 14516     END-IF
 14517
 14518     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 14519        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 14520        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 14521           MOVE PB-I-INSURED-LAST-NAME (2:14)
 14522                                 TO PB-I-INSURED-LAST-NAME
 14523        END-PERFORM
 14524     END-IF
 14525
 14526     IF PB-I-INSURED-LAST-NAME = SPACES                           ELC50PD
 14527       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14528       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14529           MOVE ER-2660    TO WS-ERROR                            ELC50PD
 14530           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14531                                                                  ELC50PD
 14532 3136-EDIT-SEX.                                                   ELC50PD
 14533                                                                  ELC50PD
 14534******************************************************************ELC50PD
 14535*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *ELC50PD
 14536******************************************************************ELC50PD
 14537                                                                  ELC50PD
 14538     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 14539        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 14540        NEXT SENTENCE                                             ELC50PD
 14541     ELSE                                                         ELC50PD
 14542        IF PB-I-INSURED-SEX = 'M' OR 'F'                          ELC50PD
 14543           NEXT SENTENCE                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 265
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14544        ELSE                                                      ELC50PD
 14545           MOVE ER-2629            TO WS-ERROR                    ELC50PD
 14546           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14547                                                                  ELC50PD
 14548 3137-EDIT-EFF-DATE.                                              ELC50PD
 14549                                                                  ELC50PD
 14550     IF PB-REISSUED-CERT       OR                                 ELC50PD
 14551        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14552        PB-POLICY-IS-VOIDED                                       ELC50PD
 14553         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14554                                                                  ELC50PD
 14555     MOVE SPACE                  TO WS-2671-SW                    ELC50PD
 14556                                    WS-2672-SW.                   ELC50PD
 14557                                                                  ELC50PD
 14558     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')             ELC50PD
 14559         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END      ELC50PD
 14560             MOVE ER-2703        TO WS-ERROR                      ELC50PD
 14561             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14562             GO TO 3139-EDIT-COVERAGE-CODES.                      ELC50PD
 14563                                                                  ELC50PD
 14564     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END         ELC50PD
 14565         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14566                                                                  ELC50PD
 14567     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 14568     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.                ELC50PD
 14569*    MOVE '1'                    TO DC-OPTION-CODE.               ELC50PD
 14570     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 14571     MOVE +0                     TO DC-ELAPSED-MONTHS             ELC50PD
 14572                                    DC-ELAPSED-DAYS.              ELC50PD
 14573     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 14574                                                                  ELC50PD
 14575     IF DATE-CONVERSION-ERROR                                     ELC50PD
 14576         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14577                                                                  ELC50PD
 14578     IF DC-ELAPSED-DAYS GREATER +180                              ELC50PD
 14579         MOVE ER-2672            TO WS-ERROR                      ELC50PD
 14580         MOVE 'Y'                TO WS-2672-SW                    ELC50PD
 14581         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14582     END-IF
 14583                                                                  ELC50PD
 14584     IF WS-ERROR = ER-2671  AND                                   ELC50PD
 14585        PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 14586        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)          ELC50PD
 14587        MOVE SPACE               TO WS-2671-SW                    ELC50PD
 14588        SUBTRACT +1            FROM PB-NO-OF-ERRORS.              ELC50PD
 14589                                                                  ELC50PD
 14590     IF PB-ISSUE-DATE-FORCED  AND                                 ELC50PD
 14591      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))      ELC50PD
 14592         SUBTRACT +1           FROM PB-NO-OF-ERRORS               ELC50PD
 14593         MOVE ER-2673            TO WS-ERROR                      ELC50PD
 14594         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14595         MOVE SPACE              TO WS-2671-SW                    ELC50PD
 14596                                    WS-2672-SW.                   ELC50PD
 14597                                                                  ELC50PD
 14598     IF DC-ELAPSED-MONTHS IS GREATER THAN +9                      ELC50PD
 14599         IF PB-ISSUE-DATE-FORCED                                  ELC50PD
 14600             MOVE ER-2600          TO  WS-ERROR                   ELC50PD
 14601             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 266
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14602         ELSE                                                     ELC50PD
 14603             MOVE ER-2692          TO  WS-ERROR                   ELC50PD
 14604             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14605                                                                  ELC50PD
 14606                                                                  ELC50PD
 14607 3139-EDIT-COVERAGE-CODES.                                        ELC50PD
 14608                                                                  ELC50PD
 14609     if pb-company-id not = 'AHL'
 14610        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 14611           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 14612           MOVE ER-2787          TO WS-ERROR
 14613           PERFORM 9900-ERROR-FORMAT
 14614                                 THRU 9900-EXIT
 14615        END-IF
 14616     end-if
 14617
 14618     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 14619        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 14620                                 > 250000.00
 14621           MOVE ER-2719          TO WS-ERROR
 14622           PERFORM 9900-ERROR-FORMAT
 14623                                 THRU 9900-EXIT
 14624        END-IF
 14625     END-IF
 14626
 14627     IF PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14628        PB-POLICY-IS-VOIDED                                       ELC50PD
 14629         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14630                                                                  ELC50PD
 14631     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND             ELC50PD
 14632        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)                  ELC50PD
 14633         MOVE ER-2630                TO WS-ERROR                  ELC50PD
 14634         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14635                                                                  ELC50PD
 14636     IF PB-I-LF-BENEFIT-CD = ZERO  AND                            ELC50PD
 14637        PB-I-LF-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14638        PB-I-LF-PREMIUM-AMT = ZERO                                ELC50PD
 14639         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14640                                                                  ELC50PD
 14641     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14642        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14643        PB-I-LF-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14644         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14645                                                                  ELC50PD
 14646     IF (PB-I-LF-BENEFIT-CD = ZERO)
 14647        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14648        MOVE ER-2631             TO WS-ERROR
 14649        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14650     END-IF
 14651                                                                  ELC50PD
 14652                                                                  ELC50PD
 14653******************************************************************ELC50PD
 14654*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS        ELC50PD
 14655******************************************************************ELC50PD
 14656                                                                  ELC50PD
 14657     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14658        NEXT SENTENCE                                             ELC50PD
 14659     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 267
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14660        IF PB-I-LF-BENEFIT-AMT = ZERO                             ELC50PD
 14661           MOVE ER-2632             TO WS-ERROR                   ELC50PD
 14662           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14663                                                                  ELC50PD
 14664                                                                  ELC50PD
 14665******************************************************************ELC50PD
 14666*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14667******************************************************************ELC50PD
 14668                                                                  ELC50PD
 14669     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14670        CONTINUE                                                  ELC50PD
 14671     ELSE                                                         ELC50PD
 14672        IF PB-I-LF-PREMIUM-AMT = ZERO                             ELC50PD
 14673           IF (NOT PB-COMP-LF-PREM)
 14674              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14675              MOVE ER-2633       TO WS-ERROR
 14676              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14677           END-IF
 14678        END-IF
 14679     END-IF
 14680
 14681     .                                                            ELC50PD
 14682 3140-CHECK-AH-FOR-ZERO.                                          ELC50PD
 14683                                                                  ELC50PD
 14684     IF PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14685        PB-I-AH-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14686        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14687         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14688                                                                  ELC50PD
 14689     IF PB-COMPANY-ID = 'CSL'  AND                                ELC50PD
 14690        PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14691        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14692        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14693         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14694                                                                  ELC50PD
 14695     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14696        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14697        PB-I-AH-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14698         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14699                                                                  ELC50PD
 14700     IF PB-I-AH-BENEFIT-CD = ZERO                                 ELC50PD
 14701         MOVE ER-2634            TO WS-ERROR                      ELC50PD
 14702         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14703                                                                  ELC50PD
 14704******************************************************************ELC50PD
 14705*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14706******************************************************************ELC50PD
 14707                                                                  ELC50PD
 14708     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14709        NEXT SENTENCE                                             ELC50PD
 14710     ELSE                                                         ELC50PD
 14711        IF PB-I-AH-BENEFIT-AMT = ZERO                             ELC50PD
 14712           MOVE ER-2635             TO WS-ERROR                   ELC50PD
 14713           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14714                                                                  ELC50PD
 14715******************************************************************ELC50PD
 14716*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14717******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 268
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14718                                                                  ELC50PD
 14719     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14720        NEXT SENTENCE                                             ELC50PD
 14721     ELSE                                                         ELC50PD
 14722        IF PB-I-AH-PREMIUM-AMT = ZERO                             ELC50PD
 14723            IF NOT PB-COMP-AH-PREM                                ELC50PD
 14724                MOVE ER-2636    TO WS-ERROR                       ELC50PD
 14725                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14726                                                                  ELC50PD
 14727                                                                  ELC50PD
 14728 3140-EDIT-MAX-AMT-SIZES.                                         ELC50PD
 14729* CUSTOM CODE FOR CLIENT    'DMD'                                 ELC50PD
 14730     MOVE ZEROS                   TO WS-RES-STATE-TAX             ELC50PD
 14731                                     WS-RES-MUNI-TAX              ELC50PD
 14732                                     PB-I-STATE-TAX               ELC50PD
 14733                                     PB-I-MUNI-TAX.               ELC50PD
 14734                                                                  ELC50PD
 14735     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.         ELC50PD
 14736                                                                  ELC50PD
 14737     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14738        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14739                                                                  ELC50PD
 14740     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14741        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14742                                                                  ELC50PD
 14743     IF WS-LF-EARNINGS-CALC EQUAL '5'                             ELC50PD
 14744        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14745                                                                  ELC50PD
 14746     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'     ELC50PD
 14747                             OR 'RIC')                            ELC50PD
 14748        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14749                                                                  ELC50PD
 14750     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'                        ELC50PD
 14751        IF PB-I-LOAN-APR GREATER THAN ZEROS                       ELC50PD
 14752            GO TO 3150-RATE-OUTSTAND-BAL                          ELC50PD
 14753        ELSE                                                      ELC50PD
 14754           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'                ELC50PD
 14755               GO TO 3150-RATE-OUTSTAND-BAL.                      ELC50PD
 14756                                                                  ELC50PD
 14757     IF NOT PB-NO-MONTHS-SKIPPED                                  ELC50PD
 14758        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14759                                                                  ELC50PD
 14760     IF PB-I-LF-TERM NOT = PB-I-AH-TERM                           ELC50PD
 14761        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14762                                                                  ELC50PD
 14763     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)                          ELC50PD
 14764        IF PB-I-AH-BENEFIT-AMT NOT = ZERO                         ELC50PD
 14765           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -   ELC50PD
 14766             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                 ELC50PD
 14767           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA            ELC50PD
 14768           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM        ELC50PD
 14769              MOVE ER-2693     TO WS-ERROR                        ELC50PD
 14770              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14771              GO TO 3150-RATE-OUTSTAND-BAL                        ELC50PD
 14772           ELSE                                                   ELC50PD
 14773              GO TO 3150-RATE-OUTSTAND-BAL.                       ELC50PD
 14774                                                                  ELC50PD
 14775 3150-RATE-OUTSTAND-BAL.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 269
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14776                                                                  ELC50PD
 14777* DMD RATING TEST                                                 ELC50PD
 14778     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 14779         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14780         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14781         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 14782         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14783         MOVE 'B'                     TO PB-I-OB-FLAG             ELC50PD
 14784         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 14785                                                                  ELC50PD
 14786     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 14787         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14788             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'                 ELC50PD
 14789                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14790                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14791                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14792                                                                  ELC50PD
 14793     IF  PB-COMPANY-ID   EQUAL    'CDL'                           ELC50PD
 14794         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14795             IF WS-STATE-ABBREVIATION EQUAL 'NC'                  ELC50PD
 14796                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14797                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14798                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14799                                                                  ELC50PD
 14800     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14801        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14802            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14803              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)ELC50PD
 14804                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT  ELC50PD
 14805                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14806                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14807                 MOVE  ER-1910           TO  WS-ERROR             ELC50PD
 14808                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 14809                                                                  ELC50PD
 14810     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14811        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14812            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)  ELC50PD
 14813               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT    ELC50PD
 14814               MOVE  ER-1910           TO  WS-ERROR               ELC50PD
 14815               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 14816                                                                  ELC50PD
 14817     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14818        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14819            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14820                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)      ELC50PD
 14821                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14822                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14823                 MOVE  +0       TO  WS-ERROR.                     ELC50PD
 14824                                                                  ELC50PD
 14825     IF WS-ERROR = ER-2693                                        ELC50PD
 14826        IF PB-COMPANY-ID = 'JAL' AND                              ELC50PD
 14827           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'      ELC50PD
 14828           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14829           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14830                                                                  ELC50PD
 14831     IF WS-ERROR = ER-2693                                        ELC50PD
 14832        IF PB-COMPANY-ID = 'NCL'  AND                             ELC50PD
 14833           PB-I-AH-BENEFIT-CD = 'OA'                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 270
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14834           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14835           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14836                                                                  ELC50PD
 14837     IF WS-ERROR = ER-2693                                        ELC50PD
 14838        IF PB-COMPANY-ID = 'CNL' AND                              ELC50PD
 14839           PB-I-LF-BENEFIT-CD = '71' OR '72'                      ELC50PD
 14840           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14841           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14842                                                                  ELC50PD
 14843     IF WS-ERROR = ER-2693                                        ELC50PD
 14844        IF PB-COMPANY-ID = 'HER'                                  ELC50PD
 14845           IF WS-LEVEL                                            ELC50PD
 14846              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14847              SUBTRACT +1    FROM PB-NO-OF-ERRORS.                ELC50PD
 14848                                                                  ELC50PD
 14849     IF ((LF-BENEFIT-FOUND) AND                                   ELC50PD
 14850         (NOT NO-LIFE-COVERAGE)  AND                              ELC50PD
 14851         (WS-LF-SPECIAL-CALC-CD = 'O'))                           ELC50PD
 14852       OR   ((AH-BENEFIT-FOUND) AND                               ELC50PD
 14853             (NOT NO-AH-COVERAGE)    AND                          ELC50PD
 14854             (WS-AH-SPECIAL-CALC-CD = 'O'))                       ELC50PD
 14855         NEXT SENTENCE                                            ELC50PD
 14856     ELSE                                                         ELC50PD
 14857         GO TO 3215-EDIT-RATES.                                   ELC50PD
 14858                                                                  ELC50PD
 14859     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 14860        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14861           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14862           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14863           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14864                                                                  ELC50PD
 14865     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 14866        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14867           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14868           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14869           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14870                                                                  ELC50PD
 14871     MOVE 'B'                    TO PB-I-OB-FLAG.                 ELC50PD
 14872                                                                  ELC50PD
 14873     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14874         NEXT SENTENCE                                            ELC50PD
 14875     ELSE                                                         ELC50PD
 14876         IF NOT NO-LIFE-COVERAGE                                  ELC50PD
 14877             IF WS-ACCT-LF-OB-RT = ZERO                           ELC50PD
 14878                MOVE ER-2641    TO WS-ERROR                       ELC50PD
 14879                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14880                                                                  ELC50PD
 14881     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14882       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE               ELC50PD
 14883         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14884         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14885         IF WS-ERROR = ER-2675                                    ELC50PD
 14886            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14887            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14888            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14889         ELSE                                                     ELC50PD
 14890            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14891            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 271
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14892                                                                  ELC50PD
 14893                                                                  ELC50PD
 14894     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14895         NEXT SENTENCE                                            ELC50PD
 14896     ELSE                                                         ELC50PD
 14897       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14898            NEXT SENTENCE
 14899       ELSE
 14900         IF NOT NO-AH-COVERAGE                                    ELC50PD
 14901             IF WS-ACCT-AH-OB-RT = ZERO                           ELC50PD
 14902                MOVE ER-2642    TO WS-ERROR                       ELC50PD
 14903                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14904                                                                  ELC50PD
 14905     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14906       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                 ELC50PD
 14907         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC        ELC50PD
 14908         IF WS-ERROR = ER-2676                                    ELC50PD
 14909            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14910            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14911            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14912         ELSE                                                     ELC50PD
 14913            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14914            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14915                                                                  ELC50PD
 14916     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14917         COMPUTE PB-I-LF-PREM-CALC ROUNDED =                      ELC50PD
 14918            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000       ELC50PD
 14919     ELSE                                                         ELC50PD
 14920         IF PB-I-LF-PREM-CALC = ZEROS                             ELC50PD
 14921             COMPUTE PB-I-LF-PREM-CALC ROUNDED =                  ELC50PD
 14922                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.  ELC50PD
 14923                                                                  ELC50PD
 14924     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14925         COMPUTE PB-I-AH-PREM-CALC ROUNDED =                      ELC50PD
 14926            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000       ELC50PD
 14927     ELSE                                                         ELC50PD
 14928         IF PB-I-AH-PREM-CALC = ZEROS                             ELC50PD
 14929             COMPUTE PB-I-AH-PREM-CALC ROUNDED =                  ELC50PD
 14930                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.  ELC50PD
 14931                                                                  ELC50PD
 14932     MOVE ZEROS TO PB-I-MORT-CODE.                                ELC50PD
 14933                                                                  ELC50PD
 14934     GO TO 3260-EDIT-CONTINUE.                                    ELC50PD
 14935                                                                  ELC50PD
 14936                                                                  ELC50PD
 14937 3215-EDIT-RATES.                                                 ELC50PD
 14938     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 14939         NEXT SENTENCE                                            ELC50PD
 14940     ELSE                                                         ELC50PD
 14941         GO TO 3999-END-EDIT.                                     ELC50PD
 14942                                                                  ELC50PD
 14943 3220-CHECK-LF-RATES.                                             ELC50PD
 14944                                                                  ELC50PD
 14945     IF PB-COMPANY-ID = 'DCC'
 14946        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14947        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14948        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14949           AND (NOT WS-LF-CASH))
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 272
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14950                           OR
 14951           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14952           AND (NOT WS-AH-CASH)))
 14953                       AND
 14954           (PB-I-ENTRY-STATUS NOT = '5')
 14955           MOVE 'M'              TO PB-BATCH-ENTRY
 14956                                    PB-I-ENTRY-STATUS
 14957        END-IF
 14958     END-IF
 14959
 14960
 14961
 14962     MOVE ZEROS                  TO PB-I-LF-PREM-CALC             ELC50PD
 14963                                    PB-I-AH-PREM-CALC             ELC50PD
 14964                                    PB-I-LF-ALT-PREM-CALC         ELC50PD
 14965                                    PB-I-LF-ALT-RATE              ELC50PD
 14966                                    PB-I-LF-REI-RATE              ELC50PD
 14967                                    PB-I-LF-ALT-REI-RATE          ELC50PD
 14968                                    PB-I-AH-REI-RATE
 14969                                    PB-I-TOT-FEES-CALC.
 14970                                                                  ELC50PD
 14971     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 14972        NEXT SENTENCE                                             ELC50PD
 14973     ELSE                                                         ELC50PD
 14974        MOVE ZEROS               TO PB-I-LF-RATE                  ELC50PD
 14975                                    PB-I-AH-RATE.                 ELC50PD
 14976                                                                  ELC50PD
 14977     IF PB-I-TOT-FEES NOT NUMERIC
 14978        MOVE ZEROS               TO PB-I-TOT-FEES
 14979     END-IF
 14980
 14981     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 14982         MOVE ZERO               TO PB-I-LIVES.                   ELC50PD
 14983                                                                  ELC50PD
 14984     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 14985         MOVE ZERO               TO PB-I-NUM-BILLED.              ELC50PD
 14986                                                                  ELC50PD
 14987     IF PB-I-LF-PREM-TAX NOT NUMERIC                              ELC50PD
 14988        MOVE +0                  TO PB-I-LF-PREM-TAX              ELC50PD
 14989     END-IF
 14990                                                                  ELC50PD
 14991     IF PB-I-AH-PREM-TAX NOT NUMERIC                              ELC50PD
 14992        MOVE +0                  TO PB-I-AH-PREM-TAX              ELC50PD
 14993     END-IF
 14994                                                                  ELC50PD
 14995     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR                         ELC50PD
 14996        PB-I-PAY-FREQUENCY = ZEROS                                ELC50PD
 14997            MOVE 12 TO CP-PAY-FREQUENCY                           ELC50PD
 14998     ELSE                                                         ELC50PD
 14999            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.          ELC50PD
 15000                                                                  ELC50PD
 15001     IF PB-I-STATE-TAX NOT NUMERIC                                ELC50PD
 15002         MOVE ZEROS               TO PB-I-STATE-TAX.              ELC50PD
 15003                                                                  ELC50PD
 15004     IF PB-I-MUNI-TAX NOT NUMERIC                                 ELC50PD
 15005         MOVE ZEROS               TO PB-I-MUNI-TAX.               ELC50PD
 15006                                                                  ELC50PD
 15007     MOVE SPACES                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 273
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15008     IF PB-COMPANY-ID  = 'CSL'  AND                               ELC50PD
 15009        PB-I-LF-TERM NOT = ZERO                                   ELC50PD
 15010        COMPUTE WS-PAYMENT-AMT =                                  ELC50PD
 15011             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM                   ELC50PD
 15012        COMPUTE WS-CSL-AMT1 =                                     ELC50PD
 15013             PB-I-LF-TERM * AM-MAX-MON-BEN                        ELC50PD
 15014        COMPUTE WS-CSL-AMT2 =                                     ELC50PD
 15015             WS-PAYMENT-AMT * PB-I-LF-TERM                        ELC50PD
 15016        IF CP-PAY-FREQUENCY NOT = 12                              ELC50PD
 15017           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT          ELC50PD
 15018           MOVE '8' TO WS-CSL-CALC-CD                             ELC50PD
 15019        ELSE                                                      ELC50PD
 15020           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND      ELC50PD
 15021              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN    ELC50PD
 15022               AM-MAX-TOT-BEN                                     ELC50PD
 15023               MOVE '6' TO WS-CSL-CALC-CD                         ELC50PD
 15024           ELSE                                                   ELC50PD
 15025              IF (WS-CSL-AMT1  GREATER THAN                       ELC50PD
 15026                 AM-MAX-TOT-BEN) AND                              ELC50PD
 15027                 (WS-CSL-AMT2  GREATER THAN                       ELC50PD
 15028                 AM-MAX-TOT-BEN)                                  ELC50PD
 15029                 MOVE '7' TO WS-CSL-CALC-CD                       ELC50PD
 15030              ELSE                                                ELC50PD
 15031                 MOVE '5' TO WS-CSL-CALC-CD.                      ELC50PD
 15032                                                                  ELC50PD
 15033     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND               ELC50PD
 15034         NEXT SENTENCE                                            ELC50PD
 15035     ELSE                                                         ELC50PD
 15036         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15037                                                                  ELC50PD
 15038*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****        ELC50PD
 15039                                                                  ELC50PD
 15040     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15041        IF (PB-I-LF-CRIT-PER    EQUAL +0)                         ELC50PD
 15042              OR                                                  ELC50PD
 15043           (PB-I-PAYMENT-AMOUNT EQUAL +0)                         ELC50PD
 15044           MOVE ER-2618          TO WS-ERROR                      ELC50PD
 15045           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15046           GO TO 3300-CHECK-AH-RATES.                             ELC50PD
 15047                                                                  ELC50PD
 15048     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15049           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL                   ELC50PD
 15050                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.        ELC50PD
 15051                                                                  ELC50PD
 15052     IF WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15053         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 15054         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15055         MOVE 'Z000'              TO PB-I-MORT-CODE               ELC50PD
 15056         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC            ELC50PD
 15057         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15058                                                                  ELC50PD
 15059     IF WS-LF-SPECIAL-CALC-CD = 'Z'                               ELC50PD
 15060        IF PB-I-LIVES = ZERO                                      ELC50PD
 15061           MOVE ER-2688          TO WS-ERROR                      ELC50PD
 15062           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 15063                                                                  ELC50PD
 15064     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15065                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 274
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15066     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15067     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 15068     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 15069     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 15070     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15071     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15072     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 15073     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15074     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15075     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 15076                                                                  ELC50PD
 15077******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15078     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15079         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15080            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15081             IF PB-CERT-EFF-DT GREATER  WS-931231                 ELC50PD
 15082                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15083*******                                                           ELC50PD
 15084                                                                  ELC50PD
 15085     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15086     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15087     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 15088     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 15089     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15090     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15091                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15092     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15093         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15094                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15095     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 15096     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 15097     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 15098     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15099     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15100     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15101     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15102     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 15103     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15104                                    CP-REMAINING-TERM             ELC50PD
 15105                                    CP-LOAN-TERM.                 ELC50PD
 15106                                                                  ELC50PD
 15107     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
 15108         NEXT SENTENCE                                            ELC50PD
 15109     ELSE                                                         ELC50PD
 15110         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 15111             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15112                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 15113                                                                  ELC50PD
 15114     IF PB-COMPANY-ID EQUAL 'CSL'                                 ELC50PD
 15115        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD) ELC50PD
 15116           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -    ELC50PD
 15117                                         PB-I-LF-PREMIUM-AMT.     ELC50PD
 15118                                                                  ELC50PD
 15119     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15120         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15121            CP-EARN-AS-NET-PAY                                    ELC50PD
 15122             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15123                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 275
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15124                                                                  ELC50PD
 15125     IF (CP-TRUNCATED-LIFE)                                       ELC50PD
 15126        or ((pb-company-id = 'AHL')
 15127           and (pb-i-loan-term > pb-i-lf-term))
 15128        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 15129                                                                  ELC50PD
 15130     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15131        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15132                                                                  ELC50PD
 15133     IF CP-TERM-IS-DAYS                                           ELC50PD
 15134         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 15135     ELSE                                                         ELC50PD
 15136         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15137
 15138     IF PB-COMPANY-ID = 'DCC'
 15139        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15140        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15141        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15142        IF WS-LF-BEN-CATEGORY = 'D'
 15143           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 15144           MOVE PB-I-LIFE-COMMISSION
 15145                                 TO CP-DCC-ACT-COMM
 15146           MOVE WS-LF-BEN-CATEGORY
 15147                                 TO CP-BEN-CATEGORY
 15148        END-IF
 15149        IF (CP-BENEFIT-CD (1:1) = 'P')
 15150           AND (PB-I-LOAN-TERM NOT = ZEROS)
 15151           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 15152           add pb-i-ah-premium-amt to cp-original-premium
 15153        END-IF
 15154     END-IF
 15155
 15156     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15157         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT       ELC50PD
 15158         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15159         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.        ELC50PD
 15160                                                                  ELC50PD
 15161     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15162        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.           ELC50PD
 15163                                                                  ELC50PD
 15164     IF (CP-SPECIAL-CALC-CD = 'H')
 15165        OR (PB-COMPANY-ID = 'DCC')
 15166         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 15167                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 15168         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 15169                                                                  ELC50PD
 15170
 15171     IF (PB-COMPANY-ID = 'CID')
 15172        AND (WS-LF-EARNINGS-CALC = 'B')
 15173        AND (CP-STATE-STD-ABBRV = 'MN')
 15174        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15175                                 TO CP-ALTERNATE-BENEFIT
 15176        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 15177     END-IF
 15178
 15179     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 15180     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15181     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 276
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15182                                                                  ELC50PD
 15183     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15184        MOVE ER-2641            TO WS-ERROR                       ELC50PD
 15185        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 15186        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15187                                                                  ELC50PD
 15188     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15189        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 15190           IF NOT ACCOUNT-LIFE-CHECKED                            ELC50PD
 15191              MOVE ER-2607      TO WS-ERROR                       ELC50PD
 15192              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 15193                                                                  ELC50PD
 15194
 15195******************************************************************ELC50PD
 15196*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *ELC50PD
 15197*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15198******************************************************************ELC50PD
 15199                                                                  ELC50PD
 15200* CALC LIFE AGE AT EXPIRATION.                                    00031342
 15201                                                                  00031343
 15202     COMPUTE WS-AGE-AT-EXPIRE =                                   00031344
 15203          ((PB-I-LF-TERM / 12) + PB-I-AGE).                       00031345
 15204                                                                  00031346
 15205*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15206*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15207*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15208*        MOVE ER-2709        TO WS-ERROR                          00031349
 15209*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15210*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15211                                                                  00031352
 15212*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031347
 15213*        MOVE 'X'            TO PB-FATAL-FLAG                     00031348
 15214*        MOVE ER-2718        TO WS-ERROR                          00031349
 15215*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15216*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15217                                                                  00031352
 15218* CALC A & H AGE AT EXPIRATION.                                   00031353
 15219                                                                  00031354
 15220     COMPUTE WS-AGE-AT-EXPIRE =                                   00031355
 15221          ((PB-I-AH-TERM / 12) + PB-I-AGE).                       00031356
 15222                                                                  00031357
 15223*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15224*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15225*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15226*        MOVE ER-2709        TO WS-ERROR                          00031349
 15227*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15228*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15229                                                                  00031352
 15230*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031358
 15231*        MOVE 'X'            TO PB-FATAL-FLAG                     00031359
 15232*        MOVE ER-2718        TO WS-ERROR                          00031360
 15233*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031361
 15234*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031362
 15235
 15236     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED              ELC50PD
 15237        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15238                                                                  ELC50PD
 15239     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 277
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15240        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15241                                                                  ELC50PD
 15242     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15243        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15244                                                                  ELC50PD
 15245     IF CP-ERROR-AMT-OUTSIDE-LIMIT                                ELC50PD
 15246         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS             ELC50PD
 15247         MOVE ER-2639        TO WS-ERROR                          ELC50PD
 15248         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15249                                                                  ELC50PD
 15250                                                                  00031363
 15251******************************************************************ELC50PD
 15252*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15253******************************************************************ELC50PD
 15254                                                                  ELC50PD
 15255 PREMIUM-EDITING-IS-BYPASSED.
 15256
 15257     IF (CP-R-MAX-ATT-AGE NUMERIC)
 15258        AND (CP-R-MAX-ATT-AGE > +0)
 15259        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 15260        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15261           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 15262           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15263           MOVE '1'              TO DC-OPTION-CODE
 15264           PERFORM 8500-DATE-CONVERT
 15265                                 THRU 8500-EXIT
 15266           IF NO-CONVERSION-ERROR
 15267              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15268                 MOVE ER-2661       TO WS-ERROR
 15269*                PERFORM 9900-ERROR-FORMAT
 15270*                                THRU 9900-EXIT
 15271              END-IF
 15272           END-IF
 15273        ELSE
 15274           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 15275           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15276              MOVE ER-2661       TO WS-ERROR
 15277*             PERFORM 9900-ERROR-FORMAT
 15278*                                THRU 9900-EXIT
 15279           ELSE
 15280              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15281                 MOVE ER-1570    TO WS-ERROR
 15282                 PERFORM 9900-ERROR-FORMAT
 15283                                 THRU 9900-EXIT
 15284              END-IF
 15285           END-IF
 15286        END-IF
 15287
 15288        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15289           MOVE PB-I-JOINT-BIRTHDAY
 15290                                 TO DC-BIN-DATE-1
 15291           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15292           MOVE '1'              TO DC-OPTION-CODE
 15293           PERFORM 8500-DATE-CONVERT
 15294                                 THRU 8500-EXIT
 15295           IF NO-CONVERSION-ERROR
 15296              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15297                 MOVE ER-2661       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 278
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15298*                PERFORM 9900-ERROR-FORMAT
 15299*                                THRU 9900-EXIT
 15300              END-IF
 15301           ELSE
 15302              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 15303           END-IF
 15304        ELSE
 15305           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 15306             (PB-I-LF-TERM / 12)
 15307           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15308              MOVE ER-2661       TO WS-ERROR
 15309*             PERFORM 9900-ERROR-FORMAT
 15310*                                THRU 9900-EXIT
 15311           ELSE
 15312              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15313                 MOVE ER-1571    TO WS-ERROR
 15314                 PERFORM 9900-ERROR-FORMAT
 15315                                 THRU 9900-EXIT
 15316              END-IF
 15317           END-IF
 15318        END-IF
 15319        IF WS-ERROR = ER-2661
 15320           PERFORM 9900-ERROR-FORMAT
 15321                                 THRU 9900-EXIT
 15322        END-IF
 15323     END-IF
 15324
 15325*    IF CP-ERROR-ATT-OUTSIDE-LIMIT                                ELC50PD
 15326*       MOVE ER-2661             TO WS-ERROR                      ELC50PD
 15327*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15328                                                                  ELC50PD
 15329     IF CP-ERROR-AGE-OUTSIDE-LIMIT                                ELC50PD
 15330        MOVE ER-2662             TO WS-ERROR                      ELC50PD
 15331        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15332                                                                  ELC50PD
 15333     IF CP-ERROR-TERM-OUTSIDE-LIMIT                               ELC50PD
 15334        MOVE ER-2677             TO WS-ERROR                      ELC50PD
 15335        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15336                                                                  ELC50PD
 15337     IF CP-ERROR-LOAN-TERM                                        ELC50PD
 15338        MOVE ER-2648             TO WS-ERROR                      ELC50PD
 15339        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15340                                                                  ELC50PD
 15341 3221-CHECK-ERROR-RATE-OPEN.                                      ELC50PD
 15342                                                                  ELC50PD
 15343     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 15344         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 15345                                                                  ELC50PD
 15346     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 15347        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE                ELC50PD
 15348     END-IF
 15349
 15350     .
 15351 3221-CONTINUE.                                                   ELC50PD
 15352     MOVE ZEROS                  TO WS-DCC-LF-RATE
 15353                                    WS-DCC-AH-RATE
 15354
 15355     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 279
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15356        IF WS-LF-BEN-CATEGORY = 'D'
 15357           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 15358              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 15359        END-IF
 15360     END-IF
 15361
 15362     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.            ELC50PD
 15363
 15364*   X'A4FF' = 12/31/2009
 15365     IF (PB-COMPANY-ID = 'CID')
 15366        AND (WS-LF-EARNINGS-CALC = 'B')
 15367        AND (CP-STATE-STD-ABBRV = 'MN')
 15368        AND (PB-CERT-EFF-DT > X'A4FF')
 15369        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 15370     END-IF
 15371
 15372     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.           ELC50PD
 15373                                                                  ELC50PD
 15374     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.                ELC50PD
 15375     IF (PB-COMPANY-ID = 'DCC')
 15376        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15377        AND (PB-I-POLICY-IS-MONTHLY)
 15378        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 15379        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 15380     END-IF
 15381     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.         ELC50PD
 15382     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.             ELC50PD
 15383     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.            ELC50PD
 15384     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15385
 15386     IF (PB-COMPANY-ID = 'DCC')
 15387        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 15388        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 15389        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 15390        MOVE ER-2786             TO WS-ERROR
 15391        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15392     END-IF
 15393                                                                  ELC50PD
 15394     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.               ELC50PD
 15395                                                                  ELC50PD
 15396******************************************************************ELC50PD
 15397*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15398******************************************************************ELC50PD
 15399     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15400        GO TO 3225-CHECK-ALT-LIFE-RATE.                           ELC50PD
 15401                                                                  ELC50PD
 15402     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15403        GO TO 3225-CHECK-ALT-LIFE-RATE                            ELC50PD
 15404     ELSE                                                         ELC50PD
 15405       IF PB-I-LF-RATE = ZERO                                     ELC50PD
 15406          MOVE ER-2641          TO WS-ERROR                       ELC50PD
 15407          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 15408                                                                  ELC50PD
 15409 3225-CHECK-ALT-LIFE-RATE.                                        ELC50PD
 15410                                                                  ELC50PD
 15411     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15412        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15413        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 280
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15414         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.                     ELC50PD
 15415                                                                  ELC50PD
 15416     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 15417         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 15418             AND PB-COMPANY-ID NOT = 'DCC')
 15419                   OR
 15420
 15421              (PB-I-LF-ALT-PREMIUM-AMT > +0
 15422              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 15423              AND PB-COMPANY-ID NOT = 'DCC')
 15424             MOVE ER-2720        TO  WS-ERROR                     ELC50PD
 15425             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 15426             GO TO 3225-RATING-CONT                               ELC50PD
 15427         ELSE                                                     ELC50PD
 15428             GO TO 3225-RATING-CONT.                              ELC50PD
 15429
 15430     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 15431        AND (AM-GPCD = 01 OR 06 OR 15)
 15432        MOVE ER-2798             TO WS-ERROR
 15433        PERFORM 9900-ERROR-FORMAT
 15434                                 THRU 9900-EXIT
 15435*       GO TO 3225-RATING-CONT
 15436     END-IF
 15437
 15438     IF (PB-COMPANY-ID = 'CID')
 15439        AND (WS-LF-EARNINGS-CALC = 'B')
 15440        AND (CP-STATE-STD-ABBRV = 'MN')
 15441        AND (PB-CERT-EFF-DT > X'A4FF')
 15442        GO TO 3225-RATING-CONT
 15443     END-IF
 15444
 15445     IF PB-COMPANY-ID = 'DCC'
 15446        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15447           AND (PB-I-POLICY-IS-MONTHLY)
 15448           GO TO 3225-RATING-CONT
 15449        END-IF
 15450     END-IF
 15451
 15452     IF PB-COMPANY-ID EQUAL 'WDS' AND                             ELC50PD
 15453        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND            ELC50PD
 15454        CP-EARN-AS-REG-BALLOON                                    ELC50PD
 15455        NEXT SENTENCE                                             ELC50PD
 15456     ELSE                                                         ELC50PD
 15457        MOVE '2'                 TO CP-EARNING-METHOD.            ELC50PD
 15458                                                                  ELC50PD
 15459 3225-SET-ALT-LIFE-RATE-LOOKUP.                                   ELC50PD
 15460                                                                  ELC50PD
 15461     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15462                                                                  ELC50PD
 15463     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15464        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15465        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15466         NEXT SENTENCE                                            ELC50PD
 15467     ELSE                                                         ELC50PD
 15468         MOVE SPACE              TO CP-SPECIAL-CALC-CD.           ELC50PD
 15469                                                                  ELC50PD
 15470     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15471     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 281
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15472     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15473                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15474     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15475         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15476                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15477
 15478     IF PB-COMPANY-ID = 'DCC'
 15479        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15480     END-IF
 15481
 15482     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15483     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15484     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15485                                    CP-REMAINING-TERM             ELC50PD
 15486                                    CP-LOAN-TERM.                 ELC50PD
 15487     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15488        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15489                                    CP-REMAINING-TERM             ELC50PD
 15490                                    CP-LOAN-TERM.                 ELC50PD
 15491                                                                  ELC50PD
 15492     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15493     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15494                                                                  ELC50PD
 15495     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15496         MOVE ER-2641            TO WS-ERROR                      ELC50PD
 15497         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15498         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15499                                                                  ELC50PD
 15500     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.             ELC50PD
 15501     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.        ELC50PD
 15502                                                                  ELC50PD
 15503     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN      ELC50PD
 15504         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15505                                                                  ELC50PD
 15506     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 15507                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 15508                                                                  ELC50PD
 15509     IF ACCOUNT-LIFE-CHECKED  OR                                  ELC50PD
 15510        PB-POLICY-IS-VOIDED   OR                                  ELC50PD
 15511        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')                    ELC50PD
 15512        GO TO 3225-CONTINUE.                                      ELC50PD
 15513                                                                  ELC50PD
 15514     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15515        GO TO 3225-CONTINUE.                                      ELC50PD
 15516                                                                  ELC50PD
 15517     IF WS-LF-BENEFIT-AMT  GREATER THAN                           ELC50PD
 15518                             EC-RT-LF-MAX-TOT-BEN                 ELC50PD
 15519        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS               ELC50PD
 15520        MOVE ER-2639       TO WS-ERROR                            ELC50PD
 15521        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15522                                                                  ELC50PD
 15523 3225-CONTINUE.                                                   ELC50PD
 15524     IF PB-I-LF-ALT-RATE = ZERO                                   ELC50PD
 15525         MOVE ER-2659            TO WS-ERROR                      ELC50PD
 15526         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15527                                                                  ELC50PD
 15528     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR                         ELC50PD
 15529        PB-I-LF-ALT-PREMIUM-AMT = ZERO                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 282
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15530        MOVE ER-2698             TO WS-ERROR                      ELC50PD
 15531        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15532                                                                  ELC50PD
 15533 3225-RATING-CONT.                                                ELC50PD
 15534                                                                  ELC50PD
 15535     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15536         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15537         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15538         IF (PB-COMPANY-ID = 'DCC')
 15539            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15540            CONTINUE
 15541         ELSE
 15542            MOVE ER-2687         TO WS-ERROR
 15543            PERFORM 9900-ERROR-FORMAT
 15544                                 THRU 9900-EXIT
 15545         END-IF
 15546         GO TO 3290-EDIT-LF-REIN-RATE
 15547     END-IF
 15548                                                                  ELC50PD
 15549* DMD RATING TEST                                                 ELC50PD
 15550     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15551         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15552         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15553         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 15554         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15555         GO TO 3290-EDIT-LF-REIN-RATE.                            ELC50PD
 15556                                                                  ELC50PD
 15557 3230-CLIENT-MORT-CD-SPECIALS.                                    ELC50PD
 15558                                                                  ELC50PD
 15559     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.                   ELC50PD
 15560     SET BIN-TO-GREG          TO TRUE.                            ELC50PD
 15561*    MOVE ' '                 TO DC-OPTION-CODE.                  ELC50PD
 15562     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15563     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.                    ELC50PD
 15564                                                                  ELC50PD
 15565 C-POS-3230-MORT-CD.                                              ELC50PD
 15566     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15567        PB-SV-CARRIER = '2'                                       ELC50PD
 15568         NEXT SENTENCE                                            ELC50PD
 15569     ELSE                                                         ELC50PD
 15570         GO TO C-POS-3240-MORT-CD.                                ELC50PD
 15571                                                                  ELC50PD
 15572     IF PB-SV-GROUPING = '030'                                    ELC50PD
 15573        AND PB-CERT-EFF-DT GREATER THAN WS-791231                 ELC50PD
 15574         MOVE '2350' TO PB-I-MORT-CODE                            ELC50PD
 15575      ELSE                                                        ELC50PD
 15576         MOVE '3300' TO PB-I-MORT-CODE.                           ELC50PD
 15577                                                                  ELC50PD
 15578                                                                  ELC50PD
 15579 C-POS-3240-MORT-CD.                                              ELC50PD
 15580     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15581        PB-SV-CARRIER = '1'                                       ELC50PD
 15582         NEXT SENTENCE                                            ELC50PD
 15583     ELSE                                                         ELC50PD
 15584         GO TO 3230-CONTINUE.                                     ELC50PD
 15585                                                                  ELC50PD
 15586     IF PB-SV-STATE = '45' OR '47'                                ELC50PD
 15587        OR PB-CERT-EFF-DT LESS THAN WS-771001                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 283
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15588         MOVE '5200' TO PB-I-MORT-CODE                            ELC50PD
 15589     ELSE                                                         ELC50PD
 15590         MOVE '8300' TO PB-I-MORT-CODE.                           ELC50PD
 15591                                                                  ELC50PD
 15592 3230-CONTINUE.                                                   ELC50PD
 15593
 15594     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'                       00033064
 15595        GO TO 3240-CONTINUE                                       00033065
 15596     END-IF
 15597
 15598     IF PB-CERT-EFF-DT > WS-971231
 15599        GO TO 3240-CONTINUE                                       00033065
 15600     END-IF
 15601
 15602     IF LF-BENEFIT-FOUND AND                                      00033066
 15603        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'                     00033067
 15604         MOVE 'F250'       TO PB-I-MORT-CODE                      00033068
 15605     ELSE                                                         00033069
 15606         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'                      00033070
 15607             MOVE '7250'   TO PB-I-MORT-CODE                      00033071
 15608         ELSE                                                     00033072
 15609             MOVE '4251'   TO PB-I-MORT-CODE                      00033073
 15610         END-IF
 15611     END-IF
 15612                                                                  00033074
 15613     .
 15614 3240-CONTINUE.                                                   ELC50PD
 15615
 15616     IF PB-COMPANY-ID NOT = 'GNL'                                 ELC50PD
 15617         GO TO 3256-CONTINUE.                                     ELC50PD
 15618                                                                  ELC50PD
 15619     IF PB-CERT-EFF-DT  LESS THAN WS-820301                       ELC50PD
 15620         MOVE 'A300' TO PB-I-MORT-CODE                            ELC50PD
 15621     ELSE                                                         ELC50PD
 15622         MOVE '8350' TO PB-I-MORT-CODE.                           ELC50PD
 15623                                                                  ELC50PD
 15624 3256-CONTINUE.                                                   ELC50PD
 15625     IF PB-COMPANY-ID NOT = 'ABL'                                 ELC50PD
 15626         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 15627                                                                  ELC50PD
 15628     IF PB-I-LF-TERM GREATER THAN 59                              ELC50PD
 15629         MOVE 'F550' TO PB-I-MORT-CODE                            ELC50PD
 15630     ELSE                                                         ELC50PD
 15631         MOVE 'E550' TO PB-I-MORT-CODE.                           ELC50PD
 15632                                                                  ELC50PD
 15633 3260-EDIT-CONTINUE.                                              ELC50PD
 15634     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.                       ELC50PD
 15635                                                                  ELC50PD
 15636 3290-EDIT-LF-REIN-RATE.                                          ELC50PD
 15637     IF LF-REIN-NSP-NOT-USED                                      ELC50PD
 15638         GO TO 3290-RATING-CONT.                                  ELC50PD
 15639                                                                  ELC50PD
 15640     IF PB-COMPANY-ID = 'DCC'
 15641        GO TO 3290-RATING-CONT.
 15642
 15643     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.         ELC50PD
 15644     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 15645     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 284
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15646     MOVE '3'                   TO CP-PROCESS-TYPE.               ELC50PD
 15647     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 15648                                                                  ELC50PD
 15649******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15650     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15651         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15652            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15653             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1                 ELC50PD
 15654*            MOVE SPACE          TO DC-OPTION-CODE                ELC50PD
 15655             SET BIN-TO-GREG     TO TRUE                          ELC50PD
 15656             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT             ELC50PD
 15657***  Y2K PROJ 7744                                                   CL*11
 15658             IF DC-GREG-DATE-CYMD GREATER 19931231                   CL*10
 15659                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15660***  Y2K PROJ 7744                                                   CL*11
 15661*******                                                           ELC50PD
 15662                                                                  ELC50PD
 15663     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 15664     MOVE PB-SV-STATE           TO CP-STATE.                      ELC50PD
 15665     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.                 ELC50PD
 15666     MOVE ZERO                  TO CP-DEVIATION-CODE              ELC50PD
 15667                                   CP-RATE-DEV-PCT.               ELC50PD
 15668     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                 ELC50PD
 15669     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT            ELC50PD
 15670                                   CP-RATING-BENEFIT-AMT.         ELC50PD
 15671                                                                  ELC50PD
 15672************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA     ELC50PD
 15673     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15674         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15675            CP-EARN-AS-NET-PAY                                    ELC50PD
 15676             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15677                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15678************                                                      ELC50PD
 15679                                                                  ELC50PD
 15680     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15681         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15682                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15683     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.           ELC50PD
 15684     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.                  ELC50PD
 15685     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.                ELC50PD
 15686     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.                 ELC50PD
 15687     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.                 ELC50PD
 15688     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.                   ELC50PD
 15689     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.            ELC50PD
 15690     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM               ELC50PD
 15691                                   CP-REMAINING-TERM              ELC50PD
 15692                                   CP-LOAN-TERM.                  ELC50PD
 15693     IF CP-TRUNCATED-LIFE                                         ELC50PD
 15694        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.                  ELC50PD
 15695                                                                  ELC50PD
 15696     IF CP-TERM-IS-DAYS                                           ELC50PD
 15697         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS         ELC50PD
 15698     ELSE                                                         ELC50PD
 15699         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15700                                                                  ELC50PD
 15701
 15702     IF PB-COMPANY-ID = 'DCC'
 15703        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 285
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15704     END-IF
 15705
 15706     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 15707          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 15708                                                                  ELC50PD
 15709     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.                         ELC50PD
 15710                                                                  ELC50PD
 15711     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15712     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15713                                                                  ELC50PD
 15714     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15715        IF PB-I-OB                                                ELC50PD
 15716           MOVE ER-2625      TO WS-ERROR                          ELC50PD
 15717           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15718           GO TO 3299-EDIT-CONTINUE                               ELC50PD
 15719        ELSE                                                      ELC50PD
 15720           MOVE ER-2643      TO WS-ERROR                          ELC50PD
 15721           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15722           GO TO 3299-EDIT-CONTINUE.                              ELC50PD
 15723                                                                  ELC50PD
 15724     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.                 ELC50PD
 15725                                                                  ELC50PD
 15726     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.                ELC50PD
 15727     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.                  ELC50PD
 15728                                                                  ELC50PD
 15729     IF PB-I-LF-REI-RATE = ZERO                                   ELC50PD
 15730         MOVE ER-2643        TO WS-ERROR                          ELC50PD
 15731         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15732                                                                  ELC50PD
 15733 3290-CHECK-ALT-REIN-RATE.                                        ELC50PD
 15734                                                                  ELC50PD
 15735     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 15736        GO TO 3290-RATING-CONT.                                   ELC50PD
 15737                                                                  ELC50PD
 15738     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15739     MOVE '2'                    TO CP-EARNING-METHOD.            ELC50PD
 15740     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15741     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15742     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15743     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15744                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15745     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15746         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15747                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15748
 15749     IF PB-COMPANY-ID = 'DCC'
 15750        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15751     END-IF
 15752
 15753     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15754     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15755     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15756                                    CP-REMAINING-TERM             ELC50PD
 15757                                    CP-LOAN-TERM.                 ELC50PD
 15758     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15759        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15760                                    CP-REMAINING-TERM             ELC50PD
 15761                                    CP-LOAN-TERM.                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 286
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15762                                                                  ELC50PD
 15763     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15764     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15765                                                                  ELC50PD
 15766     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.         ELC50PD
 15767                                                                  ELC50PD
 15768     IF PB-I-LF-ALT-REI-RATE = ZERO                               ELC50PD
 15769         MOVE ER-2643            TO WS-ERROR                      ELC50PD
 15770         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15771                                                                  ELC50PD
 15772 3290-RATING-CONT.                                                ELC50PD
 15773                                                                  ELC50PD
 15774     IF PB-I-OB                                                   ELC50PD
 15775*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15776        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15777                                                                  ELC50PD
 15778 3299-EDIT-CONTINUE.                                              ELC50PD
 15779                                                                  ELC50PD
 15780     IF  PB-I-MORT-CODE GREATER THAN SPACES                       ELC50PD
 15781         NEXT SENTENCE                                            ELC50PD
 15782     ELSE                                                         ELC50PD
 15783         MOVE ER-2620           TO WS-ERROR                       ELC50PD
 15784         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15785                                                                  ELC50PD
 15786 3300-CHECK-AH-RATES.                                             ELC50PD
 15787     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND                 ELC50PD
 15788         NEXT SENTENCE                                            ELC50PD
 15789     ELSE                                                         ELC50PD
 15790         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 15791                                                                  ELC50PD
 15792     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR                        ELC50PD
 15793        ((CF-COMPANY-ID = 'DMD') AND                              ELC50PD
 15794                (NO-DMD-RATING))                                  ELC50PD
 15795         IF (PB-COMPANY-ID = 'DCC')
 15796            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15797            CONTINUE
 15798         ELSE
 15799            MOVE ER-2687         TO WS-ERROR
 15800            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15801         END-IF
 15802         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 15803         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 15804     END-IF
 15805                                                                  ELC50PD
 15806     IF PB-I-OB                                                   ELC50PD
 15807        GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15808                                                                  ELC50PD
 15809     IF WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15810         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 15811         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15812         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC            ELC50PD
 15813         GO TO 3999-END-EDIT.                                     ELC50PD
 15814                                                                  ELC50PD
 15815*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****        ELC50PD
 15816                                                                  ELC50PD
 15817     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15818        IF PB-I-AH-CRIT-PER = ZERO
 15819           IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 287
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15820              AND AM-DCC-PRODUCT-CODE = 'DDF'
 15821              CONTINUE
 15822           ELSE
 15823              MOVE ER-2618       TO WS-ERROR
 15824              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15825              GO TO 3999-END-EDIT
 15826           END-IF
 15827        END-IF
 15828     END-IF
 15829
 15830     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15831     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15832     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15833     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15834     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15835     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15836     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15837     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.            ELC50PD
 15838     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.              ELC50PD
 15839*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15840     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 15841     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15842     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15843     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15844                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15845     IF PB-COMPANY-ID = 'CID'
 15846               OR
 15847        CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15848         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 15849                                         PB-I-AH-TERM.            ELC50PD
 15850     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 15851        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 15852           AND (PB-I-POLICY-IS-MONTHLY)
 15853           MOVE PB-I-LF-BENEFIT-AMT
 15854                                 TO CP-NET-BENEFIT-AMT
 15855           move pb-i-ah-premium-amt to cp-original-premium
 15856           add pb-i-lf-premium-amt to cp-original-premium
 15857        END-IF
 15858     END-IF
 15859
 15860     MOVE SPACES                 TO CP-BEN-CATEGORY
 15861
 15862     IF PB-COMPANY-ID = 'DCC'
 15863        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 15864        EVALUATE TRUE
 15865           WHEN (WS-AH-BEN-CATEGORY = 'G')
 15866              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15867              MOVE PB-I-LF-BENEFIT-AMT
 15868                                 TO CP-RATING-BENEFIT-AMT
 15869              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 15870           WHEN WS-AH-BEN-CATEGORY = 'G'
 15871              MOVE PB-I-UNPAID-CASH-PRICE
 15872                                 TO CP-RATING-BENEFIT-AMT
 15873           WHEN WS-AH-BEN-CATEGORY = 'D'
 15874              MOVE WS-AH-PMF-COMM
 15875                                 TO CP-DCC-PMF-COMM
 15876              MOVE PB-I-AH-COMMISSION
 15877                                 TO CP-DCC-ACT-COMM
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 288
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15878        END-EVALUATE
 15879     END-IF
 15880
 15881     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 15882     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15883     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15884     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15885     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15886     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.           ELC50PD
 15887     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15888                                    CP-REMAINING-TERM             ELC50PD
 15889                                    WS-WORK-TERM.                 ELC50PD
 15890     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.          ELC50PD
 15891                                                                  ELC50PD
 15892     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 15893     SET BIN-TO-GREG             TO TRUE.                         ELC50PD
 15894*    MOVE ' '                    TO DC-OPTION-CODE.               ELC50PD
 15895     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15896     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.                 ELC50PD
 15897                                                                  ELC50PD
 15898     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.           ELC50PD
 15899     IF NOT VALID-SKIP-CODE                                       ELC50PD
 15900         MOVE ER-2683            TO WS-ERROR                      ELC50PD
 15901         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15902         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15903                                                                  ELC50PD
 15904     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 15905         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15906                                                                  ELC50PD
 15907     MOVE SPACE TO NUMBER-OF-MONTHS.                              ELC50PD
 15908                                                                  ELC50PD
 15909     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'                        ELC50PD
 15910         MOVE 'S'                TO SK-MO (6).                    ELC50PD
 15911     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'          ELC50PD
 15912         MOVE 'S'                TO SK-MO (7).                    ELC50PD
 15913     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'   ELC50PD
 15914         MOVE 'S'                TO SK-MO (8).                    ELC50PD
 15915     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'                 ELC50PD
 15916         MOVE 'S'                TO SK-MO (9).                    ELC50PD
 15917     IF PB-I-SKIP-CODE = 'A'                                      ELC50PD
 15918         MOVE 'S'                TO SK-MO (10).                   ELC50PD
 15919                                                                  ELC50PD
 15920     MOVE 1                      TO SUB2.                         ELC50PD
 15921     MOVE PB-I-AH-TERM           TO SUB3.                         ELC50PD
 15922     MOVE WS-MONTH               TO SUB1.                         ELC50PD
 15923     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.       ELC50PD
 15924     GO TO 3320-RATE-CONTINUE.                                    ELC50PD
 15925                                                                  ELC50PD
 15926 3310-GET-SKIP-MO.                                                ELC50PD
 15927     IF SUB1 = 13                                                 ELC50PD
 15928         MOVE 1                  TO SUB1.                         ELC50PD
 15929                                                                  ELC50PD
 15930     IF SK-MO (SUB1) = 'S'                                        ELC50PD
 15931         SUBTRACT 1 FROM WS-WORK-TERM.                            ELC50PD
 15932                                                                  ELC50PD
 15933     ADD 1 TO SUB2                                                ELC50PD
 15934              SUB1.                                               ELC50PD
 15935                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 289
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15936 3320-RATE-CONTINUE.                                              ELC50PD
 15937                                                                  ELC50PD
 15938     IF WS-WORK-TERM = ZERO                                       ELC50PD
 15939         MOVE 1                  TO WS-WORK-TERM.                 ELC50PD
 15940                                                                  ELC50PD
 15941     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM              ELC50PD
 15942                                    CP-LOAN-TERM.                 ELC50PD
 15943                                                                  ELC50PD
 15944     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 15945         NEXT SENTENCE                                            ELC50PD
 15946     ELSE                                                         ELC50PD
 15947         MOVE ZERO               TO PB-I-AH-RATE                  ELC50PD
 15948                                    PB-I-AH-REI-RATE.             ELC50PD
 15949                                                                  ELC50PD
 15950                                                                  ELC50PD
 15951     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15952        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15953                                                                  ELC50PD
 15954     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15955         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN              ELC50PD
 15956         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN              ELC50PD
 15957         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15958         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.               ELC50PD
 15959                                                                  ELC50PD
 15960     IF PB-COMPANY-ID = 'DCC'
 15961        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15962           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15963              PB-I-RATE-DEV-PCT-LF
 15964        END-IF
 15965        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15966                                 TO CP-ALTERNATE-BENEFIT
 15967        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15968        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15969        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15970     END-IF
 15971
 15972     IF (PB-COMPANY-ID = 'CID')
 15973        AND (WS-LF-EARNINGS-CALC = 'B')
 15974        AND (CP-STATE-STD-ABBRV = 'MN')
 15975        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 15976     ELSE
 15977        MOVE ' '                 TO CP-AH-BALLOON-SW
 15978     END-IF
 15979
 15980     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 15981     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15982     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15983                                                                  ELC50PD
 15984     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15985        IF PB-I-OB                                                ELC50PD
 15986           MOVE ER-2624          TO WS-ERROR                      ELC50PD
 15987           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15988           GO TO 3340-CALCULATE-PREMIUM-AMT                       ELC50PD
 15989        ELSE                                                      ELC50PD
 15990          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 15991              NEXT SENTENCE
 15992          ELSE
 15993           MOVE ER-2642          TO WS-ERROR                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 290
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15994           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15995           GO TO 3340-CALCULATE-PREMIUM-AMT.                      ELC50PD
 15996                                                                  ELC50PD
 15997     IF PB-COMPANY-ID EQUAL 'CSL' AND                             ELC50PD
 15998        CP-ERROR-DIV-BY-ZERO                                      ELC50PD
 15999           MOVE ER-3782          TO WS-ERROR                      ELC50PD
 16000           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16001                                                                  ELC50PD
 16002     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 16003        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 16004           IF NOT ACCOUNT-AH-CHECKED                              ELC50PD
 16005              MOVE ER-2607          TO WS-ERROR                   ELC50PD
 16006              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 16007                                                                  ELC50PD
 16008     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16009        NEXT SENTENCE                                             ELC50PD
 16010     ELSE                                                         ELC50PD
 16011       IF CP-ERROR-AMT-OUTSIDE-LIMIT                              ELC50PD
 16012          MOVE ER-2640           TO WS-ERROR                      ELC50PD
 16013          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 16014                                                                  ELC50PD
 16015     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16016         IF WS-ERROR = ER-2640                                    ELC50PD
 16017             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16018
 16019     IF ACCOUNT-AH-CHECKED
 16020        CONTINUE
 16021     ELSE
 16022        IF (CP-R-MAX-ATT-AGE NUMERIC)
 16023           AND (CP-R-MAX-ATT-AGE > +0)
 16024           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 16025           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 16026              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 16027              MOVE PB-I-AH-EXPIRE-DT
 16028                                 TO DC-BIN-DATE-2
 16029              MOVE '1'           TO DC-OPTION-CODE
 16030              PERFORM 8500-DATE-CONVERT
 16031                                 THRU 8500-EXIT
 16032              IF NO-CONVERSION-ERROR
 16033                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16034                    MOVE ER-2661       TO WS-ERROR
 16035*                   PERFORM 9900-ERROR-FORMAT
 16036*                                THRU 9900-EXIT
 16037                 END-IF
 16038              END-IF
 16039           ELSE
 16040              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 16041              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16042                 MOVE ER-2661    TO WS-ERROR
 16043*                PERFORM 9900-ERROR-FORMAT
 16044*                                THRU 9900-EXIT
 16045              ELSE
 16046                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16047                    MOVE ER-1570 TO WS-ERROR
 16048                    PERFORM 9900-ERROR-FORMAT
 16049                                 THRU 9900-EXIT
 16050                 END-IF
 16051              END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 291
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16052           END-IF
 16053
 16054           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 16055              MOVE PB-I-JOINT-BIRTHDAY
 16056                                    TO DC-BIN-DATE-1
 16057              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 16058              MOVE '1'              TO DC-OPTION-CODE
 16059              PERFORM 8500-DATE-CONVERT
 16060                                    THRU 8500-EXIT
 16061              IF NO-CONVERSION-ERROR
 16062                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16063                    MOVE ER-2661       TO WS-ERROR
 16064*                   PERFORM 9900-ERROR-FORMAT
 16065*                                   THRU 9900-EXIT
 16066                 END-IF
 16067              END-IF
 16068           ELSE
 16069              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 16070                (PB-I-AH-TERM / 12)
 16071              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16072                 MOVE ER-2661       TO WS-ERROR
 16073*                PERFORM 9900-ERROR-FORMAT
 16074*                                   THRU 9900-EXIT
 16075              ELSE
 16076                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16077                    MOVE ER-1571 TO WS-ERROR
 16078                    PERFORM 9900-ERROR-FORMAT
 16079                                 THRU 9900-EXIT
 16080                 END-IF
 16081              END-IF
 16082           END-IF
 16083           IF WS-ERROR = ER-2661
 16084              PERFORM 9900-ERROR-FORMAT
 16085                                    THRU 9900-EXIT
 16086           END-IF
 16087        END-IF
 16088     END-IF
 16089
 16090*    IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16091*       NEXT SENTENCE                                             ELC50PD
 16092*    ELSE                                                         ELC50PD
 16093*       IF CP-ERROR-ATT-OUTSIDE-LIMIT                             ELC50PD
 16094*          MOVE ER-2661          TO WS-ERROR                      ELC50PD
 16095*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16096                                                                  ELC50PD
 16097     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16098        NEXT SENTENCE                                             ELC50PD
 16099     ELSE                                                         ELC50PD
 16100        IF CP-ERROR-AGE-OUTSIDE-LIMIT                             ELC50PD
 16101           MOVE ER-2663          TO WS-ERROR                      ELC50PD
 16102           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16103                                                                  ELC50PD
 16104     IF ACCOUNT-AH-CHECKED OR                                     ELC50PD
 16105        (WS-AH-SPECIAL-CALC-CD = 'Z') OR                          ELC50PD
 16106         PB-POLICY-IS-VOIDED                                      ELC50PD
 16107        NEXT SENTENCE                                             ELC50PD
 16108     ELSE                                                         ELC50PD
 16109        IF CP-ERROR-TOT-OUTSIDE-LIMIT                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 292
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16110           MOVE ER-2667            TO WS-ERROR                    ELC50PD
 16111           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16112                                                                  ELC50PD
 16113     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16114         IF WS-ERROR = ER-2667                                    ELC50PD
 16115             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16116                                                                  ELC50PD
 16117     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16118        NEXT SENTENCE                                             ELC50PD
 16119     ELSE                                                         ELC50PD
 16120        IF CP-ERROR-TERM-OUTSIDE-LIMIT                            ELC50PD
 16121           MOVE ER-2678            TO WS-ERROR                    ELC50PD
 16122           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16123                                                                  ELC50PD
 16124     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 16125         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 16126                                                                  ELC50PD
 16127 3321-CONTINUE.                                                   ELC50PD
 16128     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.                 ELC50PD
 16129     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.            ELC50PD
 16130
 16131     IF (PB-COMPANY-ID = 'DCC')
 16132        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16133        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 16134                                    PB-I-LF-ALT-PREM-CALC
 16135        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 16136        IF WS-AH-BEN-CATEGORY = 'G'
 16137           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16138           + PB-I-ADDL-CLP)
 16139           * (1 + WS-TOL-CLP-PCT)
 16140*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 16141        ELSE
 16142           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16143           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 16144*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 16145        END-IF
 16146        MOVE WS-TOL-LF-HIGH-PREM-AMT
 16147                                 TO PB-I-AH-PREM-CALC
 16148        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 16149           MOVE ER-8152          TO WS-ERROR
 16150           PERFORM 9900-ERROR-FORMAT
 16151                                 THRU 9900-EXIT
 16152        ELSE
 16153           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 16154                 PB-I-ADDL-CLP)
 16155              MOVE ER-8148       TO WS-ERROR
 16156              PERFORM 9900-ERROR-FORMAT
 16157                                 THRU 9900-EXIT
 16158           END-IF
 16159        END-IF
 16160     END-IF
 16161     IF (PB-COMPANY-ID = 'DCC')
 16162        AND (PB-I-POLICY-IS-MONTHLY)
 16163        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16164        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 16165        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 16166           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 16167        END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 293
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16168     END-IF
 16169
 16170     IF (PB-COMPANY-ID = 'DCC')
 16171        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 16172        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 16173        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 16174        MOVE ER-2786             TO WS-ERROR
 16175        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16176     END-IF
 16177
 16178     MOVE +0                     TO PB-I-AH-CLP
 16179     IF PB-COMPANY-ID = 'DCC'
 16180        IF WS-AH-BEN-CATEGORY = 'D'
 16181           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 16182              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 16183        ELSE
 16184           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 16185              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 16186           END-IF
 16187        END-IF
 16188     END-IF
 16189
 16190     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.           ELC50PD
 16191                                                                  ELC50PD
 16192     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC                           ELC50PD
 16193         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16194                                                                  ELC50PD
 16195     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC                           ELC50PD
 16196         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.          ELC50PD
 16197                                                                  ELC50PD
 16198     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16199         IF PB-I-NO-OF-PAYMENTS = ZERO  OR                        ELC50PD
 16200            PB-I-PAYMENT-AMOUNT = ZERO                            ELC50PD
 16201             NEXT SENTENCE                                        ELC50PD
 16202         ELSE                                                     ELC50PD
 16203             COMPUTE PB-I-AH-PREM-CALC =                          ELC50PD
 16204                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *    ELC50PD
 16205                 (CP-PREMIUM-RATE / 100)                          ELC50PD
 16206             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO                   ELC50PD
 16207                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *  ELC50PD
 16208                                             PB-I-RATE-DEV-PCT-AH.ELC50PD
 16209                                                                  ELC50PD
 16210     IF PB-I-AH-RATE  = ZERO                                      ELC50PD
 16211       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16212           NEXT SENTENCE
 16213       ELSE
 16214         MOVE ER-2642            TO WS-ERROR                      ELC50PD
 16215         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16216                                                                  ELC50PD
 16217     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.                ELC50PD
 16218     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.         ELC50PD
 16219     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.             ELC50PD
 16220     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.            ELC50PD
 16221     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.         ELC50PD
 16222     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.         ELC50PD
 16223                                                                  ELC50PD
 16224     IF (PB-COMPANY-ID = 'DCC')
 16225        AND (WS-AH-BEN-CATEGORY = 'G')
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 294
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16226        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16227        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 16228        IF CP-DEVIATION-CODE NOT = '000'
 16229           MOVE '000'            TO CP-DEVIATION-CODE
 16230           PERFORM 7000-GET-RATE THRU 7000-EXIT
 16231           IF NO-CP-ERROR
 16232              COMPUTE PB-I-DDF-IU-RATE-UP =
 16233              PB-I-AH-CLP - CP-CALC-PREMIUM
 16234           ELSE
 16235              MOVE ER-3057        TO WS-ERROR
 16236              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16237           END-IF
 16238        END-IF
 16239     END-IF
 16240
 16241     .
 16242 3335-EDIT-AH-REIN-NSP-RATE.                                      ELC50PD
 16243     IF AH-REIN-NSP-NOT-USED                                      ELC50PD
 16244         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16245                                                                  ELC50PD
 16246     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.                       ELC50PD
 16247     IF PB-COMPANY-ID = 'DCC'
 16248         GO TO 3340-CALCULATE-PREMIUM-AMT.
 16249
 16250     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 16251     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 16252     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 16253     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16254     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16255     MOVE ZERO                   TO CP-DEVIATION-CODE             ELC50PD
 16256                                    CP-RATE-DEV-PCT.              ELC50PD
 16257*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 16258     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 16259     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16260     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16261     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16262                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16263     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16264         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 16265                                         PB-I-AH-TERM.            ELC50PD
 16266     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 16267     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16268     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16269     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16270     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16271     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16272                                    CP-REMAINING-TERM             ELC50PD
 16273                                    WS-WORK-TERM.                 ELC50PD
 16274     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.           ELC50PD
 16275
 16276     IF PB-COMPANY-ID = 'DCC'
 16277        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16278     END-IF
 16279
 16280     IF  PB-COMPANY-ID = 'TIC'                                    ELC50PD
 16281         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'             ELC50PD
 16282            MOVE ZERO TO CP-CLASS-CODE.                           ELC50PD
 16283                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 295
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16284     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 16285          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 16286                                                                  ELC50PD
 16287     MOVE ZERO               TO CP-DEVIATION-CODE.                ELC50PD
 16288                                                                  ELC50PD
 16289     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.                         ELC50PD
 16290                                                                  ELC50PD
 16291     MOVE ZERO               TO PB-I-AH-REI-RATE.                 ELC50PD
 16292                                                                  ELC50PD
 16293     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16294     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16295                                                                  ELC50PD
 16296     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 16297         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16298         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 16299         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16300                                                                  ELC50PD
 16301     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.                 ELC50PD
 16302                                                                  ELC50PD
 16303     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.                ELC50PD
 16304     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.                  ELC50PD
 16305                                                                  ELC50PD
 16306     IF PB-I-AH-REI-RATE = ZERO                                   ELC50PD
 16307         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16308         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16309                                                                  ELC50PD
 16310                                                                  ELC50PD
 16311 3340-CALCULATE-PREMIUM-AMT.                                      ELC50PD
 16312                                                                  ELC50PD
 16313     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 16314         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR                      ELC50PD
 16315             WS-AH-SPECIAL-CALC-CD = 'O')                         ELC50PD
 16316             GO TO 3999-END-EDIT.                                 ELC50PD
 16317                                                                  ELC50PD
 16318     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR       ELC50PD
 16319                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR       ELC50PD
 16320                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'          ELC50PD
 16321                         OR 'AHL'
 16322         NEXT SENTENCE                                            ELC50PD
 16323     ELSE                                                         ELC50PD
 16324         IF WS-STATE-ABBREVIATION = 'CT'                          ELC50PD
 16325             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND ELC50PD
 16326                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)       ELC50PD
 16327                 COMPUTE PB-I-LF-PREM-CALC =                      ELC50PD
 16328                                     PB-I-LF-PREM-CALC * .90      ELC50PD
 16329                 COMPUTE PB-I-LF-ALT-PREM-CALC =                  ELC50PD
 16330                                     PB-I-LF-ALT-PREM-CALC * .90  ELC50PD
 16331                 COMPUTE PB-I-AH-PREM-CALC =                      ELC50PD
 16332                                     PB-I-AH-PREM-CALC * .90.     ELC50PD
 16333                                                                  ELC50PD
 16334     IF PB-COMP-LF-PREM                                           ELC50PD
 16335        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT       ELC50PD
 16336        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.  ELC50PD
 16337                                                                  ELC50PD
 16338     IF PB-COMP-AH-PREM                                           ELC50PD
 16339        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.      ELC50PD
 16340                                                                  ELC50PD
 16341 3340-CHECK-DCC-TOT-FEES.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 296
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16342
 16343     IF (PB-COMPANY-ID = 'DCC')
 16344        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 16345        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16346        AND (PB-I-POLICY-IS-MONTHLY)
 16347        CONTINUE
 16348     ELSE
 16349        GO TO 3340-EDIT-LF-AH-TOL
 16350     END-IF
 16351
 16352     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 16353     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 16354
 16355     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 16356        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16357           PB-I-RATE-DEV-PCT-LF
 16358     END-IF
 16359     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 16360        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 16361           PB-I-RATE-DEV-PCT-AH
 16362     END-IF
 16363     MOVE 'N'                    TO CP-BEN-CATEGORY
 16364
 16365     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 16366                                                                  ELC50PD
 16367     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 16368     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 16369     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 16370     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 16371     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 16372     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 16373     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 16374     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16375     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 16376     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 16377                                                                  ELC50PD
 16378     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16379     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16380     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 16381     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 16382     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16383     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16384                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16385     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16386         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 16387                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 16388     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 16389     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 16390     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 16391     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16392     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16393     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16394     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16395     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 16396     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16397                                    CP-REMAINING-TERM             ELC50PD
 16398                                    CP-LOAN-TERM.                 ELC50PD
 16399     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 297
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16400         NEXT SENTENCE                                            ELC50PD
 16401     ELSE                                                         ELC50PD
 16402         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 16403             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 16404                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 16405                                                                  ELC50PD
 16406     IF CP-TRUNCATED-LIFE                                         ELC50PD
 16407        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 16408                                                                  ELC50PD
 16409     IF CP-TERM-IS-DAYS                                           ELC50PD
 16410         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 16411     ELSE                                                         ELC50PD
 16412         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 16413                                                                  ELC50PD
 16414
 16415     IF PB-COMPANY-ID = 'DCC'
 16416        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16417     END-IF
 16418
 16419     IF CP-SPECIAL-CALC-CD = 'H'                                  ELC50PD
 16420         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 16421                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 16422         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 16423
 16424     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 16425     MOVE 'R'                    TO CP-RATE-FILE
 16426     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 16427
 16428     IF NOT CP-ERROR-RATE-NOT-FOUND
 16429        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 16430        IF (CP-DCC-LF-RATE NOT = ZEROS)
 16431           AND (CP-BENEFIT-CD (1:1) = 'S')
 16432           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 16433                                    PB-I-LF-PREMIUM-AMT
 16434        END-IF
 16435     ELSE
 16436        MOVE +0                  TO PB-I-TOT-FEES-CALC
 16437     END-IF
 16438
 16439     .
 16440 3340-EDIT-LF-AH-TOL.                                             ELC50PD
 16441                                                                  ELC50PD
 16442***    UNSIGN-WRK1    =    LIFE DIFFERENCE                        ELC50PD
 16443***    UNSIGN-WRK2    =    AH   DIFFERENCE                        ELC50PD
 16444***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE                   ELC50PD
 16445***                                                               ELC50PD
 16446     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT            ELC50PD
 16447         PB-I-AH-PREMIUM-AMT                                      ELC50PD
 16448          GIVING WS-CALC-WORK.                                    ELC50PD
 16449                                                                  ELC50PD
 16450     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM                     ELC50PD
 16451        AND WS-CALC-WORK NOT = ZERO                               ELC50PD
 16452         MOVE ER-2649            TO WS-ERROR                      ELC50PD
 16453         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16454                                                                  ELC50PD
 16455     SUBTRACT PB-I-LF-PREM-CALC                                      CL**2
 16456             FROM PB-I-LF-PREMIUM-AMT                             ELC50PD
 16457                 GIVING WS-UNSIGN-WRK1.                              CL**2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 298
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16458                                                                     CL**2
 16459     SUBTRACT PB-I-LF-ALT-PREM-CALC                                  CL**2
 16460             FROM PB-I-LF-ALT-PREMIUM-AMT                         ELC50PD
 16461                 GIVING WS-UNSIGN-WRK4.                              CL**2
 16462                                                                     CL**2
 16463     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1                         CL**2
 16464                                + WS-UNSIGN-WRK4.                    CL**2
 16465                                                                     CL**2
 16466     SUBTRACT PB-I-AH-PREM-CALC                                      CL**2
 16467             FROM PB-I-AH-PREMIUM-AMT                             ELC50PD
 16468                 GIVING WS-UNSIGN-WRK2.                           ELC50PD
 16469                                                                  ELC50PD
 16470******************************************************************ELC50PD
 16471*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *ELC50PD
 16472******************************************************************ELC50PD
 16473                                                                  ELC50PD
 16474     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 16475         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 16476                                                                  ELC50PD
 16477     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 16478         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 16479                                                                  ELC50PD
 16480     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2                               CL**2
 16481             GIVING WS-UNSIGN-WRK3.                               ELC50PD
 16482                                                                  ELC50PD
 16483 3342-CONTINUE.                                                   ELC50PD
 16484                                                                  ELC50PD
 16485     IF (PB-I-LF-RATE = ZERO  AND                                 ELC50PD
 16486         PB-I-AH-RATE = ZERO)                                     ELC50PD
 16487         IF WS-LF-SPECIAL-CALC-CD = 'O' OR                        ELC50PD
 16488            WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 16489              NEXT SENTENCE                                       ELC50PD
 16490         ELSE                                                     ELC50PD
 16491             GO TO 3345-EDIT-CONTINUE.                            ELC50PD
 16492                                                                  ELC50PD
 16493     IF  PB-RECORD-BILL   =  'B' OR  'L'                          ELC50PD
 16494         NEXT SENTENCE                                            ELC50PD
 16495     ELSE                                                         ELC50PD
 16496     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'                        ELC50PD
 16497        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM             ELC50PD
 16498           IF (PB-REISSUED-CERT         OR                        ELC50PD
 16499               PB-POLICY-IS-DECLINED    OR                        ELC50PD
 16500               PB-POLICY-IS-VOIDED)                               ELC50PD
 16501              NEXT SENTENCE                                       ELC50PD
 16502           ELSE                                                   ELC50PD
 16503              IF WS-PREM-REJECT-SW = SPACE                        ELC50PD
 16504                 MOVE ER-2652    TO WS-ERROR                      ELC50PD
 16505                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16506                 GO TO 3344-CHECK-AH                              ELC50PD
 16507              ELSE                                                ELC50PD
 16508                 MOVE ER-2650    TO WS-ERROR                      ELC50PD
 16509                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16510                 GO TO 3344-CHECK-AH.                             ELC50PD
 16511                                                                  ELC50PD
 16512***                                                               ELC50PD
 16513***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES                ELC50PD
 16514***                                                               ELC50PD
 16515                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 299
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16516     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16517         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =                        ELC50PD
 16518            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16519             (1 + WS-TOL-LF-PREM-PCT)                             ELC50PD
 16520         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =                        ELC50PD
 16521            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16522             (1 - WS-TOL-LF-PREM-PCT)                             ELC50PD
 16523     ELSE                                                         ELC50PD
 16524         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 16525         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16526                                                                  ELC50PD
 16527***                                                               ELC50PD
 16528***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES                 ELC50PD
 16529***                                                               ELC50PD
 16530                                                                  ELC50PD
 16531     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL                        ELC50PD
 16532         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +              ELC50PD
 16533          WS-TOL-LF-PREM.                                         ELC50PD
 16534                                                                  ELC50PD
 16535     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL                         ELC50PD
 16536         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -            ELC50PD
 16537          WS-TOL-LF-PREM.                                         ELC50PD
 16538                                                                  ELC50PD
 16539     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16540        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.       ELC50PD
 16541                                                                  ELC50PD
 16542     IF PB-REISSUED-CERT
 16543        or PB-POLICY-IS-DECLINED
 16544        or PB-POLICY-IS-VOIDED
 16545        continue
 16546     ELSE
 16547        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16548              > WS-TOL-LF-HIGH-PREM-AMT)
 16549           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16550              < WS-TOL-LF-LOW-PREM-AMT))
 16551                      or
 16552           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16553              > WS-TOL-LF-HIGH-PREM-PCT)
 16554           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16555              < WS-TOL-LF-LOW-PREM-PCT))
 16556           IF WS-PREM-REJECT-SW = SPACE
 16557              MOVE ER-2652       TO WS-ERROR
 16558              PERFORM 9900-ERROR-FORMAT
 16559                                 THRU 9900-EXIT
 16560           ELSE
 16561              MOVE ER-2650       TO WS-ERROR
 16562              PERFORM 9900-ERROR-FORMAT
 16563                                 THRU 9900-EXIT
 16564           end-if
 16565        end-if
 16566     end-if
 16567                                                                  ELC50PD
 16568*    IF  WS-ERROR  =  ER-2650  OR  ER-2652                        ELC50PD
 16569*        IF  PB-RECORD-BILL   =  'B' OR  'L'                      ELC50PD
 16570*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16571*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16572                                                                  ELC50PD
 16573     IF WS-ERROR  =  ER-2650  OR  ER-2652
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 300
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16574        IF (PB-RECORD-BILL   =  'B' OR  'L')
 16575                      OR
 16576           ((PB-COMPANY-ID = 'DCC')
 16577           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 16578           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 16579           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 16580        END-IF
 16581     END-IF
 16582                                                                  ELC50PD
 16583     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16584        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16585           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16586              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16587                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16588                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16589                 NEXT SENTENCE                                    ELC50PD
 16590              ELSE                                                ELC50PD
 16591                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16592                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16593                                                                  ELC50PD
 16594 3344-CVL-TOLERANCE-CHECK.                                        ELC50PD
 16595                                                                  ELC50PD
 16596      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'                    ELC50PD
 16597          GO TO 3344-CHECK-AH.                                    ELC50PD
 16598                                                                  ELC50PD
 16599      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS              ELC50PD
 16600          GO TO 3344-CHECK-AH.                                    ELC50PD
 16601                                                                  ELC50PD
 16602      MOVE ZERO                  TO  WS-UNSIGN-WRK5               ELC50PD
 16603                                     WS-UNSIGN-WRK6.              ELC50PD
 16604                                                                  ELC50PD
 16605      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO               ELC50PD
 16606          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5                 ELC50PD
 16607                                 + PB-I-LF-PREMIUM-AMT            ELC50PD
 16608                                 - PB-I-LF-PREM-CALC.             ELC50PD
 16609                                                                  ELC50PD
 16610      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO           ELC50PD
 16611          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6                 ELC50PD
 16612                                 + PB-I-LF-ALT-PREMIUM-AMT        ELC50PD
 16613                                 - PB-I-LF-ALT-PREM-CALC.         ELC50PD
 16614                                                                  ELC50PD
 16615      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO                    ELC50PD
 16616          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16617              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16618                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16619                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16620              ELSE                                                ELC50PD
 16621                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16622                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16623                                                                  ELC50PD
 16624      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO                    ELC50PD
 16625          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16626              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16627                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16628                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16629              ELSE                                                ELC50PD
 16630                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16631                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 301
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16632                                                                  ELC50PD
 16633 3344-CHECK-AH.                                                   ELC50PD
 16634                                                                  ELC50PD
 16635****************************************************************  ELC50PD
 16636***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES                  ELC50PD
 16637***                                                               ELC50PD
 16638                                                                  ELC50PD
 16639     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16640         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *    ELC50PD
 16641             (1 + WS-TOL-AH-PREM-PCT)                             ELC50PD
 16642         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *    ELC50PD
 16643             (1 - WS-TOL-AH-PREM-PCT)                             ELC50PD
 16644     ELSE                                                         ELC50PD
 16645         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 16646         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16647                                                                  ELC50PD
 16648***                                                               ELC50PD
 16649***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES                   ELC50PD
 16650***                                                               ELC50PD
 16651                                                                  ELC50PD
 16652     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL                        ELC50PD
 16653         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.                      ELC50PD
 16654                                                                  ELC50PD
 16655     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL                         ELC50PD
 16656         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.                      ELC50PD
 16657                                                                  ELC50PD
 16658     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16659        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.       ELC50PD
 16660                                                                  ELC50PD
 16661     IF (PB-REISSUED-CERT)
 16662        OR (PB-POLICY-IS-DECLINED)
 16663        OR (PB-POLICY-IS-VOIDED)
 16664        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 16665        CONTINUE
 16666     ELSE
 16667        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 16668              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 16669                          or
 16670           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 16671              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 16672           IF WS-PREM-REJECT-SW = SPACE
 16673              MOVE ER-3052       TO WS-ERROR
 16674              PERFORM 9900-ERROR-FORMAT
 16675                                 THRU 9900-EXIT
 16676           ELSE
 16677              MOVE ER-3050       TO WS-ERROR
 16678              PERFORM 9900-ERROR-FORMAT
 16679                                 THRU 9900-EXIT
 16680           END-IF
 16681        END-IF
 16682     END-IF
 16683
 16684     if (pb-company-id = 'DCC')
 16685        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 16686        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 16687        and (pb-i-policy-is-monthly)
 16688        compute ws-tol-ah-high-prem-amt =
 16689           pb-i-tot-fees-calc + ws-tol-ah-prem
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 302
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16690        compute ws-tol-ah-low-prem-amt =
 16691           pb-i-tot-fees-calc - ws-tol-ah-prem
 16692        if ws-tol-ah-prem-pct > zeros
 16693           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 16694              (1 + ws-tol-ah-prem-pct)
 16695           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 16696              (1 - ws-tol-ah-prem-pct)
 16697        else
 16698           move +9999999.99      to ws-tol-ah-high-prem-pct
 16699           move +0               to ws-tol-ah-low-prem-pct
 16700        end-if
 16701        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 16702            or
 16703           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 16704                          or
 16705           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 16706           or
 16707           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 16708            move er-3049         to ws-error
 16709           perform 9900-error-format
 16710                                 thru 9900-exit
 16711
 16712        end-if
 16713     end-if
 16714
 16715     IF  WS-ERROR  =  ER-3050   OR   ER-3052                      ELC50PD
 16716         IF  PB-RECORD-BILL   =  'B' OR 'A'                       ELC50PD
 16717             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16718             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16719                                                                  ELC50PD
 16720     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16721        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16722           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16723              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16724                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16725                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16726                 NEXT SENTENCE                                    ELC50PD
 16727              ELSE                                                ELC50PD
 16728                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16729                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16730                                                                  ELC50PD
 16731     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR              ELC50PD
 16732        (WS-COMP-MAX-CAP EQUAL +0)                                ELC50PD
 16733           GO TO 3345-EDIT-CONTINUE.                              ELC50PD
 16734                                                                  ELC50PD
 16735     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)  ELC50PD
 16736        GREATER THAN WS-COMP-MAX-CAP                              ELC50PD
 16737           MOVE ER-2646          TO  WS-ERROR                     ELC50PD
 16738           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16739                                                                  ELC50PD
 16740 3345-EDIT-CONTINUE.                                              ELC50PD
 16741                                                                  ELC50PD
 16742*    IF PB-COMPANY-ID    EQUAL    'NCL'                           ELC50PD
 16743*       IF PB-ENTRY-BATCH   NUMERIC                               ELC50PD
 16744*          IF PB-ISSUE                                            ELC50PD
 16745*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO         ELC50PD
 16746*          ELSE                                                   ELC50PD
 16747*              IF PB-CANCELLATION                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 303
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16748*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.      ELC50PD
 16749                                                                  ELC50PD
 16750*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 16751*        IF  PB-I-MICROFILM-NO     NUMERIC    AND                 ELC50PD
 16752*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS                  ELC50PD
 16753*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO     ELC50PD
 16754*        ELSE                                                     ELC50PD
 16755*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 16756*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.         ELC50PD
 16757                                                                  ELC50PD
 16758     IF PB-I-POLICY-ACCEPTED                                      ELC50PD
 16759        IF PB-POLICY-IS-DECLINED  OR                              ELC50PD
 16760           PB-REISSUED-CERT  OR                                   ELC50PD
 16761           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16762           PB-POLICY-IS-VOIDED                                    ELC50PD
 16763            MOVE  ER-1891         TO  WS-ERROR                    ELC50PD
 16764            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16765        ELSE                                                      ELC50PD
 16766            MOVE SPACE            TO  PB-BATCH-ENTRY              ELC50PD
 16767            MOVE '2'              TO  PB-I-ENTRY-STATUS.          ELC50PD
 16768                                                                  ELC50PD
 16769     IF PB-I-POLICY-DECLINED                                      ELC50PD
 16770        IF PB-REISSUED-CERT  OR                                   ELC50PD
 16771           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16772           PB-POLICY-IS-VOIDED                                    ELC50PD
 16773            MOVE  ER-1906         TO  WS-ERROR                    ELC50PD
 16774            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16775        ELSE                                                      ELC50PD
 16776            MOVE  'D'             TO  PB-BATCH-ENTRY              ELC50PD
 16777                                      PB-I-ENTRY-STATUS.          ELC50PD
 16778                                                                  ELC50PD
 16779     IF PB-I-NEEDS-UNDERWRITING                                   ELC50PD
 16780        IF PB-POLICY-IS-DECLINED OR                               ELC50PD
 16781           PB-REISSUED-CERT  OR                                   ELC50PD
 16782           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16783           PB-POLICY-IS-VOIDED                                    ELC50PD
 16784            MOVE  ER-1907         TO  WS-ERROR                    ELC50PD
 16785            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16786        ELSE                                                      ELC50PD
 16787            MOVE 'U'              TO  PB-BATCH-ENTRY              ELC50PD
 16788                                      PB-I-ENTRY-STATUS.          ELC50PD
 16789                                                                  ELC50PD
 16790     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 16791        MOVE  ER-1901             TO  WS-ERROR                    ELC50PD
 16792        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16793
 16794     IF PB-COMPANY-ID = 'DCC'
 16795        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 16796        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 16797        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16798           AND (NOT WS-LF-CASH))
 16799                           OR
 16800           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16801           AND (NOT WS-AH-CASH)))
 16802                       AND
 16803           (PB-I-ENTRY-STATUS NOT = '5')
 16804           MOVE 'M'              TO PB-BATCH-ENTRY
 16805                                    PB-I-ENTRY-STATUS
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 304
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16806        END-IF
 16807     END-IF
 16808
 16809     IF  PB-COMPANY-ID NOT = 'NCL'                                ELC50PD
 16810         GO TO 3999-END-EDIT.                                     ELC50PD
 16811                                                                  ELC50PD
 16812     IF PB-REISSUED-CERT  OR                                      ELC50PD
 16813        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 16814        PB-POLICY-IS-VOIDED  OR                                   ELC50PD
 16815        PB-I-OB                                                   ELC50PD
 16816         GO TO 3999-END-EDIT.                                     ELC50PD
 16817                                                                  ELC50PD
 16818     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS                   ELC50PD
 16819         MOVE  ER-2644            TO  WS-ERROR                    ELC50PD
 16820         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 16821         GO TO 3999-END-EDIT.                                     ELC50PD
 16822                                                                  ELC50PD
 16823     MOVE 'N'                     TO  FORM-MASTER-SW.             ELC50PD
 16824     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.                   ELC50PD
 16825                                                                  ELC50PD
 16826     IF NOT FORM-MASTER-FOUND                                     ELC50PD
 16827         GO TO 3999-END-EDIT.                                     ELC50PD
 16828                                                                  ELC50PD
 16829     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW         ELC50PD
 16830                                      FORM-MASTER-AH-SW.          ELC50PD
 16831                                                                  ELC50PD
 16832     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES            ELC50PD
 16833         MOVE  +1                 TO SUB6                         ELC50PD
 16834         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.      ELC50PD
 16835                                                                  ELC50PD
 16836     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES               ELC50PD
 16837         MOVE  +1                 TO SUB6                         ELC50PD
 16838         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.      ELC50PD
 16839                                                                  ELC50PD
 16840     IF LF-FORM-MASTER-FOUND  OR                                  ELC50PD
 16841        AH-FORM-MASTER-FOUND                                      ELC50PD
 16842         GO TO 3360-CHECK-FORM-LIMITS                             ELC50PD
 16843     ELSE                                                         ELC50PD
 16844         GO TO 3999-END-EDIT.                                     ELC50PD
 16845                                                                  ELC50PD
 16846******************************************************************ELC50PD
 16847*                  3350-GET-ERFORM                               *ELC50PD
 16848*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *ELC50PD
 16849*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *ELC50PD
 16850******************************************************************ELC50PD
 16851                                                                  ELC50PD
 16852 3350-GET-ERFORM.                                                 ELC50PD
 16853                                                                  ELC50PD
 16854     IF  WK-FORM-ADDR      EQUAL    ZEROS                         ELC50PD
 16855         GO TO  3350-ERFORM-GETMAIN.                              ELC50PD
 16856                                                                  ELC50PD
 16857     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.             ELC50PD
 16858     SET ERFORM-FILE-ADDRESSED    TO  TRUE.                       ELC50PD
 16859     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 16860     MOVE 'Y'                     TO FORM-MASTER-SW.              ELC50PD
 16861                                                                  ELC50PD
 16862     IF PB-CANCELLATION                                           ELC50PD
 16863         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 305
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16864            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16865            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID               ELC50PD
 16866              GO TO 3350-EXIT                                     ELC50PD
 16867         ELSE                                                     ELC50PD
 16868             NEXT SENTENCE                                        ELC50PD
 16869     ELSE                                                         ELC50PD
 16870         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16871            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16872            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID               ELC50PD
 16873              GO TO 3350-EXIT.                                    ELC50PD
 16874                                                                  ELC50PD
 16875 3350-ERFORM-GETMAIN.                                             ELC50PD
 16876                                                                  ELC50PD
 16877     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.           ELC50PD
 16878     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.               ELC50PD
 16879                                                                  ELC50PD
 16880 3350-ERFORM-READ.                                                ELC50PD
 16881                                                                  ELC50PD
 16882     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.            ELC50PD
 16883     MOVE  PB-SV-STATE            TO  FORM-STATE.                 ELC50PD
 16884     IF PB-CANCELLATION                                           ELC50PD
 16885         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID            ELC50PD
 16886     ELSE                                                         ELC50PD
 16887         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.           ELC50PD
 16888     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.           ELC50PD
 16889                                                                  ELC50PD
 16890     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.             ELC50PD
 16891                                                                  ELC50PD
 16892     IF FORM-MASTER-FOUND                                         ELC50PD
 16893       IF PB-CANCELLATION                                         ELC50PD
 16894          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16895             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16896             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID              ELC50PD
 16897              GO  TO 3350-EXIT                                    ELC50PD
 16898          ELSE                                                    ELC50PD
 16899              NEXT SENTENCE                                       ELC50PD
 16900       ELSE                                                       ELC50PD
 16901          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16902             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16903             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID              ELC50PD
 16904              GO  TO 3350-EXIT.                                   ELC50PD
 16905                                                                  ELC50PD
 16906     MOVE  'N'                    TO  FORM-MASTER-SW.             ELC50PD
 16907     MOVE  ER-1895                TO  WS-ERROR.                   ELC50PD
 16908     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.                 ELC50PD
 16909                                                                  ELC50PD
 16910 3350-EXIT.                                                       ELC50PD
 16911      EXIT.                                                       ELC50PD
 16912                                                                  ELC50PD
 16913******************************************************************ELC50PD
 16914*                  3355-EDIT-FORM-LF-BENEFITS                    *ELC50PD
 16915*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *ELC50PD
 16916*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16917******************************************************************ELC50PD
 16918                                                                  ELC50PD
 16919 3355-EDIT-FORM-LF-BENEFITS.                                      ELC50PD
 16920                                                                  ELC50PD
 16921     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 306
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16922        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)                 ELC50PD
 16923         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW         ELC50PD
 16924         GO TO   3355-EXIT.                                       ELC50PD
 16925                                                                  ELC50PD
 16926     IF  SUB6    LESS THAN   +40                                  ELC50PD
 16927         ADD  +1      TO  SUB6                                    ELC50PD
 16928         GO TO  3355-EDIT-FORM-LF-BENEFITS.                       ELC50PD
 16929                                                                  ELC50PD
 16930     MOVE  ER-1896         TO  WS-ERROR.                          ELC50PD
 16931     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16932                                                                  ELC50PD
 16933 3355-EXIT.                                                       ELC50PD
 16934      EXIT.                                                       ELC50PD
 16935                                                                  ELC50PD
 16936******************************************************************ELC50PD
 16937*                  3356-EDIT-FORM-AH-BENEFITS                    *ELC50PD
 16938*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *ELC50PD
 16939*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16940******************************************************************ELC50PD
 16941                                                                  ELC50PD
 16942 3356-EDIT-FORM-AH-BENEFITS.                                      ELC50PD
 16943                                                                  ELC50PD
 16944     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND            ELC50PD
 16945        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)                   ELC50PD
 16946         MOVE  'Y'                TO  FORM-MASTER-AH-SW           ELC50PD
 16947         GO TO  3356-EXIT.                                        ELC50PD
 16948                                                                  ELC50PD
 16949      IF  SUB6    LESS THAN     +40                               ELC50PD
 16950          ADD  +1      TO  SUB6                                   ELC50PD
 16951          GO TO  3356-EDIT-FORM-AH-BENEFITS.                      ELC50PD
 16952                                                                  ELC50PD
 16953     MOVE  ER-1897         TO  WS-ERROR.                          ELC50PD
 16954     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16955                                                                  ELC50PD
 16956 3356-EXIT.                                                       ELC50PD
 16957      EXIT.                                                       ELC50PD
 16958                                                                  ELC50PD
 16959******************************************************************ELC50PD
 16960*                  3357-BENEFIT-SEARCH                           *ELC50PD
 16961*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *ELC50PD
 16962*   CANCELLATIONS ONLY.                                          *ELC50PD
 16963******************************************************************ELC50PD
 16964 3357-BENEFIT-SEARCH.                                             ELC50PD
 16965     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 16966         MOVE +1                          TO SUB6                 ELC50PD
 16967         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.         ELC50PD
 16968                                                                  ELC50PD
 16969     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 16970         MOVE +1                          TO SUB6                 ELC50PD
 16971         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.         ELC50PD
 16972                                                                  ELC50PD
 16973 3357-EXIT.                                                       ELC50PD
 16974     EXIT.                                                        ELC50PD
 16975                                                                  ELC50PD
 16976******************************************************************ELC50PD
 16977*                  3358-BENEFIT-LIFE-SEARCH                      *ELC50PD
 16978*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 16979*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 307
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16980*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 16981******************************************************************ELC50PD
 16982 3358-BENEFIT-LIFE-SEARCH.                                        ELC50PD
 16983     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)      ELC50PD
 16984       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)         ELC50PD
 16985         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 16986           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 16987              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 16988                     IS GREATER THAN SPACES                       ELC50PD
 16989                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 16990                                          WS-LF-REFUND-CALC       ELC50PD
 16991                 GO TO 3358-EXIT.                                 ELC50PD
 16992                                                                  ELC50PD
 16993     IF SUB6 LESS THAN +40                                        ELC50PD
 16994         ADD +1                 TO SUB6                           ELC50PD
 16995         GO TO 3358-BENEFIT-LIFE-SEARCH.                          ELC50PD
 16996                                                                  ELC50PD
 16997 3358-EXIT.                                                       ELC50PD
 16998     EXIT.                                                        ELC50PD
 16999******************************************************************ELC50PD
 17000*                  3359-BENEFIT-AH-SEARCH                        *ELC50PD
 17001*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 17002*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 17003*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 17004******************************************************************ELC50PD
 17005 3359-BENEFIT-AH-SEARCH.                                          ELC50PD
 17006     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)       ELC50PD
 17007       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)        ELC50PD
 17008         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 17009           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 17010              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 17011                      IS GREATER THAN SPACES                      ELC50PD
 17012                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 17013                                          WS-AH-REFUND-CALC       ELC50PD
 17014                 GO TO 3359-EXIT.                                 ELC50PD
 17015                                                                  ELC50PD
 17016     IF SUB6 LESS THAN +40                                        ELC50PD
 17017         ADD +1                 TO SUB6                           ELC50PD
 17018         GO TO 3359-BENEFIT-AH-SEARCH.                            ELC50PD
 17019                                                                  ELC50PD
 17020 3359-EXIT.                                                       ELC50PD
 17021     EXIT.                                                        ELC50PD
 17022                                                                  ELC50PD
 17023******************************************************************ELC50PD
 17024*                  3360-CHECK-FORM-LIMITS                        *ELC50PD
 17025*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17026*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17027******************************************************************ELC50PD
 17028                                                                  ELC50PD
 17029 3360-CHECK-FORM-LIMITS.                                          ELC50PD
 17030                                                                  ELC50PD
 17031     IF FO-IND-GRP-CD = 'I'  OR  'G'                              ELC50PD
 17032         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.             ELC50PD
 17033                                                                  ELC50PD
 17034     IF NOT LF-FORM-MASTER-FOUND                                  ELC50PD
 17035         GO TO 3360-CHECK-FORM-AH-LIMITS.                         ELC50PD
 17036                                                                  ELC50PD
 17037 3360-CHECK-FORM-LF-MIN-ISS-AGE.                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 308
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17038                                                                  ELC50PD
 17039     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR              ELC50PD
 17040       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND       ELC50PD
 17041        WS-LF-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17042        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17043         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17044            MOVE  ER-1911          TO  WS-ERROR                   ELC50PD
 17045            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17046         ELSE                                                     ELC50PD
 17047            MOVE  ER-1892          TO  WS-ERROR                   ELC50PD
 17048            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17049                                                                  ELC50PD
 17050 3360-CHECK-FORM-LF-ATT-AGE.                                      ELC50PD
 17051                                                                  ELC50PD
 17052     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 17053                                                                  ELC50PD
 17054     IF  FO-MAX-ATT-AGE     NUMERIC  AND                          ELC50PD
 17055         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17056         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE          ELC50PD
 17057            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17058                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17059                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17060            ELSE                                                  ELC50PD
 17061                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17062                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17063                                                                  ELC50PD
 17064 3360-CHECK-FORM-LF-MAX-ISS-AGE.                                  ELC50PD
 17065                                                                  ELC50PD
 17066     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND                      ELC50PD
 17067         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS               ELC50PD
 17068         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE       ELC50PD
 17069            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17070                MOVE  ER-1914      TO  WS-ERROR                   ELC50PD
 17071                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT      ELC50PD
 17072            ELSE                                                  ELC50PD
 17073                MOVE  ER-1899      TO  WS-ERROR                   ELC50PD
 17074                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.     ELC50PD
 17075                                                                  ELC50PD
 17076 3360-CHECK-FORM-LF-TERM-BAMT.                                    ELC50PD
 17077                                                                  ELC50PD
 17078     IF  FO-LF-MAX-TERM   NUMERIC   AND                           ELC50PD
 17079         FO-LF-MAX-TERM   GREATER THAN   ZEROS                    ELC50PD
 17080         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM          ELC50PD
 17081           IF  PB-COMPANY-ID = 'NCL'                              ELC50PD
 17082               MOVE  ER-1916       TO  WS-ERROR                   ELC50PD
 17083               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17084           ELSE                                                   ELC50PD
 17085               MOVE  ER-1902       TO  WS-ERROR                   ELC50PD
 17086               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17087                                                                  ELC50PD
 17088     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +        ELC50PD
 17089                                    PB-I-LF-ALT-BENEFIT-AMT.      ELC50PD
 17090                                                                  ELC50PD
 17091     IF  FO-MAX-LF-AMT   NUMERIC   AND                            ELC50PD
 17092         FO-MAX-LF-AMT   GREATER THAN   ZEROS                     ELC50PD
 17093         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT      ELC50PD
 17094             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17095                 MOVE  ER-1918     TO  WS-ERROR                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 309
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17096                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17097             ELSE                                                 ELC50PD
 17098                 MOVE  ER-1904     TO  WS-ERROR                   ELC50PD
 17099                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17100                                                                  ELC50PD
 17101******************************************************************ELC50PD
 17102*                  3360-CHECK-FORM-AH-LIMITS                     *ELC50PD
 17103*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17104*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17105******************************************************************ELC50PD
 17106                                                                  ELC50PD
 17107 3360-CHECK-FORM-AH-LIMITS.                                       ELC50PD
 17108                                                                  ELC50PD
 17109     IF NOT AH-FORM-MASTER-FOUND                                  ELC50PD
 17110         GO TO 3999-END-EDIT.                                     ELC50PD
 17111                                                                  ELC50PD
 17112 3360-CHECK-FORM-AH-MIN-ISS-AGE.                                  ELC50PD
 17113                                                                  ELC50PD
 17114     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR              ELC50PD
 17115       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND       ELC50PD
 17116        WS-AH-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17117        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17118         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17119            MOVE  ER-1912          TO  WS-ERROR                   ELC50PD
 17120            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17121         ELSE                                                     ELC50PD
 17122            MOVE  ER-1893          TO  WS-ERROR                   ELC50PD
 17123            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17124                                                                  ELC50PD
 17125 3360-CHECK-FORM-AH-ATT-AGE.                                      ELC50PD
 17126                                                                  ELC50PD
 17127     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 17128                                                                  ELC50PD
 17129     IF  FO-MAX-ATT-AGE     NUMERIC     AND                       ELC50PD
 17130         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17131         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE            ELC50PD
 17132            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17133                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17134                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 17135            ELSE                                                  ELC50PD
 17136                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17137                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 17138                                                                  ELC50PD
 17139 3360-CHECK-FORM-AH-MAX-ISS-AGE.                                  ELC50PD
 17140                                                                  ELC50PD
 17141     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND                     ELC50PD
 17142         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0                  ELC50PD
 17143         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE    ELC50PD
 17144            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17145                MOVE  ER-1915      TO  WS-ERROR                   ELC50PD
 17146                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17147            ELSE                                                  ELC50PD
 17148                MOVE  ER-1900      TO  WS-ERROR                   ELC50PD
 17149                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17150                                                                  ELC50PD
 17151 3360-CHECK-FORM-AH-TERM-BAMT.                                    ELC50PD
 17152                                                                  ELC50PD
 17153     IF  FO-AH-MAX-TERM    NUMERIC   AND                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 310
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17154         FO-AH-MAX-TERM    GREATER THAN  +0                       ELC50PD
 17155         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM      ELC50PD
 17156             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17157                 MOVE  ER-1917     TO  WS-ERROR                   ELC50PD
 17158                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT     ELC50PD
 17159             ELSE                                                 ELC50PD
 17160                  MOVE  ER-1903    TO  WS-ERROR                   ELC50PD
 17161                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.   ELC50PD
 17162                                                                  ELC50PD
 17163     IF  FO-MAX-AH-AMT    NUMERIC   AND                           ELC50PD
 17164         FO-MAX-AH-AMT    GREATER THAN  +0                        ELC50PD
 17165         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT   ELC50PD
 17166             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17167                 MOVE  ER-1919     TO  WS-ERROR                   ELC50PD
 17168                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17169             ELSE                                                 ELC50PD
 17170                 MOVE  ER-1905     TO  WS-ERROR                   ELC50PD
 17171                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17172                                                                  ELC50PD
 17173     GO TO 3999-END-EDIT.                                         ELC50PD
 17174                                                                  ELC50PD
 17175******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 311
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17177******************************************************************ELC50PD
 17178*                  E D I T   C A N C E L                         *ELC50PD
 17179******************************************************************ELC50PD
 17180                                                                  ELC50PD
 17181 3700-EDIT-CANCEL.                                                ELC50PD
 17182     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 17183         MOVE ZEROS                   TO WS-RES-STATE-TAX         ELC50PD
 17184                                         WS-RES-MUNI-TAX          ELC50PD
 17185                                         PB-CI-STATE-TAX          ELC50PD
 17186                                         PB-CI-MUNI-TAX           ELC50PD
 17187         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.     ELC50PD
 17188                                                                  ELC50PD
 17189*    IF PB-COMPANY-ID  EQUAL  'NCL'                               ELC50PD
 17190*       IF PB-ENTRY-BATCH  NUMERIC                                ELC50PD
 17191*          IF PB-CANCELLATION                                     ELC50PD
 17192*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO      ELC50PD
 17193*          ELSE                                                   ELC50PD
 17194*             IF PB-ISSUE                                         ELC50PD
 17195*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.     ELC50PD
 17196                                                                  ELC50PD
 17197     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 17198        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 17199     END-IF
 17200
 17201*    IF PB-C-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 17202*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.           ELC50PD
 17203                                                                  ELC50PD
 17204     IF CM-ENTRY-STATUS = 'V'                                     ELC50PD
 17205        MOVE ER-2780             TO WS-ERROR                      ELC50PD
 17206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17207        GO TO 3999-END-EDIT.                                      ELC50PD
 17208                                                                  ELC50PD
 17209     IF CM-ENTRY-STATUS = 'D'                                     ELC50PD
 17210        MOVE ER-2781             TO WS-ERROR                      ELC50PD
 17211        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17212        GO TO 3999-END-EDIT.                                      ELC50PD
 17213                                                                  ELC50PD
 17214     IF CM-ENTRY-STATUS = 'U'                                     ELC50PD
 17215        MOVE ER-2782             TO WS-ERROR                      ELC50PD
 17216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17217                                                                  ELC50PD
 17218***************************************************************   ELC50PD
 17219*                                                             *   ELC50PD
 17220*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *   ELC50PD
 17221*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *   ELC50PD
 17222*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *   ELC50PD
 17223*   OF ANOTHER COVERAGE.                                      *   ELC50PD
 17224*                                                             *   ELC50PD
 17225***************************************************************   ELC50PD
 17226                                                                  ELC50PD
 17227     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17228                                    PB-C-AH-CANCEL-VOID-SW.       ELC50PD
 17229                                                                  ELC50PD
 17230     IF PB-C-LF-CANCEL-AMT = ZERO                                 ELC50PD
 17231        NEXT SENTENCE                                             ELC50PD
 17232     ELSE                                                         ELC50PD
 17233        IF (PB-C-LF-CANCEL-AMT NEGATIVE)                          ELC50PD
 17234           AND                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 312
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17235           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)    ELC50PD
 17236               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17237               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17238               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17239                                                                  ELC50PD
 17240     IF PB-C-AH-CANCEL-AMT = ZERO                                 ELC50PD
 17241        NEXT SENTENCE                                             ELC50PD
 17242     ELSE                                                         ELC50PD
 17243        IF (PB-C-AH-CANCEL-AMT NEGATIVE)                          ELC50PD
 17244           AND                                                    ELC50PD
 17245           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)      ELC50PD
 17246               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW        ELC50PD
 17247               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17248               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17249                                                                  ELC50PD
 17250     IF WS-LF-EARNINGS-CALC = '4'                                 ELC50PD
 17251        MOVE '4'                   TO WS-LF-REFUND-CALC.          ELC50PD
 17252                                                                  ELC50PD
 17253     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.          ELC50PD
 17254     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.     ELC50PD
 17255     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.     ELC50PD
 17256     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.     ELC50PD
 17257     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.          ELC50PD
 17258     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.          ELC50PD
 17259                                                                  ELC50PD
 17260     MOVE ZERO                     TO PB-C-LF-REF-CALC            ELC50PD
 17261                                      PB-C-AH-REF-CALC.           ELC50PD
 17262     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.                 ELC50PD
 17263                                                                  ELC50PD
 17264******************************************************************ELC50PD
 17265*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *ELC50PD
 17266*             TO VALIDATE COVERAGE.                              *ELC50PD
 17267******************************************************************ELC50PD
 17268                                                                  ELC50PD
 17269     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND                        ELC50PD
 17270        PB-C-LF-CANCEL-AMT = ZEROS                                ELC50PD
 17271          MOVE 'N'                 TO WS-LF-CANCEL-SW             ELC50PD
 17272      ELSE                                                        ELC50PD
 17273          MOVE 'Y'                 TO WS-LF-CANCEL-SW.            ELC50PD
 17274                                                                  ELC50PD
 17275     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND                        ELC50PD
 17276        PB-C-AH-CANCEL-AMT = ZEROS                                ELC50PD
 17277          MOVE 'N'                 TO WS-AH-CANCEL-SW             ELC50PD
 17278      ELSE                                                        ELC50PD
 17279          MOVE 'Y'                 TO WS-AH-CANCEL-SW.            ELC50PD
 17280                                                                  ELC50PD
 17281     EVALUATE TRUE                                                ELC50PD
 17282         WHEN PB-CANCEL-FORCE             OR                      ELC50PD
 17283              PB-CANCEL-DATE-FORCED       OR                      ELC50PD
 17284              PB-FORCE-OFF                                        ELC50PD
 17285                  IF PB-COMPANY-ID = 'ACE'                        ELC50PD
 17286                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE     ELC50PD
 17287                  END-IF                                          ELC50PD
 17288         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR                   ELC50PD
 17289               PB-ALL-CANCEL-FORCED-NO-FEE)  AND                  ELC50PD
 17290              (PB-COMPANY-ID = 'ACE' )                            ELC50PD
 17291                  MOVE ZEROES TO PB-CI-CANCEL-FEE                 ELC50PD
 17292         WHEN OTHER                                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 313
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17293              IF PB-COMPANY-ID = 'ACE'                            ELC50PD
 17294                 MOVE ER-2794              TO WS-ERROR            ELC50PD
 17295              ELSE                                                ELC50PD
 17296                 MOVE ER-2749              TO WS-ERROR            ELC50PD
 17297              END-IF                                              ELC50PD
 17298              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 17299     END-EVALUATE.                                                ELC50PD
 17300                                                                  ELC50PD
 17301                                                                  ELC50PD
 17302*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 17303*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS              ELC50PD
 17304*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 17305*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT          ELC50PD
 17306*        ELSE                                                     ELC50PD
 17307*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.    ELC50PD
 17308                                                                  ELC50PD
 17309     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 17310     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 17311        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 17312     ELSE
 17313        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 17314     END-IF
 17315     .
 17316 3705-EDIT-CANCEL-DT.                                             ELC50PD
 17317                                                                  ELC50PD
 17318     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17319        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17320         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17321         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17322                                 TO DC-BIN-DATE-2                 ELC50PD
 17323         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17324*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17325         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17326         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17327            NEXT SENTENCE                                         ELC50PD
 17328          ELSE                                                    ELC50PD
 17329             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17330                IF PB-CANCEL-DATE-FORCED  OR                      ELC50PD
 17331                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17332                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17333                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17334                 ELSE                                             ELC50PD
 17335                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17336                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17337                                                                  ELC50PD
 17338     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17339        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17340         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17341         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17342                                 TO DC-BIN-DATE-2                 ELC50PD
 17343         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17344*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17345         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17346         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17347            NEXT SENTENCE                                         ELC50PD
 17348          ELSE                                                    ELC50PD
 17349             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17350                IF PB-CANCEL-DATE-FORCED OR                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 314
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17351                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17352                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17353                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17354                 ELSE                                             ELC50PD
 17355                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17356                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17357                                                                  ELC50PD
 17358     IF WS-ERROR = ER-2752                                        ELC50PD
 17359        AND (PB-COMPANY-ID = 'ABL'                                ELC50PD
 17360         OR  PB-COMPANY-ID = 'FGL'                                ELC50PD
 17361         OR  PB-COMPANY-ID = 'IST'                                ELC50PD
 17362         OR  PB-COMPANY-ID = 'JHL'                                ELC50PD
 17363         OR  PB-COMPANY-ID = 'LAP'                                ELC50PD
 17364         OR  PB-COMPANY-ID = 'LBL'                                ELC50PD
 17365         OR  PB-COMPANY-ID = 'NCB'                                ELC50PD
 17366         OR  PB-COMPANY-ID = 'NLI'                                ELC50PD
 17367         OR  PB-COMPANY-ID = 'OFI'                                ELC50PD
 17368         OR  PB-COMPANY-ID = 'PLI'                                ELC50PD
 17369         OR  PB-COMPANY-ID = 'TAO'                                ELC50PD
 17370         OR  PB-COMPANY-ID = 'TIC'                                ELC50PD
 17371         OR  PB-COMPANY-ID = 'HER'                                ELC50PD
 17372         OR  WS-LF-SPECIAL-CALC-CD = 'Z'                          ELC50PD
 17373         OR  WS-AH-SPECIAL-CALC-CD = 'Z')                         ELC50PD
 17374            SUBTRACT +1          FROM PB-NO-OF-ERRORS             ELC50PD
 17375            MOVE ER-2762     TO WS-ERROR                          ELC50PD
 17376            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17377                                                                  ELC50PD
 17378     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17379        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17380        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17381             MOVE ER-2733         TO WS-ERROR                     ELC50PD
 17382             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17383                                                                  ELC50PD
 17384     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17385        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17386        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17387              MOVE ER-2733        TO WS-ERROR                     ELC50PD
 17388              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17389                                                                  ELC50PD
 17390     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND                ELC50PD
 17391        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)                     ELC50PD
 17392        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND            ELC50PD
 17393           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)                 ELC50PD
 17394            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT         ELC50PD
 17395              IF PB-COMPANY-ID NOT = 'LAP'                        ELC50PD
 17396               MOVE ER-2704            TO WS-ERROR                ELC50PD
 17397               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.        ELC50PD
 17398                                                                  ELC50PD
 17399     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 17400         GO TO 3999-END-EDIT.                                     ELC50PD
 17401                                                                  ELC50PD
 17402     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17403        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 17404           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17405            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17406            MOVE PB-C-LF-CANCEL-DT                                ELC50PD
 17407                                 TO DC-BIN-DATE-2                 ELC50PD
 17408            SET ELAPSED-BETWEEN-BIN TO TRUE                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 315
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17409*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17410            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17411            IF DATE-CONVERSION-ERROR                              ELC50PD
 17412               NEXT SENTENCE                                      ELC50PD
 17413             ELSE                                                 ELC50PD
 17414                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17415                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.      ELC50PD
 17416                                                                  ELC50PD
 17417     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17418        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 17419           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17420            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17421            MOVE PB-C-AH-CANCEL-DT                                ELC50PD
 17422                                 TO DC-BIN-DATE-2                 ELC50PD
 17423            MOVE +0              TO DC-ELAPSED-DAYS               ELC50PD
 17424                                    DC-ELAPSED-MONTHS             ELC50PD
 17425            SET ELAPSED-BETWEEN-BIN  TO TRUE                      ELC50PD
 17426*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17427            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17428            IF DATE-CONVERSION-ERROR                              ELC50PD
 17429               NEXT SENTENCE                                      ELC50PD
 17430             ELSE                                                 ELC50PD
 17431                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17432                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.      ELC50PD
 17433                                                                  ELC50PD
 17434     MOVE +0                     TO DC-ELAPSED-DAYS               ELC50PD
 17435                                    DC-ELAPSED-MONTHS.            ELC50PD
 17436                                                                  ELC50PD
 17437     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR                         ELC50PD
 17438        (WS-AH-SPECIAL-CALC-CD = 'Z')                             ELC50PD
 17439          MOVE 'Z'                TO PB-CI-OB-FLAG                ELC50PD
 17440          MOVE ER-2767            TO WS-ERROR                     ELC50PD
 17441          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 17442          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC             ELC50PD
 17443          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC             ELC50PD
 17444          GO TO 3775-OVER-REF-CHK                                 ELC50PD
 17445        ELSE                                                      ELC50PD
 17446          MOVE ZEROS              TO PB-CI-LIVES                  ELC50PD
 17447                                     PB-C-LIVES                   ELC50PD
 17448          IF PB-CI-OB-FLAG NOT = 'B'                              ELC50PD
 17449             MOVE SPACE           TO PB-CI-OB-FLAG.               ELC50PD
 17450                                                                  ELC50PD
 17451     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 17452         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS          ELC50PD
 17453     ELSE                                                         ELC50PD
 17454         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.           ELC50PD
 17455                                                                  ELC50PD
 17456     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)         ELC50PD
 17457        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')     ELC50PD
 17458            MOVE ER-2760         TO WS-ERROR                      ELC50PD
 17459            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17460                                                                  ELC50PD
 17461     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17462        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17463         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17464            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17465               MOVE ER-2774       TO WS-ERROR                     ELC50PD
 17466               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 316
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17467                                                                  ELC50PD
 17468     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17469        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17470         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17471            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17472               MOVE ER-2775       TO WS-ERROR                     ELC50PD
 17473               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17474                                                                  ELC50PD
 17475     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17476        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17477         IF PB-C-LF-CANCEL-DT = LOW-VALUES                        ELC50PD
 17478            MOVE ER-2776         TO WS-ERROR                      ELC50PD
 17479            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17480                                                                  ELC50PD
 17481     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17482        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17483         IF PB-C-AH-CANCEL-DT = LOW-VALUES                        ELC50PD
 17484            MOVE ER-2777         TO WS-ERROR                      ELC50PD
 17485            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17486
 17487     IF LF-COVERAGE-CANCELLED
 17488        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 17489        if pb-ci-lf-expire-dt = low-values or spaces
 17490           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 17491           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 17492           MOVE PB-CI-EXTENTION-DAYS
 17493                                 TO DC-ELAPSED-DAYS
 17494           SET BIN-PLUS-ELAPSED  TO TRUE
 17495           PERFORM 8500-DATE-CONVERT
 17496                                 THRU 8500-EXIT
 17497           IF DATE-CONVERSION-ERROR
 17498              move low-values    to dc-bin-date-2
 17499           end-if
 17500        else
 17501           move pb-ci-lf-expire-dt
 17502                                 to dc-bin-date-2
 17503        end-if
 17504        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 17505           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 17506                             OR  'FIA'
 17507              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 17508           ELSE
 17509              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 17510              MOVE ER-2731       TO WS-ERROR
 17511              PERFORM 9900-ERROR-FORMAT
 17512                                 THRU 9900-EXIT
 17513           end-if
 17514        end-if
 17515     end-if
 17516
 17517*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17518*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17519*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17520*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17521*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17522*        SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17523*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17524*        IF DATE-CONVERSION-ERROR                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 317
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17525*           NEXT SENTENCE                                         ELC50PD
 17526*         ELSE                                                    ELC50PD
 17527*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17528*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17529*                            OR  'FIA'                            ELC50PD
 17530*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT       ELC50PD
 17531*              ELSE                                               ELC50PD
 17532*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW      ELC50PD
 17533*               MOVE ER-2731       TO WS-ERROR                    ELC50PD
 17534*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17535     .
 17536 3705-EDIT-AH-CANCEL-DT.                                          ELC50PD
 17537
 17538     IF AH-COVERAGE-CANCELLED
 17539        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 17540        if pb-ci-AH-expire-dt = low-values or spaces
 17541           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 17542           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 17543           MOVE PB-CI-EXTENTION-DAYS
 17544                                 TO DC-ELAPSED-DAYS
 17545           SET BIN-PLUS-ELAPSED  TO TRUE
 17546           PERFORM 8500-DATE-CONVERT
 17547                                 THRU 8500-EXIT
 17548           IF DATE-CONVERSION-ERROR
 17549              move low-values    to dc-bin-date-2
 17550           end-if
 17551        else
 17552           move pb-ci-ah-expire-dt
 17553                                 to dc-bin-date-2
 17554        end-if
 17555        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 17556           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 17557                             OR  'FIA'
 17558              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 17559           ELSE
 17560              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 17561              MOVE ER-2771       TO WS-ERROR
 17562              PERFORM 9900-ERROR-FORMAT
 17563                                 THRU 9900-EXIT
 17564           end-if
 17565        end-if
 17566     end-if
 17567
 17568*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17569*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17570*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17571*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17572*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17573**       MOVE 6                    TO DC-OPTION-CODE              ELC50PD
 17574*        SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17575*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17576*        IF DATE-CONVERSION-ERROR                                 ELC50PD
 17577*           NEXT SENTENCE                                         ELC50PD
 17578*         ELSE                                                    ELC50PD
 17579*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17580*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17581*                             OR 'FIA'                            ELC50PD
 17582*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 318
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17583*             ELSE                                                ELC50PD
 17584*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW       ELC50PD
 17585*              MOVE ER-2771       TO WS-ERROR                     ELC50PD
 17586*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17587     .
 17588 3705-EDIT-CONTINUED.                                             ELC50PD
 17589                                                                  ELC50PD
 17590*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17591*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17592*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT  ELC50PD
 17593*            MOVE ER-2727         TO WS-ERROR                     ELC50PD
 17594*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17595*                                                                 ELC50PD
 17596*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17597*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17598*        IF PB-COMPANY-ID = 'ACE'                                 ELC50PD
 17599*           MOVE ER-2727        TO WS-ERROR                       ELC50PD
 17600*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 17601*        ELSE                                                     ELC50PD
 17602*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DTELC50PD
 17603*              MOVE ER-2727     TO WS-ERROR                       ELC50PD
 17604*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17605                                                                  ELC50PD
 17606     IF PB-COMPANY-ID = 'ACE'                                     ELC50PD
 17607       IF AH-COVERAGE-CANCELLED                                   ELC50PD
 17608         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                 ELC50PD
 17609           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT   ELC50PD
 17610              MOVE ER-2732      TO WS-ERROR                       ELC50PD
 17611              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17612                                                                  ELC50PD
 17613     IF PB-COMPANY-ID      EQUAL   'HER'                          ELC50PD
 17614        IF WS-ERROR        EQUAL   ER-2727                        ELC50PD
 17615            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS          ELC50PD
 17616            MOVE  ER-2725          TO  WS-ERROR                   ELC50PD
 17617            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17618                                                                  ELC50PD
 17619     IF PB-C-CLAIM-CREATED-CANCEL                                 ELC50PD
 17620            MOVE ER-2748         TO WS-ERROR                      ELC50PD
 17621            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17622                                                                  ELC50PD
 17623     IF PB-C-LAST-NAME NOT = SPACES                               ELC50PD
 17624         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME                  ELC50PD
 17625            MOVE ER-2747         TO WS-ERROR                      ELC50PD
 17626            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17627                                                                  ELC50PD
 17628 3710-EDIT-LUMP-SUM-PRIOR.                                        ELC50PD
 17629                                                                  ELC50PD
 17630     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17631         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17632             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT    ELC50PD
 17633                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17634                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17635                                                                  ELC50PD
 17636     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17637         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17638             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT    ELC50PD
 17639                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17640                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 319
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17641                                                                  ELC50PD
 17642 3710-EDIT-PRIOR-DEATH.                                           ELC50PD
 17643                                                                  ELC50PD
 17644*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17645*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17646*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17647*           (NOT PB-CI-OB)                                        ELC50PD
 17648*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT           ELC50PD
 17649*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT    ELC50PD
 17650*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17651*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17652*                                                                 ELC50PD
 17653*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17654*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17655*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17656*           (NOT PB-CI-OB)                                        ELC50PD
 17657*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT           ELC50PD
 17658*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT    ELC50PD
 17659*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17660*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17661                                                                  ELC50PD
 17662     IF PB-CI-DEATH-DT NOT = LOW-VALUES                           ELC50PD
 17663         IF (PB-C-LF-CANCEL-AMT = ZERO) AND                       ELC50PD
 17664            (NOT PB-COMP-LF-CANCEL)                               ELC50PD
 17665             NEXT SENTENCE                                        ELC50PD
 17666         ELSE                                                     ELC50PD
 17667           IF PB-C-LF-CANCEL-VOIDED                               ELC50PD
 17668              NEXT SENTENCE                                       ELC50PD
 17669           ELSE                                                   ELC50PD
 17670              MOVE ER-2753      TO WS-ERROR                       ELC50PD
 17671              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17672                                                                  ELC50PD
 17673     IF CANCEL-FUTURE-DT                                          ELC50PD
 17674         GO TO 3999-END-EDIT.                                     ELC50PD
 17675                                                                  ELC50PD
 17676 3715-GET-REMAIN-TERM-LF.                                         ELC50PD
 17677                                                                  ELC50PD
 17678     IF NO-LF-BENEFIT-MATCH  OR                                   ELC50PD
 17679        WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 17680        GO TO 3730-GET-AH-REMAIN-TERM.                            ELC50PD
 17681                                                                  ELC50PD
 17682     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 17683     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17684     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17685     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17686     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17687     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17688     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 17689     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17690     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17691     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17692     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17693     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 17694
 17695     IF (PB-COMPANY-ID = 'CID')
 17696        AND (CP-STATE-STD-ABBRV = 'WI')
 17697        MOVE '7'                 TO CP-REM-TERM-METHOD
 17698        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 320
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17699     ELSE
 17700        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 17701        MOVE WS-REM-TRM-CALC-OPTION
 17702                                 TO CP-REM-TRM-CALC-OPTION
 17703     END-IF
 17704
 17705**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 17706     IF (PB-COMPANY-ID = 'CID')
 17707        AND (CP-STATE-STD-ABBRV = 'MO')
 17708        AND (PB-CERT-EFF-DT >= X'9B41')
 17709        AND (PB-CERT-EFF-DT <= X'A2FB')
 17710        MOVE '7'                 TO CP-REM-TERM-METHOD
 17711        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17712     END-IF
 17713
 17714     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 17715                                    CP-LOAN-TERM.                 ELC50PD
 17716     IF CP-TRUNCATED-LIFE                                         ELC50PD
 17717        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.                 ELC50PD
 17718                                                                  ELC50PD
 17719     IF CP-TERM-IS-DAYS                                           ELC50PD
 17720         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS        ELC50PD
 17721     ELSE                                                         ELC50PD
 17722         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 17723                                                                  ELC50PD
 17724     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.                ELC50PD
 17725                                                                  ELC50PD
 17726     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 17727                                                                  ELC50PD
 17728     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17729        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 17730        NEXT SENTENCE                                             ELC50PD
 17731      ELSE                                                        ELC50PD
 17732          GO TO 3730-GET-AH-REMAIN-TERM.                          ELC50PD
 17733                                                                  ELC50PD
 17734 3720-GET-LF-REFUND.                                              ELC50PD
 17735                                                                  ELC50PD
 17736     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 17737        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 17738        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 17739                                                                  ELC50PD
 17740     IF PB-COMPANY-ID EQUAL 'BOA'                                 ELC50PD
 17741         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17742         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17743         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17744                                                                  ELC50PD
 17745     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR                          ELC50PD
 17746        (WS-AH-SPECIAL-CALC-CD = 'M')                             ELC50PD
 17747         MOVE ER-2767            TO WS-ERROR                      ELC50PD
 17748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 17749         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17750         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17751         GO TO 3780-UPDATE-CANCEL-CERT.                           ELC50PD
 17752                                                                  ELC50PD
 17753     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 17754                                                                     CL**2
 17755     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 17756     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 321
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17757     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17758     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 17759     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 17760     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 17761
 17762     IF (PB-COMPANY-ID = 'DCC')
 17763        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17764
 17765        IF PDEF-MASTER-FOUND
 17766           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17767              (V1 > +8)
 17768              OR (PD-PROD-CODE (V1) = 'L')
 17769           END-PERFORM
 17770           IF V1 < +9
 17771              MOVE PD-MAX-AMT (V1)
 17772                           TO CP-R-MAX-TOT-BEN
 17773                              EC-AM-LF-MAX-TOT-BEN
 17774           END-IF
 17775        ELSE
 17776
 17777        MOVE ' '                 TO PDEF-MASTER-SW
 17778        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17779        MOVE PB-STATE            TO ERPDEF-STATE
 17780        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17781        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17782        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17783        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17784        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17785        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17786        IF PDEF-MASTER-FOUND
 17787           MOVE 'N'              TO PDEF-MASTER-SW
 17788           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17789           IF PDEF-MASTER-FOUND
 17790              IF (ERPDEF-KEY-SAVE (1:16) =
 17791                           PD-CONTROL-PRIMARY (1:16))
 17792                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17793                 CONTINUE
 17794              ELSE
 17795                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17796                 IF (ERPDEF-KEY-SAVE (1:16) =
 17797                           PD-CONTROL-PRIMARY (1:16))
 17798                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17799                    CONTINUE
 17800                 ELSE
 17801                    MOVE 'N'     TO PDEF-MASTER-SW
 17802                 END-IF
 17803              END-IF
 17804              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 17805
 17806              IF PDEF-MASTER-FOUND
 17807                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17808                    (V1 > +8)
 17809                    OR (PD-PROD-CODE (V1) = 'L')
 17810                 END-PERFORM
 17811                 IF V1 < +9
 17812                    MOVE PD-MAX-AMT (V1)
 17813                                 TO CP-R-MAX-TOT-BEN
 17814                                    EC-AM-LF-MAX-TOT-BEN
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 322
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17815                 END-IF
 17816              END-IF
 17817           END-IF
 17818           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17819        END-IF
 17820        END-IF
 17821     END-IF
 17822
 17823     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.               ELC50PD
 17824                                                                  ELC50PD
 17825     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.         ELC50PD
 17826                                                                  ELC50PD
 17827     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM                CL**2
 17828                                    PB-C-LF-REM-TERM.                CL**2
 17829                                                                     CL**2
 17830     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 17831     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 17832                                                                  ELC50PD
 17833     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 17834        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 17835           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK       ELC50PD
 17836           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT   ELC50PD
 17837                    + PB-CI-LF-ALT-PREMIUM-AMT)                   ELC50PD
 17838                    - CM-LF-ITD-DEATH-AMT                         ELC50PD
 17839           IF PB-C-LF-REF-CALC LESS THAN +0                       ELC50PD
 17840              MOVE +0            TO PB-C-LF-REF-CALC              ELC50PD
 17841              GO TO 3730-GET-AH-REMAIN-TERM                       ELC50PD
 17842           ELSE                                                   ELC50PD
 17843              GO TO 3730-GET-AH-REMAIN-TERM.                      ELC50PD
 17844                                                                  ELC50PD
 17845     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 17846                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 17847                            OR '9' OR 'G'
 17848        MOVE PB-C-LF-REFUND-OVERRIDE                              ELC50PD
 17849                                 TO CP-EARNING-METHOD.            ELC50PD
 17850                                                                  ELC50PD
 17851     if pb-company-id = 'AHL'
 17852        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 17853        if cp-class-code = spaces
 17854           move zeros            to cp-class-code
 17855        end-if
 17856     ELSE
 17857        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 17858     END-IF
 17859
 17860*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 17861     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 17862     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 17863                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 17864     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17865         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17866                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17867     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 17868     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
 17869     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 17870     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.            ELC50PD
 17871     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.              ELC50PD
 17872     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 323
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17873     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17874     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 17875         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 17876                                                                  ELC50PD
 17877****   N O T E   ****
 17878*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 17879*      THE OH HARD CODING IN ELCRFNDP
 17880
 17881     IF PB-COMPANY-ID = 'CID'
 17882        IF CP-STATE-STD-ABBRV = 'OH'
 17883           MOVE WS-LF-EARNINGS-CALC
 17884                                 TO CP-EARNING-METHOD
 17885        END-IF
 17886     END-IF
 17887
 17888****   N O T E   ****
 17889
 17890     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 17891         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 17892            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 17893                MOVE WS-DEFAULT-APR                               ELC50PD
 17894                                 TO  CP-LOAN-APR                  ELC50PD
 17895                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 17896                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17897            ELSE                                                  ELC50PD
 17898                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 17899                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17900
 17901     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 17902
 17903     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17904                                                                  ELC50PD
 17905     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 17906         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.           ELC50PD
 17907                                                                  ELC50PD
 17908     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17909        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17910        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17911        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17912                                                                  ELC50PD
 17913     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17914        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17915        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17916                                                                  ELC50PD
 17917     IF PB-COMPANY-ID = 'DCC'
 17918        AND PB-CI-ENTRY-STATUS = 'M'
 17919        MOVE +0                  TO PB-C-LF-REF-CALC
 17920     ELSE
 17921        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 17922     END-IF
 17923                                                                  ELC50PD
 17924     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 17925         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17926                                                                  ELC50PD
 17927*    IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 17928*       ADD +1                   TO PB-C-LF-REM-TERM              ELC50PD
 17929*                                   CP-REMAINING-TERM             ELC50PD
 17930*                                   CP-ORIGINAL-TERM.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 324
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17931                                                                  ELC50PD
 17932     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 17933     MOVE '2'                    TO CP-EARNING-METHOD             ELC50PD
 17934                                    CP-RATING-METHOD.             ELC50PD
 17935
 17936     IF PB-COMPANY-ID = 'CID'
 17937        IF (CP-STATE-STD-ABBRV = 'MN')
 17938           AND (PB-CERT-EFF-DT > X'A4FF')
 17939           AND (WS-LF-EARNINGS-CALC = 'B')
 17940           MOVE '5'              TO CP-EARNING-METHOD
 17941           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 17942        END-IF
 17943     END-IF
 17944
 17945     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT       ELC50PD
 17946                                        CP-REMAINING-BENEFIT      ELC50PD
 17947                                        CP-RATING-BENEFIT-AMT.    ELC50PD
 17948     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17949         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17950                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17951     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.      ELC50PD
 17952     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 17953                                                                  ELC50PD
 17954     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17955                                                                  ELC50PD
 17956     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17957        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17958        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17959        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17960                                                                  ELC50PD
 17961     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17962        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17963        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17964                                                                  ELC50PD
 17965     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.             ELC50PD
 17966                                                                  ELC50PD
 17967******************************************************************ELC50PD
 17968                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 325
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17970 3730-GET-AH-REMAIN-TERM.                                         ELC50PD
 17971     IF NO-AH-BENEFIT-MATCH  OR                                   ELC50PD
 17972        WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 17973         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 17974                                                                  ELC50PD
 17975     IF PB-CI-AH-LUMP-SUM-DISAB                                   ELC50PD
 17976         IF  PB-C-AH-CANCEL-AMT = ZERO                            ELC50PD
 17977            IF NOT PB-COMP-AH-CANCEL                              ELC50PD
 17978             GO TO 3770-CHECK-REFUNDS.                            ELC50PD
 17979                                                                  ELC50PD
 17980     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 17981     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17982     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17983     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17984     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17985     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17986     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 17987     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17988     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17989     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17990     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17991     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 17992
 17993     IF (PB-COMPANY-ID = 'CID')
 17994        AND (CP-STATE-STD-ABBRV = 'WI')
 17995        MOVE '7'                 TO CP-REM-TERM-METHOD
 17996        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17997     ELSE
 17998        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 17999        MOVE WS-REM-TRM-CALC-OPTION
 18000                                 TO CP-REM-TRM-CALC-OPTION
 18001     END-IF
 18002
 18003     IF (PB-COMPANY-ID = 'CID')
 18004        AND (CP-STATE-STD-ABBRV = 'MO')
 18005        AND (PB-CERT-EFF-DT >= X'9B41')
 18006        AND (PB-CERT-EFF-DT <= X'A2FB')
 18007        MOVE '7'                 TO CP-REM-TERM-METHOD
 18008        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 18009     END-IF
 18010
 18011     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 18012                                    CP-LOAN-TERM.                 ELC50PD
 18013     IF NOT CP-TERM-IS-DAYS                                       ELC50PD
 18014         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 18015                                                                  ELC50PD
 18016     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.                 ELC50PD
 18017                                                                  ELC50PD
 18018     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 18019                                                                  ELC50PD
 18020     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 18021        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 18022        NEXT SENTENCE                                             ELC50PD
 18023      ELSE                                                        ELC50PD
 18024         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18025                                                                  ELC50PD
 18026 3740-GET-AH-REFUND.                                              ELC50PD
 18027                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 326
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18028     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 18029        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 18030        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18031                                                                  ELC50PD
 18032     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 18033         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 18034         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18035                                                                  ELC50PD
 18036     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1                 ELC50PD
 18037*    MOVE ' '                    TO DC-OPTION-CODE                ELC50PD
 18038     SET BIN-TO-GREG             TO TRUE                          ELC50PD
 18039     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 18040     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM             ELC50PD
 18041                                    PB-C-AH-REM-TERM.             ELC50PD
 18042     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 18043     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 18044                                                                  ELC50PD
 18045     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 18046        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 18047           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK       ELC50PD
 18048           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT   ELC50PD
 18049                    - CM-AH-ITD-AH-PMT)                           ELC50PD
 18050           IF PB-C-AH-REF-CALC LESS THAN +0                       ELC50PD
 18051              MOVE +0            TO PB-C-AH-REF-CALC              ELC50PD
 18052              GO TO 3770-CHECK-REFUNDS                            ELC50PD
 18053           ELSE                                                   ELC50PD
 18054              GO TO 3770-CHECK-REFUNDS.                           ELC50PD
 18055                                                                  ELC50PD
 18056     IF PB-COMPANY-ID = 'DCC'
 18057        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18058            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 18059           MOVE 'S'              TO CP-EARNING-METHOD
 18060        END-IF
 18061     END-IF
 18062
 18063     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 18064                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 18065                            OR '9' OR 'G' OR 'S'
 18066        MOVE PB-C-AH-REFUND-OVERRIDE                              ELC50PD
 18067                                 TO CP-EARNING-METHOD.            ELC50PD
 18068                                                                  ELC50PD
 18069     if pb-company-id = 'AHL'
 18070        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 18071        if cp-class-code = spaces
 18072           move zeros            to cp-class-code
 18073        end-if
 18074     ELSE
 18075        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 18076     END-IF
 18077*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 18078     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 18079     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 18080                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 18081     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 18082         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *   ELC50PD
 18083                                         PB-CI-AH-TERM.           ELC50PD
 18084     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 18085     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 327
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18086     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 18087     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.            ELC50PD
 18088     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.              ELC50PD
 18089     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 18090                                                                  ELC50PD
 18091     IF CP-STATE-STD-ABBRV = 'OH'                                 ELC50PD
 18092        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'     ELC50PD
 18093                                AND 'CID' AND 'DCC' AND 'AHL')
 18094           IF (CP-ORIGINAL-TERM GREATER 60) AND                   ELC50PD
 18095              (DC-GREG-DATE-CYMD GREATER 19831101) AND               CL**4
 18096              (PB-CI-LF-BENEFIT-CD NOT = ZERO)                    ELC50PD
 18097              MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18098           END-IF
 18099        END-IF
 18100        IF PB-COMPANY-ID = 'CID'
 18101           IF NO-LIFE-COVERAGE
 18102              IF CP-CRITICAL-PERIOD
 18103                 MOVE '2'       TO CP-EARNING-METHOD
 18104              ELSE
 18105                 MOVE '6'       TO CP-EARNING-METHOD
 18106              END-IF
 18107           ELSE
 18108              IF WS-LF-COVERAGE-TYPE = 'L'
 18109                 MOVE '2'       TO CP-EARNING-METHOD
 18110              ELSE
 18111                 IF (PB-CI-LF-TERM > +60) OR                      ELC50PD
 18112                    (WS-LF-EARNINGS-CALC = '5')
 18113                    IF CP-CRITICAL-PERIOD
 18114                       MOVE '2'  TO CP-EARNING-METHOD
 18115                    ELSE
 18116                       MOVE '6'  TO CP-EARNING-METHOD
 18117                    END-IF
 18118                 ELSE
 18119                    MOVE '1'     TO CP-EARNING-METHOD
 18120                 END-IF
 18121              END-IF
 18122           END-IF
 18123        END-IF
 18124     END-IF
 18125                                                                  ELC50PD
 18126*    IF CP-STATE-STD-ABBRV = 'VA'                                 ELC50PD
 18127*       IF DC-GREG-DATE-CYMD GREATER 19921231                        CL**4
 18128*          IF CP-ORIGINAL-TERM GREATER 61                         ELC50PD
 18129*             MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18130*          ELSE                                                   ELC50PD
 18131*             MOVE '1' TO CP-EARNING-METHOD.                      ELC50PD
 18132                                                                  ELC50PD
 18133     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 18134         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 18135                                                                  ELC50PD
 18136     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 18137         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 18138            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 18139                MOVE WS-DEFAULT-APR                               ELC50PD
 18140                                 TO  CP-LOAN-APR                  ELC50PD
 18141                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 18142                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 18143            ELSE                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 328
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18144                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 18145                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 18146
 18147     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 18148
 18149
 18150     IF PB-COMPANY-ID = 'DCC'
 18151        AND CP-CANCEL-REASON = 'R'
 18152        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18153        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 18154     END-IF
 18155
 18156     IF PB-COMPANY-ID = 'DCC'
 18157        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18158        AND (CP-EARNING-METHOD = 'D')
 18159        AND (CP-CANCEL-REASON NOT = 'R')
 18160        CONTINUE
 18161     ELSE
 18162        GO TO 3750-CONTINUE
 18163     END-IF
 18164
 18165     MOVE ' '                    TO DD-IU-SW
 18166     IF NOT PDEF-MASTER-FOUND
 18167        MOVE ' '                 TO PDEF-MASTER-SW
 18168        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 18169        MOVE PB-STATE            TO ERPDEF-STATE
 18170        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 18171        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 18172        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 18173        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 18174        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 18175        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 18176        IF PDEF-MASTER-FOUND
 18177           MOVE 'N'              TO PDEF-MASTER-SW
 18178           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18179           IF PDEF-MASTER-FOUND
 18180              IF (ERPDEF-KEY-SAVE (1:16) =
 18181                           PD-CONTROL-PRIMARY (1:16))
 18182                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18183                 CONTINUE
 18184              ELSE
 18185                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18186                 IF (ERPDEF-KEY-SAVE (1:16) =
 18187                           PD-CONTROL-PRIMARY (1:16))
 18188                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18189                    CONTINUE
 18190                 ELSE
 18191                    MOVE ER-2740 TO WS-ERROR
 18192                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18193                    GO TO 3770-CHECK-REFUNDS
 18194                 END-IF
 18195              END-IF
 18196           END-IF
 18197           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 18198        END-IF
 18199     END-IF
 18200
 18201     IF PDEF-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 329
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18202        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 18203           (V1 > +8)
 18204           OR (PD-PROD-CODE (V1) = 'I')
 18205        END-PERFORM
 18206        IF V1 < +9
 18207           SET DD-IU-PRESENT        TO TRUE
 18208        END-IF
 18209        IF WS-AH-DCC-TRUNC = 'T'
 18210           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 18211        ELSE
 18212           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 18213        END-IF
 18214        EVALUATE TRUE
 18215           WHEN WS-TERM > +168
 18216              MOVE 15               TO V1
 18217           WHEN WS-TERM > +156
 18218              MOVE 14               TO V1
 18219           WHEN WS-TERM > +144
 18220              MOVE 13               TO V1
 18221           WHEN WS-TERM > +132
 18222              MOVE 12               TO V1
 18223           WHEN WS-TERM > +120
 18224              MOVE 11               TO V1
 18225           WHEN WS-TERM > +108
 18226              MOVE 10               TO V1
 18227           WHEN WS-TERM > +96
 18228              MOVE 9                TO V1
 18229           WHEN WS-TERM > +84
 18230              MOVE 8                TO V1
 18231           WHEN WS-TERM > +72
 18232              MOVE 7                TO V1
 18233           WHEN WS-TERM > +60
 18234              MOVE 6                TO V1
 18235           WHEN WS-TERM > +48
 18236              MOVE 5                TO V1
 18237           WHEN WS-TERM > +36
 18238              MOVE 4                TO V1
 18239           WHEN WS-TERM > +24
 18240              MOVE 3                TO V1
 18241           WHEN WS-TERM > +12
 18242              MOVE 2                TO V1
 18243           WHEN OTHER
 18244              MOVE 1                TO V1
 18245        END-EVALUATE
 18246
 18247        EVALUATE TRUE
 18248*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 18249*             < +13)
 18250*             AND (DD-IU-PRESENT)
 18251*             MOVE 2                TO V2
 18252*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 18253*             MOVE 1                TO V2
 18254           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 18255              MOVE 2                TO V2
 18256           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 18257              MOVE 3                TO V2
 18258           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 18259              MOVE 4                TO V2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 330
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18260           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 18261              MOVE 5                TO V2
 18262           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 18263              MOVE 6                TO V2
 18264           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 18265              MOVE 7                TO V2
 18266           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 18267              MOVE 8                TO V2
 18268           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 18269              MOVE 9                TO V2
 18270           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 18271              MOVE 10               TO V2
 18272           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 18273              MOVE 11               TO V2
 18274           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 18275              MOVE 12               TO V2
 18276           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 18277              MOVE 13               TO V2
 18278           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 18279              MOVE 14               TO V2
 18280           WHEN OTHER
 18281              MOVE 15               TO V2
 18282        END-EVALUATE
 18283
 18284        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 18285                                 TO CP-DDF-LO-FACT
 18286        MOVE PD-UEP-FACTOR (V1 V2)
 18287                                 TO CP-DDF-HI-FACT
 18288
 18289        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 18290        MOVE CM-AH-CLP     TO CP-DDF-CLP
 18291
 18292        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 18293           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 18294        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 18295        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 18296
 18297        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 18298           + PD-1ST-YR-ADMIN-ALLOW
 18299
 18300        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18301*       IF PI-CLP-YN = 'Y'
 18302*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 18303*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 18304*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 18305*       END-IF
 18306
 18307        IF DD-IU-PRESENT
 18308           MOVE 'I'              TO CP-EARNING-METHOD
 18309        END-IF
 18310        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18311                                     CP-CLP-RATE-UP
 18312        IF CP-IU-RATE-UP NOT = ZEROS
 18313           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 18314              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 18315           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 18316              / (1 - WS-WORK-FACT)
 18317        END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 331
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18318     END-IF
 18319
 18320     .
 18321 3750-CONTINUE.
 18322
 18323     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 18324                                                                  ELC50PD
 18325     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 18326         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.           ELC50PD
 18327                                                                  ELC50PD
 18328     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 18329        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 18330        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 18331        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18332                                                                  ELC50PD
 18333     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18334        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18335        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18336
 18337     IF PB-COMPANY-ID = 'DCC'
 18338        AND PB-CI-ENTRY-STATUS = 'M'
 18339        MOVE +0                  TO PB-C-AH-REF-CALC
 18340     ELSE
 18341        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 18342     END-IF
 18343
 18344     IF PB-COMPANY-ID = 'DCC'
 18345        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18346        AND (CP-EARNING-METHOD = 'D' OR 'I')
 18347        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18348        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 18349        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 18350        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 18351        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 18352        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 18353        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 18354     END-IF
 18355
 18356     GO TO 3770-CHECK-REFUNDS.                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 332
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18358                                                                  ELC50PD
 18359 3770-CHECK-REFUNDS.                                              ELC50PD
 18360                                                                  ELC50PD
 18361     IF PB-CI-LF-CANCEL-AMT NOT = ZERO                            ELC50PD
 18362        IF PB-C-LF-CANCEL-VOID-SW = SPACE                         ELC50PD
 18363           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18364           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18365           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC     ELC50PD
 18366           IF PB-C-LF-REF-CALC LESS THAN ZERO                     ELC50PD
 18367              MOVE ZEROS         TO PB-C-LF-REF-CALC.             ELC50PD
 18368                                                                  ELC50PD
 18369     IF PB-CI-AH-CANCEL-AMT NOT = ZERO                            ELC50PD
 18370        IF PB-C-AH-CANCEL-VOID-SW = SPACE                         ELC50PD
 18371           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18372           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18373           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC     ELC50PD
 18374           IF PB-C-AH-REF-CALC LESS THAN ZERO                     ELC50PD
 18375              MOVE ZEROS         TO PB-C-AH-REF-CALC.             ELC50PD
 18376                                                                  ELC50PD
 18377     IF PB-COMP-LF-CANCEL                                         ELC50PD
 18378        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT            ELC50PD
 18379        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18380           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18381              MOVE +0            TO  PB-C-LF-CANCEL-AMT.          ELC50PD
 18382                                                                  ELC50PD
 18383     IF PB-COMP-AH-CANCEL                                         ELC50PD
 18384        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT            ELC50PD
 18385        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18386           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18387              MOVE +0            TO  PB-C-AH-CANCEL-AMT.          ELC50PD
 18388                                                                  ELC50PD
 18389     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT               CL**2
 18390             GIVING WS-UNSIGN-WRK1                                ELC50PD
 18391     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT               CL**2
 18392             GIVING WS-UNSIGN-WRK2.                               ELC50PD
 18393                                                                  ELC50PD
 18394     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18395         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 18396                                                                  ELC50PD
 18397     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 18398         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 18399                                                                  ELC50PD
 18400     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.        CL**2
 18401                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 333
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18403                                                                  ELC50PD
 18404 3772-CONTINUE.                                                   ELC50PD
 18405                                                                  ELC50PD
 18406**********************************                                ELC50PD
 18407*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE  ELC50PD
 18408*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE     ELC50PD
 18409*** DOUBLES THE TOLERANCE AMOUNT.                                 ELC50PD
 18410***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL. ELC50PD
 18411**********************************                                ELC50PD
 18412     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 18413     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND              ELC50PD
 18414         IF WS-REF-REJECT-SW = SPACE                              ELC50PD
 18415             MOVE ER-2754        TO WS-ERROR                      ELC50PD
 18416             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 18417           ELSE                                                   ELC50PD
 18418             MOVE ER-2736        TO WS-ERROR                      ELC50PD
 18419             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18420**********************************                                ELC50PD
 18421                                                                  ELC50PD
 18422 3773-CONTINUE.                                                   ELC50PD
 18423                                                                  ELC50PD
 18424     IF PB-C-LF-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18425        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18426           MOVE ER-2723          TO WS-ERROR                      ELC50PD
 18427           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18428                                                                  ELC50PD
 18429     IF PB-C-AH-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18430        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18431           MOVE ER-2724          TO WS-ERROR                      ELC50PD
 18432           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18433                                                                  ELC50PD
 18434     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18435         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *     ELC50PD
 18436             (1 + WS-LF-REFUND-OVS-PCT)                           ELC50PD
 18437     ELSE                                                         ELC50PD
 18438         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.     ELC50PD
 18439                                                                  ELC50PD
 18440     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS                ELC50PD
 18441         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *     ELC50PD
 18442             (1 - WS-TOL-LF-REFUND-PCT)                           ELC50PD
 18443     ELSE                                                         ELC50PD
 18444         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.      ELC50PD
 18445                                                                  ELC50PD
 18446     IF (PB-COMPANY-ID = 'DCC')
 18447        AND (PB-CI-ENTRY-STATUS = 'M')
 18448        AND (PB-C-LF-CANCEL-AMT > +0)
 18449        MOVE ER-3843             TO WS-ERROR
 18450        PERFORM 9900-ERROR-FORMAT
 18451                                 THRU 9900-EXIT
 18452     END-IF
 18453     EVALUATE TRUE                                                ELC50PD
 18454        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18455           CONTINUE                                               ELC50PD
 18456        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18457                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18458           CONTINUE                                               ELC50PD
 18459        WHEN WS-LF-REFUND-OVS-AMT = 0                             ELC50PD
 18460                 AND WS-TOL-LF-REFUND = 0                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 334
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18461           CONTINUE                                               ELC50PD
 18462        WHEN OTHER                                                ELC50PD
 18463           IF WS-TOL-LF-REFUND  = +0                              ELC50PD
 18464              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND           ELC50PD
 18465           END-IF                                                 ELC50PD
 18466           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18467                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <          ELC50PD
 18468                          (PB-C-LF-CANCEL-AMT))                   ELC50PD
 18469              CONTINUE                                            ELC50PD
 18470           ELSE                                                   ELC50PD
 18471              IF WS-LF-REFUND-OVS-AMT = +0                        ELC50PD
 18472                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT    ELC50PD
 18473              END-IF                                              ELC50PD
 18474              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18475                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >     ELC50PD
 18476                                       PB-C-LF-CANCEL-AMT)        ELC50PD
 18477                 CONTINUE                                         ELC50PD
 18478              ELSE                                                ELC50PD
 18479                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18480                   MOVE ER-2754   TO  WS-ERROR                    ELC50PD
 18481                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 18482                 ELSE                                             ELC50PD
 18483                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18484                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18485                 END-IF                                           ELC50PD
 18486              END-IF                                              ELC50PD
 18487           END-IF                                                 ELC50PD
 18488     END-EVALUATE.                                                ELC50PD
 18489                                                                  ELC50PD
 18490     EVALUATE TRUE                                                ELC50PD
 18491        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18492           CONTINUE                                               ELC50PD
 18493        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18494                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18495           CONTINUE                                               ELC50PD
 18496        WHEN OTHER                                                ELC50PD
 18497           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18498               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))     ELC50PD
 18499              CONTINUE                                            ELC50PD
 18500           ELSE                                                   ELC50PD
 18501              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18502               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))    ELC50PD
 18503                CONTINUE                                          ELC50PD
 18504              ELSE                                                ELC50PD
 18505                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18506                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18507                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18508                 ELSE                                             ELC50PD
 18509                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18510                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18511                 END-IF                                           ELC50PD
 18512              END-IF                                              ELC50PD
 18513           END-IF                                                 ELC50PD
 18514     END-EVALUATE.                                                ELC50PD
 18515                                                                  ELC50PD
 18516     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18517         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *     ELC50PD
 18518             (1 + WS-AH-REFUND-OVS-PCT)                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 335
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18519     ELSE                                                         ELC50PD
 18520         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.     ELC50PD
 18521                                                                  ELC50PD
 18522     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS                   ELC50PD
 18523         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *     ELC50PD
 18524             (1 - WS-TOL-AH-REFUND-PCT)                           ELC50PD
 18525     ELSE                                                         ELC50PD
 18526         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.      ELC50PD
 18527                                                                  ELC50PD
 18528     IF (PB-COMPANY-ID = 'DCC')
 18529        AND (PB-CI-ENTRY-STATUS = 'M')
 18530        AND (PB-C-AH-CANCEL-AMT > +0)
 18531        MOVE ER-3843             TO WS-ERROR
 18532        PERFORM 9900-ERROR-FORMAT
 18533                                 THRU 9900-EXIT
 18534     END-IF
 18535     EVALUATE TRUE                                                ELC50PD
 18536        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
 18537           CONTINUE                                               ELC50PD
 18538*       WHEN PB-C-AH-REF-CALC = +0 AND                            ELC50PD
 18539*                  PB-C-AH-CANCEL-AMT > +0                        ELC50PD
 18540        WHEN PB-C-AH-CANCEL-AMT = +0 AND                          ELC50PD
 18541                   PB-C-AH-REF-CALC > +0                          ELC50PD
 18542           CONTINUE                                               ELC50PD
 18543        WHEN WS-AH-REFUND-OVS-AMT = +0                            ELC50PD
 18544                AND WS-TOL-AH-REFUND = +0                         ELC50PD
 18545           CONTINUE                                               ELC50PD
 18546        WHEN OTHER                                                ELC50PD
 18547           IF WS-TOL-AH-REFUND = +0                               ELC50PD
 18548              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND           ELC50PD
 18549           END-IF                                                 ELC50PD
 18550           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND        ELC50PD
 18551               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <            ELC50PD
 18552                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18553              CONTINUE                                            ELC50PD
 18554           ELSE                                                   ELC50PD
 18555              IF WS-AH-REFUND-OVS-AMT = +0                        ELC50PD
 18556                 MOVE +9999999.99 TO                              ELC50PD
 18557                         WS-AH-REFUND-OVS-AMT                     ELC50PD
 18558              END-IF                                              ELC50PD
 18559              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18560                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >     ELC50PD
 18561                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18562                 CONTINUE                                         ELC50PD
 18563              ELSE                                                ELC50PD
 18564                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18565                    MOVE ER-2754   TO  WS-ERROR                   ELC50PD
 18566                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18567                 ELSE                                             ELC50PD
 18568                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18569                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18570                 END-IF                                           ELC50PD
 18571              END-IF                                              ELC50PD
 18572           END-IF                                                 ELC50PD
 18573     END-EVALUATE.                                                ELC50PD
 18574                                                                  ELC50PD
 18575     EVALUATE TRUE                                                ELC50PD
 18576        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 336
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18577           CONTINUE                                               ELC50PD
 18578*       WHEN PB-C-AH-REF-CALC > +0 AND                            ELC50PD
 18579*                  PB-C-AH-CANCEL-AMT = +0                        ELC50PD
 18580        WHEN PB-C-AH-CANCEL-AMT > +0 AND                          ELC50PD
 18581                   PB-C-AH-REF-CALC = +0                          ELC50PD
 18582           CONTINUE                                               ELC50PD
 18583        WHEN OTHER                                                ELC50PD
 18584           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND       ELC50PD
 18585               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))     ELC50PD
 18586              CONTINUE                                            ELC50PD
 18587           ELSE                                                   ELC50PD
 18588              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18589                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))   ELC50PD
 18590                 CONTINUE                                         ELC50PD
 18591              ELSE                                                ELC50PD
 18592                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18593                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18594                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18595                 ELSE                                             ELC50PD
 18596                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18597                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18598                 END-IF                                           ELC50PD
 18599              END-IF                                              ELC50PD
 18600           END-IF                                                 ELC50PD
 18601     END-EVALUATE.                                                ELC50PD
 18602                                                                  ELC50PD
 18603     IF (PB-C-LF-CANCEL-AMT = ZERO)
 18604        AND (PB-C-AH-CANCEL-AMT = ZERO)
 18605        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 18606           AND  PB-C-LF-REF-CALC < +1.00
 18607           AND  PB-C-AH-REF-CALC < +1.00
 18608           CONTINUE
 18609        ELSE
 18610           IF (PB-COMPANY-ID = 'DCC')
 18611              AND (PB-CI-ENTRY-STATUS = 'M')
 18612              CONTINUE
 18613           ELSE
 18614              MOVE ER-2741       TO WS-ERROR
 18615              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18616           END-IF
 18617        END-IF
 18618     END-IF
 18619                                                                  ELC50PD
 18620     IF (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18621        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18622        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED                      ELC50PD
 18623        AND PB-C-LF-REF-CALC NOT = ZERO)                          ELC50PD
 18624        OR                                                        ELC50PD
 18625        (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18626        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18627        AND PB-C-LF-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18628             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18629                AND PB-C-LF-REF-CALC LESS THAN +1.00              ELC50PD
 18630                NEXT SENTENCE                                     ELC50PD
 18631             ELSE                                                 ELC50PD
 18632                MOVE ER-2739        TO WS-ERROR                   ELC50PD
 18633                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18634                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 337
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18635     IF (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18636        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18637        AND NOT PB-CI-AH-LUMP-SUM-DISAB                           ELC50PD
 18638        AND PB-C-AH-REF-CALC NOT = ZERO)                          ELC50PD
 18639        OR                                                        ELC50PD
 18640        (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18641        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18642        AND PB-C-AH-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18643             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18644                AND PB-C-AH-REF-CALC LESS THAN +1.00              ELC50PD
 18645                NEXT SENTENCE                                     ELC50PD
 18646             ELSE                                                 ELC50PD
 18647                MOVE ER-2738        TO WS-ERROR                   ELC50PD
 18648                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18649                                                                  ELC50PD
 18650 3775-OVER-REF-CHK.                                               ELC50PD
 18651                                                                  ELC50PD
 18652     IF PB-CI-ENTRY-STATUS = '5'                                  ELC50PD
 18653        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18654                                                                  ELC50PD
 18655     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +              ELC50PD
 18656                              PB-CI-LF-ALT-PREMIUM-AMT.           ELC50PD
 18657                                                                  ELC50PD
 18658     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18659        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18660                                 PB-C-LF-REF-CALC                 ELC50PD
 18661      ELSE                                                        ELC50PD
 18662        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18663                                 PB-C-LF-CANCEL-AMT.              ELC50PD
 18664                                                                  ELC50PD
 18665     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18666        MOVE ER-2755             TO WS-ERROR                      ELC50PD
 18667        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18668                                                                  ELC50PD
 18669     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.               ELC50PD
 18670                                                                  ELC50PD
 18671     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 18672        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18673                                 PB-C-AH-REF-CALC                 ELC50PD
 18674      ELSE                                                        ELC50PD
 18675        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18676                                 PB-C-AH-CANCEL-AMT.              ELC50PD
 18677                                                                  ELC50PD
 18678     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18679        MOVE ER-2778             TO WS-ERROR                      ELC50PD
 18680        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18681                                                                  ELC50PD
 18682     IF PB-CI-OB-FLAG NOT = 'Z'                                   ELC50PD
 18683        NEXT SENTENCE                                             ELC50PD
 18684       ELSE                                                       ELC50PD
 18685         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                  ELC50PD
 18686            MOVE ER-2757           TO WS-ERROR                    ELC50PD
 18687            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 18688                                                                  ELC50PD
 18689 3780-UPDATE-CANCEL-CERT.                                         ELC50PD
 18690                                                                  ELC50PD
 18691     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'                         ELC50PD
 18692        MOVE ER-2728              TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 338
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18693        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18694                                                                  ELC50PD
 18695     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'                         ELC50PD
 18696         MOVE ER-2729              TO WS-ERROR                    ELC50PD
 18697         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 18698                                                                  ELC50PD
 18699     IF PB-CI-LF-BENEFIT-CD = ZERO                                ELC50PD
 18700         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18701                                                                  ELC50PD
 18702     IF PB-C-LF-CANCEL-DT = LOW-VALUE                             ELC50PD
 18703         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18704                                                                  ELC50PD
 18705     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18706       AND                                                        ELC50PD
 18707        (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18708       AND                                                        ELC50PD
 18709        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18710       AND                                                        ELC50PD
 18711        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)       ELC50PD
 18712            NEXT SENTENCE                                         ELC50PD
 18713       ELSE                                                       ELC50PD
 18714        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18715          AND                                                     ELC50PD
 18716***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18717***       AND                                                     ELC50PD
 18718           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)     ELC50PD
 18719            IF PB-C-LF-CANCEL-VOID-SW = SPACE                     ELC50PD
 18720               MOVE ER-2730      TO WS-ERROR                      ELC50PD
 18721               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18722               GO TO 3999-END-EDIT                                ELC50PD
 18723            ELSE                                                  ELC50PD
 18724               GO TO 3999-END-EDIT                                ELC50PD
 18725        ELSE                                                      ELC50PD
 18726            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT       ELC50PD
 18727               MOVE ER-2765           TO WS-ERROR                 ELC50PD
 18728               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18729               GO TO 3785-CHECK-NH.
 18730*              GO TO 3999-END-EDIT.                               ELC50PD
 18731                                                                  ELC50PD
 18732 3780-UPDATE-CONT-1.                                              ELC50PD
 18733     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 18734                                                                  ELC50PD
 18735     IF PB-CI-AH-BENEFIT-CD = ZERO                                ELC50PD
 18736         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18737                                                                  ELC50PD
 18738     IF PB-C-AH-CANCEL-DT = LOW-VALUE                             ELC50PD
 18739         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18740
 18741     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 18742                                                                  ELC50PD
 18743     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18744       AND                                                        ELC50PD
 18745        (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18746       AND                                                        ELC50PD
 18747        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18748       AND                                                        ELC50PD
 18749        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)       ELC50PD
 18750            NEXT SENTENCE                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 339
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18751       ELSE                                                       ELC50PD
 18752        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18753          AND                                                     ELC50PD
 18754***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18755***       AND                                                     ELC50PD
 18756           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)     ELC50PD
 18757           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 18758            IF PB-C-AH-CANCEL-VOID-SW = SPACE                     ELC50PD
 18759               MOVE ER-2773      TO WS-ERROR                      ELC50PD
 18760               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18761               GO TO 3999-END-EDIT                                ELC50PD
 18762            ELSE                                                  ELC50PD
 18763               GO TO 3999-END-EDIT                                ELC50PD
 18764            END-IF
 18765           ELSE
 18766             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18767                MOVE ER-2890 TO WS-ERROR
 18768                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18769                GO TO 3999-END-EDIT
 18770             ELSE
 18771                GO TO 3785-CHECK-NH
 18772             END-IF
 18773           END-IF
 18774          ELSE                                                    ELC50PD
 18775            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT       ELC50PD
 18776              IF WS-AH-CLAIM-RESCINDED = 'Y'
 18777                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18778                   MOVE ER-2890 TO WS-ERROR
 18779                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18780                   GO TO 3999-END-EDIT
 18781                ELSE
 18782                   MOVE ER-2765 TO WS-ERROR
 18783                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18784                   GO TO 3785-CHECK-NH
 18785                END-IF
 18786              ELSE
 18787               MOVE ER-2765      TO WS-ERROR                      ELC50PD
 18788               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18789               GO TO 3785-CHECK-NH.
 18790*              GO TO 3999-END-EDIT.                               ELC50PD
 18791                                                                  ELC50PD
 18792 3780-UPDATE-CONT-2.                                              ELC50PD
 18793                                                                  ELC50PD
 18794     IF PB-C-LF-CANCEL-AMT NOT = ZERO                             ELC50PD
 18795        AND WS-LF-BENEFIT-CD = ZERO                               ELC50PD
 18796           MOVE ER-2743           TO WS-ERROR                     ELC50PD
 18797           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18798                                                                  ELC50PD
 18799     IF PB-C-AH-CANCEL-AMT NOT = ZERO                             ELC50PD
 18800        AND WS-AH-BENEFIT-CD = ZERO                               ELC50PD
 18801           MOVE ER-2744           TO WS-ERROR                     ELC50PD
 18802           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18803                                                                  ELC50PD
 18804     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR                         ELC50PD
 18805        (PB-C-AH-CANCEL-AMT NEGATIVE))                            ELC50PD
 18806        AND                                                       ELC50PD
 18807        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR                 ELC50PD
 18808         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 340
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18809           MOVE ER-2746           TO WS-ERROR                     ELC50PD
 18810           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18811                                                                  ELC50PD
 18812     IF (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18813       AND                                                        ELC50PD
 18814        (PB-C-LF-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18815             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18816             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18817                                                                  ELC50PD
 18818     IF (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18819       AND                                                        ELC50PD
 18820        (PB-C-AH-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18821             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18822             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18823                                                                  ELC50PD
 18824     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0                       ELC50PD
 18825         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 18826             OR 'CID' OR 'DCC' OR 'AHL'
 18827             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT      ELC50PD
 18828         ELSE                                                     ELC50PD
 18829             IF PB-COMPANY-ID = 'FIA' OR 'MTL'                       CL**2
 18830                 MOVE ER-2768    TO WS-ERROR                      ELC50PD
 18831                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 18832             ELSE                                                 ELC50PD
 18833                 MOVE ER-2756    TO WS-ERROR                      ELC50PD
 18834                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 18835                                                                  ELC50PD
 18836     IF CERT-PEND-ISSUE-RETURNED                                  ELC50PD
 18837        MOVE ER-2772             TO WS-ERROR                      ELC50PD
 18838        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18839
 18840 3785-CHECK-NH.
 18841
 18842     IF PB-STATE NOT = 'NH'
 18843        GO TO 3999-END-EDIT
 18844     END-IF
 18845
 18846     MOVE ER-2796                TO WS-ERROR
 18847     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 18848
 18849     IF (PB-C-REF-INTERFACE-SW = 'Y')
 18850        OR (CM-NH-INTERFACE-SW = 'Y')
 18851        MOVE ER-2793             TO WS-ERROR
 18852        PERFORM 9900-ERROR-FORMAT
 18853                                 THRU 9900-EXIT
 18854     END-IF
 18855
 18856     MOVE +0                     TO WS-PAYMENT-AMT
 18857     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 18858        GO TO 3999-END-EDIT
 18859     END-IF
 18860
 18861     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 18862        GO TO 3999-END-EDIT
 18863     END-IF
 18864
 18865     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 18866     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 341
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18867
 18868     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 18869        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 18870     END-IF
 18871     MOVE '1'                    TO DC-OPTION-CODE
 18872     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18873     IF NO-CONVERSION-ERROR
 18874        IF DC-ELAPSED-DAYS < +16
 18875           GO TO 3999-END-EDIT
 18876        END-IF
 18877     END-IF
 18878
 18879     MOVE +0                     TO DC-ELAPSED-DAYS
 18880     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 18881     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 18882     MOVE '1'                    TO DC-OPTION-CODE
 18883     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18884     IF NO-CONVERSION-ERROR
 18885        IF DC-ELAPSED-DAYS > +30
 18886           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 18887        ELSE
 18888           GO TO 3999-END-EDIT
 18889        END-IF
 18890     ELSE
 18891        GO TO 3999-END-EDIT
 18892     END-IF
 18893
 18894     COMPUTE WS-PAYMENT-AMT ROUNDED =
 18895        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 18896           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 18897
 18898     IF WS-PAYMENT-AMT < 600.00
 18899        GO TO 3999-END-EDIT
 18900     END-IF
 18901
 18902     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 18903                                                                  ELC50PD
 18904     IF (ERMAIL-FOUND = ' ')
 18905         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 18906         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 18907        GO TO 3999-END-EDIT
 18908     END-IF
 18909
 18910     MOVE ER-2795                TO WS-ERROR
 18911     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 18912                                                                  ELC50PD
 18913     GO TO 3999-END-EDIT.                                         ELC50PD
 18914******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 342
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18916 3990-FILES-NOT-OPEN.                                             ELC50PD
 18917                                                                  ELC50PD
 18918     MOVE ER-2617                TO WS-ERROR.                     ELC50PD
 18919     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 18920     GO TO 9990-RETURN.                                           ELC50PD
 18921                                                                  ELC50PD
 18922 3999-END-EDIT.                                                   ELC50PD
 18923
 18924                                                                  ELC50PD
 18925     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.                   ELC50PD
 18926                                                                  ELC50PD
 18927     IF PB-CANCELLATION AND CERT-WAS-FOUND                        ELC50PD
 18928         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT        ELC50PD
 18929         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18930             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18931             GO TO 9990-RETURN                                    ELC50PD
 18932          ELSE                                                    ELC50PD
 18933             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT             ELC50PD
 18934             GO TO 9990-RETURN.                                   ELC50PD
 18935                                                                  ELC50PD
 18936     IF PB-CANCELLATION                                           ELC50PD
 18937          GO TO 9990-RETURN.                                      ELC50PD
 18938                                                                  ELC50PD
 18939     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 18940        MOVE SPACES              TO CERTIFICATE-MASTER.           ELC50PD
 18941                                                                  ELC50PD
 18942     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.                 ELC50PD
 18943                                                                  ELC50PD
 18944     IF CERT-WAS-FOUND                                            ELC50PD
 18945         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18946             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18947          ELSE                                                    ELC50PD
 18948            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT              ELC50PD
 18949      ELSE                                                        ELC50PD
 18950         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.                  ELC50PD
 18951
 18952     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 18953        IF PB-COMPANY-ID = 'DCC' AND
 18954           (PB-CARRIER = '2' OR '4' OR '6')
 18955              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 18956        END-IF
 18957     END-IF.
 18958
 18959     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 18960         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 18961     END-IF.
 18962                                                                  ELC50PD
 18963     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 18964     IF ((PB-COMPANY-ID = 'DCC')
 18965        AND (WS-NO-SECURE-PAY))
 18966                  OR
 18967        (WS-LF-SPECIAL-CALC-CD = 'O'
 18968        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18969        SET SKIP-ADDR-EDIT       TO TRUE
 18970     END-IF
 18971
 18972     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18973        AND (NOT SKIP-ADDR-EDIT)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 343
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18974        MOVE ER-2963             TO WS-ERROR
 18975        PERFORM 9900-ERROR-FORMAT
 18976                                 THRU 9900-EXIT
 18977        GO TO 9990-RETURN
 18978     END-IF
 18979
 18980     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.                     ELC50PD
 18981
 18982     IF ERPNDM-FOUND NOT = 'X'
 18983        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18984           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 18985           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 18986           AND (NOT SKIP-ADDR-EDIT)
 18987           MOVE ER-2694          TO WS-ERROR
 18988           PERFORM 9900-ERROR-FORMAT
 18989                                 THRU 9900-EXIT
 18990        END-IF
 18991        MOVE ' '                 TO STATE-RECORD-ERROR
 18992        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18993        MOVE PM-STATE            TO CNTL-ACCESS
 18994        MOVE '3'                 TO CNTL-REC-TYPE
 18995        MOVE +0                  TO CNTL-SEQ-NO
 18996        MOVE '0'                 TO RC-SW-2
 18997        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18998        IF (NO-STATE-RECORD)
 18999           OR (CF-RECORD-TYPE NOT = '3')
 19000           OR (PM-STATE NOT = CF-STATE-CODE)
 19001           IF (PM-STATE = SPACES)
 19002              AND (SKIP-ADDR-EDIT)
 19003              CONTINUE
 19004           ELSE
 19005              MOVE ER-2963       TO WS-ERROR
 19006              PERFORM 9900-ERROR-FORMAT
 19007                                 THRU 9900-EXIT
 19008           END-IF
 19009        END-IF
 19010        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 19011           MOVE ER-2883          TO WS-ERROR
 19012           PERFORM 9900-ERROR-FORMAT
 19013                                 THRU 9900-EXIT
 19014        END-IF
 19015        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 19016           MOVE ' '                 TO STATE-RECORD-ERROR
 19017           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 19018           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 19019           MOVE '3'                 TO CNTL-REC-TYPE
 19020           MOVE +0                  TO CNTL-SEQ-NO
 19021           MOVE '0'                 TO RC-SW-2
 19022           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 19023           IF NO-STATE-RECORD
 19024              OR (CF-RECORD-TYPE NOT = '3')
 19025              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 19026              MOVE ER-2964          TO WS-ERROR
 19027              PERFORM 9900-ERROR-FORMAT
 19028                                    THRU 9900-EXIT
 19029           END-IF
 19030        END-IF
 19031     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 344
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19032        IF NOT SKIP-ADDR-EDIT
 19033           MOVE ER-2393          TO WS-ERROR
 19034           PERFORM 9900-ERROR-FORMAT
 19035                                 THRU 9900-EXIT
 19036        END-IF
 19037     END-IF
 19038                                                                  ELC50PD
 19039     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 19040                                                                  ELC50PD
 19041     IF (ERMAIL-FOUND = ' ' AND                                   ELC50PD
 19042        ERPNDM-FOUND = ' ')                                       ELC50PD
 19043        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND             ELC50PD
 19044           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 19045           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 19046          OR                                                      ELC50PD
 19047           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)       ELC50PD
 19048          OR                                                      ELC50PD
 19049           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND               ELC50PD
 19050           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)ELC50PD
 19051           GO TO 3999-UNLOCK-ERMAIL.                              ELC50PD
 19052                                                                  ELC50PD
 19053
 19054     IF ERPNDM-FOUND = 'X'                                        ELC50PD
 19055        GO TO 3999-UNLOCK-ERMAIL.                                 ELC50PD
 19056                                                                  ELC50PD
 19057     IF PM-INSURED-LAST-NAME      = SPACES
 19058        AND PM-INSURED-FIRST-NAME = SPACES
 19059        AND PM-ADDRESS-LINE-1     = SPACES
 19060        AND PM-ADDRESS-LINE-2     = SPACES
 19061        AND PM-CITY-STATE         = SPACES
 19062        AND PM-CRED-BENE-NAME     = SPACES
 19063        AND PM-CRED-BENE-ADDR     = SPACES
 19064        AND PM-CRED-BENE-CTYST    = SPACES
 19065        GO TO 3999-UNLOCK-ERMAIL
 19066     END-IF
 19067                                                                  ELC50PD
 19068     MOVE SPACES                 TO MAILING-DATA.                 ELC50PD
 19069                                                                  ELC50PD
 19070     MOVE 'MA'                   TO MA-RECORD-ID.                 ELC50PD
 19071     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.           ELC50PD
 19072     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.            ELC50PD
 19073     MOVE PB-SV-CARRIER          TO MA-CARRIER.                   ELC50PD
 19074     MOVE PB-SV-GROUPING         TO MA-GROUPING.                  ELC50PD
 19075     MOVE PB-SV-STATE            TO MA-STATE.                     ELC50PD
 19076     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 19077     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 19078                                                                  ELC50PD
 19079     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT              ELC50PD
 19080     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY              ELC50PD
 19081                                                                  ELC50PD
 19082     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19083        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT                ELC50PD
 19084     ELSE                                                         ELC50PD
 19085        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT              ELC50PD
 19086        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY            ELC50PD
 19087        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.                 ELC50PD
 19088                                                                  ELC50PD
 19089
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 345
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19090     GO TO 9990-RETURN.                                           ELC50PD
 19091                                                                  ELC50PD
 19092 3999-UNLOCK-ERMAIL.                                              ELC50PD
 19093     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19094        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.                ELC50PD
 19095                                                                  ELC50PD
 19096     GO TO 9990-RETURN.                                           ELC50PD
 19097******************************************************************ELC50PD
 19098                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 346
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19100 4000-UPDATE-CANCELLED-CERT.                                      ELC50PD
 19101     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 19102        GO TO 4299-EXIT.                                          ELC50PD
 19103                                                                  ELC50PD
 19104*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.         ELC50PD
 19105
 19106     IF PB-C-NH-INT-ON-REFS > ZEROS
 19107        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 19108     END-IF
 19109     IF PB-C-REF-INTERFACE-SW = 'Y'
 19110        MOVE PB-C-REF-INTERFACE-SW
 19111                                 TO CM-NH-INTERFACE-SW
 19112     END-IF
 19113
 19114     IF PB-C-POST-CARD-IND = 'Y'
 19115        MOVE +8                  TO SUB
 19116        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 19117        IF ERMAIL-FOUND = ' '
 19118           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 19119              (SUB > +7)
 19120              OR (MA-MAIL-STATUS (SUB) = '1')
 19121           END-PERFORM
 19122        END-IF
 19123        IF (SUB > +7)
 19124           OR (ERMAIL-FOUND = 'X')
 19125           MOVE ER-3789          TO WS-ERROR
 19126           PERFORM 9900-ERROR-FORMAT
 19127                                 THRU 9900-EXIT
 19128        END-IF
 19129     ELSE
 19130        MOVE 'N'                 TO PB-C-POST-CARD-IND
 19131     END-IF
 19132
 19133     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 19134                                                                  ELC50PD
 19135     IF PB-CI-OB-FLAG = 'Z'                                       ELC50PD
 19136        GO TO 4150-SUMMARY-CERT-CANCEL.                           ELC50PD
 19137                                                                  ELC50PD
 19138     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19139         PERFORM 4200-REVERSE-LF-CANCEL.                          ELC50PD
 19140     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19141         PERFORM 4200-REVERSE-AH-CANCEL.                          ELC50PD
 19142                                                                  ELC50PD
 19143 4100-APPLY-LF-CANCEL.                                            ELC50PD
 19144                                                                  ELC50PD
 19145     MOVE +0                     TO WS-SUB.                       ELC50PD
 19146                                                                  ELC50PD
 19147 4100-CHECK-LF-ERRORS.                                            ELC50PD
 19148                                                                  ELC50PD
 19149     ADD +1                       TO WS-SUB.                      ELC50PD
 19150                                                                  ELC50PD
 19151     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19152        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 19153           GO TO 4100-LF-CANCEL-CONT                              ELC50PD
 19154        ELSE                                                      ELC50PD
 19155           GO TO 4100-UPDATE-LF-COVERAGE.                         ELC50PD
 19156                                                                  ELC50PD
 19157     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 347
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19158                                   ER-2729 OR                     ELC50PD
 19159                                   ER-2730 OR                     ELC50PD
 19160                                   ER-2731 OR                     ELC50PD
 19161                                   ER-2732 OR                     ELC50PD
 19162                                   ER-2737 OR                     ELC50PD
 19163                                   ER-2740 OR                     ELC50PD
 19164                                   ER-2743 OR                     ELC50PD
 19165                                   ER-2749 OR                     ELC50PD
 19166                                   ER-2750 OR                     ELC50PD
 19167                                   ER-2755 OR                     ELC50PD
 19168                                   ER-2757 OR                     ELC50PD
 19169                                   ER-2760 OR                     ELC50PD
 19170                                   ER-2772 OR                     ELC50PD
 19171                                   ER-2774 OR                     ELC50PD
 19172                                   ER-2776 OR                     ELC50PD
 19173                                   ER-2794                        ELC50PD
 19174        GO TO 4100-UPDATE-LF-COVERAGE.                            ELC50PD
 19175                                                                  ELC50PD
 19176     GO TO 4100-CHECK-LF-ERRORS.                                  ELC50PD
 19177                                                                  ELC50PD
 19178 4100-UPDATE-LF-COVERAGE.                                         ELC50PD
 19179                                                                  ELC50PD
 19180     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT     ELC50PD
 19181     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT          ELC50PD
 19182     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 19183        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 19184     END-IF
 19185     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19186                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19187     IF CM-LF-CANCEL-DT = LOW-VALUE                               ELC50PD
 19188         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.    ELC50PD
 19189                                                                  ELC50PD
 19190     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19191         MOVE SPACES                  TO CM-LF-EXIT-BATCH         ELC50PD
 19192                                         CM-LF-STATUS-AT-CANCEL.  ELC50PD
 19193                                                                  ELC50PD
 19194     GO TO 4100-APPLY-AH-CANCEL.                                  ELC50PD
 19195                                                                  ELC50PD
 19196 4100-LF-CANCEL-CONT.                                             ELC50PD
 19197     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19198         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19199                                                                  ELC50PD
 19200     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19201         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19202                                                                  ELC50PD
 19203     IF PB-C-LF-CANCEL-AMT GREATER ZERO                           ELC50PD
 19204        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                   ELC50PD
 19205           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT        ELC50PD
 19206        ELSE                                                      ELC50PD
 19207           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.       ELC50PD
 19208                                                                  ELC50PD
 19209     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.            ELC50PD
 19210     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.       ELC50PD
 19211                                                                  ELC50PD
 19212     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19213         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.           ELC50PD
 19214                                                                  ELC50PD
 19215     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 348
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19216        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 19217         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL      ELC50PD
 19218         MOVE '8'                  TO CM-LF-CURRENT-STATUS.       ELC50PD
 19219                                                                  ELC50PD
 19220     IF PB-RECORD-RETURNED                                        ELC50PD
 19221        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19222      ELSE                                                        ELC50PD
 19223        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19224                                                                  ELC50PD
 19225 4100-APPLY-AH-CANCEL.                                            ELC50PD
 19226                                                                  ELC50PD
 19227     MOVE +0                      TO WS-SUB.                      ELC50PD
 19228                                                                  ELC50PD
 19229 4100-CHECK-AH-ERRORS.                                            ELC50PD
 19230                                                                  ELC50PD
 19231     ADD +1                       TO WS-SUB.                      ELC50PD
 19232                                                                  ELC50PD
 19233     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19234        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 19235           GO TO 4100-AH-CANCEL-CONT                              ELC50PD
 19236        ELSE                                                      ELC50PD
 19237           GO TO 4100-UPDATE-AH-COVERAGE.                         ELC50PD
 19238                                                                  ELC50PD
 19239     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
 19240                                   ER-2729 OR                     ELC50PD
 19241                                   ER-2732 OR                     ELC50PD
 19242                                   ER-2737 OR                     ELC50PD
 19243                                   ER-2740 OR                     ELC50PD
 19244                                   ER-2744 OR                     ELC50PD
 19245                                   ER-2749 OR                     ELC50PD
 19246                                   ER-2750 OR                     ELC50PD
 19247                                   ER-2755 OR                     ELC50PD
 19248                                   ER-2757 OR                     ELC50PD
 19249                                   ER-2760 OR                     ELC50PD
 19250                                   ER-2771 OR                     ELC50PD
 19251                                   ER-2772 OR                     ELC50PD
 19252                                   ER-2773 OR                     ELC50PD
 19253                                   ER-2775 OR                     ELC50PD
 19254                                   ER-2777 OR                     ELC50PD
 19255                                   ER-2794                        ELC50PD
 19256        GO TO 4100-UPDATE-AH-COVERAGE.                            ELC50PD
 19257                                                                  ELC50PD
 19258     GO TO 4100-CHECK-AH-ERRORS.                                  ELC50PD
 19259                                                                  ELC50PD
 19260 4100-UPDATE-AH-COVERAGE.                                         ELC50PD
 19261                                                                  ELC50PD
 19262     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT     ELC50PD
 19263     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT          ELC50PD
 19264     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS     ELC50PD
 19265     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19266                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19267     IF CM-AH-CANCEL-DT = LOW-VALUE                               ELC50PD
 19268         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.    ELC50PD
 19269                                                                  ELC50PD
 19270     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19271         MOVE SPACES                  TO CM-AH-EXIT-BATCH         ELC50PD
 19272                                         CM-AH-STATUS-AT-CANCEL.  ELC50PD
 19273                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 349
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19274     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 19275         IF PB-RECORD-RETURNED                                    ELC50PD
 19276              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2 ELC50PD
 19277          ELSE                                                    ELC50PD
 19278              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19279                                                                  ELC50PD
 19280     GO TO 4299-EXIT.                                             ELC50PD
 19281                                                                  ELC50PD
 19282 4100-AH-CANCEL-CONT.                                             ELC50PD
 19283     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19284         GO TO 4299-EXIT.                                         ELC50PD
 19285                                                                  ELC50PD
 19286     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19287         GO TO 4299-EXIT.                                         ELC50PD
 19288                                                                  ELC50PD
 19289     IF PB-C-AH-CANCEL-AMT GREATER ZERO                           ELC50PD
 19290        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                     ELC50PD
 19291           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT      ELC50PD
 19292        ELSE                                                      ELC50PD
 19293           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.     ELC50PD
 19294                                                                  ELC50PD
 19295     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.              ELC50PD
 19296     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.         ELC50PD
 19297                                                                  ELC50PD
 19298     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19299         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.             ELC50PD
 19300                                                                  ELC50PD
 19301     IF CM-AH-STATUS-AT-CANCEL = SPACE                            ELC50PD
 19302         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL      ELC50PD
 19303         MOVE '8'                TO CM-AH-CURRENT-STATUS.         ELC50PD
 19304                                                                  ELC50PD
 19305     IF PB-RECORD-RETURNED                                        ELC50PD
 19306        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2      ELC50PD
 19307      ELSE                                                        ELC50PD
 19308        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19309                                                                  ELC50PD
 19310     GO TO 4299-EXIT.                                             ELC50PD
 19311                                                                  ELC50PD
 19312 4150-SUMMARY-CERT-CANCEL.                                        ELC50PD
 19313     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19314                                                                  ELC50PD
 19315     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19316        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19317                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC      ELC50PD
 19318     ELSE                                                         ELC50PD
 19319        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19320                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.  ELC50PD
 19321                                                                  ELC50PD
 19322     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 19323        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19324                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC     ELC50PD
 19325     ELSE                                                         ELC50PD
 19326        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19327                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.  ELC50PD
 19328                                                                  ELC50PD
 19329     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                      ELC50PD
 19330        NEXT SENTENCE                                             ELC50PD
 19331     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 350
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19332        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.              ELC50PD
 19333                                                                  ELC50PD
 19334     GO TO 4299-EXIT.                                             ELC50PD
 19335                                                                  ELC50PD
 19336 4200-REVERSE-LF-CANCEL.                                          ELC50PD
 19337     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.            ELC50PD
 19338                                                                  ELC50PD
 19339     IF CM-LF-CANCEL-APPLIED                                      ELC50PD
 19340        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT        ELC50PD
 19341        MOVE SPACES                TO CM-LF-EXIT-BATCH            ELC50PD
 19342        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.      ELC50PD
 19343                                                                  ELC50PD
 19344     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.     ELC50PD
 19345                                                                  ELC50PD
 19346     IF PB-RECORD-RETURNED                                        ELC50PD
 19347        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19348       ELSE                                                       ELC50PD
 19349        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19350                                                                  ELC50PD
 19351 4200-REVERSE-LF-EXIT.                                            ELC50PD
 19352       EXIT.                                                      ELC50PD
 19353                                                                  ELC50PD
 19354 4200-REVERSE-AH-CANCEL.                                          ELC50PD
 19355     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.            ELC50PD
 19356                                                                  ELC50PD
 19357     IF CM-AH-CANCEL-APPLIED                                      ELC50PD
 19358        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT        ELC50PD
 19359        MOVE SPACES                TO CM-AH-EXIT-BATCH            ELC50PD
 19360        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.      ELC50PD
 19361                                                                  ELC50PD
 19362     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.     ELC50PD
 19363                                                                  ELC50PD
 19364     IF PB-RECORD-RETURNED                                        ELC50PD
 19365        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19366       ELSE                                                       ELC50PD
 19367        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19368                                                                  ELC50PD
 19369 4200-REVERSE-AH-EXIT.                                            ELC50PD
 19370       EXIT.                                                      ELC50PD
 19371                                                                  ELC50PD
 19372 4299-EXIT.                                                       ELC50PD
 19373       EXIT.                                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 351
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19375                                                                  ELC50PD
 19376 4500-UPDATE-NEW-CERT.                                            ELC50PD
 19377     IF CERT-WAS-FOUND                                            ELC50PD
 19378         NEXT SENTENCE                                            ELC50PD
 19379       ELSE                                                       ELC50PD
 19380         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19381                                                                  ELC50PD
 19382     IF  CLASIC-CREATED-CERT                                      ELC50PD
 19383         GO TO 4999-EXIT.                                         ELC50PD
 19384                                                                  ELC50PD
 19385     IF  CERT-WAS-CREATED-FOR-CLAIM                               ELC50PD
 19386         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19387                                                                  ELC50PD
 19388     IF CERT-ADDED-BATCH                                          ELC50PD
 19389        IF CM-RECORD-ID = 'CM'                                    ELC50PD
 19390            GO TO 4999-EXIT.                                      ELC50PD
 19391                                                                  ELC50PD
 19392 4520-BUILD-NEW-KEY.                                              ELC50PD
 19393* BUILD CONTROL PRIMARY                                           ELC50PD
 19394                                                                  ELC50PD
 19395     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD              ELC50PD
 19396                                       CM-COMPANY-CD-A1           ELC50PD
 19397                                       CM-COMPANY-CD-A2           ELC50PD
 19398                                       CM-COMPANY-CD-A4           ELC50PD
 19399                                       CM-COMPANY-CD-A5.          ELC50PD
 19400                                                                  ELC50PD
 19401     MOVE PB-SV-CARRIER             TO CM-CARRIER.                ELC50PD
 19402     MOVE PB-SV-GROUPING            TO CM-GROUPING.               ELC50PD
 19403     MOVE PB-SV-STATE               TO CM-STATE.                  ELC50PD
 19404     MOVE PB-ACCOUNT                TO CM-ACCOUNT.                ELC50PD
 19405     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.             ELC50PD
 19406     MOVE PB-CERT-SFX               TO CM-CERT-SFX.               ELC50PD
 19407     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.            ELC50PD
 19408                                                                  ELC50PD
 19409     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.             ELC50PD
 19410                                                                  ELC50PD
 19411     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.      ELC50PD
 19412     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.      ELC50PD
 19413     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.     ELC50PD
 19414     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.    ELC50PD
 19415                                                                  ELC50PD
 19416     IF PB-I-SOC-SEC-NO EQUAL '000000000  '                       ELC50PD
 19417        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.          ELC50PD
 19418                                                                  ELC50PD
 19419     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO                        ELC50PD
 19420         MOVE PB-SV-STATE            TO CM-SSN-STATE              ELC50PD
 19421         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT            ELC50PD
 19422         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2      ELC50PD
 19423         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2    ELC50PD
 19424     ELSE                                                         ELC50PD
 19425         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.            ELC50PD
 19426                                                                  ELC50PD
 19427     IF PB-COMPANY-ID   EQUAL  'CRI'                              ELC50PD
 19428         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME         ELC50PD
 19429         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD            ELC50PD
 19430         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME          ELC50PD
 19431         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL            ELC50PD
 19432         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 352
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19433                                                                  ELC50PD
 19434     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND                  ELC50PD
 19435        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19436         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.   ELC50PD
 19437                                                                  ELC50PD
 19438     IF PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 19439        IF PB-I-JOINT-COVERAGE                                    ELC50PD
 19440            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO           ELC50PD
 19441                                           PB-I-MEMBER-NO         ELC50PD
 19442            GO TO 4550-CONT-CERT-PROCESS.                         ELC50PD
 19443                                                                  ELC50PD
 19444     IF PB-COMPANY-ID  = 'MON' OR 'PEM'                           ELC50PD
 19445        NEXT SENTENCE                                             ELC50PD
 19446     ELSE                                                         ELC50PD
 19447        GO TO 4540-BUILD-MEMBER-NO.                               ELC50PD
 19448                                                                  ELC50PD
 19449******************************************************************ELC50PD
 19450*                                                                *ELC50PD
 19451*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *ELC50PD
 19452*    FOR 'MON'.                                                  *ELC50PD
 19453*                                                                *ELC50PD
 19454******************************************************************ELC50PD
 19455                                                                  ELC50PD
 19456     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.                 ELC50PD
 19457     MOVE SPACES                 TO WS-WORK-MEMB-NAME.            ELC50PD
 19458     MOVE +1                     TO WS-SUB1                       ELC50PD
 19459                                    WS-SUB2.                      ELC50PD
 19460                                                                  ELC50PD
 19461 4530-EDIT-MEMB-NAME.                                             ELC50PD
 19462                                                                  ELC50PD
 19463     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO       ELC50PD
 19464        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)  ELC50PD
 19465        ADD +1                       TO WS-SUB2.                  ELC50PD
 19466                                                                  ELC50PD
 19467     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7            ELC50PD
 19468        ADD +1                       TO WS-SUB1                   ELC50PD
 19469        GO TO 4530-EDIT-MEMB-NAME.                                ELC50PD
 19470                                                                  ELC50PD
 19471     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.          ELC50PD
 19472     MOVE PB-SV-STATE                TO CM-MEMB-STATE.            ELC50PD
 19473     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.            ELC50PD
 19474*    MOVE SPACE                      TO DC-OPTION-CODE.           ELC50PD
 19475     SET  BIN-TO-GREG                TO TRUE.                     ELC50PD
 19476     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 19477     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.              ELC50PD
 19478                                                                  ELC50PD
 19479     GO TO 4550-CONT-CERT-PROCESS.                                ELC50PD
 19480                                                                  ELC50PD
 19481******************************************************************ELC50PD
 19482*    END FOR 'MON' CODE FOR MEMBER NO.                           *ELC50PD
 19483******************************************************************ELC50PD
 19484                                                                  ELC50PD
 19485 4540-BUILD-MEMBER-NO.                                            ELC50PD
 19486                                                                  ELC50PD
 19487     IF PB-I-MEMBER-NO  = SPACES OR ZERO                          ELC50PD
 19488         MOVE PB-SV-STATE            TO CM-MEMB-STATE             ELC50PD
 19489         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT           ELC50PD
 19490         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 353
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19491         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5    ELC50PD
 19492     ELSE                                                         ELC50PD
 19493         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.             ELC50PD
 19494                                                                  ELC50PD
 19495     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND                    ELC50PD
 19496        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19497         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.   ELC50PD
 19498                                                                  ELC50PD
 19499 4550-CONT-CERT-PROCESS.                                          ELC50PD
 19500                                                                  ELC50PD
 19501*    IF PB-I-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 19502*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO          ELC50PD
 19503*    ELSE                                                         ELC50PD
 19504*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.         ELC50PD
 19505                                                                  ELC50PD
 19506     IF CERT-WAS-CREATED-FOR-CLAIM                                ELC50PD
 19507        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19508        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.   ELC50PD
 19509                                                                  ELC50PD
 19510     IF CERT-AND-CLAIM-ONLINE                                     ELC50PD
 19511        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19512        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.  ELC50PD
 19513                                                                  ELC50PD
 19514     MOVE 'CM'                     TO CM-RECORD-ID.               ELC50PD
 19515     MOVE LOW-VALUES               TO CM-STATUS-DATA.             ELC50PD
 19516                                                                  ELC50PD
 19517     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE             ELC50PD
 19518        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW     ELC50PD
 19519        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT   ELC50PD
 19520     ELSE                                                         ELC50PD
 19521        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW        ELC50PD
 19522        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.     ELC50PD
 19523                                                                  ELC50PD
 19524     MOVE ZERO                     TO CM-LOAN-BALANCE.            ELC50PD
 19525     MOVE '1'                      TO CM-PREMIUM-TYPE.            ELC50PD
 19526     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.       ELC50PD
 19527     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.       ELC50PD
 19528     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.      ELC50PD
 19529     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.             ELC50PD
 19530     MOVE ZEROS                    TO CM-LF-REMAINING-AMT         ELC50PD
 19531                                      CM-LF-ITD-CANCEL-AMT        ELC50PD
 19532                                      CM-LF-ITD-DEATH-AMT         ELC50PD
 19533                                      CM-AH-ITD-AH-PMT            ELC50PD
 19534                                      CM-AH-ITD-LUMP-PMT          ELC50PD
 19535                                      CM-AH-ITD-CANCEL-AMT        ELC50PD
 19536                                      CM-LF-NSP-PREMIUM-AMT       ELC50PD
 19537                                      CM-AH-NSP-PREMIUM-AMT.      ELC50PD
 19538*                                     CM-CLAIM-DEDUCT-WITHHELD    ELC50PD
 19539*                                     CM-CANCEL-DEDUCT-WITHHELD.  ELC50PD
 19540     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.                ELC50PD
 19541     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.           ELC50PD
 19542     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.              ELC50PD
 19543     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.                ELC50PD
 19544     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.             ELC50PD
 19545     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.             ELC50PD
 19546     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.              ELC50PD
 19547     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.              ELC50PD
 19548     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 354
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19549     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.             ELC50PD
 19550     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.               ELC50PD
 19551     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.         ELC50PD
 19552                                                                  ELC50PD
 19553     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 19554         MOVE ZERO                 TO PB-I-LIVES.                 ELC50PD
 19555                                                                  ELC50PD
 19556     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 19557         MOVE ZERO                 TO PB-I-NUM-BILLED.            ELC50PD
 19558                                                                  ELC50PD
 19559     MOVE PB-I-LIVES               TO CM-LIVES.                   ELC50PD
 19560     MOVE PB-I-NUM-BILLED          TO CM-BILLED.                  ELC50PD
 19561                                                                  ELC50PD
 19562     IF PB-COMPANY-ID EQUAL  'DMD'                                ELC50PD
 19563         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE       ELC50PD
 19564         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.           ELC50PD
 19565                                                                  ELC50PD
 19566     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.           ELC50PD
 19567     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.            ELC50PD
 19568     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.      ELC50PD
 19569     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.          ELC50PD
 19570     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.      ELC50PD
 19571     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 19572                                                                  ELC50PD
 19573     IF PB-I-LF-POLICY-FEE NUMERIC                                ELC50PD
 19574        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE            ELC50PD
 19575     ELSE                                                         ELC50PD
 19576        MOVE +0                    TO CM-LF-POLICY-FEE.           ELC50PD
 19577                                                                  ELC50PD
 19578     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19579        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT           ELC50PD
 19580        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT       ELC50PD
 19581     ELSE                                                         ELC50PD
 19582        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.          ELC50PD
 19583                                                                  ELC50PD
 19584     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.        ELC50PD
 19585     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.    ELC50PD
 19586     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.        ELC50PD
 19587     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.      ELC50PD
 19588     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.       ELC50PD
 19589     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.           ELC50PD
 19590     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.            ELC50PD
 19591     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.          ELC50PD
 19592     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 19593                                                                  ELC50PD
 19594     IF PB-I-AH-POLICY-FEE NUMERIC                                ELC50PD
 19595        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE            ELC50PD
 19596     ELSE                                                         ELC50PD
 19597        MOVE +0                    TO CM-AH-POLICY-FEE.           ELC50PD
 19598                                                                  ELC50PD
 19599     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 19600        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT           ELC50PD
 19601     ELSE                                                         ELC50PD
 19602        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.          ELC50PD
 19603                                                                  ELC50PD
 19604     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.      ELC50PD
 19605     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.       ELC50PD
 19606                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 355
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19607     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT          ELC50PD
 19608                                      CM-LF-DEATH-EXIT-DT         ELC50PD
 19609                                      CM-AH-SETTLEMENT-EXIT-DT.   ELC50PD
 19610                                                                  ELC50PD
 19611*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR                ELC50PD
 19612*                       'TIH' OR 'OFL' OR 'FLA' OR                ELC50PD
 19613*                       'TII' OR 'TMS' OR 'CRI' OR                ELC50PD
 19614*                       'NCL'                                     ELC50PD
 19615     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 19616                                                                  ELC50PD
 19617     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND                 ELC50PD
 19618         IF WS-LF-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19619            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19620                                                                  ELC50PD
 19621     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND                   ELC50PD
 19622         IF WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19623            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19624                                                                  ELC50PD
 19625     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 19626         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS         ELC50PD
 19627     ELSE                                                         ELC50PD
 19628         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS         ELC50PD
 19629         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.     ELC50PD
 19630                                                                  ELC50PD
 19631     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.           ELC50PD
 19632     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.           ELC50PD
 19633     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.         ELC50PD
 19634     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.            ELC50PD
 19635     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.            ELC50PD
 19636     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.             ELC50PD
 19637     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.      ELC50PD
 19638     MOVE SPACE                     TO CM-PAYMENT-MODE.           ELC50PD
 19639                                                                  ELC50PD
 19640     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 19641         MOVE SPACE                 TO CM-SKIP-CODE               ELC50PD
 19642     ELSE                                                         ELC50PD
 19643         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.              ELC50PD
 19644                                                                  ELC50PD
 19645     MOVE '2'                       TO CM-LF-CURRENT-STATUS.      ELC50PD
 19646     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH      ELC50PD
 19647                                       CM-LF-STATUS-AT-CANCEL.    ELC50PD
 19648                                                                  ELC50PD
 19649     MOVE '2'                       TO CM-AH-CURRENT-STATUS.      ELC50PD
 19650     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT ELC50PD
 19651                                       CM-AH-STATUS-AT-CANCEL.    ELC50PD
 19652                                                                  ELC50PD
 19653     MOVE '1'                       TO CM-ENTRY-STATUS.           ELC50PD
 19654                                                                  ELC50PD
 19655     IF PB-REISSUED-CERT                                          ELC50PD
 19656        MOVE '5'                    TO CM-ENTRY-STATUS.           ELC50PD
 19657                                                                  ELC50PD
 19658     IF PB-MONTHLY-CERT                                           ELC50PD
 19659        MOVE 'M'                    TO CM-ENTRY-STATUS.           ELC50PD
 19660                                                                  ELC50PD
 19661     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 19662     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 19663     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 19664        MOVE 'D'                    TO CM-ENTRY-STATUS.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 356
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19665                                                                  ELC50PD
 19666     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 19667        MOVE 'V'                    TO CM-ENTRY-STATUS.           ELC50PD
 19668                                                                  ELC50PD
 19669     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 19670        MOVE 'U'                    TO CM-ENTRY-STATUS.           ELC50PD
 19671                                                                  ELC50PD
 19672     IF PB-REIN-ONLY-CERT                                         ELC50PD
 19673        MOVE '9'                    TO CM-ENTRY-STATUS.           ELC50PD
 19674                                                                  ELC50PD
 19675     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'                  ELC50PD
 19676         MOVE 'Y'                   TO CM-UNDERWRITING-CODE       ELC50PD
 19677     ELSE                                                         ELC50PD
 19678         MOVE SPACE                 TO CM-UNDERWRITING-CODE.      ELC50PD
 19679                                                                  ELC50PD
 19680     IF PB-RECORD-RETURNED                                        ELC50PD
 19681        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1   ELC50PD
 19682      ELSE                                                        ELC50PD
 19683        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.  ELC50PD
 19684                                                                  ELC50PD
 19685     IF PB-I-MAIL-ADDRS-PRESENT                                   ELC50PD
 19686        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.     ELC50PD
 19687                                                                  ELC50PD
 19688     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END          ELC50PD
 19689                                       CM-ENTRY-DT.               ELC50PD
 19690                                                                  ELC50PD
 19691 4999-EXIT.                                                       ELC50PD
 19692     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 357
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19694                                                                  ELC50PD
 19695 5000-PROCESS-REPS.
 19696
 19697     MOVE ' '                    TO AGTC-MASTER-SW
 19698     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 19699     MOVE CO-TYPE                TO AGTC-TYPE
 19700     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 19701     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 19702
 19703     IF (AGTC-MASTER-SW NOT = 'N')
 19704        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 19705        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 19706        PERFORM 8583-READ-ERAGTC-NEXT
 19707                                 THRU 8583-EXIT
 19708     END-IF
 19709
 19710     IF AGTC-MASTER-SW = 'N'
 19711        CONTINUE
 19712     ELSE
 19713        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 19714           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 19715              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 19716              MOVE 'Y'           TO AGTC-MASTER-SW
 19717           END-IF
 19718        END-IF
 19719     END-IF
 19720
 19721     .
 19722 5000-EXIT.
 19723     EXIT.
 19724
 19725
 19726 6370-EDIT-INPUT-LF-CODE.                                         ELC50PD
 19727     IF WK-LIFE-EDIT-ADDR NOT = ZEROS                             ELC50PD
 19728        MOVE +1                  TO SUB                           ELC50PD
 19729        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 19730        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19731        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19732        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19733        GO TO 6370-SEARCH-LOOP.                                   ELC50PD
 19734                                                                  ELC50PD
 19735     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19736                                                                  ELC50PD
 19737     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19738     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19739*    MOVE 'L'                    TO CNTL-REC-TYPE.                ELC50PD
 19740     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.                ELC50PD
 19741     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19742     MOVE '4' TO RC-SW-2.                                         ELC50PD
 19743     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19744                                                                  ELC50PD
 19745     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19746        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19747        GO TO 6370-NO-LF-FOUND.                                   ELC50PD
 19748                                                                  ELC50PD
 19749     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.            ELC50PD
 19750     MOVE +1                     TO SUB.                          ELC50PD
 19751                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 358
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19752 6370-SEARCH-LOOP.                                                ELC50PD
 19753     IF CF-LIFE-CODE-OUT (SUB) = ZEROS                            ELC50PD
 19754         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19755                                                                  ELC50PD
 19756     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)                  ELC50PD
 19757         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD        ELC50PD
 19758         GO TO 6370-HER-NET-PAY-CHECK.                            ELC50PD
 19759                                                                  ELC50PD
 19760     ADD 1   TO SUB.                                              ELC50PD
 19761*    IF SUB GREATER 120                                           ELC50PD
 19762     IF SUB GREATER 200                                           ELC50PD
 19763         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19764                                                                  ELC50PD
 19765     GO TO 6370-SEARCH-LOOP.                                      ELC50PD
 19766                                                                  ELC50PD
 19767 6370-NO-LF-FOUND.                                                ELC50PD
 19768                                                                  ELC50PD
 19769     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19770                                                                  ELC50PD
 19771 6370-HER-NET-PAY-CHECK.                                          ELC50PD
 19772                                                                  ELC50PD
 19773     IF PB-COMPANY-ID = 'CID'
 19774        IF PB-SV-STATE = 'CA' OR 'MN'
 19775           IF PB-I-LF-BENEFIT-CD = '02'
 19776              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 19777           ELSE
 19778              IF PB-I-LF-BENEFIT-CD = '04'
 19779                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 19780              END-IF
 19781           END-IF
 19782        END-IF
 19783     END-IF
 19784
 19785     IF PB-COMPANY-ID NOT = 'HER'                                 ELC50PD
 19786         GO TO 6370-EXIT.                                         ELC50PD
 19787                                                                  ELC50PD
 19788     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'                  ELC50PD
 19789         GO TO 6370-EXIT.                                         ELC50PD
 19790                                                                  ELC50PD
 19791     IF PB-I-LF-TERM NOT NUMERIC                                  ELC50PD
 19792         MOVE ZEROS              TO PB-I-LF-TERM.                 ELC50PD
 19793                                                                  ELC50PD
 19794     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 19795         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 19796                                                                  ELC50PD
 19797     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM                  ELC50PD
 19798         GO TO 6370-EXIT.                                         ELC50PD
 19799                                                                  ELC50PD
 19800     IF PB-I-LF-BENEFIT-CD = '33'                                 ELC50PD
 19801         MOVE '31'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19802                                                                  ELC50PD
 19803     IF PB-I-LF-BENEFIT-CD = '34'                                 ELC50PD
 19804         MOVE '32'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19805                                                                  ELC50PD
 19806 6370-EXIT.                                                       ELC50PD
 19807     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 359
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19809                                                                  ELC50PD
 19810 6380-EDIT-INPUT-AH-CODE.                                         ELC50PD
 19811     IF WK-AH-EDIT-ADDR NOT = ZEROS                               ELC50PD
 19812        MOVE +1                  TO SUB                           ELC50PD
 19813        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 19814        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19815        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19816        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19817        GO TO 6380-SEARCH-LOOP.                                   ELC50PD
 19818                                                                  ELC50PD
 19819     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19820                                                                  ELC50PD
 19821     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19822     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19823     MOVE 'A'                    TO CNTL-REC-TYPE.                ELC50PD
 19824*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.                ELC50PD
 19825     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19826     MOVE '5' TO RC-SW-2.                                         ELC50PD
 19827     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19828                                                                  ELC50PD
 19829     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19830        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19831        GO TO 6380-NO-AH-FOUND.                                   ELC50PD
 19832                                                                  ELC50PD
 19833     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.              ELC50PD
 19834     MOVE +1 TO SUB.                                              ELC50PD
 19835                                                                  ELC50PD
 19836 6380-SEARCH-LOOP.                                                ELC50PD
 19837     IF CF-AH-CODE-OUT (SUB) = ZEROS                              ELC50PD
 19838         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19839                                                                  ELC50PD
 19840     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)                    ELC50PD
 19841         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD          ELC50PD
 19842         GO TO 6380-CSO-AH-ONLY-CHECKS.                           ELC50PD
 19843                                                                  ELC50PD
 19844     ADD 1   TO SUB.                                              ELC50PD
 19845     IF SUB GREATER THAN 96                                       ELC50PD
 19846*    IF SUB GREATER THAN 300                                      ELC50PD
 19847         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19848                                                                  ELC50PD
 19849     GO TO 6380-SEARCH-LOOP.                                      ELC50PD
 19850                                                                  ELC50PD
 19851 6380-NO-AH-FOUND.                                                ELC50PD
 19852                                                                  ELC50PD
 19853     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.               ELC50PD
 19854                                                                  ELC50PD
 19855     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE                        ELC50PD
 19856         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD            ELC50PD
 19857     ELSE                                                         ELC50PD
 19858         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.           ELC50PD
 19859                                                                  ELC50PD
 19860 6380-CSO-AH-ONLY-CHECKS.                                         ELC50PD
 19861                                                                  ELC50PD
 19862     IF PB-COMPANY-ID = 'CSO' OR 'CID'                            ELC50PD
 19863        NEXT SENTENCE                                             ELC50PD
 19864      ELSE                                                        ELC50PD
 19865        GO TO 6380-EXIT.                                          ELC50PD
 19866                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 360
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19867     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS                 ELC50PD
 19868         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.                      ELC50PD
 19869                                                                  ELC50PD
 19870                                                                  00041198
 19871     GO TO 6380-EXIT                                              00041198
 19872     .
 19873 6380-CSO-LIFE-WITH-AH-CHECKS.                                    00041202
 19874                                                                  00041203
 19875                                                                  ELC50PD
 19876     .                                                            ELC50PD
 19877 6380-EXIT.                                                       ELC50PD
 19878     EXIT.                                                        ELC50PD
 19879                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 361
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19881                                                                  ELC50PD
 19882 6400-COMPUTE-EXTENSION-DAYS.                                     ELC50PD
 19883                                                                  ELC50PD
 19884******************************************************************ELC50PD
 19885*                                                                *ELC50PD
 19886*                   COMPUTE EXTENSION DAYS                       *ELC50PD
 19887*                                                                *ELC50PD
 19888*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *ELC50PD
 19889*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *ELC50PD
 19890*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *ELC50PD
 19891*    THE EXTENSION DAYS.                                         *ELC50PD
 19892*                                                                *ELC50PD
 19893******************************************************************ELC50PD
 19894                                                                  ELC50PD
 19895     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.            ELC50PD
 19896     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.            ELC50PD
 19897                                                                  ELC50PD
 19898******************************************************************ELC50PD
 19899*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *ELC50PD
 19900*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*ELC50PD
 19901******************************************************************ELC50PD
 19902                                                                  ELC50PD
 19903     IF DC-ELAPSED-MONTHS GREATER THAN +0                         ELC50PD
 19904        COMPUTE WS-ODD-DAYS-OVER =                                ELC50PD
 19905               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER  ELC50PD
 19906     ELSE                                                         ELC50PD
 19907        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.             ELC50PD
 19908                                                                  ELC50PD
 19909     IF WS-ODD-DAYS-OVER = ZEROS                                  ELC50PD
 19910           GO TO 6499-EXIT                                        ELC50PD
 19911     ELSE                                                         ELC50PD
 19912        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY                     ELC50PD
 19913           IF WS-WDF-MONTH = 02                                   ELC50PD
 19914              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT         ELC50PD
 19915              ADD 2       TO  WS-ODD-DAYS-OVER                    ELC50PD
 19916              GO TO 6499-EXIT                                     ELC50PD
 19917           ELSE                                                   ELC50PD
 19918              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31    ELC50PD
 19919                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER                 ELC50PD
 19920                 GO TO 6499-EXIT                                  ELC50PD
 19921               ELSE                                               ELC50PD
 19922                 GO TO 6499-EXIT                                  ELC50PD
 19923        ELSE                                                      ELC50PD
 19924           GO TO 6499-EXIT.                                       ELC50PD
 19925                                                                  ELC50PD
 19926 6412-CHECK-TO-DAY.                                               ELC50PD
 19927                                                                  ELC50PD
 19928        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0         ELC50PD
 19929           IF WS-WDT-DAY = 28                                     ELC50PD
 19930              ADD 2              TO WS-ODD-DAYS-OVER              ELC50PD
 19931           ELSE                                                   ELC50PD
 19932              IF WS-WDT-DAY = 29                                  ELC50PD
 19933                 ADD 1           TO WS-ODD-DAYS-OVER              ELC50PD
 19934              ELSE                                                ELC50PD
 19935                 NEXT SENTENCE                                    ELC50PD
 19936        ELSE                                                      ELC50PD
 19937           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0        ELC50PD
 19938              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 362
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19939                                                                  ELC50PD
 19940     GO TO 6499-EXIT.                                             ELC50PD
 19941                                                                  ELC50PD
 19942                                                                  ELC50PD
 19943 6415-CHECK-LEAP-YEAR.                                            ELC50PD
 19944                                                                  ELC50PD
 19945     IF DC-DAYS-IN-MONTH = 29                                     ELC50PD
 19946        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.                         ELC50PD
 19947                                                                  ELC50PD
 19948 6415-EXIT.                                                       ELC50PD
 19949     EXIT.                                                        ELC50PD
 19950                                                                  ELC50PD
 19951 6499-EXIT.                                                       ELC50PD
 19952      EXIT.                                                       ELC50PD
 19953                                                                  ELC50PD
 19954 6500-END.                                                        ELC50PD
 19955     EXIT.
 19956
 19957                                                                  ELC50PD
 19958******************************************************************ELC50PD
 19959************* PROCEDURE DIVISION FOR EL050 ***********************ELC50PD
 19960********************** ELC50PD END *******************************ELC50PD
 19961                                                                  ELC50PD
 19962*
 19963*
 19964**START***********************************************************
 19965*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 19966*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT
 19967******************************************************************
 19968*
 19969 6600-GET-STATE-MUNICIPAL-TAX.
 19970
 19971     IF PB-COMPANY-ID NOT = 'DMD'
 19972         GO TO 6640-EXIT.
 19973
 19974     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19975     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19976     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19977
 19978*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19979     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19980     MOVE SPACES TO DC-ALPHA-CENTURY.
 19981     SET BIN-TO-GREG          TO TRUE.
 19982     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19983
 19984     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 19985     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 19986
 19987     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 19988     MOVE WS-ERRESS-KEY       TO ERRESS-PRIMARY-KEY
 19989                                 WS-SAVE-ERRESS-KEY.
 19990
 19991*POSITION FILE AT STARTING KEY RECORD(COMPANY, STATE, CATEGORY)
 19992*WANT RECORD WITH RES-EXPIRE-DT GREATER THAN PB-CERT-EFF-DT
 19993
 19994     START ERRESS KEY NOT LESS THAN ERRESS-PRIMARY-KEY.
 19995
 19996     IF ERRESS-FILE-STATUS NOT EQUAL '00'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 363
* EL517.cbl
 19997         MOVE ER-8002        TO WS-ERROR
 19998         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19999         GO TO 6640-EXIT.
 20000
 20001*GET RECORD WHERE POSITIONED
 20002
 20003 6600-READ-ERRESS-NEXT.
 20004     READ ERRESS NEXT RECORD.
 20005
 20006     IF ERRESS-FILE-STATUS NOT EQUAL '00'
 20007         MOVE ER-8002        TO WS-ERROR
 20008         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20009         GO TO 6640-EXIT.
 20010
 20011*GOT GOOD RECORD ??    FIRST 4 POSITIONS MUST MATCH
 20012
 20013     IF ERRESS-PRIMARY-KEY (1:4) = WS-SAVE-ERRESS-KEY (1:4)
 20014        NEXT SENTENCE
 20015     ELSE
 20016        MOVE ER-8002        TO WS-ERROR
 20017        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20018        GO TO 6640-EXIT.
 20019
 20020     IF WS-CONTRACT-DATE LESS THAN RES-EXPIRE-DATE
 20021        NEXT SENTENCE
 20022     ELSE
 20023        GO TO 6600-READ-ERRESS-NEXT.
 20024
 20025*IS IT LIFE(1) OR IS IT P&C(2) ?????
 20026*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA
 20027
 20028     MOVE +2                     TO WS-SUB1.
 20029
 20030     IF PB-CANCELLATION
 20031        IF PB-C-POLICY-FORM-NO (6:1) = '1'
 20032           MOVE +1               TO WS-SUB1.
 20033
 20034     IF PB-ISSUE
 20035        IF PB-I-POLICY-FORM-NO (6:1) = '1'
 20036           MOVE +1               TO WS-SUB1.
 20037
 20038*
 20039*CONVERT ANNIVERSARY DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 20040*
 20041     MOVE AM-AN-MO            TO WS-NEXT-CONTRACT-DATE (5:2).
 20042     MOVE AM-AN-DA            TO WS-NEXT-CONTRACT-DATE (7:2).
 20043     MOVE AM-AN-YR            TO WS-NEXT-CONTRACT-DATE (3:2).
 20044     MOVE AM-AN-CC            TO WS-NEXT-CONTRACT-DATE (1:2).
 20045
 20046
 20047*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 20048*TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 20049*TEST IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APPLIES
 20050
 20051     ADD 1                    TO WS-YEAR-YY.
 20052
 20053     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 20054         MOVE RES-REN-STATE-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 364
* EL517.cbl
 20055                              TO WS-RES-STATE-TAX
 20056         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
 20057                              TO WS-RES-MUNI-TAX
 20058     ELSE
 20059         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 20060                              TO WS-RES-STATE-TAX
 20061         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 20062                              TO WS-RES-MUNI-TAX.
 20063
 20064*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 20065
 20066     IF PB-CANCELLATION
 20067         GO TO 6640-CANCEL-TAX.
 20068
 20069     IF PB-I-LF-PREMIUM-AMT > ZEROS
 20070          COMPUTE PB-I-STATE-TAX ROUNDED =
 20071                                    PB-I-LF-PREMIUM-AMT
 20072                                  * WS-RES-STATE-TAX
 20073          COMPUTE PB-I-MUNI-TAX ROUNDED =
 20074                                    PB-I-LF-PREMIUM-AMT
 20075                                  * WS-RES-MUNI-TAX
 20076     ELSE
 20077     IF PB-I-AH-PREMIUM-AMT > ZEROS
 20078          COMPUTE PB-I-STATE-TAX ROUNDED =
 20079                                    PB-I-AH-PREMIUM-AMT
 20080                                  * WS-RES-STATE-TAX
 20081          COMPUTE PB-I-MUNI-TAX ROUNDED =
 20082                                    PB-I-AH-PREMIUM-AMT
 20083                                  * WS-RES-MUNI-TAX.
 20084
 20085     GO TO 6640-EXIT.
 20086
 20087 6640-CANCEL-TAX.
 20088     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 20089
 20090     IF PB-C-LF-CANCEL-AMT > ZEROS
 20091          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20092                                    PB-C-LF-CANCEL-AMT
 20093                                  * WS-RES-STATE-TAX
 20094          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20095                                    PB-C-LF-CANCEL-AMT
 20096                                  * WS-RES-MUNI-TAX
 20097     ELSE
 20098     IF PB-C-AH-CANCEL-AMT > ZEROS
 20099          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20100                                    PB-C-AH-CANCEL-AMT
 20101                                  * WS-RES-STATE-TAX
 20102          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20103                                    PB-C-AH-CANCEL-AMT
 20104                                  * WS-RES-MUNI-TAX.
 20105
 20106 6640-EXIT.
 20107     EXIT.
 20108
 20109 6650-GET-RES-STATE-COMM.
 20110
 20111     IF PB-COMPANY-ID NOT = 'DMD'
 20112         GO TO 6700-COMM-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 365
* EL517.cbl
 20113
 20114     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 20115     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 20116     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 20117     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 20118     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 20119     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 20120     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 20121
 20122*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 20123
 20124     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 20125     MOVE SPACES              TO DC-ALPHA-CENTURY.
 20126     SET BIN-TO-GREG          TO TRUE.
 20127     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 20128
 20129     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20130     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20131
 20132     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 20133
 20134*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, ST,
 20135*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 20136*VALUE OF PB-CERT-EFF-DT
 20137
 20138     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
 20139     START ERRESC KEY NOT LESS THAN ERRESC-RECORD-KEY.
 20140
 20141     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20142         GO TO 6700-COMM-EXIT.
 20143
 20144*GET RECORD WHERE POSITIONED
 20145
 20146 6650-READ-ERRESC-NEXT.
 20147     READ ERRESC NEXT RECORD.
 20148
 20149     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20150         GO TO 6700-COMM-EXIT.
 20151
 20152     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 20153        NEXT SENTENCE
 20154     ELSE
 20155         GO TO 6700-COMM-EXIT.
 20156
 20157     IF WS-CONTRACT-DATE IS LESS THAN RESC-EXPIRE-DATE
 20158         NEXT SENTENCE
 20159       ELSE
 20160         GO TO 6650-READ-ERRESC-NEXT.
 20161
 20162*CHECK IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT RESIDENT ST
 20163*COMMISSION RECORD'S EFFECTIVE TIME PERIOD??
 20164
 20165     IF WS-CONTRACT-DATE IS LESS THAN RESC-EFFECTIVE-DATE
 20166         GO TO 6700-COMM-EXIT.
 20167
 20168* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 20169
 20170     MOVE ZEROS               TO WS-SUB WS-SUB1.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 366
* EL517.cbl
 20171
 20172     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 20173
 20174     IF WS-SUB1 > ZERO
 20175         IF RESC-COMMISSION-TAB (WS-SUB) NUMERIC
 20176             PERFORM 6680-SET-COMMISSION
 20177         ELSE
 20178             PERFORM 6680-SET-TABLE-CODE.
 20179
 20180     GO TO 6700-COMM-EXIT.
 20181
 20182 6680-SET-TABLE-CODE.
 20183     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 20184        MOVE ZEROS             TO WS-SUB1
 20185     ELSE
 20186* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 20187* TO COMPUTE AH COMMISSION.
 20188        MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 20189        MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 20190        MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 20191        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 20192        PERFORM 6680-READ-CTBL-TABLE
 20193        IF ERCTBL-FILE-STATUS NOT = '00'
 20194           MOVE ZEROS          TO WS-SUB1.
 20195
 20196 6680-READ-CTBL-TABLE.
 20197*
 20198* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 20199* TO COMPUTE LIFE COMMISSION
 20200
 20201     IF CTBL-SW = '0540'
 20202        MOVE WS-LF-COMP-CD     TO CTBL-BEN-CODE
 20203        MOVE PB-I-LF-TERM      TO WS-WORK-TERM
 20204        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 20205
 20206     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 20207
 20208     IF CTBL-TABLE-FOUND
 20209        IF CTBL-SW = '0530'
 20210             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 20211                                        PB-I-AH-TERM
 20212             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20213             MOVE WS-WK-RATE        TO WS-COMMISSION
 20214                                       PB-I-AH-COMMISSION
 20215        ELSE
 20216             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 20217             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20218             MOVE WS-WK-RATE        TO WS-COMMISSION
 20219                                       PB-I-LIFE-COMMISSION
 20220     ELSE
 20221        IF FIRST-TIME-THROUGH
 20222            GO TO 6680-READ-CTBL-TABLE
 20223        ELSE
 20224            MOVE ZEROS         TO WS-SUB1.
 20225
 20226 6680-SET-COMMISSION.
 20227     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 20228           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 367
* EL517.cbl
 20229       ELSE
 20230           MOVE RESC-COMMISSION-PER (WS-SUB)
 20231                             TO WS-COMMISSION
 20232           IF CTBL-SW = '0540'
 20233               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION
 20234           ELSE
 20235               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION.
 20236
 20237 6680-SEARCH-CATEGORY.
 20238     ADD +1                   TO WS-SUB.
 20239     IF WS-SUB > +12
 20240         GO TO 6680-EXIT.
 20241
 20242     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 20243          MOVE WS-SUB         TO WS-SUB1
 20244          GO TO 6680-EXIT.
 20245
 20246     GO TO 6680-SEARCH-CATEGORY.
 20247
 20248 6680-EXIT.
 20249     EXIT.
 20250
 20251 6700-COMM-EXIT.
 20252     EXIT.
 20253**END*************************************************************
 20254*      CUSTOM CODING FOR CLIENT "DMD"
 20255******************************************************************
 20256*
 20257 7000-GET-RATE.
 20258     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 20259
 20260 7000-EXIT.
 20261     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 368
* EL517.cbl
 20263
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 369
* EL517.cbl
 20265 7100-FIND-BENEFIT-IN-STATE.
 20266     MOVE 'N'                    TO BEN-SEARCH-SW.
 20267
 20268     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 20269         VARYING SUB3 FROM 1 BY 1 UNTIL
 20270            ((SUB3 GREATER 50) OR
 20271              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 20272               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 20273
 20274     IF SUB3 NOT = 51
 20275         IF CF-ST-BENEFIT-CD (SUB3) NOT = '00'
 20276             MOVE 'Y'            TO BEN-SEARCH-SW.
 20277
 20278     GO TO 7199-EXIT.
 20279
 20280 7100-BENEFIT-DUMMY.
 20281
 20282 7100-DUMMY-EXIT.
 20283     EXIT.
 20284
 20285 7199-EXIT.
 20286     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 370
* EL517.cbl
 20288 7200-FIND-BENEFIT.
 20289     MOVE 'N'                    TO BEN-SEARCH-SW.
 20290
 20291     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 20292         VARYING SUB3 FROM 1 BY 1 UNTIL
 20293            ((SUB3 GREATER 8) OR
 20294            (CF-BENEFIT-CODE (SUB3) = WS-BEN-CD)).
 20295
 20296     IF SUB3 NOT = 9
 20297         MOVE 'Y'                TO BEN-SEARCH-SW.
 20298
 20299     GO TO 7200-EXIT.
 20300
 20301 7200-BENEFIT-DUMMY.
 20302
 20303     EXIT.
 20304 7200-DUMMY-EXIT.
 20305     EXIT.
 20306
 20307 7200-EXIT.
 20308     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 371
* EL517.cbl
 20310 7250-LOOK-FOR-RESCINDED-CLAIM.
 20311
 20312     IF ELMSTR-OPEN = ' '
 20313         OPEN INPUT ELMSTR
 20314         MOVE 'X'                TO ELMSTR-OPEN
 20315         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20316             NEXT SENTENCE
 20317         ELSE
 20318             MOVE ELMSTR-FILE-STATUS
 20319                                 TO WS-ABEND-FILE-STATUS
 20320             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20321             MOVE EMSG           TO WS-ABEND-MESSAGE
 20322             GO TO ABEND-PGM.
 20323
 20324     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20325                                    W-CL-COMP-CD.
 20326     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20327                                    W-CL-CERT-NO.
 20328     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20329
 20330     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20331
 20332     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20333         GO TO 7250-EXIT.
 20334
 20335     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20336         GO TO 7250-CLAIMS-ERROR.
 20337
 20338 7250-NEXT-CLAIM.
 20339
 20340     READ ELMSTR NEXT.
 20341
 20342     IF ELMSTR-FILE-STATUS = '10'
 20343         GO TO 7250-EXIT.
 20344
 20345     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20346         GO TO 7250-CLAIMS-ERROR.
 20347
 20348     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20349        MSTR-CERT-NO NOT = CL-CERT-NO-A4
 20350         GO TO 7250-EXIT.
 20351
 20352     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20353        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20354        PB-SV-STATE    NOT = CL-CERT-STATE    OR
 20355        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20356        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20357         GO TO 7250-NEXT-CLAIM.
 20358
 20359     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20360        OR (CL-CLAIM-TYPE = 'I')
 20361        OR (CL-CLAIM-TYPE = 'G')
 20362          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20363              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 20364              GO TO 7250-EXIT
 20365          END-IF
 20366     END-IF.
 20367
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 372
* EL517.cbl
 20368     GO TO 7250-NEXT-CLAIM.
 20369
 20370 7250-CLAIMS-ERROR.
 20371
 20372     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20373     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20374     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20375     GO TO ABEND-PGM.
 20376
 20377 7250-EXIT.
 20378     EXIT.
 20379 7300-CHECK-FOR-OPEN-CLMS.
 20380
 20381     IF ELMSTR-OPEN = ' '
 20382         OPEN INPUT ELMSTR
 20383         MOVE 'X'                TO ELMSTR-OPEN
 20384         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20385             NEXT SENTENCE
 20386         ELSE
 20387             MOVE ELMSTR-FILE-STATUS
 20388                                 TO WS-ABEND-FILE-STATUS
 20389             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20390             MOVE EMSG           TO WS-ABEND-MESSAGE
 20391             GO TO ABEND-PGM.
 20392
 20393     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20394                                    W-CL-COMP-CD.
 20395     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20396                                    W-CL-CERT-NO.
 20397     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20398
 20399     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20400
 20401     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20402         GO TO 7300-EXIT.
 20403
 20404     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20405         GO TO 7300-CLAIMS-ERROR.
 20406
 20407     MOVE 'Y'                    TO W-BROWSE-SW.
 20408
 20409 7300-NEXT-CLAIM.
 20410
 20411     READ ELMSTR NEXT.
 20412
 20413     IF ELMSTR-FILE-STATUS = '10'
 20414         GO TO 7300-EXIT.
 20415
 20416     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20417         GO TO 7300-CLAIMS-ERROR.
 20418
 20419     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20420        MSTR-CERT-NO NOT = CL-CERT-NO-A4
 20421         GO TO 7300-EXIT.
 20422
 20423     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20424        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20425        PB-SV-STATE    NOT = CL-CERT-STATE    OR
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 373
* EL517.cbl
 20426        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20427        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20428         GO TO 7300-NEXT-CLAIM.
 20429
 20430     IF CL-CLAIM-TYPE = AH-OVERRIDE-L1
 20431        OR 'I' OR 'G'
 20432        IF CLAIM-IS-OPEN
 20433           EVALUATE TRUE
 20434             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20435                 MOVE ER-2884      TO WS-ERROR
 20436             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20437                 MOVE ER-2887      TO WS-ERROR
 20438             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20439                 MOVE ER-2886      TO WS-ERROR
 20440             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20441                 MOVE ER-2888      TO WS-ERROR
 20442             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20443                 MOVE ER-2885      TO WS-ERROR
 20444             WHEN OTHER
 20445                 MOVE ER-2768      TO WS-ERROR
 20446           END-EVALUATE
 20447           IF PB-C-AH-CANCEL-VOIDED OR
 20448              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20449                NOT AH-COVERAGE-CANCELLED)
 20450               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20451               MOVE ER-2768      TO WS-ERROR
 20452           END-IF
 20453           PERFORM 9900-ERROR-FORMAT
 20454                                 THRU 9900-EXIT
 20455           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20456              PB-FORCE-CODE NOT EQUAL '8'
 20457               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20458           END-IF
 20459           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20460           GO TO 7300-EXIT
 20461        ELSE
 20462           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20463*****THIS IS A RESCISSION OR REFORMATION
 20464              IF (AH-COVERAGE-CANCELLED AND
 20465                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 20466                    MOVE ER-2890 TO WS-ERROR
 20467                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20468                    GO TO 7300-EXIT
 20469              END-IF
 20470           ELSE
 20471              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20472               AND PB-C-AH-CANCEL-DT > SPACES
 20473                 MOVE ER-2756       TO WS-ERROR
 20474                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20475                 GO TO 7300-EXIT
 20476              END-IF
 20477           END-IF
 20478        END-IF
 20479     ELSE
 20480        IF CL-CLAIM-TYPE = LIFE-OVERRIDE-L1
 20481           IF CLAIM-IS-OPEN
 20482              MOVE ER-2889    TO WS-ERROR
 20483              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 374
* EL517.cbl
 20484              GO TO 7300-EXIT
 20485           ELSE
 20486              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20487*****THIS IS A RESCISSION OR REFORMATION
 20488                 IF (LF-COVERAGE-CANCELLED AND
 20489                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20490                       MOVE ER-2890 TO WS-ERROR
 20491                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20492                       GO TO 7300-EXIT
 20493                 END-IF
 20494              ELSE
 20495                 IF (AH-COVERAGE-CANCELLED AND
 20496                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 20497                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 20498                    (LF-COVERAGE-CANCELLED AND
 20499                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 20500                     WS-ST-REFUND-CLAIM-FLAG = '4')
 20501                       MOVE ER-2965 TO WS-ERROR
 20502                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20503                       GO TO 7300-EXIT
 20504                 END-IF
 20505                 IF LF-COVERAGE-CANCELLED
 20506                  IF CL-TOTAL-PAID-AMT > 0
 20507                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20508                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20509                        MOVE ER-2891 TO WS-ERROR
 20510                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20511                        GO TO 7300-EXIT
 20512                      END-IF
 20513                    ELSE
 20514                      MOVE ER-2892 TO WS-ERROR
 20515                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20516                      GO TO 7300-EXIT
 20517                    END-IF
 20518                  END-IF
 20519                 END-IF
 20520              END-IF
 20521           END-IF
 20522        END-IF
 20523     END-IF
 20524
 20525     GO TO 7300-NEXT-CLAIM.
 20526
 20527 7300-CLAIMS-ERROR.
 20528
 20529     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20530     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20531     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20532     GO TO ABEND-PGM.
 20533
 20534 7300-EXIT.
 20535     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 375
* EL517.cbl
 20537
 20538 7400-GET-REMAIN-TERM.
 20539     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20540
 20541 7400-EXIT.
 20542     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 376
* EL517.cbl
 20544
 20545 7500-GET-REMAIN-AMOUNT.
 20546     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 20547
 20548 7500-EXIT.
 20549     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 377
* EL517.cbl
 20551
 20552 7600-GET-REFUND.
 20553     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 20554
 20555 7600-EXIT.
 20556     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 378
* EL517.cbl
 20558
 20559 7700-CALL-DL1.
 20560     MOVE 'P'                    TO DMPF-PROCESS-TYPE.
 20561     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 20562
 20563 7700-EXIT.
 20564     EXIT.
 20565
 20566 7710-CALL-DL2.
 20567     MOVE 'P'                    TO DIPF-PROCESS-TYPE.
 20568     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 20569
 20570 7710-EXIT.
 20571     EXIT.
 20572
 20573 7720-CALL-DL3.
 20574     MOVE 'P'                    TO DVBI-PROCESS-TYPE.
 20575     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 20576
 20577 7720-EXIT.
 20578     EXIT.
 20579
 20580 7730-CALL-DL7.
 20581     MOVE 'P'                    TO DCUA-PROCESS-TYPE.
 20582     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 20583
 20584 7730-EXIT.
 20585     EXIT.
 20586
 20587 7740-CALL-DL11.
 20588     MOVE 'P'                    TO DPRB-PROCESS-TYPE.
 20589     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 20590
 20591 7740-EXIT.
 20592     EXIT.
 20593
 20594 7750-CALL-DL17.
 20595     MOVE 'P'                    TO DVRC-PROCESS-TYPE.
 20596     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 20597
 20598 7750-EXIT.
 20599     EXIT.
 20600
 20601 7755-CALL-DL19.
 20602     MOVE 'P'                    TO DOCC-PROCESS-TYPE.
 20603     CALL 'DLB019' USING  WS-DLB-ORIG-COV-CAT.
 20604
 20605 7755-EXIT.
 20606     EXIT.
 20607
 20608 7760-CALL-DL21.
 20609     CALL 'DLB021' USING  WS-DLB-VALID-LOAN-OFFICER.
 20610
 20611 7760-EXIT.
 20612     EXIT.
 20613
 20614 7770-CALL-DL22.
 20615     MOVE 'P'                    TO DVSC-PROCESS-TYPE.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 379
* EL517.cbl
 20616     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 20617
 20618 7770-EXIT.
 20619     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 380
* EL517.cbl
 20621
 20622 7800-REWRITE-CERT.
 20623     REWRITE CERTIFICATE-MASTER.
 20624     ADD 1 TO WCER.
 20625
 20626 7800-EXIT.
 20627      EXIT.
 20628     EXIT.
 20629
 20630 8000-WRITE-CERT.
 20631
 20632     WRITE CERTIFICATE-MASTER.
 20633     ADD 1 TO WCER.
 20634     IF ELCERT-FILE-STATUS NOT = '00'
 20635         GO TO 8000-FREE-MAIN.
 20636
 20637 8000-FREE-MAIN.
 20638
 20639 8000-EXIT.
 20640     EXIT.
 20641      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 381
* EL517.cbl
 20643
 20644 8100-READ-ERPNDM.
 20645     IF ERPNDM-OPEN = ' '
 20646        OPEN INPUT ERPNDM
 20647        MOVE 'X' TO ERPNDM-OPEN
 20648        IF ERPNDM-FILE-STATUS = '00' OR '97'
 20649           NEXT SENTENCE
 20650        ELSE
 20651           MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20652           MOVE 'ERPNDM'              TO WS-FEM-FILE-NAME
 20653           MOVE EMSG TO WS-ABEND-MESSAGE
 20654           GO TO ABEND-PGM.
 20655
 20656     MOVE SPACES                 TO ERPNDM-FOUND.
 20657     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20658     READ ERPNDM.
 20659
 20660     IF ERPNDM-FILE-STATUS  = '00'
 20661        CONTINUE
 20662     ELSE
 20663        MOVE 'X'                 TO ERPNDM-FOUND
 20664        MOVE ER-2694             TO WS-ERROR
 20665        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20666        MOVE ER-2883             TO WS-ERROR
 20667        PERFORM 9900-ERROR-FORMAT
 20668                                 THRU 9900-EXIT
 20669     END-IF
 20670
 20671     .
 20672 8100-EXIT.
 20673     EXIT.
 20674
 20675 8110-READ-ERMAIL.
 20676     IF ERMAIL-OPEN = ' '
 20677        OPEN  I-O ERMAIL
 20678        MOVE 'X' TO ERMAIL-OPEN
 20679        IF ERMAIL-FILE-STATUS = '00' OR '97'
 20680           NEXT SENTENCE
 20681        ELSE
 20682            MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20683            MOVE 'ERMAIL'              TO WS-FEM-FILE-NAME
 20684            MOVE EMSG TO WS-ABEND-MESSAGE
 20685            GO TO ABEND-PGM.
 20686
 20687     MOVE SPACES                 TO ERMAIL-FOUND.
 20688     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20689     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20690     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20691     MOVE PB-SV-STATE            TO MA-STATE.
 20692
 20693     READ ERMAIL.
 20694
 20695     IF ERMAIL-FILE-STATUS  = '00'
 20696         NEXT SENTENCE
 20697       ELSE
 20698        MOVE 'X'                 TO ERMAIL-FOUND.
 20699
 20700 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 382
* EL517.cbl
 20701     EXIT.
 20702
 20703 8120-REWRITE-ERMAIL.
 20704     REWRITE MAILING-DATA.
 20705
 20706 8120-EXIT.
 20707     EXIT.
 20708
 20709 8130-WRITE-ERMAIL.
 20710     WRITE MAILING-DATA.
 20711
 20712 8130-EXIT.
 20713     EXIT.
 20714
 20715 8140-UNLOCK-ERMAIL.
 20716     MOVE SPACES                 TO ERMAIL-FOUND.
 20717
 20718 8140-EXIT.
 20719     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 383
* EL517.cbl
 20721
 20722 8180-UPDATE-VIN-NUMBER.
 20723
 20724     IF ELCRTT-OPEN = ' '
 20725         OPEN I-O ELCRTT
 20726         MOVE 'X' TO ELCRTT-OPEN
 20727         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20728             NEXT SENTENCE
 20729         ELSE
 20730             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20731             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20732             MOVE EMSG               TO WS-ABEND-MESSAGE
 20733             GO TO ABEND-PGM
 20734         END-IF
 20735     END-IF.
 20736
 20737     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20738     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20739     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20740
 20741     READ ELCRTT.
 20742
 20743     IF ELCRTT-FILE-STATUS  = '00'
 20744        CONTINUE
 20745     ELSE
 20746        GO TO 8180-NOTFND
 20747     END-IF.
 20748
 20749     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20750         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20751         REWRITE CERTIFICATE-TRAILERS
 20752     END-IF.
 20753
 20754     GO TO 8180-EXIT.
 20755
 20756 8180-NOTFND.
 20757
 20758     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20759     MOVE 'CS'         TO CS-RECORD-ID.
 20760     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20761     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20762     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20763     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20764     WRITE CERTIFICATE-TRAILERS.
 20765
 20766 8180-EXIT.
 20767     EXIT.
 20768
 20769 8190-UPDATE-REFUND-CLAIM-FLAG.
 20770
 20771     IF ELCRTT-OPEN = ' '
 20772         OPEN I-O ELCRTT
 20773         MOVE 'X' TO ELCRTT-OPEN
 20774         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20775             NEXT SENTENCE
 20776         ELSE
 20777             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20778             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 384
* EL517.cbl
 20779             MOVE EMSG               TO WS-ABEND-MESSAGE
 20780             GO TO ABEND-PGM
 20781         END-IF
 20782     END-IF.
 20783
 20784     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20785     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20786     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20787
 20788     READ ELCRTT.
 20789
 20790     IF ELCRTT-FILE-STATUS  = '00'
 20791        CONTINUE
 20792     ELSE
 20793        GO TO 8190-NOTFND
 20794     END-IF.
 20795
 20796     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20797     REWRITE CERTIFICATE-TRAILERS.
 20798
 20799     GO TO 8190-EXIT.
 20800
 20801 8190-NOTFND.
 20802
 20803     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20804     MOVE 'CS'         TO CS-RECORD-ID.
 20805     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20806     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20807     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20808     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20809     WRITE CERTIFICATE-TRAILERS.
 20810
 20811 8190-EXIT.
 20812     EXIT.
 20813
 20814 8195-UPDATE-AGE-FLAGS.
 20815     IF ELCRTT-OPEN = ' '
 20816         OPEN I-O ELCRTT
 20817         MOVE 'X' TO ELCRTT-OPEN
 20818         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20819             NEXT SENTENCE
 20820         ELSE
 20821             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20822             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20823             MOVE EMSG               TO WS-ABEND-MESSAGE
 20824             GO TO ABEND-PGM
 20825         END-IF
 20826     END-IF.
 20827
 20828     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20829     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20830     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20831
 20832     READ ELCRTT.
 20833
 20834     IF ELCRTT-FILE-STATUS  = '00'
 20835        CONTINUE
 20836     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 385
* EL517.cbl
 20837        GO TO 8195-NOTFND
 20838     END-IF.
 20839
 20840     IF WS-INS-AGE-SET = 'Y'
 20841        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20842     END-IF
 20843     IF WS-JNT-AGE-SET = 'Y'
 20844        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20845     END-IF
 20846
 20847     REWRITE CERTIFICATE-TRAILERS.
 20848
 20849     GO TO 8195-EXIT.
 20850
 20851 8195-NOTFND.
 20852
 20853     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20854     MOVE 'CS'         TO CS-RECORD-ID.
 20855     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20856     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20857     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20858     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20859     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20860     WRITE CERTIFICATE-TRAILERS.
 20861
 20862 8195-EXIT.
 20863     EXIT.
 20864
 20865 8200-READ-REIN-TABLE.
 20866     MOVE ERREIN-KEY TO RE-CONTROL-PRIMARY.
 20867     READ ERREIN.
 20868     ADD 1 TO RREI.
 20869
 20870     IF RE-CODE NOT = 'A'
 20871        PERFORM REIN-DATE-LOAD.
 20872
 20873     IF ERREIN-FILE-STATUS NOT = '00'
 20874          GO TO 8200-NOTFND.
 20875
 20876     GO TO 8200-EXIT.
 20877
 20878 8200-NOTFND.
 20879     MOVE 'N'                TO WS-REIN-READ-SW.
 20880
 20881 8200-EXIT.
 20882     EXIT.
 20883      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 386
* EL517.cbl
 20885
 20886 8300-READ-CTBL-TABLE.
 20887     MOVE ERCTBL-KEY TO CT-CONTROL-PRIMARY.
 20888     READ ERCTBL.
 20889     ADD 1 TO RCTB.
 20890
 20891     IF ERCTBL-FILE-STATUS NOT = '00'
 20892         GO TO 8300-NOTFND.
 20893
 20894     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20895
 20896     GO TO 8300-EXIT.
 20897
 20898 8300-NOTFND.
 20899     IF CTBL-SW = '0530'
 20900         MOVE 'AA'                     TO WS-AH-COMP-CD
 20901         MOVE '0550'                   TO CTBL-SW
 20902         MOVE '1'                      TO WS-CTBL-READ-SW
 20903         GO TO 8300-EXIT.
 20904
 20905     IF CTBL-SW = '0540'
 20906         MOVE 'AA'                     TO WS-LF-COMP-CD
 20907         MOVE '0550'                   TO CTBL-SW
 20908         MOVE '1'                      TO WS-CTBL-READ-SW
 20909         GO TO 8300-EXIT.
 20910
 20911     IF CTBL-SW = '0550'
 20912         MOVE '2'                      TO WS-CTBL-READ-SW
 20913         GO TO 8300-EXIT.
 20914
 20915 8300-EXIT.
 20916      EXIT.
 20917     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 387
* EL517.cbl
 20919
 20920 8400-GETMAIN-ERFORM.
 20921*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 20922     EXIT.
 20923 8400-EXIT.
 20924     EXIT.
 20925
 20926 8450-READ-FORM-MASTER.
 20927
 20928     MOVE ERFORM-KEY             TO FO-CONTROL-PRIMARY
 20929
 20930     START ERFORM KEY NOT LESS THAN FO-CONTROL-PRIMARY.
 20931
 20932     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 20933        GO TO 8450-FORM-NOT-FOUND.
 20934
 20935     READ ERFORM NEXT.
 20936
 20937     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 20938        GO TO 8450-FORM-NOT-FOUND.
 20939
 20940     MOVE 'Y'                    TO FORM-MASTER-SW.
 20941     GO TO 8450-EXIT.
 20942
 20943 8450-FORM-NOT-FOUND.
 20944
 20945     MOVE 'N'                    TO FORM-MASTER-SW.
 20946
 20947 8450-EXIT.
 20948     EXIT.
 20949
 20950 8500-DATE-CONVERT.
 20951     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 20952
 20953 8500-EXIT.
 20954     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 388
* EL517.cbl
 20956
 20957 8555-RELOAD-CONTROL-FILE.
 20958     MOVE HOLD-ELCNTL (ELCNTL-POINTER) TO  CONTROL-FILE.
 20959
 20960 8555-EXIT.
 20961     EXIT.
 20962
 20963 8557-GETMAIN-ERPLAN.
 20964*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 20965     EXIT.
 20966 8557-EXIT.
 20967     EXIT.
 20968
 20969 8560-GETMAIN.
 20970      MOVE 999 TO ERACCT-POINTER.
 20971
 20972 8560-EXIT.
 20973     EXIT.
 20974
 20975 8570-START-ACCOUNT-MASTER.
 20976     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 20977
 20978 8570-EXIT.
 20979     EXIT.
 20980
 20981 8580-READ-ACCOUNT-MASTER.
 20982     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 20983
 20984     IF WS-BROWSE-STARTED-SW = 'Y'
 20985         START ERACCT KEY NOT LESS THAN AM-CONTROL-BY-VAR-GRP.
 20986
 20987     IF ERACCT-FILE-STATUS = '23'
 20988         MOVE HIGH-VALUE TO ERACCT-KEY
 20989         GO TO 8580-EXIT.
 20990
 20991     IF ERACCT-FILE-STAT-1 = '9'
 20992         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20993         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 20994         MOVE RMSG TO WS-ABEND-MESSAGE
 20995         GO TO ABEND-PGM.
 20996
 20997     MOVE SPACE TO WS-BROWSE-STARTED-SW.
 20998
 20999     READ ERACCT NEXT.
 21000     ADD 1 TO RACC.
 21001
*21002     COPY ELCACCTI.
 21003******************************************************************04/14/98
 21004*                                                                *ELCACCTI
 21005*                            ELCACCTI                            *   LV003
 21006*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21007*                            VMOD=2.001                          *ELCACCTI
 21008*                                                                *ELCACCTI
 21009*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
 21010*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
 21011*                                                                *ELCACCTI
 21012*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
 21013*                                                                *ELCACCTI
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 389
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTI)
 21014******************************************************************ELCACCTI
 21015     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
 21016     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
 21017     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
 21018     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
 21019     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
 21020     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
 21021     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
 21022     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
 21023     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
 21024
 21025     IF ERACCT-FILE-STAT-1 = '9'
 21026         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21027         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 21028         MOVE RMSG TO WS-ABEND-MESSAGE
 21029         GO TO ABEND-PGM.
 21030
 21031     IF ERACCT-FILE-STATUS NOT = '00'
 21032         MOVE HIGH-VALUE TO ERACCT-KEY
 21033         GO TO 8580-EXIT.
 21034
 21035     MOVE AM-CONTROL-BY-VAR-GRP TO ERACCT-KEY.
 21036
 21037 8580-EXIT.
 21038     EXIT.
 21039
 21040 8582-READ-COMPENSATION-MASTER.
 21041     MOVE ERCOMP-KEY TO CO-CONTROL-PRIMARY
 21042
 21043     READ ERCOMP
 21044
 21045     IF ERCOMP-FILE-STATUS NOT = '00'
 21046        GO TO 8582-COMP-NOT-FOUND
 21047     END-IF
 21048
 21049     MOVE 'Y'                    TO COMP-MASTER-SW.
 21050     GO TO 8582-EXIT
 21051     .
 21052 8582-COMP-NOT-FOUND.
 21053
 21054     MOVE 'N'                    TO COMP-MASTER-SW.
 21055
 21056 8582-EXIT.
 21057     EXIT.
 21058
 21059 8583-READ-ERAGTC.
 21060
 21061     MOVE ERAGTC-KEY TO AG-CONTROL-PRIMARY
 21062
 21063     START ERAGTC KEY IS NOT < AG-CONTROL-PRIMARY
 21064
 21065     IF ERAGTC-FILE-STATUS NOT = '00'
 21066        GO TO 8583-AGTC-NOT-FOUND
 21067     END-IF
 21068
 21069     .
 21070 8583-READ-ERAGTC-NEXT.
 21071
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 390
* EL517.cbl
 21072     READ ERAGTC NEXT RECORD
 21073
 21074     IF ERAGTC-FILE-STATUS NOT = '00'
 21075        GO TO 8583-AGTC-NOT-FOUND
 21076     END-IF
 21077
 21078*    MOVE 'Y'                    TO AGTC-MASTER-SW.
 21079     GO TO 8583-EXIT
 21080     .
 21081 8583-AGTC-NOT-FOUND.
 21082
 21083     MOVE 'N'                    TO AGTC-MASTER-SW.
 21084
 21085 8583-EXIT.
 21086     EXIT.
 21087
 21088 8584-READ-BANK-CROSS-REF.
 21089     MOVE ERBXRF-KEY TO BK-CONTROL-PRIMARY
 21090
 21091     READ ERBXRF
 21092
 21093     IF ERBXRF-FILE-STATUS NOT = '00'
 21094        GO TO 8584-BXRF-NOT-FOUND
 21095     END-IF
 21096
 21097     MOVE 'Y'                    TO BXRF-MASTER-SW.
 21098     GO TO 8584-EXIT
 21099     .
 21100 8584-BXRF-NOT-FOUND.
 21101
 21102     MOVE 'N'                    TO BXRF-MASTER-SW.
 21103
 21104 8584-EXIT.
 21105     EXIT.
 21106
 21107 8585-READ-PLAN-MASTER.
 21108
 21109     MOVE ERPLAN-KEY             TO PL-CONTROL-PRIMARY.
 21110
 21111     READ ERPLAN.
 21112
 21113     IF ERPLAN-FILE-STATUS NOT EQUAL '00'
 21114        GO TO 8585-PLAN-NOT-FOUND.
 21115
 21116     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21117     GO TO 8585-EXIT.
 21118
 21119 8585-PLAN-NOT-FOUND.
 21120
 21121     MOVE 'N'                    TO PLAN-MASTER-SW.
 21122
 21123 8585-EXIT.
 21124     EXIT.
 21125
 21126 8586-READ-LOAN-OFFICER.
 21127
 21128     MOVE ERLOFC-KEY             TO LO-CONTROL-PRIMARY
 21129
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 391
* EL517.cbl
 21130     READ ERLOFC
 21131
 21132     IF ERLOFC-FILE-STATUS NOT = '00'
 21133        MOVE 'N'                 TO LOFC-MASTER-SW
 21134     ELSE
 21135        MOVE 'Y'                 TO LOFC-MASTER-SW
 21136     END-IF
 21137
 21138     .
 21139 8586-EXIT.
 21140     EXIT.
 21141
 21142
 21143 8587-START-ERPDEF.
 21144
 21145     MOVE ERPDEF-KEY             TO PD-CONTROL-PRIMARY
 21146
 21147     START ERPDEF KEY >= PD-CONTROL-PRIMARY
 21148     IF ERPDEF-FILE-STATUS NOT = '00'
 21149        MOVE 'N'                 TO PDEF-MASTER-SW
 21150     ELSE
 21151        MOVE 'Y'                 TO PDEF-MASTER-SW
 21152     END-IF
 21153
 21154
 21155     .
 21156 8587-EXIT.
 21157     EXIT.
 21158
 21159 8588-READ-ERPDEF.
 21160
 21161     READ ERPDEF NEXT RECORD
 21162
 21163     IF ERPDEF-FILE-STATUS NOT = '00'
 21164        MOVE 'N'                 TO PDEF-MASTER-SW
 21165     ELSE
 21166        MOVE 'Y'                 TO PDEF-MASTER-SW
 21167     END-IF
 21168
 21169     .
 21170 8588-EXIT.
 21171     EXIT.
 21172
 21173 8589-ENDBR-ERPDEF.
 21174
 21175     .
 21176 8589-EXIT.
 21177     EXIT.
 21178
 21179 8590-READ-CERT-MASTER.
 21180     MOVE ELCERT-KEY TO CM-CONTROL-PRIMARY.
 21181     READ ELCERT.
 21182     ADD 1 TO RCER.
 21183
 21184     IF ELCERT-FILE-STATUS NOT = '00'
 21185         NEXT SENTENCE
 21186     ELSE
 21187         GO TO 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 392
* EL517.cbl
 21188
 21189     MOVE '1'                     TO CERT-STATUS-SW.
 21190
 21191     IF PB-COMPANY-ID = 'UCL'
 21192         IF WS-ERROR = ER-2799
 21193             GO TO 8590-EXIT.
 21194
 21195     IF PB-CANCELLATION
 21196        MOVE ER-2726              TO  WS-ERROR
 21197        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 21198        IF ACCOUNT-MAST-FOUND
 21199           MOVE AM-EXPIRATION-DT  TO  PB-ACCT-EXP-DT
 21200           MOVE AM-EFFECTIVE-DT   TO  PB-ACCT-EFF-DT
 21201           GO TO 8590-EXIT
 21202        ELSE
 21203           GO TO 8590-EXIT.
 21204
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 393
* EL517.cbl
 21206
 21207 8590-EXIT.
 21208     EXIT.
 21209
 21210 8750-START-ELSTAT.
 21211
 21212     MOVE ELSTAT-KEY             TO SF-CONTROL-PRIMARY
 21213
 21214     START ELSTAT KEY >= SF-CONTROL-PRIMARY
 21215     IF ELSTAT-FILE-STATUS NOT = '00'
 21216        MOVE 'N'                 TO STAT-MASTER-SW
 21217     ELSE
 21218        MOVE 'Y'                 TO STAT-MASTER-SW
 21219     END-IF
 21220
 21221     .
 21222 8750-EXIT.
 21223     EXIT.
 21224
 21225 8752-READ-ELSTAT.
 21226
 21227     READ ELSTAT NEXT RECORD
 21228
 21229     IF ELSTAT-FILE-STATUS NOT = '00'
 21230        MOVE 'N'                 TO STAT-MASTER-SW
 21231     ELSE
 21232        MOVE 'Y'                 TO STAT-MASTER-SW
 21233     END-IF
 21234
 21235     .
 21236 8752-EXIT.
 21237     EXIT.
 21238
 21239 8800-GET-COMP-RATE.
 21240     MOVE +1 TO IB.
 21241     IF WS-COMM-CK-AMT > CT-TBF (1)
 21242         ADD +9 TO IB
 21243         IF WS-COMM-CK-AMT > CT-TBF (2)
 21244             ADD +9 TO IB
 21245             IF WS-COMM-CK-AMT > CT-TBF (3)
 21246                MOVE ZEROS       TO WS-WK-RATE
 21247                GO TO 8800-EXIT.
 21248
 21249     IF PB-I-AGE > CT-AGE (1)
 21250         ADD +3 TO IB
 21251         IF PB-I-AGE > CT-AGE (2)
 21252             ADD +3 TO IB
 21253             IF PB-I-AGE > CT-AGE (3)
 21254                MOVE ZEROS       TO WS-WK-RATE
 21255                GO TO 8800-EXIT.
 21256
 21257     IF WS-WORK-TERM > CT-TRM (1)
 21258         ADD +1 TO IB
 21259         IF WS-WORK-TERM > CT-TRM (2)
 21260             ADD +1 TO IB
 21261             IF WS-WORK-TERM > CT-TRM (3)
 21262                MOVE ZEROS       TO WS-WK-RATE
 21263                GO TO 8800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 394
* EL517.cbl
 21264
 21265     IF CT-RT (IB) NOT NUMERIC
 21266         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21267         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21268         GO TO 8800-GET-COMP-RATE.
 21269
 21270     MOVE CT-RT (IB) TO WS-WK-RATE.
 21271
 21272 8800-EXIT.
 21273     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 395
* EL517.cbl
 21275
 21276 8900-ADDRESS-FILE.
 21277     EXIT.
 21278 8900-ADDRESS-EXIT.
 21279     EXIT.
 21280
 21281 9000-READ-CONTROL.
 21282     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21283     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21284
 21285     IF ELCNTL-FILE-STATUS NOT = '00'
 21286         GO TO 9000-NOTFND.
 21287
 21288     READ ELCNTL NEXT.
 21289     ADD 1 TO RCNT.
 21290
 21291     IF ELCNTL-FILE-STATUS NOT = '00'
 21292         GO TO 9000-NOTFND.
 21293
 21294     IF CNTL-REC-TYPE = '1'
 21295         MOVE CONTROL-FILE TO HOLD-ELCNTL (1)
 21296         MOVE 1            TO ELCNTL-POINTER.
 21297
 21298     IF CNTL-REC-TYPE = '6'
 21299         MOVE CONTROL-FILE TO HOLD-ELCNTL (6)
 21300         MOVE 6            TO ELCNTL-POINTER.
 21301
 21302     GO TO 9000-EXIT.
 21303
 21304 9000-NOTFND.
 21305     IF RC-SW-1 = '1'
 21306         MOVE ER-2616             TO WS-ERROR
 21307         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21308         GO TO 9000-EXIT.
 21309
 21310     IF RC-SW-1 = '2'
 21311         MOVE ER-2602             TO WS-ERROR
 21312         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21313         GO TO 9000-EXIT.
 21314
 21315     GO TO 9000-EXIT.
 21316
 21317 9000-EXIT.
 21318     EXIT.
 21319      EXIT.
 21320
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 396
* EL517.cbl
 21322 9100-READ-CONTROL.
 21323     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21324     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21325
 21326     IF ELCNTL-FILE-STATUS NOT = '00'
 21327         GO TO 9100-NOTFND.
 21328
 21329     READ ELCNTL NEXT.
 21330     ADD 1 TO RCNT.
 21331
 21332     IF ELCNTL-FILE-STATUS NOT = '00'
 21333         GO TO 9100-NOTFND.
 21334
 21335     IF CNTL-REC-TYPE = '3'
 21336         MOVE CONTROL-FILE TO HOLD-ELCNTL (3)
 21337         MOVE 3            TO ELCNTL-POINTER
 21338         GO TO 9100-EXIT.
 21339
 21340     IF CNTL-REC-TYPE = '4'
 21341         MOVE CONTROL-FILE TO HOLD-ELCNTL (4)
 21342         MOVE 4            TO ELCNTL-POINTER
 21343         GO TO 9100-EXIT.
 21344
 21345     IF CNTL-REC-TYPE = '5'
 21346         MOVE CONTROL-FILE TO HOLD-ELCNTL (5)
 21347         MOVE 5            TO ELCNTL-POINTER
 21348         GO TO 9100-EXIT.
 21349
 21350     IF CNTL-REC-TYPE = 'L'
 21351         MOVE CONTROL-FILE TO HOLD-ELCNTL (10)
 21352         MOVE 10           TO ELCNTL-POINTER
 21353         GO TO 9100-EXIT.
 21354
 21355     IF CNTL-REC-TYPE = 'A'
 21356         MOVE CONTROL-FILE TO HOLD-ELCNTL (11)
 21357         MOVE 11           TO ELCNTL-POINTER
 21358         GO TO 9100-EXIT.
 21359
 21360 9100-NOTFND.
 21361     DISPLAY 'CTL FILE NOT FOUND ' RC-SW-2 ' KEY='  ELCNTL-KEY.
 21362
 21363     IF RC-SW-2 = '1'
 21364        MOVE '1'                 TO LF-BENEFIT-ERROR
 21365        MOVE ER-2604             TO WS-ERROR
 21366        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21367        GO TO 9100-EXIT.
 21368
 21369     IF RC-SW-2 = '2'
 21370        MOVE '1'                 TO AH-BENEFIT-ERROR
 21371        MOVE ER-2605             TO WS-ERROR
 21372        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21373        GO TO 9100-EXIT.
 21374
 21375     IF RC-SW-2 = '3'
 21376        MOVE ER-2603             TO WS-ERROR
 21377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21378        GO TO 9100-EXIT.
 21379
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 397
* EL517.cbl
 21380     IF RC-SW-2 = '4'
 21381         MOVE PB-I-LF-INPUT-CD   TO PB-I-LF-BENEFIT-CD
 21382         GO TO 9100-EXIT.
 21383
 21384     IF RC-SW-2 = '5'
 21385         MOVE PB-I-AH-INPUT-CD   TO WS-AH-INPUT-CD
 21386         IF WS-AH-INPUT-CD-1 = SPACE
 21387             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21388         ELSE
 21389             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21390
 21391 9100-EXIT.
 21392     EXIT.
 21393      EXIT.
 21394
 21395 9200-CONTROL-GETMAIN.
 21396*    ESTABLISH LINKAGE AREA FOR CONTROL FILE.
 21397     EXIT.
 21398 9200-EXIT.
 21399     EXIT.
 21400
 21401 9250-UNLOCK-RETURN.
 21402*  DUMMIED IN THE BATCH EL517 ....
 21403     EXIT.
 21404 9250-UNLOCK-EXIT.
 21405     EXIT.
 21406      EXIT.
 21407
 21408 9300-ACCUM-BATCH-TOTALS.
 21409         IF PB-ISSUE
 21410             ADD PB-I-LF-PREM-CALC       TO WS-LF-ISS-COMPUTED
 21411             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21412             ADD PB-I-LF-PREMIUM-AMT     TO WS-LF-ISS-ENTERED
 21413             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21414             ADD PB-I-AH-PREM-CALC       TO WS-AH-ISS-COMPUTED
 21415             ADD PB-I-AH-PREMIUM-AMT     TO WS-AH-ISS-ENTERED
 21416             ADD 1                       TO WS-ISSUE-CNT
 21417         ELSE
 21418             ADD PB-C-LF-REF-CALC        TO WS-LF-CAN-COMPUTED
 21419             ADD PB-C-LF-CANCEL-AMT      TO WS-LF-CAN-ENTERED
 21420             ADD PB-C-AH-REF-CALC        TO WS-AH-CAN-COMPUTED
 21421             ADD PB-C-AH-CANCEL-AMT      TO WS-AH-CAN-ENTERED
 21422             ADD 1                       TO WS-CANCEL-CNT.
 21423
 21424 9400-EXIT.
 21425     EXIT.
 21426
 21427 9990-RETURN.
 21428*    END BROUSE OF ACCOUNT FILE
 21429     EXIT.
 21430
 21431 9990-EXIT.
 21432     EXIT.
 21433
 21434
 21435****Check for CRTO record, add one if not found.
 21436 9991-CHECK-FOR-ELCRTO.
 21437     IF ELCRTO-OPEN = ' '
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 398
* EL517.cbl
 21438         OPEN I-O ELCRTO
 21439         MOVE 'X' TO ELCRTO-OPEN
 21440         IF ELCRTO-FILE-STATUS   = '00' OR '97'
 21441             NEXT SENTENCE
 21442         ELSE
 21443             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21444             MOVE 'ELCRTO'           TO WS-FEM-FILE-NAME
 21445             MOVE EMSG               TO WS-ABEND-MESSAGE
 21446             GO TO ABEND-PGM
 21447         END-IF
 21448     END-IF.
 21449     IF ELCRTT-OPEN = ' '
 21450         OPEN I-O ELCRTT
 21451         MOVE 'X' TO ELCRTT-OPEN
 21452         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 21453             NEXT SENTENCE
 21454         ELSE
 21455             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21456             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 21457             MOVE EMSG               TO WS-ABEND-MESSAGE
 21458             GO TO ABEND-PGM
 21459         END-IF
 21460     END-IF.
 21461     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21462     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21463     MOVE +0                     TO ELCRTO-SEQ-NO
 21464     MOVE ELCRTO-KEY             TO OC-CONTROL-PRIMARY
 21465
 21466     START ELCRTO KEY NOT LESS THAN OC-CONTROL-PRIMARY.
 21467
 21468     IF ELCRTO-FILE-STATUS NOT = '00'
 21469         GO TO 9991-CRTO-NOT-FOUND
 21470     END-IF.
 21471
 21472     READ ELCRTO NEXT.
 21473     IF ELCRTO-FILE-STATUS = '00'
 21474        AND (OC-CONTROL-PRIMARY (1:33) =
 21475                 PB-CONTROL-BY-ACCOUNT (1:33))
 21476        AND (OC-RECORD-TYPE = 'I')
 21477           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21478               GO TO 9991-CHECK-INDICATORS
 21479           ELSE
 21480               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21481               GO TO 9991-CRTO-ADD-REC
 21482           END-IF
 21483     END-IF.
 21484
 21485 9991-CRTO-NOT-FOUND.
 21486
 21487     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21488     MOVE 'OC'                TO OC-RECORD-ID
 21489     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21490                              TO OC-CONTROL-PRIMARY (1:33)
 21491     MOVE +4096               TO OC-KEY-SEQ-NO.
 21492
 21493 9991-CRTO-ADD-REC.
 21494
 21495     MOVE 'E517'              TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 399
* EL517.cbl
 21496     MOVE '120000'            TO OC-LAST-MAINT-HHMMSS
 21497     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21498     MOVE 'I'                 TO OC-RECORD-TYPE
 21499     IF PB-ISSUE
 21500         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21501         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21502         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21503         MOVE PB-I-AGE               TO OC-INS-AGE
 21504         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21505         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21506         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21507         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21508         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21509         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21510         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21511         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21512         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21513         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21514         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21515         IF PB-I-JOINT-COMMISSION > +0
 21516             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21517         ELSE
 21518             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21519         END-IF
 21520         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21521         MOVE +0                     TO OC-LF-CANCEL-AMT
 21522                                        OC-LF-ITD-CANCEL-AMT
 21523         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21524         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21525         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21526         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21527         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21528         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21529         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21530         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21531         MOVE +0                     TO OC-AH-CANCEL-AMT
 21532                                        OC-AH-ITD-CANCEL-AMT
 21533         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21534         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21535         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21536     ELSE
 21537         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21538         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21539         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21540         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21541         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21542         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21543         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21544         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21545         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21546          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21547             MOVE SPACES             TO OC-LF-BENCD
 21548             MOVE ZEROS              TO OC-LF-TERM
 21549                                        OC-LF-BEN-AMT
 21550                                        OC-LF-PRM-AMT
 21551                                        OC-LF-ALT-BEN-AMT
 21552                                        OC-LF-ALT-PRM-AMT
 21553                                        OC-LF-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 400
* EL517.cbl
 21554                                        OC-LF-CANCEL-AMT
 21555             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21556             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21557         ELSE
 21558             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21559             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21560             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21561             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21562             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21563             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21564             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21565             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21566             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21567             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21568         END-IF
 21569         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21570         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21571          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21572             MOVE SPACES             TO OC-AH-BENCD
 21573             MOVE ZEROS              TO OC-AH-TERM
 21574                                        OC-AH-BEN-AMT
 21575                                        OC-AH-PRM-AMT
 21576                                        OC-AH-COMM-PCT
 21577                                        OC-AH-CANCEL-AMT
 21578                                        OC-AH-CP
 21579             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21580             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21581         ELSE
 21582             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21583             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21584             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21585             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21586             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21587             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21588             MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 21589             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21590             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21591         END-IF
 21592         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21593         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21594         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21595         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21596     END-IF
 21597     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21598
 21599     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21600     IF ERMAIL-FOUND = ' '
 21601         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21602     END-IF.
 21603
 21604     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21605     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21606     MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY.
 21607
 21608     READ ELCRTT
 21609
 21610     IF ELCRTT-FILE-STATUS  = '00'
 21611         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 401
* EL517.cbl
 21612         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21613     END-IF.
 21614
 21615     WRITE ORIGINAL-CERTIFICATE.
 21616
 21617     GO TO 9991-EXIT.
 21618
 21619 9991-CHECK-INDICATORS.
 21620
 21621     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21622         GO TO 9991-EXIT
 21623     END-IF.
 21624
 21625     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21626         GO TO 9991-EXIT
 21627     END-IF.
 21628
 21629     IF PB-ISSUE
 21630        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21631        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21632        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21633        MOVE PB-I-AGE               TO OC-INS-AGE
 21634        MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21635        MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21636        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21637        MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21638        MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21639        MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21640        MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21641        MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21642        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21643        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21644        MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21645        IF PB-I-JOINT-COMMISSION > +0
 21646            MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21647        ELSE
 21648            MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21649        END-IF
 21650        MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21651        MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21652        MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21653        MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21654        MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21655        MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21656        MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21657        MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21658        MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21659
 21660        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21661        IF ERMAIL-FOUND = ' '
 21662           MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21663        END-IF
 21664
 21665        MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21666        MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21667        MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY
 21668        READ ELCRTT
 21669        IF ELCRTT-FILE-STATUS  = '00'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 402
* EL517.cbl
 21670           MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21671           MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21672        END-IF
 21673
 21674     ELSE
 21675        IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21676           MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21677           MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21678           MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21679        END-IF
 21680        IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21681           MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21682           MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21683           MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21684        END-IF
 21685        MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21686     END-IF
 21687
 21688     REWRITE ORIGINAL-CERTIFICATE.
 21689
 21690 9991-EXIT.
 21691     EXIT.
 21692
 21693
 21694 9999-SET-PNDB-ERROR-FLAGS.
 21695
 21696     IF PB-BATCH-TRAILER
 21697        GO TO 9999-REWRITE-RECORD.
 21698
 21699     IF PB-COMMON-ERRORS = LOW-VALUES
 21700        GO TO 9999-SET-ERROR-FLAGS.
 21701
 21702 9999-FORMAT-ERRORS.
 21703
 21704     MOVE +0                     TO SUB1.
 21705
 21706 9999-ERROR-LOOP.
 21707
 21708     ADD +1                      TO SUB1.
 21709
 21710     IF SUB1 GREATER THAN PB-NO-OF-ERRORS
 21711        GO TO 9999-SET-ERROR-FLAGS.
 21712
 21713     MOVE PB-COMMON-ERROR (SUB1) TO EM-MESSAGE-NUMBER.
 21714
 21715     READ ELCERR.
 21716
 21717     IF ELCERR-FILE-STATUS NOT = '00'
 21718        ADD +1                       TO EMI-FATAL-CTR
 21719        GO TO  9999-ERROR-LOOP.
 21720
*21721                                 COPY ELCERRPD.
 21722******************************************************************04/15/98
 21723*                                                                *ELCERRPD
 21724*                                                                *ELCERRPD
 21725*                            ELCERRPD                            *   LV002
 21726*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 21727*                            VMOD=2.005                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 403
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21728*                                                                *ELCERRPD
 21729*    CLIENT CODED ERROR MESSAGES                                 *ELCERRPD
 21730*                                                                *ELCERRPD
 21731******************************************************************ELCERRPD
 21732                                                                  ELCERRPD
 21733     IF EM-MESSAGE-NUMBER NOT NUMERIC                             ELCERRPD
 21734         MOVE ZEROS TO EM-MESSAGE-NUMBER.                         ELCERRPD
 21735                                                                  ELCERRPD
 21736     IF E-CLIENT-ID EQUAL CLIENT-AIG OR CLIENT-AUK                ELCERRPD
 21737                         OR CLIENT-CIG OR CLIENT-CUK              ELCERRPD
 21738        IF EM-MESSAGE-NUMBER EQUAL 0541                           ELCERRPD
 21739            MOVE 'X' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21740                                                                  ELCERRPD
 21741     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21742        IF EM-MESSAGE-NUMBER IS EQUAL TO 1909                     ELCERRPD
 21743            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21744                                                                  ELCERRPD
 21745     IF E-CLIENT-ID EQUAL CLIENT-LAP                              ELCERRPD
 21746        IF EM-MESSAGE-NUMBER EQUAL 2656                           ELCERRPD
 21747            MOVE 'F' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21748                                                                  ELCERRPD
 21749     IF E-CLIENT-ID IS EQUAL TO CLIENT-NCB                        ELCERRPD
 21750        IF EM-MESSAGE-NUMBER IS EQUAL TO 2671                     ELCERRPD
 21751            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21752                                                                  ELCERRPD
 21753     IF E-CLIENT-ID IS EQUAL TO CLIENT-ABL OR CLIENT-TIC          ELCERRPD
 21754        IF EM-MESSAGE-NUMBER IS EQUAL TO 2672                     ELCERRPD
 21755            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21756                                                                  ELCERRPD
 21757     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21758        IF EM-MESSAGE-NUMBER IS EQUAL TO 2693                     ELCERRPD
 21759            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21760                                                                  ELCERRPD
 21761     IF E-CLIENT-ID IS EQUAL TO CLIENT-TMS                        ELCERRPD
 21762        IF EM-MESSAGE-NUMBER IS EQUAL TO 2696                     ELCERRPD
 21763            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21764                                                                  ELCERRPD
 21765     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21766        IF EM-MESSAGE-NUMBER EQUAL 2738                           ELCERRPD
 21767            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21768                                                                  ELCERRPD
 21769     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21770        IF EM-MESSAGE-NUMBER EQUAL 2739                           ELCERRPD
 21771            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21772                                                                  ELCERRPD
 21773     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21774        IF EM-MESSAGE-NUMBER EQUAL 2741                           ELCERRPD
 21775            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21776                                                                  ELCERRPD
 21777     IF  E-CLIENT-ID EQUAL CLIENT-HAN                             ELCERRPD
 21778             OR                                                   ELCERRPD
 21779         E-CLIENT-ID EQUAL CLIENT-JHL                             ELCERRPD
 21780                                                                  ELCERRPD
 21781         IF  EM-MESSAGE-NUMBER EQUAL 2756                         ELCERRPD
 21782             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21783                                                                  ELCERRPD
 21784     IF E-CLIENT-ID = CLIENT-NCX                                  ELCERRPD
 21785         IF EM-MESSAGE-NUMBER = 9895                              ELCERRPD
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 404
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21786             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21787
 21788     IF E-CLIENT-ID = CLIENT-DCC
 21789        IF EM-MESSAGE-NUMBER = 2719
 21790           MOVE 'W'              TO EM-ERROR-SEVERITY
 21791        END-IF
 21792     END-IF
 21793
 21794     .
 21795
 21796     IF EM-ERROR-SEVERITY = 'W'
 21797        ADD +1                   TO EMI-WARNING-CTR
 21798        GO TO  9999-ERROR-LOOP.
 21799
 21800     IF EM-ERROR-SEVERITY = 'F'
 21801        ADD +1                   TO EMI-FORCABLE-CTR
 21802        GO TO  9999-ERROR-LOOP.
 21803
 21804     IF EM-ERROR-SEVERITY = 'X'
 21805        ADD +1                   TO EMI-FATAL-CTR.
 21806
 21807     GO TO 9999-ERROR-LOOP.
 21808
 21809 9999-SET-ERROR-FLAGS.
 21810
 21811     IF EMI-FATAL-CTR NOT = ZEROS
 21812        MOVE 'X'                 TO PB-FATAL-FLAG
 21813        GO TO 9999-CONT-SET-ERROR-FLAGS.
 21814
 21815     IF EMI-FORCABLE-CTR NOT = ZEROS
 21816        IF PB-ISSUE
 21817           IF PB-ISSUE-FORCE
 21818              MOVE 'F'           TO PB-FORCE-ER-CD
 21819             ELSE
 21820              MOVE 'X'           TO PB-FORCE-ER-CD
 21821          ELSE
 21822           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 21823              MOVE 'F'           TO PB-FORCE-ER-CD
 21824             ELSE
 21825              MOVE 'X'           TO PB-FORCE-ER-CD.
 21826
 21827 9999-CONT-SET-ERROR-FLAGS.
 21828
 21829     IF EMI-WARNING-CTR NOT = ZEROS
 21830        MOVE 'W'                 TO PB-WARN-ER-CD.
 21831
 21832     IF PB-UNFORCED-ERRORS OR
 21833        PB-FATAL-ERRORS    OR
 21834        PB-RECORD-ON-HOLD  OR
 21835        PB-RECORD-RETURNED
 21836*        OR
 21837*       PB-CANCELLATION
 21838          NEXT SENTENCE
 21839        ELSE
 21840          GO TO 9999-REWRITE-RECORD.
 21841
 21842     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 21843     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 405
* EL517.cbl
 21844     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
 21845     MOVE PB-SV-STATE            TO CERT-STATE.
 21846
 21847     READ ELCERT.
 21848
 21849     IF PB-ISSUE
 21850     IF CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE
 21851        GO TO 9999-REWRITE-CERT-MASTER.
 21852
 21853     IF PB-ISSUE
 21854        IF PB-RECORD-RETURNED
 21855            MOVE '4'             TO CM-CREDIT-INTERFACE-SW-1
 21856        ELSE
 21857             MOVE '2'            TO CM-CREDIT-INTERFACE-SW-1.
 21858
 21859     IF PB-CANCELLATION
 21860        IF PB-RECORD-RETURNED
 21861            MOVE '7'             TO CM-CREDIT-INTERFACE-SW-2
 21862        ELSE
 21863            IF PB-C-LF-CANCEL-VOIDED OR PB-C-AH-CANCEL-VOIDED
 21864               MOVE '6'          TO CM-CREDIT-INTERFACE-SW-2
 21865            ELSE
 21866               MOVE '4'          TO CM-CREDIT-INTERFACE-SW-2.
 21867
 21868 9999-REWRITE-CERT-MASTER.
 21869
 21870     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 21871        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 21872        GO TO 9999-REWRITE-RECORD.
 21873
 21874     REWRITE CERTIFICATE-MASTER.
 21875     ADD 1 TO WCER.
 21876
 21877 9999-REWRITE-RECORD.
 21878     IF NOT PB-BATCH-TRAILER
 21879         IF PB-ISSUE
 21880             ADD PB-I-LF-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21881             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21882             ADD PB-I-LF-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21883             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21884             ADD PB-I-AH-PREM-CALC   TO WS-AH-ISS-COMPUTED
 21885             ADD PB-I-AH-PREMIUM-AMT TO WS-AH-ISS-ENTERED
 21886             ADD 1                   TO WS-ISSUE-CNT
 21887         ELSE
 21888             ADD PB-C-LF-REF-CALC    TO WS-LF-CAN-COMPUTED
 21889             ADD PB-C-LF-CANCEL-AMT  TO WS-LF-CAN-ENTERED
 21890             ADD PB-C-AH-REF-CALC    TO WS-AH-CAN-COMPUTED
 21891             ADD PB-C-AH-CANCEL-AMT  TO WS-AH-CAN-ENTERED
 21892             ADD 1                   TO WS-CANCEL-CNT
 21893     ELSE
 21894         MOVE WS-LF-ISS-COMPUTED     TO PB-B-LF-ISS-PRM-COMPUTED
 21895         MOVE WS-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED
 21896         MOVE WS-AH-ISS-COMPUTED     TO PB-B-AH-ISS-PRM-COMPUTED
 21897         MOVE WS-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED
 21898         MOVE WS-LF-CAN-COMPUTED     TO PB-B-LF-CAN-PRM-COMPUTED
 21899         MOVE WS-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED
 21900         MOVE WS-AH-CAN-COMPUTED     TO PB-B-AH-CAN-PRM-COMPUTED
 21901         MOVE WS-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 406
* EL517.cbl
 21902         MOVE WS-ISSUE-CNT           TO PB-B-ISSUE-CNT-ENTERED
 21903         MOVE WS-CANCEL-CNT          TO PB-B-CANCEL-CNT-ENTERED
 21904         MOVE ZEROS                  TO WS-LF-ISS-COMPUTED
 21905                                        WS-LF-ISS-ENTERED
 21906                                        WS-AH-ISS-COMPUTED
 21907                                        WS-AH-ISS-ENTERED
 21908                                        WS-LF-CAN-COMPUTED
 21909                                        WS-LF-CAN-ENTERED
 21910                                        WS-AH-CAN-COMPUTED
 21911                                        WS-AH-CAN-ENTERED
 21912                                        WS-ISSUE-CNT
 21913                                        WS-CANCEL-CNT
 21914         MOVE SPACE                  TO PB-FATAL-FLAG.
 21915
 21916     IF PB-BATCH-TRAILER
 21917         IF PB-B-LF-ISS-PRM-REMITTED =
 21918            PB-B-LF-ISS-PRM-ENTERED   AND
 21919            PB-B-LF-CAN-PRM-REMITTED =
 21920            PB-B-LF-CAN-PRM-ENTERED   AND
 21921            PB-B-AH-ISS-PRM-REMITTED =
 21922            PB-B-AH-ISS-PRM-ENTERED   AND
 21923            PB-B-AH-CAN-PRM-REMITTED =
 21924            PB-B-AH-CAN-PRM-ENTERED   AND
 21925            PB-B-ISSUE-CNT-REMITTED  =
 21926            PB-B-ISSUE-CNT-ENTERED    AND
 21927            PB-B-CANCEL-CNT-REMITTED =
 21928            PB-B-CANCEL-CNT-ENTERED
 21929             MOVE SPACE          TO PB-OUT-BAL-CD
 21930           ELSE
 21931             MOVE 'O'            TO PB-OUT-BAL-CD.
 21932
 21933     REWRITE PENDING-BUSINESS.
 21934
 21935     ADD 1 TO WPND.
 21936
 21937     GO TO 0100-READ-PENDING.
 21938
 21939 9999-EXIT.
 21940     EXIT.
 21941
 21942******************************************************************
 21943*                                                                *
 21944*            E R R O R   F O R M A T   R O U T I N E             *
 21945*                                                                *
 21946******************************************************************
 21947
 21948 9900-ERROR-FORMAT.
 21949
 21950     IF WS-ERROR = PB-COMMON-ERROR (1)  OR
 21951                   PB-COMMON-ERROR (2)  OR
 21952                   PB-COMMON-ERROR (3)  OR
 21953                   PB-COMMON-ERROR (4)  OR
 21954                   PB-COMMON-ERROR (5)  OR
 21955                   PB-COMMON-ERROR (6)  OR
 21956                   PB-COMMON-ERROR (7)  OR
 21957                   PB-COMMON-ERROR (8)  OR
 21958                   PB-COMMON-ERROR (9)  OR
 21959                   PB-COMMON-ERROR (10)
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 407
* EL517.cbl
 21960        GO TO 9900-EXIT.
 21961
 21962     IF PB-NO-OF-ERRORS = +10
 21963        GO TO 9900-EXIT.
 21964
 21965     ADD +1                      TO PB-NO-OF-ERRORS.
 21966     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21967                                       (PB-NO-OF-ERRORS).
 21968
 21969
 21970 9900-EXIT.
 21971     EXIT.
 21972
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 408
* EL517.cbl
 21974 9999-DONE.
 21975*START*************CUSTOM CODE FOR CLIENT "DMD"*************
 21976
 21977     IF DTE-CLIENT NOT EQUAL 'DMD'
 21978          GO TO 9999-DONE-CONT.
 21979
 21980     CLOSE ERRESS
 21981           ERRESC.
 21982
 21983     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
 21984     MOVE 'C'                    TO DMPF-PROCESS-TYPE.
 21985     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 21986     IF DMPF-RETURN-CODE EQUAL 'Z3'
 21987         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21988         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
 21989         MOVE CMSG               TO WS-ABEND-MESSAGE
 21990         GO TO ABEND-PGM.
 21991
 21992     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
 21993     MOVE 'C'                    TO DIPF-PROCESS-TYPE.
 21994     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 21995     IF DIPF-RETURN-CODE EQUAL 'Z3'
 21996         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21997         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
 21998         MOVE CMSG               TO WS-ABEND-MESSAGE
 21999         GO TO ABEND-PGM.
 22000
 22001     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
 22002     MOVE 'C'                    TO DVBI-PROCESS-TYPE.
 22003     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 22004     IF DIPF-RETURN-CODE EQUAL 'Z3'
 22005         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22006         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
 22007         MOVE CMSG               TO WS-ABEND-MESSAGE
 22008         GO TO ABEND-PGM.
 22009
 22010     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
 22011     MOVE 'C'                    TO DCUA-PROCESS-TYPE.
 22012     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 22013     IF DCUA-RETURN-CODE EQUAL 'Z3'
 22014         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22015         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
 22016         MOVE CMSG               TO WS-ABEND-MESSAGE
 22017         GO TO ABEND-PGM.
 22018
 22019     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
 22020     MOVE 'C'                    TO DPRB-PROCESS-TYPE.
 22021     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 22022     IF DPRB-RETURN-CODE EQUAL 'Z3'
 22023         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22024         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
 22025         MOVE CMSG               TO WS-ABEND-MESSAGE
 22026         GO TO ABEND-PGM.
 22027
 22028     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
 22029     MOVE 'C'                    TO DVRC-PROCESS-TYPE.
 22030     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 22031     IF DVRC-RETURN-CODE EQUAL 'Z3'
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 409
* EL517.cbl
 22032         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22033         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
 22034         MOVE CMSG               TO WS-ABEND-MESSAGE
 22035         GO TO ABEND-PGM.
 22036
 22037     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
 22038     MOVE 'C'                    TO DVSC-PROCESS-TYPE.
 22039     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 22040     IF DVSC-RETURN-CODE EQUAL 'Z3'
 22041         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22042         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
 22043         MOVE CMSG               TO WS-ABEND-MESSAGE
 22044         GO TO ABEND-PGM.
 22045
 22046*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22047
 22048 9999-DONE-CONT.
 22049
 22050     IF ERPNDM-OPEN = 'X'
 22051        CLOSE ERPNDM.
 22052
 22053     IF ERMAIL-OPEN = 'X'
 22054        CLOSE ERMAIL.
 22055
 22056     IF ELMSTR-OPEN = 'X'
 22057        CLOSE ELMSTR.
 22058
 22059     IF ELCRTT-OPEN = 'X'
 22060        CLOSE ELCRTT
 22061     END-IF.
 22062
 22063     IF ELCRTO-OPEN = 'X'
 22064        CLOSE ELCRTO
 22065     END-IF.
 22066
 22067     CLOSE      ELCNTL
 22068                ELCERR
 22069                ERPNDB
 22070                ERREIN
 22071                ELCERT
 22072                ERCTBL
 22073                ERPLAN
 22074                ERACCT
 22075                ERBXRF
 22076                ERAGTC
 22077                ERCOMP.
 22078
 22079     IF DTE-CLIENT = 'DCC'
 22080        CLOSE ERPDEF ELSTAT
 22081        IF ERPDEF-FILE-STATUS NOT = '00'
 22082            MOVE ERPDEF-FILE-STATUS
 22083                                 TO WS-ABEND-FILE-STATUS
 22084            MOVE 'ERPDEF'        TO WS-CEM-FILE-NAME
 22085            MOVE CMSG            TO WS-ABEND-MESSAGE
 22086            GO TO ABEND-PGM
 22087        END-IF
 22088        IF ELSTAT-FILE-STATUS NOT = '00'
 22089            MOVE ELSTAT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 410
* EL517.cbl
 22090                                 TO WS-ABEND-FILE-STATUS
 22091            MOVE 'ELSTAT'        TO WS-CEM-FILE-NAME
 22092            MOVE CMSG            TO WS-ABEND-MESSAGE
 22093            GO TO ABEND-PGM
 22094        END-IF
 22095     END-IF
 22096
 22097     IF ELCNTL-FILE-STATUS NOT = '00'
 22098         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22099         MOVE 'ELCNTL'              TO WS-CEM-FILE-NAME
 22100         MOVE CMSG TO WS-ABEND-MESSAGE
 22101         GO TO ABEND-PGM.
 22102
 22103     IF ERPNDB-FILE-STATUS NOT = '00'
 22104         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22105         MOVE 'ERPNDB'              TO WS-CEM-FILE-NAME
 22106         MOVE CMSG TO WS-ABEND-MESSAGE
 22107         GO TO ABEND-PGM.
 22108
 22109     IF ERREIN-FILE-STATUS NOT = '00'
 22110         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22111         MOVE 'ERREIN'              TO WS-CEM-FILE-NAME
 22112         MOVE CMSG TO WS-ABEND-MESSAGE
 22113         GO TO ABEND-PGM.
 22114
 22115     IF ELCERT-FILE-STATUS NOT = '00'
 22116         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22117         MOVE 'ELCERT'              TO WS-CEM-FILE-NAME
 22118         MOVE CMSG TO WS-ABEND-MESSAGE
 22119         GO TO ABEND-PGM.
 22120
 22121     IF ERMAIL-OPEN   = 'X'
 22122       IF ERMAIL-FILE-STATUS NOT = '00'
 22123           MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22124           MOVE 'ERMAIL'              TO WS-CEM-FILE-NAME
 22125           MOVE CMSG TO WS-ABEND-MESSAGE
 22126           GO TO ABEND-PGM.
 22127
 22128     IF ERPNDM-OPEN   = 'X'
 22129       IF ERPNDM-FILE-STATUS NOT = '00'
 22130            MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22131            MOVE 'ERPNDM'              TO WS-CEM-FILE-NAME
 22132            MOVE CMSG TO WS-ABEND-MESSAGE
 22133            GO TO ABEND-PGM.
 22134
 22135     IF ELCRTT-OPEN = 'X'
 22136         IF ELCRTT-FILE-STATUS NOT = '00'
 22137             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22138             MOVE 'ELCRTT'              TO WS-CEM-FILE-NAME
 22139             MOVE CMSG TO WS-ABEND-MESSAGE
 22140             GO TO ABEND-PGM
 22141         END-IF
 22142     END-IF.
 22143
 22144     IF ELCRTO-OPEN = 'X'
 22145         IF ELCRTO-FILE-STATUS NOT = '00'
 22146             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22147             MOVE 'ELCRTO'              TO WS-CEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 411
* EL517.cbl
 22148             MOVE CMSG TO WS-ABEND-MESSAGE
 22149             GO TO ABEND-PGM
 22150         END-IF
 22151     END-IF.
 22152
 22153     IF ERCTBL-FILE-STATUS NOT = '00'
 22154         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22155         MOVE 'ERCTBL'              TO WS-CEM-FILE-NAME
 22156         MOVE CMSG TO WS-ABEND-MESSAGE
 22157         GO TO ABEND-PGM.
 22158
 22159     IF ERPLAN-FILE-STATUS NOT = '00'
 22160        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
 22161        MOVE 'ERPLAN '           TO WS-CEM-FILE-NAME
 22162        MOVE CMSG TO WS-ABEND-MESSAGE
 22163        GO TO ABEND-PGM.
 22164
 22165     IF ERACCT-FILE-STATUS NOT = '00'
 22166         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22167         MOVE 'ERACCT'              TO WS-CEM-FILE-NAME
 22168         MOVE CMSG TO WS-ABEND-MESSAGE
 22169         GO TO ABEND-PGM.
 22170
 22171     IF ERCOMP-FILE-STATUS NOT = '00'
 22172         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22173         MOVE 'ERCOMP'              TO WS-CEM-FILE-NAME
 22174         MOVE CMSG TO WS-ABEND-MESSAGE
 22175         GO TO ABEND-PGM.
 22176
 22177     IF ERBXRF-FILE-STATUS NOT = '00'
 22178         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22179         MOVE 'ERBXRF'              TO WS-CEM-FILE-NAME
 22180         MOVE CMSG TO WS-ABEND-MESSAGE
 22181         GO TO ABEND-PGM.
 22182
 22183     IF ERAGTC-FILE-STATUS NOT = '00'
 22184         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22185         MOVE 'ERAGTC'              TO WS-CEM-FILE-NAME
 22186         MOVE CMSG TO WS-ABEND-MESSAGE
 22187         GO TO ABEND-PGM.
 22188
 22189     IF ELCERR-FILE-STATUS NOT = '00'
 22190         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22191         MOVE 'ELCERR'              TO WS-CEM-FILE-NAME
 22192         MOVE CMSG TO WS-ABEND-MESSAGE
 22193         GO TO ABEND-PGM.
 22194
 22195     MOVE 'C'                     TO CP-IO-FUNCTION.
 22196     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22197
 22198     IF IO-ERROR
 22199        MOVE SPACE                TO WS-ABEND-FILE-STATUS
 22200        MOVE 'ELRATE'             TO WS-CEM-FILE-NAME
 22201        MOVE CMSG                 TO WS-ABEND-MESSAGE
 22202        GO TO ABEND-PGM.
 22203
 22204     OPEN OUTPUT PRINT-FILE.
 22205
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 412
* EL517.cbl
 22206     MOVE CF-CL-MAIL-TO-NAME     TO H2-COMP.
 22207     MOVE WS-CURRENT-DATE        TO H2-DATE.
 22208     MOVE ALPH-DATE              TO H3-DATE.
 22209     MOVE TRAN-CT                TO SUM-TOT.
 22210
 22211 7000-PRT-HDG.
 22212     MOVE HDG1 TO PRT   MOVE '1' TO X.
 22213     PERFORM 7000-PRINT-LINE.
 22214     MOVE HDG2 TO PRT   MOVE ' ' TO X.
 22215     PERFORM 7000-PRINT-LINE.
 22216     MOVE HDG3 TO PRT   MOVE ' ' TO X.
 22217     PERFORM 7000-PRINT-LINE.
 22218     MOVE SUM1 TO PRT   MOVE '0' TO X.
 22219     PERFORM 7000-PRINT-LINE.
 22220     GO TO 9999-END-JOB.
 22221
 22222 7000-HDG-XIT.
 22223     EXIT.
 22224
 22225 7000-PRINT-LINE.
*22226                     COPY ELCPRT2X.
 22227******************************************************************04/15/98
 22228*                                                                *ELCPRT2X
 22229*                                                                *ELCPRT2X
 22230*                            ELCPRT2X.                           *   LV002
 22231*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22232*                            VMOD=2.002                          *   CL**2
 22233*                                                                *ELCPRT2X
 22234*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
 22235*                                                                *ELCPRT2X
 22236*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
 22237*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
 22238*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
 22239*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
 22240*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
 22241*                                                                *ELCPRT2X
 22242*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
 22243*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
 22244******************************************************************ELCPRT2X
 22245                                                                  ELCPRT2X
 22246     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
 22247         FICH-OPEN   = SPACE                                      ELCPRT2X
 22248         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
 22249         OPEN OUTPUT FICH.                                        ELCPRT2X
 22250                                                                  ELCPRT2X
 22251     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22252         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
 22253             OPEN I-O ELREPT                                      ELCPRT2X
 22254             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
 22255                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
 22256                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
 22257                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
 22258                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
 22259                 GO TO ABEND-PGM                                  ELCPRT2X
 22260             ELSE                                                 ELCPRT2X
 22261                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
 22262                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22263                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 413
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22264                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22265                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22266                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22267                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22268                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22269                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
 22270                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22271                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22272                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22273                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22274                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22275                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
 22276                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22277                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
 22278                                                                  ELCPRT2X
 22279     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
 22280        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
 22281         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
 22282         GO TO ABEND-PGM.                                         ELCPRT2X
 22283                                                                  ELCPRT2X
 22284     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22285         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
 22286         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
 22287             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
 22288                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
 22289                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
 22290                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
 22291                     INVALID KEY                                  ELCPRT2X
 22292                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
 22293                         CLOSE ELREPT                             ELCPRT2X
 22294                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
 22295                                                                  ELCPRT2X
 22296     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
 22297         MOVE X                      TO  P-CTL                    ELCPRT2X
 22298         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
 22299                                                                  ELCPRT2X
 22300     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
 22301       MOVE X                        TO  P-CTL                    ELCPRT2X
 22302       IF P-CTL = ' '                                             ELCPRT2X
 22303         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
 22304       ELSE                                                       ELCPRT2X
 22305         IF P-CTL = '0'                                           ELCPRT2X
 22306           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
 22307         ELSE                                                     ELCPRT2X
 22308           IF P-CTL = '-'                                         ELCPRT2X
 22309             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
 22310           ELSE                                                   ELCPRT2X
 22311             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
 22312                                                                  ELCPRT2X
 22313     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
 22314                                                                  ELCPRT2X
 22315 DTE-REPORT-DELETE.                                               ELCPRT2X
 22316     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
 22317         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
 22318         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
 22319                                                                  ELCPRT2X
 22320     READ ELREPT   NEXT RECORD                                    ELCPRT2X
 22321           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 414
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22322                                                                  ELCPRT2X
 22323     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
 22324        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
 22325         DELETE ELREPT RECORD                                     ELCPRT2X
 22326         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
 22327                                                                  ELCPRT2X
 22328 DTE-DELETE-EXIT.                                                 ELCPRT2X
 22329     EXIT.                                                        ELCPRT2X
 22330                                                                  ELCPRT2X
 22331 DTE-PRINT-EXIT.                                                  ELCPRT2X
 22332     EXIT.                                                        ELCPRT2X
 22333******************************************************************ELCPRT2X
 22334
 22335 REIN-DATE-LOAD.
*22336     COPY ELCRENM1.
 22337******************************************************************04/15/98
 22338*                                                                *ELCRENM1
 22339*                                                                *ELCRENM1
 22340*                            ELCRENM1                            *   LV002
 22341*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22342*                            VMOD=2.001                          *ELCRENM1
 22343*                                                                *ELCRENM1
 22344*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCRENM1
 22345*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCRENM1
 22346*                                                                *ELCRENM1
 22347******************************************************************ELCRENM1
 22348     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.       CL**2
 22349     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.       CL**2
 22350     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.        CL**2
 22351                                                                  ELCRENM1
 22352
 22353 7000-PRINT-LINE-XIT.
 22354      EXIT.
 22355
 22356 9999-END-JOB.
 22357     CLOSE PRINT-FILE.
*22358             COPY ELCPRTCX.
 22359******************************************************************04/15/98
 22360*                                                                *ELCPRTCX
 22361*                                                                *ELCPRTCX
 22362*                            ELCPRTCX.                           *   LV003
 22363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22364*                            VMOD=2.003                          *   CL**3
 22365*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
 22366*                                                                *ELCPRTCX
 22367* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 22368******************************************************************ELCPRTCX
 22369                                                                  ELCPRTCX
 22370      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
 22371          CLOSE FICH.                                             ELCPRTCX
 22372                                                                  ELCPRTCX
 22373      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
 22374          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
 22375          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
 22376          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
 22377          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
 22378          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
 22379          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 415
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
 22380          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
 22381          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
 22382              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22383              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22384              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22385                  UPON CONSOLE                                    ELCPRTCX
 22386              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22387                  UPON CONSOLE                                    ELCPRTCX
 22388            ELSE                                                  ELCPRTCX
 22389              DISPLAY '***************************************'   ELCPRTCX
 22390              DISPLAY '***************************************'   ELCPRTCX
 22391              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
 22392              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
 22393              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
 22394              DISPLAY '**                                   **'   ELCPRTCX
 22395              DISPLAY '***************************************'   ELCPRTCX
 22396              DISPLAY '***************************************'   ELCPRTCX
 22397              CLOSE ELREPT.                                       ELCPRTCX
 22398                                                                  ELCPRTCX
 22399      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
 22400          DISPLAY '***************************************'       ELCPRTCX
 22401          DISPLAY '***************************************'       ELCPRTCX
 22402          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22403          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
 22404          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
 22405          DISPLAY '**                                   **'       ELCPRTCX
 22406          DISPLAY '***************************************'       ELCPRTCX
 22407          DISPLAY '***************************************'       ELCPRTCX
 22408          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22409                                                                  ELCPRTCX
 22410      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
 22411          DISPLAY '***************************************'       ELCPRTCX
 22412          DISPLAY '***************************************'       ELCPRTCX
 22413          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22414          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
 22415          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
 22416          DISPLAY '**                                   **'       ELCPRTCX
 22417          DISPLAY '***************************************'       ELCPRTCX
 22418          DISPLAY '***************************************'       ELCPRTCX
 22419          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22420                                                                  ELCPRTCX
 22421                                                                  ELCPRTCX
 22422******************************************************************ELCPRTCX
 22423
 22424     GOBACK.
 22425
 22426 ABEND-PGM.
*                   COPY ELCABEND.
 22427***************************************************************** 04/14/98
 22428*                                                               * ELCABEND
 22429*                            ELCABEND.                          *    LV003
 22430*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22431*                            VMOD 2.002                              CL**2
 22432*                                                               * ELCABEND
 22433*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22434*            AND THEN ABENDS.                                   * ELCABEND
 22435*                                                               * ELCABEND
 22436*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
* Micro Focus Server Express         V5.1 revision 000 19-Aug-13 14:05 Page 416
* EL517.cbl (/apps/prod/cid1p/copy/ELCABEND)
 22437*                                                               * ELCABEND
 22438***************************************************************** ELCABEND
 22439*APS-010.                                                         ELCABEND
 22440     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22441     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22442                                                                  ELCABEND
 22443     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22444         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22445         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22446                                 UPON CONSOLE.                    ELCABEND
 22447                                                                  ELCABEND
 22448     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22449         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22450         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22451                                 UPON CONSOLE.                    ELCABEND
 22452                                                                  ELCABEND
 22453     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22454     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22455                                 UPON CONSOLE.                    ELCABEND
 22456                                                                  ELCABEND
 22457     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22458     CALL 'ABORTME'.
 22459                                                                  ELCABEND
 22460 APS-EXIT.                                                        ELCABEND
 22461     EXIT.                                                        ELCABEND
 22462
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      116640     Code:       91185
