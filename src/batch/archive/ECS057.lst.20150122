* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* ECS057.cbl
* Options: int("ECS057.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS057.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS057.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS057.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         04/18/98
     2                                                                  ECS057
     3 PROGRAM-ID.                ECS057.                                  LV004
     4                                                                  ECS057
     5*AUTHOR.       SUZAN VUKOV.                                       ECS057
     6                                                                  ECS057
     7*REMARKS.                                                         ECS057
     8*        CREATE PERIODIC FEE PAYMENT HISTORY REPORT
     9*
    10******************************************************************
    11*                   C H A N G E   L O G
    12*
    13* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* ECS057.cbl
    14*-----------------------------------------------------------------
    15*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    16* EFFECTIVE    NUMBER
    17*-----------------------------------------------------------------
    18* 032703   2001061800003   SMVA  NEW PROGRAM
    19* 033104                 SMVA  ADD ME DATE TO HEADER & CHG RPT
    20*                              AMTS TO CASH RECEIVED FROM GROSS
    21* 062304   2004061600004   PEMA  ADD CANCELATION PROCESSING
    22* 060308 IR2008050500002   PEMA  PROCESS GIANTS ONLY
    23* 070808 IR2008070700001   PEMA  ADD CODES TO GIANT LIST
    24* 071212 CR2012020100004   PEMA  ADD 10C BENEFIT CODES TO LIST
    25******************************************************************
    26                                                                  ECS057
    27 ENVIRONMENT DIVISION.                                            ECS057
    28 CONFIGURATION SECTION.                                           ECS057
    29                                                                     CL**3
    30 INPUT-OUTPUT SECTION.                                            ECS057
    31 FILE-CONTROL.                                                    ECS057
    32                                                                  ECS057
    33     SELECT PRT-RPT          ASSIGN TO SYS008.
    34
    35     SELECT SORTFL           ASSIGN TO SORTWK1.
    36
    37     SELECT OFFLN-CERT-IN    ASSIGN TO SYS010.
    38
    39     SELECT DISK-DATE        ASSIGN TO SYS019.
    40
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* ECS057.cbl
    42 DATA DIVISION.                                                   ECS057
    43 FILE SECTION.                                                    ECS057
    44                                                                  ECS057
    45 FD  PRT-RPT                                                      ECS057
*   46                             COPY ELCPRTFD.                       ECS057
    47******************************************************************04/15/98
    48*                                                                *ELCPRTFD
    49*                                                                *ELCPRTFD
    50*                            ELCPRTFD.                           *   LV003
    51*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    52*                            VMOD=2.006                          *ELCPRTFD
    53******************************************************************ELCPRTFD
    54     RECORDING MODE F                                             ELCPRTFD
    55     LABEL RECORDS OMITTED                                        ELCPRTFD
    56     BLOCK CONTAINS 0 RECORDS
    57     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
    58 01  PRT.                                                         ELCPRTFD
    59     12  P-CTL               PIC  X.                                 CL**2
    60     12  P-DATA              PIC  X(132).                         ELCPRTFD
    61******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* ECS057.cbl
    63 FD  OFFLN-CERT-IN.
*   64                             COPY ECSCRT01.
    65******************************************************************
    66*                                                                *
    67*                            ECSCRT01                            *
    68*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    69*                            VMOD=2.016                          *
    70*                                                                *
    71*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
    72*                                                                *
    73*   FILE TYPE = SEQUENTIAL
    74*   RECORD SIZE = 1056 RECFORM = FIXED                           *
    75*                                                                *
    76*   KEY DATA =                         START=4, LEN=36           *
    77*                                                                *
    78*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
    79*                                                                *
    80******************************************************************
    81******************************************************************
    82*                   C H A N G E   L O G
    83*
    84* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    85*-----------------------------------------------------------------
    86*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    87* EFFECTIVE    NUMBER
    88*-----------------------------------------------------------------
    89* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    90* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    91* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    92* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
    93* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    94* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    95* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    96* 032612  CR2011110200001  PEMA  AHL CHANGES
    97******************************************************************
    98
    99 01  CERTIFICATE-RECORD.
   100     12  CR-RECORD-ID                      PIC XX.
   101         88  VALID-CR-ID                      VALUE 'CR'.
   102
   103     12  CR-COMPANY-CD                     PIC X.
   104
   105     12  CR-FULL-CONTROL.
   106         16  CR-CONTROL-1.
   107             20  CR-ACCT-CONTROL.
   108                 24  CR-CARRIER            PIC X.
   109                 24  CR-GROUPING.
   110                     28  CR-GROUP-PREFIX   PIC XXX.
   111                     28  CR-GROUP-PRIME    PIC XXX.
   112                 24  CR-STATE              PIC XX.
   113                 24  CR-ACCOUNT.
   114                     28  CR-ACCT-PREFIX    PIC X(4).
   115                     28  CR-ACCT-PRIME     PIC X(6).
   116             20  CR-DT                     PIC 9(11)  COMP-3.
   117         16  CR-CERT-NO.
   118             20  CR-CERT.
   119                 24  CR-CERT-PREFIX        PIC X(3).
   120                 24  CR-CERT-PRIME         PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* ECS057.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   121             20  CR-CERT-SFX               PIC X.
   122
   123     12  CR-INSUREDS-PROFILE.
   124         16  CR-NAME.
   125             20  CR-LNAME                  PIC X(15).
   126             20  CR-FNAME.
   127                 24  CR-1ST-INITIAL        PIC X.
   128                 24  FILLER                PIC X(9).
   129             20  CR-INIT                   PIC X.
   130         16  CR-AGE                        PIC 99.
   131         16  CR-SEX                        PIC X.
   132             88  CR-SEX-MALE                  VALUE 'M'.
   133             88  CR-SEX-FEMALE                VALUE 'F'.
   134         16  CR-SOC-SEC                    PIC X(11).
   135         16  CR-JOINT-NAME.
   136             20  CR-JT-LNAME               PIC X(15).
   137             20  CR-JT-FNAME.
   138                 24  CR-JT-1ST-INIT        PIC X.
   139                 24  FILLER                PIC X(9).
   140             20  CR-JT-INIT                PIC X.
   141         16  CR-JOINT-AGE                  PIC 99.
   142
   143         16  cr-ahl-ah-claim-no            pic x(9).
   144         16  cr-ahl-ah-cert-seq            pic x(3).
   145         16  cr-hst-proc-lf                pic x.
   146         16  f                             pic x(7).
   147
   148     12  CR-LF-COVERAGE-DATA.
   149         16  CR-LFTYP                      PIC XX.
   150         16  CR-LF-TERM                    PIC S999       COMP-3.
   151         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   152         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   153         16  CR-LF-DEV-CODE                PIC XXX.
   154         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   155
   156         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   157         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   158         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   159         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   160
   161         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   162         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   163         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   164         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   165
   166         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   167         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   168
   169         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   170         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   171
   172         16  CR-LF-REFUND-TYPE             PIC X.
   173         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   174
   175         16  CR-LF-COMM-CHARGEBACK         PIC X.
   176             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   177
   178         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* ECS057.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   179
   180         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   181         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   182         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   183
   184         16  cr-ahl-lf-claim-no            pic x(9).
   185         16  cr-ahl-lf-cert-seq            pic x(3).
   186         16  FILLER                        PIC XX.
   187
   188     12  CR-AH-COVERAGE-DATA.
   189         16  CR-AHTYP                      PIC XX.
   190         16  CR-AH-TERM                    PIC S999       COMP-3.
   191         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   192         16  CR-AH-DEV-CODE                PIC XXX.
   193         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   194
   195         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   196         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   197         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   198         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   199
   200         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   201         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   202
   203         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   204         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   205
   206         16  CR-AH-REFUND-TYPE             PIC X.
   207         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   208
   209         16  CR-AH-COMM-CHARGEBACK         PIC X.
   210             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   211
   212         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   213
   214         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   215         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   216         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   217
   218         16  FILLER                        PIC XX.
   219*        16  FILLER                        PIC X(8).
   220
   221     12  CR-LOAN-DATA.
   222         16  CR-LIVES                      PIC S9(7)      COMP-3.
   223         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   224                                           PIC S9(5)V99   COMP-3.
   225         16  CR-BILLED                     PIC S9(7)      COMP-3.
   226         16  CR-APR                        PIC S999V9(4)  COMP-3.
   227         16  CR-PMT-FREQ                   PIC 99.
   228         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   229         16  CR-RATING-CLASS               PIC XX.
   230         16  CR-POLICY-FORM-NO             PIC X(12).
   231         16  CR-GRPTYP                     PIC XX.
   232         16  CR-IND-GRP                    PIC X.
   233             88  CR-INDIVIDUAL                VALUE '1'.
   234             88  CR-GROUP                     VALUE '2'.
   235         16  CR-SKIP                       PIC 99.
   236             88  NO-MONTHS-SKIPPED            VALUE 00.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* ECS057.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   237             88  SKIP-JULY                    VALUE 01.
   238             88  SKIP-AUGUST                  VALUE 02.
   239             88  SKIP-SEPTEMBER               VALUE 03.
   240             88  SKIP-JULY-AUG                VALUE 04.
   241             88  SKIP-AUG-SEPT                VALUE 05.
   242             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   243             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   244             88  SKIP-JUNE                    VALUE 08.
   245             88  SKIP-JUNE-JULY               VALUE 09.
   246             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   247             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   248         16  CR-RESIDENT-STATE             PIC XX.
   249         16  CR-RATE-CODE.
   250             20  CR-LF-CLASS-CD            PIC XX.
   251             20  CR-AH-CLASS-CD            PIC XX.
   252         16  CR-MORT.
   253             20  CR-TAB                    PIC X.
   254             20  CR-INT                    PIC 99.
   255             20  CR-GRP                    PIC X.
   256         16  CR-MEMBER-NO                  PIC X(12).
   257         16  CR-OLD-LOF                    PIC XXX.
   258*        16  CR-LOAN-OFFICER               PIC XXX.
   259         16  CR-REIN-TABLE                 PIC XXX.
   260         16  CR-REIN-SPEC                  PIC X.
   261         16  CR-LOAN-1ST-PMT-DT.
   262             20  CR-1ST-PMT-YR             PIC 99.
   263             20  CR-1ST-PMT-MO             PIC 99.
   264             20  CR-1ST-PMT-DA             PIC 99.
   265         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   266         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   267         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   268         16  CR-LAST-ADD-ON-DT             PIC XX.
   269
   270         16  CR-UNDERWRITING-CODE          PIC X.
   271             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   272
   273         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   274         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   275         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   276         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   277
   278     12  CR-STATUS-INFORMATION.
   279         16  CR-ENTRY-STATUS               PIC X.
   280             88  CR-NORMAL-ENTRY              VALUE '1'.
   281             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   282             88  CR-CONVERSION-ENTRY          VALUE '4'.
   283             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   284             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   285             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   286             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   287             88  CR-POLICY-IS-VOID            VALUE 'V'.
   288             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   289             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   290                                                    '5' '9' 'P'.
   291         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   292
   293         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   294         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* ECS057.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   295         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   296
   297         16  CR-LF-STATUS-AT-DEATH         PIC X.
   298         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   299
   300         16  CR-LF-CURRENT-STATUS          PIC X.
   301             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   302             88  CR-LF-POLICY-PENDING         VALUE '2'.
   303             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   304             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   305             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   306             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   307             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   308             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   309             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   310             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   311             88  CR-LF-IS-DECLINED            VALUE 'D'.
   312             88  CR-LF-IS-VOID                VALUE 'V'.
   313             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   314                                                    '4' '5' '9'.
   315
   316         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   317
   318         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   319         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   320
   321         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   322         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   323
   324         16  CR-AH-CURRENT-STATUS          PIC X.
   325             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   326             88  CR-AH-POLICY-PENDING         VALUE '2'.
   327             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   328             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   329             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   330             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   331             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   332             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   333             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   334             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   335             88  CR-AH-IS-DECLINED            VALUE 'D'.
   336             88  CR-AH-IS-VOID                VALUE 'V'.
   337             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   338                                                    '4' '5' '9'.
   339         16  CR-LOAN-OFFICER               PIC X(5).
   340         16  CR-CANCEL-REASON              PIC X.
   341         16  cr-xycor-lf-cov-code          pic x(4).
   342         16  cr-xycor-ah-cov-code          pic x(4).
   343         16  FILLER                        PIC X(6).
   344
   345     12  CR-DEATH-CLAIM-DATA.
   346         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   347
   348         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   349         16  CR-DTH-RPT-DT.
   350             20  CR-DTH-RPT-YR             PIC 99.
   351             20  CR-DTH-RPT-MO             PIC 99.
   352             20  CR-DTH-RPT-DA             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* ECS057.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   353         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   354
   355         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   356         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   357         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   358         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   359         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   360
   361         16  CR-DTH-AGE                    PIC 99.
   362         16  CR-DTH-PAY-CD                 PIC X.
   363         16  CR-DEATH-CAUSE                PIC X(6).
   364
   365         16  FILLER                        PIC X(16).
   366
   367     12  CR-DISAB-CLAIM-DATA.
   368         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   369
   370         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   371         16  CR-DIS-RPT-DT.
   372             20  CR-DIS-RPT-YR             PIC 99.
   373             20  CR-DIS-RPT-MO             PIC 99.
   374             20  CR-DIS-RPT-DA             PIC 99.
   375         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   376         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   377
   378         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   379         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   380         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   381         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   382         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   383
   384         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   385         16  CR-DIS-PAY-CD                 PIC X.
   386         16  FILLER                        PIC XX.
   387
   388         16  CR-DISAB-INCURRED-DETAIL.
   389             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   390**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   391                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   392                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   393                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   394
   395         16  CR-DISAB-CAUSE                PIC X(6).
   396         16  FILLER                        PIC X(14).
   397
   398     12  CR-REMIT-TO                       PIC 99.
   399
   400     12  CR-COMPENSATION-LEVELS.
   401         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   402             20  CR-COM-AGT.
   403                 24  CR-COM-AGT-PREFIX     PIC X(4).
   404                 24  CR-COM-AGT-PRIME      PIC X(6).
   405             20  CR-AGT-TYPE               PIC X.
   406             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   407             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   408
   409     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   410     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* ECS057.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   411     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   412     12  CR-CLP-STATE                      PIC XX.
   413     12  CR-POST-CARD-IND                  PIC X.
   414     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   415     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   416     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   417     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   418     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   419     12  FILLER                            PIC X(07).
   420
   421     12  CR-CSR-CODE                       PIC XXX.
   422
   423     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   424     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   425
   426     12  CR-MICROFILM-NUMBERS.
   427*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   428         16  FILLER                        PIC X(5).
   429     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   430
   431     12  CR-USER-CODE                      PIC X.
   432     12  CR-USER-FUTURE                    PIC X(9).
   433
   434     12  CR-BENEFICIARY.
   435         16  CR-BANK-NO                    PIC X(10).
   436         16  FILLER                        PIC X(15).
   437
   438     12  CR-ENTRY-BATCH                    PIC X(6).
   439     12  CR-LF-EXIT-BATCH                  PIC X(6).
   440     12  CR-AH-EXIT-BATCH                  PIC X(6).
   441
   442     12  CR-NOTE-SW                        PIC X.
   443
   444     12  CR-ORIGIN-INDICATOR               PIC X.
   445         88  CR-ENTERED-MANUALLY              VALUE '1'.
   446         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   447
   448     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   449     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   450     12  FILLER                            PIC X(33).
   451
   452******************************************************************
   453                                                                  ECS057
   454 FD  DISK-DATE                                                    ECS057
*  455                             COPY ELCDTEFD.                       ECS057
   456******************************************************************04/15/98
   457*                                                                *ELCDTEFD
   458*                                                                *ELCDTEFD
   459*                            ELCDTEFD.                           *   LV002
   460*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   461*                            VMOD=2.007                          *   CL**2
   462*                                                                *ELCDTEFD
   463******************************************************************ELCDTEFD
   464     BLOCK CONTAINS 0 RECORDS
   465     RECORDING MODE F.                                            ELCDTEFD
   466                                                                  ELCDTEFD
   467 01  DATE-DISK.                                                   ELCDTEFD
   468     12  DD-ID                       PIC  X(4).                   ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   469     12  FILLER                      PIC  X(14).                  ELCDTEFD
   470     12  DD-CR1                      PIC  9.                      ELCDTEFD
   471     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   472     12  DD-CR2                      PIC  9.                      ELCDTEFD
   473     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   474     12  FILLER                      PIC  X(20).                  ELCDTEFD
   475                                                                  ELCDTEFD
   476 01  DATE-DISK-R.                                                 ELCDTEFD
   477     12  FILLER                      PIC  X(4).                   ELCDTEFD
   478     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   479                                     PIC  X(32).                  ELCDTEFD
   480                                                                  ELCDTEFD
   481 01  DATE-DISK-T.                                                 ELCDTEFD
   482     12  FILLER                      PIC  X(4).                   ELCDTEFD
   483     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   484                                     PIC  X(48).                  ELCDTEFD
   485                                                                  ELCDTEFD
   486 01  DATE-DISK-M.                                                 ELCDTEFD
   487     12  FILLER                      PIC  X(4).                   ELCDTEFD
   488     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   489                                     PIC  X(48).                  ELCDTEFD
   490                                                                  ELCDTEFD
   491 01  DATE-DISK-P.                                                 ELCDTEFD
   492     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   493     12  DD-IDX                      PIC  99.                     ELCDTEFD
   494     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   495     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   496         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   497                                     PIC  X.                      ELCDTEFD
   498         16  FILLER                  PIC  X(46).                  ELCDTEFD
   499     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   500         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   501             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   502             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   503             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   504             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   505         16  FILLER                  PIC  X(16).                  ELCDTEFD
   506                                                                  ELCDTEFD
   507 01  DATE-DISK-E.                                                 ELCDTEFD
   508     12  FILLER                      PIC  X(4).                   ELCDTEFD
   509     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   510                                     PIC  X(4).                   ELCDTEFD
   511                                                                  ELCDTEFD
   512 01  DATE-DISK-C.                                                 ELCDTEFD
   513     12  FILLER                      PIC  X(7).                   ELCDTEFD
   514     12  DD-CARR1-SECPAY-SW          PIC  X.
   515     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   516     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   517     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   518     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   519     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   520     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   521     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   522     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   523     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   524     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   525     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   526     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   527     12  DD-CARR2-SECPAY-SW          PIC  X.
   528     12  FILLER                      PIC  X(7).                   ELCDTEFD
   529                                                                  ELCDTEFD
   530 01  DATE-DISK-OPT.                                               ELCDTEFD
   531     12  FILLER                      PIC  X(04).                  ELCDTEFD
   532     12  DD-TLR-DATA.                                             ELCDTEFD
   533         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   534                                     PIC  X(03).                  ELCDTEFD
   535     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   536         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   537                                     PIC  X(06).                  ELCDTEFD
   538     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   539         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   540                                     PIC  X(07).                  ELCDTEFD
   541         16  FILLER                  PIC  X(05).                  ELCDTEFD
   542     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   543                                     PIC  X(96).                  ELCDTEFD
   544******************************************************************ELCDTEFD
   545
   546 SD  SORTFL.
   547
   548 01  SRT-REC.
   549     12  SRT-STATE               PIC XX.
   550     12  SRT-ACCOUNT             PIC X(10).
   551     12  SRT-ENTRY-DT            PIC 9(11)  COMP-3.
   552     12  SRT-BATCH-NO            PIC X(6).
   553     12  SRT-EFF-DT              PIC 9(11)  COMP-3.
   554     12  SRT-AMOUNT              PIC S9(9)V99 COMP-3.
   555
   556 WORKING-STORAGE SECTION.                                         ECS057
   557 77  FILLER  PIC  X(32) VALUE '********************************'. ECS057
   558 77  FILLER  PIC  X(32) VALUE '     ECS057 WORKING STORAGE     '. ECS057
   559 77  FILLER  PIC  X(32) VALUE '********** VMOD=2.008 **********'.    CL**3
   560                                                                  ECS057
   561 77  WK-YR                   PIC S9(5)   COMP-3  VALUE +0.        ECS057
   562 77  PAGER                   PIC S9(5)   COMP-3  VALUE +1.        ECS057
   563 77  X                       PIC  X.                              ECS057
   564
   565 01  WS-COUNTERS-AND-SUBS.
   566     05  MONTH-SUB            COMP    PIC S9(03) VALUE +0.
   567     05  SAVE-1ST-EFF-MONTH           PIC 9(03)  VALUE 0.
   568     05  COLUMN-SUB           COMP    PIC S9(02) VALUE +0.
   569     05  SUB                  COMP    PIC S9(03) VALUE +0.
   570     05  SUB1                 COMP    PIC S9(03) VALUE +0.
   571     05  SUB2                 COMP    PIC S9(03) VALUE +0.
   572     05  SUB3                 COMP    PIC S9(03) VALUE +0.
   573     05  PROCMO               COMP    PIC S9(03) VALUE +0.
   574     05  EFFMO                COMP    PIC S9(03) VALUE +0.
   575     05  EFFMOCOL             COMP    PIC S9(03) VALUE +0.
   576     05  MOHDR                COMP    PIC S9(03) VALUE +0.
   577     05  PGM-SUB              COMP    PIC S9(03) VALUE +57.
   578     05  WS-LINE-COUNT        COMP-3  PIC S9(03) VALUE +56.
   579     05  WS-LINE-COUNT-MAX    COMP-3  PIC S9(03) VALUE +55.
   580     05  WS-PAGE              COMP-3  PIC S9(05) VALUE +0.
   581
   582 01  WS-DATES.
   583     05  WS-HDR-EFF-CCYY              PIC 9(04)  VALUE 0.
   584     05  WS-HDR-EFF-CCYY-2                       REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* ECS057.cbl
   585         WS-HDR-EFF-CCYY.
   586         10  WS-HDR-EFF-CC            PIC 9(02).
   587         10  WS-HDR-EFF-YY            PIC 9(02).
   588
   589     05  WS-CR-ENTRY-DATE             PIC 9(11).
   590     05  WS-CR-ENTRY-DATE-R                      REDEFINES
   591         WS-CR-ENTRY-DATE.
   592         10  FILLER                   PIC 9(03).
   593         10  WS-CR-ENTRY-CYMD.
   594             15  WS-CR-ENTRY-CC       PIC 9(02).
   595             15  WS-CR-ENTRY-YY       PIC 9(02).
   596             15  WS-CR-ENTRY-MM       PIC 9(02).
   597             15  WS-CR-ENTRY-DD       PIC 9(02).
   598
   599     05  WS-LF-EXIT-DATE              PIC 9(11).
   600     05  WS-LF-EXIT-DATE-R                      REDEFINES
   601         WS-LF-EXIT-DATE.
   602         10  FILLER                   PIC 9(03).
   603         10  WS-LF-EXIT-CYMD.
   604             15  WS-LF-EXIT-CC       PIC 9(02).
   605             15  WS-LF-EXIT-YY       PIC 9(02).
   606             15  WS-LF-EXIT-MM       PIC 9(02).
   607             15  WS-LF-EXIT-DD       PIC 9(02).
   608
   609     05  WS-AH-EXIT-DATE              PIC 9(11).
   610     05  WS-AH-EXIT-DATE-R                      REDEFINES
   611         WS-AH-EXIT-DATE.
   612         10  FILLER                   PIC 9(03).
   613         10  WS-AH-EXIT-CYMD.
   614             15  WS-AH-EXIT-CC       PIC 9(02).
   615             15  WS-AH-EXIT-YY       PIC 9(02).
   616             15  WS-AH-EXIT-MM       PIC 9(02).
   617             15  WS-AH-EXIT-DD       PIC 9(02).
   618
   619     05  WS-EARLIEST-PROCESS-DT.
   620         10  WS-EARLIEST-PROC-DT-CCYY PIC 9(04)  VALUE 0.
   621         10  WS-EARLIEST-PROC-DT-MM   PIC 9(02)  VALUE 0.
   622         10  WS-EARLIEST-PROC-DT-DD   PIC 9(02)  VALUE 0.
   623
   624     05  WS-CERT-EFF-DT               PIC 9(11).
   625     05  WS-CERT-EFF-DT-R                        REDEFINES
   626         WS-CERT-EFF-DT.
   627         10  FILLER                   PIC 9(03).
   628         10  WS-CERT-EFF-CYMD.
   629             15  WS-CERT-EFF-CC       PIC 9(02).
   630             15  WS-CERT-EFF-YY       PIC 9(02).
   631             15  WS-CERT-EFF-MM       PIC 9(02).
   632             15  WS-CERT-EFF-DD       PIC 9(02).
   633
   634     05  WS-HOLD-ENTRY-DATE           PIC 9(11)  VALUE 0.
   635     05  WS-HOLD-ENTRY-DATE-R                    REDEFINES
   636         WS-HOLD-ENTRY-DATE.
   637         10  FILLER                   PIC 9(03).
   638         10  WS-HOLD-ENTRY-CYMD.
   639             15  WS-HOLD-ENTRY-CC     PIC X(02).
   640             15  WS-HOLD-ENTRY-YY     PIC X(02).
   641             15  WS-HOLD-ENTRY-MM     PIC X(02).
   642             15  FILLER               PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* ECS057.cbl
   643
   644     05  WS-HOLD-EXIT-DATE            PIC 9(11)  VALUE 0.
   645     05  WS-HOLD-EXIT-DATE-R                     REDEFINES
   646         WS-HOLD-EXIT-DATE.
   647         10  FILLER                   PIC 9(03).
   648         10  WS-HOLD-EXIT-CYMD.
   649             15  WS-HOLD-EXIT-CC      PIC X(02).
   650             15  WS-HOLD-EXIT-YY      PIC X(02).
   651             15  WS-HOLD-EXIT-MM      PIC X(02).
   652             15  FILLER               PIC X(02).
   653
   654 01  WS-SWITCHES.
   655     05  WS-EOF-OFFLN-CERT            PIC X(01)  VALUE SPACE.
   656         88  EOF                                 VALUE '1'.
   657
   658     05  WS-FIRST-TIME-SW             PIC X(01)  VALUE SPACE.
   659         88  NOT-FIRST-TIME                      VALUE 'X'.
   660
   661     05  WS-DETAIL-LINE-SW            PIC X(01)  VALUE SPACE.
   662         88  DETAIL-LN-NOT-DONE                  VALUE '1'.
   663         88  DETAIL-LN-WITH-PREMIUM-DONE         VALUE '2'.
   664
   665     05  WS-SUBTOTAL-SW               PIC X(01)  VALUE SPACE.
   666         88  SUBTOT-NOT-NEEDED                   VALUE '1'.
   667         88  SUBTOT-REQUIRED-FOR-PROCMO          VALUE '2'.
   668
   669     05  WS-MON-TOTAL-SW              PIC X(01)  VALUE SPACE.
   670         88  NEW-MONTH-TOTAL                     VALUE '1'.
   671         88  TOTAL-FOR-MONTH-DONE                VALUE '2'.
   672
   673 01  WS-MISC.
   674     05  WS-HOLD-ACCT                 PIC X(10)  VALUE SPACES.
   675     05  WS-HOLD-STATE                PIC X(02)  VALUE SPACES.
   676     05  WS-HOLD-ENTRY-BATCH          PIC X(06)  VALUE SPACES.
   677     05  WS-HOLD-ALPHA-MO             PIC X(03)  VALUE SPACES.
   678     05  WS-HOLD-PREV-ACCT            PIC X(10)  VALUE SPACES.
   679     05  WS-HOLD-PREV-MM              PIC X(02)  VALUE SPACES.
   680     05  WS-HOLD-PREV-YY              PIC X(02)  VALUE SPACES.
   681
   682     05  WS-PREMIUM-PAYMENT           PIC S9(07)V99
   683                                                 VALUE ZEROS.
   684
   685
   686
   687
   688***** THE FOLLOWING TOTAL TABLES DEFINED FOR EACH ACCOUNT
   689******************************************************************
   690 01  WS-PAYMENT-BYBATCH-TABLE.
   691     05  WS-PAYMENT-BYBATCH         COMP-3   PIC S9(07)V99
   692                                                 VALUE ZEROS
   693                                                 OCCURS 12 TIMES.
   694
   695 01  WS-PAYMENT-BYPROCMO-TABLE.
   696     05  WS-PAYMENT-BYPROCMO        COMP-3   PIC S9(07)V99
   697                                                 VALUE ZEROS
   698                                                 OCCURS 12 TIMES.
   699
   700 01  WS-12MO-TOTALS-TABLE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* ECS057.cbl
   701     05  WS-PAYMENT-12MOTOTS-BYACCT COMP-3   PIC S9(07)V99
   702                                                 VALUE ZEROS
   703                                                 OCCURS 12 TIMES.
   704
   705
   706***** THE FOLLOWING TOTAL TABLES DEFINED TO SUMMARIZE ALL ACCOUNTS
   707******************************************************************
   708 01  WS-ALLACCT-PAYMENTS-TABLE.
   709     05  WS-ALLACCT-BYPROCMO  OCCURS 12 TIMES.
   710         10  WS-ALLACCT-BYPROCMO-EFFMO COMP-3 PIC S9(07)V99
   711                                                 VALUE ZEROS
   712                                                 OCCURS 12 TIMES.
   713
   714 01  WS-ALLACCT-12MO-TOTALS-TABLE.
   715     05  WS-ALLACCT-12MOTOTS          COMP-3 PIC S9(07)V99
   716                                                 VALUE ZEROS
   717                                                 OCCURS 12 TIMES.
   718******************************************************************
   719
   720 01  WS-TOT-PAYMENTS-PROCMO          COMP-3  PIC S9(07)V99
   721                                                 VALUE ZEROS.
   722
   723 01  WS-12MO-ACCT-TOTAL              COMP-3  PIC S9(07)V99
   724                                                 VALUE ZEROS.
   725
   726 01  WS-12MO-ALLACCT-GRAND-TOTAL     COMP-3  PIC S9(07)V99
   727                                                 VALUE ZEROS.
   728
   729******************************************************************
   730
   731 01  MONTH-TAB.
   732     05  MONTH-TB1.
   733         10  FILLER                   PIC X(03)  VALUE 'JAN'.
   734         10  FILLER                   PIC X(03)  VALUE 'FEB'.
   735         10  FILLER                   PIC X(03)  VALUE 'MAR'.
   736         10  FILLER                   PIC X(03)  VALUE 'APR'.
   737         10  FILLER                   PIC X(03)  VALUE 'MAY'.
   738         10  FILLER                   PIC X(03)  VALUE 'JUN'.
   739         10  FILLER                   PIC X(03)  VALUE 'JUL'.
   740         10  FILLER                   PIC X(03)  VALUE 'AUG'.
   741         10  FILLER                   PIC X(03)  VALUE 'SEP'.
   742         10  FILLER                   PIC X(03)  VALUE 'OCT'.
   743         10  FILLER                   PIC X(03)  VALUE 'NOV'.
   744         10  FILLER                   PIC X(03)  VALUE 'DEC'.
   745     05  MONTH-TB2  REDEFINES  MONTH-TB1.
   746         10  ALPHA-MONTH              PIC X(03)  OCCURS 12 TIMES.
   747
   748 01  WS-NUMERIC-MONTH-TAB.
   749     05  MONTH-TB3.
   750         10  FILLER                   PIC X(02)  VALUE '01'.
   751         10  FILLER                   PIC X(02)  VALUE '02'.
   752         10  FILLER                   PIC X(02)  VALUE '03'.
   753         10  FILLER                   PIC X(02)  VALUE '04'.
   754         10  FILLER                   PIC X(02)  VALUE '05'.
   755         10  FILLER                   PIC X(02)  VALUE '06'.
   756         10  FILLER                   PIC X(02)  VALUE '07'.
   757         10  FILLER                   PIC X(02)  VALUE '08'.
   758         10  FILLER                   PIC X(02)  VALUE '09'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* ECS057.cbl
   759         10  FILLER                   PIC X(02)  VALUE '10'.
   760         10  FILLER                   PIC X(02)  VALUE '11'.
   761         10  FILLER                   PIC X(02)  VALUE '12'.
   762     05  MONTH-TB4                               REDEFINES
   763         MONTH-TB3.
   764         10  NUMERIC-MONTH            PIC X(02)  OCCURS 12 TIMES.
   765
   766 01  WS-ACCOUNT-HEADING.
   767     05  FILLER                       PIC X(01)  VALUE '0'.
   768     05  FILLER                       PIC X(10)  VALUE
   769         'ACCOUNT - '.
   770     05  WS-H-ACCOUNT                 PIC X(10)  VALUE SPACES.
   771     05  FILLER                       PIC X(06)  VALUE SPACES.
   772     05  WS-H-LITERAL                 PIC X(08)  VALUE
   773         'STATE - '.
   774     05  WS-H-STATE                   PIC X(02)  VALUE SPACES.
   775     05  FILLER                       PIC X(96)  VALUE SPACES.
   776
   777
   778 01  WS-HEADING1.
   779     05  FILLER                       PIC X(01)  VALUE '1'.
   780     05  FILLER                       PIC X(47)  VALUE SPACES.
   781     05  WS-H1-TITLE                  PIC X(28)  VALUE
   782         'PERIODIC FEE PAYMENT HISTORY'.
   783     05  FILLER                       PIC X(45)  VALUE SPACES.
   784     05  WS-H1-REPORT-ID              PIC X(06)  VALUE 'ECS057'.
   785     05  FILLER                       PIC X(06)  VALUE SPACES.
   786
   787
   788 01  WS-HEADING2.
   789     05  FILLER                       PIC X(01)  VALUE SPACE.
   790     05  FILLER                       PIC X(46)  VALUE SPACES.
   791     05  WS-H2-COMPANY-NAME           PIC X(30)  VALUE SPACES.
   792     05  FILLER                       PIC X(44)  VALUE SPACES.
   793     05  WS-H2-DATE                   PIC X(08)  VALUE SPACES.
   794     05  FILLER                       PIC X(04)  VALUE SPACES.
   795
   796
   797 01  WS-HEADING3.
   798     05  FILLER                       PIC X(01)  VALUE SPACE.
   799     05  FILLER                       PIC X(52)  VALUE SPACES.
   800     05  WS-H3-MONTHEND-DT            PIC X(18)  VALUE SPACES.
   801     05  FILLER                       PIC X(50)  VALUE SPACES.
   802     05  FILLER                       PIC X(04)  VALUE 'PAGE'.
   803     05  FILLER                       PIC X(01)  VALUE SPACES.
   804     05  WS-H3-PAGE                   PIC ZZ,ZZ9.
   805     05  FILLER                       PIC X(01)  VALUE SPACE.
   806
   807
   808 01  WS-HEADING4.
   809     05  FILLER                       PIC X(01)  VALUE '0'.
   810     05  FILLER                       PIC X(44)  VALUE SPACES.
   811     05  FILLER                       PIC X(33)  VALUE
   812         'MASTER CERTIFICATE EFFECTIVE DATE'.
   813     05  FILLER                       PIC X(55)  VALUE SPACES.
   814
   815
   816 01  WS-HEADING5.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* ECS057.cbl
   817     05  FILLER                       PIC X(01)  VALUE ' '.
   818     05  FILLER                       PIC X(12)  VALUE SPACES.
   819     05  WS-H5-EFFECTIVE-MONTHS       PIC X(120) VALUE SPACES.
   820     05  WS-H5-EFFECTIVE-MONTHS-R                REDEFINES
   821         WS-H5-EFFECTIVE-MONTHS.
   822         10  WS-H5-EFF-MOYY                      OCCURS 12 TIMES.
   823             15  FILLER               PIC X(05).
   824             15  WS-H5-EFF-MO         PIC X(03).
   825             15  WS-H5-EFF-YY         PIC X(02).
   826
   827
   828 01  WS-HEADING6.
   829     05  FILLER                       PIC X(01)  VALUE SPACE.
   830     05  FILLER                       PIC X(09)  VALUE
   831         'PROCESSED'.
   832     05  FILLER                       PIC X(125) VALUE SPACES.
   833
   834
   835 01  WS-HEADING7.
   836     05  FILLER                       PIC X(01)  VALUE SPACE.
   837     05  WS-H7-VARIABLE-HDR          PIC X(15)  VALUE
   838         'DATE AND BATCH#'.
   839     05  FILLER                       PIC X(117) VALUE SPACES.
   840
   841
   842 01  WS-DETAIL.
   843     05  WS-D1-PRINT-CTL              PIC X(01)   VALUE ' '.
   844     05  WS-D1-PROCESS-DATE.
   845         10  WS-D1-PROCESS-MO         PIC X(03)   VALUE SPACES.
   846         10  WS-D1-PROCESS-YY         PIC X(02)   VALUE SPACES.
   847     05  WS-D1-BATCH-NO               PIC X(06)   VALUE SPACES.
   848     05  FILLER                       PIC X(01)   VALUE SPACES.
   849     05  WS-D1-PAYMENT                PIC ZZZZZ9.99-
   850                                                  OCCURS 12 TIMES.
   851
   852
   853 01  WS-WK.
   854     12  WS-RETURN-CODE               PIC X(04)   VALUE SPACES.
   855     12  WS-ABEND-MESSAGE             PIC X(80)   VALUE SPACES.
   856     12  WS-ZERO                      PIC S9(01)  VALUE ZERO.
   857     12  WS-ABEND-FILE-STATUS         PIC X(02)   VALUE SPACES.
   858                                                                  ECS057
*  859     COPY ELCDTECX.                                               ECS057
   860******************************************************************06/05/98
   861*                                                                *ELCDTECX
   862*                            ELCDTECX.                           *   LV005
   863*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   864*                            VMOD=2.015                          *ELCDTECX
   865*                                                                *ELCDTECX
   866*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   867*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   868*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   869*                                                                *ELCDTECX
   870******************************************************************ELCDTECX
   871******************************************************************
   872*                   C H A N G E   L O G
   873*
   874* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   875*-----------------------------------------------------------------
   876*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   877* EFFECTIVE    NUMBER
   878*-----------------------------------------------------------------
   879* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   880*                                  BENEFIT CODES FROM 300 TO 900
   881* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   882* 051304    2003080800002  SMVA  ADD REFUND METHOD
   883******************************************************************
   884 01  DATE-CARD.                                                   ELCDTECX
   885     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   886     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   887     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   888     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   889     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   890     12  EP-SW                       PIC  X.                      ELCDTECX
   891         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   892     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   893         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   894     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   895     12  RUN-CENTURY.                                             ELCDTECX
   896         16 RUN-CENTURY-N            PIC  99.                        CL**4
   897     12  FILLER                      PIC  X.                         CL**4
   898     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   899     12  FILLER                      PIC  XXX.                    ELCDTECX
   900     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   901                                                                  ELCDTECX
   902 01  FILLER                          PIC  X(7)                       CL**6
   903                                          VALUE 'OPTIONS'.        ELCDTECX
   904 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   905     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   906     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   907     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   908         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   909         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   910     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   911     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   912     12  FILLER                      PIC  X.                      ELCDTECX
   913     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   914     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   915     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   916     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   917     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   918     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   919     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   920     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   921     12  FILLER                      PIC  X.                      ELCDTECX
   922     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   923     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   924     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   925     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   926     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   927     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   928     12  FILLER                      PIC  X.                      ELCDTECX
   929     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   930     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   931     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   932     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   933     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   934     12  DTE-R78                     PIC  X.                      ELCDTECX
   935     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   936     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   937     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   938     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   939     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   940     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   941     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   942                                     PIC  X.                      ELCDTECX
   943         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   944                                                 ' '.             ELCDTECX
   945         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   946         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   947     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   948         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   949         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   950     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   951     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   952                                     PIC  9.                         CL**4
   953     12  DTE-SYSTEM.                                              ELCDTECX
   954         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   955         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   956         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   957         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   958         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   959         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   960         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   961         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   962         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   963         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   964         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   965         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   966         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   967         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   968         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   969         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   970         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   971         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   972         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   973         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   974         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   975         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   976         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   977         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   978         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   979         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   980     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   981         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   982                                     PIC  X.                      ELCDTECX
   983     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   984                                                                  ELCDTECX
   985 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   986     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   987     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   988     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   989*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   990     12  FILLER                      PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   991     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   992     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   993     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   994     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   995     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   996     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   997     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   998                                                                  ELCDTECX
   999     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1000     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1001     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1002     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1003                                                                  ELCDTECX
  1004     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1005     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1006     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1007     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1008                                                                  ELCDTECX
  1009     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1010     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1011                                                                  ELCDTECX
  1012     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1013     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1014                                                                  ELCDTECX
  1015     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1016                                                                  ELCDTECX
  1017 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1018     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1019     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1020     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1021     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1022     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1023     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1024     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1025                                                                  ELCDTECX
  1026 01  FILLER                          PIC  X(12)                   ELCDTECX
  1027                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1028 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1029     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1030         16  CNT-ID                  PIC  X.                      ELCDTECX
  1031         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1032                                                                  ELCDTECX
  1033 01  FILLER                          PIC  X(11)                   ELCDTECX
  1034                                          VALUE 'STATE NAMES'.    ELCDTECX
  1035 01  STATE-NAMES.                                                 ELCDTECX
  1036     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1037         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1038         16  STATE-PIC1.                                          ELCDTECX
  1039             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1040             20  FILLER              PIC  XXX.                    ELCDTECX
  1041             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1042             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1043             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1044             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1045                                                                  ELCDTECX
  1046 01  FILLER                          PIC  X(13)                   ELCDTECX
  1047                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1048 01  CARRIER-NAMES.                                               ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1049     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1050         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1051         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1052         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1053         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1054         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1055         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1056*        16  FILLER                  PIC  X.                      ELCDTECX
  1057         16  CARRIER-SEC-PAY         PIC  X.
  1058             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1059                                                                  ELCDTECX
  1060 01  FILLER                          PIC  X(9)                       CL**6
  1061                                          VALUE 'INS TYPES'.      ELCDTECX
  1062 01  CLAS-INS-TYPES.                                              ELCDTECX
  1063*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1064     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1065         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1066         16  CLAS-I-AB3.                                          ELCDTECX
  1067             20  FILLER              PIC  X.                      ELCDTECX
  1068             20  CLAS-I-AB2.                                      ELCDTECX
  1069                 24  FILLER          PIC  X.                      ELCDTECX
  1070                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1071         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1072             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1073             20  FILLER              PIC  X.                         CL**4
  1074         16  CLAS-I-AB10.                                         ELCDTECX
  1075             20  FILLER              PIC  X(9).                   ELCDTECX
  1076             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1077         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1078         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1079         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1080         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1081             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1082         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1083         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1084         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1085         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1086         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  1087         16  FILLER                  PIC  X(05).
  1088                                                                  ELCDTECX
  1089 01  FILLER                          PIC  X(16)                   ELCDTECX
  1090                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1091 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1092     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1093                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1094         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1095         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1096         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1097         16  CLAS-MORT-DESC.                                      ELCDTECX
  1098             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1099             20  FILLER              PIC  XX.                        CL**5
  1100             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1101             20  FILLER              PIC  X.                         CL**5
  1102             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1103             20  FILLER              PIC  X.                         CL**5
  1104             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1105             20  FILLER              PIC  X.                         CL**5
  1106             20  CLAS-INTEREST       PIC  99.99.                     CL**5
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1107             20  FILLER              PIC  X(5).                      CL**6
  1108                                                                  ELCDTECX
  1109 01  FILLER                          PIC  X(15)                   ELCDTECX
  1110                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1111 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1112     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1113         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1114         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1115         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1116         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1117         16  FILLER                  PIC  X(4).                      CL**6
  1118                                                                  ELCDTECX
  1119 01  FILLER                          PIC  X(7)                       CL**6
  1120                                     VALUE 'INDEXES'.             ELCDTECX
  1121 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1122     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1123     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1124     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1125     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1126     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1127     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1128     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1129     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1130     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1131     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1132     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1133     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1134     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1135     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1136     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1137     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1138     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1139                                                                  ELCDTECX
  1140 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1141     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1142     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1143     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1144     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1145     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1146     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1147     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1148     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1149     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1150     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1151     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1152                                                                  ELCDTECX
  1153 01  FILLER                          PIC  X(13)                   ELCDTECX
  1154                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1155 01  CLAS-MISC.                                                   ELCDTECX
  1156     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1157         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1158         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1159         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1160     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1161     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1162     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1163     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1164     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1165     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1166     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1167     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1168     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1169     12  STATE-L                     PIC  XX.                     ELCDTECX
  1170     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1171     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1172     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1173         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1174         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1175     12  DTE-ABEND-WORK.                                          ELCDTECX
  1176         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1177         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1178                                                                  ELCDTECX
  1179 01  FILLER                          PIC  X(12)                   ELCDTECX
  1180                                     VALUE 'WORKING DATE'.        ELCDTECX
  1181 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1182     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1183         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1184         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1185         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1186     12  WS-CURRENT-DATE.                                         ELCDTECX
  1187         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1188         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1189         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1190         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1191         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1192     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1193         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1194         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1195                                                                  ELCDTECX
  1196 01  FILLER                          PIC  X(12)                   ELCDTECX
  1197                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1198 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1199     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1200         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1201         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1202         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1203                                                                  ELCDTECX
  1204 01  FILLER                          PIC  X(10)                   ELCDTECX
  1205                                     VALUE 'STATE TLRS'.          ELCDTECX
  1206 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1207     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1208         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1209         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1210                                                                  ELCDTECX
  1211 01  FILLER                          PIC  X(13)                   ELCDTECX
  1212                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1213 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1214     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1215         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1216                                                                  ELCDTECX
  1217 01  FILLER                          PIC  X(13)                   ELCDTECX
  1218                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1219 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1220     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1221     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1222     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1223                                     PIC  X.                         CL**5
  1224     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1225     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1226     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1227     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1228     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1229     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1230     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1231     12  FILLER                      PIC  X(75).                  ELCDTECX
  1232******************************************************************ELCDTECX
  1233*01  MISC-CARR-PCT-DATA.                                          00001521
  1234*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1235*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1236*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1237*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1238*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1239*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1240******************************************************************ELCDTECX
  1241                                                                  ECS057
* 1242     COPY ELCDTEVR.                                               ECS057
  1243***************************************************************** 04/15/98
  1244*                                                                *ELCDTEVR
  1245*                                                                *ELCDTEVR
  1246*                            ELCDTEVR.                           *   LV003
  1247*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1248*                            VMOD=2.001                          *   CL**2
  1249*                                                                *ELCDTEVR
  1250*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1251*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1252*                                                                *ELCDTEVR
  1253******************************************************************ELCDTEVR
  1254 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1255     05  WS-RUN-DATE.                                             ELCDTEVR
  1256         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1257         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1258         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1259             15  RUN-CC              PIC  99.                     ELCDTEVR
  1260             15  RUN-YR              PIC  99.                     ELCDTEVR
  1261         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1262         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1263     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1264            WS-RUN-DATE              PIC 9(11).                      CL**2
  1265     05  WS-EP-DT.                                                ELCDTEVR
  1266         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1267         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1268         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1269             15  EP-CC               PIC  99.                     ELCDTEVR
  1270             15  EP-YR               PIC  99.                     ELCDTEVR
  1271         10  EP-MO                   PIC  99.                     ELCDTEVR
  1272         10  EP-DA                   PIC  99.                     ELCDTEVR
  1273     05  WS-EP-DT-N REDEFINES                                        CL**2
  1274            WS-EP-DT                 PIC 9(11).                      CL**2
  1275     05  WS-DTE-CONV-DT.                                             CL**4
  1276         10  FILLER                  PIC  9(03).                     CL**4
  1277         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1278         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1279             15  DTE-CONV-CC         PIC  99.                        CL**4
  1280             15  DTE-CONV-YR         PIC  99.                        CL**4
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1281         10  DTE-CONV-MO             PIC  99.                        CL**4
  1282         10  DTE-CONV-DA             PIC  99.                        CL**4
  1283     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1284            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1285 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1286     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1287         10  FILLER                            PIC 999.           ELCDTEVR
  1288         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1289         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1290             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1291             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1292         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1293         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1294     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1295            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1296     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1297         10  FILLER                            PIC 999.           ELCDTEVR
  1298         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1299         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1300         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1301         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1302     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1303            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1304 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1305     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1306         10  FILLER                            PIC 999.           ELCDTEVR
  1307         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1308         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1309             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1310             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1311         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1312         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1313     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1314            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1315     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1316         10  FILLER                            PIC 999.           ELCDTEVR
  1317         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1318         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1319             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1320             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1321         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1322         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1323     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1324            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1325     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1326         10  FILLER                            PIC 999.           ELCDTEVR
  1327         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1328         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1329             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1330             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1331         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1332         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1333     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1334            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1335 01  WS-RATE-RECORD.                                              ELCDTEVR
  1336         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1337             10  FILLER                        PIC 999.           ELCDTEVR
  1338             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1339             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1340                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1341                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1342             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1343             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1344         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1345                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1346                                                                  ECS057
* 1347     COPY ELCDATE.                                                   CL**4
  1348******************************************************************06/11/98
  1349*                                                                *ELCDATE
  1350*                                                                *ELCDATE
  1351*                            ELCDATE.                            *   LV023
  1352*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1353*                            VMOD=2.003                           ELCDATE
  1354*                                                                *ELCDATE
  1355*                                                                *ELCDATE
  1356*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1357*                 LENGTH = 200                                   *   CL*19
  1358******************************************************************ELCDATE
  1359                                                                  ELCDATE
  1360 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1361     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1362     12  DC-OPTION-CODE                PIC X.                        CL*15
  1363         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1364         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1365         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1366         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1367         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1368         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1369         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1370         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1371         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1372         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1373         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1374         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1375         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1376         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1377         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1378         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1379         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1380         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1381         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1382         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1383         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1384         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1385         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1386         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1387         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1388         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1389         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1390         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1391         88  THREE-CHARACTER-BIN                                  ELCDATE
  1392                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1393         88  GREGORIAN-TO-BIN                                        CL**2
  1394                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1395         88  BIN-TO-GREGORIAN                                        CL**2
  1396                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1397         88  JULIAN-TO-BINARY                                        CL**2
  1398                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1399     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1400         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1401         88  DATE-CONVERSION-ERROR                                ELCDATE
  1402                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1403         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1404         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1405         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1406         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1407         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1408         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1409         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1410         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1411         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1412         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1413     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1414         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1415     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1416         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1417         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1418         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1419     12  FILLER                        PIC X.                        CL*15
  1420     12  DC-CONVERSION-DATES.                                        CL*15
  1421         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1422         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1423         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1424         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1425                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1426             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1427             20  SLASH1-1              PIC X.                        CL*15
  1428             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1429             20  SLASH1-2              PIC X.                        CL*15
  1430             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1431         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1432         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1433                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1434             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1435             20  SLASH2-1              PIC X.                        CL*15
  1436             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1437             20  SLASH2-2              PIC X.                        CL*15
  1438             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1439         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1440         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1441                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1442             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1443             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1444             20  DC-YMD-DAY            PIC 99.                       CL*15
  1445         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1446         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1447                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1448             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1449             20  DC-MDY-DAY            PIC 99.                       CL*15
  1450             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1451         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1452             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1453             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1454             20  FILLER                PIC XX.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1455             20  DC-ALPHA-CENTURY.                                   CL*15
  1456                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1457             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1458         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1459         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1460         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1461         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1462         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1463                                       PIC 9(05).                    CL*20
  1464         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1465             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1466             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1467         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1468         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1469         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1470     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1471         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1472         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1473             20  FILLER                PIC 9(3).                     CL*15
  1474             20  HOLD-CEN-1-CCYY.                                    CL*15
  1475                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1476                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1477             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1478             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1479         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1480             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1481             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1482             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1483                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1484                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1485             20  FILLER                PIC 9(3).                     CL*15
  1486         16  HOLD-CENTURY-1-X.                                       CL*15
  1487             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1488             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1489                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1490                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1491             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1492             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1493         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1494             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1495             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1496             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1497                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1498                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1499             20  FILLER                PIC XXX.                      CL*23
  1500         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1501         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1502         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1503         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1504             20  DC-JULIAN-1-CCYY.                                   CL*15
  1505                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1506                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1507             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1508         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1509         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1510             20  DC-JULIAN-2-CCYY.                                   CL*15
  1511                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1512                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1513             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1514         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1515             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1516             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1517             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1518             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1519             20  DC-EDITA-CCYY.                                      CL*15
  1520                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1521                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1522         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1523             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1524             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1525             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1526             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1527             20  DC-EDITB-CCYY.                                      CL*15
  1528                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1529                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1530         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1531         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1532                              DC-GREG-DATE-CYMD.                  ELCDATE
  1533             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1534             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1535             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1536             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1537         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1538         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1539                              DC-GREG-DATE-MDCY.                  ELCDATE
  1540             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1541             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1542             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1543             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1544    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1545        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1546    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1547    12  FILLER                         PIC X(28).                    CL*26
  1548
  1549 LINKAGE SECTION.
  1550
  1551 01 PARM.
  1552    05  PARM-LENGTH          COMP     PIC S9(04)  VALUE ZEROS.
  1553    05  PARM-CYCLE-DT-CYMD            PIC X(08)   VALUE SPACES.
  1554
  1555 PROCEDURE DIVISION USING PARM.
  1556                                                                  ECS057
  1557 0000-MAIN.
* 1558                             COPY ELCDTERX.                       ECS057
  1559******************************************************************04/15/98
  1560*                                                                *ELCDTERX
  1561*                                                                *ELCDTERX
  1562*                            ELCDTERX.                           *   LV002
  1563*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1564*                            VMOD=2.007                          *ELCDTERX
  1565*                                                                *ELCDTERX
  1566*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1567*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1568*      = ELCDTEFD)                                               *ELCDTERX
  1569*                                                                *ELCDTERX
  1570******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1571                                                                  ELCDTERX
  1572     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1573                                                                  ELCDTERX
  1574     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1575     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1576     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1577                                                                  ELCDTERX
  1578     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1579                                                                  ELCDTERX
  1580******************************************************************ELCDTERX
  1581*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1582*          WARNING MESSAGES.                                      ELCDTERX
  1583******************************************************************ELCDTERX
  1584     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1585         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1586                                                                  ELCDTERX
  1587     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1588                                                                  ELCDTERX
  1589     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1590                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1591                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1592                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1593                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1594                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1595                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1596                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1597                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1598                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1599                                                                  ELCDTERX
  1600     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1601                                                                  ELCDTERX
  1602     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1603                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1604                                                                  ELCDTERX
  1605     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1606     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1607     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1608     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1609                                                                  ELCDTERX
  1610     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1611         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1612     ELSE                                                         ELCDTERX
  1613         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1614                                                                  ELCDTERX
  1615     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1616         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1617     ELSE                                                         ELCDTERX
  1618         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1619                                                                  ELCDTERX
  1620 0005-READ--CARD.                                                 ELCDTERX
  1621     READ DISK-DATE                                               ELCDTERX
  1622         AT END CLOSE DISK-DATE                                   ELCDTERX
  1623             GO TO 0060-READ--TEST.                               ELCDTERX
  1624                                                                  ELCDTERX
  1625     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1626                                                                  ELCDTERX
  1627     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1628         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1629         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1630         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1631         GO TO 0005-READ--CARD.                                   ELCDTERX
  1632                                                                  ELCDTERX
  1633     IF DD-ID = 'CLAD'                                            ELCDTERX
  1634         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1635         GO TO 0005-READ--CARD.                                   ELCDTERX
  1636                                                                  ELCDTERX
  1637     IF DD-ID = 'CLAX'                                            ELCDTERX
  1638         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1639         GO TO 0005-READ--CARD.                                   ELCDTERX
  1640                                                                  ELCDTERX
  1641     IF DD-ID = 'CLAF'                                            ELCDTERX
  1642         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1643         GO TO 0005-READ--CARD.                                   ELCDTERX
  1644                                                                  ELCDTERX
  1645     IF DD-ID = 'CLAC'                                            ELCDTERX
  1646         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1647                                                                  ELCDTERX
  1648     IF DD-ID = 'CARR'                                            ELCDTERX
  1649         GO TO 0015-READ--CARR.                                   ELCDTERX
  1650                                                                  ELCDTERX
  1651     IF DD-ID = 'STAT'                                            ELCDTERX
  1652         GO TO 0020-READ--STAT.                                   ELCDTERX
  1653                                                                  ELCDTERX
  1654     IF DD-ID = 'BUSC'                                            ELCDTERX
  1655         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1656                                                                  ELCDTERX
  1657     IF DD-ID = 'MORT'                                            ELCDTERX
  1658         GO TO 0030-READ--MORT.                                   ELCDTERX
  1659                                                                  ELCDTERX
  1660     IF DD-ID = 'CLAI'                                            ELCDTERX
  1661         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1662                                                                  ELCDTERX
  1663     IF DD-ID = 'COLC'                                            ELCDTERX
  1664         GO TO 0065-READ--COLC.                                   ELCDTERX
  1665                                                                  ELCDTERX
  1666     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1667        DD-IDA = 'CL'                                             ELCDTERX
  1668         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1669                                                                  ELCDTERX
  1670     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1671        DD-IDA = 'PO'                                             ELCDTERX
  1672         GO TO 0050-READ--POXX.                                   ELCDTERX
  1673                                                                  ELCDTERX
  1674     IF DD-ID = 'OPCA'                                            ELCDTERX
  1675         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1676                                                                  ELCDTERX
  1677     IF DD-ID = 'OPST'                                            ELCDTERX
  1678         GO TO 0072-READ--OPST.                                   ELCDTERX
  1679                                                                  ELCDTERX
  1680     IF DD-ID = 'OPBS'                                            ELCDTERX
  1681         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1682                                                                  ELCDTERX
  1683     IF DD-ID = 'OPMS'                                            ELCDTERX
  1684         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1685                                                                  ELCDTERX
  1686     GO TO 0005-READ--CARD.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1687                                                                  ELCDTERX
  1688 0010-READ--CLAC.                                                 ELCDTERX
  1689     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1690     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1691     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1692     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1693     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1694     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1695     GO TO 0005-READ--CARD.                                       ELCDTERX
  1696                                                                  ELCDTERX
  1697 0015-READ--CARR.                                                 ELCDTERX
  1698     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1699     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1700        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1701        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1702        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1703        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1704        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1705        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1706        MOVE DD-CARR1-SECPAY-SW
  1707                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1708     END-IF
  1709                                                                  ELCDTERX
  1710     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1711     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1712        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1713        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1714        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1715        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1716        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1717        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1718        MOVE DD-CARR2-SECPAY-SW
  1719                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1720     END-IF
  1721                                                                  ELCDTERX
  1722                                                                  ELCDTERX
  1723     GO TO 0005-READ--CARD.                                       ELCDTERX
  1724                                                                  ELCDTERX
  1725 0020-READ--STAT.                                                 ELCDTERX
  1726     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1727     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1728        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1729         GO TO 0005-READ--CARD.                                   ELCDTERX
  1730                                                                  ELCDTERX
  1731     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1732     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1733     GO TO 0020-READ--STAT.                                       ELCDTERX
  1734                                                                  ELCDTERX
  1735 0025-READ--BUSC.                                                 ELCDTERX
  1736     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1737     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1738        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1739         GO TO 0005-READ--CARD.                                   ELCDTERX
  1740                                                                  ELCDTERX
  1741     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1742     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1743     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1744                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1745 0030-READ--MORT.                                                 ELCDTERX
  1746     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1747     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1748        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1749         GO TO 0005-READ--CARD.                                   ELCDTERX
  1750                                                                  ELCDTERX
  1751     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1752     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1753     GO TO 0030-READ--MORT.                                       ELCDTERX
  1754                                                                  ELCDTERX
  1755 0035-READ--CLXX.                                                 ELCDTERX
  1756     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1757          GO TO 0005-READ--CARD.                                  ELCDTERX
  1758                                                                  ELCDTERX
  1759     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1760         DISPLAY '***********************************************'ELCDTERX
  1761         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1762         DISPLAY '***********************************************'ELCDTERX
  1763         GO TO 0055-READ--STOP.                                   ELCDTERX
  1764                                                                  ELCDTERX
  1765     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1766        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1767         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1768                                                                  ELCDTERX
  1769     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1770        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1771         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1772                                                                  ELCDTERX
  1773*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1774     GO TO 0005-READ--CARD.                                       ELCDTERX
  1775                                                                  ELCDTERX
  1776 0040-READ--CLAI.                                                 ELCDTERX
  1777     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1778     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1779        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1780         GO TO 0005-READ--CARD.                                   ELCDTERX
  1781                                                                  ELCDTERX
  1782     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1783     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1784     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1785                                                                  ELCDTERX
  1786 0045-READ--DUMP.                                                 ELCDTERX
  1787     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1788     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1789                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1790     PERFORM ABEND-PGM.                                           ELCDTERX
  1791                                                                  ELCDTERX
  1792 0050-READ--POXX.                                                 ELCDTERX
  1793     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1794         GO TO 0005-READ--CARD.                                   ELCDTERX
  1795                                                                  ELCDTERX
  1796     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1797         DISPLAY '***********************************************'ELCDTERX
  1798         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1799         DISPLAY '***********************************************'ELCDTERX
  1800         GO TO 0055-READ--STOP.                                   ELCDTERX
  1801                                                                  ELCDTERX
  1802     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1803     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1804     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1805     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1806                                                                  ELCDTERX
  1807     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1808         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1809     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1810         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1811                                                                  ELCDTERX
  1812     GO TO 0005-READ--CARD.                                       ELCDTERX
  1813                                                                  ELCDTERX
  1814 0055-READ--STOP.                                                 ELCDTERX
  1815     GOBACK.                                                      ELCDTERX
  1816                                                                  ELCDTERX
  1817 0060-READ--TEST.                                                 ELCDTERX
  1818     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1819        CLAX-ID         = SPACE  OR                               ELCDTERX
  1820        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1821         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1822                                                                  ELCDTERX
  1823     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1824     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1825                                                                  ELCDTERX
  1826 0065-READ--COLC.                                                 ELCDTERX
  1827     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1828     GO TO 0005-READ--CARD.                                       ELCDTERX
  1829                                                                  ELCDTERX
  1830 0070-READ--OPCA.                                                 ELCDTERX
  1831                                                                  ELCDTERX
  1832     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1833                                                                  ELCDTERX
  1834     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1835             OR                                                   ELCDTERX
  1836         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1837         GO TO 0005-READ--CARD.                                   ELCDTERX
  1838                                                                  ELCDTERX
  1839     ADD 1                       TO INDEXCA.                      ELCDTERX
  1840     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1841                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1842     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1843                                                                  ELCDTERX
  1844 0072-READ--OPST.                                                 ELCDTERX
  1845                                                                  ELCDTERX
  1846     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1847                                                                  ELCDTERX
  1848     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1849             OR                                                   ELCDTERX
  1850         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1851         GO TO 0005-READ--CARD.                                   ELCDTERX
  1852                                                                  ELCDTERX
  1853     ADD 1                       TO INDEXST.                      ELCDTERX
  1854     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1855                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1856     GO TO 0072-READ--OPST.                                       ELCDTERX
  1857                                                                  ELCDTERX
  1858 0074-READ--OPBS.                                                 ELCDTERX
  1859                                                                  ELCDTERX
  1860     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1861                                                                  ELCDTERX
  1862     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1863             OR                                                   ELCDTERX
  1864         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1865         GO TO 0005-READ--CARD.                                   ELCDTERX
  1866                                                                  ELCDTERX
  1867     ADD 1                       TO INDEXBS.                      ELCDTERX
  1868     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1869     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1870                                                                  ELCDTERX
  1871 0079-READ--EXIT.                                                 ELCDTERX
  1872*    EXIT.                                                        ELCDTERX
  1873******************************************************************ELCDTERX
  1874                                                                  ECS057
  1875     PERFORM 0050-EDIT-ME-CYCLE-DT    THRU 0050-EXIT
  1876     MOVE COMPANY-NAME                TO WS-H2-COMPANY-NAME
  1877     MOVE WS-CURRENT-DATE             TO WS-H2-DATE
  1878     MOVE SPACES                      TO WS-H5-EFFECTIVE-MONTHS
  1879
  1880     SUBTRACT +1                      FROM RUN-CCYY
  1881         GIVING WS-HDR-EFF-CCYY
  1882
  1883     COMPUTE MONTH-SUB = RUN-MO + +1
  1884     IF MONTH-SUB > +12
  1885         MOVE +1                      TO MONTH-SUB
  1886         MOVE RUN-CCYY                TO WS-HDR-EFF-CCYY
  1887     END-IF
  1888
  1889     MOVE MONTH-SUB                   TO SAVE-1ST-EFF-MONTH
  1890     MOVE WS-HDR-EFF-CCYY             TO WS-EARLIEST-PROC-DT-CCYY
  1891     MOVE NUMERIC-MONTH (MONTH-SUB)   TO WS-EARLIEST-PROC-DT-MM
  1892     MOVE '01'                        TO WS-EARLIEST-PROC-DT-DD
  1893
  1894     MOVE +1                          TO COLUMN-SUB
  1895     PERFORM 0100-EFF-MO-HDR          THRU 0100-EXIT
  1896         UNTIL COLUMN-SUB > +12
  1897
  1898     SORT SORTFL
  1899             ON ASCENDING KEY SRT-STATE
  1900                              SRT-ACCOUNT
  1901                              SRT-ENTRY-DT
  1902                              SRT-BATCH-NO
  1903                              SRT-EFF-DT
  1904         INPUT PROCEDURE 0010-INPUT-RTN  THRU 0019-EXIT
  1905        OUTPUT PROCEDURE 0020-OUTPUT-RTN THRU 0029-EXIT.
  1906
  1907     IF SORT-RETURN NOT = ZEROES
  1908         MOVE +0101                     TO  WS-RETURN-CODE
  1909         MOVE 'INTERNAL SORT ABORTED'   TO  WS-ABEND-MESSAGE
  1910         GO TO ABEND-PGM
  1911     END-IF
  1912
  1913     GOBACK
  1914
  1915     .
  1916 0010-INPUT-RTN SECTION.
  1917
  1918     PERFORM 8800-OPEN-FILES             THRU 8800-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* ECS057.cbl
  1919     PERFORM 0200-READ-SORTED-OFFLN-CERT THRU 0200-EXIT
  1920         UNTIL EOF
  1921     .
  1922 0019-EXIT.
  1923     EXIT.
  1924
  1925 0020-OUTPUT-RTN SECTION.
  1926
  1927
  1928     MOVE SPACES                 TO WS-EOF-OFFLN-CERT
  1929
  1930     PERFORM 0300-RETURN         THRU 0300-EXIT
  1931         UNTIL EOF
  1932
  1933********
  1934***** Need to print totals for last month of last account
  1935********
  1936     MOVE WS-CR-ENTRY-CYMD              TO WS-HOLD-ENTRY-CYMD
  1937     PERFORM 0225-WRITE-PREV-ACCUM-DATA THRU 0225-EXIT
  1938
  1939     IF SUBTOT-REQUIRED-FOR-PROCMO
  1940         PERFORM 0350-SUBTOTAL          THRU 0350-EXIT
  1941         SET SUBTOT-NOT-NEEDED          TO TRUE
  1942     END-IF
  1943
  1944     PERFORM 0240-TOTAL-FOR-PROCMO      THRU 0240-EXIT
  1945     PERFORM 0360-12MO-TOTAL-FOR-ACCT   THRU 0360-EXIT
  1946
  1947     PERFORM 0380-ALLACCT-SUMMARY       THRU 0380-EXIT
  1948     PERFORM 8900-CLOSE-FILES           THRU 8900-EXIT
  1949
  1950     .
  1951 0029-EXIT.
  1952     EXIT.
  1953
  1954                                                                  ECS057
  1955 0050-EDIT-ME-CYCLE-DT.
  1956
  1957   IF PARM-LENGTH = +0
  1958       DISPLAY 'CYCLE DATE INPUT PARM MISSING'
  1959       PERFORM ABEND-PGM            THRU APS-EXIT
  1960   END-IF
  1961
  1962   MOVE PARM-CYCLE-DT-CYMD          TO DC-GREG-DATE-CYMD
  1963   MOVE 'L'                         TO DC-OPTION-CODE
  1964   PERFORM 8500-DATE-CONVERSION     THRU 8500-EXIT
  1965
  1966   IF NO-CONVERSION-ERROR
  1967       MOVE DC-GREG-DATE-1-ALPHA    TO WS-H3-MONTHEND-DT
  1968   ELSE
  1969       DISPLAY 'INVALID ME CYCLE DATE ' PARM-CYCLE-DT-CYMD
  1970       PERFORM ABEND-PGM            THRU APS-EXIT
  1971   END-IF
  1972
  1973   .
  1974 0050-EXIT.
  1975     EXIT.
  1976
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  37
* ECS057.cbl
  1977 0100-EFF-MO-HDR.
  1978
  1979     MOVE ALPHA-MONTH (MONTH-SUB)   TO WS-H5-EFF-MO (COLUMN-SUB)
  1980     MOVE WS-HDR-EFF-YY             TO WS-H5-EFF-YY (COLUMN-SUB)
  1981                                                                  ECS057
  1982     ADD +1                         TO MONTH-SUB
  1983                                                                  ECS057
  1984     IF MONTH-SUB > +12
  1985         MOVE +1                    TO MONTH-SUB
  1986         MOVE RUN-CCYY              TO WS-HDR-EFF-CCYY
  1987     END-IF
  1988                                                                  ECS057
  1989     ADD +1                         TO COLUMN-SUB
  1990                                                                  ECS057
  1991     .
  1992
  1993 0100-EXIT.
  1994     EXIT.
  1995 0200-READ-SORTED-OFFLN-CERT.
  1996
  1997     READ OFFLN-CERT-IN
  1998         AT END
  1999             SET EOF                        TO TRUE
  2000             GO TO 0200-EXIT
  2001     END-READ
  2002
  2003     MOVE CR-ENTRY-DATE                     TO WS-CR-ENTRY-DATE
  2004     MOVE CR-LF-CANCEL-EXIT-DATE            TO WS-LF-EXIT-DATE
  2005     MOVE CR-AH-CANCEL-EXIT-DATE            TO WS-AH-EXIT-DATE
  2006
  2007********
  2008** Report goes back 12 months from current processing month
  2009********
  2010     IF (WS-CR-ENTRY-CYMD >= WS-EARLIEST-PROCESS-DT)
  2011        OR (WS-LF-EXIT-CYMD >= WS-EARLIEST-PROCESS-DT)
  2012        OR (WS-AH-EXIT-CYMD >= WS-EARLIEST-PROCESS-DT)
  2013        CONTINUE
  2014     ELSE
  2015         GO TO 0200-EXIT
  2016     END-IF
  2017
  2018     IF (CR-LFTYP = 'MJ' OR 'MS'
  2019         OR 'NJ' OR 'NL'
  2020         OR 'SJ' OR 'SL'
  2021         OR 'HJ' OR 'HL'
  2022         OR 'PL' OR 'PJ')
  2023        OR (CR-AHTYP =
  2024               'MJ' OR 'MS' OR 'MI' OR 'MU'
  2025            OR 'MX' OR 'MY' OR 'MZ'
  2026            OR 'NI' OR 'NJ' OR 'NL' OR 'NU'
  2027            OR 'SI' OR 'SJ' OR 'SL' OR 'SU'
  2028            OR 'HD' OR 'HE' OR 'HF' OR 'HG'
  2029            OR 'HJ' OR 'HL'
  2030            OR 'PL' OR 'PJ' OR 'PI' OR 'PU')
  2031        CONTINUE
  2032     ELSE
  2033        GO TO 0200-EXIT
  2034     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  38
* ECS057.cbl
  2035
  2036     IF WS-CR-ENTRY-CYMD >= WS-EARLIEST-PROCESS-DT
  2037        MOVE CR-STATE            TO SRT-STATE
  2038        MOVE CR-ACCOUNT          TO SRT-ACCOUNT
  2039        COMPUTE SRT-AMOUNT = (CR-LFPRM + CR-AHPRM) -
  2040                                 ((CR-LFPRM * CR-LCOM-L (1)) +
  2041                                 (CR-AHPRM * CR-LCOM-AH (1)))
  2042
  2043        MOVE CR-DT               TO SRT-EFF-DT
  2044        MOVE CR-ENTRY-DATE       TO SRT-ENTRY-DT
  2045        MOVE CR-ENTRY-BATCH      TO SRT-BATCH-NO
  2046        RELEASE SRT-REC
  2047     END-IF
  2048
  2049     IF WS-LF-EXIT-CYMD >= WS-EARLIEST-PROCESS-DT
  2050        MOVE CR-STATE            TO SRT-STATE
  2051        MOVE CR-ACCOUNT          TO SRT-ACCOUNT
  2052        COMPUTE SRT-AMOUNT = (CR-LFRFND
  2053           - (CR-LFRFND * CR-LCOM-L (1))) * -1
  2054        MOVE CR-LF-CANC-DT       TO SRT-EFF-DT
  2055        MOVE CR-LF-CANCEL-EXIT-DATE
  2056                                 TO SRT-ENTRY-DT
  2057        MOVE CR-LF-EXIT-BATCH    TO SRT-BATCH-NO
  2058        RELEASE SRT-REC
  2059     END-IF
  2060
  2061     IF WS-AH-EXIT-CYMD >= WS-EARLIEST-PROCESS-DT
  2062        MOVE CR-STATE            TO SRT-STATE
  2063        MOVE CR-ACCOUNT          TO SRT-ACCOUNT
  2064        COMPUTE SRT-AMOUNT = (CR-AHRFND
  2065           - (CR-AHRFND * CR-LCOM-AH (1))) * -1
  2066        MOVE CR-AH-CANC-DT       TO SRT-EFF-DT
  2067        MOVE CR-AH-CANCEL-EXIT-DATE
  2068                                 TO SRT-ENTRY-DT
  2069        MOVE CR-AH-EXIT-BATCH    TO SRT-BATCH-NO
  2070        RELEASE SRT-REC
  2071     END-IF
  2072
  2073     .
  2074 0200-EXIT.
  2075     EXIT.
  2076
  2077 0300-RETURN.
  2078
  2079     RETURN SORTFL
  2080         AT END
  2081             SET EOF                        TO TRUE
  2082             GO TO 0300-EXIT
  2083     END-RETURN
  2084
  2085     MOVE SRT-ENTRY-DT                    TO WS-CR-ENTRY-DATE
  2086
  2087********
  2088** Report goes back 12 months from current processing month
  2089********
  2090
  2091     IF SRT-ACCOUNT = WS-HOLD-ACCT
  2092        AND WS-CR-ENTRY-CYMD = WS-HOLD-ENTRY-CYMD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  39
* ECS057.cbl
  2093        AND SRT-BATCH-NO = WS-HOLD-ENTRY-BATCH
  2094         CONTINUE
  2095     ELSE
  2096         IF NOT-FIRST-TIME
  2097             PERFORM 0225-WRITE-PREV-ACCUM-DATA
  2098                                            THRU 0225-EXIT
  2099         ELSE
  2100             MOVE +1                        TO SUB
  2101             SET NOT-FIRST-TIME             TO TRUE
  2102             MOVE SRT-ACCOUNT               TO WS-H-ACCOUNT
  2103             MOVE SRT-STATE                 TO WS-H-STATE
  2104         END-IF
  2105
  2106         MOVE SRT-ACCOUNT                   TO WS-HOLD-ACCT
  2107         MOVE SRT-STATE                     TO WS-HOLD-STATE
  2108         MOVE WS-CR-ENTRY-CYMD              TO WS-HOLD-ENTRY-CYMD
  2109         MOVE SRT-BATCH-NO                  TO WS-HOLD-ENTRY-BATCH
  2110     END-IF
  2111
  2112     MOVE SRT-AMOUNT             TO WS-PREMIUM-PAYMENT
  2113     MOVE SRT-EFF-DT             TO WS-CERT-EFF-DT
  2114     MOVE WS-HOLD-ENTRY-MM       TO SUB1
  2115
  2116     PERFORM 0250-ACCUM-PAYMENTS
  2117                                 THRU 0250-EXIT
  2118
  2119
  2120     .
  2121 0300-EXIT.
  2122     EXIT.
  2123
  2124 0225-WRITE-PREV-ACCUM-DATA.
  2125
  2126**** Entry dates correspond to process dates on the report
  2127**** The input file is presorted in the job step prior to executing
  2128**** this program.  The sort order is account number, entry date,
  2129**** batch#, & eff date.
  2130
  2131***** IF there are multiple batches in the same month for the
  2132***** same account, don't bump to next process month.
  2133*    IF WS-HOLD-ENTRY-MM = WS-HOLD-PREV-MM
  2134*       AND WS-HOLD-ACCT = WS-HOLD-PREV-ACCT
  2135*        SUBTRACT +1                        FROM SUB
  2136*        SET SUBTOT-REQUIRED-FOR-PROCMO     TO TRUE
  2137*    END-IF
  2138
  2139     MOVE WS-HOLD-ENTRY-MM                  TO SUB2
  2140     PERFORM 0340-DETAIL-LINES              THRU 0340-EXIT
  2141         VARYING SUB FROM SUB BY +1
  2142         UNTIL DETAIL-LN-WITH-PREMIUM-DONE
  2143               OR SUB > +12
  2144     SUBTRACT +1                            FROM SUB
  2145
  2146     PERFORM 0370-CLEAR-PAYMENT-TABLE       THRU 0370-EXIT
  2147         VARYING COLUMN-SUB FROM +1 BY +1
  2148         UNTIL COLUMN-SUB > +12
  2149
  2150     SET DETAIL-LN-NOT-DONE                 TO TRUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  40
* ECS057.cbl
  2151
  2152     IF SUBTOT-REQUIRED-FOR-PROCMO
  2153        AND (WS-CR-ENTRY-MM NOT = WS-HOLD-ENTRY-MM
  2154            OR SRT-ACCOUNT NOT = WS-HOLD-ACCT)
  2155         PERFORM 0350-SUBTOTAL              THRU 0350-EXIT
  2156         SET SUBTOT-NOT-NEEDED              TO TRUE
  2157         PERFORM 0240-TOTAL-FOR-PROCMO      THRU 0240-EXIT
  2158         SET TOTAL-FOR-MONTH-DONE           TO TRUE
  2159     END-IF
  2160
  2161     IF WS-TOT-PAYMENTS-PROCMO NOT = +0
  2162        AND NOT TOTAL-FOR-MONTH-DONE
  2163         IF WS-CR-ENTRY-MM NOT = WS-HOLD-ENTRY-MM
  2164            OR SRT-ACCOUNT NOT = WS-HOLD-ACCT
  2165             PERFORM 0240-TOTAL-FOR-PROCMO  THRU 0240-EXIT
  2166         END-IF
  2167     END-IF
  2168
  2169     IF TOTAL-FOR-MONTH-DONE
  2170         SET NEW-MONTH-TOTAL                TO TRUE
  2171     END-IF
  2172
  2173     MOVE WS-HOLD-ENTRY-MM                  TO WS-HOLD-PREV-MM
  2174     MOVE WS-HOLD-ACCT                      TO WS-HOLD-PREV-ACCT
  2175
  2176     IF SRT-ACCOUNT = WS-HOLD-ACCT
  2177         CONTINUE
  2178     ELSE
  2179         PERFORM 0360-12MO-TOTAL-FOR-ACCT   THRU 0360-EXIT
  2180         MOVE +1                            TO SUB
  2181         MOVE SRT-ACCOUNT                   TO WS-H-ACCOUNT
  2182         MOVE SRT-STATE                     TO WS-H-STATE
  2183         MOVE +56                           TO WS-LINE-COUNT
  2184     END-IF
  2185
  2186     .
  2187 0225-EXIT.
  2188     EXIT.
  2189
  2190
  2191 0240-TOTAL-FOR-PROCMO.
  2192
  2193     MOVE SPACES                         TO WS-DETAIL
  2194     MOVE WS-HOLD-ALPHA-MO               TO WS-D1-PROCESS-MO
  2195     MOVE WS-HOLD-ENTRY-YY               TO WS-D1-PROCESS-YY
  2196     MOVE 'SUBTOT'                       TO WS-D1-BATCH-NO
  2197     MOVE WS-TOT-PAYMENTS-PROCMO         TO WS-D1-PAYMENT (1)
  2198     PERFORM 0400-PRINT-DETAIL           THRU 0400-EXIT
  2199     MOVE ZEROS                          TO WS-TOT-PAYMENTS-PROCMO
  2200     ADD +1                              TO SUB
  2201
  2202     MOVE SPACES                         TO WS-DETAIL
  2203     PERFORM 0400-PRINT-DETAIL           THRU 0400-EXIT
  2204
  2205     .
  2206 0240-EXIT.
  2207     EXIT.
  2208
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  41
* ECS057.cbl
  2209
  2210 0250-ACCUM-PAYMENTS.
  2211
  2212     EVALUATE TRUE
  2213     WHEN WS-CERT-EFF-MM = 01
  2214         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (1)
  2215         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (1)
  2216         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (1)
  2217         ADD WS-PREMIUM-PAYMENT
  2218                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 1)
  2219         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (1)
  2220
  2221     WHEN WS-CERT-EFF-MM = 02
  2222         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (2)
  2223         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (2)
  2224         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (2)
  2225         ADD WS-PREMIUM-PAYMENT
  2226                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 2)
  2227         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (2)
  2228
  2229     WHEN WS-CERT-EFF-MM = 03
  2230         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (3)
  2231         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (3)
  2232         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (3)
  2233         ADD WS-PREMIUM-PAYMENT
  2234                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 3)
  2235         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (3)
  2236
  2237     WHEN WS-CERT-EFF-MM = 04
  2238         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (4)
  2239         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (4)
  2240         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (4)
  2241         ADD WS-PREMIUM-PAYMENT
  2242                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 4)
  2243         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (4)
  2244
  2245     WHEN WS-CERT-EFF-MM = 05
  2246         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (5)
  2247         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (5)
  2248         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (5)
  2249         ADD WS-PREMIUM-PAYMENT
  2250                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 5)
  2251         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (5)
  2252
  2253     WHEN WS-CERT-EFF-MM = 06
  2254         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (6)
  2255         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (6)
  2256         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (6)
  2257         ADD WS-PREMIUM-PAYMENT
  2258                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 6)
  2259         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (6)
  2260
  2261     WHEN WS-CERT-EFF-MM = 07
  2262         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (7)
  2263         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (7)
  2264         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (7)
  2265         ADD WS-PREMIUM-PAYMENT
  2266                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 7)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  42
* ECS057.cbl
  2267         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (7)
  2268
  2269     WHEN WS-CERT-EFF-MM = 08
  2270         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (8)
  2271         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (8)
  2272         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (8)
  2273         ADD WS-PREMIUM-PAYMENT
  2274                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 8)
  2275         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (8)
  2276
  2277     WHEN WS-CERT-EFF-MM = 09
  2278         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (9)
  2279         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (9)
  2280         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (9)
  2281         ADD WS-PREMIUM-PAYMENT
  2282                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 9)
  2283         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (9)
  2284
  2285     WHEN WS-CERT-EFF-MM = 10
  2286         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (10)
  2287         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (10)
  2288         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (10)
  2289         ADD WS-PREMIUM-PAYMENT
  2290                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 10)
  2291         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (10)
  2292
  2293     WHEN WS-CERT-EFF-MM = 11
  2294         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (11)
  2295         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (11)
  2296         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (11)
  2297         ADD WS-PREMIUM-PAYMENT
  2298                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 11)
  2299         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (11)
  2300
  2301     WHEN WS-CERT-EFF-MM = 12
  2302         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (12)
  2303         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (12)
  2304         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (12)
  2305         ADD WS-PREMIUM-PAYMENT
  2306                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 12)
  2307         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (12)
  2308     END-EVALUATE
  2309
  2310     ADD WS-PREMIUM-PAYMENT     TO WS-TOT-PAYMENTS-PROCMO
  2311
  2312     .
  2313 0250-EXIT.
  2314     EXIT.
  2315
  2316
  2317 0340-DETAIL-LINES.
  2318
  2319     IF WS-H5-EFF-MO (SUB) = ALPHA-MONTH (SUB2)
  2320        AND WS-H5-EFF-YY (SUB) = WS-HOLD-ENTRY-YY
  2321         SET DETAIL-LN-WITH-PREMIUM-DONE   TO TRUE
  2322         MOVE ALPHA-MONTH (SUB2)           TO WS-HOLD-ALPHA-MO
  2323         MOVE WS-HOLD-ENTRY-BATCH          TO WS-D1-BATCH-NO
  2324         MOVE SAVE-1ST-EFF-MONTH           TO SUB3
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  43
* ECS057.cbl
  2325         MOVE +1                           TO COLUMN-SUB
  2326         PERFORM 0345-MOVE-PAYMENTS-TO-RPT THRU 0345-EXIT
  2327             VARYING SUB3 FROM SUB3 BY +1
  2328             UNTIL SUB3 > +12
  2329         IF SAVE-1ST-EFF-MONTH > +1
  2330             PERFORM 0345-MOVE-PAYMENTS-TO-RPT
  2331                                           THRU 0345-EXIT
  2332                 VARYING SUB3 FROM +1 BY +1
  2333                 UNTIL SUB3 = SAVE-1ST-EFF-MONTH
  2334         END-IF
  2335     ELSE
  2336         MOVE SPACES                       TO WS-D1-BATCH-NO
  2337         PERFORM 0347-ZERO-PAYMENTS        THRU 0347-EXIT
  2338             VARYING COLUMN-SUB FROM +1 BY +1
  2339             UNTIL COLUMN-SUB > +12
  2340     END-IF
  2341
  2342     MOVE WS-H5-EFF-MO (SUB)              TO WS-D1-PROCESS-MO
  2343     MOVE WS-H5-EFF-YY (SUB)              TO WS-D1-PROCESS-YY
  2344     PERFORM 0400-PRINT-DETAIL            THRU 0400-EXIT
  2345
  2346     .
  2347 0340-EXIT.
  2348     EXIT.
  2349
  2350
  2351 0345-MOVE-PAYMENTS-TO-RPT.
  2352
  2353     MOVE WS-PAYMENT-BYBATCH (SUB3) TO WS-D1-PAYMENT (COLUMN-SUB)
  2354     ADD +1                         TO COLUMN-SUB
  2355
  2356     .
  2357 0345-EXIT.
  2358     EXIT.
  2359
  2360 0347-ZERO-PAYMENTS.
  2361
  2362     MOVE ZEROS                     TO WS-D1-PAYMENT (COLUMN-SUB)
  2363
  2364     .
  2365 0347-EXIT.
  2366     EXIT.
  2367
  2368 0350-SUBTOTAL.
  2369
  2370     MOVE SPACES                          TO WS-DETAIL
  2371     MOVE WS-H5-EFF-MO (SUB)              TO WS-D1-PROCESS-MO
  2372     MOVE WS-H5-EFF-YY (SUB)              TO WS-D1-PROCESS-YY
  2373     MOVE 'TOTALS'                        TO WS-D1-BATCH-NO
  2374     PERFORM 0400-PRINT-DETAIL            THRU 0400-EXIT
  2375     MOVE SPACES                          TO WS-DETAIL
  2376     MOVE 'BY'                            TO WS-D1-PROCESS-YY
  2377     MOVE 'EFF MO'                        TO WS-D1-BATCH-NO
  2378
  2379     MOVE SAVE-1ST-EFF-MONTH              TO SUB3
  2380     MOVE +1                              TO COLUMN-SUB
  2381     PERFORM 0355-MOVE-PROCMO-TOTS-TO-RPT THRU 0355-EXIT
  2382         VARYING SUB3 FROM SUB3 BY +1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  44
* ECS057.cbl
  2383         UNTIL SUB3 > +12
  2384     IF SAVE-1ST-EFF-MONTH > +1
  2385         PERFORM 0355-MOVE-PROCMO-TOTS-TO-RPT THRU 0355-EXIT
  2386             VARYING SUB3 FROM +1 BY +1
  2387             UNTIL SUB3 = SAVE-1ST-EFF-MONTH
  2388     END-IF
  2389
  2390     PERFORM 0400-PRINT-DETAIL            THRU 0400-EXIT
  2391
  2392     MOVE SPACES                          TO WS-DETAIL
  2393     MOVE 'SUBTOT'                        TO WS-D1-BATCH-NO
  2394     MOVE WS-TOT-PAYMENTS-PROCMO          TO WS-D1-PAYMENT (1)
  2395     PERFORM 0400-PRINT-DETAIL            THRU 0400-EXIT
  2396
  2397     PERFORM 0373-CLEAR-SUBTOTALS         THRU 0373-EXIT
  2398         VARYING COLUMN-SUB FROM +1 BY +1
  2399         UNTIL COLUMN-SUB > +12
  2400
  2401     .
  2402 0350-EXIT.
  2403     EXIT.
  2404
  2405 0355-MOVE-PROCMO-TOTS-TO-RPT.
  2406
  2407     MOVE WS-PAYMENT-BYPROCMO (SUB3)
  2408                                    TO WS-D1-PAYMENT (COLUMN-SUB)
  2409     ADD +1                         TO COLUMN-SUB
  2410
  2411     .
  2412 0355-EXIT.
  2413     EXIT.
  2414
  2415
  2416 0360-12MO-TOTAL-FOR-ACCT.
  2417
  2418     MOVE SPACES                        TO WS-DETAIL
  2419     MOVE '-'                           TO WS-D1-PRINT-CTL
  2420     MOVE '12M'                         TO WS-D1-PROCESS-MO
  2421     MOVE 'O '                          TO WS-D1-PROCESS-YY
  2422     MOVE 'TOTALS'                      TO WS-D1-BATCH-NO
  2423     PERFORM 0400-PRINT-DETAIL          THRU 0400-EXIT
  2424
  2425     MOVE SPACE                         TO WS-D1-PRINT-CTL
  2426     MOVE 'BY'                          TO WS-D1-PROCESS-YY
  2427     MOVE 'EFF MO'                      TO WS-D1-BATCH-NO
  2428     MOVE SAVE-1ST-EFF-MONTH            TO SUB3
  2429     MOVE +1                            TO COLUMN-SUB
  2430     PERFORM 0365-MOVE-12MO-TOTS        THRU 0365-EXIT
  2431         VARYING SUB3 FROM SUB3 BY +1
  2432         UNTIL SUB3 > +12
  2433
  2434     IF SAVE-1ST-EFF-MONTH > +1
  2435         PERFORM 0365-MOVE-12MO-TOTS    THRU 0365-EXIT
  2436             VARYING SUB3 FROM +1 BY +1
  2437             UNTIL SUB3 = SAVE-1ST-EFF-MONTH
  2438     END-IF
  2439
  2440     PERFORM 0400-PRINT-DETAIL          THRU 0400-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  45
* ECS057.cbl
  2441
  2442     MOVE SPACES                        TO WS-DETAIL
  2443     MOVE '0'                           TO WS-D1-PRINT-CTL
  2444     MOVE 'ACC'                         TO WS-D1-PROCESS-MO
  2445     MOVE 'T '                          TO WS-D1-PROCESS-YY
  2446     MOVE 'TOTALS'                      TO WS-D1-BATCH-NO
  2447     PERFORM 0400-PRINT-DETAIL          THRU 0400-EXIT
  2448
  2449     MOVE SPACES                        TO WS-DETAIL
  2450     MOVE 'LAS'                         TO WS-D1-PROCESS-MO
  2451     MOVE 'T '                          TO WS-D1-PROCESS-YY
  2452     MOVE '12 MOS'                      TO WS-D1-BATCH-NO
  2453     MOVE WS-12MO-ACCT-TOTAL            TO WS-D1-PAYMENT (1)
  2454     PERFORM 0400-PRINT-DETAIL          THRU 0400-EXIT
  2455
  2456     PERFORM 0375-CLEAR-12MO-TOTALS     THRU 0375-EXIT
  2457         VARYING COLUMN-SUB FROM +1 BY +1
  2458         UNTIL COLUMN-SUB > +12
  2459
  2460     MOVE ZEROS                         TO WS-12MO-ACCT-TOTAL
  2461
  2462
  2463     .
  2464 0360-EXIT.
  2465     EXIT.
  2466
  2467 0365-MOVE-12MO-TOTS.
  2468
  2469     MOVE WS-PAYMENT-12MOTOTS-BYACCT (SUB3)
  2470                                    TO WS-D1-PAYMENT (COLUMN-SUB)
  2471     ADD +1                         TO COLUMN-SUB
  2472     ADD WS-PAYMENT-12MOTOTS-BYACCT (SUB3)  TO WS-12MO-ACCT-TOTAL
  2473
  2474     .
  2475 0365-EXIT.
  2476     EXIT.
  2477
  2478
  2479 0370-CLEAR-PAYMENT-TABLE.
  2480
  2481     MOVE ZEROS                TO WS-PAYMENT-BYBATCH (COLUMN-SUB)
  2482
  2483     .
  2484 0370-EXIT.
  2485     EXIT.
  2486
  2487 0373-CLEAR-SUBTOTALS.
  2488
  2489     MOVE ZEROS                TO WS-PAYMENT-BYPROCMO (COLUMN-SUB)
  2490
  2491     .
  2492 0373-EXIT.
  2493     EXIT.
  2494
  2495 0375-CLEAR-12MO-TOTALS.
  2496
  2497     MOVE ZEROS        TO WS-PAYMENT-12MOTOTS-BYACCT (COLUMN-SUB)
  2498
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  46
* ECS057.cbl
  2499     .
  2500 0375-EXIT.
  2501     EXIT.
  2502
  2503
  2504 0380-ALLACCT-SUMMARY.
  2505
  2506     MOVE 'ALL ACCTS'                      TO WS-H-ACCOUNT
  2507     MOVE SPACES                           TO WS-H-LITERAL
  2508     MOVE SPACES                           TO WS-H-STATE
  2509     MOVE +56                              TO WS-LINE-COUNT
  2510     MOVE 'DATE           '                TO WS-H7-VARIABLE-HDR
  2511
  2512     MOVE SAVE-1ST-EFF-MONTH               TO PROCMO
  2513     MOVE +1                               TO MOHDR
  2514     PERFORM 0382-ALLACCT-PROCMO-TOTS      THRU 0382-EXIT
  2515         VARYING PROCMO FROM PROCMO BY +1
  2516             UNTIL PROCMO > +12
  2517     IF SAVE-1ST-EFF-MONTH > +1
  2518         PERFORM 0382-ALLACCT-PROCMO-TOTS  THRU 0382-EXIT
  2519             VARYING PROCMO FROM +1 BY +1
  2520                 UNTIL PROCMO = SAVE-1ST-EFF-MONTH
  2521     END-IF
  2522
  2523     MOVE SPACES                           TO WS-DETAIL
  2524     MOVE '0'                              TO WS-D1-PRINT-CTL
  2525     MOVE '12M'                            TO WS-D1-PROCESS-MO
  2526     MOVE 'O '                             TO WS-D1-PROCESS-YY
  2527     MOVE 'TOTALS'                         TO WS-D1-BATCH-NO
  2528     PERFORM 0400-PRINT-DETAIL             THRU 0400-EXIT
  2529
  2530     MOVE SPACE                            TO WS-D1-PRINT-CTL
  2531     MOVE 'BY'                             TO WS-D1-PROCESS-YY
  2532     MOVE 'EFF MO'                         TO WS-D1-BATCH-NO
  2533     MOVE SAVE-1ST-EFF-MONTH               TO SUB3
  2534     MOVE +1                               TO COLUMN-SUB
  2535     PERFORM 0385-MOVE-ALLACCTS-12MO-TOTS  THRU 0385-EXIT
  2536         VARYING SUB3 FROM SUB3 BY +1
  2537         UNTIL SUB3 > +12
  2538
  2539     IF SAVE-1ST-EFF-MONTH > +1
  2540         PERFORM 0385-MOVE-ALLACCTS-12MO-TOTS THRU 0385-EXIT
  2541             VARYING SUB3 FROM +1 BY +1
  2542             UNTIL SUB3 = SAVE-1ST-EFF-MONTH
  2543     END-IF
  2544
  2545     PERFORM 0400-PRINT-DETAIL             THRU 0400-EXIT
  2546
  2547     MOVE SPACES                           TO WS-DETAIL
  2548     MOVE '0'                              TO WS-D1-PRINT-CTL
  2549     MOVE 'GRA'                            TO WS-D1-PROCESS-MO
  2550     MOVE 'ND'                             TO WS-D1-PROCESS-YY
  2551     MOVE ' TOTAL'                         TO WS-D1-BATCH-NO
  2552     PERFORM 0400-PRINT-DETAIL             THRU 0400-EXIT
  2553
  2554     MOVE SPACES                           TO WS-DETAIL
  2555     MOVE 'LAS'                            TO WS-D1-PROCESS-MO
  2556     MOVE 'T '                             TO WS-D1-PROCESS-YY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  47
* ECS057.cbl
  2557     MOVE '12 MOS'                         TO WS-D1-BATCH-NO
  2558     MOVE WS-12MO-ALLACCT-GRAND-TOTAL      TO WS-D1-PAYMENT (1)
  2559     PERFORM 0400-PRINT-DETAIL             THRU 0400-EXIT
  2560
  2561     .
  2562 0380-EXIT.
  2563     EXIT.
  2564
  2565
  2566 0382-ALLACCT-PROCMO-TOTS.
  2567
  2568     MOVE SPACES                           TO WS-DETAIL
  2569     MOVE WS-H5-EFF-MOYY (MOHDR) (6:5)     TO WS-D1-PROCESS-DATE
  2570
  2571     MOVE +1                               TO EFFMOCOL
  2572     PERFORM 0384-ALLACCT-EFFMO-TOTS       THRU 0384-EXIT
  2573         VARYING EFFMO FROM SAVE-1ST-EFF-MONTH BY +1
  2574             UNTIL EFFMO > +12
  2575     IF SAVE-1ST-EFF-MONTH > +1
  2576         PERFORM 0384-ALLACCT-EFFMO-TOTS   THRU 0384-EXIT
  2577             VARYING EFFMO FROM +1 BY +1
  2578                 UNTIL EFFMO = SAVE-1ST-EFF-MONTH
  2579     END-IF
  2580     PERFORM 0400-PRINT-DETAIL             THRU 0400-EXIT
  2581     ADD +1                                TO MOHDR
  2582
  2583     .
  2584 0382-EXIT.
  2585     EXIT.
  2586
  2587
  2588 0384-ALLACCT-EFFMO-TOTS.
  2589
  2590     MOVE WS-ALLACCT-BYPROCMO-EFFMO (PROCMO EFFMO)
  2591                                     TO WS-D1-PAYMENT (EFFMOCOL)
  2592     ADD +1                          TO EFFMOCOL
  2593
  2594     .
  2595 0384-EXIT.
  2596     EXIT.
  2597
  2598
  2599 0385-MOVE-ALLACCTS-12MO-TOTS.
  2600
  2601     MOVE WS-ALLACCT-12MOTOTS (SUB3)
  2602                                    TO WS-D1-PAYMENT (COLUMN-SUB)
  2603     ADD +1                         TO COLUMN-SUB
  2604     ADD WS-ALLACCT-12MOTOTS (SUB3) TO WS-12MO-ALLACCT-GRAND-TOTAL
  2605
  2606     .
  2607 0385-EXIT.
  2608     EXIT.
  2609
  2610
  2611 0400-PRINT-DETAIL.
  2612
  2613     IF WS-LINE-COUNT >= WS-LINE-COUNT-MAX
  2614         PERFORM 4500-PRINT-HEADINGS  THRU 4500-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  48
* ECS057.cbl
  2615     END-IF
  2616
  2617     MOVE WS-DETAIL                   TO PRT
  2618     PERFORM 4900-WRITE               THRU 4900-EXIT
  2619
  2620     INITIALIZE WS-DETAIL
  2621
  2622     .
  2623 0400-EXIT.
  2624     EXIT.
  2625
  2626
  2627 4500-PRINT-HEADINGS.
  2628
  2629     MOVE WS-HEADING1                 TO PRT
  2630     PERFORM 4900-WRITE               THRU 4900-EXIT
  2631
  2632     MOVE WS-HEADING2                 TO PRT
  2633     PERFORM 4900-WRITE               THRU 4900-EXIT
  2634
  2635     ADD +1                           TO WS-PAGE
  2636     MOVE WS-PAGE                     TO WS-H3-PAGE
  2637     MOVE WS-HEADING3                 TO PRT
  2638     PERFORM 4900-WRITE               THRU 4900-EXIT
  2639
  2640     MOVE WS-ACCOUNT-HEADING          TO PRT
  2641     PERFORM 4900-WRITE               THRU 4900-EXIT
  2642
  2643     MOVE WS-HEADING4                 TO PRT
  2644     PERFORM 4900-WRITE               THRU 4900-EXIT
  2645
  2646     MOVE WS-HEADING5                 TO PRT
  2647     PERFORM 4900-WRITE               THRU 4900-EXIT
  2648
  2649     MOVE WS-HEADING6                 TO PRT
  2650     PERFORM 4900-WRITE               THRU 4900-EXIT
  2651
  2652     MOVE WS-HEADING7                 TO PRT
  2653     PERFORM 4900-WRITE               THRU 4900-EXIT
  2654
  2655     MOVE SPACES                      TO PRT
  2656     PERFORM 4900-WRITE               THRU 4900-EXIT
  2657
  2658     .
  2659 4500-EXIT.
  2660     EXIT.
  2661
  2662
  2663 4900-WRITE.
  2664
  2665     EVALUATE TRUE
  2666     WHEN P-CTL = '1'
  2667         MOVE +1                      TO WS-LINE-COUNT
  2668
  2669     WHEN P-CTL = SPACE
  2670         ADD +1                       TO WS-LINE-COUNT
  2671
  2672     WHEN P-CTL = '0'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  49
* ECS057.cbl
  2673         ADD +2                       TO WS-LINE-COUNT
  2674
  2675     WHEN OTHER
  2676         ADD +3                       TO WS-LINE-COUNT
  2677     END-EVALUATE
  2678
  2679     WRITE PRT
  2680
  2681     .
  2682 4900-EXIT.
  2683     EXIT.
  2684
  2685 8500-DATE-CONVERSION.
  2686
  2687     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  2688
  2689     .
  2690 8500-EXIT.
  2691     EXIT.
  2692
  2693 8800-OPEN-FILES.
  2694                                                                  ECS057
  2695     OPEN INPUT   OFFLN-CERT-IN                                   ECS057
  2696          OUTPUT  PRT-RPT
  2697
  2698     .
  2699 8800-EXIT.
  2700     EXIT.
  2701                                                                  ECS057
  2702 8900-CLOSE-FILES.
  2703                                                                  ECS057
  2704     CLOSE OFFLN-CERT-IN
  2705           PRT-RPT
  2706
  2707     .
  2708 8900-EXIT.
  2709     EXIT.
  2710                                                                  ECS057
  2711
  2712 ABEND-PGM SECTION.                                               ECS057
* 2713                             COPY ELCABEND.                       ECS057
  2714***************************************************************** 04/14/98
  2715*                                                               * ELCABEND
  2716*                            ELCABEND.                          *    LV003
  2717*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2718*                            VMOD 2.002                              CL**2
  2719*                                                               * ELCABEND
  2720*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2721*            AND THEN ABENDS.                                   * ELCABEND
  2722*                                                               * ELCABEND
  2723*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2724*                                                               * ELCABEND
  2725***************************************************************** ELCABEND
  2726*APS-010.                                                         ELCABEND
  2727     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2728     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2729                                                                  ELCABEND
  2730     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  50
* ECS057.cbl (/apps/prod/cid1p/copy/ELCABEND)
  2731         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2732         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2733                                 UPON CONSOLE.                    ELCABEND
  2734                                                                  ELCABEND
  2735     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2736         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2737         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2738                                 UPON CONSOLE.                    ELCABEND
  2739                                                                  ELCABEND
  2740     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2741     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2742                                 UPON CONSOLE.                    ELCABEND
  2743                                                                  ELCABEND
  2744     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2745     CALL 'ABORTME'.
  2746                                                                  ELCABEND
  2747 APS-EXIT.                                                        ELCABEND
  2748     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       51284     Code:        8575
