* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* SQLBERMEBL.cbl
* Options: int("SQLBERMEBL.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("SQLBERMEBL.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SQLBERMEBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "SQLBERMEBL.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE
*          "0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 IDENTIFICATION DIVISION.
     9 PROGRAM-ID. SQLBERMEBL.
    10 AUTHOR.   Cowtown.
    11
    12 ENVIRONMENT DIVISION.
    13 CONFIGURATION SECTION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* SQLBERMEBL.cbl
    14 INPUT-OUTPUT SECTION.
    15 FILE-CONTROL.
    16
    17     SELECT ERMEBL           ASSIGN TO ERMEBL
    18                             ORGANIZATION IS INDEXED
    19                             ACCESS IS DYNAMIC
    20                             RECORD KEY IS ME-CONTROL-primary
    21                             FILE STATUS IS ERMEBL-FILE-STATUS.
    22
    23     SELECT DISK-DATE        ASSIGN TO SYS019.
    24
    25 DATA DIVISION.
    26 FILE SECTION.
    27
    28 FD  ERMEBL.
    29
*   30                                 copy ERCMEBL.
    31******************************************************************
    32*
    33*
    34*                            ERCMEBL                             *
    35*                                                                *
    36*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *
    37*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *
    38*                       4-6 OF THE FIELD NAMES) AND BY EL541     *
    39*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*
    40*                                                                *
    41*    FILE TYPE = VSAM, KSDS                                      *
    42*    RECORD SIZE = 765       RECFORM = FIXED                     *
    43*                                                                *
    44*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *
    45*    ALTERNATE PATHS = NONE        STARTING IN  3                *
    46*                                                                *
    47******************************************************************
    48
    49******************************************************************
    50*                   C H A N G E   L O G
    51*
    52* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    53*-----------------------------------------------------------------
    54*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    55* EFFECTIVE    NUMBER
    56*-----------------------------------------------------------------
    57* 070714  CR2013060600001  PEMA  AUTOMATE EOM BALANCING
    58******************************************************************
    59 01  MONTH-END-BALANCES.
    60     12  ME-RECORD-ID            PIC  XX.
    61     12  ME-CONTROL-PRIMARY.
    62         16  ME-COMPANY          PIC  XXX.
    63         16  ME-MOYR             PIC  9999       COMP.
    64     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.
    65     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.
    66     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.
    67     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.
    68     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.
    69     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.
    70     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.
    71     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ERCMEBL)
    72     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.
    73     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.
    74     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.
    75     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.
    76     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.
    77     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.
    78*    12  ME-010-START            PIC  9(6)       COMP-3.
    79*    12  ME-010-END              PIC  9(6)       COMP-3.
    80     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.
    81     12  ME-018-COMM-Y           PIC S9(9)V99    COMP-3.
    82     12  ME-018-COMM-1           PIC S9(9)V99    COMP-3.
    83     12  ME-018-OW-Y             PIC S9(9)V99    COMP-3.
    84     12  ME-018-OW-1             PIC S9(9)V99    COMP-3.
    85     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.
    86*    12  ME-018-START            PIC  9(6)       COMP-3.
    87*    12  ME-018-END              PIC  9(6)       COMP-3.
    88     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.
    89     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.
    90     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.
    91     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.
    92     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.
    93     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.
    94     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.
    95     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.
    96     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.
    97     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.
    98*    12  ME-019-START            PIC  9(6)       COMP-3.
    99*    12  ME-019-END              PIC  9(6)       COMP-3.
   100     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.
   101     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.
   102     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.
   103     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.
   104*    12  ME-030-START            PIC  9(6)       COMP-3.
   105*    12  ME-030-END              PIC  9(6)       COMP-3.
   106     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.
   107     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.
   108     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.
   109     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.
   110*    12  ME-032-START            PIC  9(6)       COMP-3.
   111*    12  ME-032-END              PIC  9(6)       COMP-3.
   112     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.
   113     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.
   114     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.
   115     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.
   116*    12  ME-035-START            PIC S9(6)       COMP-3.
   117*    12  ME-035-END              PIC S9(6)       COMP-3.
   118     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.
   119     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.
   120     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.
   121     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.
   122*    12  ME-038-START            PIC  9(6)       COMP-3.
   123*    12  ME-038-END              PIC  9(6)       COMP-3.
   124     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.
   125     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.
   126     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.
   127*    12  ME-041-START            PIC  9(6)       COMP-3.
   128*    12  ME-041-END              PIC  9(6)       COMP-3.
   129     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ERCMEBL)
   130     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.
   131     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.
   132*    12  ME-050-START            PIC  9(6)       COMP-3.
   133     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.
   134*    12  ME-050-END              PIC  9(6)       COMP-3.
   135     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.
   136     12  ME-061-PREM             PIC S9(9)V99    COMP-3.
   137     12  ME-061-COMM             PIC S9(9)V99    COMP-3.
   138     12  ME-061-OR               PIC S9(9)V99    COMP-3.
   139     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.
   140     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.
   141     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.
   142     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.
   143     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.
   144*    12  ME-061-START            PIC  9(6)       COMP-3.
   145*    12  ME-061-END              PIC  9(6)       COMP-3.
   146     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.
   147     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.
   148     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.
   149*    12  ME-080-START            PIC  9(6)       COMP-3.
   150*    12  ME-080-END              PIC  9(6)       COMP-3.
   151     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.
   152     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.
   153     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.
   154     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.
   155*    12  ME-315-START            PIC  9(6)       COMP-3.
   156*    12  ME-315-END              PIC  9(6)       COMP-3.
   157     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.
   158     12  ME-331-FLAG             PIC  9.
   159     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.
   160*    12  ME-331-START            PIC  9(6)       COMP-3.
   161*    12  ME-331-END              PIC  9(6)       COMP-3.
   162     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.
   163     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.
   164     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.
   165*    12  ME-341-START            PIC  9(6)       COMP-3.
   166*    12  ME-341-END              PIC  9(6)       COMP-3.
   167     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.
   168     12  ME-501-FLAG             PIC  9.
   169     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.
   170     12  ME-501-START            PIC  9(6)       COMP-3.
   171     12  ME-501-END              PIC  9(6)       COMP-3.
   172     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.
   173     12  ME-509-FLAG             PIC  9.
   174     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.
   175     12  ME-509-START            PIC  9(6)       COMP-3.
   176     12  ME-509-END              PIC  9(6)       COMP-3.
   177     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.
   178     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.
   179     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.
   180     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.
   181     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.
   182     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.
   183     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.
   184     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.
   185     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.
   186     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.
   187     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ERCMEBL)
   188     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.
   189     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.
   190     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.
   191     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.
   192     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.
   193     12  ME-522-START            PIC  9(6)       COMP-3.
   194     12  ME-522-END              PIC  9(6)       COMP-3.
   195     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.
   196     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.
   197     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.
   198     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.
   199     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.
   200     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.
   201     12  ME-524-START            PIC  9(6)       COMP-3.
   202     12  ME-524-END              PIC  9(6)       COMP-3.
   203     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.
   204     12  ME-525-FLAG             PIC  9.
   205     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.
   206     12  ME-525-START            PIC  9(6)       COMP-3.
   207     12  ME-525-END              PIC  9(6)       COMP-3.
   208     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.
   209     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.
   210     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.
   211     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.
   212     12  ME-048-START            PIC  9(6)       COMP-3.
   213     12  ME-048-END              PIC  9(6)       COMP-3.
   214     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.
   215     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.
   216
   217     12  ME-019-CLMS-L           PIC S9(9)V99    COMP-3.
   218     12  ME-019-CLMS-AH          PIC S9(9)V99    COMP-3.
   219     12  ME-035-COMM-TOT         PIC S9(9)V99    COMP-3.
   220     12  ME-035-CLMS-L           PIC S9(9)V99    COMP-3.
   221     12  ME-035-CLMS-AH          PIC S9(9)V99    COMP-3.
   222     12  ME-041-RECS-IN          PIC S9(9)       COMP-3.
   223     12  ME-041-RECS-OUT         PIC S9(9)       COMP-3.
   224     12  ME-050-ACT-L            PIC S9(7)       COMP-3.
   225     12  ME-050-ACT-AH           PIC S9(7)       COMP-3.
   226     12  ME-061-CLMS             PIC S9(9)V99    COMP-3.
   227     12  ME-341-CLMS-L           PIC S9(9)V99    COMP-3.
   228     12  ME-341-CLMS-AH          PIC S9(9)V99    COMP-3.
   229     12  ME-515-CLMS-WRAP        PIC S9(7)V99    COMP-3.
   230     12  ME-515-RESV-WRAP        PIC S9(7)V99    COMP-3.
   231     12  ME-317-CLMS-TOT         PIC S9(9)V99    comp-3.
   232     12  ME-325-CLMS-TOT         PIC S9(9)V99    comp-3.
   233     12  ME-020-PREM-TOT         PIC S9(11)V99   COMP-3.
   234     12  ME-020-CLMS-TOT         PIC S9(9)V99    COMP-3.
   235     12  ME-020-RESV-TOT         PIC S9(9)V99    COMP-3.
   236     12  ME-063-OW               PIC S9(9)V99    COMP-3.
   237     12  ME-082-ACT-L            PIC S9(7)       COMP-3.
   238     12  ME-082-ACT-AH           PIC S9(7)       COMP-3.
   239     12  ME-016-RECS-IN          PIC S9(9)       COMP-3.
   240     12  ME-016-RECS-OUT         PIC S9(9)       COMP-3.
   241     12  ME-562-PREM-TOT         PIC S9(9)V99    COMP-3.
   242     12  ME-562-COMM-TOT         PIC S9(9)V99    COMP-3.
   243     12  ME-524-CLMS-TOT-CM      PIC S9(9)V99    comp-3.
   244     12  ME-523-PREM-TOT         PIC S9(9)V99    COMP-3.
   245     12  ME-064-BEG-BAL          PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ERCMEBL)
   246     12  ME-064-END-BAL          PIC S9(9)V99    COMP-3.
   247     12  ME-010-MM-PREM-TOT      PIC S9(9)V99    COMP-3.
   248     12  ME-010-MM-TOT-CLMS      PIC S9(9)V99    COMP-3.
   249     12  ME-010-MM-TOT-RESV      PIC S9(9)V99    COMP-3.
   250     12  ME-080-MORT-RESV        PIC S9(9)V99    COMP-3.
   251
   252     12  FILLER                  PIC  X(09).
   253*    12  FILLER                  PIC  X(88).
   254******************************************************************
   255
   256 FD  DISK-DATE
*  257                              COPY ELCDTEFD.
   258******************************************************************04/15/98
   259*                                                                *ELCDTEFD
   260*                                                                *ELCDTEFD
   261*                            ELCDTEFD.                           *   LV002
   262*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   263*                            VMOD=2.007                          *   CL**2
   264*                                                                *ELCDTEFD
   265******************************************************************ELCDTEFD
   266     BLOCK CONTAINS 0 RECORDS
   267     RECORDING MODE F.                                            ELCDTEFD
   268                                                                  ELCDTEFD
   269 01  DATE-DISK.                                                   ELCDTEFD
   270     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   271     12  FILLER                      PIC  X(14).                  ELCDTEFD
   272     12  DD-CR1                      PIC  9.                      ELCDTEFD
   273     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   274     12  DD-CR2                      PIC  9.                      ELCDTEFD
   275     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   276     12  FILLER                      PIC  X(20).                  ELCDTEFD
   277                                                                  ELCDTEFD
   278 01  DATE-DISK-R.                                                 ELCDTEFD
   279     12  FILLER                      PIC  X(4).                   ELCDTEFD
   280     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   281                                     PIC  X(32).                  ELCDTEFD
   282                                                                  ELCDTEFD
   283 01  DATE-DISK-T.                                                 ELCDTEFD
   284     12  FILLER                      PIC  X(4).                   ELCDTEFD
   285     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   286                                     PIC  X(48).                  ELCDTEFD
   287                                                                  ELCDTEFD
   288 01  DATE-DISK-M.                                                 ELCDTEFD
   289     12  FILLER                      PIC  X(4).                   ELCDTEFD
   290     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   291                                     PIC  X(48).                  ELCDTEFD
   292                                                                  ELCDTEFD
   293 01  DATE-DISK-P.                                                 ELCDTEFD
   294     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   295     12  DD-IDX                      PIC  99.                     ELCDTEFD
   296     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   297     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   298         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   299                                     PIC  X.                      ELCDTEFD
   300         16  FILLER                  PIC  X(46).                  ELCDTEFD
   301     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   302         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   303             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   304             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   305             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   306             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   307         16  FILLER                  PIC  X(16).                  ELCDTEFD
   308                                                                  ELCDTEFD
   309 01  DATE-DISK-E.                                                 ELCDTEFD
   310     12  FILLER                      PIC  X(4).                   ELCDTEFD
   311     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   312                                     PIC  X(4).                   ELCDTEFD
   313                                                                  ELCDTEFD
   314 01  DATE-DISK-C.                                                 ELCDTEFD
   315     12  FILLER                      PIC  X(7).                   ELCDTEFD
   316     12  DD-CARR1-SECPAY-SW          PIC  X.
   317     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   318     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   319     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   320     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   321     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   322     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   323     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   324     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   325     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   326     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   327     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   328     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   329     12  DD-CARR2-SECPAY-SW          PIC  X.
   330     12  FILLER                      PIC  X(7).                   ELCDTEFD
   331                                                                  ELCDTEFD
   332 01  DATE-DISK-OPT.                                               ELCDTEFD
   333     12  FILLER                      PIC  X(04).                  ELCDTEFD
   334     12  DD-TLR-DATA.                                             ELCDTEFD
   335         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   336                                     PIC  X(03).                  ELCDTEFD
   337     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   338         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   339                                     PIC  X(06).                  ELCDTEFD
   340     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   341         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   342                                     PIC  X(07).                  ELCDTEFD
   343         16  FILLER                  PIC  X(05).                  ELCDTEFD
   344     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   345                                     PIC  X(96).                  ELCDTEFD
   346******************************************************************ELCDTEFD
   347
   348 working-storage section.
   349
*  350 EXEC SQL
*  351    INCLUDE SQLDA
*  352 END-EXEC
   353 01 SQLDA sync.
   354    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   355    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   356    05 SQLN                  PIC S9(4) COMP-5 value 0.
   357    05 SQLD                  PIC S9(4) COMP-5 value 0.
   358    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   359       10 SQLTYPE            PIC S9(4) COMP-5.
   360       10 SQLLEN             PIC S9(4) COMP-5.
   361$IF P64 SET
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* SQLBERMEBL.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   362X      *> For 64-bit environments, ensure that SQLDATA is
   363X      *> aligned on an 8-byte boundary.
   364X      10 FILLER             PIC S9(9) COMP-5.
   365$END
   366       10 SQLDATA            USAGE POINTER.
   367       10 SQLIND             USAGE POINTER.
   368       10 SQLNAME.
   369          15 SQLNAMEL        PIC S9(4) COMP-5.
   370          15 SQLNAMEC        PIC X(30).
   371
   372* Values for SQLTYPE
   373
   374 78  ESQL-DATE-CHAR              VALUE 384.
   375 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   376 78  ESQL-DATE-REC               VALUE 386.
   377 78  ESQL-DATE-REC-NULL          VALUE 387.
   378 78  ESQL-TIME-CHAR              VALUE 388.
   379 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   380 78  ESQL-TIME-REC               VALUE 390.
   381 78  ESQL-TIME-REC-NULL          VALUE 391.
   382 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   383 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   384 78  ESQL-TIMESTAMP-REC          VALUE 394.
   385 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   386 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   387 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   388 78  ESQL-TS-OFFSET-REC          VALUE 398.
   389 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   390 78  ESQL-LONGVARBINARY          VALUE 404.
   391 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   392 78  ESQL-LONGVARCHAR            VALUE 408.
   393 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   394 78  ESQL-BINARY                 VALUE 444.
   395 78  ESQL-BINARY-NULL            VALUE 445.
   396 78  ESQL-VARBINARY              VALUE 446.
   397 78  ESQL-VARBINARY-NULL         VALUE 447.
   398 78  ESQL-VARCHAR                VALUE 448.
   399 78  ESQL-VARCHAR-NULL           VALUE 449.
   400
   401 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   402 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   403
   404 78  ESQL-CHAR                   VALUE 452.
   405 78  ESQL-CHAR-NULL              VALUE 453.
   406
   407 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   408 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   409
   410 78  ESQL-DOUBLE                 VALUE 480.
   411 78  ESQL-DOUBLE-NULL            VALUE 481.
   412 78  ESQL-REAL                   VALUE 482.
   413 78  ESQL-REAL-NULL              VALUE 483.
   414 78  ESQL-DECIMAL                VALUE 484.
   415 78  ESQL-DECIMAL-NULL           VALUE 485.
   416 78  ESQL-INTEGER                VALUE 496.
   417 78  ESQL-INTEGER-NULL           VALUE 497.
   418 78  ESQL-SMALLINT               VALUE 500.
   419 78  ESQL-SMALLINT-NULL          VALUE 501.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* SQLBERMEBL.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   420 78  ESQL-TINYINT                VALUE 502.
   421 78  ESQL-TINYINT-NULL           VALUE 503.
   422
*  423 EXEC SQL
*  424    INCLUDE SQLCA
*  425 END-EXEC
   426 01 SQLCA.
   427     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   428     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   429     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   430     05  SQLERRM.
   431         49  SQLERRML    PIC S9(4) COMP-5.
   432         49  SQLERRMC    PIC X(70).
   433     05  SQLERRP         PIC X(8).
   434     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   435     05  SQLWARN.
   436         10  SQLWARN0    PIC X.
   437         10  SQLWARN1    PIC X.
   438         10  SQLWARN2    PIC X.
   439         10  SQLWARN3    PIC X.
   440         10  SQLWARN4    PIC X.
   441         10  SQLWARN5    PIC X.
   442         10  SQLWARN6    PIC X.
   443         10  SQLWARN7    PIC X.
   444     05  SQLEXT.
   445         10  SQLWARN8    PIC X.
   446         10  SQLWARN9    PIC X.
   447         10  SQLWARN10   PIC X.
   448         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   449     05  SQLSTATE    PIC X(5).
   450
   451 77  s1                          pic s999 comp-3 value +0.
   452 77  rec-cnt                     pic 9(9) value zeros.
   453 77  ws-recs-in                  pic 9(7) value zeros.
   454 77  ws-sql-code                 pic s9(7) value zeros.
   455 77  ws-dis-sql-code             pic -9999999 value zeros.
   456 77  ermebl-file-status          pic xx value low-values.
   457 77  eof-sw                      pic x value ' '.
   458     88  end-of-input               value 'Y'.
   459
   460 01  P pointer.
   461 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   462 01  var-ptr pointer.
   463 01  env-var-len                 pic 9(4)  binary.
   464 01  rc                          pic 9(9)  binary.
   465
   466 01  WS-KIXSYS.
   467     05  WS-KIX-FIL1             PIC X(10).
   468     05  WS-KIX-APPS             PIC X(10).
   469     05  WS-KIX-ENV              PIC X(10).
   470     05  WS-KIX-MYENV            PIC X(10).
   471     05  WS-KIX-SYS              PIC X(10).
   472
   473 01  filler.
   474     05  ws-work-date.
   475         10  ws-work-ccyy        pic 9999.
   476         10  ws-work-mm          pic 99.
   477         10  ws-work-dd          pic 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* SQLBERMEBL.cbl
   478     05  ws-work-date-moyr       pic 9999  comp value zeros.
   479
   480 EXEC SQL
   481    BEGIN DECLARE SECTION
   482 END-EXEC
   483
   484 01  sqlcmd                      pic x(1024).
   485 01  WS-MOE-DATE                 pic x(10).
   486 01  svr                         pic x(32).
   487 01  usr                         pic x(32).
   488 01  pass                        pic x(32).
   489 01  usr-pass                    pic x(64).
   490 01  ws-disp-code                pic s9(11).
   491
   492***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   493***                                                            ***
   494***  These indicators are used to tell sql server that i am    ***
   495***  passing it a null value.  The indicator will be -1        ***
   496***  if the value is nulls and +0 if the value is other than   ***
   497***  nulls.  Here is a sample on how to use it.                ***
   498***                                                            ***
   499***      if db-date1 = spaces move -1 to nu-date1 end-if       ***
   500***     EXEC SQL                                               ***
   501***        insert into ERMEBL (                                ***
   502***           date1,                                           ***
   503***           date2)                                           ***
   504***        values (                                            ***
   505***           :db-date1      :nu-date1,                        ***
   506***           :db-date2      :nu-date2)                        ***
   507***     END-EXEC                                               ***
   508***                                                            ***
   509***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   510
   511 01  indicator-vaiables-for-nulls.
   512     05  NU-RECORDED-DT          PIC s9(4) comp value +0.
   513     05  NU-CHECK-WRITTEN-DT     PIC s9(4) comp value +0.
   514     05  nu-check-cashed-dt      pic s9(4) comp value +0.
   515     05  NU-CREDIT-SELECT-DT     PIC s9(4) comp value +0.
   516     05  NU-CREDIT-ACCEPT-DT     PIC s9(4) comp value +0.
   517     05  NU-VOID-DT              PIC s9(4) comp value +0.
   518     05  NU-APPROVAL-DT          PIC s9(4) comp value +0.
   519     05  NU-CANC-DT              PIC s9(4) comp value +0.
   520
   521
   522 01  ERMEBL-TABLE-RECORD.
   523     05  TB-MONTH-END-DT         PIC X(10).
   524     05  TB-COMPANY-ID           PIC XXX.
   525     05  TB-CERT-IN-CNT-N        PIC 9(7).
   526     05  TB-CERT-IN-CNT REDEFINES
   527         TB-CERT-IN-CNT-N        PIC X(7).
   528     05  TB-CERT-OUT-CNT-N       PIC 9(7).
   529     05  TB-CERT-OUT-CNT REDEFINES
   530         TB-CERT-OUT-CNT-N       PIC X(7).
   531
   532     05  TB-ECS010-NET-PREM-N    PIC 9(9).99.
   533     05  TB-ECS010-NET-PREM REDEFINES
   534         TB-ECS010-NET-PREM-N    PIC X(12).
   535     05  TB-ECS010-NET-COMM-N    PIC 9(9).99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* SQLBERMEBL.cbl
   536     05  TB-ECS010-NET-COMM REDEFINES
   537         TB-ECS010-NET-COMM-N    PIC X(12).
   538     05  TB-ECS010-TOT-CLMS-N    PIC 9(9).99.
   539     05  TB-ECS010-TOT-CLMS REDEFINES
   540         TB-ECS010-TOT-CLMS-N    PIC X(12).
   541     05  TB-ECS010-MM-NET-PREM-N PIC 9(9).99.
   542     05  TB-ECS010-MM-NET-PREM REDEFINES
   543         TB-ECS010-MM-NET-PREM-N PIC X(12).
   544     05  TB-ECS010-MM-TOT-CLMS-N PIC 9(9).99.
   545     05  TB-ECS010-MM-TOT-CLMS REDEFINES
   546         TB-ECS010-MM-TOT-CLMS-N PIC X(12).
   547     05  TB-ECS010-MM-TOT-RESV-N PIC 9(9).99.
   548     05  TB-ECS010-MM-TOT-RESV REDEFINES
   549         TB-ECS010-MM-TOT-RESV-N PIC X(12).
   550
   551     05  TB-ECS018-NET-COMM-Y-N  PIC -9(9).99.
   552     05  TB-ECS018-NET-COMM-Y REDEFINES
   553         TB-ECS018-NET-COMM-Y-N  PIC X(13).
   554     05  TB-ECS018-NET-OW-Y-N    PIC -9(9).99.
   555     05  TB-ECS018-NET-OW-Y REDEFINES
   556         TB-ECS018-NET-OW-Y-N    PIC X(13).
   557
   558     05  TB-ECS018-NET-COMM-1-N  PIC -9(9).99.
   559     05  TB-ECS018-NET-COMM-1 REDEFINES
   560         TB-ECS018-NET-COMM-1-N  PIC X(13).
   561     05  TB-ECS018-NET-OW-1-N    PIC -9(9).99.
   562     05  TB-ECS018-NET-OW-1 REDEFINES
   563         TB-ECS018-NET-OW-1-N    PIC X(13).
   564
   565     05  TB-ECS019-NET-PREM-N    PIC 9(9).99.
   566     05  TB-ECS019-NET-PREM REDEFINES
   567         TB-ECS019-NET-PREM-N    PIC X(12).
   568     05  TB-ECS019-NET-COMM-N    PIC 9(9).99.
   569     05  TB-ECS019-NET-COMM REDEFINES
   570         TB-ECS019-NET-COMM-N    PIC X(12).
   571     05  TB-ECS019-NET-OW-N      PIC 9(9).99.
   572     05  TB-ECS019-NET-OW REDEFINES
   573         TB-ECS019-NET-OW-N      PIC X(12).
   574     05  TB-ECS019-TOT-CLMS-N    PIC 9(9).99.
   575     05  TB-ECS019-TOT-CLMS REDEFINES
   576         TB-ECS019-TOT-CLMS-N    PIC X(12).
   577
   578     05  TB-EL522-NET-PREM-N    PIC 9(9).99.
   579     05  TB-EL522-NET-PREM REDEFINES
   580         TB-EL522-NET-PREM-N    PIC X(12).
   581     05  TB-EL522-TOT-CLMS-N    PIC 9(9).99.
   582     05  TB-EL522-TOT-CLMS REDEFINES
   583         TB-EL522-TOT-CLMS-N    PIC X(12).
   584     05  TB-EL522-TOT-RESV-N    PIC 9(9).99.
   585     05  TB-EL522-TOT-RESV REDEFINES
   586         TB-EL522-TOT-RESV-N    PIC X(12).
   587     05  TB-EL522-TOT-PYAJ-N    PIC 9(9).99.
   588     05  TB-EL522-TOT-PYAJ REDEFINES
   589         TB-EL522-TOT-PYAJ-N    PIC X(12).
   590
   591     05  TB-EL524-TOT-CLMS-N    PIC 9(9).99.
   592     05  TB-EL524-TOT-CLMS REDEFINES
   593         TB-EL524-TOT-CLMS-N    PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* SQLBERMEBL.cbl
   594     05  TB-EL524-TOT-RESV-N    PIC 9(9).99.
   595     05  TB-EL524-TOT-RESV REDEFINES
   596         TB-EL524-TOT-RESV-N    PIC X(12).
   597     05  TB-EL524-TOT-CLMS-CM-N PIC 9(9).99.
   598     05  TB-EL524-TOT-CLMS-CM REDEFINES
   599         TB-EL524-TOT-CLMS-CM-N PIC X(12).
   600
   601     05  TB-EL315-TOT-RESV-N    PIC 9(9).99.
   602     05  TB-EL315-TOT-RESV REDEFINES
   603         TB-EL315-TOT-RESV-N    PIC X(12).
   604
   605     05  TB-ECS030-TOT-CLMS-N    PIC 9(9).99.
   606     05  TB-ECS030-TOT-CLMS REDEFINES
   607         TB-ECS030-TOT-CLMS-N    PIC X(12).
   608
   609     05  TB-ECS032-TOT-RESV-N    PIC 9(9).99.
   610     05  TB-ECS032-TOT-RESV REDEFINES
   611         TB-ECS032-TOT-RESV-N    PIC X(12).
   612
   613     05  TB-ECS035-NET-PREM-N    PIC 9(9).99.
   614     05  TB-ECS035-NET-PREM REDEFINES
   615         TB-ECS035-NET-PREM-N    PIC X(12).
   616     05  TB-ECS035-NET-COMM-N    PIC 9(9).99.
   617     05  TB-ECS035-NET-COMM REDEFINES
   618         TB-ECS035-NET-COMM-N    PIC X(12).
   619     05  TB-ECS035-TOT-CLMS-N    PIC 9(9).99.
   620     05  TB-ECS035-TOT-CLMS REDEFINES
   621         TB-ECS035-TOT-CLMS-N    PIC X(12).
   622
   623     05  TB-ECS061-NET-PREM-N    PIC 9(9).99.
   624     05  TB-ECS061-NET-PREM REDEFINES
   625         TB-ECS061-NET-PREM-N    PIC X(12).
   626     05  TB-ECS061-NET-COMM-N    PIC 9(9).99.
   627     05  TB-ECS061-NET-COMM REDEFINES
   628         TB-ECS061-NET-COMM-N    PIC X(12).
   629     05  TB-ECS061-NET-OW-N      PIC 9(9).99.
   630     05  TB-ECS061-NET-OW REDEFINES
   631         TB-ECS061-NET-OW-N      PIC X(12).
   632     05  TB-ECS061-TOT-CLMS-N    PIC 9(9).99.
   633     05  TB-ECS061-TOT-CLMS REDEFINES
   634         TB-ECS061-TOT-CLMS-N    PIC X(12).
   635     05  TB-ECS061-TOT-PYAJ-N    PIC 9(9).99.
   636     05  TB-ECS061-TOT-PYAJ REDEFINES
   637         TB-ECS061-TOT-PYAJ-N    PIC X(12).
   638
   639     05  TB-ECS063-NET-OW-N      PIC 9(9).99.
   640     05  TB-ECS063-NET-OW REDEFINES
   641         TB-ECS063-NET-OW-N      PIC X(12).
   642
   643     05  TB-ECS050-ACT-L-N   PIC 9(7).
   644     05  TB-ECS050-ACT-L REDEFINES
   645         TB-ECS050-ACT-L-N   PIC X(7).
   646     05  TB-ECS050-ACT-AH-N   PIC 9(7).
   647     05  TB-ECS050-ACT-AH REDEFINES
   648         TB-ECS050-ACT-AH-N   PIC X(7).
   649
   650     05  TB-ECS082-ACT-L-N   PIC 9(7).
   651     05  TB-ECS082-ACT-L REDEFINES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* SQLBERMEBL.cbl
   652         TB-ECS082-ACT-L-N   PIC X(7).
   653     05  TB-ECS082-ACT-AH-N   PIC 9(7).
   654     05  TB-ECS082-ACT-AH REDEFINES
   655         TB-ECS082-ACT-AH-N   PIC X(7).
   656
   657     05  TB-ECS016-IN-CNT-N        PIC 9(9).
   658     05  TB-ECS016-IN-CNT REDEFINES
   659         TB-ECS016-IN-CNT-N        PIC X(9).
   660     05  TB-ECS016-OUT-CNT-N       PIC 9(9).
   661     05  TB-ECS016-OUT-CNT REDEFINES
   662         TB-ECS016-OUT-CNT-N       PIC X(9).
   663
   664     05  TB-ECS041-IN-CNT-N        PIC 9(9).
   665     05  TB-ECS041-IN-CNT REDEFINES
   666         TB-ECS041-IN-CNT-N        PIC X(9).
   667     05  TB-ECS041-OUT-CNT-N       PIC 9(9).
   668     05  TB-ECS041-OUT-CNT REDEFINES
   669         TB-ECS041-OUT-CNT-N       PIC X(9).
   670
   671     05  TB-EL562-NET-PREM-N    PIC 9(9).99.
   672     05  TB-EL562-NET-PREM REDEFINES
   673         TB-EL562-NET-PREM-N    PIC X(12).
   674     05  TB-EL562-NET-COMM-N    PIC 9(9).99.
   675     05  TB-EL562-NET-COMM REDEFINES
   676         TB-EL562-NET-COMM-N    PIC X(12).
   677
   678     05  TB-EL341-TOT-CLMS-N    PIC 9(9).99.
   679     05  TB-EL341-TOT-CLMS REDEFINES
   680         TB-EL341-TOT-CLMS-N    PIC X(12).
   681
   682     05  TB-EL317-TOT-CLMS-N    PIC 9(9).99.
   683     05  TB-EL317-TOT-CLMS REDEFINES
   684         TB-EL317-TOT-CLMS-N    PIC X(12).
   685
   686     05  TB-EL325-TOT-CLMS-N    PIC 9(9).99.
   687     05  TB-EL325-TOT-CLMS REDEFINES
   688         TB-EL325-TOT-CLMS-N    PIC X(12).
   689
   690     05  TB-ECS020-NET-PREM-N    PIC 9(11).99.
   691     05  TB-ECS020-NET-PREM REDEFINES
   692         TB-ECS020-NET-PREM-N    PIC X(14).
   693     05  TB-ECS020-TOT-CLMS-N    PIC 9(9).99.
   694     05  TB-ECS020-TOT-CLMS REDEFINES
   695         TB-ECS020-TOT-CLMS-N    PIC X(12).
   696     05  TB-ECS020-TOT-RESV-N    PIC 9(9).99.
   697     05  TB-ECS020-TOT-RESV REDEFINES
   698         TB-ECS020-TOT-RESV-N    PIC X(12).
   699
   700     05  TB-EL515-CLMS-WRAP-N    PIC 9(9).99.
   701     05  TB-EL515-CLMS-WRAP REDEFINES
   702         TB-EL515-CLMS-WRAP-N    PIC X(12).
   703     05  TB-EL515-RESV-WRAP-N    PIC 9(9).99.
   704     05  TB-EL515-RESV-WRAP REDEFINES
   705         TB-EL515-RESV-WRAP-N    PIC X(12).
   706
   707     05  TB-EL523-TOT-PREM-N    PIC 9(9).99.
   708     05  TB-EL523-TOT-PREM REDEFINES
   709         TB-EL523-TOT-PREM-N    PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* SQLBERMEBL.cbl
   710
   711     05  TB-ECS064-BEG-BAL-N    PIC -9(10).99.
   712     05  TB-ECS064-BEG-BAL REDEFINES
   713         TB-ECS064-BEG-BAL-N    PIC X(14).
   714     05  TB-ECS064-END-BAL-N    PIC -9(10).99.
   715     05  TB-ECS064-END-BAL REDEFINES
   716         TB-ECS064-END-BAL-N    PIC X(14).
   717     05  TB-ECS080-MORT-RESV-N  PIC 9(11).99.
   718     05  TB-ECS080-MORT-RESV REDEFINES
   719         TB-ECS080-MORT-RESV-N  PIC X(14).
   720
   721 EXEC SQL
   722    END DECLARE SECTION
   723 END-EXEC
   724
   725 01  FILLER.
   726     05  ABEND-CODE              PIC X(4)  VALUE SPACES.
   727     05  ABEND-OPTION            PIC X     VALUE 'Y'.
   728     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
   729     05  WS-ABEND-FILE-STATUS    PIC XX    VALUE ZERO.
   730     05  WS-RETURN-CODE          PIC S9(3) VALUE ZERO COMP-3.
   731     05  PGM-SUB                 PIC S999  VALUE +344 COMP-3.
   732
*  733                                 COPY ELCDTECX.
   734******************************************************************06/05/98
   735*                                                                *ELCDTECX
   736*                            ELCDTECX.                           *   LV005
   737*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   738*                            VMOD=2.015                          *ELCDTECX
   739*                                                                *ELCDTECX
   740*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   741*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   742*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   743*                                                                *ELCDTECX
   744******************************************************************ELCDTECX
   745******************************************************************
   746*                   C H A N G E   L O G
   747*
   748* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   749*-----------------------------------------------------------------
   750*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   751* EFFECTIVE    NUMBER
   752*-----------------------------------------------------------------
   753* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   754*                                  BENEFIT CODES FROM 300 TO 900
   755* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   756* 051304    2003080800002  SMVA  ADD REFUND METHOD
   757* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   758******************************************************************
   759 01  DATE-CARD.                                                   ELCDTECX
   760     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   761     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   762     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   763     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   764     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   765     12  EP-SW                       PIC  X.                      ELCDTECX
   766         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   767     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   768         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   769     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   770     12  RUN-CENTURY.                                             ELCDTECX
   771         16 RUN-CENTURY-N            PIC  99.                        CL**4
   772     12  FILLER                      PIC  X.                         CL**4
   773     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   774     12  FILLER                      PIC  XXX.                    ELCDTECX
   775     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   776                                                                  ELCDTECX
   777 01  FILLER                          PIC  X(7)                       CL**6
   778                                          VALUE 'OPTIONS'.        ELCDTECX
   779 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   780     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   781     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   782     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   783         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   784         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   785     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   786     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   787     12  FILLER                      PIC  X.                      ELCDTECX
   788     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   789     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   790     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   791     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   792     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   793     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   794     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   795     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   796     12  FILLER                      PIC  X.                      ELCDTECX
   797     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   798     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   799     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   800     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   801     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   802     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   803     12  FILLER                      PIC  X.                      ELCDTECX
   804     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   805     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   806     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   807     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   808     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   809     12  DTE-R78                     PIC  X.                      ELCDTECX
   810     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   811     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   812     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   813     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   814     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   815     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   816     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   817                                     PIC  X.                      ELCDTECX
   818         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   819                                                 ' '.             ELCDTECX
   820         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   821         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   822     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   823         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   824         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   825     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   826     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   827                                     PIC  9.                         CL**4
   828     12  DTE-SYSTEM.                                              ELCDTECX
   829         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   830         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   831         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   832         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   833         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   834         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   835         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   836         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   837         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   838         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   839         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   840         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   841         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   842         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   843         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   844         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   845         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   846         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   847         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   848         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   849         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   850         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   851         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   852         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   853         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   854         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   855     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   856         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   857                                     PIC  X.                      ELCDTECX
   858     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   859                                                                  ELCDTECX
   860 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   861     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   862     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   863     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   864*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   865     12  FILLER                      PIC  X.                      ELCDTECX
   866     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   867     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   868     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   869     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   870     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   871     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   872     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   873                                                                  ELCDTECX
   874     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   875     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   876     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   877     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   878                                                                  ELCDTECX
   879     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   880     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   881     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   882     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   883                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   884     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   885     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   886                                                                  ELCDTECX
   887     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   888     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   889                                                                  ELCDTECX
   890     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   891                                                                  ELCDTECX
   892 01  DATE-CARD-FACTORS.                                           ELCDTECX
   893     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   894     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   895     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   896     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   897     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   898     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   899     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   900                                                                  ELCDTECX
   901 01  FILLER                          PIC  X(12)                   ELCDTECX
   902                                          VALUE 'COMPANY NAME'.   ELCDTECX
   903 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   904     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   905         16  CNT-ID                  PIC  X.                      ELCDTECX
   906         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   907                                                                  ELCDTECX
   908 01  FILLER                          PIC  X(11)                   ELCDTECX
   909                                          VALUE 'STATE NAMES'.    ELCDTECX
   910 01  STATE-NAMES.                                                 ELCDTECX
   911     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   912         16  STATE-SUB               PIC  XX.                     ELCDTECX
   913         16  STATE-PIC1.                                          ELCDTECX
   914             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   915             20  FILLER              PIC  XXX.                    ELCDTECX
   916             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   917             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   918             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   919             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   920                                                                  ELCDTECX
   921 01  FILLER                          PIC  X(13)                   ELCDTECX
   922                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   923 01  CARRIER-NAMES.                                               ELCDTECX
   924     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   925         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   926         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   927         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   928         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   929         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   930         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   931*        16  FILLER                  PIC  X.                      ELCDTECX
   932         16  CARRIER-SEC-PAY         PIC  X.
   933             88  SEC-PAY-CARRIER          VALUE 'Y'.
   934                                                                  ELCDTECX
   935 01  FILLER                          PIC  X(9)                       CL**6
   936                                          VALUE 'INS TYPES'.      ELCDTECX
   937 01  CLAS-INS-TYPES.                                              ELCDTECX
   938*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   939     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   940         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   941         16  CLAS-I-AB3.                                          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   942             20  FILLER              PIC  X.                      ELCDTECX
   943             20  CLAS-I-AB2.                                      ELCDTECX
   944                 24  FILLER          PIC  X.                      ELCDTECX
   945                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   946         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   947             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   948             20  FILLER              PIC  X.                         CL**4
   949         16  CLAS-I-AB10.                                         ELCDTECX
   950             20  FILLER              PIC  X(9).                   ELCDTECX
   951             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   952         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   953         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   954         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   955         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   956             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   957         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   958         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   959         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   960         16  CLAS-I-BEN-CATEGORY     PIC  X.
   961         16  CLAS-I-REFUND-METHOD    PIC  X.
   962         16  CLAS-I-MAX-BENEFITS     PIC 99.
   963         16  FILLER                  PIC  XXX.
   964                                                                  ELCDTECX
   965 01  FILLER                          PIC  X(16)                   ELCDTECX
   966                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   967 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   968     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   969                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   970         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   971         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   972         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   973         16  CLAS-MORT-DESC.                                      ELCDTECX
   974             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   975             20  FILLER              PIC  XX.                        CL**5
   976             20  CLAS-YEAR           PIC  X(4).                      CL**6
   977             20  FILLER              PIC  X.                         CL**5
   978             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   979             20  FILLER              PIC  X.                         CL**5
   980             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   981             20  FILLER              PIC  X.                         CL**5
   982             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   983             20  FILLER              PIC  X(5).                      CL**6
   984                                                                  ELCDTECX
   985 01  FILLER                          PIC  X(15)                   ELCDTECX
   986                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   987 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   988     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   989         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   990         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   991         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   992         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   993         16  FILLER                  PIC  X(4).                      CL**6
   994                                                                  ELCDTECX
   995 01  FILLER                          PIC  X(7)                       CL**6
   996                                     VALUE 'INDEXES'.             ELCDTECX
   997 01  CLAS-INDEX-TBL.                                              ELCDTECX
   998     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   999     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1000     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1001     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1002     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1003     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1004     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1005     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1006     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1007     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1008     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1009     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1010     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1011     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1012     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1013     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1014     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1015                                                                  ELCDTECX
  1016 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1017     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1018     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1019     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1020     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1021     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1022     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1023     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1024     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1025     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1026     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1027     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1028                                                                  ELCDTECX
  1029 01  FILLER                          PIC  X(13)                   ELCDTECX
  1030                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1031 01  CLAS-MISC.                                                   ELCDTECX
  1032     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1033         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1034         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1035         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1036     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1037     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1038     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1039     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1040     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1041     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1042     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1043     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1044     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1045     12  STATE-L                     PIC  XX.                     ELCDTECX
  1046     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1047     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1048     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1049         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1050         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1051     12  DTE-ABEND-WORK.                                          ELCDTECX
  1052         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1053         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1054                                                                  ELCDTECX
  1055 01  FILLER                          PIC  X(12)                   ELCDTECX
  1056                                     VALUE 'WORKING DATE'.        ELCDTECX
  1057 01  WS-DATE-AND-TIME.                                            ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1058     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1059         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1060         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1061         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1062     12  WS-CURRENT-DATE.                                         ELCDTECX
  1063         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1064         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1065         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1066         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1067         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1068     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1069         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1070         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1071                                                                  ELCDTECX
  1072 01  FILLER                          PIC  X(12)                   ELCDTECX
  1073                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1074 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1075     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1076         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1077         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1078         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1079                                                                  ELCDTECX
  1080 01  FILLER                          PIC  X(10)                   ELCDTECX
  1081                                     VALUE 'STATE TLRS'.          ELCDTECX
  1082 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1083     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1084         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1085         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1086                                                                  ELCDTECX
  1087 01  FILLER                          PIC  X(13)                   ELCDTECX
  1088                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1089 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1090     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1091         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1092                                                                  ELCDTECX
  1093 01  FILLER                          PIC  X(13)                   ELCDTECX
  1094                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1095 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1096     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1097     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1098     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1099                                     PIC  X.                         CL**5
  1100     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1101     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1102     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1103     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1104     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1105     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1106     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1107     12  FILLER                      PIC  X(75).                  ELCDTECX
  1108******************************************************************ELCDTECX
  1109*01  MISC-CARR-PCT-DATA.                                          00001521
  1110*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1111*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1112*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1113*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1114*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1115*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* SQLBERMEBL.cbl
  1116******************************************************************ELCDTECX
* 1117                                 copy ELCDTEVR.
  1118***************************************************************** 04/15/98
  1119*                                                                *ELCDTEVR
  1120*                                                                *ELCDTEVR
  1121*                            ELCDTEVR.                           *   LV003
  1122*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1123*                            VMOD=2.001                          *   CL**2
  1124*                                                                *ELCDTEVR
  1125*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1126*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1127*                                                                *ELCDTEVR
  1128******************************************************************ELCDTEVR
  1129 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1130     05  WS-RUN-DATE.                                             ELCDTEVR
  1131         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1132         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1133         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1134             15  RUN-CC              PIC  99.                     ELCDTEVR
  1135             15  RUN-YR              PIC  99.                     ELCDTEVR
  1136         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1137         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1138     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1139            WS-RUN-DATE              PIC 9(11).                      CL**2
  1140     05  WS-EP-DT.                                                ELCDTEVR
  1141         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1142         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1143         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1144             15  EP-CC               PIC  99.                     ELCDTEVR
  1145             15  EP-YR               PIC  99.                     ELCDTEVR
  1146         10  EP-MO                   PIC  99.                     ELCDTEVR
  1147         10  EP-DA                   PIC  99.                     ELCDTEVR
  1148     05  WS-EP-DT-N REDEFINES                                        CL**2
  1149            WS-EP-DT                 PIC 9(11).                      CL**2
  1150     05  WS-DTE-CONV-DT.                                             CL**4
  1151         10  FILLER                  PIC  9(03).                     CL**4
  1152         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1153         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1154             15  DTE-CONV-CC         PIC  99.                        CL**4
  1155             15  DTE-CONV-YR         PIC  99.                        CL**4
  1156         10  DTE-CONV-MO             PIC  99.                        CL**4
  1157         10  DTE-CONV-DA             PIC  99.                        CL**4
  1158     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1159            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1160 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1161     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1162         10  FILLER                            PIC 999.           ELCDTEVR
  1163         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1164         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1165             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1166             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1167         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1168         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1169     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1170            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1171     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1172         10  FILLER                            PIC 999.           ELCDTEVR
  1173         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1174         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1175         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1176         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1177     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1178            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1179 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1180     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1181         10  FILLER                            PIC 999.           ELCDTEVR
  1182         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1183         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1184             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1185             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1186         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1187         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1188     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1189            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1190     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1191         10  FILLER                            PIC 999.           ELCDTEVR
  1192         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1193         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1194             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1195             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1196         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1197         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1198     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1199            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1200     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1201         10  FILLER                            PIC 999.           ELCDTEVR
  1202         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1203         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1204             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1205             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1206         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1207         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1208     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1209            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1210 01  WS-RATE-RECORD.                                              ELCDTEVR
  1211         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1212             10  FILLER                        PIC 999.           ELCDTEVR
  1213             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1214             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1215                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1216                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1217             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1218             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1219         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1220                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* 1221                                 COPY ELCDATE.
  1222******************************************************************06/11/98
  1223*                                                                *ELCDATE
  1224*                                                                *ELCDATE
  1225*                            ELCDATE.                            *   LV023
  1226*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1227*                            VMOD=2.003                           ELCDATE
  1228*                                                                *ELCDATE
  1229*                                                                *ELCDATE
  1230*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1231*                 LENGTH = 200                                   *   CL*19
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1232******************************************************************ELCDATE
  1233                                                                  ELCDATE
  1234 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1235     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1236     12  DC-OPTION-CODE                PIC X.                        CL*15
  1237         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1238         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1239         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1240         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1241         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1242         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1243         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1244         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1245         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1246         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1247         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1248         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1249         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1250         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1251         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1252         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1253         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1254         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1255         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1256         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1257         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1258         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1259         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1260         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1261         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1262         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1263         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1264         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1265         88  THREE-CHARACTER-BIN                                  ELCDATE
  1266                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1267         88  GREGORIAN-TO-BIN                                        CL**2
  1268                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1269         88  BIN-TO-GREGORIAN                                        CL**2
  1270                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1271         88  JULIAN-TO-BINARY                                        CL**2
  1272                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1273     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1274         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1275         88  DATE-CONVERSION-ERROR                                ELCDATE
  1276                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1277         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1278         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1279         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1280         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1281         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1282         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1283         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1284         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1285         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1286         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1287     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1288         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1289     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1290         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1291         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1292         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1293     12  FILLER                        PIC X.                        CL*15
  1294     12  DC-CONVERSION-DATES.                                        CL*15
  1295         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1296         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1297         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1298         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1299                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1300             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1301             20  SLASH1-1              PIC X.                        CL*15
  1302             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1303             20  SLASH1-2              PIC X.                        CL*15
  1304             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1305         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1306         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1307                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1308             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1309             20  SLASH2-1              PIC X.                        CL*15
  1310             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1311             20  SLASH2-2              PIC X.                        CL*15
  1312             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1313         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1314         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1315                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1316             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1317             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1318             20  DC-YMD-DAY            PIC 99.                       CL*15
  1319         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1320         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1321                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1322             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1323             20  DC-MDY-DAY            PIC 99.                       CL*15
  1324             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1325         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1326             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1327             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1328             20  FILLER                PIC XX.                       CL*15
  1329             20  DC-ALPHA-CENTURY.                                   CL*15
  1330                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1331             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1332         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1333         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1334         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1335         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1336         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1337                                       PIC 9(05).                    CL*20
  1338         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1339             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1340             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1341         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1342         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1343         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1344     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1345         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1346         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1347             20  FILLER                PIC 9(3).                     CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1348             20  HOLD-CEN-1-CCYY.                                    CL*15
  1349                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1350                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1351             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1352             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1353         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1354             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1355             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1356             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1357                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1358                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1359             20  FILLER                PIC 9(3).                     CL*15
  1360         16  HOLD-CENTURY-1-X.                                       CL*15
  1361             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1362             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1363                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1364                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1365             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1366             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1367         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1368             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1369             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1370             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1371                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1372                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1373             20  FILLER                PIC XXX.                      CL*23
  1374         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1375         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1376         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1377         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1378             20  DC-JULIAN-1-CCYY.                                   CL*15
  1379                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1380                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1381             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1382         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1383         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1384             20  DC-JULIAN-2-CCYY.                                   CL*15
  1385                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1386                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1387             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1388         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1389             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1390             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1391             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1392             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1393             20  DC-EDITA-CCYY.                                      CL*15
  1394                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1395                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1396         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1397             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1398             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1399             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1400             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1401             20  DC-EDITB-CCYY.                                      CL*15
  1402                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1403                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1404         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1405         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1406                              DC-GREG-DATE-CYMD.                  ELCDATE
  1407             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1408             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1409             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1410             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1411         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1412         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1413                              DC-GREG-DATE-MDCY.                  ELCDATE
  1414             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1415             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1416             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1417             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1418    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1419        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1420    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1421    12  FILLER                         PIC X(28).                    CL*26
  1422
  1423 LINKAGE SECTION.
  1424 01  parm.
  1425     05  parm-length             pic s9(4) comp.
  1426     05  parm-current-month-end  pic 9(8).
  1427     05  parm-program-option     pic x.
  1428
  1429 01  var  pic x(30).
  1430
  1431 procedure division using parm.
* 1432                                 COPY ELCDTERX.
  1433******************************************************************04/15/98
  1434*                                                                *ELCDTERX
  1435*                                                                *ELCDTERX
  1436*                            ELCDTERX.                           *   LV002
  1437*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1438*                            VMOD=2.007                          *ELCDTERX
  1439*                                                                *ELCDTERX
  1440*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1441*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1442*      = ELCDTEFD)                                               *ELCDTERX
  1443*                                                                *ELCDTERX
  1444******************************************************************ELCDTERX
  1445                                                                  ELCDTERX
  1446     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1447                                                                  ELCDTERX
  1448     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1449     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1450     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1451                                                                  ELCDTERX
  1452     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1453                                                                  ELCDTERX
  1454******************************************************************ELCDTERX
  1455*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1456*          WARNING MESSAGES.                                      ELCDTERX
  1457******************************************************************ELCDTERX
  1458     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1459         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1460                                                                  ELCDTERX
  1461     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1462                                                                  ELCDTERX
  1463     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1464                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1465                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1466                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1467                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1468                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1469                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1470                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1471                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1472                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1473                                                                  ELCDTERX
  1474     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1475                                                                  ELCDTERX
  1476     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1477                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1478                                                                  ELCDTERX
  1479     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1480     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1481     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1482     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1483                                                                  ELCDTERX
  1484     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1485         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1486     ELSE                                                         ELCDTERX
  1487         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1488                                                                  ELCDTERX
  1489     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1490         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1491     ELSE                                                         ELCDTERX
  1492         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1493                                                                  ELCDTERX
  1494 0005-READ--CARD.                                                 ELCDTERX
  1495     READ DISK-DATE                                               ELCDTERX
  1496         AT END CLOSE DISK-DATE                                   ELCDTERX
  1497             GO TO 0060-READ--TEST.                               ELCDTERX
  1498                                                                  ELCDTERX
  1499     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1500                                                                  ELCDTERX
  1501     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1502         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1503         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1504         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1505         GO TO 0005-READ--CARD.                                   ELCDTERX
  1506                                                                  ELCDTERX
  1507     IF DD-ID = 'CLAD'                                            ELCDTERX
  1508         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1509         GO TO 0005-READ--CARD.                                   ELCDTERX
  1510                                                                  ELCDTERX
  1511     IF DD-ID = 'CLAX'                                            ELCDTERX
  1512         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1513         GO TO 0005-READ--CARD.                                   ELCDTERX
  1514                                                                  ELCDTERX
  1515     IF DD-ID = 'CLAF'                                            ELCDTERX
  1516         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1517         GO TO 0005-READ--CARD.                                   ELCDTERX
  1518                                                                  ELCDTERX
  1519     IF DD-ID = 'CLAC'                                            ELCDTERX
  1520         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1521                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1522     IF DD-ID = 'CARR'                                            ELCDTERX
  1523         GO TO 0015-READ--CARR.                                   ELCDTERX
  1524                                                                  ELCDTERX
  1525     IF DD-ID = 'STAT'                                            ELCDTERX
  1526         GO TO 0020-READ--STAT.                                   ELCDTERX
  1527                                                                  ELCDTERX
  1528     IF DD-ID = 'BUSC'                                            ELCDTERX
  1529         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1530                                                                  ELCDTERX
  1531     IF DD-ID = 'MORT'                                            ELCDTERX
  1532         GO TO 0030-READ--MORT.                                   ELCDTERX
  1533                                                                  ELCDTERX
  1534     IF DD-ID = 'CLAI'                                            ELCDTERX
  1535         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1536                                                                  ELCDTERX
  1537     IF DD-ID = 'COLC'                                            ELCDTERX
  1538         GO TO 0065-READ--COLC.                                   ELCDTERX
  1539                                                                  ELCDTERX
  1540     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1541        DD-IDA = 'CL'                                             ELCDTERX
  1542         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1543                                                                  ELCDTERX
  1544     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1545        DD-IDA = 'PO'                                             ELCDTERX
  1546         GO TO 0050-READ--POXX.                                   ELCDTERX
  1547                                                                  ELCDTERX
  1548     IF DD-ID = 'OPCA'                                            ELCDTERX
  1549         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1550                                                                  ELCDTERX
  1551     IF DD-ID = 'OPST'                                            ELCDTERX
  1552         GO TO 0072-READ--OPST.                                   ELCDTERX
  1553                                                                  ELCDTERX
  1554     IF DD-ID = 'OPBS'                                            ELCDTERX
  1555         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1556                                                                  ELCDTERX
  1557     IF DD-ID = 'OPMS'                                            ELCDTERX
  1558         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1559                                                                  ELCDTERX
  1560     GO TO 0005-READ--CARD.                                       ELCDTERX
  1561                                                                  ELCDTERX
  1562 0010-READ--CLAC.                                                 ELCDTERX
  1563     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1564     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1565     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1566     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1567     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1568     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1569     GO TO 0005-READ--CARD.                                       ELCDTERX
  1570                                                                  ELCDTERX
  1571 0015-READ--CARR.                                                 ELCDTERX
  1572     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1573     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1574        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1575        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1576        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1577        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1578        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1579        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1580        MOVE DD-CARR1-SECPAY-SW
  1581                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1582     END-IF
  1583                                                                  ELCDTERX
  1584     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1585     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1586        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1587        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1588        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1589        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1590        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1591        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1592        MOVE DD-CARR2-SECPAY-SW
  1593                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1594     END-IF
  1595                                                                  ELCDTERX
  1596                                                                  ELCDTERX
  1597     GO TO 0005-READ--CARD.                                       ELCDTERX
  1598                                                                  ELCDTERX
  1599 0020-READ--STAT.                                                 ELCDTERX
  1600     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1601     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1602        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1603         GO TO 0005-READ--CARD.                                   ELCDTERX
  1604                                                                  ELCDTERX
  1605     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1606     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1607     GO TO 0020-READ--STAT.                                       ELCDTERX
  1608                                                                  ELCDTERX
  1609 0025-READ--BUSC.                                                 ELCDTERX
  1610     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1611     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1612        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1613         GO TO 0005-READ--CARD.                                   ELCDTERX
  1614                                                                  ELCDTERX
  1615     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1616     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1617     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1618                                                                  ELCDTERX
  1619 0030-READ--MORT.                                                 ELCDTERX
  1620     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1621     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1622        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1623         GO TO 0005-READ--CARD.                                   ELCDTERX
  1624                                                                  ELCDTERX
  1625     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1626     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1627     GO TO 0030-READ--MORT.                                       ELCDTERX
  1628                                                                  ELCDTERX
  1629 0035-READ--CLXX.                                                 ELCDTERX
  1630     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1631          GO TO 0005-READ--CARD.                                  ELCDTERX
  1632                                                                  ELCDTERX
  1633     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1634         DISPLAY '***********************************************'ELCDTERX
  1635         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1636         DISPLAY '***********************************************'ELCDTERX
  1637         GO TO 0055-READ--STOP.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1638                                                                  ELCDTERX
  1639     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1640        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1641         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1642                                                                  ELCDTERX
  1643     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1644        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1645         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1646                                                                  ELCDTERX
  1647*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1648     GO TO 0005-READ--CARD.                                       ELCDTERX
  1649                                                                  ELCDTERX
  1650 0040-READ--CLAI.                                                 ELCDTERX
  1651     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1652     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1653        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1654         GO TO 0005-READ--CARD.                                   ELCDTERX
  1655                                                                  ELCDTERX
  1656     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1657     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1658     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1659                                                                  ELCDTERX
  1660 0045-READ--DUMP.                                                 ELCDTERX
  1661     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1662     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1663                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1664     PERFORM ABEND-PGM.                                           ELCDTERX
  1665                                                                  ELCDTERX
  1666 0050-READ--POXX.                                                 ELCDTERX
  1667     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1668         GO TO 0005-READ--CARD.                                   ELCDTERX
  1669                                                                  ELCDTERX
  1670     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1671         DISPLAY '***********************************************'ELCDTERX
  1672         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1673         DISPLAY '***********************************************'ELCDTERX
  1674         GO TO 0055-READ--STOP.                                   ELCDTERX
  1675                                                                  ELCDTERX
  1676     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1677     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1678     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1679     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1680                                                                  ELCDTERX
  1681     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1682         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1683     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1684         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1685                                                                  ELCDTERX
  1686     GO TO 0005-READ--CARD.                                       ELCDTERX
  1687                                                                  ELCDTERX
  1688 0055-READ--STOP.                                                 ELCDTERX
  1689     GOBACK.                                                      ELCDTERX
  1690                                                                  ELCDTERX
  1691 0060-READ--TEST.                                                 ELCDTERX
  1692     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1693        CLAX-ID         = SPACE  OR                               ELCDTERX
  1694        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1695         GO TO 0045-READ--DUMP.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* SQLBERMEBL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1696                                                                  ELCDTERX
  1697     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1698     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1699                                                                  ELCDTERX
  1700 0065-READ--COLC.                                                 ELCDTERX
  1701     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1702     GO TO 0005-READ--CARD.                                       ELCDTERX
  1703                                                                  ELCDTERX
  1704 0070-READ--OPCA.                                                 ELCDTERX
  1705                                                                  ELCDTERX
  1706     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1707                                                                  ELCDTERX
  1708     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1709             OR                                                   ELCDTERX
  1710         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1711         GO TO 0005-READ--CARD.                                   ELCDTERX
  1712                                                                  ELCDTERX
  1713     ADD 1                       TO INDEXCA.                      ELCDTERX
  1714     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1715                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1716     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1717                                                                  ELCDTERX
  1718 0072-READ--OPST.                                                 ELCDTERX
  1719                                                                  ELCDTERX
  1720     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1721                                                                  ELCDTERX
  1722     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1723             OR                                                   ELCDTERX
  1724         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1725         GO TO 0005-READ--CARD.                                   ELCDTERX
  1726                                                                  ELCDTERX
  1727     ADD 1                       TO INDEXST.                      ELCDTERX
  1728     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1729                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1730     GO TO 0072-READ--OPST.                                       ELCDTERX
  1731                                                                  ELCDTERX
  1732 0074-READ--OPBS.                                                 ELCDTERX
  1733                                                                  ELCDTERX
  1734     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1735                                                                  ELCDTERX
  1736     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1737             OR                                                   ELCDTERX
  1738         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1739         GO TO 0005-READ--CARD.                                   ELCDTERX
  1740                                                                  ELCDTERX
  1741     ADD 1                       TO INDEXBS.                      ELCDTERX
  1742     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1743     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1744                                                                  ELCDTERX
  1745 0079-READ--EXIT.                                                 ELCDTERX
  1746*    EXIT.                                                        ELCDTERX
  1747******************************************************************ELCDTERX
  1748 0000-begin.
  1749
  1750**  program option 1
  1751**     Build the entire table including previous months
  1752**  program option 2
  1753**     Just build / rebuild the current month
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* SQLBERMEBL.cbl
  1754**     based on the parm date
  1755
  1756     display ' Begin Program '
  1757
  1758     set P to address of KIXSYS
  1759     CALL "getenv" using by value P returning var-ptr
  1760     if var-ptr = null then
  1761        display ' kixsys not set '
  1762     else
  1763        set address of var to var-ptr
  1764        move 0 to env-var-len
  1765        inspect var tallying env-var-len
  1766          for characters before X'00'
  1767        unstring var (1:env-var-len) delimited by '/'
  1768           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  1769              WS-KIX-SYS
  1770        end-unstring
  1771     end-if
  1772
  1773     display ' KIXSYS  ' ws-kix-myenv
  1774
  1775     perform 0010-init           thru 0010-exit
  1776     perform 2000-connect-to-logic
  1777                                 thru 2000-exit
  1778     if parm-program-option = '1'
  1779        perform 1010-drop-table  thru 1010-exit
  1780     end-if
  1781
  1782*    perform 1020-truncate-table thru 1020-exit
  1783
  1784     if parm-program-option = '1'
  1785        perform 1000-create-table
  1786                                 thru 1000-exit
  1787     end-if
  1788
  1789     perform 0020-open-files     thru 0020-exit
  1790
  1791     EXEC SQL
  1792        SET AUTOCOMMIT OFF
  1793     END-EXEC
  1794
  1795     perform 0030-start-input    thru 0030-exit
  1796     perform 0046-read-input     thru 0046-exit
  1797     perform 0045-process-input  thru 0045-exit until
  1798        end-of-input
  1799*      or ws-recs-in > 10000
  1800
  1801     perform 0060-finish-up      thru 0060-exit
  1802     close ERMEBL
  1803     display ' End Program '
  1804     display ' rows inserted ' rec-cnt
  1805     display ' records read  ' ws-recs-in
  1806     goback
  1807
  1808     .
  1809 0010-init.
  1810
  1811     MOVE BIN-RUN-DATE           TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* SQLBERMEBL.cbl
  1812     MOVE    ' '                 TO DC-OPTION-CODE
  1813     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1814     move dc-greg-date-a-edit    to ws-moe-date
  1815     display ' parm length '     parm-length ' '
  1816        parm-current-month-end
  1817
  1818     string
  1819        parm-current-month-end (5:4)
  1820        parm-current-month-end (1:2)
  1821        parm-current-month-end (3:2)
  1822        delimited by size into dc-greg-date-cymd-r
  1823     end-string
  1824
  1825     move 'L'                    to dc-option-code
  1826     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1827     if no-conversion-error
  1828        move dc-greg-date-a-edit to tb-month-end-dt
  1829        display ' init month end date ' tb-month-end-dt
  1830     else
  1831        display ' invalid parm date - aborting '
  1832           parm-current-month-end
  1833        perform abend-pgm
  1834     end-if
  1835
  1836     move dc-greg-date-cymd      to ws-work-date
  1837
  1838     compute ws-work-date-moyr =
  1839        (ws-work-ccyy * 12) + ws-work-mm
  1840
  1841     display ' moyr ' ws-work-date-moyr
  1842
  1843     if parm-program-option = '1'
  1844        display ' Build the whole file '
  1845     else
  1846        if parm-program-option = '2'
  1847           display ' Build current month '
  1848        else
  1849           display ' invalid program option '
  1850           perform abend-pgm
  1851        end-if
  1852     end-if
  1853
  1854     .
  1855 0010-exit.
  1856     exit.
  1857
  1858 0020-open-files.
  1859
  1860     open input ERMEBL
  1861     if ermebl-file-status not = '00'
  1862        display ' error-ermebl-open ' ermebl-file-status
  1863        perform abend-pgm
  1864     end-if
  1865
  1866     .
  1867 0020-exit.
  1868     exit.
  1869
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* SQLBERMEBL.cbl
  1870 0030-start-input.
  1871
  1872     if parm-program-option = '1'
  1873        move low-values to me-control-primary
  1874     else
  1875        move dte-client          to me-company
  1876        move ws-work-date-moyr   to me-moyr
  1877     end-if
  1878     start ermebl key >= me-control-primary
  1879     if ermebl-file-status = '10' or '23'
  1880        set end-of-input to true
  1881     else
  1882        if ermebl-file-status not = '00'
  1883           display ' error-ermebl-start ' ermebl-file-status
  1884           perform abend-pgm
  1885        end-if
  1886     end-if
  1887
  1888     .
  1889 0030-exit.
  1890     exit.
  1891
  1892 0045-process-input.
  1893
  1894     perform 0050-insert-row     thru 0050-exit
  1895     perform 0046-read-input     thru 0046-exit
  1896
  1897     .
  1898 0045-exit.
  1899     exit.
  1900
  1901 0046-read-input.
  1902
  1903     read ermebl next record
  1904
  1905     evaluate true
  1906        when (parm-program-option = '1' or '2')
  1907           and (ermebl-file-status = '10' or '23')
  1908           set end-of-input      to true
  1909        when (parm-program-option = '2')
  1910           and ((me-company not = dte-client)
  1911           or (me-moyr not = ws-work-date-moyr))
  1912           set end-of-input      to true
  1913        when ermebl-file-status not = '00'
  1914           display ' error-ermebl-read ' ermebl-file-status
  1915           perform abend-pgm
  1916        when other
  1917           add 1 to ws-recs-in
  1918     end-evaluate
  1919
  1920     .
  1921 0046-exit.
  1922     exit.
  1923
  1924 0050-insert-row.
  1925
  1926     perform 0052-build-values   thru 0052-exit
  1927     perform 0057-insert-row     thru 0057-exit
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* SQLBERMEBL.cbl
  1928
  1929     .
  1930 0050-exit.
  1931     exit.
  1932
  1933 0052-build-values.
  1934
  1935     move me-company             to tb-company-id
  1936
  1937     if parm-program-option = '2'
  1938        go to 0052-continue
  1939     end-if
  1940
  1941     divide me-moyr by 12 giving ws-work-ccyy
  1942        remainder ws-work-mm
  1943     if ws-work-mm = zeros
  1944        move 12 to ws-work-mm
  1945        subtract 1 from ws-work-ccyy
  1946     end-if
  1947     move 01                     to ws-work-dd
  1948     move ws-work-date           to dc-greg-date-cymd-r
  1949     display ' ws-work-date ' ws-work-date
  1950     move 'L'                    to dc-option-code
  1951     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1952     if not no-conversion-error
  1953        display ' bad me eom dt ' me-moyr
  1954        perform abend-pgm
  1955     end-if
  1956     move dc-days-in-month    to ws-work-dd
  1957     string ws-work-mm '/'
  1958        ws-work-dd     '/'
  1959        ws-work-ccyy delimited by size into tb-month-end-dt
  1960     end-string
  1961
  1962     display ' tb month end ' tb-month-end-dt ' '
  1963        dc-days-in-month
  1964
  1965     .
  1966 0052-continue.
  1967
  1968     move me-010-cert-in         to tb-cert-in-cnt-n
  1969     move me-010-cert-out        to tb-cert-out-cnt-n
  1970
  1971     compute tb-ecs010-net-prem-n =
  1972        me-010-net-l + me-010-net-ah
  1973     compute tb-ecs010-net-comm-n =
  1974        me-010-comm-l + me-010-comm-ah
  1975     compute tb-ecs010-tot-clms-n =
  1976        me-010-pmt-l + me-010-pmt-ah
  1977
  1978     compute tb-ecs018-net-comm-y-n = me-018-comm-y
  1979     compute tb-ecs018-net-comm-1-n = me-018-comm-1
  1980     compute tb-ecs018-net-ow-y-n   = me-018-ow-y
  1981     compute tb-ecs018-net-ow-1-n   = me-018-ow-1
  1982
  1983     compute tb-ecs019-net-prem-n =
  1984        (me-019-prem-l + me-019-prem-ah) -
  1985        (me-019-ref-l + me-019-ref-ah)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  36
* SQLBERMEBL.cbl
  1986     compute tb-ecs019-net-comm-n =
  1987        me-019-comm-l + me-019-comm-ah
  1988     compute tb-ecs019-net-ow-n =
  1989        me-019-or-l   + me-019-or-ah
  1990
  1991      display ' me 019 claims ' me-019-clms-l ' ' me-019-clms-ah
  1992      compute tb-ecs019-tot-clms-n =
  1993         me-019-clms-l + me-019-clms-ah
  1994*    move zeros                  to tb-ecs019-tot-clms-n
  1995
  1996     compute tb-el522-net-prem-n =
  1997        (me-522-prem-l + me-522-prem-ah) -
  1998        (me-522-ref-l + me-522-ref-ah)
  1999     compute tb-el522-tot-clms-n =
  2000        me-522-proc-clm-l + me-522-proc-clm-ah
  2001     compute tb-el522-tot-resv-n =
  2002        me-522-proc-rsv-l + me-522-proc-rsv-ah
  2003     compute tb-el522-tot-pyaj-n = me-522-py-adj
  2004
  2005     compute tb-el524-tot-clms-n =
  2006        me-524-clms-l + me-524-clms-ah
  2007     compute tb-el524-tot-resv-n =
  2008        me-524-resv-l + me-524-resv-ah
  2009     compute tb-el524-tot-clms-cm-n = me-524-clms-tot-cm
  2010
  2011     compute tb-el315-tot-resv-n =
  2012        me-315-resv-l + me-315-resv-ah
  2013
  2014     compute tb-ecs030-tot-clms-n =
  2015        me-030-clms-l + me-030-clms-ah
  2016
  2017     compute tb-ecs032-tot-resv-n =
  2018        me-032-resv-l + me-032-resv-ah
  2019
  2020     compute tb-ecs035-net-prem-n =
  2021        me-035-net-l + me-035-net-ah
  2022      compute tb-ecs035-net-comm-n = me-035-comm-tot
  2023      compute tb-ecs035-tot-clms-n =
  2024         me-035-clms-l + me-035-clms-ah
  2025*     move zeros                 to tb-ecs035-net-comm-n
  2026*                                   tb-ecs035-tot-clms-n
  2027
  2028     compute tb-ecs061-net-prem-n = me-061-prem
  2029     compute tb-ecs061-net-comm-n = me-061-comm
  2030     compute tb-ecs061-net-ow-n   = me-061-or
  2031     compute tb-ecs061-tot-pyaj-n = me-061-py-adj
  2032     display ' ecs061 claims ' me-061-clms
  2033     compute tb-ecs061-tot-clms-n = me-061-clms
  2034*    move zeros                  to tb-ecs061-tot-clms-n
  2035
  2036     compute tb-ecs063-net-ow-n   = me-063-ow
  2037*    move zeros                  to tb-ecs063-net-ow-n
  2038
  2039     compute tb-ecs050-act-l-n = me-050-act-l
  2040     compute tb-ecs050-act-ah-n = me-050-act-ah
  2041*    move zeros                  to tb-ecs050-act-l-n
  2042*                                   tb-ecs050-act-ah-n
  2043
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  37
* SQLBERMEBL.cbl
  2044     compute tb-ecs082-act-l-n = me-082-act-l
  2045     compute tb-ecs082-act-ah-n = me-082-act-ah
  2046*    move zeros                  to tb-ecs082-act-l-n
  2047*                                   tb-ecs082-act-ah-n
  2048
  2049     compute tb-ecs016-in-cnt-n = me-016-recs-in
  2050     compute tb-ecs016-out-cnt-n = me-016-recs-out
  2051*    move zeros                  to tb-ecs016-in-cnt-n
  2052*                                   tb-ecs016-out-cnt-n
  2053
  2054     compute tb-ecs041-in-cnt-n = me-041-recs-in
  2055     compute tb-ecs041-out-cnt-n = me-041-recs-out
  2056*    move zeros                  to tb-ecs041-in-cnt-n
  2057*                                   tb-ecs041-out-cnt-n
  2058
  2059     compute tb-el562-net-prem-n = me-562-prem-tot
  2060     compute tb-el562-net-comm-n = me-562-comm-tot
  2061*    move zeros                  to tb-el562-net-prem-n
  2062*                                   tb-el562-net-comm-n
  2063
  2064     compute tb-el341-tot-clms-n =
  2065        me-341-clms-l + me-341-clms-ah
  2066
  2067     compute tb-el317-tot-clms-n = me-317-clms-tot
  2068
  2069     compute tb-el325-tot-clms-n = me-325-clms-tot
  2070
  2071     compute tb-ecs020-net-prem-n = me-020-prem-tot
  2072     compute tb-ecs020-tot-clms-n = me-020-clms-tot
  2073     compute tb-ecs020-tot-resv-n = me-020-resv-tot
  2074     compute tb-el515-clms-wrap-n = me-515-clms-wrap
  2075     compute tb-el515-resv-wrap-n = me-515-resv-wrap
  2076     compute tb-el523-tot-prem-n  = me-523-prem-tot
  2077
  2078     display ' 523 tb me ' tb-el523-tot-prem ' ' me-523-prem-tot
  2079
  2080     compute tb-ecs064-beg-bal-n  = me-064-beg-bal
  2081     compute tb-ecs064-end-bal-n  = me-064-end-bal
  2082     compute tb-ecs010-mm-net-prem-n = me-010-mm-prem-tot
  2083     compute tb-ecs010-mm-tot-clms-n = me-010-mm-tot-clms
  2084     compute tb-ecs010-mm-tot-resv-n = me-010-mm-tot-resv
  2085     if me-080-mort-resv not numeric
  2086        move zeros               to me-080-mort-resv
  2087     end-if
  2088     compute tb-ecs080-mort-resv-n  = me-080-mort-resv
  2089
  2090     .
  2091 0052-exit.
  2092     exit.
  2093
  2094 0057-insert-row.
  2095
  2096     EXEC SQL
  2097        insert into ERMEBL (
  2098          MONTH_END_DT        ,
  2099          COMPANY_ID          ,
  2100          CERT_IN_CNT         ,
  2101          CERT_OUT_CNT        ,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  38
* SQLBERMEBL.cbl
  2102          ECS010_NET_PREM     ,
  2103          ECS010_NET_COMM     ,
  2104          ECS010_TOT_CLMS     ,
  2105          ECS010_MM_NET_PREM  ,
  2106          ECS010_MM_TOT_CLMS  ,
  2107          ECS010_MM_TOT_RESV  ,
  2108          ECS018_NET_COMM_Y   ,
  2109          ECS018_NET_OW_Y     ,
  2110          ECS018_NET_COMM_1   ,
  2111          ECS018_NET_OW_1     ,
  2112          ECS019_NET_PREM     ,
  2113          ECS019_NET_COMM     ,
  2114          ECS019_NET_OW       ,
  2115          ECS019_TOT_CLMS     ,
  2116          EL522_NET_PREM      ,
  2117          EL522_TOT_CLMS      ,
  2118          EL522_TOT_RESV      ,
  2119          EL522_TOT_PYAJ      ,
  2120          EL524_TOT_CLMS      ,
  2121          EL524_TOT_RESV      ,
  2122          EL524_TOT_CLMS_CM   ,
  2123          EL315_TOT_RESV      ,
  2124          ECS030_TOT_CLMS     ,
  2125          ECS032_TOT_RESV     ,
  2126          ECS035_NET_PREM     ,
  2127          ECS035_NET_COMM     ,
  2128          ECS035_TOT_CLMS     ,
  2129          ECS061_NET_PREM     ,
  2130          ECS061_NET_COMM     ,
  2131          ECS061_NET_OW       ,
  2132          ECS061_TOT_CLMS     ,
  2133          ECS061_TOT_PYAJ     ,
  2134          ECS063_NET_OW       ,
  2135          ECS050_ACT_L        ,
  2136          ECS050_ACT_AH       ,
  2137          ECS082_ACT_L        ,
  2138          ECS082_ACT_AH       ,
  2139          ECS016_IN_CNT       ,
  2140          ECS016_OUT_CNT      ,
  2141          ECS041_IN_CNT       ,
  2142          ECS041_OUT_CNT      ,
  2143          EL562_NET_PREM      ,
  2144          EL562_NET_COMM      ,
  2145          EL341_TOT_CLMS      ,
  2146          EL317_TOT_CLMS      ,
  2147          EL325_TOT_CLMS      ,
  2148          ECS020_ITD_PREM     ,
  2149          ECS020_ITD_CLMS     ,
  2150          ECS020_ITD_RESV     ,
  2151          EL515_CLMS_WRAP     ,
  2152          EL515_RESV_WRAP     ,
  2153          EL523_TOT_PREM      ,
  2154          ECS064_BEG_BAL      ,
  2155          ECS064_END_BAL      ,
  2156          ECS080_MORT_RESV)
  2157               values (
  2158            :TB-MONTH-END-DT       ,
  2159            :TB-COMPANY-ID         ,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  39
* SQLBERMEBL.cbl
  2160            :TB-CERT-IN-CNT        ,
  2161            :TB-CERT-OUT-CNT       ,
  2162            :TB-ECS010-NET-PREM    ,
  2163            :TB-ECS010-NET-COMM    ,
  2164            :TB-ECS010-TOT-CLMS    ,
  2165            :TB-ECS010-MM-NET-PREM ,
  2166            :TB-ECS010-MM-TOT-CLMS ,
  2167            :TB-ECS010-MM-TOT-RESV ,
  2168            :TB-ECS018-NET-COMM-Y  ,
  2169            :TB-ECS018-NET-OW-Y    ,
  2170            :TB-ECS018-NET-COMM-1  ,
  2171            :TB-ECS018-NET-OW-1    ,
  2172            :TB-ECS019-NET-PREM    ,
  2173            :TB-ECS019-NET-COMM    ,
  2174            :TB-ECS019-NET-OW      ,
  2175            :TB-ECS019-TOT-CLMS    ,
  2176            :TB-EL522-NET-PREM     ,
  2177            :TB-EL522-TOT-CLMS     ,
  2178            :TB-EL522-TOT-RESV     ,
  2179            :TB-EL522-TOT-PYAJ     ,
  2180            :TB-EL524-TOT-CLMS     ,
  2181            :TB-EL524-TOT-RESV     ,
  2182            :TB-EL524-TOT-CLMS-CM  ,
  2183            :TB-EL315-TOT-RESV     ,
  2184            :TB-ECS030-TOT-CLMS    ,
  2185            :TB-ECS032-TOT-RESV    ,
  2186            :TB-ECS035-NET-PREM    ,
  2187            :TB-ECS035-NET-COMM    ,
  2188            :TB-ECS035-TOT-CLMS    ,
  2189            :TB-ECS061-NET-PREM    ,
  2190            :TB-ECS061-NET-COMM    ,
  2191            :TB-ECS061-NET-OW      ,
  2192            :TB-ECS061-TOT-CLMS    ,
  2193            :TB-ECS061-TOT-PYAJ    ,
  2194            :TB-ECS063-NET-OW      ,
  2195            :TB-ECS050-ACT-L       ,
  2196            :TB-ECS050-ACT-AH      ,
  2197            :TB-ECS082-ACT-L       ,
  2198            :TB-ECS082-ACT-AH      ,
  2199            :TB-ECS016-IN-CNT      ,
  2200            :TB-ECS016-OUT-CNT     ,
  2201            :TB-ECS041-IN-CNT      ,
  2202            :TB-ECS041-OUT-CNT     ,
  2203            :TB-EL562-NET-PREM     ,
  2204            :TB-EL562-NET-COMM     ,
  2205            :TB-EL341-TOT-CLMS     ,
  2206            :TB-EL317-TOT-CLMS     ,
  2207            :TB-EL325-TOT-CLMS     ,
  2208            :TB-ECS020-NET-PREM    ,
  2209            :TB-ECS020-TOT-CLMS    ,
  2210            :TB-ECS020-TOT-RESV    ,
  2211            :TB-EL515-CLMS-WRAP    ,
  2212            :TB-EL515-RESV-WRAP    ,
  2213            :TB-EL523-TOT-PREM     ,
  2214            :TB-ECS064-BEG-BAL     ,
  2215            :TB-ECS064-END-BAL     ,
  2216            :TB-ECS080-MORT-RESV)
  2217     end-exec
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  40
* SQLBERMEBL.cbl
  2218
  2219     if sqlcode not = 0
  2220        display "Error: cannot insert row "
  2221        move sqlcode             to ws-sql-code
  2222        move ws-sql-code         to ws-dis-sql-code
  2223        display ' sqlcode ' ws-dis-sql-code
  2224        display ' sql err mess    ' sqlerrmc
  2225        display ' in out cnt ' ws-recs-in ' ' rec-cnt
  2226        display ' offending rec ' ermebl-table-record
  2227     else
  2228        add 1 to rec-cnt
  2229     end-if
  2230
  2231     .
  2232 0057-exit.
  2233     exit.
  2234
  2235 0060-finish-up.
  2236
  2237     EXEC SQL
  2238         commit work release
  2239     END-EXEC
  2240
  2241     if sqlcode not = 0
  2242        display "Error: commit work release "
  2243        display ' sql return code ' sqlcode
  2244        display ' sql err mess    ' sqlerrmc
  2245     end-if
  2246
  2247     EXEC SQL
  2248        DISCONNECT
  2249     END-EXEC
  2250
  2251     if sqlcode not = 0
  2252        display "Error: disconnect  "
  2253        display ' sql return code ' sqlcode
  2254        display ' sql err mess    ' sqlerrmc
  2255     end-if
  2256
  2257     .
  2258 0060-exit.
  2259     exit.
  2260
  2261 1000-create-table.
  2262
  2263     display ' Begin Create table '
  2264
  2265     EXEC SQL
  2266        create table ERMEBL (
  2267          MONTH_END_DT        datetime NOT null,
  2268          COMPANY_ID          char(3) NOT NULL,
  2269          CERT_IN_CNT         int not null,
  2270          CERT_OUT_CNT        int not null,
  2271          ECS010_NET_PREM     decimal(11,2),
  2272          ECS010_NET_COMM     decimal(11,2),
  2273          ECS010_TOT_CLMS     decimal(11,2),
  2274          ECS010_MM_NET_PREM  decimal(11,2),
  2275          ECS010_MM_TOT_CLMS  decimal(11,2),
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  41
* SQLBERMEBL.cbl
  2276          ECS010_MM_TOT_RESV  decimal(11,2),
  2277          ECS018_NET_COMM_Y   decimal(11,2),
  2278          ECS018_NET_OW_Y     decimal(11,2),
  2279          ECS018_NET_COMM_1   decimal(11,2),
  2280          ECS018_NET_OW_1     decimal(11,2),
  2281          ECS019_NET_PREM     decimal(11,2),
  2282          ECS019_NET_COMM     decimal(11,2),
  2283          ECS019_NET_OW       decimal(11,2),
  2284          ECS019_TOT_CLMS     decimal(11,2),
  2285          EL522_NET_PREM      decimal(11,2),
  2286          EL522_TOT_CLMS      decimal(11,2),
  2287          EL522_TOT_RESV      decimal(11,2),
  2288          EL522_TOT_PYAJ      decimal(11,2),
  2289          EL524_TOT_CLMS      decimal(11,2),
  2290          EL524_TOT_RESV      decimal(11,2),
  2291          EL524_TOT_CLMS_CM   decimal(11,2),
  2292          EL315_TOT_RESV      decimal(11,2),
  2293          ECS030_TOT_CLMS     decimal(11,2),
  2294          ECS032_TOT_RESV     decimal(11,2),
  2295          ECS035_NET_PREM     decimal(11,2),
  2296          ECS035_NET_COMM     decimal(11,2),
  2297          ECS035_TOT_CLMS     decimal(11,2),
  2298          ECS061_NET_PREM     decimal(11,2),
  2299          ECS061_NET_COMM     decimal(11,2),
  2300          ECS061_NET_OW       decimal(11,2),
  2301          ECS061_TOT_CLMS     decimal(11,2),
  2302          ECS061_TOT_PYAJ     decimal(11,2),
  2303          ECS063_NET_OW       decimal(11,2),
  2304          ECS050_ACT_L        int,
  2305          ECS050_ACT_AH       int,
  2306          ECS082_ACT_L        int,
  2307          ECS082_ACT_AH       int,
  2308          ECS016_IN_CNT       int not null,
  2309          ECS016_OUT_CNT      int not null,
  2310          ECS041_IN_CNT       int not null,
  2311          ECS041_OUT_CNT      int not null,
  2312          EL562_NET_PREM      decimal(11,2),
  2313          EL562_NET_COMM      decimal(11,2),
  2314          EL341_TOT_CLMS      decimal(11,2),
  2315          EL317_TOT_CLMS      decimal(11,2),
  2316          EL325_TOT_CLMS      decimal(11,2),
  2317          ECS020_ITD_PREM     decimal(13,2),
  2318          ECS020_ITD_CLMS     decimal(11,2),
  2319          ECS020_ITD_RESV     decimal(11,2),
  2320          EL515_CLMS_WRAP     decimal(11,2),
  2321          EL515_RESV_WRAP     decimal(11,2),
  2322          EL523_TOT_PREM      decimal(11,2),
  2323          ECS064_BEG_BAL      decimal(11,2),
  2324          ECS064_END_BAL      decimal(11,2),
  2325          ECS080_MORT_RESV    decimal(11,2)
  2326           CONSTRAINT PK_ERMEBL PRIMARY KEY CLUSTERED
  2327             (MONTH_END_DT, COMPANY_ID)
  2328             )
  2329     END-EXEC
  2330
  2331     if sqlcode not = 0
  2332        display "Error: cannot create table "
  2333        move sqlcode             to ws-disp-code
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  42
* SQLBERMEBL.cbl
  2334        display ' sql return code ' ws-disp-code
  2335        display ' sql err mess    ' sqlerrmc
  2336        goback
  2337     end-if
  2338
  2339     .
  2340 1000-exit.
  2341     exit.
  2342
  2343 1010-drop-table.
  2344
  2345     display 'Begin Drop table'
  2346     EXEC SQL
  2347         drop table ERMEBL
  2348     END-EXEC
  2349     if sqlcode not = 0
  2350        display "Error(anticipated) : cannot drop table "
  2351        move sqlcode             to ws-sql-code
  2352        move ws-sql-code         to ws-dis-sql-code
  2353        display ' sqlcode ' ws-dis-sql-code
  2354        display ' message ' sqlerrmc
  2355     end-if
  2356
  2357     .
  2358 1010-exit.
  2359     exit.
  2360
  2361 1020-truncate-table.
  2362
  2363     display 'Begin Truncate table'
  2364     EXEC SQL
  2365         truncate table ERMEBL
  2366     END-EXEC
  2367
  2368     if sqlcode not = 0
  2369        display "Error : cannot truncate table "
  2370        move sqlcode             to ws-sql-code
  2371        move ws-sql-code         to ws-dis-sql-code
  2372        display ' sqlcode ' ws-dis-sql-code
  2373        display ' message ' sqlerrmc
  2374     end-if
  2375
  2376     .
  2377 1020-exit.
  2378     exit.
  2379
  2380 2000-connect-to-logic.
  2381
  2382     display ' about to connect to Logic '
  2383
  2384     move 'NTSQLTST2_Logic'      to svr
  2385     move 'sa'                   to usr
  2386     move 'sql2008r2'            to pass
  2387
  2388     if ws-kix-myenv = 'cid1p'
  2389        move 'NTCSO2_Logic'      to svr
  2390        move 'sa'                to usr
  2391        move 'ntcso2'            to pass
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  43
* SQLBERMEBL.cbl
  2392     end-if
  2393
  2394     string
  2395         usr delimited space
  2396         "." delimited size
  2397         pass delimited space into usr-pass
  2398     end-string
  2399
  2400     EXEC SQL
  2401        SET OPTION logintime 5
  2402     END-EXEC
  2403
  2404     EXEC SQL
  2405        CONNECT TO :svr
  2406              USER :usr-pass
  2407     END-EXEC
  2408
  2409     if sqlcode not = 0
  2410        display "Error: cannot connect to Logic"
  2411        move sqlcode             to ws-sql-code
  2412        move ws-sql-code         to ws-dis-sql-code
  2413        display ' sqlcode ' ws-dis-sql-code
  2414        display sqlerrmc
  2415        perform abend-pgm
  2416     end-if
  2417
  2418     .
  2419 2000-exit.
  2420     exit.
  2421
  2422 8500-DATE-CONVERT.
* 2423                                 COPY ELCDCS.
  2424****************************************************************  04/15/98
  2425*                                                              *  ELCDCS
  2426*                                                              *  ELCDCS
  2427*                            ELCDCS.                           *     LV003
  2428*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2429*                            VMOD=2.002                        *     CL**3
  2430*                                                              *  ELCDCS
  2431*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  2432****************************************************************. ELCDCS
  2433                                                                  ELCDCS
  2434 8510-DATE-CONVERSION.                                            ELCDCS
  2435     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  2436                                                                  ELCDCS
  2437 8590-EXIT.                                                       ELCDCS
  2438     EXIT.                                                        ELCDCS
  2439                                                                  ELCDCS
  2440
  2441 abend-pgm.
  2442
  2443      call 'ABORTME'.
  2444
  2445      goback.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  44
* SQLBERMEBL.cbl
* Data:      181404     Code:       18142
