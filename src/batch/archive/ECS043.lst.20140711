* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* ECS043.cbl
* Options: int("ECS043.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS043.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS043.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS043.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ECS043.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/13/94 16:43:46.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                           VMOD=2.021.
     9*AUTHOR.     LOGIC, INC.
    10*            DALLAS, TEXAS.
    11
    12*SECURITY.   *****************************************************
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* ECS043.cbl
    14*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    15*            *                                                   *
    16*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    17*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    THIS PROGRAM WILL READ THE EP-EC FILE AND PRINT
    23*            EARNED REVIEW STATEMENTS.
    24
    25*            AN OPTIONAL CARD INPUT MAY BE USED TO SPECIFY A
    26*        FORMAT OTHER THAN YTD AND ITD.
    27
    28*        FORMAT OF INPUT IS -
    29*         CC 1-2    CARD I.D. 'RF'
    30*            3-5    CLIENT-ID
    31*            6      LEFT SIDE FORMAT  (RIGHT SIDE ALWAYS ITD)
    32
    33*                  BLANK  USE DATE IN CC 7-14 AS BEGINNING DATE
    34*                      1  YTD
    35*                      2  QTD
    36*                      3  LAST 3 MOS.
    37*                      4  LAST 6 MOS.
    38*                      5  LAST 12 MOS.
    39*                      6  LAST MONTH
    40
    41*            7-14   BEGINNING DATE  (CCYYMMDD)
    42
    43******************************************************************
    44*                   C H A N G E   L O G
    45*
    46* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    47*-----------------------------------------------------------------
    48*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    49* EFFECTIVE    NUMBER
    50*-----------------------------------------------------------------
    51* 060402    2002060300014  SMVA  MOVE PAGE # FROM BOTTOM TO TOP
    52* 061302    2002061200004  SMVA  REMOVE ECS043B HARDCOPY - PRTN043
    53* 090908    2008090300001  AJRA  FIX RETRO CALC FOR COMMISSION
    54*                                FIX DIVIDE BY ZERO
    55* 051810 CR2010042900001   PEMA  SPEARATE CITY AND STATE
    56******************************************************************
    57
    58
    59 ENVIRONMENT DIVISION.
    60 INPUT-OUTPUT SECTION.
    61 FILE-CONTROL.
    62
    63     SELECT  SORT-WORK       ASSIGN TO SYS001-DA-FBA1-S-SORTWK1.
    64     SELECT  PRNTR           ASSIGN TO SYS008-UR-1403-S-SYS008.
    65     SELECT  EPEC-FILE       ASSIGN TO SYS010-UT-2400-S-SYS010.
    66     SELECT  ACC-MSTR        ASSIGN TO ERACCTT
    67                             ACCESS IS SEQUENTIAL
    68                             ORGANIZATION IS INDEXED
    69                             FILE STATUS IS ERACCTT-FILE-STATUS
    70                             RECORD KEY IS AM-CONTROL-PRIMARY.
    71     SELECT  ERPLAN-IN       ASSIGN TO ERPLAN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* ECS043.cbl
    72                             ORGANIZATION IS INDEXED
    73                             ACCESS IS DYNAMIC
    74                             FILE STATUS IS ERPLAN-FILE-STATUS
    75                             RECORD KEY IS PL-CONTROL-PRIMARY.
    76     SELECT  DISK-DATE       ASSIGN TO SYS019-UT-FBA1-S-SYS019.
    77     SELECT  FICH            ASSIGN TO SYS020-UT-2400-S-SYS020.
    78     SELECT  CONTROL-CARD    ASSIGN TO SYS006-UR-2540R-S-SYS006.
    79
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* ECS043.cbl
    81 DATA DIVISION.
    82 FILE SECTION.
    83
    84 SD  SORT-WORK.
    85
    86 01  SW-REC-OUT.
    87     12  SW-RPT-TYPE-ID-OUT  PIC X.
    88     12  SW-CTL-OUT          PIC X(35).
    89     12  FILLER              PIC X(1090).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* ECS043.cbl
    91 FD  CONTROL-CARD
    92     BLOCK CONTAINS 0 RECORDS
    93     RECORDING MODE F.
    94
    95 01  CARD-IN-AREA            PIC X(80).
    96
    97 FD  PRNTR
*   98                             COPY ELCPRTFD.
    99******************************************************************04/15/98
   100*                                                                *ELCPRTFD
   101*                                                                *ELCPRTFD
   102*                            ELCPRTFD.                           *   LV003
   103*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   104*                            VMOD=2.006                          *ELCPRTFD
   105******************************************************************ELCPRTFD
   106     RECORDING MODE F                                             ELCPRTFD
   107     LABEL RECORDS OMITTED                                        ELCPRTFD
   108     BLOCK CONTAINS 0 RECORDS
   109     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   110 01  PRT.                                                         ELCPRTFD
   111     12  P-CTL               PIC  X.                                 CL**2
   112     12  P-DATA              PIC  X(132).                         ELCPRTFD
   113******************************************************************ELCPRTFD
   114
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* ECS043.cbl
   116 FD  EPEC-FILE
*  117                             COPY ECSEPCFD.
   118******************************************************************07/10/97
   119*                                                                *ECSEPCFD
   120*                            ECSEPCFD                            *   LV001
   121*                            VMOD=2.002                          *ECSEPCFD
   122*                                                                *ECSEPCFD
   123*  NO  CID  MODS  IN  COPYBOOK  ECSEPCFD                         *ECSEPCFD
   124*                                                                *ECSEPCFD
   125******************************************************************ECSEPCFD
   126     RECORDING MODE F                                             ECSEPCFD
   127     LABEL RECORDS STANDARD                                       ECSEPCFD
   128     BLOCK CONTAINS 0 RECORDS
   129     RECORD CONTAINS 325 CHARACTERS.                              ECSEPCFD
   130******************************************************************ECSEPCFD
*  131                             COPY ECSEPC01.
   132******************************************************************
   133*                                                                *
   134*                            ECSEPC01                            *
   135*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   136*                            VMOD=2.008                          *
   137*                                                                *
   138*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
   139*                                                                *
   140*   FILE TYPE = SEQUENTIAL                                       *
   141*   RECORD SIZE = 325  RECFORM = FIXED                           *
   142*                                                                *
   143*   KEY DATA =                                  START=5, LEN=31  *
   144*                                                                *
   145*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
   146*                                                                *
   147******************************************************************
   148
   149 01  EP-RECORD.
   150     02 EP-FILE.
   151     12  EP-RECORD-ID                      PIC XX.
   152         88  VALID-EP-ID                      VALUE 'EP'.
   153
   154     12  EP-COMPANY-CD                     PIC X.
   155
   156     12  EP-REIN                           PIC X.
   157         88  EP-REIN-EXTRACT                  VALUE 'R'.
   158
   159     12  EP-CONTROL.
   160         16  EP-CNTRL-1.
   161             20  EP-COMPANY.
   162                 24  EP-CARRIER            PIC X.
   163                 24  EP-GROUPING.
   164                     28  EP-GROUP-PREFIX   PIC XXX.
   165                     28  EP-GROUP-PRIME    PIC XXX.
   166             20  EP-STATE                  PIC XX.
   167             20  EP-ACCOUNT.
   168                 24  EP-ACCT-PREFIX        PIC X(4).
   169                 24  EP-ACCT-PRIME         PIC X(6).
   170         16  EP-CNTRL-2.
   171             20  EP-DATES.
   172                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
   173                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* ECS043.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   174
   175     12  EP-REI-CO.
   176         16  EP-REINCO                     PIC XXX.
   177         16  EP-REINCO-SUB                 PIC XXX.
   178
   179     12  EP-RCD-TYPE                       PIC X.
   180         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
   181         88  EP-BEN-TYPE-AH                   VALUE 'A'.
   182         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
   183         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   184         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   185         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
   186     12  EP-BEN-CODE                       PIC XX.
   187     12  FILLER                            PIC X.
   188
   189     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
   190     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
   191     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   192
   193     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
   194     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
   195     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   196
   197     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
   198     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   199     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
   200     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   201
   202     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
   203     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
   204     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
   205
   206     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
   207     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
   208     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
   209
   210     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
   211     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
   212     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
   213     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
   214     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
   215
   216     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
   217     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
   218     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
   219
   220     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
   221     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
   222     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
   223
   224     12  EP-SPECIFIC-OPT-RSV-FIELDS.
   225         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
   226         16  EP-NEW-DATA-IND               PIC X(01).
   227             88  EP-NEW-DATA                   VALUE 'Y'.
   228         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
   229         16  FILLER                        PIC X(19).
   230
   231     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* ECS043.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   232     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
   233     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
   234
   235     12  FILLER                            PIC XXX.
   236
   237     12  EP-UNDERWRITING-CODE              PIC X.
   238         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
   239
   240     12  EP-PRM-TAX                        PIC S9(5)V99   COMP-3.
   241
   242     12  FILLER                            PIC X(30).
   243*    12  FILLER                            PIC X(34).
   244
   245     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
   246     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
   247     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
   248     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
   249     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
   250     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
   251
   252     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
   253
   254     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
   255     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
   256
   257     12  EP-PURGE                          PIC X.
   258         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   259
   260     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
   261
   262     02 EC-RECORD     REDEFINES     EP-FILE.
   263     12  EC-RECORD-ID                      PIC XX.
   264         88  VALID-EC-ID                      VALUE 'EC'.
   265
   266     12  EC-COMPANY-CD                     PIC X.
   267
   268     12  EC-REIN                           PIC X.
   269         88  EC-REIN-EXTRACT                  VALUE 'R'.
   270
   271     12  EC-CONTROL.
   272         16  EC-CARRIER                    PIC X.
   273         16  EC-GROUPING.
   274             20  EC-GROUP-PREFIX           PIC XXX.
   275             20  EC-GROUP-PRIME            PIC XXX.
   276         16  EC-STATE                      PIC XX.
   277         16  EC-ACCOUNT.
   278             20  EC-ACCT-PREFIX            PIC X(4).
   279             20  EC-ACCT-PRIME             PIC X(6).
   280         16  EC-DATES.
   281             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
   282             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
   283
   284     12  EC-REI-CO.
   285         16  EC-REINCO                     PIC XXX.
   286         16  EC-REINCO-SUB                 PIC XXX.
   287
   288     12  EC-RCD-TYPE                       PIC X.
   289         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* ECS043.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   290         88  EC-BEN-TYPE-AH                   VALUE 'A'.
   291         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
   292         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   293         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   294     12  EC-BEN-CODE                       PIC XX.
   295     12  EC-SEQ-NBR                        PIC X.
   296         88  EC-COMP-LEVELS-1-5               VALUE '1'.
   297         88  EC-COMP-LEVELS-6-10              VALUE '2'.
   298
   299     12  EC-AGENTS-DATA.
   300         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
   301             20  EC-AGT-NO.
   302                 24  EC-AGT-PREFIX         PIC X(4).
   303                 24  EC-AGT-PRIME          PIC X(6).
   304             20  EC-AGT-TYPE               PIC X.
   305             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
   306             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
   307             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
   308             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
   309             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
   310
   311     12  EC-UNDERWRITING-CODE              PIC X.
   312         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
   313
   314     12  EC-AGENTS-DATA-II.
   315         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
   316             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
   317             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
   318
   319     12  FILLER                            PIC X(7).
   320
   321     12  EC-PURGE                          PIC X.
   322         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   323
   324     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
   325
   326******************************************************************
   327
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* ECS043.cbl
   329 FD  ACC-MSTR.
*  330                             COPY ERCACCT.
   331******************************************************************04/19/98
   332*                                                                *ERCACCT
   333*                                                                *ERCACCT
   334*                            ERCACCT                             *   LV031
   335*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   336*                            VMOD=2.031                          *ERCACCT
   337*                                                                *ERCACCT
   338*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   339*                                                                *ERCACCT
   340*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   341*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   342*                                                                *ERCACCT
   343*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   344*                                                                *ERCACCT
   345*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   346*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   347*                                                                *ERCACCT
   348*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   349*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   350*                                                                *ERCACCT
   351*   LOG = NO                                                     *ERCACCT
   352*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   353*                                                                *ERCACCT
   354*                                                                *ERCACCT
   355******************************************************************ERCACCT
   356*                   C H A N G E   L O G
   357*
   358* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   359*-----------------------------------------------------------------
   360*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   361* EFFECTIVE    NUMBER
   362*-----------------------------------------------------------------
   363* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   364* 092705    2005050300006  PEMA  ADD SPP LEASES
   365* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   366* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   367* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   368* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   369* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   370******************************************************************
   371                                                                  ERCACCT
   372 01  ACCOUNT-MASTER.                                              ERCACCT
   373     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   374         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   375                                                                  ERCACCT
   376     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   377         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   378         16  AM-MSTR-CNTRL.                                       ERCACCT
   379             20  AM-CONTROL-A.                                    ERCACCT
   380                 24  AM-CARRIER            PIC X.                 ERCACCT
   381                 24  AM-GROUPING.                                 ERCACCT
   382                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   383                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   384                 24  AM-STATE              PIC XX.                ERCACCT
   385                 24  AM-ACCOUNT.                                  ERCACCT
   386                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* ECS043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   387                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   388             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   389                                           PIC X(19).             ERCACCT
   390             20  AM-CNTRL-B.                                      ERCACCT
   391                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   392                 24  FILLER                PIC X(4).              ERCACCT
   393             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   394                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   395                                                                  ERCACCT
   396     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   397         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   398         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   399         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   400         16  AM-VG-STATE                   PIC XX.                ERCACCT
   401         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   402         16  AM-VG-DATE.                                          ERCACCT
   403             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   404             20  FILLER                    PIC X(4).              ERCACCT
   405         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   406                                           PIC 9(11)      COMP-3. ERCACCT
   407     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   408         16  FILLER                        PIC X(10).
   409         16  AM-VG-KEY3.
   410             20  AM-VG3-ACCOUNT            PIC X(10).
   411             20  AM-VG3-EXP-DT             PIC XX.
   412         16  FILLER                        PIC X(4).
   413     12  AM-MAINT-INFORMATION.                                    ERCACCT
   414         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   415         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   416         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   417         16  FILLER                        PIC XX.                ERCACCT
   418                                                                  ERCACCT
   419     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   420     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   421                                                                  ERCACCT
   422     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   423         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   424         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   425                                                                  ERCACCT
   426     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   427     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   428                                                                  ERCACCT
   429     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   430     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   431                                                                  ERCACCT
   432     12  AM-NAME                           PIC X(30).             ERCACCT
   433     12  AM-PERSON                         PIC X(30).             ERCACCT
   434     12  AM-ADDRS                          PIC X(30).             ERCACCT
   435     12  AM-CITY.
   436         16  AM-ADDR-CITY                  PIC X(28).
   437         16  AM-ADDR-STATE                 PIC XX.
   438     12  AM-ZIP.                                                  ERCACCT
   439         16  AM-ZIP-PRIME.                                        ERCACCT
   440             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   441                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   442             20  FILLER                    PIC X(4).              ERCACCT
   443         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   444     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* ECS043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   445         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   446         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   447         16  FILLER                        PIC XXX.               ERCACCT
   448     12  AM-TEL-NO.                                               ERCACCT
   449         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   450         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   451         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   452     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   453         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   454         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   455                                                                  ERCACCT
   456     12  AM-COMM-STRUCTURE.                                       ERCACCT
   457         16  AM-DEFN-1.                                           ERCACCT
   458             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   459                 24  AM-AGT.                                      ERCACCT
   460                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   461                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   462                 24  AM-COM-TYP            PIC X.                 ERCACCT
   463                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   464                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   465                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   466                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   467                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   468                 24  AM-GL-CODES           PIC X.                 ERCACCT
   469                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   470                 24  FILLER                PIC X(01).             ERCACCT
   471         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   472             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   473                 24  FILLER                PIC X(11).             ERCACCT
   474                 24  AM-L-COMA             PIC XXX.               ERCACCT
   475                 24  AM-J-COMA             PIC XXX.               ERCACCT
   476                 24  AM-A-COMA             PIC XXX.               ERCACCT
   477                 24  FILLER                PIC X(6).              ERCACCT
   478                                                                  ERCACCT
   479     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   480         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   481                                                                  ERCACCT
   482     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   483                                                                  ERCACCT
   484     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   485         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   486         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   487     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   488         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   489         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   490     12  AM-GPCD                           PIC 99.                ERCACCT
   491     12  AM-IG                             PIC X.                 ERCACCT
   492         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   493         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   494     12  AM-STATUS                         PIC X.                 ERCACCT
   495         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   496         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   497         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   498         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   499         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   500         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   501     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   502     12  AM-ID-NO                          PIC X(11).             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* ECS043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   503                                                                  ERCACCT
   504     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   505     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   506     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   507     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   508     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   509     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   510     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   511     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   512     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   513                                                                  ERCACCT
   514     12  AM-USER-FIELDS.                                          ERCACCT
   515         16  AM-FLD-1                      PIC XX.                ERCACCT
   516         16  AM-FLD-2                      PIC XX.                ERCACCT
   517         16  AM-FLD-3                      PIC XX.                ERCACCT
   518         16  AM-FLD-4                      PIC XX.                ERCACCT
   519         16  AM-FLD-5                      PIC XX.                ERCACCT
   520                                                                  ERCACCT
   521     12  AM-1ST-PROD-DATE.                                        ERCACCT
   522         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   523         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   524         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   525     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   526     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   527         16  AM-PUR-YR                     PIC XX.                ERCACCT
   528         16  AM-PUR-MO                     PIC XX.                ERCACCT
   529         16  AM-PUR-DA                     PIC XX.                ERCACCT
   530     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   531     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   532     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   533     12  AM-INACTIVE-DATE.                                        ERCACCT
   534         16  AM-INA-MO                     PIC 99.                ERCACCT
   535         16  AM-INA-DA                     PIC 99.                ERCACCT
   536         16  AM-INA-YR                     PIC 99.                ERCACCT
   537     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   538                                                                  ERCACCT
   539     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   540     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   541                                                                  ERCACCT
   542     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   543         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   544         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   545         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   546         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   547                                                                  ERCACCT
   548     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   549         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   550         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   551                                                                  ERCACCT
   552     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   553                                                                  ERCACCT
   554     12  AM-OVER-SHORT.                                           ERCACCT
   555         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   556         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   557                                                                  ERCACCT
   558     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   559     12  AM-DCC-CLP-STATE                  PIC XX.
   560                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* ECS043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   561     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   562     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   563                                                                  ERCACCT
   564     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   565     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   566     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   567     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   568     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   569     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   570     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   571     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   572     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   573     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   574     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   575     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   576     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   577     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   578     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   579     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   580                                                                  ERCACCT
   581     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   582                                                                  ERCACCT
   583     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   584     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   585                                                                  ERCACCT
   586     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   587     12  AM-EARN-METHODS.                                         ERCACCT
   588         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   589             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   590             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   591             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   592             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   593         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   594             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   595             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   596             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   597             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   598         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   599             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   600             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   601             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   602             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   603             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   604             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   605                                                                  ERCACCT
   606     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   607     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   608     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   609                                                                  ERCACCT
   610     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   611     12  AM-RET-P-E                        PIC X.                 ERCACCT
   612     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   613     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   614     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   615     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   616         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   617         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   618     12  AM-RETRO-EARNINGS.                                       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* ECS043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   619         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   620         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   621         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   622     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   623         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   624         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   625     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   626         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   627         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   628         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   629     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   630     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   631                                                                  ERCACCT
   632     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   633         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   634         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   635         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   636         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   637         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   638                                                                  ERCACCT
   639     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   640                                                                  ERCACCT
   641     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   642                                                                  ERCACCT
   643     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   644         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   645                                                                  ERCACCT
   646     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   647         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   648         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   649                                                                  ERCACCT
   650     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   651         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   652                                                                  ERCACCT
   653     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   654         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   655         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   656                                                                  ERCACCT
   657     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   658                                                                  ERCACCT
   659     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   660     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   661     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   662     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   663     12  AM-DCC-UEF-STATE                  PIC XX.
   664     12  FILLER                            PIC XXX.
   665     12  AM-REPORT-CODE-3                  PIC X(10).
   666*    12  FILLER                            PIC X(22).             ERCACCT
   667                                                                  ERCACCT
   668     12  AM-RESERVE-DATE.                                         ERCACCT
   669         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   670         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   671         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   672                                                                  ERCACCT
   673     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   674     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   675         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   676         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* ECS043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   677         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   678         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   679                                                                  ERCACCT
   680     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   681         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   682         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   683         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   684         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   685                                                                  ERCACCT
   686     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   687         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   688             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   689             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   690             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   691             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   692             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   693             20  FILLER                    PIC XX.                ERCACCT
   694         16  FILLER                        PIC X(80).             ERCACCT
   695                                                                  ERCACCT
   696     12  AM-TRANSFER-DATA.                                        ERCACCT
   697         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   698             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   699             20  AM-TRNFROM-GROUPING.                             ERCACCT
   700                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   701                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   702             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   703             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   704                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   705                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   706             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   707         16  AM-TRANSFERRED-TO.                                   ERCACCT
   708             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   709             20  AM-TRNTO-GROUPING.                               ERCACCT
   710                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   711                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   712             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   713             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   714                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   715                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   716             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   717         16  FILLER                        PIC X(10).             ERCACCT
   718                                                                  ERCACCT
   719     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   720                                                                  ERCACCT
   721     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   722         16  AM-DEFN-1-SAVED.                                     ERCACCT
   723             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   724                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   725                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   726                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   727                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   728                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   729                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   730                 24  FILLER                PIC X.                 ERCACCT
   731                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   732                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   733                 24  FILLER                PIC X.                 ERCACCT
   734         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* ECS043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   735             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   736                 24  FILLER                PIC X(11).             ERCACCT
   737                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   738                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   739                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   740                 24  FILLER                PIC X(6).              ERCACCT
   741                                                                  ERCACCT
   742     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   743         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   744            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   745            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   746            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   747                                                                  ERCACCT
   748     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   749     12  FILLER                            PIC X(120).            ERCACCT
   750                                                                  ERCACCT
   751     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   752         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   753         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   754             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   755             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   756                                                          COMP-3. ERCACCT
   757             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   758                                                          COMP-3. ERCACCT
   759         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   760             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   761             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   762                                                          COMP-3. ERCACCT
   763             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   764                                                          COMP-3. ERCACCT
   765                                                                  ERCACCT
   766     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   767         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   768         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   769         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   770         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   771             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   772                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   773                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   774             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   775                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   776                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   777             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   778                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   779                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   780         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   781             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   782                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   783                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   784                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   785             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   786                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   787                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   788             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   789                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   790                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   791                                                                  ERCACCT
   792     12  AM-COMMENTS.                                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* ECS043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   793         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   794                                                                  ERCACCT
   795     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   796         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   797         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   798         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   799         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   800         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   801             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   802             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   803             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   804             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   805         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   806             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   807             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   808             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   809         16  FILLER                        PIC X(102).            ERCACCT
   810                                                                  ERCACCT
   811     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   812         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   813             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   814             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   815             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   816             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   817             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   818         16  FILLER                          PIC X(10).           ERCACCT
   819******************************************************************ERCACCT
   820
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* ECS043.cbl
   822 FD  ERPLAN-IN.
*  823                             COPY ERCPLAN.
   824******************************************************************04/29/98
   825*                                                                *ERCPLAN
   826*                                                                *ERCPLAN
   827*                            ERCPLAN                             *   LV003
   828*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   829*                            VMOD=2.003                          *   CL**2
   830*                                                                *ERCPLAN
   831*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
   832*                                                                *ERCPLAN
   833*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
   834*   PLAN MASTER                                                  *ERCPLAN
   835*                                                                *ERCPLAN
   836*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
   837*                                                                *ERCPLAN
   838*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
   839*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
   840*                                                                *ERCPLAN
   841*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
   842*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
   843*                                                                *ERCPLAN
   844*   LOG = NO                                                     *ERCPLAN
   845*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
   846*                                                                *ERCPLAN
   847*                                                                *ERCPLAN
   848******************************************************************ERCPLAN
   849                                                                  ERCPLAN
   850 01  PLAN-MASTER.                                                 ERCPLAN
   851     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
   852         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
   853                                                                  ERCPLAN
   854     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
   855         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
   856         16  PL-MSTR-CNTRL.                                       ERCPLAN
   857             20  PL-CONTROL-A.                                    ERCPLAN
   858                 24  PL-CARRIER            PIC X.                 ERCPLAN
   859                 24  PL-GROUPING           PIC X(6).              ERCPLAN
   860                 24  PL-STATE              PIC XX.                ERCPLAN
   861                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
   862             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
   863             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
   864             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
   865                                                                  ERCPLAN
   866     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
   867         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
   868         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
   869         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
   870         16  PL-VG-STATE                   PIC XX.                ERCPLAN
   871         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
   872         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
   873         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
   874         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
   875                                                                  ERCPLAN
   876     12  PL-MAINT-INFORMATION.                                    ERCPLAN
   877         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
   878         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
   879         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* ECS043.cbl (/apps/prod/cid1p/copy/ERCPLAN)
   880         16  FILLER                        PIC XX.                ERCPLAN
   881                                                                  ERCPLAN
   882     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
   883         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
   884         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
   885             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
   886             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
   887             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
   888             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
   889                                                                  ERCPLAN
   890     12  FILLER                            PIC X(30).             ERCPLAN
   891                                                                  ERCPLAN
   892     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
   893         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
   894         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
   895         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
   896     12  FILLER                            PIC X(24).             ERCPLAN
   897     12  PL-TOLERANCES.                                           ERCPLAN
   898         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
   899         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
   900         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
   901         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
   902         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
   903         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
   904     12  PL-OVER-SHORT.                                           ERCPLAN
   905         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
   906         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
   907     12  FILLER                            PIC X(24).             ERCPLAN
   908     12  PLAN-MISC.                                               ERCPLAN
   909         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
   910         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
   911         16  PL-IG                         PIC X.                 ERCPLAN
   912         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
   913         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
   914         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
   915         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
   916         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
   917         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
   918         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
   919         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
   920                                                                  ERCPLAN
   921         16  FILLER                        PIC X(99).             ERCPLAN
   922******************************************************************ERCPLAN
   923
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* ECS043.cbl
   925 FD  DISK-DATE
*  926                             COPY ELCDTEFD.
   927******************************************************************04/15/98
   928*                                                                *ELCDTEFD
   929*                                                                *ELCDTEFD
   930*                            ELCDTEFD.                           *   LV002
   931*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   932*                            VMOD=2.007                          *   CL**2
   933*                                                                *ELCDTEFD
   934******************************************************************ELCDTEFD
   935     BLOCK CONTAINS 0 RECORDS
   936     RECORDING MODE F.                                            ELCDTEFD
   937                                                                  ELCDTEFD
   938 01  DATE-DISK.                                                   ELCDTEFD
   939     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   940     12  FILLER                      PIC  X(14).                  ELCDTEFD
   941     12  DD-CR1                      PIC  9.                      ELCDTEFD
   942     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   943     12  DD-CR2                      PIC  9.                      ELCDTEFD
   944     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   945     12  FILLER                      PIC  X(20).                  ELCDTEFD
   946                                                                  ELCDTEFD
   947 01  DATE-DISK-R.                                                 ELCDTEFD
   948     12  FILLER                      PIC  X(4).                   ELCDTEFD
   949     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   950                                     PIC  X(32).                  ELCDTEFD
   951                                                                  ELCDTEFD
   952 01  DATE-DISK-T.                                                 ELCDTEFD
   953     12  FILLER                      PIC  X(4).                   ELCDTEFD
   954     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   955                                     PIC  X(48).                  ELCDTEFD
   956                                                                  ELCDTEFD
   957 01  DATE-DISK-M.                                                 ELCDTEFD
   958     12  FILLER                      PIC  X(4).                   ELCDTEFD
   959     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   960                                     PIC  X(48).                  ELCDTEFD
   961                                                                  ELCDTEFD
   962 01  DATE-DISK-P.                                                 ELCDTEFD
   963     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   964     12  DD-IDX                      PIC  99.                     ELCDTEFD
   965     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   966     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   967         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   968                                     PIC  X.                      ELCDTEFD
   969         16  FILLER                  PIC  X(46).                  ELCDTEFD
   970     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   971         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   972             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   973             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   974             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   975             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   976         16  FILLER                  PIC  X(16).                  ELCDTEFD
   977                                                                  ELCDTEFD
   978 01  DATE-DISK-E.                                                 ELCDTEFD
   979     12  FILLER                      PIC  X(4).                   ELCDTEFD
   980     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   981                                     PIC  X(4).                   ELCDTEFD
   982                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* ECS043.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   983 01  DATE-DISK-C.                                                 ELCDTEFD
   984     12  FILLER                      PIC  X(7).                   ELCDTEFD
   985     12  DD-CARR1-SECPAY-SW          PIC  X.
   986     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   987     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   988     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   989     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   990     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   991     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   992     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   993     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   994     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   995     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   996     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   997     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   998     12  DD-CARR2-SECPAY-SW          PIC  X.
   999     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1000                                                                  ELCDTEFD
  1001 01  DATE-DISK-OPT.                                               ELCDTEFD
  1002     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1003     12  DD-TLR-DATA.                                             ELCDTEFD
  1004         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1005                                     PIC  X(03).                  ELCDTEFD
  1006     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1007         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1008                                     PIC  X(06).                  ELCDTEFD
  1009     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1010         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1011                                     PIC  X(07).                  ELCDTEFD
  1012         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1013     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1014                                     PIC  X(96).                  ELCDTEFD
  1015******************************************************************ELCDTEFD
  1016
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* ECS043.cbl
  1018 FD  FICH
* 1019                             COPY ELCFCHFD.
  1020******************************************************************04/15/98
  1021*                                                                *ELCFCHFD
  1022*                            ELCFCHFD.                           *   LV003
  1023*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1024*                            VMOD=2.004                          *   CL**3
  1025*                                                                *ELCFCHFD
  1026******************************************************************ELCFCHFD
  1027     BLOCK CONTAINS 0 RECORDS
  1028     RECORDING MODE F.                                            ELCFCHFD
  1029                                                                  ELCFCHFD
  1030 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  1031******************************************************************ELCFCHFD
  1032
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* ECS043.cbl
  1034 WORKING-STORAGE SECTION.
  1035
  1036 77  FILLER  PIC X(32) VALUE '********************************'.
  1037 77  FILLER  PIC X(32) VALUE '     ECS043 WORKING STORAGE     '.
  1038 77  FILLER  PIC X(32) VALUE '***********VMOD=2.020 **********'.
  1039
  1040 77  NO-OF-RECORDS-RELEASED  PIC S9(9)      COMP-3  VALUE +0.
  1041 77  NDX                     PIC S999            COMP.
  1042 77  SA                      PIC S999            COMP.
  1043 77  SB                      PIC S999            COMP.
  1044 77  SC                      PIC S999            COMP.
  1045 77  SE                      PIC S999            COMP.
  1046 77  SF                      PIC S999            COMP.
  1047 77  SG                      PIC S999            COMP.
  1048 77  SH                      PIC S999            COMP.
  1049 77  CL                      PIC S999            COMP.
  1050 77  AL                      PIC S999            COMP.
  1051 77  AN                      PIC S999            COMP.
  1052 77  WS-SEQ-NBR              PIC S9              COMP   VALUE +0.
  1053 77  PAGE-CNT                PIC S9(5)           COMP-3 VALUE +0.
  1054 77  LINE-CNT                PIC S999            COMP-3 VALUE +99.
  1055 77  PGM-SUB                 PIC S999            COMP-3 VALUE +43.
  1056 77  X                       PIC X.
  1057 77  BREAK-1-SWITCH          PIC X       VALUE SPACES.
  1058 77  WS-EP-CODE              PIC X.
  1059 77  WS-OB-CODE              PIC X.
  1060 77  SAVE-DA-UP              PIC S9(9)V99.
  1061 77  SAVE-DA-UC              PIC S9(9)V99.
  1062 77  SAVE-DA-GA-UC           PIC S9(9)V99.
  1063 77  SAVE-DA-PCT-E-PREM      PIC S9(9)V99.
  1064 77  SAVE-DA-PCT-UP          PIC S9(9)V99.
  1065 77  SAVE-BEG-DATE           PIC 9(11)     VALUE ZERO.
  1066 77  WS-RETRO-FLAG           PIC X.
  1067
  1068 01  SPACE-LINE                PIC X(132)  VALUE SPACES.
  1069
  1070 01  WS-ABEND-STORAGE.
  1071     12  WS-RETURN-CODE        PIC S9(4)   VALUE ZERO COMP.
  1072     12  WS-ABEND-MESSAGE      PIC X(80)   VALUE SPACES.
  1073     12  WS-ABEND-FILE-STATUS  PIC XX      VALUE ZERO.
  1074     12  WS-ZERO               PIC S9      VALUE ZERO COMP-3.
  1075
  1076     12  WS-ABEND-CODE         PIC 9(4).
  1077     12  WORK-ABEND-CODE       REDEFINES     WS-ABEND-CODE.
  1078         16  W-ABEND-CODE-1    PIC XX.
  1079         16  W-ABEND-CODE-2    PIC XX.
  1080     12  ERACCTT-FILE-STATUS   PIC XX.
  1081     12  ERPLAN-FILE-STATUS    PIC XX.
  1082
  1083 01  WORK-MSG.
  1084     05  FILLER              PIC X    VALUE SPACE.
  1085     05  W-MM                PIC XX.
  1086     05  FILLER              PIC X    VALUE '/'.
  1087     05  W-DD                PIC XX.
  1088     05  FILLER              PIC X    VALUE '/'.
  1089     05  W-CCYY              PIC X(4).
  1090     05  FILLER        PIC X(9)  VALUE ' TO DATE '.
  1091
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* ECS043.cbl
  1092 01  FORMAT-CONTROL-CARD.
  1093     05  FC-ID               PIC XX.
  1094     05  FC-CLIENT           PIC XXX.
  1095     05  FC-CODE             PIC X.
  1096     05  FC-DATE             PIC 9(8).
  1097     05  FC-DATE-R  REDEFINES  FC-DATE.
  1098         10  FC-CCYY         PIC 9(04).
  1099         10  FC-CCYR REDEFINES FC-CCYY.
  1100             15  FC-CC       PIC 99.
  1101             15  FC-YY       PIC 99.
  1102         10  FC-MM           PIC 99.
  1103         10  FC-DD           PIC 99.
  1104     05  FILLER              PIC X(66).
  1105
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* ECS043.cbl
  1107 01  SW-REC.
  1108     12  SW-RPT-TYPE-ID      PIC X.
  1109         88  ACCOUNT-RPT        VALUE 'A'.
  1110         88  RETRO-GROUP-RPT    VALUE 'B'.
  1111         88  GA-ACCOUNT-RPT     VALUE 'C'.
  1112     12  SW-CTL.
  1113         16  SW-GA           PIC X(10).
  1114         16  SW-CARR         PIC X.
  1115         16  SW-COMP         PIC XXXXXX.
  1116         16  SW-STATE        PIC XX.
  1117         16  SW-ACCT         PIC X(10).
  1118         16  SW-EXP-DT       PIC 9(11)  COMP-3.
  1119     12  SW-EFF-DT           PIC 9(11)  COMP-3.
  1120     12  SW-NAME             PIC X(30).
  1121     12  SW-ADDRS            PIC X(20).
  1122     12  SW-CITY             PIC X(20).
  1123     12  SW-ZIP.
  1124         16  SW-ZIP-PRIME.
  1125             20  FILLER      PIC X(01).
  1126                 88  SW-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1127             20  FILLER      PIC X(04).
  1128         16  SW-ZIP-PLUS4    PIC X(04).
  1129     12  SW-CANADIAN-POSTAL-CODES REDEFINES SW-ZIP.
  1130         16  SW-CAN-POST-CODE-1
  1131                             PIC X(03).
  1132         16  SW-CAN-POST-CODE-2
  1133                             PIC X(03).
  1134         16  FILLER          PIC X(03).
  1135     12  SW-LRET             PIC S9V9(4)     COMP-3.
  1136     12  SW-ARET             PIC S9V9(4)     COMP-3.
  1137     12  SW-RET-Y-N          PIC X.
  1138     12  SW-RET-TYP          PIC X.
  1139     12  SW-GA-FLAG          PIC X.
  1140     12  SW-ACCUMS           PIC X(972).
  1141     12  SW-BEG-DATE         PIC 9(11)       COMP-3.
  1142     12  SW-RETRO-LIMIT      PIC S9(7)       COMP-3.
  1143     12  SW-PREM-P-E         PIC X.
  1144     12  SW-CLMS-P-I         PIC X.
  1145     12  FILLER              PIC X(12).
  1146
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* ECS043.cbl
  1148 01  WS-ACCT-CONTROL.
  1149     12  WS-MSTR-CNTRL       PIC X(25)   VALUE LOW-VALUES.
  1150     12  WS-EFFECT           PIC 9(11)  COMP-3  VALUE ZEROS.
  1151
  1152 01  WS-SAVE-CONTROL.
  1153     12  WS-SAVE-CARR        PIC X.
  1154     12  WS-SAVE-COMP        PIC XXXXXX.
  1155     12  WS-SAVE-STATE       PIC XX.
  1156     12  WS-SAVE-ACCT        PIC X(10).
  1157     12  WS-SAVE-EXP-DATE    PIC 9(11)  COMP-3.
  1158     12  WS-SAVE-EFF-DATE    PIC 9(11)  COMP-3.
  1159
  1160 01  WS-SAVE-CTL.
  1161     12  WS-SAVE-GA          PIC X(10).
  1162     12  WS-SAVE-CAR         PIC X.
  1163     12  WS-SAVE-CMP         PIC XXXXXX.
  1164     12  WS-SAVE-ST          PIC XX.
  1165     12  WS-SAVE-ACC         PIC X(10).
  1166     12  WS-SAVE-EXP         PIC 9(11)  COMP-3.
  1167
  1168 01  WS-PLAN-CONTROL.
  1169     12  WS-PL-COMPANY-CD    PIC X          VALUE SPACE.
  1170     12  WS-PL-CONTROL-A.
  1171         16  WS-PL-CARRIER       PIC X      VALUE SPACE.
  1172         16  WS-PL-GROUPING      PIC X(6)   VALUE SPACES.
  1173         16  WS-PL-STATE         PIC XX     VALUE SPACES.
  1174         16  WS-PL-ACCOUNT       PIC X(10)  VALUE SPACES.
  1175     12  WS-PL-BENEFIT-TYPE  PIC X          VALUE SPACE.
  1176     12  WS-PL-BENEFIT-CODE  PIC XX         VALUE SPACE.
  1177     12  WS-PL-REVISION-NO   PIC X(3)       VALUE SPACES.
  1178
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* ECS043.cbl
  1180 01  MISC.
  1181     12  RETENT-FACT         PIC S9V9(5)   VALUE +0.
  1182     12  ERP-PERCENT         PIC S9V9(5)   VALUE +0.
  1183     12  EXP-FACTOR          PIC S9V9(5)   VALUE +0.
  1184     12  LIFE-RETENT         PIC S9V9(5)     COMP-3  VALUE +0.
  1185     12  AH-RETENT           PIC S9V9(5)     COMP-3  VALUE +0.
  1186     12  SAVE-RETRO-LIMIT    PIC S9(7)       COMP-3.
  1187     12  ANNUALIZED-PREM     PIC S9(9)V99    COMP-3.
  1188     12  WS-MIN-LOSS         PIC S9(5)V99    COMP-3.
  1189     12  HEAD-SW             PIC X         VALUE SPACE.
  1190     12  NBR-OF-MTHS         PIC 99        VALUE 12.
  1191     12  SAVE-GA-FLAG        PIC X.
  1192     12  SAVE-RET-Y-N        PIC X.
  1193     12  SAVE-RET-TYP        PIC X.
  1194     12  SAVE-PREM-P-E       PIC X.
  1195     12  SAVE-CLMS-P-I       PIC X.
  1196     12  WS-EXCLUSION-SWITCH PIC X             VALUE SPACE.
  1197         88  EXCLUDING-BENEFIT  VALUE '*'.
  1198
  1199 01  BEG-DATE                PIC 9(11).
  1200 01  BEG-DATE-R REDEFINES BEG-DATE.
  1201     12 FILLER               PIC 999.
  1202     12  BD-CCYY             PIC 9(04).
  1203     12  BD-CCYR REDEFINES BD-CCYY.
  1204         16  BD-CC           PIC 99.
  1205         16  BD-YR           PIC 99.
  1206     12  BD-MO               PIC 99.
  1207     12  BD-DA               PIC 99.
  1208
  1209 01  RUN-DT                  PIC 9(11).
  1210 01  RUN-DT-R REDEFINES RUN-DT.
  1211     12  FILLER              PIC 999.
  1212     12  RD-CCYY             PIC 9(04).
  1213     12  RD-CCYR REDEFINES RD-CCYY.
  1214         16  RD-CC           PIC 99.
  1215         16  RD-YR           PIC 99.
  1216     12  RD-MO               PIC 99.
  1217     12  RD-DA               PIC 99.
  1218
  1219 01  WORK-DATE           PIC 9(11).
  1220 01  WORK-DATE-R  REDEFINES  WORK-DATE.
  1221     12  FILLER          PIC 999.
  1222     12  WK-CCYY         PIC 9(04).
  1223     12  WK-CCYR REDEFINES WK-CCYY.
  1224         16  WK-CC       PIC 99.
  1225         16  WK-YR       PIC 99.
  1226     12  WK-MO           PIC 99.
  1227     12  WK-DA           PIC 99.
  1228
  1229 01  ZONE-GROUP.
  1230     03  ZON                 PIC XXX       VALUE 'ZON'.
  1231     03  Z-G                 PIC XXX.
  1232
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* ECS043.cbl
  1234*
  1235* THE DETAIL AND AGENTS ACCUMULATORS ARE USED AS FOLLOWS
  1236*
  1237*    OCCURRENCE 1 = LIFE BEGINNING DATA
  1238*    OCCURRENCE 2 = A&H BEGINNING DATA
  1239*    OCCURRENCE 3 = LIFE CURRENT DATA
  1240*    OCCURRENCE 4 = A&H CURRENT DATA
  1241*
  1242 01  DETAIL-ACCUMULATORS     COMP-3.
  1243     12  DETAIL-ACCUMS   OCCURS 4 TIMES.
  1244         16  DA-ISP          PIC S9(9)V99.
  1245         16  DA-TAX          PIC S9(9)V99.
  1246         16  DA-CNP          PIC S9(9)V99.
  1247         16  DA-UP           PIC S9(9)V99.
  1248         16  DA-CLM          PIC S9(9)V99.
  1249         16  DA-EXP          PIC S9(9)V99.
  1250         16  DA-CPS          PIC S9(9)V99.
  1251         16  DA-OTC          PIC S9(9)V99.
  1252         16  DA-LRV          PIC S9(9)V99.
  1253         16  DA-CAJ          PIC S9(9)V99.
  1254         16  DA-ISC          PIC S9(9)V99.
  1255         16  DA-CNC          PIC S9(9)V99.
  1256         16  DA-UC           PIC S9(9)V99.
  1257         16  DA-ISC-ADDL     PIC S9(9)V99.
  1258         16  DA-CNC-ADDL     PIC S9(9)V99.
  1259         16  DA-UC-ADDL      PIC S9(9)V99.
  1260         16  DA-GA-ISC       PIC S9(9)V99.
  1261         16  DA-GA-CNC       PIC S9(9)V99.
  1262         16  DA-GA-UC        PIC S9(9)V99.
  1263         16  DA-PCT-E-PREM   PIC S9(9)V99.
  1264
  1265 01  TEMP-GA-ACCUMS.
  1266     12  GA-LEVELS.
  1267         16  GA-LEVELS OCCURS 10 TIMES.
  1268             20  XDA-GA-NO       PIC X(10).
  1269             20  XDA-GA-TYPE     PIC X.
  1270             20  ACCUM-LEVELS OCCURS 4 TIMES.
  1271                 24  XDA-GA-ISC      PIC S9(9)V99    COMP-3.
  1272                 24  XDA-GA-CNC      PIC S9(9)V99    COMP-3.
  1273                 24  XDA-GA-UC       PIC S9(9)V99    COMP-3.
  1274
  1275 01  EC-REC-MAX                  PIC S99 COMP-3 VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* ECS043.cbl
  1277*
  1278* THE PRINT ACCUMULATORS ARE USED AS FOLLOWS
  1279*
  1280*    A SET CONSISTS OF 6 ACCUMULATORS
  1281*
  1282*        OCCURRENCE 1 = LIFE TOTAL PERIOD
  1283*        OCCURRENCE 2 = A&H TOTAL FOR PERIOD
  1284*        OCCURRENCE 3 = COMBINED TOTAL FOR PERIOD
  1285*        OCCURRENCE 4 = LIFE TOTAL FOR INCEPTION-TO-DATE
  1286*        OCCURRENCE 5 = A&H TOTAL FOR INCEPTION-TO-DATE
  1287*        OCCURRENCE 6 = COMBINED TOTAL FOR INCEPTION-TO-DATE
  1288*
  1289*    THERE ARE 6 SETS
  1290*
  1291*        SET 1 = LEVEL 1 (DATE RANGE TOTALS)
  1292*        SET 2 = LEVEL 2 (ACCOUNT TOTALS)
  1293*        SET 3 = LEVEL 3 (STATE TOTALS)
  1294*        SET 4 = LEVEL 4 (COMPANY TOTALS)
  1295*        SET 5 = LEVEL 5 (CARRIER TOTALS)
  1296*        SET 6 = LEVEL 6 (FINAL TOTALS)
  1297*
  1298 01  PRINT-ACCUMULATORS      COMP-3.
  1299     12  PRINT-ACCUMS    OCCURS 36.
  1300         16  PA-NW           PIC S9(9)V99.
  1301         16  PA-BR           PIC S9(9)V99.
  1302         16  PA-ER           PIC S9(9)V99.
  1303         16  PA-EP           PIC S9(9)V99.
  1304         16  PA-PE           PIC S9(9)V99.
  1305         16  PA-PL           PIC S9(9)V99.
  1306         16  PA-BLR          PIC S9(9)V99.
  1307         16  PA-ELR          PIC S9(9)V99.
  1308         16  PA-TL           PIC S9(9)V99.
  1309         16  PA-RC           PIC S9(9)V99.
  1310         16  PA-OC           PIC S9(9)V99.
  1311         16  PA-TC           PIC S9(9)V99.
  1312         16  PA-CP           PIC S9(9)V99.
  1313         16  PA-EX           PIC S9(9)V99.
  1314         16  PA-TE           PIC S9(9)V99.
  1315         16  PA-BA           PIC S9(9)V99.
  1316         16  PA-NTE          PIC S9(9)V99.
  1317         16  PA-NBA          PIC S9(9)V99.
  1318         16  PA-EC           PIC S9(9)V99.
  1319         16  PA-GARC         PIC S9(9)V99.
  1320         16  PA-GAEC         PIC S9(9)V99.
  1321         16  PA-GACU         PIC S9(9)V99.
  1322         16  PA-CU           PIC S9(9)V99.
  1323         16  PA-GATC         PIC S9(9)V99.
  1324         16  PA-GAGT         PIC S9(9)V99.
  1325         16  PA-GABA         PIC S9(9)V99.
  1326         16  PA-GATE         PIC S9(9)V99.
  1327 01  PRINT-ACCUMULATORS-R    REDEFINES PRINT-ACCUMULATORS  COMP-3.
  1328     12  PRINT-ACCUMS-R  OCCURS 6.
  1329         16  PRINT-ACCUMS-SL OCCURS 6.
  1330             20  PRINT-ACCUMS-L OCCURS 27.
  1331                 24  PA-AMT  PIC S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* ECS043.cbl
  1333
  1334*
  1335* THE FOLLOWING ACCUMULATORS ARE FOR THE PERCENTS
  1336*    TO BE PRINTED ON THE RETRO
  1337*
  1338 01  PERCENT-ACCUMULATORS    COMP-3.
  1339     12  PER-ACCUMS      OCCURS 2.
  1340       14  PER-ACCUMS-X   OCCURS 27.
  1341         16  PT-PRCNT        PIC S9(4)V9(4).
  1342
  1343 01  DESC-TABLE.
  1344     12  FILLER              PIC X(33)   VALUE
  1345             '1. NET WRITTEN PREMIUM      00101'.
  1346     12  FILLER              PIC X(33)   VALUE
  1347             '2. PLUS BEGINNING RESERVE   00202'.
  1348     12  FILLER              PIC X(33)   VALUE
  1349             '3. LESS ENDING RESERVE      00303'.
  1350     12  FILLER              PIC X(33)   VALUE
  1351             '4. EARNED PREMIUM           00404'.
  1352     12  FILLER              PIC X(33)   VALUE
  1353             '5. PERCENT OF EARNED PREMIUM00505'.
  1354     12  FILLER              PIC X(33)   VALUE
  1355             '6. EXPENSES                 -0000'.
  1356     12  FILLER              PIC X(33)   VALUE
  1357             ' A. LOSSES                  00000'.
  1358     12  FILLER              PIC X(33)   VALUE
  1359             '  1. PAID                    0606'.
  1360     12  FILLER              PIC X(33)   VALUE
  1361             '  2. LESS BEG. LOSS RESERVE  0707'.
  1362     12  FILLER              PIC X(33)   VALUE
  1363             '  3. PLUS END. LOSS RESERVE  0808'.
  1364     12  FILLER              PIC X(33)   VALUE
  1365             '  4. TOTAL                   0909'.
  1366     12  FILLER              PIC X(33)   VALUE
  1367             ' B. COMMISSIONS             00000'.
  1368     12  FILLER              PIC X(33)   VALUE
  1369             '  1. RETAINED                2323'.
  1370     12  FILLER              PIC X(33)   VALUE
  1371             '  2. OTHER COMMISSION PAID   1111'.
  1372     12  FILLER              PIC X(33)   VALUE
  1373             '  3. OVERWRITE                 22'.
  1374     12  FILLER              PIC X(33)   VALUE
  1375             '  3. TOTAL                   12  '.
  1376     12  FILLER              PIC X(33)   VALUE
  1377             '  4. TOTAL                     24'.
  1378     12  WS-EX-LINE          PIC X(33)   VALUE
  1379             ' C. OTHER EXPENSE           01414'.
  1380     12  FILLER              PIC X(33)   VALUE
  1381             '7. TOTAL EXPENSE            01727'.
  1382     12  WS-BAL-LINE-1       PIC X(33)   VALUE
  1383             '8. BALANCE AT END OF PERIOD 01826'.
  1384     12  WS-BAL-LINE-2       PIC X(33)   VALUE
  1385             '   (LINE 5 MINUS LINE 7)     0000'.
  1386     12  FILLER              PIC X(33)   VALUE
  1387             '9. ACCOUNT BALANCES         0  18'.
  1388     12  FILLER              PIC X(33)   VALUE
  1389             '9. EXPERIENCE REFUND PRV PD 013  '.
  1390     12  FILLER              PIC X(33)   VALUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* ECS043.cbl
  1391             '10. EXPERIENCE REFUND PRV PD0  13'.
  1392     12  FILLER              PIC X(33)   VALUE
  1393             '10. NET BALANCE OR LOSS     -16  '.
  1394     12  FILLER              PIC X(33)   VALUE
  1395             '11. NET BALANCE OR LOSS     -  25'.
  1396     12  FILLER              PIC X(33)   VALUE HIGH-VALUES.
  1397 01  DESC-TABLE-R    REDEFINES DESC-TABLE.
  1398     12  DT-TB-ENT   OCCURS 27.
  1399         16  DT-ENTRY    PIC X(28).
  1400         16  DT-CTL-CHAR PIC X.
  1401         16  DT-SUBSCR   OCCURS 2.
  1402             20  DT-SS-R.
  1403                 24  DT-SS   PIC 99.
  1404
  1405 01  DESC-TABLE-DESCRIPTIONS.
  1406     12  EXPENSE-LINE        PIC X(33)   VALUE
  1407             ' C. TAXES AND OTHER EXPENSES01414'.
  1408     12  BALANCE-LINE-1      PIC X(33)   VALUE
  1409             '8. BALANCE AT END OF PERIOD 01826'.
  1410     12  BALANCE-LINE-2      PIC X(33)   VALUE
  1411             '   (LINE 5 MINUS LINE 7)     0000'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* ECS043.cbl
  1413
  1414 01  HEAD-1.
  1415     12  H1-NAME         PIC X(30)   VALUE SPACES.
  1416     12  FILLER          PIC X(21)   VALUE SPACES.
  1417     12  FILLER          PIC X(20)   VALUE 'CREDIT INSURANCE EAR'.
  1418     12  FILLER          PIC X(10)   VALUE 'NED REVIEW'.
  1419     12  FILLER          PIC X(38)   VALUE SPACES.
  1420     12  FILLER          PIC X(6)    VALUE 'ECS043'.
  1421     12  H1-REPORT-SUF   PIC X       VALUE SPACES.
  1422
  1423 01  HEAD-2.
  1424     12  H2-ADDR         PIC X(30)   VALUE SPACES.
  1425     12  FILLER          PIC X(21)   VALUE SPACES.
  1426     12  HD-COMP         PIC X(30)   VALUE SPACES.
  1427     12  FILLER          PIC X(38)   VALUE SPACES.
  1428     12  HD-RD           PIC X(8)    VALUE SPACES.
  1429
  1430 01  HEAD-3.
  1431     12  H3-ADDR         PIC X(20)   VALUE SPACES.
  1432     12  FILLER          PIC X       VALUE SPACES.
  1433     12  H3-ZIP.
  1434         16  H3-ZIP-PRIME
  1435                         PIC X(5).
  1436         16  H3-DASH     PIC X.
  1437         16  H3-ZIP-PLUS4
  1438                         PIC X(4).
  1439     12  H3-CANADIAN-POSTAL-CODE REDEFINES H3-ZIP.
  1440         16  H3-CAN-POSTAL-CODE-1
  1441                         PIC X(3).
  1442         16  H3-DASH-CAN PIC X.
  1443         16  H3-CAN-POSTAL-CODE-2
  1444                         PIC X(3).
  1445         16  H3-CAN-FILLER
  1446                         PIC X(3).
  1447     12  FILLER          PIC X(26)   VALUE SPACES.
  1448     12  HD-AD           PIC X(18)   VALUE SPACES.
  1449     12  FILLER          PIC X(44)   VALUE SPACES.
  1450     12  FILLER          PIC X(05)   VALUE
  1451         'PAGE '.
  1452     12  H3-PAGE         PIC ZZZZ9.
  1453
  1454 01  HEAD-4.
  1455     12  FILLER          PIC X(20)   VALUE 'COMP    ST ACCOUNT  '.
  1456     12  H4-FT           PIC X(20)   VALUE '       FROM    TO'.
  1457     12  FILLER          PIC X(5)    VALUE SPACES.
  1458     12  H4-GROUP        PIC X(6)    VALUE SPACES.
  1459
  1460 01  HEAD-5.
  1461     12  H5-CARR         PIC X       VALUE SPACES.
  1462     12  H5-COMP         PIC X(6)    VALUE SPACES.
  1463     12  FILLER          PIC X       VALUE SPACES.
  1464     12  H5-ST           PIC XX      VALUE SPACES.
  1465     12  FILLER          PIC X       VALUE SPACES.
  1466     12  H5-ACCT         PIC X(10)   VALUE SPACES.
  1467     12  FILLER          PIC X       VALUE SPACES.
  1468     12  H5-FMO          PIC XX      VALUE SPACES.
  1469     12  H5-FS1          PIC X       VALUE '-'.
  1470     12  H5-FDA          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* ECS043.cbl
  1471     12  H5-FS2          PIC X       VALUE '-'.
  1472     12  H5-FYR          PIC XX      VALUE SPACES.
  1473     12  FILLER          PIC X       VALUE SPACES.
  1474     12  H5-TMO          PIC XX      VALUE SPACES.
  1475     12  H5-TS1          PIC X       VALUE '-'.
  1476     12  H5-TDA          PIC XX      VALUE SPACES.
  1477     12  H5-TS2          PIC X       VALUE '-'.
  1478     12  H5-TYR          PIC XX      VALUE SPACES.
  1479     12  FILLER          PIC X(4)    VALUE SPACES.
  1480     12  H5-GROUP        PIC X(10)   VALUE SPACES.
  1481     12  H5-MESSAGE      PIC X(40)   VALUE SPACES.
  1482     12  END-CHARACTER   PIC X       VALUE ' '.
  1483
  1484 01  HEAD-6.
  1485     12  FILLER          PIC X(15)   VALUE '***************'.
  1486     12  H6-YTD-HD.
  1487         14  FILLER      PIC X(8)    VALUE '*  LAST '.
  1488         14  H6-MTHS     PIC Z9.
  1489         14  FILLER      PIC X(10)   VALUE ' MONTHS  *'.
  1490     12  H6-YTD-HD-R  REDEFINES H6-YTD-HD.
  1491         16  H6R-FILLER  PIC X.
  1492         16  H6R-MO      PIC XX.
  1493         16  H6R-DASH1   PIC X.
  1494         16  H6R-DA      PIC XX.
  1495         16  H6R-DASH2   PIC X.
  1496         16  H6R-CCYY    PIC X(4).
  1497         16  H6R-MSG     PIC X(9).
  1498     12  FILLER          PIC X(15)   VALUE '***************'.
  1499     12  FILLER          PIC X(29)   VALUE SPACES.
  1500     12  FILLER          PIC X(16)   VALUE '****************'.
  1501     12  FILLER          PIC X(21)  VALUE '  INCEPTION TO DATE  '.
  1502     12  FILLER          PIC X(16)   VALUE '****************'.
  1503
  1504 01  HEAD-7.
  1505     12  HEAD-7-PLUG-1   PIC X(12)   VALUE SPACES.
  1506     12  FILLER          PIC X(1)    VALUE SPACES.
  1507     12  HEAD-7-PLUG-2   PIC X(12)   VALUE SPACES.
  1508     12  FILLER          PIC X(15)   VALUE '         TOTAL '.
  1509     12  FILLER          PIC X(20)   VALUE '   PERCENT          '.
  1510     12  FILLER          PIC X(20)   VALUE '                    '.
  1511     12  HEAD-7-PLUG-3   PIC X(12)   VALUE SPACES.
  1512     12  FILLER          PIC X       VALUE SPACES.
  1513     12  HEAD-7-PLUG-4   PIC X(12)   VALUE SPACES.
  1514     12  FILLER          PIC X(15)   VALUE '           TOTA'.
  1515     12  FILLER          PIC X(12)   VALUE 'L    PERCENT'.
  1516
  1517 01  HEAD-8-STATE.
  1518     12  FILLER          PIC X(8)    VALUE '  STATE '.
  1519     12  H8-ST           PIC XX      VALUE SPACES.
  1520     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1521
  1522 01  HEAD-8-COMP.
  1523     12  FILLER          PIC X(10)   VALUE '  COMPANY '.
  1524     12  H8-COMP         PIC X(6)    VALUE SPACES.
  1525     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1526
  1527 01  HEAD-8-CARR.
  1528     12  FILLER          PIC X(10)   VALUE '  CARRIER '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* ECS043.cbl
  1529     12  H8-CARR         PIC X       VALUE SPACES.
  1530     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1531
  1532 01  HEAD-8-GROUP.
  1533     12  H-8-G           PIC X(8)    VALUE '  GROUP '.
  1534     12  H8-GROUP        PIC X(6)    VALUE SPACES.
  1535     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1536
  1537 01  HEAD-8-GA.
  1538     12  FILLER          PIC X(8)    VALUE '   G.A. '.
  1539     12  H8-GA           PIC X(10)   VALUE SPACES.
  1540     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1541
  1542 01  HEAD-8-FINAL.
  1543     12  FILLER          PIC X(20)   VALUE '  FINAL       TOTALS'.
  1544
  1545*01  HEAD-9.
  1546*    12  FILLER          PIC X(127)  VALUE SPACES.
  1547*    12  H9-PAGE         PIC ZZZZ9.
  1548
  1549 01  DETAIL-LINE.
  1550     12  DL-YLF          PIC ZZ,ZZZ,ZZZ.99-.
  1551     12  DL-YAH          PIC ZZ,ZZZ,ZZZ.99-.
  1552     12  DL-YT           PIC ZZ,ZZZ,ZZZ.99-.
  1553     12  DL-YPT          PIC ZZZZ.99-    BLANK WHEN ZERO.
  1554     12  FILLER          PIC X.
  1555     12  DL-DESC         PIC X(28).
  1556     12  DL-ILF          PIC ZZZ,ZZZ,ZZZ.99-.
  1557     12  DL-IAH          PIC ZZZ,ZZZ,ZZZ.99-.
  1558     12  DL-IT           PIC ZZZ,ZZZ,ZZZ.99-.
  1559     12  DL-IPT          PIC ZZZZ.99-    BLANK WHEN ZERO.
  1560
* 1561                                    COPY ELCDATE.
  1562******************************************************************06/11/98
  1563*                                                                *ELCDATE
  1564*                                                                *ELCDATE
  1565*                            ELCDATE.                            *   LV023
  1566*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1567*                            VMOD=2.003                           ELCDATE
  1568*                                                                *ELCDATE
  1569*                                                                *ELCDATE
  1570*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1571*                 LENGTH = 200                                   *   CL*19
  1572******************************************************************ELCDATE
  1573                                                                  ELCDATE
  1574 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1575     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1576     12  DC-OPTION-CODE                PIC X.                        CL*15
  1577         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1578         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1579         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1580         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1581         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1582         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1583         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1584         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1585         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1586         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* ECS043.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1587         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1588         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1589         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1590         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1591         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1592         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1593         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1594         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1595         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1596         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1597         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1598         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1599         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1600         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1601         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1602         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1603         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1604         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1605         88  THREE-CHARACTER-BIN                                  ELCDATE
  1606                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1607         88  GREGORIAN-TO-BIN                                        CL**2
  1608                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1609         88  BIN-TO-GREGORIAN                                        CL**2
  1610                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1611         88  JULIAN-TO-BINARY                                        CL**2
  1612                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1613     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1614         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1615         88  DATE-CONVERSION-ERROR                                ELCDATE
  1616                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1617         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1618         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1619         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1620         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1621         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1622         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1623         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1624         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1625         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1626         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1627     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1628         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1629     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1630         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1631         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1632         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1633     12  FILLER                        PIC X.                        CL*15
  1634     12  DC-CONVERSION-DATES.                                        CL*15
  1635         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1636         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1637         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1638         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1639                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1640             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1641             20  SLASH1-1              PIC X.                        CL*15
  1642             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1643             20  SLASH1-2              PIC X.                        CL*15
  1644             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  37
* ECS043.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1645         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1646         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1647                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1648             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1649             20  SLASH2-1              PIC X.                        CL*15
  1650             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1651             20  SLASH2-2              PIC X.                        CL*15
  1652             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1653         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1654         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1655                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1656             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1657             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1658             20  DC-YMD-DAY            PIC 99.                       CL*15
  1659         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1660         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1661                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1662             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1663             20  DC-MDY-DAY            PIC 99.                       CL*15
  1664             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1665         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1666             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1667             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1668             20  FILLER                PIC XX.                       CL*15
  1669             20  DC-ALPHA-CENTURY.                                   CL*15
  1670                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1671             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1672         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1673         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1674         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1675         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1676         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1677                                       PIC 9(05).                    CL*20
  1678         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1679             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1680             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1681         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1682         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1683         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1684     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1685         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1686         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1687             20  FILLER                PIC 9(3).                     CL*15
  1688             20  HOLD-CEN-1-CCYY.                                    CL*15
  1689                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1690                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1691             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1692             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1693         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1694             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1695             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1696             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1697                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1698                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1699             20  FILLER                PIC 9(3).                     CL*15
  1700         16  HOLD-CENTURY-1-X.                                       CL*15
  1701             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1702             20  HOLD-CEN-1-X-CCYY.                                  CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  38
* ECS043.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1703                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1704                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1705             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1706             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1707         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1708             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1709             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1710             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1711                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1712                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1713             20  FILLER                PIC XXX.                      CL*23
  1714         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1715         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1716         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1717         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1718             20  DC-JULIAN-1-CCYY.                                   CL*15
  1719                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1720                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1721             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1722         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1723         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1724             20  DC-JULIAN-2-CCYY.                                   CL*15
  1725                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1726                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1727             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1728         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1729             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1730             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1731             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1732             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1733             20  DC-EDITA-CCYY.                                      CL*15
  1734                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1735                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1736         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1737             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1738             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1739             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1740             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1741             20  DC-EDITB-CCYY.                                      CL*15
  1742                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1743                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1744         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1745         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1746                              DC-GREG-DATE-CYMD.                  ELCDATE
  1747             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1748             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1749             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1750             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1751         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1752         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1753                              DC-GREG-DATE-MDCY.                  ELCDATE
  1754             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1755             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1756             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1757             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1758    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1759        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1760    12  DC-EL310-DATE                  PIC X(21).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  39
* ECS043.cbl
  1761    12  FILLER                         PIC X(28).                    CL*26
  1762
* 1763                                    COPY ELCDTECX.
  1764******************************************************************06/05/98
  1765*                                                                *ELCDTECX
  1766*                            ELCDTECX.                           *   LV005
  1767*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1768*                            VMOD=2.015                          *ELCDTECX
  1769*                                                                *ELCDTECX
  1770*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1771*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1772*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1773*                                                                *ELCDTECX
  1774******************************************************************ELCDTECX
  1775******************************************************************
  1776*                   C H A N G E   L O G
  1777*
  1778* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1779*-----------------------------------------------------------------
  1780*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1781* EFFECTIVE    NUMBER
  1782*-----------------------------------------------------------------
  1783* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1784*                                  BENEFIT CODES FROM 300 TO 900
  1785* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1786* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1787******************************************************************
  1788 01  DATE-CARD.                                                   ELCDTECX
  1789     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1790     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1791     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1792     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1793     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1794     12  EP-SW                       PIC  X.                      ELCDTECX
  1795         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1796     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1797         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1798     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1799     12  RUN-CENTURY.                                             ELCDTECX
  1800         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1801     12  FILLER                      PIC  X.                         CL**4
  1802     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1803     12  FILLER                      PIC  XXX.                    ELCDTECX
  1804     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1805                                                                  ELCDTECX
  1806 01  FILLER                          PIC  X(7)                       CL**6
  1807                                          VALUE 'OPTIONS'.        ELCDTECX
  1808 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1809     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1810     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1811     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1812         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1813         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1814     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1815     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1816     12  FILLER                      PIC  X.                      ELCDTECX
  1817     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1818     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  40
* ECS043.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1819     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1820     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1821     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1822     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1823     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1824     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1825     12  FILLER                      PIC  X.                      ELCDTECX
  1826     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1827     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1828     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1829     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1830     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1831     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1832     12  FILLER                      PIC  X.                      ELCDTECX
  1833     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1834     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1835     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1836     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1837     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1838     12  DTE-R78                     PIC  X.                      ELCDTECX
  1839     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1840     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1841     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1842     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1843     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1844     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1845     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1846                                     PIC  X.                      ELCDTECX
  1847         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1848                                                 ' '.             ELCDTECX
  1849         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1850         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1851     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1852         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1853         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1854     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1855     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1856                                     PIC  9.                         CL**4
  1857     12  DTE-SYSTEM.                                              ELCDTECX
  1858         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1859         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1860         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1861         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1862         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1863         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1864         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1865         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1866         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1867         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1868         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1869         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1870         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1871         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1872         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1873         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1874         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1875         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1876         16  DTE-SYS-S               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  41
* ECS043.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1877         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1878         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1879         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1880         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1881         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1882         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1883         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1884     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1885         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1886                                     PIC  X.                      ELCDTECX
  1887     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1888                                                                  ELCDTECX
  1889 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1890     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1891     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1892     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1893*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1894     12  FILLER                      PIC  X.                      ELCDTECX
  1895     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1896     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1897     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1898     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1899     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1900     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1901     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1902                                                                  ELCDTECX
  1903     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1904     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1905     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1906     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1907                                                                  ELCDTECX
  1908     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1909     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1910     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1911     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1912                                                                  ELCDTECX
  1913     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1914     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1915                                                                  ELCDTECX
  1916     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1917     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1918                                                                  ELCDTECX
  1919     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1920                                                                  ELCDTECX
  1921 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1922     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1923     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1924     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1925     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1926     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1927     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1928     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1929                                                                  ELCDTECX
  1930 01  FILLER                          PIC  X(12)                   ELCDTECX
  1931                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1932 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1933     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1934         16  CNT-ID                  PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  42
* ECS043.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1935         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1936                                                                  ELCDTECX
  1937 01  FILLER                          PIC  X(11)                   ELCDTECX
  1938                                          VALUE 'STATE NAMES'.    ELCDTECX
  1939 01  STATE-NAMES.                                                 ELCDTECX
  1940     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1941         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1942         16  STATE-PIC1.                                          ELCDTECX
  1943             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1944             20  FILLER              PIC  XXX.                    ELCDTECX
  1945             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1946             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1947             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1948             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1949                                                                  ELCDTECX
  1950 01  FILLER                          PIC  X(13)                   ELCDTECX
  1951                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1952 01  CARRIER-NAMES.                                               ELCDTECX
  1953     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1954         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1955         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1956         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1957         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1958         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1959         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1960*        16  FILLER                  PIC  X.                      ELCDTECX
  1961         16  CARRIER-SEC-PAY         PIC  X.
  1962             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1963                                                                  ELCDTECX
  1964 01  FILLER                          PIC  X(9)                       CL**6
  1965                                          VALUE 'INS TYPES'.      ELCDTECX
  1966 01  CLAS-INS-TYPES.                                              ELCDTECX
  1967*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1968     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1969         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1970         16  CLAS-I-AB3.                                          ELCDTECX
  1971             20  FILLER              PIC  X.                      ELCDTECX
  1972             20  CLAS-I-AB2.                                      ELCDTECX
  1973                 24  FILLER          PIC  X.                      ELCDTECX
  1974                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1975         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1976             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1977             20  FILLER              PIC  X.                         CL**4
  1978         16  CLAS-I-AB10.                                         ELCDTECX
  1979             20  FILLER              PIC  X(9).                   ELCDTECX
  1980             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1981         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1982         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1983         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1984         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1985             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1986         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1987         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1988         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1989         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1990         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  1991         16  FILLER                  PIC  X(05).
  1992                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  43
* ECS043.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1993 01  FILLER                          PIC  X(16)                   ELCDTECX
  1994                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1995 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1996     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1997                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1998         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1999         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  2000         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  2001         16  CLAS-MORT-DESC.                                      ELCDTECX
  2002             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  2003             20  FILLER              PIC  XX.                        CL**5
  2004             20  CLAS-YEAR           PIC  X(4).                      CL**6
  2005             20  FILLER              PIC  X.                         CL**5
  2006             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  2007             20  FILLER              PIC  X.                         CL**5
  2008             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  2009             20  FILLER              PIC  X.                         CL**5
  2010             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  2011             20  FILLER              PIC  X(5).                      CL**6
  2012                                                                  ELCDTECX
  2013 01  FILLER                          PIC  X(15)                   ELCDTECX
  2014                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  2015 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  2016     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  2017         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  2018         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  2019         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  2020         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  2021         16  FILLER                  PIC  X(4).                      CL**6
  2022                                                                  ELCDTECX
  2023 01  FILLER                          PIC  X(7)                       CL**6
  2024                                     VALUE 'INDEXES'.             ELCDTECX
  2025 01  CLAS-INDEX-TBL.                                              ELCDTECX
  2026     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  2027     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  2028     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  2029     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  2030     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  2031     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  2032     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  2033     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  2034     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  2035     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  2036     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  2037     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  2038     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  2039     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  2040     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  2041     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  2042     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  2043                                                                  ELCDTECX
  2044 01  CLAS-TYPE-MISC.                                              ELCDTECX
  2045     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  2046     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  2047     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  2048     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  2049     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  2050     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  44
* ECS043.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2051     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  2052     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  2053     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  2054     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  2055     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  2056                                                                  ELCDTECX
  2057 01  FILLER                          PIC  X(13)                   ELCDTECX
  2058                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  2059 01  CLAS-MISC.                                                   ELCDTECX
  2060     12  DTE-FICH                    PIC  X.                      ELCDTECX
  2061         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  2062         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  2063         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  2064     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  2065     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  2066     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  2067     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  2068     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  2069     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  2070     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  2071     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  2072     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  2073     12  STATE-L                     PIC  XX.                     ELCDTECX
  2074     12  CLAS-CN                     PIC  99.                     ELCDTECX
  2075     12  CLAS-CO                     PIC  99.                     ELCDTECX
  2076     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  2077         16  DTE-F-1                 PIC  X.                      ELCDTECX
  2078         16  DTE-F-2                 PIC  X.                      ELCDTECX
  2079     12  DTE-ABEND-WORK.                                          ELCDTECX
  2080         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  2081         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  2082                                                                  ELCDTECX
  2083 01  FILLER                          PIC  X(12)                   ELCDTECX
  2084                                     VALUE 'WORKING DATE'.        ELCDTECX
  2085 01  WS-DATE-AND-TIME.                                            ELCDTECX
  2086     12  WS-ACCEPT-DATE.                                          ELCDTECX
  2087         16  WS-AD-YY                PIC  99.                     ELCDTECX
  2088         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2089         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2090     12  WS-CURRENT-DATE.                                         ELCDTECX
  2091         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2092         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2093         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2094         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2095         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2096     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2097         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2098         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2099                                                                  ELCDTECX
  2100 01  FILLER                          PIC  X(12)                   ELCDTECX
  2101                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2102 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2103     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2104         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2105         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2106         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  2107                                                                  ELCDTECX
  2108 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  45
* ECS043.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2109                                     VALUE 'STATE TLRS'.          ELCDTECX
  2110 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2111     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2112         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2113         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2114                                                                  ELCDTECX
  2115 01  FILLER                          PIC  X(13)                   ELCDTECX
  2116                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2117 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2118     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2119         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2120                                                                  ELCDTECX
  2121 01  FILLER                          PIC  X(13)                   ELCDTECX
  2122                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2123 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2124     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2125     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2126     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2127                                     PIC  X.                         CL**5
  2128     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2129     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2130     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2131     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2132     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2133     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2134     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2135     12  FILLER                      PIC  X(75).                  ELCDTECX
  2136******************************************************************ELCDTECX
  2137*01  MISC-CARR-PCT-DATA.                                          00001521
  2138*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2139*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2140*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2141*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2142*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2143*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2144******************************************************************ELCDTECX
  2145
* 2146                                    COPY ELCDTEVR.
  2147***************************************************************** 04/15/98
  2148*                                                                *ELCDTEVR
  2149*                                                                *ELCDTEVR
  2150*                            ELCDTEVR.                           *   LV003
  2151*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2152*                            VMOD=2.001                          *   CL**2
  2153*                                                                *ELCDTEVR
  2154*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2155*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2156*                                                                *ELCDTEVR
  2157******************************************************************ELCDTEVR
  2158 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2159     05  WS-RUN-DATE.                                             ELCDTEVR
  2160         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2161         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2162         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2163             15  RUN-CC              PIC  99.                     ELCDTEVR
  2164             15  RUN-YR              PIC  99.                     ELCDTEVR
  2165         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2166         10  RUN-DA                  PIC  99.                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  46
* ECS043.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2167     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2168            WS-RUN-DATE              PIC 9(11).                      CL**2
  2169     05  WS-EP-DT.                                                ELCDTEVR
  2170         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2171         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2172         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2173             15  EP-CC               PIC  99.                     ELCDTEVR
  2174             15  EP-YR               PIC  99.                     ELCDTEVR
  2175         10  EP-MO                   PIC  99.                     ELCDTEVR
  2176         10  EP-DA                   PIC  99.                     ELCDTEVR
  2177     05  WS-EP-DT-N REDEFINES                                        CL**2
  2178            WS-EP-DT                 PIC 9(11).                      CL**2
  2179     05  WS-DTE-CONV-DT.                                             CL**4
  2180         10  FILLER                  PIC  9(03).                     CL**4
  2181         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2182         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2183             15  DTE-CONV-CC         PIC  99.                        CL**4
  2184             15  DTE-CONV-YR         PIC  99.                        CL**4
  2185         10  DTE-CONV-MO             PIC  99.                        CL**4
  2186         10  DTE-CONV-DA             PIC  99.                        CL**4
  2187     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2188            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2189 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2190     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2191         10  FILLER                            PIC 999.           ELCDTEVR
  2192         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2193         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2194             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2195             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2196         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2197         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2198     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2199            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2200     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2201         10  FILLER                            PIC 999.           ELCDTEVR
  2202         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  2203         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2204         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2205         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2206     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2207            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2208 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2209     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2210         10  FILLER                            PIC 999.           ELCDTEVR
  2211         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2212         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2213             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2214             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2215         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2216         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2217     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2218            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2219     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2220         10  FILLER                            PIC 999.           ELCDTEVR
  2221         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2222         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  2223             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2224             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  47
* ECS043.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2225         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2226         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2227     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2228            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2229     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2230         10  FILLER                            PIC 999.           ELCDTEVR
  2231         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2232         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2233             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2234             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2235         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2236         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2237     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2238            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2239 01  WS-RATE-RECORD.                                              ELCDTEVR
  2240         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2241             10  FILLER                        PIC 999.           ELCDTEVR
  2242             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2243             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2244                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2245                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2246             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2247             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2248         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2249                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  2250
* 2251                                    COPY ELCACCTV.
  2252******************************************************************04/14/98
  2253*                                                                *ELCACCTV
  2254*                            ELCACCTV                            *   LV002
  2255*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2256*                            VMOD=2.001                          *ELCACCTV
  2257*                                                                *ELCACCTV
  2258*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  2259*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  2260*                                                                *ELCACCTV
  2261*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  2262*                                                                *ELCACCTV
  2263******************************************************************ELCACCTV
  2264                                                                  ELCACCTV
  2265 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  2266                                                                  ELCACCTV
  2267     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  2268         10  FILLER            PIC 999.                           ELCACCTV
  2269         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  2270         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  2271             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  2272             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  2273         10  AM-EXP-MO         PIC 99.                               CL**5
  2274         10  AM-EXP-DA         PIC 99.                               CL**5
  2275     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  2276            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  2277     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  2278         10  FILLER                    PIC 999.                   ELCACCTV
  2279         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  2280         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  2281             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  2282             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  48
* ECS043.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  2283         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  2284         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  2285     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  2286            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  2287     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  2288         10  FILLER                    PIC 999.                   ELCACCTV
  2289         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  2290         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  2291             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  2292             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  2293         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  2294         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  2295     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  2296            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  2297     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  2298         10 FILLER                     PIC 999.                   ELCACCTV
  2299         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  2300         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  2301            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  2302            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  2303         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  2304         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  2305     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  2306            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  2307     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  2308         10 FILLER                     PIC 999.                   ELCACCTV
  2309         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  2310         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  2311            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  2312            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  2313         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  2314         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  2315     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  2316            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  2317     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  2318         10  FILLER                    PIC 999.                   ELCACCTV
  2319         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  2320         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  2321             15  AM-AN-CC              PIC 99.                    ELCACCTV
  2322             15  AM-AN-YR              PIC 99.                    ELCACCTV
  2323         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  2324         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  2325     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  2326            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  2327     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  2328         10  FILLER                    PIC 999.                   ELCACCTV
  2329         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  2330         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  2331             15  AM-HI-CC              PIC 99.                    ELCACCTV
  2332             15  AM-HI-YR              PIC 99.                    ELCACCTV
  2333         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  2334         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  2335     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  2336            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  2337     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  2338         10  FILLER                    PIC 999.                   ELCACCTV
  2339         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  2340         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  49
* ECS043.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  2341             15  AM-LO-CC              PIC 99.                    ELCACCTV
  2342             15  AM-LO-YR              PIC 99.                    ELCACCTV
  2343         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  2344         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  2345     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  2346            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  2347     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  2348         10  FILLER                    PIC 999.                   ELCACCTV
  2349         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  2350         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  2351             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  2352             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  2353         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  2354         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  2355     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  2356            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
  2357
* 2358                                    COPY ELCEPCVR.
  2359******************************************************************05/15/98
  2360*                                                                *ELCEPCVR
  2361*                                                                *ELCEPCVR
  2362*                            ELCEPCVR                            *   LV003
  2363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2364*                            VMOD=2.001                          *ELCEPCVR
  2365*                                                                *ELCEPCVR
  2366*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  2367*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  2368*                                                                *ELCEPCVR
  2369******************************************************************ELCEPCVR
  2370 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  2371     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  2372         10  FILLER            PIC 999.                           ELCEPCVR
  2373         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  2374         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  2375             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  2376             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  2377         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  2378         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  2379     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  2380            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  2381     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  2382         10  FILLER            PIC 999.                              CL**5
  2383         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  2384         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  2385             15  EC-EXP-CC     PIC 99.                               CL**5
  2386             15  EC-EXP-YR     PIC 99.                               CL**5
  2387         10  EC-EXP-MO         PIC 99.                               CL**5
  2388         10  EC-EXP-DA         PIC 99.                               CL**5
  2389     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  2390            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  2391     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  2392         10  FILLER            PIC 999.                           ELCEPCVR
  2393         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  2394         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  2395             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  2396             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  2397         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  2398         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  50
* ECS043.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2399     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  2400            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  2401     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  2402         10  FILLER            PIC 999.                              CL**5
  2403         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  2404         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  2405             15  EC-EFF-CC     PIC 99.                               CL**5
  2406             15  EC-EFF-YR     PIC 99.                               CL**5
  2407         10  EC-EFF-MO         PIC 99.                               CL**5
  2408         10  EC-EFF-DA         PIC 99.                               CL**5
  2409     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  2410            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  2411     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  2412         10  FILLER            PIC 999.                           ELCEPCVR
  2413         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  2414         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  2415             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  2416             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  2417         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  2418         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  2419     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  2420            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  2421     05  WS-EP-HI-CERT.                                           ELCEPCVR
  2422         10  FILLER            PIC 999.                           ELCEPCVR
  2423         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  2424         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  2425             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  2426             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  2427         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  2428         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  2429     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  2430            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  2431     05  WS-EP-LO-CERT.                                           ELCEPCVR
  2432         10  FILLER            PIC 999.                           ELCEPCVR
  2433         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  2434         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  2435             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  2436             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  2437         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  2438         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  2439     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  2440            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  2441     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  2442         10  FILLER            PIC 999.                           ELCEPCVR
  2443         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2444         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  2445             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  2446             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  2447         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  2448         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  2449     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  2450            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  2451     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  2452         10  FILLER            PIC 999.                           ELCEPCVR
  2453         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2454         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  2455             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  2456             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  51
* ECS043.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2457         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  2458         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  2459     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  2460            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  2461
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  52
* ECS043.cbl
  2463 PROCEDURE DIVISION.
  2464 0100-READ-DATE-CARD.
* 2465                             COPY ELCDTERX SUPPRESS.
  2781
  2782     MOVE LIFE-OVERRIDE-L12     TO HEAD-7-PLUG-1
  2783                                   HEAD-7-PLUG-3.
  2784     MOVE AH-OVERRIDE-L12       TO HEAD-7-PLUG-2
  2785                                   HEAD-7-PLUG-4.
  2786     MOVE WS-CURRENT-DATE TO HD-RD.
  2787     MOVE ALPH-DATE       TO HD-AD.
  2788     MOVE COMPANY-NAME    TO HD-COMP.
  2789
  2790     MOVE LOW-VALUES      TO END-CHARACTER.
  2791     MOVE SPACES          TO END-CHARACTER.
  2792
  2793     MOVE RUN-DATE        TO RUN-DT
  2794                             BEG-DATE.
  2795
  2796     OPEN INPUT CONTROL-CARD.
  2797
  2798     READ CONTROL-CARD INTO FORMAT-CONTROL-CARD
  2799          AT END   MOVE '1' TO FC-CODE
  2800                   GO TO 0130-BUILD-SELECT-DATES.
  2801
  2802 0110-READ-CARD-LOOP.
  2803     IF FC-ID = 'RF'
  2804         IF FC-CLIENT = DTE-CLIENT
  2805             GO TO 0120-FLUSH-REMAINING-CARDS.
  2806
  2807     READ CONTROL-CARD INTO FORMAT-CONTROL-CARD
  2808          AT END   MOVE '1' TO FC-CODE
  2809                   GO TO 0130-BUILD-SELECT-DATES.
  2810
  2811     GO TO 0110-READ-CARD-LOOP.
  2812
  2813 0120-FLUSH-REMAINING-CARDS.
  2814     READ CONTROL-CARD
  2815            AT END GO TO 0130-BUILD-SELECT-DATES.
  2816
  2817     GO TO 0120-FLUSH-REMAINING-CARDS.
  2818
  2819 0130-BUILD-SELECT-DATES.
  2820     IF DTE-PGM-OPT = '5' OR '7'
  2821        MOVE 'RF'       TO FC-ID
  2822        MOVE DTE-CLIENT TO FC-CLIENT
  2823        MOVE '5'        TO FC-CODE
  2824        MOVE RUN-DATE   TO FC-DATE.
  2825
  2826     IF FC-CODE = ' '
  2827       IF FC-DATE NOT NUMERIC  OR
  2828          FC-DATE = ZEROS
  2829          MOVE 'INVALID BEGIN DATE  ' TO WS-ABEND-MESSAGE
  2830          GO TO ABEND-PGM.
  2831
  2832     IF FC-CODE = ' '
  2833         MOVE FC-DATE   TO BEG-DATE
  2834         MOVE FC-MM     TO W-MM
  2835         MOVE FC-DD     TO W-DD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  53
* ECS043.cbl
  2836         MOVE FC-CCYY   TO W-CCYY
  2837         MOVE WORK-MSG  TO H6-YTD-HD
  2838         GO TO 0140-SORT-CONTROL.
  2839
  2840     IF DTE-PGM-OPT = '5'
  2841         MOVE FC-DATE   TO BEG-DATE.
  2842
  2843     IF FC-CODE = ('1' OR '5')
  2844         SUBTRACT 1 FROM BD-CCYY
  2845         IF FC-CODE = '1'
  2846              MOVE 31   TO BD-DA
  2847              MOVE 12   TO BD-MO
  2848              MOVE '*   YEAR TO DATE   *' TO H6-YTD-HD
  2849              GO TO 0140-SORT-CONTROL
  2850         ELSE
  2851              MOVE '*  LAST 12 MONTHS  *' TO H6-YTD-HD
  2852              MOVE BEG-DATE TO SAVE-BEG-DATE
  2853              GO TO 0140-SORT-CONTROL.
  2854
  2855     IF FC-CODE = '2'
  2856         MOVE '* QUARTER TO DATE  *' TO H6-YTD-HD
  2857         IF RD-MO LESS 3
  2858             MOVE 12    TO BD-MO
  2859             MOVE 31    TO BD-DA
  2860             SUBTRACT 1 FROM BD-CCYY
  2861             GO TO 0140-SORT-CONTROL
  2862         ELSE
  2863             IF RD-MO LESS 6
  2864                 MOVE 03 TO BD-MO
  2865                 MOVE 31 TO BD-DA
  2866                 GO TO 0140-SORT-CONTROL
  2867             ELSE
  2868                 IF BD-MO LESS 9
  2869                     MOVE 06 TO BD-MO
  2870                     MOVE 30 TO BD-DA
  2871                     GO TO 0140-SORT-CONTROL
  2872                 ELSE
  2873                     MOVE 09 TO BD-MO
  2874                     MOVE 30 TO BD-DA
  2875                     GO TO 0140-SORT-CONTROL.
  2876
  2877     MOVE BIN-RUN-DATE          TO DC-BIN-DATE-1.
  2878     MOVE '6'                   TO DC-OPTION-CODE.
  2879
  2880     EVALUATE FC-CODE
  2881        WHEN '3'
  2882           MOVE '*   LAST 3 MONTHS  *' TO H6-YTD-HD
  2883           MOVE  -3 TO DC-ELAPSED-MONTHS
  2884        WHEN '4'
  2885           MOVE '*   LAST 6 MONTHS  *' TO H6-YTD-HD
  2886           MOVE  -6 TO DC-ELAPSED-MONTHS
  2887        WHEN '6'
  2888           MOVE '*    LAST MONTH    *' TO H6-YTD-HD
  2889           MOVE  -1 TO DC-ELAPSED-MONTHS
  2890     END-EVALUATE.
  2891
  2892     MOVE ZEROS                 TO DC-ELAPSED-DAYS.
  2893     MOVE '1'                   TO DC-END-OF-MONTH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  54
* ECS043.cbl
  2894     PERFORM 8510-DATE-CONVERSION THRU 8590-EXIT.
  2895     MOVE DC-GREG-DATE-CYMD     TO BEG-DATE.
  2896
  2897
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  55
* ECS043.cbl
  2899 0140-SORT-CONTROL.
  2900     SORT SORT-WORK ON
  2901         ASCENDING  SW-RPT-TYPE-ID-OUT
  2902                    SW-CTL-OUT
  2903         INPUT PROCEDURE 0150-BUILD-EXTRACTS
  2904         OUTPUT PROCEDURE
  2905             0745-OUTPUT-PROCEDURE THRU 1090-CLOSE-EXIT.
  2906
  2907     IF SORT-RETURN NOT = ZERO AND 4
  2908          MOVE SORT-RETURN            TO WS-RETURN-CODE
  2909          MOVE 'UNSUCCESSFUL SORT RC' TO WS-ABEND-MESSAGE
  2910          GO TO ABEND-PGM.
  2911
  2912     GOBACK.
  2913
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  56
* ECS043.cbl
  2915 0150-BUILD-EXTRACTS SECTION.
  2916
  2917 0160-BEGIN-PROCESSING.
  2918     OPEN INPUT
  2919             ACC-MSTR
  2920             ERPLAN-IN
  2921             EPEC-FILE
  2922         OUTPUT
  2923             PRNTR.
  2924
  2925     IF ERACCTT-FILE-STATUS  = '00' OR '97'
  2926         NEXT SENTENCE
  2927       ELSE
  2928         MOVE '11'                TO W-ABEND-CODE-1
  2929         MOVE ERACCTT-FILE-STATUS TO W-ABEND-CODE-2
  2930         MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  2931         MOVE 'OPEN ERROR - ERACCTT' TO WS-ABEND-MESSAGE
  2932         GO TO ABEND-PGM.
  2933
  2934     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  2935         NEXT SENTENCE
  2936       ELSE
  2937         MOVE '12'                TO W-ABEND-CODE-1
  2938         MOVE ERPLAN-FILE-STATUS  TO W-ABEND-CODE-2
  2939         MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  2940         MOVE 'OPEN ERROR - ERPLAN ' TO WS-ABEND-MESSAGE
  2941         GO TO ABEND-PGM.
  2942
  2943     PERFORM 0550-ZERO-DA  VARYING SA FROM 1 BY 1
  2944                           UNTIL SA GREATER 4.
  2945     PERFORM 0560-ZERO-PA  VARYING SB FROM 1 BY 1
  2946                           UNTIL SB GREATER 36.
  2947     PERFORM 0570-ZERO-XDA VARYING CL FROM 1 BY 1
  2948                           UNTIL CL GREATER 10.
  2949
  2950     PERFORM 0240-READ-EXTRACT THRU 0240-EXIT.
  2951     PERFORM 0260-READ-ACCT    THRU 0260-EXIT.
  2952
  2953     MOVE EP-CONTROL TO WS-SAVE-CONTROL.
  2954
  2955     GO TO 0200-CHECK-ACCT-MSTR.
  2956
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  57
* ECS043.cbl
  2958 0170-CHECK-CONTROL.
  2959
  2960     PERFORM 0250-CHECK-PLAN  THRU 0250-EXIT.
  2961
  2962     IF EXCLUDING-BENEFIT
  2963        GO TO 0190-BYPASS-ACCUM.
  2964
  2965     IF DTE-PGM-OPT = '5'
  2966        AND AM-AN-MO NOT = RUN-MO
  2967        GO TO 0190-BYPASS-ACCUM.
  2968
  2969     IF AM-RET-Y-N = 'L'
  2970         IF EP-RCD-TYPE NOT = LIFE-OVERRIDE-L1
  2971             GO TO 0190-BYPASS-ACCUM.
  2972
  2973     IF AM-RET-Y-N = 'D'
  2974         IF EP-RCD-TYPE NOT = AH-OVERRIDE-L1
  2975             GO TO 0190-BYPASS-ACCUM.
  2976
  2977     IF EP-RECORD-ID = 'EP'
  2978         IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  2979             ADD EP-RETRO-PAYMENTS TO DA-CPS (3)
  2980             ADD EP-RETRO-EXPENSES TO DA-EXP (3)
  2981             ADD EP-RETRO-OTH-COMM TO DA-OTC (3)
  2982         ELSE
  2983             ADD EP-RETRO-PAYMENTS TO DA-CPS (4)
  2984             ADD EP-RETRO-EXPENSES TO DA-EXP (4)
  2985             ADD EP-RETRO-OTH-COMM TO DA-OTC (4).
  2986
  2987     IF EP-RECORD-ID = 'EP'
  2988         IF EP-RUN-DTE NOT GREATER BEG-DATE
  2989             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  2990                 ADD EP-RETRO-PAYMENTS TO DA-CPS (1)
  2991                 ADD EP-RETRO-EXPENSES TO DA-EXP (1)
  2992                 ADD EP-RETRO-OTH-COMM TO DA-OTC (1)
  2993             ELSE
  2994                 ADD EP-RETRO-PAYMENTS TO DA-CPS (2)
  2995                 ADD EP-RETRO-EXPENSES TO DA-EXP (2)
  2996                 ADD EP-RETRO-OTH-COMM TO DA-OTC (2).
  2997
  2998     IF EP-PURGE = 'P'
  2999         IF EP-RUN-DTE GREATER BEG-DATE
  3000             MOVE 'Q' TO EP-PURGE
  3001             GO TO 0180-TEST-ACCUM
  3002         ELSE
  3003             GO TO 0180-TEST-ACCUM.
  3004
  3005     IF EP-RUN-CCYY = RD-CCYY  AND
  3006        EP-RUN-MO = RD-MO
  3007         MOVE '2' TO EP-PURGE
  3008         GO TO 0180-TEST-ACCUM.
  3009
  3010     IF EP-RUN-CCYY = BD-CCYY  AND
  3011        EP-RUN-MO = BD-MO
  3012         MOVE '1' TO EP-PURGE
  3013         GO TO 0180-TEST-ACCUM.
  3014
  3015     GO TO 0190-BYPASS-ACCUM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  58
* ECS043.cbl
  3016
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  59
* ECS043.cbl
  3018 0180-TEST-ACCUM.
  3019     IF EP-RECORD-ID = 'EP'
  3020         IF EP-PURGE = ('1' OR 'P')
  3021             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3022                 MOVE +1 TO SA
  3023                 MOVE LIFE-RETENT   TO RETENT-FACT
  3024                 PERFORM 0640-EP-ADD THRU 0640-EXIT
  3025             ELSE
  3026                 MOVE +2 TO SA
  3027                 MOVE   AH-RETENT   TO RETENT-FACT
  3028                 PERFORM 0640-EP-ADD THRU 0640-EXIT.
  3029
  3030     IF EP-RECORD-ID = 'EP'
  3031         IF EP-PURGE = ('2' OR 'P' OR 'Q')
  3032             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3033                 MOVE +3 TO SA
  3034                 MOVE LIFE-RETENT   TO RETENT-FACT
  3035                 PERFORM 0640-EP-ADD THRU 0640-EXIT
  3036             ELSE
  3037                 MOVE +4 TO SA
  3038                 MOVE   AH-RETENT   TO RETENT-FACT
  3039                 PERFORM 0640-EP-ADD THRU 0640-EXIT.
  3040
  3041     IF EP-RECORD-ID = 'EC'
  3042         IF EP-PURGE = ('1' OR 'P')
  3043             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3044                 MOVE +1 TO SA
  3045                 PERFORM 0690-EC-ADD THRU 0729-EXIT
  3046             ELSE
  3047                 MOVE +2 TO SA
  3048                 PERFORM 0690-EC-ADD THRU 0729-EXIT.
  3049
  3050     IF EP-RECORD-ID = 'EC'
  3051         IF EP-PURGE = ('2' OR 'P' OR 'Q')
  3052             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3053                 MOVE +3 TO SA
  3054                 PERFORM 0690-EC-ADD THRU 0729-EXIT
  3055             ELSE
  3056                 MOVE +4 TO SA
  3057                 PERFORM 0690-EC-ADD THRU 0729-EXIT.
  3058
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  60
* ECS043.cbl
  3060 0190-BYPASS-ACCUM.
  3061     PERFORM 0240-READ-EXTRACT THRU 0240-EXIT.
  3062
  3063     IF EP-CONTROL = WS-SAVE-CONTROL
  3064         GO TO 0170-CHECK-CONTROL.
  3065
  3066     PERFORM 0280-CALCULATE-RETRO THRU 0330-EXIT.
  3067
  3068     IF EP-CONTROL = HIGH-VALUES
  3069         GO TO 0220-BUILD-EXTRACTS-EXIT.
  3070
  3071     MOVE EP-CONTROL TO WS-SAVE-CONTROL.
  3072
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  61
* ECS043.cbl
  3074 0200-CHECK-ACCT-MSTR.
  3075     IF WS-ACCT-CONTROL LESS WS-SAVE-CONTROL
  3076         IF AM-GPCD = 98
  3077             PERFORM 0360-BUILD-DUMMY-GA
  3078             PERFORM 0260-READ-ACCT THRU 0260-EXIT
  3079             GO TO 0200-CHECK-ACCT-MSTR
  3080         ELSE
  3081             PERFORM 0260-READ-ACCT THRU 0260-EXIT
  3082             GO TO 0200-CHECK-ACCT-MSTR.
  3083
  3084 0210-NO-ACCT-MSTR.
  3085     IF WS-ACCT-CONTROL GREATER WS-SAVE-CONTROL
  3086         PERFORM 0270-NO-ACCT-MSG
  3087         PERFORM 0240-READ-EXTRACT THRU 0240-EXIT
  3088         IF EP-CONTROL = HIGH-VALUES
  3089             GO TO 0220-BUILD-EXTRACTS-EXIT
  3090         ELSE
  3091             MOVE EP-CONTROL TO WS-SAVE-CONTROL
  3092             GO TO 0200-CHECK-ACCT-MSTR.
  3093
  3094     IF DTE-PGM-OPT = '7'
  3095         PERFORM 0215-COMPUTE-BEG-DATE THRU 0215-EXIT.
  3096
  3097     GO TO 0170-CHECK-CONTROL.
  3098
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  62
* ECS043.cbl
  3100 0215-COMPUTE-BEG-DATE.
  3101     IF (AM-ANNIVERSARY-DATE NOT NUMERIC) OR
  3102        (AM-AN-MO LESS 01 OR GREATER 12)
  3103            MOVE SAVE-BEG-DATE TO BEG-DATE
  3104            GO TO 0215-EXIT.
  3105
  3106     MOVE RD-CCYY  TO BD-CCYY.
  3107     MOVE AM-AN-MO TO BD-MO.
  3108
  3109     IF BD-MO NOT LESS RD-MO
  3110         SUBTRACT 1 FROM BD-CCYY.
  3111
  3112     IF BD-MO = 04 OR 06 OR 09 OR 11
  3113         MOVE 30 TO BD-DA
  3114     ELSE
  3115         MOVE 31 TO BD-DA.
  3116
  3117     IF BD-MO = 02
  3118         MOVE BD-CCYY     TO HOLD-CEN-1-CCYY
  3119         MOVE 'H'         TO DC-OPTION-CODE
  3120         PERFORM 8510-DATE-CONVERSION THRU 8590-EXIT
  3121         IF ONLY-LEAP-YEAR
  3122             MOVE HOLD-CEN-1-DA TO BD-DA
  3123         ELSE
  3124             MOVE 28            TO BD-DA.
  3125
  3126 0215-EXIT.
  3127     EXIT.
  3128
  3129 0220-BUILD-EXTRACTS-EXIT.
  3130     CLOSE
  3131         ACC-MSTR
  3132         ERPLAN-IN
  3133         EPEC-FILE.
  3134
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  63
* ECS043.cbl
  3136****************************************************************
  3137*                                                              *
  3138****************************************************************
  3139
  3140 0230-PERFORMED-ROUTINES SECTION.
  3141
  3142 0240-READ-EXTRACT.
  3143     READ EPEC-FILE AT END
  3144          MOVE HIGH-VALUES TO EP-CONTROL
  3145          GO TO 0240-EXIT.
  3146
  3147     IF EP-RECORD-ID NOT = 'EP' AND 'EC'
  3148         GO TO 0240-READ-EXTRACT.
  3149
  3150     IF EP-REIN = 'R'
  3151         GO TO 0240-READ-EXTRACT.
  3152
  3153     IF EP-RUN-DTE GREATER RUN-DT
  3154         GO TO 0240-READ-EXTRACT.
  3155
* 3156     COPY ELCEPCM1.
  3157******************************************************************05/15/98
  3158*                                                                *ELCEPCM1
  3159*                                                                *ELCEPCM1
  3160*                            ELCEPCM1                            *   LV007
  3161*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  3162*                            VMOD=2.001                          *ELCEPCM1
  3163*                                                                *ELCEPCM1
  3164*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEPCM1
  3165*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCM1
  3166*                                                                *ELCEPCM1
  3167******************************************************************ELCEPCM1
  3168                                                                     CL**7
  3169     MOVE EP-EXP-DTE         TO  WS-EP-EXP-DTE-N                     CL**7
  3170                                 WS-EC-EXP-DTE-N.                    CL**7
  3171     MOVE EP-EFF-DTE         TO  WS-EP-EFF-DTE-N                     CL**7
  3172                                 WS-EC-EFF-DTE-N.                    CL**7
  3173     MOVE EP-RUN-DTE         TO  WS-EP-RUN-DTE-N                     CL**7
  3174                                 WS-EC-RUN-DTE-N.                    CL**7
  3175                                                                     CL**7
  3176     IF VALID-EP-ID                                                  CL**7
  3177         MOVE EP-HI-COV-DT   TO  WS-EP-HI-COV-DT-N                   CL**7
  3178         MOVE EP-HI-CERT     TO  WS-EP-HI-CERT-N                     CL**7
  3179         MOVE EP-LO-CERT     TO  WS-EP-LO-CERT-N.                    CL**7
  3180                                                                     CL**7
  3181
  3182 0240-EXIT.
  3183     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  64
* ECS043.cbl
  3185
  3186 0250-CHECK-PLAN.
  3187
  3188     PERFORM 0650-EP-EARN-TYPE THRU 0680-EXIT.
  3189
  3190*    IF AM-RET-Y-N = ' '   OR  'N'
  3191*        MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3192*        GO TO 0250-EXIT.
  3193
  3194
  3195     IF EP-COMPANY-CD  EQUAL  WS-PL-COMPANY-CD   AND
  3196        EP-CNTRL-1     EQUAL  WS-PL-CONTROL-A    AND
  3197        EP-RCD-TYPE    EQUAL  WS-PL-BENEFIT-TYPE AND
  3198        EP-BEN-CODE    EQUAL  WS-PL-BENEFIT-CODE
  3199            GO TO 0250-EXIT.
  3200
  3201     MOVE EP-COMPANY-CD       TO WS-PL-COMPANY-CD.
  3202     MOVE EP-CNTRL-1          TO WS-PL-CONTROL-A.
  3203     MOVE EP-RCD-TYPE         TO WS-PL-BENEFIT-TYPE.
  3204     MOVE EP-BEN-CODE         TO WS-PL-BENEFIT-CODE.
  3205
  3206     MOVE SPACE               TO WS-EXCLUSION-SWITCH.
  3207
  3208     MOVE +1                  TO NDX.
  3209
  3210 0250-PLAN-LOOP.
  3211
  3212     IF NDX GREATER THAN +20
  3213        MOVE +1                 TO NDX
  3214        GO TO 025A-EDIT-FOR-SPECIAL.
  3215
  3216     IF AM-BENEFIT-CODE (NDX)  EQUAL EP-BEN-CODE AND
  3217        AM-BENEFIT-TYPE (NDX)  EQUAL EP-RCD-TYPE
  3218          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3219          MOVE WS-PLAN-CONTROL     TO PL-CONTROL-PRIMARY
  3220          GO TO 0250-READ-PLAN
  3221     ELSE
  3222        ADD +1                TO NDX
  3223        GO TO 0250-PLAN-LOOP.
  3224
  3225 0250-READ-PLAN.
  3226
  3227     IF AM-BENEFIT-RETRO-Y-N (NDX) = 'N'
  3228         MOVE '*'              TO WS-EXCLUSION-SWITCH
  3229         GO TO 0250-EXIT.
  3230
  3231     READ ERPLAN-IN.
  3232
  3233     IF ERPLAN-FILE-STATUS  EQUAL '00'
  3234         NEXT SENTENCE
  3235     ELSE
  3236        IF ERPLAN-FILE-STATUS  EQUAL '23'
  3237            GO TO 0250-PLAN-NOT-FOUND
  3238        ELSE
  3239            MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3240            MOVE 'READ ERROR - ERPLAN ' TO WS-ABEND-MESSAGE
  3241            DISPLAY '**BAD PLAN FILE READ'
  3242            DISPLAY '**ERPLAN-FILE-STATUS= ' ERPLAN-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  65
* ECS043.cbl
  3243            GO TO ABEND-PGM.
  3244
  3245     IF EP-COMPANY-CD  EQUAL  PL-COMPANY-CD   AND
  3246        EP-CNTRL-1     EQUAL  PL-CONTROL-A    AND
  3247        EP-RCD-TYPE    EQUAL  PL-BENEFIT-TYPE AND
  3248        AM-BENEFIT-CODE (NDX)  EQUAL  PL-BENEFIT-CODE
  3249           NEXT SENTENCE
  3250     ELSE
  3251           GO TO 0250-PLAN-NOT-FOUND.
  3252
  3253     IF AM-RET-Y-N = ' '   OR  'N'
  3254         MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3255         GO TO 0250-EXIT.
  3256
  3257     IF PL-RETRO-RET EQUAL ZEROS
  3258         GO TO 0250-PLAN-NOT-FOUND.
  3259
  3260     IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3261         COMPUTE LIFE-RETENT = 1 - PL-RETRO-RET
  3262         GO TO 0250-EXIT
  3263     ELSE
  3264         COMPUTE AH-RETENT   = 1 - PL-RETRO-RET
  3265         GO TO 0250-EXIT.
  3266
  3267 025A-EDIT-FOR-SPECIAL.
  3268
  3269     IF (AM-BENEFIT-CODE (NDX) EQUAL '99')
  3270      AND
  3271        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3272          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3273          MOVE AM-BENEFIT-CODE (NDX)     TO WS-PL-BENEFIT-CODE
  3274          MOVE WS-PLAN-CONTROL           TO PL-CONTROL-PRIMARY
  3275          GO TO 0250-READ-PLAN.
  3276
  3277     IF (AM-BENEFIT-CODE (NDX) EQUAL '91')
  3278      AND
  3279        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3280        AND
  3281          AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE
  3282          IF CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I'
  3283              AND CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'R'
  3284          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3285          MOVE AM-BENEFIT-CODE (NDX)     TO WS-PL-BENEFIT-CODE
  3286          MOVE WS-PLAN-CONTROL           TO PL-CONTROL-PRIMARY
  3287          GO TO 0250-READ-PLAN.
  3288
  3289     IF (AM-BENEFIT-CODE (NDX) EQUAL '91')
  3290      AND
  3291        (AM-BENEFIT-TYPE (NDX) EQUAL AH-OVERRIDE-L1)
  3292      AND
  3293        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3294         IF CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I'
  3295            MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3296            MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3297            MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3298            GO TO 0250-READ-PLAN.
  3299
  3300     IF (AM-BENEFIT-CODE (NDX) EQUAL '92')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  66
* ECS043.cbl
  3301      AND
  3302        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3303      AND
  3304        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3305         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3306           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'R')
  3307             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3308             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3309             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3310             GO TO 0250-READ-PLAN.
  3311
  3312     IF (AM-BENEFIT-CODE (NDX) EQUAL '92')
  3313      AND
  3314        (AM-BENEFIT-TYPE (NDX) EQUAL AH-OVERRIDE-L1)
  3315      AND
  3316        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3317         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3318             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3319             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3320             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3321             GO TO 0250-READ-PLAN.
  3322
  3323     IF (AM-BENEFIT-CODE (NDX) EQUAL '93')
  3324      AND
  3325        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3326      AND
  3327        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3328         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I')
  3329           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P' OR 'L')
  3330             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3331             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3332             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3333             GO TO 0250-READ-PLAN.
  3334
  3335     IF (AM-BENEFIT-CODE (NDX) EQUAL '94')
  3336      AND
  3337        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3338      AND
  3339        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3340         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3341           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P' OR 'L')
  3342             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3343             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3344             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3345             GO TO 0250-READ-PLAN.
  3346
  3347     IF (AM-BENEFIT-CODE (NDX) EQUAL '98')
  3348      AND
  3349        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3350             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3351             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3352             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3353             GO TO 0250-READ-PLAN.
  3354
  3355     IF NDX NOT LESS THAN +20
  3356       GO TO 0250-PLAN-NOT-FOUND
  3357     ELSE
  3358       ADD  +1                 TO NDX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  67
* ECS043.cbl
  3359       GO TO 025A-EDIT-FOR-SPECIAL.
  3360
  3361
  3362 0250-PLAN-NOT-FOUND.
  3363     IF AM-RET-Y-N = ' '   OR  'N'
  3364         MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3365         GO TO 0250-EXIT
  3366     ELSE
  3367         COMPUTE LIFE-RETENT = 1 - AM-LF-RET
  3368         COMPUTE AH-RETENT   = 1 - AM-AH-RET
  3369         GO TO 0250-EXIT.
  3370
  3371 0250-EXIT.
  3372     EXIT.
  3373
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  68
* ECS043.cbl
  3375 0260-READ-ACCT.
  3376     READ ACC-MSTR
  3377             AT END MOVE HIGH-VALUES TO WS-ACCT-CONTROL
  3378                    GO TO 0260-EXIT.
  3379
* 3380     COPY ELCACCTI.
  3381******************************************************************04/14/98
  3382*                                                                *ELCACCTI
  3383*                            ELCACCTI                            *   LV003
  3384*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3385*                            VMOD=2.001                          *ELCACCTI
  3386*                                                                *ELCACCTI
  3387*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  3388*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  3389*                                                                *ELCACCTI
  3390*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  3391*                                                                *ELCACCTI
  3392******************************************************************ELCACCTI
  3393     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  3394     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  3395     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  3396     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  3397     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  3398     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  3399     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  3400     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  3401     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  3402
  3403     MOVE AM-MSTR-CNTRL TO WS-MSTR-CNTRL.
  3404     MOVE AM-EFFECT-DT  TO WS-EFFECT.
  3405
  3406
  3407     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  3408         MOVE EXPENSE-LINE TO WS-EX-LINE.
  3409
  3410     IF DTE-PGM-OPT  = '5' AND
  3411        AM-AN-MO NOT = RUN-MO
  3412         MOVE SPACES TO AM-RETRO-POOL
  3413         MOVE +0.0   TO AM-LF-RET AM-AH-RET
  3414         MOVE 'N'    TO AM-RET-Y-N.
  3415
  3416     IF DTE-CLIENT = 'GIC'
  3417         MOVE 'P' TO AM-RET-P-E.
  3418     IF AM-RETRO-QUALIFY-LIMIT NOT NUMERIC  OR
  3419        AM-RETRO-QUALIFY-LIMIT = ZEROS
  3420         MOVE -9999999         TO AM-RETRO-QUALIFY-LIMIT.
  3421
  3422     IF AM-RET-P-E NOT = 'P'  AND  'E'
  3423         MOVE 'E'              TO AM-RET-P-E.
  3424     IF AM-RETRO-PREM-P-E NOT = 'P'  AND  'E'
  3425         MOVE AM-RET-P-E       TO AM-RETRO-PREM-P-E.
  3426     IF AM-RETRO-CLMS-P-I NOT = 'P'  AND  'I'
  3427         MOVE 'I'              TO AM-RETRO-CLMS-P-I.
  3428     IF AM-RETRO-RET-METHOD-LF NOT = 'P'  AND  'S'
  3429         MOVE 'P'              TO AM-RETRO-RET-METHOD-LF.
  3430     IF AM-RETRO-RET-BASIS-LF NOT = 'P'  AND  'E'
  3431         MOVE 'P'              TO AM-RETRO-RET-BASIS-LF.
  3432     IF AM-RETRO-RET-METHOD-AH NOT = 'P'  AND  'S'  AND  'L'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  69
* ECS043.cbl
  3433         MOVE 'P'              TO AM-RETRO-RET-METHOD-AH.
  3434     IF AM-RETRO-RET-BASIS-AH NOT = 'P'  AND  'E'
  3435         MOVE 'P'              TO AM-RETRO-RET-BASIS-AH.
  3436
  3437     IF AM-RETRO-USE-LIFE-METHOD
  3438         MOVE AM-RETRO-RET-BRACKET-LF TO AM-RETRO-RET-BRACKET-AH.
  3439
  3440 0260-EXIT.
  3441     EXIT.
  3442
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  70
* ECS043.cbl
  3444 0270-NO-ACCT-MSG.
  3445     IF LINE-CNT GREATER +55
  3446         MOVE ZERO   TO LINE-CNT
  3447         MOVE '1'    TO X
  3448         MOVE HEAD-1 TO P-DATA
  3449         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3450         MOVE ' '    TO X
  3451         MOVE HEAD-2 TO P-DATA
  3452         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3453         ADD +1               TO PAGE-CNT
  3454         MOVE PAGE-CNT        TO H3-PAGE
  3455         MOVE ' '    TO X
  3456         MOVE HEAD-3 TO P-DATA
  3457         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3458         MOVE ' '    TO X
  3459         MOVE HEAD-4 TO P-DATA
  3460         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3461         MOVE ' '    TO X
  3462         MOVE SPACES TO P-DATA
  3463         PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  3464
  3465     MOVE WS-SAVE-CARR     TO H5-CARR.
  3466     MOVE WS-SAVE-COMP     TO H5-COMP.
  3467     MOVE WS-SAVE-STATE    TO H5-ST.
  3468     MOVE WS-SAVE-ACCT     TO H5-ACCT.
  3469     MOVE WS-SAVE-EXP-DATE TO WORK-DATE.
  3470     MOVE WK-YR            TO H5-TYR.
  3471     MOVE WK-MO            TO H5-TMO.
  3472     MOVE WK-DA            TO H5-TDA.
  3473     MOVE WS-SAVE-EFF-DATE TO WORK-DATE.
  3474     MOVE WK-YR            TO H5-FYR.
  3475     MOVE WK-MO            TO H5-FMO.
  3476     MOVE WK-DA            TO H5-FDA.
  3477     MOVE ' NO MATCHING ACCOUNT MASTER' TO H5-MESSAGE.
  3478     MOVE ' '              TO X.
  3479     MOVE HEAD-5           TO P-DATA.
  3480     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  3481
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  71
* ECS043.cbl
  3483 0280-CALCULATE-RETRO.
  3484******************************************************************
  3485*              SPECIAL LOSS-RESERVE CALCULATION FOR OLI
  3486
  3487     IF DTE-CLIENT NOT = 'POS'
  3488         GO TO 0290-SKIP-CC.
  3489
  3490     IF AM-CARRIER NOT = '1'
  3491         GO TO 0290-SKIP-CC.
  3492
  3493     IF AM-FLD-5 NOT = 'CC'
  3494         GO TO 0290-SKIP-CC.
  3495
  3496     COMPUTE DA-LRV (1) = (+.40 * ((DA-ISP (1) - DA-CNP (1))
  3497                     - DA-UP (1))) - DA-CLM (1).
  3498     COMPUTE DA-LRV (2) = (+.40 * ((DA-ISP (2) - DA-CNP (2))
  3499                     - DA-UP (2))) - DA-CLM (2).
  3500     COMPUTE DA-LRV (3) = (+.40 * ((DA-ISP (3) - DA-CNP (3))
  3501                     - DA-UP (3))) - DA-CLM (3).
  3502     COMPUTE DA-LRV (4) = (+.40 * ((DA-ISP (4) - DA-CNP (4))
  3503                     - DA-UP (4))) - DA-CLM (4).
  3504
  3505     IF DA-LRV (1) LESS ZERO
  3506         ADD DA-LRV (1) TO DA-LRV (2)
  3507         MOVE ZEROS TO DA-LRV (1)
  3508         IF DA-LRV (2) LESS ZERO
  3509             MOVE ZEROS TO DA-LRV (2).
  3510
  3511     IF DA-LRV (2) LESS ZERO
  3512         ADD DA-LRV (2) TO DA-LRV (1)
  3513         MOVE ZEROS TO DA-LRV (2)
  3514         IF DA-LRV (1) LESS ZERO
  3515             MOVE ZEROS TO DA-LRV (1).
  3516
  3517     IF DA-LRV (3) LESS ZERO
  3518         ADD DA-LRV (3) TO DA-LRV (4)
  3519         MOVE ZEROS TO DA-LRV (3)
  3520         IF DA-LRV (4) LESS ZERO
  3521             MOVE ZEROS TO DA-LRV (4).
  3522
  3523     IF DA-LRV (4) LESS ZERO
  3524         ADD DA-LRV (4) TO DA-LRV (3)
  3525         MOVE ZEROS TO DA-LRV (4)
  3526         IF DA-LRV (3) LESS ZERO
  3527             MOVE ZEROS TO DA-LRV (3).
  3528
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  72
* ECS043.cbl
  3530******************************************************************
  3531**       END OF SPECIAL OLI CODING
  3532******************************************************************
  3533
  3534 0290-SKIP-CC.
  3535
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  73
* ECS043.cbl
  3537 0300-CALC-RETRO-A.
  3538
  3539     MOVE +1 TO SA.
  3540     MOVE +3 TO SB.
  3541     MOVE +1 TO SC.
  3542     MOVE +3 TO SF.
  3543     PERFORM 0380-COMPUTE-YTD THRU 0390-EXIT.
  3544     MOVE +2 TO SA.
  3545     MOVE +4 TO SB.
  3546     MOVE +2 TO SC.
  3547     PERFORM 0380-COMPUTE-YTD THRU 0390-EXIT.
  3548     MOVE +3 TO SB.
  3549     MOVE +4 TO SC.
  3550     MOVE +6 TO SF.
  3551     PERFORM 0400-COMPUTE-ITD THRU 0410-EXIT.
  3552     MOVE +4 TO SB.
  3553     MOVE +5 TO SC.
  3554     PERFORM 0400-COMPUTE-ITD THRU 0410-EXIT.
  3555     MOVE SPACES       TO SW-REC.
  3556     MOVE 'A'          TO SW-RPT-TYPE-ID.
  3557     MOVE AM-NAME      TO SW-NAME.
  3558     MOVE AM-ADDRS     TO SW-ADDRS.
  3559     MOVE SPACES       TO SW-CITY.
  3560     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3561        DELIMITED BY '  ' INTO SW-CITY
  3562     END-STRING
  3563     MOVE AM-ZIP       TO SW-ZIP.
  3564     MOVE AM-EXPIRE-DT TO SW-EXP-DT.
  3565     MOVE AM-EFFECT-DT TO SW-EFF-DT.
  3566
  3567     IF PA-EP (4) NOT EQUAL ZEROS
  3568        COMPUTE LIFE-RETENT ROUNDED =
  3569            PA-PE (4) / PA-EP (4)
  3570     ELSE
  3571        MOVE +0.0      TO LIFE-RETENT.
  3572
  3573     IF PA-EP (5) NOT EQUAL ZEROS
  3574        COMPUTE AH-RETENT  ROUNDED =
  3575            PA-PE (5) / PA-EP (5)
  3576     ELSE
  3577        MOVE +0.0      TO AH-RETENT.
  3578
  3579     MOVE LIFE-RETENT  TO SW-LRET.
  3580     MOVE AH-RETENT    TO SW-ARET.
  3581     MOVE AM-RET-Y-N   TO SW-RET-Y-N.
  3582     MOVE AM-RET-P-E   TO SW-RET-TYP.
  3583     MOVE AM-RETRO-PREM-P-E TO SW-PREM-P-E.
  3584     MOVE AM-RETRO-CLMS-P-I TO SW-CLMS-P-I.
  3585     MOVE AM-RETRO-QUALIFY-LIMIT   TO SW-RETRO-LIMIT.
  3586     MOVE PRINT-ACCUMS-R (1) TO SW-ACCUMS.
  3587     MOVE AM-CARRIER   TO SW-CARR.
  3588     MOVE AM-GROUPING  TO SW-COMP.
  3589     MOVE AM-STATE     TO SW-STATE.
  3590     MOVE AM-ACCOUNT   TO SW-ACCT.
  3591     MOVE BEG-DATE     TO SW-BEG-DATE.
  3592
  3593 0310-EXIT.
  3594     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  74
* ECS043.cbl
  3595
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  75
* ECS043.cbl
  3597 0320-CONT-RETRO-A.
  3598     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  3599         RELEASE SW-REC-OUT FROM SW-REC
  3600         ADD +1 TO NO-OF-RECORDS-RELEASED.
  3601
  3602     IF AM-RETRO-POOL NOT = SPACES AND NOT = ZEROS
  3603         MOVE AM-RETRO-POOL TO SW-GA
  3604         MOVE 'B'           TO SW-RPT-TYPE-ID
  3605         IF DTE-CLIENT NOT = 'VSL'
  3606             RELEASE SW-REC-OUT FROM SW-REC
  3607             ADD +1 TO NO-OF-RECORDS-RELEASED
  3608         ELSE
  3609             IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  3610                 RELEASE SW-REC-OUT FROM SW-REC
  3611                 ADD +1 TO NO-OF-RECORDS-RELEASED.
  3612
  3613     IF DTE-CLIENT = 'TAO'
  3614         MOVE AM-USER-FIELDS TO Z-G
  3615         MOVE ZONE-GROUP     TO SW-GA
  3616         MOVE 'B'            TO SW-RPT-TYPE-ID
  3617         RELEASE SW-REC-OUT FROM SW-REC
  3618         ADD +1             TO NO-OF-RECORDS-RELEASED.
  3619
  3620     MOVE ZEROS TO DA-ISC-ADDL (1) DA-CNC-ADDL (1) DA-UC-ADDL (1)
  3621                   DA-ISC-ADDL (2) DA-CNC-ADDL (2) DA-UC-ADDL (2)
  3622                   DA-ISC-ADDL (3) DA-CNC-ADDL (3) DA-UC-ADDL (3)
  3623                   DA-ISC-ADDL (4) DA-CNC-ADDL (4) DA-UC-ADDL (4).
  3624
  3625     PERFORM 0340-GA-EXT-LOOP THRU 0350-EXIT
  3626         VARYING CL FROM 1 BY 1 UNTIL CL GREATER EC-REC-MAX.
  3627
  3628     IF AM-GPCD = 98
  3629         MOVE AM-ACCOUNT  TO SW-GA
  3630         MOVE 'X'         TO SW-GA-FLAG
  3631         MOVE HIGH-VALUES TO SW-CARR SW-COMP SW-STATE
  3632         MOVE 'C'         TO SW-RPT-TYPE-ID
  3633         RELEASE SW-REC-OUT FROM SW-REC
  3634         ADD +1 TO NO-OF-RECORDS-RELEASED.
  3635
  3636     PERFORM 0550-ZERO-DA VARYING SA FROM 1 BY 1
  3637                          UNTIL SA GREATER 4.
  3638     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  3639                          UNTIL SB GREATER 6.
  3640     PERFORM 0570-ZERO-XDA VARYING CL FROM 1 BY 1
  3641                          UNTIL CL GREATER 10.
  3642
  3643 0330-EXIT.
  3644     EXIT.
  3645
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  76
* ECS043.cbl
  3647 0340-GA-EXT-LOOP.
  3648     IF XDA-GA-TYPE (CL) = 'O' OR 'P' OR 'G' OR 'B'
  3649         NEXT SENTENCE
  3650      ELSE
  3651         GO TO 0350-EXIT.
  3652
  3653     MOVE XDA-GA-ISC (CL, 1) TO DA-GA-ISC (1).
  3654     MOVE XDA-GA-ISC (CL, 2) TO DA-GA-ISC (2).
  3655     MOVE XDA-GA-ISC (CL, 3) TO DA-GA-ISC (3).
  3656     MOVE XDA-GA-ISC (CL, 4) TO DA-GA-ISC (4).
  3657     MOVE XDA-GA-CNC (CL, 1) TO DA-GA-CNC (1).
  3658     MOVE XDA-GA-CNC (CL, 2) TO DA-GA-CNC (2).
  3659     MOVE XDA-GA-CNC (CL, 3) TO DA-GA-CNC (3).
  3660     MOVE XDA-GA-CNC (CL, 4) TO DA-GA-CNC (4).
  3661     MOVE XDA-GA-UC  (CL, 1) TO DA-GA-UC  (1).
  3662     MOVE XDA-GA-UC  (CL, 2) TO DA-GA-UC  (2).
  3663     MOVE XDA-GA-UC  (CL, 3) TO DA-GA-UC  (3).
  3664     MOVE XDA-GA-UC  (CL, 4) TO DA-GA-UC  (4).
  3665
  3666     MOVE 3 TO SB.
  3667     PERFORM 0560-ZERO-PA.
  3668     MOVE 6 TO SB.
  3669     PERFORM 0560-ZERO-PA.
  3670     PERFORM 0300-CALC-RETRO-A THRU 0310-EXIT.
  3671     MOVE XDA-GA-NO (CL)         TO SW-GA.
  3672     MOVE 'C'                    TO SW-RPT-TYPE-ID.
  3673     RELEASE SW-REC-OUT FROM SW-REC.
  3674     ADD +1 TO NO-OF-RECORDS-RELEASED.
  3675
  3676 0350-EXIT.
  3677     EXIT.
  3678
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  77
* ECS043.cbl
  3680 0360-BUILD-DUMMY-GA.
  3681
  3682     MOVE SPACES       TO SW-REC.
  3683     MOVE -9999999     TO SW-RETRO-LIMIT.
  3684     MOVE 'X'          TO SW-GA-FLAG.
  3685     MOVE 'C'          TO SW-RPT-TYPE-ID.
  3686     MOVE AM-NAME      TO SW-NAME.
  3687     MOVE AM-ADDRS     TO SW-ADDRS.
  3688     MOVE SPACES       TO SW-CITY.
  3689     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3690        DELIMITED BY '  ' INTO SW-CITY
  3691     END-STRING
  3692     MOVE AM-ZIP       TO SW-ZIP.
  3693     MOVE AM-EXPIRE-DT TO SW-EXP-DT.
  3694     MOVE AM-EFFECT-DT TO SW-EFF-DT.
  3695
  3696     IF AM-RET-Y-N = ' '   OR  'N'
  3697         MOVE +1.0 TO SW-LRET SW-ARET
  3698     ELSE
  3699         COMPUTE SW-LRET = 1 - AM-LF-RET
  3700         COMPUTE SW-ARET = 1 - AM-AH-RET.
  3701
  3702     MOVE AM-RET-P-E         TO SW-RET-TYP.
  3703     MOVE PRINT-ACCUMS-R (6) TO SW-ACCUMS.
  3704     MOVE HIGH-VALUES        TO SW-CARR SW-COMP SW-STATE.
  3705     MOVE AM-ACCOUNT         TO SW-ACCT SW-GA.
  3706     RELEASE SW-REC-OUT FROM SW-REC.
  3707     ADD +1 TO NO-OF-RECORDS-RELEASED.
  3708
  3709 0370-EXIT.
  3710     EXIT.
  3711
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  78
* ECS043.cbl
  3713 0380-COMPUTE-YTD.
  3714     COMPUTE PA-NW (SC) = (DA-ISP (SB) - DA-CNP (SB)) -
  3715                          (DA-ISP (SA) - DA-CNP (SA)).
  3716
  3717     IF AM-RETRO-PREM-P-E = 'E'
  3718         MOVE DA-UP (SA) TO PA-BR (SC)
  3719         MOVE DA-UP (SB) TO PA-ER (SC).
  3720
  3721     COMPUTE PA-EP (SC) = PA-NW (SC) + PA-BR (SC) - PA-ER (SC).
  3722
  3723     COMPUTE PA-PE (SC) = DA-PCT-E-PREM (SB) - DA-PCT-E-PREM (SA).
  3724
  3725     COMPUTE PA-PL (SC) = DA-CLM (SB) - DA-CLM (SA).
  3726
  3727     IF AM-RETRO-CLMS-P-I = 'I'
  3728         MOVE DA-LRV (SA) TO PA-BLR (SC)
  3729         MOVE DA-LRV (SB) TO PA-ELR (SC).
  3730
  3731     IF DTE-CLIENT = 'ABL'
  3732         COMPUTE PA-BLR (SC) =   DA-LRV (SA) +
  3733         ((((DA-ISP (SB) - DA-ISP (SA)) -
  3734            (DA-CNP (SB) - DA-CNP (SA))) - DA-UP (SA)) * .25)
  3735         COMPUTE PA-ELR (SC) =   DA-LRV (SB) + (PA-EP (SC) * .25).
  3736
  3737     IF DTE-CLIENT = 'GIC'
  3738         IF SC = +1
  3739             COMPUTE PA-BLR (SC) =  PA-BR (SC) * .00
  3740             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .00
  3741         ELSE
  3742             COMPUTE PA-BLR (SC) =  PA-BR (SC) * .12
  3743             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .12.
  3744
  3745     IF AM-RET-MIN-LOSS-L NOT NUMERIC
  3746         MOVE +0 TO AM-RET-MIN-LOSS-L.
  3747
  3748     IF AM-RET-MIN-LOSS-A NOT NUMERIC
  3749         MOVE +0 TO AM-RET-MIN-LOSS-A.
  3750
  3751     IF SC = +1
  3752         COMPUTE WS-MIN-LOSS ROUNDED =
  3753            (PA-EP (SC) * AM-RET-MIN-LOSS-L) - PA-PL (SC)
  3754                                              + PA-BLR (SC)
  3755        ELSE
  3756         COMPUTE WS-MIN-LOSS ROUNDED =
  3757            (PA-EP (SC) * AM-RET-MIN-LOSS-A) - PA-PL (SC)
  3758                                              + PA-BLR (SC).
  3759     IF SC = +1
  3760         IF AM-RET-MIN-LOSS-L = ZERO
  3761            MOVE ZERO TO WS-MIN-LOSS.
  3762
  3763     IF SC = +2
  3764         IF AM-RET-MIN-LOSS-A = ZERO
  3765            MOVE ZERO TO WS-MIN-LOSS.
  3766
  3767     IF WS-MIN-LOSS GREATER PA-ELR (SC)
  3768         MOVE WS-MIN-LOSS TO PA-ELR (SC).
  3769
  3770     COMPUTE PA-TL (SC) = PA-PL (SC) - PA-BLR (SC) + PA-ELR (SC).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  79
* ECS043.cbl
  3771
  3772     COMPUTE PA-RC (SC) = ((DA-ISC (SB) - DA-CNC (SB)) -
  3773                           (DA-ISC (SA) - DA-CNC (SA))) +
  3774                          ((DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)) -
  3775                           (DA-ISC-ADDL (SA) - DA-CNC-ADDL (SA))).
  3776
  3777     COMPUTE PA-EC (SC) = PA-RC (SC) + (DA-UC (SA) - DA-UC (SB))
  3778                         + (DA-UC-ADDL (SA) - DA-UC-ADDL (SB)).
  3779
  3780     IF AM-RET-P-E = 'P'
  3781         MOVE PA-RC (SC) TO PA-CU (SC)
  3782      ELSE
  3783         MOVE PA-EC (SC) TO PA-CU (SC).
  3784
  3785     COMPUTE PA-OC (SC) = DA-OTC (SB) - DA-OTC (SA).
  3786     COMPUTE PA-TC (SC) = PA-CU (SC) + PA-OC (SC).
  3787     COMPUTE PA-CP (SC) = DA-CPS (SB) - DA-CPS (SA).
  3788
  3789     IF DTE-CLIENT = 'FLA'
  3790         COMPUTE PA-EX (SC) = PA-NW (SC) * .11
  3791      ELSE
  3792         COMPUTE PA-EX (SC) = DA-EXP (SB) - DA-EXP (SA).
  3793
  3794     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  3795         IF (AM-RET-P-E = 'P') OR (AM-RET-ST-TAX-USE = 'P')
  3796              IF SC = 1
  3797                 COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3798*                          (PA-NW (SC) * AM-REI-LF-TAX)
  3799                    (DA-TAX (SB) - DA-TAX (SA))
  3800               ELSE
  3801                 COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3802*                          (PA-NW (SC) * AM-REI-AH-TAX)
  3803                    (DA-TAX (SB) - DA-TAX (SA))
  3804          ELSE
  3805              IF PA-NW (SC) <> 0
  3806                 IF SC = 1
  3807                    COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3808*                             (PA-EP (SC) * AM-REI-LF-TAX)
  3809                       (PA-EP (SC) / PA-NW (SC)) *
  3810                       (DA-TAX (SB) - DA-TAX (SA))
  3811                  ELSE
  3812                    COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3813*                             (PA-EP (SC) * AM-REI-AH-TAX).
  3814                       (PA-EP (SC) / PA-NW (SC)) *
  3815                       (DA-TAX (SB) - DA-TAX (SA)).
  3816
  3817     COMPUTE PA-TE (SC) = PA-TL (SC) + PA-TC (SC)
  3818                          + PA-CP (SC) + PA-EX (SC).
  3819     COMPUTE PA-BA (SC) = PA-PE (SC) - PA-TE (SC).
  3820     COMPUTE PA-NTE (SC) = PA-TL (SC) + PA-TC (SC) + PA-EX (SC).
  3821     COMPUTE PA-NBA (SC) = PA-PE (SC) - PA-NTE (SC).
  3822     COMPUTE PA-GARC (SC) = (DA-GA-ISC (SB) - DA-GA-CNC (SB)) -
  3823                   (DA-GA-ISC (SA) - DA-GA-CNC (SA)).
  3824     COMPUTE PA-GAEC (SC) = PA-GARC (SC) + DA-GA-UC (SA) -
  3825                                        DA-GA-UC (SB).
  3826     PERFORM 0520-ADD-PA-LEVELS.
  3827
  3828 0390-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  80
* ECS043.cbl
  3829     EXIT.
  3830
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  81
* ECS043.cbl
  3832 0400-COMPUTE-ITD.
  3833     COMPUTE PA-NW (SC) = DA-ISP (SB) - DA-CNP (SB).
  3834
  3835     IF AM-RETRO-PREM-P-E = 'E'
  3836         MOVE DA-UP (SB)       TO PA-ER (SC).
  3837
  3838     COMPUTE PA-EP (SC) = PA-NW (SC) - PA-ER (SC).
  3839
  3840     MOVE DA-PCT-E-PREM (SB)   TO PA-PE (SC).
  3841
  3842     MOVE DA-CLM (SB)          TO PA-PL (SC).
  3843
  3844     IF AM-RETRO-CLMS-P-I = 'I'
  3845         MOVE DA-LRV (SB)      TO PA-ELR (SC).
  3846
  3847     IF DTE-CLIENT = 'ABL'
  3848         COMPUTE PA-ELR (SC) = DA-LRV (SB) + (PA-EP (SC) * .25).
  3849
  3850     IF DTE-CLIENT = 'GIC'
  3851         IF SC = +4
  3852             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .00
  3853         ELSE
  3854             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .12.
  3855
  3856     IF AM-RET-MIN-LOSS-L NOT NUMERIC
  3857         MOVE +0 TO AM-RET-MIN-LOSS-L.
  3858
  3859     IF AM-RET-MIN-LOSS-A NOT NUMERIC
  3860         MOVE +0 TO AM-RET-MIN-LOSS-A.
  3861
  3862     IF SC = +4
  3863         COMPUTE WS-MIN-LOSS ROUNDED =
  3864            (PA-EP (SC) * AM-RET-MIN-LOSS-L) - PA-PL (SC)
  3865     ELSE
  3866         COMPUTE WS-MIN-LOSS ROUNDED =
  3867            (PA-EP (SC) * AM-RET-MIN-LOSS-A) - PA-PL (SC).
  3868
  3869     IF SC = +4
  3870         IF AM-RET-MIN-LOSS-L = ZERO
  3871            MOVE ZERO TO WS-MIN-LOSS.
  3872
  3873     IF SC = +5
  3874         IF AM-RET-MIN-LOSS-A = ZERO
  3875            MOVE ZERO TO WS-MIN-LOSS.
  3876
  3877     IF WS-MIN-LOSS GREATER PA-ELR (SC)
  3878         MOVE WS-MIN-LOSS TO PA-ELR (SC).
  3879
  3880     COMPUTE PA-TL (SC) = PA-PL (SC) + PA-ELR (SC).
  3881
  3882
  3883     COMPUTE PA-RC (SC) = (DA-ISC (SB) - DA-CNC (SB)) +
  3884                          (DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)).
  3885     COMPUTE PA-EC (SC) =
  3886                  PA-RC (SC) - DA-UC (SB) - DA-UC-ADDL (SB).
  3887
  3888     IF AM-RET-P-E = 'P'
  3889         MOVE PA-RC (SC) TO PA-CU (SC)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  82
* ECS043.cbl
  3890     ELSE
  3891         MOVE PA-EC (SC) TO PA-CU (SC).
  3892
  3893     MOVE DA-OTC (SB) TO PA-OC (SC).
  3894     COMPUTE PA-TC (SC) = PA-CU (SC) + PA-OC (SC).
  3895     MOVE DA-CPS (SB) TO PA-CP (SC).
  3896
  3897     IF DTE-CLIENT = 'FLA'
  3898        COMPUTE PA-EX (SC) = PA-NW (SC) * .11
  3899     ELSE
  3900        MOVE DA-EXP (SB) TO PA-EX (SC)
  3901     END-IF
  3902
  3903*    MOVE 'P' TO AM-RET-ST-TAX-USE
  3904*    MOVE 'P' TO AM-RET-P-E
  3905     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  3906        IF (AM-RET-P-E = 'P') OR (AM-RET-ST-TAX-USE = 'P')
  3907           IF SC = 4
  3908              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3909*                (PA-NW (SC) * AM-REI-LF-TAX)
  3910                 DA-TAX (SB)
  3911           ELSE
  3912              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3913*                (PA-NW (SC) * AM-REI-AH-TAX)
  3914                 DA-TAX (SB)
  3915           END-IF
  3916        ELSE
  3917          IF PA-NW (SC) <> 0
  3918           IF SC = 4
  3919              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3920*                (PA-EP (SC) * AM-REI-LF-TAX)
  3921                 ((PA-EP (SC) / PA-NW (SC)) * DA-TAX (SB))
  3922           ELSE
  3923              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3924*                (PA-EP (SC) * AM-REI-AH-TAX).
  3925                 ((PA-EP (SC) / PA-NW (SC)) * DA-TAX (SB))
  3926           END-IF
  3927          END-IF
  3928        END-IF
  3929     END-IF
  3930
  3931     COMPUTE PA-TE (SC) = PA-TL (SC) + PA-TC (SC)
  3932                        + PA-CP (SC) + PA-EX (SC).
  3933     COMPUTE PA-BA (SC) = PA-PE (SC) - PA-TE (SC).
  3934     COMPUTE PA-NTE (SC) = PA-TL (SC) + PA-TC (SC) + PA-EX (SC).
  3935     COMPUTE PA-NBA (SC) = PA-PE (SC) - PA-NTE (SC).
  3936     COMPUTE PA-GARC (SC) = DA-GA-ISC (SB) - DA-GA-CNC (SB).
  3937     COMPUTE PA-GAEC (SC) = PA-GARC (SC) - DA-GA-UC (SB).
  3938
  3939     PERFORM 0520-ADD-PA-LEVELS.
  3940
  3941 0410-EXIT.
  3942     EXIT.
  3943
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  83
* ECS043.cbl
  3945 0420-CALCULATE-GA.
  3946     COMPUTE PA-PE (SC) ROUNDED = PA-EP (SC) * RETENT-FACT.
  3947
  3948     IF SAVE-RET-TYP = 'E'
  3949         MOVE PA-GAEC (SC) TO PA-GACU (SC)
  3950     ELSE
  3951         MOVE PA-GARC (SC) TO PA-GACU (SC).
  3952
  3953     COMPUTE PA-GATC (SC) = PA-TC (SC) + PA-GACU (SC).
  3954     COMPUTE PA-GATE (SC) = PA-NTE (SC) + PA-GACU (SC).
  3955     COMPUTE PA-GABA (SC) = PA-PE (SC) - PA-GATE (SC).
  3956     COMPUTE PA-GAGT (SC) = PA-GABA (SC) - PA-CP (SC)
  3957                                      - PA-NBA (SC).
  3958     ADD PA-GACU (SC) TO PA-GACU (SF).
  3959     ADD PA-GATC (SC) TO PA-GATC (SF).
  3960     ADD PA-GATE (SC) TO PA-GATE (SF).
  3961     ADD PA-GABA (SC) TO PA-GABA (SF).
  3962     ADD PA-GAGT (SC) TO PA-GAGT (SF).
  3963
  3964 0430-EXIT.
  3965
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  84
* ECS043.cbl
  3967 0440-GENERATE-RETRO.
  3968     IF DTE-PGM-OPT = '1'
  3969         AND H1-REPORT-SUF NOT = 'A'
  3970     OR DTE-PGM-OPT = '2'
  3971         AND H1-REPORT-SUF NOT = 'B'
  3972     OR DTE-PGM-OPT = '3'
  3973         AND H1-REPORT-SUF NOT = 'C'
  3974             GO TO 0470-EXIT.
  3975
  3976     IF DTE-PGM-OPT = ('5' OR '6' OR '7') AND
  3977        H1-REPORT-SUF NOT = ('A' AND 'B')
  3978          GO TO 0470-EXIT.
  3979
  3980     PERFORM 0580-ZERO-PCNT VARYING SB FROM 1 BY 1
  3981                            UNTIL SB GREATER 2
  3982       AFTER SC FROM 1 BY 1 UNTIL SC GREATER 27.
  3983
  3984     MOVE +1 TO SE.
  3985     PERFORM 0480-COMPUTE-PERCENTS THRU 0490-EXIT.
  3986     MOVE +2 TO SE.
  3987     ADD +3 TO SF.
  3988
  3989     PERFORM 0480-COMPUTE-PERCENTS THRU 0490-EXIT.
  3990     PERFORM 0590-HEADING-ROUTINE  THRU 0600-EXIT.
  3991
  3992     IF HEAD-SW = '1' OR '2'
  3993         IF SAVE-RET-TYP = 'E'
  3994             MOVE '  1. EARNED '         TO DT-ENTRY (13)
  3995         ELSE
  3996             MOVE '  1. RETAINED '       TO DT-ENTRY (13)
  3997     ELSE
  3998         MOVE '  1. ACCOUNT COMMISSION ' TO DT-ENTRY (13).
  3999
  4000     MOVE +1 TO SB.
  4001
  4002 0450-PRINT-LOOP.
  4003     IF DT-SS-R (SB SH) = SPACES
  4004         GO TO 0460-CHECK-NEXT-LINE.
  4005
  4006     IF DT-SS-R (SB SH) = '00'
  4007         MOVE DT-CTL-CHAR (SB) TO X
  4008         MOVE DT-ENTRY (SB)    TO DL-DESC
  4009         MOVE DETAIL-LINE      TO P-DATA
  4010         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  4011         GO TO 0460-CHECK-NEXT-LINE.
  4012
  4013     MOVE DT-CTL-CHAR (SB) TO X.
  4014     MOVE DT-SS (SB SH)    TO SA.
  4015
  4016     PERFORM 0500-PRINT-DETAIL THRU 0510-EXIT.
  4017
  4018 0460-CHECK-NEXT-LINE.
  4019     ADD +1 TO SB.
  4020     IF DT-CTL-CHAR (SB) NOT = HIGH-VALUES
  4021         GO TO 0450-PRINT-LOOP.
  4022
  4023     MOVE '-'    TO X.
  4024     MOVE SPACES TO P-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  85
* ECS043.cbl
  4025     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4026*    IF (DTE-FMT-OPT  =  2)        AND
  4027*       (BREAK-1-SWITCH NOT = ' ')   AND
  4028*       (H1-REPORT-SUF = 'A')
  4029*       NEXT SENTENCE
  4030*    ELSE
  4031*       ADD 1 TO PAGE-CNT.
  4032*    MOVE PAGE-CNT TO H9-PAGE.
  4033*    MOVE HEAD-9   TO P-DATA.
  4034*    PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4035
  4036 0470-EXIT.
  4037     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  86
* ECS043.cbl
  4039
  4040 0480-COMPUTE-PERCENTS.
  4041     IF PA-EP (SF) = ZERO
  4042         GO TO 0490-EXIT.
  4043
  4044     COMPUTE PT-PRCNT (SE 5) ROUNDED =
  4045         PA-PE (SF) / PA-EP (SF).
  4046     COMPUTE PT-PRCNT (SE 9) ROUNDED =
  4047         PA-TL (SF) / PA-EP (SF).
  4048     COMPUTE PT-PRCNT (SE 12) ROUNDED =
  4049         PA-TC (SF) / PA-EP (SF).
  4050
  4051     IF DTE-CLIENT = 'TAO'  AND  PA-NW (SF) NOT = ZERO
  4052         COMPUTE PT-PRCNT (SE 12) ROUNDED =
  4053             PA-TC (SF) / PA-NW (SF).
  4054
  4055     COMPUTE PT-PRCNT (SE 13) ROUNDED =
  4056         PA-CP (SF) / PA-EP (SF).
  4057     COMPUTE PT-PRCNT (SE 14) ROUNDED =
  4058         PA-EX (SF) / PA-EP (SF).
  4059     COMPUTE PT-PRCNT (SE 16) ROUNDED =
  4060         PA-BA (SF) / PA-EP (SF).
  4061     COMPUTE PT-PRCNT (SE 17) ROUNDED =
  4062         PA-NTE (SF) / PA-EP (SF).
  4063     COMPUTE PT-PRCNT (SE 18) ROUNDED =
  4064         PA-NBA (SF) / PA-EP (SF).
  4065     COMPUTE PT-PRCNT (SE 24) ROUNDED =
  4066         PA-GATC (SF) / PA-EP (SF).
  4067     COMPUTE PT-PRCNT (SE 25) ROUNDED =
  4068         PA-GAGT (SF) / PA-EP (SF).
  4069     COMPUTE PT-PRCNT (SE 26) ROUNDED =
  4070         PA-GABA (SF) / PA-EP (SF).
  4071     COMPUTE PT-PRCNT (SE 27) ROUNDED =
  4072         PA-GATE (SF) / PA-EP (SF).
  4073
  4074     COMPUTE PT-PRCNT (SE 5)  =  PT-PRCNT (SE 5)  * +100.
  4075     COMPUTE PT-PRCNT (SE 9)  =  PT-PRCNT (SE 9)  * +100.
  4076     COMPUTE PT-PRCNT (SE 12) =  PT-PRCNT (SE 12) * +100.
  4077     COMPUTE PT-PRCNT (SE 13) =  PT-PRCNT (SE 13) * +100.
  4078     COMPUTE PT-PRCNT (SE 14) =  PT-PRCNT (SE 14) * +100.
  4079     COMPUTE PT-PRCNT (SE 16) =  PT-PRCNT (SE 16) * +100.
  4080     COMPUTE PT-PRCNT (SE 17) =  PT-PRCNT (SE 17) * +100.
  4081     COMPUTE PT-PRCNT (SE 18) =  PT-PRCNT (SE 18) * +100.
  4082     COMPUTE PT-PRCNT (SE 24) =  PT-PRCNT (SE 24) * +100.
  4083     COMPUTE PT-PRCNT (SE 25) =  PT-PRCNT (SE 25) * +100.
  4084     COMPUTE PT-PRCNT (SE 26) =  PT-PRCNT (SE 26) * +100.
  4085     COMPUTE PT-PRCNT (SE 27) =  PT-PRCNT (SE 27) * +100.
  4086
  4087 0490-EXIT.
  4088     EXIT.
  4089
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  87
* ECS043.cbl
  4091 0500-PRINT-DETAIL.
  4092     MOVE PA-AMT (SG 1 SA) TO DL-YLF.
  4093     MOVE PA-AMT (SG 2 SA) TO DL-YAH.
  4094     MOVE PA-AMT (SG 3 SA) TO DL-YT.
  4095     MOVE PT-PRCNT (1 SA)  TO DL-YPT.
  4096     MOVE DT-ENTRY (SB)    TO DL-DESC.
  4097     MOVE PA-AMT (SG 4 SA) TO DL-ILF.
  4098     MOVE PA-AMT (SG 5 SA) TO DL-IAH.
  4099     MOVE PA-AMT (SG 6 SA) TO DL-IT.
  4100     MOVE PT-PRCNT (2 SA)  TO DL-IPT.
  4101     MOVE DETAIL-LINE      TO P-DATA.
  4102     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4103     MOVE SPACES           TO DETAIL-LINE  P-DATA.
  4104
  4105 0510-EXIT.
  4106     EXIT.
  4107
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  88
* ECS043.cbl
  4109 0520-ADD-PA-LEVELS.
  4110     ADD PA-NW   (SC) TO PA-NW   (SF).
  4111     ADD PA-BR   (SC) TO PA-BR   (SF).
  4112     ADD PA-ER   (SC) TO PA-ER   (SF).
  4113     ADD PA-EP   (SC) TO PA-EP   (SF).
  4114     ADD PA-PE   (SC) TO PA-PE   (SF).
  4115     ADD PA-PL   (SC) TO PA-PL   (SF).
  4116     ADD PA-BLR  (SC) TO PA-BLR  (SF).
  4117     ADD PA-ELR  (SC) TO PA-ELR  (SF).
  4118     ADD PA-TL   (SC) TO PA-TL   (SF).
  4119     ADD PA-RC   (SC) TO PA-RC   (SF).
  4120     ADD PA-OC   (SC) TO PA-OC   (SF).
  4121     ADD PA-TC   (SC) TO PA-TC   (SF).
  4122     ADD PA-CP   (SC) TO PA-CP   (SF).
  4123     ADD PA-EX   (SC) TO PA-EX   (SF).
  4124     ADD PA-TE   (SC) TO PA-TE   (SF).
  4125     ADD PA-BA   (SC) TO PA-BA   (SF).
  4126     ADD PA-NTE  (SC) TO PA-NTE  (SF).
  4127     ADD PA-NBA  (SC) TO PA-NBA  (SF).
  4128     ADD PA-EC   (SC) TO PA-EC   (SF).
  4129     ADD PA-GARC (SC) TO PA-GARC (SF).
  4130     ADD PA-GAEC (SC) TO PA-GAEC (SF).
  4131     ADD PA-GACU (SC) TO PA-GACU (SF).
  4132     ADD PA-CU   (SC) TO PA-CU   (SF).
  4133     ADD PA-GATC (SC) TO PA-GATC (SF).
  4134     ADD PA-GAGT (SC) TO PA-GAGT (SF).
  4135     ADD PA-GABA (SC) TO PA-GABA (SF).
  4136     ADD PA-GATE (SC) TO PA-GATE (SF).
  4137
  4138 0530-ADD-UP-LEVELS.
  4139     PERFORM 0520-ADD-PA-LEVELS.
  4140     ADD +1 TO SC
  4141               SF.
  4142
  4143 0540-EXIT.
  4144     EXIT.
  4145
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  89
* ECS043.cbl
  4147 0550-ZERO-DA.
  4148     MOVE +0 TO DA-ISP (SA)  DA-CNP (SA)  DA-UP (SA)   DA-UC (SA)
  4149                DA-TAX (SA)
  4150                DA-CLM (SA)  DA-EXP (SA)  DA-CPS (SA)  DA-OTC (SA)
  4151                DA-LRV (SA)  DA-CAJ (SA)  DA-ISC (SA)  DA-CNC (SA)
  4152                DA-ISC-ADDL (SA) DA-CNC-ADDL (SA) DA-UC-ADDL (SA)
  4153                DA-GA-ISC (SA)   DA-GA-CNC (SA)   DA-GA-UC (SA)
  4154                DA-PCT-E-PREM (SA).
  4155
  4156 0560-ZERO-PA.
  4157     MOVE +0 TO PA-NW (SB)  PA-BR (SB) PA-ER (SB)  PA-EP (SB)
  4158                PA-PE (SB)  PA-PL (SB) PA-BLR (SB) PA-ELR (SB)
  4159                PA-TL (SB)  PA-RC (SB) PA-OC (SB)  PA-TC (SB)
  4160                PA-CP (SB)  PA-EX (SB) PA-TE (SB)  PA-BA (SB)
  4161                PA-NTE (SB) PA-NBA (SB)   PA-EC (SB)
  4162                PA-GARC (SB)  PA-GAEC (SB)  PA-GACU (SB)
  4163                PA-GATC (SB)  PA-GAGT (SB)  PA-GABA (SB)
  4164                PA-GATE (SB)  PA-CU (SB).
  4165
  4166 0570-ZERO-XDA.
  4167
  4168     PERFORM 0575-ZERO-XDA VARYING SA FROM 1 BY 1
  4169                           UNTIL SA GREATER THAN 4.
  4170
  4171 0575-ZERO-XDA.
  4172
  4173     MOVE SPACES                 TO  XDA-GA-NO (CL)
  4174                                     XDA-GA-TYPE (CL).
  4175     MOVE ZEROS                  TO  XDA-GA-ISC (CL SA)
  4176                                     XDA-GA-CNC (CL SA)
  4177                                     XDA-GA-UC  (CL SA).
  4178
  4179 0580-ZERO-PCNT.
  4180     MOVE +0 TO PT-PRCNT (SB SC).
  4181
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  90
* ECS043.cbl
  4183 0590-HEADING-ROUTINE.
  4184     IF DTE-PGM-OPT = '1'
  4185         AND H1-REPORT-SUF NOT = 'A'
  4186     OR DTE-PGM-OPT = '2'
  4187         AND H1-REPORT-SUF NOT = 'B'
  4188     OR DTE-PGM-OPT = '3'
  4189         AND H1-REPORT-SUF NOT = 'C'
  4190             GO TO 0600-EXIT.
  4191
  4192     IF DTE-PGM-OPT = ('5' OR '6' OR '7') AND
  4193        H1-REPORT-SUF NOT = ('A' AND 'B')
  4194        GO TO 0600-EXIT.
  4195
  4196     MOVE '1'    TO X.
  4197     MOVE HEAD-1 TO P-DATA.
  4198     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4199     MOVE ' '    TO X.
  4200     MOVE HEAD-2 TO P-DATA.
  4201     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4202     ADD +1               TO PAGE-CNT.
  4203     MOVE PAGE-CNT        TO H3-PAGE.
  4204     MOVE HEAD-3 TO P-DATA.
  4205     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4206
  4207     IF HEAD-SW = '1' OR '2'
  4208         MOVE '0'    TO X
  4209         MOVE HEAD-4 TO P-DATA
  4210         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  4211         MOVE ' '    TO X
  4212         MOVE HEAD-5 TO P-DATA
  4213         PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4214
  4215     MOVE '0' TO X.
  4216     IF DTE-PGM-OPT = '7'
  4217         IF HEAD-SW NOT = '1' AND '2'
  4218             MOVE '* CONTRACT TO DATE *' TO H6-YTD-HD
  4219         ELSE
  4220             MOVE BD-MO     TO H6R-MO
  4221             MOVE BD-DA     TO H6R-DA
  4222             MOVE BD-CCYY   TO H6R-CCYY
  4223             MOVE '-'       TO H6R-DASH1 H6R-DASH2
  4224             MOVE ' TO DATE '       TO H6R-MSG
  4225             MOVE ' '       TO H6R-FILLER.
  4226
  4227     MOVE HEAD-6 TO P-DATA.
  4228     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4229     MOVE ' '    TO X.
  4230     MOVE HEAD-7 TO P-DATA.
  4231     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4232     MOVE '0'    TO X.
  4233
  4234 0600-EXIT.
  4235     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  91
* ECS043.cbl
  4237
  4238 0610-PRT-RTN.
  4239****  THE FOLLOWING CLIENT CODING SUPPRESSES DATE BREAKS ON '43A'.
  4240
  4241     IF (DTE-FMT-OPT  =  2)        AND
  4242        (BREAK-1-SWITCH NOT = ' ')   AND
  4243        (H1-REPORT-SUF = 'A')
  4244             MOVE SPACES TO P-DATA  DETAIL-LINE
  4245             GO TO 0630-EXIT.
  4246
  4247 0620-PRT-REST.
  4248*                            COPY ELCPRT2.
* 4249                             COPY PRTN043.
  4250******************************************************************
  4251*                                                                *
  4252*  THIS IS A CSO VERSION OF COPYBOOK ELCPRTN TO ALLOW INDIVIDUAL *
  4253*  CHANGES FOR DELETING PAPER PRINT OF ECS043A.     (CSOMOD #759)*
  4254*  ALL REPORTS WILL STILL GO TO FICH.                            *
  4255*                                                                *
  4256******************************************************************
  4257*                                                                *
  4258*                            ELCPRTN                             *
  4259*                            VMOD=2.002                          *
  4260*                                                                *
  4261******************************************************************
  4262*                   C H A N G E   L O G
  4263*
  4264* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4265*-----------------------------------------------------------------
  4266*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4267* EFFECTIVE    NUMBER
  4268*-----------------------------------------------------------------
  4269* 061302    2002061200004  SMVA  REMOVE ECS043B HARDCOPY
  4270******************************************************************
  4271
  4272     IF DTE-FICH NOT = SPACE AND
  4273        FICH-OPEN    = SPACE
  4274         MOVE 'X' TO FICH-OPEN
  4275         OPEN OUTPUT FICH.
  4276
  4277     IF DTE-FICH NOT = SPACE
  4278         MOVE X TO P-CTL
  4279         WRITE FICH-REC FROM PRT.
  4280
  4281     IF H1-REPORT-SUF = 'A' OR 'B' OR 'C'
  4282         GO TO SKIP-A-REPORT.
  4283
  4284     IF DTE-FICH = SPACE OR '2'
  4285       MOVE X                    TO  P-CTL
  4286       IF P-CTL = ' '
  4287         WRITE PRT AFTER ADVANCING 1 LINE
  4288       ELSE
  4289         IF P-CTL = '0'
  4290           WRITE PRT AFTER ADVANCING 2 LINES
  4291         ELSE
  4292           IF P-CTL = '-'
  4293             WRITE PRT AFTER ADVANCING 3 LINES
  4294           ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  92
* ECS043.cbl (/apps/prod/cid1p/copy/PRTN043)
  4295             WRITE PRT AFTER ADVANCING PAGE.
  4296
  4297******************************************************************
  4298
  4299******************************************************************
  4300 SKIP-A-REPORT.
  4301     MOVE SPACES TO P-DATA  DETAIL-LINE.
  4302
  4303 0630-EXIT.
  4304     EXIT.
  4305
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  93
* ECS043.cbl
  4307 0640-EP-ADD.
  4308     ADD EP-ISS-PRM TO DA-ISP (SA).
  4309     IF EP-PRM-TAX NUMERIC
  4310        ADD EP-PRM-TAX TO DA-TAX (SA).
  4311     ADD EP-CNC-PRM TO DA-CNP (SA).
  4312     ADD EP-CLM-AMT TO DA-CLM (SA).
  4313     ADD EP-CLM-DU TO DA-LRV (SA).
  4314
  4315     IF DTE-CLIENT NOT = 'ABL'
  4316         ADD EP-CLM-IBNR TO DA-LRV (SA).
  4317
  4318     ADD EP-LOSS-RESV TO DA-LRV (SA).
  4319     ADD EP-CLAIM-ADJ TO DA-CAJ (SA).
  4320
  4321     IF DTE-CLIENT = 'ABL'
  4322         ADD EP-CLAIM-ADJ TO DA-CLM (SA).
  4323
  4324*    PERFORM 0650-EP-EARN-TYPE THRU 0680-EXIT.
  4325
  4326     MOVE DA-UP (SA) TO SAVE-DA-UP.
  4327     MOVE 0                    TO SAVE-DA-PCT-UP.
  4328
  4329     IF WS-EP-CODE = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  4330         COMPUTE SAVE-DA-PCT-UP =
  4331                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-78)
  4332         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4333                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-78).
  4334
  4335     IF WS-EP-CODE = 'P'
  4336         COMPUTE SAVE-DA-PCT-UP =
  4337                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-PR)
  4338         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4339                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-PR).
  4340
  4341     IF (WS-EP-CODE = 'B' OR 'K' OR 'L')
  4342         COMPUTE SAVE-DA-PCT-UP =
  4343                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-ST)
  4344         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4345                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-ST).
  4346
  4347     IF WS-EP-CODE = 'M'
  4348         COMPUTE SAVE-DA-PCT-UP =
  4349             ((EP-ISS-PRM - EP-CNC-PRM) -
  4350               ((EP-PRM-PR + EP-PRM-78) * .5))
  4351         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4352             ((EP-ISS-PRM - EP-CNC-PRM) -
  4353               ((EP-PRM-PR + EP-PRM-78) * .5)).
  4354
  4355     IF WS-EP-CODE = '1'
  4356         COMPUTE SAVE-DA-PCT-UP =
  4357             ((EP-ISS-PRM - EP-CNC-PRM) -
  4358              ((EP-PRM-PR * +.6667) + (EP-PRM-78 * +.3333)))
  4359         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4360             ((EP-ISS-PRM - EP-CNC-PRM) -
  4361              ((EP-PRM-PR * +.6667) + (EP-PRM-78 * +.3333))).
  4362
  4363     IF WS-EP-CODE = '2'
  4364         COMPUTE SAVE-DA-PCT-UP =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  94
* ECS043.cbl
  4365             ((EP-ISS-PRM - EP-CNC-PRM) -
  4366              ((EP-PRM-PR * +.80) + (EP-PRM-78 * +.20)))
  4367         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4368             ((EP-ISS-PRM - EP-CNC-PRM) -
  4369              ((EP-PRM-PR * +.80) + (EP-PRM-78 * +.20))).
  4370
  4371     IF AM-RETRO-PREM-P-E = 'E'
  4372         COMPUTE SAVE-DA-PCT-E-PREM  ROUNDED  =
  4373             (EP-ISS-PRM - EP-CNC-PRM - SAVE-DA-PCT-UP)
  4374                                                 * RETENT-FACT
  4375     ELSE
  4376         COMPUTE SAVE-DA-PCT-E-PREM  ROUNDED  =
  4377                       (EP-ISS-PRM - EP-CNC-PRM) * RETENT-FACT.
  4378
  4379     ADD SAVE-DA-PCT-E-PREM      TO DA-PCT-E-PREM (SA).
  4380
  4381 0640-EXIT.
  4382     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  95
* ECS043.cbl
  4384
  4385 0650-EP-EARN-TYPE.
  4386     MOVE CLAS-STARTS TO CLAS-INDEXS.
  4387
  4388 0652-ST-LOOK-UP.
  4389     IF AM-STATE = STATE-SUB (CLAS-INDEXS)
  4390         NEXT SENTENCE
  4391      ELSE
  4392          ADD +1 TO CLAS-INDEXS
  4393          IF CLAS-INDEXS NOT GREATER CLAS-MAXS
  4394              GO TO 0652-ST-LOOK-UP
  4395           ELSE
  4396             DISPLAY ' INVALID STATE CODE -' AM-STATE
  4397             MOVE    ' INVALID STATE CODE -' TO WS-ABEND-MESSAGE
  4398             MOVE 0402      TO WS-RETURN-CODE
  4399             GO TO ABEND-PGM.
  4400
  4401     IF EP-RCD-TYPE = AH-OVERRIDE-L1
  4402         MOVE CLAS-STARTA TO CLAS-INDEXA
  4403         GO TO 0670-EP-EARN-AH.
  4404
  4405     MOVE CLAS-STARTL TO CLAS-INDEXL.
  4406
  4407 0660-EP-EARN-TYPE-LOOP.
  4408     IF (CLAS-INDEXL GREATER CLAS-MAXL) OR (CLAS-INDEXL = ZERO)
  4409         DISPLAY ' INVALID LIFE BENEFIT TYPE -' EP-BEN-CODE
  4410         MOVE ' INVALID LIFE BENEFIT TYPE -' TO WS-ABEND-MESSAGE
  4411         MOVE 0401            TO WS-RETURN-CODE
  4412         GO TO ABEND-PGM.
  4413
  4414     IF EP-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXL)
  4415         ADD +1 TO CLAS-INDEXL
  4416         GO TO 0660-EP-EARN-TYPE-LOOP.
  4417
  4418     MOVE CLAS-I-EP (CLAS-INDEXL) TO WS-EP-CODE.
  4419
  4420     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  4421          MOVE 'P' TO WS-EP-CODE.
  4422
  4423     IF DTE-CLIENT = 'ITG'
  4424          MOVE 'P' TO WS-EP-CODE.
  4425
  4426     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  4427       AND (AM-RET-EARN-R NOT = SPACE AND ZERO)
  4428           MOVE AM-RET-EARN-R TO WS-EP-CODE.
  4429     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  4430       AND (AM-RET-EARN-L NOT = SPACE AND ZERO)
  4431           MOVE AM-RET-EARN-L TO WS-EP-CODE.
  4432
  4433     MOVE CLAS-I-BAL (CLAS-INDEXL) TO WS-OB-CODE.
  4434
  4435     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  4436       AND (SA = 1 OR 2)
  4437       AND (AM-RET-BEG-EARN-R NOT = SPACE AND ZERO)
  4438           MOVE AM-RET-BEG-EARN-R TO WS-EP-CODE.
  4439
  4440     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  4441       AND (SA = 1 OR 2)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  96
* ECS043.cbl
  4442       AND (AM-RET-BEG-EARN-L NOT = SPACE AND ZERO)
  4443           MOVE AM-RET-BEG-EARN-L TO WS-EP-CODE.
  4444
  4445     GO TO 0680-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  97
* ECS043.cbl
  4447
  4448 0670-EP-EARN-AH.
  4449     IF (CLAS-INDEXA GREATER CLAS-MAXA) OR (CLAS-INDEXA = ZERO)
  4450         DISPLAY ' INVALID A&H BENEFIT TYPE -' EP-BEN-CODE
  4451         MOVE    ' INVALID A&H BENEFIT TYPE -' TO WS-ABEND-MESSAGE
  4452         MOVE 0402         TO WS-RETURN-CODE
  4453         GO TO ABEND-PGM.
  4454
  4455     IF EP-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXA)
  4456         ADD +1 TO CLAS-INDEXA
  4457         GO TO 0670-EP-EARN-AH.
  4458
  4459     MOVE CLAS-I-EP (CLAS-INDEXA) TO WS-EP-CODE.
  4460
  4461     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  4462          MOVE 'P' TO WS-EP-CODE.
  4463
  4464     IF DTE-CLIENT = 'ITG'
  4465          MOVE 'P' TO WS-EP-CODE.
  4466
  4467     IF CLAS-I-RL-AH (CLAS-INDEXA) = 'A'
  4468       AND (AM-RET-EARN-A NOT = SPACE AND ZERO)
  4469           MOVE AM-RET-EARN-A TO WS-EP-CODE.
  4470
  4471     IF CLAS-I-RL-AH (CLAS-INDEXA) = 'A'
  4472       AND (SA = 1 OR 2)
  4473       AND (AM-RET-BEG-EARN-A NOT = SPACE AND ZERO)
  4474           MOVE AM-RET-BEG-EARN-A TO WS-EP-CODE.
  4475
  4476     IF DTE-CLIENT = 'ITY'
  4477         IF EP-CARRIER = '5' OR '7'
  4478              MOVE '1' TO WS-EP-CODE.
  4479
  4480     IF DTE-CLIENT = 'GIC'
  4481         IF CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'
  4482              MOVE '2' TO WS-EP-CODE.
  4483
  4484     IF DTE-CLIENT = 'AN1' OR 'TFS' OR 'NIS' OR
  4485                     'UW1' OR 'DDB' OR 'GSL'
  4486         MOVE 'M'                  TO WS-EP-CODE.
  4487
  4488     MOVE CLAS-I-BAL (CLAS-INDEXA) TO WS-OB-CODE.
  4489
  4490 0680-EXIT.
  4491     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  98
* ECS043.cbl
  4493
  4494 0690-EC-ADD.
  4495     PERFORM 0700-ACCT-EC-ADD  THRU 0710-EXIT
  4496         VARYING CL FROM 1 BY 1 UNTIL CL GREATER THAN +5.
  4497
  4498     GO TO 0729-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  99
* ECS043.cbl
  4500
  4501 0700-ACCT-EC-ADD.
  4502******************************************************************
  4503*         CL - AGENT LEVEL WITHIN EC RECORD
  4504*         AL - AGENT LEVEL WITHIN GA TABLE
  4505*         SA - BEGINNING / CURRENT   LIFE/AH INDICATOR
  4506******************************************************************
  4507
  4508     IF EC-AGT-NO (CL) = ZEROS
  4509         GO TO 0710-EXIT.
  4510
  4511     IF EC-SEQ-NBR GREATER THAN 1
  4512         MOVE EC-SEQ-NBR         TO  WS-SEQ-NBR
  4513         SUBTRACT +1 FROM WS-SEQ-NBR
  4514         COMPUTE AL = WS-SEQ-NBR * 5.
  4515
  4516     PERFORM 0725-CHECK-AM-RETRO  THRU  0725-EXIT.
  4517
  4518     IF WS-RETRO-FLAG = 'N'
  4519        GO TO 0710-EXIT.
  4520
  4521     MOVE +1                     TO  AL.
  4522
  4523 0700-LOOP.
  4524
  4525     IF EC-AGT-NO (CL) = XDA-GA-NO (AL)
  4526         GO TO 0705-ACCUM.
  4527
  4528     IF XDA-GA-NO (AL) = SPACES
  4529         MOVE EC-AGT-NO (CL)     TO  XDA-GA-NO (AL)
  4530         MOVE EC-AGT-TYPE (CL)   TO  XDA-GA-TYPE (AL)
  4531         GO TO 0705-ACCUM.
  4532
  4533     ADD +1 TO AL.
  4534
  4535     IF AL GREATER THAN EC-REC-MAX
  4536         MOVE 'NO OF EC RECORDS EXCEED TABLE LIMIT'
  4537                                 TO  WS-ABEND-MESSAGE
  4538         GO TO ABEND-PGM.
  4539
  4540     GO TO 0700-LOOP.
  4541
  4542 0705-ACCUM.
  4543
  4544     IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4545         ADD EC-ISS-COMM (CL) TO DA-ISC (SA)
  4546         ADD EC-CNC-COMM (CL) TO DA-CNC (SA).
  4547
  4548     IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4549         ADD EC-ISS-COMM (CL) TO XDA-GA-ISC (AL SA)
  4550         ADD EC-CNC-COMM (CL) TO XDA-GA-CNC (AL SA)
  4551*02281        IF AM-RETRO-LV-INDIC (AL) = 'A'
  4552       IF WS-RETRO-FLAG = 'A'
  4553           ADD EC-ISS-COMM (CL) TO DA-ISC-ADDL (SA)
  4554           ADD EC-CNC-COMM (CL) TO DA-CNC-ADDL (SA).
  4555
  4556*    MOVE DA-UC (SA) TO SAVE-DA-UC.
  4557*    MOVE XDA-GA-UC (SA AL) TO SAVE-DA-GA-UC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 100
* ECS043.cbl
  4558
  4559     IF WS-EP-CODE = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  4560        IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4561         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4562             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4563              EC-COMM-78 (CL))
  4564        ELSE
  4565         IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4566          COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4567             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4568              EC-COMM-78 (CL))
  4569*02298             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4570            IF WS-RETRO-FLAG = 'A'
  4571               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4572                  ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4573                    EC-COMM-78 (CL)).
  4574
  4575     IF WS-EP-CODE = 'P'
  4576       IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4577         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4578             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4579              EC-COMM-PR (CL))
  4580       ELSE
  4581        IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4582         COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4583             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4584              EC-COMM-PR (CL))
  4585*02313             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4586            IF WS-RETRO-FLAG = 'A'
  4587               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4588                ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4589                  EC-COMM-PR (CL)).
  4590
  4591     IF (WS-EP-CODE = 'B' OR 'K' OR 'L')
  4592       IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4593         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4594             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4595              EC-COMM-ST (CL))
  4596       ELSE
  4597        IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4598         COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4599             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4600              EC-COMM-ST (CL))
  4601*02328             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4602            IF WS-RETRO-FLAG = 'A'
  4603               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4604                ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4605                  EC-COMM-ST (CL)).
  4606
  4607     IF WS-EP-CODE = 'M'
  4608         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4609                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4610                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4611                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5))
  4612          ELSE
  4613           IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4614                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4615                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 101
* ECS043.cbl
  4616                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5))
  4617*02343                IF AM-RETRO-LV-INDIC (AL) = 'A'
  4618            IF WS-RETRO-FLAG = 'A'
  4619                   COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4620                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4621                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5)).
  4622
  4623     IF WS-EP-CODE = '1'
  4624         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4625                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4626                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4627                      ((EC-COMM-PR (CL) * +.6667) +
  4628                       (EC-COMM-78 (CL) * +.3333)))
  4629         ELSE
  4630             IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4631                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4632                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4633                      ((EC-COMM-PR (CL) * +.6667) +
  4634                       (EC-COMM-78 (CL) * +.3333)))
  4635*02360                  IF AM-RETRO-LV-INDIC (AL) = 'A'
  4636                 IF WS-RETRO-FLAG = 'A'
  4637                     COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4638                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4639                      ((EC-COMM-PR (CL) * +.6667) +
  4640                       (EC-COMM-78 (CL) * +.3333))).
  4641
  4642     IF WS-EP-CODE = '2'
  4643         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4644                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4645                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4646                      ((EC-COMM-PR (CL) * +.80) +
  4647                       (EC-COMM-78 (CL) * +.20)))
  4648         ELSE
  4649             IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4650                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4651                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4652                      ((EC-COMM-PR (CL) * +.80) +
  4653                       (EC-COMM-78 (CL) * +.20)))
  4654*02378                  IF AM-RETRO-LV-INDIC (AL) = 'A'
  4655                 IF WS-RETRO-FLAG = 'A'
  4656                     COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4657                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4658                      ((EC-COMM-PR (CL) * +.80) +
  4659                       (EC-COMM-78 (CL) * +.20))).
  4660
  4661 0710-EXIT.
  4662     EXIT.
  4663
  4664 0725-CHECK-AM-RETRO.
  4665
  4666     MOVE SPACE                  TO  WS-RETRO-FLAG.
  4667
  4668     PERFORM 0725-CHECK-LOOP VARYING AN FROM 1 BY 1
  4669                             UNTIL AN GREATER THAN 10.
  4670 0725-CHECK-LOOP.
  4671
  4672     IF EC-AGT-NO (CL) = AM-AGT (AN)
  4673         MOVE AM-RETRO-LV-INDIC (AN)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 102
* ECS043.cbl
  4674                                 TO  WS-RETRO-FLAG
  4675         MOVE +11                TO  AN.
  4676
  4677 0725-EXIT.
  4678     EXIT.
  4679
  4680 0729-EXIT.
  4681     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 103
* ECS043.cbl
  4683
  4684 0730-RETURN-SORTED-FILE.
  4685
  4686     IF SW-CTL NOT = HIGH-VALUES
  4687         RETURN SORT-WORK  INTO  SW-REC
  4688                    AT END MOVE HIGH-VALUES TO SW-RPT-TYPE-ID
  4689                                               SW-CTL.
  4690 0730-EXIT.
  4691     EXIT.
  4692
  4693 0740-MOVE-SW-REC.
  4694     IF SW-RPT-TYPE-ID = 'C'
  4695         IF DTE-CLIENT = 'LBL'
  4696             MOVE 'E'            TO SW-RET-TYP.
  4697
  4698     MOVE SW-NAME                TO H1-NAME.
  4699     MOVE SW-ADDRS               TO H2-ADDR.
  4700     MOVE SW-CITY                TO H3-ADDR.
  4701
  4702     IF  SW-CANADIAN-POST-CODE
  4703         MOVE SW-CAN-POST-CODE-1 TO H3-CAN-POSTAL-CODE-1
  4704         MOVE SW-CAN-POST-CODE-2 TO H3-CAN-POSTAL-CODE-2
  4705         MOVE SPACES             TO H3-DASH-CAN
  4706                                    H3-CAN-FILLER
  4707
  4708     ELSE
  4709         MOVE SW-ZIP-PRIME       TO H3-ZIP-PRIME
  4710
  4711         IF  SW-ZIP-PLUS4 = SPACES OR ZEROS
  4712             MOVE SPACES         TO H3-ZIP-PLUS4 H3-DASH
  4713
  4714         ELSE
  4715             MOVE SW-ZIP-PLUS4   TO H3-ZIP-PLUS4
  4716             MOVE '-'            TO H3-DASH.
  4717
  4718     MOVE SW-CARR                TO H5-CARR.
  4719     MOVE SW-COMP                TO H5-COMP.
  4720     MOVE SW-STATE               TO H5-ST.
  4721     MOVE SW-ACCT                TO H5-ACCT.
  4722     MOVE '-'                    TO H5-FS1 H5-FS2 H5-TS1 H5-TS2.
  4723     MOVE SW-EFF-DT              TO WORK-DATE.
  4724     MOVE WK-MO                  TO H5-FMO.
  4725     MOVE WK-DA                  TO H5-FDA.
  4726     MOVE WK-YR                  TO H5-FYR.
  4727     MOVE SW-EXP-DT              TO WORK-DATE.
  4728     MOVE WK-MO                  TO H5-TMO.
  4729     MOVE WK-DA                  TO H5-TDA.
  4730     MOVE WK-YR                  TO H5-TYR.
  4731     MOVE SW-ACCUMS              TO PRINT-ACCUMS-R (1).
  4732     MOVE SW-CTL                 TO WS-SAVE-CTL.
  4733     MOVE SW-GA-FLAG             TO SAVE-GA-FLAG.
  4734     MOVE SW-RET-Y-N             TO SAVE-RET-Y-N.
  4735     MOVE SW-RET-TYP             TO SAVE-RET-TYP.
  4736     MOVE SW-LRET                TO LIFE-RETENT.
  4737     MOVE SW-ARET                TO AH-RETENT.
  4738     MOVE SW-RETRO-LIMIT         TO SAVE-RETRO-LIMIT.
  4739     MOVE SW-PREM-P-E            TO SAVE-PREM-P-E.
  4740     MOVE SW-CLMS-P-I            TO SAVE-CLMS-P-I.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 104
* ECS043.cbl
  4741     MOVE SW-BEG-DATE            TO BEG-DATE.
  4742
  4743     IF SW-RPT-TYPE-ID = 'B'
  4744         MOVE 'GROUP'            TO H4-GROUP
  4745         MOVE SW-GA              TO H5-GROUP.
  4746
  4747     MOVE SW-GA                  TO ZONE-GROUP.
  4748
  4749     IF SW-RPT-TYPE-ID = 'B' AND ZON = 'ZON'
  4750         MOVE '  ZONE'           TO H4-GROUP
  4751         INSPECT H5-GROUP CONVERTING 'ZON' TO '   '.
  4752
  4753     IF SW-RPT-TYPE-ID = 'C'
  4754         MOVE ' G.A.'            TO H4-GROUP
  4755         MOVE SW-GA              TO H5-GROUP.
  4756
  4757     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 105
* ECS043.cbl
  4759 0745-OUTPUT-PROCEDURE SECTION.
  4760     IF NO-OF-RECORDS-RELEASED = +0
  4761        GO TO 1080-E-O-J.
  4762
  4763 0750-PRINT-REPORT SECTION.
  4764     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
  4765
  4766     IF SW-RPT-TYPE-ID = 'B'
  4767         GO TO 0900-PRINT-GROUP-TOTALS.
  4768
  4769     IF SW-RPT-TYPE-ID = 'C'
  4770         GO TO 0990-PRINT-GA-TOTALS.
  4771
  4772     MOVE 'A'    TO H1-REPORT-SUF.
  4773     PERFORM 0740-MOVE-SW-REC.
  4774     MOVE SPACES TO H5-MESSAGE.
  4775
  4776*    IF SW-CARR = WS-SAVE-CAR
  4777*        AND SW-COMP = WS-SAVE-CMP
  4778*        AND SW-STATE = WS-SAVE-ST
  4779*        AND SW-ACCT = WS-SAVE-ACC
  4780*            GO TO 0780-BREAK-1
  4781*    ELSE
  4782*        GO TO 0800-BREAK-2.
  4783
  4784 0760-CHECK-BREAK.
  4785     IF SW-CARR NOT = WS-SAVE-CAR
  4786         GO TO 0860-BREAK-5.
  4787     IF SW-COMP NOT = WS-SAVE-CMP
  4788         GO TO 0840-BREAK-4.
  4789     IF SW-STATE NOT = WS-SAVE-ST
  4790         GO TO 0820-BREAK-3.
  4791     IF SW-ACCT NOT = WS-SAVE-ACC
  4792         GO TO 0800-BREAK-2.
  4793
  4794     GO TO 0780-BREAK-1.
  4795
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 106
* ECS043.cbl
  4797 0770-BREAK-RETURN.
  4798     PERFORM 0740-MOVE-SW-REC.
  4799
  4800     IF SW-CTL = HIGH-VALUES
  4801         PERFORM 0880-BREAK-6
  4802         GO TO 1080-E-O-J
  4803     ELSE
  4804         IF SW-RPT-TYPE-ID = 'B'
  4805             PERFORM 0880-BREAK-6
  4806             GO TO 0900-PRINT-GROUP-TOTALS
  4807         ELSE
  4808             IF SW-RPT-TYPE-ID = 'C'
  4809                 PERFORM 0880-BREAK-6
  4810                 GO TO 0990-PRINT-GA-TOTALS
  4811             ELSE
  4812                 GO TO 0760-CHECK-BREAK.
  4813
  4814 0780-BREAK-1.
  4815     MOVE 'X'            TO BREAK-1-SWITCH.
  4816     MOVE '1'            TO HEAD-SW.
  4817     MOVE 'FROM      TO' TO H4-FT.
  4818     MOVE +1             TO SG.
  4819     MOVE +3             TO SF.
  4820     MOVE +1             TO SH.
  4821
  4822     IF DTE-CLIENT NOT = 'ITG'
  4823         PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  4824
  4825     MOVE +1 TO SC.
  4826     MOVE +7 TO SF.
  4827     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  4828     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  4829                          UNTIL SB GREATER 6.
  4830
  4831 0790-BREAD-1-EXIT.
  4832     GO TO 0770-BREAK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 107
* ECS043.cbl
  4834
  4835 0800-BREAK-2.
  4836     IF BREAK-1-SWITCH NOT = ' '
  4837         PERFORM 0780-BREAK-1
  4838     ELSE
  4839         MOVE +1 TO SC
  4840         MOVE +7 TO SF
  4841         PERFORM 0530-ADD-UP-LEVELS 6 TIMES
  4842         PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  4843                              UNTIL SB GREATER 6.
  4844
  4845     MOVE SPACES TO BREAK-1-SWITCH.
  4846     MOVE '2'    TO HEAD-SW.
  4847
  4848     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  4849                    H5-TMO  H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  4850
  4851     IF FC-CODE = ' '  OR  '5'
  4852         MOVE PA-NW (9)             TO ANNUALIZED-PREM.
  4853     IF FC-CODE = '1'
  4854         COMPUTE ANNUALIZED-PREM = (PA-NW (9) / RD-MO) * 12.
  4855     IF FC-CODE = '2'
  4856         IF RD-MO = 01 OR 04 OR 07 OR 10
  4857             COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 12
  4858         ELSE
  4859             IF RD-MO = 02 OR 05 OR 08 OR 11
  4860                 COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 6
  4861             ELSE
  4862                 COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 4.
  4863     IF FC-CODE = '3'
  4864         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 4.
  4865     IF FC-CODE = '4'
  4866         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 2.
  4867     IF FC-CODE = '6'
  4868         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 12.
  4869
  4870     IF ANNUALIZED-PREM GREATER THAN SAVE-RETRO-LIMIT
  4871         MOVE +2   TO SG
  4872         MOVE +9   TO SF
  4873         MOVE +1   TO SH
  4874         PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT
  4875         MOVE +7   TO SC
  4876         MOVE +13  TO SF
  4877         PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  4878
  4879     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  4880                          UNTIL SB GREATER 12.
  4881
  4882 0810-BREAK-2-EXIT.
  4883     GO TO 0770-BREAK-RETURN.
  4884
  4885 0820-BREAK-3.
  4886     PERFORM 0800-BREAK-2.
  4887     MOVE '3'           TO HEAD-SW.
  4888     MOVE WS-SAVE-ST    TO H8-ST.
  4889     MOVE HEAD-8-STATE  TO H2-ADDR.
  4890     MOVE SPACES        TO H1-NAME  H3-ADDR  H3-ZIP.
  4891     MOVE +3            TO SG.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 108
* ECS043.cbl
  4892     MOVE +15           TO SF.
  4893     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  4894     MOVE +13           TO SC.
  4895     MOVE +19           TO SF.
  4896     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  4897     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  4898                          UNTIL SB GREATER 18.
  4899
  4900     MOVE BALANCE-LINE-1 TO WS-BAL-LINE-1.
  4901     MOVE BALANCE-LINE-2 TO WS-BAL-LINE-2.
  4902
  4903 0830-BREAK-3-EXIT.
  4904     GO TO 0770-BREAK-RETURN.
  4905
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 109
* ECS043.cbl
  4907 0840-BREAK-4.
  4908     PERFORM 0820-BREAK-3.
  4909     MOVE '4'         TO HEAD-SW.
  4910     MOVE WS-SAVE-CMP TO H8-COMP.
  4911     MOVE HEAD-8-COMP TO H2-ADDR.
  4912     MOVE +4          TO SG.
  4913     MOVE +21         TO SF.
  4914     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  4915     MOVE +19         TO SC.
  4916     MOVE +25         TO SF.
  4917     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  4918     PERFORM 0560-ZERO-PA VARYING SB FROM 19 BY 1
  4919                          UNTIL SB GREATER 24.
  4920
  4921 0850-BREAK-4-EXIT.
  4922     GO TO 0770-BREAK-RETURN.
  4923
  4924 0860-BREAK-5.
  4925     PERFORM 0840-BREAK-4.
  4926     MOVE '5'         TO HEAD-SW.
  4927     MOVE WS-SAVE-CAR TO H8-CARR.
  4928     MOVE HEAD-8-CARR TO H2-ADDR.
  4929     MOVE +5          TO SG.
  4930     MOVE +27         TO SF.
  4931     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  4932     MOVE +25         TO SC.
  4933     MOVE +31         TO SF.
  4934     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  4935     PERFORM 0560-ZERO-PA VARYING SB FROM 25 BY 1
  4936                          UNTIL SB GREATER 30.
  4937
  4938 0870-BREAK-5-EXIT.
  4939     GO TO 0770-BREAK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 110
* ECS043.cbl
  4941
  4942 0880-BREAK-6.
  4943     PERFORM 0860-BREAK-5.
  4944     MOVE '6'          TO HEAD-SW.
  4945     MOVE HEAD-8-FINAL TO H2-ADDR.
  4946     MOVE +6           TO SG.
  4947     MOVE +33          TO SF.
  4948     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  4949
  4950 0890-BREAK-6-EXIT.
  4951     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 111
* ECS043.cbl
  4953
  4954 0900-PRINT-GROUP-TOTALS.
  4955     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  4956                          UNTIL SB GREATER 36.
  4957     MOVE 'B' TO H1-REPORT-SUF.
  4958     PERFORM 0740-MOVE-SW-REC.
  4959
  4960 0910-CHECK-GROUP-BREAK.
  4961     IF SW-GA NOT = WS-SAVE-GA
  4962         GO TO 0970-BREAK-GROUP-3.
  4963
  4964     IF SW-CARR  NOT = WS-SAVE-CAR OR
  4965        SW-COMP  NOT = WS-SAVE-CMP OR
  4966        SW-STATE NOT = WS-SAVE-ST  OR
  4967        SW-ACCT  NOT = WS-SAVE-ACC
  4968           GO TO 0950-BREAK-GROUP-2.
  4969
  4970     GO TO 0930-BREAK-GROUP-1.
  4971
  4972 0920-BREAK-GROUP-RETURN.
  4973     PERFORM 0740-MOVE-SW-REC.
  4974
  4975     IF SW-CTL = HIGH-VALUES
  4976         PERFORM 0970-BREAK-GROUP-3
  4977         GO TO 1080-E-O-J
  4978     ELSE
  4979         IF SW-RPT-TYPE-ID = 'C'
  4980             PERFORM 0970-BREAK-GROUP-3
  4981             GO TO 0990-PRINT-GA-TOTALS
  4982         ELSE
  4983             GO TO 0910-CHECK-GROUP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 112
* ECS043.cbl
  4985
  4986 0930-BREAK-GROUP-1.
  4987     MOVE +1 TO SC.
  4988     MOVE +7 TO SF.
  4989     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  4990     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  4991                          UNTIL SB GREATER 6.
  4992
  4993 0940-BREAK-GROUP-1-EXIT.
  4994     GO TO 0920-BREAK-GROUP-RETURN.
  4995
  4996 0950-BREAK-GROUP-2.
  4997     PERFORM 0930-BREAK-GROUP-1.
  4998     MOVE '2'    TO HEAD-SW.
  4999     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5000                    H5-TMO H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5001     MOVE +2     TO SG.
  5002     MOVE +9     TO SF.
  5003     MOVE +1     TO SH.
  5004     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5005     MOVE +7     TO SC.
  5006     MOVE +13    TO SF.
  5007     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5008     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5009                          UNTIL SB GREATER 12.
  5010
  5011 0960-BREAK-GROUP-2-EXIT.
  5012     GO TO 0920-BREAK-GROUP-RETURN.
  5013
  5014 0970-BREAK-GROUP-3.
  5015     PERFORM 0950-BREAK-GROUP-2.
  5016     MOVE '3'        TO HEAD-SW.
  5017     MOVE WS-SAVE-GA TO H8-GROUP  ZONE-GROUP.
  5018     MOVE '  GROUP'  TO H-8-G.
  5019
  5020     IF ZON = 'ZON'
  5021         INSPECT H8-GROUP CONVERTING 'ZON' TO '   '
  5022         MOVE '  ZONE' TO H-8-G.
  5023*
  5024*  SKIP 1 ADDITIONAL PAGE TO PRINT GROUP TOTALS ON A
  5025*  SEPARATE PAGE BY ITSELF.
  5026*
  5027     MOVE '1'              TO X.
  5028     MOVE SPACE-LINE       TO P-DATA.
  5029     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  5030
  5031     MOVE HEAD-8-GROUP TO H2-ADDR.
  5032     MOVE SPACES       TO H1-NAME  H3-ADDR  H3-ZIP.
  5033     MOVE +3           TO SG.
  5034     MOVE +15          TO SF.
  5035     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5036*
  5037*  SKIP 1 ADDITIONAL PAGE TO PRINT GROUP TOTALS ON A
  5038*  SEPARATE PAGE BY ITSELF.
  5039*
  5040     MOVE '1'              TO X.
  5041     MOVE SPACE-LINE       TO P-DATA.
  5042     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 113
* ECS043.cbl
  5043
  5044     MOVE +13          TO SC.
  5045     MOVE +19          TO SF.
  5046     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5047     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5048                          UNTIL SB GREATER 18.
  5049
  5050 0980-BREAK-GROUP-3-EXIT.
  5051     GO TO 0920-BREAK-GROUP-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 114
* ECS043.cbl
  5053 0990-PRINT-GA-TOTALS.
  5054     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5055                          UNTIL SB GREATER 36.
  5056     MOVE 'C' TO H1-REPORT-SUF.
  5057     PERFORM 0740-MOVE-SW-REC.
  5058
  5059 1000-CHECK-GA-BREAK.
  5060     IF SW-GA NOT = WS-SAVE-GA
  5061         GO TO 1060-BREAK-GA-3.
  5062
  5063     IF SW-CARR  NOT = WS-SAVE-CAR  OR
  5064        SW-COMP  NOT = WS-SAVE-CMP  OR
  5065        SW-STATE NOT = WS-SAVE-ST   OR
  5066        SW-ACCT  NOT = WS-SAVE-ACC
  5067           GO TO 1040-BREAK-GA-2.
  5068
  5069     GO TO 1020-BREAK-GA-1.
  5070
  5071 1010-BREAK-GA-RETURN.
  5072     PERFORM 0740-MOVE-SW-REC.
  5073
  5074     IF SW-CTL = HIGH-VALUES
  5075         PERFORM 1060-BREAK-GA-3
  5076         GO TO 1080-E-O-J.
  5077
  5078     GO TO 1000-CHECK-GA-BREAK.
  5079
  5080 1020-BREAK-GA-1.
  5081     MOVE +1 TO SC.
  5082     MOVE +7 TO SF.
  5083     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5084     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5085                          UNTIL SB GREATER 6.
  5086
  5087 1030-BREAK-GA-1-EXIT.
  5088     GO TO 1010-BREAK-GA-RETURN.
  5089
  5090 1040-BREAK-GA-2.
  5091     PERFORM 1020-BREAK-GA-1.
  5092
  5093     IF LIFE-RETENT = ZERO
  5094         MOVE ZEROS TO PA-NBA (7) PA-NBA (10).
  5095
  5096     IF AH-RETENT = ZERO
  5097         MOVE ZEROS TO PA-NBA (8) PA-NBA (11).
  5098
  5099     ADD PA-NBA (7) PA-NBA (8) GIVING PA-NBA (9).
  5100     ADD PA-NBA (10) PA-NBA (11) GIVING PA-NBA (12).
  5101
  5102     MOVE '2' TO HEAD-SW.
  5103     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5104                    H5-TMO H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5105
  5106     MOVE +2 TO SG.
  5107     MOVE +9 TO SF.
  5108     MOVE +1 TO SH.
  5109     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5110
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 115
* ECS043.cbl
  5111     IF PA-NBA (7) LESS +0
  5112         ADD PA-NBA (7) TO PA-NBA (8)
  5113         MOVE +0 TO PA-NBA (7)
  5114         IF PA-NBA (8) LESS +0
  5115             MOVE +0 TO PA-NBA (8).
  5116
  5117     IF PA-NBA (8) LESS +0
  5118         ADD PA-NBA (8) TO PA-NBA (7)
  5119         MOVE +0 TO PA-NBA (8)
  5120         IF PA-NBA (7) LESS +0
  5121             MOVE +0 TO PA-NBA (7).
  5122
  5123     COMPUTE PA-NBA (9) = PA-NBA (7) + PA-NBA (8).
  5124
  5125     IF SAVE-RET-Y-N = SPACE  OR  'N'
  5126         MOVE ZEROS  TO  PA-NBA (7)  PA-NBA (8)  PA-NBA (9).
  5127
  5128     IF PA-NBA (10) LESS +0
  5129         ADD PA-NBA (10) TO PA-NBA (11)
  5130         MOVE +0 TO PA-NBA (10)
  5131         IF PA-NBA (11) LESS +0
  5132             MOVE +0 TO PA-NBA (11).
  5133
  5134     IF PA-NBA (11) LESS +0
  5135         ADD PA-NBA (11) TO PA-NBA (10)
  5136         MOVE +0 TO PA-NBA (11)
  5137         IF PA-NBA (10) LESS +0
  5138             MOVE +0 TO PA-NBA (10).
  5139
  5140     COMPUTE PA-NBA (12) = PA-NBA (10) + PA-NBA (11).
  5141
  5142     IF SAVE-RET-Y-N = SPACE  OR  'N'
  5143         MOVE ZEROS  TO  PA-NBA (10)  PA-NBA (11)  PA-NBA (12).
  5144
  5145     MOVE +7  TO SC.
  5146     MOVE +13 TO SF.
  5147     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5148     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5149                          UNTIL SB GREATER 12.
  5150
  5151 1050-BREAK-GA-2-EXIT.
  5152     GO TO 1010-BREAK-GA-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 116
* ECS043.cbl
  5154
  5155 1060-BREAK-GA-3.
  5156     PERFORM 1040-BREAK-GA-2.
  5157     MOVE '3'        TO HEAD-SW.
  5158     MOVE WS-SAVE-GA TO H8-GA.
  5159     MOVE HEAD-8-GA  TO H2-ADDR.
  5160     MOVE SPACES     TO H1-NAME  H3-ADDR  H3-ZIP.
  5161*    MOVE +1.0       TO LIFE-RETENT AH-RETENT.
  5162
  5163     IF DTE-CLIENT = 'GIC'
  5164         MOVE 'P' TO SAVE-RET-TYP
  5165     ELSE
  5166         MOVE 'E' TO SAVE-RET-TYP.
  5167
  5168     MOVE +3    TO SG.
  5169     MOVE +15   TO SF.
  5170     MOVE +2    TO SH.
  5171     MOVE LIFE-RETENT TO RETENT-FACT.
  5172     MOVE +13   TO SC.
  5173     MOVE +15   TO SF.
  5174     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5175     MOVE AH-RETENT TO RETENT-FACT.
  5176     MOVE +14   TO SC.
  5177     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5178     MOVE LIFE-RETENT TO RETENT-FACT.
  5179     MOVE +16   TO SC.
  5180     MOVE +18   TO SF.
  5181     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5182     MOVE AH-RETENT TO RETENT-FACT.
  5183     MOVE +17 TO SC.
  5184     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5185
  5186     ADD PA-PE (13) PA-PE (14) GIVING PA-PE (15).
  5187     ADD PA-PE (16) PA-PE (17) GIVING PA-PE (18).
  5188
  5189     MOVE +15 TO SF.
  5190
  5191     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5192     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5193                          UNTIL SB GREATER 18.
  5194
  5195 1070-BREAK-GA-3-EXIT.
  5196     GO TO 1010-BREAK-GA-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 117
* ECS043.cbl
  5198 1080-E-O-J.
  5199     CLOSE
  5200         PRNTR.
  5201
  5202 1090-CLOSE-FICH.
* 5203                             COPY ELCPRTC.
  5204******************************************************************04/15/98
  5205*                                                                *ELCPRTC
  5206*                                                                *ELCPRTC
  5207*                            ELCPRTC.                            *   LV003
  5208*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5209*                            VMOD=2.002                          *   CL**2
  5210*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  5211*                                                                *ELCPRTC
  5212* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  5213******************************************************************ELCPRTC
  5214                                                                  ELCPRTC
  5215      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  5216          CLOSE FICH.                                             ELCPRTC
  5217                                                                  ELCPRTC
  5218******************************************************************ELCPRTC
  5219
  5220 1090-CLOSE-EXIT.
  5221     EXIT.
  5222
* 5223 COPY ELCDCS.
  5224****************************************************************  04/15/98
  5225*                                                              *  ELCDCS
  5226*                                                              *  ELCDCS
  5227*                            ELCDCS.                           *     LV003
  5228*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5229*                            VMOD=2.002                        *     CL**3
  5230*                                                              *  ELCDCS
  5231*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  5232****************************************************************. ELCDCS
  5233                                                                  ELCDCS
  5234 8510-DATE-CONVERSION.                                            ELCDCS
  5235     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  5236                                                                  ELCDCS
  5237 8590-EXIT.                                                       ELCDCS
  5238     EXIT.                                                        ELCDCS
  5239                                                                  ELCDCS
  5240
  5241 ABEND-PGM SECTION.
* 5242                             COPY ELCABEND SUPPRESS.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       65156     Code:       29907
