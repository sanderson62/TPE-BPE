* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* EL555.cbl
* Options: int("EL555.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL555.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL555.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL555.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         03/10/98
     2                                                                  EL555
     3 PROGRAM-ID.                 EL555 .                                 LV002
     4*              PROGRAM CONVERTED BY                               EL555
     5*              COBOL CONVERSION AID PO 5785-ABJ                   EL555
     6*              CONVERSION DATE 02/12/96 16:49:31.                 EL555
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE            EL555
     8*                            VMOD=2.003                           EL555
     9                                                                  EL555
    10*AUTHOR.     LOGIC, INC.                                          EL555
    11*            DALLAS, TEXAS.                                       EL555
    12                                                                  EL555
    13*DATE-COMPILED.                                                   EL555
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* EL555.cbl
    14                                                                  EL555
    15*SECURITY.   *****************************************************EL555
    16*            *                                                   *EL555
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *EL555
    18*            *                                                   *EL555
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *EL555
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *EL555
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *EL555
    22*            *                                                   *EL555
    23*            *****************************************************EL555
    24                                                                  EL555
    25*REMARKS.                                                         EL555
    26                                                                  EL555
    27*    THIS PROGRAM WILL DELETE ANY REPORTS THAT HAVE BEEN ON THE   EL555
    28*         FILE LONGER THAN 15 DAYS.  ALSO DELETES ANY DETAIL      EL555
    29*         RECORDS THAT HAVE NO TRAILER RECORD.                    EL555
    30                                                                  EL555
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* EL555.cbl
    32                                                                  EL555
    33 ENVIRONMENT DIVISION.                                            EL555
    34                                                                  EL555
    35 INPUT-OUTPUT SECTION.                                            EL555
    36                                                                  EL555
    37 FILE-CONTROL.                                                    EL555
    38                                                                  EL555
    39     SELECT SORT-WORK    ASSIGN TO SYS001-UT-FBA1-S-SORTWK1.      EL555
    40                                                                  EL555
    41     SELECT RPTFILE      ASSIGN TO SYS014-UT-FBA1-S-RPTFILE.      EL555
    42                                                                  EL555
    43     SELECT NEWFILE      ASSIGN TO SYS015-UT-FBA1-S-NEWFILE.      EL555
    44                                                                  EL555
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* EL555.cbl
    46 DATA DIVISION.                                                   EL555
    47 FILE SECTION.                                                    EL555
    48                                                                  EL555
    49 SD  SORT-WORK.                                                   EL555
    50 01  SORT-RECORD.                                                 EL555
    51     12  FILLER                      PIC XX.                      EL555
    52     12  SORT-COMPANY                PIC X.                       EL555
    53     12  SORT-TYPE                   PIC X.                       EL555
    54     12  SORT-ID                     PIC X(5).                    EL555
    55     12  SORT-LINE                   PIC S9(8) COMP.              EL555
    56     12  FILLER                      PIC X.                       EL555
    57     12  SORT-CURRENT-DATE           PIC X(8).                    EL555
    58     12  FILLER                      PIC X(124).                  EL555
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* EL555.cbl
    60 FD  RPTFILE.                                                     EL555
    61                                                                  EL555
*   62 COPY ELCREPT.                                                    EL555
    63******************************************************************04/15/98
    64*                                                                *ELCREPT
    65*                                                                *ELCREPT
    66*                            ELCREPT.                            *   LV002
    67*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    68*                            VMOD=2.002                          *   CL**2
    69*                                                                *ELCREPT
    70*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
    71*                                                                *ELCREPT
    72*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
    73*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
    74*                                                                *ELCREPT
    75*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
    76*       ALTERNATE PATH  = NOT USED                               *ELCREPT
    77*                                                                *ELCREPT
    78*   LOG = NO                                                     *ELCREPT
    79*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
    80******************************************************************ELCREPT
    81 01  REPORT-SAVE-FILE.                                            ELCREPT
    82     12  RF-RECORD-ID                PIC XX.                      ELCREPT
    83         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
    84                                                                  ELCREPT
    85     12  RF-CONTROL-PRIMARY.                                      ELCREPT
    86         16  RF-COMPANY-CD           PIC X.                       ELCREPT
    87         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
    88             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
    89             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
    90         16  RF-REPORT-ID.                                        ELCREPT
    91             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
    92                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
    93                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
    94             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
    95         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
    96     12  RF-REPORT-LINE-133.                                      ELCREPT
    97         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
    98         16  RF-DATA-133             PIC X(132).                  ELCREPT
    99         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
   100             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
   101             20  FILLER              PIC X(52).                   ELCREPT
   102         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
   103             20  FILLER              PIC X(53).                   ELCREPT
   104             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
   105     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
   106         16  FILLER                  PIC X.                       ELCREPT
   107         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
   108         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
   109         16  FILLER                  PIC X(115).                  ELCREPT
   110         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
   111******************************************************************ELCREPT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* EL555.cbl
   113 FD  NEWFILE.                                                     EL555
   114                                                                  EL555
   115 01  OUT-REC                PIC X(146).                           EL555
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* EL555.cbl
   117 WORKING-STORAGE SECTION.                                         EL555
   118 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.      EL555
   119 77  FILLER  PIC X(32)  VALUE '********************************'. EL555
   120 77  FILLER  PIC X(32)  VALUE '*    EL555 WORKING STORAGE     *'. EL555
   121 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.003 ************'. EL555
   122                                                                  EL555
   123 77  IN-CNT          PIC S9(7)       COMP-3  VALUE ZERO.          EL555
   124 77  DEL-CNT         PIC S9(7)       COMP-3  VALUE ZERO.          EL555
   125 77  OUT-CNT         PIC S9(7)       COMP-3  VALUE ZERO.          EL555
   126 77  STR-CNT         PIC S9(7)       COMP-3  VALUE ZERO.          EL555
   127 77  ELREPT-RECS-DEL PIC S9(7)       COMP-3  VALUE ZERO.          EL555
   128 77  ELREPT-RPTS-DEL PIC S9(7)       COMP-3  VALUE ZERO.          EL555
   129 77  WS-PAGE         PIC S9(7)       COMP-3  VALUE ZERO.          EL555
   130 77  PRT-CNT         PIC S9(3)       COMP-3  VALUE ZERO.          EL555
   131 77  X               PIC X.                                       EL555
   132                                                                  EL555
   133 01  WS-ACCEPT-DATE.                                              EL555
   134     12  WS-AD-YY                    PIC 99.                      EL555
   135     12  WS-AD-MM                    PIC 99.                      EL555
   136     12  WS-AD-DD                    PIC 99.                      EL555
   137                                                                  EL555
   138 01  WS-CURRENT-DATE.                                             EL555
   139     12  WS-CD-MM                    PIC 99.                      EL555
   140     12  FILLER                      PIC X      VALUE '/'.        EL555
   141     12  WS-CD-DD                    PIC 99.                      EL555
   142     12  FILLER                      PIC X      VALUE '/'.        EL555
   143     12  WS-CD-YY                    PIC 99.                      EL555
   144                                                                  EL555
   145 01  WS-TIME-OF-DAY.                                              EL555
   146     12  WS-TIME                     PIC 9(6).                    EL555
   147     12  WS-HUN-SEC                  PIC 99.                      EL555
   148                                                                  EL555
   149 01  FILLER.                                                      EL555
   150     12  SAVE-ID                PIC X(5)  VALUE SPACES.           EL555
   151     12  DATE-NOW               PIC XX.                           EL555
   152     12  DATE-THEN              PIC XX.                           EL555
   153     12  WS-REPORT-ID           PIC X(8).                         EL555
   154     12  WS-COMPANY-CD          PIC X.                            EL555
   155     12  WS-LINE-NUMBER         PIC S9(8)  COMP.                  EL555
   156                                                                  EL555
   157                                                                  EL555
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* EL555.cbl
*  159 COPY ELCDATE.                                                    EL555
   160******************************************************************06/11/98
   161*                                                                *ELCDATE
   162*                                                                *ELCDATE
   163*                            ELCDATE.                            *   LV023
   164*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   165*                            VMOD=2.003                           ELCDATE
   166*                                                                *ELCDATE
   167*                                                                *ELCDATE
   168*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   169*                 LENGTH = 200                                   *   CL*19
   170******************************************************************ELCDATE
   171                                                                  ELCDATE
   172 01  DATE-CONVERSION-DATA.                                        ELCDATE
   173     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   174     12  DC-OPTION-CODE                PIC X.                        CL*15
   175         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   176         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   177         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   178         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   179         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   180         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   181         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   182         88  FIND-CENTURY               VALUE '7'.                   CL*22
   183         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   184         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   185         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   186         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   187         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   188         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   189         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   190         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   191         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   192         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   193         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   194         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   195         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   196         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   197         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   198         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   199         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   200         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   201         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   202         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   203         88  THREE-CHARACTER-BIN                                  ELCDATE
   204                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   205         88  GREGORIAN-TO-BIN                                        CL**2
   206                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   207         88  BIN-TO-GREGORIAN                                        CL**2
   208                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   209         88  JULIAN-TO-BINARY                                        CL**2
   210                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   211     12  DC-ERROR-CODE                 PIC X.                        CL*15
   212         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   213         88  DATE-CONVERSION-ERROR                                ELCDATE
   214                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   215         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   216         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* EL555.cbl (/apps/prod/cid1p/copy/ELCDATE)
   217         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   218         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   219         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   220         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   221         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   222         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   223         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   224         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   225     12  DC-END-OF-MONTH               PIC X.                        CL*15
   226         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   227     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   228         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   229         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   230         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   231     12  FILLER                        PIC X.                        CL*15
   232     12  DC-CONVERSION-DATES.                                        CL*15
   233         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   234         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   235         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   236         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   237                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   238             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   239             20  SLASH1-1              PIC X.                        CL*15
   240             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   241             20  SLASH1-2              PIC X.                        CL*15
   242             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   243         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   244         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   245                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   246             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   247             20  SLASH2-1              PIC X.                        CL*15
   248             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   249             20  SLASH2-2              PIC X.                        CL*15
   250             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   251         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   252         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   253                     DC-GREG-DATE-1-YMD.                          ELCDATE
   254             20  DC-YMD-YEAR           PIC 99.                       CL*15
   255             20  DC-YMD-MONTH          PIC 99.                       CL*15
   256             20  DC-YMD-DAY            PIC 99.                       CL*15
   257         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   258         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   259                      DC-GREG-DATE-1-MDY.                         ELCDATE
   260             20  DC-MDY-MONTH          PIC 99.                       CL*15
   261             20  DC-MDY-DAY            PIC 99.                       CL*15
   262             20  DC-MDY-YEAR           PIC 99.                       CL*15
   263         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   264             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   265             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   266             20  FILLER                PIC XX.                       CL*15
   267             20  DC-ALPHA-CENTURY.                                   CL*15
   268                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   269             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   270         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   271         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   272         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   273         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   274         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* EL555.cbl (/apps/prod/cid1p/copy/ELCDATE)
   275                                       PIC 9(05).                    CL*20
   276         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   277             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   278             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   279         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   280         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   281         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   282     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   283         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   284         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   285             20  FILLER                PIC 9(3).                     CL*15
   286             20  HOLD-CEN-1-CCYY.                                    CL*15
   287                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   288                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   289             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   290             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   291         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   292             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   293             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   294             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   295                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   296                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   297             20  FILLER                PIC 9(3).                     CL*15
   298         16  HOLD-CENTURY-1-X.                                       CL*15
   299             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   300             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   301                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   302                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   303             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   304             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   305         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   306             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   307             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   308             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   309                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   310                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   311             20  FILLER                PIC XXX.                      CL*23
   312         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   313         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   314         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   315         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   316             20  DC-JULIAN-1-CCYY.                                   CL*15
   317                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   318                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   319             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   320         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   321         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   322             20  DC-JULIAN-2-CCYY.                                   CL*15
   323                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   324                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   325             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   326         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   327             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   328             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   329             20  DC-EDITA-DAY          PIC 99.                       CL*15
   330             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   331             20  DC-EDITA-CCYY.                                      CL*15
   332                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* EL555.cbl (/apps/prod/cid1p/copy/ELCDATE)
   333                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   334         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   335             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   336             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   337             20  DC-EDITB-DAY          PIC 99.                       CL*15
   338             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   339             20  DC-EDITB-CCYY.                                      CL*15
   340                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   341                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   342         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   343         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   344                              DC-GREG-DATE-CYMD.                  ELCDATE
   345             20  DC-CYMD-CEN           PIC 99.                       CL*15
   346             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   347             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   348             20  DC-CYMD-DAY           PIC 99.                       CL*15
   349         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   350         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   351                              DC-GREG-DATE-MDCY.                  ELCDATE
   352             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   353             20  DC-MDCY-DAY           PIC 99.                       CL*15
   354             20  DC-MDCY-CEN           PIC 99.                       CL*15
   355             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   356    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   357        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   358    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   359    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* EL555.cbl
   361 PROCEDURE DIVISION.                                              EL555
   362                                                                  EL555
   363 0100-OPEN-EM.                                                    EL555
   364     ACCEPT WS-ACCEPT-DATE FROM DATE.                             EL555
   365     MOVE WS-AD-YY               TO WS-CD-YY.                     EL555
   366     MOVE WS-AD-MM               TO WS-CD-MM.                     EL555
   367     MOVE WS-AD-DD               TO WS-CD-DD.                     EL555
   368                                                                  EL555
   369     MOVE WS-CURRENT-DATE TO DC-GREG-DATE-1-EDIT.                 EL555
   370     MOVE '2'             TO DC-OPTION-CODE.                      EL555
   371     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT.                    EL555
   372     MOVE DC-BIN-DATE-1   TO  DATE-NOW.                           EL555
   373                                                                  EL555
   374                                                                  EL555
   375     OPEN INPUT RPTFILE                                           EL555
   376         OUTPUT NEWFILE.                                          EL555
   377 SORT-INPUT.                                                      EL555
   378        SORT SORT-WORK      ASCENDING KEY                         EL555
   379                                SORT-COMPANY                      EL555
   380                                SORT-ID                           EL555
   381                            DESCENDING KEY                        EL555
   382                                SORT-TYPE                         EL555
   383                                                                  EL555
   384               INPUT PROCEDURE  1000-RD-INPUT                     EL555
   385               OUTPUT PROCEDURE 5000-READ-SORTED.                 EL555
   386                                                                  EL555
   387     CLOSE RPTFILE                                                EL555
   388           NEWFILE.                                               EL555
   389                                                                  EL555
   390     SORT SORT-WORK      ASCENDING KEY                            EL555
   391                             SORT-COMPANY                         EL555
   392                             SORT-TYPE                            EL555
   393                             SORT-ID                              EL555
   394                             SORT-LINE                            EL555
   395                 USING  NEWFILE                                   EL555
   396                 GIVING RPTFILE.                                  EL555
   397                                                                  EL555
   398     DISPLAY '**ELREPT RECORDS IN   ' IN-CNT.                     EL555
   399     DISPLAY '**ELREPT RECS DELETED ' DEL-CNT.                    EL555
   400     DISPLAY '**ELREPT RECS STARTED ' STR-CNT.                    EL555
   401     DISPLAY '**ELREPT RECORDS OUT  ' OUT-CNT.                    EL555
   402     GOBACK.                                                      EL555
   403                                                                  EL555
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* EL555.cbl
   405 1000-RD-INPUT          SECTION.                                  EL555
   406 2000-READ-TAPE.                                                  EL555
   407     READ RPTFILE  AT END  GO TO 4000-E-INPUT-SECT.               EL555
   408                                                                  EL555
   409     IF RF-LINE-NUMBER = ZERO                                     EL555
   410        ADD 1 TO STR-CNT                                          EL555
   411        GO TO 2000-READ-TAPE.                                     EL555
   412                                                                  EL555
   413     MOVE REPORT-SAVE-FILE TO SORT-RECORD.                        EL555
   414                                                                  EL555
   415     RELEASE SORT-RECORD.                                         EL555
   416                                                                  EL555
   417     GO TO 2000-READ-TAPE.                                        EL555
   418                                                                  EL555
   419 4000-E-INPUT-SECT.                                               EL555
   420     EXIT.                                                        EL555
   421                                                                  EL555
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* EL555.cbl
   423 5000-READ-SORTED     SECTION.                                    EL555
   424 5000-READ-IT.                                                    EL555
   425     RETURN SORT-WORK                                             EL555
   426          AT END GO TO 9000-CLOSE-EM.                             EL555
   427                                                                  EL555
   428     ADD 1 TO IN-CNT.                                             EL555
   429                                                                  EL555
   430     IF SORT-TYPE NOT = '2'                                       EL555
   431        GO TO 6000-CHECK-DETAIL.                                  EL555
   432                                                                  EL555
   433******  TRAILER RECORD ******                                     EL555
   434     MOVE SORT-ID   TO SAVE-ID.                                   EL555
   435     MOVE SORT-CURRENT-DATE TO DC-GREG-DATE-1-EDIT.               EL555
   436     MOVE '2'               TO DC-OPTION-CODE.                    EL555
   437     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT.                    EL555
   438     MOVE DC-BIN-DATE-1     TO  DATE-THEN.                        EL555
   439                                                                  EL555
   440     MOVE DATE-THEN       TO DC-BIN-DATE-1.                       EL555
   441     MOVE DATE-NOW        TO DC-BIN-DATE-2.                       EL555
   442     MOVE '1'             TO DC-OPTION-CODE.                      EL555
   443     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT.                    EL555
   444                                                                  EL555
   445     IF DC-ELAPSED-DAYS GREATER 15                                EL555
   446        MOVE SPACE TO SAVE-ID.                                    EL555
   447                                                                  EL555
   448 6000-CHECK-DETAIL.                                               EL555
   449     IF SORT-ID NOT = SAVE-ID                                     EL555
   450        ADD 1 TO DEL-CNT                                          EL555
   451        GO TO 5000-READ-IT.                                       EL555
   452                                                                  EL555
   453 7000-WRITE-RECORD.                                               EL555
   454     WRITE OUT-REC FROM SORT-RECORD.                              EL555
   455                                                                  EL555
   456     ADD 1 TO OUT-CNT.                                            EL555
   457     GO TO 5000-READ-IT.                                          EL555
   458                                                                  EL555
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* EL555.cbl
   460 8000-DATE-CONVERT.                                               EL555
   461     CALL 'ELDATCX'  USING DATE-CONVERSION-DATA.                  EL555
   462     IF DC-ERROR-CODE NOT = SPACE                                 EL555
   463        MOVE ZEROS TO DC-CONVERSION-DATES.                        EL555
   464 8000-EXIT.                                                       EL555
   465     EXIT.                                                        EL555
   466                                                                  EL555
   467 9000-CLOSE-EM.                                                   EL555
   468                                                                  EL555
   469 9999-EOJ    SECTION.                                             EL555
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2868     Code:        1684
