* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* EL551.cbl
* Options: int("EL551.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL551.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL551.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL551.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EL551.
     3 AUTHOR.        PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:19.
     6*REMARKS.
     7*    THIS PROGRAM READS THE LETTER ARCHIVE FILE AND CREATES
     8*    A REPORT OF ALL LETTERS THAT HAVE A FOLLOW UP DATE IN
     9*    THE NEXT 5 DAYS.
    11 ENVIRONMENT DIVISION.
    12 INPUT-OUTPUT SECTION.
    13 FILE-CONTROL.
    14
    15     SELECT DISK-DATE            ASSIGN TO SYS019.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* EL551.cbl
    16     SELECT PRINTX               ASSIGN TO SYS008.
    17     SELECT FICH                 ASSIGN TO SYS020.
    18     SELECT ERARCH               ASSIGN TO ERARCH
    19            ACCESS IS DYNAMIC
    20            ORGANIZATION IS INDEXED
    21            FILE STATUS IS ERARCH-FILE-STATUS
    22            RECORD KEY IS ERARCH-KEY.
    23
    24     SELECT SORTFL               ASSIGN TO SORTWK1.
    25
    26     SELECT LETTER-EXTRACT       ASSIGN TO SYS012
    27        ORGANIZATION IS LINE SEQUENTIAL.
    28
    29 DATA DIVISION.
    30 FILE SECTION.
    31
    32
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* EL551.cbl
    34 FD  DISK-DATE
*   35                                 COPY ELCDTEFD.
    36******************************************************************04/15/98
    37*                                                                *ELCDTEFD
    38*                                                                *ELCDTEFD
    39*                            ELCDTEFD.                           *   LV002
    40*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    41*                            VMOD=2.007                          *   CL**2
    42*                                                                *ELCDTEFD
    43******************************************************************ELCDTEFD
    44     BLOCK CONTAINS 0 RECORDS
    45     RECORDING MODE F.                                            ELCDTEFD
    46                                                                  ELCDTEFD
    47 01  DATE-DISK.                                                   ELCDTEFD
    48     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    49     12  FILLER                      PIC  X(14).                  ELCDTEFD
    50     12  DD-CR1                      PIC  9.                      ELCDTEFD
    51     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    52     12  DD-CR2                      PIC  9.                      ELCDTEFD
    53     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    54     12  FILLER                      PIC  X(20).                  ELCDTEFD
    55                                                                  ELCDTEFD
    56 01  DATE-DISK-R.                                                 ELCDTEFD
    57     12  FILLER                      PIC  X(4).                   ELCDTEFD
    58     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
    59                                     PIC  X(32).                  ELCDTEFD
    60                                                                  ELCDTEFD
    61 01  DATE-DISK-T.                                                 ELCDTEFD
    62     12  FILLER                      PIC  X(4).                   ELCDTEFD
    63     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
    64                                     PIC  X(48).                  ELCDTEFD
    65                                                                  ELCDTEFD
    66 01  DATE-DISK-M.                                                 ELCDTEFD
    67     12  FILLER                      PIC  X(4).                   ELCDTEFD
    68     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
    69                                     PIC  X(48).                  ELCDTEFD
    70                                                                  ELCDTEFD
    71 01  DATE-DISK-P.                                                 ELCDTEFD
    72     12  DD-IDA                      PIC  XX.                     ELCDTEFD
    73     12  DD-IDX                      PIC  99.                     ELCDTEFD
    74     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
    75     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    76         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
    77                                     PIC  X.                      ELCDTEFD
    78         16  FILLER                  PIC  X(46).                  ELCDTEFD
    79     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    80         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
    81             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
    82             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
    83             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
    84             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
    85         16  FILLER                  PIC  X(16).                  ELCDTEFD
    86                                                                  ELCDTEFD
    87 01  DATE-DISK-E.                                                 ELCDTEFD
    88     12  FILLER                      PIC  X(4).                   ELCDTEFD
    89     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
    90                                     PIC  X(4).                   ELCDTEFD
    91                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
    92 01  DATE-DISK-C.                                                 ELCDTEFD
    93     12  FILLER                      PIC  X(7).                   ELCDTEFD
    94     12  DD-CARR1-SECPAY-SW          PIC  X.
    95     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
    96     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
    97     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
    98     12  DD-CARR1                    PIC  X.                      ELCDTEFD
    99     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   100     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   101     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   102     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   103     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   104     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   105     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   106     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   107     12  DD-CARR2-SECPAY-SW          PIC  X.
   108     12  FILLER                      PIC  X(7).                   ELCDTEFD
   109                                                                  ELCDTEFD
   110 01  DATE-DISK-OPT.                                               ELCDTEFD
   111     12  FILLER                      PIC  X(04).                  ELCDTEFD
   112     12  DD-TLR-DATA.                                             ELCDTEFD
   113         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   114                                     PIC  X(03).                  ELCDTEFD
   115     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   116         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   117                                     PIC  X(06).                  ELCDTEFD
   118     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   119         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   120                                     PIC  X(07).                  ELCDTEFD
   121         16  FILLER                  PIC  X(05).                  ELCDTEFD
   122     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   123                                     PIC  X(96).                  ELCDTEFD
   124******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* EL551.cbl
   126 FD  PRINTX
*  127                                 COPY ELCPRTFD.
   128******************************************************************04/15/98
   129*                                                                *ELCPRTFD
   130*                                                                *ELCPRTFD
   131*                            ELCPRTFD.                           *   LV003
   132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   133*                            VMOD=2.006                          *ELCPRTFD
   134******************************************************************ELCPRTFD
   135     RECORDING MODE F                                             ELCPRTFD
   136     LABEL RECORDS OMITTED                                        ELCPRTFD
   137     BLOCK CONTAINS 0 RECORDS
   138     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   139 01  PRT.                                                         ELCPRTFD
   140     12  P-CTL               PIC  X.                                 CL**2
   141     12  P-DATA              PIC  X(132).                         ELCPRTFD
   142******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* EL551.cbl
   144 FD  FICH
*  145                                 COPY ELCFCHFD.
   146******************************************************************04/15/98
   147*                                                                *ELCFCHFD
   148*                            ELCFCHFD.                           *   LV003
   149*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   150*                            VMOD=2.004                          *   CL**3
   151*                                                                *ELCFCHFD
   152******************************************************************ELCFCHFD
   153     BLOCK CONTAINS 0 RECORDS
   154     RECORDING MODE F.                                            ELCFCHFD
   155                                                                  ELCFCHFD
   156 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   157******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* EL551.cbl
   159 FD  ERARCH.
   160
   161 01  ERARCH-IN-RECORD.
   162     12  FILLER                  PIC XX.
   163     12  ERARCH-KEY              PIC X(5).
   164     12  FILLER                  PIC X(243).
   165
   166 SD  SORTFL.
   167
   168 01  SRT-REC.
   169     12  FILLER                  PIC X(73).
   170     12  SRT-PROC-ID             PIC X(4).
   171     12  FILLER                  PIC X(173).
   172
   173 FD  LETTER-EXTRACT
   174     LABEL RECORDS ARE STANDARD
   175     RECORDING MODE IS F
   176     BLOCK CONTAINS 0 RECORDS.
   177 01  LETTER-RECORD               PIC X(250).
   178
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* EL551.cbl
   180 WORKING-STORAGE SECTION.
   181 77  FILLER  PIC X(32) VALUE '********************************'.
   182 77  FILLER  PIC X(32) VALUE '      EL551   WORKING STORAGE   '.
   183 77  FILLER  PIC X(32) VALUE '********************************'.
   184 77  WS-CURRENT-BIN-DATE         PIC XX  VALUE LOW-VALUES.
   185 77  WS-CURRENT-DATE-PLUS-5      PIC XX  VALUE LOW-VALUES.
   186 77  WS-CURRENT-DATE-MINUS-5     PIC XX  VALUE LOW-VALUES.
   187 77  WS-PASS-RESEND-DT           PIC XX  VALUE LOW-VALUES.
   188 77  WS-EOF-SW                   PIC X  VALUE SPACES.
   189     88  END-OF-ERARCH              VALUE 'Y'.
   190     88  MORE-ERARCH                VALUE 'N'.
   191 77  WS-A                       PIC S9(03) COMP-3 VALUE +0.
   192 77  IYR                         PIC S9(03) COMP-3 VALUE +0.
   193 77  VYR                         PIC S9(03) COMP-3 VALUE +0.
   194 77  PAGE-CTR                    PIC S9(07) VALUE +0  COMP-3.
   195 77  LINE-CTR                    PIC S9(03) VALUE +99 COMP-3.
   196 77  SPACE-NP                    PIC X      VALUE '1'.
   197 77  SPACE-1                     PIC X      VALUE ' '.
   198 77  SPACE-2                     PIC X      VALUE '0'.
   199 77  SPACE-3                     PIC X      VALUE '-'.
   200 77  X                           PIC X      VALUE ' '.
   201 77  LNCTR                       PIC S999   VALUE +60 COMP-3.
   202 77  PGCTR                       PIC S9(5)  VALUE +0 COMP-3.
   203 77  ERARCH-IN-CNT               PIC 9(11)   VALUE ZEROS.
   204 77  RETURN-CNT                  PIC 9(11)   VALUE ZEROS.
   205 77  RELEASE-CNT                 PIC 9(11)   VALUE ZEROS.
   206 77  WS-SAVE-PROC-ID             PIC X(04)   VALUE SPACES.
   207 77  WS-HOLD-TYPE                PIC X(20)   VALUE SPACES.
   208
   209 01  HD1.
   210     12  FILLER              PIC  X(44)      VALUE SPACES.
   211     12  FILLER              PIC  X(44)      VALUE
   212             '     CORRESPONDENCE FOLLOW-UP REPORT       '.
   213     12  FILLER              PIC  X(31)      VALUE SPACES.
   214     12  FILLER              PIC  X(08)      VALUE 'EL551  '.
   215
   216 01  HD2.
   217     12  FILLER              PIC  X(51)      VALUE SPACES.
   218     12  HD-CO               PIC  X(30).
   219     12  FILLER              PIC  X(38)      VALUE SPACES.
   220     12  HD-RUN-DT           PIC  X(08)      VALUE SPACES.
   221
   222 01  HD3.
   223     12  FILLER              PIC  X(57)      VALUE SPACES.
   224     12  HD-DT               PIC  X(18).
   225     12  FILLER              PIC  X(44)      VALUE SPACES.
   226     12  FILLER              PIC  X(05)      VALUE 'PAGE '.
   227     12  HD-PG               PIC ZZ,ZZ9.
   228
   229 01  HD3-5.
   230     12  FILLER              PIC X(15)   VALUE SPACES.
   231     12  FILLER              PIC X(15)   VALUE 'PROCESSOR ID - '.
   232     12  HD3-5-PROC-ID       PIC X(4)    VALUE SPACES.
   233
   234 01  HD4.
   235     12  FILLER                  PIC X(133)  VALUE
   236         '      ACCT       CERT            FORM  ARCHIVE    LETTER
   237-        '    SCHEDULED                '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* EL551.cbl
   238
   239 01  HD5.
   240     12  FILLER                  PIC X(133)  VALUE
   241         ' CAR  NUMBER    NUMBER     SRCE  TYPE  NUMBER    CREATE
   242-        'DT   SUB REQ   BY   TYPE        STATUS'.
   243
   244
   245 01  WS-DETAIL                   PIC X(133)  VALUE SPACES.
   246
   247 01  WS-DETAIL1               REDEFINES
   248     WS-DETAIL.
   249     12  FILLER                  PIC XX.
   250     12  WS-B1-CARRIER           PIC X.
   251     12  FILLER                  PIC X.
   252     12  WS-B1-ACCOUNT-NO        PIC X(10).
   253     12  FILLER                  PIC X.
   254     12  WS-B1-CERT-NO           PIC X(11).
   255     12  FILLER                  PIC XX.
   256     12  WS-B1-DATA-SOURCE       PIC X(4).
   257     12  FILLER                  PIC XX.
   258     12  WS-B1-FORM-TYPE         PIC X(4).
   259     12  FILLER                  PIC X.
   260     12  WS-B1-ARCHIVE-NO        PIC Z(7)9.
   261     12  WS-B1-ARCHIVE-NO-X          REDEFINES
   262         WS-B1-ARCHIVE-NO        PIC X(8).
   263     12  FILLER                  PIC XX.
   264     12  WS-B1-ORIG-SEND-DATE    PIC X(8).
   265     12  WS-B1-NOT-PRINTED-FLAG  PIC X.
   266     12  FILLER                  PIC XX.
   267     12  WS-B1-SCHEDULED-RESEND-DATE PIC X(8).
   268     12  FILLER                  PIC XX.
   269     12  WS-B1-BY                PIC X(4).
   270     12  FILLER                  PIC XX.
   271     12  WS-B1-TYPE              PIC X(10).
   272     12  FILLER                  PIC XX.
   273     12  WS-B1-STATUS            PIC X(10).
   274     12  FILLER                  PIC X(50).
   275
   276 01  WS-MISC.
   277     05  ERARCH-FILE-STATUS      PIC XX.
   278     05  WS-HOLD-PRT             PIC X(133).
   279     05  INTERMED                PIC S9(9)V9(6)  COMP-3.
   280     05  WS-BIN-CR-DT            PIC XX  VALUE LOW-VALUES.
   281     05  WS-BIN-LF-END-DATE      PIC XX  VALUE LOW-VALUES.
   282     05  WS-BIN-AH-END-DATE      PIC XX  VALUE LOW-VALUES.
   283     05  WS-END-YEAR             PIC 9(11)  VALUE ZEROS.
   284     05  FILLER REDEFINES WS-END-YEAR.
   285         10  WS-CCYY             PIC 9(7).
   286         10  WS-MMDD             PIC 9(4).
   287 01  WS-DEBUG-AREA.
   288     12  WS-DEBUG-SW             PIC X(01) VALUE ' '.
   289         88  DEBUG-IS-ON                VALUES '1' '2' '3' '4'.
   290         88  DEBUG-LF-INFORCE-CNT       VALUE '1'.
   291         88  DEBUG-AH-INFORCE-CNT       VALUE '2'.
   292         88  DEBUG-LF-STATUTORY         VALUE '3'.
   293         88  DEBUG-AH-STATUTORY         VALUE '4'.
   294
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* EL551.cbl
   296
   297
   298 01  WS-ABEND-AREA.
   299     05  WS-ABEND-FILE-STATUS    PIC X(02).
   300     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
   301     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
   302     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
   303
   304 01  WORK-ABEND-CODE.
   305     12  WAC-1                   PIC X.
   306     12  WAC-2                   PIC X.
   307     12  WAC-3-4.
   308         16  WAC-3               PIC X.
   309         16  WAC-4               PIC X.
   310
   311 01  WS-EXTRACT-RECORD.
*  312                                 COPY FNC022.
   313     05  FX-COMMON-SECTION.                                       00010001
   314         10  FX-SYSTEM             PIC X(10).                     00020001
   315         10  FX-SOURCE-CODE        PIC X(6).                      00030001
   316         10  FX-DIVISION           PIC X(2).                      00040001
   317         10  FX-TRAN-TYPE          PIC X(2).                      00050001
   318         10  FX-SUB-TYPE           PIC X(2).                      00060001
   319         10  FX-CLM-RES            PIC X(2).                      00070001
   320         10  FX-ANN-STMT           PIC X(3).                      00080001
   321         10  FX-PLAN-CODE          PIC X(6).                      00090001
   322         10  FX-FORM               PIC X(3).                      00091001
   323         10  FX-JOURNAL-DATE       PIC X(8).                      00092001
   324         10  FX-POSTING-DATE       PIC X(8).                      00093001
   325         10  FX-POLICY-NO          PIC X(10).                     00094001
   326         10  FX-CITY               PIC X(30).                     00095002
   327         10  FX-STATE              PIC X(2).                      00095102
   328         10  FX-ZIP-CODE           PIC X(9).                      00096001
   329         10  FX-LOC-CODE           PIC X.                         00096102
   330         10  FX-FY-REN             PIC X.                         00097001
   331         10  FX-AGENT-01           PIC X(9).                      00098001
   332         10  FX-AGENT-50           PIC X(9).                      00099001
   333         10  FX-COST-CENTER        PIC X(4).                      00100001
   334         10  FX-TAXABLE            PIC X.                         00110004
   335         10  FX-DISTR              PIC X(2).                      00120001
   336         10  FX-SOURCE-ACCT        PIC X(10).                     00130001
   337         10  FX-DESCRIPTION        PIC X(30).                     00140001
   338         10  FX-REFERENCE          PIC X(10).                     00150001
   339         10  FX-SUSPENSE           PIC X(15).                     00151002
   340         10  FX-AMOUNT             PIC S9(10)V99                  00160001
   341                                   SIGN IS TRAILING SEPARATE.     00170001
   342                                                                  00180001
   343     05  FX-CLAIM-SECTION.                                        00190001
   344         10  FX-CLAIM-NO           PIC X(10).                     00200001
   345         10  FX-CLAIM-TYPE         PIC X.                         00210001
   346         10  FX-DRAFT-NO           PIC X(10).                     00220001
   347         10  FX-DRAFT-STATUS       PIC X.                         00230001
   348         10  FX-TAX-ID             PIC X(10).                     00240001
   349         10  FILLER                PIC X(10).                     00250003
   350                                                                  00290001
   351
   352
   353 01  DATE-AREAS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* EL551.cbl
   354     05  WS-TEST-RUN-DATE        PIC 9(11).
   355     05  WS-WORK-DATE            PIC 9(11).
   356     05  FILLER REDEFINES WS-WORK-DATE.
   357         10  FILLER              PIC XXX.
   358         10  WS-WORK-CCYY        PIC 9(4).
   359         10  WS-WORK-MMDD        PIC 9(4).
   360     05  WS-ISSUE-DATE           PIC 9(11).
   361     05  FILLER REDEFINES WS-ISSUE-DATE.
   362         10  FILLER              PIC XXX.
   363         10  WS-ISSUE-CCYY       PIC 9(4).
   364         10  WS-ISSUE-MMDD       PIC 9(4).
   365     05  WS-EXPIRE-DATE          PIC 9(11).
   366     05  FILLER REDEFINES WS-EXPIRE-DATE.
   367         10  FILLER              PIC XXX.
   368         10  WS-EXPIRE-CCYY      PIC 9(4).
   369         10  WS-EXPIRE-MMDD      PIC 9(4).
   370     05  WS-ENTRY-DATE           PIC 9(11).
   371     05  FILLER REDEFINES WS-ENTRY-DATE.
   372         10  FILLER              PIC XXX.
   373         10  WS-ENTRY-CCYY       PIC 9(4).
   374         10  WS-ENTRY-MMDD       PIC 9(4).
   375     05  WS-CANCEL-DATE          PIC 9(11).
   376     05  FILLER REDEFINES WS-CANCEL-DATE.
   377         10  FILLER              PIC XXX.
   378         10  WS-CANCEL-CCYY      PIC 9(4).
   379         10  WS-CANCEL-MMDD      PIC 9(4).
   380     05  WS-CLAIM-DATE           PIC 9(11).
   381     05  FILLER REDEFINES WS-CLAIM-DATE.
   382         10  FILLER              PIC XXX.
   383         10  WS-CLAIM-CCYY       PIC 9(4).
   384         10  WS-CLAIM-MMDD       PIC 9(4).
   385     05  WS-POSTING-DATE         PIC X(8).
   386     05  WS-HI-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
   387     05  WS-LO-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
   388     05  WS-HI-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
   389     05  WS-LO-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
   390     05  WS-BIN-VAL-DATES OCCURS 50
   391                                 PIC XX.
   392
   393 01  ABEND-FIELDS.
   394     12  PGM-SUB                 PIC S999 COMP  VALUE +064.
   395     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
   396         88  FIRST-TIME                 VALUE 'Y'.
   397
*  398                                 COPY ERCARCH.
   399******************************************************************04/19/98
   400*                                                                *ERCARCH
   401*                            ERCARCH.                            *   LV002
   402*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   403*                            VMOD=2.002                          *   CL**2
   404*                                                                *ERCARCH
   405*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *ERCARCH
   406*                                                                *ERCARCH
   407*   FILE TYPE = VSAM,KSDS                                        *ERCARCH
   408*   RECORD SIZE = 250  RECFORM = FIXED                           *ERCARCH
   409*                                                                *ERCARCH
   410*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *ERCARCH
   411*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *ERCARCH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* EL551.cbl (/apps/prod/cid1p/copy/ERCARCH)
   412*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *ERCARCH
   413*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *ERCARCH
   414*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *ERCARCH
   415*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *ERCARCH
   416*                                                                *ERCARCH
   417*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCARCH
   418******************************************************************ERCARCH
   419*                   C H A N G E   L O G
   420*
   421* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   422*-----------------------------------------------------------------
   423*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   424* EFFECTIVE    NUMBER
   425*-----------------------------------------------------------------
   426* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   427* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
   428* 110612    2012101700002  AJRA  ADD NEW FIELDS
   429******************************************************************
   430 01  LETTER-ARCHIVE.                                              ERCARCH
   431     12  LA-RECORD-ID                PIC  X(02).                  ERCARCH
   432         88  LA-VALID-ID                VALUE 'LA'.               ERCARCH
   433                                                                  ERCARCH
   434     12  LA-CONTROL-PRIMARY.                                      ERCARCH
   435         16  LA-COMPANY-CD           PIC  X(01).                  ERCARCH
   436         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.          ERCARCH
   437                                                                  ERCARCH
   438     12  LA-CONTROL-BY-CERT-RESP.                                 ERCARCH
   439         16  LA-COMPANY-CD-A2        PIC  X(01).                  ERCARCH
   440         16  LA-CERT-NO-A2.                                       ERCARCH
   441             20  LA-CERT-PRIME-A2    PIC  X(10).                  ERCARCH
   442             20  LA-CERT-SUFFIX-A2   PIC  X(01).                  ERCARCH
   443         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.            ERCARCH
   444             20  LA-RESP-PERSON-A2   PIC  X(10).                  ERCARCH
   445             20  LA-TYPE-A2          PIC  X(01).                  ERCARCH
   446         16  LA-CARRIER-A2           PIC  X(01).                  ERCARCH
   447         16  LA-GROUPING-A2          PIC  X(06).                  ERCARCH
   448         16  LA-STATE-A2             PIC  X(02).                  ERCARCH
   449         16  LA-ACCOUNT-A2           PIC  X(10).                  ERCARCH
   450         16  LA-EFFECT-DATE-A2       PIC  X(02).                  ERCARCH
   451         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.          ERCARCH
   452                                                                  ERCARCH
   453     12  LA-CONTROL-BY-FORM.                                      ERCARCH
   454         16  LA-COMPANY-CD-A3        PIC  X(01).                  ERCARCH
   455         16  LA-FORM-A3              PIC  X(04).                  ERCARCH
   456         16  LA-CARRIER-A3           PIC  X(01).                  ERCARCH
   457         16  LA-GROUPING-A3          PIC  X(06).                  ERCARCH
   458         16  LA-STATE-A3             PIC  X(02).                  ERCARCH
   459         16  LA-ACCOUNT-A3           PIC  X(10).                  ERCARCH
   460         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.          ERCARCH
   461                                                                  ERCARCH
   462     12  LA-CONTROL-BY-PROCESSOR.                                 ERCARCH
   463         16  LA-COMPANY-CD-A4        PIC  X(01).                  ERCARCH
   464         16  LA-PROCESSOR-CD         PIC  X(04).                  ERCARCH
   465         16  LA-CARRIER-A4           PIC  X(01).                  ERCARCH
   466         16  LA-GROUPING-A4          PIC  X(06).                  ERCARCH
   467         16  LA-STATE-A4             PIC  X(02).                  ERCARCH
   468         16  LA-ACCOUNT-A4           PIC  X(10).                  ERCARCH
   469         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.          ERCARCH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* EL551.cbl (/apps/prod/cid1p/copy/ERCARCH)
   470                                                                  ERCARCH
   471     12  LA-CONTROL-BY-KEY-FIELDS.                                ERCARCH
   472         16  LA-COMPANY-CD-A5        PIC  X(01).                  ERCARCH
   473         16  LA-CARRIER-A5           PIC  X(01).                  ERCARCH
   474         16  LA-GROUPING-A5          PIC  X(06).                  ERCARCH
   475         16  LA-STATE-A5             PIC  X(02).                  ERCARCH
   476         16  LA-ACCOUNT-A5           PIC  X(10).                  ERCARCH
   477         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.          ERCARCH
   478                                                                  ERCARCH
   479     12  LA-CONTROL-BY-GROUP-CODE.                                ERCARCH
   480         16  LA-COMPANY-CD-A6        PIC  X(01).                  ERCARCH
   481         16  LA-ENTRY-A6.                                         ERCARCH
   482             20  LA-FILLER           PIC  X(02).                  ERCARCH
   483             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.          ERCARCH
   484         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.          ERCARCH
   485                                                                  ERCARCH
   486     12  FILLER                      PIC  X(09).                  ERCARCH
   487                                                                  ERCARCH
   488     12  LA-HEADER-RECORD.                                        ERCARCH
   489         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.          ERCARCH
   490         16  LA-CREATION-DATE        PIC  X(02).                  ERCARCH
   491         16  LA-FOLLOW-UP-DATE       PIC  X(02).                  ERCARCH
   492         16  LA-FINAL-ACT-DATE       REDEFINES
   493               LA-FOLLOW-UP-DATE     PIC  X(02).
   494         16  LA-INITIAL-PRINT-DATE   PIC  X(02).                  ERCARCH
   495         16  LA-NO-OF-COPIES         PIC S9(01).                  ERCARCH
   496         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.          ERCARCH
   497         16  LA-REPLY-DATE           PIC  X(02).                  ERCARCH
   498         16  LA-RESEND-DATES.                                     ERCARCH
   499             20  LA-RESEND-DATE      PIC  X(02).                  ERCARCH
   500             20  LA-SENT-DATE        PIC  X(02).                  ERCARCH
   501             20  FILLER              PIC  X(08).
   502         16  LA-SOURCE-INFORMATION.                               ERCARCH
   503             20  LA-DATA-SOURCE      PIC  X(01).                  ERCARCH
   504             20  LA-ADDR-SOURCE      PIC  X(01).                  ERCARCH
   505         16  LA-STATUS               PIC  X(01).                  ERCARCH
   506             88  LA-STATUS-ACTIVE         VALUE 'A'.              ERCARCH
   507             88  LA-STATUS-COMPLETED      VALUE 'C'.              ERCARCH
   508             88  LA-STATUS-ON-HOLD        VALUE 'H'.              ERCARCH
   509             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.              ERCARCH
   510             88  LA-STATUS-PURGED         VALUE 'P'.              ERCARCH
   511             88  LA-STATUS-VOIDED         VALUE 'V'.              ERCARCH
   512         16  LA-LAST-RESENT-PRINT-DATE                            ERCARCH
   513                                     PIC  X(02).                  ERCARCH
   514         16  LA-PRINT-RESTRICTION    PIC  X(01).                  ERCARCH
   515             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN                    ERCARCH
   516                                          VALUE 'C'.              ERCARCH
   517             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN                    ERCARCH
   518                                          VALUE 'F'.              ERCARCH
   519             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN                    ERCARCH
   520                                          VALUE 'P'.              ERCARCH
   521         16  LA-PURGED-DATE          PIC  X(02).                  ERCARCH
   522         16  LA-VOIDED-DATE          PIC  X(02).
   523         16  LA-RESEND-LETR          PIC  X(4).
   524         16  FILLER                  PIC  X(08).
   525*        16  LA-RESEND-LETR-2        PIC  X(4).
   526*        16  LA-RESEND-LETR-3        PIC  X(4).
   527*        16  FILLER                  PIC  X(59).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* EL551.cbl (/apps/prod/cid1p/copy/ERCARCH)
   528         16  LA-ARCHIVE-STATUS       PIC  X.
   529             88  LA-TEMP                VALUE 'T'.
   530             88  LA-QWS                 VALUE 'Q'.
   531             88  LA-BATCH               VALUE 'B'.
   532         16  LA-FINAL-ACT-IND        PIC  X(1).
   533         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
   534         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
   535         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
   536                                     PIC X(4).
   537         16  FILLER                  PIC  X(42).
   538*        16  FILLER                  PIC  X(71).                  ERCARCH
   539         16  LA-LAST-MAINT-DATE      PIC  X(2).
   540         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
   541         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
   542                                     PIC  X(4).
   543         16  LA-LAST-UPDATED-BY      PIC  X(4).
   544                                                                  ERCARCH
   545******************************************************************ERCARCH
   546
*  547                                 COPY ELCDATE.
   548******************************************************************06/11/98
   549*                                                                *ELCDATE
   550*                                                                *ELCDATE
   551*                            ELCDATE.                            *   LV023
   552*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   553*                            VMOD=2.003                           ELCDATE
   554*                                                                *ELCDATE
   555*                                                                *ELCDATE
   556*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   557*                 LENGTH = 200                                   *   CL*19
   558******************************************************************ELCDATE
   559                                                                  ELCDATE
   560 01  DATE-CONVERSION-DATA.                                        ELCDATE
   561     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   562     12  DC-OPTION-CODE                PIC X.                        CL*15
   563         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   564         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   565         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   566         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   567         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   568         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   569         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   570         88  FIND-CENTURY               VALUE '7'.                   CL*22
   571         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   572         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   573         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   574         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   575         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   576         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   577         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   578         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   579         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   580         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   581         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   582         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   583         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   584         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   585         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* EL551.cbl (/apps/prod/cid1p/copy/ELCDATE)
   586         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   587         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   588         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   589         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   590         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   591         88  THREE-CHARACTER-BIN                                  ELCDATE
   592                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   593         88  GREGORIAN-TO-BIN                                        CL**2
   594                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   595         88  BIN-TO-GREGORIAN                                        CL**2
   596                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   597         88  JULIAN-TO-BINARY                                        CL**2
   598                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   599     12  DC-ERROR-CODE                 PIC X.                        CL*15
   600         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   601         88  DATE-CONVERSION-ERROR                                ELCDATE
   602                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   603         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   604         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   605         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   606         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   607         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   608         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   609         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   610         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   611         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   612         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   613     12  DC-END-OF-MONTH               PIC X.                        CL*15
   614         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   615     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   616         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   617         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   618         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   619     12  FILLER                        PIC X.                        CL*15
   620     12  DC-CONVERSION-DATES.                                        CL*15
   621         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   622         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   623         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   624         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   625                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   626             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   627             20  SLASH1-1              PIC X.                        CL*15
   628             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   629             20  SLASH1-2              PIC X.                        CL*15
   630             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   631         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   632         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   633                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   634             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   635             20  SLASH2-1              PIC X.                        CL*15
   636             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   637             20  SLASH2-2              PIC X.                        CL*15
   638             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   639         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   640         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   641                     DC-GREG-DATE-1-YMD.                          ELCDATE
   642             20  DC-YMD-YEAR           PIC 99.                       CL*15
   643             20  DC-YMD-MONTH          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* EL551.cbl (/apps/prod/cid1p/copy/ELCDATE)
   644             20  DC-YMD-DAY            PIC 99.                       CL*15
   645         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   646         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   647                      DC-GREG-DATE-1-MDY.                         ELCDATE
   648             20  DC-MDY-MONTH          PIC 99.                       CL*15
   649             20  DC-MDY-DAY            PIC 99.                       CL*15
   650             20  DC-MDY-YEAR           PIC 99.                       CL*15
   651         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   652             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   653             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   654             20  FILLER                PIC XX.                       CL*15
   655             20  DC-ALPHA-CENTURY.                                   CL*15
   656                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   657             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   658         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   659         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   660         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   661         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   662         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   663                                       PIC 9(05).                    CL*20
   664         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   665             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   666             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   667         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   668         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   669         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   670     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   671         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   672         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   673             20  FILLER                PIC 9(3).                     CL*15
   674             20  HOLD-CEN-1-CCYY.                                    CL*15
   675                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   676                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   677             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   678             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   679         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   680             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   681             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   682             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   683                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   684                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   685             20  FILLER                PIC 9(3).                     CL*15
   686         16  HOLD-CENTURY-1-X.                                       CL*15
   687             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   688             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   689                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   690                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   691             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   692             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   693         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   694             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   695             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   696             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   697                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   698                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   699             20  FILLER                PIC XXX.                      CL*23
   700         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   701         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* EL551.cbl (/apps/prod/cid1p/copy/ELCDATE)
   702         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   703         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   704             20  DC-JULIAN-1-CCYY.                                   CL*15
   705                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   706                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   707             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   708         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   709         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   710             20  DC-JULIAN-2-CCYY.                                   CL*15
   711                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   712                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   713             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   714         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   715             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   716             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   717             20  DC-EDITA-DAY          PIC 99.                       CL*15
   718             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   719             20  DC-EDITA-CCYY.                                      CL*15
   720                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   721                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   722         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   723             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   724             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   725             20  DC-EDITB-DAY          PIC 99.                       CL*15
   726             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   727             20  DC-EDITB-CCYY.                                      CL*15
   728                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   729                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   730         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   731         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   732                              DC-GREG-DATE-CYMD.                  ELCDATE
   733             20  DC-CYMD-CEN           PIC 99.                       CL*15
   734             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   735             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   736             20  DC-CYMD-DAY           PIC 99.                       CL*15
   737         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   738         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   739                              DC-GREG-DATE-MDCY.                  ELCDATE
   740             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   741             20  DC-MDCY-DAY           PIC 99.                       CL*15
   742             20  DC-MDCY-CEN           PIC 99.                       CL*15
   743             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   744    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   745        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   746    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   747    12  FILLER                         PIC X(28).                    CL*26
*  748                                 COPY ELCDTECX.
   749******************************************************************06/05/98
   750*                                                                *ELCDTECX
   751*                            ELCDTECX.                           *   LV005
   752*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   753*                            VMOD=2.015                          *ELCDTECX
   754*                                                                *ELCDTECX
   755*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   756*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   757*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   758*                                                                *ELCDTECX
   759******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   760******************************************************************
   761*                   C H A N G E   L O G
   762*
   763* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   764*-----------------------------------------------------------------
   765*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   766* EFFECTIVE    NUMBER
   767*-----------------------------------------------------------------
   768* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   769*                                  BENEFIT CODES FROM 300 TO 900
   770* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   771* 051304    2003080800002  SMVA  ADD REFUND METHOD
   772* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   773******************************************************************
   774 01  DATE-CARD.                                                   ELCDTECX
   775     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   776     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   777     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   778     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   779     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   780     12  EP-SW                       PIC  X.                      ELCDTECX
   781         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   782     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   783         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   784     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   785     12  RUN-CENTURY.                                             ELCDTECX
   786         16 RUN-CENTURY-N            PIC  99.                        CL**4
   787     12  FILLER                      PIC  X.                         CL**4
   788     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   789     12  FILLER                      PIC  XXX.                    ELCDTECX
   790     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   791                                                                  ELCDTECX
   792 01  FILLER                          PIC  X(7)                       CL**6
   793                                          VALUE 'OPTIONS'.        ELCDTECX
   794 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   795     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   796     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   797     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   798         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   799         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   800     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   801     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   802     12  FILLER                      PIC  X.                      ELCDTECX
   803     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   804     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   805     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   806     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   807     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   808     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   809     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   810     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   811     12  FILLER                      PIC  X.                      ELCDTECX
   812     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   813     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   814     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   815     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   816     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   817     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   818     12  FILLER                      PIC  X.                      ELCDTECX
   819     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   820     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   821     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   822     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   823     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   824     12  DTE-R78                     PIC  X.                      ELCDTECX
   825     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   826     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   827     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   828     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   829     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   830     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   831     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   832                                     PIC  X.                      ELCDTECX
   833         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   834                                                 ' '.             ELCDTECX
   835         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   836         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   837     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   838         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   839         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   840     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   841     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   842                                     PIC  9.                         CL**4
   843     12  DTE-SYSTEM.                                              ELCDTECX
   844         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   845         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   846         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   847         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   848         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   849         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   850         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   851         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   852         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   853         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   854         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   855         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   856         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   857         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   858         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   859         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   860         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   861         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   862         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   863         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   864         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   865         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   866         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   867         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   868         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   869         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   870     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   871         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   872                                     PIC  X.                      ELCDTECX
   873     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   874                                                                  ELCDTECX
   875 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   876     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   877     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   878     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   879*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   880     12  FILLER                      PIC  X.                      ELCDTECX
   881     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   882     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   883     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   884     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   885     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   886     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   887     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   888                                                                  ELCDTECX
   889     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   890     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   891     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   892     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   893                                                                  ELCDTECX
   894     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   895     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   896     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   897     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   898                                                                  ELCDTECX
   899     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   900     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   901                                                                  ELCDTECX
   902     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   903     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   904                                                                  ELCDTECX
   905     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   906                                                                  ELCDTECX
   907 01  DATE-CARD-FACTORS.                                           ELCDTECX
   908     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   909     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   910     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   911     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   912     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   913     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   914     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   915                                                                  ELCDTECX
   916 01  FILLER                          PIC  X(12)                   ELCDTECX
   917                                          VALUE 'COMPANY NAME'.   ELCDTECX
   918 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   919     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   920         16  CNT-ID                  PIC  X.                      ELCDTECX
   921         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   922                                                                  ELCDTECX
   923 01  FILLER                          PIC  X(11)                   ELCDTECX
   924                                          VALUE 'STATE NAMES'.    ELCDTECX
   925 01  STATE-NAMES.                                                 ELCDTECX
   926     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   927         16  STATE-SUB               PIC  XX.                     ELCDTECX
   928         16  STATE-PIC1.                                          ELCDTECX
   929             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   930             20  FILLER              PIC  XXX.                    ELCDTECX
   931             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   932             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   933             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   934             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   935                                                                  ELCDTECX
   936 01  FILLER                          PIC  X(13)                   ELCDTECX
   937                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   938 01  CARRIER-NAMES.                                               ELCDTECX
   939     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   940         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   941         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   942         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   943         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   944         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   945         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   946*        16  FILLER                  PIC  X.                      ELCDTECX
   947         16  CARRIER-SEC-PAY         PIC  X.
   948             88  SEC-PAY-CARRIER          VALUE 'Y'.
   949                                                                  ELCDTECX
   950 01  FILLER                          PIC  X(9)                       CL**6
   951                                          VALUE 'INS TYPES'.      ELCDTECX
   952 01  CLAS-INS-TYPES.                                              ELCDTECX
   953*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   954     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   955         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   956         16  CLAS-I-AB3.                                          ELCDTECX
   957             20  FILLER              PIC  X.                      ELCDTECX
   958             20  CLAS-I-AB2.                                      ELCDTECX
   959                 24  FILLER          PIC  X.                      ELCDTECX
   960                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   961         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   962             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   963             20  FILLER              PIC  X.                         CL**4
   964         16  CLAS-I-AB10.                                         ELCDTECX
   965             20  FILLER              PIC  X(9).                   ELCDTECX
   966             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   967         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   968         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   969         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   970         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   971             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   972         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   973         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   974         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   975         16  CLAS-I-BEN-CATEGORY     PIC  X.
   976         16  CLAS-I-REFUND-METHOD    PIC  X.
   977         16  CLAS-I-MAX-BENEFITS     PIC 99.
   978         16  FILLER                  PIC  XXX.
   979                                                                  ELCDTECX
   980 01  FILLER                          PIC  X(16)                   ELCDTECX
   981                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   982 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   983     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   984                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   985         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   986         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   987         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   988         16  CLAS-MORT-DESC.                                      ELCDTECX
   989             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   990             20  FILLER              PIC  XX.                        CL**5
   991             20  CLAS-YEAR           PIC  X(4).                      CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   992             20  FILLER              PIC  X.                         CL**5
   993             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   994             20  FILLER              PIC  X.                         CL**5
   995             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   996             20  FILLER              PIC  X.                         CL**5
   997             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   998             20  FILLER              PIC  X(5).                      CL**6
   999                                                                  ELCDTECX
  1000 01  FILLER                          PIC  X(15)                   ELCDTECX
  1001                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1002 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1003     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1004         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1005         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1006         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1007         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1008         16  FILLER                  PIC  X(4).                      CL**6
  1009                                                                  ELCDTECX
  1010 01  FILLER                          PIC  X(7)                       CL**6
  1011                                     VALUE 'INDEXES'.             ELCDTECX
  1012 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1013     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1014     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1015     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1016     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1017     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1018     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1019     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1020     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1021     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1022     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1023     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1024     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1025     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1026     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1027     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1028     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1029     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1030                                                                  ELCDTECX
  1031 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1032     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1033     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1034     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1035     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1036     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1037     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1038     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1039     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1040     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1041     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1042     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1043                                                                  ELCDTECX
  1044 01  FILLER                          PIC  X(13)                   ELCDTECX
  1045                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1046 01  CLAS-MISC.                                                   ELCDTECX
  1047     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1048         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1049         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1050         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1051     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1052     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1053     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1054     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1055     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1056     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1057     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1058     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1059     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1060     12  STATE-L                     PIC  XX.                     ELCDTECX
  1061     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1062     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1063     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1064         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1065         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1066     12  DTE-ABEND-WORK.                                          ELCDTECX
  1067         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1068         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1069                                                                  ELCDTECX
  1070 01  FILLER                          PIC  X(12)                   ELCDTECX
  1071                                     VALUE 'WORKING DATE'.        ELCDTECX
  1072 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1073     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1074         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1075         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1076         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1077     12  WS-CURRENT-DATE.                                         ELCDTECX
  1078         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1079         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1080         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1081         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1082         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1083     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1084         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1085         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1086                                                                  ELCDTECX
  1087 01  FILLER                          PIC  X(12)                   ELCDTECX
  1088                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1089 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1090     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1091         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1092         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1093         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1094                                                                  ELCDTECX
  1095 01  FILLER                          PIC  X(10)                   ELCDTECX
  1096                                     VALUE 'STATE TLRS'.          ELCDTECX
  1097 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1098     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1099         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1100         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1101                                                                  ELCDTECX
  1102 01  FILLER                          PIC  X(13)                   ELCDTECX
  1103                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1104 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1105     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1106         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1107                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1108 01  FILLER                          PIC  X(13)                   ELCDTECX
  1109                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1110 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1111     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1112     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1113     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1114                                     PIC  X.                         CL**5
  1115     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1116     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1117     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1118     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1119     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1120     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1121     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1122     12  FILLER                      PIC  X(75).                  ELCDTECX
  1123******************************************************************ELCDTECX
  1124*01  MISC-CARR-PCT-DATA.                                          00001521
  1125*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1126*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1127*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1128*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1129*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1130*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1131******************************************************************ELCDTECX
* 1132                                 COPY ELCDTEVR.
  1133***************************************************************** 04/15/98
  1134*                                                                *ELCDTEVR
  1135*                                                                *ELCDTEVR
  1136*                            ELCDTEVR.                           *   LV003
  1137*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1138*                            VMOD=2.001                          *   CL**2
  1139*                                                                *ELCDTEVR
  1140*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1141*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1142*                                                                *ELCDTEVR
  1143******************************************************************ELCDTEVR
  1144 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1145     05  WS-RUN-DATE.                                             ELCDTEVR
  1146         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1147         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1148         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1149             15  RUN-CC              PIC  99.                     ELCDTEVR
  1150             15  RUN-YR              PIC  99.                     ELCDTEVR
  1151         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1152         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1153     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1154            WS-RUN-DATE              PIC 9(11).                      CL**2
  1155     05  WS-EP-DT.                                                ELCDTEVR
  1156         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1157         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1158         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1159             15  EP-CC               PIC  99.                     ELCDTEVR
  1160             15  EP-YR               PIC  99.                     ELCDTEVR
  1161         10  EP-MO                   PIC  99.                     ELCDTEVR
  1162         10  EP-DA                   PIC  99.                     ELCDTEVR
  1163     05  WS-EP-DT-N REDEFINES                                        CL**2
  1164            WS-EP-DT                 PIC 9(11).                      CL**2
  1165     05  WS-DTE-CONV-DT.                                             CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1166         10  FILLER                  PIC  9(03).                     CL**4
  1167         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1168         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1169             15  DTE-CONV-CC         PIC  99.                        CL**4
  1170             15  DTE-CONV-YR         PIC  99.                        CL**4
  1171         10  DTE-CONV-MO             PIC  99.                        CL**4
  1172         10  DTE-CONV-DA             PIC  99.                        CL**4
  1173     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1174            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1175 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1176     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1177         10  FILLER                            PIC 999.           ELCDTEVR
  1178         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1179         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1180             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1181             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1182         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1183         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1184     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1185            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1186     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1187         10  FILLER                            PIC 999.           ELCDTEVR
  1188         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1189         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1190         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1191         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1192     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1193            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1194 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1195     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1196         10  FILLER                            PIC 999.           ELCDTEVR
  1197         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1198         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1199             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1200             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1201         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1202         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1203     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1204            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1205     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1206         10  FILLER                            PIC 999.           ELCDTEVR
  1207         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1208         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1209             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1210             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1211         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1212         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1213     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1214            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1215     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1216         10  FILLER                            PIC 999.           ELCDTEVR
  1217         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1218         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1219             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1220             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1221         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1222         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1223     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1224            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1225 01  WS-RATE-RECORD.                                              ELCDTEVR
  1226         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1227             10  FILLER                        PIC 999.           ELCDTEVR
  1228             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1229             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1230                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1231                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1232             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1233             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1234         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1235                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1236
  1237 PROCEDURE DIVISION.
  1238
  1239 0001-DT-CRD-READ.
* 1240                                 COPY ELCDTERX.
  1241******************************************************************04/15/98
  1242*                                                                *ELCDTERX
  1243*                                                                *ELCDTERX
  1244*                            ELCDTERX.                           *   LV002
  1245*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1246*                            VMOD=2.007                          *ELCDTERX
  1247*                                                                *ELCDTERX
  1248*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1249*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1250*      = ELCDTEFD)                                               *ELCDTERX
  1251*                                                                *ELCDTERX
  1252******************************************************************ELCDTERX
  1253                                                                  ELCDTERX
  1254     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1255                                                                  ELCDTERX
  1256     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1257     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1258     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1259                                                                  ELCDTERX
  1260     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1261                                                                  ELCDTERX
  1262******************************************************************ELCDTERX
  1263*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1264*          WARNING MESSAGES.                                      ELCDTERX
  1265******************************************************************ELCDTERX
  1266     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1267         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1268                                                                  ELCDTERX
  1269     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1270                                                                  ELCDTERX
  1271     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1272                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1273                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1274                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1275                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1276                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1277                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1278                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1279                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1280                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1281                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1282     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1283                                                                  ELCDTERX
  1284     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1285                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1286                                                                  ELCDTERX
  1287     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1288     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1289     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1290     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1291                                                                  ELCDTERX
  1292     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1293         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1294     ELSE                                                         ELCDTERX
  1295         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1296                                                                  ELCDTERX
  1297     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1298         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1299     ELSE                                                         ELCDTERX
  1300         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1301                                                                  ELCDTERX
  1302 0005-READ--CARD.                                                 ELCDTERX
  1303     READ DISK-DATE                                               ELCDTERX
  1304         AT END CLOSE DISK-DATE                                   ELCDTERX
  1305             GO TO 0060-READ--TEST.                               ELCDTERX
  1306                                                                  ELCDTERX
  1307     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1308                                                                  ELCDTERX
  1309     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1310         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1311         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1312         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1313         GO TO 0005-READ--CARD.                                   ELCDTERX
  1314                                                                  ELCDTERX
  1315     IF DD-ID = 'CLAD'                                            ELCDTERX
  1316         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1317         GO TO 0005-READ--CARD.                                   ELCDTERX
  1318                                                                  ELCDTERX
  1319     IF DD-ID = 'CLAX'                                            ELCDTERX
  1320         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1321         GO TO 0005-READ--CARD.                                   ELCDTERX
  1322                                                                  ELCDTERX
  1323     IF DD-ID = 'CLAF'                                            ELCDTERX
  1324         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1325         GO TO 0005-READ--CARD.                                   ELCDTERX
  1326                                                                  ELCDTERX
  1327     IF DD-ID = 'CLAC'                                            ELCDTERX
  1328         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1329                                                                  ELCDTERX
  1330     IF DD-ID = 'CARR'                                            ELCDTERX
  1331         GO TO 0015-READ--CARR.                                   ELCDTERX
  1332                                                                  ELCDTERX
  1333     IF DD-ID = 'STAT'                                            ELCDTERX
  1334         GO TO 0020-READ--STAT.                                   ELCDTERX
  1335                                                                  ELCDTERX
  1336     IF DD-ID = 'BUSC'                                            ELCDTERX
  1337         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1338                                                                  ELCDTERX
  1339     IF DD-ID = 'MORT'                                            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1340         GO TO 0030-READ--MORT.                                   ELCDTERX
  1341                                                                  ELCDTERX
  1342     IF DD-ID = 'CLAI'                                            ELCDTERX
  1343         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1344                                                                  ELCDTERX
  1345     IF DD-ID = 'COLC'                                            ELCDTERX
  1346         GO TO 0065-READ--COLC.                                   ELCDTERX
  1347                                                                  ELCDTERX
  1348     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1349        DD-IDA = 'CL'                                             ELCDTERX
  1350         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1351                                                                  ELCDTERX
  1352     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1353        DD-IDA = 'PO'                                             ELCDTERX
  1354         GO TO 0050-READ--POXX.                                   ELCDTERX
  1355                                                                  ELCDTERX
  1356     IF DD-ID = 'OPCA'                                            ELCDTERX
  1357         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1358                                                                  ELCDTERX
  1359     IF DD-ID = 'OPST'                                            ELCDTERX
  1360         GO TO 0072-READ--OPST.                                   ELCDTERX
  1361                                                                  ELCDTERX
  1362     IF DD-ID = 'OPBS'                                            ELCDTERX
  1363         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1364                                                                  ELCDTERX
  1365     IF DD-ID = 'OPMS'                                            ELCDTERX
  1366         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1367                                                                  ELCDTERX
  1368     GO TO 0005-READ--CARD.                                       ELCDTERX
  1369                                                                  ELCDTERX
  1370 0010-READ--CLAC.                                                 ELCDTERX
  1371     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1372     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1373     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1374     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1375     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1376     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1377     GO TO 0005-READ--CARD.                                       ELCDTERX
  1378                                                                  ELCDTERX
  1379 0015-READ--CARR.                                                 ELCDTERX
  1380     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1381     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1382        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1383        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1384        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1385        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1386        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1387        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1388        MOVE DD-CARR1-SECPAY-SW
  1389                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1390     END-IF
  1391                                                                  ELCDTERX
  1392     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1393     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1394        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1395        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1396        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1397        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1398        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1399        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1400        MOVE DD-CARR2-SECPAY-SW
  1401                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1402     END-IF
  1403                                                                  ELCDTERX
  1404                                                                  ELCDTERX
  1405     GO TO 0005-READ--CARD.                                       ELCDTERX
  1406                                                                  ELCDTERX
  1407 0020-READ--STAT.                                                 ELCDTERX
  1408     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1409     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1410        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1411         GO TO 0005-READ--CARD.                                   ELCDTERX
  1412                                                                  ELCDTERX
  1413     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1414     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1415     GO TO 0020-READ--STAT.                                       ELCDTERX
  1416                                                                  ELCDTERX
  1417 0025-READ--BUSC.                                                 ELCDTERX
  1418     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1419     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1420        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1421         GO TO 0005-READ--CARD.                                   ELCDTERX
  1422                                                                  ELCDTERX
  1423     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1424     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1425     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1426                                                                  ELCDTERX
  1427 0030-READ--MORT.                                                 ELCDTERX
  1428     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1429     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1430        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1431         GO TO 0005-READ--CARD.                                   ELCDTERX
  1432                                                                  ELCDTERX
  1433     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1434     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1435     GO TO 0030-READ--MORT.                                       ELCDTERX
  1436                                                                  ELCDTERX
  1437 0035-READ--CLXX.                                                 ELCDTERX
  1438     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1439          GO TO 0005-READ--CARD.                                  ELCDTERX
  1440                                                                  ELCDTERX
  1441     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1442         DISPLAY '***********************************************'ELCDTERX
  1443         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1444         DISPLAY '***********************************************'ELCDTERX
  1445         GO TO 0055-READ--STOP.                                   ELCDTERX
  1446                                                                  ELCDTERX
  1447     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1448        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1449         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1450                                                                  ELCDTERX
  1451     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1452        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1453         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1454                                                                  ELCDTERX
  1455*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1456     GO TO 0005-READ--CARD.                                       ELCDTERX
  1457                                                                  ELCDTERX
  1458 0040-READ--CLAI.                                                 ELCDTERX
  1459     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1460     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1461        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1462         GO TO 0005-READ--CARD.                                   ELCDTERX
  1463                                                                  ELCDTERX
  1464     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1465     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1466     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1467                                                                  ELCDTERX
  1468 0045-READ--DUMP.                                                 ELCDTERX
  1469     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1470     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1471                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1472     PERFORM ABEND-PGM.                                           ELCDTERX
  1473                                                                  ELCDTERX
  1474 0050-READ--POXX.                                                 ELCDTERX
  1475     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1476         GO TO 0005-READ--CARD.                                   ELCDTERX
  1477                                                                  ELCDTERX
  1478     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1479         DISPLAY '***********************************************'ELCDTERX
  1480         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1481         DISPLAY '***********************************************'ELCDTERX
  1482         GO TO 0055-READ--STOP.                                   ELCDTERX
  1483                                                                  ELCDTERX
  1484     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1485     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1486     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1487     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1488                                                                  ELCDTERX
  1489     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1490         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1491     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1492         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1493                                                                  ELCDTERX
  1494     GO TO 0005-READ--CARD.                                       ELCDTERX
  1495                                                                  ELCDTERX
  1496 0055-READ--STOP.                                                 ELCDTERX
  1497     GOBACK.                                                      ELCDTERX
  1498                                                                  ELCDTERX
  1499 0060-READ--TEST.                                                 ELCDTERX
  1500     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1501        CLAX-ID         = SPACE  OR                               ELCDTERX
  1502        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1503         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1504                                                                  ELCDTERX
  1505     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1506     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1507                                                                  ELCDTERX
  1508 0065-READ--COLC.                                                 ELCDTERX
  1509     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1510     GO TO 0005-READ--CARD.                                       ELCDTERX
  1511                                                                  ELCDTERX
  1512 0070-READ--OPCA.                                                 ELCDTERX
  1513                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* EL551.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1514     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1515                                                                  ELCDTERX
  1516     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1517             OR                                                   ELCDTERX
  1518         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1519         GO TO 0005-READ--CARD.                                   ELCDTERX
  1520                                                                  ELCDTERX
  1521     ADD 1                       TO INDEXCA.                      ELCDTERX
  1522     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1523                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1524     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1525                                                                  ELCDTERX
  1526 0072-READ--OPST.                                                 ELCDTERX
  1527                                                                  ELCDTERX
  1528     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1529                                                                  ELCDTERX
  1530     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1531             OR                                                   ELCDTERX
  1532         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1533         GO TO 0005-READ--CARD.                                   ELCDTERX
  1534                                                                  ELCDTERX
  1535     ADD 1                       TO INDEXST.                      ELCDTERX
  1536     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1537                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1538     GO TO 0072-READ--OPST.                                       ELCDTERX
  1539                                                                  ELCDTERX
  1540 0074-READ--OPBS.                                                 ELCDTERX
  1541                                                                  ELCDTERX
  1542     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1543                                                                  ELCDTERX
  1544     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1545             OR                                                   ELCDTERX
  1546         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1547         GO TO 0005-READ--CARD.                                   ELCDTERX
  1548                                                                  ELCDTERX
  1549     ADD 1                       TO INDEXBS.                      ELCDTERX
  1550     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1551     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1552                                                                  ELCDTERX
  1553 0079-READ--EXIT.                                                 ELCDTERX
  1554*    EXIT.                                                        ELCDTERX
  1555******************************************************************ELCDTERX
  1556
  1557     SORT SORTFL ON ASCENDING KEY SRT-PROC-ID
  1558        INPUT PROCEDURE
  1559           0001-INPUT-RTN        THRU 0001-EXIT
  1560        OUTPUT PROCEDURE
  1561           0100-OUTPUT-RTN       THRU 0100-EXIT.
  1562
  1563     IF SORT-RETURN NOT = ZEROES
  1564        MOVE +0101               TO WS-RETURN-CODE
  1565        MOVE '   SORT ABORTED'   TO WS-ABEND-MESSAGE
  1566        PERFORM ABEND-PGM
  1567     END-IF
  1568
  1569     GOBACK
  1570     .
  1571 0001-INPUT-RTN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* EL551.cbl
  1572
  1573     DISPLAY ' BEGIN SORT INPUT ROUTINE '
  1574
  1575     PERFORM 0010-OPEN-ERARCH    THRU 0010-EXIT
  1576
  1577     PERFORM 0020-INITIALIZE     THRU 0020-EXIT
  1578
  1579     PERFORM 0025-SELECT-RECS    THRU 0025-EXIT UNTIL
  1580        END-OF-ERARCH
  1581
  1582     SET MORE-ERARCH             TO TRUE
  1583     DISPLAY ' ERARCH RECORDS READ ' ERARCH-IN-CNT
  1584     DISPLAY ' RECORDS RELEASED    ' RELEASE-CNT
  1585
  1586     PERFORM 0070-CLOSE-ERARCH   THRU 0070-EXIT
  1587
  1588     .
  1589 0001-EXIT.
  1590     EXIT.
  1591
  1592 0010-OPEN-ERARCH.
  1593
  1594     OPEN INPUT ERARCH
  1595
  1596     IF ERARCH-FILE-STATUS = '00' OR '97'
  1597        CONTINUE
  1598     ELSE
  1599        DISPLAY ' ERROR ON ERARCH OPEN  '
  1600           ERARCH-FILE-STATUS
  1601        MOVE ' ERROR ON ERARCH OPEN  '
  1602                                 TO WS-ABEND-MESSAGE
  1603        MOVE ERARCH-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  1604        PERFORM ABEND-PGM
  1605     END-IF
  1606
  1607     .
  1608 0010-EXIT.
  1609     EXIT.
  1610
  1611 0020-INITIALIZE.
  1612
  1613     DISPLAY ' ACCEPT DATE ' WS-ACCEPT-DATE
  1614
  1615     MOVE WS-ACCEPT-DATE         TO DC-GREG-DATE-1-YMD
  1616     MOVE '3'                    TO DC-OPTION-CODE
  1617     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1618     IF NO-CONVERSION-ERROR
  1619        MOVE DC-BIN-DATE-1       TO WS-CURRENT-BIN-DATE
  1620     ELSE
  1621        DISPLAY ' ERROR CONVERTING CURRENT DATE '
  1622     END-IF
  1623
  1624     MOVE COMPANY-NAME           TO HD-CO
  1625     MOVE ALPH-DATE              TO HD-DT
  1626     MOVE WS-CURRENT-DATE        TO HD-RUN-DT
  1627
  1628     MOVE RUN-DATE               TO WS-TEST-RUN-DATE
  1629
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* EL551.cbl
  1630     MOVE WS-CURRENT-BIN-DATE    TO DC-BIN-DATE-1
  1631     MOVE -5                     TO DC-ELAPSED-DAYS
  1632     MOVE ZERO                   TO DC-ELAPSED-MONTHS
  1633     MOVE '6'                    TO DC-OPTION-CODE
  1634     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1635     MOVE DC-BIN-DATE-2          TO WS-CURRENT-DATE-MINUS-5
  1636
  1637     MOVE WS-CURRENT-BIN-DATE    TO DC-BIN-DATE-1
  1638     MOVE +5                     TO DC-ELAPSED-DAYS
  1639     MOVE ZERO                   TO DC-ELAPSED-MONTHS
  1640     MOVE '6'                    TO DC-OPTION-CODE
  1641     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1642     MOVE DC-BIN-DATE-2          TO WS-CURRENT-DATE-PLUS-5
  1643
  1644     PERFORM 0050-START-ERARCH   THRU 0050-EXIT
  1645     PERFORM 0060-READ-ERARCH    THRU 0060-EXIT
  1646
  1647     .
  1648 0020-EXIT.
  1649     EXIT.
  1650
  1651 0025-SELECT-RECS.
  1652
  1653     PERFORM 0030-SELECT-RECS    THRU 0030-EXIT
  1654
  1655     PERFORM 0060-READ-ERARCH    THRU 0060-EXIT
  1656
  1657     .
  1658 0025-EXIT.
  1659     EXIT.
  1660
  1661 0030-SELECT-RECS.
  1662
  1663     IF (LA-FORM-A3 = '9999')
  1664                  OR
  1665        (LA-STATUS = 'C' OR 'V')
  1666                 OR
  1667        (LA-REPLY-DATE NOT = SPACES AND LOW-VALUES)
  1668        GO TO 0030-EXIT
  1669     END-IF
  1670
  1671     IF (LA-INITIAL-PRINT-DATE = LOW-VALUES)
  1672                     OR
  1673        ((LA-FOLLOW-UP-DATE >= WS-CURRENT-DATE-MINUS-5)
  1674        AND (LA-FOLLOW-UP-DATE <= WS-CURRENT-DATE-PLUS-5))
  1675                     OR
  1676        ((LA-SENT-DATE = LOW-VALUES)
  1677         AND (LA-RESEND-DATE > LOW-VALUES)
  1678         AND (LA-RESEND-DATE <= WS-CURRENT-DATE-PLUS-5))
  1679         PERFORM 0040-RELEASE     THRU 0040-EXIT
  1680     END-IF
  1681
  1682     .
  1683 0030-EXIT.
  1684     EXIT.
  1685
  1686 0040-RELEASE.
  1687
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* EL551.cbl
  1688     IF LA-FORM-A3 (1:3) = 'EL0'
  1689        CONTINUE
  1690     ELSE
  1691        MOVE 'KRHA'              TO LA-PROCESSOR-CD
  1692     END-IF
  1693     RELEASE SRT-REC             FROM LETTER-ARCHIVE
  1694     ADD 1                       TO RELEASE-CNT
  1695
  1696     .
  1697 0040-EXIT.
  1698     EXIT.
  1699
  1700 0050-START-ERARCH.
  1701
  1702     MOVE LOW-VALUES             TO ERARCH-KEY
  1703     MOVE DTE-CLASIC-COMPANY-CD  TO ERARCH-KEY (1:1)
  1704     START ERARCH KEY >= ERARCH-KEY
  1705
  1706     IF ERARCH-FILE-STATUS = '10' OR '23'
  1707        SET END-OF-ERARCH        TO TRUE
  1708     ELSE
  1709        IF ERARCH-FILE-STATUS NOT = '00'
  1710           MOVE ' ERROR ON ERARCH  START     '
  1711                                 TO WS-ABEND-MESSAGE
  1712           MOVE ERARCH-FILE-STATUS
  1713                                 TO WS-ABEND-FILE-STATUS
  1714           DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  1715           PERFORM ABEND-PGM
  1716        END-IF
  1717     END-IF
  1718
  1719     .
  1720 0050-EXIT.
  1721     EXIT.
  1722
  1723 0060-READ-ERARCH.
  1724
  1725     READ ERARCH NEXT RECORD INTO LETTER-ARCHIVE
  1726
  1727     IF (ERARCH-FILE-STATUS = '10' OR '23')
  1728        OR (LA-COMPANY-CD NOT = DTE-CLASIC-COMPANY-CD)
  1729        SET END-OF-ERARCH        TO TRUE
  1730     ELSE
  1731        IF ERARCH-FILE-STATUS NOT = '00'
  1732           MOVE ' ERROR ON ERARCH READ NEXT  '
  1733                                 TO WS-ABEND-MESSAGE
  1734           MOVE ERARCH-FILE-STATUS
  1735                                 TO WS-ABEND-FILE-STATUS
  1736           DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  1737           PERFORM ABEND-PGM
  1738        ELSE
  1739           ADD +1                TO ERARCH-IN-CNT
  1740        END-IF
  1741     END-IF
  1742
  1743     .
  1744 0060-EXIT.
  1745     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* EL551.cbl
  1746
  1747 0070-CLOSE-ERARCH.
  1748
  1749     CLOSE ERARCH
  1750
  1751     IF ERARCH-FILE-STATUS = '00' OR '97'
  1752        CONTINUE
  1753     ELSE
  1754        DISPLAY ' ERROR ON ERARCH CLOSE '
  1755           ERARCH-FILE-STATUS
  1756        MOVE ' ERROR ON ERARCH CLOSE '
  1757                                 TO WS-ABEND-MESSAGE
  1758        MOVE ERARCH-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  1759        PERFORM ABEND-PGM
  1760     END-IF
  1761
  1762     .
  1763 0070-EXIT.
  1764     EXIT.
  1765
  1766 0100-OUTPUT-RTN.
  1767
  1768     DISPLAY ' BEGIN SORT INPUT ROUTINE '
  1769
  1770     PERFORM 0110-OPEN-OUTPUT    THRU 0110-EXIT
  1771
  1772     PERFORM 0120-INITIALIZE     THRU 0120-EXIT
  1773
  1774     PERFORM 0130-PROCESS-FILE   THRU 0130-EXIT UNTIL
  1775        END-OF-ERARCH
  1776
  1777     PERFORM 0170-CLOSE-OUTPUT   THRU 0170-EXIT
  1778
  1779     DISPLAY ' RETURNED RECORDS   ' RETURN-CNT
  1780     .
  1781 0100-EXIT.
  1782     EXIT.
  1783
  1784 0110-OPEN-OUTPUT.
  1785
  1786     OPEN OUTPUT PRINTX LETTER-EXTRACT
  1787
  1788     .
  1789 0110-EXIT.
  1790     EXIT.
  1791
  1792 0120-INITIALIZE.
  1793
  1794     PERFORM 0140-RETURN-ERARCH  THRU 0140-EXIT
  1795
  1796     MOVE LA-PROCESSOR-CD        TO WS-SAVE-PROC-ID
  1797                                    HD3-5-PROC-ID
  1798     .
  1799 0120-EXIT.
  1800     EXIT.
  1801
  1802 0130-PROCESS-FILE.
  1803
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  36
* EL551.cbl
  1804     IF LA-PROCESSOR-CD NOT = WS-SAVE-PROC-ID
  1805        MOVE LA-PROCESSOR-CD     TO HD3-5-PROC-ID
  1806                                    WS-SAVE-PROC-ID
  1807        MOVE +60                 TO LNCTR
  1808     END-IF
  1809
  1810     IF (LA-FOLLOW-UP-DATE >= WS-CURRENT-DATE-MINUS-5
  1811        AND <= WS-CURRENT-DATE-PLUS-5)
  1812        MOVE 'FOLLOW UP'         TO WS-HOLD-TYPE
  1813        PERFORM 0150-FOLLOW-UP   THRU 0150-EXIT
  1814     END-IF
  1815
  1816     IF LA-INITIAL-PRINT-DATE = LOW-VALUES
  1817        MOVE ' INITIAL '         TO WS-HOLD-TYPE
  1818        PERFORM 0160-RESENDS     THRU 0160-EXIT
  1819     END-IF
  1820
  1821     IF (LA-SENT-DATE = LOW-VALUES)
  1822        AND (LA-RESEND-DATE > LOW-VALUES)
  1823        DISPLAY ' FOUND ONE ' LA-CERT-NO-A2
  1824        MOVE LA-RESEND-DATE      TO WS-PASS-RESEND-DT
  1825        MOVE ' SUB REQ '         TO WS-HOLD-TYPE
  1826        PERFORM 0160-RESENDS     THRU 0160-EXIT
  1827     END-IF
  1828
  1829     PERFORM 0140-RETURN-ERARCH  THRU 0140-EXIT
  1830
  1831     .
  1832 0130-EXIT.
  1833     EXIT.
  1834
  1835 0140-RETURN-ERARCH.
  1836
  1837     RETURN SORTFL INTO LETTER-ARCHIVE AT END
  1838        SET END-OF-ERARCH        TO TRUE
  1839     END-RETURN
  1840
  1841     IF NOT END-OF-ERARCH
  1842        ADD 1                    TO RETURN-CNT
  1843     END-IF
  1844
  1845     .
  1846 0140-EXIT.
  1847     EXIT.
  1848
  1849
  1850 0150-FOLLOW-UP.
  1851
  1852     DISPLAY ' MADE IT TO FOLLOW UP'
  1853     MOVE SPACES                 TO WS-DETAIL
  1854
  1855     MOVE LA-FOLLOW-UP-DATE      TO DC-BIN-DATE-1
  1856     MOVE ' '                    TO DC-OPTION-CODE
  1857     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1858     IF NO-CONVERSION-ERROR
  1859        MOVE DC-GREG-DATE-1-EDIT TO WS-B1-SCHEDULED-RESEND-DATE
  1860     ELSE
  1861        MOVE SPACES              TO WS-B1-SCHEDULED-RESEND-DATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  37
* EL551.cbl
  1862     END-IF
  1863
  1864     PERFORM 0165-COMMON-FORMAT  THRU 0165-EXIT
  1865
  1866     .
  1867 0150-EXIT.
  1868     EXIT.
  1869
  1870 0160-RESENDS.
  1871
  1872     DISPLAY ' MADE IT TO RESENDS  '
  1873     MOVE SPACES                 TO WS-DETAIL
  1874
  1875     MOVE WS-PASS-RESEND-DT      TO DC-BIN-DATE-1
  1876     MOVE ' '                    TO DC-OPTION-CODE
  1877     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1878     IF NO-CONVERSION-ERROR
  1879        MOVE DC-GREG-DATE-1-EDIT TO WS-B1-SCHEDULED-RESEND-DATE
  1880     ELSE
  1881        MOVE SPACES              TO WS-B1-SCHEDULED-RESEND-DATE
  1882     END-IF
  1883
  1884     PERFORM 0165-COMMON-FORMAT  THRU 0165-EXIT
  1885
  1886     .
  1887 0160-EXIT.
  1888     EXIT.
  1889
  1890 0165-COMMON-FORMAT.
  1891
  1892     IF LA-CARRIER-A2 NOT = LOW-VALUES
  1893        MOVE LA-CARRIER-A2       TO WS-B1-CARRIER
  1894     END-IF
  1895     IF LA-ACCOUNT-A2 NOT = LOW-VALUES
  1896        MOVE LA-ACCOUNT-A2       TO WS-B1-ACCOUNT-NO
  1897     END-IF
  1898     IF LA-CERT-NO-A2 NOT = LOW-VALUES
  1899        MOVE LA-CERT-NO-A2       TO WS-B1-CERT-NO
  1900     END-IF
  1901
  1902     MOVE LA-FORM-A3             TO WS-B1-FORM-TYPE
  1903     MOVE LA-ARCHIVE-NO          TO WS-B1-ARCHIVE-NO
  1904
  1905     MOVE LA-PROCESSOR-CD        TO WS-B1-BY
  1906
  1907     MOVE WS-HOLD-TYPE           TO WS-B1-TYPE
  1908
  1909     MOVE LA-CREATION-DATE       TO DC-BIN-DATE-1
  1910     MOVE ' '                    TO DC-OPTION-CODE
  1911     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1912     IF NO-CONVERSION-ERROR
  1913        MOVE DC-GREG-DATE-1-EDIT TO WS-B1-ORIG-SEND-DATE
  1914     ELSE
  1915        MOVE SPACES              TO WS-B1-ORIG-SEND-DATE
  1916     END-IF
  1917
  1918     IF LA-INITIAL-PRINT-DATE = LOW-VALUES
  1919        MOVE '*'                 TO WS-B1-NOT-PRINTED-FLAG
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  38
* EL551.cbl
  1920     ELSE
  1921        MOVE ' '                 TO WS-B1-NOT-PRINTED-FLAG
  1922     END-IF
  1923
  1924     EVALUATE LA-DATA-SOURCE
  1925        WHEN '1'
  1926           MOVE 'ACCT'           TO WS-B1-DATA-SOURCE
  1927        WHEN '2'
  1928           MOVE 'CERT'           TO WS-B1-DATA-SOURCE
  1929        WHEN '3'
  1930           MOVE 'COMP'           TO WS-B1-DATA-SOURCE
  1931        WHEN '4'
  1932           MOVE 'PEND'           TO WS-B1-DATA-SOURCE
  1933        WHEN '5'
  1934           MOVE 'CHEK'           TO WS-B1-DATA-SOURCE
  1935        WHEN '6'
  1936           MOVE 'PYAJ'           TO WS-B1-DATA-SOURCE
  1937        WHEN OTHER
  1938           MOVE 'OTHR'           TO WS-B1-DATA-SOURCE
  1939     END-EVALUATE
  1940
  1941     EVALUATE LA-STATUS
  1942        WHEN 'A'
  1943           MOVE 'ACTIVE'         TO WS-B1-STATUS
  1944        WHEN 'C'
  1945           MOVE 'COMPLETED'      TO WS-B1-STATUS
  1946        WHEN 'H'
  1947           MOVE 'ON HOLD'        TO WS-B1-STATUS
  1948        WHEN 'X'
  1949           MOVE 'TO BE PURGED'   TO WS-B1-STATUS
  1950        WHEN 'P'
  1951           MOVE 'PURGED'         TO WS-B1-STATUS
  1952        WHEN 'V'
  1953           MOVE 'VOIDED'         TO WS-B1-STATUS
  1954        WHEN OTHER
  1955           MOVE 'OTHER'          TO WS-B1-STATUS
  1956     END-EVALUATE
  1957
  1958     MOVE WS-DETAIL1              TO P-DATA
  1959     MOVE SPACE-1                 TO P-CTL
  1960     PERFORM 8800-PRT-RTN         THRU 8800-EXIT
  1961
  1962     .
  1963 0165-EXIT.
  1964     EXIT.
  1965
  1966 0170-CLOSE-OUTPUT.
  1967
  1968     CLOSE PRINTX LETTER-EXTRACT
  1969
  1970     .
  1971 0170-EXIT.
  1972     EXIT.
  1973
  1974 0350-CREATE-EXTRACT.
  1975
  1976     DISPLAY ' MADE IT TO 0350 CREATE FREE '
  1977
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  39
* EL551.cbl
  1978     MOVE SPACES                 TO WS-EXTRACT-RECORD
  1979     MOVE 'LPACDUEPC'            TO FX-SYSTEM
  1980     MOVE 'LOGIC '               TO FX-SOURCE-CODE
  1981     MOVE '11'                   TO FX-DIVISION
  1982     MOVE '15'                   TO FX-SUB-TYPE
  1983
  1984     MOVE 'Y'                    TO FX-LOC-CODE
  1985
  1986     MOVE WS-POSTING-DATE        TO FX-POSTING-DATE
  1987
  1988     IF DTE-CLIENT = 'CID'
  1989        MOVE 'S'                 TO FX-FY-REN
  1990     ELSE
  1991        MOVE ' '                 TO FX-FY-REN
  1992     END-IF
  1993
  1994     MOVE ZEROS                  TO FX-AMOUNT
  1995
  1996     .
  1997 0350-EXIT.
  1998     EXIT.
  1999
  2000 8600-HD-RTN.
  2001     MOVE +0                     TO LNCTR
  2002     MOVE HD1                    TO  P-DATA
  2003     MOVE SPACE-NP               TO  P-CTL
  2004
  2005     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2006
  2007     ADD +1                      TO  PGCTR
  2008
  2009     MOVE PGCTR                  TO  HD-PG
  2010     MOVE HD2                    TO  P-DATA
  2011     MOVE SPACE-1                TO  P-CTL
  2012
  2013     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2014
  2015     MOVE HD3                    TO  P-DATA
  2016     MOVE SPACE-1                TO  P-CTL
  2017
  2018     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2019
  2020     MOVE HD3-5                  TO  P-DATA
  2021     MOVE SPACE-1                TO  P-CTL
  2022
  2023     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2024
  2025     MOVE SPACE-2                TO  P-CTL
  2026     MOVE HD4                    TO  P-DATA
  2027
  2028     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2029
  2030     MOVE HD5                    TO  P-DATA
  2031     MOVE SPACE-1                TO  P-CTL
  2032     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2033
  2034     MOVE SPACES                 TO  P-DATA
  2035     MOVE SPACE-1                TO  P-CTL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  40
* EL551.cbl
  2036     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2037
  2038     MOVE +10                    TO  LNCTR
  2039*    MOVE SPACE-2                TO  P-CTL
  2040
  2041     .
  2042 8699-EXIT.
  2043     EXIT.
  2044
  2045 8800-PRT-RTN.
  2046
  2047     IF LNCTR > +56
  2048        MOVE PRT                 TO WS-HOLD-PRT
  2049        PERFORM 8600-HD-RTN      THRU 8699-EXIT
  2050        MOVE WS-HOLD-PRT         TO PRT
  2051     END-IF
  2052
  2053     MOVE P-CTL                  TO X
  2054     IF P-CTL = SPACE-1
  2055        ADD +1                   TO LNCTR
  2056     ELSE
  2057        IF P-CTL = SPACE-2
  2058           ADD +2                TO LNCTR
  2059        ELSE
  2060           IF P-CTL = SPACE-3
  2061              ADD +3             TO LNCTR
  2062           END-IF
  2063        END-IF
  2064     END-IF
  2065
  2066     .
  2067 8850-COPY-PRT-RTN.
* 2068                                 COPY ELCPRT2.
  2069******************************************************************04/15/98
  2070*                                                                *ELCPRT2
  2071*                                                                *ELCPRT2
  2072*                            ELCPRT2                             *   LV005
  2073*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  2074*                            VMOD=2.002                          *   CL**5
  2075*                                                                *   CL**4
  2076******************************************************************   CL**4
  2077                                                                     CL**4
  2078     IF DTE-FICH NOT = SPACE AND                                     CL**4
  2079        FICH-OPEN    = SPACE                                         CL**4
  2080         MOVE 'X'                TO  FICH-OPEN                       CL**4
  2081         OPEN OUTPUT FICH.                                           CL**4
  2082                                                                     CL**4
  2083     IF DTE-FICH NOT = SPACE                                         CL**4
  2084         MOVE X                  TO  P-CTL                           CL**4
  2085         WRITE FICH-REC FROM PRT.                                    CL**4
  2086                                                                     CL**4
  2087     IF DTE-FICH = SPACE OR '2'                                      CL**4
  2088       MOVE X                    TO  P-CTL                           CL**4
  2089       IF P-CTL = ' '                                                CL**4
  2090         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  2091       ELSE                                                          CL**4
  2092         IF P-CTL = '0'                                              CL**4
  2093           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  41
* EL551.cbl (/apps/prod/cid1p/copy/ELCPRT2)
  2094         ELSE                                                        CL**4
  2095           IF P-CTL = '-'                                            CL**4
  2096             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  2097           ELSE                                                      CL**4
  2098             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  2099                                                                     CL**4
  2100******************************************************************   CL**4
  2101
  2102 8800-EXIT.
  2103     EXIT.
  2104
  2105 8500-DATE-CONVERT.
  2106
  2107     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  2108
  2109     .
  2110 8590-EXIT.
  2111     EXIT.
  2112
  2113 ABEND-PGM.
* 2114                                 COPY ELCABEND.
  2115***************************************************************** 04/14/98
  2116*                                                               * ELCABEND
  2117*                            ELCABEND.                          *    LV003
  2118*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2119*                            VMOD 2.002                              CL**2
  2120*                                                               * ELCABEND
  2121*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2122*            AND THEN ABENDS.                                   * ELCABEND
  2123*                                                               * ELCABEND
  2124*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2125*                                                               * ELCABEND
  2126***************************************************************** ELCABEND
  2127*APS-010.                                                         ELCABEND
  2128     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2129     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2130                                                                  ELCABEND
  2131     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2132         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2133         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2134                                 UPON CONSOLE.                    ELCABEND
  2135                                                                  ELCABEND
  2136     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2137         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2138         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2139                                 UPON CONSOLE.                    ELCABEND
  2140                                                                  ELCABEND
  2141     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2142     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2143                                 UPON CONSOLE.                    ELCABEND
  2144                                                                  ELCABEND
  2145     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2146     CALL 'ABORTME'.
  2147                                                                  ELCABEND
  2148 APS-EXIT.                                                        ELCABEND
  2149     EXIT.                                                        ELCABEND
  2150
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  42
* EL551.cbl
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       51404     Code:        6822
