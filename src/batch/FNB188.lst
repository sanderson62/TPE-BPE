* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* FNB188.cbl
* Options: int("FNB188.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB188.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB188.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB188.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    FNB188.
     3 AUTHOR.        DAN DRYDEN.
     4 DATE-WRITTEN.  DECEMBER, 1998.
     5
     6*****************************************************************
     7*  THIS PROGRAM SUBSTITUTES YYYYMMDDHHMMSS WITH THE CURRENT     *
     8*  DATE AND TIME.                                               *
     9*****************************************************************
    10
    11 ENVIRONMENT DIVISION.
    12 INPUT-OUTPUT SECTION.
    13 FILE-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* FNB188.cbl
    14
    15     SELECT DNLOAD-DATA
    16         ASSIGN TO SYS001
    17         STATUS IS SYS001-STATUS.
    18
    19
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* FNB188.cbl
    20/
    21 DATA DIVISION.
    22 FILE SECTION.
    23
    24 FD  DNLOAD-DATA
    25     LABEL RECORDS ARE STANDARD
    26     RECORDING MODE IS F
    27     RECORD CONTAINS 80 CHARACTERS
    28     BLOCK CONTAINS 0 RECORDS.
    29 01  DNLOAD-RECORD      PIC X(80).
    30
    31
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* FNB188.cbl
    32/
    33 WORKING-STORAGE SECTION.
    34
    35 01  FILLER.
    36     05  SUB              PIC S9(8)  BINARY VALUE +0.
    37     05  S0C7             PIC X      VALUE SPACE.
    38     05  FORCE-DUMP REDEFINES S0C7   PIC S9  COMP-3.
    39     05  SYS001-STATUS    PIC XX     VALUE ZERO.
    40         88  EOF                     VALUE '10'.
    41     05  UPDATE-SW        PIC X      VALUE ZERO.
    42         88  RECORD-UPDATED          VALUE '1'.
    43         88  END-OF-RECORD           VALUE '2'.
    44     05  YYYYMMDDHHMMSS.
    45         10  YYYYMMDD     PIC 9(8)   VALUE ZERO.
    46         10  HHMMSS       PIC 9(8)   VALUE ZERO.
    47
    48
    49
    50
    51*
    52 PROCEDURE DIVISION.
    53*
    54     OPEN I-O DNLOAD-DATA
    55     IF SYS001-STATUS NOT = '00'
    56        DISPLAY 'OPEN ERROR ' SYS001-STATUS ' ON SYS001'
    57        ADD +1 TO FORCE-DUMP
    58     END-IF
    59
    60     CALL 'IGZEDT4' USING YYYYMMDD
    61     ACCEPT HHMMSS FROM TIME
    62
    63     PERFORM UNTIL EOF
    64        READ DNLOAD-DATA
    65        IF NOT EOF
    66           MOVE ZERO TO UPDATE-SW
    67           PERFORM VARYING SUB FROM 1 BY 1
    68             UNTIL END-OF-RECORD OR RECORD-UPDATED
    69               IF DNLOAD-RECORD(SUB:14) = 'YYYYMMDDHHMMSS'
    70                  MOVE YYYYMMDDHHMMSS TO DNLOAD-RECORD(SUB:14)
    71                  REWRITE DNLOAD-RECORD
    72                  SET RECORD-UPDATED TO TRUE
    73               END-IF
    74               IF SUB = 60
    75                  SET END-OF-RECORD TO TRUE
    76               END-IF
    77           END-PERFORM
    78        END-IF
    79     END-PERFORM
    80
    81     STOP RUN.
    82
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1092     Code:         397
