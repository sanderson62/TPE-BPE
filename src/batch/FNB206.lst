* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* FNB206.cbl
* Options: int("FNB206.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB206.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB206.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB206.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
* GENERAL LEDGER SUSPENSE FILE EDIT                    06-Oct-15 17:19 Page   2
* FNB206.cbl
     2
     3 IDENTIFICATION DIVISION.
     4 PROGRAM-ID.    FNB206.
     5 AUTHOR.        DAN DRYDEN.
     6 DATE-WRITTEN.  FEBRUARY, 1999.
     7
     8*****************************************************************
     9*                         H I S T O R Y                         *
    10*****************************************************************
    11* NAME    DATE    DESCRIPTION                                   *
    12* ---- ---------- ----------------------------------------------*
    13* DANA 02/23/1999 TO PRODUCTION                                 *
    14* DANA 06/19/2000 IR2000061700004                               *
    15* DJNA 02/24/2003 CONVERT FROM MAINFRAME TO MICROFOCUS COBOL.   *
    16* AJR  08/25/2006 REMOVE FROM CLAIMS SYSTEM.                    *
    17*****************************************************************
    18
    19 ENVIRONMENT DIVISION.
    20 INPUT-OUTPUT SECTION.
    21 FILE-CONTROL.
    22
    23     SELECT UPLOAD
    24         ASSIGN TO EXTERNAL SYS010
    25         ORGANIZATION IS LINE SEQUENTIAL
    26         FILE STATUS IS SYS010-STATUS.
    27
    28     SELECT OLD-BACKUP
    29         ASSIGN TO EXTERNAL SYS011
    30         ORGANIZATION IS LINE SEQUENTIAL
    31         FILE STATUS IS SYS011-STATUS.
    32
    33     SELECT NEW-BACKUP
    34         ASSIGN TO EXTERNAL SYS012
    35         ORGANIZATION IS LINE SEQUENTIAL.
    36
    37 DATA DIVISION.
    38 FILE SECTION.
    39
    40 FD  UPLOAD
    41     LABEL RECORDS ARE STANDARD
    42     RECORDING MODE IS F
    43     RECORD CONTAINS 120 CHARACTERS
    44     BLOCK CONTAINS 0 RECORDS.
    45 01  UPLOAD-RECORD     PIC X(120).
    46
    47 FD  OLD-BACKUP
    48     LABEL RECORDS ARE STANDARD
    49     RECORDING MODE IS F
    50     RECORD CONTAINS 120 CHARACTERS
    51     BLOCK CONTAINS 0 RECORDS.
    52 01  OLDBU-RECORD        PIC X(120).
    53
    54 FD  NEW-BACKUP
    55     LABEL RECORDS ARE STANDARD
    56     RECORDING MODE IS F
    57     RECORD CONTAINS 120 CHARACTERS
    58     BLOCK CONTAINS 0 RECORDS.
    59 01  NEWBU-RECORD        PIC X(120).
* GENERAL LEDGER SUSPENSE FILE EDIT                    06-Oct-15 17:19 Page   3
* FNB206.cbl
    60
    61 WORKING-STORAGE SECTION.
    62
    63 01 RC                       PIC S9(9)   COMP-5 VALUE 0.
    64 01 LIST-REC                 PIC X(132).
    65
    66 01  FILLER.
    67     05  SYS010-STATUS       PIC XX     VALUE '00'.
    68         88  EOF-SYS010                 VALUE '10'.
    69     05  SYS011-STATUS       PIC XX     VALUE '00'.
    70         88  EOF-SYS011                 VALUE '10'.
    71     05  FILLER              PIC X      VALUE '0'.
    72         88  FILES-ARE-EQUAL            VALUE '1'.
    73         88  FILES-ARE-NOT-EQUAL        VALUE '2'.
    74         88  END-OF-MATCH               VALUE '1', '2'.
    75
    76 PROCEDURE DIVISION.
    77
    78     CALL 'FNBLIST' USING 'O' LIST-REC
    79     OPEN INPUT UPLOAD
    80     IF SYS010-STATUS NOT = '00'
    81       DISPLAY '*** OPEN ERROR ' SYS010-STATUS ' ON SYS010'
    82               UPON SYSERR
    83       MOVE SPACES TO LIST-REC
    84       STRING  '*** OPEN ERROR ' SYS010-STATUS ' ON SYS010'
    85         DELIMITED BY SIZE INTO LIST-REC
    86       CALL 'FNBLIST' USING 'W' LIST-REC
    87       CALL 'FNBLIST' USING 'C' LIST-REC
    88       MOVE 16 TO RC
    89*      GOBACK GIVING RC
    90       STOP RUN GIVING RC
    91     END-IF
    92
    93     READ UPLOAD
    94     IF SYS010-STATUS = '10'
    95       DISPLAY 'ERROR...UPLOAD FILE IS EMPTY ' UPON SYSERR
    96       MOVE    'ERROR...UPLOAD FILE IS EMPTY ' TO LIST-REC
    97       CALL 'FNBLIST' USING 'W' LIST-REC
    98       CALL 'FNBLIST' USING 'C' LIST-REC
    99       MOVE 04 TO RC
   100*      GOBACK GIVING RC
   101       STOP RUN GIVING RC
   102     END-IF
   103
   104     OPEN INPUT OLD-BACKUP
   105     IF SYS011-STATUS NOT = '00'
   106       DISPLAY '*** OPEN ERROR ' SYS011-STATUS ' ON SYS011'
   107               UPON SYSERR
   108       MOVE SPACES TO LIST-REC
   109       STRING  '*** OPEN ERROR ' SYS011-STATUS ' ON SYS011'
   110         DELIMITED BY SIZE INTO LIST-REC
   111       CALL 'FNBLIST' USING 'W' LIST-REC
   112       CALL 'FNBLIST' USING 'C' LIST-REC
   113       MOVE 16 TO RC
   114*      GOBACK GIVING RC
   115       STOP RUN GIVING RC
   116     END-IF
   117
* GENERAL LEDGER SUSPENSE FILE EDIT                    06-Oct-15 17:19 Page   4
* FNB206.cbl
   118     READ OLD-BACKUP
   119     IF SYS010-STATUS NOT = '00'
   120       SET FILES-ARE-NOT-EQUAL TO TRUE
   121     END-IF
   122
   123** MATCH THE CURRENT UPLOAD FILE TO THE PREVIOUS FILE (BACKUP)
   124** IF THE FILES ARE EQUAL THEN ABEND THE JOB
   125** ELSE COPY THE CURRENT UPLOAD TO THE BACKUP FILE
   126
   127     PERFORM UNTIL END-OF-MATCH
   128       IF EOF-SYS010 AND EOF-SYS011
   129         SET FILES-ARE-EQUAL TO TRUE
   130       ELSE
   131         IF UPLOAD-RECORD NOT = OLDBU-RECORD
   132           SET FILES-ARE-NOT-EQUAL TO TRUE
   133         ELSE
   134           READ UPLOAD
   135           READ OLD-BACKUP
   136         END-IF
   137       END-IF
   138     END-PERFORM
   139
   140     CLOSE UPLOAD
   141
   142     IF FILES-ARE-NOT-EQUAL
   143       OPEN INPUT  UPLOAD
   144       OPEN OUTPUT NEW-BACKUP
   145       PERFORM UNTIL EOF-SYS010
   146         READ UPLOAD
   147           AT END EXIT PERFORM
   148         END-READ
   149         WRITE NEWBU-RECORD FROM UPLOAD-RECORD
   150       END-PERFORM
   151       CLOSE UPLOAD
   152       CLOSE NEW-BACKUP
   153     ELSE
   154       DISPLAY 'ERROR   *** DUPLICATE UPLOAD FILE ***' UPON SYSERR
   155       DISPLAY ' '                                     UPON SYSERR
   156       DISPLAY '*************************************' UPON SYSERR
   157       DISPLAY '* THE UPLOAD FILE FOR TODAY IS THE  *' UPON SYSERR
   158       DISPLAY '* SAME AS THE PREVIOUS DAY''S FILE. *' UPON SYSERR
   159       DISPLAY '*************************************' UPON SYSERR
   160       MOVE    'ERROR   *** DUPLICATE UPLOAD FILE ***' TO LIST-REC
   161       CALL 'FNBLIST' USING 'W' LIST-REC
   162       MOVE    ' '                                     TO LIST-REC
   163       CALL 'FNBLIST' USING 'W' LIST-REC
   164       MOVE    '*************************************' TO LIST-REC
   165       CALL 'FNBLIST' USING 'W' LIST-REC
   166       MOVE    '* THE UPLOAD FILE FOR TODAY IS THE  *' TO LIST-REC
   167       CALL 'FNBLIST' USING 'W' LIST-REC
   168       MOVE    '* SAME AS THE PREVIOUS DAY''S FILE. *' TO LIST-REC
   169       CALL 'FNBLIST' USING 'W' LIST-REC
   170       MOVE    '*************************************' TO LIST-REC
   171       CALL 'FNBLIST' USING 'W' LIST-REC
   172       CALL 'FNBLIST' USING 'C' LIST-REC
   173       MOVE 08 TO RC
   174*      GOBACK GIVING RC
   175       STOP RUN GIVING RC
* GENERAL LEDGER SUSPENSE FILE EDIT                    06-Oct-15 17:19 Page   5
* FNB206.cbl
   176     END-IF.
   177
   178     CALL 'FNBLIST' USING 'C' LIST-REC
   179*    GOBACK GIVING RC.
   180     STOP RUN GIVING RC.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2324     Code:        1878
