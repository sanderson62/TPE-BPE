* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMATF3.cbl
* Options: int("PEMATF3.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMATF3.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMATF3.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"PEMATF3.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. PEMATF3.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:19.
     6 ENVIRONMENT DIVISION.
     7 INPUT-OUTPUT SECTION.
     8 FILE-CONTROL.
     9     SELECT ELMSTR           ASSIGN TO ELMSTR
    10                             ORGANIZATION IS INDEXED
    11                             ACCESS IS DYNAMIC
    12                             RECORD KEY IS CL-CONTROL-PRIMARY
    13                             FILE STATUS IS ELMSTR-FILE-STATUS.
    14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMATF3.cbl
    15     SELECT ELTRLR           ASSIGN TO ELTRLR
    16                             ORGANIZATION IS INDEXED
    17                             ACCESS IS DYNAMIC
    18                             RECORD KEY IS AT-CONTROL-PRIMARY
    19                             FILE STATUS IS ELTRLR-FILE-STATUS.
    20
    21 DATA DIVISION.
    22 FILE SECTION.
    23
    24 FD  ELMSTR.
    25
*   26                                 COPY ELCMSTR.
    27******************************************************************04/15/98
    28*                                                                *ELCMSTR
    29*                            ELCMSTR.                            *   LV002
    30*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    31*                            VMOD=2.012                          *   CL**2
    32*                                                                *ELCMSTR
    33*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
    34*                                                                *ELCMSTR
    35*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
    36*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
    37*                                                                *ELCMSTR
    38*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
    39*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
    40*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
    41*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
    42*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
    43*                                                 RKP=75,LEN=21  *ELCMSTR
    44*                                                                *ELCMSTR
    45*   **** NOTE ****                                               *ELCMSTR
    46*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
    47*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
    48*                                                                *ELCMSTR
    49*   LOG = YES                                                    *ELCMSTR
    50*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
    51******************************************************************
    52*                   C H A N G E   L O G
    53*
    54* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    55*-----------------------------------------------------------------
    56*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    57* EFFECTIVE    NUMBER
    58*-----------------------------------------------------------------
    59* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
    60* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
    61* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
    62* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    63* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    64******************************************************************ELCMSTR
    65 01  CLAIM-MASTER.                                                ELCMSTR
    66     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
    67         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
    68                                                                  ELCMSTR
    69     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
    70         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
    71         16  CL-CARRIER              PIC X.                       ELCMSTR
    72         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMATF3.cbl (/apps/prod/cid1p/copy/ELCMSTR)
    73         16  CL-CERT-NO.                                          ELCMSTR
    74             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
    75             20  CL-CERT-SFX         PIC X.                       ELCMSTR
    76                                                                  ELCMSTR
    77     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
    78         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
    79         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
    80         16  CL-INSURED-NAME.                                     ELCMSTR
    81             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
    82             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
    83                                                                  ELCMSTR
    84     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
    85         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
    86         16  CL-SOC-SEC-NO.                                       ELCMSTR
    87             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
    88             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
    89             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
    90                                                                  ELCMSTR
    91     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
    92         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
    93         16  CL-CERT-NO-A4.                                       ELCMSTR
    94             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
    95             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
    96                                                                  ELCMSTR
    97     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
    98         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
    99         16  CL-CCN-A5.                                           ELCMSTR
   100             20  CL-CCN.                                          ELCMSTR
   101                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
   102                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
   103             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
   104                                                                  ELCMSTR
   105     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
   106         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
   107         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
   108             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
   109             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
   110             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
   111         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
   112         16  FILLER                  PIC X(5).                    ELCMSTR
   113                                                                  ELCMSTR
   114     12  CL-PROCESSING-INFO.                                      ELCMSTR
   115         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
   116         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
   117             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
   118             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
   119         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
   120*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
   121*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
   122*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
   123*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
   124*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
   125*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   126         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
   127             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
   128             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
   129             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
   130         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMATF3.cbl (/apps/prod/cid1p/copy/ELCMSTR)
   131         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
   132         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
   133         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
   134         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
   135         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
   136         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
   137         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
   138         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
   139         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
   140         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
   141             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
   142             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
   143             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
   144         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
   145                                                                  ELCMSTR
   146         16  CL-PRIME-CERT-NO.                                    ELCMSTR
   147             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
   148             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
   149                                                                  ELCMSTR
   150         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
   151             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
   152             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
   153                                                                  ELCMSTR
   154         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
   155         16  FILLER REDEFINES CL-MICROFILM-NO.
   156             20  CL-BENEFIT-PERIOD   PIC 99.
   157             20  FILLER              PIC X(8).
   158         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
   159         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
   160                                                                  ELCMSTR
   161         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
   162         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
   163         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
   164             88  FINAL-PAID             VALUE '1'.                ELCMSTR
   165             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
   166             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
   167             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
   168             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
   169             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
   170         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
   171         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
   172         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
   173             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
   174         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   175         16  FILLER                  PIC X.
   176                                                                  ELCMSTR
   177     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
   178         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
   179             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
   180             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
   181             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
   182         16  CL-CERT-KEY-DATA.                                    ELCMSTR
   183             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
   184             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
   185             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
   186             20  CL-CERT-ACCOUNT.                                 ELCMSTR
   187                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
   188                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMATF3.cbl (/apps/prod/cid1p/copy/ELCMSTR)
   189             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
   190                                                                  ELCMSTR
   191     12  CL-STATUS-CONTROLS.                                      ELCMSTR
   192         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
   193             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
   194             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
   195         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
   196             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
   197             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
   198         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
   199         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
   200         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
   201         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
   202         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
   203         16  CL-CRITICAL-PERIOD      PIC 99.
   204*        16  FILLER                  PIC XX.                      ELCMSTR
   205         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
   206         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
   207         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
   208         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
   209             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
   210             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
   211             88  LETTER-SENT            VALUE '2'.                ELCMSTR
   212             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
   213             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
   214             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
   215             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
   216             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
   217             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
   218         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
   219         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
   220         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
   221         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
   222         16  CL-DENIAL-TYPE          PIC X.
   223             88  CL-TYPE-DENIAL          VALUE '1'.
   224             88  CL-TYPE-RESCISSION      VALUE '2'.
   225             88  CL-TYPE-REFORMATION     VALUE '3'.
   226             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   227             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   228         16  filler                  pic x(5).
   229*        16  CL-CRIT-PER-RECURRENT   PIC X.
   230*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   231*        16  CL-RTW-DT               PIC XX.
   232                                                                  ELCMSTR
   233     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
   234         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
   235             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
   236             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
   237             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
   238         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
   239         16  FILLER                  PIC XX.                      ELCMSTR
   240         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
   241         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
   242             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
   243                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
   244             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
   245                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
   246             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMATF3.cbl (/apps/prod/cid1p/copy/ELCMSTR)
   247                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
   248             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
   249                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
   250             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
   251                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
   252             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
   253                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
   254             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
   255                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
   256                                                                  ELCMSTR
   257     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
   258         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
   259         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
   260                                                                  ELCMSTR
   261     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
   262                                                                  ELCMSTR
   263     12  CL-PROCESS-ERRORS.                                       ELCMSTR
   264         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
   265             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
   266         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
   267             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
   268                                                                  ELCMSTR
   269     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
   270                                                                  ELCMSTR
   271     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
   272         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
   273         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
   274         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
   275         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
   276                                                                  ELCMSTR
   277     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
   278         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
   279         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
   280         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
   281         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
   282                                                                  ELCMSTR
   283     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
   284     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
   285     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
   286                                                                  ELCMSTR
   287     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
   288     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
   289     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
   290     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
   291                                                                  ELCMSTR
   292     12  CL-YESNOSW                  PIC X.                       ELCMSTR
   293     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   294         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   295         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   296         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   297     12  cl-insured-type             pic x.
   298         88  cl-claim-on-primary         value 'P'.
   299         88  cl-claim-on-co-borrower     value 'C'.
   300     12  cl-benefit-expiration-dt    PIC XX.
   301
   302 FD  ELTRLR.
   303
*  304                                 COPY ELCTRLR.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMATF3.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   305******************************************************************04/16/98
   306*                                                                *ELCTRLR
   307*                            ELCTRLR.                            *   LV002
   308*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   309*                            VMOD=2.014                          *   CL**2
   310*                                                                *ELCTRLR
   311*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *ELCTRLR
   312*                                                                *ELCTRLR
   313*   FILE TYPE = VSAM,KSDS                                        *ELCTRLR
   314*   RECORD SIZE = 200    RECFORM = FIXED                         *ELCTRLR
   315*                                                                *ELCTRLR
   316*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *ELCTRLR
   317*       ALTERNATE INDEX = NONE                                   *ELCTRLR
   318*                                                                *ELCTRLR
   319*   LOG = YES                                                    *ELCTRLR
   320*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCTRLR
   321******************************************************************
   322*                   C H A N G E   L O G
   323*
   324* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   325*-----------------------------------------------------------------
   326*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   327* EFFECTIVE    NUMBER
   328*-----------------------------------------------------------------
   329* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   330* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
   331* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
   332* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
   333* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
   334* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
   335* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
   336* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
   337* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
   338* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
   339* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
   340* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
   341* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAILER
   342* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM IND
   343* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
   344* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   345* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
   346* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
   347* 040814    2014030500002  AJRA  ADD ICD CODES
   348* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   349******************************************************************ELCTRLR
   350 01  ACTIVITY-TRAILERS.                                           ELCTRLR
   351     12  AT-RECORD-ID                    PIC XX.                  ELCTRLR
   352         88  VALID-AT-ID                       VALUE 'AT'.        ELCTRLR
   353                                                                  ELCTRLR
   354     12  AT-CONTROL-PRIMARY.                                      ELCTRLR
   355         16  AT-COMPANY-CD               PIC X.                   ELCTRLR
   356         16  AT-CARRIER                  PIC X.                   ELCTRLR
   357         16  AT-CLAIM-NO                 PIC X(7).                ELCTRLR
   358         16  AT-CERT-NO.                                          ELCTRLR
   359             20  AT-CERT-PRIME           PIC X(10).               ELCTRLR
   360             20  AT-CERT-SFX             PIC X.                   ELCTRLR
   361         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.      ELCTRLR
   362             88  AT-1ST-TRL-AVAIL             VALUE +4095.        ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMATF3.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   363             88  AT-LAST-TRL-AVAIL            VALUE +100.         ELCTRLR
   364             88  AT-RESV-EXP-HIST-TRL         VALUE +0.           ELCTRLR
   365             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.   ELCTRLR
   366             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19. ELCTRLR
   367             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29. ELCTRLR
   368             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39. ELCTRLR
   369             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49. ELCTRLR
   370             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59. ELCTRLR
   371             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69. ELCTRLR
   372             88  AT-DIAGNOSIS-TRL             VALUE +90.          ELCTRLR
   373             88  AT-BENEFICIARY-TRL           VALUE +91.
   374             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
   375             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
   376             88  AT-VFY-CAUSAL-STATE          VALUE +94.
   377             88  AT-ERROR-MSGS-TRL            VALUE +95.
   378                                                                  ELCTRLR
   379     12  AT-TRAILER-TYPE                 PIC X.                   ELCTRLR
   380         88  RESERVE-EXPENSE-TR               VALUE '1'.          ELCTRLR
   381         88  PAYMENT-TR                       VALUE '2'.          ELCTRLR
   382         88  AUTO-PAY-TR                      VALUE '3'.          ELCTRLR
   383         88  CORRESPONDENCE-TR                VALUE '4'.          ELCTRLR
   384         88  ADDRESS-TR                       VALUE '5'.          ELCTRLR
   385         88  GENERAL-INFO-TR                  VALUE '6'.          ELCTRLR
   386         88  AUTO-PROMPT-TR                   VALUE '7'.          ELCTRLR
   387         88  DENIAL-TR                        VALUE '8'.          ELCTRLR
   388         88  INCURRED-CHG-TR                  VALUE '9'.          ELCTRLR
   389         88  FORM-CONTROL-TR                  VALUE 'A'.          ELCTRLR
   390                                                                  ELCTRLR
   391     12  AT-RECORDED-DT                  PIC XX.                  ELCTRLR
   392     12  AT-RECORDED-BY                  PIC X(4).                ELCTRLR
   393     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.    ELCTRLR
   394                                                                  ELCTRLR
   395     12  AT-TRAILER-BODY                 PIC X(165).              ELCTRLR
   396                                                                  ELCTRLR
   397     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.       ELCTRLR
   398         16  AT-RESERVE-CONTROLS.                                 ELCTRLR
   399             20  AT-MANUAL-SW            PIC X.                   ELCTRLR
   400                 88  AT-MANUAL-RESERVES-USED VALUE '1'.           ELCTRLR
   401             20  AT-FUTURE-SW            PIC X.                   ELCTRLR
   402                 88  AT-FUTURE-RESERVES-USED VALUE '1'.           ELCTRLR
   403             20  AT-PTC-SW               PIC X.                   ELCTRLR
   404                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.           ELCTRLR
   405             20  AT-IBNR-SW              PIC X.                   ELCTRLR
   406                 88  AT-IBNR-RESERVES-USED   VALUE '1'.           ELCTRLR
   407             20  AT-PTC-LF-SW            PIC X.                   ELCTRLR
   408                 88  AT-LF-PTC-USED          VALUE '1'.           ELCTRLR
   409             20  AT-CDT-ACCESS-METHOD    PIC X.                   ELCTRLR
   410                 88  AT-CDT-ROUND-NEAR       VALUE '1'.           ELCTRLR
   411                 88  AT-CDT-ROUND-HIGH       VALUE '2'.           ELCTRLR
   412                 88  AT-CDT-INTERPOLATED     VALUE '3'.           ELCTRLR
   413             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.  ELCTRLR
   414         16  AT-LAST-COMPUTED-DT         PIC XX.                  ELCTRLR
   415         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.  ELCTRLR
   416         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.  ELCTRLR
   417         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.  ELCTRLR
   418         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
   419         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
   420         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMATF3.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   421         16  AT-EXPENSE-CONTROLS.                                 ELCTRLR
   422             20  AT-EXPENSE-METHOD       PIC X.                   ELCTRLR
   423                 88  NO-EXPENSE-CALCULATED    VALUE '1'.          ELCTRLR
   424                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.          ELCTRLR
   425                 88  PERCENT-OF-PMT           VALUE '3'.          ELCTRLR
   426                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.          ELCTRLR
   427             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.  ELCTRLR
   428             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.  ELCTRLR
   429         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.  ELCTRLR
   430         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.  ELCTRLR
   431                                                                  ELCTRLR
   432         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.  ELCTRLR
   433         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.  ELCTRLR
   434                                                                  ELCTRLR
   435*        16  FILLER                      PIC X(53).               ELCTRLR
   436         16  FILLER                      PIC X(47).               ELCTRLR
   437                                                                  ELCTRLR
   438         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   439         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   440                                                                  ELCTRLR
   441         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.                ELCTRLR
   442             20  AT-OPEN-CLOSE-DATE      PIC XX.                  ELCTRLR
   443             20  AT-OPEN-CLOSE-TYPE      PIC X.                   ELCTRLR
   444*                    C = CLOSED                                   ELCTRLR
   445*                    O = OPEN                                     ELCTRLR
   446             20  AT-OPEN-CLOSE-REASON    PIC X(5).                ELCTRLR
   447*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE      ELCTRLR
   448                                                                  ELCTRLR
   449     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.               ELCTRLR
   450         16  AT-PAYMENT-TYPE             PIC X.                   ELCTRLR
   451             88  PARTIAL-PAYMENT                VALUE '1'.        ELCTRLR
   452             88  FINAL-PAYMENT                  VALUE '2'.        ELCTRLR
   453             88  LUMP-SUM-PAYMENT               VALUE '3'.        ELCTRLR
   454             88  ADDITIONAL-PAYMENT             VALUE '4'.        ELCTRLR
   455             88  CHARGEABLE-EXPENSE             VALUE '5'.        ELCTRLR
   456             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.        ELCTRLR
   457             88  VOIDED-PAYMENT                 VALUE '9'.        ELCTRLR
   458             88  TRANSFER                       VALUE 'T'.
   459             88  LIFE-INTEREST                  VALUE 'I'.
   460                                                                  ELCTRLR
   461         16  AT-CLAIM-TYPE               PIC X.                   ELCTRLR
   462             88  PAID-FOR-AH                    VALUE 'A'.        ELCTRLR
   463             88  PAID-FOR-LIFE                  VALUE 'L'.        ELCTRLR
   464             88  PAID-FOR-IUI                   VALUE 'I'.        ELCTRLR
   465             88  PAID-FOR-GAP                   VALUE 'G'.        ELCTRLR
   466             88  PAID-FOR-FAM                   VALUE 'F'.
   467         16  AT-CLAIM-PREM-TYPE          PIC X.                   ELCTRLR
   468             88  AT-SINGLE-PREMIUM              VALUE '1'.        ELCTRLR
   469             88  AT-O-B-COVERAGE                VALUE '2'.        ELCTRLR
   470             88  AT-OPEN-END-COVERAGE           VALUE '3'.        ELCTRLR
   471         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.    ELCTRLR
   472         16  AT-CHECK-NO                 PIC X(7).                ELCTRLR
   473         16  AT-PAID-FROM-DT             PIC XX.                  ELCTRLR
   474         16  AT-PAID-THRU-DT             PIC XX.                  ELCTRLR
   475         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.      ELCTRLR
   476         16  FILLER                      PIC X.                   ELCTRLR
   477         16  AT-PAYEES-NAME              PIC X(30).               ELCTRLR
   478         16  AT-PAYMENT-ORIGIN           PIC X.                   ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMATF3.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   479             88  ONLINE-MANUAL-PMT              VALUE '1'.        ELCTRLR
   480             88  ONLINE-AUTO-PMT                VALUE '2'.        ELCTRLR
   481             88  OFFLINE-PMT                    VALUE '3'.        ELCTRLR
   482         16  AT-CHECK-WRITTEN-DT         PIC XX.                  ELCTRLR
   483         16  AT-TO-BE-WRITTEN-DT         PIC XX.                  ELCTRLR
   484         16  AT-VOID-DATA.                                        ELCTRLR
   485             20  AT-VOID-DT              PIC XX.                  ELCTRLR
   486*00144       20  AT-VOID-REASON          PIC X(30).               ELCTRLR
   487             20  AT-VOID-REASON          PIC X(26).
   488         16  AT-PMT-APPROVED-BY          PIC X(04).
   489         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.    ELCTRLR
   490         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.    ELCTRLR
   491         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
   492                                         PIC S99V9(5)  COMP-3.
   493         16  AT-CREDIT-INTERFACE.                                 ELCTRLR
   494             20  AT-PMT-SELECT-DT        PIC XX.                  ELCTRLR
   495                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.       ELCTRLR
   496             20  AT-PMT-ACCEPT-DT        PIC XX.                  ELCTRLR
   497                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.       ELCTRLR
   498             20  AT-VOID-SELECT-DT       PIC XX.                  ELCTRLR
   499                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.       ELCTRLR
   500             20  AT-VOID-ACCEPT-DT       PIC XX.                  ELCTRLR
   501                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.       ELCTRLR
   502                                                                  ELCTRLR
   503         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.      ELCTRLR
   504                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.     ELCTRLR
   505                 88  CONVERSION-PAYMENT           VALUE +99999999.ELCTRLR
   506         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.      ELCTRLR
   507                                                                  ELCTRLR
   508         16  AT-FORCE-CONTROL            PIC X.                   ELCTRLR
   509             88  PAYMENT-WAS-FORCED           VALUE '1'.          ELCTRLR
   510         16  AT-PREV-LAST-PMT-DT         PIC XX.                  ELCTRLR
   511         16  AT-PREV-PAID-THRU-DT        PIC XX.                  ELCTRLR
   512         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.    ELCTRLR
   513         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.    ELCTRLR
   514         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.    ELCTRLR
   515         16  AT-BENEFIT-TYPE             PIC X.                   ELCTRLR
   516                                                                  ELCTRLR
   517         16  AT-EXPENSE-TYPE             PIC X.                   ELCTRLR
   518         16  AT-PAYMENT-APPROVAL-SW      PIC X.                   ELCTRLR
   519                                                                  ELCTRLR
   520         16  AT-PAYEE-TYPE-CD.                                    ELCTRLR
   521             20  AT-PAYEE-TYPE           PIC X.                   ELCTRLR
   522                 88  INSURED-PAID           VALUE 'I'.            ELCTRLR
   523                 88  BENEFICIARY-PAID       VALUE 'B'.            ELCTRLR
   524                 88  ACCOUNT-PAID           VALUE 'A'.            ELCTRLR
   525                 88  OTHER-1-PAID           VALUE 'O'.            ELCTRLR
   526                 88  OTHER-2-PAID           VALUE 'Q'.            ELCTRLR
   527                 88  DOCTOR-PAID            VALUE 'P'.            ELCTRLR
   528                 88  EMPLOYER-PAID          VALUE 'E'.            ELCTRLR
   529             20  AT-PAYEE-SEQ            PIC X.                   ELCTRLR
   530                                                                  ELCTRLR
   531         16  AT-CASH-PAYMENT             PIC X.                   ELCTRLR
   532         16  AT-GROUPED-PAYMENT          PIC X.                   ELCTRLR
   533         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.    ELCTRLR
   534         16  AT-APPROVAL-LEVEL-REQD      PIC X.                   ELCTRLR
   535         16  AT-APPROVED-LEVEL           PIC X.                   ELCTRLR
   536         16  AT-VOID-TYPE                PIC X.                   ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMATF3.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   537             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.            ELCTRLR
   538             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.            ELCTRLR
   539         16  AT-AIG-UNEMP-IND            PIC X.                   ELCTRLR
   540             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.            ELCTRLR
   541         16  AT-ASSOCIATES               PIC X.                   ELCTRLR
   542             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.        ELCTRLR
   543             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.        ELCTRLR
   544                                                                  ELCTRLR
   545         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.    ELCTRLR
   546         16  AT-CV-PMT-CODE              PIC X.                   ELCTRLR
   547             88  FULL-DEATH-PAYMENT         VALUE '1'.            ELCTRLR
   548             88  HALF-DEATH-PAYMENT         VALUE '2'.            ELCTRLR
   549             88  FULL-ADD-PAYMENT           VALUE '3'.            ELCTRLR
   550             88  HALF-ADD-PAYMENT           VALUE '4'.            ELCTRLR
   551             88  FULL-RIDER-PAYMENT         VALUE '5'.            ELCTRLR
   552             88  HALF-RIDER-PAYMENT         VALUE '6'.            ELCTRLR
   553             88  NON-CHG-EXP-PAYMENT        VALUE '7'.            ELCTRLR
   554             88  ADDL-PAYMENT               VALUE '8'.            ELCTRLR
   555                                                                  ELCTRLR
   556         16  AT-EOB-CODE1                PIC XXX.                 ELCTRLR
   557         16  AT-EOB-CODE2                PIC XXX.                 ELCTRLR
   558         16  AT-EOB-CODE3                PIC XXX.
   559         16  FILLER REDEFINES AT-EOB-CODE3.
   560             20  AT-PRINT-CLM-FORM       PIC X.
   561             20  AT-PRINT-SURVEY         PIC X.
   562             20  AT-SPECIAL-RELEASE      PIC X.
   563         16  AT-EOB-CODE4                PIC XXX.                 ELCTRLR
   564         16  FILLER REDEFINES AT-EOB-CODE4.
   565             20  AT-INT-PMT-SELECT-DT    PIC XX.
   566             20  FILLER                  PIC X.
   567         16  AT-EOB-CODE5                PIC XXX.                 ELCTRLR
   568         16  FILLER REDEFINES AT-EOB-CODE5.
   569             20  AT-PMT-PROOF-DT         PIC XX.
   570             20  FILLER                  PIC X.
   571                                                                  ELCTRLR
   572         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
   573             88  AT-PRINT-EOB            VALUE 'Y'.
   574                                                                  ELCTRLR
   575         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.                  ELCTRLR
   576         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).                ELCTRLR
   577                                                                  ELCTRLR
   578     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.              ELCTRLR
   579         16  AT-SCHEDULE-START-DT        PIC XX.                  ELCTRLR
   580         16  AT-SCHEDULE-END-DT          PIC XX.                  ELCTRLR
   581         16  AT-TERMINATED-DT            PIC XX.                  ELCTRLR
   582         16  AT-LAST-PMT-TYPE            PIC X.                   ELCTRLR
   583             88  LAST-PMT-IS-FINAL              VALUE 'F'.        ELCTRLR
   584             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.        ELCTRLR
   585         16  AT-FIRST-PMT-DATA.                                   ELCTRLR
   586             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.    ELCTRLR
   587             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.      ELCTRLR
   588             20  AT-1ST-PAY-THRU-DT      PIC XX.                  ELCTRLR
   589         16  AT-REGULAR-PMT-DATA.                                 ELCTRLR
   590             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.    ELCTRLR
   591             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.      ELCTRLR
   592             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.      ELCTRLR
   593         16  AT-AUTO-PAYEE-CD.                                    ELCTRLR
   594             20  AT-AUTO-PAYEE-TYPE      PIC X.                   ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMATF3.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   595                 88  INSURED-PAID-AUTO      VALUE 'I'.            ELCTRLR
   596                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.            ELCTRLR
   597                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.            ELCTRLR
   598                 88  OTHER-1-PAID-AUTO      VALUE 'O'.            ELCTRLR
   599                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.            ELCTRLR
   600             20  AT-AUTO-PAYEE-SEQ       PIC X.                   ELCTRLR
   601         16  AT-AUTO-PAY-DAY             PIC 99.                  ELCTRLR
   602         16  AT-AUTO-CASH                PIC X.                   ELCTRLR
   603             88  AT-CASH                      VALUE 'Y'.          ELCTRLR
   604             88  AT-NON-CASH                  VALUE 'N'.          ELCTRLR
   605*        16  FILLER                      PIC X(129).              ELCTRLR
   606         16  AT-AUTO-END-LETTER          PIC X(4).
   607         16  FILLER                      PIC X(125).
   608                                                                  ELCTRLR
   609         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   610         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   611                                                                  ELCTRLR
   612     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.        ELCTRLR
   613         16  AT-LETTER-SENT-DT           PIC XX.                  ELCTRLR
   614         16  AT-RECEIPT-FOLLOW-UP        PIC XX.                  ELCTRLR
   615         16  AT-AUTO-RE-SEND-DT          PIC XX.                  ELCTRLR
   616         16  AT-LETTER-ANSWERED-DT       PIC XX.                  ELCTRLR
   617         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.      ELCTRLR
   618         16  AT-LETTER-ORIGIN            PIC X.                   ELCTRLR
   619             88  ONLINE-CREATION              VALUE '1' '3'.
   620             88  OFFLINE-CREATION             VALUE '2' '4'.
   621             88  NAPER-ONLINE-CREATION        VALUE '3'.
   622             88  NAPER-OFFLINE-CREATION       VALUE '4'.
   623         16  AT-STD-LETTER-FORM          PIC X(4).                ELCTRLR
   624         16  AT-REASON-TEXT              PIC X(70).               ELCTRLR
   625         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.      ELCTRLR
   626         16  AT-ADDRESEE-TYPE            PIC X.                   ELCTRLR
   627              88  INSURED-ADDRESEE            VALUE 'I'.          ELCTRLR
   628              88  BENEFICIARY-ADDRESEE        VALUE 'B'.          ELCTRLR
   629              88  ACCOUNT-ADDRESEE            VALUE 'A'.          ELCTRLR
   630              88  PHYSICIAN-ADDRESEE          VALUE 'P'.          ELCTRLR
   631              88  EMPLOYER-ADDRESEE           VALUE 'E'.          ELCTRLR
   632              88  OTHER-ADDRESEE-1            VALUE 'O'.          ELCTRLR
   633              88  OTHER-ADDRESEE-2            VALUE 'Q'.          ELCTRLR
   634         16  AT-ADDRESSEE-NAME           PIC X(30).               ELCTRLR
   635         16  AT-INITIAL-PRINT-DATE       PIC XX.                  ELCTRLR
   636         16  AT-RESEND-PRINT-DATE        PIC XX.                  ELCTRLR
   637         16  AT-CORR-SOL-UNSOL           PIC X.                   ELCTRLR
   638         16  AT-LETTER-PURGED-DT         PIC XX.                  ELCTRLR
   639*                                                                 ELCTRLR
   640*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.          ELCTRLR
   641*                                                                 ELCTRLR
   642         16  AT-CSO-REDEFINITION.                                 00001862
   643             20  AT-RESEND-LETTER-FORM   PIC X(4).
   644             20  AT-AUTO-CLOSE-IND       PIC X(1).
   645             20  AT-LETTER-TO-BENE       PIC X(1).
   646             20  AT-STOP-LETTER-DT       PIC X(2).
   647             20  FILLER                  PIC X(19).
   648*             20  FILLER                  PIC X(27).               0000186
   649             20  AT-CSO-LETTER-STATUS    PIC X.                   00001864
   650                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.           00001865
   651                 88  AT-CSO-LETTER-PURGED    VALUE '2'.           00001866
   652                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.           00001867
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMATF3.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   653             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.               00001868
   654             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.               00001869
   655*                                                                 ELCTRLR
   656*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED ELCTRLR
   657*                                                                 ELCTRLR
   658*        16  FILLER                      PIC X(26).               ELCTRLR
   659*                                                                 ELCTRLR
   660*        16  AT-DMD-BSR-CODE             PIC X.                   ELCTRLR
   661*            88  AT-AUTOMATED-BSR              VALUE 'A'.         ELCTRLR
   662*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.     ELCTRLR
   663*                                                                 ELCTRLR
   664*        16  AT-DMD-LETTER-STATUS        PIC X.                   ELCTRLR
   665*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.         ELCTRLR
   666*            88  AT-DMD-LETTER-PURGED          VALUE '2'.         ELCTRLR
   667*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.         ELCTRLR
   668*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.                  ELCTRLR
   669*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.                  ELCTRLR
   670                                                                  ELCTRLR
   671         16  AT-CORR-LAST-MAINT-DT       PIC XX.                  ELCTRLR
   672         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).                ELCTRLR
   673                                                                  ELCTRLR
   674     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.               ELCTRLR
   675         16  AT-ADDRESS-TYPE             PIC X.                   ELCTRLR
   676             88  INSURED-ADDRESS               VALUE 'I'.         ELCTRLR
   677             88  BENEFICIARY-ADDRESS           VALUE 'B'.         ELCTRLR
   678             88  ACCOUNT-ADDRESS               VALUE 'A'.         ELCTRLR
   679             88  PHYSICIAN-ADDRESS             VALUE 'P'.         ELCTRLR
   680             88  EMPLOYER-ADDRESS              VALUE 'E'.         ELCTRLR
   681             88  OTHER-ADDRESS-1               VALUE 'O'.         ELCTRLR
   682             88  OTHER-ADDRESS-2               VALUE 'Q'.         ELCTRLR
   683         16  AT-MAIL-TO-NAME             PIC X(30).               ELCTRLR
   684         16  AT-ADDRESS-LINE-1           PIC X(30).               ELCTRLR
   685         16  AT-ADDRESS-LINE-2           PIC X(30).               ELCTRLR
   686         16  AT-CITY-STATE.
   687             20  AT-CITY                 PIC X(28).
   688             20  AT-STATE                PIC XX.
   689         16  AT-ZIP.                                              ELCTRLR
   690             20  AT-ZIP-CODE.                                     ELCTRLR
   691                 24  AT-ZIP-1ST          PIC X.                   ELCTRLR
   692                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.ELCTRLR
   693                 24  FILLER              PIC X(4).                ELCTRLR
   694             20  AT-ZIP-PLUS4            PIC X(4).                ELCTRLR
   695         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.          ELCTRLR
   696             20  AT-CAN-POSTAL-1         PIC XXX.                 ELCTRLR
   697             20  AT-CAN-POSTAL-2         PIC XXX.                 ELCTRLR
   698             20  FILLER                  PIC XXX.                 ELCTRLR
   699         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.    ELCTRLR
   700*         16  FILLER                      PIC X(23).               ELCTRLR
   701         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
   702         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
   703         16  FILLER                      PIC X(13).
   704         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.                  ELCTRLR
   705         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).                ELCTRLR
   706                                                                  ELCTRLR
   707     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
   708         16  AT-INFO-LINE-1              PIC X(60).               ELCTRLR
   709         16  FILLER REDEFINES AT-INFO-LINE-1.
   710             20  AT-NOTE-ERROR-NO OCCURS 15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMATF3.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   711                                         PIC X(4).
   712         16  AT-INFO-LINE-2              PIC X(60).               ELCTRLR
   713         16  FILLER REDEFINES AT-INFO-LINE-2.
   714             20  AT-ICD-CODE-1           PIC X(8).
   715             20  AT-ICD-CODE-2           PIC X(8).
   716             20  FILLER                  PIC X(44).
   717         16  AT-INFO-TRAILER-TYPE        PIC X.                   ELCTRLR
   718             88  AT-ERRORS-NOTE          VALUE 'E'.
   719             88  AT-PAYMENT-NOTE         VALUE 'P'.               ELCTRLR
   720             88  AT-CALL-NOTE            VALUE 'C'.               ELCTRLR
   721             88  AT-MAINT-NOTE           VALUE 'M'.               ELCTRLR
   722             88  AT-CERT-CHANGE          VALUE 'X'.               ELCTRLR
   723             88  AT-APPROVAL-NOTE        VALUE 'R'.
   724             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
   725             88  AT-CERT-CANCELLED       VALUE 'T'.
   726         16  AT-CALL-TYPE                PIC X.                   ELCTRLR
   727             88  AT-PHONE-CALL-IN        VALUE 'I'.               ELCTRLR
   728             88  AT-PHONE-CALL-OUT       VALUE 'O'.               ELCTRLR
   729         16  AT-NOTE-CONTINUATION        PIC X.                   ELCTRLR
   730             88  AT-CONTINUED-NOTE       VALUE 'X'.
   731         16  AT-EOB-CODES-EXIST          PIC X.
   732             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
   733         16  FILLER                      PIC X(35).               ELCTRLR
   734         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   735         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   736                                                                  ELCTRLR
   737     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.           ELCTRLR
   738         16  AT-PROMPT-LINE-1            PIC X(60).               ELCTRLR
   739         16  AT-PROMPT-LINE-2            PIC X(60).               ELCTRLR
   740         16  AT-PROMPT-START-DT          PIC XX.                  ELCTRLR
   741         16  AT-PROMPT-END-DT            PIC XX.                  ELCTRLR
   742         16  FILLER                      PIC X(35).               ELCTRLR
   743         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.                  ELCTRLR
   744         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).                ELCTRLR
   745                                                                  ELCTRLR
   746     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.           ELCTRLR
   747         16  AT-DENIAL-INFO-1            PIC X(60).               ELCTRLR
   748         16  AT-DENIAL-INFO-2            PIC X(60).               ELCTRLR
   749         16  AT-DENIAL-DT                PIC XX.                  ELCTRLR
   750         16  AT-RETRACTION-DT            PIC XX.                  ELCTRLR
   751         16  AT-DENIAL-REASON-CODE       PIC X(4).                ELCTRLR
   752*         16  FILLER                      PIC X(31).               ELCTRLR
   753         16  AT-DENIAL-PROOF-DT          PIC XX.
   754         16  FILLER                      PIC X(29).
   755         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.                  ELCTRLR
   756         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).                ELCTRLR
   757                                                                  ELCTRLR
   758     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
   759         16  AT-OLD-INCURRED-DT          PIC XX.                  ELCTRLR
   760         16  AT-OLD-REPORTED-DT          PIC XX.                  ELCTRLR
   761         16  AT-OLD-ESTABLISHED-DT       PIC XX.                  ELCTRLR
   762         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3. ELCTRLR
   763         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.   ELCTRLR
   764         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3. ELCTRLR
   765         16  AT-OLD-PAID-THRU-DT         PIC XX.                  ELCTRLR
   766         16  AT-LAST-PMT-MADE-DT         PIC XX.                  ELCTRLR
   767         16  FILLER                      PIC X(26).               ELCTRLR
   768         16  AT-OLD-DIAG-CODE            PIC X(6).                ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMATF3.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   769         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.   ELCTRLR
   770         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3. ELCTRLR
   771         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3. ELCTRLR
   772         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3. ELCTRLR
   773         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3. ELCTRLR
   774         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3. ELCTRLR
   775         16  AT-OLD-DIAG-DESCRIP         PIC X(60).               ELCTRLR
   776         16  AT-OLD-ICD-CODE-1           PIC X(8).
   777         16  AT-OLD-ICD-CODE-2           PIC X(8).
   778         16  FILLER                      PIC X(9).                ELCTRLR
   779         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   780                                                                  ELCTRLR
   781     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
   782         16  AT-FORM-SEND-ON-DT          PIC XX.                  ELCTRLR
   783         16  AT-FORM-FOLLOW-UP-DT        PIC XX.                  ELCTRLR
   784         16  AT-FORM-RE-SEND-DT          PIC XX.                  ELCTRLR
   785         16  AT-FORM-ANSWERED-DT         PIC XX.                  ELCTRLR
   786         16  AT-FORM-PRINTED-DT          PIC XX.                  ELCTRLR
   787         16  AT-FORM-REPRINT-DT          PIC XX.                  ELCTRLR
   788         16  AT-FORM-TYPE                PIC X.                   ELCTRLR
   789             88  INITIAL-FORM                  VALUE '1'.         ELCTRLR
   790             88  PROGRESS-FORM                 VALUE '2'.         ELCTRLR
   791         16  AT-INSTRUCT-LN-1            PIC X(28).               ELCTRLR
   792         16  AT-INSTRUCT-LN-2            PIC X(28).               ELCTRLR
   793         16  AT-INSTRUCT-LN-3            PIC X(28).               ELCTRLR
   794         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.     ELCTRLR
   795         16  AT-FORM-ADDRESS             PIC X.                   ELCTRLR
   796             88  FORM-TO-INSURED              VALUE 'I'.          ELCTRLR
   797             88  FORM-TO-ACCOUNT              VALUE 'A'.          ELCTRLR
   798             88  FORM-TO-OTHER-1              VALUE 'O'.          ELCTRLR
   799             88  FORM-TO-OTHER-2              VALUE 'Q'.          ELCTRLR
   800         16  AT-RELATED-1.                                        ELCTRLR
   801             20 AT-REL-CARR-1            PIC X.                   ELCTRLR
   802             20 AT-REL-CLAIM-1           PIC X(7).                ELCTRLR
   803             20 AT-REL-CERT-1            PIC X(11).               ELCTRLR
   804         16  AT-RELATED-2.                                        ELCTRLR
   805             20 AT-REL-CARR-2            PIC X.                   ELCTRLR
   806             20 AT-REL-CLAIM-2           PIC X(7).                ELCTRLR
   807             20 AT-REL-CERT-2            PIC X(11).               ELCTRLR
   808         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.                  ELCTRLR
   809         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.                  ELCTRLR
   810         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.                  ELCTRLR
   811         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.                  ELCTRLR
   812         16  AT-FORM-REM-PRINT-DT        PIC XX.                  ELCTRLR
   813         16  AT-STOP-FORM-DT             PIC X(2).
   814                                                                  ELCTRLR
   815         16  FILLER                      PIC X(09).               ELCTRLR
   816         16  AT-FORM-LAST-MAINT-DT       PIC XX.                  ELCTRLR
   817         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).                ELCTRLR
   818******************************************************************ELCTRLR
   819
   820 WORKING-STORAGE SECTION.
   821 77  S1                          PIC S9(3) COMP-3 VALUE +0.
   822 77  WS-STATE-SW                 PIC X  VALUE ' '.
   823     88  VALID-STATE               VALUE 'Y'.
   824 01  WS-STATUS-CODES.
   825     05  ELMSTR-FILE-STATUS      PIC XX  VALUE SPACES.
   826     05  ELTRLR-FILE-STATUS      PIC XX  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* PEMATF3.cbl
   827     05  WS-EOF-SW               PIC X   VALUE SPACES.
   828         88  END-OF-ELTRLR               VALUE 'Y'.
   829         88  MORE-ELTRLR                 VALUE ' '.
   830
   831*****************************************************************
   832*                                                               *
   833*                     STATE CODE TABLE                          *
   834*                                                               *
   835*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     *
   836*            SEARCH VERB WILL NOT WORK PROPERLY !               *
   837*                                                               *
   838*****************************************************************
   839
   840 01  STATE-VALUES.
   841     05  PIC X(24)  VALUE 'AAAA                    '.
   842     05  PIC X(24)  VALUE 'AEAE                    '.
   843     05  PIC X(24)  VALUE 'AKAKALASKA              '.
   844     05  PIC X(24)  VALUE 'ALALALABAMA             '.
   845     05  PIC X(24)  VALUE 'APAP                    '.
   846     05  PIC X(24)  VALUE 'ARARARKANSAS            '.
   847     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.
   848     05  PIC X(24)  VALUE 'AZAZARIZONA             '.
   849     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.
   850     05  PIC X(24)  VALUE 'CDCNCANADA              '.
   851     05  PIC X(24)  VALUE 'CNCNCANADA              '.
   852     05  PIC X(24)  VALUE 'COCOCOLORADO            '.
   853     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.
   854     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.
   855     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.
   856     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.
   857     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.
   858     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.
   859     05  PIC X(24)  VALUE 'GUGUGUAM                '.
   860     05  PIC X(24)  VALUE 'HIHIHAWAII              '.
   861     05  PIC X(24)  VALUE 'IAIAIOWA                '.
   862     05  PIC X(24)  VALUE 'IDIDIDAHO               '.
   863     05  PIC X(24)  VALUE 'ILILILLINOIS            '.
   864     05  PIC X(24)  VALUE 'INININDIANA             '.
   865     05  PIC X(24)  VALUE 'KSKSKANSAS              '.
   866     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.
   867     05  PIC X(24)  VALUE 'LALALOUISIANA           '.
   868     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.
   869     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.
   870     05  PIC X(24)  VALUE 'MEMEMAINE               '.
   871     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.
   872     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.
   873     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.
   874     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.
   875     05  PIC X(24)  VALUE 'MTMTMONTANA             '.
   876     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.
   877     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.
   878     05  PIC X(24)  VALUE 'NENENEBRASKA            '.
   879     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.
   880     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.
   881     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.
   882     05  PIC X(24)  VALUE 'NVNVNEVADA              '.
   883     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.
   884     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* PEMATF3.cbl
   885     05  PIC X(24)  VALUE 'OHOHOHIO                '.
   886     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.
   887     05  PIC X(24)  VALUE 'OROROREGON              '.
   888     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.
   889     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.
   890     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.
   891     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.
   892     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.
   893     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.
   894     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.
   895     05  PIC X(24)  VALUE 'TXTXTEXAS               '.
   896     05  PIC X(24)  VALUE 'UTUTUTAH                '.
   897     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.
   898     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.
   899     05  PIC X(24)  VALUE 'VTVTVERMONT             '.
   900     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.
   901     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.
   902     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.
   903     05  PIC X(24)  VALUE 'WYWYWYOMING             '.
   904
   905 01  FILLER REDEFINES STATE-VALUES.
   906     05  STATE-TABLE
   907             OCCURS 63 TIMES
   908             ASCENDING KEY IS ST-STATE
   909             INDEXED BY ST-INDEX.
   910         10  ST-STATE          PIC XX.
   911         10  ST-ALT-STATE      PIC XX.
   912         10  ST-NAME           PIC X(20).
   913
   914 01  WS-HOLD-CITY-STATE          PIC X(30)  VALUE SPACES.
   915 01  WS-WORK-CITY-ST.
   916     05  WS-WORK-CITY            PIC X(28)  VALUE SPACES.
   917     05  WS-WORK-STATE           PIC XX     VALUE SPACES.
   918 01  WS-HOLD-ELTRLR              PIC X(200) VALUE LOW-VALUES.
   919 01  WS-WORK-FIELDS.
   920     05  WS-ABEND-FLD            PIC 9         VALUE ZEROS.
   921     05  WS-ZERO-FLD             PIC 9         VALUE ZEROS.
   922     05  WS-ELTRLR-RECS-IN       PIC 9(9)      VALUE ZEROS.
   923     05  WS-ELTRLR-RECS-FIX      PIC 9(9)      VALUE ZEROS.
   924     05  WS-ELTRLR-RECS-DEL      PIC 9(9)      VALUE ZEROS.
   925     05  WS-DISPLAY-CNT          PIC Z,ZZZ,ZZ9 VALUE ZEROS.
   926     05  WS-INVALID-ST-CNT       PIC 9(9)      VALUE ZEROS.
   927
   928 PROCEDURE DIVISION.
   929 0000-MAINLINE.
   930
   931     PERFORM 0100-OPEN-FILES     THRU 0100-EXIT
   932     PERFORM 0200-INITIALIZE     THRU 0200-EXIT
   933     PERFORM 0500-PROCESS        THRU 0500-EXIT UNTIL
   934        END-OF-ELTRLR
   935*       OR WS-ELTRLR-RECS-FIX > 500
   936     PERFORM 3000-CLOSE-FILES    THRU 3000-EXIT
   937     PERFORM 4000-FINAL-TOTALS   THRU 4000-EXIT
   938     GOBACK
   939
   940     .
   941 0000-EXIT.
   942     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* PEMATF3.cbl
   943
   944 0100-OPEN-FILES.
   945
   946     OPEN I-O   ELTRLR
   947*    OPEN INPUT ELTRLR
   948
   949     OPEN INPUT ELMSTR
   950
   951     IF ELTRLR-FILE-STATUS = '00'
   952         CONTINUE
   953     ELSE
   954         DISPLAY '*** ERROR OPENING ELTRLR FILE ***'
   955         DISPLAY '*** STATUS CODE IS ' ELTRLR-FILE-STATUS
   956         PERFORM 9999-ABEND-RTN
   957     END-IF
   958
   959     IF ELMSTR-FILE-STATUS = '00'
   960         CONTINUE
   961     ELSE
   962         DISPLAY '*** ERROR OPENING ELMSTR FILE ***'
   963         DISPLAY '*** STATUS CODE IS ' ELMSTR-FILE-STATUS
   964         PERFORM 9999-ABEND-RTN
   965     END-IF
   966
   967     .
   968 0100-EXIT.
   969     EXIT.
   970
   971 0200-INITIALIZE.
   972
   973     MOVE SPACES                 TO WS-EOF-SW
   974     MOVE ZEROS                  TO WS-ELTRLR-RECS-IN
   975                                    WS-ELTRLR-RECS-FIX
   976                                    WS-ELTRLR-RECS-DEL
   977
   978     PERFORM 1100-START-ELTRLR   THRU 1100-EXIT
   979
   980     PERFORM 1200-READ-ELTRLR    THRU 1200-EXIT
   981
   982     .
   983 0200-EXIT.
   984     EXIT.
   985
   986 0500-PROCESS.
   987
   988     IF (AT-TRAILER-TYPE = '5')
   989        AND (AT-CITY-STATE NOT = SPACES)
   990        PERFORM 1000-PROCESS     THRU 1000-EXIT
   991     END-IF
   992
   993     PERFORM 1200-READ-ELTRLR    THRU 1200-EXIT
   994
   995     .
   996 0500-EXIT.
   997     EXIT.
   998
   999 1000-PROCESS.
  1000
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* PEMATF3.cbl
  1001     MOVE SPACES                 TO WS-WORK-CITY-ST
  1002     MOVE AT-CITY-STATE          TO WS-HOLD-CITY-STATE
  1003** CHECK FOR GUAM AND CHANGE TO GU **
  1004     PERFORM VARYING S1 FROM +27 BY -1 UNTIL
  1005        (S1 = +1)
  1006        OR (AT-CITY-STATE (S1:4) = 'GUAM')
  1007     END-PERFORM
  1008     IF AT-CITY-STATE (S1:4) = 'GUAM'
  1009        MOVE 'GU  '              TO AT-CITY-STATE (S1:4)
  1010        DISPLAY ' FIXED GUAM ' WS-HOLD-CITY-STATE ' '
  1011           AT-CITY-STATE
  1012        MOVE AT-CITY-STATE       TO WS-HOLD-CITY-STATE
  1013     END-IF
  1014
  1015     PERFORM VARYING S1 FROM +30 BY -1 UNTIL
  1016        (AT-CITY-STATE (S1:1) NOT = SPACE AND '.')
  1017        OR (S1 = +1)
  1018     END-PERFORM
  1019     IF S1 > 3
  1020        SUBTRACT +1 FROM S1
  1021        MOVE AT-CITY-STATE (S1:2)
  1022                                 TO WS-WORK-STATE
  1023        SUBTRACT +1 FROM S1
  1024        PERFORM VARYING S1 FROM S1 BY -1 UNTIL
  1025           AT-CITY-STATE (S1:1) NOT = SPACE
  1026        END-PERFORM
  1027        IF S1 > 2
  1028           IF AT-CITY-STATE (S1:1) = ',' OR ';' OR '.'
  1029              MOVE AT-CITY-STATE (1:S1 - 1) TO WS-WORK-CITY
  1030           ELSE
  1031              MOVE AT-CITY-STATE (1:S1) TO WS-WORK-CITY
  1032           END-IF
  1033        END-IF
  1034        MOVE SPACE               TO WS-STATE-SW
  1035        PERFORM 1500-EDIT-STATE  THRU 1500-EXIT
  1036        IF VALID-STATE
  1037           MOVE WS-WORK-CITY     TO AT-CITY
  1038           MOVE WS-WORK-STATE    TO AT-STATE
  1039           PERFORM 2100-REWRITE-ELTRLR
  1040                                 THRU 2100-EXIT
  1041        ELSE
  1042           PERFORM 1300-READ-ELMSTR
  1043                                 THRU 1300-EXIT
  1044        END-IF
  1045     ELSE
  1046        DISPLAY ' WEIRD CITY STATE ' AT-CONTROL-PRIMARY (2:19)
  1047           ' ' AT-SEQUENCE-NO ' ' AT-CITY-STATE
  1048     END-IF
  1049
  1050
  1051     .
  1052 1000-EXIT.
  1053     EXIT.
  1054
  1055 1100-START-ELTRLR.
  1056
  1057     MOVE LOW-VALUES             TO AT-CONTROL-PRIMARY
  1058     MOVE X'04'                  TO AT-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* PEMATF3.cbl
  1059
  1060     START ELTRLR KEY IS NOT <
  1061                      AT-CONTROL-PRIMARY
  1062     IF ELTRLR-FILE-STATUS NOT = '00'
  1063        DISPLAY ' ELTRLR, BAD START '
  1064              ELTRLR-FILE-STATUS
  1065        PERFORM 9999-ABEND-RTN
  1066     END-IF
  1067
  1068     .
  1069
  1070 1100-EXIT.
  1071     EXIT.
  1072
  1073 1200-READ-ELTRLR.
  1074
  1075     READ ELTRLR NEXT RECORD
  1076
  1077     IF ELTRLR-FILE-STATUS = '10' OR '23'
  1078        SET END-OF-ELTRLR TO TRUE
  1079     ELSE
  1080        IF ELTRLR-FILE-STATUS NOT = '00'
  1081           DISPLAY 'ELTRLR, BAD READ NEXT '
  1082                ELTRLR-FILE-STATUS
  1083           PERFORM 9999-ABEND-RTN
  1084        ELSE
  1085           ADD 1              TO WS-ELTRLR-RECS-IN
  1086        END-IF
  1087     END-IF
  1088
  1089     .
  1090 1200-EXIT.
  1091     EXIT.
  1092
  1093 1300-READ-ELMSTR.
  1094
  1095     MOVE AT-CONTROL-PRIMARY (1:20)
  1096                                 TO CL-CONTROL-PRIMARY
  1097
  1098     READ ELMSTR
  1099
  1100     IF (ELMSTR-FILE-STATUS = '00')
  1101        IF CLAIM-IS-OPEN
  1102           DISPLAY 'OPEN CLAIM WITH INVALID STATE CODE: '
  1103           WS-WORK-STATE
  1104           ' ' WS-HOLD-CITY-STATE ' ' CL-CONTROL-PRIMARY (2:19)
  1105        ELSE
  1106           DISPLAY 'INVALID STATE CODE: ' WS-WORK-STATE
  1107           ' ' WS-HOLD-CITY-STATE ' ' CL-CONTROL-PRIMARY (2:19)
  1108        END-IF
  1109     ELSE
  1110        DISPLAY ' CLAIM NOT FOUND ' CL-CONTROL-PRIMARY (2:19)
  1111     END-IF
  1112
  1113     .
  1114
  1115 1300-EXIT.
  1116     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* PEMATF3.cbl
  1117
  1118 1500-EDIT-STATE.
  1119
  1120     SEARCH ALL STATE-TABLE AT END
  1121           ADD 1 TO WS-INVALID-ST-CNT
  1122        WHEN ST-STATE (ST-INDEX) = WS-WORK-STATE
  1123           SET VALID-STATE TO TRUE
  1124     END-SEARCH
  1125
  1126     .
  1127 1500-EXIT.
  1128     EXIT.
  1129
  1130 2100-REWRITE-ELTRLR.
  1131
  1132*    DISPLAY ' OLD ' WS-HOLD-CITY-STATE ' NEW ' WS-WORK-CITY-ST
  1133     REWRITE ACTIVITY-TRAILERS
  1134*    MOVE '00' TO ELTRLR-FILE-STATUS
  1135
  1136     IF ELTRLR-FILE-STATUS = '00'
  1137         ADD 1                   TO WS-ELTRLR-RECS-FIX
  1138     ELSE
  1139         DISPLAY 'ELTRLR, BAD REWRITE '
  1140         DISPLAY '*** STATUS CODE IS ' ELTRLR-FILE-STATUS
  1141         PERFORM 9999-ABEND-RTN
  1142     END-IF
  1143     .
  1144 2100-EXIT.
  1145     EXIT.
  1146
  1147 2200-DELETE-ELTRLR.
  1148
  1149     DELETE  ELTRLR
  1150
  1151     IF ELTRLR-FILE-STATUS = '00'
  1152         ADD 1                   TO WS-ELTRLR-RECS-DEL
  1153     ELSE
  1154         DISPLAY 'ELTRLR, BAD DELETE  '
  1155         DISPLAY '*** STATUS CODE IS ' ELTRLR-FILE-STATUS
  1156         PERFORM 9999-ABEND-RTN
  1157     END-IF
  1158     .
  1159 2200-EXIT.
  1160     EXIT.
  1161
  1162
  1163 3000-CLOSE-FILES.
  1164
  1165     CLOSE ELTRLR ELMSTR
  1166
  1167     .
  1168 3000-EXIT.
  1169     EXIT.
  1170
  1171 4000-FINAL-TOTALS.
  1172
  1173     DISPLAY '**************************************************'
  1174     DISPLAY '***                                            ***'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* PEMATF3.cbl
  1175
  1176     MOVE WS-ELTRLR-RECS-IN      TO WS-DISPLAY-CNT
  1177     DISPLAY '***  TRLR RECORDS     IN         = ' WS-DISPLAY-CNT
  1178
  1179     MOVE WS-ELTRLR-RECS-FIX     TO WS-DISPLAY-CNT
  1180     DISPLAY '***  TRLR RECORDS     FIXED      = ' WS-DISPLAY-CNT
  1181
  1182     MOVE WS-INVALID-ST-CNT      TO WS-DISPLAY-CNT
  1183     DISPLAY '***  INVALID STATES              = ' WS-DISPLAY-CNT
  1184
  1185     MOVE WS-ELTRLR-RECS-DEL     TO WS-DISPLAY-CNT
  1186     DISPLAY '***  TRLR RECORDS     DELETED    = ' WS-DISPLAY-CNT
  1187
  1188
  1189     DISPLAY '***                                            ***'
  1190     DISPLAY '**************************************************'
  1191     .
  1192 4000-EXIT.
  1193     EXIT.
  1194
  1195 9999-ABEND-RTN.
  1196
  1197     DISPLAY '*** ELTRLR  FILE CONVERSION PROGRAM ABENDING ***'
  1198     DISPLAY '************************************************'
  1199
  1200     MOVE 1                      TO WS-ABEND-FLD
  1201     MOVE 0                      TO WS-ZERO-FLD
  1202
  1203     COMPUTE WS-ABEND-FLD = WS-ABEND-FLD / WS-ZERO-FLD
  1204     .
  1205 9999-EXIT.
  1206     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3892     Code:        2426
