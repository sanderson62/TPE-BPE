* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS010D.cbl
* Options: int("ECS010D.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010D.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010D.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010D.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS010D.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61* 041508  CR2008030300004  PEMA  ADD POST CARD REFUND PROCESSING
    62* 042408  CR2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    63* 050808  IR2008050100002  PEMA  CHECK FOR LF AMT = ZERO
    64* 080808  IR2008080100002  PEMA  CHECK FOR AH AMT = ZERO
    65* 111208  IR2008111000001  PEMA  CORRECT BANK FEE CALC.
    66* 040109  CR2009031600001  AJRA  ADD VIN TO CERT TRLR.
    67* 093009  CR2009010500002  PEMA  CORRECT EARNED COMMISSION CALC
    68* 121609  CR2008112100001  AJRA  CORRECT AL, TX, VA STATE STAT EP
    69* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    70* 042110  CR2010010400006  PEMA  ADD PC FIELDS FOR EMERALD 032
    71******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS010D.cbl
    73 ENVIRONMENT DIVISION.
    74 CONFIGURATION SECTION.
    75 SPECIAL-NAMES.
    76     C02 IS LCP-CH2
    77     C03 IS LCP-CH3
    78     C04 IS LCP-CH4
    79     C05 IS LCP-CH5
    80     C06 IS LCP-CH6
    81     C07 IS LCP-CH7
    82     C08 IS LCP-CH8
    83     C09 IS LCP-CH9
    84     C10 IS LCP-CH10
    85     C11 IS LCP-CH11
    86     C12 IS LCP-CH12
    87     S01 IS LCP-P01
    88     S02 IS LCP-P02.
    89
    90 INPUT-OUTPUT SECTION.
    91 FILE-CONTROL.
    92
    93     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
    94
    95     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
    96
    97     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
    98                             ACCESS IS SEQUENTIAL
    99                             ORGANIZATION IS INDEXED
   100                             FILE STATUS IS ERACCTT-FILE-STATUS
   101                             RECORD KEY IS AM-CONTROL-PRIMARY.
   102
   103     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
   104                             ACCESS IS DYNAMIC
   105                             ORGANIZATION IS INDEXED
   106                             FILE STATUS IS ERRTBL-FILE-STATUS
   107                             RECORD KEY IS RE-CONTROL-PRIMARY.
   108
   109     SELECT ERCTBL           ASSIGN TO ERCTBLT
   110                             ACCESS IS DYNAMIC
   111                             ORGANIZATION IS INDEXED
   112                             FILE STATUS IS ERCTBL-FILE-STATUS
   113                             RECORD KEY IS CT-CONTROL-PRIMARY.
   114
   115     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
   116                             ORGANIZATION INDEXED
   117                             ACCESS DYNAMIC
   118                             RECORD KEY ME-CONTROL-PRIMARY
   119                             FILE STATUS ERMEBL-FILE-STATUS.
   120
   121     SELECT ERRESC-IN        ASSIGN TO ERRESC
   122                             ORGANIZATION IS INDEXED
   123                             ACCESS IS DYNAMIC
   124                             RECORD KEY IS ERRESC-RECORD-KEY
   125                             FILE STATUS IS ERRESC-FILE-STATUS.
   126
   127     SELECT ELCRTT           ASSIGN TO ELCRTT
   128                             ACCESS IS DYNAMIC
   129                             ORGANIZATION IS INDEXED
   130                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS010D.cbl
   131                             RECORD KEY IS CS-CONTROL-PRIMARY.
   132
   133     SELECT ERAGTC           ASSIGN TO ERAGTC
   134                             ACCESS IS DYNAMIC
   135                             ORGANIZATION IS INDEXED
   136                             FILE STATUS IS ERAGTC-FILE-STATUS
   137                             RECORD KEY IS AG-CONTROL-PRIMARY.
   138
   139     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   140
   141     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   142
   143     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   144
   145
   146     SELECT ME-ECS010-BALANCE
   147                             ASSIGN TO SYS012
   148                             ORGANIZATION IS LINE SEQUENTIAL.
   149
   150     SELECT ME50-ECS010-BALANCE
   151                             ASSIGN TO SYS013
   152                             ORGANIZATION IS LINE SEQUENTIAL.
   153
   154     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   155
   156     SELECT DISK-DATE        ASSIGN TO SYS019.
   157
   158     SELECT PRINT-COPY       ASSIGN TO SYS008.
   159
   160     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   161
   162     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS010D.cbl
   164 DATA DIVISION.
   165 FILE SECTION.
   166
   167 FD  PENDING-EXTRACT
   168     BLOCK CONTAINS 0 RECORDS
   169     RECORDING MODE F.
   170
*  171                             COPY ERCEXTD.
   172******************************************************************04/29/98
   173*                                                                *ERCEXTD
   174*                                                                *ERCEXTD
   175*                            ERCEXTD                             *   LV002
   176*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   177*                            VMOD=2.002                          *   CL**2
   178*                                                                *ERCEXTD
   179*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   180*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   181*                                                                *ERCEXTD
   182*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   183*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   184*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   185*                                                                *ERCEXTD
   186*         RECORD                                                 *ERCEXTD
   187*          TYPE          PROGRAM USING                           *ERCEXTD
   188*        --------        --------------------------------        *ERCEXTD
   189*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   190*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   191*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   192*                                                                *ERCEXTD
   193* -------------------------------------------------------------- *ERCEXTD
   194*                                                                *ERCEXTD
   195*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   196*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   197*                                                                *ERCEXTD
   198*   FILENAME = EREXTD                                            *ERCEXTD
   199*                                                                *ERCEXTD
   200******************************************************************ERCEXTD
   201                                                                  ERCEXTD
   202 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   203     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   204         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   205                                                                  ERCEXTD
   206     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   207         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   208         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   209         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   210                                                                  ERCEXTD
   211     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   212                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS010D.cbl
   214 FD  CERT-MASTER-IN
*  215                             COPY ECSCRIFD.
   216******************************************************************07/10/97
   217*                                                                *ECSCRIFD
   218*                            ECSCRIFD                            *   LV001
   219*                            VMOD 2.005                          *ECSCRIFD
   220*                                                                *ECSCRIFD
   221*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   222*                                                                *ECSCRIFD
   223******************************************************************ECSCRIFD
   224     BLOCK CONTAINS 0 RECORDS
   225     RECORDING MODE F.                                            ECSCRIFD
   226                                                                  ECSCRIFD
   227 01  CERT-IN-RECORD.                                              ECSCRIFD
   228                                                                  ECSCRIFD
   229     12  FILLER                            PIC XXX.               ECSCRIFD
   230     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   231     12  FILLER                            PIC X(66).             ECSCRIFD
   232     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   233     12  FILLER                            PIC X(20).             ECSCRIFD
   234     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   235     12  FILLER                            PIC X(14).             ECSCRIFD
   236     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   237     12  FILLER                            PIC X(39).             ECSCRIFD
   238     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   239     12  FILLER                            PIC X(45).             ECSCRIFD
   240     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   241     12  FILLER                            PIC X(35).             ECSCRIFD
   242     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   243     12  FILLER                            PIC X(41).             ECSCRIFD
   244     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   245     12  FILLER                            PIC X(48).             ECSCRIFD
   246     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   247     12  FILLER                            PIC X(9).              ECSCRIFD
   248     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   249     12  FILLER                            PIC X(120).            ECSCRIFD
   250     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   251     12  FILLER                            PIC X(73).             ECSCRIFD
   252     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   253     12  FILLER                            PIC X(464).            ECSCRIFD
   254                                                                  ECSCRIFD
   255******************************************************************ECSCRIFD
   256
   257 01  CI-RECORD.
   258     12  FILLER          PIC  X(03).
   259     12  CI-ACCOUNT-CONTROL.
   260         16  CI-CARRIER      PIC  X(01).
   261         16  CI-GROUPING     PIC  X(06).
   262         16  CI-STATE        PIC  X(02).
   263         16  CI-ACCOUNT      PIC  X(10).
   264     12  FILLER          PIC  X(06).
   265     12  CI-CERT-NO.
   266         16  CI-CERT     PIC X(10).
   267         16  CI-CERT-SFX PIC X.
   268     12  FILLER          PIC  X(1017).
   269
   270******************************************************
   271*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS010D.cbl
   272*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   273*   COMMERCIAL FEDERAL BANK
   274******************************************************
   275 01  CF-RECORD.
   276     12  FILLER          PIC X(759).
   277     12  CF-THIRD-AGENT  PIC X(10).
   278     12  FILLER          PIC X(7).
   279     12  CF-FOURTH-AGENT PIC X(10).
   280     12  FILLER          PIC X(270).
   281
   282******************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS010D.cbl
   284 FD  ERACCTT-IN.
   285
*  286                             COPY ERCACCT.
   287******************************************************************04/19/98
   288*                                                                *ERCACCT
   289*                                                                *ERCACCT
   290*                            ERCACCT                             *   LV031
   291*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   292*                            VMOD=2.031                          *ERCACCT
   293*                                                                *ERCACCT
   294*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   295*                                                                *ERCACCT
   296*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   297*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   298*                                                                *ERCACCT
   299*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   300*                                                                *ERCACCT
   301*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   302*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   303*                                                                *ERCACCT
   304*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   305*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   306*                                                                *ERCACCT
   307*   LOG = NO                                                     *ERCACCT
   308*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   309*                                                                *ERCACCT
   310*                                                                *ERCACCT
   311******************************************************************ERCACCT
   312*                   C H A N G E   L O G
   313*
   314* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   315*-----------------------------------------------------------------
   316*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   317* EFFECTIVE    NUMBER
   318*-----------------------------------------------------------------
   319* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   320* 092705    2005050300006  PEMA  ADD SPP LEASES
   321* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   322* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   323* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   324* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   325* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   326******************************************************************
   327                                                                  ERCACCT
   328 01  ACCOUNT-MASTER.                                              ERCACCT
   329     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   330         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   331                                                                  ERCACCT
   332     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   333         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   334         16  AM-MSTR-CNTRL.                                       ERCACCT
   335             20  AM-CONTROL-A.                                    ERCACCT
   336                 24  AM-CARRIER            PIC X.                 ERCACCT
   337                 24  AM-GROUPING.                                 ERCACCT
   338                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   339                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   340                 24  AM-STATE              PIC XX.                ERCACCT
   341                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCACCT)
   342                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   343                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   344             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   345                                           PIC X(19).             ERCACCT
   346             20  AM-CNTRL-B.                                      ERCACCT
   347                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   348                 24  FILLER                PIC X(4).              ERCACCT
   349             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   350                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   351                                                                  ERCACCT
   352     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   353         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   354         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   355         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   356         16  AM-VG-STATE                   PIC XX.                ERCACCT
   357         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   358         16  AM-VG-DATE.                                          ERCACCT
   359             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   360             20  FILLER                    PIC X(4).              ERCACCT
   361         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   362                                           PIC 9(11)      COMP-3. ERCACCT
   363     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   364         16  FILLER                        PIC X(10).
   365         16  AM-VG-KEY3.
   366             20  AM-VG3-ACCOUNT            PIC X(10).
   367             20  AM-VG3-EXP-DT             PIC XX.
   368         16  FILLER                        PIC X(4).
   369     12  AM-MAINT-INFORMATION.                                    ERCACCT
   370         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   371         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   372         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   373         16  FILLER                        PIC XX.                ERCACCT
   374                                                                  ERCACCT
   375     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   376     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   377                                                                  ERCACCT
   378     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   379         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   380         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   381                                                                  ERCACCT
   382     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   383     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   384                                                                  ERCACCT
   385     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   386     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   387                                                                  ERCACCT
   388     12  AM-NAME                           PIC X(30).             ERCACCT
   389     12  AM-PERSON                         PIC X(30).             ERCACCT
   390     12  AM-ADDRS                          PIC X(30).             ERCACCT
   391     12  AM-CITY.
   392         16  AM-ADDR-CITY                  PIC X(28).
   393         16  AM-ADDR-STATE                 PIC XX.
   394     12  AM-ZIP.                                                  ERCACCT
   395         16  AM-ZIP-PRIME.                                        ERCACCT
   396             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   397                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   398             20  FILLER                    PIC X(4).              ERCACCT
   399         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCACCT)
   400     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   401         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   402         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   403         16  FILLER                        PIC XXX.               ERCACCT
   404     12  AM-TEL-NO.                                               ERCACCT
   405         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   406         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   407         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   408     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   409         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   410         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   411                                                                  ERCACCT
   412     12  AM-COMM-STRUCTURE.                                       ERCACCT
   413         16  AM-DEFN-1.                                           ERCACCT
   414             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   415                 24  AM-AGT.                                      ERCACCT
   416                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   417                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   418                 24  AM-COM-TYP            PIC X.                 ERCACCT
   419                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   420                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   421                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   422                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   423                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   424                 24  AM-GL-CODES           PIC X.                 ERCACCT
   425                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   426                 24  FILLER                PIC X(01).             ERCACCT
   427         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   428             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   429                 24  FILLER                PIC X(11).             ERCACCT
   430                 24  AM-L-COMA             PIC XXX.               ERCACCT
   431                 24  AM-J-COMA             PIC XXX.               ERCACCT
   432                 24  AM-A-COMA             PIC XXX.               ERCACCT
   433                 24  FILLER                PIC X(6).              ERCACCT
   434                                                                  ERCACCT
   435     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   436         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   437                                                                  ERCACCT
   438     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   439                                                                  ERCACCT
   440     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   441         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   442         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   443     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   444         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   445         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   446     12  AM-GPCD                           PIC 99.                ERCACCT
   447     12  AM-IG                             PIC X.                 ERCACCT
   448         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   449         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   450     12  AM-STATUS                         PIC X.                 ERCACCT
   451         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   452         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   453         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   454         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   455         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   456         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   457     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCACCT)
   458     12  AM-ID-NO                          PIC X(11).             ERCACCT
   459                                                                  ERCACCT
   460     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   461     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   462     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   463     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   464     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   465     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   466     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   467     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   468     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   469                                                                  ERCACCT
   470     12  AM-USER-FIELDS.                                          ERCACCT
   471         16  AM-FLD-1                      PIC XX.                ERCACCT
   472         16  AM-FLD-2                      PIC XX.                ERCACCT
   473         16  AM-FLD-3                      PIC XX.                ERCACCT
   474         16  AM-FLD-4                      PIC XX.                ERCACCT
   475         16  AM-FLD-5                      PIC XX.                ERCACCT
   476                                                                  ERCACCT
   477     12  AM-1ST-PROD-DATE.                                        ERCACCT
   478         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   479         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   480         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   481     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   482     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   483         16  AM-PUR-YR                     PIC XX.                ERCACCT
   484         16  AM-PUR-MO                     PIC XX.                ERCACCT
   485         16  AM-PUR-DA                     PIC XX.                ERCACCT
   486     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   487     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   488     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   489     12  AM-INACTIVE-DATE.                                        ERCACCT
   490         16  AM-INA-MO                     PIC 99.                ERCACCT
   491         16  AM-INA-DA                     PIC 99.                ERCACCT
   492         16  AM-INA-YR                     PIC 99.                ERCACCT
   493     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   494                                                                  ERCACCT
   495     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   496     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   497                                                                  ERCACCT
   498     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   499         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   500         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   501         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   502         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   503                                                                  ERCACCT
   504     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   505         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   506         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   507                                                                  ERCACCT
   508     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   509                                                                  ERCACCT
   510     12  AM-OVER-SHORT.                                           ERCACCT
   511         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   512         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   513                                                                  ERCACCT
   514     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   515     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCACCT)
   516                                                                  ERCACCT
   517     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   518     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   519                                                                  ERCACCT
   520     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   521     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   522     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   523     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   524     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   525     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   526     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   527     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   528     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   529     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   530     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   531     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   532     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   533     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   534     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   535     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   536                                                                  ERCACCT
   537     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   538                                                                  ERCACCT
   539     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   540     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   541                                                                  ERCACCT
   542     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   543     12  AM-EARN-METHODS.                                         ERCACCT
   544         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   545             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   546             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   547             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   548             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   549         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   550             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   551             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   552             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   553             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   554         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   555             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   556             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   557             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   558             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   559             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   560             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   561                                                                  ERCACCT
   562     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   563     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   564     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   565                                                                  ERCACCT
   566     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   567     12  AM-RET-P-E                        PIC X.                 ERCACCT
   568     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   569     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   570     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   571     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   572         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   573         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCACCT)
   574     12  AM-RETRO-EARNINGS.                                       ERCACCT
   575         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   576         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   577         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   578     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   579         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   580         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   581     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   582         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   583         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   584         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   585     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   586     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   587                                                                  ERCACCT
   588     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   589         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   590         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   591         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   592         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   593         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   594                                                                  ERCACCT
   595     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   596                                                                  ERCACCT
   597     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   598                                                                  ERCACCT
   599     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   600         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   601                                                                  ERCACCT
   602     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   603         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   604         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   605                                                                  ERCACCT
   606     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   607         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   608                                                                  ERCACCT
   609     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   610         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   611         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   612                                                                  ERCACCT
   613     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   614                                                                  ERCACCT
   615     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   616     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   617     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   618     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   619     12  AM-DCC-UEF-STATE                  PIC XX.
   620     12  FILLER                            PIC XXX.
   621     12  AM-REPORT-CODE-3                  PIC X(10).
   622*    12  FILLER                            PIC X(22).             ERCACCT
   623                                                                  ERCACCT
   624     12  AM-RESERVE-DATE.                                         ERCACCT
   625         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   626         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   627         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   628                                                                  ERCACCT
   629     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   630     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   631         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCACCT)
   632         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   633         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   634         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   635                                                                  ERCACCT
   636     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   637         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   638         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   639         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   640         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   641                                                                  ERCACCT
   642     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   643         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   644             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   645             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   646             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   647             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   648             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   649             20  FILLER                    PIC XX.                ERCACCT
   650         16  FILLER                        PIC X(80).             ERCACCT
   651                                                                  ERCACCT
   652     12  AM-TRANSFER-DATA.                                        ERCACCT
   653         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   654             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   655             20  AM-TRNFROM-GROUPING.                             ERCACCT
   656                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   657                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   658             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   659             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   660                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   661                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   662             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   663         16  AM-TRANSFERRED-TO.                                   ERCACCT
   664             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   665             20  AM-TRNTO-GROUPING.                               ERCACCT
   666                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   667                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   668             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   669             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   670                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   671                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   672             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   673         16  FILLER                        PIC X(10).             ERCACCT
   674                                                                  ERCACCT
   675     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   676                                                                  ERCACCT
   677     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   678         16  AM-DEFN-1-SAVED.                                     ERCACCT
   679             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   680                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   681                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   682                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   683                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   684                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   685                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   686                 24  FILLER                PIC X.                 ERCACCT
   687                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   688                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   689                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCACCT)
   690         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   691             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   692                 24  FILLER                PIC X(11).             ERCACCT
   693                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   694                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   695                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   696                 24  FILLER                PIC X(6).              ERCACCT
   697                                                                  ERCACCT
   698     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   699         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   700            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   701            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   702            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   703                                                                  ERCACCT
   704     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   705     12  FILLER                            PIC X(120).            ERCACCT
   706                                                                  ERCACCT
   707     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   708         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   709         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   710             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   711             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   712                                                          COMP-3. ERCACCT
   713             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   714                                                          COMP-3. ERCACCT
   715         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   716             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   717             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   718                                                          COMP-3. ERCACCT
   719             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   720                                                          COMP-3. ERCACCT
   721                                                                  ERCACCT
   722     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   723         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   724         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   725         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   726         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   727             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   728                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   729                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   730             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   731                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   732                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   733             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   734                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   735                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   736         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   737             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   738                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   739                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   740                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   741             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   742                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   743                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   744             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   745                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   746                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   747                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCACCT)
   748     12  AM-COMMENTS.                                             ERCACCT
   749         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   750                                                                  ERCACCT
   751     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   752         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   753         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   754         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   755         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   756         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   757             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   758             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   759             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   760             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   761         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   762             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   763             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   764             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   765         16  FILLER                        PIC X(102).            ERCACCT
   766                                                                  ERCACCT
   767     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   768         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   769             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   770             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   771             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   772             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   773             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   774         16  FILLER                          PIC X(10).           ERCACCT
   775******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS010D.cbl
   777 FD  ERRTBL-IN.
   778
*  779                             COPY ERCREIN.
   780******************************************************************07/27/93
   781*                                                                *ERCREIN
   782*                            ERCREIN                             *   LV009
   783*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   784*                            VMOD=2.010                          *   CL**9
   785*                                                                *ERCREIN
   786*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   787*                                                                *ERCREIN
   788*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   789*                                                                *ERCREIN
   790*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   791*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   792*                                                                *ERCREIN
   793*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   794*       ALTERNATE PATH = NONE                                    *ERCREIN
   795*                                                                *ERCREIN
   796*   LOG = NO                                                     *ERCREIN
   797*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   798*                                                                *ERCREIN
   799******************************************************************ERCREIN
   800*                   C H A N G E   L O G
   801*
   802* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   803*-----------------------------------------------------------------
   804*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   805* EFFECTIVE    NUMBER
   806*-----------------------------------------------------------------
   807* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   808* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   809******************************************************************
   810 01  REINSURANCE-RECORD.                                          ERCREIN
   811     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   812         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   813                                                                  ERCREIN
   814     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   815         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   816         16  RE-KEY.                                              ERCREIN
   817             20  RE-CODE                   PIC X.                 ERCREIN
   818                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   819                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   820             20  RE-TABLE                  PIC XXX.               ERCREIN
   821             20  FILLER                    PIC XXX.               ERCREIN
   822         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   823             20  FILLER                    PIC X.                 ERCREIN
   824             20  RE-COMPANY.                                      ERCREIN
   825                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   826                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   827                                                                  ERCREIN
   828     12  RE-MAINT-INFORMATION.                                    ERCREIN
   829         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   830         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   831         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   832         16  FILLER                        PIC X(10).             ERCREIN
   833                                                                  ERCREIN
   834     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCREIN)
   835         16  RE-100-COMP                   PIC 99.                ERCREIN
   836                                                                  ERCREIN
   837         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   838             20  RE-REI-COMP-NO.                                  ERCREIN
   839                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   840                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   841             20  RE-LF-QC                  PIC X.                 ERCREIN
   842             20  RE-AH-QC                  PIC X.                 ERCREIN
   843             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   844             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   845             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   846             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   847             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   848             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   849             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   850             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   851             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   852             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   853             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   854             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   855             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   856             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   857             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   858             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   859             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   860             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   861             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   862             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   863             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   864             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   865             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   866             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   867             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   868             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   869             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   870             20  RE-REMAINING              PIC X.                 ERCREIN
   871             20  RE-LF-RUNOFF-SW           PIC X.                      000
   872             20  RE-AH-RUNOFF-SW           PIC X.                      000
   873             20  FILLER                    PIC X(19).                  000
   874                                                                  ERCREIN
   875         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   876         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   877         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   878         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   879             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   880                                                                  ERCREIN
   881         16  FILLER                        PIC X(27).             ERCREIN
   882                                                                  ERCREIN
   883     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   884         16  RE-NAME                       PIC X(30).             ERCREIN
   885         16  RE-LF-PE                      PIC X.                 ERCREIN
   886         16  RE-AH-PE                      PIC X.                 ERCREIN
   887         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   888         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   889         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   890         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   891         16  RE-PRT-ST                     PIC X.                 ERCREIN
   892         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCREIN)
   893         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   894         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   895         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   896         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   897         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   898         16  RE-LF-COMM                    PIC X.                 ERCREIN
   899         16  RE-AH-COMM                    PIC X.                 ERCREIN
   900         16  RE-LF-TAX                     PIC X.                 ERCREIN
   901         16  RE-AH-TAX                     PIC X.                 ERCREIN
   902         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   903         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   904         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   905                                                                  ERCREIN
   906         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   907             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   908                                                                  ERCREIN
   909         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   910             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   911                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   912                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   913                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   914                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   915             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   916                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   917                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   918                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   919                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   920                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   921                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   922                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   923                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   924             20  FILLER                    PIC XXX.               ERCREIN
   925             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   926                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   927                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   928                                                                  ERCREIN
   929         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   930             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   931                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   932                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   933                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   934                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   935             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   936                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   937                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   938                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   939                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   940                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   941                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   942                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   943                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   944             20  FILLER                    PIC XXX.               ERCREIN
   945             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   946                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   947                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   948                                                                  ERCREIN
   949         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   950                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCREIN)
   951         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   952                                                                  ERCREIN
   953         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   954         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   955         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   956         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   957         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   958         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   959         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   960         16  RE-MORT-SW                    PIC X.                 ERCREIN
   961         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   962             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   963             88  RE-CEDED                          VALUE 'C'.        CL**2
   964             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   965             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   966                                                                  ERCREIN
   967         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   968             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   969         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   970             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   971         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   972             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   973         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   974             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   975         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   976             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   977                                                                     CL**3
   978         16  RE-PRT-CRSV                   PIC X.                    CL**5
   979                                                                     CL**5
   980         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   981                                                                     CL**8
   982         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   983                                                                     CL**8
   984         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   985                                                                     CL**9
   986         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   987             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   988             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   989
   990         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   991             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   992                                                                     CL**9
   993         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   994         16  FILLER                        PIC X(2281).              CL**9
   995                                                                  ERCREIN
   996         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   997                                                                  ERCREIN
   998******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS010D.cbl
  1000 FD  ERCTBL.
  1001
* 1002                             COPY ERCCTBL.
  1003******************************************************************04/29/98
  1004*                                                                *ERCCTBL
  1005*                                                                *ERCCTBL
  1006*                            ERCCTBL                             *   LV002
  1007*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1008*                            VMOD=2.003                              CL**2
  1009*                                                                *ERCCTBL
  1010*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1011*                                                                *ERCCTBL
  1012*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1013*                                                                *ERCCTBL
  1014*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1015*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1016*                                                                *ERCCTBL
  1017*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1018*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1019*                                                                *ERCCTBL
  1020*   LOG = NO                                                     *ERCCTBL
  1021*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1022*                                                                *ERCCTBL
  1023*                                                                *ERCCTBL
  1024******************************************************************ERCCTBL
  1025                                                                  ERCCTBL
  1026 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1027     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1028         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1029                                                                  ERCCTBL
  1030     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1031         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1032         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1033         16  CT-CNTRL-2.                                          ERCCTBL
  1034             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1035             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1036                                                                  ERCCTBL
  1037     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1038         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1039         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1040         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1041         16  FILLER                        PIC X(31).             ERCCTBL
  1042                                                                  ERCCTBL
  1043     12  CT-LIMITS.                                               ERCCTBL
  1044         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1045                                                                  ERCCTBL
  1046         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1047                                                                  ERCCTBL
  1048         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1049                                                                  ERCCTBL
  1050     12  CT-RATES.                                                ERCCTBL
  1051         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1052             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1053             20  CT-RT-R   REDEFINES                              ERCCTBL
  1054                 CT-RT                     PIC XXX.               ERCCTBL
  1055                                                                  ERCCTBL
  1056     12  FILLER                            PIC  X(42).            ERCCTBL
  1057                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS010D.cbl
  1058******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS010D.cbl
  1060 FD  ERMEBL-INOUT.
  1061
* 1062                             COPY ERCMEBL.
  1063******************************************************************
  1064*
  1065*
  1066*                            ERCMEBL                             *
  1067*                                                                *
  1068*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *
  1069*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *
  1070*                       4-6 OF THE FIELD NAMES) AND BY EL541     *
  1071*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*
  1072*                                                                *
  1073*    FILE TYPE = VSAM, KSDS                                      *
  1074*    RECORD SIZE = 765       RECFORM = FIXED                     *
  1075*                                                                *
  1076*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *
  1077*    ALTERNATE PATHS = NONE        STARTING IN  3                *
  1078*                                                                *
  1079******************************************************************
  1080
  1081******************************************************************
  1082*                   C H A N G E   L O G
  1083*
  1084* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1085*-----------------------------------------------------------------
  1086*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1087* EFFECTIVE    NUMBER
  1088*-----------------------------------------------------------------
  1089* 070714  CR2013060600001  PEMA  AUTOMATE EOM BALANCING
  1090******************************************************************
  1091 01  MONTH-END-BALANCES.
  1092     12  ME-RECORD-ID            PIC  XX.
  1093     12  ME-CONTROL-PRIMARY.
  1094         16  ME-COMPANY          PIC  XXX.
  1095         16  ME-MOYR             PIC  9999       COMP.
  1096     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.
  1097     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.
  1098     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.
  1099     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.
  1100     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.
  1101     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.
  1102     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.
  1103     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.
  1104     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.
  1105     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.
  1106     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.
  1107     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.
  1108     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.
  1109     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.
  1110*    12  ME-010-START            PIC  9(6)       COMP-3.
  1111*    12  ME-010-END              PIC  9(6)       COMP-3.
  1112     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.
  1113     12  ME-018-COMM-Y           PIC S9(9)V99    COMP-3.
  1114     12  ME-018-COMM-1           PIC S9(9)V99    COMP-3.
  1115     12  ME-018-OW-Y             PIC S9(9)V99    COMP-3.
  1116     12  ME-018-OW-1             PIC S9(9)V99    COMP-3.
  1117     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1118*    12  ME-018-START            PIC  9(6)       COMP-3.
  1119*    12  ME-018-END              PIC  9(6)       COMP-3.
  1120     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.
  1121     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.
  1122     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.
  1123     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.
  1124     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.
  1125     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.
  1126     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.
  1127     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.
  1128     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.
  1129     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.
  1130*    12  ME-019-START            PIC  9(6)       COMP-3.
  1131*    12  ME-019-END              PIC  9(6)       COMP-3.
  1132     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.
  1133     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.
  1134     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.
  1135     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.
  1136*    12  ME-030-START            PIC  9(6)       COMP-3.
  1137*    12  ME-030-END              PIC  9(6)       COMP-3.
  1138     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.
  1139     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.
  1140     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.
  1141     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.
  1142*    12  ME-032-START            PIC  9(6)       COMP-3.
  1143*    12  ME-032-END              PIC  9(6)       COMP-3.
  1144     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.
  1145     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.
  1146     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.
  1147     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.
  1148*    12  ME-035-START            PIC S9(6)       COMP-3.
  1149*    12  ME-035-END              PIC S9(6)       COMP-3.
  1150     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.
  1151     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.
  1152     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.
  1153     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.
  1154*    12  ME-038-START            PIC  9(6)       COMP-3.
  1155*    12  ME-038-END              PIC  9(6)       COMP-3.
  1156     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.
  1157     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.
  1158     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.
  1159*    12  ME-041-START            PIC  9(6)       COMP-3.
  1160*    12  ME-041-END              PIC  9(6)       COMP-3.
  1161     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.
  1162     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.
  1163     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.
  1164*    12  ME-050-START            PIC  9(6)       COMP-3.
  1165     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.
  1166*    12  ME-050-END              PIC  9(6)       COMP-3.
  1167     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.
  1168     12  ME-061-PREM             PIC S9(9)V99    COMP-3.
  1169     12  ME-061-COMM             PIC S9(9)V99    COMP-3.
  1170     12  ME-061-OR               PIC S9(9)V99    COMP-3.
  1171     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.
  1172     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.
  1173     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.
  1174     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.
  1175     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1176*    12  ME-061-START            PIC  9(6)       COMP-3.
  1177*    12  ME-061-END              PIC  9(6)       COMP-3.
  1178     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.
  1179     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.
  1180     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.
  1181*    12  ME-080-START            PIC  9(6)       COMP-3.
  1182*    12  ME-080-END              PIC  9(6)       COMP-3.
  1183     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.
  1184     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.
  1185     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.
  1186     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.
  1187*    12  ME-315-START            PIC  9(6)       COMP-3.
  1188*    12  ME-315-END              PIC  9(6)       COMP-3.
  1189     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.
  1190     12  ME-331-FLAG             PIC  9.
  1191     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.
  1192*    12  ME-331-START            PIC  9(6)       COMP-3.
  1193*    12  ME-331-END              PIC  9(6)       COMP-3.
  1194     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.
  1195     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.
  1196     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.
  1197*    12  ME-341-START            PIC  9(6)       COMP-3.
  1198*    12  ME-341-END              PIC  9(6)       COMP-3.
  1199     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.
  1200     12  ME-501-FLAG             PIC  9.
  1201     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.
  1202     12  ME-501-START            PIC  9(6)       COMP-3.
  1203     12  ME-501-END              PIC  9(6)       COMP-3.
  1204     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.
  1205     12  ME-509-FLAG             PIC  9.
  1206     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.
  1207     12  ME-509-START            PIC  9(6)       COMP-3.
  1208     12  ME-509-END              PIC  9(6)       COMP-3.
  1209     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.
  1210     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.
  1211     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.
  1212     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.
  1213     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.
  1214     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.
  1215     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.
  1216     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.
  1217     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.
  1218     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.
  1219     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.
  1220     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.
  1221     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.
  1222     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.
  1223     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.
  1224     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.
  1225     12  ME-522-START            PIC  9(6)       COMP-3.
  1226     12  ME-522-END              PIC  9(6)       COMP-3.
  1227     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.
  1228     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.
  1229     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.
  1230     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.
  1231     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.
  1232     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.
  1233     12  ME-524-START            PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1234     12  ME-524-END              PIC  9(6)       COMP-3.
  1235     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.
  1236     12  ME-525-FLAG             PIC  9.
  1237     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.
  1238     12  ME-525-START            PIC  9(6)       COMP-3.
  1239     12  ME-525-END              PIC  9(6)       COMP-3.
  1240     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.
  1241     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.
  1242     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.
  1243     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.
  1244     12  ME-048-START            PIC  9(6)       COMP-3.
  1245     12  ME-048-END              PIC  9(6)       COMP-3.
  1246     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.
  1247     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.
  1248
  1249     12  ME-019-CLMS-L           PIC S9(9)V99    COMP-3.
  1250     12  ME-019-CLMS-AH          PIC S9(9)V99    COMP-3.
  1251     12  ME-035-COMM-TOT         PIC S9(9)V99    COMP-3.
  1252     12  ME-035-CLMS-L           PIC S9(9)V99    COMP-3.
  1253     12  ME-035-CLMS-AH          PIC S9(9)V99    COMP-3.
  1254     12  ME-041-RECS-IN          PIC S9(9)       COMP-3.
  1255     12  ME-041-RECS-OUT         PIC S9(9)       COMP-3.
  1256     12  ME-050-ACT-L            PIC S9(7)       COMP-3.
  1257     12  ME-050-ACT-AH           PIC S9(7)       COMP-3.
  1258     12  ME-061-CLMS             PIC S9(9)V99    COMP-3.
  1259     12  ME-341-CLMS-L           PIC S9(9)V99    COMP-3.
  1260     12  ME-341-CLMS-AH          PIC S9(9)V99    COMP-3.
  1261     12  ME-515-CLMS-WRAP        PIC S9(7)V99    COMP-3.
  1262     12  ME-515-RESV-WRAP        PIC S9(7)V99    COMP-3.
  1263     12  ME-317-CLMS-TOT         PIC S9(9)V99    comp-3.
  1264     12  ME-325-CLMS-TOT         PIC S9(9)V99    comp-3.
  1265     12  ME-020-PREM-TOT         PIC S9(11)V99   COMP-3.
  1266     12  ME-020-CLMS-TOT         PIC S9(9)V99    COMP-3.
  1267     12  ME-020-RESV-TOT         PIC S9(9)V99    COMP-3.
  1268     12  ME-063-OW               PIC S9(9)V99    COMP-3.
  1269     12  ME-082-ACT-L            PIC S9(7)       COMP-3.
  1270     12  ME-082-ACT-AH           PIC S9(7)       COMP-3.
  1271     12  ME-016-RECS-IN          PIC S9(9)       COMP-3.
  1272     12  ME-016-RECS-OUT         PIC S9(9)       COMP-3.
  1273     12  ME-562-PREM-TOT         PIC S9(9)V99    COMP-3.
  1274     12  ME-562-COMM-TOT         PIC S9(9)V99    COMP-3.
  1275     12  ME-524-CLMS-TOT-CM      PIC S9(9)V99    comp-3.
  1276     12  ME-523-PREM-TOT         PIC S9(9)V99    COMP-3.
  1277     12  ME-064-BEG-BAL          PIC S9(9)V99    COMP-3.
  1278     12  ME-064-END-BAL          PIC S9(9)V99    COMP-3.
  1279     12  ME-010-MM-PREM-TOT      PIC S9(9)V99    COMP-3.
  1280     12  ME-010-MM-TOT-CLMS      PIC S9(9)V99    COMP-3.
  1281     12  ME-010-MM-TOT-RESV      PIC S9(9)V99    COMP-3.
  1282     12  ME-080-MORT-RESV        PIC S9(9)V99    COMP-3.
  1283
  1284     12  FILLER                  PIC  X(09).
  1285*    12  FILLER                  PIC  X(88).
  1286******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS010D.cbl
  1288 FD  CERT-MASTER-OUT
* 1289                             COPY ECSCROFD.
  1290******************************************************************07/10/97
  1291*                                                                *ECSCROFD
  1292*                            ECSCROFD                            *   LV001
  1293*                            VMOD=2.002                          *ECSCROFD
  1294*                                                                *ECSCROFD
  1295*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1296*                                                                *ECSCROFD
  1297******************************************************************ECSCROFD
  1298     RECORDING MODE F                                             ECSCROFD
  1299     LABEL RECORDS STANDARD                                       ECSCROFD
  1300     BLOCK CONTAINS 0 RECORDS
  1301     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1302 01  CERT-OUT-RECORD.                                             ECSCROFD
  1303     12  FILLER                            PIC  XXX.              ECSCROFD
  1304     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1305     12  FILLER                            PIC  X(1017).          ECSCROFD
  1306                                                                  ECSCROFD
  1307******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS010D.cbl
  1309 FD  DETAIL-EXTR
  1310     BLOCK CONTAINS 0 RECORDS
  1311     RECORDING MODE F.
  1312
* 1313                             COPY ECSEXT01.
  1314******************************************************************04/29/98
  1315*                                                                *ECSEXT01
  1316*                            ECSEXT01                            *   LV015
  1317*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1318*                            VMOD=2.015                          *ECSEXT01
  1319*                                                                *ECSEXT01
  1320*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1321*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1322*                                                                *ECSEXT01
  1323*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1324*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1325*                                                                *ECSEXT01
  1326*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1327*                                                                *ECSEXT01
  1328******************************************************************ECSEXT01
  1329******************************************************************
  1330*                   C H A N G E   L O G
  1331*
  1332* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1333*-----------------------------------------------------------------
  1334*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1335* EFFECTIVE    NUMBER
  1336*-----------------------------------------------------------------
  1337* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1338* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1339* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1340* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1341* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1342* 032612  CR2011110200001  PEMA  AHL CHANGES
  1343******************************************************************
  1344                                                                  ECSEXT01
  1345 01  DETAIL-EXTRACT.                                              ECSEXT01
  1346     02 DETAIL-FILE.                                              ECSEXT01
  1347     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1348         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1349                                                                  ECSEXT01
  1350     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1351                                                                  ECSEXT01
  1352     12  DE-REIN                           PIC X.                 ECSEXT01
  1353                                                                  ECSEXT01
  1354     12  DE-CONTROL.                                              ECSEXT01
  1355         16  DE-CNTRL1.                                           ECSEXT01
  1356             20  DE-CARRIER                PIC X.                 ECSEXT01
  1357             20  DE-GROUPING.                                     ECSEXT01
  1358                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1359                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1360             20  DE-STATE                  PIC XX.                ECSEXT01
  1361             20  DE-ACCOUNT.                                      ECSEXT01
  1362                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1363                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1364         16  DE-CNTRL2.                                           ECSEXT01
  1365             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1366             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1367                 24 DE-CERT-NO.                                   ECSEXT01
  1368                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1369                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1370                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1371                                                                  ECSEXT01
  1372     12  DE-TRANS                          PIC X.                 ECSEXT01
  1373         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1374         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1375         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1376         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1377         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1378         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1379         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1380         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1381         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1382         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1383                                                                  ECSEXT01
  1384     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1385     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1386                                                                  ECSEXT01
  1387     12  DE-NAME.                                                 ECSEXT01
  1388         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1389         16  DE-FNAME.                                            ECSEXT01
  1390             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1391             20  FILLER                    PIC X(9).              ECSEXT01
  1392         16  DE-INIT                       PIC X.                 ECSEXT01
  1393     12  DE-AGE                            PIC 99.                ECSEXT01
  1394     12  DE-SEX                            PIC X.                 ECSEXT01
  1395     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1396                                                                  ECSEXT01
  1397     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1398     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1399     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1400     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1401     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1402     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1403     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1404     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1405     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1406                                                                  ECSEXT01
  1407     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1408     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1409     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1410     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1411                                                                  ECSEXT01
  1412     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1413     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1414     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1415     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1416     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1417                                                                  ECSEXT01
  1418     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1419     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1420     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1421     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1422                                                                  ECSEXT01
  1423     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1424     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1425                                           PIC S9(5)V99   COMP-3.
  1426     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1427     12  FILLER REDEFINES DE-NUM-BILLED.
  1428         16  DE-CLP-STATE                  PIC XX.
  1429         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1430     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1431     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1432                                                                  ECSEXT01
  1433     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1434     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1435     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1436     12  DE-IG                             PIC X.                 ECSEXT01
  1437     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1438*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1439     12  DE-MEMBER-NO.                                            ECSEXT01
  1440         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1441         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1442         16  FILLER                        PIC X(03).             ECSEXT01
  1443     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1444                                                                  ECSEXT01
  1445     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1446         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1447                                                                  ECSEXT01
  1448     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1449     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1450                                                                  ECSEXT01
  1451     12  DE-REI-AREA.                                             ECSEXT01
  1452         16  DE-REI-COMP.                                         ECSEXT01
  1453             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1454             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1455         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1456         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1457         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1458         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1459         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1460         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1461         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1462                                                                  ECSEXT01
  1463     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1464     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1465         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1466         16  F                             PIC X.
  1467*    12  FILLER                            PIC X(5).              ECSEXT01
  1468                                                                  ECSEXT01
  1469     12  DE-BILLED-AREA.                                          ECSEXT01
  1470         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1471             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1472                                                                  ECSEXT01
  1473         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1474             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1475             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1476             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1477             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1478             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1479             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1480                                                                  ECSEXT01
  1481         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1482             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1483                                                                  ECSEXT01
  1484         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1485         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1486         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1487         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1488                                                                  ECSEXT01
  1489         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1490*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1491*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1492                                                                  ECSEXT01
  1493     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1494         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1495         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1496         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1497                                                                  ECSEXT01
  1498     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1499         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1500         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1501     12  DE-CANCEL-REASON                  PIC X.
  1502                                                                  ECSEXT01
  1503     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1504     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1505                                                                  ECSEXT01
  1506     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1507         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1508             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1509         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1510             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1511                                                                  ECSEXT01
  1512     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1513         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1514                                                                  ECSEXT01
  1515     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1516     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1517         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1518         16  FILLER                        PIC X.
  1519                                                                  ECSEXT01
  1520****************************************************************  ECSEXT01
  1521**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1522****************************************************************  ECSEXT01
  1523     12  DE-COMM-LEVELS.                                          ECSEXT01
  1524         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1525             20  DE-AGT.                                          ECSEXT01
  1526                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1527                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1528             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1529             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1530             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1531                                                                  ECSEXT01
  1532     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1533****************************************************************  ECSEXT01
  1534*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1535****************************************************************  ECSEXT01
  1536     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1537     12  FILLER                            PIC X(334).            ECSEXT01
  1538     12  DE-TYPE                           PIC X.                 ECSEXT01
  1539         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1540         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1541         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1542         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1543         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1544         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1545                                                                  ECSEXT01
  1546     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1547     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1548                                                                  ECSEXT01
  1549     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1550     12  DE-REPORTED.                                             ECSEXT01
  1551         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1552         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1553         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1554     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1555     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1556                                                                  ECSEXT01
  1557     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1558     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1559     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1560     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1561     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1562     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1563         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1564         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1565         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1566         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1567         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1568         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1569         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1570                                                                  ECSEXT01
  1571     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1572                                                                  ECSEXT01
  1573     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1574     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1575     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1576     12  FILLER                            PIC XX.                ECSEXT01
  1577     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1578                                                                  ECSEXT01
  1579     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1580     12  DE-BENEFICIARY                    PIC X(10).
  1581     12  filler redefines de-beneficiary.
  1582         16  de-birth-date                 pic 9(11)  comp-3.
  1583         16  f                             pic x(4).
  1584     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1585     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1586     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1587     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1588     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1589     12  DE-CLM-CLASS                      PIC XX.
  1590     12  DE-CLM-DEV                        PIC XXX.
  1591     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1592     12  de-xycor-cert-seq                 pic x(3).
  1593     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1594     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1595     12  DE-XYCOR-STATUS                   PIC X.
  1596     12  FILLER                            PIC X(4).              ECSEXT01
  1597                                                                  ECSEXT01
  1598     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1599                                                                  ECSEXT01
  1600****************************************************************  ECSEXT01
  1601*******               RESERVE EXTRACT                      *****  ECSEXT01
  1602****************************************************************  ECSEXT01
  1603     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1604     12  FILLER                            PIC X(334).            ECSEXT01
  1605                                                                  ECSEXT01
  1606     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1607         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1608         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1609                                                                  ECSEXT01
  1610     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1611     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1612     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1613                                                                  ECSEXT01
  1614     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1615                                                                  ECSEXT01
  1616     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1617     12  DE-RSV-REPORTED.                                         ECSEXT01
  1618         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1619         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1620         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1621     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1622                                                                  ECSEXT01
  1623     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1624     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1625     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1626                                                                  ECSEXT01
  1627     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1628     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1629     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1630                                                                  ECSEXT01
  1631     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1632                                                                  ECSEXT01
  1633     12  DE-RATE-CLASS                     PIC XX.
  1634     12  DE-DEV-CODE                       PIC XXX.
  1635     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1636     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1637     12  FILLER                            PIC X(58).             ECSEXT01
  1638                                                                  ECSEXT01
  1639     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1640******************************************************************ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS010D.cbl
  1642 FD  SUMMARY-EXTR
  1643     BLOCK CONTAINS 0 RECORDS
  1644     RECORDING MODE F.
  1645
* 1646                             COPY ECSEPC01.
  1647******************************************************************
  1648*                                                                *
  1649*                            ECSEPC01                            *
  1650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1651*                            VMOD=2.008                          *
  1652*                                                                *
  1653*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1654*                                                                *
  1655*   FILE TYPE = SEQUENTIAL                                       *
  1656*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1657*                                                                *
  1658*   KEY DATA =                                  START=5, LEN=31  *
  1659*                                                                *
  1660*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1661*                                                                *
  1662******************************************************************
  1663
  1664 01  EP-RECORD.
  1665     02 EP-FILE.
  1666     12  EP-RECORD-ID                      PIC XX.
  1667         88  VALID-EP-ID                      VALUE 'EP'.
  1668
  1669     12  EP-COMPANY-CD                     PIC X.
  1670
  1671     12  EP-REIN                           PIC X.
  1672         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1673
  1674     12  EP-CONTROL.
  1675         16  EP-CNTRL-1.
  1676             20  EP-COMPANY.
  1677                 24  EP-CARRIER            PIC X.
  1678                 24  EP-GROUPING.
  1679                     28  EP-GROUP-PREFIX   PIC XXX.
  1680                     28  EP-GROUP-PRIME    PIC XXX.
  1681             20  EP-STATE                  PIC XX.
  1682             20  EP-ACCOUNT.
  1683                 24  EP-ACCT-PREFIX        PIC X(4).
  1684                 24  EP-ACCT-PRIME         PIC X(6).
  1685         16  EP-CNTRL-2.
  1686             20  EP-DATES.
  1687                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1688                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1689
  1690     12  EP-REI-CO.
  1691         16  EP-REINCO                     PIC XXX.
  1692         16  EP-REINCO-SUB                 PIC XXX.
  1693
  1694     12  EP-RCD-TYPE                       PIC X.
  1695         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  1696         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  1697         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  1698         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1699         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1700         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  1701     12  EP-BEN-CODE                       PIC XX.
  1702     12  FILLER                            PIC X.
  1703
  1704     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  1705     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  1706     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  1707
  1708     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  1709     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  1710     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  1711
  1712     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  1713     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  1714     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  1715     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  1716
  1717     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  1718     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  1719     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  1720
  1721     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  1722     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  1723     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  1724
  1725     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  1726     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  1727     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  1728     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  1729     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  1730
  1731     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  1732     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  1733     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  1734
  1735     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
  1736     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  1737     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  1738
  1739     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  1740         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  1741         16  EP-NEW-DATA-IND               PIC X(01).
  1742             88  EP-NEW-DATA                   VALUE 'Y'.
  1743         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  1744         16  FILLER                        PIC X(19).
  1745
  1746     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  1747     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  1748     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  1749
  1750     12  FILLER                            PIC XXX.
  1751
  1752     12  EP-UNDERWRITING-CODE              PIC X.
  1753         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  1754
  1755     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
  1756
  1757     12  FILLER                            PIC X(29).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1758*    12  FILLER                            PIC X(34).
  1759
  1760     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  1761     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  1762     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  1763     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  1764     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  1765     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  1766
  1767     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  1768
  1769     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  1770     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  1771
  1772     12  EP-PURGE                          PIC X.
  1773         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  1774
  1775     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  1776
  1777     02 EC-RECORD     REDEFINES     EP-FILE.
  1778     12  EC-RECORD-ID                      PIC XX.
  1779         88  VALID-EC-ID                      VALUE 'EC'.
  1780
  1781     12  EC-COMPANY-CD                     PIC X.
  1782
  1783     12  EC-REIN                           PIC X.
  1784         88  EC-REIN-EXTRACT                  VALUE 'R'.
  1785
  1786     12  EC-CONTROL.
  1787         16  EC-CARRIER                    PIC X.
  1788         16  EC-GROUPING.
  1789             20  EC-GROUP-PREFIX           PIC XXX.
  1790             20  EC-GROUP-PRIME            PIC XXX.
  1791         16  EC-STATE                      PIC XX.
  1792         16  EC-ACCOUNT.
  1793             20  EC-ACCT-PREFIX            PIC X(4).
  1794             20  EC-ACCT-PRIME             PIC X(6).
  1795         16  EC-DATES.
  1796             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  1797             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  1798
  1799     12  EC-REI-CO.
  1800         16  EC-REINCO                     PIC XXX.
  1801         16  EC-REINCO-SUB                 PIC XXX.
  1802
  1803     12  EC-RCD-TYPE                       PIC X.
  1804         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  1805         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  1806         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  1807         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1808         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  1809     12  EC-BEN-CODE                       PIC XX.
  1810     12  EC-SEQ-NBR                        PIC X.
  1811         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  1812         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  1813
  1814     12  EC-AGENTS-DATA.
  1815         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1816             20  EC-AGT-NO.
  1817                 24  EC-AGT-PREFIX         PIC X(4).
  1818                 24  EC-AGT-PRIME          PIC X(6).
  1819             20  EC-AGT-TYPE               PIC X.
  1820             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  1821             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  1822             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  1823             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  1824             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  1825
  1826     12  EC-UNDERWRITING-CODE              PIC X.
  1827         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  1828
  1829     12  EC-AGENTS-DATA-II.
  1830         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  1831             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  1832             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  1833
  1834     12  FILLER                            PIC X(7).
  1835
  1836     12  EC-PURGE                          PIC X.
  1837         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  1838
  1839     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  1840
  1841******************************************************************
  1842
  1843 FD  ERRESC-IN.
* 1844                             COPY ERCRESC.
  1845******************************************************************04/29/98
  1846*                                                                *ERCRESC
  1847*                            ERCRESC                             *   LV002
  1848*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1849*                            VMOD=2.003                          *   CL**2
  1850*                                                                *ERCRESC
  1851*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  1852*                                                                *ERCRESC
  1853*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  1854*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  1855*                                                                *ERCRESC
  1856*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  1857*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  1858*                                                                *ERCRESC
  1859*   LOG = NO                                                     *ERCRESC
  1860*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  1861*                                                                *ERCRESC
  1862******************************************************************ERCRESC
  1863                                                                  ERCRESC
  1864 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  1865                                                                  ERCRESC
  1866     10  ERRESC-RECORD-KEY.                                       ERCRESC
  1867         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  1868         15  RESC-CARRIER              PIC   X.                   ERCRESC
  1869         15  RESC-GROUP                PIC   X(6).                ERCRESC
  1870         15  RESC-STATE                PIC   XX.                  ERCRESC
  1871         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  1872         15  RESC-AGENT                PIC   X(10).               ERCRESC
  1873         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCRESC)
  1874         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  1875*                                           YYYYMMDD              ERCRESC
  1876     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  1877                                                                  ERCRESC
  1878     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  1879         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  1880             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  1881             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  1882             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  1883                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  1884                                                                  ERCRESC
  1885     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  1886     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  1887     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  1888*                                          YYYYMMDD               ERCRESC
  1889 FD  ELCRTT.
  1890
* 1891                             COPY ELCCRTT.
  1892******************************************************************
  1893*                                                                *ELCCRTT
  1894*                            ELCCRTT.                            *
  1895*                                                                *ELCCRTT
  1896*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  1897*                                                                *ELCCRTT
  1898*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  1899*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  1900*                                                                *ELCCRTT
  1901*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  1902*                                                                *ELCCRTT
  1903*   LOG = YES                                                    *ELCCRTT
  1904*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  1905******************************************************************
  1906*                   C H A N G E   L O G
  1907*
  1908* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1909*-----------------------------------------------------------------
  1910*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1911* EFFECTIVE    NUMBER
  1912*-----------------------------------------------------------------
  1913* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  1914* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  1915* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  1916* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1917* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1918* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1919* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1920* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1921******************************************************************
  1922                                                                  ELCCRTT
  1923 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  1924     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  1925         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  1926                                                                  ELCCRTT
  1927     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  1928         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  1929         16  CS-CARRIER                    PIC X.                 ELCCRTT
  1930         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  1931         16  CS-STATE                      PIC XX.                ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  1932         16  CS-ACCOUNT                    PIC X(10).
  1933         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  1934         16  CS-CERT-NO.                                          ELCCRTT
  1935             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  1936             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  1937         16  CS-TRAILER-TYPE               PIC X.
  1938             88  COMM-TRLR           VALUE 'A'.
  1939             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1940             88  CERT-DATA-TRLR      VALUE 'C'.
  1941                                                                  ELCCRTT
  1942     12  CS-DATA-AREA                      PIC X(516).
  1943
  1944     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1945         16  CS-BANK-COMMISSION-AREA.
  1946             20  CS-BANK-COMMS       OCCURS 10.
  1947                 24  CS-AGT                PIC X(10).
  1948                 24  CS-COM-TYP            PIC X.
  1949                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1950                 24  CS-RECALC-LV-INDIC    PIC X.
  1951                 24  FILLER                PIC X(10).
  1952
  1953         16  FILLER                        PIC X(256).
  1954
  1955     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1956****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1957
  1958         16  CS-MB-CLAIM-DATA OCCURS 24.
  1959             20  CS-CLAIM-NO               PIC X(7).
  1960             20  CS-CLAIM-TYPE             PIC X.
  1961                 88  CS-AH-CLM               VALUE 'A'.
  1962                 88  CS-IU-CLM               VALUE 'I'.
  1963                 88  CS-GP-CLM               VALUE 'G'.
  1964                 88  CS-LF-CLM               VALUE 'L'.
  1965                 88  CS-PR-CLM               VALUE 'P'.
  1966                 88  CS-FL-CLM               VALUE 'F'.
  1967             20  CS-INSURED-TYPE           PIC X.
  1968                 88  CS-PRIM-INSURED          VALUE 'P'.
  1969                 88  CS-CO-BORROWER           VALUE 'C'.
  1970             20  CS-BENEFIT-PERIOD         PIC 99.
  1971             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  1972             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  1973             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1974         16  FILLER                        PIC X(12).
  1975
  1976     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1977         16  CS-VIN-NUMBER                 PIC X(17).
  1978         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1979         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1980         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1981         16  cs-agent-name.
  1982             20  cs-agent-fname            pic x(20).
  1983             20  cs-agent-mi               pic x.
  1984             20  cs-agent-lname            pic x(25).
  1985         16  cs-license-no                 pic x(15).
  1986         16  cs-npn-number                 pic x(10).
  1987         16  cs-agent-edit-status          pic x.
  1988             88  cs-ae-refer-to-manager      value 'M'.
  1989             88  cs-ae-cover-sheet           value 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  1990             88  cs-ae-sig-form              value 'S'.
  1991             88  cs-ae-verified              value 'V'.
  1992             88  cs-unidentified-signature   value 'U'.
  1993             88  cs-cert-returned            value 'R'.
  1994             88  cs-accept-no-commission     value 'N'.
  1995         16  FILLER                        PIC X(424).
  1996*        16  FILLER                        PIC X(496).
  1997
  1998 FD  ERAGTC.
  1999
* 2000                             COPY ERCAGTC.
  2001******************************************************************
  2002*                                                                *
  2003*                                                                *
  2004*                            ERCAGTC                             *
  2005*                            VMOD=2.001                          *
  2006*                                                                *
  2007*   ONLINE CREDIT SYSTEM                                         *
  2008*                                                                *
  2009*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2010*                                                                *
  2011*   FILE TYPE = VSAM,KSDS                                        *
  2012*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2013*                                                                *
  2014*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2015*       ALTERNATE PATH = NONE                                    *
  2016*                                                                *
  2017*   LOG = NO                                                     *
  2018*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2019*                                                                *
  2020******************************************************************
  2021*                   C H A N G E   L O G
  2022*
  2023* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2024*-----------------------------------------------------------------
  2025*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2026* EFFECTIVE    NUMBER
  2027*-----------------------------------------------------------------
  2028* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2029* 111004                         NEW FILE AND COPYBOOK
  2030* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2031******************************************************************
  2032
  2033 01  AGENT-COMMISSIONS.
  2034     12  AG-RECORD-ID                          PIC XX.
  2035         88  VALID-CO-ID                          VALUE 'AG'.
  2036
  2037     12  AG-CONTROL-PRIMARY.
  2038         16  AG-COMPANY-CD                     PIC X.
  2039         16  AG-CONTROL.
  2040             20  AG-CTL-1.
  2041                 24  AG-CARR-GROUP.
  2042                     28  AG-CARRIER            PIC X.
  2043                     28  AG-GROUPING           PIC X(6).
  2044                 24  AG-BANK                   PIC X(10).
  2045             20  AG-CTL-2.
  2046                 24  AG-EXP-DT                 PIC XX.
  2047         16  AG-TYPE                           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2048             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2049             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2050
  2051     12  AG-MAINT-INFORMATION.
  2052         16  AG-LAST-MAINT-DT                  PIC XX.
  2053         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2054         16  AG-LAST-MAINT-USER                PIC X(4).
  2055         16  FILLER                            PIC X(10).
  2056
  2057     12  AG-EFF-DT                             PIC XX.
  2058     12  AG-COMM-STRUCTURE.
  2059         16  AG-AGT-COMMS OCCURS 10.
  2060             20  AG-AGT                PIC X(10).
  2061             20  AG-COM-TYP            PIC X.
  2062             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2063             20  AG-RECALC-LV-INDIC    PIC X.
  2064             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2065             20  AG-LRCALC-LV-INDIC    PIC X.
  2066             20  FILLER                PIC X(05).
  2067
  2068     12  FILLER                  PIC X(145).
  2069******************************************************************
  2070
  2071 FD  ME-ECS010-BALANCE
  2072     RECORDING MODE IS F
  2073     BLOCK CONTAINS 0 RECORDS.
  2074 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2075
  2076 FD  ME50-ECS010-BALANCE
  2077     RECORDING MODE IS F
  2078     BLOCK CONTAINS 0 RECORDS.
  2079 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2080
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS010D.cbl
  2082 FD  DISK-DATE
* 2083                             COPY ELCDTEFD.
  2084******************************************************************04/15/98
  2085*                                                                *ELCDTEFD
  2086*                                                                *ELCDTEFD
  2087*                            ELCDTEFD.                           *   LV002
  2088*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2089*                            VMOD=2.007                          *   CL**2
  2090*                                                                *ELCDTEFD
  2091******************************************************************ELCDTEFD
  2092     BLOCK CONTAINS 0 RECORDS
  2093     RECORDING MODE F.                                            ELCDTEFD
  2094                                                                  ELCDTEFD
  2095 01  DATE-DISK.                                                   ELCDTEFD
  2096     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2097     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2098     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2099     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2100     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2101     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2102     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2103                                                                  ELCDTEFD
  2104 01  DATE-DISK-R.                                                 ELCDTEFD
  2105     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2106     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2107                                     PIC  X(32).                  ELCDTEFD
  2108                                                                  ELCDTEFD
  2109 01  DATE-DISK-T.                                                 ELCDTEFD
  2110     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2111     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2112                                     PIC  X(48).                  ELCDTEFD
  2113                                                                  ELCDTEFD
  2114 01  DATE-DISK-M.                                                 ELCDTEFD
  2115     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2116     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2117                                     PIC  X(48).                  ELCDTEFD
  2118                                                                  ELCDTEFD
  2119 01  DATE-DISK-P.                                                 ELCDTEFD
  2120     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2121     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2122     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2123     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2124         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2125                                     PIC  X.                      ELCDTEFD
  2126         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2127     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2128         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2129             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2130             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2131             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2132             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2133         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2134                                                                  ELCDTEFD
  2135 01  DATE-DISK-E.                                                 ELCDTEFD
  2136     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2137     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2138                                     PIC  X(4).                   ELCDTEFD
  2139                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2140 01  DATE-DISK-C.                                                 ELCDTEFD
  2141     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2142     12  DD-CARR1-SECPAY-SW          PIC  X.
  2143     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2144     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2145     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2146     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2147     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2148     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2149     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2150     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2151     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2152     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2153     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2154     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2155     12  DD-CARR2-SECPAY-SW          PIC  X.
  2156     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2157                                                                  ELCDTEFD
  2158 01  DATE-DISK-OPT.                                               ELCDTEFD
  2159     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2160     12  DD-TLR-DATA.                                             ELCDTEFD
  2161         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2162                                     PIC  X(03).                  ELCDTEFD
  2163     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2164         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2165                                     PIC  X(06).                  ELCDTEFD
  2166     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2167         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2168                                     PIC  X(07).                  ELCDTEFD
  2169         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2170     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2171                                     PIC  X(96).                  ELCDTEFD
  2172******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS010D.cbl
  2174 FD  PRINT-COPY
* 2175                             COPY ELCPRTFD.
  2176******************************************************************04/15/98
  2177*                                                                *ELCPRTFD
  2178*                                                                *ELCPRTFD
  2179*                            ELCPRTFD.                           *   LV003
  2180*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2181*                            VMOD=2.006                          *ELCPRTFD
  2182******************************************************************ELCPRTFD
  2183     RECORDING MODE F                                             ELCPRTFD
  2184     LABEL RECORDS OMITTED                                        ELCPRTFD
  2185     BLOCK CONTAINS 0 RECORDS
  2186     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2187 01  PRT.                                                         ELCPRTFD
  2188     12  P-CTL               PIC  X.                                 CL**2
  2189     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2190******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS010D.cbl
  2192 FD  MISMATCH-REPORT
  2193     RECORDING MODE F.
  2194
  2195 01  MISMATCH-RPT.
  2196     12  MR-CTL              PIC X.
  2197     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS010D.cbl
  2199 FD  FICH
* 2200                             COPY ELCFCHFD.
  2201******************************************************************04/15/98
  2202*                                                                *ELCFCHFD
  2203*                            ELCFCHFD.                           *   LV003
  2204*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2205*                            VMOD=2.004                          *   CL**3
  2206*                                                                *ELCFCHFD
  2207******************************************************************ELCFCHFD
  2208     BLOCK CONTAINS 0 RECORDS
  2209     RECORDING MODE F.                                            ELCFCHFD
  2210                                                                  ELCFCHFD
  2211 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2212******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS010D.cbl
  2214 FD  DISPLAY-PRT
  2215     RECORDING MODE IS F
  2216     LABEL RECORDS ARE STANDARD
  2217     BLOCK CONTAINS 0 RECORDS
  2218     RECORD CONTAINS 133 CHARACTERS.
  2219
  2220 01  DISPLAY-REC.
  2221     05  DISPLAY-CC           PIC X.
  2222     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS010D.cbl
  2224 WORKING-STORAGE SECTION.
  2225 77  LCP-ASA                       PIC X.
  2226 77  FILLER  PIC X(32)  VALUE '********************************'.
  2227 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2228 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2229
  2230 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2231 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2232 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2233 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2234 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2235 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2236 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2237 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2238 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2239 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2240 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2241 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2242 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2243 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2244 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2245 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2246 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2247 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2248 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2249 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2250 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2251 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2252 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2253 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2254 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2255 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2256 77  ISS-WK                  PIC S9(9)V99    COMP-3 VALUE +0.
  2257 77  CNC-WK                  PIC S9(9)V99    COMP-3 VALUE +0.
  2258 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2259 77  EC-FACT                 PIC S9(3)V9(9) COMP-3 VALUE +0.
  2260 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2261 77  X                       PIC X.
  2262 77  DD-FLG                  PIC X               VALUE SPACE.
  2263 77  AGT-SW                  PIC X               VALUE SPACE.
  2264 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2265 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2266 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2267 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2268 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2269 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2270 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2271 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2272 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2273 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2274 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2275 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2276 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2277 77  SV-TRD-CERT             PIC X(11).
  2278 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2279 77  SV-TRD-ISDT             PIC X(10).
  2280 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2281*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS010D.cbl
  2282*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
  2283 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2284 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2285 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2286 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2287 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2288 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2289 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2290 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2291 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2292 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2293 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2294 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2295 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2296 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2297 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2298 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2299 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2300 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2301 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2302 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2303 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2304 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2305 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2306 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2307 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2308 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2309 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2310 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2311 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2312 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2313 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2314 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2315 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2316 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2317 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2318 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2319 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2320 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2321 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2322 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2323 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2324 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2325 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2326 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2327 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2328 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2329 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2330 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2331 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2332 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2333 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2334 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2335 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2336 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2337 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2338 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2339 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS010D.cbl
  2340 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
  2341 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2342 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2343 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2344 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2345 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2346 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2347 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2348 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2349 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2350 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2351 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2352 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2353 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2354 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2355 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2356 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2357 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2358 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2359 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2360 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2361 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2362 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2363
  2364 01  MONTH-END-DATA.
  2365     12  ME-START-DATE.
  2366         16  ME-START-MO         PIC 99.
  2367         16  FILLER              PIC X.
  2368         16  ME-START-DA         PIC 99.
  2369         16  FILLER              PIC X.
  2370         16  ME-START-YR         PIC 99.
  2371     12  ME-CNDS-DATE            PIC 9(6).
  2372     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2373         16  ME-CNDS-MO          PIC 99.
  2374         16  ME-CNDS-DA          PIC 99.
  2375         16  ME-CNDS-YR          PIC 99.
  2376     12  ME-START-TIME           PIC 9(6).
  2377     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2378         88  ME-DO-UPDATE        VALUE 'Y'.
  2379         88  ME-NO-UPDATE        VALUE 'N'.
  2380     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2381
  2382 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2383     'Life Claims Paid'.
  2384
  2385 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2386     'A&H Claims Paid'.
  2387
  2388 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2389     'Output Certificate Master Records Prior Month'.
  2390
  2391 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2392     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2393
  2394 01  WS-ME-BALANCE-REC.
  2395     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2396     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2397     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS010D.cbl
  2398     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2399     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2400     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2401     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2402
  2403 01  WS-ME50-BALANCE-REC.
  2404     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2405     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2406     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2407     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2408     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2409     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2410     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2411     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2412     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2413
  2414 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2415 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2416 01  WS-BANK-COMMISSIONS.
  2417     12  WS-BANK-COMMS           OCCURS 10.
  2418         16  WS-BNK-AGT          PIC X(10).
  2419         16  WS-BNK-TYPE         PIC X.
  2420         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2421         16  WS-BNK-RECALC       PIC X.
  2422         16  FILLER              PIC X(10).
  2423
  2424 01  PENDING-MATCH-CONTROL.
  2425     12  PENDING-ACCOUNT-CONTROL.
  2426         16  PEND-MATCH-CARRIER    PIC X.
  2427         16  PEND-MATCH-GROUPING   PIC X(6).
  2428         16  PEND-MATCH-STATE      PIC XX.
  2429         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2430     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2431     12  PEND-MATCH-CERT-NO.
  2432         16  PEND-MATCH-CERT       PIC X(10).
  2433         16  PEND-MATCH-CERT-SFX   PIC X.
  2434 01  PENDING-RECORD-TYPE           PIC X.
  2435     88  ISSUE-TRANSACTION            VALUE '1'.
  2436     88  CANCEL-TRANSACTION           VALUE '2'.
  2437     88  CLAIM-TRANSACTION            VALUE '3'.
  2438     88  RESERVE-TRANSACTION          VALUE '4'.
  2439     88  UPDATE-TRANSACTION           VALUE '5'.
  2440
  2441 01  CLM-INCUR-REIN-DATE.
  2442     12  CIRD-CCYY.
  2443         16  CIRD-CC         PIC 99.
  2444         16  CIRD-YR         PIC 99.
  2445     12  CIRD-MO             PIC 99.
  2446
  2447 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2448
  2449 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2450
  2451 01  REIN-BILLING-TABLE.
  2452     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2453         16  RB-COMPANY      PIC X(6).
  2454         16  RB-COUNT        PIC S9(5)   COMP-3.
  2455
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS010D.cbl
  2456 01  B-SUB                   PIC S9(4)   COMP.
  2457
  2458 01  BINARY-COUNTERS     COMP      SYNC.
  2459     12  IA                  PIC S999            VALUE +0.
  2460     12  IB                  PIC S999            VALUE +0.
  2461     12  SUB                 PIC S999            VALUE +0.
  2462     12  SUBM                PIC S999            VALUE +0.
  2463     12  SUB3                PIC S999            VALUE +0.
  2464     12  SUB4                PIC S999            VALUE +0.
  2465     12  SUB5                PIC S999            VALUE +0.
  2466     12  SUB6                PIC S999            VALUE +0.
  2467     12  SUB7                PIC S999            VALUE +0.
  2468     12  SUB8                PIC S999            VALUE +0.
  2469     12  SUB9                PIC S999            VALUE +0.
  2470     12  SUB10               PIC S999            VALUE +0.
  2471     12  SUB11               PIC S999            VALUE +0.
  2472     12  SUB12               PIC S999            VALUE +0.
  2473     12  SUB13               PIC S999            VALUE +0.
  2474     12  SUB14               PIC S999            VALUE +0.
  2475     12  SUB15               PIC S999            VALUE +0.
  2476     12  SUB16               PIC S999            VALUE +0.
  2477     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2478 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2479
  2480 01  WS.
  2481     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2482     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2483     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2484     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2485
  2486     12  WS-ABEND-CODE         PIC 9(4).
  2487     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2488         16  ABEND-CODE-1    PIC XX.
  2489         16  ABEND-CODE-2.
  2490             20  AC2-ONE     PIC X.
  2491             20  AC2-TWO     PIC X.
  2492
  2493     12  CTBL-SEARCH.
  2494         16  CTBL-COMP-CD    PIC X.
  2495         16  CTBL-TABLE-CD   PIC XXX.
  2496         16  CTBL-BEN-TYPE   PIC X.
  2497         16  CTBL-BEN-CODE   PIC XX.
  2498     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2499     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2500     12  WS-COMM-TERM        PIC S999            COMP-3.
  2501     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2502         88  CTBL-ERROR         VALUE '*'.
  2503
  2504     12  REIN-SPEC.
  2505         16  REIN-SPEC-A     PIC X.
  2506         16  REIN-SPEC-B     PIC X.
  2507         16  REIN-SPEC-C     PIC X.
  2508
  2509     12  WS-CHECK-NUMBER.
  2510         16  WS-CHECK-NO     PIC X(4).
  2511         16  FILLER          PIC XXX.
  2512
  2513     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS010D.cbl
  2514         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
  2515         88  AH-EARN-NET                         VALUE 'N'.
  2516
  2517     12  INTERMED                PIC S9(9)V9(6)  COMP-3.
  2518     12  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
  2519
  2520 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2521 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2522 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2523 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2524 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2525 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  2526 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  2527
  2528 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2529 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2530 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
  2531 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2532
  2533 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  2534     12  WS-LF-CHARGEBACK-LEVELS.
  2535         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2536     12  WS-AH-CHARGEBACK-LEVELS.
  2537         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2538*****************************************************************
  2539*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2540*****************************************************************
  2541*RESIDENT STATE TAXES MASTER(ERRESC)
  2542*
  2543 01  WORK-AREAS.
  2544     12  WS-ERRESC-KEY.
  2545         16 WS-ERRESC-SEARCH-KEY.
  2546             20  WS-ERRESC-COMPANY-CD PIC  X.
  2547             20  WS-ERRESC-CARRIER    PIC  X.
  2548             20  WS-ERRESC-GROUP      PIC X(6).
  2549             20  WS-ERRESC-STATE      PIC XX.
  2550             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2551         16 WS-ERRESC-RESIDUAL-KEY.
  2552             20  WS-ERRESC-AGENT      PIC X(10).
  2553             20  WS-ERRESC-RES-STATE  PIC XX.
  2554             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2555*                                          YYYYMMDD
  2556     12  WS-YYYYMMDD-DT               PIC 9(8).
  2557     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2558     12  WS-SUB                       PIC    99  COMP-3.
  2559     12  WS-SUB1                      PIC    99  COMP-3.
  2560*****************************************************************
  2561*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2562*****************************************************************
  2563
  2564 01  COMM-WORK-AREAS.
  2565     12  FILLER              PIC  X(17)
  2566         VALUE 'COMMON WORK AREAS'.
  2567     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2568     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2569     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2570     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2571     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS010D.cbl
  2572     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2573     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2574     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2575     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2576     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2577     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2578     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2579     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2580     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2581     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  2582     12  W-CERT-COUNT        PIC S9(08)  COMP.
  2583     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  2584     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  2585     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
  2586
  2587     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
  2588                                         COMP-3 VALUE ZEROS.
  2589     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  2590                                         COMP-3 VALUE ZEROS.
  2591     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  2592                                         COMP-3 VALUE ZEROS.
  2593     12  W-EDIT-FIELD        PIC ----------9.
  2594     12  W-EDIT-FIELD2       PIC ----------9.99.
  2595     12  W-EDIT-7            PIC Z(06)9.
  2596     12  W-FACTOR            PIC S9(09)V9(08)
  2597                                         COMP-3 VALUE ZEROS.
  2598     12  W-IBNR-1            PIC S9(07)V9(02)
  2599                                         COMP-3 VALUE ZEROS.
  2600     12  W-IBNR-2            PIC S9(07)V9(02)
  2601                                         COMP-3 VALUE ZEROS.
  2602     12  W-ISS-BEN           PIC S9(11)V9(02)
  2603                                         COMP-3 VALUE ZEROS.
  2604     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  2605                                         COMP-3 VALUE ZEROS.
  2606     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2607     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  2608     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2609     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2610     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2611     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2612     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2613     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  2614     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2615     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2616     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2617     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2618     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2619     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2620     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  2621     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  2622                                         COMP-3 VALUE ZEROS.
  2623     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  2624     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  2625     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  2626     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  2627     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  2628     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  2629     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS010D.cbl
  2630     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  2631     12  W-POLICY-INACTIVE-CTR
  2632                             PIC S9(13)  COMP-3 VALUE ZEROS.
  2633     12  W-POLICY-REISSUE-CTR
  2634                             PIC S9(13)  COMP-3 VALUE ZEROS.
  2635     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  2636     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  2637     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  2638                                         COMP-3 VALUE ZEROS.
  2639     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  2640     12  W-WK-IBNR           PIC S9(07)V9(02)
  2641                                         COMP-3 VALUE ZEROS.
  2642
  2643     12  W-CLAIM-TYPE        PIC  X(01).
  2644         88  W-A-H                              VALUE 'A'.
  2645         88  W-LIFE                             VALUE 'L'.
  2646     12  W-CUTOFF-DATE       PIC  9(08).
  2647     12  W-DIS-DT            PIC  XX.
  2648     12  W-DIS-PTO-DT        PIC  XX.
  2649     12  WK-LEVEL.
  2650         16  WK-AGT          PIC X(10).
  2651         16  WK-A-TYPE       PIC X.
  2652         16  WK-L-RT         PIC SV9(5)  COMP-3.
  2653         16  WK-J-RT         PIC SV9(5)  COMP-3.
  2654         16  WK-A-RT         PIC SV9(5)  COMP-3.
  2655         16  FILLER          PIC X(6).
  2656     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  2657         16  FILLER          PIC X(11).
  2658         16  WK-L-RTX        PIC X(3).
  2659         16  WK-J-RTX        PIC X(3).
  2660         16  WK-A-RTX        PIC X(3).
  2661         16  FILLER          PIC X(6).
  2662     12  WK-NEW-RATES.
  2663         16  WK-N-R      OCCURS 10.
  2664             20  WK-N-AGT    PIC X(10).
  2665             20  WK-N-TYPE   PIC X.
  2666             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  2667             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  2668     12  W-LIFE-YEARS-ZERO.
  2669         16  FILLER          PIC  X(06)         VALUE ZEROS.
  2670         16  FILLER          PIC  X(01)         VALUE SPACES.
  2671         16  FILLER          PIC  X(02)         VALUE ZEROS.
  2672         16  FILLER          PIC  X(01)         VALUE SPACES.
  2673         16  FILLER          PIC  X(01)         VALUE SPACES.
  2674         16  FILLER          PIC  X(01)         VALUE SPACES.
  2675         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2676         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2677         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2678         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2679         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2680         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2681         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2682         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2683         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2684         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2685         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2686         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2687         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS010D.cbl
  2688         16  FILLER          PIC S9(09)V9(02) COMP-3
  2689                                                VALUE ZEROS.
  2690         16  FILLER          PIC S9(09)V9(02) COMP-3
  2691                                                VALUE ZEROS.
  2692         16  FILLER          PIC S9(09)V9(02) COMP-3
  2693                                                VALUE ZEROS.
  2694         16  FILLER          PIC S9(09)V9(02) COMP-3
  2695                                                VALUE ZEROS.
  2696         16  FILLER          PIC S9(11)V9(02) COMP-3
  2697                                                VALUE ZEROS.
  2698
  2699     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  2700         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  2701     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
  2702         88  W-REIN-PROCESS                     VALUE 'Y'.
  2703         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
  2704     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  2705         88  W-SELECTION-ON                     VALUE 'Y'.
  2706         88  W-SELECTION-OFF                    VALUE SPACES.
  2707     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  2708         88  W-RTRM-0                           VALUE 'Y'.
  2709         88  W-RTRM-NOT-0                       VALUE SPACES.
  2710     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  2711     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  2712         88  W-TABLE-USED                       VALUE 'Y'.
  2713         88  W-TABLE-NOT-USED                   VALUE SPACES.
  2714     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  2715         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  2716
  2717     12  W-VAL-ERRORS.
  2718         16  FILLER          PIC  X(40)
  2719             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  2720         16  FILLER          PIC  X(40)
  2721             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  2722         16  FILLER          PIC  X(40)
  2723             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  2724         16  FILLER          PIC  X(40)
  2725             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  2726         16  FILLER          PIC  X(40)
  2727             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  2728         16  FILLER          PIC  X(40)
  2729             VALUE 'RUN DATE EPEC - A&H - '.
  2730         16  FILLER          PIC  X(40)
  2731             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  2732         16  FILLER          PIC  X(40)
  2733             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  2734         16  FILLER          PIC  X(40)
  2735             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  2736     12  FILLER REDEFINES W-VAL-ERRORS.
  2737         16  W-VAL-ERROR OCCURS 9 TIMES
  2738                             PIC  X(40).
  2739
  2740     12  W-WORK-DATE         PIC  X(02).
  2741     12  SAVE-WK-NEW-RATES.
  2742         16  FILLER          PIC X(170).
  2743
  2744***   The following data area is for NCL only
  2745*    12  W-WORK-OB-DATA OCCURS 300.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS010D.cbl
  2746*    12  W-WORK-OB-DATA OCCURS 220.
  2747     12  W-WORK-OB-DATA OCCURS 900.
  2748         16  WS-OB-REIN-CO       PIC X(06).
  2749         16  WS-OB-LF-AH         PIC X.
  2750         16  WS-OB-BENEFIT-CODE  PIC XX.
  2751         16  WS-OB-EARNED OCCURS 3.
  2752             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  2753
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS010D.cbl
  2755 01  EPEC-WORK-AREAS.
  2756     12  WE-REIN-CO          PIC X(6).
  2757     12  WE-LF-AH            PIC X.
  2758     12  WE-BEN-TYPE         PIC XX.
  2759     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  2760     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  2761     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  2762     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  2763     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  2764     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  2765     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  2766     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  2767     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  2768     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  2769     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  2770     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  2771     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  2772     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  2773     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  2774     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  2775     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  2776     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  2777     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  2778     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  2779     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  2780     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  2781     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  2782     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  2783     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  2784     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  2785     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  2786     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  2787     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  2788     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  2789     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  2790     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  2791     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  2792     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  2793     12  EPR-R78             PIC S9(7)V99    COMP-3.
  2794     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  2795     12  EPR-ST              PIC S9(7)V99    COMP-3.
  2796     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  2797     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  2798     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  2799     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  2800     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  2801     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  2802     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  2803     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  2804     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  2805     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  2806     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  2807     12  WX-SETTLEMENT-EXIT-DATE
  2808                             PIC  9(11)      COMP-3.
  2809     12  WX-STATUS-AT-CANCEL PIC  X(1).
  2810     12  WX-STATUS-AT-DEATH  PIC  X(1).
  2811     12  WX-STATUS-AT-SETTLEMENT
  2812                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS010D.cbl
  2813     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  2814
  2815 01  EPEC-WORK.
  2816     12  EW-REIN-CO          PIC X(6).
  2817     12  EW-SUB-KEY.
  2818         16  EW-LF-AH        PIC X.
  2819         16  EW-BEN-TYPE     PIC XX.
  2820     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  2821     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  2822     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  2823     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  2824     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  2825     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  2826     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  2827     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  2828     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  2829     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  2830     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  2831     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  2832     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  2833     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  2834     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  2835     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  2836     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  2837     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  2838     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  2839     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  2840     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  2841     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  2842     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  2843     12  EW-AGENTS       OCCURS 10.
  2844         16  EW-AGT-NO       PIC X(10).
  2845         16  EW-AGT-TYPE     PIC X.
  2846         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  2847         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  2848         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  2849         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  2850         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  2851         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  2852         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  2853     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  2854     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  2855     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  2856     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  2857     12  EW-AGE              PIC S9(9)       COMP-3.
  2858     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  2859     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  2860     12  EW-LEVEL-USED       PIC X.
  2861
  2862 01  EPEC-TOTALS.
  2863     12  EPEC-LEVELS     OCCURS 900.
  2864*    12  EPEC-LEVELS     OCCURS 220.
  2865*    12  EPEC-LEVELS     OCCURS 300.
  2866         16  EPEC-REIN-CO          PIC X(6).
  2867         16  EPEC-SUB-KEY.
  2868             24  EPEC-LF-AH        PIC X.
  2869             24  EPEC-BEN-TYPE     PIC XX.
  2870*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS010D.cbl
  2871         16  FILLER                PIC X(699).
  2872     12  EPEC-LEVELS-END           PIC X(6).
  2873
  2874 01  EPEC-UNDERWRITTEN-TOTALS.
  2875     12  EPEC-LEVELS-II  OCCURS 900.
  2876*    12  EPEC-LEVELS-II  OCCURS 220.
  2877*    12  EPEC-LEVELS-II  OCCURS 300.
  2878         16  EPEC-REIN-CO-II       PIC X(6).
  2879         16  EPEC-SUB-KEY-II.
  2880             24  EPEC-LF-AH-II     PIC X.
  2881             24  EPEC-BEN-TYPE-II  PIC XX.
  2882*        16  FILLER                PIC X(694).
  2883         16  FILLER                PIC X(699).
  2884     12  EPEC-LEVELS-END-II        PIC X(6).
  2885
  2886
  2887 01  FILLER                      PIC  X(11)
  2888                                 VALUE 'OPT RSV TBL'.
  2889*
  2890* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  2891*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  2892*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  2893*      EPEC-OPT-GRP  (108)
  2894*
  2895*      300 X 108 = 32400.
  2896*
  2897 01  EPEC-OPT-DATA-TABLE.
  2898*    12  FILLER                  PIC X(32400).
  2899*    12  FILLER                  PIC X(23760).
  2900     12  FILLER                  PIC X(97200).
  2901
  2902 01  FILLER                      PIC  X(16)
  2903                                 VALUE 'OPT RSV TBL UNDW'.
  2904 01  EPEC-UNDW-OPT-DATA-TABLE.
  2905*    12  FILLER                  PIC X(32400).
  2906*    12  FILLER                  PIC X(23760).
  2907     12  FILLER                  PIC X(97200).
  2908
  2909 01  FILLER                      PIC  X(16)
  2910                                 VALUE 'OPT RSV TBL WORK'.
  2911 01  EPEC-OPT-WORK-TABLE.
  2912*    12  EPEC-OPT-GRP        OCCURS 300.
  2913*    12  EPEC-OPT-GRP        OCCURS 220.
  2914     12  EPEC-OPT-GRP        OCCURS 900.
  2915         16  EPEC-REIN-CO-OPT
  2916                             PIC  X(06).
  2917         16  EPEC-SUB-KEY-OPT.
  2918             24  EPEC-LF-AH-OPT
  2919                             PIC  X(01).
  2920             24  EPEC-BEN-TYPE-OPT
  2921                             PIC  X(02).
  2922         16  EPEC-OPT-DATA.
  2923             20  EPEC-REIN-ONLY-IND
  2924                             PIC  X(01).
  2925                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  2926             20  EPEC-LINE-NOT-USED-IND
  2927                             PIC  X(01).
  2928                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS010D.cbl
  2929             20  EPEC-LIFE-CTR-USED-IND
  2930                             PIC  X(01).
  2931                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  2932                 88  EPEC-LIFE-CTR-NOT-USED
  2933                                           VALUE ' '.
  2934             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  2935                             PIC S9(09)       COMP-3.
  2936             20  EPEC-EARNED-PREMIUM-AH
  2937                             PIC S9(09)V9(02) COMP-3.
  2938             20  EPEC-CLAIMS-MADE-PAID
  2939                             PIC S9(09)V9(02) COMP-3.
  2940             20  EPEC-CLM-EXP
  2941                             PIC S9(09)V9(02) COMP-3.
  2942             20  EPEC-LIFE-IBNR
  2943                             PIC S9(09)V9(02) COMP-3.
  2944             20  EPEC-REIN-ISS-BEN
  2945                             PIC S9(11)V9(02) COMP-3.
  2946
  2947 01  FILLER                  PIC X(09)
  2948                                 VALUE 'EOM TABLE'.
  2949
  2950 01  EOM-DATE-TABLE.
  2951     12  EOM-DATE            OCCURS 13
  2952                             PIC 9(08).
  2953
  2954 01  EPEC-SUBS.
  2955     12  EPEC-SUB-LEVELS OCCURS 31.
  2956         16  EPEC-SUB-REIN   PIC X(6).
  2957         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  2958         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  2959     12  EPEC-SUBS-END       PIC X(6).
  2960
  2961 01  SAVE-REIN-WORK.
  2962     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  2963     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  2964     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  2965     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  2966     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  2967
  2968 01  SAVE-REIN-TABLE.
  2969     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  2970         16  SR-TIME         PIC 9(6).
  2971         16  SR-ENTRY.
  2972             20  FILLER      PIC XX.
  2973             20  SR-CONTROL  PIC X(8).
  2974             20  FILLER      PIC X(3990).
  2975
  2976
* 2977                             COPY ECSRITAB.
  2978******************************************************************04/29/98
  2979*                                                                *ECSRITAB
  2980*                            ECSRITAB                            *   LV015
  2981*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  2982*                            VMOD=2.015                          *ECSRITAB
  2983*                                                                *ECSRITAB
  2984*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  2985*                                                                *ECSRITAB
  2986******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2987 01  REIN-WORK-AREAS.                                             ECSRITAB
  2988     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2989     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2990     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2991     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2992     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2993     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2994     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2995     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2996     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2997     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2998     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  2999         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  3000             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  3001             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  3002             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  3003     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3004     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3005     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3006     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3007     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3008     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3009     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3010     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3011     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3012     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3013     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3014     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3015     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3016     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3017     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3018     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3019     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3020     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3021     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3022     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3023     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3024     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3025     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3026                                                                  ECSRITAB
  3027 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3028     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3029         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3030         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3031             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3032             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3033         16  REIN-WORK-FLDS.                                      ECSRITAB
  3034             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3035             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3036             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3037             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3038             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3039             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3040             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3041             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3042             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3043             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3044             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3045             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3046             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3047             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3048             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3049             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3050             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3051             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3052             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3053             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3054             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3055             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3056             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3057             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3058             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3059             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3060             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3061             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3062     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3063                                                                  ECSRITAB
  3064     12  RWF-FIELDS.                                              ECSRITAB
  3065         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3066         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3067         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3068         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3069         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3070         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3071         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3072         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3073         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3074         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3075         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3076         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3077         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3078         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3079         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3080         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3081         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3082         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3083         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3084         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3085         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3086         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3087         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3088         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3089         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3090         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3091         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3092         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3093                                                                  ECSRITAB
  3094     12  WT-COMP-INFO.                                            ECSRITAB
  3095         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3096         16  WT-LF-QC                PIC X.                       ECSRITAB
  3097         16  WT-AH-QC                PIC X.                       ECSRITAB
  3098         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3099         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3100         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3101         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3102         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3103         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3104         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3105         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3106         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3107         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3108         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3109         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3110         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3111         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3112         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3113         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3114         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3115         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3116         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3117         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3118         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3119         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3120         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3121         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3122         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3123         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3124         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3125         16  WT-REMAINING            PIC X.                       ECSRITAB
  3126         16  FILLER                  PIC X(21).                   ECSRITAB
  3127                                                                  ECSRITAB
  3128 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3129     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3130     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3131     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3132     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3133     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3134     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3135     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3136     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3137     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3138     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3139     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3140     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3141     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3142     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3143     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3144     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3145     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3146     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3147     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3148     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3149     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3150     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3151     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3152     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3153                                                                  ECSRITAB
  3154     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3155         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3156     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3157         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3158     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3159         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3160     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3161         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3162     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3163         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3164     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3165         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3166                                                                  ECSRITAB
  3167     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3168         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3169         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3170         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3171         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3172         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3173         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3174         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3175         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3176         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3177         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3178         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3179         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3180         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3181         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3182         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3183         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3184         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3185         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3186         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3187         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3188         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3189         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3190         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3191     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3192     12  REIN-SEARCH.                                             ECSRITAB
  3193         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3194         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3195         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3196         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3197     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3198     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3199     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3200     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3201     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3202     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3203     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3204     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3205     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3206     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3207     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3208     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3209     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3210     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3211     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3212     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3213     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3214     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3215     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3216     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3217     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3218     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3219     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3220     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3221     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3222                                                                  ECSRITAB
  3223 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3224* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3225     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3226         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3227         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3228         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3229         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3230         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3231         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3232         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3233         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3234         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3235                                                                  ECSRITAB
  3236 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3237     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3238         16  RC2-REIN-CO.                                         ECSRITAB
  3239             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3240             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3241         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3242         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3243         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3244         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3245         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3246         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3247                                                                  ECSRITAB
  3248 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3249     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3250         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3251         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3252     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3253                                                                  ECSRITAB
  3254 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3255     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3256         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3257         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3258         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3259 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3260     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3261         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3262                                                                  ECSRITAB
  3263 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3264******************************************************************ECSRITAB
  3265
* 3266                             COPY ELCPSEVR.
  3267******************************************************************04/16/98
  3268*                                                                *ELCPSEVR
  3269*                                                                *ELCPSEVR
  3270*                            ELCPSEVR                            *   LV003
  3271*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3272*                            VMOD=2.001                          *ELCPSEVR
  3273*                                                                *ELCPSEVR
  3274*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3275*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3276*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3277******************************************************************ELCPSEVR
  3278                                                                  ELCPSEVR
  3279 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3280     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3281         10  FILLER               PIC 999.                        ELCPSEVR
  3282         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3283         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3284             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3285             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3286         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3287         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3288     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3289            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3290     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3291         10  FILLER              PIC 999.                         ELCPSEVR
  3292         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3293         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3294             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3295             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3296         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3297         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3298     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3299            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3300 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3301     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3302                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3303         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3304             15  FILLER              PIC 999.                     ELCPSEVR
  3305             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3306             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3307                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3308                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3309             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3310             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3311         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3312                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3313         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3314             15  FILLER              PIC 999.                     ELCPSEVR
  3315             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3316             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3317                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3318                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3319             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3320             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3321         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3322                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3323         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3324             15  FILLER              PIC 999.                     ELCPSEVR
  3325             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3326             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3327                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3328                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3329             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3330             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3331         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3332                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3333     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3334         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3335         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3336         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3337             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3338             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3339         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3340         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3341     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3342            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3343
* 3344                             COPY ELCEPCVR.
  3345******************************************************************05/15/98
  3346*                                                                *ELCEPCVR
  3347*                                                                *ELCEPCVR
  3348*                            ELCEPCVR                            *   LV003
  3349*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3350*                            VMOD=2.001                          *ELCEPCVR
  3351*                                                                *ELCEPCVR
  3352*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3353*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3354*                                                                *ELCEPCVR
  3355******************************************************************ELCEPCVR
  3356 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3357     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3358         10  FILLER            PIC 999.                           ELCEPCVR
  3359         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3360         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3361             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3362             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3363         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3364         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3365     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3366            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3367     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3368         10  FILLER            PIC 999.                              CL**5
  3369         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3370         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3371             15  EC-EXP-CC     PIC 99.                               CL**5
  3372             15  EC-EXP-YR     PIC 99.                               CL**5
  3373         10  EC-EXP-MO         PIC 99.                               CL**5
  3374         10  EC-EXP-DA         PIC 99.                               CL**5
  3375     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3376            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3377     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3378         10  FILLER            PIC 999.                           ELCEPCVR
  3379         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3380         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3381             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3382             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3383         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3384         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3385     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3386            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3387     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3388         10  FILLER            PIC 999.                              CL**5
  3389         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3390         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3391             15  EC-EFF-CC     PIC 99.                               CL**5
  3392             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3393         10  EC-EFF-MO         PIC 99.                               CL**5
  3394         10  EC-EFF-DA         PIC 99.                               CL**5
  3395     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3396            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3397     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3398         10  FILLER            PIC 999.                           ELCEPCVR
  3399         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3400         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3401             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3402             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3403         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3404         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3405     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3406            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3407     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3408         10  FILLER            PIC 999.                           ELCEPCVR
  3409         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3410         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3411             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3412             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3413         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3414         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3415     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3416            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3417     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3418         10  FILLER            PIC 999.                           ELCEPCVR
  3419         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3420         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3421             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3422             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3423         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3424         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3425     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3426            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3427     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3428         10  FILLER            PIC 999.                           ELCEPCVR
  3429         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3430         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3431             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3432             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3433         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3434         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3435     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3436            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3437     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3438         10  FILLER            PIC 999.                           ELCEPCVR
  3439         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3440         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3441             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3442             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3443         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3444         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3445     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3446            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3447
* 3448                             COPY ELCREINV.
  3449******************************************************************04/18/98
  3450*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3451*                                                                *ELCREINV
  3452*                            ELCREINV                            *   LV003
  3453*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3454*                            VMOD=2.001                          *ELCREINV
  3455*                                                                *ELCREINV
  3456*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3457*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3458*                                                                *ELCREINV
  3459******************************************************************ELCREINV
  3460                                                                  ELCREINV
  3461 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3462     05  WS-RE-LO-DATE.                                              CL**3
  3463         10 FILLER                     PIC 999.                      CL**3
  3464         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3465         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3466            15 RE-LO-CC                PIC 99.                       CL**3
  3467            15 RE-LO-YR                PIC 99.                       CL**3
  3468         10 RE-LO-MO                   PIC 99.                       CL**3
  3469         10 RE-LO-DA                   PIC 99.                       CL**3
  3470     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3471            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3472     05  WS-RE-HI-DATE.                                              CL**3
  3473         10 FILLER                     PIC 999.                      CL**3
  3474         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3475         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3476            15 RE-HI-CC                PIC 99.                       CL**3
  3477            15 RE-HI-YR                PIC 99.                       CL**3
  3478         10 RE-HI-MO                   PIC 99.                       CL**3
  3479         10 RE-HI-DA                   PIC 99.                       CL**3
  3480     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3481            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3482     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3483         10 FILLER                     PIC 999.                   ELCREINV
  3484         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3485         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3486            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3487            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3488         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3489         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3490     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3491            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3492     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3493         10  FILLER                    PIC 999.                   ELCREINV
  3494         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3495         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3496             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3497             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3498         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3499         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3500     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3501            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3502     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3503         10  FILLER                    PIC 999.                   ELCREINV
  3504         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3505         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3506             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3507             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3508         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3509         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3510     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3511            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3512
  3513 01  RC-REIN-HOLD-AREAS.
  3514     12  RC-REIN-LEVELS  OCCURS 30.
  3515         16  RC-REIN-COMP    PIC X(6).
  3516         16  RC-OLD-ISS      PIC X.
  3517         16  RC-NEW-ISS      PIC X.
  3518         16  RC-OLD-CNC      PIC X.
  3519         16  RC-NEW-CNC      PIC X.
  3520         16  RC-OLD-LF-CLM   PIC X.
  3521         16  RC-OLD-AH-CLM   PIC X.
  3522         16  RC-NEW-LF-CLM   PIC X.
  3523         16  RC-NEW-AH-CLM   PIC X.
  3524         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3525         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3526         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3527         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3528         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3529         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3530         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3531         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3532         16  RC-REIN-REM-SW  PIC X.
  3533     12  RC-REIN-LEVELS-END  PIC X(6).
  3534
  3535 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3536     12  TPC-COUNTERS    OCCURS 6.
  3537         16  TPL-ISS-PRM     PIC S9(9)V99.
  3538         16  TPA-ISS-PRM     PIC S9(9)V99.
  3539         16  TPL-CNC-PRM     PIC S9(9)V99.
  3540         16  TPA-CNC-PRM     PIC S9(9)V99.
  3541         16  TPL-ACCT-COM    PIC S9(9)V99.
  3542         16  TPA-ACCT-COM    PIC S9(9)V99.
  3543         16  TPL-CLAIMS      PIC S9(9)V99.
  3544         16  TPA-CLAIMS      PIC S9(9)V99.
  3545
  3546 01  HLD-DTS SYNC.
  3547     12  EOM-RUN-DATE        PIC 9(08).
  3548     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3549         16  EOM-CCYY.
  3550             20  EOM-CC      PIC 99.
  3551             20  EOM-YR      PIC 99.
  3552         16  EOM-MO          PIC 99.
  3553         16  EOM-DA          PIC 99.
  3554
  3555****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3556****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3557     12  OB-RUN-DATES OCCURS 2.
  3558         16  OB-CCYY         PIC 9(4).
  3559         16  OB-MO           PIC 99.
  3560         16  OB-DA           PIC 99.
  3561
  3562     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3563         88  OB-DATE-1-USED     VALUE '*'.
  3564     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3565         88  OB-DATE-2-USED     VALUE '*'.
  3566     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS010D.cbl
  3567         88  OB-DATE-3-USED     VALUE '*'.
  3568     12  EARNING-START-DATE  PIC 9(08).
  3569     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3570         16  E-ERN-START-CC  PIC 99.
  3571         16  E-ERN-START-YR  PIC 99.
  3572         16  E-ERN-START-MO  PIC 99.
  3573         16  E-ERN-START-DA  PIC 99.
  3574     12  EARNING-STOP-DATE   PIC 9(08).
  3575     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  3576         16  E-ERN-STOP-CC   PIC 99.
  3577         16  E-ERN-STOP-YR   PIC 99.
  3578         16  E-ERN-STOP-MO   PIC 99.
  3579         16  E-ERN-STOP-DA   PIC 99.
  3580     12  STOP-LF-DATE        PIC 9(08).
  3581     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  3582         16  STOP-LF-CC      PIC 99.
  3583         16  STOP-LF-YR      PIC 99.
  3584         16  STOP-LF-MO      PIC 99.
  3585         16  STOP-LF-DA      PIC 99.
  3586     12  STOP-AH-DATE        PIC 9(08).
  3587     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  3588         16  STOP-AH-CC      PIC 99.
  3589         16  STOP-AH-YR      PIC 99.
  3590         16  STOP-AH-MO      PIC 99.
  3591         16  STOP-AH-DA      PIC 99.
  3592     12  BIN-VALUATION-DT    PIC XX.
  3593     12  BIN-EOM-RUN-DATE    PIC XX.
  3594     12  LAST-YRS-DATE       PIC 9(08).
  3595     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  3596         16  LYD-CCYY        PIC 9(04).
  3597         16  LYD-CCYR REDEFINES LYD-CCYY.
  3598             20  LYD-CC      PIC 99.
  3599             20  LYD-YR      PIC 99.
  3600         16  LYD-MO          PIC 99.
  3601         16  LYD-DA          PIC 99.
  3602     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  3603     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  3604         16  VAL-CC          PIC 99.
  3605         16  VAL-YR          PIC 99.
  3606         16  VAL-MO          PIC 99.
  3607         16  VAL-DA          PIC 99.
  3608     12  INCURRED-DATE       PIC 9(08).
  3609     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  3610         16  DTO-CC          PIC 99.
  3611         16  DTO-YR          PIC 99.
  3612         16  DTO-MO          PIC 99.
  3613         16  DTO-DA          PIC 99.
  3614     12  REPORTED-DATE.
  3615         16  RPT-YR          PIC 99.
  3616         16  RPT-MO          PIC 99.
  3617         16  RPT-DA          PIC 99.
  3618     12  PAYMENT-DATE        PIC 9(08).
  3619     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  3620         16  PAY-CC          PIC 99.
  3621         16  PAY-YR          PIC 99.
  3622         16  PAY-MO          PIC 99.
  3623         16  PAY-DA          PIC 99.
  3624     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS010D.cbl
  3625     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  3626         16  PAYTO-CC        PIC 99.
  3627         16  PAYTO-YR        PIC 99.
  3628         16  PAYTO-MO        PIC 99.
  3629         16  PAYTO-DA        PIC 99.
  3630
  3631 01  AH-RES-STATE-TABLE.
  3632     12  FILLER              PIC X(42)       VALUE
  3633             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  3634     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  3635
  3636 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  3637     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  3638
  3639 01  BILLING-COUNTERS    COMP-3.
  3640     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  3641     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  3642     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  3643     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  3644     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  3645     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  3646     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  3647     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  3648     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  3649     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  3650     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  3651     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  3652     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  3653     12  BC-COMM             PIC S9(5)           VALUE +0.
  3654     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  3655     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  3656     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  3657     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  3658     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  3659     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  3660     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  3661     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  3662     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  3663     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  3664
  3665 01  FLAGS SYNC.
  3666     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  3667         88  CHECK-BILLED                        VALUE 'Y'.
  3668     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  3669         88  EOF-ON-TRANS                        VALUE '*'.
  3670     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  3671         88  EOF-ON-CERT                         VALUE '*'.
  3672     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  3673         88  PROCESSING-COMPLETED                VALUE '*'.
  3674     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  3675         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  3676     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  3677         88  PRINTING-CERT-CHANGES               VALUE '*'.
  3678     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  3679         88  STATUTORY-REQUIREMENT               VALUE '*'.
  3680     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  3681         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  3682     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS010D.cbl
  3683         88  LIFE-FULLY-EARNED                   VALUE '*'.
  3684     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  3685         88  A-H-FULLY-EARNED                    VALUE '*'.
  3686     12  CNCL-FLG            PIC X               VALUE SPACE.
  3687     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  3688         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  3689         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  3690     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  3691         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  3692     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  3693         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  3694     12  EP-FLG              PIC X               VALUE SPACE.
  3695     12  END-FLG             PIC X               VALUE SPACE.
  3696     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  3697     12  PRIOR-CERT-IN-CNTRL PIC X(36)           VALUE LOW-VALUE.
  3698     12  ACCT-FLG            PIC X               VALUE SPACE.
  3699     12  STATE-FLG           PIC X               VALUE SPACE.
  3700     12  COMP-FLG            PIC X               VALUE SPACE.
  3701     12  CARR-FLG            PIC X               VALUE SPACE.
  3702     12  FINAL-FLG           PIC X               VALUE SPACE.
  3703     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  3704     12  REIN-FLG            PIC X               VALUE SPACE.
  3705     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  3706     12  REIN-RT-SW          PIC X               VALUE SPACE.
  3707
  3708 01  TEXAS-REG-WORK-AREAS   SYNC.
  3709     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  3710     12  TEX-FACT-2          PIC S999        COMP-3.
  3711     12  TEX-FACT-3          PIC S999        COMP-3.
  3712     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  3713     12  TEX-FACT-5          PIC S999        COMP-3.
  3714     12  TEX-FACT-6          PIC S999        COMP-3.
  3715     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  3716     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  3717     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  3718
  3719 01  NET-PAY-INTERFACE.
  3720     12  NP-APR              PIC S999V9(4)   COMP-3.
  3721     12  NP-ORIG             PIC S999        COMP-3.
  3722     12  NP-REM              PIC S999        COMP-3.
  3723     12  NP-OPT              PIC X.
  3724     12  NP-CAP              PIC S999        COMP-3.
  3725     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  3726     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  3727     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  3728     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  3729     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  3730     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  3731     12  NP-ACCOUNT          PIC X(10).
  3732
  3733 01  HOLDERS SYNC.
  3734     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  3735     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  3736     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  3737     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  3738     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  3739     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  3740     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS010D.cbl
  3741     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  3742     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  3743     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  3744     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  3745     12  TEMP-3              PIC S9(7)V99 COMP-3 VALUE +0.
  3746     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  3747     12  TEMP-5              PIC S9V9(9)  COMP-3 VALUE +0.
  3748     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  3749     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  3750     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  3751     12  REM-TRM1            PIC S999V99  COMP-3.
  3752     12  REM-TRM2            PIC S999V99  COMP-3.
  3753     12  REM-TRM3            PIC S999V99  COMP-3.
  3754     12  TEM-TRM1            PIC S999V99  COMP-3.
  3755     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  3756     12  ORIG-TERM           PIC S999V99  COMP-3.
  3757     12  HLD-CONTROL.
  3758         16  HLD-CARRIER     PIC X               VALUE SPACES.
  3759         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  3760         16  HLD-STATE       PIC XX              VALUE SPACES.
  3761         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  3762     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  3763
  3764 01  DISPLAY-IBNR-LINE.
  3765     05  FILLER                  PIC X       VALUE SPACES.
  3766     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  3767     05  FILLER                  PIC XX      VALUE SPACES.
  3768     05  DIL-TYPE                PIC X       VALUE SPACES.
  3769     05  FILLER                  PIC X       VALUE SPACES.
  3770     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  3771     05  FILLER                  PIC XXX     VALUE SPACES.
  3772     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  3773
  3774 01  DISPLAY-HD-1.
  3775     05  FILLER      PIC X       VALUE SPACES.
  3776     05  FILLER      PIC X(50)   VALUE SPACES.
  3777     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  3778     05  FILLER      PIC X(51)   VALUE SPACES.
  3779     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  3780
  3781 01  DISPLAY-HD-2.
  3782     05  FILLER                 PIC X       VALUE SPACE.
  3783     05  FILLER                 PIC X(57)   VALUE SPACES.
  3784     05  DIS-DATE               PIC X(8).
  3785     05  FILLER                 PIC X(66)   VALUE SPACES.
  3786
  3787 01  DISPLAY-LINE.
  3788     05  DL-FULL.
  3789         10  FILLER           PIC X       VALUE SPACE.
  3790         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  3791         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  3792
  3793 01  PRT-HDNGS SYNC.
  3794     12  TR-HD-1.
  3795         16  FILLER      PIC X       VALUE '1'.
  3796         16  FILLER      PIC X(53)   VALUE SPACES.
  3797         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  3798         16  FILLER      PIC X(48)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS010D.cbl
  3799         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  3800     12  TR-HD-2.
  3801         16  FILLER      PIC X       VALUE SPACE.
  3802         16  FILLER      PIC X(47)   VALUE SPACES.
  3803         16  TRHDNM      PIC X(30).
  3804         16  FILLER      PIC X(42)   VALUE SPACES.
  3805         16  TR-RN-DT    PIC X(8).
  3806     12  TR-HD-3.
  3807         16  FILLER      PIC X       VALUE SPACE.
  3808         16  FILLER      PIC X(53)   VALUE SPACES.
  3809         16  TR-MODAYR   PIC X(18).
  3810         16  FILLER      PIC X       VALUE SPACE.
  3811         16  TR-YRASK    PIC X       VALUE SPACE.
  3812         16  FILLER      PIC X(46)   VALUE SPACES.
  3813         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  3814         16  TR-PG       PIC ZZ,ZZ9.
  3815     12  TR-HD-4.
  3816         16  FILLER      PIC X       VALUE SPACE.
  3817         16  TR-AGCY     PIC X(30).
  3818     12  TR-HD-5.
  3819         16  FILLER      PIC X       VALUE SPACE.
  3820         16  TR-CARR     PIC X.
  3821         16  FILLER      PIC X       VALUE '-'.
  3822         16  TR-GROUP    PIC X(6).
  3823         16  FILLER      PIC X       VALUE '-'.
  3824         16  TR-ST-NO    PIC X(2).
  3825         16  FILLER      PIC X       VALUE '-'.
  3826         16  TR-AG-NO    PIC X(10).
  3827         16  FILLER      PIC X(23)   VALUE SPACES.
  3828         16  TR5-RP-TYP.
  3829             20  FILLER  PIC X(20)   VALUE
  3830                     '* * * * TRANSACTION '.
  3831             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  3832     12  TR-HD-6.
  3833         16  FILLER      PIC X       VALUE SPACE.
  3834         16  TR-CE-MO    PIC XX.
  3835         16  FILLER      PIC X       VALUE '-'.
  3836         16  TR-CE-DA    PIC XX.
  3837         16  FILLER      PIC X       VALUE '-'.
  3838         16  TR-CE-YR    PIC XX.
  3839         16  FILLER      PIC X(6)    VALUE '  TO  '.
  3840         16  TR-CX.
  3841             20  TR-CX-MO PIC XX.
  3842             20  HSHR1    PIC X.
  3843             20  TR-CX-DA PIC XX.
  3844             20  HSHR2    PIC X.
  3845             20  TR-CX-YR PIC XX.
  3846     12  TR-HD-7.
  3847         16  FILLER  PIC X      VALUE '0'.
  3848         16  FILLER  PIC X(24)  VALUE SPACES.
  3849         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  3850         16  TR-7-LF PIC X(6).
  3851         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  3852         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  3853         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  3854         16  TR-7-AH PIC X(6).
  3855         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  3856         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS010D.cbl
  3857     12  TR-HD-8.
  3858         16  FILLER  PIC X      VALUE SPACE.
  3859         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  3860         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  3861         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  3862         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  3863         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  3864     12  TR-HD-9.
  3865         16  FILLER  PIC X      VALUE SPACE.
  3866         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  3867         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  3868         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  3869         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  3870         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  3871         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  3872     12  TR-TTL-HD.
  3873         16  FILLER      PIC X       VALUE '0'.
  3874         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  3875         16  FILLER      PIC XX      VALUE SPACES.
  3876         16  TTL-HD-DS   PIC X(60)   VALUE
  3877             'ECS010 CONTROL TOTALS'.
  3878
  3879 01  TR-DTL.
  3880     12  FILLER                  PIC X           VALUE SPACE.
  3881     12  TR-DTL1.
  3882         16  TRD-CERT            PIC X(11).
  3883         16  TRD-ISDT.
  3884             20  FILLER          PIC X           VALUE SPACE.
  3885             20  TRD-ISMO        PIC XX.
  3886             20  TRD-IS-S1       PIC X           VALUE '/'.
  3887             20  TRD-ISDA        PIC XX.
  3888             20  TRD-IS-S2       PIC X           VALUE '/'.
  3889             20  TRD-ISYR        PIC XX.
  3890             20  FILLER          PIC X           VALUE SPACE.
  3891         16  TRD-AGE             PIC XX.
  3892     12  TR-DTL2.
  3893         16  FILLER              PIC X           VALUE SPACE.
  3894         16  TRD-LFTYP           PIC XXX.
  3895         16  FILLER              PIC X           VALUE SPACE.
  3896         16  TRD-LFTRM           PIC ZZ9.
  3897         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  3898         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  3899         16  TRD-LFACTDT.
  3900             20  FILLER          PIC X           VALUE SPACE.
  3901             20  TRD-LFACTMO     PIC XX.
  3902             20  TRD-LF-S1       PIC X           VALUE '/'.
  3903             20  TRD-LFACTDA     PIC XX.
  3904             20  TRD-LF-S2       PIC X           VALUE '/'.
  3905             20  TRD-LFACTYR     PIC XX.
  3906             20  FILLER          PIC X           VALUE SPACE.
  3907         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  3908         16  FILLER              PIC X           VALUE SPACE.
  3909         16  TRD-LF-STATUS       PIC X.
  3910         16  FILLER              PIC X(4)        VALUE SPACE.
  3911         16  TRD-AHTYP           PIC XXX.
  3912         16  FILLER              PIC X           VALUE SPACE.
  3913         16  TRD-AHTRM           PIC ZZ9.
  3914         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS010D.cbl
  3915         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  3916         16  TRD-AHACTDT.
  3917             20  FILLER          PIC X           VALUE SPACE.
  3918             20  TRD-AHACTMO     PIC XX.
  3919             20  TRD-AH-S1       PIC X           VALUE '/'.
  3920             20  TRD-AHACTDA     PIC XX.
  3921             20  TRD-AH-S2       PIC X           VALUE '/'.
  3922             20  TRD-AHACTYR     PIC XX.
  3923             20  FILLER          PIC X           VALUE SPACE.
  3924         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  3925         16  FILLER              PIC X           VALUE SPACE.
  3926         16  TRD-AH-STATUS       PIC X.
  3927     12  TR-DTL3 REDEFINES TR-DTL2.
  3928         16  FILLER              PIC X(20).
  3929         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  3930         16  FILLER              PIC X.
  3931         16  TRD-IBNRX           PIC X(4).
  3932         16  FILLER              PIC X(2).
  3933         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  3934         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  3935                                 PIC X(11).
  3936         16  FILLER              PIC X.
  3937         16  TRD-PAYCURX         PIC X(8).
  3938         16  FILLER              PIC X(2).
  3939         16  TRD-FUTRSV-DATA.
  3940             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  3941             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  3942                                 PIC X(11).
  3943             20  FILLER          PIC X.
  3944             20  TRD-FUTRSVX     PIC X(6).
  3945         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  3946             20  TRD-BENEFIT-X   PIC X(10).
  3947             20  TRD-BENEFIT-CODE
  3948                                 PIC X(02).
  3949             20  FILLER          PIC X(06).
  3950         16  FILLER              PIC X(4).
  3951         16  TRD-RSV-DESC        PIC X(6).
  3952         16  TRD-RSV-ACTION      PIC X(21).
  3953
  3954 01  DET-PR-UREC.
  3955     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  3956     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  3957     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  3958     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  3959     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  3960     12  DET-SEX             PIC X.
  3961     12  FILLER              PIC X(9)     VALUE '   APR - '.
  3962     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  3963     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  3964     12  DET-PR-MEM          PIC X(12).
  3965     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  3966     12  DET-PR-SS           PIC X(11).
  3967     12  FILLER              PIC XXX      VALUE SPACES.
  3968     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3969
  3970 01  DET-PR-UREC-2.
  3971     12  FILLER              PIC X        VALUE SPACE.
  3972     12  DET-LF-DESC         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS010D.cbl
  3973     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  3974     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  3975     12  FILLER              PIC X(4)     VALUE ' TO '.
  3976     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  3977     12  FILLER              PIC X        VALUE SPACE.
  3978     12  DET-AH-DESC         PIC XX.
  3979     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  3980     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  3981     12  FILLER              PIC X(4)     VALUE ' TO '.
  3982     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  3983     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  3984     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  3985     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  3986     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  3987     12  FILLER              PIC X(5)     VALUE SPACES.
  3988     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3989
  3990 01  DET-PR-UREC-3.
  3991     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  3992     12  DET-IND-GRP         PIC X.
  3993     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  3994     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  3995     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  3996     12  DET-POL-FORM        PIC X(12).
  3997     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  3998     12  DET-LOAN-OFFICER    PIC XXX.
  3999     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  4000     12  DET-USER-CODE       PIC X.
  4001     12  FILLER              PIC X(8)     VALUE SPACES.
  4002     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4003
  4004 01  DET-PR-UREC-4.
  4005     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  4006     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4007     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  4008     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4009     12  FILLER              PIC X(37)    VALUE SPACES.
  4010     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4011
  4012 01  DET-PR-UREC-5.
  4013     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4014     12  DET-LF-BEN-CD       PIC XX.
  4015     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4016     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4017     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4018     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4019     12  FILLER              PIC X(30)    VALUE SPACES.
  4020     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4021
  4022 01  DET-PR-UREC-6.
  4023     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4024     12  DET-AH-BEN-CD       PIC XX.
  4025     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4026     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4027     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4028     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4029     12  FILLER              PIC X(30)    VALUE SPACES.
  4030     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS010D.cbl
  4031
  4032 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4033     88  WS-CHANGE-REC              VALUE 'Y'.
  4034
  4035 01  TOTAL-PAGE-HD1.
  4036     12  FILLER              PIC X               VALUE SPACE.
  4037     12  TPH1-TYPE           PIC X(8).
  4038     12  TPH1-DESC.
  4039         16  TPH1-ST-CODE    PIC XX.
  4040         16  FILLER          PIC XXX.
  4041         16  TPH1-ST-DESC    PIC X(20).
  4042
  4043 01  TOTAL-PAGE-HD2.
  4044     12  FILLER              PIC X           VALUE SPACE.
  4045     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4046     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4047     12  FILLER              PIC X(9)        VALUE SPACES.
  4048     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4049     12  FILLER              PIC X(11)       VALUE SPACES.
  4050     12  FILLER              PIC X(3)        VALUE 'NET'.
  4051     12  FILLER              PIC X(11)       VALUE SPACES.
  4052     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4053     12  FILLER              PIC X(10)       VALUE SPACES.
  4054     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4055
  4056 01  TOTAL-PAGE-HD3.
  4057     12  FILLER              PIC X           VALUE SPACE.
  4058     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4059     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4060     12  FILLER              PIC X(10)       VALUE SPACES.
  4061     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4062     12  FILLER              PIC X(10)       VALUE SPACES.
  4063     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4064     12  FILLER              PIC X(7)        VALUE SPACES.
  4065     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4066     12  FILLER              PIC X(08)       VALUE SPACES.
  4067     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4068     12  FILLER              PIC X(11)       VALUE SPACES.
  4069     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4070
  4071 01  TOTAL-PAGE-DETAIL.
  4072     12  FILLER              PIC X(5).
  4073     12  TPD-DESC            PIC X(6).
  4074     12  FILLER              PIC X(3).
  4075     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4076     12  FILLER              PIC X(2).
  4077     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4078     12  FILLER              PIC X(2).
  4079     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4080     12  FILLER              PIC X(2).
  4081     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4082     12  FILLER              PIC X(2).
  4083     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4084     12  FILLER              PIC X(2).
  4085     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4086     12  FILLER              PIC X(4).
  4087     12  TPD-LO-CERT         PIC X(6).
  4088     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS010D.cbl
  4089     12  TPD-HI-CERT         PIC X(6).
  4090*    12  FILLER              PIC X.
  4091*    12  TPD-LO-CERT         PIC X(8).
  4092*    12  FILLER              PIC X.
  4093*    12  TPD-HI-CERT         PIC X(8).
  4094
  4095 01  DUPE-CERT-TABLE.
  4096     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4097         16  DUPE-ENTRY      PIC X(36).
  4098         16  DUPE-STATUS     PIC X(01).
  4099         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4100         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4101
  4102 01  MISMATCH-HEADING-1.
  4103     12  FILLER              PIC X           VALUE '1'.
  4104     12  FILLER              PIC X(45)       VALUE SPACES.
  4105     12  FILLER              PIC X(42)       VALUE
  4106             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4107     12  FILLER              PIC X(35)       VALUE SPACES.
  4108     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4109
  4110 01  MISMATCH-HEADING-2.
  4111     12  FILLER              PIC X           VALUE '0'.
  4112     12  FILLER              PIC X(44)       VALUE
  4113             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4114     12  FILLER              PIC X(44)       VALUE
  4115             'YPE      CERT IN CONTROL                    '.
  4116     12  FILLER              PIC X(44)       VALUE
  4117             '        CERT OUT CONTROL           STATUS   '.
  4118
  4119 01  MISMATCH-DETAIL.
  4120     12  FILLER              PIC X           VALUE '0'.
  4121     12  FILLER              PIC X           VALUE SPACES.
  4122     12  DTL-MATCH-CONTROL   PIC X(36).
  4123     12  FILLER              PIC X(3)        VALUE SPACES.
  4124     12  DTL-REC-TYPE        PIC X.
  4125     12  FILLER              PIC X(2)        VALUE SPACES.
  4126     12  DTL-REC-TYPE-DESC   PIC X(3).
  4127     12  FILLER              PIC X(3)        VALUE SPACES.
  4128     12  DTL-CERT-IN-CONTROL
  4129                             PIC X(36).
  4130     12  FILLER              PIC X           VALUE SPACES.
  4131     12  DTL-CERT-OUT-CONTROL
  4132                             PIC X(36).
  4133     12  FILLER              PIC X           VALUE SPACES.
  4134     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4135     12  FILLER              PIC X(2)        VALUE SPACES.
  4136
  4137 01  MISMATCH-DETAIL-2.
  4138     12  FILLER              PIC X           VALUE ' '.
  4139     12  FILLER              PIC X           VALUE SPACES.
  4140     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4141             ' LIFE PREMIUM = '.
  4142     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
  4143     12  FILLER              PIC X           VALUE SPACES.
  4144     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4145             'LIFE ALT PREM = '.
  4146     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS010D.cbl
  4147     12  FILLER              PIC XX          VALUE SPACES.
  4148     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4149             'A/H PREMIUM = '.
  4150     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4151     12  FILLER              PIC X(39)       VALUE SPACES.
  4152
  4153 01  MISMATCH-DETAIL-3.
  4154     12  FILLER              PIC X           VALUE ' '.
  4155     12  FILLER              PIC X           VALUE SPACES.
  4156     12  FILLER              PIC X(16)       VALUE
  4157             ' LIFE  REFUND = '.
  4158     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4159     12  FILLER              PIC X           VALUE SPACES.
  4160     12  FILLER              PIC X(16)       VALUE
  4161             'A & H  REFUND = '.
  4162     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4163     12  FILLER              PIC X(72)       VALUE SPACES.
  4164
  4165 01  MISMATCH-DETAIL-4.
  4166     12  FILLER              PIC X           VALUE ' '.
  4167     12  FILLER              PIC X           VALUE SPACES.
  4168     12  FILLER              PIC X(16)       VALUE
  4169             ' LIFE  CLAIM  = '.
  4170     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4171     12  FILLER              PIC X           VALUE SPACES.
  4172     12  FILLER              PIC X(16)       VALUE
  4173             'A & H  CLAIM  = '.
  4174     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4175     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS010D.cbl
  4177*
  4178*
  4179* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS010D.cbl
  4181 01  PB-STARTS-HERE              PIC X(48)
  4182       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4183
* 4184                             COPY ERCPNDB.
  4185******************************************************************
  4186*                                                                *
  4187*                                                                *
  4188*                            ERCPNDB.                            *
  4189*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4190*                            VMOD=2.025                          *
  4191*                                                                *
  4192*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4193*                                                                *
  4194******************************************************************
  4195*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4196*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4197******************************************************************
  4198*                                                                *
  4199*                                                                *
  4200*   FILE TYPE = VSAM,KSDS                                        *
  4201*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4202*                                                                *
  4203*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4204*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4205*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4206*                                                 RKP=13,LEN=36  *
  4207*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4208*                                      AND CHG-SEQ.)             *
  4209*                                                RKP=49,LEN=11   *
  4210*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4211*                                      AND CHG-SEQ.)             *
  4212*                                                RKP=60,LEN=15   *
  4213*                                                                *
  4214*   LOG = NO                                                     *
  4215*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4216******************************************************************
  4217******************************************************************
  4218*                   C H A N G E   L O G
  4219*
  4220* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4221*-----------------------------------------------------------------
  4222*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4223* EFFECTIVE    NUMBER
  4224*-----------------------------------------------------------------
  4225* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4226* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4227* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4228* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4229* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4230* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4231* 032306                   PEMA  ADD BOW LOAN NUMBER
  4232* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4233* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4234* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4235* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4236* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4237* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4238* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4239* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4240* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4241******************************************************************
  4242
  4243 01  PENDING-BUSINESS.
  4244     12  PB-RECORD-ID                     PIC XX.
  4245         88  VALID-PB-ID                        VALUE 'PB'.
  4246
  4247     12  PB-CONTROL-PRIMARY.
  4248         16  PB-COMPANY-CD                PIC X.
  4249         16  PB-ENTRY-BATCH               PIC X(6).
  4250         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4251         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4252
  4253     12  PB-CONTROL-BY-ACCOUNT.
  4254         16  PB-COMPANY-CD-A1             PIC X.
  4255         16  PB-CARRIER                   PIC X.
  4256         16  PB-GROUPING.
  4257             20  PB-GROUPING-PREFIX       PIC XXX.
  4258             20  PB-GROUPING-PRIME        PIC XXX.
  4259         16  PB-STATE                     PIC XX.
  4260         16  PB-ACCOUNT.
  4261             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4262             20  PB-ACCOUNT-PRIME         PIC X(6).
  4263         16  PB-CERT-EFF-DT               PIC XX.
  4264         16  PB-CERT-NO.
  4265             20  PB-CERT-PRIME            PIC X(10).
  4266             20  PB-CERT-SFX              PIC X.
  4267         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4268
  4269         16  PB-RECORD-TYPE               PIC X.
  4270             88  PB-MAILING-DATA                VALUE '0'.
  4271             88  PB-ISSUE                       VALUE '1'.
  4272             88  PB-CANCELLATION                VALUE '2'.
  4273             88  PB-BATCH-TRAILER               VALUE '9'.
  4274
  4275     12  PB-CONTROL-BY-ORIG-BATCH.
  4276         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4277         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4278         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4279         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4280
  4281     12  PB-CONTROL-BY-CSR.
  4282         16  PB-CSR-COMPANY-CD            PIC X.
  4283         16  PB-CSR-ID                    PIC X(4).
  4284         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4285         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4286         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4287******************************************************************
  4288*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4289******************************************************************
  4290
  4291     12  PB-LAST-MAINT-DT                 PIC XX.
  4292     12  PB-LAST-MAINT-BY                 PIC X(4).
  4293     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4294
  4295     12  PB-RECORD-BODY                   PIC X(375).
  4296
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4297     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4298         16  PB-CERT-ORIGIN               PIC X.
  4299             88  CLASIC-CREATED-CERT         VALUE '1'.
  4300         16  PB-I-NAME.
  4301             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4302             20  PB-I-INSURED-FIRST-NAME.
  4303                 24  PB-I-INSURED-1ST-INIT PIC X.
  4304                 24  FILLER                PIC X(9).
  4305             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4306         16  PB-I-AGE                     PIC S99   COMP-3.
  4307         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4308         16  PB-I-BIRTHDAY                PIC XX.
  4309         16  PB-I-INSURED-SEX             PIC X.
  4310             88  PB-SEX-MALE     VALUE 'M'.
  4311             88  PB-SEX-FEMALE   VALUE 'F'.
  4312
  4313         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4314         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4315         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4316         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4317         16  PB-I-SKIP-CODE               PIC X.
  4318             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4319             88  PB-SKIP-JULY              VALUE '1'.
  4320             88  PB-SKIP-AUGUST            VALUE '2'.
  4321             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4322             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4323             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4324             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4325             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4326             88  PB-SKIP-JUNE              VALUE '8'.
  4327             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4328             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4329             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4330         16  PB-I-TERM-TYPE               PIC X.
  4331             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4332             88  PB-PAID-WEEKLY            VALUE 'W'.
  4333             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4334             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4335             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4336         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4337         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4338         16  PB-I-DATA-ENTRY-SW           PIC X.
  4339             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4340             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4341             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4342             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4343         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4344         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4345*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4346         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4347         16  FILLER                       PIC X.
  4348
  4349         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4350             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4351             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4352                                                   '90' THRU '99'.
  4353         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4354                                          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4355         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4356         16  PB-I-AMOUNT-FINANCED REDEFINES
  4357                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4358         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4359         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4360                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4361         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4362         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4363         16  PB-I-CLP-AMOUNT REDEFINES
  4364                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4365         16  PB-I-LF-CALC-FLAG            PIC X.
  4366             88 PB-COMP-LF-PREM               VALUE '?'.
  4367         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4368         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4369         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4370         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4371         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4372         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4373         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4374         16  PB-I-LF-ABBR                 PIC XXX.
  4375         16  PB-I-LF-INPUT-CD             PIC XX.
  4376
  4377         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4378             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4379             88  PB-INVALID-AH               VALUE '  ' '00'
  4380                                                   '90' THRU '99'.
  4381         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4382         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4383         16  PB-I-AH-CALC-FLAG            PIC X.
  4384             88 PB-COMP-AH-PREM                  VALUE '?'.
  4385         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4386         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4387         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4388         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4389         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4390         16  PB-I-AH-ABBR                 PIC XXX.
  4391         16  PB-I-AH-INPUT-CD             PIC XXX.
  4392
  4393         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4394         16  PB-I-REIN-TABLE              PIC XXX.
  4395         16  PB-I-BUSINESS-TYPE           PIC 99.
  4396         16  PB-I-INDV-GRP-CD             PIC X.
  4397         16  PB-I-MORT-CODE.
  4398             20  PB-I-TABLE               PIC X.
  4399             20  PB-I-INTEREST            PIC XX.
  4400             20  PB-I-MORT-TYP            PIC X.
  4401         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4402         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4403         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4404         16  PB-I-INDV-GRP-OVRD           PIC X.
  4405         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4406         16  PB-I-SIG-SW                  PIC X.
  4407             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4408         16  PB-I-RATE-CLASS              PIC XX.
  4409         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4410         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4411         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4412         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4413         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4414         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4415         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4416         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4417         16  PB-I-OB-FLAG                 PIC X.
  4418             88  PB-I-OB                      VALUE 'B'.
  4419             88  PB-I-SUMMARY                 VALUE 'Z'.
  4420         16  PB-I-ENTRY-STATUS            PIC X.
  4421             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4422                                              'M' '5' '9' '2'.
  4423             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4424             88  PB-I-POLICY-PENDING          VALUE '2'.
  4425             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4426             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4427             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4428             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4429             88  PB-I-REIN-ONLY               VALUE '9'.
  4430             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4431             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4432             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4433             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4434         16  PB-I-INT-CODE                PIC X.
  4435             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4436             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4437         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4438         16  PB-I-SOC-SEC-NO              PIC X(11).
  4439         16  PB-I-MEMBER-NO               PIC X(12).
  4440         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4441*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4442         16  PB-I-OLD-LOF                 PIC XXX.
  4443         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4444         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4445         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4446         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4447         16  PB-I-LIFE-INDICATOR          PIC X.
  4448             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4449         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4450         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4451                                          PIC S9(5)V99    COMP-3.
  4452         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4453             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4454             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4455         16  PB-I-1ST-PMT-DT              PIC XX.
  4456         16  PB-I-JOINT-INSURED.
  4457             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4458             20 PB-I-JOINT-FIRST-NAME.
  4459                24  PB-I-JOINT-FIRST-INIT PIC X.
  4460                24  FILLER                PIC X(9).
  4461             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4462*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4463         16  PB-I-BENEFICIARY-NAME.
  4464             20  PB-I-BANK-NUMBER         PIC X(10).
  4465             20  FILLER                   PIC X(15).
  4466         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4467         16  PB-I-REFERENCE               PIC X(12).
  4468         16  FILLER REDEFINES PB-I-REFERENCE.
  4469             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4470             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4471             20  PB-I-CLP-STATE           PIC XX.
  4472         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4473             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4474             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4475             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4476         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4477         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4478         16  PB-I-RESIDENT-STATE          PIC XX.
  4479         16  PB-I-RATE-CODE               PIC X(4).
  4480         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4481         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4482         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4483         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4484         16  PB-I-BANK-NOCHRGB            PIC 99.
  4485         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4486         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4487
  4488     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4489         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4490             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4491         16  PB-C-CANCEL-ORIGIN           PIC X.
  4492             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4493         16  PB-C-LF-CANCEL-DT            PIC XX.
  4494         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4495         16  PB-C-LF-CALC-REQ             PIC X.
  4496             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4497         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4498         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4499         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4500             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4501         16  PB-C-AH-CANCEL-DT            PIC XX.
  4502         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4503         16  PB-C-AH-CALC-REQ             PIC X.
  4504             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4505         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4506         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4507         16  PB-C-LAST-NAME               PIC X(15).
  4508         16  PB-C-REFUND-SW               PIC X.
  4509             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4510             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4511         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4512         16  PB-C-PAYEE-CODE              PIC X(6).
  4513         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4514         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4515         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4516         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4517         16  PB-C-REFERENCE               PIC X(12).
  4518         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4519         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4520         16  PB-C-POST-CARD-IND           PIC X.
  4521         16  PB-C-CANCEL-REASON           PIC X.
  4522         16  PB-C-REF-INTERFACE-SW        PIC X.
  4523         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4524         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4525         16  FILLER                       PIC X(01).
  4526*        16  FILLER                       PIC X(18).
  4527         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4528*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4529         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4530         16  PB-CANCELED-CERT-DATA.
  4531             20  PB-CI-INSURED-NAME.
  4532                 24  PB-CI-LAST-NAME      PIC X(15).
  4533                 24  PB-CI-INITIALS       PIC XX.
  4534             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4535             20  PB-CI-INSURED-SEX        PIC X.
  4536             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4537             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4538             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4539             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4540             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4541             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4542             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4543             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4544             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4545             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4546             20  PB-CI-RATE-CLASS         PIC XX.
  4547             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4548             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4549             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4550             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4551             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4552             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4553             20  PB-CI-LF-ABBR            PIC X(3).
  4554             20  PB-CI-AH-ABBR            PIC X(3).
  4555             20  PB-CI-OB-FLAG            PIC X.
  4556                 88  PB-CI-OB                VALUE 'B'.
  4557             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4558                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4559                                           'M' '4' '5' '9' '2'.
  4560                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4561                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4562                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4563                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4564                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4565                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4566                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4567                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4568                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4569                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4570                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4571                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4572                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4573             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4574                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4575                                           'M' '4' '5' '9' '2'.
  4576                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4577                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4578                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4579                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4580                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4581                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4582                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4583                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4584                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4585                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4586                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4587                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4588                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4589             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4590             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4591             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4592             20  PB-CI-MEMBER-NO          PIC X(12).
  4593             20  PB-CI-INT-CODE           PIC X.
  4594                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4595                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4596             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4597             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4598             20  PB-CI-COMP-EXCP-SW       PIC X.
  4599                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4600                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4601             20  PB-CI-ENTRY-STATUS       PIC X.
  4602             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4603             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4604             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4605             20  PB-CI-DEATH-DT           PIC XX.
  4606             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4607             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4608             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4609             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4610             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4611             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4612             20  PB-CI-ENTRY-DT              PIC XX.
  4613             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4614             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4615             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4616             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4617             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4618             20  PB-CI-OLD-LOF               PIC XXX.
  4619*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4620             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4621             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4622             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4623             20  PB-CI-INDV-GRP-CD           PIC X.
  4624             20  PB-CI-BENEFICIARY-NAME.
  4625                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4626                 24  FILLER                  PIC X(15).
  4627             20  PB-CI-NOTE-SW               PIC X.
  4628             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4629             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4630             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4631             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4632             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4633             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4634             20  PB-CI-FIRST-NAME            PIC X(10).
  4635             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4636
  4637         16  FILLER                       PIC X(13).
  4638*032306  16  FILLER                       PIC X(27).
  4639*        16  FILLER                       PIC X(46).
  4640
  4641     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4642         16  FILLER                       PIC X(10).
  4643         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4644         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4645         16  PB-M-INSURED-MID-INIT        PIC X.
  4646         16  PB-M-INSURED-AGE             PIC 99.
  4647         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4648         16  PB-M-INSURED-SEX             PIC X.
  4649         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4650         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4651         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4652         16  PB-M-INSURED-CITY-STATE.
  4653             20  PB-M-INSURED-CITY        PIC X(28).
  4654             20  PB-M-INSURED-STATE       PIC XX.
  4655         16  PB-M-INSURED-ZIP-CODE.
  4656             20  PB-M-INSURED-ZIP-PRIME.
  4657                 24  PB-M-INSURED-ZIP-1   PIC X.
  4658                     88  PB-M-CANADIAN-POST-CODE
  4659                                             VALUE 'A' THRU 'Z'.
  4660                 24  FILLER               PIC X(4).
  4661             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4662         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4663                                        PB-M-INSURED-ZIP-CODE.
  4664             20  PM-M-INS-CAN-POST1       PIC XXX.
  4665             20  PM-M-INS-CAN-POST2       PIC XXX.
  4666             20  FILLER                   PIC XXX.
  4667         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4668         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4669         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4670         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4671         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4672         16  PB-M-CRED-BENE-CITYST.
  4673             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4674             20  PB-M-CRED-BENE-STATE     PIC XX.
  4675
  4676         16  FILLER                       PIC X(92).
  4677
  4678     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4679         16  FILLER                       PIC X(10).
  4680         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4681         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4682         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4683         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4684         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4685         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4686         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4687         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4688         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4689         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4690         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4691         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4692         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4693         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4694         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4695         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4696         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4697         16  PB-ACCOUNT-NAME              PIC X(30).
  4698         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4699         16  PB-REFERENCE                 PIC X(12).
  4700         16  PB-B-RECEIVED-DT             PIC XX.
  4701         16  FILLER                       PIC X(234).
  4702
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4703     12  PB-RECORD-STATUS.
  4704         16  PB-CREDIT-SELECT-DT          PIC XX.
  4705         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4706         16  PB-BILLED-DT                 PIC XX.
  4707         16  PB-BILLING-STATUS            PIC X.
  4708             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4709             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4710             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4711         16  PB-RECORD-BILL               PIC X.
  4712             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4713             88  PB-RECORD-RETURNED           VALUE 'R'.
  4714             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4715             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4716             88  PB-OVERRIDE-AH               VALUE 'A'.
  4717             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4718         16  PB-BATCH-ENTRY               PIC X.
  4719             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4720             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4721             88  PB-REISSUED-CERT             VALUE 'E'.
  4722             88  PB-CASH-CERT                 VALUE 'C'.
  4723             88  PB-MONTHLY-CERT              VALUE 'M'.
  4724             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4725             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4726             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4727         16  PB-FORCE-CODE                PIC X.
  4728             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4729             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4730             88  PB-CANCEL-FORCE              VALUE '8'.
  4731             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4732             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4733             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4734             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4735             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4736             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4737             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4738         16  PB-FATAL-FLAG                PIC X.
  4739             88  PB-FATAL-ERRORS              VALUE 'X'.
  4740         16  PB-FORCE-ER-CD               PIC X.
  4741             88  PB-FORCE-ERRORS              VALUE 'F'.
  4742             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4743         16  PB-WARN-ER-CD                PIC X.
  4744             88  PB-WARNING-ERRORS            VALUE 'W'.
  4745         16  FILLER                       PIC X.
  4746         16  PB-OUT-BAL-CD                PIC X.
  4747             88  PB-OUT-OF-BAL                VALUE 'O'.
  4748         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4749         16  PB-AH-OVERRIDE-L1            PIC X.
  4750         16  PB-INPUT-DT                  PIC XX.
  4751         16  PB-INPUT-BY                  PIC X(4).
  4752         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4753         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4754         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4755         16  PB-LF-EARNING-METHOD         PIC X.
  4756         16  PB-AH-EARNING-METHOD         PIC X.
  4757         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4758         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4759         16  PB-REIN-CD                   PIC XXX.
  4760         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4761         16  PB-AH-REFUND-TYPE            PIC X.
  4762         16  PB-ACCT-EFF-DT               PIC XX.
  4763         16  PB-ACCT-EXP-DT               PIC XX.
  4764         16  PB-COMPANY-ID                PIC X(3).
  4765         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4766         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4767         16  PB-SV-CARRIER                PIC X.
  4768         16  PB-SV-GROUPING               PIC X(6).
  4769         16  PB-SV-STATE                  PIC XX.
  4770         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4771         16  PB-GA-BILLING-INFO.
  4772             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4773                                          PIC XX.
  4774         16  PB-SV-REMIT-TO  REDEFINES
  4775             PB-GA-BILLING-INFO           PIC X(10).
  4776         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4777         16  PB-I-LOAN-OFFICER            PIC X(5).
  4778         16  PB-I-VIN                     PIC X(17).
  4779
  4780         16  FILLER                       PIC X(04).
  4781         16  IMNET-BYPASS-SW              PIC X.
  4782
  4783******************************************************************
  4784*                COMMON EDIT ERRORS                              *
  4785******************************************************************
  4786
  4787     12  PB-COMMON-ERRORS.
  4788         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4789                                           PIC S9(4)     COMP.
  4790
  4791******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS010D.cbl
  4793 01  PC-STARTS-HERE              PIC X(48)
  4794       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  4795
* 4796                             COPY ERCPNDC.
  4797******************************************************************04/29/98
  4798*                                                                *ERCPNDC
  4799*                                                                *ERCPNDC
  4800*                            ERCPNDC                             *   LV003
  4801*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4802*                            VMOD=2.004                          *   CL**2
  4803*                                                                *ERCPNDC
  4804*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  4805*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  4806*                                                                *ERCPNDC
  4807*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  4808*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  4809*                                                                *ERCPNDC
  4810*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  4811*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  4812*                                                                *ERCPNDC
  4813*   LOG = YES                                                    *ERCPNDC
  4814*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  4815******************************************************************ERCPNDC
  4816                                                                  ERCPNDC
  4817 01  PENDING-CLAIMS.                                              ERCPNDC
  4818     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  4819         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  4820                                                                  ERCPNDC
  4821     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  4822         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  4823         16  PC-CARRIER                   PIC X.                  ERCPNDC
  4824         16  PC-GROUPING.                                         ERCPNDC
  4825             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  4826             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  4827         16  PC-STATE                     PIC XX.                 ERCPNDC
  4828         16  PC-ACCOUNT.                                          ERCPNDC
  4829             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  4830             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  4831         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  4832         16  PC-CERT-NO.                                          ERCPNDC
  4833             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  4834             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  4835         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  4836         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  4837                                                                  ERCPNDC
  4838         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  4839             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  4840             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  4841         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  4842                                                                  ERCPNDC
  4843     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  4844     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  4845     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  4846                                                                  ERCPNDC
  4847     12  PC-CLAIM-RECORD.                                         ERCPNDC
  4848         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  4849             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  4850             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4851             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  4852             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  4853         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  4854         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  4855         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  4856         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  4857         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  4858         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  4859         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  4860         16  FILLER                       PIC XX.                 ERCPNDC
  4861         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  4862             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  4863             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  4864             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  4865             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  4866             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  4867             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  4868             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  4869                                                                  ERCPNDC
  4870         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  4871         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  4872         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  4873         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  4874                                                                  ERCPNDC
  4875         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  4876         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  4877         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  4878                                                                  ERCPNDC
  4879         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  4880             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  4881                                                                  ERCPNDC
  4882         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  4883         16  FILLER                       PIC X(48).              ERCPNDC
  4884                                                                  ERCPNDC
  4885         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  4886             20  PC-CC-INSURED-NAME.                              ERCPNDC
  4887                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  4888                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  4889             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  4890             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  4891             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  4892             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  4893             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  4894             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  4895             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  4896             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  4897             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  4898             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  4899             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  4900             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  4901             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  4902                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  4903             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  4904                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  4905                                               '4' '5' '9' '2'.   ERCPNDC
  4906                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  4907                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  4908                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4909                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  4910                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  4911                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  4912                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  4913                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  4914                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  4915             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  4916                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  4917                                               '4' '5' '9' '2'.   ERCPNDC
  4918                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  4919                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  4920                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  4921                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  4922                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  4923                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  4924                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  4925                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  4926                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  4927             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  4928             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  4929             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  4930             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  4931             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  4932                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  4933                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  4934             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  4935             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  4936             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  4937             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  4938             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  4939             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  4940             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  4941             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  4942         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  4943         16  PC-CC-CLP-STATE              PIC XX.
  4944         16  FILLER                       PIC X(14).              ERCPNDC
  4945         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  4946         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  4947         16  FILLER                       PIC X(34).              ERCPNDC
  4948                                                                  ERCPNDC
  4949     12  PC-RECORD-STATUS.                                        ERCPNDC
  4950         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  4951         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  4952         16  FILLER                       PIC XX.                 ERCPNDC
  4953         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  4954             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  4955         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  4956             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  4957             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  4958                                                     '8'.         ERCPNDC
  4959         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  4960             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  4961             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  4962         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  4963             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  4964         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  4965         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  4966         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4967         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  4968             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  4969         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  4970         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  4971                                                                  ERCPNDC
  4972     12  PC-ERROR-FLAGS.                                          ERCPNDC
  4973         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  4974             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  4975         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  4976             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  4977                                                                  ERCPNDC
  4978     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  4979         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  4980                                                                  ERCPNDC
  4981     12  FILLER                           PIC X(25).              ERCPNDC
  4982                                                                  ERCPNDC
  4983******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS010D.cbl
  4985 01  CC-STARTS-HERE              PIC X(48)
  4986       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  4987
* 4988                             COPY ERCCRTC.
  4989******************************************************************04/29/98
  4990*                                                                *ERCCRTC
  4991*                                                                *ERCCRTC
  4992*                            ERCCRTC                             *   LV003
  4993*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4994*                            VMOD=2.005                          *   CL**3
  4995*                                                                *ERCCRTC
  4996*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  4997*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  4998*                       ISSUES AND CANCELS)                      *ERCCRTC
  4999*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  5000*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  5001*                                                                *ERCCRTC
  5002*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  5003*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  5004*                                                                *ERCCRTC
  5005*   LOG = YES                                                    *ERCCRTC
  5006*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  5007******************************************************************ERCCRTC
  5008*                   C H A N G E   L O G
  5009*
  5010* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5011*-----------------------------------------------------------------
  5012*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5013* EFFECTIVE    NUMBER
  5014*-----------------------------------------------------------------
  5015* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5016******************************************************************
  5017 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5018     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5019         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5020                                                                  ERCCRTC
  5021     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5022         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5023         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5024         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5025         16  CC-STATE                     PIC XX.                 ERCCRTC
  5026         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5027         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5028         16  CC-CERT-NO.                                          ERCCRTC
  5029             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5030             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5031                                                                  ERCCRTC
  5032         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5033                                                                  ERCCRTC
  5034     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5035     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5036     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5037                                                                  ERCCRTC
  5038     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5039                                                                  ERCCRTC
  5040     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5041         16  FILLER                       PIC X(10).              ERCCRTC
  5042         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5043             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5044             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5045                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5046                 24  FILLER               PIC X(9).               ERCCRTC
  5047             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5048         16  CC-AGE                       PIC S99.                ERCCRTC
  5049         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5050         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5051         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5052             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5053             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5054         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5055             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5056             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5057                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5058                 24  FILLER               PIC X(9).               ERCCRTC
  5059             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5060         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5061         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5062         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5063         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5064         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5065         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5066         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5067         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5068         16  CC-OLD-LOF                   PIC XXX.
  5069*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5070         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5071         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5072         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5073         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5074         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5075         16  FILLER                       PIC X(3).               ERCCRTC
  5076         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5077         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5078         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5079         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5080         16  CC-LOAN-OFFICER              PIC X(5).
  5081         16  FILLER                       PIC XXX.                ERCCRTC
  5082     12  CC-RECORD-STATUS.                                        ERCCRTC
  5083         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5084         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5085     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5086         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5087         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5088         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5089         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5090     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5091     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5092         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5093             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5094         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5095             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5096     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5097         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5098         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5099         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5100         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS010D.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5101                                                                  ERCCRTC
  5102     12  FILLER                           PIC X(05).              ERCCRTC
  5103******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS010D.cbl
  5105 01  CR-STARTS-HERE              PIC X(48)
  5106       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5107
* 5108                             COPY ECSCRT01.
  5109******************************************************************
  5110*                                                                *
  5111*                            ECSCRT01                            *
  5112*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5113*                            VMOD=2.016                          *
  5114*                                                                *
  5115*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5116*                                                                *
  5117*   FILE TYPE = SEQUENTIAL
  5118*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5119*                                                                *
  5120*   KEY DATA =                         START=4, LEN=36           *
  5121*                                                                *
  5122*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5123*                                                                *
  5124******************************************************************
  5125******************************************************************
  5126*                   C H A N G E   L O G
  5127*
  5128* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5129*-----------------------------------------------------------------
  5130*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5131* EFFECTIVE    NUMBER
  5132*-----------------------------------------------------------------
  5133* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5134* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5135* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5136* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5137* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5138* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5139* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5140* 032612  CR2011110200001  PEMA  AHL CHANGES
  5141* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  5142* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5143******************************************************************
  5144
  5145 01  CERTIFICATE-RECORD.
  5146     12  CR-RECORD-ID                      PIC XX.
  5147         88  VALID-CR-ID                      VALUE 'CR'.
  5148
  5149     12  CR-COMPANY-CD                     PIC X.
  5150
  5151     12  CR-FULL-CONTROL.
  5152         16  CR-CONTROL-1.
  5153             20  CR-ACCT-CONTROL.
  5154                 24  CR-CARRIER            PIC X.
  5155                 24  CR-GROUPING.
  5156                     28  CR-GROUP-PREFIX   PIC XXX.
  5157                     28  CR-GROUP-PRIME    PIC XXX.
  5158                 24  CR-STATE              PIC XX.
  5159                 24  CR-ACCOUNT.
  5160                     28  CR-ACCT-PREFIX    PIC X(4).
  5161                     28  CR-ACCT-PRIME     PIC X(6).
  5162             20  CR-DT                     PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5163         16  CR-CERT-NO.
  5164             20  CR-CERT.
  5165                 24  CR-CERT-PREFIX        PIC X(3).
  5166                 24  CR-CERT-PRIME         PIC X(7).
  5167             20  CR-CERT-SFX               PIC X.
  5168
  5169     12  CR-INSUREDS-PROFILE.
  5170         16  CR-NAME.
  5171             20  CR-LNAME                  PIC X(15).
  5172             20  CR-FNAME.
  5173                 24  CR-1ST-INITIAL        PIC X.
  5174                 24  FILLER                PIC X(9).
  5175             20  CR-INIT                   PIC X.
  5176         16  CR-AGE                        PIC 99.
  5177         16  CR-SEX                        PIC X.
  5178             88  CR-SEX-MALE                  VALUE 'M'.
  5179             88  CR-SEX-FEMALE                VALUE 'F'.
  5180         16  CR-SOC-SEC                    PIC X(11).
  5181         16  CR-JOINT-NAME.
  5182             20  CR-JT-LNAME               PIC X(15).
  5183             20  CR-JT-FNAME.
  5184                 24  CR-JT-1ST-INIT        PIC X.
  5185                 24  FILLER                PIC X(9).
  5186             20  CR-JT-INIT                PIC X.
  5187         16  CR-JOINT-AGE                  PIC 99.
  5188
  5189         16  cr-ahl-ah-claim-no            pic x(9).
  5190         16  cr-ahl-ah-cert-seq            pic x(3).
  5191         16  cr-hst-proc-lf                pic x.
  5192         16  f                             pic x(7).
  5193
  5194     12  CR-LF-COVERAGE-DATA.
  5195         16  CR-LFTYP                      PIC XX.
  5196         16  CR-LF-TERM                    PIC S999       COMP-3.
  5197         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5198         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5199         16  CR-LF-DEV-CODE                PIC XXX.
  5200         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5201
  5202         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5203         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5204         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5205         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5206
  5207         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5208         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5209         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5210         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5211
  5212         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5213         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5214
  5215         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5216         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5217
  5218         16  CR-LF-REFUND-TYPE             PIC X.
  5219         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5220
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5221         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5222             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
  5223
  5224         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5225
  5226         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5227         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5228         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5229
  5230         16  cr-ahl-lf-claim-no            pic x(9).
  5231         16  cr-ahl-lf-cert-seq            pic x(3).
  5232         16  FILLER                        PIC XX.
  5233
  5234     12  CR-AH-COVERAGE-DATA.
  5235         16  CR-AHTYP                      PIC XX.
  5236         16  CR-AH-TERM                    PIC S999       COMP-3.
  5237         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5238         16  CR-AH-DEV-CODE                PIC XXX.
  5239         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5240
  5241         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5242         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5243         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5244         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5245
  5246         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5247         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5248
  5249         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5250         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5251
  5252         16  CR-AH-REFUND-TYPE             PIC X.
  5253         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5254
  5255         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5256             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5257
  5258         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5259
  5260         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5261         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5262         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5263
  5264         16  FILLER                        PIC XX.
  5265*        16  FILLER                        PIC X(8).
  5266
  5267     12  CR-LOAN-DATA.
  5268         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5269         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5270                                           PIC S9(5)V99   COMP-3.
  5271         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5272         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5273         16  CR-PMT-FREQ                   PIC 99.
  5274         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5275         16  CR-RATING-CLASS               PIC XX.
  5276         16  CR-POLICY-FORM-NO             PIC X(12).
  5277         16  CR-GRPTYP                     PIC XX.
  5278         16  CR-IND-GRP                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5279             88  CR-INDIVIDUAL                VALUE '1'.
  5280             88  CR-GROUP                     VALUE '2'.
  5281         16  CR-SKIP                       PIC 99.
  5282             88  NO-MONTHS-SKIPPED            VALUE 00.
  5283             88  SKIP-JULY                    VALUE 01.
  5284             88  SKIP-AUGUST                  VALUE 02.
  5285             88  SKIP-SEPTEMBER               VALUE 03.
  5286             88  SKIP-JULY-AUG                VALUE 04.
  5287             88  SKIP-AUG-SEPT                VALUE 05.
  5288             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5289             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5290             88  SKIP-JUNE                    VALUE 08.
  5291             88  SKIP-JUNE-JULY               VALUE 09.
  5292             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5293             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5294         16  CR-RESIDENT-STATE             PIC XX.
  5295         16  CR-RATE-CODE.
  5296             20  CR-LF-CLASS-CD            PIC XX.
  5297             20  CR-AH-CLASS-CD            PIC XX.
  5298         16  CR-MORT.
  5299             20  CR-TAB                    PIC X.
  5300             20  CR-INT                    PIC 99.
  5301             20  CR-GRP                    PIC X.
  5302         16  CR-MEMBER-NO                  PIC X(12).
  5303         16  CR-OLD-LOF                    PIC XXX.
  5304*        16  CR-LOAN-OFFICER               PIC XXX.
  5305         16  CR-REIN-TABLE                 PIC XXX.
  5306         16  CR-REIN-SPEC                  PIC X.
  5307         16  CR-LOAN-1ST-PMT-DT.
  5308             20  CR-1ST-PMT-YR             PIC 99.
  5309             20  CR-1ST-PMT-MO             PIC 99.
  5310             20  CR-1ST-PMT-DA             PIC 99.
  5311         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5312         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5313         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5314         16  CR-LAST-ADD-ON-DT             PIC XX.
  5315
  5316         16  CR-UNDERWRITING-CODE          PIC X.
  5317             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5318
  5319         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5320         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5321         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5322         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5323
  5324     12  CR-STATUS-INFORMATION.
  5325         16  CR-ENTRY-STATUS               PIC X.
  5326             88  CR-NORMAL-ENTRY              VALUE '1'.
  5327             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5328             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5329             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5330             88  CR-POLICY-IS-CASH            VALUE 'C'.
  5331             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5332             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5333             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5334             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5335             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5336             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5337                                                'C' '5' '9' 'P'.
  5338         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5339
  5340         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5341         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5342         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5343
  5344         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5345         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5346
  5347         16  CR-LF-CURRENT-STATUS          PIC X.
  5348             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5349             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5350             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5351             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5352             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5353             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5354             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5355             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5356             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5357             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5358             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5359             88  CR-LF-IS-VOID                VALUE 'V'.
  5360             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5361                                                    '4' '5' '9'.
  5362
  5363         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5364
  5365         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5366         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5367
  5368         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5369         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5370
  5371         16  CR-AH-CURRENT-STATUS          PIC X.
  5372             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5373             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5374             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5375             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5376             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5377             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5378             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5379             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5380             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5381             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5382             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5383             88  CR-AH-IS-VOID                VALUE 'V'.
  5384             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5385                                                    '4' '5' '9'.
  5386         16  CR-LOAN-OFFICER               PIC X(5).
  5387         16  CR-CANCEL-REASON              PIC X.
  5388         16  cr-xycor-lf-cov-code          pic x(4).
  5389         16  cr-xycor-ah-cov-code          pic x(4).
  5390         16  cr-temp-epiq                  pic x(4).
  5391         16  FILLER                        PIC XX.
  5392
  5393     12  CR-DEATH-CLAIM-DATA.
  5394         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5395
  5396         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5397         16  CR-DTH-RPT-DT.
  5398             20  CR-DTH-RPT-YR             PIC 99.
  5399             20  CR-DTH-RPT-MO             PIC 99.
  5400             20  CR-DTH-RPT-DA             PIC 99.
  5401         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5402
  5403         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5404         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5405         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5406         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5407         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5408
  5409         16  CR-DTH-AGE                    PIC 99.
  5410         16  CR-DTH-PAY-CD                 PIC X.
  5411         16  CR-DEATH-CAUSE                PIC X(6).
  5412
  5413         16  FILLER                        PIC X(16).
  5414
  5415     12  CR-DISAB-CLAIM-DATA.
  5416         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5417
  5418         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5419         16  CR-DIS-RPT-DT.
  5420             20  CR-DIS-RPT-YR             PIC 99.
  5421             20  CR-DIS-RPT-MO             PIC 99.
  5422             20  CR-DIS-RPT-DA             PIC 99.
  5423         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5424         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5425
  5426         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5427         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5428         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5429         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5430         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5431
  5432         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5433         16  CR-DIS-PAY-CD                 PIC X.
  5434         16  FILLER                        PIC XX.
  5435
  5436         16  CR-DISAB-INCURRED-DETAIL.
  5437             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5438**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5439                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5440                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5441                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5442
  5443         16  CR-DISAB-CAUSE                PIC X(6).
  5444         16  FILLER                        PIC X(14).
  5445
  5446     12  CR-REMIT-TO                       PIC 99.
  5447
  5448     12  CR-COMPENSATION-LEVELS.
  5449         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5450             20  CR-COM-AGT.
  5451                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5452                 24  CR-COM-AGT-PRIME      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5453             20  CR-AGT-TYPE               PIC X.
  5454             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5455             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5456
  5457     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5458     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5459     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5460     12  CR-CLP-STATE                      PIC XX.
  5461     12  CR-POST-CARD-IND                  PIC X.
  5462     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5463     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5464     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5465     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5466     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5467     12  FILLER                            PIC X(07).
  5468
  5469     12  CR-CSR-CODE                       PIC XXX.
  5470
  5471     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5472     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5473
  5474     12  CR-MICROFILM-NUMBERS.
  5475*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5476         16  FILLER                        PIC X(5).
  5477     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5478
  5479     12  CR-USER-CODE                      PIC X.
  5480     12  CR-USER-FUTURE                    PIC X(9).
  5481
  5482     12  CR-BENEFICIARY.
  5483         16  CR-BANK-NO                    PIC X(10).
  5484         16  FILLER                        PIC X(15).
  5485
  5486     12  CR-ENTRY-BATCH                    PIC X(6).
  5487     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5488     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5489
  5490     12  CR-NOTE-SW                        PIC X.
  5491
  5492     12  CR-ORIGIN-INDICATOR               PIC X.
  5493         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5494         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5495
  5496     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5497     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5498     12  FILLER                            PIC X(33).
  5499
  5500******************************************************************
* 5501                             COPY ELCCRTVR.
  5502***************************************************************** 04/24/98
  5503*                                                                *ELCCRTVR
  5504*                                                                *ELCCRTVR
  5505*                            ELCCRTVR                            *   LV003
  5506*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5507*                            VMOD=2.001                          *ELCCRTVR
  5508*                                                                *ELCCRTVR
  5509*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5510*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5511*                                                                *ELCCRTVR
  5512******************************************************************ELCCRTVR
  5513                                                                  ELCCRTVR
  5514 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  5515     05  WS-CR-DT.                                                ELCCRTVR
  5516         10  FILLER                PIC 999.                       ELCCRTVR
  5517         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5518         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5519             15  CR-CC             PIC 99.                        ELCCRTVR
  5520             15  CR-YR             PIC 99.                        ELCCRTVR
  5521         10  CR-MO                 PIC 99.                        ELCCRTVR
  5522         10  CR-DA                 PIC 99.                        ELCCRTVR
  5523     05  WS-CR-DT-N REDEFINES                                        CL**2
  5524            WS-CR-DT               PIC 9(11).                        CL**2
  5525     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5526         10  FILLER                    PIC 999.                   ELCCRTVR
  5527         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5528         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5529             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5530             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5531         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5532         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5533     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5534            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5535     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5536         10  FILLER                    PIC 999.                   ELCCRTVR
  5537         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5538         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5539             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5540             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5541         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5542         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5543     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5544            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5545     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5546         10  FILLER                    PIC 999.                   ELCCRTVR
  5547         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5548         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5549             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5550             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5551         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5552         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5553     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5554            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5555     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5556         10  FILLER                    PIC 999.                   ELCCRTVR
  5557         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5558         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5559             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5560             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5561         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5562         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5563     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5564            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5565     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5566         10  FILLER                    PIC 999.                   ELCCRTVR
  5567         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5568         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5569             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5570             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5571         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5572         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  5573     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5574            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5575     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  5576         10  FILLER                    PIC 999.                   ELCCRTVR
  5577         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5578         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  5579             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  5580             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  5581         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  5582         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  5583     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  5584            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  5585     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  5586         10  FILLER                    PIC 999.                   ELCCRTVR
  5587         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5588         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  5589             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  5590             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  5591         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  5592         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  5593     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  5594            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  5595     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  5596         10  FILLER                    PIC 999.                   ELCCRTVR
  5597         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5598         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  5599             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  5600             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  5601         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  5602         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  5603     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5604            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5605     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  5606         10  FILLER                    PIC 999.                   ELCCRTVR
  5607         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5608         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  5609             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  5610             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  5611         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  5612         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  5613     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  5614          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  5615     05  WS-CR-DTH-DT.                                            ELCCRTVR
  5616         10  FILLER                    PIC 999.                   ELCCRTVR
  5617         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  5618         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  5619             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  5620             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  5621         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  5622         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  5623     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  5624            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  5625     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  5626         10  FILLER                    PIC 999.                   ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5627         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  5628         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  5629             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  5630             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  5631         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  5632         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  5633     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  5634            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  5635     05  WS-CR-DIS-DT.                                            ELCCRTVR
  5636         10  FILLER                    PIC 999.                   ELCCRTVR
  5637         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  5638         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  5639             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  5640             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  5641         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  5642         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  5643     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  5644            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  5645     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  5646         10  FILLER                    PIC 999.                   ELCCRTVR
  5647         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  5648         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  5649             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  5650             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  5651         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  5652         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  5653     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  5654            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  5655     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  5656         10  FILLER                    PIC 999.                   ELCCRTVR
  5657         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  5658         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  5659             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  5660             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  5661         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  5662         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  5663     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  5664            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  5665     05  COPY-NDX                      PIC 9.                        CL**6
  5666     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  5667         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  5668             15  FILLER                PIC 999.                   ELCCRTVR
  5669             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  5670             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  5671                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  5672                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  5673             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  5674             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  5675         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  5676                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  5677
  5678 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS010D.cbl
* 5680                             COPY ELCDATE.
  5681******************************************************************06/11/98
  5682*                                                                *ELCDATE
  5683*                                                                *ELCDATE
  5684*                            ELCDATE.                            *   LV023
  5685*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  5686*                            VMOD=2.003                           ELCDATE
  5687*                                                                *ELCDATE
  5688*                                                                *ELCDATE
  5689*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  5690*                 LENGTH = 200                                   *   CL*19
  5691******************************************************************ELCDATE
  5692                                                                  ELCDATE
  5693 01  DATE-CONVERSION-DATA.                                        ELCDATE
  5694     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  5695     12  DC-OPTION-CODE                PIC X.                        CL*15
  5696         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  5697         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  5698         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  5699         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  5700         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  5701         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  5702         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  5703         88  FIND-CENTURY               VALUE '7'.                   CL*22
  5704         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  5705         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  5706         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  5707         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  5708         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  5709         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  5710         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  5711         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  5712         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  5713         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  5714         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  5715         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  5716         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  5717         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  5718         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  5719         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  5720         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  5721         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  5722         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  5723         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  5724         88  THREE-CHARACTER-BIN                                  ELCDATE
  5725                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  5726         88  GREGORIAN-TO-BIN                                        CL**2
  5727                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  5728         88  BIN-TO-GREGORIAN                                        CL**2
  5729                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  5730         88  JULIAN-TO-BINARY                                        CL**2
  5731                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  5732     12  DC-ERROR-CODE                 PIC X.                        CL*15
  5733         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  5734         88  DATE-CONVERSION-ERROR                                ELCDATE
  5735                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  5736         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  5737         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5738         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  5739         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  5740         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  5741         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  5742         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  5743         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  5744         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  5745         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  5746     12  DC-END-OF-MONTH               PIC X.                        CL*15
  5747         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  5748     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  5749         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  5750         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  5751         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  5752     12  FILLER                        PIC X.                        CL*15
  5753     12  DC-CONVERSION-DATES.                                        CL*15
  5754         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  5755         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  5756         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  5757         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  5758                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  5759             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  5760             20  SLASH1-1              PIC X.                        CL*15
  5761             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  5762             20  SLASH1-2              PIC X.                        CL*15
  5763             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  5764         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  5765         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  5766                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  5767             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  5768             20  SLASH2-1              PIC X.                        CL*15
  5769             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  5770             20  SLASH2-2              PIC X.                        CL*15
  5771             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  5772         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  5773         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  5774                     DC-GREG-DATE-1-YMD.                          ELCDATE
  5775             20  DC-YMD-YEAR           PIC 99.                       CL*15
  5776             20  DC-YMD-MONTH          PIC 99.                       CL*15
  5777             20  DC-YMD-DAY            PIC 99.                       CL*15
  5778         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  5779         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  5780                      DC-GREG-DATE-1-MDY.                         ELCDATE
  5781             20  DC-MDY-MONTH          PIC 99.                       CL*15
  5782             20  DC-MDY-DAY            PIC 99.                       CL*15
  5783             20  DC-MDY-YEAR           PIC 99.                       CL*15
  5784         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  5785             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  5786             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  5787             20  FILLER                PIC XX.                       CL*15
  5788             20  DC-ALPHA-CENTURY.                                   CL*15
  5789                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  5790             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  5791         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  5792         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  5793         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  5794         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  5795         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5796                                       PIC 9(05).                    CL*20
  5797         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  5798             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  5799             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  5800         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  5801         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  5802         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  5803     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  5804         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  5805         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  5806             20  FILLER                PIC 9(3).                     CL*15
  5807             20  HOLD-CEN-1-CCYY.                                    CL*15
  5808                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  5809                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  5810             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  5811             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  5812         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  5813             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  5814             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  5815             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  5816                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  5817                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  5818             20  FILLER                PIC 9(3).                     CL*15
  5819         16  HOLD-CENTURY-1-X.                                       CL*15
  5820             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  5821             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  5822                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  5823                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  5824             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  5825             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  5826         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  5827             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  5828             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  5829             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  5830                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  5831                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  5832             20  FILLER                PIC XXX.                      CL*23
  5833         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  5834         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  5835         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  5836         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  5837             20  DC-JULIAN-1-CCYY.                                   CL*15
  5838                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  5839                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  5840             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  5841         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  5842         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  5843             20  DC-JULIAN-2-CCYY.                                   CL*15
  5844                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  5845                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  5846             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  5847         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  5848             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  5849             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  5850             20  DC-EDITA-DAY          PIC 99.                       CL*15
  5851             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  5852             20  DC-EDITA-CCYY.                                      CL*15
  5853                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5854                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  5855         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  5856             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  5857             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  5858             20  DC-EDITB-DAY          PIC 99.                       CL*15
  5859             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  5860             20  DC-EDITB-CCYY.                                      CL*15
  5861                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  5862                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  5863         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  5864         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  5865                              DC-GREG-DATE-CYMD.                  ELCDATE
  5866             20  DC-CYMD-CEN           PIC 99.                       CL*15
  5867             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  5868             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  5869             20  DC-CYMD-DAY           PIC 99.                       CL*15
  5870         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  5871         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  5872                              DC-GREG-DATE-MDCY.                  ELCDATE
  5873             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  5874             20  DC-MDCY-DAY           PIC 99.                       CL*15
  5875             20  DC-MDCY-CEN           PIC 99.                       CL*15
  5876             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  5877    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  5878        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  5879    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  5880    12  FILLER                         PIC X(28).                    CL*26
* 5881                             COPY ELCFUNDT.
  5882***************************************************************** 12/03/98
  5883*                                                               * ELCFUNDT
  5884*                            ELCFUNDT.                          *    LV004
  5885*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  5886*                            VMOD=2.001                         * ELCFUNDT
  5887*                                                               * ELCFUNDT
  5888*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  5889*                                                               * ELCFUNDT
  5890***************************************************************** ELCFUNDT
  5891                                                                  ELCFUNDT
  5892                                                                  ELCFUNDT
  5893 01  FUNCTION-DATE.                                                  CL**2
  5894     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  5895     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  5896         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  5897         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  5898             15  WS-FN-CC          PIC 99.                           CL**3
  5899             15  WS-FN-YR          PIC 99.                           CL**3
  5900         10  WS-FN-MO              PIC 99.                           CL**3
  5901         10  WS-FN-DA              PIC 99.                           CL**3
  5902     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  5903     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  5904     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  5905     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  5906     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  5907         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  5908         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  5909         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  5910     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  5911     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS010D.cbl
  5912
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* ECS010D.cbl
  5914 01  CPA-STARTS-HERE             PIC X(48)
  5915       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 5916                             COPY ELCCALC.
  5917******************************************************************04/15/98
  5918*                                                                *ELCCALC
  5919*                           ELCCALC.                            *    LV003
  5920*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5921*                            VMOD=2.025                          *   CL**3
  5922*                                                                *   CL**2
  5923*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  5924*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  5925*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  5926*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  5927*                                                                *   CL**2
  5928*  PASSED TO ELRTRM                                              *   CL**2
  5929*  -----------------                                             *   CL**2
  5930*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  5931*  ORIGINAL TERM                                                 *   CL**2
  5932*  BEGINNING DATE                                                *   CL**2
  5933*  ENDING DATE                                                   *   CL**2
  5934*  COMPANY I.D.                                                  *   CL**2
  5935*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  5936*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  5937*  FREE LOOK DAYS                                                *   CL**2
  5938*                                                                *   CL**2
  5939*  RETURNED FROM ELRTRM                                          *   CL**2
  5940*  ---------------------                                         *   CL**2
  5941*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  5942*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  5943*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  5944*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  5945*----------------------------------------------------------------*   CL**2
  5946*  PASSED TO ELRAMT                                              *   CL**2
  5947*  ----------------                                              *   CL**2
  5948*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  5949*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5950*  ORIGINAL AMOUNT                                               *   CL**2
  5951*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  5952*  A.P.R. - NET PAY ONLY                                         *   CL**2
  5953*  METHOD                                                            CL**2
  5954*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  5955*  COMPANY I.D.                                                  *   CL**2
  5956*  BENEFIT TYPE                                                  *   CL**2
  5957*                                                                *   CL**2
  5958*  RETURNED FROM ELRAMT                                          *   CL**2
  5959*  --------------------                                          *   CL**2
  5960*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  5961*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  5962*  REMAINING AMOUNT FACTOR                                           CL**2
  5963*----------------------------------------------------------------*   CL**2
  5964*  PASSED TO ELRESV                                              *   CL**2
  5965*  -----------------                                             *   CL**2
  5966*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  5967*  VALUATION DATE                                                *   CL**2
  5968*  PAID THRU DATE                                                *   CL**2
  5969*  BENEFIT                                                       *   CL**2
  5970*  INCURRED DATE                                                 *   CL**2
  5971*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5972*  ISSUE AGE                                                     *   CL**2
  5973*  TERM                                                          *   CL**2
  5974*  CDT PERCENT                                                   *   CL**2
  5975*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  5976* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  5977* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  5978* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  5979*                                                                *   CL**2
  5980*  RETURNED FROM ELRESV                                          *   CL**2
  5981*  --------------------                                          *   CL**2
  5982*  CDT TABLE USED                                                *   CL**2
  5983*  CDT FACTOR USED                                               *   CL**2
  5984*  PAY TO CURRENT RESERVE                                        *   CL**2
  5985*  I.B.N.R. - A/H ONLY                                           *   CL**2
  5986*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  5987*----------------------------------------------------------------*   CL**2
  5988*  PASSED TO ELRATE                                              *   CL**2
  5989*  ----------------                                              *   CL**2
  5990*  CERT ISSUE DATE                                               *   CL**2
  5991*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5992*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  5993*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  5994*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  5995*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  5996*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  5997*  DEVIATION CODE                                                *   CL**2
  5998*  ISSUE AGE                                                     *   CL**2
  5999*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6000*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6001*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  6002*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6003*  A.P.R.                                                        *   CL**2
  6004*  METHOD                                                            CL**2
  6005*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6006*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6007*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6008*  BENEFIT CODE                                                  *   CL**2
  6009*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6010*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  6011*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  6012*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  6013*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6014*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6015*                                                                *   CL**2
  6016*  RETURNED FROM ELRATE                                          *   CL**2
  6017*  --------------------                                          *   CL**2
  6018*  CALCULATED PREMIUM                                            *   CL**2
  6019*  PREMIUM RATE                                                  *   CL**2
  6020*  MORTALITY CODE                                                *   CL**2
  6021*  MAX ATTAINED AGE                                              *   CL**2
  6022*  MAX AGE                                                       *   CL**2
  6023*  MAX TERM                                                      *   CL**2
  6024*  MAX MONTHLY BENEFIT                                           *   CL**2
  6025*  MAX TOTAL BENIFIT                                             *   CL**2
  6026*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6027*----------------------------------------------------------------*   CL**2
  6028*  PASSED TO ELRFND                                              *   CL**2
  6029*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6030*  CERT ISSUE DATE                                               *   CL**2
  6031*  REFUND DATE                                                   *   CL**2
  6032*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6033*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6034*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6035*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6036*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6037*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6038*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6039*  DEVIATION CODE                                                *   CL**2
  6040*  ISSUE AGE                                                     *   CL**2
  6041*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6042*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6043*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6044*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6045*  A.P.R.                                                        *   CL**2
  6046*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6047*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6048*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6049*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6050*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6051*  BENEFIT CODE                                                  *   CL**2
  6052*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6053*                                                                *   CL**2
  6054*  RETURNED FROM ELRFND                                          *   CL**2
  6055*  --------------------                                          *   CL**2
  6056*  CALCULATED REFUND                                             *   CL**2
  6057*----------------------------------------------------------------*   CL**2
  6058*  PASSED TO ELEARN                                              *   CL**2
  6059*  ----------------                                              *   CL**2
  6060*  CERT ISSUE DATE                                               *   CL**2
  6061*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6062*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6063*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6064*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6065*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6066*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6067*  DEVIATION CODE                                                *   CL**2
  6068*  ISSUE AGE                                                     *   CL**2
  6069*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6070*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6071*  A.P.R.                                                        *   CL**2
  6072*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6073*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6074*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6075*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6076*  BENEFIT CODE                                                  *   CL**2
  6077*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6078*                                                                *   CL**2
  6079*  RETURNED FROM ELEARN                                          *   CL**2
  6080*  --------------------                                          *   CL**2
  6081*  INDICATED  EARNINGS                                           *   CL**2
  6082*----------------------------------------------------------------*   CL**2
  6083*                 LENGTH = 450                                   *   CL**2
  6084*                                                                *   CL**2
  6085******************************************************************   CL**2
  6086******************************************************************
  6087*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6088*
  6089* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6090*-----------------------------------------------------------------
  6091*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6092* EFFECTIVE    NUMBER
  6093*-----------------------------------------------------------------
  6094* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6095* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6096* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6097* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6098* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6099* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6100* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6101* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6102* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6103* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  6104******************************************************************
  6105                                                                     CL**2
  6106 01  CALCULATION-PASS-AREA.                                          CL**2
  6107     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6108                                     COMP.                           CL**2
  6109                                                                     CL**2
  6110     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6111       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6112       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6113                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6114       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6115       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6116       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6117       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6118       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6119       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6120       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6121       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6122       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6123       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6124       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6125       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6126       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6127       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6128       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6129       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6130       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6131                                                                     CL**2
  6132     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6133       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6134***********************  INPUT AREAS ****************************    CL**2
  6135                                                                     CL**2
  6136     12  CP-CALCULATION-AREA.                                        CL**2
  6137         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6138         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6139         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6140         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6141         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6142           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6143                                                   'I' 'U'.          CL**2
  6144           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6145           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6146         16  CP-INCURRED-DT        PIC XX.                           CL**2
  6147         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6148         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6149         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6150         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6151                                     COMP-3.                         CL**2
  6152         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6153                                     COMP-3.                         CL**2
  6154         16  CP-CDT-METHOD         PIC X.                            CL**2
  6155           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6156           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6157           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6158         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6159           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6160           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6161         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6162                                     COMP-3.                         CL**2
  6163         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6164                                     COMP-3.                         CL**2
  6165         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6166                                     COMP-3.                         CL**2
  6167         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6168                                     COMP-3.                         CL**2
  6169         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6170                                     COMP-3.                         CL**2
  6171         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6172                                     COMP-3.                         CL**2
  6173         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6174                                     COMP-3.                         CL**2
  6175         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6176           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6177           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6178           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6179           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6180           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6181           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6182           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6183         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6184           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6185           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6186           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6187           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6188           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6189           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6190           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6191           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6192           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6193           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6194           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6195           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6196           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6197           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6198         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6199           88  CP-CLAIM                            VALUE '1'.        CL**2
  6200           88  CP-CANCEL                           VALUE '2'.        CL**2
  6201           88  CP-ISSUE                            VALUE '3'.        CL**2
  6202         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6203           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6204           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  6205           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6206           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6207           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6208           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6209           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6210           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6211           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6212           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6213           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6214           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6215           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6216           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6217           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6218           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6219           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6220           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6221                                                     'W' 'X'.        CL**2
  6222           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6223           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6224           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6225           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6226           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6227           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6228           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6229           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6230           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6231           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6232           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6233           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6234           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6235                                                                     CL**2
  6236         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6237                                     COMP-3.                         CL**2
  6238         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6239         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6240         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6241         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6242         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6243           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6244               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6245         16  CP-R78-OPTION         PIC X.                            CL**2
  6246           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6247           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6248                                                                     CL**2
  6249         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6250         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6251         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6252         16  CP-RATE-FILE          PIC X.                            CL**2
  6253         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6254                                     COMP-3.                         CL**2
  6255                                                                     CL**2
  6256         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6257         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6258                                                                     CL**2
  6259         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6260                                     COMP-3.
  6261         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6262                                   PIC S9(5)V99 COMP-3.
  6263         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6264                                     COMP-3.                         CL**2
  6265         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6266                                     COMP-3.                         CL**2
  6267         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6268                                     COMP-3.
  6269         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6270                                  PIC S9(7)V99 COMP-3.
  6271                                                                     CL**2
  6272         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6273         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6274         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6275           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6276           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6277           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6278           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6279         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6280         16  CP-CARRIER            PIC X.                            CL**2
  6281         16  CP-REIN-FLAG          PIC X.                            CL**2
  6282         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6283           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6284                      '2' '3' '4' '5'.                               CL**2
  6285           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6286           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6287           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6288           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6289           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6290           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6291           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6292           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6293         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6294         16  CP-RATING-METHOD      PIC X.                            CL**2
  6295           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6296           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6297           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6298           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6299           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6300           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6301           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6302           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6303           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6304         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6305                                     COMP-3.                         CL**2
  6306         16  CP-BEN-CATEGORY       PIC X.
  6307         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6308         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6309                                   PIC S99V9(5) COMP-3.
  6310         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6311         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6312                                   PIC S99V9(5) COMP-3.
  6313         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6314         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6315         16  CP-EXPIRE-DT          PIC XX.
  6316         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6317         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6318         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6319         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6320         16  CP-DDF-SPEC-CALC      PIC X.
  6321             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6322             88  CP-CALC-CLP              VALUE 'C'.
  6323         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6324         16  CP-CANCEL-REASON      PIC X.
  6325         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6326         16  CP-PMT-MODE           PIC X.
  6327         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6328         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6329         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6330         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6331         16  FILLER                PIC X.
  6332                                                                     CL**2
  6333***************    OUTPUT FROM ELRESV   ************************     CL**2
  6334                                                                     CL**2
  6335         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6336                                                                     CL**2
  6337         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6338                                     COMP-3.                         CL**2
  6339         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6340                                     COMP-3.                         CL**2
  6341         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6342                                     COMP-3.                         CL**2
  6343         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6344                                     COMP-3.                         CL**2
  6345         16  FILLER                PIC X(09).                        CL**2
  6346***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6347                                                                     CL**2
  6348         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6349                                     COMP-3.                         CL**2
  6350         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6351                                     COMP-3.                         CL**2
  6352         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6353                                     COMP-3.                         CL**2
  6354         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6355                                     COMP-3.                         CL**2
  6356         16  FILLER                PIC X(12).                        CL**2
  6357                                                                     CL**2
  6358***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6359                                                                     CL**2
  6360         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6361                                     COMP-3.                         CL**2
  6362         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6363                                     COMP-3.                         CL**2
  6364         16  FILLER                PIC X(12).                        CL**2
  6365                                                                     CL**2
  6366***************    OUTPUT FROM ELRATE   *************************    CL**2
  6367                                                                     CL**2
  6368         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6369                                     COMP-3.                         CL**2
  6370         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6371                                     COMP-3.                         CL**2
  6372         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6373         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6374             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6375         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6376                                     COMP-3.                         CL**2
  6377         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6378         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  6379         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6380                                   PIC S9(7)V99 COMP-3.
  6381         16  FILLER                PIC X(07).                        CL**2
  6382                                                                     CL**2
  6383***************    OUTPUT FROM ELRFND   *************************    CL**2
  6384                                                                     CL**2
  6385         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6386                                     COMP-3.                         CL**2
  6387         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6388           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6389           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6390           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6391           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6392           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6393           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6394           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6395           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6396           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6397           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6398           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6399           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6400           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6401           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6402         16  FILLER                PIC X(12).                        CL**2
  6403                                                                     CL**2
  6404***************    OUTPUT FROM ELEARN   *************************    CL**2
  6405                                                                     CL**2
  6406         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6407                                     COMP-3.                         CL**2
  6408         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6409                                     COMP-3.                         CL**2
  6410         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6411                                     COMP-3.                         CL**2
  6412         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6413                                     COMP-3.                         CL**2
  6414         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6415                                     COMP-3.                         CL**2
  6416         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6417                                     COMP-3.                         CL**2
  6418         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6419           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6420           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6421           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6422           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6423           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6424           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6425           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6426           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6427           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6428         16  FILLER                PIC X(12).                        CL**2
  6429                                                                     CL**2
  6430***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6431                                                                     CL**2
  6432         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6433                                     COMP-3.                         CL**2
  6434         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6435                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6436         16  FILLER                PIC X(12).                        CL**2
  6437                                                                     CL**2
  6438***************   MISC WORK AREAS    *****************************   CL**2
  6439         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6440                                     COMP-3.                         CL**2
  6441         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6442                                     COMP-3.                         CL**2
  6443         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6444                                     COMP-3.                         CL**2
  6445         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6446                                     COMP-3.                         CL**2
  6447         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6448                                     COMP-3.                         CL**2
  6449         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6450                                     COMP-3.                         CL**2
  6451         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6452             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6453             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6454             88  IO-ERROR                         VALUE 'E'.         CL**2
  6455                                                                     CL**2
  6456         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6457                                                                     CL**2
  6458         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6459                                                                     CL**2
  6460         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6461                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6462                                     COMP-3.                         CL**2
  6463                                                                     CL**2
  6464         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6465                                                                     CL**2
  6466         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6467                                     COMP-3.                         CL**2
  6468                                                                     CL**2
  6469         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6470                                     COMP-3.                         CL**2
  6471                                                                     CL**2
  6472         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6473                                     COMP-3.                         CL**2
  6474                                                                     CL**2
  6475         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6476                                     COMP-3.                         CL**2
  6477                                                                     CL**2
  6478         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6479                                     COMP-3.                         CL**2
  6480                                                                     CL**2
  6481         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6482                                     COMP-3.                         CL**2
  6483                                                                     CL**2
  6484         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6485                                     COMP-3.                         CL**2
  6486                                                                     CL**2
  6487         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6488             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6489                                                                     CL**2
  6490         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6491                                     COMP-3.                         CL**2
  6492         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6493                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 127
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6494         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  6495         16  cp-extra-periods      pic 9 value zeros.
  6496         16  cp-net-only-state     pic x value spaces.
  6497         16  FILLER                PIC X(13).                        CL**2
  6498******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 128
* ECS010D.cbl
* 6500                             COPY ELCDTECX.
  6501******************************************************************06/05/98
  6502*                                                                *ELCDTECX
  6503*                            ELCDTECX.                           *   LV005
  6504*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6505*                            VMOD=2.015                          *ELCDTECX
  6506*                                                                *ELCDTECX
  6507*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6508*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6509*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6510*                                                                *ELCDTECX
  6511******************************************************************ELCDTECX
  6512******************************************************************
  6513*                   C H A N G E   L O G
  6514*
  6515* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6516*-----------------------------------------------------------------
  6517*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6518* EFFECTIVE    NUMBER
  6519*-----------------------------------------------------------------
  6520* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6521*                                  BENEFIT CODES FROM 300 TO 900
  6522* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6523* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6524* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  6525******************************************************************
  6526 01  DATE-CARD.                                                   ELCDTECX
  6527     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6528     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6529     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6530     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6531     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6532     12  EP-SW                       PIC  X.                      ELCDTECX
  6533         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6534     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6535         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6536     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6537     12  RUN-CENTURY.                                             ELCDTECX
  6538         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6539     12  FILLER                      PIC  X.                         CL**4
  6540     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6541     12  FILLER                      PIC  XXX.                    ELCDTECX
  6542     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6543                                                                  ELCDTECX
  6544 01  FILLER                          PIC  X(7)                       CL**6
  6545                                          VALUE 'OPTIONS'.        ELCDTECX
  6546 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6547     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6548     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6549     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6550         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6551         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6552     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6553     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6554     12  FILLER                      PIC  X.                      ELCDTECX
  6555     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6556     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6557     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 129
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6558     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  6559     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6560     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6561     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6562     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6563     12  FILLER                      PIC  X.                      ELCDTECX
  6564     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6565     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6566     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6567     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6568     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6569     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6570     12  FILLER                      PIC  X.                      ELCDTECX
  6571     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6572     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6573     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6574     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6575     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6576     12  DTE-R78                     PIC  X.                      ELCDTECX
  6577     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6578     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6579     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  6580     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  6581     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  6582     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  6583     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  6584                                     PIC  X.                      ELCDTECX
  6585         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  6586                                                 ' '.             ELCDTECX
  6587         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  6588         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  6589     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  6590         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  6591         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  6592     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  6593     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  6594                                     PIC  9.                         CL**4
  6595     12  DTE-SYSTEM.                                              ELCDTECX
  6596         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  6597         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  6598         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  6599         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  6600         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  6601         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  6602         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  6603         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  6604         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  6605         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  6606         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  6607         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  6608         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  6609         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  6610         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  6611         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  6612         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  6613         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  6614         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  6615         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 130
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6616         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  6617         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  6618         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  6619         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  6620         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  6621         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  6622     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  6623         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  6624                                     PIC  X.                      ELCDTECX
  6625     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  6626                                                                  ELCDTECX
  6627 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  6628     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  6629     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  6630     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  6631*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  6632     12  FILLER                      PIC  X.                      ELCDTECX
  6633     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  6634     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  6635     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  6636     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  6637     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  6638     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  6639     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  6640                                                                  ELCDTECX
  6641     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  6642     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  6643     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  6644     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  6645                                                                  ELCDTECX
  6646     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  6647     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  6648     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  6649     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  6650                                                                  ELCDTECX
  6651     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  6652     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  6653                                                                  ELCDTECX
  6654     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  6655     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  6656                                                                  ELCDTECX
  6657     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  6658                                                                  ELCDTECX
  6659 01  DATE-CARD-FACTORS.                                           ELCDTECX
  6660     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  6661     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  6662     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  6663     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  6664     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  6665     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  6666     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  6667                                                                  ELCDTECX
  6668 01  FILLER                          PIC  X(12)                   ELCDTECX
  6669                                          VALUE 'COMPANY NAME'.   ELCDTECX
  6670 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  6671     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  6672         16  CNT-ID                  PIC  X.                      ELCDTECX
  6673         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 131
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6674                                                                  ELCDTECX
  6675 01  FILLER                          PIC  X(11)                   ELCDTECX
  6676                                          VALUE 'STATE NAMES'.    ELCDTECX
  6677 01  STATE-NAMES.                                                 ELCDTECX
  6678     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  6679         16  STATE-SUB               PIC  XX.                     ELCDTECX
  6680         16  STATE-PIC1.                                          ELCDTECX
  6681             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  6682             20  FILLER              PIC  XXX.                    ELCDTECX
  6683             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  6684             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  6685             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  6686             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  6687                                                                  ELCDTECX
  6688 01  FILLER                          PIC  X(13)                   ELCDTECX
  6689                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  6690 01  CARRIER-NAMES.                                               ELCDTECX
  6691     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  6692         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  6693         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  6694         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  6695         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6696         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6697         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6698*        16  FILLER                  PIC  X.                      ELCDTECX
  6699         16  CARRIER-SEC-PAY         PIC  X.
  6700             88  SEC-PAY-CARRIER          VALUE 'Y'.
  6701                                                                  ELCDTECX
  6702 01  FILLER                          PIC  X(9)                       CL**6
  6703                                          VALUE 'INS TYPES'.      ELCDTECX
  6704 01  CLAS-INS-TYPES.                                              ELCDTECX
  6705*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  6706     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  6707         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  6708         16  CLAS-I-AB3.                                          ELCDTECX
  6709             20  FILLER              PIC  X.                      ELCDTECX
  6710             20  CLAS-I-AB2.                                      ELCDTECX
  6711                 24  FILLER          PIC  X.                      ELCDTECX
  6712                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  6713         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  6714             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  6715             20  FILLER              PIC  X.                         CL**4
  6716         16  CLAS-I-AB10.                                         ELCDTECX
  6717             20  FILLER              PIC  X(9).                   ELCDTECX
  6718             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  6719         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  6720         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  6721         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  6722         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  6723             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  6724         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  6725         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  6726         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  6727         16  CLAS-I-BEN-CATEGORY     PIC  X.
  6728         16  CLAS-I-REFUND-METHOD    PIC  X.
  6729         16  CLAS-I-MAX-BENEFITS     PIC 99.
  6730         16  FILLER                  PIC  XXX.
  6731                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 132
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6732 01  FILLER                          PIC  X(16)                   ELCDTECX
  6733                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  6734 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  6735     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  6736                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  6737         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  6738         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  6739         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  6740         16  CLAS-MORT-DESC.                                      ELCDTECX
  6741             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  6742             20  FILLER              PIC  XX.                        CL**5
  6743             20  CLAS-YEAR           PIC  X(4).                      CL**6
  6744             20  FILLER              PIC  X.                         CL**5
  6745             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  6746             20  FILLER              PIC  X.                         CL**5
  6747             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  6748             20  FILLER              PIC  X.                         CL**5
  6749             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  6750             20  FILLER              PIC  X(5).                      CL**6
  6751                                                                  ELCDTECX
  6752 01  FILLER                          PIC  X(15)                   ELCDTECX
  6753                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  6754 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  6755     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  6756         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  6757         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  6758         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  6759         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  6760         16  FILLER                  PIC  X(4).                      CL**6
  6761                                                                  ELCDTECX
  6762 01  FILLER                          PIC  X(7)                       CL**6
  6763                                     VALUE 'INDEXES'.             ELCDTECX
  6764 01  CLAS-INDEX-TBL.                                              ELCDTECX
  6765     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  6766     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  6767     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  6768     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  6769     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  6770     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  6771     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  6772     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  6773     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  6774     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  6775     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  6776     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  6777     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  6778     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  6779     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  6780     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  6781     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  6782                                                                  ELCDTECX
  6783 01  CLAS-TYPE-MISC.                                              ELCDTECX
  6784     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  6785     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  6786     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  6787     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  6788     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  6789     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 133
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6790     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  6791     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  6792     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  6793     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  6794     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  6795                                                                  ELCDTECX
  6796 01  FILLER                          PIC  X(13)                   ELCDTECX
  6797                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  6798 01  CLAS-MISC.                                                   ELCDTECX
  6799     12  DTE-FICH                    PIC  X.                      ELCDTECX
  6800         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  6801         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  6802         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  6803     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  6804     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  6805     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  6806     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  6807     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  6808     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  6809     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  6810     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  6811     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  6812     12  STATE-L                     PIC  XX.                     ELCDTECX
  6813     12  CLAS-CN                     PIC  99.                     ELCDTECX
  6814     12  CLAS-CO                     PIC  99.                     ELCDTECX
  6815     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  6816         16  DTE-F-1                 PIC  X.                      ELCDTECX
  6817         16  DTE-F-2                 PIC  X.                      ELCDTECX
  6818     12  DTE-ABEND-WORK.                                          ELCDTECX
  6819         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  6820         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  6821                                                                  ELCDTECX
  6822 01  FILLER                          PIC  X(12)                   ELCDTECX
  6823                                     VALUE 'WORKING DATE'.        ELCDTECX
  6824 01  WS-DATE-AND-TIME.                                            ELCDTECX
  6825     12  WS-ACCEPT-DATE.                                          ELCDTECX
  6826         16  WS-AD-YY                PIC  99.                     ELCDTECX
  6827         16  WS-AD-MM                PIC  99.                     ELCDTECX
  6828         16  WS-AD-DD                PIC  99.                     ELCDTECX
  6829     12  WS-CURRENT-DATE.                                         ELCDTECX
  6830         16  WS-CD-MM                PIC  99.                     ELCDTECX
  6831         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  6832         16  WS-CD-DD                PIC  99.                     ELCDTECX
  6833         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  6834         16  WS-CD-YY                PIC  99.                     ELCDTECX
  6835     12  WS-TIME-OF-DAY.                                          ELCDTECX
  6836         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  6837         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  6838                                                                  ELCDTECX
  6839 01  FILLER                          PIC  X(12)                   ELCDTECX
  6840                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  6841 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  6842     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  6843         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  6844         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  6845         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  6846                                                                  ELCDTECX
  6847 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 134
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6848                                     VALUE 'STATE TLRS'.          ELCDTECX
  6849 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  6850     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  6851         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  6852         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  6853                                                                  ELCDTECX
  6854 01  FILLER                          PIC  X(13)                   ELCDTECX
  6855                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  6856 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  6857     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  6858         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  6859                                                                  ELCDTECX
  6860 01  FILLER                          PIC  X(13)                   ELCDTECX
  6861                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  6862 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  6863     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  6864     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  6865     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  6866                                     PIC  X.                         CL**5
  6867     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  6868     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  6869     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  6870     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  6871     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  6872     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  6873     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  6874     12  FILLER                      PIC  X(75).                  ELCDTECX
  6875******************************************************************ELCDTECX
  6876*01  MISC-CARR-PCT-DATA.                                          00001521
  6877*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  6878*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  6879*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  6880*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  6881*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  6882*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  6883******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 135
* ECS010D.cbl
* 6885                             COPY ELCDTEVR.
  6886***************************************************************** 04/15/98
  6887*                                                                *ELCDTEVR
  6888*                                                                *ELCDTEVR
  6889*                            ELCDTEVR.                           *   LV003
  6890*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6891*                            VMOD=2.001                          *   CL**2
  6892*                                                                *ELCDTEVR
  6893*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  6894*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  6895*                                                                *ELCDTEVR
  6896******************************************************************ELCDTEVR
  6897 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  6898     05  WS-RUN-DATE.                                             ELCDTEVR
  6899         10  FILLER                  PIC  9(03).                  ELCDTEVR
  6900         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  6901         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  6902             15  RUN-CC              PIC  99.                     ELCDTEVR
  6903             15  RUN-YR              PIC  99.                     ELCDTEVR
  6904         10  RUN-MO                  PIC  99.                     ELCDTEVR
  6905         10  RUN-DA                  PIC  99.                     ELCDTEVR
  6906     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  6907            WS-RUN-DATE              PIC 9(11).                      CL**2
  6908     05  WS-EP-DT.                                                ELCDTEVR
  6909         10  FILLER                  PIC  9(03).                  ELCDTEVR
  6910         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  6911         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  6912             15  EP-CC               PIC  99.                     ELCDTEVR
  6913             15  EP-YR               PIC  99.                     ELCDTEVR
  6914         10  EP-MO                   PIC  99.                     ELCDTEVR
  6915         10  EP-DA                   PIC  99.                     ELCDTEVR
  6916     05  WS-EP-DT-N REDEFINES                                        CL**2
  6917            WS-EP-DT                 PIC 9(11).                      CL**2
  6918     05  WS-DTE-CONV-DT.                                             CL**4
  6919         10  FILLER                  PIC  9(03).                     CL**4
  6920         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  6921         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  6922             15  DTE-CONV-CC         PIC  99.                        CL**4
  6923             15  DTE-CONV-YR         PIC  99.                        CL**4
  6924         10  DTE-CONV-MO             PIC  99.                        CL**4
  6925         10  DTE-CONV-DA             PIC  99.                        CL**4
  6926     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  6927            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  6928 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  6929     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  6930         10  FILLER                            PIC 999.           ELCDTEVR
  6931         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  6932         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  6933             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  6934             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  6935         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  6936         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  6937     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  6938            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  6939     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  6940         10  FILLER                            PIC 999.           ELCDTEVR
  6941         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  6942         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 136
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  6943         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  6944         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  6945     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  6946            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  6947 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  6948     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  6949         10  FILLER                            PIC 999.           ELCDTEVR
  6950         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  6951         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  6952             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  6953             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  6954         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  6955         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  6956     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  6957            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  6958     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  6959         10  FILLER                            PIC 999.           ELCDTEVR
  6960         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  6961         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  6962             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  6963             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  6964         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  6965         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  6966     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  6967            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  6968     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  6969         10  FILLER                            PIC 999.           ELCDTEVR
  6970         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  6971         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  6972             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  6973             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  6974         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  6975         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  6976     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  6977            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  6978 01  WS-RATE-RECORD.                                              ELCDTEVR
  6979         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  6980             10  FILLER                        PIC 999.           ELCDTEVR
  6981             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  6982             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  6983                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  6984                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  6985             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  6986             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  6987         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  6988                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 137
* ECS010D.cbl
* 6990                             COPY ELCACCTV.
  6991******************************************************************04/14/98
  6992*                                                                *ELCACCTV
  6993*                            ELCACCTV                            *   LV002
  6994*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6995*                            VMOD=2.001                          *ELCACCTV
  6996*                                                                *ELCACCTV
  6997*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  6998*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  6999*                                                                *ELCACCTV
  7000*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  7001*                                                                *ELCACCTV
  7002******************************************************************ELCACCTV
  7003                                                                  ELCACCTV
  7004 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  7005                                                                  ELCACCTV
  7006     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  7007         10  FILLER            PIC 999.                           ELCACCTV
  7008         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  7009         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  7010             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  7011             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  7012         10  AM-EXP-MO         PIC 99.                               CL**5
  7013         10  AM-EXP-DA         PIC 99.                               CL**5
  7014     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7015            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7016     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7017         10  FILLER                    PIC 999.                   ELCACCTV
  7018         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7019         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7020             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7021             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7022         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7023         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7024     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7025            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7026     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7027         10  FILLER                    PIC 999.                   ELCACCTV
  7028         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7029         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7030             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7031             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7032         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7033         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7034     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7035            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7036     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7037         10 FILLER                     PIC 999.                   ELCACCTV
  7038         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7039         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7040            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7041            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7042         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7043         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7044     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7045            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7046     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7047         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 138
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7048         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7049         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7050            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7051            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7052         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7053         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7054     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7055            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7056     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7057         10  FILLER                    PIC 999.                   ELCACCTV
  7058         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7059         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7060             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7061             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7062         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7063         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7064     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7065            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7066     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7067         10  FILLER                    PIC 999.                   ELCACCTV
  7068         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7069         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7070             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7071             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7072         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7073         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7074     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7075            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7076     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7077         10  FILLER                    PIC 999.                   ELCACCTV
  7078         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7079         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7080             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7081             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7082         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7083         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7084     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7085            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7086     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7087         10  FILLER                    PIC 999.                   ELCACCTV
  7088         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7089         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7090             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7091             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7092         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7093         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7094     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7095            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 139
* ECS010D.cbl
* 7097                             COPY ELCEXTVR.
  7098******************************************************************04/15/98
  7099*                                                                *ELCEXTVR
  7100*                                                                *ELCEXTVR
  7101*                             ELCEXTVR                           *   LV002
  7102*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7103*                            VMOD=2.001                          *ELCEXTVR
  7104*                                                                *ELCEXTVR
  7105*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7106*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7107*                                                                *ELCEXTVR
  7108******************************************************************ELCEXTVR
  7109 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7110     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7111         10  FILLER              PIC 999.                         ELCEXTVR
  7112         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7113         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7114             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7115             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7116         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7117         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7118     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7119            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7120 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7121     05  WS-DE-EFF.                                               ELCEXTVR
  7122         10  FILLER              PIC 999.                         ELCEXTVR
  7123         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7124         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7125             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7126             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7127         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7128         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7129     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7130            WS-DE-EFF            PIC 9(11).                          CL**2
  7131     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7132         10  FILLER              PIC 999.                         ELCEXTVR
  7133         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7134         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7135             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7136             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7137         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7138         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7139     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7140            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7141     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7142         10  FILLER                 PIC 999.                      ELCEXTVR
  7143         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7144         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7145             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7146             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7147         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7148         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7149     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7150            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7151     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7152         10  FILLER                 PIC 999.                      ELCEXTVR
  7153         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7154         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 140
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7155             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7156             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7157         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7158         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7159     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7160            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7161     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7162         10  FILLER                 PIC 999.                      ELCEXTVR
  7163         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7164         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7165             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7166             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7167         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7168         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7169     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7170            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7171     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7172         10  FILLER                 PIC 999.                      ELCEXTVR
  7173         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7174         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7175             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7176             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7177         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7178         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7179     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7180            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7181     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7182         10  FILLER                 PIC 999.                      ELCEXTVR
  7183         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7184         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7185             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7186             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7187         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7188         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7189     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7190            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7191     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7192         10  FILLER                 PIC 999.                         CL**5
  7193         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7194         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7195             15  DE-CP-CC           PIC 99.                          CL**5
  7196             15  DE-CP-YR           PIC 99.                          CL**5
  7197         10  DE-CP-MO               PIC 99.                          CL**5
  7198         10  DE-CP-DA               PIC 99.                          CL**5
  7199     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7200            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7201     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7202         10  FILLER                 PIC 999.                         CL**5
  7203         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7204         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7205             15  DE-RP-CC           PIC 99.                          CL**5
  7206             15  DE-RP-YR           PIC 99.                          CL**5
  7207         10  DE-RP-MO                      PIC 99.                   CL**5
  7208         10  DE-RP-DA                      PIC 99.                   CL**5
  7209     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7210            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7211     05  WS-DE-INCUR.                                             ELCEXTVR
  7212         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 141
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7213         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7214         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7215             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7216             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7217         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7218         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7219     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7220            WS-DE-INCUR             PIC 9(11).                       CL**2
  7221     05  WS-DE-PAY.                                               ELCEXTVR
  7222         10  FILLER                 PIC 999.                      ELCEXTVR
  7223         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7224         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7225             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7226             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7227         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7228         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7229     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7230            WS-DE-PAY               PIC 9(11).                       CL**2
  7231     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7232         10  FILLER                 PIC 999.                      ELCEXTVR
  7233         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7234         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7235             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7236             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7237         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7238         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7239     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7240            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7241     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7242         10 FILLER                  PIC 999.                      ELCEXTVR
  7243         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7244         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7245            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7246            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7247         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7248         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7249     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7250            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7251     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7252         10 FILLER                  PIC 999.                      ELCEXTVR
  7253         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7254         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7255            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7256            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7257         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7258         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7259     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7260            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7261     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7262         10  FILLER                 PIC 999.                      ELCEXTVR
  7263         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7264         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7265             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7266             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7267         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7268         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7269     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7270            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 142
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7271     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7272         10  FILLER                 PIC 999.                      ELCEXTVR
  7273         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7274         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7275             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7276             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7277         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7278         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7279     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7280            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7281     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7282         10  FILLER                        PIC 999.               ELCEXTVR
  7283         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7284         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7285                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7286             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7287             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7288         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7289         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7290     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7291            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7292     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7293         10  FILLER                        PIC 999.               ELCEXTVR
  7294         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7295         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7296                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7297             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7298             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7299         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7300         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7301     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7302            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7303                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 143
* ECS010D.cbl
  7305 PROCEDURE DIVISION.
  7306
  7307 0000-START.
  7308
  7309******************************************************************
  7310***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7311******************************************************************
  7312
  7313*0003-LOAD-DATE-CARD.
* 7314                             COPY ELCDTERX.
  7315******************************************************************04/15/98
  7316*                                                                *ELCDTERX
  7317*                                                                *ELCDTERX
  7318*                            ELCDTERX.                           *   LV002
  7319*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7320*                            VMOD=2.007                          *ELCDTERX
  7321*                                                                *ELCDTERX
  7322*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7323*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7324*      = ELCDTEFD)                                               *ELCDTERX
  7325*                                                                *ELCDTERX
  7326******************************************************************ELCDTERX
  7327                                                                  ELCDTERX
  7328     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7329                                                                  ELCDTERX
  7330     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7331     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7332     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7333                                                                  ELCDTERX
  7334     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7335                                                                  ELCDTERX
  7336******************************************************************ELCDTERX
  7337*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7338*          WARNING MESSAGES.                                      ELCDTERX
  7339******************************************************************ELCDTERX
  7340     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7341         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7342                                                                  ELCDTERX
  7343     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7344                                                                  ELCDTERX
  7345     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7346                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7347                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7348                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7349                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7350                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7351                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7352                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7353                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7354                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7355                                                                  ELCDTERX
  7356     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7357                                                                  ELCDTERX
  7358     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7359                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7360                                                                  ELCDTERX
  7361     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7362     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 144
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7363     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7364     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7365                                                                  ELCDTERX
  7366     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7367         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7368     ELSE                                                         ELCDTERX
  7369         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7370                                                                  ELCDTERX
  7371     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7372         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7373     ELSE                                                         ELCDTERX
  7374         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7375                                                                  ELCDTERX
  7376 0005-READ--CARD.                                                 ELCDTERX
  7377     READ DISK-DATE                                               ELCDTERX
  7378         AT END CLOSE DISK-DATE                                   ELCDTERX
  7379             GO TO 0060-READ--TEST.                               ELCDTERX
  7380                                                                  ELCDTERX
  7381     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7382                                                                  ELCDTERX
  7383     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7384         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7385         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7386         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7387         GO TO 0005-READ--CARD.                                   ELCDTERX
  7388                                                                  ELCDTERX
  7389     IF DD-ID = 'CLAD'                                            ELCDTERX
  7390         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7391         GO TO 0005-READ--CARD.                                   ELCDTERX
  7392                                                                  ELCDTERX
  7393     IF DD-ID = 'CLAX'                                            ELCDTERX
  7394         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7395         GO TO 0005-READ--CARD.                                   ELCDTERX
  7396                                                                  ELCDTERX
  7397     IF DD-ID = 'CLAF'                                            ELCDTERX
  7398         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7399         GO TO 0005-READ--CARD.                                   ELCDTERX
  7400                                                                  ELCDTERX
  7401     IF DD-ID = 'CLAC'                                            ELCDTERX
  7402         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7403                                                                  ELCDTERX
  7404     IF DD-ID = 'CARR'                                            ELCDTERX
  7405         GO TO 0015-READ--CARR.                                   ELCDTERX
  7406                                                                  ELCDTERX
  7407     IF DD-ID = 'STAT'                                            ELCDTERX
  7408         GO TO 0020-READ--STAT.                                   ELCDTERX
  7409                                                                  ELCDTERX
  7410     IF DD-ID = 'BUSC'                                            ELCDTERX
  7411         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7412                                                                  ELCDTERX
  7413     IF DD-ID = 'MORT'                                            ELCDTERX
  7414         GO TO 0030-READ--MORT.                                   ELCDTERX
  7415                                                                  ELCDTERX
  7416     IF DD-ID = 'CLAI'                                            ELCDTERX
  7417         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7418                                                                  ELCDTERX
  7419     IF DD-ID = 'COLC'                                            ELCDTERX
  7420         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 145
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7421                                                                  ELCDTERX
  7422     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7423        DD-IDA = 'CL'                                             ELCDTERX
  7424         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7425                                                                  ELCDTERX
  7426     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7427        DD-IDA = 'PO'                                             ELCDTERX
  7428         GO TO 0050-READ--POXX.                                   ELCDTERX
  7429                                                                  ELCDTERX
  7430     IF DD-ID = 'OPCA'                                            ELCDTERX
  7431         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7432                                                                  ELCDTERX
  7433     IF DD-ID = 'OPST'                                            ELCDTERX
  7434         GO TO 0072-READ--OPST.                                   ELCDTERX
  7435                                                                  ELCDTERX
  7436     IF DD-ID = 'OPBS'                                            ELCDTERX
  7437         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7438                                                                  ELCDTERX
  7439     IF DD-ID = 'OPMS'                                            ELCDTERX
  7440         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7441                                                                  ELCDTERX
  7442     GO TO 0005-READ--CARD.                                       ELCDTERX
  7443                                                                  ELCDTERX
  7444 0010-READ--CLAC.                                                 ELCDTERX
  7445     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7446     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7447     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7448     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7449     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7450     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7451     GO TO 0005-READ--CARD.                                       ELCDTERX
  7452                                                                  ELCDTERX
  7453 0015-READ--CARR.                                                 ELCDTERX
  7454     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7455     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7456        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7457        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7458        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7459        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7460        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7461        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7462        MOVE DD-CARR1-SECPAY-SW
  7463                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7464     END-IF
  7465                                                                  ELCDTERX
  7466     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7467     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7468        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7469        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7470        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7471        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7472        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7473        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7474        MOVE DD-CARR2-SECPAY-SW
  7475                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7476     END-IF
  7477                                                                  ELCDTERX
  7478                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 146
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7479     GO TO 0005-READ--CARD.                                       ELCDTERX
  7480                                                                  ELCDTERX
  7481 0020-READ--STAT.                                                 ELCDTERX
  7482     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7483     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7484        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7485         GO TO 0005-READ--CARD.                                   ELCDTERX
  7486                                                                  ELCDTERX
  7487     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7488     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7489     GO TO 0020-READ--STAT.                                       ELCDTERX
  7490                                                                  ELCDTERX
  7491 0025-READ--BUSC.                                                 ELCDTERX
  7492     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7493     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7494        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7495         GO TO 0005-READ--CARD.                                   ELCDTERX
  7496                                                                  ELCDTERX
  7497     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7498     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7499     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7500                                                                  ELCDTERX
  7501 0030-READ--MORT.                                                 ELCDTERX
  7502     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7503     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7504        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7505         GO TO 0005-READ--CARD.                                   ELCDTERX
  7506                                                                  ELCDTERX
  7507     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7508     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7509     GO TO 0030-READ--MORT.                                       ELCDTERX
  7510                                                                  ELCDTERX
  7511 0035-READ--CLXX.                                                 ELCDTERX
  7512     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7513          GO TO 0005-READ--CARD.                                  ELCDTERX
  7514                                                                  ELCDTERX
  7515     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7516         DISPLAY '***********************************************'ELCDTERX
  7517         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7518         DISPLAY '***********************************************'ELCDTERX
  7519         GO TO 0055-READ--STOP.                                   ELCDTERX
  7520                                                                  ELCDTERX
  7521     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7522        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7523         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7524                                                                  ELCDTERX
  7525     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7526        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7527         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7528                                                                  ELCDTERX
  7529*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7530     GO TO 0005-READ--CARD.                                       ELCDTERX
  7531                                                                  ELCDTERX
  7532 0040-READ--CLAI.                                                 ELCDTERX
  7533     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7534     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7535        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7536         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 147
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7537                                                                  ELCDTERX
  7538     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7539     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7540     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7541                                                                  ELCDTERX
  7542 0045-READ--DUMP.                                                 ELCDTERX
  7543     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7544     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7545                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7546     PERFORM ABEND-PGM.                                           ELCDTERX
  7547                                                                  ELCDTERX
  7548 0050-READ--POXX.                                                 ELCDTERX
  7549     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7550         GO TO 0005-READ--CARD.                                   ELCDTERX
  7551                                                                  ELCDTERX
  7552     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7553         DISPLAY '***********************************************'ELCDTERX
  7554         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7555         DISPLAY '***********************************************'ELCDTERX
  7556         GO TO 0055-READ--STOP.                                   ELCDTERX
  7557                                                                  ELCDTERX
  7558     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7559     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7560     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7561     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7562                                                                  ELCDTERX
  7563     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7564         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7565     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7566         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7567                                                                  ELCDTERX
  7568     GO TO 0005-READ--CARD.                                       ELCDTERX
  7569                                                                  ELCDTERX
  7570 0055-READ--STOP.                                                 ELCDTERX
  7571     GOBACK.                                                      ELCDTERX
  7572                                                                  ELCDTERX
  7573 0060-READ--TEST.                                                 ELCDTERX
  7574     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7575        CLAX-ID         = SPACE  OR                               ELCDTERX
  7576        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7577         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7578                                                                  ELCDTERX
  7579     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7580     GO TO 0079-READ--EXIT.                                       ELCDTERX
  7581                                                                  ELCDTERX
  7582 0065-READ--COLC.                                                 ELCDTERX
  7583     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  7584     GO TO 0005-READ--CARD.                                       ELCDTERX
  7585                                                                  ELCDTERX
  7586 0070-READ--OPCA.                                                 ELCDTERX
  7587                                                                  ELCDTERX
  7588     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7589                                                                  ELCDTERX
  7590     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  7591             OR                                                   ELCDTERX
  7592         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  7593         GO TO 0005-READ--CARD.                                   ELCDTERX
  7594                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 148
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7595     ADD 1                       TO INDEXCA.                      ELCDTERX
  7596     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  7597                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  7598     GO TO 0070-READ--OPCA.                                       ELCDTERX
  7599                                                                  ELCDTERX
  7600 0072-READ--OPST.                                                 ELCDTERX
  7601                                                                  ELCDTERX
  7602     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7603                                                                  ELCDTERX
  7604     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  7605             OR                                                   ELCDTERX
  7606         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7607         GO TO 0005-READ--CARD.                                   ELCDTERX
  7608                                                                  ELCDTERX
  7609     ADD 1                       TO INDEXST.                      ELCDTERX
  7610     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  7611                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  7612     GO TO 0072-READ--OPST.                                       ELCDTERX
  7613                                                                  ELCDTERX
  7614 0074-READ--OPBS.                                                 ELCDTERX
  7615                                                                  ELCDTERX
  7616     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7617                                                                  ELCDTERX
  7618     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  7619             OR                                                   ELCDTERX
  7620         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7621         GO TO 0005-READ--CARD.                                   ELCDTERX
  7622                                                                  ELCDTERX
  7623     ADD 1                       TO INDEXBS.                      ELCDTERX
  7624     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  7625     GO TO 0074-READ--OPBS.                                       ELCDTERX
  7626                                                                  ELCDTERX
  7627 0079-READ--EXIT.                                                 ELCDTERX
  7628*    EXIT.                                                        ELCDTERX
  7629******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 149
* ECS010D.cbl
  7631******************************************************************
  7632***           O P E N   F I L E S   R O U T I N E              ***
  7633******************************************************************
  7634
  7635     DISPLAY ' '.
  7636     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  7637         'ECS010 ******'
  7638     DISPLAY ' '.
  7639
  7640     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  7641     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  7642     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  7643     .
  7644 0080-OPEN-FILES.
  7645*    IF DTE-PGM-OPT = '1'
  7646*       open output detail-extr
  7647*    end-if
  7648     OPEN INPUT  PENDING-EXTRACT
  7649                 CERT-MASTER-IN
  7650                 ERACCTT-IN
  7651                 ERAGTC
  7652
  7653          I-O    ERMEBL-INOUT
  7654                 ELCRTT
  7655
  7656          OUTPUT SUMMARY-EXTR
  7657                 ME-ECS010-BALANCE
  7658                 ME50-ECS010-BALANCE
  7659                 DISPLAY-PRT
  7660                 MISMATCH-REPORT
  7661                 PRINT-COPY.
  7662
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 150
* ECS010D.cbl
  7664*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  7665     IF DTE-CLIENT NOT = 'DMD'
  7666         NEXT SENTENCE
  7667     ELSE
  7668         OPEN INPUT ERRESC-IN
  7669            IF ERRESC-FILE-STATUS   = '00' OR '97'
  7670                NEXT SENTENCE
  7671            ELSE
  7672                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  7673                MOVE 'ERROR OPENING ERRESC FILE'
  7674                                        TO WS-ABEND-MESSAGE
  7675                GO TO ABEND-PGM.
  7676*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  7677
  7678     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  7679         NEXT SENTENCE
  7680       ELSE
  7681         MOVE '11'                    TO ABEND-CODE-1
  7682         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  7683         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  7684         GO TO ABEND-PGM.
  7685
  7686     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  7687        CONTINUE
  7688     ELSE
  7689        DISPLAY ' OPEN ERROR ELCRTT '
  7690        MOVE '31'                TO ABEND-CODE-1
  7691        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  7692        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  7693        GO TO ABEND-PGM
  7694     END-IF
  7695
  7696     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  7697        CONTINUE
  7698     ELSE
  7699        DISPLAY ' OPEN ERROR ERAGTC '
  7700        MOVE '41'                TO ABEND-CODE-1
  7701        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  7702        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  7703        GO TO ABEND-PGM
  7704     END-IF
  7705
  7706     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  7707         NEXT SENTENCE
  7708       ELSE
  7709         MOVE 'N'                     TO ME-UPDATE-FLAG.
  7710
  7711     IF DTE-PGM-OPT = '1'
  7712         OPEN OUTPUT  CERT-MASTER-OUT
  7713                      DETAIL-EXTR
  7714     ELSE
  7715         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  7716         MOVE '*'                     TO TRANS-EOF-FLAG.
  7717
  7718     MOVE 'R'                         TO CP-RATE-FILE.
  7719     MOVE 'O'                         TO CP-IO-FUNCTION.
  7720     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  7721     IF IO-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 151
* ECS010D.cbl
  7722         MOVE 'ERROR OCCURED OPENING - ELRATE'
  7723                                      TO WS-ABEND-MESSAGE
  7724         MOVE 0302                    TO WS-RETURN-CODE
  7725         GO TO ABEND-PGM.
  7726
  7727******************************************************************
  7728***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  7729******************************************************************
  7730
  7731 0090-INITIALIZATION-ROUTINE.
  7732
  7733     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  7734     MOVE WS-TIME                     TO ME-START-TIME.
  7735     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  7736                                         TR-RN-DT.
  7737     MOVE ME-START-MO                 TO ME-CNDS-MO.
  7738     MOVE ME-START-DA                 TO ME-CNDS-DA.
  7739     MOVE ME-START-YR                 TO ME-CNDS-YR.
  7740     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  7741     MOVE COMPANY-NAME                TO TRHDNM.
  7742     MOVE ALPH-DATE                   TO TR-MODAYR.
  7743     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  7744     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  7745
  7746     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  7747     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  7748     COMPUTE LYD-MO = LYD-MO - 1.
  7749     IF LYD-MO = ZERO
  7750         MOVE 12                      TO LYD-MO
  7751         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  7752
  7753     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  7754
  7755
  7756     IF DTE-CLIENT = 'CID'
  7757         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  7758         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  7759     ELSE
  7760         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
  7761         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  7762     END-IF.
  7763
  7764     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  7765         GO TO 0090-CONTINUE.
  7766
  7767     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7768     MOVE -12                    TO DC-ELAPSED-MONTHS.
  7769     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  7770     MOVE '6'                    TO DC-OPTION-CODE.
  7771     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7772
  7773     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7774         MOVE '**** WORK DATE CALC ERROR ****'
  7775                                 TO WS-ABEND-MESSAGE
  7776         MOVE '90'               TO ABEND-CODE-1
  7777         MOVE '0'                TO AC2-ONE
  7778         MOVE DC-ERROR-CODE      TO AC2-TWO
  7779         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 152
* ECS010D.cbl
  7780         GO TO ABEND-PGM.
  7781
  7782     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  7783
  7784     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  7785     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  7786
  7787     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  7788             VARYING
  7789         SUBM FROM +2 BY +1
  7790             UNTIL
  7791         SUBM GREATER THAN +12.
  7792
  7793     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  7794
  7795     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  7796             VARYING
  7797         SUBM FROM +1 BY +1
  7798             UNTIL
  7799         SUBM GREATER THAN +13.
  7800
  7801     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7802*    MOVE -90                    TO DC-ELAPSED-DAYS.
  7803     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  7804                                    DC-ELAPSED-MONTHS.
  7805     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  7806     MOVE 1                      TO DC-END-OF-MONTH.
  7807     MOVE '6'                    TO DC-OPTION-CODE.
  7808     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7809
  7810     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7811         MOVE '**** CUT OFF DATE ERROR ****'
  7812                                 TO WS-ABEND-MESSAGE
  7813         MOVE '90'               TO ABEND-CODE-1
  7814         MOVE '0'                TO AC2-ONE
  7815         MOVE DC-ERROR-CODE      TO AC2-TWO
  7816         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7817         GO TO ABEND-PGM.
  7818
  7819     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  7820     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  7821
  7822 0090-CONTINUE.
  7823
  7824     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7825     MOVE -1                     TO DC-ELAPSED-MONTHS.
  7826     MOVE +0                     TO DC-ELAPSED-DAYS.
  7827     MOVE '6'                    TO DC-OPTION-CODE.
  7828     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7829
  7830     IF NO-CONVERSION-ERROR
  7831        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  7832
  7833     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  7834     MOVE -1                     TO DC-ELAPSED-MONTHS.
  7835     MOVE +0                     TO DC-ELAPSED-DAYS.
  7836     MOVE '6'                    TO DC-OPTION-CODE.
  7837     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 153
* ECS010D.cbl
  7838
  7839     IF NO-CONVERSION-ERROR
  7840        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  7841
  7842     MOVE +0                     TO DC-ELAPSED-MONTHS
  7843                                    DC-ELAPSED-DAYS.
  7844
  7845     MOVE SPACES                 TO CERTIFICATE-RECORD.
  7846     MOVE 'CR'                   TO CR-RECORD-ID.
  7847     MOVE ZEROS                  TO
  7848               CR-AGE                  CR-JOINT-AGE
  7849               CR-LFTYP                CR-AHTYP
  7850               CR-LF-TERM              CR-AH-TERM
  7851               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  7852               CR-LF-TERM-IN-DAYS
  7853               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  7854               CR-LFAMT                CR-AHAMT
  7855               CR-LFPRM                CR-AHPRM
  7856               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  7857               CR-LFPRM-CALC           CR-AHPRM-CALC
  7858               CR-LFPRM-RATE           CR-AHPRM-RATE
  7859               CR-LFAMT-ALT
  7860               CR-LFPRM-ALT
  7861               CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
  7862               CR-LFPRM-RATE-ALT
  7863               CR-LFRFND               CR-AHRFND
  7864               CR-LFRFND-CALC          CR-AHRFND-CALC
  7865               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  7866               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  7867               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  7868               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  7869               CR-LIVES                CR-APR
  7870               CR-BILLED
  7871               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  7872               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  7873               CR-PMT-FREQ             CR-LOAN-TERM
  7874               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  7875               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
  7876               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  7877               CR-LF-CANC-DT           CR-AH-CANC-DT
  7878               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  7879               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  7880               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  7881               CR-DTH-DT               CR-DIS-DT
  7882               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  7883               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  7884                                       CR-DIS-PTO-DT
  7885               CR-DTHAMT               CR-DISAMT
  7886               CR-DTHAMT-YTD           CR-DISAMT-YTD
  7887               CR-DTHAMT-LAST          CR-DISAMT-LAST
  7888               CR-DTHEXP               CR-DISEXP
  7889               CR-DTHEXP-YTD           CR-DISEXP-YTD
  7890               CR-DTH-AGE              CR-DAYS-DISAB
  7891               CR-DIS-INCUR-DT (1)     CR-CLAIM-DEDUCT-WITHHELD
  7892               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  7893               CR-INCUR-DISEXP (1)     CR-REMIT-TO
  7894               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  7895               CR-MOB-NET-TOT-FEES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 154
* ECS010D.cbl
  7896               CR-ADDL-CLP  CR-LF-CLP  CR-AH-CLP.
  7897
  7898     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  7899                                       CR-DISAB-DETAIL-DATA (3)
  7900                                       CR-DISAB-DETAIL-DATA (4)
  7901                                       CR-DISAB-DETAIL-DATA (5).
  7902
  7903     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  7904
  7905     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  7906     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  7907        IA > +10
  7908        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  7909     END-PERFORM
  7910     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  7911
  7912     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  7913
  7914     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  7915                          EPEC-TOTALS      EPEC-SUBS
  7916                          EPEC-UNDERWRITTEN-TOTALS.
  7917
  7918     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  7919                          EPEC-LEVELS-END-II.
  7920     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  7921                          DUPE-CERT-TABLE.
  7922
  7923     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  7924     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  7925     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  7926                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  7927     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  7928                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  7929
  7930     IF RUN-DATE NOT = EP-DT
  7931         MOVE '*'                     TO TR-YRASK.
  7932     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  7933     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  7934     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  7935     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  7936
  7937     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  7938         MOVE +1000                   TO DUP-MAX.
  7939
  7940     MOVE DTE-CLIENT                  TO ME-COMPANY.
  7941     MOVE MONTH-END-MOYR              TO ME-MOYR.
  7942     IF ME-DO-UPDATE
  7943         READ ERMEBL-INOUT INVALID KEY
  7944                       CLOSE ERMEBL-INOUT
  7945                       MOVE 'N'       TO ME-UPDATE-FLAG.
  7946
  7947     GO TO 0150-READ-ACCOUNT-MASTER.
  7948
  7949 0090-EXIT.
  7950     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 155
* ECS010D.cbl
  7952 0095-GET-EOM-DATES.
  7953
  7954     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  7955     MOVE '6'                    TO DC-OPTION-CODE.
  7956     MOVE 1                      TO DC-ELAPSED-MONTHS
  7957                                    DC-END-OF-MONTH.
  7958     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  7959     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7960
  7961     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7962         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  7963                                 TO WS-ABEND-MESSAGE
  7964         MOVE '90'               TO ABEND-CODE-1
  7965         MOVE '0'                TO AC2-ONE
  7966         MOVE DC-ERROR-CODE      TO AC2-TWO
  7967         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7968         GO TO ABEND-PGM.
  7969
  7970     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  7971                                     DC-BIN-DATE-1.
  7972     MOVE SPACES                 TO  DC-BIN-DATE-2.
  7973     MOVE ' '                    TO  DC-OPTION-CODE.
  7974     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7975
  7976     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7977         MOVE '**** YMD EOM DATE CALC ERROR ****'
  7978                                 TO WS-ABEND-MESSAGE
  7979         MOVE '90'               TO ABEND-CODE-1
  7980         MOVE '0'                TO AC2-ONE
  7981         MOVE DC-ERROR-CODE      TO AC2-TWO
  7982         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7983         GO TO ABEND-PGM.
  7984
  7985     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  7986
  7987 0095-EXIT.
  7988     EXIT.
  7989
  7990 0096-DISPLAY-EOM-DATES.
  7991
  7992     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  7993
  7994 0096-EXIT.
  7995     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 156
* ECS010D.cbl
  7997******************************************************************
  7998***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  7999******************************************************************
  8000
  8001 0100-ACCT-MASTER-READ-ROUTINE.
  8002
  8003     IF EP-FLG = '1'
  8004        ADD +1                   TO BC-ACT-ACCTS
  8005        IF DTE-OPT-RESERVE-METHOD-AUTH
  8006           PERFORM 4700-CALC-OPT-IBNR
  8007                                 THRU 4700-EXIT
  8008        END-IF
  8009        PERFORM 4500-BUILD-EPEC-EXTRACT
  8010                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  8011     END-IF
  8012
  8013     IF TRANSACTION-WAS-PROCESSED
  8014         MOVE '1'                     TO ACCT-FLG
  8015                                         STATE-FLG
  8016                                         COMP-FLG
  8017                                         CARR-FLG
  8018                                         FINAL-FLG.
  8019
  8020 0150-READ-ACCOUNT-MASTER.
  8021
  8022     READ ERACCTT-IN AT END
  8023         GO TO 9930-EOJ-3.
  8024
  8025     ADD +1                            TO ERACCTT-READS.
  8026
* 8027     COPY ELCACCTI.
  8028******************************************************************04/14/98
  8029*                                                                *ELCACCTI
  8030*                            ELCACCTI                            *   LV003
  8031*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8032*                            VMOD=2.001                          *ELCACCTI
  8033*                                                                *ELCACCTI
  8034*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8035*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8036*                                                                *ELCACCTI
  8037*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8038*                                                                *ELCACCTI
  8039******************************************************************ELCACCTI
  8040     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8041     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8042     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8043     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8044     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8045     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8046     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8047     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8048     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8049
  8050     IF FIRST-ACCOUNT EQUAL +1
  8051        MOVE +0                  TO FIRST-ACCOUNT
  8052        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8053
  8054     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 157
* ECS010D.cbl
  8055         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8056     ELSE
  8057     IF AM-GROUPING NOT = HLD-GROUPING
  8058         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8059     ELSE
  8060     IF AM-STATE NOT = HLD-STATE
  8061         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8062     ELSE
  8063     IF AM-ACCOUNT NOT = HLD-ACCT
  8064         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8065     ELSE
  8066     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8067
  8068     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8069        (AM-GROUPING NOT = HLD-GROUPING)
  8070         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8071
  8072 0190-PROCESS-NEW-ACCOUNT.
  8073
  8074     IF AM-CARRIER NOT = HLD-CARRIER
  8075         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8076
  8077     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8078     MOVE AM-CARRIER            TO TR-CARR.
  8079     MOVE AM-GROUPING           TO TR-GROUP.
  8080     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8081     MOVE AM-NAME               TO TR-AGCY.
  8082     MOVE AM-EFF-MO             TO TR-CE-MO.
  8083     MOVE AM-EFF-DA             TO TR-CE-DA.
  8084     MOVE AM-EFF-YR             TO TR-CE-YR.
  8085     MOVE AM-STATE              TO TR-ST-NO.
  8086     IF AM-EXPIRE-DT =  99999999999
  8087         MOVE 'CURRENT '        TO TR-CX
  8088     ELSE
  8089         MOVE AM-EXP-MO         TO TR-CX-MO
  8090         MOVE AM-EXP-DA         TO TR-CX-DA
  8091         MOVE AM-EXP-YR         TO TR-CX-YR
  8092         MOVE '-'               TO HSHR1  HSHR2.
  8093
  8094     ADD +1 TO BC-ACCTS.
  8095
  8096     IF AM-RECORD-ID = '**'
  8097         ADD +1 TO BC-NEW-ACCTS.
  8098     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8099         ADD +1 TO BC-ER-ACCTS.
  8100
  8101     MOVE ZEROS                 TO SV-LO-CERT
  8102                                   SV-HI-CERT.
  8103     MOVE SPACE                 TO TRANSACTION-FLAG
  8104                                   LST-TRD-CERT
  8105                                   LST-TRD-ISDT
  8106                                   OB-DATE-1-SWITCH
  8107                                   OB-DATE-2-SWITCH
  8108                                   OB-DATE-3-SWITCH.
  8109     MOVE +81                   TO LN-CNT.
  8110
  8111 0199-READ-ACCOUNT-X.
  8112     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 158
* ECS010D.cbl
  8113
  8114 0199A-CARRIER-TABLE-LOOKUP.
  8115
  8116     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8117            VARYING CLAS-INDEXCN FROM 1 BY 1
  8118         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8119               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8120
  8121     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8122         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8123         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8124                                 TO WS-ABEND-MESSAGE
  8125         MOVE 4004               TO WS-ABEND-CODE
  8126         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8127         GO TO ABEND-PGM.
  8128
  8129 0199A-LOOKUP-XIT.
  8130     EXIT.
  8131 0199B-SEARCH-CARRIER-TABLE.
  8132     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 159
* ECS010D.cbl
  8134******************************************************************
  8135***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8136******************************************************************
  8137
  8138 0200-CERT-MASTER-READ-ROUTINE.
  8139
  8140     IF EOF-ON-CERT
  8141         GO TO 0299-READ-CERT-X.
  8142
  8143     IF FIRST-CERT EQUAL +1
  8144        MOVE +0                  TO FIRST-CERT
  8145        GO TO 0250-READ-CERT-MASTER.
  8146
  8147     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8148
  8149     PERFORM CERT-DATE-LOAD.
  8150
  8151     IF CR-IND-GRP = 'I'  OR  '1'
  8152         MOVE '1'                    TO CR-IND-GRP
  8153     ELSE
  8154         MOVE '2'                    TO CR-IND-GRP.
  8155
  8156     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8157         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8158     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8159         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8160
  8161************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8162     IF DTE-CLIENT NOT = 'NSL'
  8163         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8164                                      CR-AH-REI-RISK-PRM.
  8165******************************************************************
  8166
  8167     IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8168         MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8169     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8170         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8171
  8172     MOVE CR-STATE                   TO STATE-L.
  8173     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8174
  8175     IF CR-LFTYP NOT = ZERO
  8176         MOVE CR-LFTYP               TO CLAS-LOOK
  8177         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8178
  8179     IF CR-AHTYP NOT = ZERO
  8180         MOVE CR-AHTYP               TO CLAS-LOOK
  8181         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8182
  8183     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8184     MOVE 'L'                    TO DC-OPTION-CODE
  8185     MOVE +0                     TO DC-ELAPSED-MONTHS
  8186                                    DC-ELAPSED-DAYS
  8187     PERFORM 8000-DATE-CONVERT-ROUTINE
  8188                                 THRU 8099-DATE-CONVERT-X
  8189     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8190
  8191     IF (DTE-CLIENT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 160
* ECS010D.cbl
  8192        AND (CR-AHTYP NOT = ZERO AND SPACES)
  8193        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8194        PERFORM 0395-GET-CERT-TRLRS
  8195                                 THRU 0395-EXIT
  8196     END-IF
  8197
  8198     IF RUN-MO NOT = 01
  8199         GO TO 0250-READ-CERT-MASTER.
  8200
  8201     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8202                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8203
  8204     IF ((CR-LFTYP NOT = ZERO)  AND
  8205         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8206        ((CR-AHTYP NOT = ZERO)  AND
  8207         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8208           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8209
  8210     .
  8211 0250-READ-CERT-MASTER.
  8212
  8213     READ CERT-MASTER-IN
  8214               AT END GO TO 9920-EOJ-2.
  8215
  8216     ADD +1 TO CMIN-CNT.
  8217
  8218*     DISPLAY ' READ CERT ' CIR-CONTROL
  8219     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8220         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8221         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8222         DISPLAY 'SECOND - '  CIR-CONTROL
  8223         MOVE 0612                    TO WS-ABEND-CODE
  8224         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8225         GO TO ABEND-PGM.
  8226
  8227     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8228         DISPLAY 'DUPLICATE CERT ON FILE'  PRIOR-CERT-IN-CNTRL
  8229         IF DTE-CLIENT EQUAL 'SEN'
  8230            GO TO 0250-READ-CERT-MASTER
  8231         ELSE
  8232            MOVE 'DUPLICATE CERT ON FILE'
  8233                                      TO WS-ABEND-MESSAGE
  8234            MOVE 0302                 TO WS-ABEND-CODE
  8235            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8236            GO TO ABEND-PGM.
  8237
  8238******************************************************
  8239*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8240*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8241*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8242******************************************************
  8243     IF DTE-CLIENT = 'CID'
  8244        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8245           IF (CF-THIRD-AGENT  = '0000713100') OR
  8246              (CF-FOURTH-AGENT = '0000713100')
  8247              CONTINUE
  8248           ELSE
  8249              GO TO 0250-READ-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 161
* ECS010D.cbl
  8250           END-IF
  8251        ELSE
  8252           IF COMPANY-NAME = '        PEOPLES TRUST'
  8253              IF CI-ACCOUNT = '0000845800'
  8254                 CONTINUE
  8255              ELSE
  8256                 GO TO 0250-READ-CERT-MASTER
  8257              END-IF
  8258           ELSE
  8259              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8260                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8261                    (CF-FOURTH-AGENT = '0000681700')
  8262                    CONTINUE
  8263                 ELSE
  8264                    GO TO 0250-READ-CERT-MASTER
  8265                 END-IF
  8266              ELSE
  8267                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8268                    IF CI-ACCOUNT = '0001107200'
  8269                       CONTINUE
  8270                    ELSE
  8271                       GO TO 0250-READ-CERT-MASTER
  8272                    END-IF
  8273                 END-IF
  8274              END-IF
  8275           END-IF
  8276        END-IF
  8277     END-IF
  8278
  8279******************************************************
  8280     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8281
  8282 0299-READ-CERT-X.
  8283     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 162
* ECS010D.cbl
  8285******************************************************************
  8286***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8287******************************************************************
  8288
  8289 0300-READ-PENDING-TRANSACTIONS.
  8290
  8291     READ PENDING-EXTRACT
  8292                   AT END GO TO 9910-EOJ-1.
  8293
  8294     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8295
  8296     IF NOT ED-PENDING-BUSINESS  AND
  8297        NOT ED-PENDING-CLAIMS  AND
  8298        NOT ED-CERT-CHANGES
  8299           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8300                                               ED-RECORD-TYPE
  8301           MOVE 0301                        TO WS-ABEND-CODE
  8302           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8303           GO TO ABEND-PGM.
  8304
  8305     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8306
  8307     IF DTE-CLIENT = 'NCL'
  8308         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8309             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8310                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8311             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8312
  8313     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8314         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8315         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8316         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8317         MOVE 0603                    TO WS-ABEND-CODE
  8318         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8319         GO TO ABEND-PGM.
  8320
  8321     ADD +1 TO TR-CNT.
  8322
  8323     IF ISSUE-TRANSACTION   OR
  8324        CANCEL-TRANSACTION  OR
  8325        CLAIM-TRANSACTION   OR
  8326        RESERVE-TRANSACTION OR
  8327        UPDATE-TRANSACTION
  8328         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8329         GO TO 0330-MATCH-PENDING-TO-CERT.
  8330
  8331     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8332
  8333     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8334     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8335             PENDING-RECORD-TYPE ')'.
  8336
  8337     MOVE 0301                   TO WS-ABEND-CODE.
  8338     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8339     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 163
* ECS010D.cbl
  8341 0310-SET-UP-MATCHING-KEY.
  8342
  8343     IF ED-PENDING-BUSINESS
  8344         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8345         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8346         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8347         MOVE PB-STATE           TO PEND-MATCH-STATE
  8348         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8349         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8350         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8351         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8352
  8353     IF ED-PENDING-CLAIMS
  8354         ADD +1                  TO W-PENDING-CLMS
  8355         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8356         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8357         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8358         MOVE PC-STATE           TO PEND-MATCH-STATE
  8359         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8360         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8361         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8362         IF PC-CLAIMS
  8363             MOVE '3'            TO PENDING-RECORD-TYPE
  8364         ELSE
  8365             IF PC-RESERVES
  8366                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8367
  8368     IF ED-CERT-CHANGES
  8369         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8370         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8371         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8372         MOVE CC-STATE           TO PEND-MATCH-STATE
  8373         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8374         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8375         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8376         MOVE '5'                TO PENDING-RECORD-TYPE.
  8377
  8378     MOVE ' '                    TO DC-OPTION-CODE.
  8379     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8380     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8381
  8382 0310-EXIT.
  8383     EXIT.
  8384
  8385******************************************************************
  8386***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8387******************************************************************
  8388
  8389 0330-MATCH-PENDING-TO-CERT.
  8390
  8391     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8392         GO TO 0390-CERT-MISMATCH-ERROR.
  8393
  8394     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8395*       DISPLAY ' EQUAL PEND ' PENDING-MATCH-CONTROL
  8396       IF CLAIM-TRANSACTION
  8397*         DISPLAY ' CLAIM '
  8398         IF NOT PC-CHARGEBLE-EXPENSE  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 164
* ECS010D.cbl
  8399            NOT PC-NON-CHARGEBLE-EXPENSE
  8400             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8401                                      OR
  8402                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8403                  GO TO 0390-CERT-MISMATCH-ERROR.
  8404
  8405     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8406       IF RESERVE-TRANSACTION
  8407*         DISPLAY ' RESV '
  8408         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8409                                  OR
  8410            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8411              GO TO 0390-CERT-MISMATCH-ERROR.
  8412
  8413     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8414         IF ISSUE-TRANSACTION
  8415*           DISPLAY ' ISSUE '
  8416             GO TO 0380-DUPLICATE-CERT-ERROR
  8417         ELSE
  8418             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8419
  8420     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8421         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8422         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8423                                               0299-READ-CERT-X
  8424         GO TO 0330-MATCH-PENDING-TO-CERT.
  8425
  8426     IF ISSUE-TRANSACTION
  8427         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8428     ELSE
  8429         GO TO 0390-CERT-MISMATCH-ERROR.
  8430
  8431 0350-MATCH-PENDING-TO-ACCOUNT.
  8432
  8433     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8434       ADD +1  TO ERROR-COUNT
  8435         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8436           TO  DL-FULL
  8437             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8438         MOVE    ' PENDING CONTROL = '
  8439           TO  DIS-LINE-REASON
  8440         MOVE  PENDING-MATCH-CONTROL
  8441           TO  DIS-LINE-REC
  8442             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8443         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8444           TO  DIS-LINE-REASON
  8445         MOVE  PENDING-MATCH-CONTROL
  8446           TO  DIS-LINE-REC
  8447             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8448         MOVE  SPACES
  8449           TO  DISPLAY-LINE
  8450             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8452         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8453         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8454         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8455         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8456         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8457         DISPLAY '    ACCOUNT CONTROL = '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 165
* ECS010D.cbl
  8458         AM-MSTR-CNTRL AM-EFFECT-DT
  8459         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID'
  8460            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8461            GO TO 0300-READ-PENDING-TRANSACTIONS
  8462         ELSE
  8463            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8464                                      TO WS-ABEND-MESSAGE
  8465            MOVE 0302 TO WS-ABEND-CODE
  8466            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8467            GO TO ABEND-PGM.
  8468
  8469     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8470         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8471                                              0199-READ-ACCOUNT-X
  8472         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8473
  8474     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8475        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8476         GO TO 0500-APPLY-PENDING-BUSINESS.
  8477
  8478     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8479                                       0199-READ-ACCOUNT-X.
  8480     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8481
  8482
  8483 0370-ACCOUNT-MISMATCH-ERROR.
  8484
  8485     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8486     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8487     MOVE 'MISMATCH ACCOUNT ERROR'
  8488                               TO WS-ABEND-MESSAGE.
  8489     MOVE 0302 TO WS-ABEND-CODE.
  8490         DISPLAY '******************************'
  8491         DISPLAY '***** ERROR LOCATION 009 *****'
  8492         DISPLAY '******************************'
  8493     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8494     GO TO ABEND-PGM.
  8495
  8496
  8497 0380-DUPLICATE-CERT-ERROR.
  8498
  8499     IF PB-I-OB  OR  PB-I-SUMMARY
  8500         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8501
  8502     ADD +1 TO DUP-CNT.
  8503
  8504     IF DUP-CNT NOT GREATER THAN DUP-MAX
  8505         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  8506         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  8507                                         PB-I-LF-ALT-PREMIUM-AMT
  8508         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  8509         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  8510         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8511
  8512     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  8513     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8514
  8515*    MOVE 0301 TO WS-ABEND-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 166
* ECS010D.cbl
  8516*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8517*    GO TO ABEND-PGM.
  8518
  8519
  8520 0390-CERT-MISMATCH-ERROR.
  8521
  8522     IF ISSUE-TRANSACTION  OR
  8523        CANCEL-TRANSACTION  OR
  8524        CLAIM-TRANSACTION
  8525         ADD +1                  TO  MISMATCH-COUNT.
  8526
  8527     IF DTE-CLIENT  =  'CID'  OR  'CSO'
  8528       ADD  +1  TO  ERROR-COUNT
  8529         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  8530           TO  DL-FULL
  8531             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8532         MOVE    ' TRANS CONTROL = '
  8533           TO  DIS-LINE-REASON
  8534         MOVE  PENDING-MATCH-CONTROL
  8535           TO  DIS-LINE-REC
  8536             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8537         MOVE    ' TRANS TYPE    = '
  8538           TO  DIS-LINE-REASON
  8539         MOVE  PENDING-RECORD-TYPE
  8540           TO  DIS-LINE-REC
  8541             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8542         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8543           TO  DL-FULL
  8544             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8545         MOVE    ' CERT IN CTL   = '
  8546           TO  DIS-LINE-REASON
  8547         MOVE  CIR-CONTROL
  8548           TO  DIS-LINE-REC
  8549             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8550         MOVE    ' BYPASSED TRANS  = '
  8551           TO  DIS-LINE-REASON
  8552         MOVE  PENDING-MATCH-CONTROL
  8553           TO  DIS-LINE-REC
  8554             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8555         MOVE  SPACES
  8556           TO  DISPLAY-LINE
  8557             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8558         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  8559
  8560     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  8561     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  8562
  8563     IF ISSUE-TRANSACTION
  8564         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  8565     ELSE
  8566         IF CANCEL-TRANSACTION
  8567             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  8568         ELSE
  8569             IF CLAIM-TRANSACTION
  8570                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  8571             ELSE
  8572                 IF RESERVE-TRANSACTION
  8573                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 167
* ECS010D.cbl
  8574                 ELSE
  8575                     IF UPDATE-TRANSACTION
  8576                         MOVE 'CHG'
  8577                                 TO  DTL-REC-TYPE-DESC.
  8578
  8579     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  8580     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  8581     MOVE 'DROPPED'              TO  DTL-STATUS.
  8582
  8583     IF ISSUE-TRANSACTION
  8584         MOVE PB-I-LF-PREMIUM-AMT
  8585                                 TO  MD2-LF-PREM
  8586         MOVE PB-I-LF-ALT-PREMIUM-AMT
  8587                                 TO  MD2-LF-ALT-PREM
  8588         MOVE PB-I-AH-PREMIUM-AMT
  8589                                 TO  MD2-AH-PREM
  8590         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  8591         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  8592         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  8593     ELSE
  8594         IF CANCEL-TRANSACTION
  8595             MOVE PB-C-LF-CANCEL-AMT
  8596                                 TO  MD3-LF-REFUND
  8597             MOVE PB-C-AH-CANCEL-AMT
  8598                                 TO  MD3-AH-REFUND
  8599             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  8600             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  8601         ELSE
  8602             IF CLAIM-TRANSACTION
  8603                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  8604                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  8605                     MOVE ZEROS             TO MD4-AH-CLAIM
  8606                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  8607                 ELSE
  8608                     MOVE ZEROS             TO MD4-LF-CLAIM
  8609                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  8610                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  8611
  8612     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  8613         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  8614         MOVE MISMATCH-PAGE-NUMBER
  8615                                 TO  TR-PG
  8616         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  8617         MOVE MR-CTL             TO  X
  8618         MOVE X TO LCP-ASA
  8619         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8620             THRU LCP-WRITE-END-MISMATCH-RPT
  8621         MOVE TR-HD-2            TO  MISMATCH-RPT
  8622         MOVE MR-CTL             TO  X
  8623         MOVE X TO LCP-ASA
  8624         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8625             THRU LCP-WRITE-END-MISMATCH-RPT
  8626         MOVE TR-HD-3            TO  MISMATCH-RPT
  8627         MOVE MR-CTL             TO  X
  8628         MOVE X TO LCP-ASA
  8629         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8630             THRU LCP-WRITE-END-MISMATCH-RPT
  8631         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 168
* ECS010D.cbl
  8632         MOVE MR-CTL             TO  X
  8633         MOVE X TO LCP-ASA
  8634         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8635             THRU LCP-WRITE-END-MISMATCH-RPT
  8636         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  8637
  8638     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  8639     MOVE MR-CTL                 TO  X.
  8640     ADD +2                      TO  MISMATCH-LINE-COUNT.
  8641
  8642     MOVE X TO LCP-ASA
  8643     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8644         THRU LCP-WRITE-END-MISMATCH-RPT.
  8645
  8646     IF ISSUE-TRANSACTION
  8647         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  8648         MOVE MR-CTL             TO  X
  8649         ADD +1                  TO  MISMATCH-LINE-COUNT
  8650         MOVE X TO LCP-ASA
  8651         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8652             THRU LCP-WRITE-END-MISMATCH-RPT.
  8653
  8654     IF CANCEL-TRANSACTION
  8655         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  8656         MOVE MR-CTL             TO  X
  8657         ADD +1                  TO  MISMATCH-LINE-COUNT
  8658         MOVE X TO LCP-ASA
  8659         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8660             THRU LCP-WRITE-END-MISMATCH-RPT.
  8661
  8662     IF CLAIM-TRANSACTION
  8663         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  8664         MOVE MR-CTL             TO  X
  8665         ADD +1                  TO  MISMATCH-LINE-COUNT
  8666         MOVE X TO LCP-ASA
  8667         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8668             THRU LCP-WRITE-END-MISMATCH-RPT.
  8669
  8670     MOVE SPACES                 TO  MISMATCH-RPT.
  8671
  8672     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8673
  8674 0395-GET-CERT-TRLRS.
  8675
  8676     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  8677     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  8678     MOVE CR-CARRIER             TO CS-CARRIER
  8679     MOVE CR-GROUPING            TO CS-GROUPING
  8680     MOVE CR-STATE               TO CS-STATE
  8681     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  8682     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  8683     MOVE CR-CERT-NO             TO CS-CERT-NO
  8684     MOVE 'A'                    TO CS-TRAILER-TYPE
  8685
  8686     READ ELCRTT
  8687
  8688     IF ELCRTT-FILE-STATUS = '00'
  8689        MOVE CS-BANK-COMMISSION-AREA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 169
* ECS010D.cbl
  8690                                 TO WS-BANK-COMMISSIONS
  8691     ELSE
  8692        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  8693           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
  8694           PERFORM ABEND-PGM
  8695        END-IF
  8696     END-IF
  8697
  8698     .
  8699 0395-EXIT.
  8700     EXIT.
  8701
  8702******************************************************************
  8703***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  8704******************************************************************
  8705
  8706 0400-WRITE-CERT-RECORD.
  8707*     DISPLAY ' MADE 400 WRITE ' CR-FULL-CONTROL
  8708
  8709     IF CERTIFICATE-RECORD = LOW-VALUES
  8710         GO TO 0499-WRITE-CERT-X.
  8711
  8712     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  8713         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  8714         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL
  8715         ADD  +1  TO  ERROR-COUNT
  8716         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  8717           TO  DL-FULL
  8718             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8719         MOVE    ' CERT. CONTROL = '
  8720           TO  DIS-LINE-REASON
  8721         MOVE  CR-FULL-CONTROL
  8722           TO  DIS-LINE-REC
  8723             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8724         MOVE  SPACES
  8725           TO  DISPLAY-LINE
  8726             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8727            WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  8728            ADD +1 TO CMOT-CNT
  8729            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  8730               GO TO 0400-WRITE-CERT-RECORD.
  8731
  8732*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  8733
  8734     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  8735         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8736                                              0199-READ-ACCOUNT-X
  8737         GO TO 0400-WRITE-CERT-RECORD.
  8738
  8739     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  8740        CR-DT NOT LESS THAN AM-EXPIRE-DT
  8741         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8742                                              0199-READ-ACCOUNT-X
  8743         GO TO 0400-WRITE-CERT-RECORD.
  8744
  8745*     DISPLAY ' BEFORE REIN '
  8746     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  8747*     DISPLAY ' AFTER REIN '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 170
* ECS010D.cbl
  8748
  8749     IF CR-LFTYP = ZEROS  AND
  8750        CR-DTHEXP NOT = ZEROS
  8751         ADD +1                     TO W-LFTYP-99
  8752         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  8753         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8754
  8755     IF CR-AHTYP = ZEROS  AND
  8756        CR-DISEXP NOT = ZEROS
  8757         ADD +1                     TO W-AHTYP-99
  8758         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  8759         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8760
  8761*     DISPLAY ' BEFORE EP BUMP'
  8762     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  8763*     DISPLAY ' AFTER EP BUMP'
  8764
  8765     IF CR-LFTYP = '99'
  8766         MOVE '00'                  TO CR-LFTYP.
  8767     IF CR-AHTYP = '99'
  8768         MOVE '00'                  TO CR-AHTYP.
  8769
  8770*    IF CR-ISS-MICROFILM-NO NOT NUMERIC
  8771*        MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
  8772
  8773     IF CR-NH-INT-ON-REF NOT NUMERIC
  8774         MOVE ZEROS                 TO CR-NH-INT-ON-REF
  8775     END-IF
  8776
  8777     IF  CR-POLICY-IS-ACTIVE
  8778         ADD +1                  TO W-POLICY-ACTIVE-CTR
  8779         IF  CR-POLICY-IS-REISSUE
  8780             OR CR-POLICY-IS-MONTHLY
  8781             ADD +1              TO W-POLICY-REISSUE-CTR
  8782         ELSE
  8783             IF  CR-POLICY-IS-REIN-ONLY
  8784                 ADD +1          TO W-POLICY-REIN-CTR
  8785             ELSE
  8786                 NEXT SENTENCE
  8787     ELSE
  8788         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  8789
  8790     IF DTE-PGM-OPT = '1'
  8791       IF REIN-IS-RISK-PREMIUM  AND
  8792          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  8793         IF NOT CR-POLICY-IS-REISSUE  AND
  8794            NOT CR-POLICY-IS-DECLINED  AND
  8795            NOT CR-POLICY-IS-VOID
  8796            AND NOT CR-POLICY-IS-MONTHLY
  8797             MOVE '*'            TO RISK-PREM-FLAG
  8798             PERFORM 3100-REINSURE-ISSUE THRU
  8799                     3199-REINSURE-ISSUE-X.
  8800
* 8801     COPY ELCCRTM2.
  8802******************************************************************04/16/98
  8803*                                                                *ELCCRTM2
  8804*                                                                *ELCCRTM2
  8805*                            ELCCRTM2                            *   LV004
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 171
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCCRTM2)
  8806*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8807*                            VMOD=2.001                          *ELCCRTM2
  8808*                                                                *ELCCRTM2
  8809*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  8810*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  8811*                                                                *ELCCRTM2
  8812******************************************************************ELCCRTM2
  8813     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  8814     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  8815     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  8816     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  8817     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  8818     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  8819                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  8820     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  8821     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  8822     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  8823     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  8824                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  8825     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  8826     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  8827     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  8828     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  8829     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  8830                                                                     CL**4
  8831     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  8832                UNTIL COPY-NDX > 5                                   CL**4
  8833           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  8834                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  8835     END-PERFORM.                                                 ELCCRTM2
  8836                                                                  ELCCRTM2
  8837
  8838     IF DTE-PGM-OPT = '1'
  8839         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  8840         ADD +1 TO CMOT-CNT.
  8841
  8842     MOVE SPACE                  TO REIN-FLG
  8843                                    RISK-REIN-FLAG
  8844                                    RISK-PREM-FLAG
  8845                                    RC-COMM-FLG.
  8846
  8847 0499-WRITE-CERT-X.
  8848     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 172
* ECS010D.cbl
  8850******************************************************************
  8851***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  8852******************************************************************
  8853
  8854 0500-APPLY-PENDING-BUSINESS.
  8855
  8856     IF CANCEL-TRANSACTION
  8857*         DISPLAY ' CANCEL TRAN ' CIR-CONTROL
  8858         GO TO 0600-PROCESS-CANCELLATIONS.
  8859
  8860     IF CLAIM-TRANSACTION
  8861*        DISPLAY ' CLAIM TRAN ' CIR-CONTROL
  8862         GO TO 0700-PROCESS-CLAIMS.
  8863
  8864     IF RESERVE-TRANSACTION
  8865*        DISPLAY ' RESV TRAN ' CIR-CONTROL
  8866         GO TO 0800-PROCESS-RESERVES.
  8867
  8868     IF UPDATE-TRANSACTION
  8869*        DISPLAY ' UPD TRAN ' CIR-CONTROL
  8870         GO TO 0900-PROCESS-CERT-CHANGES.
  8871
  8872******************************************************************
  8873***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  8874******************************************************************
  8875
  8876 0505-PROCESS-ISSUES.
  8877
  8878     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  8879     PERFORM CERT-DATE-LOAD.
  8880
  8881     ADD +1                      TO  W-POL-ISSUES.
  8882
  8883     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  8884     MOVE PB-CARRIER             TO  CR-CARRIER.
  8885     MOVE PB-GROUPING            TO  CR-GROUPING.
  8886     MOVE PB-STATE               TO  CR-STATE.
  8887     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  8888     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  8889                                     WS-CR-BIN-DATE
  8890     MOVE ' '                    TO  DC-OPTION-CODE.
  8891     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8892     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  8893                                     WS-CR-DT-N.
  8894     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  8895
  8896*     DISPLAY ' PROC ISS ' CR-FULL-CONTROL
  8897     MOVE PB-I-NAME              TO  CR-NAME.
  8898     MOVE PB-I-AGE               TO  CR-AGE.
  8899     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  8900     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  8901
  8902     IF PB-I-JOINT-COVERAGE
  8903         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  8904         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  8905     ELSE
  8906        IF (DTE-CLIENT EQUAL 'BOA')  AND
  8907           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 173
* ECS010D.cbl
  8908             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  8909
  8910     IF PB-I-SUMMARY  OR
  8911        DTE-CLIENT = 'DMD'
  8912         MOVE PB-I-LIVES         TO  CR-LIVES.
  8913
  8914     IF PB-I-NUM-BILLED NOT NUMERIC
  8915        MOVE ZEROS               TO PB-I-NUM-BILLED.
  8916
  8917     IF PB-I-STATE-TAX NOT NUMERIC
  8918        MOVE ZEROS               TO PB-I-STATE-TAX.
  8919
  8920     IF PB-I-MUNI-TAX NOT NUMERIC
  8921        MOVE ZEROS               TO PB-I-MUNI-TAX.
  8922     IF PB-I-TOT-FEES NOT NUMERIC
  8923        MOVE ZEROS               TO PB-I-TOT-FEES
  8924     END-IF
  8925     IF PB-I-ADDL-CLP NOT NUMERIC
  8926        MOVE ZEROS               TO PB-I-ADDL-CLP
  8927     END-IF
  8928
  8929     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  8930     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  8931     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  8932     MOVE PB-I-LF-CLP            TO  CR-LF-CLP
  8933     MOVE PB-I-AH-CLP            TO  CR-AH-CLP
  8934     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  8935     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  8936     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  8937     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  8938     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  8939     MOVE PB-I-LOAN-APR          TO  CR-APR.
  8940     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  8941     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  8942
  8943     IF PB-I-RATE-CLASS-OVRD = SPACES
  8944         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  8945     ELSE
  8946         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  8947
  8948     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  8949     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  8950
  8951     IF PB-I-INDV-GRP-OVRD = SPACES
  8952         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  8953     ELSE
  8954         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  8955
  8956     IF CR-IND-GRP = 'I'  OR  '1'
  8957         MOVE '1'                TO  CR-IND-GRP
  8958     ELSE
  8959         MOVE '2'                TO  CR-IND-GRP.
  8960
  8961     IF PB-I-SKIP-CODE = '1'
  8962         MOVE 01                 TO  CR-SKIP.
  8963     IF PB-I-SKIP-CODE = '2'
  8964         MOVE 02                 TO  CR-SKIP.
  8965     IF PB-I-SKIP-CODE = '3'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 174
* ECS010D.cbl
  8966         MOVE 03                 TO  CR-SKIP.
  8967     IF PB-I-SKIP-CODE = '4'
  8968         MOVE 04                 TO  CR-SKIP.
  8969     IF PB-I-SKIP-CODE = '5'
  8970         MOVE 05                 TO  CR-SKIP.
  8971     IF PB-I-SKIP-CODE = '6'
  8972         MOVE 06                 TO  CR-SKIP.
  8973     IF PB-I-SKIP-CODE = '7'
  8974         MOVE 07                 TO  CR-SKIP.
  8975     IF PB-I-SKIP-CODE = '8'
  8976         MOVE 08                 TO  CR-SKIP.
  8977     IF PB-I-SKIP-CODE = '9'
  8978         MOVE 09                 TO  CR-SKIP.
  8979     IF PB-I-SKIP-CODE = 'A'
  8980         MOVE 10                 TO  CR-SKIP.
  8981     IF PB-I-SKIP-CODE = 'X'
  8982         MOVE 11                 TO  CR-SKIP.
  8983
  8984     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  8985     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  8986     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  8987
  8988     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  8989         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  8990                                        REIN-SPEC-A
  8991                                        REIN-SPEC-B
  8992                                        REIN-SPEC-C
  8993         MOVE REIN-SPEC          TO CR-REIN-TABLE
  8994     ELSE
  8995         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  8996
  8997     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  8998     MOVE ' '                    TO  DC-OPTION-CODE.
  8999     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9000     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  9001
  9002     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  9003
  9004     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  9005         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  9006     ELSE
  9007         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  9008
  9009     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  9010         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  9011
  9012     IF PB-BATCH-ENTRY = SPACE  OR
  9013        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  9014         MOVE '1'                TO  CR-ENTRY-STATUS
  9015     ELSE
  9016         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
  9017
  9018     IF PB-POLICY-IS-DECLINED
  9019         MOVE 'D'                TO  CR-ENTRY-STATUS.
  9020
  9021     IF PB-POLICY-IS-VOIDED
  9022         MOVE 'V'                TO  CR-ENTRY-STATUS.
  9023
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 175
* ECS010D.cbl
  9024***  IF DTE-CLIENT NOT = 'CRI'
  9025***      IF PB-I-PREM-ACCTNG-ONLY
  9026***          MOVE '1'            TO  CR-ENTRY-STATUS.
  9027
  9028     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  9029                                     WS-CR-ENTRY-DATE-N.
  9030
  9031*    IF PB-I-MICROFILM-NO NUMERIC
  9032*        MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
  9033
  9034     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9035        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9036         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9037     END-IF
  9038
  9039*************************************************
  9040***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9041***  WAS CONVERTED TO 1056 BYTES.             ***
  9042*************************************************
  9043     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9044     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9045
  9046     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9047
  9048     MOVE CR-STATE               TO STATE-L.
  9049
  9050     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9051
  9052     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9053
  9054***************************************************
  9055***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9056***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9057***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9058***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9059***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9060***************************************************
  9061     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9062         IF CR-LF-POLICY-IS-RESTORE
  9063             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9064             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9065         ELSE
  9066         IF CR-LF-POLICY-IS-REISSUE
  9067             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9068             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9069         ELSE
  9070         IF CR-LF-IS-REIN-ONLY
  9071             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  9072             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9073         ELSE
  9074         IF CR-LF-IS-DECLINED
  9075             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9076             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9077         ELSE
  9078         IF CR-LF-IS-VOID
  9079             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  9080             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9081         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 176
* ECS010D.cbl
  9082         IF CR-LF-POLICY-IS-MONTHLY
  9083            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9084            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9085
  9086
  9087 0510-PROCESS-LIFE-ISSUE.
  9088
  9089     IF PB-INVALID-LIFE
  9090         GO TO 0520-PROCESS-A-H-ISSUE.
  9091
  9092     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9093     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9094     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9095
  9096     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9097     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9098     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9099     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9100     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9101     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9102
  9103     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9104     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9105     IF PB-I-LF-POLICY-FEE  NUMERIC
  9106         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9107     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9108     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9109
  9110     IF PB-I-LF-PREM-TAX NUMERIC
  9111        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9112     END-IF
  9113
  9114
  9115     IF PB-I-LF-REI-RATE NOT = ZEROS
  9116        IF DTE-CLIENT = 'DCC'
  9117           CONTINUE
  9118*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9119        ELSE
  9120           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9121           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9122                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9123        END-IF
  9124     END-IF
  9125
  9126     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9127         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9128         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9129         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  9130         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9131         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
  9132             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9133                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9134
  9135     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9136     MOVE ' '                    TO  DC-OPTION-CODE.
  9137     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9138     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9139                                     WS-CR-LF-EXPIRE-DATE-N.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 177
* ECS010D.cbl
  9140
  9141     IF CR-ENTRY-STATUS = 'P'
  9142         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  9143     ELSE
  9144         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9145
  9146     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9147     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9148     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9149     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9150     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9151
  9152     IF CR-LF-POLICY-IS-RESTORE
  9153         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9154     IF CR-LF-POLICY-IS-REISSUE
  9155         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9156     IF CR-LF-IS-REIN-ONLY
  9157         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9158
  9159     IF CR-LF-IS-DECLINED
  9160         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9161
  9162     IF CR-LF-IS-VOID
  9163         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9164     IF CR-LF-POLICY-IS-MONTHLY
  9165         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9166
  9167     ADD +1                      TO  W-LF-ISSUES.
  9168
  9169 0520-PROCESS-A-H-ISSUE.
  9170
  9171     IF PB-INVALID-AH
  9172         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9173
  9174     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9175     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9176     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9177
  9178     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9179     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9180     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9181     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9182     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9183
  9184     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9185     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9186     IF PB-I-AH-POLICY-FEE  NUMERIC
  9187         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  9188     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9189     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9190
  9191     IF PB-I-AH-PREM-TAX NUMERIC
  9192        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9193     END-IF
  9194
  9195     IF PB-I-AH-REI-RATE NOT = ZEROS
  9196        IF DTE-CLIENT = 'DCC'
  9197           CONTINUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 178
* ECS010D.cbl
  9198        ELSE
  9199           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9200           COMPUTE CR-AH-NSP-PRM ROUNDED =
  9201             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9202        END-IF
  9203     END-IF
  9204
  9205     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9206        MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9207        MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9208        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9209     END-IF
  9210     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9211     MOVE ' '                    TO  DC-OPTION-CODE.
  9212     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9213     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9214                                     WS-CR-AH-EXPIRE-DATE-N.
  9215
  9216     IF CR-ENTRY-STATUS = 'P'
  9217         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9218     ELSE
  9219         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9220
  9221     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9222     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9223     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9224     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9225     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9226
  9227     IF CR-AH-POLICY-IS-RESTORE
  9228         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9229     IF CR-AH-POLICY-IS-REISSUE
  9230         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9231     IF CR-AH-IS-REIN-ONLY
  9232         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9233
  9234     IF CR-AH-IS-DECLINED
  9235         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9236
  9237     IF CR-AH-IS-VOID
  9238         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9239     IF CR-AH-POLICY-IS-MONTHLY
  9240         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9241
  9242     ADD +1                      TO  W-AH-ISSUES.
  9243
  9244 0530-PROCESS-ISSUE-CONTINUED.
  9245
  9246     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9247     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9248     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9249     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9250
  9251     IF (DTE-CLIENT = 'DCC')
  9252        AND (CR-AHTYP NOT = '00' AND '  ')
  9253        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9254           PERFORM 0920-GET-BANK-FEES
  9255                                 THRU 0920-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 179
* ECS010D.cbl
  9256           PERFORM 0930-BUILD-CERT-TRLR
  9257                                 THRU 0930-EXIT
  9258           PERFORM 0395-GET-CERT-TRLRS
  9259                                 THRU 0395-EXIT
  9260        END-IF
  9261     END-IF
  9262
  9263     IF DTE-CLIENT = 'DCC'
  9264        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
  9265           MOVE CR-LF-CLP        TO CR-LF-NSP-PRM
  9266        END-IF
  9267        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9268           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9269              (CR-LFPRM + CR-LFPRM-ALT) -
  9270              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9271        END-IF
  9272     END-IF
  9273
  9274     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9275        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9276     ELSE
  9277        IF DTE-CLIENT = 'DCC'
  9278           IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
  9279              MOVE CR-AH-CLP        TO CR-AH-NSP-PRM
  9280           END-IF
  9281           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9282              COMPUTE CR-AH-NSP-PRM ROUNDED = CR-AHPRM -
  9283              (CR-AHPRM * CR-LCOM-AH (1))
  9284           END-IF
  9285        END-IF
  9286     END-IF
  9287
  9288     IF DTE-CLIENT = 'DCC'
  9289         IF PB-I-VIN > SPACES
  9290             PERFORM 0950-BUILD-CERT-C-TRLR THRU 0950-EXIT
  9291         END-IF
  9292     END-IF.
  9293
  9294     IF CR-ENTRY-STATUS = 'P'
  9295         MOVE '1'                   TO CR-ENTRY-STATUS.
  9296
  9297     IF CR-POLICY-IS-REISSUE  OR
  9298        CR-POLICY-IS-REIN-ONLY OR
  9299        CR-POLICY-IS-DECLINED OR
  9300        CR-POLICY-IS-VOID
  9301        OR CR-POLICY-IS-MONTHLY
  9302         GO TO 0590-END-ISSUE-PROCESSING.
  9303
  9304     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9305     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9306        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9307     END-IF
  9308     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9309
  9310     IF NOT PB-INVALID-LIFE
  9311         COMPUTE H-LFCM ROUNDED =
  9312                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9313         MOVE H-LFCM                   TO TRD-LFCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 180
* ECS010D.cbl
  9314         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9315
  9316     IF NOT PB-INVALID-AH
  9317        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9318           COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9319           + CR-ADDL-CLP)
  9320        ELSE
  9321           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9322        END-IF
  9323        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9324        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9325     END-IF
  9326
  9327     ADD +1 TO BC-G-ISS.
  9328     ADD +1 TO BC-COMM.
  9329     ADD CR-LFPRM TO BC-NET-WRIT.
  9330     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9331        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9332     END-IF
  9333     ADD CR-AHPRM TO BC-NET-WRIT.
  9334
  9335     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9336        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9337        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9338     ELSE
  9339        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9340        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9341           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9342        END-IF
  9343     END-IF
  9344
  9345     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9346         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9347     ELSE
  9348         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
  9349
  9350 0590-END-ISSUE-PROCESSING.
  9351
  9352     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9353
  9354     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9355
  9356     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  9357        NOT CR-POLICY-IS-DECLINED  AND
  9358        NOT CR-POLICY-IS-VOID
  9359         MOVE 'Y' TO BILLED-SWITCH
  9360         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9361
  9362     IF NOT CR-POLICY-IS-REISSUE  AND
  9363        NOT CR-POLICY-IS-DECLINED  AND
  9364        NOT CR-POLICY-IS-VOID
  9365        AND NOT CR-POLICY-IS-MONTHLY
  9366         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9367
  9368     MOVE '*'                   TO TRANSACTION-FLAG.
  9369     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 181
* ECS010D.cbl
  9371******************************************************************
  9372***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9373******************************************************************
  9374
  9375 0600-PROCESS-CANCELLATIONS.
  9376
  9377*     DISPLAY ' PROC CNC ' CR-FULL-CONTROL
  9378     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9379
  9380     IF AM-RECALC-COMM = ('Y' OR '1')
  9381        PERFORM 1600-RECALC-COMM-EXTR
  9382                                 THRU 1899-RECALC-COMM-EXTR-X
  9383        MOVE ' '                 TO RECALC-TYPE
  9384     END-IF
  9385
  9386     MOVE CR-LFRFND               TO LIFE-REFUND.
  9387     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9388     MOVE CR-AHRFND               TO A-H-REFUND.
  9389     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9390     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9391
  9392     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9393     IF CR-LFRFND-CALC = ZEROS
  9394         MOVE PB-C-LF-REF-CALC    TO CR-LFRFND-CALC
  9395                                     LIFE-REFUND-CALC
  9396     ELSE
  9397         MOVE PB-C-LF-CANCEL-AMT  TO CR-LFRFND-CALC.
  9398
  9399     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9400
  9401     IF CR-AHRFND-CALC = ZEROS
  9402        MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9403                                    A-H-REFUND-CALC
  9404     ELSE
  9405        MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC
  9406     END-IF
  9407
  9408     IF PB-C-POST-CARD-IND = 'Y' OR 'N'
  9409        MOVE PB-C-POST-CARD-IND  TO CR-POST-CARD-IND
  9410     ELSE
  9411        MOVE SPACES              TO CR-POST-CARD-IND
  9412     END-IF
  9413
  9414*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9415*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9416*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9417*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9418
  9419     IF PB-C-NH-INT-ON-REFS NUMERIC
  9420        AND PB-C-NH-INT-ON-REFS NOT = ZEROS
  9421        MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
  9422     END-IF
  9423
  9424     IF PB-CI-STATE-TAX NOT NUMERIC
  9425        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9426
  9427     IF PB-CI-MUNI-TAX NOT NUMERIC
  9428        MOVE ZEROS               TO PB-CI-MUNI-TAX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 182
* ECS010D.cbl
  9429
  9430     IF CR-CANCEL-STATE-TAX NUMERIC
  9431         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9432       ELSE
  9433         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9434
  9435     IF CR-CANCEL-MUNI-TAX NUMERIC
  9436         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
  9437       ELSE
  9438         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9439
  9440     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9441                                    MONTHS-DIFF-AH.
  9442
  9443     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9444
  9445 0630-PROCESS-LIFE-CANCEL.
  9446
  9447     IF CR-LFTYP = ZERO  OR
  9448        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9449         MOVE ZEROS               TO H-LFCM
  9450         GO TO 0650-PROCESS-A-H-CANCEL.
  9451
  9452     IF PB-C-LF-PREM-TAX NUMERIC
  9453        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
  9454     END-IF
  9455     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
  9456     MOVE ' '                     TO  DC-OPTION-CODE.
  9457     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9458     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
  9459                                      WS-CR-LF-CANC-DT-N.
  9460
  9461
  9462     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
  9463     MOVE ' '                    TO DC-OPTION-CODE
  9464     PERFORM 8000-DATE-CONVERT-ROUTINE
  9465                                 THRU 8099-DATE-CONVERT-X
  9466     IF CR-LF-CNC-ENT-DT NOT NUMERIC
  9467        MOVE ZEROS TO CR-LF-CNC-ENT-DT
  9468     END-IF
  9469     IF NO-CONVERSION-ERROR
  9470        IF CR-LF-CNC-ENT-DT = ZEROS
  9471           MOVE DC-GREG-DATE-CYMD TO CR-LF-CNC-ENT-DT
  9472        END-IF
  9473     END-IF
  9474
  9475     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9476     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
  9477     MOVE '1'                     TO  DC-OPTION-CODE.
  9478     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9479     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9480                                      DC-ODD-DAYS-OVER
  9481                                      DC-ELAPSED-DAYS.
  9482     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9483     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
  9484
  9485     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
  9486         ADD  +1                  TO  MONTHS-DIFF-LF.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 183
* ECS010D.cbl
  9487
  9488     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
  9489
  9490     MOVE  ZEROS                  TO  SUB.
  9491
  9492 0635-LIFE-CHARGEBACK-LOOP.
  9493
  9494     ADD    +1                    TO  SUB.
  9495
  9496     IF  SUB  GREATER THAN  +10
  9497         GO TO  0640-CONTINUE-LIFE-CANCEL.
  9498
  9499     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
  9500         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
  9501         GO TO  0635-LIFE-CHARGEBACK-LOOP.
  9502
  9503     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
  9504         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
  9505
  9506     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
  9507         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
  9508
  9509     GO TO  0635-LIFE-CHARGEBACK-LOOP.
  9510
  9511
  9512 0640-CONTINUE-LIFE-CANCEL.
  9513
  9514     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
  9515        SUBTRACT +1 FROM MONTHS-DIFF-LF.
  9516
  9517     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9518
  9519     IF DTE-CLIENT = 'GIC'
  9520         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  9521             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
  9522                                     LIFE-REFUND-CALC.
  9523
  9524*    IF DTE-CLIENT = 'TMS'
  9525     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
  9526
  9527     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
  9528         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
  9529     ELSE
  9530         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
  9531             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
  9532             MOVE '8'                  TO CR-LF-CURRENT-STATUS
  9533             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
  9534             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
  9535                                       WS-CR-LF-CANCEL-EXIT-DATE-N
  9536         ELSE
  9537             IF CR-LF-CURRENT-STATUS = '6'
  9538                 MOVE '8'              TO CR-LF-CURRENT-STATUS
  9539                 MOVE PB-C-LF-COMM-CHARGEBACK
  9540                                       TO CR-LF-COMM-CHARGEBACK
  9541                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
  9542                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
  9543
  9544*************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 184
* ECS010D.cbl
  9545***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9546***  WAS CONVERTED TO 1056 BYTES.             ***
  9547*************************************************
  9548     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
  9549
  9550     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
  9551     MOVE CR-LF-TERM                   TO TRD-LFTRM.
  9552     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
  9553
  9554     COMPUTE H-LFCM ROUNDED =
  9555                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
  9556     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
  9557
  9558     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
  9559     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
  9560     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
  9561     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
  9562
  9563     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
  9564     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
  9565
  9566 0650-PROCESS-A-H-CANCEL.
  9567
  9568     IF CR-AHTYP = ZERO  OR
  9569        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
  9570         MOVE ZEROS               TO H-AHCM
  9571         GO TO 0660-PROCESS-CANCEL-CONTINUE.
  9572
  9573*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9574*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9575*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9576*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9577
  9578     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
  9579     MOVE ' '                     TO  DC-OPTION-CODE.
  9580     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9581     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
  9582                                      WS-CR-AH-CANC-DT-N.
  9583
  9584     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
  9585     MOVE ' '                    TO DC-OPTION-CODE
  9586     PERFORM 8000-DATE-CONVERT-ROUTINE
  9587                                 THRU 8099-DATE-CONVERT-X
  9588     IF CR-AH-CNC-ENT-DT NOT NUMERIC
  9589        MOVE ZEROS TO CR-AH-CNC-ENT-DT
  9590     END-IF
  9591     IF NO-CONVERSION-ERROR
  9592        IF CR-AH-CNC-ENT-DT = ZEROS
  9593           MOVE DC-GREG-DATE-CYMD TO CR-AH-CNC-ENT-DT
  9594        END-IF
  9595     END-IF
  9596
  9597     IF PB-C-AH-PREM-TAX NUMERIC
  9598        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
  9599     END-IF
  9600     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9601     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
  9602     MOVE '1'                     TO  DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 185
* ECS010D.cbl
  9603     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9604     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9605                                      DC-ODD-DAYS-OVER
  9606                                      DC-ELAPSED-DAYS.
  9607     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9608     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
  9609
  9610     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
  9611          ADD  +1                 TO  MONTHS-DIFF-AH.
  9612
  9613     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
  9614     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
  9615        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
  9616     END-IF
  9617*    IF DTE-CLIENT = 'DCC'
  9618*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9619*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
  9620*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
  9621*             (CR-BANK-NO = CR-COM-AGT (SUB))
  9622*             OR (SUB > +10)
  9623*          END-PERFORM
  9624*          IF CR-BANK-NO = CR-COM-AGT (SUB)
  9625*             MOVE CR-BANK-NOCHRGB-MONTHS
  9626*                                TO AM-COMM-CHARGEBACK (SUB)
  9627*          END-IF
  9628*       END-IF
  9629*    END-IF
  9630
  9631
  9632     MOVE 'Y'                     TO WS-FIRST-K
  9633     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
  9634     MOVE  ZEROS                  TO  SUB.
  9635
  9636 0653-A-H-CHARGEBACK-LOOP.
  9637
  9638     ADD    +1                    TO  SUB.
  9639
  9640     IF  SUB  GREATER THAN  +10
  9641         GO TO  0655-CONTINUE-A-H-CANCEL.
  9642
  9643     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
  9644         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
  9645         GO TO  0653-A-H-CHARGEBACK-LOOP.
  9646
  9647     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
  9648         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
  9649
  9650     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
  9651         OR ((DTE-CLIENT = 'DCC')
  9652             AND (CR-AHRFND = ZEROS))
  9653         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
  9654
  9655     GO TO  0653-A-H-CHARGEBACK-LOOP.
  9656
  9657
  9658 0655-CONTINUE-A-H-CANCEL.
  9659
  9660     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 186
* ECS010D.cbl
  9661        SUBTRACT +1 FROM MONTHS-DIFF-AH.
  9662
  9663     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
  9664
  9665     IF DTE-CLIENT = 'GIC'
  9666         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
  9667             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
  9668                                     A-H-REFUND-CALC.
  9669
  9670*    IF DTE-CLIENT = 'TMS'
  9671     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
  9672*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
  9673
  9674
  9675     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
  9676         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
  9677     ELSE
  9678         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
  9679             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
  9680             MOVE '8'                  TO CR-AH-CURRENT-STATUS
  9681             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
  9682             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
  9683                                     WS-CR-AH-CANCEL-EXIT-DATE-N
  9684         ELSE
  9685             IF CR-AH-CURRENT-STATUS = '7'
  9686                 MOVE '8'              TO CR-AH-CURRENT-STATUS
  9687                 MOVE PB-C-AH-COMM-CHARGEBACK
  9688                                       TO CR-AH-COMM-CHARGEBACK
  9689                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
  9690                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
  9691
  9692*************************************************
  9693***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9694***  WAS CONVERTED TO 1056 BYTES.             ***
  9695*************************************************
  9696     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
  9697
  9698     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
  9699     MOVE CR-AH-TERM                   TO TRD-AHTRM.
  9700     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
  9701
  9702     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9703        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
  9704        COMPUTE H-AHCM ROUNDED = CNC-FACT *
  9705           (CR-AHPRM - (CR-LFPRM-ALT
  9706           + CR-ADDL-CLP)) * -1
  9707     ELSE
  9708        COMPUTE H-AHCM ROUNDED =
  9709          (CR-AHRFND * ACCT-COMM-AH) * (-1)
  9710     END-IF
  9711
  9712     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
  9713
  9714     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
  9715     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
  9716     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
  9717     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
  9718
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 187
* ECS010D.cbl
  9719     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
  9720     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
  9721
  9722 0660-PROCESS-CANCEL-CONTINUE.
  9723
  9724     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9725
  9726     IF CR-POLICY-IS-REIN-ONLY
  9727        GO TO 0660-CONT.
  9728
  9729     MOVE 'Y'                    TO BILLED-SWITCH.
  9730     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
  9731
  9732     IF CR-POLICY-IS-MONTHLY
  9733        GO TO 0660-CONT
  9734     END-IF
  9735
  9736     ADD +1                      TO BC-G-CNC.
  9737     ADD +1                      TO BC-COMM.
  9738     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
  9739     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
  9740     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
  9741     ADD H-LFCM                  TO TPL-ACCT-COM (1).
  9742     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
  9743     ADD H-AHCM                  TO TPA-ACCT-COM (1).
  9744
  9745     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9746         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
  9747     ELSE
  9748         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
  9749
  9750     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9751         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
  9752     ELSE
  9753         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
  9754
  9755
  9756 0660-CONT.
  9757
  9758     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
  9759     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
  9760
  9761     IF CR-LFRFND NEGATIVE
  9762       IF CR-LFRFND + LIFE-REFUND = ZEROS
  9763           MOVE '*'                 TO REIN-VOID-LF-SW.
  9764     IF CR-AHRFND NEGATIVE
  9765       IF CR-AHRFND + A-H-REFUND = ZEROS
  9766           MOVE '*'                 TO REIN-VOID-AH-SW.
  9767
  9768     IF CR-LFRFND NOT = ZEROS
  9769       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
  9770           MOVE '*'                 TO REIN-ADDL-LF-SW.
  9771     IF CR-AHRFND NOT = ZEROS
  9772       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
  9773           MOVE '*'                 TO REIN-ADDL-AH-SW.
  9774
  9775     IF CR-DT = CR-LF-CANC-DT
  9776       MOVE '*'                     TO REIN-CANCEL-LF-SW.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 188
* ECS010D.cbl
  9777     IF CR-DT = CR-AH-CANC-DT
  9778       MOVE '*'                     TO REIN-CANCEL-AH-SW.
  9779
  9780     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
  9781
  9782     MOVE SPACES                    TO REIN-VOID-LF-SW
  9783                                       REIN-VOID-AH-SW
  9784                                       REIN-ADDL-LF-SW
  9785                                       REIN-ADDL-AH-SW.
  9786
  9787     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
  9788     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
  9789
  9790     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
  9791     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
  9792
  9793     IF (CR-LFTYP NOT = ZERO  AND
  9794        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
  9795        (CR-AHTYP NOT = ZERO  AND
  9796        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
  9797         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
  9798         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
  9799
  9800 0670-LIFE-CANCEL-VOID.
  9801
  9802     IF CR-LFTYP NOT = ZERO  AND
  9803        CR-LFRFND = ZERO  AND
  9804        PB-C-LF-CANCEL-AMT NEGATIVE
  9805         NEXT SENTENCE
  9806     ELSE
  9807         GO TO 0680-A-H-CANCEL-VOID.
  9808
  9809     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
  9810                                       WS-CR-LF-CANCEL-EXIT-DATE-N
  9811                                          CR-LF-CANC-DT
  9812                                          WS-CR-LF-CANC-DT-N
  9813                                          CR-LFRFND-CALC.
  9814
  9815     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
  9816
  9817     IF CR-LF-CANCEL-APPLIED
  9818         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
  9819         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
  9820     ELSE
  9821         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
  9822         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
  9823
  9824     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9825
  9826     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
  9827     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
  9828
  9829     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9830
  9831 0680-A-H-CANCEL-VOID.
  9832
  9833     IF CR-AHTYP NOT = ZERO  AND
  9834        CR-AHRFND = ZERO  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 189
* ECS010D.cbl
  9835        PB-C-AH-CANCEL-AMT NEGATIVE
  9836         NEXT SENTENCE
  9837     ELSE
  9838         GO TO 0690-END-CANCEL-PROCESSING.
  9839
  9840     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
  9841                                     WS-CR-AH-CANCEL-EXIT-DATE-N
  9842                                        CR-AH-CANC-DT
  9843                                        WS-CR-AH-CANC-DT-N
  9844                                        CR-AHRFND-CALC.
  9845
  9846     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
  9847
  9848     IF CR-AH-CANCEL-APPLIED
  9849         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
  9850         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
  9851     ELSE
  9852         MOVE CR-AH-STATUS-AT-CANCEL
  9853                                    TO CR-AH-STATUS-AT-SETTLEMENT
  9854         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
  9855
  9856     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9857
  9858     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
  9859     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
  9860
  9861     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9862
  9863 0690-END-CANCEL-PROCESSING.
  9864
  9865     IF CR-LF-CANC-DT = ZEROS  AND
  9866        CR-AH-CANC-DT = ZEROS
  9867         MOVE ZEROS             TO CR-NH-INT-ON-REF
  9868     END-IF
  9869
  9870     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
  9871         NEXT SENTENCE
  9872     ELSE
  9873         MOVE 'X'               TO REIN-RT-SW
  9874         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
  9875         MOVE ' '               TO REIN-RT-SW.
  9876
  9877     MOVE '*'                   TO TRANSACTION-FLAG.
  9878     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9879
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 190
* ECS010D.cbl
  9881******************************************************************
  9882***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
  9883******************************************************************
  9884
  9885 0700-PROCESS-CLAIMS.
  9886
  9887     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
  9888        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
  9889         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
  9890             PENDING-MATCH-CONTROL
  9891         MOVE 0301 TO WS-ABEND-CODE
  9892         DISPLAY '******************************'
  9893         DISPLAY '***** ERROR LOCATION 011 *****'
  9894         DISPLAY '******************************'
  9895         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9896         GO TO ABEND-PGM.
  9897
  9898     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9899
  9900     ADD +1                       TO  W-LF-CLAIMS.
  9901
  9902     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
  9903     MOVE ' '                     TO  DC-OPTION-CODE.
  9904     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9905     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
  9906
  9907     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
  9908     MOVE ' '                     TO  DC-OPTION-CODE.
  9909     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9910     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
  9911
  9912     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
  9913     MOVE ' '                     TO  DC-OPTION-CODE.
  9914     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9915     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
  9916
  9917     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
  9918     MOVE ' '                     TO  DC-OPTION-CODE.
  9919     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9920     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
  9921
  9922     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9923
  9924     IF DTE-CLIENT = 'LAP'  OR  'RMC'
  9925       MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
  9926       IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
  9927         IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
  9928             MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
  9929         ELSE
  9930             ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
  9931
  9932     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
  9933         GO TO 0750-PROCESS-DISABILITY-CLAIM.
  9934
  9935******************************************************************
  9936***           P R O C E S S   D E A T H   C L A I M            ***
  9937******************************************************************
  9938
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 191
* ECS010D.cbl
  9939     IF REIN-IS-RISK-PREMIUM
  9940       IF CR-DTH-DT = ZEROS
  9941           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
  9942           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
  9943           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
  9944
  9945     MOVE INCURRED-DATE            TO CR-DTH-DT
  9946                                      WS-CR-DTH-DT-N.
  9947
  9948     IF PC-CHARGEBLE-EXPENSE  OR
  9949        PC-NON-CHARGEBLE-EXPENSE
  9950         IF CR-LFTYP = '00'
  9951             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
  9952             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
  9953                     8399-LIFE-LOOKUP-X.
  9954
  9955     IF PC-CHARGEBLE-EXPENSE  OR
  9956        PC-NON-CHARGEBLE-EXPENSE
  9957         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
  9958         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
  9959         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
  9960         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
  9961         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
  9962         GO TO 0780-END-CLAIMS-PROCESSING.
  9963
  9964     ADD +1                       TO  CR-NUM-DTH-CLM.
  9965     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
  9966     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
  9967                                      WS-CR-DTH-PAY-DT-N.
  9968
  9969     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
  9970     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
  9971     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
  9972     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
  9973     IF CR-DTH-PAY-CD NOT = 'F'
  9974         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
  9975     INSPECT CR-DTH-PAY-CD
  9976         CONVERTING '12349' TO 'PFSXV'.
  9977     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
  9978
  9979     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
  9980         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
  9981       AND
  9982       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
  9983       OR
  9984        DTE-CLIENT = 'ACC' OR 'FDL')
  9985        NEXT SENTENCE
  9986     ELSE
  9987     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
  9988         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
  9989             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
  9990             MOVE '7'            TO CR-LF-CURRENT-STATUS
  9991             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
  9992                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
  9993
  9994     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
  9995     MOVE CR-LF-TERM                   TO TRD-LFTRM.
  9996     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 192
* ECS010D.cbl
  9997     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
  9998         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
  9999     ELSE
 10000         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
 10001     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
 10002
 10003     IF NOT CR-POLICY-IS-REIN-ONLY
 10004         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
 10005
 10006 0720-CANCEL-AH-COVERAGE.
 10007
 10008     IF CR-AHTYP = ZEROS  OR
 10009        NOT CR-AH-POLICY-IS-ACTIVE
 10010         GO TO 0740-DEATH-CLAIM-VOID.
 10011
 10012     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
 10013     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
 10014     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
 10015                                           WS-CR-AH-CANC-DT-N.
 10016     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
 10017                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
 10018
 10019     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
 10020     MOVE CR-AH-TERM                    TO TRD-AHTRM.
 10021     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
 10022     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
 10023     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
 10024     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
 10025     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
 10026     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10027
 10028 0740-DEATH-CLAIM-VOID.
 10029
 10030     IF CR-DTHAMT = ZERO  AND
 10031        PC-CLAIM-PAYMENT NEGATIVE
 10032         NEXT SENTENCE
 10033     ELSE
 10034         GO TO 0780-END-CLAIMS-PROCESSING.
 10035
 10036     MOVE '*'                           TO DEATH-VOID-FLAG.
 10037
 10038     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
 10039                                        WS-CR-LF-CLAIM-EXIT-DATE-N
 10040                                           CR-NUM-DTH-CLM
 10041                                           CR-DTH-RPT-DT
 10042                                           CR-DTH-PAY-DT
 10043                                           WS-CR-DTH-PAY-DT-N
 10044*                                          CR-DTHAMT-YTD
 10045*                                          CR-DTHAMT-LAST
 10046                                           CR-DTH-AGE.
 10047     MOVE ' '                           TO CR-DTH-PAY-CD.
 10048
 10049     IF CR-LF-DEATH-CLAIM-APPLIED
 10050         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
 10051         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
 10052     ELSE
 10053         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
 10054         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 193
* ECS010D.cbl
 10055
 10056     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
 10057     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10058
 10059     IF CR-AH-DEATH-CLAIM-APPLIED
 10060         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10061         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10062         MOVE ZEROS                     TO CR-AH-CANC-DT
 10063                                           WS-CR-AH-CANC-DT-N
 10064                                           CR-AH-CANCEL-EXIT-DATE
 10065                                       WS-CR-AH-CANCEL-EXIT-DATE-N
 10066         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
 10067         MOVE CR-AH-TERM                TO TRD-AHTRM
 10068         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
 10069         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
 10070
 10071     GO TO 0780-END-CLAIMS-PROCESSING.
 10072
 10073******************************************************************
 10074***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
 10075******************************************************************
 10076
 10077 0750-PROCESS-DISABILITY-CLAIM.
 10078
 10079     ADD +1                       TO W-AH-CLAIMS.
 10080
 10081     MOVE INCURRED-DATE           TO CR-DIS-DT
 10082                                     WS-CR-DIS-DT-N.
 10083
 10084     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10085
 10086     IF REIN-AH-CLM-MONTHS = +1
 10087         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10088     ELSE
 10089       IF REIN-AH-CLM-MONTHS = +2
 10090           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10091       ELSE
 10092         IF REIN-AH-CLM-MONTHS = +3
 10093             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10094         ELSE
 10095           IF REIN-AH-CLM-MONTHS = +4
 10096               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10097           ELSE
 10098               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10099
 10100     IF PC-CHARGEBLE-EXPENSE  OR
 10101        PC-NON-CHARGEBLE-EXPENSE
 10102         IF CR-AHTYP = '00'
 10103             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10104             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10105                     8499-A-H-LOOKUP-X.
 10106
 10107     IF PC-CHARGEBLE-EXPENSE  OR
 10108        PC-NON-CHARGEBLE-EXPENSE
 10109         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10110         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10111         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10112         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 194
* ECS010D.cbl
 10113         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10114         GO TO 0780-END-CLAIMS-PROCESSING.
 10115
 10116     ADD +1                       TO CR-NUM-DIS-CLM.
 10117
 10118     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10119     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10120                                      WS-CR-DIS-PAY-DT-N.
 10121     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10122                                      WS-CR-DIS-PTO-DT-N.
 10123
 10124     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10125     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10126     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10127
 10128     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10129     IF CR-DIS-PAY-CD NOT = 'S'
 10130         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10131     INSPECT CR-DIS-PAY-CD
 10132         CONVERTING '12349' TO 'PFSXV'.
 10133     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10134
 10135     IF PC-LUMP-SUM-PAYMENT
 10136         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10137           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10138           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10139           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10140                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10141
 10142     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10143     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10144     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10145     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10146     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10147
 10148     IF NOT CR-POLICY-IS-REIN-ONLY
 10149         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10150
 10151     IF NOT PC-LUMP-SUM-PAYMENT
 10152         GO TO 0780-END-CLAIMS-PROCESSING.
 10153
 10154 0770-CANCEL-LF-COVERAGE.
 10155
 10156     IF CR-LFTYP = ZEROS  OR
 10157        NOT CR-LF-POLICY-IS-ACTIVE
 10158         GO TO 0780-END-CLAIMS-PROCESSING.
 10159
 10160     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10161     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10162     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10163                                           WS-CR-LF-CANC-DT-N.
 10164     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10165                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10166
 10167     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10168     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10169     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10170     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 195
* ECS010D.cbl
 10171     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10172     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10173     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10174     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10175
 10176 0780-END-CLAIMS-PROCESSING.
 10177
 10178     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10179         MOVE DTO-MO               TO TRD-LFACTMO
 10180         MOVE DTO-DA               TO TRD-LFACTDA
 10181         MOVE DTO-YR               TO TRD-LFACTYR
 10182         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10183     ELSE
 10184         MOVE PAY-MO               TO TRD-AHACTMO
 10185         MOVE PAY-DA               TO TRD-AHACTDA
 10186         MOVE PAY-YR               TO TRD-AHACTYR
 10187         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10188
 10189     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10190
 10191     IF NOT CR-POLICY-IS-REIN-ONLY
 10192         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10193         ADD +1                    TO BC-G-CLM.
 10194
 10195     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10196
 10197     IF DEATH-CLAIM-VOIDED
 10198         MOVE ZEROS                TO CR-DTH-DT
 10199                                      WS-CR-DTH-DT-N.
 10200     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10201
 10202     MOVE '*'                      TO TRANSACTION-FLAG.
 10203     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10204
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 196
* ECS010D.cbl
 10206 0790-TABLE-DISAB-PERIODS.
 10207
 10208     MOVE +1                       TO SUB14.
 10209     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10210
 10211     MOVE +1                       TO SUB14.
 10212
 10213**************************************************************
 10214**                                                          **
 10215**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10216**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10217**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10218**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10219**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10220**                                                          **
 10221**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10222**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10223**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10224**                                                          **
 10225**************************************************************
 10226
 10227 0791-TABLE-AH-AMOUNT.
 10228
 10229     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10230         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10231
 10232     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10233         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10234                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10235         IF REIN-IS-RISK-PREMIUM
 10236             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10237             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10238             IF SUB14 = +1
 10239               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10240             ELSE
 10241             IF SUB14 = +2
 10242               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10243             ELSE
 10244             IF SUB14 = +3
 10245               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10246             ELSE
 10247             IF SUB14 = +4
 10248               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10249             ELSE
 10250               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10251
 10252
 10253     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10254         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10255         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10256                                        +  CR-INCUR-DISEXP (SUB14)
 10257         IF PC-CHARGEBLE-EXPENSE  OR
 10258            PC-NON-CHARGEBLE-EXPENSE
 10259             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10260             GO TO 0791-TABLE-AH-EXIT
 10261         ELSE
 10262             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10263             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 197
* ECS010D.cbl
 10264
 10265     ADD +1                       TO SUB14.
 10266
 10267     GO TO 0791-TABLE-AH-AMOUNT.
 10268
 10269 0791-TABLE-AH-EXIT.
 10270     EXIT.
 10271
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 198
* ECS010D.cbl
 10273**************************************************************
 10274**                                                          **
 10275** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10276** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10277**                                                          **
 10278** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 10279** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 10280** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 10281** OCCURRENCE.                                              **
 10282**************************************************************
 10283 0792-MOVE-TABLE.
 10284
 10285     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 10286                                  WS-CR-DIS-INCUR-DT-N (1).
 10287     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 10288     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 10289
 10290     MOVE +2                   TO SUB14.
 10291     MOVE +3                   TO SUB15.
 10292     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 10293
 10294     MOVE DISABILITY-TBL-MAX   TO SUB14.
 10295
 10296     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10297                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 10298
 10299 0792-MOVE-TABLE-EXIT.
 10300     EXIT.
 10301
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 199
* ECS010D.cbl
 10303**************************************************************
 10304**                                                          **
 10305**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 10306** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 10307** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 10308** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 10309** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 10310**************************************************************
 10311
 10312 0794-REVIEW-TABLE.
 10313
 10314     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10315         GO TO 0794-REVIEW-TABLE-EXIT.
 10316
 10317     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 10318         GO TO 0794-REVIEW-TABLE-EXIT.
 10319
 10320     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 10321        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 10322         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 10323         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 10324                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 10325         MOVE SUB14            TO SUB15
 10326         ADD +1                TO SUB15
 10327         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 10328         MOVE +1               TO SUB14
 10329         GO TO 0794-REVIEW-TABLE.
 10330
 10331     ADD +1                    TO SUB14.
 10332
 10333     GO TO 0794-REVIEW-TABLE.
 10334
 10335 0794-REVIEW-TABLE-EXIT.
 10336     EXIT.
 10337
 10338 0794A-BUMP-TBL.
 10339
 10340     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 10341         GO TO 0794A-BUMP-TBL-EXIT.
 10342
 10343     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 10344                             CR-DISAB-DETAIL-DATA (SUB14).
 10345
 10346     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 10347                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 10348                                  CR-INCUR-DISAMT (SUB15)
 10349                                  CR-INCUR-DISEXP (SUB15).
 10350
 10351     ADD +1                    TO SUB14
 10352                                  SUB15.
 10353     GO TO 0794A-BUMP-TBL.
 10354
 10355 0794A-BUMP-TBL-EXIT.
 10356     EXIT.
 10357
 10358 0795-DCC-NSP-LF.
 10359
 10360     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 200
* ECS010D.cbl
 10361     MOVE 'L'                        TO DC-OPTION-CODE.
 10362     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10363     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 10364     MOVE SPACES                     TO CP-ACCT-FLD-5.
 10365     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 10366     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 10367     MOVE CR-APR                     TO CP-LOAN-APR.
 10368     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 10369     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 10370     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 10371     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 10372
 10373     MOVE '3'                        TO CP-PROCESS-TYPE.
 10374     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 10375     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 10376
 10377     IF CR-LFTYP = ZERO
 10378         GO TO 0795-EXIT
 10379     END-IF
 10380
 10381     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 10382         GO TO 0795-EXIT
 10383     END-IF
 10384     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 10385     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 10386     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 10387     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 10388                                        CP-RATING-BENEFIT-AMT.
 10389     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 10390     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 10391     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 10392     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 10393     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 10394     MOVE CR-STATE                   TO CP-STATE.
 10395     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 10396
 10397     IF CP-STATE-STD-ABBRV = 'OR'
 10398         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 10399
 10400     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 10401
 10402     IF CP-ERROR-RATE-NOT-FOUND  OR
 10403        CP-ERROR-RATE-IS-ZERO
 10404         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 10405                                     TO WS-ABEND-MESSAGE
 10406         MOVE 0302                   TO WS-ABEND-CODE
 10407         DISPLAY '******************************'
 10408         DISPLAY '***** ERROR LOCATION 018 *****'
 10409         DISPLAY '******************************'
 10410         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10411         GO TO ABEND-PGM.
 10412
 10413     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 10414
 10415*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 10416*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 10417
 10418     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 201
* ECS010D.cbl
 10419                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 10420
 10421     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 10422
 10423 0795-exit.
 10424     exit.
 10425
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 202
* ECS010D.cbl
 10427******************************************************************
 10428***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 10429******************************************************************
 10430
 10431 0800-PROCESS-RESERVES.
 10432
 10433     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10434       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 10435           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 10436
 10437     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10438
 10439     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10440     MOVE ' '                     TO  DC-OPTION-CODE.
 10441     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10442     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10443
 10444     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10445     MOVE ' '                     TO  DC-OPTION-CODE.
 10446     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10447     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10448
 10449     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10450     MOVE ' '                     TO  DC-OPTION-CODE.
 10451     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10452     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10453
 10454     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10455
 10456     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10457         ADD +1                     TO W-LF-RESERVES
 10458         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 10459         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 10460         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 10461         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 10462         MOVE INCURRED-DATE         TO CR-DTH-DT
 10463                                       WS-CR-DTH-DT-N
 10464         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 10465
 10466     ELSE
 10467         ADD +1                     TO W-AH-RESERVES
 10468         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 10469         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 10470         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 10471         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 10472         MOVE INCURRED-DATE         TO CR-DIS-DT
 10473                                       WS-CR-DIS-DT-N
 10474         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 10475
 10476     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 10477     MOVE 'IBNR'                    TO TRD-IBNRX.
 10478     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 10479     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 10480     COMPUTE TRD-FUTRSV EQUAL
 10481            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 10482     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 10483     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 10484
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 203
* ECS010D.cbl
 10485 0820-END-RESERVE-PROCESSING.
 10486
 10487     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10488
 10489     IF NOT CR-POLICY-IS-REIN-ONLY
 10490         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 10491                                            2499-BLD-RESERVE-X
 10492         ADD +1 TO BC-G-CRS.
 10493
 10494     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 10495
 10496     MOVE '*'                    TO TRANSACTION-FLAG.
 10497     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10498
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 204
* ECS010D.cbl
 10500******************************************************************
 10501***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 10502******************************************************************
 10503
 10504 0900-PROCESS-CERT-CHANGES.
 10505
 10506     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10507
 10508     IF CC-AGE NOT NUMERIC  OR
 10509        CC-AGE = CR-AGE
 10510         MOVE ZEROS TO CC-AGE.
 10511
 10512     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 10513        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 10514         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 10515
 10516     IF CC-INSURED-SEX NOT = 'M'  AND
 10517        CC-INSURED-SEX NOT = 'F'
 10518         MOVE SPACES TO CC-INSURED-SEX.
 10519
 10520     IF CC-LOAN-APR NOT NUMERIC  OR
 10521        CC-LOAN-APR = CR-APR
 10522         MOVE ZEROS TO CC-LOAN-APR.
 10523
 10524     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 10525        CC-PAY-FREQUENCY = CR-PMT-FREQ
 10526         MOVE ZEROS TO CC-PAY-FREQUENCY.
 10527
 10528     IF CC-IND-GRP-TYPE NOT = '1'  AND
 10529        CC-IND-GRP-TYPE NOT = '2'
 10530         MOVE SPACES TO CC-IND-GRP-TYPE.
 10531
 10532     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC  OR
 10533        CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 10534         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 10535
 10536     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 10537        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 10538         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 10539
 10540     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 10541        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 10542        CR-LFTYP = ZEROS
 10543         MOVE ZEROS TO CC-LF-ORIG-TERM.
 10544
 10545     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 10546        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 10547        CR-AHTYP = ZEROS
 10548         MOVE ZEROS TO CC-AH-ORIG-TERM.
 10549
 10550     IF CR-BILLED NOT NUMERIC
 10551         MOVE ZEROS TO CR-BILLED.
 10552
 10553     IF CR-LIVES NOT NUMERIC
 10554         MOVE ZEROS TO CR-LIVES.
 10555
 10556     IF CC-LIVES NOT NUMERIC  OR
 10557        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 205
* ECS010D.cbl
 10558         MOVE ZEROS TO CC-LIVES.
 10559
 10560     IF CC-BILLED NOT NUMERIC  OR
 10561        CC-BILLED = CR-BILLED
 10562         MOVE ZEROS TO CC-BILLED.
 10563
 10564     IF CC-INSURED-LAST-NAME NOT = SPACES
 10565         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 10566     IF CC-INSURED-FIRST-NAME NOT = SPACES
 10567         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 10568     IF CC-INSURED-INITIAL2 NOT = SPACES
 10569         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 10570     IF CC-JT-LAST-NAME NOT = SPACES
 10571         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 10572     IF CC-JT-FIRST-NAME NOT = SPACES
 10573         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 10574     IF CC-JT-INITIAL NOT = SPACES
 10575         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 10576
 10577     IF CC-AGE NOT = ZEROS
 10578         MOVE CC-AGE                 TO CR-AGE
 10579                                        DET-AGE
 10580     ELSE
 10581         MOVE ZEROS                  TO DET-AGE.
 10582
 10583     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 10584         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 10585                                        DET-JT-AGE
 10586     ELSE
 10587         MOVE ZEROS                  TO DET-JT-AGE.
 10588
 10589     IF CC-INSURED-SEX NOT = SPACES
 10590         MOVE CC-INSURED-SEX         TO CR-SEX
 10591                                        DET-SEX
 10592     ELSE
 10593         MOVE SPACE                  TO DET-SEX.
 10594
 10595     IF CC-MEMBER-NO NOT = SPACES
 10596         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 10597                                        DET-PR-MEM
 10598     ELSE
 10599         MOVE SPACES                 TO DET-PR-MEM.
 10600
 10601     IF CC-SOC-SEC-NO NOT = SPACES
 10602         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 10603                                        DET-PR-SS
 10604     ELSE
 10605         MOVE SPACES                 TO DET-PR-SS.
 10606
 10607     IF CC-LOAN-APR NOT = ZEROS
 10608         MOVE CC-LOAN-APR            TO CR-APR
 10609                                        DET-PR-APR
 10610     ELSE
 10611         MOVE ZEROS                  TO DET-PR-APR.
 10612
 10613     IF CC-AGE NOT = ZERO  OR
 10614        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 10615        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 206
* ECS010D.cbl
 10616        CC-MEMBER-NO NOT = SPACES  OR
 10617        CC-SOC-SEC-NO NOT = SPACES  OR
 10618        CC-LOAN-APR NOT = ZERO
 10619         MOVE DET-PR-UREC            TO TR-DTL2
 10620         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10621         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10622
 10623     IF CC-LF-ORIG-TERM NOT = ZEROS
 10624         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 10625         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 10626                                        DET-N-LF-TERM
 10627     ELSE
 10628         MOVE ZEROS                  TO DET-O-LF-TERM
 10629                                        DET-N-LF-TERM.
 10630
 10631     IF CC-AH-ORIG-TERM NOT = ZEROS
 10632         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 10633         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 10634                                        DET-N-AH-TERM
 10635     ELSE
 10636         MOVE ZEROS                  TO DET-O-AH-TERM
 10637                                        DET-N-AH-TERM.
 10638
 10639     IF CC-LIVES NOT = ZEROS
 10640         MOVE CR-LIVES               TO DET-O-LIVES
 10641         MOVE CC-LIVES               TO CR-LIVES
 10642                                        DET-N-LIVES
 10643     ELSE
 10644         MOVE ZEROS                  TO DET-O-LIVES
 10645                                        DET-N-LIVES.
 10646
 10647     IF CC-BILLED NOT  = ZEROES
 10648         MOVE CC-BILLED              TO CR-BILLED.
 10649
 10650     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 10651        CC-AH-ORIG-TERM NOT = ZERO  OR
 10652        CC-LIVES NOT = ZERO
 10653         MOVE DET-PR-UREC-2          TO TR-DTL2
 10654         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10655         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10656
 10657     IF CC-IND-GRP-TYPE NOT = SPACES
 10658         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 10659                                        DET-IND-GRP
 10660     ELSE
 10661         MOVE SPACE                  TO DET-IND-GRP.
 10662
 10663     IF CC-PAY-FREQUENCY NOT = ZEROS
 10664         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 10665                                        DET-PMT-FREQ
 10666     ELSE
 10667         MOVE ZEROS                  TO DET-PMT-FREQ.
 10668
 10669     IF CC-POLICY-FORM-NO NOT = SPACES
 10670         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 10671                                        DET-POL-FORM
 10672     ELSE
 10673         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 207
* ECS010D.cbl
 10674
 10675     IF CC-LOAN-OFFICER NOT = SPACES
 10676         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 10677                                        DET-LOAN-OFFICER
 10678     ELSE
 10679         MOVE SPACES                 TO DET-LOAN-OFFICER.
 10680
 10681     IF CC-USER-FIELD NOT = SPACES
 10682         MOVE CC-USER-FIELD          TO CR-USER-CODE
 10683                                        DET-USER-CODE
 10684     ELSE
 10685         MOVE SPACE                  TO DET-USER-CODE.
 10686
 10687     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 10688        CC-PAY-FREQUENCY NOT = ZEROS  OR
 10689        CC-POLICY-FORM-NO NOT = SPACES  OR
 10690        CC-LOAN-OFFICER NOT = SPACES  OR
 10691        CC-USER-FIELD NOT = SPACES
 10692         MOVE DET-PR-UREC-3          TO TR-DTL2
 10693         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10694         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10695
 10696     IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 10697         MOVE CC-CLAIM-DEDUCT-WITHHELD
 10698                                     TO CR-CLAIM-DEDUCT-WITHHELD
 10699                                        DET-CLM-DEDUCT
 10700     ELSE
 10701         MOVE ZEROS                  TO DET-CLM-DEDUCT.
 10702
 10703     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 10704         MOVE CC-CANCEL-DEDUCT-WITHHELD
 10705                                     TO CR-CANCEL-DEDUCT-WITHHELD
 10706                                        DET-CAN-DEDUCT
 10707     ELSE
 10708         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 10709
 10710     IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 10711        CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 10712         MOVE DET-PR-UREC-4          TO TR-DTL2
 10713         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10714         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10715
 10716     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 10717         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 10718
 10719     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 10720         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 10721
 10722     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 10723         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 10724
 10725     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 10726         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 10727
 10728     IF CC-LF-BENEFIT-CD NOT = SPACES
 10729         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 10730                                     DET-LF-BEN-CD
 10731     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 208
* ECS010D.cbl
 10732         MOVE SPACES             TO DET-LF-BEN-CD.
 10733
 10734     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 10735         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 10736                                     DET-LF-PREM
 10737     ELSE
 10738         MOVE ZEROS              TO DET-LF-PREM.
 10739
 10740     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 10741         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 10742                                     DET-LF-BEN
 10743     ELSE
 10744         MOVE ZEROS              TO DET-LF-BEN.
 10745
 10746     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 10747        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 10748        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 10749         MOVE DET-PR-UREC-5          TO TR-DTL2
 10750         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10751         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10752
 10753     IF CC-AH-BENEFIT-CD NOT = SPACES
 10754         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 10755                                     DET-AH-BEN-CD
 10756     ELSE
 10757         MOVE SPACES             TO DET-AH-BEN-CD.
 10758
 10759     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 10760         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 10761                                     DET-AH-PREM
 10762     ELSE
 10763         MOVE ZEROS              TO DET-AH-PREM.
 10764
 10765     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 10766         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 10767                                     DET-AH-BEN
 10768     ELSE
 10769         MOVE ZEROS              TO DET-AH-BEN.
 10770
 10771     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 10772        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 10773        CC-AH-BENEFIT-AMT NOT = ZEROS
 10774         MOVE DET-PR-UREC-6          TO TR-DTL2
 10775         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10776         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10777
 10778 0910-END-CHANGE-PROCESSING.
 10779
 10780     IF CR-LNAME = ALL '*'
 10781         MOVE SPACES                 TO CR-LNAME.
 10782     IF CR-FNAME = ALL '*'
 10783         MOVE SPACES                 TO CR-FNAME.
 10784     IF CR-INIT = '*'
 10785         MOVE SPACES                 TO CR-INIT.
 10786     IF CR-SOC-SEC = ALL '*'
 10787         MOVE SPACES                 TO CR-SOC-SEC.
 10788     IF CR-JT-LNAME = ALL '*'
 10789         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 209
* ECS010D.cbl
 10790     IF CR-JT-FNAME = ALL '*'
 10791         MOVE SPACES                 TO CR-JT-FNAME.
 10792     IF CR-JT-INIT = '*'
 10793         MOVE SPACES                 TO CR-JT-INIT.
 10794     IF CR-POLICY-FORM-NO = ALL '*'
 10795         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 10796     IF CR-MEMBER-NO = ALL '*'
 10797         MOVE SPACES                 TO CR-MEMBER-NO.
 10798     IF CR-LOAN-OFFICER = ALL '*'
 10799         MOVE SPACES                 TO CR-LOAN-OFFICER.
 10800     IF CR-USER-CODE = ALL '*'
 10801         MOVE SPACES                 TO CR-USER-CODE.
 10802
 10803     ADD +1 TO BC-G-CTN.
 10804     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 210
* ECS010D.cbl
 10806 0920-GET-BANK-FEES.
 10807
 10808     IF CR-CERT-NO = '0008771354 '
 10809        DISPLAY ' MADE IT TO 0920 '
 10810     END-IF
 10811
 10812     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 10813     MOVE CR-CARRIER             TO AG-CARRIER
 10814     MOVE CR-GROUPING            TO AG-GROUPING
 10815     MOVE CR-BANK-NO             TO AG-BANK
 10816     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 10817     MOVE 'B'                    TO AG-TYPE
 10818
 10819*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 10820*       PERFORM 0925-BUILD-WORK-BNK-COMM
 10821*                                THRU 0925-EXIT
 10822*       GO TO 0920-EXIT
 10823*    END-IF
 10824
 10825     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 10826
 10827     IF CR-CERT-NO = '0008771354 '
 10828        DISPLAY ' MADE IT AFTER START '
 10829     END-IF
 10830
 10831     .
 10832 0920-READ-ERAGTC.
 10833
 10834     IF ERAGTC-FILE-STATUS = '00'
 10835        READ ERAGTC NEXT RECORD
 10836     IF CR-CERT-NO = '0008771354 '
 10837        DISPLAY ' MADE ONE READ '
 10838     END-IF
 10839
 10840        IF ERAGTC-FILE-STATUS = '00'
 10841           IF (CR-CARRIER         = AG-CARRIER)
 10842              AND (CR-GROUPING    = AG-GROUPING)
 10843              AND (CR-BANK-NO     = AG-BANK)
 10844              IF WS-CR-BIN-DATE  = AG-EXP-DT
 10845                 GO TO 0920-READ-ERAGTC
 10846              ELSE
 10847                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 10848                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 10849                    PERFORM 0925-BUILD-WORK-BNK-COMM
 10850                                 THRU 0925-EXIT
 10851                    MOVE AG-CONTROL-PRIMARY
 10852                                 TO WS-PREV-BANK-COMM-KEY
 10853                    GO TO 0920-EXIT
 10854                 END-IF
 10855              END-IF
 10856           END-IF
 10857        END-IF
 10858     END-IF
 10859
 10860     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 10861*    PERFORM 0925-BUILD-WORK-BNK-COMM
 10862
 10863     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 211
* ECS010D.cbl
 10864        AND (PB-I-BANK-FEE NOT = ZEROS)
 10865        MOVE CR-BANK-NO          TO WS-BNK-AGT (1)
 10866        MOVE 'B'                 TO WS-BNK-TYPE (1)
 10867        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (1)
 10868        MOVE ' '                 TO WS-BNK-RECALC (1)
 10869        MOVE +2                  TO IB
 10870     END-IF
 10871
 10872     .
 10873 0920-EXIT.
 10874     EXIT.
 10875
 10876 0925-BUILD-WORK-BNK-COMM.
 10877
 10878     IF CR-CERT-NO = '0008771354 '
 10879        DISPLAY ' MADE IT TO 0925 '
 10880     END-IF
 10881
 10882     MOVE +1                     TO IA IB
 10883
 10884*    IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 10885*       AND (PB-I-BANK-FEE NOT = ZEROS)
 10886*       MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 10887*       MOVE 'B'                 TO WS-BNK-TYPE (IB)
 10888*       MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 10889*       MOVE ' '                 TO WS-BNK-RECALC (IB)
 10890*       ADD +1                   TO IB
 10891*    END-IF
 10892*    .
 10893*0925-BUILD-CONTINUE.
 10894
 10895     IF CR-CERT-NO = '00087735841'
 10896        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 10897        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 10898        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 10899     END-IF
 10900
 10901*    PERFORM VARYING IA FROM +2 BY +1 UNTIL
 10902     PERFORM VARYING IA FROM +1 BY +1 UNTIL
 10903        (IA > +10)
 10904        OR (IB > +10)
 10905        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 10906           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 10907           MOVE 'B'              TO WS-BNK-TYPE (IB)
 10908*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 10909           IF AG-SPP-FEES (IA) NOT NUMERIC
 10910              MOVE ZEROS         TO AG-SPP-FEES (IA)
 10911           END-IF
 10912           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 10913           MOVE AG-RECALC-LV-INDIC (IA)
 10914                                 TO WS-BNK-RECALC (IB)
 10915        ELSE
 10916           MOVE SPACES           TO WS-BNK-AGT (IB)
 10917                                    WS-BNK-TYPE (IB)
 10918                                    WS-BNK-RECALC (IB)
 10919           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 10920        END-IF
 10921        ADD +1                   TO IB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 212
* ECS010D.cbl
 10922     END-PERFORM
 10923
 10924     .
 10925 0925-EXIT.
 10926     EXIT.
 10927
 10928 0930-BUILD-CERT-TRLR.
 10929
 10930     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 10931     MOVE 'CS'                   TO CS-RECORD-ID
 10932     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 10933     MOVE CR-CARRIER             TO CS-CARRIER
 10934     MOVE CR-GROUPING            TO CS-GROUPING
 10935     MOVE CR-STATE               TO CS-STATE
 10936     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 10937     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 10938     MOVE CR-CERT-NO             TO CS-CERT-NO
 10939     MOVE 'A'                    TO CS-TRAILER-TYPE
 10940
 10941     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 10942
 10943     IF CS-AGT (1) NOT = SPACES AND ZEROS
 10944        WRITE CERTIFICATE-TRAILERS
 10945        IF ELCRTT-FILE-STATUS = '00'
 10946           CONTINUE
 10947        ELSE
 10948           IF ELCRTT-FILE-STATUS = '22'
 10949              READ ELCRTT
 10950              IF ELCRTT-FILE-STATUS = '00'
 10951                 MOVE WS-BANK-COMMISSIONS
 10952                                 TO CS-BANK-COMMISSION-AREA
 10953                 REWRITE CERTIFICATE-TRAILERS
 10954                 IF ELCRTT-FILE-STATUS NOT = '00'
 10955                    DISPLAY ' BAD REWRITE ELCRTT '
 10956                                 ELCRTT-FILE-STATUS
 10957                    PERFORM ABEND-PGM
 10958                 END-IF
 10959              ELSE
 10960                 DISPLAY ' BAD READ    ELCRTT '
 10961                                  ELCRTT-FILE-STATUS
 10962                 PERFORM ABEND-PGM
 10963              END-IF
 10964           ELSE
 10965              DISPLAY ' BAD WRITE ELCRTT '
 10966                                 ELCRTT-FILE-STATUS
 10967              PERFORM ABEND-PGM
 10968           END-IF
 10969        END-IF
 10970     END-IF
 10971
 10972     .
 10973 0930-EXIT.
 10974     EXIT.
 10975
 10976 0950-BUILD-CERT-C-TRLR.
 10977
 10978     MOVE SPACES                 TO CERTIFICATE-TRAILERS.
 10979     MOVE 'CS'                   TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 213
* ECS010D.cbl
 10980     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD.
 10981     MOVE CR-CARRIER             TO CS-CARRIER.
 10982     MOVE CR-GROUPING            TO CS-GROUPING.
 10983     MOVE CR-STATE               TO CS-STATE.
 10984     MOVE CR-ACCOUNT             TO CS-ACCOUNT.
 10985     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT.
 10986     MOVE CR-CERT-NO             TO CS-CERT-NO.
 10987     MOVE 'C'                    TO CS-TRAILER-TYPE.
 10988
 10989     MOVE PB-I-VIN               TO CS-VIN-NUMBER.
 10990
 10991     WRITE CERTIFICATE-TRAILERS.
 10992     IF ELCRTT-FILE-STATUS = '00'
 10993        CONTINUE
 10994     ELSE
 10995        IF ELCRTT-FILE-STATUS = '22'
 10996           READ ELCRTT
 10997           IF ELCRTT-FILE-STATUS = '00'
 10998              MOVE PB-I-VIN      TO CS-VIN-NUMBER
 10999              REWRITE CERTIFICATE-TRAILERS
 11000              IF ELCRTT-FILE-STATUS NOT = '00'
 11001                 DISPLAY ' BAD REWRITE ELCRTT '
 11002                              ELCRTT-FILE-STATUS
 11003                 PERFORM ABEND-PGM
 11004              END-IF
 11005           ELSE
 11006              DISPLAY ' BAD READ    ELCRTT '
 11007                               ELCRTT-FILE-STATUS
 11008              PERFORM ABEND-PGM
 11009           END-IF
 11010        ELSE
 11011           DISPLAY ' BAD WRITE ELCRTT '
 11012                              ELCRTT-FILE-STATUS
 11013           PERFORM ABEND-PGM
 11014        END-IF
 11015     END-IF.
 11016
 11017     .
 11018 0950-EXIT.
 11019     EXIT.
 11020
 11021
 11022******************************************************************
 11023***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 11024******************************************************************
 11025
 11026 1000-SET-COMMISSION-STRUCTURE.
 11027
 11028     MOVE +1                     TO IA
 11029                                    IB.
 11030
 11031 1100-GET-COMMISSION-LEVEL.
 11032
 11033     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 11034
 11035     IF WK-AGT = '0000000000' OR SPACES
 11036         MOVE +0                 TO WK-L-RT
 11037                                    WK-J-RT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 214
* ECS010D.cbl
 11038                                    WK-A-RT
 11039         GO TO 1200-SET-COMMISSION-LEVEL.
 11040
 11041 1110-LIFE-COMMISSION.
 11042
 11043     IF CR-LFTYP = ZERO  OR
 11044       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11045         MOVE +0 TO WK-L-RT
 11046                    WK-J-RT
 11047         GO TO 1130-A-H-COMMISSION.
 11048
 11049     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11050         GO TO 1120-JOINT-LIFE-COMMISSION.
 11051
 11052     IF WK-L-RT NUMERIC
 11053        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 11054         MOVE WK-L-RT                TO WS-COMMISSION
 11055         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11056         MOVE WS-COMMISSION          TO WK-L-RT
 11057         GO TO 1130-A-H-COMMISSION.
 11058
 11059     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11060     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11061     MOVE ZEROS                      TO WS-SUB1.
 11062     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11063
 11064     IF WS-SUB1 = ZEROS
 11065         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 11066     ELSE
 11067         MOVE WK-RATE                TO WK-L-RT
 11068         GO TO 1130-A-H-COMMISSION.
 11069
 11070     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11071
 11072     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11073     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11074     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11075     MOVE WK-RATE                    TO WK-L-RT.
 11076
 11077     GO TO 1130-A-H-COMMISSION.
 11078
 11079 1120-JOINT-LIFE-COMMISSION.
 11080
 11081     IF WK-J-RT NUMERIC
 11082        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 11083         MOVE WK-J-RT                TO WS-COMMISSION
 11084         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11085         MOVE WS-COMMISSION          TO WK-J-RT
 11086         GO TO 1130-A-H-COMMISSION.
 11087
 11088     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11089     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11090     MOVE ZEROS                      TO WS-SUB1.
 11091     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11092
 11093     IF WS-SUB1 = ZEROS
 11094         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 11095     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 215
* ECS010D.cbl
 11096         MOVE WK-RATE                TO WK-J-RT
 11097         GO TO 1130-A-H-COMMISSION.
 11098
 11099     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11100
 11101     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11102     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11103     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11104     MOVE WK-RATE                    TO WK-J-RT.
 11105
 11106 1130-A-H-COMMISSION.
 11107
 11108     IF CR-AHTYP = ZERO  OR
 11109       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11110         MOVE +0 TO WK-A-RT
 11111         GO TO 1200-SET-COMMISSION-LEVEL.
 11112
 11113     IF WK-A-RT NUMERIC
 11114        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 11115         MOVE WK-A-RT                TO WS-COMMISSION
 11116         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11117         MOVE WS-COMMISSION          TO WK-A-RT
 11118         GO TO 1200-SET-COMMISSION-LEVEL.
 11119
 11120     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 11121     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 11122     MOVE ZEROS                      TO WS-SUB1.
 11123     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11124
 11125     IF WS-SUB1 = ZEROS
 11126         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 11127     ELSE
 11128         MOVE WK-RATE                TO WK-A-RT
 11129         GO TO 1200-SET-COMMISSION-LEVEL.
 11130
 11131     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11132
 11133     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 11134     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 11135     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11136     MOVE WK-RATE                    TO WK-A-RT.
 11137
 11138 1200-SET-COMMISSION-LEVEL.
 11139
 11140     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11141     IF WK-AGT = '0000000000' OR SPACES
 11142         MOVE SPACE                   TO WK-N-TYPE (IA)
 11143     ELSE
 11144         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11145
 11146     IF CR-LFTYP = ZERO
 11147         MOVE +0                      TO WK-L-RT1  (IA)
 11148     ELSE
 11149         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11150             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11151         ELSE
 11152             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11153
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 216
* ECS010D.cbl
 11154     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11155
 11156     IF RC-COMM-FLG = 'X'
 11157        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11158*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11159*             AND (IA = +5))
 11160            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11161            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11162            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11163            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11164
 11165     IF IA LESS THAN +10
 11166         ADD +1 TO IA
 11167         GO TO 1100-GET-COMMISSION-LEVEL.
 11168
 11169     GO TO 1499-SET-COMM-X.
 11170
 11171 1300-READ-ERCTBL-FILE.
 11172
 11173     IF CTBL-SEARCH = LAST-CTBL
 11174         GO TO 1399-READ-ERCTBL-X.
 11175
 11176     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11177
 11178     IF COMM-OPEN-SW = ' '
 11179         MOVE 'X'                        TO COMM-OPEN-SW
 11180         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11181         OPEN INPUT ERCTBL
 11182         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11183             NEXT SENTENCE
 11184            ELSE
 11185             MOVE '41'                   TO ABEND-CODE-1
 11186             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11187             DISPLAY '******************************'
 11188             DISPLAY '***** ERROR LOCATION 012 *****'
 11189             DISPLAY '******************************'
 11190             DISPLAY '******************************'
 11191             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11192             GO TO ABEND-PGM.
 11193
 11194     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11195                                            LAST-CTBL.
 11196     READ ERCTBL.
 11197
 11198     IF ERCTBL-FILE-STATUS = '23'
 11199         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 11200                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11201                 ' CTBL: ' CTBL-SEARCH
 11202         MOVE '*'                TO CTBL-ERROR-SWITCH
 11203         MOVE '44'               TO ABEND-CODE-1
 11204         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11205         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11206         DISPLAY '******************************'
 11207         DISPLAY '***** ERROR LOCATION 013 *****'
 11208         DISPLAY '******************************'
 11209         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11210*        IF DTE-CLIENT NOT = 'NCL'
 11211         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 217
* ECS010D.cbl
 11212             GO TO ABEND-PGM
 11213         ELSE
 11214             NEXT SENTENCE
 11215     ELSE
 11216         IF ERCTBL-FILE-STATUS NOT = '00'
 11217             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11218             MOVE '44'               TO ABEND-CODE-1
 11219             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11220             DISPLAY '******************************'
 11221             DISPLAY '***** ERROR LOCATION 014 *****'
 11222             DISPLAY '******************************'
 11223             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11224             GO TO ABEND-PGM.
 11225
 11226     ADD +1                            TO ERCTBL-READS.
 11227
 11228 1399-READ-ERCTBL-X.
 11229     EXIT.
 11230
 11231 1400-GET-COMM-PERCENT.
 11232
 11233     IF CTBL-ERROR
 11234         MOVE ZEROS                      TO WK-RATE
 11235         GO TO 1489-GET-PERCENT-X.
 11236
 11237     MOVE +1 TO IB.
 11238     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11239        (CT-TBF (1) NOT EQUAL +9999999.99)
 11240         ADD +9 TO IB
 11241         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11242            (CT-TBF (2) NOT EQUAL +9999999.99)
 11243             ADD +9 TO IB.
 11244
 11245     IF CR-AGE GREATER CT-AGE (1)
 11246         ADD +3 TO IB
 11247         IF CR-AGE GREATER CT-AGE (2)
 11248             ADD +3 TO IB.
 11249
 11250     IF WS-COMM-TERM GREATER CT-TRM (1)
 11251         ADD +1 TO IB
 11252         IF WS-COMM-TERM GREATER CT-TRM (2)
 11253             ADD +1 TO IB.
 11254
 11255     IF CT-RT (IB) NOT NUMERIC
 11256         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 11257         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 11258         GO TO 1300-READ-ERCTBL-FILE.
 11259
 11260     MOVE CT-RT (IB) TO WK-RATE.
 11261
 11262 1489-GET-PERCENT-X.
 11263     EXIT.
 11264
 11265 1499-SET-COMM-X.
 11266     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 218
* ECS010D.cbl
 11268******************************************************************
 11269***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 11270******************************************************************
 11271
 11272 1500-GET-ACCT-LEVEL-LF-COMM.
 11273
 11274     MOVE ZEROS                      TO ACCT-COMM-LF
 11275                                        ACCT-COMM-AH.
 11276
 11277     MOVE +1                         TO IA.
 11278
 11279 1510-ACCT-LEVEL-LOOP.
 11280
 11281     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11282         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 11283             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 11284             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 11285         ELSE
 11286             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 11287                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 11288
 11289     IF IA LESS THAN +10
 11290         ADD +1 TO IA
 11291         GO TO 1510-ACCT-LEVEL-LOOP.
 11292
 11293 1519-ACCT-LF-COMM-X.
 11294     EXIT.
 11295
 11296
 11297 1550-GET-ACCT-LEVEL-AH-COMM.
 11298
 11299     MOVE ZEROS                      TO ACCT-COMM-AH.
 11300
 11301     MOVE +1                         TO IA.
 11302
 11303 1555-ACCT-LEVEL-LOOP.
 11304
 11305     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11306         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 11307             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 11308
 11309     IF IA LESS THAN +10
 11310         ADD +1 TO IA
 11311         GO TO 1555-ACCT-LEVEL-LOOP.
 11312
 11313 1599-ACCT-AH-COMM-X.
 11314     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 219
* ECS010D.cbl
 11316******************************************************************
 11317***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 11318******************************************************************
 11319
 11320 1600-RECALC-COMM-EXTR.
 11321
 11322     IF RC-COMM-FLG = 'X'  OR
 11323        (DTE-PGM-OPT = '2'  OR  '3')  OR
 11324        CR-POLICY-IS-DECLINED  OR
 11325        CR-POLICY-IS-VOID
 11326         GO TO 1899-RECALC-COMM-EXTR-X.
 11327
 11328     MOVE 'X'                           TO RC-COMM-FLG.
 11329
 11330     IF CR-ENTRY-DATE = EOM-RUN-DATE
 11331         GO TO 1899-RECALC-COMM-EXTR-X.
 11332
 11333     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 11334
 11335     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11336         GO TO 1899-RECALC-COMM-EXTR-X.
 11337
 11338     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 11339
 11340     PERFORM 1610-CK-DUPLICATE-ENTRIES
 11341         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 11342             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 11343
 11344     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11345         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 11346                                           WK-NEW-RATES
 11347         GO TO 1899-RECALC-COMM-EXTR-X.
 11348
 11349     MOVE +1                            TO SUB8.
 11350     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11351
 11352 1610-CK-DUPLICATE-ENTRIES.
 11353     PERFORM 1620-CK-DUPL-ENTR-NEW
 11354         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 11355             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 11356
 11357 1619-CK-DUPLICATE-ENTRIES-XIT.
 11358     EXIT.
 11359
 11360 1620-CK-DUPL-ENTR-NEW.
 11361     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 11362         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 11363         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 11364         MOVE +0                        TO CR-LCOM-L (SUB11)
 11365                                           CR-LCOM-AH (SUB11)
 11366         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 11367         MOVE 11                        TO SUB12.
 11368
 11369 1629-CK-DUPL-ENTR-NEW-XIT.
 11370     EXIT.
 11371
 11372 1700-REVERSE-OLD-COMM-LOOP.
 11373     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 220
* ECS010D.cbl
 11374     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 11375
 11376     IF SUB8 LESS THAN +10
 11377         ADD +1 TO SUB8
 11378         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11379
 11380     MOVE 'O' TO RECALC-TYPE.
 11381
 11382     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11383
 11384     GO TO 1800-MOVE-NEW-COMM-RATES.
 11385
 11386 1710-DO-R-C-EXTRACTS.
 11387
 11388     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11389
 11390     PERFORM 1720-CHECK-COMM-LEVELS
 11391         THRU 1729-CHECK-COMM-LEVELS-EXIT
 11392             VARYING SUB13 FROM +1 BY +1
 11393                 UNTIL SUB13 GREATER THAN 10.
 11394
 11395     MOVE '8'                           TO DE-TRANS.
 11396     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 11397*****PERFORM EXTRACT-DATE-RELOAD.
 11398     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11399     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11400     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 11401     PERFORM EXTRACT-DATE-LOAD.
 11402     MOVE 'R'                           TO DE-REIN.
 11403     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11404     MOVE +1                            TO SUB1.
 11405     PERFORM 3110-REINSURE-ISSUE-LOOP
 11406         THRU 3119-REINSURE-ISSUE-LOOP-END.
 11407
 11408     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 11409         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 11410                                       2259-END-CANCEL-BUILD
 11411         PERFORM 1720-CHECK-COMM-LEVELS
 11412             THRU 1729-CHECK-COMM-LEVELS-EXIT
 11413                 VARYING SUB13 FROM +1 BY +1
 11414                     UNTIL SUB13 GREATER THAN 10
 11415         MOVE '7'                       TO DE-TRANS
 11416         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 11417*********PERFORM EXTRACT-DATE-RELOAD
 11418         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 11419         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 11420         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 11421         PERFORM EXTRACT-DATE-LOAD
 11422         MOVE 'R'                       TO DE-REIN
 11423         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 11424         MOVE +1                        TO SUB1
 11425         PERFORM 3210-REINSURE-CANCEL-LOOP
 11426             THRU 3219-REINSURE-CANCEL-LOOP-END.
 11427
 11428 1719-DO-R-C-EXTRACTS-X.
 11429     EXIT.
 11430
 11431 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 221
* ECS010D.cbl
 11432
 11433     IF  DE-AGT (SUB13)       =  SPACES  AND
 11434         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 11435         DE-L-PC (SUB13)      =  ZEROS   AND
 11436         DE-A-PC (SUB13)      =  ZEROS
 11437         MOVE '0000000000'        TO  DE-AGT (SUB13).
 11438
 11439 1729-CHECK-COMM-LEVELS-EXIT.
 11440     EXIT.
 11441
 11442 1800-MOVE-NEW-COMM-RATES.
 11443     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 11444     MOVE 'N'                           TO RECALC-TYPE.
 11445     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11446     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 11447                                           CR-COMPENSATION-LEVELS.
 11448     IF DTE-CLIENT = 'DCC'
 11449        IF CR-LF-NSP-PRM NOT = ZEROS
 11450           COMPUTE CR-LF-NSP-PRM ROUNDED =
 11451              (CR-LFPRM + CR-LFPRM-ALT) -
 11452              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 11453        END-IF
 11454        IF (CR-AH-NSP-PRM NOT = ZEROS)
 11455           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 11456                                        NOT = 'G' AND 'L')
 11457           COMPUTE CR-AH-NSP-PRM ROUNDED =
 11458           CR-AHPRM -
 11459           (CR-AHPRM * CR-LCOM-AH (1))
 11460        END-IF
 11461     END-IF
 11462     .
 11463
 11464 1899-RECALC-COMM-EXTR-X.
 11465     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 222
* ECS010D.cbl
 11467******************************************************************
 11468***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 11469******************************************************************
 11470
 11471 2000-INITIALIZE-DETAIL-EXTRACT.
 11472
 11473     MOVE SPACES                   TO DETAIL-EXTRACT.
 11474
 11475     MOVE 'DE'                     TO DE-RECORD-ID.
 11476     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 11477     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 11478
 11479     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 11480     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 11481
 11482     MOVE CR-NAME                  TO DE-NAME.
 11483     MOVE CR-AGE                   TO DE-AGE.
 11484     MOVE CR-SEX                   TO DE-SEX.
 11485     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 11486
 11487     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 11488     MOVE CR-LF-TERM               TO DE-LF-TERM.
 11489     MOVE CR-LFAMT                 TO DE-LF-BEN.
 11490     MOVE ZEROS                    TO DE-LF-CNBEN.
 11491     MOVE CR-LFPRM                 TO DE-LF-PRM.
 11492     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 11493     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 11494     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 11495     MOVE ZEROS                    TO DE-LF-RFND.
 11496
 11497     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 11498     MOVE ZEROS                    TO DE-LF-CANC-DTE
 11499                                      DE-LF-CANC-EXIT-DT.
 11500
 11501     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 11502     MOVE CR-AH-TERM               TO DE-AH-TERM.
 11503     MOVE CR-AHAMT                 TO DE-AH-BEN.
 11504     MOVE CR-AHPRM                 TO DE-AH-PRM.
 11505     MOVE ZEROS                    TO DE-AH-RFND.
 11506
 11507     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 11508     MOVE ZEROS                    TO DE-AH-CANC-DTE
 11509                                      DE-AH-CANC-EXIT-DT.
 11510     MOVE CR-MOB-NET-TOT-FEES      TO DE-MOB-NET-TOT-FEES.
 11511
 11512     IF DTE-CLIENT = 'DCC'
 11513        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 11514        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 11515     ELSE
 11516        IF (CR-LFTYP NOT = ZERO   AND
 11517           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 11518           (CR-AHTYP NOT = ZERO  AND
 11519           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 11520           MOVE CR-LIVES           TO DE-LIVES
 11521           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 11522                                      DE-CANCEL-CNT-YTD
 11523        END-IF
 11524     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 223
* ECS010D.cbl
 11525
 11526     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 11527     IF AM-ZIP-PRIME NUMERIC
 11528        MOVE AM-ZIP-PRIME          TO DE-ZIP
 11529      ELSE
 11530        MOVE ZEROS                 TO DE-ZIP.
 11531     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 11532
 11533     MOVE CR-APR                   TO DE-APR.
 11534     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 11535     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 11536     MOVE CR-IND-GRP               TO DE-IG.
 11537     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 11538     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 11539
 11540     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 11541     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE.
 11542
 11543     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 11544     MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 11545
 11546     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 11547                                      DE-REI-AHAMT  DE-REI-AHPRM
 11548                                      DE-REI-LFRFND DE-REI-AHRFND
 11549                                      DE-REI-CNAMT.
 11550
 11551     MOVE +1                       TO SUB1.
 11552
 11553* THIS WAS ADDED SO I COULD PASS THE CLP TO ECS017
 11554* FOR DEALER DIRECT OTHERWISE THERE WAS NO WAY TO
 11555* CALC IT IN ECS017.
 11556     IF DTE-CLIENT = 'DCC'
 11557        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 11558           MOVE CR-LF-CLP          TO DE-REI-LFPRM
 11559           IF CR-ACCOUNT = '05500500DD'
 11560              DISPLAY ' LF CLP ' DE-CERT-NO ' ' DE-REI-LFPRM
 11561                ' ' DE-REI-LFRFND
 11562           END-IF
 11563        END-IF
 11564        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
 11565           MOVE CR-AH-CLP          TO DE-REI-AHPRM
 11566        END-IF
 11567     END-IF
 11568
 11569
 11570     PERFORM EXTRACT-DATE-LOAD.
 11571
 11572     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 11573                                      WS-DE-INCUR-N
 11574                                      WS-DE-PAY-N
 11575                                      WS-DE-PAID-TO-N
 11576                                      WS-DE-ACC-EXP-DTE-N
 11577                                      WS-DE-ACC-EFF-DTE-N
 11578                                      WS-DE-RSV-INCUR-N
 11579                                      WS-DE-RSV-PAYTO-N
 11580                                      WS-DE-ACC-EXP-DTE-RSV-N
 11581                                      WS-DE-ACC-EFF-DTE-RSV-N.
 11582
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 224
* ECS010D.cbl
 11583 2090-GL-CODE-LOOP.
 11584
 11585     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 11586
 11587     IF SUB1 LESS THAN +10
 11588         ADD +1 TO SUB1
 11589         GO TO 2090-GL-CODE-LOOP.
 11590
 11591     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 11592
 11593     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 11594
 11595     IF (DTE-CLIENT = 'DCC')
 11596        AND (CR-AHTYP NOT = SPACES AND ZEROS)
 11597        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11598        AND (RECALC-TYPE = SPACES)
 11599        MOVE +1                  TO IA
 11600*       IF CR-ACCOUNT = '05500500DD'
 11601**      IF CR-CERT-NO = '0008773536 '
 11602*          DISPLAY ' MADE IT TO 2000 '
 11603*          DISPLAY ' CERT AREA  REIN ' DE-REIN ' ' CR-CERT-NO
 11604*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11605*             (IB > +10)
 11606*             IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 11607*                MOVE IB TO DIL-BEN-CODE
 11608*                MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 11609*                MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 11610*                DISPLAY DISPLAY-IBNR-LINE
 11611*             END-IF
 11612*          END-PERFORM
 11613*          DISPLAY ' TRLR AREA  '
 11614*          DISPLAY ' CS CERT NO ' CS-CERT-NO
 11615*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11616*             (IB > +10)
 11617*             IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 11618*                MOVE IB TO DIL-BEN-CODE
 11619*                MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 11620*                MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 11621*                DISPLAY DISPLAY-IBNR-LINE
 11622*             END-IF
 11623*          END-PERFORM
 11624*       END-IF
 11625        PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11626           IB > +10
 11627           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 11628              CONTINUE
 11629           ELSE
 11630              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 11631                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 11632                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 11633                 COMPUTE DE-A-PC (IB) =
 11634                        WS-BNK-SPP-FEES (IA) / +1000
 11635                 MOVE +0              TO DE-L-PC (IB)
 11636                 ADD +1               TO IA
 11637              END-IF
 11638*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 11639*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 11640*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 225
* ECS010D.cbl
 11641*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 11642*                MOVE +0              TO DE-L-PC (IB)
 11643*                ADD +1               TO IA
 11644*             END-IF
 11645           END-IF
 11646        END-PERFORM
 11647     END-IF
 11648
 11649
 11650
 11651     .
 11652 2099-INIT-DTL-X.
 11653     EXIT.
 11654
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 226
* ECS010D.cbl
 11656******************************************************************
 11657***            B U I L D   I S S U E   E X T R A C T           ***
 11658******************************************************************
 11659
 11660 2100-BUILD-ISSUE-EXTRACT.
 11661
 11662     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11663
 11664     MOVE 'I'                      TO DE-TRANS.
 11665
 11666     IF CHECK-BILLED
 11667         MOVE 'N' TO BILLED-SWITCH
 11668     ELSE
 11669         GO TO 2190-WRITE-ISSUE-EXTRACT.
 11670
 11671     MOVE +1                        TO SUB1.
 11672 2150-GA-BILL-LOOP.
 11673
 11674     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 11675         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 11676
 11677     IF SUB1 LESS THAN +5
 11678         ADD +1 TO SUB1
 11679         GO TO 2150-GA-BILL-LOOP.
 11680
 11681     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 11682     MOVE ZEROS                     TO DE-BILLED-LFPRM
 11683                                       DE-BILLED-LFRFND
 11684                                       DE-BILLED-AHPRM
 11685                                       DE-BILLED-AHRFND.
 11686
 11687     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 11688         IF PB-LF-BILLED-AMTS = ZERO  AND
 11689            PB-AH-BILLED-AMTS = ZERO
 11690             MOVE ' '                    TO DE-BILL-STATUS
 11691         ELSE
 11692             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 11693                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 11694                 MOVE 'B'                TO DE-BILL-STATUS
 11695             ELSE
 11696                 MOVE 'R'                TO DE-BILL-STATUS
 11697                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 11698                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 11699     ELSE
 11700         MOVE 'B'                        TO DE-BILL-STATUS.
 11701
 11702 2190-WRITE-ISSUE-EXTRACT.
 11703
 11704     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11705
 11706 2199-BLD-ISSUE-X.
 11707     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 227
* ECS010D.cbl
 11709******************************************************************
 11710***           B U I L D   C A N C E L   E X T R A C T          ***
 11711******************************************************************
 11712
 11713 2200-BUILD-CANCEL-EXTRACT.
 11714
 11715     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11716
 11717     MOVE 'C'                           TO DE-TRANS.
 11718
 11719     IF CR-LFTYP = ZERO
 11720         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11721
 11722     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 11723         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 11724             CR-LFRFND = +0
 11725              MOVE +0                   TO TEMP-5
 11726              GO TO 2250-CONTINUE-CANCEL-BUILD.
 11727
 11728     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11729          IF CR-LFRFND = +0
 11730              GO TO 2250-CONTINUE-CANCEL-BUILD.
 11731
 11732     MOVE +1 TO TEMP-5.
 11733     MOVE CR-LF-TERM             TO ORIG-TERM.
 11734     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 11735     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 11736     MOVE '1'                    TO W-VAL-SOURCE.
 11737     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 11738
 11739     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 11740         MOVE CR-LFAMT TO DE-LF-CNBEN
 11741         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11742
 11743     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11744         GO TO 2220-BLD-DE-CANCEL-SUM.
 11745
 11746     IF REM-TRM3 = CR-LF-TERM
 11747         MOVE CR-LFAMT TO DE-LF-CNBEN
 11748         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11749
 11750     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 11751         GO TO 2210-BLD-DE-CANCEL-TEX.
 11752
 11753     IF DTE-CLIENT = 'NCL'
 11754         IF CR-DT LESS THAN 19910101
 11755             GO TO 2205-BLD-DE-CANCEL-BEN.
 11756
 11757     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 11758         GO TO 2230-BLD-DE-CANCEL-NP.
 11759
 11760     IF DTE-CLIENT = 'FUL'
 11761         GO TO 2240-BLD-DE-CANCEL-FUL.
 11762
 11763*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 11764     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 11765        (CR-RATING-CLASS NOT = 'L ')
 11766         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 228
* ECS010D.cbl
 11767            (CR-LF-TERM GREATER THAN 060)  AND
 11768            (CR-DT GREATER THAN 19831031)
 11769              GO TO 2230-BLD-DE-CANCEL-NP.
 11770
 11771     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 11772         IF (CR-APR GREATER THAN ZERO)  AND
 11773            (CR-LF-TERM GREATER THAN 061)  AND
 11774            (CR-DT GREATER THAN 19830318)
 11775              GO TO 2230-BLD-DE-CANCEL-NP.
 11776
 11777     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 11778         IF (CR-APR GREATER THAN ZERO)  AND
 11779            (CR-LF-TERM GREATER THAN 062)  AND
 11780            (CR-DT GREATER THAN 19810831)  AND
 11781            (CR-DT LESS THAN 19830901)
 11782              GO TO 2230-BLD-DE-CANCEL-NP.
 11783
 11784     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 11785         IF (CR-APR GREATER THAN ZERO)  AND
 11786            (CR-LF-TERM GREATER THAN 060)  AND
 11787            (CR-DT GREATER THAN 19831231)
 11788              GO TO 2230-BLD-DE-CANCEL-NP.
 11789
 11790 2205-BLD-DE-CANCEL-BEN.
 11791
 11792     IF CR-LF-TERM EQUAL +0
 11793         MOVE +0          TO TEMP-5
 11794     ELSE
 11795         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 11796
 11797     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 11798
 11799     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11800
 11801 2210-BLD-DE-CANCEL-TEX.
 11802
 11803     DIVIDE CR-LFAMT BY CR-LF-TERM
 11804         GIVING TEX-FACT-1.
 11805     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 11806         GIVING TEX-FACT-2
 11807             REMAINDER TEX-FACT-3.
 11808     IF TEX-FACT-3 NOT = ZERO
 11809         ADD +1 TO TEX-FACT-2.
 11810     COMPUTE DE-LF-CNBEN =
 11811         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 11812
 11813     IF CR-LFAMT EQUAL +0
 11814         MOVE +0                  TO TEMP-5
 11815     ELSE
 11816         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11817
 11818     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11819
 11820 2220-BLD-DE-CANCEL-SUM.
 11821
 11822     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 11823     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 11824
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 229
* ECS010D.cbl
 11825     IF CR-LFRFND NOT LESS CR-LFPRM
 11826         MOVE CR-LFAMT           TO DE-LF-CNBEN
 11827          GO TO 2250-CONTINUE-CANCEL-BUILD.
 11828
 11829     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 11830     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 11831     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 11832         MOVE TEMP-7             TO DE-LF-CNBEN
 11833       ELSE
 11834         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 11835         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 11836
 11837     IF CR-LFAMT EQUAL +0
 11838         MOVE +0                  TO TEMP-5
 11839     ELSE
 11840         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 11841
 11842     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 11843         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11844
 11845 2230-BLD-DE-CANCEL-NP.
 11846
 11847     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 11848     MOVE 'L'                        TO  DC-OPTION-CODE.
 11849     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11850     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 11851
 11852     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 11853       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 11854       MOVE '3'                      TO  DC-OPTION-CODE
 11855       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 11856       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 11857     ELSE
 11858       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 11859       MOVE '6'                      TO  DC-OPTION-CODE
 11860       MOVE +1                       TO  DC-ELAPSED-MONTHS
 11861       MOVE +0                       TO  DC-ELAPSED-DAYS
 11862       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 11863       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 11864
 11865     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 11866     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 11867     MOVE CR-APR                     TO  CP-LOAN-APR.
 11868     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 11869     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 11870     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 11871     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 11872     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 11873     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 11874
 11875     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 11876
 11877     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11878         COMPUTE DE-LF-CNBEN =
 11879                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 11880      ELSE
 11881          COMPUTE DE-LF-CNBEN ROUNDED =
 11882                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 230
* ECS010D.cbl
 11883
 11884     IF CR-LFAMT EQUAL +0
 11885         MOVE +0                  TO TEMP-5
 11886     ELSE
 11887         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11888
 11889     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11890
 11891 2240-BLD-DE-CANCEL-FUL.
 11892
 11893     MOVE CR-APR                  TO NP-APR.
 11894     MOVE CR-LF-TERM              TO NP-ORIG.
 11895     MOVE REM-TRM3                TO NP-REM.
 11896     MOVE '2'                     TO NP-OPT.
 11897     MOVE CR-AHPRM                TO NP-AHPRM.
 11898     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 11899     MOVE CR-LFAMT                TO NP-BENEFIT.
 11900
 11901*    CALL 'FULNETRM'
 11902*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 11903*              NP-ACCOUNT NP-REMAINING.
 11904
 11905     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 11906
 11907     IF CR-LFAMT EQUAL +0
 11908         MOVE +0                  TO TEMP-5
 11909     ELSE
 11910         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11911
 11912 2250-CONTINUE-CANCEL-BUILD.
 11913
 11914     MOVE CR-LFRFND                   TO DE-LF-RFND.
 11915     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 11916     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
 11917                                         WS-DE-LF-CANC-DTE-N.
 11918     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 11919                                         WS-DE-LF-CANC-EXIT-DT-N.
 11920     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 11921
 11922     MOVE CR-AHRFND                   TO DE-AH-RFND.
 11923
 11924     IF DTE-CLIENT = 'DCC'
 11925        IF DE-AH-RFND = ZEROS
 11926           MOVE ZEROS                 TO DE-ADDL-CLP
 11927        END-IF
 11928     END-IF
 11929
 11930     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 11931     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 11932                                         WS-DE-AH-CANC-DTE-N.
 11933     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 11934                                         WS-DE-AH-CANC-EXIT-DT-N.
 11935     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 11936
 11937     IF PB-LAST-MAINT-BY = 'E570'
 11938         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11939
 11940     IF CHECK-BILLED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 231
* ECS010D.cbl
 11941         MOVE 'N' TO BILLED-SWITCH
 11942     ELSE
 11943         GO TO 2259-END-CANCEL-BUILD.
 11944
 11945     MOVE +1                        TO SUB1.
 11946 2255-GA-BILL-LOOP.
 11947
 11948     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 11949         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 11950
 11951     IF SUB1 LESS THAN +5
 11952         ADD +1 TO SUB1
 11953         GO TO 2255-GA-BILL-LOOP.
 11954
 11955     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 11956     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 11957     MOVE ZEROS                     TO DE-BILLED-LFPRM
 11958                                       DE-BILLED-LFRFND
 11959                                       DE-BILLED-AHPRM
 11960                                       DE-BILLED-AHRFND.
 11961
 11962     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 11963         IF PB-LF-BILLED-AMTS = ZERO  AND
 11964            PB-AH-BILLED-AMTS = ZERO
 11965             MOVE ' '                    TO DE-BILL-STATUS
 11966         ELSE
 11967             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 11968                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 11969                 MOVE 'B'                TO DE-BILL-STATUS
 11970             ELSE
 11971                 MOVE 'R'                TO DE-BILL-STATUS
 11972                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 11973                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 11974     ELSE
 11975         MOVE 'B'                        TO DE-BILL-STATUS.
 11976
 11977 2259-END-CANCEL-BUILD.
 11978     EXIT.
 11979
 11980 2290-WRITE-CANCEL-EXTRACT.
 11981
 11982     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11983
 11984 2299-BLD-CANCEL-X.
 11985     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 232
* ECS010D.cbl
 11987******************************************************************
 11988***            B U I L D   C L A I M   E X T R A C T           ***
 11989******************************************************************
 11990
 11991 2300-BUILD-CLAIM-EXTRACT.
 11992
 11993     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11994
 11995     MOVE 'X'                       TO DE-TRANS.
 11996
 11997     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 11998
 11999     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 12000     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 12001
 12002     MOVE INCURRED-DATE             TO DE-INCUR
 12003                                       WS-DE-INCUR-N.
 12004     MOVE REPORTED-DATE             TO DE-REPORTED.
 12005     MOVE PAYMENT-DATE              TO DE-PAY
 12006                                       WS-DE-PAY-N.
 12007     MOVE PAY-TO-DATE               TO DE-PAID-TO
 12008                                       WS-DE-PAID-TO-N.
 12009
 12010     MOVE PC-CLAIM-NO               TO DE-CNUM.
 12011     MOVE PC-CHECK-NO               TO DE-CHECK.
 12012     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 12013     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 12014     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 12015     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 12016     INSPECT DE-PAY-CODE
 12017         CONVERTING '1234569' TO 'PFSXEEV'.
 12018
 12019     MOVE AM-NAME                   TO DE-ACC-NAME.
 12020     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 12021                                       WS-DE-ACC-EXP-DTE-N.
 12022     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 12023                                       WS-DE-ACC-EFF-DTE-N.
 12024     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 12025     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 12026
 12027     IF DE-DTH  OR  DE-OB-DTH
 12028         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 12029     ELSE
 12030         IF CR-AH-LUMP-SUM-DISAB
 12031             MOVE CR-AH-STATUS-AT-SETTLEMENT
 12032                                    TO DE-AH-PREV-STAT.
 12033
 12034     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12035         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12036
 12037 2390-WRITE-CLAIM-EXTRACT.
 12038
 12039     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12040
 12041 2399-BLD-CLAIM-X.
 12042     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 233
* ECS010D.cbl
 12044******************************************************************
 12045***          B U I L D   R E S E R V E   E X T R A C T         ***
 12046******************************************************************
 12047
 12048 2400-BUILD-RESERVE-EXTRACT.
 12049
 12050     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12051
 12052     MOVE 'Y'                         TO DE-TRANS.
 12053     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 12054
 12055     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 12056     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 12057     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 12058     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 12059     MOVE PC-REMAINING-BENEFIT        TO DE-RSV-REM-BENEFIT
 12060     MOVE PC-REMAINING-TERM           TO DE-RSV-REM-TERM
 12061
 12062     IF DTE-CLIENT  =  'NCL'
 12063        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 12064            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 12065
 12066     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 12067
 12068     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 12069                                         WS-DE-ACC-EXP-DTE-RSV-N.
 12070
 12071     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 12072                                         WS-DE-ACC-EFF-DTE-RSV-N.
 12073
 12074     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 12075                                         WS-DE-RSV-INCUR-N.
 12076     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 12077     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 12078                                         WS-DE-RSV-PAYTO-N.
 12079
 12080     MOVE ZEROS                       TO DE-REI-IBNR
 12081                                         DE-REI-PAYCUR
 12082                                         DE-REI-FUTRSV.
 12083
 12084     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 12085
 12086     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12087         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12088
 12089 2490-WRITE-RESERVE-EXTRACT.
 12090
 12091     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12092
 12093 2499-BLD-RESERVE-X.
 12094     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 234
* ECS010D.cbl
 12096******************************************************************
 12097***          W R I T E   D E T A I L   E X T R A C T S         ***
 12098******************************************************************
 12099
 12100 2500-WRITE-DETAIL-EXTRACTS.
 12101
 12102
 12103     MOVE  ZEROS            TO  SUB.
 12104
 12105     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 12106         GO TO 2520-WRITE-CONTINUE.
 12107
 12108 2510-ZERO-CHARGEBACK-LOOP.
 12109
 12110     ADD  +1                TO  SUB.
 12111
 12112     IF  SUB    GREATER  THAN     +10
 12113         GO TO  2520-WRITE-CONTINUE.
 12114
 12115*    DISPLAY ' CERT NO ' CR-CERT-NO
 12116*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 12117*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 12118
 12119
 12120     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 12121         MOVE  ZEROS            TO  DE-L-PC (SUB).
 12122
 12123     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 12124                   OR
 12125         ((CR-AH-REFUND-TYPE = 'G')
 12126         AND (CR-AHRFND = ZEROS))
 12127         MOVE  ZEROS             TO DE-A-PC (SUB)
 12128     END-IF
 12129
 12130     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 12131
 12132 2520-WRITE-CONTINUE.
 12133
 12134     IF DTE-CLIENT NOT = 'HER'
 12135         GO TO 2590-WRITE-EXTRACTS.
 12136
 12137     IF DE-REINCO NOT = 'LNL'
 12138         GO TO 2590-WRITE-EXTRACTS.
 12139
 12140     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 12141         GO TO 2590-WRITE-EXTRACTS.
 12142
 12143     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 12144     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 12145     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 12146     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 12147     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 12148     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 12149     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 12150     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 12151     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 12152     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 12153
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 235
* ECS010D.cbl
 12154     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
 12155     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 12156     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12157     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12158     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12159     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12160     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12161     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12162     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12163     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12164
 12165
 12166 2590-WRITE-EXTRACTS.
 12167
 12168     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12169                                     WS-DE-PROC-DT-N.
 12170
 12171     IF DTE-PGM-OPT = '1'
 12172         ADD +1                   TO DE-CNT
 12173*********PERFORM EXTRACT-DATE-RELOAD
 12174         WRITE DETAIL-EXTRACT.
 12175
 12176
 12177 2599-WRT-DETAIL-X.
 12178     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 236
* ECS010D.cbl
 12180******************************************************************
 12181***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12182******************************************************************
 12183
 12184 3000-REINSURE-ROUTINE.
 12185
 12186     IF (CR-POLICY-IS-DECLINED) OR
 12187        (CR-POLICY-IS-VOID)
 12188        GO TO 3099-REINSURE-ROUTINE-X.
 12189
 12190     IF REIN-FLG = 'X'
 12191         GO TO 3099-REINSURE-ROUTINE-X.
 12192
 12193     MOVE 'X' TO REIN-FLG.
 12194
 12195     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 12196
 12197     IF CR-REIN-TABLE = SPACES OR ZEROS
 12198         GO TO 3030-RE-CALCULATE-REINSURANCE.
 12199
 12200******************************************************************
 12201***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 12202******************************************************************
 12203
 12204 3010-RR-READ-REIN.
 12205
 12206     IF REIN-OPEN-SW = ' '
 12207         MOVE 'X'                       TO REIN-OPEN-SW
 12208         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 12209         MOVE 'A'                       TO REIN-SRCH-CODE
 12210         OPEN INPUT ERRTBL-IN
 12211         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 12212             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 12213          ELSE
 12214             MOVE '21'                  TO ABEND-CODE-1
 12215             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 12216             DISPLAY '******************************'
 12217             DISPLAY '***** ERROR LOCATION 015 *****'
 12218             DISPLAY '******************************'
 12219             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12220             GO TO ABEND-PGM.
 12221
 12222     IF CR-REIN-TABLE = REIN-SRCH
 12223         GO TO 3019-RR-READ-REIN-X.
 12224
 12225     MOVE +0                            TO REIN-SUB-1.
 12226     MOVE 999999                        TO REIN-LOW-TIME.
 12227     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 12228
 12229 3011-RR-CHECK-REIN-SAVE-TABLE.
 12230
 12231     ADD +1                             TO REIN-SUB-1.
 12232     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 12233        REIN-SUB-1 GREATER THAN REIN-SUB-2
 12234         GO TO 3015-RR-READ-ERRTBL.
 12235
 12236     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 12237         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 237
* ECS010D.cbl
 12238         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12239         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 12240         GO TO 3019-RR-READ-REIN-X.
 12241
 12242     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 12243         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 12244         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 12245
 12246     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 12247
 12248 3015-RR-READ-ERRTBL.
 12249
 12250     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 12251
 12252     READ ERRTBL-IN.
 12253
 12254     IF ERRTBL-FILE-STATUS  = '23'
 12255         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 12256                                           ' ' CR-FULL-CONTROL
 12257         MOVE '24'                      TO ABEND-CODE-1
 12258         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12259         DISPLAY '******************************'
 12260         DISPLAY '***** ERROR LOCATION 016 *****'
 12261         DISPLAY '******************************'
 12262         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12263         GO TO ABEND-PGM.
 12264
 12265     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 12266         NEXT SENTENCE
 12267       ELSE
 12268         MOVE '24'                      TO ABEND-CODE-1
 12269         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12270         DISPLAY '******************************'
 12271         DISPLAY '***** ERROR LOCATION 017 *****'
 12272         DISPLAY '******************************'
 12273         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12274         GO TO ABEND-PGM.
 12275
 12276     ADD +1                            TO ERRTBL-READS.
 12277
 12278     IF REIN-SUB-1 GREATER THAN REIN-MAX
 12279         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 12280         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12281         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 12282     ELSE
 12283         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 12284         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12285         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 12286         MOVE REIN-SUB-1               TO REIN-SUB-2.
 12287
 12288 3019-RR-READ-REIN-X.
 12289     EXIT.
 12290
 12291 3020-CALCULATE-REINSURANCE.
 12292
 12293*    IF DTE-CLIENT = '???'  AND
 12294*       (CR-REIN-TABLE = 'SE1')
 12295*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 238
* ECS010D.cbl
 12296*        IF CR-STATE NOT = STATE-L
 12297*            MOVE CR-STATE             TO STATE-L
 12298*            PERFORM 8200-STATE-CODE-LOOKUP
 12299*                         THRU 8299-STATE-LOOKUP-X.
 12300
 12301
 12302*    IF DTE-CLIENT = 'DCC'
 12303*       IF CR-LF-NSP-PRM NOT = ZEROS
 12304*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 12305*             (CR-LFPRM + CR-LFPRM-ALT) -
 12306*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12307*       END-IF
 12308*       IF CR-AH-NSP-PRM NOT = ZEROS
 12309*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 12310*          CR-AHPRM -
 12311*          (CR-AHPRM * CR-LCOM-AH (1))
 12312*       END-IF
 12313*    END-IF
 12314
 12315
 12316     IF RE-REMAINING (1) = 'I'
 12317         MOVE '*'                      TO RISK-REIN-FLAG
 12318     ELSE
 12319         GO TO 3029-CONTINUE-REIN-CALC.
 12320
 12321     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 12322                                          REIN-CANCEL-AH-SW.
 12323     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 12324                                          REIN-LCNC-EARN-TERM
 12325                                          REIN-LF-CLM-MONTHS
 12326                                          REIN-EARN-AH-TERM
 12327                                          REIN-ACNC-EARN-TERM
 12328                                          REIN-AH-PRIOR-CLMS-PAID
 12329                                          REIN-AH-CLM-MONTHS
 12330                                          REIN-AH-CLM-MTH-1
 12331                                          REIN-AH-CLM-MTH-2
 12332                                          REIN-AH-CLM-MTH-3
 12333                                          REIN-AH-CLM-MTH-4
 12334                                          REIN-AH-CLM-MTH-5.
 12335
 12336*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 12337*    MOVE 'L'                          TO DC-OPTION-CODE.
 12338*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12339*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 12340
 12341     IF CR-LFTYP = ZEROS  OR  SPACES
 12342         GO TO 3023-CONTINUE.
 12343
 12344     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12345
 12346     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 12347       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 12348           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 12349
 12350     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 12351       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 12352           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 12353
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 239
* ECS010D.cbl
 12354     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 12355     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 12356
 12357     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 12358         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 12359     ELSE
 12360         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 12361
 12362     IF CR-LF-CANC-DT NOT = ZEROS
 12363         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 12364         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12365         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 12366         IF CR-DT = CR-LF-CANC-DT
 12367             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 12368
 12369     IF CR-DTH-DT NOT = ZEROS
 12370         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 12371         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12372         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 12373
 12374     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 12375
 12376
 12377 3023-CONTINUE.
 12378
 12379     IF CR-AHTYP = ZEROS  OR  SPACES
 12380        GO TO 3029-CONTINUE-REIN-CALC.
 12381
 12382     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12383
 12384     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 12385       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 12386           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 12387
 12388     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 12389       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 12390           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 12391
 12392     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 12393     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 12394
 12395     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 12396         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 12397     ELSE
 12398         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 12399
 12400     IF CR-AH-CANC-DT NOT = ZEROS
 12401         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 12402         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12403         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 12404         IF CR-DT = CR-AH-CANC-DT
 12405             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 12406
 12407     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 12408         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 12409         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12410         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 12411
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 240
* ECS010D.cbl
 12412     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 12413         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 12414         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12415         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 12416
 12417     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 12418         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 12419         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12420         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 12421
 12422     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 12423         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 12424         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12425         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 12426
 12427     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 12428         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 12429         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12430         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 12431
 12432     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 12433
 12434
 12435     GO TO 3029-CONTINUE-REIN-CALC.
 12436
 12437
 12438 3025-CALC-ELAPSED-MONTHS.
 12439
 12440     MOVE 'L'                          TO DC-OPTION-CODE.
 12441     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12442     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 12443     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 12444     MOVE '1'                          TO DC-OPTION-CODE.
 12445     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 12446     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 12447                                          DC-ODD-DAYS-OVER
 12448                                          DC-ELAPSED-DAYS.
 12449     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12450
 12451 3026-CALC-EXIT.
 12452     EXIT.
 12453
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 241
* ECS010D.cbl
 12455 3029-CONTINUE-REIN-CALC.
 12456
*12457                             COPY ECSRTPFM.
 12458******************************************************************07/10/97
 12459*                                                                *ECSRTPFM
 12460*                            ECSRTPFM                            *   LV001
 12461*                            VMOD=2.002                          *ECSRTPFM
 12462*                                                                *ECSRTPFM
 12463******************************************************************ECSRTPFM
 12464                                                                  ECSRTPFM
 12465     IF    CR-LFAMT  NUMERIC                                      00000072
 12466           NEXT SENTENCE                                          00000073
 12467        ELSE                                                      00000074
 12468           MOVE ZEROS TO CR-LFAMT.                                00000075
 12469                                                                  00000076
 12470     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 12471           NEXT SENTENCE                                          00000078
 12472        ELSE                                                      00000079
 12473           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 12474                                                                  00000081
 12475                                                                  00000082
 12476     IF    CR-LFPRM  NUMERIC                                      00000083
 12477           NEXT SENTENCE                                          00000084
 12478        ELSE                                                      00000085
 12479           MOVE ZEROS TO CR-LFPRM.                                00000086
 12480                                                                  00000087
 12481     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 12482           NEXT SENTENCE                                          00000089
 12483        ELSE                                                      00000090
 12484           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 12485                                                                  00000092
 12486                                                                  00000093
 12487     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 12488           NEXT SENTENCE                                          00000095
 12489        ELSE                                                      00000096
 12490           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 12491                                                                  00000098
 12492     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 12493           NEXT SENTENCE                                          00000100
 12494        ELSE                                                      00000101
 12495           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 12496                                                                  00000103
 12497     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 12498           NEXT SENTENCE                                          00000105
 12499        ELSE                                                      00000106
 12500           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 12501                                                                  00000108
 12502     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 12503     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 12504     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 12505         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 12506     ELSE                                                         ECSRTPFM
 12507         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 12508     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 12509                                                                  ECSRTPFM
 12510     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 12511     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 12512     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 242
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 12513         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 12514     ELSE                                                         ECSRTPFM
 12515         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 12516     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 12517                                                                  ECSRTPFM
 12518     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 12519         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 12520             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 12521                                                                  ECSRTPFM
 12522
 12523     MOVE 'X'                  TO REIN-RT-SW.
 12524     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 12525     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 12526     MOVE ' '                  TO REIN-RT-SW.
 12527
 12528 3030-RE-CALCULATE-REINSURANCE.
 12529
 12530     IF AM-RECALC-REIN = 'Y'
 12531         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 12532            CR-REIN-SPEC = SPACE  AND
 12533            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 12534             PERFORM 3600-RC-REINSURANCE
 12535                 THRU 3799-RC-REINSURANCE-X.
 12536
 12537     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 12538         VARYING SUB1 FROM 1 BY 1
 12539             UNTIL REIN-COMP (SUB1) = SPACES.
 12540
 12541     GO TO 3099-REINSURE-ROUTINE-X.
 12542
 12543 3040-REIN-REC-CNT.
 12544
 12545     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 12546         GO TO 3049-RRC-XIT.
 12547
 12548     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 12549         VARYING B-SUB FROM 1 BY 1
 12550             UNTIL B-SUB GREATER THAN 50.
 12551
 12552 3049-RRC-XIT.
 12553     EXIT.
 12554
 12555 3050-REIN-COMP-ADD.
 12556
 12557     IF RB-COMPANY (B-SUB) = SPACES
 12558         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 12559     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 12560         MOVE 1   TO RB-COUNT (B-SUB)
 12561         MOVE +50 TO B-SUB.
 12562
 12563 3059-RCA-XIT.
 12564     EXIT.
 12565
 12566 3099-REINSURE-ROUTINE-X.
 12567     EXIT.
 12568
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 243
* ECS010D.cbl
 12570******************************************************************
 12571***                R E I N S U R E   I S S U E S               ***
 12572******************************************************************
 12573
 12574 3100-REINSURE-ISSUE.
 12575
 12576     IF  REIN-COMP (1) = SPACES
 12577         GO TO 3199-REINSURE-ISSUE-X.
 12578
 12579     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12580     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 12581     MOVE 'I'      TO DE-TRANS.
 12582     MOVE 'R'      TO DE-REIN.
 12583*****PERFORM EXTRACT-DATE-RELOAD.
 12584     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12585     MOVE +1       TO SUB1.
 12586
 12587 3110-REINSURE-ISSUE-LOOP.
 12588
 12589     IF REIN-COMP (SUB1) = SPACES
 12590         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 12591
 12592     IF UPDATING-RISK-PREMIUMS
 12593       IF REIN-REM-SW (SUB1) NOT = 'I'
 12594         ADD +1 TO SUB1
 12595         GO TO 3110-REINSURE-ISSUE-LOOP.
 12596
 12597     IF REIN-REM-SW (SUB1) = 'Z'
 12598         ADD +1 TO SUB1
 12599         GO TO 3110-REINSURE-ISSUE-LOOP.
 12600
 12601     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12602     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12603     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12604     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12605     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12606     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12607
 12608     IF REIN-REM-SW (SUB1) NOT = 'I'
 12609         GO TO 3115-CONTINUE-ISSUE-LOOP.
 12610
 12611     IF RWF-LFPRM = ZEROS  AND
 12612        RWF-AHPRM = ZEROS
 12613         GO TO 3115-CONTINUE-ISSUE-LOOP.
 12614
 12615     IF RWF-LFPRM NOT = ZEROS
 12616         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 12617         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 12618
 12619     IF RWF-AHPRM NOT = ZEROS
 12620         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 12621         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 12622
 12623 3115-CONTINUE-ISSUE-LOOP.
 12624
 12625     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 12626     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 12627
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 244
* ECS010D.cbl
 12628     IF DE-REI-LFAMT NOT = ZERO
 12629        OR DE-REI-LFPRM NOT = ZERO
 12630        OR DE-REI-AHAMT NOT = ZERO
 12631        OR DE-REI-AHPRM NOT = ZERO
 12632         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12633                 2599-WRT-DETAIL-X
 12634         ADD +1 TO BC-R-ISS.
 12635
 12636     ADD +1 TO SUB1.
 12637     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 12638     PERFORM EXTRACT-DATE-LOAD.
 12639
 12640     GO TO 3110-REINSURE-ISSUE-LOOP.
 12641
 12642 3119-REINSURE-ISSUE-LOOP-END.
 12643     EXIT.
 12644
 12645 3190-REINSURE-ISSUE-PRINT.
 12646
 12647     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12648     IF RW-ACCUM-LF NOT = ZERO
 12649         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12650         MOVE CR-LF-TERM               TO TRD-LFTRM
 12651         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 12652         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 12653     IF RW-ACCUM-AH NOT = ZERO
 12654         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12655         MOVE CR-AH-TERM               TO TRD-AHTRM
 12656         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 12657         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 12658     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 12659         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12660
 12661 3199-REINSURE-ISSUE-X.
 12662     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 245
* ECS010D.cbl
 12664******************************************************************
 12665***               R E I N S U R E   C A N C E L S              ***
 12666******************************************************************
 12667
 12668 3200-REINSURE-CANCEL.
 12669
 12670     IF REIN-COMP (1) = SPACES
 12671         GO TO 3299-REINSURE-CANCEL-X.
 12672
 12673     IF CR-LFRFND = ZERO
 12674        AND CR-AHRFND = ZERO
 12675         GO TO 3299-REINSURE-CANCEL-X.
 12676
 12677     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 12678             VARYING SUB1 FROM +1 BY +1 UNTIL
 12679                       REIN-COMP (SUB1) = SPACES.
 12680
 12681     IF REIN-RT-SW = 'X'
 12682         GO TO 3299-REINSURE-CANCEL-X.
 12683
 12684     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 12685     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 12686     MOVE 'R'      TO DE-REIN.
 12687*****PERFORM EXTRACT-DATE-RELOAD.
 12688     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12689     MOVE +1       TO SUB1.
 12690
 12691 3210-REINSURE-CANCEL-LOOP.
 12692
 12693     IF REIN-COMP (SUB1) = SPACES
 12694         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 12695
 12696     IF REIN-REM-SW (SUB1) = 'Z'
 12697         ADD +1        TO SUB1
 12698         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 12699         PERFORM EXTRACT-DATE-LOAD
 12700         GO TO 3210-REINSURE-CANCEL-LOOP.
 12701
 12702     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12703     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12704
 12705     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 12706     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 12707     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12708     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12709     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12710     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12711     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 12712     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 12713     COMPUTE DE-REI-CNAMT ROUNDED = RWF-LFAMT * TEMP-5.
 12714
 12715     IF REIN-REM-SW (SUB1) NOT = 'I'
 12716         GO TO 3215-CONTINUE-CANCEL-LOOP.
 12717
 12718     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 12719        VOIDING-LF-CANCEL
 12720         NEXT SENTENCE
 12721     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 246
* ECS010D.cbl
 12722         MOVE ZEROS             TO DE-REI-LFRFND.
 12723
 12724     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 12725        VOIDING-AH-CANCEL
 12726         NEXT SENTENCE
 12727     ELSE
 12728         MOVE ZEROS             TO DE-REI-AHRFND.
 12729
 12730 3215-CONTINUE-CANCEL-LOOP.
 12731
 12732     IF RWF-LF-RUNOFF-SW = 'N'
 12733         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 12734             MOVE ZEROS         TO DE-LF-TYPE
 12735                                   DE-REI-LFAMT
 12736                                   DE-REI-LFPRM
 12737                                   DE-REI-LFRFND
 12738                                   DE-REI-CNAMT.
 12739
 12740     IF RWF-AH-RUNOFF-SW = 'N'
 12741         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 12742             MOVE ZEROS         TO DE-AH-TYPE
 12743                                   DE-REI-AHAMT
 12744                                   DE-REI-AHPRM
 12745                                   DE-REI-AHRFND.
 12746
 12747     IF DE-REI-LFAMT NOT = ZERO
 12748        OR DE-REI-LFPRM NOT = ZERO
 12749        OR DE-REI-AHAMT NOT = ZERO
 12750        OR DE-REI-AHPRM NOT = ZERO
 12751        OR DE-REI-LFRFND NOT = ZERO
 12752        OR DE-REI-AHRFND NOT = ZERO
 12753        OR DE-REI-CNAMT NOT = ZERO
 12754         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12755                                            2599-WRT-DETAIL-X
 12756         ADD +1 TO BC-R-CNC.
 12757
 12758     ADD +1 TO SUB1.
 12759     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 12760     PERFORM EXTRACT-DATE-LOAD.
 12761     GO TO 3210-REINSURE-CANCEL-LOOP.
 12762
 12763 3219-REINSURE-CANCEL-LOOP-END.
 12764     EXIT.
 12765
 12766 3290-REINSURE-CANCEL-PRINT.
 12767
 12768     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12769     IF RW-ACCUM-LF NOT = ZERO
 12770         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12771         MOVE CR-LF-TERM               TO TRD-LFTRM
 12772         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 12773         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 12774     IF RW-ACCUM-AH NOT = ZERO
 12775         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12776         MOVE CR-AH-TERM               TO TRD-AHTRM
 12777         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 12778         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 12779     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 247
* ECS010D.cbl
 12780         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12781
 12782 3299-REINSURE-CANCEL-X.
 12783     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 248
* ECS010D.cbl
 12785******************************************************************
 12786***                R E I N S U R E   C L A I M S               ***
 12787******************************************************************
 12788
 12789 3300-REINSURE-CLAIM.
 12790
 12791*    IF DTE-CLIENT = '???'
 12792*       IF (REIN-RT-SW NOT = 'X')  AND
 12793*          (PC-PAYMENT-TYPE = '5' OR '6')
 12794*        GO TO 3399-REINSURE-CLAIM-X.
 12795
 12796     IF REIN-COMP (1) = SPACES
 12797         GO TO 3399-REINSURE-CLAIM-X.
 12798
 12799     IF REIN-RT-SW = 'X'
 12800         MOVE CR-DTHAMT   TO RW-LFCLMWK
 12801         ADD  CR-DTHEXP   TO RW-LFCLMWK
 12802         MOVE CR-DISAMT   TO RW-AHCLMWK
 12803         ADD  CR-DISEXP   TO RW-AHCLMWK
 12804     ELSE
 12805         IF PC-CLAIM-TYPE  = 1 OR 3
 12806             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 12807             MOVE +0                  TO RW-AHCLMWK
 12808         ELSE
 12809             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 12810             MOVE +0                  TO RW-LFCLMWK.
 12811
 12812     MOVE +0                          TO RW-LFCLM
 12813                                         RW-AHCLM.
 12814     IF RW-LFCLMWK = ZERO
 12815        AND RW-AHCLMWK = ZERO
 12816         GO TO 3399-REINSURE-CLAIM-X.
 12817
 12818     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 12819         VARYING SUB1 FROM +1 BY +1
 12820             UNTIL REIN-COMP (SUB1) = SPACES.
 12821
 12822     IF REIN-RT-SW = 'X'
 12823         GO TO 3399-REINSURE-CLAIM-X.
 12824
 12825     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 12826     MOVE ZEROS                TO RW-ACCUM-CLM.
 12827     MOVE 'R'                  TO DE-REIN.
 12828*****PERFORM EXTRACT-DATE-RELOAD.
 12829     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 12830     MOVE +1                   TO SUB1.
 12831
 12832 3310-REINSURE-CLAIM-LOOP.
 12833
 12834     IF REIN-COMP (SUB1) = SPACES
 12835         GO TO 3390-REINSURE-CLAIM-PRINT.
 12836
 12837     IF REIN-REM-SW (SUB1) = 'Z'
 12838         ADD +1        TO SUB1
 12839         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 12840         PERFORM EXTRACT-DATE-LOAD
 12841         GO TO 3310-REINSURE-CLAIM-LOOP.
 12842
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 249
* ECS010D.cbl
 12843     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12844     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12845
 12846     IF PC-CLAIM-TYPE  = 1 OR 3
 12847         IF RWF-LF-RUNOFF-SW = 'N'
 12848           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12849               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 12850
 12851     IF PC-CLAIM-TYPE  = 2 OR 4
 12852         IF RWF-AH-RUNOFF-SW = 'N'
 12853           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12854               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 12855
 12856     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12857     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12858     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12859     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12860
 12861     IF PC-CLAIM-TYPE  = 1 OR 3
 12862         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 12863         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 12864     ELSE
 12865         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 12866         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 12867
 12868     IF PC-CLAIM-TYPE = 1 OR 3
 12869         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 12870            AND DE-REI-CLAIM-AMT
 12871             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 12872         ELSE
 12873             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 12874     ELSE
 12875         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 12876            AND DE-REI-CLAIM-AMT
 12877             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 12878         ELSE
 12879             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 12880
 12881 3320-REINSURE-CLAIM-LOOP-GO.
 12882
 12883     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12884     ADD +1                     TO BC-R-CLM.
 12885
 12886 3330-REINSURE-CLAIM-LOOP-ADD.
 12887
 12888     ADD +1                     TO SUB1.
 12889     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 12890     PERFORM EXTRACT-DATE-LOAD.
 12891     GO TO 3310-REINSURE-CLAIM-LOOP.
 12892
 12893 3390-REINSURE-CLAIM-PRINT.
 12894
 12895     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12896     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12897         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12898         MOVE CR-LF-TERM               TO TRD-LFTRM
 12899         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 12900         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 250
* ECS010D.cbl
 12901     ELSE
 12902         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12903         MOVE CR-AH-TERM               TO TRD-AHTRM
 12904         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 12905         MOVE CR-DIS-MO        TO TRD-AHACTMO
 12906         MOVE CR-DIS-DA        TO TRD-AHACTDA
 12907         MOVE CR-DIS-YR        TO TRD-AHACTYR
 12908         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 12909         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 12910     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12911
 12912 3399-REINSURE-CLAIM-X.
 12913     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 251
* ECS010D.cbl
 12915******************************************************************
 12916***              R E I N S U R E   R E S E R V E S             ***
 12917******************************************************************
 12918
 12919 3400-REINSURE-RESERVE.
 12920
 12921     IF REIN-COMP (1) = SPACES
 12922         GO TO 3499-REINSURE-RESERVE-X.
 12923
 12924     IF PC-CLAIM-TYPE = '1' OR '3'
 12925         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 12926         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 12927         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 12928         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 12929         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 12930     ELSE
 12931         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 12932         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 12933         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 12934         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 12935         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 12936
 12937     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 12938                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 12939     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 12940         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 12941          GO TO 3499-REINSURE-RESERVE-X.
 12942
 12943     IF DTE-CLIENT NOT = 'MIC'
 12944         GO TO 3405-REINSURE-RESERVE-CONT.
 12945
 12946     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12947         GO TO 3405-REINSURE-RESERVE-CONT.
 12948
 12949     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 12950     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 12951     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 12952     MOVE 'A'                        TO CP-BENEFIT-TYPE
 12953                                        CP-CLAIM-TYPE.
 12954     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 12955     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 12956     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 12957     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 12958     MOVE ZEROS                      TO CP-CDT-PERCENT.
 12959     MOVE '3'                        TO CP-CDT-METHOD.
 12960     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 12961     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 12962                                        CP-RATING-BENEFIT-AMT.
 12963     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 12964     MOVE 'O'                        TO CP-CLAIM-STATUS.
 12965
 12966 3405-REINSURE-RESERVE-CONT.
 12967
 12968     PERFORM 3500-REINSURE-CALC-RESERVE
 12969         THRU 3599-REINSURE-CALC-RESERVE-X
 12970             VARYING SUB1 FROM +1 BY +1
 12971                 UNTIL REIN-COMP (SUB1) = SPACES.
 12972
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 252
* ECS010D.cbl
 12973     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 12974     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 12975     MOVE 'R'            TO DE-REIN.
 12976*****PERFORM EXTRACT-DATE-RELOAD.
 12977     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12978     MOVE +1             TO SUB1.
 12979
 12980 3410-REINSURE-RESERVE-LOOP.
 12981
 12982     IF REIN-COMP (SUB1) = SPACES
 12983         GO TO 3490-REINSURE-RESERVE-PRINT.
 12984
 12985     IF REIN-REM-SW (SUB1) = 'Z'
 12986         ADD +1 TO SUB1
 12987         GO TO 3410-REINSURE-RESERVE-LOOP.
 12988
 12989     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12990     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12991
 12992     IF PC-CLAIM-TYPE  = 1 OR 3
 12993         IF RWF-LF-RUNOFF-SW = 'N'
 12994           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12995               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 12996
 12997     IF PC-CLAIM-TYPE  = 2 OR 4
 12998         IF RWF-AH-RUNOFF-SW = 'N'
 12999           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13000               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13001
 13002     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13003     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13004     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13005     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13006
 13007     IF PC-CLAIM-TYPE = 1 OR 3
 13008         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 13009         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 13010         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 13011     ELSE
 13012         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 13013         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 13014         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 13015
 13016     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 13017     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 13018     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 13019
 13020     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 13021        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 13022        OR DE-REI-FUTRSV
 13023         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13024                                            2599-WRT-DETAIL-X
 13025         ADD +1 TO BC-R-CRS.
 13026
 13027 3415-REINSURE-RESERVE-LOOP-ADD.
 13028
 13029     ADD +1 TO SUB1.
 13030     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 253
* ECS010D.cbl
 13031     PERFORM EXTRACT-DATE-LOAD.
 13032     GO TO 3410-REINSURE-RESERVE-LOOP.
 13033
 13034 3490-REINSURE-RESERVE-PRINT.
 13035
 13036     IF RW-ACCUM-IBNR   = ZERO  AND
 13037        RW-ACCUM-PAYCUR = ZERO  AND
 13038        RW-ACCUM-FUTRSV = ZERO
 13039         GO TO 3499-REINSURE-RESERVE-X.
 13040
 13041     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13042     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 13043     MOVE 'IBNR'                    TO TRD-IBNRX.
 13044     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 13045     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 13046     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 13047     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 13048
 13049     IF PC-CLAIM-TYPE = 1
 13050         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 13051     ELSE
 13052         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 13053     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 13054
 13055     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13056
 13057 3499-REINSURE-RESERVE-X.
 13058     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 254
* ECS010D.cbl
 13060******************************************************************
 13061***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 13062******************************************************************
 13063
 13064 3500-REINSURE-CALC-RESERVE.
 13065
 13066     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13067     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 13068                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 13069
 13070     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 13071        VARYING CO-SUB FROM 1 BY 1 UNTIL
 13072          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 13073       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 13074
 13075     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 13076        MOVE ZERO TO CO-SUB.
 13077
 13078     IF CO-SUB NOT = ZERO
 13079        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13080           IF PC-CLAIM-TYPE = '1' OR '3'
 13081             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13082                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13083
 13084     IF PC-CLAIM-TYPE  = 1 OR 3
 13085         IF RWF-LF-RUNOFF-SW = 'N'
 13086           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13087               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13088
 13089     IF CO-SUB NOT = ZERO
 13090        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13091           IF PC-CLAIM-TYPE = '2' OR '4'
 13092             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13093                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13094
 13095     IF PC-CLAIM-TYPE  = 2 OR 4
 13096         IF RWF-AH-RUNOFF-SW = 'N'
 13097           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13098               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13099
 13100     IF DTE-CLIENT NOT = 'MIC'
 13101         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13102
 13103     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13104         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13105
 13106     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 13107
 13108     IF CR-AHTYP = ZERO  OR
 13109        CO-SUB = ZERO
 13110         GO TO 3505-REIN-CALC-RESERVE-CONT
 13111     ELSE
 13112         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13113             GO TO 3505-REIN-CALC-RESERVE-CONT.
 13114
 13115     COMPUTE MAX-REM-TERM ROUNDED =
 13116                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 13117
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 255
* ECS010D.cbl
 13118     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 13119         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13120
 13121     COMPUTE CP-ORIGINAL-TERM =
 13122                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 13123
 13124     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 13125
 13126     IF  CP-RETURN-CODE = ZERO
 13127         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 13128
 13129 3505-REIN-CALC-RESERVE-CONT.
 13130
 13131     IF SUB1 = RE-100-COMP
 13132         GO TO 3520-REIN-REMAINDER-RSRV.
 13133
 13134     IF CR-LFAMT NOT = ZERO  AND
 13135        RWF-LFAMT NOT = ZERO
 13136         IF DTE-CLIENT NOT = 'MIC'
 13137             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 13138                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13139             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 13140                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13141             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 13142                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13143         ELSE
 13144             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 13145             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 13146             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 13147
 13148     IF CR-AHAMT NOT = ZERO  AND
 13149        RWF-AHAMT NOT = ZERO
 13150         IF DTE-CLIENT NOT = 'MIC'
 13151             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 13152                         RWF-AHAMT) / CR-AHAMT
 13153             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 13154                         RWF-AHAMT) / CR-AHAMT
 13155             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 13156                         RWF-AHAMT) / CR-AHAMT
 13157         ELSE
 13158             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13159             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13160             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13161
 13162 3510-REINSURE-CALC-RESERVE-ADD.
 13163
 13164     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13165     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13166     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13167     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13168     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13169     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13170
 13171     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13172         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13173
 13174     IF CO-SUB = ZERO
 13175         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 256
* ECS010D.cbl
 13176
 13177 3513-REIN-CHK-LF-RSRV-LIMIT.
 13178     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13179         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13180
 13181     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13182         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13183
 13184     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13185                                      (RWF-LFCLM +
 13186                                       RWF-DTH-PAYCUR +
 13187                                       RWF-DTH-FUTRSV).
 13188
 13189     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13190         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13191
 13192     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 13193
 13194     IF RWF-DTH-PAYCURL LESS THAN ZERO
 13195         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 13196         MOVE ZEROS TO RWF-DTH-PAYCURL.
 13197     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 13198         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 13199
 13200     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 13201
 13202     IF RWF-DTH-PAYCUR LESS THAN ZERO
 13203         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 13204         MOVE ZEROS TO RWF-DTH-PAYCUR.
 13205     IF RWF-DTH-FUTRSV LESS THAN ZERO
 13206         MOVE ZEROS TO RWF-DTH-FUTRSV.
 13207
 13208 3515-REIN-CHK-AH-RSRV-LIMIT.
 13209     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13210         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13211
 13212     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 13213         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 13214
 13215     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 13216                                      (RWF-AHCLM +
 13217                                       RWF-DIS-PAYCUR +
 13218                                       RWF-DIS-FUTRSV).
 13219
 13220     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13221         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13222
 13223     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 13224
 13225     IF RWF-DIS-PAYCURL LESS THAN ZERO
 13226         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 13227         MOVE ZEROS TO RWF-DIS-PAYCURL.
 13228     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 13229         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 13230
 13231     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 13232
 13233     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 257
* ECS010D.cbl
 13234         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 13235         MOVE ZEROS TO RWF-DIS-PAYCUR.
 13236     IF RWF-DIS-FUTRSV LESS THAN ZERO
 13237         MOVE ZEROS TO RWF-DIS-FUTRSV.
 13238
 13239 3519-REINSURE-CALC-RESERVE-END.
 13240
 13241     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 13242        OR RWF-DTH-FUTRSV
 13243         MOVE 'X' TO REIN-LF-FLG (SUB1).
 13244
 13245     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 13246        OR RWF-DIS-FUTRSV
 13247         MOVE 'X' TO REIN-AH-FLG (SUB1).
 13248
 13249     GO TO 3540-CONT-REIN-CALC-RESERVE.
 13250
 13251 3520-REIN-REMAINDER-RSRV.
 13252
 13253     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 13254     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 13255     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 13256     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 13257     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 13258     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 13259
 13260     PERFORM 3530-REIN-SUB-RSRV
 13261         THRU 3539-REIN-SUB-RSRV-X
 13262             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 13263
 13264     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 13265
 13266 3530-REIN-SUB-RSRV.
 13267
 13268     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 13269     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 13270     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 13271     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 13272     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 13273     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 13274
 13275 3539-REIN-SUB-RSRV-X.
 13276     EXIT.
 13277
 13278 3540-CONT-REIN-CALC-RESERVE.
 13279
 13280     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 13281         MOVE 'X' TO REIN-BUS-FLAG.
 13282     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 13283
 13284 3599-REINSURE-CALC-RESERVE-X.
 13285     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 258
* ECS010D.cbl
 13287******************************************************************
 13288***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 13289******************************************************************
 13290
 13291*REINSURANCE-CALCULATIONS.
*13292                             COPY ECSRIRTN.
 13293******************************************************************04/30/98
 13294*                                                                *ECSRIRTN
 13295*                            ECSRIRTN                            *   LV012
 13296*                            VMOD=2.025.                         *ECSRIRTN
 13297*                                                                *ECSRIRTN
 13298******************************************************************ECSRIRTN
 13299******************************************************************
 13300*                   C H A N G E   L O G
 13301*
 13302* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 13303*-----------------------------------------------------------------
 13304*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 13305* EFFECTIVE    NUMBER
 13306*-----------------------------------------------------------------
 13307* 062703                   PEMA  ADD DCC CLIENT ID TO
 13308*                                SPECIAL CEDED CLAIM CALC
 13309* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 13310* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
 13311                                                                  ECSRIRTN
 13312 REINSURE-CALC.                                                   ECSRIRTN
 13313                                                                  ECSRIRTN
 13314     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 13315     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13316     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 13317     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 13318                                   REIN-REM-SW (SUB1).            ECSRIRTN
 13319                                                                  ECSRIRTN
 13320     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 13321                                   WS-RWF-EP-STOP-DATE-N             CL*12
 13322                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 13323                                                                  ECSRIRTN
 13324     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13325                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 13326                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 13327                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13328                                                                  ECSRIRTN
 13329     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 13330        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 13331          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 13332          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 13333          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 13334                                                                  ECSRIRTN
 13335     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 13336        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 13337         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13338                                                                  ECSRIRTN
 13339     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 13340                                          WS-RWF-EP-STOP-DATE-N      CL*12
 13341                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 13342                                                                  ECSRIRTN
 13343     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 13344         GO TO CALC-CONTINUED.                                    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 259
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13345                                                                  ECSRIRTN
 13346     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 13347         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13348                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 13349                                                                  ECSRIRTN
 13350     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 13351         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 13352                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13353                                                                  ECSRIRTN
 13354 CALC-CONTINUED.                                                  ECSRIRTN
 13355                                                                  ECSRIRTN
 13356     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 13357     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 13358                                                                  ECSRIRTN
 13359     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 13360         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 13361     ELSE                                                         ECSRIRTN
 13362         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 13363     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 13364                                                                  ECSRIRTN
 13365     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 13366     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 13367     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 13368         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 13369     ELSE                                                         ECSRIRTN
 13370         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 13371     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 13372                                                                  ECSRIRTN
 13373     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 13374         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 13375         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 13376         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 13377         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 13378         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 13379         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 13380                                                                  ECSRIRTN
 13381     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 13382         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 13383                                                                  ECSRIRTN
 13384     IF CR-DT LESS WT-LO-DATE                                        CL**2
 13385         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 13386                                                                  ECSRIRTN
 13387     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 13388         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 13389                                                                  ECSRIRTN
 13390     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 13391     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 13392                                                                  ECSRIRTN
 13393     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 13394         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 13395                                                                  ECSRIRTN
 13396     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 13397       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 13398        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 13399        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 13400           NEXT SENTENCE                                          ECSRIRTN
 13401       ELSE                                                       ECSRIRTN
 13402           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 260
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13403                       REIN-AH-FLG (SUB1).                        ECSRIRTN
 13404                                                                  ECSRIRTN
 13405     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 13406         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 13407            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 13408             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 13409                                                                  ECSRIRTN
 13410     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 13411         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 13412            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 13413             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 13414                                                                  ECSRIRTN
 13415     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 13416         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 13417             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 13418                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 13419             ELSE                                                 ECSRIRTN
 13420                 NEXT SENTENCE                                    ECSRIRTN
 13421         ELSE                                                     ECSRIRTN
 13422             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 13423                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 13424                                                                  ECSRIRTN
 13425     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 13426         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 13427             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 13428                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 13429             ELSE                                                 ECSRIRTN
 13430                 NEXT SENTENCE                                    ECSRIRTN
 13431         ELSE                                                     ECSRIRTN
 13432             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 13433                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 13434                                                                  ECSRIRTN
 13435     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 13436         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 13437                                                                  ECSRIRTN
 13438     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 13439         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 13440         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 13441                                                                  ECSRIRTN
 13442     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 13443         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 13444                                                                  ECSRIRTN
 13445     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 13446         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 13447         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 13448                                                                  ECSRIRTN
 13449     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13450         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 13451                                                                  ECSRIRTN
 13452     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13453         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 13454                                                                  ECSRIRTN
 13455     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 13456                                                                  ECSRIRTN
 13457 REINSURE-CK-LIFE.                                                ECSRIRTN
 13458                                                                  ECSRIRTN
 13459     IF CR-LFTYP = ZERO                                           ECSRIRTN
 13460         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 261
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13461                                                                  ECSRIRTN
 13462     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 13463         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13464                                                                  ECSRIRTN
 13465     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 13466         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 13467             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13468                                                                  ECSRIRTN
 13469     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 13470                                                                  ECSRIRTN
 13471     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 13472         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 13473             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 13474         ELSE                                                     ECSRIRTN
 13475             NEXT SENTENCE                                        ECSRIRTN
 13476     ELSE                                                         ECSRIRTN
 13477         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 13478             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13479                                                                  ECSRIRTN
 13480     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 13481         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 13482             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 13483         ELSE                                                     ECSRIRTN
 13484             NEXT SENTENCE                                        ECSRIRTN
 13485     ELSE                                                         ECSRIRTN
 13486         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 13487             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13488                                                                  ECSRIRTN
 13489     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 13490         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 13491             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13492                                                                  ECSRIRTN
 13493     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 13494         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 13495            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13496                                                                  ECSRIRTN
 13497     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 13498         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 13499             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13500                                                                  ECSRIRTN
 13501     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 13502         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 13503            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13504                                                                  ECSRIRTN
 13505     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 13506         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 13507             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13508                                                                  ECSRIRTN
 13509     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 13510         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 13511            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 13512            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 13513             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13514                                                                  ECSRIRTN
 13515     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 13516         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 13517            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 13518             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 262
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13519                                                                  ECSRIRTN
 13520     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 13521         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 13522             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13523                                                                  ECSRIRTN
 13524     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 13525         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 13526             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13527                                                                  ECSRIRTN
 13528     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 13529        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 13530           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 13531            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13532                                                                  ECSRIRTN
 13533     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 13534         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13535            CR-IND-GRP = '1'                                      ECSRIRTN
 13536             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13537                                                                  ECSRIRTN
 13538     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 13539         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 13540            CR-IND-GRP = '1'                                      ECSRIRTN
 13541             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13542                                                                  ECSRIRTN
 13543     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 13544         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13545            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 13546            CR-IND-GRP = '1'                                      ECSRIRTN
 13547             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13548                                                                  ECSRIRTN
 13549     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 13550         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13551            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 13552            CR-IND-GRP = '1'                                      ECSRIRTN
 13553             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13554                                                                  ECSRIRTN
 13555     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 13556         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 13557            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13558                                                                  ECSRIRTN
 13559     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 13560        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 13561                                                                  ECSRIRTN
 13562     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 13563         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13564                                                                  ECSRIRTN
 13565     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 13566         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13567                                                                  ECSRIRTN
 13568     IF CR-LF-TERM  NUMERIC                                       00002331
 13569        NEXT SENTENCE                                             00002332
 13570     ELSE                                                         00002333
 13571        MOVE ZEROS               TO CR-LF-TERM                    00002334
 13572     END-IF
 13573                                                                  00002335
 13574     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 13575         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13576                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 263
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13577     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
 13578         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13579                                                                  ECSRIRTN
 13580     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 13581                                                                  ECSRIRTN
 13582     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 13583         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13584                                                                  ECSRIRTN
 13585     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 13586         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13587                                                                  ECSRIRTN
 13588     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 13589                                                                  ECSRIRTN
 13590 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 13591     EXIT.                                                        ECSRIRTN
 13592                                                                  ECSRIRTN
 13593 REINSURE-CK-AH.                                                  ECSRIRTN
 13594                                                                  ECSRIRTN
 13595     IF CR-AHTYP = ZERO                                           ECSRIRTN
 13596         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13597                                                                  ECSRIRTN
 13598     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 13599         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13600                                                                  ECSRIRTN
 13601     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 13602         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 13603             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13604                                                                  ECSRIRTN
 13605     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 13606                                                                  ECSRIRTN
 13607     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 13608         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 13609             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 13610         ELSE                                                     ECSRIRTN
 13611             NEXT SENTENCE                                        ECSRIRTN
 13612     ELSE                                                         ECSRIRTN
 13613         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 13614             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13615                                                                  ECSRIRTN
 13616     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 13617         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 13618             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13619                                                                  ECSRIRTN
 13620     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 13621         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 13622             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13623                                                                  ECSRIRTN
 13624     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 13625         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 13626             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13627                                                                  ECSRIRTN
 13628     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 13629         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 13630             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13631                                                                  ECSRIRTN
 13632     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 13633         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 13634            CR-IND-GRP = '1'                                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 264
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13635             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13636                                                                  ECSRIRTN
 13637     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 13638         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 13639             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13640                                                                  ECSRIRTN
 13641     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 13642         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 13643            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 13644                                                                  ECSRIRTN
 13645     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 13646         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 13647            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 13648                                                                  ECSRIRTN
 13649     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 13650         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 13651             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13652                                                                  ECSRIRTN
 13653     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 13654        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 13655                                                                  ECSRIRTN
 13656     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 13657         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13658                                                                  ECSRIRTN
 13659     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 13660         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13661                                                                  ECSRIRTN
 13662     IF CR-AH-TERM  NUMERIC                                       00002331
 13663        NEXT SENTENCE                                             00002332
 13664     ELSE                                                         00002333
 13665        MOVE ZEROS               TO CR-AH-TERM                    00002334
 13666     END-IF
 13667                                                                  00002335
 13668     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 13669         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13670                                                                  ECSRIRTN
 13671     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 13672         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13673                                                                  ECSRIRTN
 13674     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 13675                                                                  ECSRIRTN
 13676     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 13677         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 13678             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 13679                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 13680                                                                  ECSRIRTN
 13681     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 13682         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 13683             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 13684                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 13685                                                                  ECSRIRTN
 13686     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 13687     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 13688                                                                  ECSRIRTN
 13689     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 13690         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 13691                                                                  ECSRIRTN
 13692     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 265
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13693         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
 13694                                                                  ECSRIRTN
 13695     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 13696                                                                  ECSRIRTN
 13697     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 13698                                                                  ECSRIRTN
 13699     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 13700         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13701                                                                  ECSRIRTN
 13702     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13703         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13704                                                                  ECSRIRTN
 13705     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 13706                                                                  ECSRIRTN
 13707 REINSURE-CK-AH-X.                                                ECSRIRTN
 13708     EXIT.                                                        ECSRIRTN
 13709                                                                  ECSRIRTN
 13710 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 13711                                                                  ECSRIRTN
 13712     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 13713        RS-AH-BEN = ZERO                                          ECSRIRTN
 13714         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 13715                                                                  ECSRIRTN
 13716     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 13717        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13718         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 13719                                                                  ECSRIRTN
 13720     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13721                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 13722                                                                  ECSRIRTN
 13723     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 13724         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 13725             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 13726                                     WT-AHBEN-HI.                 ECSRIRTN
 13727     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 13728         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 13729             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 13730                                     WT-AHMOA-HI.                 ECSRIRTN
 13731                                                                  ECSRIRTN
 13732     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 13733     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 13734                                                                  ECSRIRTN
 13735     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 13736         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 13737                                                                  ECSRIRTN
 13738     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 13739         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 13740                                                                  ECSRIRTN
 13741     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 13742                                                                  ECSRIRTN
 13743     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13744         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 13745                                                                  ECSRIRTN
 13746     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 13747         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 13748                                       / RW-AHWRK                 ECSRIRTN
 13749       ELSE                                                       ECSRIRTN
 13750         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 266
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13751                                                                  ECSRIRTN
 13752     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 13753         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 13754                                       / RS-LIFE-BEN              ECSRIRTN
 13755       ELSE                                                       ECSRIRTN
 13756         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 13757                                                                  ECSRIRTN
 13758     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 13759        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 13760          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 13761          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 13762                                      / CR-AH-TERM.               ECSRIRTN
 13763                                                                  ECSRIRTN
 13764     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 13765        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 13766          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13767          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 13768               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 13769            ELSE                                                  ECSRIRTN
 13770                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 13771                                                                  ECSRIRTN
 13772     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 13773        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 13774        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 13775          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 13776          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 13777                                      / CR-AH-TERM                ECSRIRTN
 13778         ELSE                                                     ECSRIRTN
 13779          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13780          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 13781               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 13782            ELSE                                                  ECSRIRTN
 13783                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 13784                                                                  ECSRIRTN
 13785 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 13786     EXIT.                                                        ECSRIRTN
 13787                                                                  ECSRIRTN
 13788                                                                  ECSRIRTN
 13789 REIN-CALC-LIFE.                                                  ECSRIRTN
 13790                                                                  ECSRIRTN
 13791     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 13792         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 13793     ELSE                                                         ECSRIRTN
 13794         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 13795                                                                  ECSRIRTN
 13796     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 13797         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 13798     ELSE                                                         ECSRIRTN
 13799         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 13800           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 13801               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 13802           ELSE                                                   ECSRIRTN
 13803               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 13804                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 13805                                                                  ECSRIRTN
 13806 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 13807                                                                  ECSRIRTN
 13808     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 267
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13809                                                                  ECSRIRTN
 13810     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13811         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 13812                                                                  ECSRIRTN
 13813     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13814         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 13815         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 13816                                                                  ECSRIRTN
 13817     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 13818         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 13819                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 13820         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 13821                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 13822     ELSE                                                         ECSRIRTN
 13823         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 13824             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 13825             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 13826                                                                  ECSRIRTN
 13827     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 13828         (WT-LF-QC = '2' AND                                         CL**8
 13829          PGM-SUB = +50  AND                                         CL**8
 13830          DTE-CLIENT = 'LAP'))                                       CL**8
 13831          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 13832     ELSE                                                         ECSRIRTN
 13833         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 13834                                                                  ECSRIRTN
 13835     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 13836         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 13837         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 13838         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 13839                                                                  ECSRIRTN
 13840     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 13841                                                                  ECSRIRTN
 13842 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 13843                                                                  ECSRIRTN
 13844     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 13845         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 13846         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 13847                                                                  ECSRIRTN
 13848     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 13849     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 13850     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 13851                                       RW-LFPRM.                  ECSRIRTN
 13852                                                                  ECSRIRTN
 13853 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 13854                                                                  ECSRIRTN
 13855     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 13856                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 13857                                                                  ECSRIRTN
 13858     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 13859        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 13860                                                                  ECSRIRTN
 13861     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 13862        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13863         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 13864     ELSE                                                         ECSRIRTN
 13865         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13866         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 268
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13867                                                                  ECSRIRTN
 13868                                                                  ECSRIRTN
 13869 REIN-CALC-LIFE-X.                                                ECSRIRTN
 13870     EXIT.                                                        ECSRIRTN
 13871                                                                  ECSRIRTN
 13872 REIN-CALC-AH.                                                    ECSRIRTN
 13873                                                                  ECSRIRTN
 13874     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 13875         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 13876             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 13877                                 WT-AHBEN-HI.                     ECSRIRTN
 13878                                                                  ECSRIRTN
 13879     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 13880         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 13881             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 13882                                 WT-AHMOA-HI.                     ECSRIRTN
 13883                                                                  ECSRIRTN
 13884     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 13885     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 13886                                                                  ECSRIRTN
 13887     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 13888         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 13889                                                                  ECSRIRTN
 13890     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 13891         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 13892                                                                  ECSRIRTN
 13893     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13894         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 13895                                                                  ECSRIRTN
 13896     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 13897         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 13898     ELSE                                                         ECSRIRTN
 13899         IF WT-REMAINING = 'L'                                    ECSRIRTN
 13900             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 13901         ELSE                                                     ECSRIRTN
 13902             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 13903             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 13904                                                                  ECSRIRTN
 13905 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 13906                                                                  ECSRIRTN
 13907     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13908         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 13909                                                                  ECSRIRTN
 13910     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13911         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 13912         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 13913                                                                  ECSRIRTN
 13914     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 13915         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 13916                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 13917         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 13918                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 13919     ELSE                                                         ECSRIRTN
 13920         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 13921             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 13922             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 13923                                                                  ECSRIRTN
 13924     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 269
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13925         (WT-AH-QC = '2' AND                                         CL**8
 13926          PGM-SUB = +50  AND                                         CL**8
 13927          DTE-CLIENT = 'LAP'))                                       CL**8
 13928         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 13929     ELSE                                                         ECSRIRTN
 13930         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 13931                                                                  ECSRIRTN
 13932     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 13933         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 13934            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 13935                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 13936                                                                  ECSRIRTN
 13937     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 13938         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 13939         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 13940         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 13941                                                                  ECSRIRTN
 13942     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 13943                                                                  ECSRIRTN
 13944 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 13945                                                                  ECSRIRTN
 13946     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 13947         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 13948         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 13949                                                                  ECSRIRTN
 13950     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 13951     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 13952     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 13953                                    RW-AHPRM.                     ECSRIRTN
 13954                                                                  ECSRIRTN
 13955 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 13956                                                                  ECSRIRTN
 13957     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 13958                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 13959                                                                  ECSRIRTN
 13960     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 13961                                                                  ECSRIRTN
 13962     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 13963        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13964         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 13965     ELSE                                                         ECSRIRTN
 13966         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13967         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 13968                                                                  ECSRIRTN
 13969                                                                  ECSRIRTN
 13970 REIN-CALC-AH-X.                                                  ECSRIRTN
 13971     EXIT.                                                        ECSRIRTN
 13972                                                                  ECSRIRTN
 13973 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 13974                                                                  ECSRIRTN
 13975     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 13976     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 13977     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 13978     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 13979                                                                  ECSRIRTN
 13980     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 13981         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 13982                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 270
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13983     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
 13984        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 13985           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 13986                                                                  ECSRIRTN
 13987     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 13988        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 13989           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 13990                                                                  ECSRIRTN
 13991 REINSURE-CALC-X.                                                 ECSRIRTN
 13992                                                                  ECSRIRTN
 13993     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 13994         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 13995                                                                  ECSRIRTN
 13996     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 13997                                                                  ECSRIRTN
 13998 REINSURE-SUBTRACT.                                               ECSRIRTN
 13999                                                                  ECSRIRTN
 14000     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 14001     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 14002     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 14003     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 14004                                                                  ECSRIRTN
 14005 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 14006     EXIT.                                                        ECSRIRTN
 14007                                                                  ECSRIRTN
 14008 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 14009                                                                  ECSRIRTN
 14010     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14011     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14012                                                                  ECSRIRTN
 14013     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14014         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 14015                                                                  ECSRIRTN
 14016     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14017         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14018                                                                  ECSRIRTN
 14019     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14020         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 14021             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 14022                                                                  ECSRIRTN
 14023     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14024         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 14025                                                                  ECSRIRTN
 14026     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14027         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 14028         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14029                                                                  ECSRIRTN
 14030     IF CR-LFPRM = ZERO                                           ECSRIRTN
 14031        MOVE ZERO                TO REIN-FACTOR
 14032     ELSE                                                         ECSRIRTN
 14033        IF DTE-CLIENT = 'GIC'  AND
 14034           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14035           MOVE +1.0             TO REIN-FACTOR
 14036        ELSE
 14037           IF DTE-CLIENT = 'DCC'
 14038              COMPUTE REIN-FACTOR = CR-LFRFND /
 14039                 (CR-LFPRM + CR-LFPRM-ALT)
 14040           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 271
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14041              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 14042                 (CR-LFPRM + CR-LFPRM-ALT)
 14043            END-IF
 14044         END-IF
 14045     END-IF
 14046                                                                  ECSRIRTN
 14047     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14048         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14049             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14050                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 14051                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14052             ELSE                                                 ECSRIRTN
 14053                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14054                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14055                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 14056                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14057         ELSE                                                     ECSRIRTN
 14058             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14059                 compute rein-factor rounded =
 14060                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 14061                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
 14062                    rein-factor
 14063             ELSE                                                 ECSRIRTN
 14064*                COMPUTE RWF-LFRFND = REIN-FACTOR
 14065*                   * REIN-CALCED-LIFE *
 14066*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 14067                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14068                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14069                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 14070                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 14071                                                                  ECSRIRTN
 14072     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14073         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14074             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14075                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14076                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 14077             ELSE                                                 ECSRIRTN
 14078                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14079                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14080                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14081                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 14082                                                                  ECSRIRTN
 14083     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 14084                                                                  ECSRIRTN
 14085                                                                  ECSRIRTN
 14086 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 14087                                                                  ECSRIRTN
 14088     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14089       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 14090         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14091         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14092                                                                  ECSRIRTN
 14093     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14094       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 14095           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 14096           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 14097       ELSE                                                       ECSRIRTN
 14098           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 272
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14099               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 14100                                                                  ECSRIRTN
 14101     IF FLAT-CANCEL-LF                                            ECSRIRTN
 14102         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 14103         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14104                                                                  ECSRIRTN
 14105     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 14106         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14107         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14108                                                                  ECSRIRTN
 14109     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 14110     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14111     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 14112                                         RW-LFRFND.               ECSRIRTN
 14113                                                                  ECSRIRTN
 14114 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14115                                                                  ECSRIRTN
 14116     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 14117                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14118                                                                  ECSRIRTN
 14119     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14120        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14121                                                                  ECSRIRTN
 14122     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 14123        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14124         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 14125     ELSE                                                         ECSRIRTN
 14126         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14127         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 14128                                                                  ECSRIRTN
 14129                                                                  ECSRIRTN
 14130 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 14131                                                                  ECSRIRTN
 14132     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14133         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14134                                                                  ECSRIRTN
 14135     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14136         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 14137             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 14138                                                                  ECSRIRTN
 14139     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14140         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 14141         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 14142             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 14143                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14144         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14145                                                                  ECSRIRTN
 14146     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14147         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 14148                                                                  ECSRIRTN
 14149     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14150         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 14151         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14152                                                                  ECSRIRTN
 14153     IF CR-AHPRM = ZERO                                           ECSRIRTN
 14154        MOVE ZERO                TO REIN-FACTOR
 14155     ELSE
 14156        IF DTE-CLIENT = 'GIC'  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 273
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14157           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14158            MOVE +1.0            TO REIN-FACTOR
 14159        ELSE
 14160           IF DTE-CLIENT = 'DCC'
 14161              COMPUTE REIN-FACTOR =
 14162                 CR-AHRFND / CR-AHPRM
 14163           ELSE
 14164              COMPUTE REIN-FACTOR ROUNDED =
 14165                                CR-AHRFND-CALC / CR-AHPRM
 14166           END-IF
 14167        END-IF
 14168     END-IF
 14169
 14170     IF CR-AHAMT NOT = ZERO
 14171        IF (DTE-CLIENT = 'DCC')
 14172           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14173           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14174        ELSE
 14175           IF WT-AH-QC = ('1' OR '4')
 14176              compute rein-factor rounded = rwf-ahamt / cr-ahamt
 14177              compute rwf-ahrfnd rounded =
 14178                 cr-ahrfnd * rein-factor
 14179           ELSE
 14180              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14181              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14182                       RWF-AHAMT) / CR-AHAMT
 14183           END-IF
 14184        END-IF
 14185     ELSE
 14186        IF RWF-AH-LIMIT = ZERO
 14187           IF WT-AH-QC = ('1' OR '4')
 14188              COMPUTE RWF-AHRFND ROUNDED =
 14189                       CR-AHRFND * WT-AH-PCT
 14190           ELSE
 14191              COMPUTE RWF-AHRFND =
 14192                            REIN-FACTOR * REIN-CALCED-AH
 14193              COMPUTE RWF-AHRFND ROUNDED =
 14194                       RWF-AHRFND * WT-AH-PCT
 14195           END-IF
 14196        END-IF
 14197     END-IF
 14198
 14199     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 14200                                                                  ECSRIRTN
 14201                                                                  ECSRIRTN
 14202 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 14203                                                                  ECSRIRTN
 14204     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14205       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 14206         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14207         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14208                                                                  ECSRIRTN
 14209     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14210       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 14211           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 14212           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 14213       ELSE                                                       ECSRIRTN
 14214           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 274
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14215               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 14216                                                                  ECSRIRTN
 14217     IF FLAT-CANCEL-AH                                            ECSRIRTN
 14218         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
 14219         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14220                                                                  ECSRIRTN
 14221     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 14222         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14223         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14224                                                                  ECSRIRTN
 14225     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14226     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14227     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14228                                    RW-AHRFND.                    ECSRIRTN
 14229                                                                  ECSRIRTN
 14230 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14231                                                                  ECSRIRTN
 14232     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 14233                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14234                                                                  ECSRIRTN
 14235     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14236                                                                  ECSRIRTN
 14237     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 14238        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14239         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 14240     ELSE                                                         ECSRIRTN
 14241         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14242         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 14243                                                                  ECSRIRTN
 14244                                                                  ECSRIRTN
 14245 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 14246                                                                  ECSRIRTN
 14247     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14248         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14249                                                                  ECSRIRTN
 14250     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14251         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14252                                                                  ECSRIRTN
 14253     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 14254                                                                  ECSRIRTN
 14255 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 14256                                                                  ECSRIRTN
 14257     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 14258     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 14259                                                                  ECSRIRTN
 14260     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 14261         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 14262             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14263                                                                  ECSRIRTN
 14264     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14265         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14266                                                                  ECSRIRTN
 14267     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14268         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14269                                                                  ECSRIRTN
 14270 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 14271                                                                  ECSRIRTN
 14272     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 275
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14273         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14274                                                                  ECSRIRTN
 14275     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14276                                                                  ECSRIRTN
 14277 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 14278                                                                  ECSRIRTN
 14279     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 14280     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 14281                                                                  ECSRIRTN
 14282 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 14283     EXIT.                                                        ECSRIRTN
 14284                                                                  ECSRIRTN
 14285 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 14286                                                                  ECSRIRTN
 14287     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14288         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 14289                                                                  ECSRIRTN
 14290 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 14291     EXIT.                                                        ECSRIRTN
 14292                                                                  ECSRIRTN
 14293 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 14294                                                                  ECSRIRTN
 14295     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14296     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14297                                                                  ECSRIRTN
 14298     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14299         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 14300                                                                  ECSRIRTN
 14301     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14302        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14303          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14304          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14305          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14306                                                                  ECSRIRTN
 14307     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14308        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14309          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 14310                                                                  ECSRIRTN
 14311     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 14312                                  RWF-AHCLML.                     ECSRIRTN
 14313                                                                  ECSRIRTN
 14314     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14315         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14316                                                                  ECSRIRTN
 14317     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 14318         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14319                                                                  ECSRIRTN
 14320     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14321         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14322             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 14323                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14324                                                                  ECSRIRTN
 14325     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14326         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14327                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14328                                                                  ECSRIRTN
 14329     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14330         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 276
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14331                                                                  ECSRIRTN
 14332     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14333         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14334             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
 14335                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14336             ELSE                                                 ECSRIRTN
 14337                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 14338         ELSE                                                     ECSRIRTN
 14339             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 14340                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 14341                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14342             ELSE                                                 ECSRIRTN
 14343                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 14344                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 14345                                                                  ECSRIRTN
 14346     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14347         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14348                                                                  ECSRIRTN
 14349     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14350         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14351            OR 'DCC'
 14352             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 14353                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14354         ELSE                                                     ECSRIRTN
 14355             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 14356                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 14357                                                                  ECSRIRTN
 14358     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14359         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14360             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 14361                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 14362                                                                  ECSRIRTN
 14363     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14364         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 14365             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 14366                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 14367                                                                  ECSRIRTN
 14368     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14369         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 14370             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 14371               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 14372                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 14373                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 14374                  ELSE                                            ECSRIRTN
 14375                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 14376                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 14377              ELSE                                                ECSRIRTN
 14378                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 14379                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 14380                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 14381                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 14382                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 14383                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 14384                                                                  ECSRIRTN
 14385     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 14386                                                                  ECSRIRTN
 14387     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 14388                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 277
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14389                                                                  ECSRIRTN
 14390 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 14391                                                                  ECSRIRTN
 14392     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14393         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14394                                                                  ECSRIRTN
 14395     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 14396         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 14397     ELSE                                                         ECSRIRTN
 14398         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 14399                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 14400                                                                  ECSRIRTN
 14401     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14402         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14403                                                                  ECSRIRTN
 14404     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14405         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 14406             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 14407         ELSE                                                     ECSRIRTN
 14408             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 14409     ELSE                                                         ECSRIRTN
 14410         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 14411             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 14412             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 14413         ELSE                                                     ECSRIRTN
 14414             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 14415             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 14416                                                                  ECSRIRTN
 14417                                                                  ECSRIRTN
 14418 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 14419                                                                  ECSRIRTN
 14420     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14421         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 14422                                                                  ECSRIRTN
 14423     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14424         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14425                                                                  ECSRIRTN
 14426     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14427         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 14428                                                                  ECSRIRTN
 14429     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 14430     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 14431                                                                  ECSRIRTN
 14432     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 14433             VARYING                                              ECSRIRTN
 14434         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 14435             UNTIL                                                ECSRIRTN
 14436         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 14437                                                                  ECSRIRTN
 14438     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14439         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 14440     ELSE                                                         ECSRIRTN
 14441         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 14442                                                                  ECSRIRTN
 14443 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 14444                                                                  ECSRIRTN
 14445     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 14446         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 278
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14447                                                                  ECSRIRTN
 14448     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14449       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 14450           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
 14451                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 14452               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 14453                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 14454               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 14455                                                                  ECSRIRTN
 14456     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14457       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 14458           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 14459                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 14460           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 14461                                                                  ECSRIRTN
 14462     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 14463         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 14464                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 14465                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 14466         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14467                                                                  ECSRIRTN
 14468     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14469         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14470                                                                  ECSRIRTN
 14471     IF INC-SUB = +1                                              ECSRIRTN
 14472         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14473     IF INC-SUB = +2                                              ECSRIRTN
 14474         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14475     IF INC-SUB = +3                                              ECSRIRTN
 14476         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14477     IF INC-SUB = +4                                              ECSRIRTN
 14478         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14479     IF INC-SUB = +5                                              ECSRIRTN
 14480         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14481                                                                  ECSRIRTN
 14482     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 14483                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 14484                                                                  ECSRIRTN
 14485     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14486         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14487                                                                  ECSRIRTN
 14488     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 14489              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 14490         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 14491     ELSE                                                         ECSRIRTN
 14492         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 14493                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 14494                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 14495                                                                  ECSRIRTN
 14496 CHECK-DISABS-EXIT.                                               ECSRIRTN
 14497      EXIT.                                                       ECSRIRTN
 14498                                                                  ECSRIRTN
 14499 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 14500                                                                  ECSRIRTN
 14501     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14502         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14503                                                                  ECSRIRTN
 14504     IF CO-SUB NOT = ZERO                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 279
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14505         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14506             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 14507                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 14508                                                                  ECSRIRTN
 14509     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14510         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14511             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 14512                                                                  ECSRIRTN
 14513 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 14514                                                                  ECSRIRTN
 14515     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14516         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 14517         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 14518             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 14519                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14520         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 14521         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14522                                                                  ECSRIRTN
 14523     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14524         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 14525                                                                  ECSRIRTN
 14526     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14527         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14528             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 14529                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 14530             ELSE                                                 ECSRIRTN
 14531                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 14532         ELSE                                                     ECSRIRTN
 14533             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 14534                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 14535                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 14536             ELSE                                                 ECSRIRTN
 14537                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 14538                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 14539                                                                  ECSRIRTN
 14540     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14541         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14542                                                                  ECSRIRTN
 14543     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 14544         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 14545                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 14546     ELSE                                                         ECSRIRTN
 14547         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 14548             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 14549                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 14550                                                                  ECSRIRTN
 14551     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14552         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 14553             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 14554                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 14555                                                                  ECSRIRTN
 14556     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14557         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 14558             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 14559               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 14560                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 14561                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 14562                  ELSE                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 280
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14563                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 14564                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 14565              ELSE                                                ECSRIRTN
 14566                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
 14567                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 14568                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 14569                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 14570                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 14571                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 14572                                                                  ECSRIRTN
 14573                                                                  ECSRIRTN
 14574     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 14575        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 14576                               '220000' OR '230000')              ECSRIRTN
 14577           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 14578               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 14579                                                                  ECSRIRTN
 14580     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 14581                                                                  ECSRIRTN
 14582     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 14583                                                                  ECSRIRTN
 14584                                                                  ECSRIRTN
 14585 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 14586                                                                  ECSRIRTN
 14587     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14588         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14589                                                                  ECSRIRTN
 14590     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14591         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 14592         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14593                                                                  ECSRIRTN
 14594     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 14595                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 14596                                                                  ECSRIRTN
 14597     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14598         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14599                                                                  ECSRIRTN
 14600     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 14601         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14602                                                                  ECSRIRTN
 14603     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 14604                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 14605         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 14606                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 14607         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 14608     ELSE                                                         ECSRIRTN
 14609         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 14610         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 14611                                                                  ECSRIRTN
 14612                                                                  ECSRIRTN
 14613 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 14614                                                                  ECSRIRTN
 14615     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 14616         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14617                                                                  ECSRIRTN
 14618     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 14619         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14620                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 281
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14621     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 14622                                                                  ECSRIRTN
 14623 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 14624                                                                  ECSRIRTN
 14625     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 14626     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 14627                                                                  ECSRIRTN
 14628     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 14629         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 14630             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14631                                                                  ECSRIRTN
 14632     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 14633     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 14634                                                                  ECSRIRTN
 14635     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 14636         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14637                                                                  ECSRIRTN
 14638     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 14639         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14640                                                                  ECSRIRTN
 14641 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 14642                                                                  ECSRIRTN
 14643     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14644         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14645                                                                  ECSRIRTN
 14646     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14647                                                                  ECSRIRTN
 14648 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 14649                                                                  ECSRIRTN
 14650     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 14651     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 14652                                                                  ECSRIRTN
 14653 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 14654     EXIT.                                                        ECSRIRTN
 14655                                                                  ECSRIRTN
 14656 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 14657                                                                  ECSRIRTN
 14658     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14659         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 14660                                                                  ECSRIRTN
 14661 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 14662     EXIT.                                                        ECSRIRTN
 14663                                                                  ECSRIRTN
 14664                                                                  ECSRIRTN
 14665 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 14666                                                                  ECSRIRTN
 14667     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 14668     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 14669     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 14670     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 14671                                                                  ECSRIRTN
 14672     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 14673         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 14674         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 14675         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 14676         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 14677         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 14678         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 282
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14679         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 14680         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 14681         REIN-AH-LIMIT (1).                                       ECSRIRTN
 14682                                                                  ECSRIRTN
 14683     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 14684         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 14685                                                                  ECSRIRTN
 14686     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 14687                                                                  ECSRIRTN
 14688 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 14689                                                                  ECSRIRTN
 14690     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 14691                                                                  ECSRIRTN
 14692 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 14693     EXIT.                                                        ECSRIRTN
 14694                                                                  ECSRIRTN
 14695 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 14696                                                                  ECSRIRTN
 14697     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 14698                                                                  ECSRIRTN
 14699     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 14700         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 14701                                                                  ECSRIRTN
 14702     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 14703         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 14704             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 14705                                                                  ECSRIRTN
 14706     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14707         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 14708         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 14709         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 14710     ELSE                                                         ECSRIRTN
 14711         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 14712         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 14713         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 14714                                                                  ECSRIRTN
 14715     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 14716                                                                  ECSRIRTN
 14717     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 14718        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 14719         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 14720                                                                  ECSRIRTN
 14721     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 14722         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 14723                                                                  ECSRIRTN
 14724 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 14725     EXIT.                                                        ECSRIRTN
 14726                                                                  ECSRIRTN
 14727 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 14728                                                                  ECSRIRTN
 14729     CONTINUE.                                                    ECSRIRTN
 14730*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 14731 FIND-REI-CO-EXIT.                                                ECSRIRTN
 14732     EXIT.                                                        ECSRIRTN
 14733                                                                  ECSRIRTN
 14734 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 14735                                                                  ECSRIRTN
 14736     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 283
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14737         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 14738                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 14739                                                                  ECSRIRTN
 14740     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
 14741         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 14742                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 14743                                                                  ECSRIRTN
 14744     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 14745                                                                  ECSRIRTN
 14746     START ERRTBL-IN                                              ECSRIRTN
 14747           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 14748             INVALID KEY                                          ECSRIRTN
 14749               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 14750                                                                  ECSRIRTN
 14751     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 14752     MOVE 0 TO SUB1.                                              ECSRIRTN
 14753 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 14754                                                                  ECSRIRTN
 14755     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 14756                                                                  ECSRIRTN
 14757     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 14758        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 14759                                                                  ECSRIRTN
 14760     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 14761        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 14762        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 14763                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14764        GO TO ABEND-PGM.                                          ECSRIRTN
 14765                                                                  ECSRIRTN
 14766     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 14767        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 14768                                                                  ECSRIRTN
 14769     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 14770        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 14771                                                                  ECSRIRTN
 14772     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 14773        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 14774                                                                  ECSRIRTN
 14775     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 14776        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 14777                                                                  ECSRIRTN
 14778     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 14779        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14780                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 14781        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 283)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14782                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 14783        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 283)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14784                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 14785     END-PERFORM.                                                 ECSRIRTN
 14786     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 14787                                                                  ECSRIRTN
 14788     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 284
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14789        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 14790                                                                  ECSRIRTN
 14791     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 14792        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
 14793                                                                  ECSRIRTN
 14794     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 14795        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 14796                                                                  ECSRIRTN
 14797     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 14798        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 14799                                                                  ECSRIRTN
 14800     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 14801        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 14802        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 14803        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 14804        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 14805        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 14806        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 14807          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 14808                                                                  ECSRIRTN
 14809     ADD +1 TO CO-SUB.                                            ECSRIRTN
 14810                                                                  ECSRIRTN
 14811     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 14812        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 14813        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 14814        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 14815        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 14816                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14817        GO TO ABEND-PGM.                                          ECSRIRTN
 14818                                                                  ECSRIRTN
 14819     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 14820                                                                  ECSRIRTN
 14821     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 14822                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 14823     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 14824                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 14825     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 14826                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 14827                                                                  ECSRIRTN
 14828     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 14829         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 14830     ELSE                                                         ECSRIRTN
 14831         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 14832                                                                  ECSRIRTN
 14833     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 14834     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 14835     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 14836     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 14837                                                                  ECSRIRTN
 14838 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 14839                                                                  ECSRIRTN
 14840     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 14841        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 14842                                                                  ECSRIRTN
 14843     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 14844        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 14845                                                                  ECSRIRTN
 14846     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 285
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14847        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 14848                                                                  ECSRIRTN
 14849     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 14850        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
 14851                                                                  ECSRIRTN
 14852     ADD +1 TO SUB1.                                              ECSRIRTN
 14853                                                                  ECSRIRTN
 14854     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 14855        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 14856        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 14857                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14858        GO TO ABEND-PGM.                                          ECSRIRTN
 14859                                                                  ECSRIRTN
 14860     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 14861     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 14862     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 14863     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 14864     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 14865     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 14866     if re-state-exhibit-opt-f = 'Y'
 14867        move 'Y'         to rc2-ecs152-rpt (sub1)
 14868     else
 14869        move 'N'         to rc2-ecs152-rpt (sub1)
 14870     end-if
 14871                                                                  ECSRIRTN
 14872     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 14873                                                                  ECSRIRTN
 14874 REIN-BUILD-EXIT.                                                 ECSRIRTN
 14875     EXIT.                                                        ECSRIRTN
 14876                                                                  ECSRIRTN
 14877 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 14878                                                                  ECSRIRTN
 14879     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 14880                                                                  ECSRIRTN
 14881     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 14882                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 14883                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 14884                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 14885                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 14886                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 14887                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 14888                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 14889                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 14890                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 14891                                                                  ECSRIRTN
 14892 ZERO-RCT-EXIT.                                                   ECSRIRTN
 14893     EXIT.                                                        ECSRIRTN
 14894                                                                  ECSRIRTN
 14895 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 14896                                                                  ECSRIRTN
 14897     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 14898                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 14899     move spaces      to rc2-ecs152-rpt (co-sub)
 14900                                                                  ECSRIRTN
 14901     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 14902                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 14903                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 14904                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 286
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14905                                                                  ECSRIRTN
 14906 ZERO-RC2-EXIT.                                                   ECSRIRTN
 14907     EXIT.                                                        ECSRIRTN
 14908******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 287
* ECS010D.cbl
 14910******************************************************************
 14911***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 14912******************************************************************
 14913
 14914 3600-RC-REINSURANCE.
 14915
 14916     IF DTE-PGM-OPT NOT = '1'
 14917         GO TO 3799-RC-REINSURANCE-X.
 14918
 14919     IF DTE-CLIENT = 'WSL'
 14920         IF CR-REIN-TABLE = '00A'
 14921             GO TO 3799-RC-REINSURANCE-X.
 14922
 14923     IF CR-REIN-TABLE = SPACES OR ZEROS
 14924         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 14925
 14926 3610-CLEAR-RC-REIN.
 14927
 14928     MOVE SPACES TO RC-REIN-LEVELS (1).
 14929     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 14930                    RC-REIN-LFPRM (1)
 14931                    RC-REIN-AHAMT (1)
 14932                    RC-REIN-AHPRM (1)
 14933                    RC-REIN-LFRFND (1)
 14934                    RC-REIN-AHRFND (1)
 14935                    RC-REIN-LFCLM (1)
 14936                    RC-REIN-AHCLM (1).
 14937
 14938     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 14939         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 14940
 14941     MOVE +1 TO SUB1.
 14942     MOVE +0 TO SUB2.
 14943
 14944     GO TO 3630-RC-REIN-LOOP-1.
 14945
 14946 3620-CLEAR-RC-LEVELS.
 14947
 14948     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 14949
 14950
 14951 3630-RC-REIN-LOOP-1.
 14952
 14953     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 14954         ADD +1 TO SUB2
 14955         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 14956         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 14957         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 14958         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 14959         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 14960         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 14961         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 14962         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 14963         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 14964         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 14965
 14966     ADD +1 TO SUB1.
 14967     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 288
* ECS010D.cbl
 14968         GO TO 3630-RC-REIN-LOOP-1.
 14969
 14970     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 14971
 14972     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 14973     IF CR-REIN-TABLE = SPACES OR ZEROS
 14974         MOVE +1                     TO SUB1
 14975         GO TO 3710-RC-REIN-LOOP-2.
 14976
 14977     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 14978
 14979 3640-NSP-REIN-RATING-ROUTINE.
 14980
 14981     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 14982     MOVE 'L'                        TO DC-OPTION-CODE.
 14983     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 14984     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 14985     MOVE SPACES                     TO CP-ACCT-FLD-5.
 14986     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 14987     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 14988     MOVE CR-APR                     TO CP-LOAN-APR.
 14989     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 14990     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 14991     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 14992     MOVE ZEROS                      TO CP-CLASS-CODE.
 14993
 14994     IF DTE-CLIENT = 'TIC'
 14995        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 14996            MOVE ZERO                TO CP-CLASS-CODE
 14997        ELSE
 14998            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 14999
 15000     MOVE '3'                        TO CP-PROCESS-TYPE.
 15001     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 15002     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 15003
 15004 3650-NSP-REIN-LIFE.
 15005
 15006     IF CR-LFTYP = ZERO
 15007         GO TO 3660-NSP-REIN-AH.
 15008     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 15009        OR (DTE-CLIENT = 'DCC')
 15010         GO TO 3660-NSP-REIN-AH.
 15011     IF DTE-CLIENT NOT = 'LBL'
 15012         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 15013             GO TO 3660-NSP-REIN-AH.
 15014
 15015     IF RE-NSP-ST-CD-LF NOT = STATE-L
 15016         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 15017         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15018
 15019     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 15020     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 15021     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 15022                                        CP-RATING-BENEFIT-AMT.
 15023     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 15024     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 15025     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 289
* ECS010D.cbl
 15026     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 15027     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15028     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 15029     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15030
 15031     IF CP-STATE-STD-ABBRV = 'OR'
 15032         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 15033
 15034     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15035
 15036     IF CP-ERROR-RATE-NOT-FOUND  OR
 15037        CP-ERROR-RATE-IS-ZERO
 15038         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 15039                                     TO WS-ABEND-MESSAGE
 15040         MOVE 0302                   TO WS-ABEND-CODE
 15041         DISPLAY '******************************'
 15042         DISPLAY '***** ERROR LOCATION 018 *****'
 15043         DISPLAY '******************************'
 15044         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15045         GO TO ABEND-PGM.
 15046
 15047     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 15048
 15049*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 15050*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 15051
 15052     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 15053                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 15054
 15055     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 15056
 15057 3660-NSP-REIN-AH.
 15058
 15059     IF CR-AHTYP = ZERO
 15060         GO TO 3669-NSP-REIN-X.
 15061     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 15062        OR (DTE-CLIENT = 'DCC')
 15063         GO TO 3669-NSP-REIN-X.
 15064     IF DTE-CLIENT NOT = 'LBL'
 15065         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 15066             GO TO 3669-NSP-REIN-X.
 15067
 15068     IF RE-NSP-ST-CD-AH NOT = STATE-L
 15069         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 15070         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15071
 15072     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 15073     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 15074     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 15075                                        CP-RATING-BENEFIT-AMT.
 15076     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 15077     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 15078     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 15079     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 15080     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15081     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 15082     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15083
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 290
* ECS010D.cbl
 15084     IF CP-STATE-STD-ABBRV = 'OR'
 15085         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 15086
 15087     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15088
 15089     IF CP-ERROR-RATE-NOT-FOUND  OR
 15090        CP-ERROR-RATE-IS-ZERO
 15091         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 15092                                     TO WS-ABEND-MESSAGE
 15093         MOVE 0302                   TO WS-ABEND-CODE
 15094         DISPLAY '******************************'
 15095         DISPLAY '***** ERROR LOCATION 019 *****'
 15096         DISPLAY '******************************'
 15097         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15098         GO TO ABEND-PGM.
 15099
 15100     COMPUTE CR-AH-NSP-PRM ROUNDED =
 15101             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 15102
 15103     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 15104
 15105 3669-NSP-REIN-X.
 15106     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 291
* ECS010D.cbl
 15108******************************************************************
 15109***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 15110******************************************************************
 15111
 15112 3700-RC-REIN-PERF-CALC.
 15113
*15114                             COPY ECSRTPFM.
 15115******************************************************************07/10/97
 15116*                                                                *ECSRTPFM
 15117*                            ECSRTPFM                            *   LV001
 15118*                            VMOD=2.002                          *ECSRTPFM
 15119*                                                                *ECSRTPFM
 15120******************************************************************ECSRTPFM
 15121                                                                  ECSRTPFM
 15122     IF    CR-LFAMT  NUMERIC                                      00000072
 15123           NEXT SENTENCE                                          00000073
 15124        ELSE                                                      00000074
 15125           MOVE ZEROS TO CR-LFAMT.                                00000075
 15126                                                                  00000076
 15127     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 15128           NEXT SENTENCE                                          00000078
 15129        ELSE                                                      00000079
 15130           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 15131                                                                  00000081
 15132                                                                  00000082
 15133     IF    CR-LFPRM  NUMERIC                                      00000083
 15134           NEXT SENTENCE                                          00000084
 15135        ELSE                                                      00000085
 15136           MOVE ZEROS TO CR-LFPRM.                                00000086
 15137                                                                  00000087
 15138     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 15139           NEXT SENTENCE                                          00000089
 15140        ELSE                                                      00000090
 15141           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 15142                                                                  00000092
 15143                                                                  00000093
 15144     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 15145           NEXT SENTENCE                                          00000095
 15146        ELSE                                                      00000096
 15147           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 15148                                                                  00000098
 15149     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 15150           NEXT SENTENCE                                          00000100
 15151        ELSE                                                      00000101
 15152           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 15153                                                                  00000103
 15154     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 15155           NEXT SENTENCE                                          00000105
 15156        ELSE                                                      00000106
 15157           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15158                                                                  00000108
 15159     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15160     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15161     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15162         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15163     ELSE                                                         ECSRTPFM
 15164         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15165     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 292
* ECS010D.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15166                                                                  ECSRTPFM
 15167     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15168     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15169     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15170         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15171     ELSE                                                         ECSRTPFM
 15172         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15173     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15174                                                                  ECSRTPFM
 15175     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15176         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15177             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15178                                                                  ECSRTPFM
 15179
 15180     IF CR-STATE NOT = STATE-L
 15181         MOVE CR-STATE               TO STATE-L
 15182         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15183
 15184     MOVE 'X'                     TO REIN-RT-SW.
 15185     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15186     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15187     MOVE ' '                     TO REIN-RT-SW.
 15188
 15189 3710-RC-REIN-LOOP-2.
 15190
 15191     IF REIN-COMP (SUB1) = SPACES
 15192         GO TO 3730-RC-REIN-EXTRACTS.
 15193
 15194     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 15195        ADD +1 TO SUB1
 15196         GO TO 3710-RC-REIN-LOOP-2.
 15197
 15198     MOVE +1 TO SUB2.
 15199
 15200 3720-RC-REIN-LOOP-3.
 15201
 15202     IF RC-REIN-COMP (SUB2) = SPACES
 15203         ADD +1 TO SUB1
 15204         GO TO 3710-RC-REIN-LOOP-2.
 15205
 15206     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 15207         ADD +1 TO SUB2
 15208         GO TO 3720-RC-REIN-LOOP-3.
 15209
 15210     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 15211        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 15212        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 15213        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 15214         MOVE 'X' TO RC-OLD-ISS (SUB2)
 15215         MOVE 'X' TO RC-NEW-ISS (SUB1).
 15216
 15217     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 15218        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 15219         MOVE 'X' TO RC-OLD-CNC (SUB2)
 15220         MOVE 'X' TO RC-NEW-CNC (SUB1).
 15221
 15222     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 15223         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 293
* ECS010D.cbl
 15224         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 15225
 15226     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 15227         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 15228         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 15229
 15230     ADD +1 TO SUB2.
 15231     GO TO 3720-RC-REIN-LOOP-3.
 15232
 15233 3730-RC-REIN-EXTRACTS.
 15234
 15235     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 15236     MOVE 'R' TO DE-REIN.
 15237     MOVE 'J' TO DE-TRANS.
 15238*****PERFORM EXTRACT-DATE-RELOAD.
 15239     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 15240     MOVE +1 TO SUB1.
 15241
 15242 3740-RC-REIN-OLD-ISSUE.
 15243
 15244     IF RC-REIN-COMP (SUB1) = SPACES
 15245         MOVE +1 TO SUB1
 15246         GO TO 3745-RC-REIN-NEW-ISSUE.
 15247
 15248     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15249         ADD +1 TO SUB1
 15250         GO TO 3740-RC-REIN-OLD-ISSUE.
 15251
 15252     IF RC-OLD-ISS (SUB1) = 'X'
 15253         ADD +1 TO SUB1
 15254         GO TO 3740-RC-REIN-OLD-ISSUE.
 15255
 15256     IF RC-REIN-LFAMT (SUB1) = ZERO
 15257        AND RC-REIN-LFPRM (SUB1) = ZERO
 15258        AND RC-REIN-AHAMT (SUB1) = ZERO
 15259        AND RC-REIN-AHPRM (SUB1) = ZERO
 15260         ADD +1 TO SUB1
 15261         GO TO 3740-RC-REIN-OLD-ISSUE.
 15262
 15263     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 15264     PERFORM EXTRACT-DATE-LOAD.
 15265     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15266     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 15267     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 15268     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 15269     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 15270     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15271
 15272     ADD +1 TO BC-R-ISS.
 15273     ADD +1 TO SUB1.
 15274     GO TO 3740-RC-REIN-OLD-ISSUE.
 15275
 15276 3745-RC-REIN-NEW-ISSUE.
 15277
 15278     IF REIN-COMP (SUB1) = SPACES
 15279         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 15280                                         2259-END-CANCEL-BUILD
 15281         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 294
* ECS010D.cbl
 15282         MOVE 'K'      TO DE-TRANS
 15283*********PERFORM EXTRACT-DATE-RELOAD
 15284         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15285         MOVE +1       TO SUB1
 15286         GO TO 3750-RC-REIN-OLD-CANCEL.
 15287
 15288     IF REIN-REM-SW (SUB1) = 'Z'
 15289         ADD +1 TO SUB1
 15290         GO TO 3745-RC-REIN-NEW-ISSUE.
 15291
 15292     IF RC-NEW-ISS (SUB1) = 'X'
 15293         ADD +1 TO SUB1
 15294         GO TO 3745-RC-REIN-NEW-ISSUE.
 15295
 15296     IF REIN-LFAMT (SUB1) = ZERO
 15297        AND REIN-LFPRM (SUB1) = ZERO
 15298        AND REIN-AHAMT (SUB1) = ZERO
 15299        AND REIN-AHPRM (SUB1) = ZERO
 15300         ADD +1 TO SUB1
 15301         GO TO 3745-RC-REIN-NEW-ISSUE.
 15302
 15303     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15304     PERFORM EXTRACT-DATE-LOAD.
 15305     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15306     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15307     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15308     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15309     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15310     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15311
 15312     ADD +1 TO BC-R-ISS.
 15313     ADD +1 TO SUB1.
 15314     GO TO 3745-RC-REIN-NEW-ISSUE.
 15315
 15316 3750-RC-REIN-OLD-CANCEL.
 15317
 15318     IF RC-REIN-COMP (SUB1) = SPACES
 15319         MOVE +1 TO SUB1
 15320         GO TO 3755-RC-REIN-NEW-CANCEL.
 15321
 15322     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15323         ADD +1 TO SUB1
 15324         GO TO 3750-RC-REIN-OLD-CANCEL.
 15325
 15326     IF RC-OLD-CNC (SUB1) = 'X'
 15327         ADD +1 TO SUB1
 15328         GO TO 3750-RC-REIN-OLD-CANCEL.
 15329
 15330     IF RC-REIN-LFRFND (SUB1) = ZERO
 15331        AND RC-REIN-AHRFND (SUB1) = ZERO
 15332         ADD +1 TO SUB1
 15333         GO TO 3750-RC-REIN-OLD-CANCEL.
 15334
 15335     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 15336     PERFORM EXTRACT-DATE-LOAD.
 15337     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15338     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 15339     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 295
* ECS010D.cbl
 15340     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15341
 15342     ADD +1 TO BC-R-CNC.
 15343     ADD +1 TO SUB1.
 15344     GO TO 3750-RC-REIN-OLD-CANCEL.
 15345
 15346 3755-RC-REIN-NEW-CANCEL.
 15347
 15348     IF REIN-COMP (SUB1) = SPACES
 15349         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 15350         MOVE 'R' TO DE-REIN
 15351         MOVE 'L' TO DE-TRANS
 15352*********PERFORM EXTRACT-DATE-RELOAD
 15353         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15354         MOVE +1 TO SUB1
 15355         GO TO 3760-RC-REIN-OLD-CLAIM.
 15356
 15357     IF REIN-REM-SW (SUB1) = 'Z'
 15358         ADD +1 TO SUB1
 15359         GO TO 3755-RC-REIN-NEW-CANCEL.
 15360
 15361     IF RC-NEW-CNC (SUB1) = 'X'
 15362         ADD +1 TO SUB1
 15363         GO TO 3755-RC-REIN-NEW-CANCEL.
 15364
 15365     IF REIN-LFRFND (SUB1) = ZERO
 15366        AND REIN-AHRFND (SUB1) = ZERO
 15367         ADD +1 TO SUB1
 15368         GO TO 3755-RC-REIN-NEW-CANCEL.
 15369
 15370     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 15371     PERFORM EXTRACT-DATE-LOAD.
 15372     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 15373     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 15374     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 15375     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15376
 15377     ADD +1 TO BC-R-CNC.
 15378     ADD +1 TO SUB1.
 15379     GO TO 3755-RC-REIN-NEW-CANCEL.
 15380
 15381 3760-RC-REIN-OLD-CLAIM.
 15382
 15383     IF RC-REIN-COMP (SUB1) = SPACES
 15384         MOVE +1 TO SUB1
 15385         GO TO 3780-RC-REIN-NEW-CLAIM.
 15386
 15387     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15388         ADD +1 TO SUB1
 15389         GO TO 3760-RC-REIN-OLD-CLAIM.
 15390
 15391     IF RC-OLD-LF-CLM (SUB1) = 'X'
 15392         GO TO 3770-RC-REIN-OLD-AH-CLM.
 15393
 15394     IF RC-REIN-LFCLM (SUB1) = ZERO
 15395         GO TO 3770-RC-REIN-OLD-AH-CLM.
 15396
 15397     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 296
* ECS010D.cbl
 15398     PERFORM EXTRACT-DATE-LOAD.
 15399     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 15400     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15401     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15402     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15403     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15404     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 15405     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 15406     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 15407     MOVE CR-DTH-PAY-DT TO DE-PAY
 15408                           WS-DE-PAY-N.
 15409
 15410     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 15411         MOVE '3' TO DE-TYPE
 15412     ELSE
 15413         MOVE '1' TO DE-TYPE.
 15414
 15415     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15416
 15417     ADD +1 TO BC-R-CLM.
 15418
 15419 3770-RC-REIN-OLD-AH-CLM.
 15420
 15421     IF RC-OLD-AH-CLM (SUB1) = 'X'
 15422         ADD +1 TO SUB1
 15423         GO TO 3760-RC-REIN-OLD-CLAIM.
 15424
 15425     IF RC-REIN-AHCLM (SUB1) = ZERO
 15426         ADD +1 TO SUB1
 15427         GO TO 3760-RC-REIN-OLD-CLAIM.
 15428
 15429     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 15430     PERFORM EXTRACT-DATE-LOAD.
 15431     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 15432     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15433     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15434     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15435     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15436     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 15437     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 15438     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 15439     MOVE CR-DIS-PAY-DT TO DE-PAY
 15440                           WS-DE-PAY-N.
 15441
 15442     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 15443         MOVE '4' TO DE-TYPE
 15444     ELSE
 15445         MOVE '2' TO DE-TYPE.
 15446
 15447     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15448
 15449     ADD +1 TO BC-R-CLM.
 15450     ADD +1 TO SUB1.
 15451
 15452     GO TO 3760-RC-REIN-OLD-CLAIM.
 15453
 15454 3780-RC-REIN-NEW-CLAIM.
 15455
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 297
* ECS010D.cbl
 15456     IF REIN-COMP (SUB1) = SPACES
 15457         GO TO 3799-RC-REINSURANCE-X.
 15458
 15459     IF REIN-REM-SW (SUB1) = 'Z'
 15460         ADD +1 TO SUB1
 15461         GO TO 3780-RC-REIN-NEW-CLAIM.
 15462
 15463     IF RC-NEW-LF-CLM (SUB1) = 'X'
 15464         GO TO 3790-RC-REIN-NEW-AH-CLM.
 15465
 15466     IF REIN-LFCLM (SUB1) = ZERO
 15467         GO TO 3790-RC-REIN-NEW-AH-CLM.
 15468
 15469     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15470     PERFORM EXTRACT-DATE-LOAD.
 15471     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15472     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15473     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15474     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15475     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15476     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 15477     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 15478     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 15479     MOVE CR-DTH-PAY-DT     TO DE-PAY
 15480                               WS-DE-PAY-N.
 15481
 15482     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 15483         MOVE '3' TO DE-TYPE
 15484     ELSE
 15485         MOVE '1' TO DE-TYPE.
 15486
 15487     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15488
 15489     ADD +1 TO BC-R-CLM.
 15490
 15491 3790-RC-REIN-NEW-AH-CLM.
 15492
 15493     IF RC-NEW-AH-CLM (SUB1) = 'X'
 15494         ADD +1 TO SUB1
 15495         GO TO 3780-RC-REIN-NEW-CLAIM.
 15496
 15497     IF REIN-AHCLM (SUB1) = ZERO
 15498         ADD +1 TO SUB1
 15499         GO TO 3780-RC-REIN-NEW-CLAIM.
 15500
 15501     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15502     PERFORM EXTRACT-DATE-LOAD.
 15503     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15504     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15505     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15506     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15507     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15508     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 15509     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 15510     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 15511     MOVE CR-DIS-PAY-DT     TO DE-PAY
 15512                               WS-DE-PAY-N.
 15513
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 298
* ECS010D.cbl
 15514     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 15515         MOVE '4' TO DE-TYPE
 15516     ELSE
 15517         MOVE '2' TO DE-TYPE.
 15518
 15519     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15520
 15521     ADD +1 TO BC-R-CLM.
 15522     ADD +1 TO SUB1.
 15523
 15524     GO TO 3780-RC-REIN-NEW-CLAIM.
 15525
 15526 3799-RC-REINSURANCE-X.
 15527     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 299
* ECS010D.cbl
 15529******************************************************************
 15530***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 15531******************************************************************
 15532
 15533 4000-EP-BUMP-RTN.
 15534
 15535     IF AM-RECALC-COMM = ('Y' OR '1')
 15536        PERFORM 1600-RECALC-COMM-EXTR
 15537                                 THRU 1899-RECALC-COMM-EXTR-X
 15538        MOVE ' '                 TO RECALC-TYPE
 15539     END-IF
 15540
 15541     MOVE '1'    TO EP-FLG.
 15542     ADD +1      TO BC-G-CERTS.
 15543
 15544     MOVE CR-DT               TO HIGH-CERT.
 15545     IF CR-ACCT-CONTROL NOT = LOW-CTL
 15546         MOVE CR-DT           TO LOW-CERT
 15547         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 15548
 15549     IF CR-POLICY-IS-REIN-ONLY
 15550         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 15551                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 15552                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 15553                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 15554                              DTH-IBNR           DIS-IBNR
 15555                              DTH-PAYCUR         DIS-PAYCUR
 15556                              DTH-FUTRSV         DIS-FUTRSV
 15557         GO TO 4050-EP-DO-REINSURE.
 15558
 15559     MOVE CR-LFAMT       TO WE-LFAMT.
 15560     MOVE CR-LFPRM       TO WE-LFPRM.
 15561     IF CR-LFTYP NOT = ZEROS
 15562         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 15563             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 15564             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 15565         ELSE
 15566             MOVE ZEROS               TO WE-LFAMT-ALT
 15567                                         WE-LFPRM-ALT.
 15568
 15569     MOVE SPACES         TO REIN-EP-FLG
 15570                            WE-REIN-CO.
 15571     MOVE CR-LFRFND      TO WE-LFRFND.
 15572     MOVE CR-DTHAMT      TO WE-DTHAMT.
 15573     ADD  CR-DTHEXP      TO WE-DTHAMT.
 15574     MOVE CR-DTHEXP      TO WE-DTHEXP.
 15575     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 15576     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 15577     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 15578     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 15579
 15580     MOVE CR-AHPRM       TO WE-AHPRM.
 15581     MOVE CR-AHAMT       TO WE-AHAMT.
 15582     MOVE CR-AHRFND      TO WE-AHRFND.
 15583     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 15584     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 15585     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 15586     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 300
* ECS010D.cbl
 15587     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 15588     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 15589     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 15590
 15591     IF CR-POLICY-IS-RESTORE  OR
 15592        CR-POLICY-IS-REISSUE
 15593        OR CR-POLICY-IS-MONTHLY
 15594         MOVE ZEROS      TO WE-LFPRM
 15595                            WE-LFPRM-ALT
 15596                            WE-AHPRM.
 15597
 15598     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 15599                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 15600                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 15601                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 15602                              DTH-IBNR           DIS-IBNR
 15603                              DTH-PAYCUR         DIS-PAYCUR
 15604                              DTH-FUTRSV         DIS-FUTRSV.
 15605
 15606*     DISPLAY ' B4 4100 '
 15607     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 15608*     DISPLAY ' AFTER 4100 '
 15609
 15610     IF CR-POLICY-IS-DECLINED  OR
 15611        CR-POLICY-IS-VOID
 15612         GO TO 4099-EP-BUMP-RTN-X.
 15613
 15614 4050-EP-DO-REINSURE.
 15615
 15616     MOVE 'R' TO REIN-EP-FLG.
 15617     MOVE +1  TO SUB5.
 15618
 15619 4090-EP-DO-REINSURE-LOOP.
 15620
 15621*     DISPLAY ' 4090 '
 15622     IF REIN-COMP (SUB5) = SPACES
 15623         MOVE SPACE TO REIN-EP-FLG
 15624         GO TO 4099-EP-BUMP-RTN-X.
 15625
 15626     IF REIN-REM-SW (SUB5) = 'Z'  OR
 15627        REIN-LF-AH-FLGS (SUB5) = SPACES
 15628         ADD +1 TO SUB5
 15629         GO TO 4090-EP-DO-REINSURE-LOOP.
 15630
 15631     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 15632        VARYING CO-SUB FROM 1 BY 1 UNTIL
 15633          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 15634          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 15635          (RCT-REIN-CO (CO-SUB) = SPACES).
 15636
 15637     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 15638        (RCT-REIN-CO (CO-SUB) = SPACES)
 15639        MOVE ZERO TO CO-SUB.
 15640
 15641*     DISPLAY ' 4090 A '
 15642*     DISPLAY ' AM RECALC ' AM-RECALC-COMM
 15643     ADD +1 TO BC-R-CERTS.
 15644     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 301
* ECS010D.cbl
 15645     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 15646     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 15647
 15648     IF (DTE-CLIENT = 'DCC')
 15649        AND (CR-LFAMT + CR-LFAMT-ALT) > ZEROS
 15650*        DISPLAY ' B4 CEDE FACT '
 15651*        DISPLAY ' CR-LFAMT ' CR-LFAMT
 15652*        DISPLAY ' CR-LFAMT-ALT ' CR-LFAMT-ALT
 15653*        DISPLAY ' RWF-LFAMT ' RWF-LFAMT
 15654        COMPUTE WS-CEDE-FACT =
 15655           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15656*        DISPLAY ' AFTER CEDE FACT '
 15657        IF (AM-RECALC-COMM = ('Y' OR '1'))
 15658           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 15659                                     NOT = 'G' AND 'L')
 15660           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15661*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 15662*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 15663           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 15664           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 15665        END-IF
 15666     END-IF
 15667
 15668     MOVE RWF-LFPRM      TO WE-LFPRM.
 15669     MOVE RWF-LFAMT      TO WE-LFAMT.
 15670     MOVE RWF-LFRFND     TO WE-LFRFND.
 15671     MOVE RWF-LFCLM      TO WE-DTHAMT.
 15672     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 15673     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 15674     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 15675     MOVE +0             TO WE-LFAMT-ALT
 15676                            WE-LFPRM-ALT
 15677                            WE-DTHEXP
 15678                            WE-NUM-DTH-CLM.
 15679
 15680*     DISPLAY ' 4090 B '
 15681     IF (DTE-CLIENT EQUAL 'NSL') AND
 15682        (CR-REIN-TABLE EQUAL 'NAR')
 15683        CONTINUE
 15684     ELSE
 15685      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 15686       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 15687        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 15688            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15689        COMPUTE WE-LFAMT ROUNDED EQUAL
 15690                           CR-LFAMT * WS-CEDE-FACT
 15691        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 15692                           CR-LFAMT-ALT * WS-CEDE-FACT
 15693        IF (DTE-CLIENT = 'CID')
 15694           AND (CR-LF-NSP-PRM > +0)
 15695           AND (CR-ENTRY-DATE > 20031130)
 15696           AND (WT-LF-QC NOT = '1' AND '3')
 15697           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 15698              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 15699           MOVE +0            TO WE-LFPRM-ALT
 15700        ELSE
 15701          IF (DTE-CLIENT = 'CID')
 15702             AND (CR-LF-NSP-PRM > +0)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 302
* ECS010D.cbl
 15703             AND (CR-ENTRY-DATE > 20030430)
 15704             AND (WT-LF-QC NOT = '1' AND '3')
 15705             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15706             MOVE +0            TO WE-LFPRM-ALT
 15707          ELSE
 15708             COMPUTE WE-LFPRM ROUNDED EQUAL
 15709                           CR-LFPRM * WS-CEDE-FACT
 15710             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 15711                           CR-LFPRM-ALT * WS-CEDE-FACT
 15712          END-IF
 15713        END-IF
 15714        IF (DTE-CLIENT = 'CID')
 15715           AND (CR-LF-NSP-PRM > +0)
 15716           AND (CR-LFRFND-CALC > +0)
 15717           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 15718           AND (WT-LF-QC NOT = '1' AND '4')
 15719           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 15720              (CR-LFPRM + CR-LFPRM-ALT)
 15721           COMPUTE WE-LFRFND =
 15722              REIN-FACTOR * REIN-CALCED-LIFE
 15723           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 15724              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 15725*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 15726*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 15727*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15728        ELSE
 15729
 15730          IF (DTE-CLIENT = 'CID')
 15731           AND (CR-LF-NSP-PRM > +0)
 15732           AND (CR-LFRFND-CALC > +0)
 15733           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 15734           AND (WT-LF-QC NOT = '1' AND '4')
 15735           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15736           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 15737              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 15738
 15739          END-IF
 15740        END-IF
 15741       ELSE
 15742         MOVE +0 TO WS-CEDE-FACT
 15743       END-IF
 15744      END-IF
 15745     END-IF
 15746
 15747*     DISPLAY ' 4090 C '
 15748     IF DTE-CLIENT = 'DCC'
 15749        IF (AM-RECALC-COMM = ('Y' OR '1'))
 15750           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 15751                                   NOT = 'G' AND 'L')
 15752           AND (CR-AHAMT NOT = ZEROS)
 15753*        DISPLAY ' CR-AHAMT ' CR-AHAMT
 15754           COMPUTE WS-CEDE-FACT =
 15755               RWF-AHAMT / CR-AHAMT
 15756           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 15757*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 15758*          / CR-AHPRM * CR-AHRFND
 15759           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 15760           / CR-AHPRM) * CR-AH-NSP-PRM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 303
* ECS010D.cbl
 15761        END-IF
 15762     END-IF
 15763
 15764     MOVE RWF-AHPRM      TO WE-AHPRM.
 15765
 15766     MOVE RWF-AHAMT      TO WE-AHAMT
 15767     MOVE RWF-AHRFND     TO WE-AHRFND.
 15768     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 15769     MOVE +0             TO WE-DSPY-EXP
 15770                            WE-NUM-DIS-CLM.
 15771     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 15772     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 15773     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 15774
 15775     IF  RWF-LF-RUNOFF-SW = 'N'
 15776             OR
 15777         RWF-AH-RUNOFF-SW = 'N'
 15778         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 15779
 15780     IF  RWF-LF-RUNOFF-SW = 'N'
 15781         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 15782     ELSE
 15783         MOVE 99999999             TO STOP-LF-DATE.
 15784
 15785     IF  RWF-AH-RUNOFF-SW = 'N'
 15786         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 15787     ELSE
 15788         MOVE 99999999             TO STOP-AH-DATE.
 15789
 15790     IF CR-POLICY-IS-RESTORE  OR
 15791        CR-POLICY-IS-REISSUE
 15792        OR CR-POLICY-IS-MONTHLY
 15793         MOVE ZEROS      TO WE-LFPRM
 15794                            WE-LFPRM-ALT
 15795                            WE-AHPRM.
 15796
 15797*     DISPLAY ' B4 4100-EP-DO-LF '
 15798     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 15799*     DISPLAY ' AFTER 4100-EP-DO-LF '
 15800
 15801     IF CO-SUB NOT = ZERO
 15802       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 15803         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 15804             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 15805
 15806     ADD +1 TO SUB5.
 15807     GO TO 4090-EP-DO-REINSURE-LOOP.
 15808
 15809 4099-EP-BUMP-RTN-X.
 15810     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 304
* ECS010D.cbl
 15812******************************************************************
 15813***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 15814******************************************************************
 15815
 15816 4100-EP-DO-LF.
 15817
 15818     MOVE +0                         TO ISS-BEN  EPR-R78
 15819                                        CNC-BEN  EPR-PRO
 15820                                        ISS-PRM  EPR-ST
 15821                                        ISS-PRMTAX
 15822                                        CNC-PRM  ACTIVE-COUNT.
 15823     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 15824
 15825     IF CR-LFTYP = ZERO
 15826         GO TO 4200-EP-DO-AH.
 15827
 15828     IF REIN-EP-FLG = 'R'
 15829         IF REIN-LF-FLG (SUB5) = SPACE
 15830             GO TO 4200-EP-DO-AH.
 15831
 15832     IF CR-APR NOT NUMERIC
 15833         MOVE ZERO TO CR-APR.
 15834
 15835     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 15836     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 15837     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 15838
 15839     IF CR-POLICY-IS-DECLINED  OR
 15840        CR-POLICY-IS-VOID
 15841         GO TO 4191-CONTINUE.
 15842
 15843     MOVE CR-LF-TERM             TO ORIG-TERM.
 15844     MOVE CLAS-INDEXL            TO W-NDX.
 15845
 15846     IF CR-DT GREATER EW-COV-DTE
 15847         MOVE CR-DT              TO EW-COV-DTE.
 15848
 15849     IF (NOT CR-POLICY-IS-RESTORE) AND
 15850        (NOT CR-POLICY-IS-REISSUE)
 15851        AND (NOT CR-POLICY-IS-MONTHLY)
 15852         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 15853         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15854             ADD CR-LIVES TO EW-ISS-CNT
 15855             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 15856                                    (ORIG-TERM * CR-LIVES)
 15857             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 15858             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 15859             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 15860                                   (ORIG-TERM * ISS-BEN)
 15861         ELSE
 15862             ADD +1 TO EW-ISS-CNT
 15863             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 15864             COMPUTE EW-AGE = EW-AGE + CR-AGE
 15865             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 15866             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 15867                                   (ORIG-TERM * ISS-BEN).
 15868
 15869     MOVE RUN-DATE        TO VALUATION-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 305
* ECS010D.cbl
 15870     MOVE '2'             TO W-VAL-SOURCE.
 15871
 15872     IF REIN-EP-FLG = 'R'
 15873         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 15874            EARNING-STOP-DATE LESS THAN VALUATION-DT
 15875             MOVE EARNING-STOP-DATE TO VALUATION-DT
 15876             MOVE '10'              TO W-VAL-SOURCE.
 15877
 15878     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15879
 15880     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 15881        (REM-TRM3 GREATER ZERO)
 15882        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15883            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 15884                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 15885            COMPUTE EW-REM-TERM = EW-REM-TERM +
 15886                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 15887          ELSE
 15888            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 15889            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 15890
 15891     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 15892
 15893     IF DTE-CLIENT = 'GIC'
 15894         IF REIN-EP-FLG NOT = 'R'  AND
 15895            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 15896            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 15897            MOVE CR-LFPRM-CALC TO ISS-PRM.
 15898
 15899     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 15900         GO TO 4105-EP-DO-LF-REIN-CHK.
 15901
 15902     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 15903             AND
 15904         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 15905             AND
 15906         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 15907                 OR
 15908             CR-LF-CANC-DT EQUAL ZEROS)
 15909             AND
 15910         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 15911                 OR
 15912             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 15913         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 15914         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 15915                 VARYING
 15916             SUBM FROM +1 BY +1
 15917                 UNTIL
 15918             SUBM GREATER THAN +13.
 15919
 15920     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 15921     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 15922
 15923 4105-EP-DO-LF-REIN-CHK.
 15924
 15925     IF REIN-EP-FLG = 'R'  AND
 15926        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 15927         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 306
* ECS010D.cbl
 15928     ELSE
 15929         GO TO 4110-EP-DO-LF-CLM.
 15930
 15931     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 15932         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 15933             GO TO 4130-EP-DO-LF-EP.
 15934
 15935     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15936         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 15937             GO TO 4130-EP-DO-LF-EP.
 15938
 15939 4110-EP-DO-LF-CLM.
 15940
 15941     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 15942         NEXT  SENTENCE
 15943       ELSE
 15944         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 15945
 15946     ADD WE-DTHAMT      TO EW-CLM-AMT.
 15947     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 15948
 15949     IF CR-LF-STATUS-AT-DEATH = ' '
 15950         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 15951             GO TO 4115-EP-DO-LF-CLM-EPR.
 15952
 15953     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 15954     ADD +1             TO EW-CLM-CRT.
 15955
 15956 4115-EP-DO-LF-CLM-EPR.
 15957
 15958     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15959         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 15960         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 15961     END-IF
 15962     .
 15963 4120-EP-DO-LF-CNCL.
 15964
 15965     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 15966        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 15967         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15968             GO TO 4190-EP-DO-LF-COMM
 15969         ELSE
 15970             GO TO 4130-EP-DO-LF-EP.
 15971
 15972     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15973         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 15974         GO TO 4124-EP-DO-LF-CNCL-SUM.
 15975
 15976     ADD +1                       TO EW-CNC-CNT.
 15977
 15978     MOVE WE-LFRFND               TO CNC-PRM.
 15979
 15980     IF DTE-CLIENT = 'GIC'
 15981         IF REIN-EP-FLG NOT = 'R'  AND
 15982            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 15983             MOVE CR-LFRFND-CALC TO CNC-PRM.
 15984
 15985*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 307
* ECS010D.cbl
 15986*    MOVE 'L'                   TO  DC-OPTION-CODE.
 15987*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15988*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 15989
 15990     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 15991     MOVE 'L'                   TO  DC-OPTION-CODE.
 15992     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15993     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 15994
 15995     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 15996     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 15997     MOVE '1'                     TO  DC-OPTION-CODE.
 15998     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 15999     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 16000     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 16001                                      DC-ODD-DAYS-OVER
 16002                                      DC-ELAPSED-DAYS.
 16003     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16004     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 16005
 16006     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 16007         ADD  +1                  TO  MONTHS-DIFF-LF.
 16008
 16009     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16010
 16011     IF DTE-CLIENT = 'ACE'
 16012         GO TO 4120-CONTINUE-LIFE-CANCEL.
 16013
 16014     MOVE  ZEROS                  TO  SUB.
 16015
 16016 4120-LIFE-CHARGEBACK-LOOP.
 16017
 16018     ADD    +1                    TO  SUB.
 16019
 16020     IF  SUB  GREATER THAN  +10
 16021         GO TO  4120-CONTINUE-LIFE-CANCEL.
 16022
 16023     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 16024         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 16025         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16026
 16027     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 16028         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 16029
 16030     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 16031         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 16032
 16033     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16034
 16035
 16036 4120-CONTINUE-LIFE-CANCEL.
 16037
 16038     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 16039     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 16040
 16041     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 16042         GO TO 4190-EP-DO-LF-COMM.
 16043
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 308
* ECS010D.cbl
 16044     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16045         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16046         GO TO 4190-EP-DO-LF-COMM.
 16047
 16048     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16049     MOVE '3'           TO W-VAL-SOURCE.
 16050     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16051
 16052     IF REM-TRM3 = CR-LF-TERM
 16053         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16054         GO TO 4190-EP-DO-LF-COMM.
 16055
 16056     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16057         GO TO 4122-EP-DO-LF-CNCL-TEX.
 16058
 16059     IF DTE-CLIENT = 'NCL'
 16060         IF CR-DT LESS THAN 19910101
 16061             GO TO 4121-EP-DO-LF-CNC-BEN.
 16062
 16063     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16064         GO TO 4126-EP-DO-LF-CNCL-NP.
 16065
 16066     IF DTE-CLIENT = 'FUL'
 16067         GO TO 4128-EP-DO-LF-CNCL-FUL.
 16068
 16069*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16070     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16071        (CR-RATING-CLASS NOT = 'L ')
 16072         IF (CR-APR GREATER THAN ZERO)  AND
 16073            (CR-LF-TERM GREATER THAN 060)  AND
 16074            (CR-DT GREATER THAN 19831031)
 16075              GO TO 4126-EP-DO-LF-CNCL-NP.
 16076
 16077     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16078         IF (CR-APR GREATER THAN ZERO)  AND
 16079            (CR-LF-TERM GREATER THAN 061)  AND
 16080            (CR-DT GREATER THAN 19830318)
 16081              GO TO 4126-EP-DO-LF-CNCL-NP.
 16082
 16083     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16084         IF (CR-APR GREATER THAN ZERO)  AND
 16085            (CR-LF-TERM GREATER THAN 062)  AND
 16086            (CR-DT GREATER THAN 19810831)  AND
 16087            (CR-DT LESS THAN 19830901)
 16088              GO TO 4126-EP-DO-LF-CNCL-NP.
 16089
 16090     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16091         IF (CR-APR GREATER THAN ZERO)  AND
 16092            (CR-LF-TERM GREATER THAN 060)  AND
 16093            (CR-DT GREATER THAN 19831231)
 16094              GO TO 4126-EP-DO-LF-CNCL-NP.
 16095
 16096 4121-EP-DO-LF-CNC-BEN.
 16097
 16098     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 16099
 16100     COMPUTE TEMP-3 ROUNDED EQUAL
 16101         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 309
* ECS010D.cbl
 16102
 16103     MOVE TEMP-3                 TO CNC-BEN.
 16104
 16105     GO TO 4190-EP-DO-LF-COMM.
 16106
 16107 4122-EP-DO-LF-CNCL-TEX.
 16108
 16109     DIVIDE WE-LFAMT BY CR-LF-TERM
 16110         GIVING TEX-FACT-1.
 16111     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 16112         GIVING TEX-FACT-2
 16113             REMAINDER TEX-FACT-3.
 16114     IF TEX-FACT-3 NOT = ZERO
 16115         ADD +1 TO TEX-FACT-2.
 16116
 16117     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 16118
 16119     GO TO 4190-EP-DO-LF-COMM.
 16120
 16121 4124-EP-DO-LF-CNCL-SUM.
 16122
 16123     IF WE-LFRFND = ZERO
 16124         GO TO 4130-EP-DO-LF-EP.
 16125
 16126     MOVE WE-LFRFND TO CNC-PRM.
 16127
 16128     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16129
 16130     IF WE-LFRFND NOT LESS WE-LFPRM
 16131         MOVE WE-LFAMT TO CNC-BEN
 16132          GO TO 4130-EP-DO-LF-EP.
 16133
 16134
 16135     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 16136
 16137     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16138         MOVE TEMP-7 TO CNC-BEN
 16139          GO TO 4130-EP-DO-LF-EP.
 16140
 16141     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16142     MOVE '4'           TO W-VAL-SOURCE.
 16143     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16144
 16145     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 16146         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 16147         GO TO 4130-EP-DO-LF-EP.
 16148
 16149 4126-EP-DO-LF-CNCL-NP.
 16150
 16151     IF WE-LFAMT = ZERO
 16152        GO TO 4190-EP-DO-LF-COMM.
 16153
 16154     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 16155     MOVE 'L'                        TO  DC-OPTION-CODE.
 16156     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16157     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 16158
 16159     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 310
* ECS010D.cbl
 16160       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 16161       MOVE '3'                      TO  DC-OPTION-CODE
 16162       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16163       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 16164     ELSE
 16165       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 16166       MOVE '6'                      TO  DC-OPTION-CODE
 16167       MOVE +1                       TO  DC-ELAPSED-MONTHS
 16168       MOVE +0                       TO  DC-ELAPSED-DAYS
 16169       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16170       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 16171
 16172     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 16173     MOVE CR-APR                     TO  CP-LOAN-APR.
 16174     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16175     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16176     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16177     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16178     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16179     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16180
 16181     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 16182
 16183     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16184       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 16185       GO TO 4130-EP-DO-LF-EP
 16186     ELSE
 16187       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 16188
 16189     GO TO 4190-EP-DO-LF-COMM.
 16190
 16191 4128-EP-DO-LF-CNCL-FUL.
 16192
 16193     IF WE-LFAMT = ZERO
 16194        GO TO 4190-EP-DO-LF-COMM.
 16195
 16196     MOVE CR-APR              TO NP-APR.
 16197     MOVE CR-LF-TERM          TO NP-ORIG.
 16198     MOVE REM-TRM3            TO NP-REM.
 16199     MOVE '2'                 TO NP-OPT.
 16200     MOVE CR-AHPRM            TO NP-AHPRM.
 16201     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 16202     MOVE CR-LFAMT            TO NP-BENEFIT.
 16203
 16204*    CALL 'FULNETRM'
 16205*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 16206*              NP-ACCOUNT NP-REMAINING.
 16207
 16208     MOVE NP-REMAINING TO CNC-BEN.
 16209
 16210     GO TO 4190-EP-DO-LF-COMM.
 16211
 16212 4130-EP-DO-LF-EP.
 16213
 16214     MOVE SPACE                  TO STATUTORY-SWITCH.
 16215
 16216     MOVE EOM-RUN-DATE TO VALUATION-DT.
 16217     MOVE '5'           TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 311
* ECS010D.cbl
 16218
 16219     IF REIN-EP-FLG = 'R'
 16220       IF REIN-REM-SW (SUB5) = 'I'
 16221           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16222           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 16223           GO TO 4190-EP-DO-LF-COMM.
 16224
 16225     IF REIN-EP-FLG = 'R'
 16226         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 16227            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16228             MOVE '*'               TO LIFE-EARNED-SWITCH
 16229             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16230             MOVE '10'              TO W-VAL-SOURCE.
 16231
 16232     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16233
 16234     IF REM-TRM2 GREATER CR-LF-TERM
 16235         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16236         GO TO 4190-EP-DO-LF-COMM.
 16237
 16238     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16239         GO TO 4180-EP-DO-LF-EP-SUM.
 16240
 16241     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16242         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16243             IF REM-TRM2 NOT GREATER THAN +0
 16244                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16245                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16246                 GO TO 4190-EP-DO-LF-COMM
 16247             ELSE
 16248                 NEXT SENTENCE
 16249         ELSE
 16250             IF W-BAL-REMTRM NOT GREATER +0
 16251                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16252                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16253                 GO TO 4190-EP-DO-LF-COMM
 16254             ELSE
 16255                 NEXT SENTENCE
 16256     ELSE
 16257        IF DTE-CLIENT = 'NCL'  AND
 16258           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16259            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16260        ELSE
 16261         IF REM-TRM2 NOT GREATER +0  OR
 16262            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16263             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16264             GO TO 4190-EP-DO-LF-COMM.
 16265
 16266     MOVE +1 TO ACTIVE-COUNT.
 16267
 16268     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16269         GO TO 4140-EP-DO-LF-EP-TEX.
 16270
 16271     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16272         GO TO 4150-EP-DO-LF-EP-NP.
 16273
 16274*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16275     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 312
* ECS010D.cbl
 16276        (CR-RATING-CLASS NOT = 'L ')
 16277         IF (CR-APR GREATER THAN ZERO)  AND
 16278            (CR-LF-TERM GREATER THAN 060)  AND
 16279            (CR-DT GREATER THAN 19831031)
 16280             MOVE '*'             TO STATUTORY-SWITCH
 16281              GO TO 4150-EP-DO-LF-EP-NP.
 16282
 16283     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16284         IF (CR-APR GREATER THAN ZERO)  AND
 16285            (CR-LF-TERM GREATER THAN 061)  AND
 16286            (CR-DT GREATER THAN 19830318)
 16287             MOVE '*'             TO STATUTORY-SWITCH
 16288              GO TO 4150-EP-DO-LF-EP-NP.
 16289
 16290     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16291         IF (CR-APR GREATER THAN ZERO)  AND
 16292            (CR-LF-TERM GREATER THAN 062)  AND
 16293            (CR-DT GREATER THAN 19810831)  AND
 16294            (CR-DT LESS THAN 19830901)
 16295             MOVE '*'             TO STATUTORY-SWITCH
 16296              GO TO 4150-EP-DO-LF-EP-NP.
 16297
 16298     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16299         IF (CR-APR GREATER THAN ZERO)  AND
 16300            (CR-LF-TERM GREATER THAN 060)  AND
 16301            (CR-DT GREATER THAN 19831231)
 16302             MOVE '*'             TO STATUTORY-SWITCH
 16303              GO TO 4150-EP-DO-LF-EP-NP.
 16304
 16305     GO TO 4160-EP-DO-LF-EP-R78.
 16306
 16307 4140-EP-DO-LF-EP-TEX.
 16308
 16309     IF CR-PMT-FREQ = 0
 16310       DISPLAY '*************************************'
 16311       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 16312       DISPLAY '*************************************'
 16313       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 16314       DISPLAY '*************************************'
 16315       COMPUTE TEX-FACT-4 =
 16316          (CR-LF-TERM * CR-LF-TERM) +
 16317                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 16318     ELSE
 16319        COMPUTE TEX-FACT-4 =
 16320         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 16321
 16322     IF CR-PMT-FREQ = 0
 16323       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 16324           GIVING TEX-FACT-5
 16325               REMAINDER TEX-FACT-6
 16326     ELSE
 16327        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 16328            GIVING TEX-FACT-5
 16329                REMAINDER TEX-FACT-6.
 16330
 16331     IF CR-PMT-FREQ > 0
 16332        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 16333
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 313
* ECS010D.cbl
 16334     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 16335     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 16336         (TEX-FACT-5 * CR-PMT-FREQ) +
 16337         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 16338     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 16339
 16340     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 16341
 16342     GO TO 4170-EP-DO-LF-EP-PRO.
 16343
 16344 4150-EP-DO-LF-EP-NP.
 16345
 16346     IF WE-LFPRM = ZERO
 16347         GO TO 4160-EP-DO-LF-EP-R78.
 16348
 16349     IF DTE-CLIENT = 'CRI'
 16350       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 16351             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 16352           GO TO 4160-EP-DO-LF-EP-R78.
 16353
 16354     IF DTE-CLIENT = 'NCL'
 16355       IF CR-DT LESS THAN 19910101
 16356           GO TO 4160-EP-DO-LF-EP-R78.
 16357
 16358     IF REM-TRM1 = CR-LF-TERM
 16359         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16360         GO TO 4190-EP-DO-LF-COMM.
 16361
 16362     MOVE CR-APR TO NP-APR.
 16363     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 16364     MOVE REM-TRM1 TO NP-REM.
 16365     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 16366     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 16367         MOVE CR-LOAN-TERM TO NP-ORIG.
 16368
 16369     MOVE 'R' TO NP-OPT.
 16370     CALL 'ECSNETRM'
 16371         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 16372
 16373     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 16374
 16375     IF STATUTORY-REQUIREMENT
 16376         MOVE EPR-R78                TO EPR-ST.
 16377
 16378 4160-EP-DO-LF-EP-R78.
 16379
 16380     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 16381        (DTE-CLIENT EQUAL 'NCL')
 16382        IF (CR-CCYY EQUAL EOM-CCYY) AND
 16383           (CR-MO EQUAL EOM-MO)
 16384           MOVE '*'            TO OB-DATE-1-SWITCH
 16385           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16386           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16387           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16388           COMPUTE WS-EPR-R78 (SUB3 1) =
 16389                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 16390           GO TO 4190-EP-DO-LF-COMM
 16391        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 314
* ECS010D.cbl
 16392        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 16393           (CR-MO EQUAL OB-MO (1))
 16394           MOVE '*'            TO OB-DATE-2-SWITCH
 16395           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16396           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16397           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16398           COMPUTE WS-EPR-R78 (SUB3 2) =
 16399                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 16400           GO TO 4190-EP-DO-LF-COMM
 16401        ELSE
 16402        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 16403           (CR-MO EQUAL OB-MO (2))
 16404           MOVE '*'            TO OB-DATE-3-SWITCH
 16405           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16406           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16407           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16408           COMPUTE WS-EPR-R78 (SUB3 3) =
 16409                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 16410           GO TO 4190-EP-DO-LF-COMM
 16411        ELSE
 16412           GO TO 4190-EP-DO-LF-COMM.
 16413
 16414     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 16415
 16416     IF DTE-R78 = '1'
 16417         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 16418     ELSE
 16419         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16420
 16421     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 16422
 16423     IF REM-TRM1 GREATER THAN +0
 16424         COMPUTE TEMP-7 ROUNDED EQUAL
 16425             WE-LFPRM - (WE-LFPRM * TEMP-4)
 16426     ELSE
 16427         MOVE WE-LFPRM                TO TEMP-7.
 16428
 16429     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 16430         MOVE TEMP-7                 TO EPR-ST.
 16431
 16432     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16433         MOVE ZEROS                  TO TEMP-8
 16434         GO TO 4165-END-LF-EP-R78.
 16435
 16436     IF EPR-ST = ZEROS
 16437         MOVE TEMP-7                 TO EPR-ST.
 16438
 16439     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 16440         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 16441         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 16442         IF DTE-R78 = '1'
 16443             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 16444
 16445     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 16446
 16447     COMPUTE TEMP-8 ROUNDED =
 16448               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 16449
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 315
* ECS010D.cbl
 16450 4165-END-LF-EP-R78.
 16451
 16452     IF EPR-R78 = ZEROS
 16453         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 16454     ELSE
 16455         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 16456
 16457 4170-EP-DO-LF-EP-PRO.
 16458
 16459     IF DTE-CLIENT = 'MIC' OR 'MCC'
 16460         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 16461     ELSE
 16462         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 16463
 16464     IF REM-TRM1 GREATER THAN +0
 16465         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 16466     ELSE
 16467         MOVE WE-LFPRM                  TO TEMP-7.
 16468
 16469     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16470         MOVE ZEROS                     TO TEMP-8
 16471         GO TO 4175-END-LF-EP-PRO.
 16472
 16473     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 16474         IF DTE-CLIENT = 'MIC' OR 'MCC'
 16475             COMPUTE TEMP-5 ROUNDED =
 16476                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 16477         ELSE
 16478             COMPUTE TEMP-5 ROUNDED =
 16479                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 16480
 16481     COMPUTE TEMP-8 ROUNDED =
 16482                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 16483
 16484     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 16485
 16486 4175-END-LF-EP-PRO.
 16487
 16488     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 16489
 16490     GO TO 4185-EP-DO-LF-STATUTORY.
 16491
 16492 4180-EP-DO-LF-EP-SUM.
 16493
 16494     IF REM-TRM1 NOT GREATER +0
 16495         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 16496         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16497         GO TO 4190-EP-DO-LF-COMM.
 16498
 16499     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 16500
 16501     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 16502         MOVE ZEROS                 TO TEMP-7
 16503     ELSE
 16504         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 16505                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 16506
 16507     IF TEMP-7 NOT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 316
* ECS010D.cbl
 16508         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16509             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 16510             GO TO 4190-EP-DO-LF-COMM
 16511         ELSE
 16512             MOVE ZEROS             TO TEMP-7.
 16513
 16514     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 16515     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16516     IF DTE-R78 = '1'
 16517         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 16518
 16519     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 16520     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 16521
 16522     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 16523
 16524     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 16525
 16526     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16527         GO TO 4185-EP-DO-LF-STATUTORY.
 16528
 16529     MOVE EPR-R78                  TO EPR-ST.
 16530
 16531     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 16532         MOVE ZEROS                 TO TEMP-8
 16533     ELSE
 16534         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 16535                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 16536
 16537     IF TEMP-8 NOT GREATER ZERO
 16538         GO TO 4185-EP-DO-LF-STATUTORY.
 16539
 16540     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 16541                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 16542
 16543     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 16544                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 16545
 16546     COMPUTE EPR-ST ROUNDED = EPR-ST +
 16547                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 16548
 16549 4185-EP-DO-LF-STATUTORY.
 16550
 16551*07635      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 16552*07636          MOVE EPR-R78                TO EPR-ST.
 16553     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 16554         MOVE EPR-PRO                TO EPR-ST.
 16555
 16556     IF (DTE-CLIENT = 'CID') AND
 16557        (STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX') AND
 16558        (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L') AND
 16559        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 16560           GO TO 4187-EP-DO-LF-STAT-ROA
 16561     END-IF.
 16562
 16563     IF EPR-ST NOT = ZEROS
 16564         GO TO 4190-EP-DO-LF-COMM.
 16565
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 317
* ECS010D.cbl
 16566     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 16567         MOVE EPR-R78                TO EPR-ST
 16568     ELSE
 16569         MOVE EPR-PRO                TO EPR-ST.
 16570
 16571     GO TO 4190-EP-DO-LF-COMM.
 16572
 16573 4187-EP-DO-LF-STAT-ROA.
 16574     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 16575     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 16576     MOVE 'L'                        TO DC-OPTION-CODE.
 16577     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16578     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 16579     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 16580        MOVE CR-LOAN-1ST-PMT-DT      TO  DC-GREG-DATE-1-YMD
 16581        MOVE '3'                     TO  DC-OPTION-CODE
 16582        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 16583                              8099-DATE-CONVERT-X
 16584        MOVE DC-BIN-DATE-1           TO  CP-FIRST-PAY-DATE
 16585     ELSE
 16586        MOVE CP-CERT-EFF-DT          TO  DC-BIN-DATE-1
 16587        MOVE +1                      TO  DC-ELAPSED-MONTHS
 16588        MOVE +0                      TO  DC-ELAPSED-DAYS
 16589        MOVE '6'                     TO  DC-OPTION-CODE
 16590        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 16591                              8099-DATE-CONVERT-X
 16592        MOVE DC-BIN-DATE-2           TO  CP-FIRST-PAY-DATE
 16593     END-IF.
 16594     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 16595     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 16596     MOVE SPACES                     TO CP-ACCT-FLD-5.
 16597     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 16598     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 16599     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 16600     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 16601     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 16602     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 16603     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 16604                                        CP-LOAN-TERM.
 16605     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 16606                                        CP-RATING-BENEFIT-AMT.
 16607     MOVE WS-REM-AMT                 TO CP-REMAINING-BENEFIT
 16608     MOVE CR-APR                     TO CP-LOAN-APR.
 16609     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 16610     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 16611     MOVE '6'                        TO CP-EARNING-METHOD.
 16612     MOVE '3'                        TO CP-PROCESS-TYPE.
 16613     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 16614     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 16615         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 16616     ELSE
 16617         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 16618     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 16619     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 16620     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 16621     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 16622     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 16623     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 318
* ECS010D.cbl
 16624
 16625     IF CP-STATE-STD-ABBRV = 'OR'
 16626        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 16627     END-IF
 16628
 16629     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 16630        COMPUTE CP-ORIGINAL-BENEFIT =
 16631         (CR-LFAMT - CR-LFPRM)
 16632     END-IF
 16633
 16634     IF CP-TRUNCATED-LIFE
 16635        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 16636     END-IF
 16637
 16638     IF CP-TERM-IS-DAYS
 16639        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16640     ELSE
 16641        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 16642     END-IF
 16643
 16644     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 16645
 16646     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 16647
 16648 4190-EP-DO-LF-COMM.
 16649
 16650     MOVE +0 TO SUB1.
 16651     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 16652         10 TIMES.
 16653
 16654     IF REIN-EP-FLG NOT = 'R'  OR
 16655        CR-POLICY-IS-REIN-ONLY
 16656         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 16657         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 16658         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 16659         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 16660
 16661     ADD ISS-BEN TO EW-ISS-BEN.
 16662     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 16663     ADD CNC-BEN TO EW-CNC-BEN.
 16664     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 16665     ADD ISS-PRM TO EW-ISS-PRM.
 16666     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 16667     ADD CNC-PRM TO EW-CNC-PRM.
 16668     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 16669
 16670     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 16671     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 16672     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 16673
 16674     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 16675        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 16676     END-IF
 16677     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 16678        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 16679     END-IF
 16680
 16681     COMPUTE ISS-PRMTAX =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 319
* ECS010D.cbl
 16682        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 16683        (CNC-PRM * CR-LF-CNC-PREM-TAX)
 16684
 16685     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 16686
 16687     IF LIFE-FULLY-EARNED
 16688         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 16689                                            (ISS-PRM - EPR-R78)
 16690         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 16691                                            (ISS-PRM - EPR-PRO)
 16692         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 16693                                            (ISS-PRM - EPR-ST).
 16694
 16695     IF  DTE-OPT-RESERVE-METHOD-AUTH
 16696         IF  REIN-EP-FLG NOT = 'R'
 16697                 OR
 16698             CR-POLICY-IS-REIN-ONLY
 16699             MOVE 'L'      TO W-CLAIM-TYPE
 16700             MOVE EPR-R78  TO W-OPT-R78
 16701             MOVE EPR-PRO  TO W-OPT-PRO
 16702             MOVE EPR-ST   TO W-OPT-ST
 16703             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 16704             MOVE ZEROS    TO EW-CLM-IBNR
 16705         ELSE
 16706             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 16707                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 16708                 MOVE ZEROS      TO EW-CLM-IBNR
 16709             ELSE
 16710                 MOVE ZEROS      TO EW-CLM-IBNR
 16711     ELSE
 16712         IF  DTE-CLIENT NOT EQUAL 'ITG'
 16713             ADD WE-DTH-IBNR
 16714                       TO EW-CLM-IBNR
 16715         ELSE
 16716             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16717                     AND
 16718                 CR-DT GREATER THAN LAST-YRS-DATE
 16719                 COMPUTE  EW-CLM-IBNR
 16720                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 16721
 16722     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 16723     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 16724
 16725 4191-CONTINUE.
 16726
 16727     MOVE 'Y'          TO EW-LEVEL-USED.
 16728
 16729     IF CR-POLICY-UNDERWRITTEN
 16730         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 16731         MOVE EPEC-OPT-WORK-TABLE
 16732                              TO EPEC-UNDW-OPT-DATA-TABLE
 16733     ELSE
 16734         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 16735         MOVE EPEC-OPT-WORK-TABLE
 16736                              TO EPEC-OPT-DATA-TABLE.
 16737
 16738     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 320
* ECS010D.cbl
 16740 4194-SLOT-INTO-EFFECTED-MONTHS.
 16741
 16742     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 16743             AND
 16744         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 16745             AND
 16746         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 16747                 OR
 16748          CR-LF-CANC-DT EQUAL ZEROS)
 16749             AND
 16750         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 16751                 OR
 16752          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16753         MOVE 'Y'                 TO W-TABLE-USED-SW
 16754         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16755             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 16756                 = EPEC-LIFE-CTR (SUB3 SUBM)
 16757                 + CR-LIVES
 16758         ELSE
 16759             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 16760                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 16761
 16762 4194-EXIT.
 16763     EXIT.
 16764
 16765 4196-CALC-REM-AMT.
 16766
 16767     IF CR-LFTYP = 'QD'
 16768        MOVE +15.0               TO CR-APR
 16769     END-IF
 16770
 16771     MOVE +0                     TO WS-REM-AMT
 16772     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16773        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 16774           COMPUTE WS-REM-AMT =
 16775             CR-LFAMT + CR-LFAMT-ALT
 16776        ELSE
 16777           MOVE CR-LFAMT         TO WS-REM-AMT
 16778        END-IF
 16779        GO TO 4199-EXIT
 16780     END-IF
 16781
 16782     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
 16783
 16784     IF REM-TRM1 = CR-LF-TERM
 16785        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 16786           COMPUTE WS-REM-AMT =
 16787             CR-LFAMT + CR-LFAMT-ALT
 16788        ELSE
 16789           MOVE CR-LFAMT         TO WS-REM-AMT
 16790        END-IF
 16791        GO TO 4199-EXIT
 16792     END-IF
 16793
 16794     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 16795        GO TO 4198-ORDINARY-REM
 16796     END-IF
 16797
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 321
* ECS010D.cbl
 16798     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16799        GO TO 4198-CALC-TEXAS-REM
 16800     END-IF
 16801
 16802     IF CR-LFTYP = 'QD'
 16803        MOVE +15.0               TO CR-APR
 16804        MOVE 'N'                 TO
 16805                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
 16806        GO TO 4198-CALC-NET-PAY-REM
 16807     END-IF
 16808
 16809     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16810        GO TO 4198-CALC-NET-PAY-REM
 16811     END-IF
 16812
 16813     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16814        (CR-RATING-CLASS NOT = 'L ')
 16815         IF (CR-LF-TERM GREATER THAN +60) AND
 16816            (CR-DT GREATER THAN 19831031) AND
 16817            (CR-APR GREATER THAN ZERO)
 16818             GO TO 4198-CALC-NET-PAY-REM
 16819        END-IF
 16820     END-IF
 16821
 16822     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16823         IF (CR-LF-TERM GREATER THAN +61) AND
 16824            (CR-DT  GREATER THAN 19830318) AND
 16825            (CR-APR GREATER THAN ZERO)
 16826             GO TO 4198-CALC-NET-PAY-REM
 16827        END-IF
 16828     END-IF
 16829
 16830     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16831         IF (CR-LF-TERM GREATER THAN +62) AND
 16832            (CR-DT  GREATER THAN 19810831) AND
 16833            (CR-DT  LESS THAN 19830901) AND
 16834            (CR-APR GREATER THAN ZERO)
 16835             GO TO 4198-CALC-NET-PAY-REM
 16836        END-IF
 16837     END-IF
 16838
 16839     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16840         IF (CR-LF-TERM GREATER THAN +60) AND
 16841            (CR-DT  GREATER THAN 19831231) AND
 16842            (CR-APR GREATER THAN ZERO)
 16843             GO TO 4198-CALC-NET-PAY-REM
 16844        END-IF
 16845     END-IF
 16846
 16847     .
 16848 4198-ORDINARY-REM.
 16849
 16850     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 16851         COMPUTE WS-REM-AMT ROUNDED =
 16852                  (INTERMED * REM-TRM2) + CR-LFAMT-ALT
 16853     ELSE
 16854         COMPUTE WS-REM-AMT ROUNDED = INTERMED * REM-TRM2
 16855     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 322
* ECS010D.cbl
 16856
 16857     GO TO 4199-EXIT
 16858
 16859     .
 16860 4198-CALC-TEXAS-REM.
 16861
 16862     DIVIDE CR-LFAMT BY CR-LF-TERM
 16863         GIVING TEX-FACT-1.
 16864     DIVIDE REM-TRM2 BY CR-PMT-FREQ
 16865         GIVING TEX-FACT-2
 16866         REMAINDER TEX-FACT-3.
 16867
 16868     IF TEX-FACT-3 NOT = ZERO
 16869         ADD +1                  TO TEX-FACT-2
 16870     END-IF
 16871
 16872     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
 16873         MOVE CR-LFAMT           TO WS-REM-AMT
 16874     ELSE
 16875         COMPUTE WS-REM-AMT ROUNDED =
 16876             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
 16877     END-IF
 16878
 16879     GO TO 4199-EXIT
 16880
 16881     .
 16882 4198-CALC-NET-PAY-REM.
 16883
 16884     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 16885     MOVE 'L'                        TO DC-OPTION-CODE.
 16886     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16887     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 16888
 16889     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 16890        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 16891        MOVE '3'                 TO  DC-OPTION-CODE
 16892        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 16893                                  8099-DATE-CONVERT-X
 16894        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 16895     ELSE
 16896        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 16897        MOVE +1                  TO  DC-ELAPSED-MONTHS
 16898        MOVE +0                  TO  DC-ELAPSED-DAYS
 16899        MOVE '6'                 TO  DC-OPTION-CODE
 16900        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 16901                                  8099-DATE-CONVERT-X
 16902        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 16903     END-IF
 16904
 16905     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 16906        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
 16907     ELSE
 16908        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
 16909     END-IF
 16910     MOVE CR-APR                 TO  CP-LOAN-APR
 16911     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
 16912     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
 16913     MOVE REM-TRM2               TO  CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 323
* ECS010D.cbl
 16914     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
 16915                                 TO CP-SPECIAL-CALC-CD
 16916     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
 16917                                 TO  CP-BENEFIT-TYPE
 16918     MOVE CLAS-I-EP (CLAS-INDEXL)
 16919                                 TO  CP-EARNING-METHOD
 16920
 16921     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 16922
 16923     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
 16924
 16925     .
 16926 4199-EXIT.
 16927     EXIT.
 16928
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 324
* ECS010D.cbl
 16930******************************************************************
 16931***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 16932******************************************************************
 16933
 16934 4200-EP-DO-AH.
 16935
 16936*     DISPLAY ' MADE IT TO 4200 '
 16937     MOVE +0                         TO ISS-BEN  EPR-R78
 16938                                        CNC-BEN  EPR-PRO
 16939                                        ISS-PRM  EPR-ST
 16940                                        CNC-PRM
 16941                                        WX-CLM-AMT
 16942                                        WX-CLM-EXP
 16943                                        WX-CLM-CNT
 16944                                        WX-CLM-CRT
 16945                                        WX-ACTIVE-COUNT
 16946                                        ISS-PRMTAX
 16947                                        WX-CNC-CNT.
 16948     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 16949
 16950     IF CR-AHTYP = ZERO
 16951         GO TO 4295-EP-DO-COUNT.
 16952
 16953     IF REIN-EP-FLG = 'R'
 16954         IF REIN-AH-FLG (SUB5) = SPACE
 16955             GO TO 4295-EP-DO-COUNT.
 16956
 16957     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 16958     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 16959     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16960
 16961     IF CR-POLICY-IS-DECLINED  OR
 16962        CR-POLICY-IS-VOID
 16963         GO TO 4290-CONTINUE.
 16964
 16965     MOVE CR-AH-TERM           TO ORIG-TERM.
 16966
 16967     IF CR-DT GREATER EW-COV-DTE
 16968         MOVE CR-DT            TO EW-COV-DTE.
 16969
 16970     IF NOT CR-POLICY-IS-RESTORE  AND
 16971        NOT CR-POLICY-IS-REISSUE
 16972        AND NOT CR-POLICY-IS-MONTHLY
 16973         MOVE WE-AHAMT         TO ISS-BEN
 16974         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16975         COMPUTE EW-AGE = EW-AGE + CR-AGE
 16976         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16977         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16978                                   (ORIG-TERM * ISS-BEN).
 16979
 16980     MOVE CLAS-INDEXA     TO W-NDX.
 16981     MOVE RUN-DATE        TO VALUATION-DT
 16982     MOVE '6'             TO W-VAL-SOURCE.
 16983
 16984     IF REIN-EP-FLG = 'R'
 16985         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 16986            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16987             MOVE EARNING-STOP-DATE TO VALUATION-DT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 325
* ECS010D.cbl
 16988             MOVE '10'              TO W-VAL-SOURCE.
 16989
 16990*     DISPLAY ' B4 RTRM'
 16991     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16992*     DISPLAY ' AFTER RTRM'
 16993
 16994     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 16995        (REM-TRM3 GREATER ZERO)
 16996        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 16997            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16998                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16999            COMPUTE EW-REM-TERM = EW-REM-TERM +
 17000                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 17001          ELSE
 17002            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 17003            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 17004
 17005     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 17006         GO TO 4210-BY-OPT-LOGIC.
 17007
 17008     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 17009             AND
 17010         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 17011             AND
 17012         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 17013                 OR
 17014          CR-AH-CANC-DT EQUAL ZEROS)
 17015         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 17016         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 17017                 VARYING
 17018             SUBM FROM +1 BY +1
 17019                 UNTIL
 17020             SUBM GREATER THAN +13.
 17021
 17022     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 17023     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 17024
 17025 4210-BY-OPT-LOGIC.
 17026
 17027     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17028         ADD CR-LIVES TO EW-ISS-CNT
 17029         MOVE WE-AHPRM TO ISS-PRM
 17030         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 17031                                (ORIG-TERM * CR-LIVES)
 17032         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 17033         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17034         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17035                                   (ORIG-TERM * ISS-BEN)
 17036         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 17037         GO TO 4225-CONTINUE.
 17038
 17039     IF (NOT CR-POLICY-IS-RESTORE) AND
 17040        (NOT CR-POLICY-IS-REISSUE)
 17041        AND (NOT CR-POLICY-IS-MONTHLY)
 17042        ADD +1 TO EW-ISS-CNT.
 17043
 17044     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 17045
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 326
* ECS010D.cbl
 17046 4225-CONTINUE.
 17047
 17048*     DISPLAY ' 4225 '
 17049     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 17050         NEXT  SENTENCE
 17051       ELSE
 17052         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 17053
 17054     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 17055     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 17056     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 17057     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 17058     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 17059     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 17060
 17061     MOVE +0           TO SUB1.
 17062     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17063         10 TIMES.
 17064     MOVE +0                     TO SUB16
 17065     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 17066        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 17067
 17068     IF REIN-EP-FLG NOT = 'R'  OR
 17069        CR-POLICY-IS-REIN-ONLY
 17070         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 17071         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 17072         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 17073         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 17074
 17075     ADD ISS-BEN TO EW-ISS-BEN.
 17076     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 17077     ADD CNC-BEN TO EW-CNC-BEN.
 17078     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 17079     ADD ISS-PRM TO EW-ISS-PRM.
 17080     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 17081     ADD CNC-PRM TO EW-CNC-PRM.
 17082     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 17083
 17084     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17085     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17086     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17087
 17088     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 17089        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 17090     END-IF
 17091     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 17092        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 17093     END-IF
 17094     COMPUTE ISS-PRMTAX =
 17095        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 17096        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 17097     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17098
 17099     IF A-H-FULLY-EARNED
 17100         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17101                                            (ISS-PRM - EPR-R78)
 17102         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17103                                            (ISS-PRM - EPR-PRO)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 327
* ECS010D.cbl
 17104         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17105                                            (ISS-PRM - EPR-ST).
 17106
 17107     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17108         IF  REIN-EP-FLG NOT = 'R'
 17109                 OR
 17110             CR-POLICY-IS-REIN-ONLY
 17111             MOVE 'A'      TO W-CLAIM-TYPE
 17112             MOVE EPR-R78  TO W-OPT-R78
 17113             MOVE EPR-PRO  TO W-OPT-PRO
 17114             MOVE EPR-ST   TO W-OPT-ST
 17115             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17116             MOVE ZEROS    TO EW-CLM-IBNR
 17117         ELSE
 17118             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 17119                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 17120                 MOVE ZEROS TO EW-CLM-IBNR
 17121             ELSE
 17122                 MOVE ZEROS TO EW-CLM-IBNR
 17123     ELSE
 17124         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17125             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 17126         ELSE
 17127             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 17128                 IF  CR-AH-POLICY-IS-ACTIVE
 17129                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 17130                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 17131                 ELSE
 17132                     NEXT SENTENCE
 17133             ELSE
 17134                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 17135                     COMPUTE  EW-CLM-IBNR
 17136                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 17137
 17138     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 17139     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 17140
 17141 4290-CONTINUE.
 17142*     DISPLAY ' 4290 '
 17143
 17144     MOVE 'Y'          TO EW-LEVEL-USED.
 17145
 17146     IF CR-POLICY-UNDERWRITTEN
 17147         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17148         MOVE EPEC-OPT-WORK-TABLE
 17149                              TO EPEC-UNDW-OPT-DATA-TABLE
 17150     ELSE
 17151         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 17152         MOVE EPEC-OPT-WORK-TABLE
 17153                              TO EPEC-OPT-DATA-TABLE.
 17154
 17155
 17156 4295-EP-DO-COUNT.
 17157
 17158     IF REIN-EP-FLG = 'R'
 17159         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 17160     ELSE
 17161         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 328
* ECS010D.cbl
 17162
 17163     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 329
* ECS010D.cbl
 17165 4296-SLOT-INTO-EFFECTED-MONTHS.
 17166
 17167     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17168             AND
 17169         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17170             AND
 17171         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17172                 OR
 17173          CR-AH-CANC-DT EQUAL ZEROS)
 17174         MOVE 'Y'                 TO W-TABLE-USED-SW
 17175         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17176             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17177                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17178                 + CR-LIVES
 17179         ELSE
 17180             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17181                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17182
 17183 4296-EXIT.
 17184     EXIT.
 17185
 17186 4299-EPBX.
 17187     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 330
* ECS010D.cbl
 17189******************************************************************
 17190***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 17191******************************************************************
 17192
 17193 4300-EP-COMM-LOOP.
 17194*     DISPLAY ' 4300 '
 17195     IF DTE-CLIENT = 'DMD'
 17196         GO TO 4350-EP-COMM-LOOP-X.
 17197
 17198     ADD +1                         TO SUB1.
 17199     MOVE ZEROS                     TO SUB16.
 17200
 17201     IF CR-ADDL-CLP NOT NUMERIC
 17202        MOVE ZEROS               TO CR-ADDL-CLP
 17203     END-IF
 17204     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 17205         GO TO 4350-EP-COMM-LOOP-X.
 17206
 17207 4300-AGENT-LOOP.
 17208
 17209     ADD +1                         TO SUB16.
 17210
 17211     IF SUB16 GREATER THAN WS-LOOP-MAX
 17212         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17213         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 17214         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17215                                     TO WS-ABEND-MESSAGE
 17216         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17217         MOVE 4001                   TO WS-ABEND-CODE
 17218         GO TO ABEND-PGM.
 17219
 17220     IF EW-AGT-NO (SUB16) = SPACES
 17221         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 17222         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 17223     ELSE
 17224         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 17225            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 17226             NEXT SENTENCE
 17227         ELSE
 17228             GO TO 4300-AGENT-LOOP.
 17229
 17230     IF EW-LF-AH = AH-OVERRIDE-L1
 17231         GO TO 4350-EP-COMM-LOOP-A.
 17232
 17233     IF (DTE-CLIENT = 'DCC')
 17234        AND (REIN-EP-FLG = 'R')
 17235        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17236        AND (WE-LFPRM NOT = ZEROS)
 17237        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 17238           COMPUTE ISS-WK ROUNDED =
 17239              CR-LF-NSP-PRM * CR-LCOM-L (SUB1)
 17240        ELSE
 17241           COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 17242               (CR-LFAMT + CR-LFAMT-ALT)
 17243           COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 17244              * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 17245        END-IF
 17246     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 331
* ECS010D.cbl
 17247        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 17248                             OR 'J'
 17249           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 17250        ELSE
 17251           IF CR-AGT-TYPE (SUB1) = 'A'
 17252              COMPUTE ISS-WK ROUNDED =
 17253                   CR-LF-CLP * CR-LCOM-L (SUB1)
 17254           ELSE
 17255              IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 17256                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D')
 17257                 COMPUTE ISS-WK ROUNDED =
 17258                      CR-LF-CLP * CR-LCOM-L (SUB1)
 17259                 DISPLAY ' MADE IT TO LF DD AGT P '
 17260                    CR-LF-CLP ' ' CR-LCOM-L (SUB1)
 17261              ELSE
 17262                 IF CR-AGT-TYPE (SUB1) = 'P'
 17263                    MOVE +.01 TO CR-LCOM-L (SUB1)
 17264                 END-IF
 17265                 COMPUTE ISS-WK  ROUNDED = ISS-PRM
 17266                    * CR-LCOM-L (SUB1)
 17267                 IF CR-AGT-TYPE (SUB1) = 'P'
 17268                    AND REIN-EP-FLG NOT = 'R'
 17269                 DISPLAY ' OW ' CR-ACCT-CONTROL ' ' CR-CERT-NO ' '
 17270                   ISS-PRM ' * ' CR-LCOM-L (SUB1) ' = ' ISS-WK
 17271                   ' ' EW-ISS-COM (SUB16) ' ' SUB16
 17272                 END-IF
 17273              END-IF
 17274           END-IF
 17275        END-IF
 17276     END-IF
 17277
 17278     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16)
 17279         + ISS-WK.
 17280
 17281     MOVE ZEROS                  TO CNC-WK
 17282                                    CNC-FACT
 17283     IF DTE-CLIENT EQUAL 'XXX'
 17284         IF NOT CR-NO-LF-CHARGEBACK
 17285            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 17286            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 17287                                + CNC-WK
 17288            GO TO 4300-CONTINUE-LOOP.
 17289
 17290     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 17291        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 17292
 17293      IF (DTE-CLIENT = 'DCC')
 17294         AND (REIN-EP-FLG = 'R')
 17295         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17296         AND (WE-LFRFND NOT = ZEROS)
 17297         IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 17298            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17299            COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 17300               CR-LCOM-L (SUB1)
 17301            IF CR-ACCOUNT = '05500500DD'
 17302               DISPLAY ' REIN P D ' CNC-FACT ' ' CNC-WK
 17303            END-IF
 17304         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 332
* ECS010D.cbl
 17305            COMPUTE WS-CEDE-FACT = RWF-LFAMT / CR-LFAMT
 17306            COMPUTE CNC-WK ROUNDED = (CR-LFRFND * WS-CEDE-FACT)
 17307               * CR-LCOM-L (SUB1)
 17308         END-IF
 17309      ELSE
 17310        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 17311                              OR 'L' OR 'J' OR 'K')
 17312           AND (CNC-PRM > +0)
 17313           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17314           COMPUTE CNC-WK = CNC-FACT *
 17315              (CR-LCOM-L (SUB1) * +1000)
 17316        ELSE
 17317           IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 17318               AND (CR-AHTYP NOT = '00' AND '  ')
 17319              AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 17320              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17321              COMPUTE CNC-WK = CNC-FACT *
 17322                 (CR-AHPRM - (CR-LFPRM-ALT
 17323                 + CR-ADDL-CLP))
 17324           ELSE
 17325             IF (CR-AGT-TYPE (SUB1) = 'A')
 17326                       OR
 17327              ((CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 17328                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'))
 17329              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17330              COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 17331                CR-LCOM-L (SUB1)
 17332             ELSE
 17333                 IF CR-AGT-TYPE (SUB1) = 'P'
 17334                    MOVE +.01 TO CR-LCOM-L (SUB1)
 17335                 END-IF
 17336               COMPUTE CNC-WK  ROUNDED =
 17337                 CNC-PRM * CR-LCOM-L (SUB1)
 17338             END-IF
 17339           END-IF
 17340        END-IF
 17341      END-IF
 17342        COMPUTE EW-CNC-COM (SUB16) =
 17343                                  EW-CNC-COM (SUB16) + CNC-WK
 17344     END-IF
 17345
 17346     .
 17347 4300-CONTINUE-LOOP.
 17348
 17349*     DISPLAY ' 4300 CONTINUE '
 17350     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17351               OR
 17352        ((ISS-WK - CNC-WK) = ZEROS)
 17353        MOVE ZEROS              TO COMM-WK
 17354     ELSE
 17355        COMPUTE EC-FACT ROUNDED =
 17356           EPR-R78 / (ISS-PRM - CNC-PRM)
 17357        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17358     END-IF
 17359
 17360     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 17361
 17362     IF ((ISS-PRM - CNC-PRM) = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 333
* ECS010D.cbl
 17363               OR
 17364        ((ISS-WK - CNC-WK) = ZEROS)
 17365        MOVE ZEROS              TO COMM-WK
 17366     ELSE
 17367        COMPUTE EC-FACT ROUNDED =
 17368           EPR-PRO / (ISS-PRM - CNC-PRM)
 17369        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17370     END-IF
 17371     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 17372
 17373     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17374               OR
 17375        ((ISS-WK - CNC-WK) = ZEROS)
 17376        MOVE ZEROS              TO COMM-WK
 17377     ELSE
 17378        COMPUTE EC-FACT ROUNDED =
 17379           EPR-ST / (ISS-PRM - CNC-PRM)
 17380        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17381     END-IF
 17382
 17383     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 17384
 17385     IF LIFE-FULLY-EARNED
 17386         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 17387                                                CR-LCOM-L (SUB1)
 17388         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 17389                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 17390         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 17391                                                CR-LCOM-L (SUB1)
 17392         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 17393                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 17394
 17395     GO TO 4350-EP-COMM-LOOP-X.
 17396
 17397 4350-EP-COMM-LOOP-A.
 17398
 17399     IF (DTE-CLIENT = 'DCC')
 17400        AND (REIN-EP-FLG = 'R')
 17401        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17402        AND (WE-AHPRM NOT = ZEROS)
 17403
 17404        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
 17405           COMPUTE ISS-WK ROUNDED =
 17406              CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 17407        ELSE
 17408           COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 17409           COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 17410              * CR-LCOM-AH (SUB1)
 17411        END-IF
 17412     ELSE
 17413        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L' OR 'J'
 17414           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 17415        ELSE
 17416           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 17417             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 17418              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
 17419              + CR-ADDL-CLP)
 17420           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 334
* ECS010D.cbl
 17421              IF (CR-AGT-TYPE (SUB1) = 'M')
 17422                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 17423                              = 'G' OR 'L')
 17424                 COMPUTE ISS-WK ROUNDED =
 17425                    CR-LFPRM-ALT * CR-LCOM-AH (SUB1)
 17426              ELSE
 17427                 IF CR-AGT-TYPE (SUB1) = 'A'
 17428                    COMPUTE ISS-WK ROUNDED =
 17429                      CR-AH-CLP * CR-LCOM-AH (SUB1)
 17430                 ELSE
 17431                    IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 17432                       AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) =
 17433                                     'D')
 17434                       COMPUTE ISS-WK ROUNDED =
 17435                         CR-AH-CLP * CR-LCOM-AH (SUB1)
 17436                    ELSE
 17437                       COMPUTE ISS-WK  ROUNDED =
 17438                         ISS-PRM * CR-LCOM-AH (SUB1)
 17439                    END-IF
 17440                 END-IF
 17441              END-IF
 17442           END-IF
 17443        END-IF
 17444     END-IF
 17445
 17446     COMPUTE EW-ISS-COM (SUB16) =
 17447             EW-ISS-COM (SUB16) + ISS-WK.
 17448
 17449     MOVE ZEROS                  TO CNC-WK
 17450     IF DTE-CLIENT EQUAL 'XXX'
 17451         IF NOT CR-NO-LF-CHARGEBACK
 17452           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 17453           COMPUTE EW-CNC-COM (SUB16) =
 17454                   EW-CNC-COM (SUB16) + CNC-WK
 17455           GO TO 4300-CONTINUE-LOOP-AH.
 17456
 17457
 17458     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 17459        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 17460      IF (DTE-CLIENT = 'DCC')
 17461         AND (REIN-EP-FLG = 'R')
 17462         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17463         AND (WE-AHRFND NOT = ZEROS)
 17464         IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 17465            COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 17466            COMPUTE CNC-WK ROUNDED = CNC-FACT *
 17467                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 17468         ELSE
 17469            COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 17470            COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 17471            * CR-LCOM-AH (SUB1)
 17472         END-IF
 17473      ELSE
 17474        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 17475                              OR 'L' OR 'J' OR 'K')
 17476           AND (CNC-PRM > +0)
 17477           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17478           COMPUTE CNC-WK = CNC-FACT *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 335
* ECS010D.cbl
 17479              (CR-LCOM-AH (SUB1) * +1000)
 17480        ELSE
 17481           IF (CR-AGT-TYPE (SUB1) = 'M')
 17482              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 17483                              = 'G' OR 'L')
 17484              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 17485              COMPUTE CNC-WK = CNC-FACT *
 17486                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 17487           ELSE
 17488              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 17489                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 17490                 COMPUTE CNC-WK = CNC-FACT *
 17491                 (CR-AHPRM - (CR-LFPRM-ALT
 17492                    + CR-ADDL-CLP))
 17493              ELSE
 17494                 IF (CR-AGT-TYPE (SUB1) = 'A')
 17495                           OR
 17496                    ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 17497                    AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 17498                    COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 17499                    COMPUTE CNC-WK ROUNDED = CNC-FACT *
 17500                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 17501                 ELSE
 17502                    COMPUTE CNC-WK  ROUNDED =
 17503                      CNC-PRM * CR-LCOM-AH (SUB1)
 17504                 END-IF
 17505              END-IF
 17506           END-IF
 17507        END-IF
 17508*       END-IF
 17509      END-IF
 17510        COMPUTE EW-CNC-COM (SUB16) =
 17511           EW-CNC-COM (SUB16) + CNC-WK
 17512     END-IF
 17513
 17514     .
 17515 4300-CONTINUE-LOOP-AH.
 17516
 17517*     DISPLAY ' 4300-CONTINUE-LOOP-AH '
 17518     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17519                OR
 17520        ((ISS-WK - CNC-WK) = ZEROS)
 17521        MOVE ZEROS          TO COMM-WK
 17522     ELSE
 17523        COMPUTE EC-FACT ROUNDED =
 17524           EPR-R78 / (ISS-PRM - CNC-PRM)
 17525        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17526     END-IF
 17527
 17528     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 17529
 17530     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17531                OR
 17532        ((ISS-WK - CNC-WK) = ZEROS)
 17533        MOVE ZEROS          TO COMM-WK
 17534     ELSE
 17535        COMPUTE EC-FACT ROUNDED =
 17536           EPR-PRO / (ISS-PRM - CNC-PRM)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 336
* ECS010D.cbl
 17537        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17538     END-IF
 17539
 17540     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 17541
 17542     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17543                OR
 17544        ((ISS-WK - CNC-WK) = ZEROS)
 17545        MOVE ZEROS          TO COMM-WK
 17546     ELSE
 17547        COMPUTE EC-FACT ROUNDED =
 17548           EPR-ST / (ISS-PRM - CNC-PRM)
 17549        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17550     END-IF
 17551
 17552     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 17553
 17554     IF A-H-FULLY-EARNED
 17555         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 17556                                                CR-LCOM-AH (SUB1)
 17557         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 17558                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 17559         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 17560                                                CR-LCOM-AH (SUB1)
 17561         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 17562                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 17563
 17564 4350-EP-COMM-LOOP-X.
 17565     EXIT.
 17566
 17567
 17568
 17569
 17570******************************************************************
 17571***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 17572******************************************************************
 17573
 17574 4375-EP-BANK-COMM.
 17575*     DISPLAY ' 4375 '
 17576
 17577     IF CS-AGT (SUB1) = SPACES OR ZEROS
 17578        GO TO 4375-EXIT
 17579     END-IF
 17580     .
 17581 4375-BANK-LOOP.
 17582
 17583     ADD +1                      TO SUB16
 17584
 17585     IF EW-LF-AH NOT = AH-OVERRIDE-L1
 17586        GO TO 4375-EXIT
 17587     END-IF
 17588
 17589     IF SUB16 GREATER THAN WS-LOOP-MAX
 17590         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 17591         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 17592         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17593                                     TO WS-ABEND-MESSAGE
 17594         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 337
* ECS010D.cbl
 17595         MOVE 4001                   TO WS-ABEND-CODE
 17596         PERFORM ABEND-PGM
 17597     END-IF
 17598
 17599     IF EW-AGT-NO (SUB16) = SPACES
 17600        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 17601        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 17602     ELSE
 17603        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 17604           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 17605           CONTINUE
 17606        ELSE
 17607           GO TO 4375-BANK-LOOP
 17608        END-IF
 17609     END-IF
 17610
 17611     IF CS-COM-TYP  (SUB1) = 'B'
 17612        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 17613     END-IF
 17614
 17615     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 17616
 17617     MOVE ZEROS                  TO CNC-WK
 17618                                    CNC-FACT
 17619
 17620     IF (CS-COM-TYP (SUB1) = 'B')
 17621        AND (CNC-PRM > +0)
 17622        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17623        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 17624     END-IF
 17625
 17626     COMPUTE EW-CNC-COM (SUB16) =
 17627                  EW-CNC-COM (SUB16) + CNC-WK
 17628
 17629     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17630                OR
 17631        ((ISS-WK - CNC-WK) = ZEROS)
 17632        MOVE ZEROS          TO COMM-WK
 17633     ELSE
 17634        COMPUTE EC-FACT ROUNDED =
 17635           EPR-R78 / (ISS-PRM - CNC-PRM)
 17636        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17637     END-IF
 17638
 17639     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 17640
 17641     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17642                OR
 17643        ((ISS-WK - CNC-WK) = ZEROS)
 17644        MOVE ZEROS          TO COMM-WK
 17645     ELSE
 17646        COMPUTE EC-FACT ROUNDED =
 17647           EPR-PRO / (ISS-PRM - CNC-PRM)
 17648        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17649     END-IF
 17650
 17651     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 17652
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 338
* ECS010D.cbl
 17653     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17654                OR
 17655        ((ISS-WK - CNC-WK) = ZEROS)
 17656        MOVE ZEROS          TO COMM-WK
 17657     ELSE
 17658        COMPUTE EC-FACT ROUNDED =
 17659           EPR-ST / (ISS-PRM - CNC-PRM)
 17660        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17661     END-IF
 17662
 17663     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 17664
 17665     IF A-H-FULLY-EARNED
 17666        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 17667        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 17668                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 17669        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 17670                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 17671     END-IF
 17672
 17673     .
 17674 4375-EXIT.
 17675     EXIT.
 17676
 17677******************************************************************
 17678******************************************************************
 17679******************************************************************
 17680******************************************************************
 17681******************************************************************
 17682******************************************************************
 17683******************************************************************
 17684******************************************************************
 17685******************************************************************
 17686******************************************************************
 17687***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 17688******************************************************************
 17689
 17690 S-4100-EP-DO-LF.
 17691
 17692     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 17693                                        EPR-PRO
 17694                                        EPR-ST.
 17695
 17696     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 17697     MOVE 'L'                    TO DC-OPTION-CODE.
 17698     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17699
 17700     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17701     MOVE -1                     TO DC-ELAPSED-DAYS.
 17702     MOVE '6'                    TO DC-OPTION-CODE.
 17703     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17704
 17705     MOVE +0                     TO DC-ELAPSED-MONTHS
 17706                                    DC-ELAPSED-DAYS.
 17707
 17708     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 17709     MOVE ' '                    TO DC-OPTION-CODE.
 17710     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 339
* ECS010D.cbl
 17711
 17712     IF NO-CONVERSION-ERROR
 17713        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 17714     ELSE
 17715         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 17716                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 17717                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 17718         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 17719                                     TO WS-ABEND-MESSAGE
 17720         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17721         MOVE 4001                   TO WS-ABEND-CODE
 17722         GO TO ABEND-PGM.
 17723
 17724     IF CR-LFTYP = ZERO
 17725         GO TO S-4200-EP-DO-AH.
 17726
 17727     IF REIN-LF-FLG (SUB5) = SPACE
 17728         GO TO S-4200-EP-DO-AH.
 17729
 17730     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 17731     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 17732     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17733
 17734     MOVE CR-LF-TERM             TO ORIG-TERM.
 17735     MOVE CLAS-INDEXL            TO W-NDX.
 17736
 17737 S-4120-EP-DO-LF-CNCL.
 17738
 17739     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 17740        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 17741         GO TO S-4130-EP-DO-LF-EP.
 17742
 17743     COMPUTE EARNED-BY-CANCEL =
 17744                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 17745
 17746 S-4130-EP-DO-LF-EP.
 17747
 17748     MOVE SPACE                  TO STATUTORY-SWITCH.
 17749
 17750     MOVE EARNING-START-DATE     TO VALUATION-DT.
 17751     MOVE '9'                    TO W-VAL-SOURCE.
 17752     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17753
 17754     IF REM-TRM2 GREATER CR-LF-TERM
 17755         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17756         GO TO S-4190-EP-DO-LF-COMM.
 17757
 17758     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17759         GO TO S-4180-EP-DO-LF-EP-SUM.
 17760
 17761     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 17762         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 17763             IF REM-TRM2 NOT GREATER THAN +0
 17764                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 17765                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17766                 GO TO S-4190-EP-DO-LF-COMM
 17767             ELSE
 17768                 NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 340
* ECS010D.cbl
 17769         ELSE
 17770             IF W-BAL-REMTRM NOT GREATER +0
 17771                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 17772                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17773                 GO TO S-4190-EP-DO-LF-COMM
 17774             ELSE
 17775                 NEXT SENTENCE
 17776     ELSE
 17777        IF (DTE-CLIENT EQUAL 'NCL') AND
 17778           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 17779             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 17780        ELSE
 17781         IF REM-TRM2 NOT GREATER +0  OR
 17782            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 17783             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 17784             GO TO S-4190-EP-DO-LF-COMM.
 17785
 17786     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17787         GO TO S-4140-EP-DO-LF-EP-TEX.
 17788
 17789     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17790         GO TO S-4150-EP-DO-LF-EP-NP.
 17791
 17792*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 17793     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17794        (CR-RATING-CLASS NOT = 'L ')
 17795         IF (CR-APR GREATER THAN ZERO)  AND
 17796            (CR-LF-TERM GREATER THAN 060)  AND
 17797            (CR-DT GREATER THAN 19831031)
 17798             MOVE '*'             TO STATUTORY-SWITCH
 17799              GO TO S-4150-EP-DO-LF-EP-NP.
 17800
 17801     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17802         IF (CR-APR GREATER THAN ZERO)  AND
 17803            (CR-LF-TERM GREATER THAN 061)  AND
 17804            (CR-DT GREATER THAN 19830318)
 17805             MOVE '*'             TO STATUTORY-SWITCH
 17806              GO TO S-4150-EP-DO-LF-EP-NP.
 17807
 17808     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17809         IF (CR-APR GREATER THAN ZERO)  AND
 17810            (CR-LF-TERM GREATER THAN 062)  AND
 17811            (CR-DT GREATER THAN 19810831)  AND
 17812            (CR-DT LESS THAN 19830901)
 17813             MOVE '*'             TO STATUTORY-SWITCH
 17814              GO TO S-4150-EP-DO-LF-EP-NP.
 17815
 17816     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17817         IF (CR-APR GREATER THAN ZERO)  AND
 17818            (CR-LF-TERM GREATER THAN 060)  AND
 17819            (CR-DT GREATER THAN 19831231)
 17820             MOVE '*'             TO STATUTORY-SWITCH
 17821              GO TO S-4150-EP-DO-LF-EP-NP.
 17822
 17823     GO TO S-4160-EP-DO-LF-EP-R78.
 17824
 17825 S-4140-EP-DO-LF-EP-TEX.
 17826
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 341
* ECS010D.cbl
 17827     COMPUTE TEX-FACT-4 =
 17828         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 17829     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 17830         GIVING TEX-FACT-5
 17831             REMAINDER TEX-FACT-6.
 17832     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 17833     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 17834         (TEX-FACT-5 * CR-PMT-FREQ) +
 17835         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 17836     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 17837
 17838     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 17839
 17840     GO TO S-4170-EP-DO-LF-EP-PRO.
 17841
 17842 S-4150-EP-DO-LF-EP-NP.
 17843
 17844     IF WE-LFPRM = ZERO
 17845         GO TO S-4160-EP-DO-LF-EP-R78.
 17846
 17847     IF DTE-CLIENT = 'CRI'
 17848       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 17849             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17850           GO TO S-4160-EP-DO-LF-EP-R78.
 17851
 17852     IF DTE-CLIENT = 'NCL'
 17853       IF CR-DT LESS THAN 19910101
 17854           GO TO S-4160-EP-DO-LF-EP-R78.
 17855
 17856     IF REM-TRM1 = CR-LF-TERM
 17857         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17858         GO TO S-4190-EP-DO-LF-COMM.
 17859
 17860     MOVE CR-APR TO NP-APR.
 17861     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17862     MOVE REM-TRM1 TO NP-REM.
 17863     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17864     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17865         MOVE CR-LOAN-TERM TO NP-ORIG.
 17866     MOVE 'R' TO NP-OPT.
 17867     CALL 'ECSNETRM'
 17868         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17869
 17870     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17871
 17872     IF STATUTORY-REQUIREMENT
 17873         MOVE EPR-R78                TO EPR-ST.
 17874
 17875 S-4160-EP-DO-LF-EP-R78.
 17876
 17877     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17878        (DTE-CLIENT EQUAL 'NCL')
 17879        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17880           (CR-MO EQUAL EOM-MO)
 17881           MOVE '*'            TO OB-DATE-1-SWITCH
 17882           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17883           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17884           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 342
* ECS010D.cbl
 17885           COMPUTE WS-EPR-R78 (SUB3 1) =
 17886                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 17887           GO TO S-4190-EP-DO-LF-COMM
 17888        ELSE
 17889        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17890           (CR-MO EQUAL OB-MO (1))
 17891           MOVE '*'            TO OB-DATE-2-SWITCH
 17892           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17893           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17894           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17895           COMPUTE WS-EPR-R78 (SUB3 2) =
 17896                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 17897           GO TO S-4190-EP-DO-LF-COMM
 17898        ELSE
 17899        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17900           (CR-MO EQUAL OB-MO (2))
 17901           MOVE '*'            TO OB-DATE-3-SWITCH
 17902           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17903           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17904           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17905           COMPUTE WS-EPR-R78 (SUB3 3) =
 17906                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 17907           GO TO S-4190-EP-DO-LF-COMM
 17908        ELSE
 17909           GO TO S-4190-EP-DO-LF-COMM.
 17910
 17911     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17912
 17913     IF DTE-R78 = '1'
 17914         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17915     ELSE
 17916         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17917
 17918     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17919
 17920     IF REM-TRM1 GREATER THAN +0
 17921         COMPUTE TEMP-7 ROUNDED EQUAL
 17922             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17923     ELSE
 17924         MOVE WE-LFPRM                TO TEMP-7.
 17925
 17926     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17927         MOVE TEMP-7                 TO EPR-ST.
 17928
 17929     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17930         MOVE ZEROS                  TO TEMP-8
 17931         GO TO S-4165-END-LF-EP-R78.
 17932
 17933     IF EPR-ST NOT = ZEROS
 17934         MOVE TEMP-7                 TO EPR-ST.
 17935
 17936     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17937         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17938         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17939         IF DTE-R78 = '1'
 17940             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17941
 17942     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 343
* ECS010D.cbl
 17943
 17944     COMPUTE TEMP-8 ROUNDED =
 17945               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17946
 17947 S-4165-END-LF-EP-R78.
 17948
 17949     IF EPR-R78 = ZEROS
 17950         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17951     ELSE
 17952         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17953
 17954 S-4170-EP-DO-LF-EP-PRO.
 17955
 17956     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17957         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17958     ELSE
 17959         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17960
 17961     IF REM-TRM1 GREATER THAN +0
 17962         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17963     ELSE
 17964         MOVE WE-LFPRM                  TO TEMP-7.
 17965
 17966     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17967         MOVE ZEROS                     TO TEMP-8
 17968         GO TO S-4175-END-LF-EP-PRO.
 17969
 17970     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17971         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17972             COMPUTE TEMP-5 ROUNDED =
 17973                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17974         ELSE
 17975             COMPUTE TEMP-5 ROUNDED =
 17976                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17977
 17978     COMPUTE TEMP-8 ROUNDED =
 17979                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 17980
 17981     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17982
 17983 S-4175-END-LF-EP-PRO.
 17984
 17985     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17986
 17987     GO TO S-4185-EP-DO-LF-STATUTORY.
 17988
 17989 S-4180-EP-DO-LF-EP-SUM.
 17990
 17991     IF REM-TRM1 NOT GREATER +0
 17992         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 17993         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17994         GO TO S-4190-EP-DO-LF-COMM.
 17995
 17996     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17997         MOVE ZEROS                 TO TEMP-7
 17998     ELSE
 17999         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 18000                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 344
* ECS010D.cbl
 18001
 18002     IF TEMP-7 NOT GREATER ZERO
 18003         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18004             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 18005             GO TO S-4190-EP-DO-LF-COMM
 18006         ELSE
 18007             MOVE ZEROS             TO TEMP-7.
 18008
 18009     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 18010     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 18011     IF DTE-R78 = '1'
 18012         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 18013
 18014     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 18015     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 18016
 18017     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 18018
 18019     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 18020
 18021     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18022         GO TO S-4185-EP-DO-LF-STATUTORY.
 18023
 18024     MOVE EPR-R78                  TO EPR-ST.
 18025
 18026     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 18027         MOVE ZEROS                 TO TEMP-8
 18028     ELSE
 18029         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 18030                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 18031
 18032     IF TEMP-8 NOT GREATER ZERO
 18033         GO TO S-4185-EP-DO-LF-STATUTORY.
 18034
 18035     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 18036                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 18037
 18038     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 18039                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 18040
 18041     COMPUTE EPR-ST ROUNDED = EPR-ST +
 18042                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 18043
 18044 S-4185-EP-DO-LF-STATUTORY.
 18045
 18046*08472      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 18047*08473          MOVE EPR-R78                TO EPR-ST.
 18048
 18049     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 18050         MOVE EPR-PRO                TO EPR-ST.
 18051
 18052     IF (DTE-CLIENT = 'CID') AND
 18053        (STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX') AND
 18054        (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L') AND
 18055        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 18056           GO TO S-4187-EP-DO-LF-STAT-ROA
 18057     END-IF.
 18058
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 345
* ECS010D.cbl
 18059     IF EPR-ST NOT = ZEROS
 18060         GO TO S-4190-EP-DO-LF-COMM.
 18061
 18062     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 18063         MOVE EPR-R78                TO EPR-ST
 18064     ELSE
 18065         MOVE EPR-PRO                TO EPR-ST.
 18066
 18067     GO TO S-4190-EP-DO-LF-COMM.
 18068
 18069 S-4187-EP-DO-LF-STAT-ROA.
 18070     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 18071     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 18072     MOVE 'L'                        TO DC-OPTION-CODE.
 18073     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18074     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 18075     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 18076        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 18077        MOVE '3'                 TO  DC-OPTION-CODE
 18078        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 18079                              8099-DATE-CONVERT-X
 18080        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 18081     ELSE
 18082        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 18083        MOVE +1                  TO  DC-ELAPSED-MONTHS
 18084        MOVE +0                  TO  DC-ELAPSED-DAYS
 18085        MOVE '6'                 TO  DC-OPTION-CODE
 18086        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 18087                              8099-DATE-CONVERT-X
 18088        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 18089     END-IF
 18090     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 18091     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 18092     MOVE SPACES                     TO CP-ACCT-FLD-5.
 18093     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 18094     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 18095     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 18096     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 18097     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 18098     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 18099     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 18100                                        CP-LOAN-TERM.
 18101     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 18102                                        CP-RATING-BENEFIT-AMT.
 18103     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 18104         MOVE ZEROS                  TO CP-REMAINING-BENEFIT
 18105     ELSE
 18106         MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
 18107     END-IF.
 18108     MOVE CR-APR                     TO CP-LOAN-APR.
 18109     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 18110     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 18111     MOVE '6'                        TO CP-EARNING-METHOD.
 18112     MOVE '3'                        TO CP-PROCESS-TYPE.
 18113     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 18114     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 18115         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 18116     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 346
* ECS010D.cbl
 18117         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 18118     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 18119     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 18120     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 18121     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 18122     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 18123     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 18124
 18125
 18126     IF CP-STATE-STD-ABBRV = 'OR'
 18127        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 18128     END-IF
 18129
 18130     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 18131        COMPUTE CP-ORIGINAL-BENEFIT =
 18132         (CR-LFAMT - CR-LFPRM)
 18133     END-IF
 18134
 18135     IF CP-TRUNCATED-LIFE
 18136        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 18137     END-IF
 18138
 18139     IF CP-TERM-IS-DAYS
 18140        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 18141     ELSE
 18142        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 18143     END-IF
 18144
 18145     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 18146
 18147     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 18148
 18149 S-4190-EP-DO-LF-COMM.
 18150
 18151     IF EARNED-BY-CANCEL = ZEROS
 18152         GO TO S-4195-LF-COMM-CONTINUE.
 18153
 18154     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 18155         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 18156
 18157     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 18158         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 18159
 18160     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 18161         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 18162
 18163 S-4195-LF-COMM-CONTINUE.
 18164
 18165     MOVE +0 TO SUB1.
 18166     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 18167         10 TIMES.
 18168
 18169     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 18170     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 18171     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 18172
 18173     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 18174     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 347
* ECS010D.cbl
 18175     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 18176
 18177     MOVE 'Y'          TO EW-LEVEL-USED.
 18178
 18179     IF CR-POLICY-UNDERWRITTEN
 18180         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 18181
 18182     ELSE
 18183         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 18184
 18185     GO TO S-4200-EP-DO-AH.
 18186
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 348
* ECS010D.cbl
 18188******************************************************************
 18189***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 18190******************************************************************
 18191
 18192 S-4200-EP-DO-AH.
 18193
 18194     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 18195                                        EPR-PRO
 18196                                        EPR-ST.
 18197
 18198     IF CR-AHTYP = ZERO
 18199         GO TO S-4299-EPBX.
 18200
 18201     IF REIN-AH-FLG (SUB5) = SPACE
 18202         GO TO S-4299-EPBX.
 18203
 18204     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 18205     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 18206     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 18207
 18208     MOVE CR-AH-TERM           TO ORIG-TERM.
 18209     MOVE CLAS-INDEXA          TO W-NDX.
 18210
 18211     MOVE EARNING-START-DATE     TO VALUATION-DT.
 18212     MOVE '9'                    TO W-VAL-SOURCE.
 18213     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 18214
 18215 S-4220-EP-DO-AH-CNCL.
 18216
 18217     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 18218         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 18219
 18220 S-4230-EP-DO-AH-EP.
 18221
 18222     IF REM-TRM2 GREATER CR-AH-TERM
 18223         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18224         GO TO S-4290-EP-DO-AH-COMM.
 18225
 18226     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 18227         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 18228
 18229 S-4235-CHECK-OB-AH-NCL.
 18230
 18231     IF (DTE-CLIENT EQUAL 'NCL') AND
 18232        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 18233           MOVE WE-AHPRM         TO EPR-R78
 18234                                    EPR-PRO
 18235                                    EPR-ST
 18236        IF (CR-CCYY EQUAL EOM-CCYY) AND
 18237           (CR-MO EQUAL EOM-MO)
 18238           MOVE '*'            TO OB-DATE-1-SWITCH
 18239           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18240           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18241           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18242           COMPUTE WS-EPR-R78 (SUB3 1) =
 18243                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 18244            GO TO S-4290-EP-DO-AH-COMM
 18245        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 349
* ECS010D.cbl
 18246        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 18247           (CR-MO EQUAL OB-MO (1))
 18248           MOVE '*'            TO OB-DATE-2-SWITCH
 18249           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18250           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18251           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18252           COMPUTE WS-EPR-R78 (SUB3 2) =
 18253                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 18254            GO TO S-4290-EP-DO-AH-COMM
 18255        ELSE
 18256        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 18257           (CR-MO EQUAL OB-MO (2))
 18258           MOVE '*'            TO OB-DATE-3-SWITCH
 18259           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18260           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18261           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18262           COMPUTE WS-EPR-R78 (SUB3 3) =
 18263                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 18264            GO TO S-4290-EP-DO-AH-COMM
 18265        ELSE
 18266            GO TO S-4290-EP-DO-AH-COMM.
 18267
 18268     IF REM-TRM2 NOT GREATER +0
 18269         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 18270         GO TO S-4290-EP-DO-AH-COMM.
 18271
 18272     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 18273         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 18274         GO TO S-4290-EP-DO-AH-COMM.
 18275
 18276     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 18277     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 18278     IF DTE-R78 = '1'
 18279         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 18280     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 18281
 18282     IF DTE-CLIENT = 'MIC' OR 'MCC'
 18283         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 18284     ELSE
 18285         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 18286
 18287     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 18288     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 18289
 18290     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 18291     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 18292
 18293     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 18294
 18295*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 18296*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 18297
 18298     MOVE SPACES TO STATUTORY-SWITCH-AH.
 18299
 18300     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 18301        (CR-DT GREATER THAN  19921231)
 18302         IF CR-AH-TERM GREATER THAN  +61
 18303             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 350
* ECS010D.cbl
 18304             MOVE '*' TO STATUTORY-SWITCH-AH
 18305             GO TO S-4245-EP-DO-AH-EP-AN
 18306         ELSE
 18307             GO TO S-4250-EP-DO-AH-STATUTORY.
 18308
 18309     IF AH-EARN-METHOD EQUAL 'N'
 18310         GO TO S-4240-EP-DO-AH-EP-NP.
 18311
 18312     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 18313         MOVE 'A' TO AH-EARN-METHOD
 18314         GO TO S-4245-EP-DO-AH-EP-AN.
 18315
 18316     GO TO S-4250-EP-DO-AH-STATUTORY.
 18317
 18318 S-4240-EP-DO-AH-EP-NP.
 18319
 18320     IF WE-AHPRM = ZERO
 18321         GO TO S-4250-EP-DO-AH-STATUTORY.
 18322
 18323     IF CR-APR GREATER THAN +0
 18324         NEXT SENTENCE
 18325     ELSE
 18326         GO TO S-4250-EP-DO-AH-STATUTORY.
 18327
 18328     IF DTE-CLIENT = 'NCL'
 18329       IF CR-DT LESS THAN 19910101
 18330           GO TO S-4250-EP-DO-AH-STATUTORY.
 18331
 18332     IF REM-TRM1 = CR-AH-TERM
 18333         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18334         GO TO S-4290-EP-DO-AH-COMM.
 18335
 18336     MOVE CR-APR TO NP-APR.
 18337     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 18338     MOVE REM-TRM1 TO NP-REM.
 18339     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 18340     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 18341         MOVE CR-LOAN-TERM TO NP-ORIG.
 18342     MOVE 'R' TO NP-OPT.
 18343     CALL 'ECSNETRM'
 18344         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 18345
 18346     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 18347
 18348     GO TO S-4250-EP-DO-AH-STATUTORY.
 18349
 18350 S-4245-EP-DO-AH-EP-AN.
 18351     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 18352     MOVE 'L'                        TO DC-OPTION-CODE.
 18353     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18354     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 18355     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 18356     MOVE SPACES                     TO CP-ACCT-FLD-5.
 18357     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 18358     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 18359     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 18360     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 18361     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 351
* ECS010D.cbl
 18362     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 18363                                        CP-RATING-BENEFIT-AMT.
 18364     IF CP-STATE-STD-ABBRV = 'OR'
 18365         COMPUTE CP-RATING-BENEFIT-AMT =
 18366                                  CR-AHAMT * REM-TRM1.
 18367     MOVE CR-APR                     TO CP-LOAN-APR.
 18368     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 18369     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 18370     MOVE '3'                        TO CP-PROCESS-TYPE.
 18371     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 18372     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 18373
 18374     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 18375         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 18376     ELSE
 18377         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 18378
 18379     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 18380     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 18381     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 18382     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 18383     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 18384     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 18385
 18386     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 18387
 18388     IF CP-ERROR-RATE-NOT-FOUND  OR
 18389        CP-ERROR-RATE-IS-ZERO  OR
 18390        CP-ERROR-IN-DATES
 18391         GO TO S-4250-EP-DO-AH-STATUTORY.
 18392
 18393     COMPUTE EPR-R78 ROUNDED =
 18394             ((REM-TRM1 * WE-AHAMT) / +100) *
 18395               CP-PREMIUM-RATE.
 18396
 18397     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 18398
 18399     IF STATUTORY-REQUIREMENT-AH
 18400         MOVE EPR-R78                TO EPR-ST
 18401         GO TO S-4290-EP-DO-AH-COMM.
 18402
 18403 S-4250-EP-DO-AH-STATUTORY.
 18404     IF (DTE-CLIENT EQUAL 'CID') AND
 18405        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 18406         GO TO S-4267-EP-DO-AH-STAT-ROA
 18407     END-IF.
 18408
 18409 S-4250-EP-DO-AH-STATUTORY-VA.
 18410
 18411     MOVE EPR-R78                    TO EPR-ST.
 18412
 18413     MOVE +0                         TO SUB1.
 18414
 18415 S-4255-EP-AH-STAT-LOOP.
 18416     ADD +1 TO SUB1.
 18417
 18418     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 18419         MOVE EPR-PRO                TO EPR-ST
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 352
* ECS010D.cbl
 18420     ELSE
 18421         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 18422             GO TO S-4255-EP-AH-STAT-LOOP.
 18423
 18424     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 18425         CR-DT GREATER THAN 19831031)
 18426                    OR
 18427        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 18428         CR-DT GREATER THAN 19820629)
 18429                    OR
 18430        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 18431         CR-DT GREATER THAN 19830831)
 18432             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 18433
 18434     IF DTE-CLIENT = 'CSO'  OR  'CID'
 18435       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 18436         IF CR-DT LESS THAN 19970101
 18437             MOVE EPR-R78            TO EPR-ST
 18438         ELSE
 18439             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 18440
 18441     GO TO S-4290-EP-DO-AH-COMM.
 18442
 18443 S-4267-EP-DO-AH-STAT-ROA.
 18444     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 18445     MOVE 'L'                        TO DC-OPTION-CODE.
 18446     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18447     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 18448     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 18449     MOVE SPACES                     TO CP-ACCT-FLD-5.
 18450     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 18451     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 18452     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 18453     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 18454     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 18455     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 18456                                        CP-RATING-BENEFIT-AMT.
 18457     IF CP-STATE-STD-ABBRV = 'OR'
 18458         COMPUTE CP-RATING-BENEFIT-AMT =
 18459                                  CR-AHAMT * REM-TRM1.
 18460     MOVE CR-APR                     TO CP-LOAN-APR.
 18461     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 18462     MOVE 'A'                        TO CP-EARNING-METHOD.
 18463     MOVE '3'                        TO CP-PROCESS-TYPE.
 18464     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 18465     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 18466     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 18467         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 18468     ELSE
 18469         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 18470     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 18471     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 18472     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 18473     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 18474     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 18475     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 18476
 18477     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 353
* ECS010D.cbl
 18478
 18479     IF CP-ERROR-RATE-NOT-FOUND  OR
 18480        CP-ERROR-RATE-IS-ZERO  OR
 18481        CP-ERROR-IN-DATES
 18482         GO TO S-4250-EP-DO-AH-STATUTORY-VA.
 18483
 18484     COMPUTE EPR-ST ROUNDED =
 18485             ((REM-TRM1 * WE-AHAMT) / +100) *
 18486               CP-PREMIUM-RATE.
 18487
 18488     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 18489
 18490     GO TO S-4290-EP-DO-AH-COMM.
 18491
 18492 S-4290-EP-DO-AH-COMM.
 18493
 18494     IF EARNED-BY-CANCEL = ZEROS
 18495         GO TO S-4295-AH-COMM-CONTINUE.
 18496
 18497     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 18498         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 18499
 18500     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 18501         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 18502
 18503     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 18504         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 18505
 18506 S-4295-AH-COMM-CONTINUE.
 18507
 18508     MOVE +0           TO SUB1.
 18509     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 18510         10 TIMES.
 18511
 18512     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 18513     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 18514     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 18515
 18516     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 18517     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 18518     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 18519
 18520     MOVE 'Y'          TO EW-LEVEL-USED.
 18521
 18522     IF CR-POLICY-UNDERWRITTEN
 18523         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 18524     ELSE
 18525         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 18526
 18527
 18528 S-4299-EPBX.
 18529     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 354
* ECS010D.cbl
 18531******************************************************************
 18532***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 18533******************************************************************
 18534
 18535 S-4300-EP-COMM-LOOP.
 18536
 18537     ADD +1 TO SUB1.
 18538     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 18539         GO TO S-4399-EP-COMM-LOOP-X.
 18540
 18541     IF EW-LF-AH = AH-OVERRIDE-L1
 18542         GO TO S-4350-EP-COMM-LOOP-A.
 18543
 18544*    IF CR-AGT-TYPE (SUB1) = 'K'
 18545*       COMPUTE COMM-WK =
 18546     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 18547     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 18548     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 18549                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 18550
 18551     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 18552     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 18553     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 18554                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 18555
 18556     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 18557     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 18558
 18559     GO TO S-4399-EP-COMM-LOOP-X.
 18560
 18561 S-4350-EP-COMM-LOOP-A.
 18562
 18563     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 18564     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 18565     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 18566                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 18567
 18568     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 18569     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 18570     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 18571                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 18572
 18573     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 18574     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 18575
 18576 S-4399-EP-COMM-LOOP-X.
 18577     EXIT.
 18578
 18579******************************************************************
 18580******************************************************************
 18581******************************************************************
 18582******************************************************************
 18583******************************************************************
 18584******************************************************************
 18585******************************************************************
 18586******************************************************************
 18587******************************************************************
 18588******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 355
* ECS010D.cbl
 18590******************************************************************
 18591***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 18592******************************************************************
 18593
 18594 4400-EP-FIND-TAB-ENT.
 18595
 18596     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 18597         GO TO 4490-EP-FIND-TAB-SUB.
 18598     MOVE +1 TO SUB9.
 18599
 18600 4450-EP-FIND-TAB-LOOP.
 18601
 18602     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 18603         GO TO 4490-EP-FIND-TAB-SUB.
 18604     IF EPEC-SUB-REIN (SUB9) = ZEROS
 18605         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 18606         GO TO 4490-EP-FIND-TAB-SUB.
 18607
 18608     ADD +1 TO SUB9.
 18609     IF SUB9 GREATER THAN +31
 18610         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 18611         MOVE 0201 TO WS-ABEND-CODE
 18612         DISPLAY '******************************'
 18613         DISPLAY '***** ERROR LOCATION 020 *****'
 18614         DISPLAY '******************************'
 18615         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 18616         GO TO ABEND-PGM.
 18617
 18618     GO TO 4450-EP-FIND-TAB-LOOP.
 18619
 18620 4490-EP-FIND-TAB-SUB.
 18621
 18622     IF WE-LF-AH = LIFE-OVERRIDE-L1
 18623         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 18624             ADD +1 TO SUB10
 18625             MOVE SUB10 TO SUB3
 18626             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 18627         ELSE
 18628             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 18629
 18630     IF WE-LF-AH = AH-OVERRIDE-L1
 18631         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 18632             ADD +1 TO SUB10
 18633             MOVE SUB10 TO SUB3
 18634             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 18635         ELSE
 18636             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 18637
 18638*    IF SUB3 GREATER THAN +220
 18639*    IF SUB3 GREATER THAN +300
 18640     IF SUB3 GREATER THAN +900
 18641         DISPLAY 'SUB3 VALUE IS - ' SUB3
 18642         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 18643         MOVE 0202 TO WS-ABEND-CODE
 18644         DISPLAY '******************************'
 18645         DISPLAY '***** ERROR LOCATION 021 *****'
 18646         DISPLAY '******************************'
 18647         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 356
* ECS010D.cbl
 18648         GO TO ABEND-PGM.
 18649
 18650     IF CR-POLICY-UNDERWRITTEN
 18651         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 18652         MOVE EPEC-UNDW-OPT-DATA-TABLE
 18653                                     TO EPEC-OPT-WORK-TABLE
 18654     ELSE
 18655         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 18656         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 18657
 18658     MOVE WE-REIN-CO         TO EW-REIN-CO
 18659                                EPEC-REIN-CO (SUB3)
 18660                                EPEC-REIN-CO-II (SUB3).
 18661     MOVE WE-LF-AH           TO EW-LF-AH
 18662                                EPEC-LF-AH (SUB3)
 18663                                EPEC-LF-AH-II (SUB3).
 18664     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 18665                                EPEC-BEN-TYPE (SUB3)
 18666                                EPEC-BEN-TYPE-II (SUB3).
 18667
 18668 4499-EP-FIND-TAB-ENT-X.
 18669     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 357
* ECS010D.cbl
 18671******************************************************************
 18672***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 18673******************************************************************
 18674
 18675 4500-BUILD-EPEC-EXTRACT.
 18676
 18677     IF DTE-CLIENT = 'DCC'
 18678        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 18679     END-IF
 18680
 18681     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 18682         VARYING SUB2 FROM +1 BY +1
 18683             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 18684
 18685     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 18686
 18687     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 18688
 18689
 18690 4510-BUILD-EPEC-EXT.
 18691
 18692     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 18693     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 18694     IF EW-LEVEL-USED = 'Y'
 18695         MOVE SPACE                     TO W-UNDERWRITING-SW
 18696         PERFORM 4511-BUILD-EPEC-RECORD THRU
 18697                 4518-BUILD-EPEC-RCD-X.
 18698
 18699     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 18700     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 18701     IF EW-LEVEL-USED = 'Y'
 18702         MOVE '*'                       TO W-UNDERWRITING-SW
 18703         PERFORM 4511-BUILD-EPEC-RECORD THRU
 18704                 4518-BUILD-EPEC-RCD-X.
 18705
 18706     GO TO 4519-BUILD-EPEC-EXT-X.
 18707
 18708 4511-BUILD-EPEC-RECORD.
 18709
 18710     MOVE SPACES                        TO EP-RECORD.
 18711     MOVE 'EP'                          TO EP-RECORD-ID.
 18712     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 18713     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 18714     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 18715     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 18716                                           WS-EP-EFF-DTE-N.
 18717     MOVE EW-REIN-CO                    TO EP-REI-CO.
 18718     IF EP-REI-CO NOT = SPACES
 18719         MOVE 'R'                       TO EP-REIN.
 18720     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 18721     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 18722
 18723     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 18724     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 18725     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 18726
 18727     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
 18728     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 358
* ECS010D.cbl
 18729     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 18730
 18731     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 18732     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 18733     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 18734     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 18735
 18736     IF DTE-CLIENT NOT = 'NCL'
 18737         GO TO 4512-BUILD-EPEC-CONTINUE.
 18738
 18739     IF W-UNDERWRITTEN-DATA
 18740         GO TO 4512-BUILD-EPEC-CONTINUE.
 18741
 18742     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 18743         GO TO 4512-BUILD-EPEC-CONTINUE.
 18744
 18745     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 18746        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 18747        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 18748         NEXT SENTENCE
 18749     ELSE
 18750         GO TO 4512-BUILD-EPEC-CONTINUE.
 18751
 18752     IF OB-DATE-1-USED  OR
 18753        OB-DATE-2-USED  OR
 18754        OB-DATE-3-USED
 18755         NEXT SENTENCE
 18756     ELSE
 18757         GO TO 4512-BUILD-EPEC-CONTINUE.
 18758
 18759     IF OB-DATE-1-USED
 18760         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 18761             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18762                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 18763             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18764                                   EW-EPR-ST
 18765             GO TO 4512-BUILD-EPEC-CONTINUE
 18766         ELSE
 18767             GO TO 4512-BUILD-EPEC-CONTINUE.
 18768
 18769     IF OB-DATE-2-USED
 18770         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 18771             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18772                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 18773             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18774                                   EW-EPR-ST
 18775             GO TO 4512-BUILD-EPEC-CONTINUE
 18776         ELSE
 18777             GO TO 4512-BUILD-EPEC-CONTINUE.
 18778
 18779     IF OB-DATE-3-USED
 18780         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 18781             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18782                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 18783             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18784                                   EW-EPR-ST
 18785             GO TO 4512-BUILD-EPEC-CONTINUE
 18786         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 359
* ECS010D.cbl
 18787             GO TO 4512-BUILD-EPEC-CONTINUE.
 18788
 18789 4512-BUILD-EPEC-CONTINUE.
 18790
 18791     MOVE EW-EPR-R78                    TO EP-PRM-78.
 18792     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 18793     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 18794
 18795     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 18796     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 18797     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 18798
 18799     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 18800
 18801     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 18802     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 18803     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 18804
 18805     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 18806     MOVE ZEROS                         TO EP-CLM-PV.
 18807
 18808     IF EP-RCD-TYPE = 'A' OR 'U'
 18809         IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 18810             PERFORM 4599A-CALC-IBNR THRU 4599A-CALC-EXIT.
 18811
 18812     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 18813
 18814     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 18815     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 18816
 18817     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 18818
 18819     IF EW-ISS-CNT = ZERO
 18820         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 18821                                           EP-AVG-AGE
 18822       ELSE
 18823         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 18824                                EW-ORIG-TERM / EW-ISS-CNT
 18825         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 18826
 18827     IF EW-INFORCE-CNT = ZERO
 18828         MOVE ZERO                      TO EP-AVG-REM-TERM
 18829       ELSE
 18830         COMPUTE EP-AVG-REM-TERM ROUNDED =
 18831                             EW-REM-TERM / EW-INFORCE-CNT.
 18832
 18833     IF EW-ISS-BEN = ZERO
 18834         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 18835                                           EP-WEIGHTED-AGE
 18836       ELSE
 18837         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 18838                                  EW-TERM-BEN / EW-ISS-BEN
 18839         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 18840                                   EW-AGE-BEN / EW-ISS-BEN.
 18841
 18842     MOVE ZEROS                         TO
 18843         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 18844         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 360
* ECS010D.cbl
 18845
 18846     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 18847                                           WS-EP-HI-COV-DT-N.
 18848     MOVE HIGH-CERT                     TO EP-HI-CERT
 18849                                           WS-EP-HI-CERT-N.
 18850     MOVE LOW-CERT                      TO EP-LO-CERT
 18851                                           WS-EP-LO-CERT-N.
 18852     IF DTE-PGM-OPT = '3'
 18853         MOVE 'P'                       TO EP-PURGE.
 18854
 18855     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 18856         GO TO 4514-CONTINUE.
 18857
 18858     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 18859
 18860     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 18861         MOVE +1                 TO EP-LIFE-YEARS
 18862     ELSE
 18863         MOVE ZEROS              TO W-LIFE-YEARS
 18864         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 18865                 VARYING
 18866             SUBM FROM +1 BY +1
 18867                 UNTIL
 18868             SUBM GREATER THAN +13
 18869         COMPUTE W-LIFE-YEARS-INT ROUNDED
 18870             = W-LIFE-YEARS / 12
 18871             - (EPEC-LIFE-CTR (SUB2 1)
 18872             + EPEC-LIFE-CTR (SUB2 13)) / 24
 18873         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 18874         IF  EP-LIFE-YEARS LESS THAN +1
 18875             MOVE +1             TO EP-LIFE-YEARS.
 18876
 18877 4514-CONTINUE.
 18878
 18879     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4999-WRT-SUMMARY-X.
 18880
 18881     MOVE SPACES                        TO EC-RECORD.
 18882     MOVE '1'                           TO WS-SEQ-NBR.
 18883     MOVE +0                            TO SUB3.
 18884     MOVE +0                            TO SUB4.
 18885     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 18886         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 18887         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 18888
 18889     GO TO 4518-BUILD-EPEC-RCD-X.
 18890
 18891 4515-DETERMINE-LIFE-YEARS.
 18892
 18893     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 18894
 18895 4515-EXIT.
 18896     EXIT.
 18897
 18898 4518-BUILD-EPEC-RCD-X.
 18899     EXIT.
 18900
 18901 4519-BUILD-EPEC-EXT-X.
 18902     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 361
* ECS010D.cbl
 18903
 18904 4520-BUILD-EPEC-LOAD-COMM.
 18905
 18906     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 18907
 18908     ADD +1 TO SUB3  SUB4.
 18909     MOVE ZEROS                  TO LEVELS-BUILT.
 18910
 18911 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18912
 18913     IF SUB4 GREATER THAN WS-LOOP-MAX
 18914         IF AGT-SW = 'X'
 18915             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18916                 THRU 4999-WRT-SUMMARY-X
 18917             MOVE ' '            TO AGT-SW
 18918             MOVE WS-LOOP-MAX    TO  SUB4
 18919             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 18920         ELSE
 18921             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 18922
 18923     IF LEVELS-BUILT EQUAL +5
 18924         IF AGT-SW = 'X'
 18925             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18926                 THRU 4999-WRT-SUMMARY-X
 18927             MOVE ' '            TO AGT-SW
 18928             MOVE ZEROS          TO LEVELS-BUILT
 18929             ADD 1 TO WS-SEQ-NBR
 18930             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 18931             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 18932                     4540-BUILD-CLEAR-X
 18933                 VARYING SUB3 FROM +1 BY +1
 18934                 UNTIL SUB3 GREATER THAN +5
 18935             MOVE +1             TO SUB3
 18936             GO TO 4531-BUILD-EPEC-LOAD-COMM
 18937         ELSE
 18938             MOVE +1             TO SUB3
 18939             MOVE ZEROS          TO LEVELS-BUILT
 18940             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 18941
 18942     IF SUB4 GREATER THAN WS-LOOP-MAX
 18943         IF AGT-SW = 'X'
 18944             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18945                 THRU 4999-WRT-SUMMARY-X
 18946             MOVE ' '                   TO AGT-SW
 18947             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 18948         ELSE
 18949             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 18950
 18951 4531-BUILD-EPEC-LOAD-COMM.
 18952
 18953     IF (EW-AGT-NO (SUB4) = SPACES)
 18954                  OR
 18955        ((EW-ISS-COM (SUB4) = ZEROS) AND
 18956         (EW-CNC-COM (SUB4) = ZEROS) AND
 18957         (EW-ECR-R78 (SUB4) = ZEROS) AND
 18958         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 18959         (EW-ECR-PRO (SUB4) = ZEROS) AND
 18960         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 362
* ECS010D.cbl
 18961         (EW-ECR-ST (SUB4) = ZEROS))
 18962         PERFORM 4540-BUILD-EPEC-CLEAR
 18963             THRU 4540-BUILD-CLEAR-X
 18964         ADD +1 TO SUB4
 18965         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18966
 18967     MOVE 'X'                           TO AGT-SW.
 18968     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 18969     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 18970     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 18971     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 18972     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 18973     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 18974     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 18975     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 18976     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 18977
 18978     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 18979
 18980     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18981
 18982 4539-BUILD-EPEC-LOAD-COMM-X.
 18983     EXIT.
 18984
 18985 4540-BUILD-EPEC-CLEAR.
 18986
 18987     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 18988     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 18989     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 18990                                           EC-CNC-COMM (SUB3)
 18991                                           EC-COMM-78 (SUB3)
 18992                                           EC-COMM-PR (SUB3)
 18993                                           EC-COMM-ST (SUB3)
 18994                                           EC-COMM-78-ADJ (SUB3)
 18995                                           EC-COMM-PR-ADJ (SUB3).
 18996
 18997 4540-BUILD-CLEAR-X.
 18998     EXIT.
 18999
 19000 4541-CALC-IBNR.
 19001
 19002     MOVE +0                    TO TOT-AH-IBNR
 19003                                   TOT-AH-PRM
 19004                                   TOT-AH-PD-CLMS
 19005                                   TOT-AH-CLMRSV
 19006                                   TOT-LF-IBNR
 19007                                   TOT-LF-PRM
 19008                                   TOT-LF-PD-CLMS
 19009                                   TOT-LF-CLMRSV
 19010
 19011     MOVE +0                    TO RTOT-AH-IBNR
 19012                                   RTOT-AH-PRM
 19013                                   RTOT-AH-PD-CLMS
 19014                                   RTOT-AH-CLMRSV
 19015                                   RTOT-LF-IBNR
 19016                                   RTOT-LF-PRM
 19017                                   RTOT-LF-PD-CLMS
 19018                                   RTOT-LF-CLMRSV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 363
* ECS010D.cbl
 19019
 19020     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 19021        (SUB2 > +900)
 19022        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 19023*       IF W-UNDERWRITTEN-DATA
 19024*          MOVE EPEC-LEVELS-II (SUB2)
 19025*                                TO EPEC-WORK
 19026*       ELSE
 19027           MOVE EPEC-LEVELS (SUB2)
 19028                                 TO EPEC-WORK
 19029*       END-IF
 19030        IF EW-REIN-CO = SPACES
 19031           IF EW-LF-AH = 'L'
 19032              COMPUTE TOT-LF-PRM = TOT-LF-PRM
 19033                 + EW-EPR-ST
 19034              COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 19035                 + EW-CLM-AMT
 19036              COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 19037                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 19038           ELSE
 19039              COMPUTE TOT-AH-PRM = TOT-AH-PRM
 19040                 + EW-EPR-ST
 19041              COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 19042                 + EW-CLM-AMT
 19043              COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 19044                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 19045        ELSE
 19046           IF EW-LF-AH = 'L'
 19047              COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 19048                 + EW-EPR-ST
 19049              COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 19050                 + EW-CLM-AMT
 19051              COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 19052                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 19053           ELSE
 19054              COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 19055                 + EW-EPR-ST
 19056              COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
 19057                 + EW-CLM-AMT
 19058              COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 19059                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 19060           END-IF
 19061        END-IF
 19062     END-PERFORM
 19063
 19064     COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 19065        - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 19066     IF TOT-AH-IBNR < ZEROS
 19067        COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 19068     END-IF
 19069     COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 19070        - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 19071     IF TOT-LF-IBNR < ZEROS
 19072        COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 19073     END-IF
 19074
 19075     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 19076        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 364
* ECS010D.cbl
 19077     IF RTOT-AH-IBNR < ZEROS
 19078        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 19079     END-IF
 19080     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 19081        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 19082     IF RTOT-LF-IBNR < ZEROS
 19083        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 19084     END-IF
 19085
 19086     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 19087        (SUB2 > +900)
 19088        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 19089*       IF W-UNDERWRITTEN-DATA
 19090*          MOVE EPEC-LEVELS-II (SUB2)
 19091*                                TO EPEC-WORK
 19092*       ELSE
 19093           MOVE EPEC-LEVELS (SUB2)
 19094                                 TO EPEC-WORK
 19095*       END-IF
 19096        IF EW-REIN-CO = SPACES
 19097           IF EW-LF-AH = 'L'
 19098              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 19099                 / TOT-LF-PRM
 19100              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 19101                 * RTOT-LF-IBNR
 19102*                * TOT-LF-IBNR
 19103           ELSE
 19104              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 19105                 / TOT-AH-PRM
 19106              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 19107                 * RTOT-AH-IBNR
 19108*                * TOT-AH-IBNR
 19109           END-IF
 19110        ELSE
 19111           IF EW-LF-AH = 'L'
 19112              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 19113                 / RTOT-LF-PRM
 19114              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 19115                 * RTOT-LF-IBNR
 19116           ELSE
 19117              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 19118                 / RTOT-AH-PRM
 19119              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 19120                 * RTOT-AH-IBNR
 19121           END-IF
 19122        END-IF
 19123*       IF W-UNDERWRITTEN-DATA
 19124*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 19125*       ELSE
 19126           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 19127*       END-IF
 19128     END-PERFORM
 19129
 19130     .
 19131 4541-EXIT.
 19132     EXIT.
 19133
 19134 4545-BUILD-BASE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 365
* ECS010D.cbl
 19135
 19136     MOVE 'EC'                   TO EC-RECORD-ID.
 19137     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 19138     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 19139     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 19140     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 19141                                    WS-EC-EFF-DTE.
 19142     MOVE EW-REIN-CO             TO EC-REI-CO.
 19143     IF EC-REI-CO NOT = SPACES
 19144         MOVE 'R'                TO EC-REIN.
 19145     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 19146     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 19147     IF DTE-PGM-OPT = '3'
 19148         MOVE 'P'                TO EC-PURGE.
 19149     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 19150
 19151 4545-BUILD-BASE-X.
 19152     EXIT.
 19153
 19154******************************************************************
 19155***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 19156******************************************************************
 19157
 19158 4550-CLEAR-EPEC-TOTALS.
 19159
 19160     MOVE LOW-CERT             TO SV-LO-CERT.
 19161     MOVE HIGH-CERT            TO SV-HI-CERT.
 19162     MOVE SPACES               TO LOW-CTL.
 19163     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 19164
 19165     MOVE +1                   TO SUB9.
 19166     MOVE +0                   TO SUB10.
 19167     MOVE ZERO                 TO EW-REIN-CO
 19168                                  EW-BEN-TYPE.
 19169     MOVE SPACE                TO EP-FLG
 19170                                  EW-LF-AH
 19171                                  EW-LEVEL-USED
 19172                                  W-TABLE-USED-SW.
 19173
 19174     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 19175                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 19176                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 19177                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 19178                                  EW-EPR-R78     EW-EPR-R78-ADJ
 19179                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 19180                                  EW-EPR-ST      EW-EPR-ST-ADJ
 19181                                  EW-CLM-AMT     EW-COV-DTE
 19182                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 19183                                  EW-CLM-FUTRSV  EW-CLM-CNT
 19184                                  EW-CLM-CRT     EW-ISS-CNT
 19185                                  EW-CNC-CNT     EW-AGE
 19186                                  EW-ORIG-TERM   EW-INFORCE-CNT
 19187                                  EW-AGE-BEN     EW-TERM-BEN
 19188                                  EW-ISS-PRM-TAX
 19189                                  EW-REM-TERM.
 19190
 19191     MOVE +1 TO SUB1.
 19192     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 366
* ECS010D.cbl
 19193     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 19194         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 19195     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 19196                                    EPEC-UNDW-OPT-DATA-TABLE.
 19197     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 19198         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 19199
 19200     PERFORM 4590-INIT-OB THRU 4590-EXIT
 19201         VARYING SUB3 FROM +1 BY +1
 19202*        UNTIL SUB3 GREATER THAN +300.
 19203*        UNTIL SUB3 GREATER THAN +220.
 19204         UNTIL SUB3 GREATER THAN +900.
 19205
 19206     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 19207
 19208 4555-CLEAR-EPEC-COMM.
 19209
 19210     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 19211                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 19212                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 19213                EW-ECR-ST  (SUB1).
 19214     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 19215                                    EW-AGT-TYPE (SUB1).
 19216
 19217     ADD +1 TO SUB1.
 19218
 19219 4560-CLEAR-EPEC-ALL.
 19220
 19221     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 19222                                    EPEC-LEVELS-II (SUB1).
 19223     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 19224
 19225 4570-CLEAR-EPEC-SUB-A.
 19226
 19227     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 19228     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 19229*        UNTIL SUB2 GREATER +300.
 19230         UNTIL SUB2 GREATER +900.
 19231
 19232 4580-CLEAR-EPEC-SUB-B.
 19233
 19234     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 19235     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 19236
 19237 4589-CLEAR-EPEC-TOTALS-X.
 19238     EXIT.
 19239
 19240 4590-INIT-OB.
 19241
 19242     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 19243     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 19244     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 19245
 19246 4590-EXIT.
 19247     EXIT.
 19248
 19249 4599-BUILD-EPEC-EXTRACT-X.
 19250     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 367
* ECS010D.cbl
 19251
 19252*********************************************************
 19253*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 19254*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 19255*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 19256*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 19257*  IN THE DATE CARD.                                    *
 19258*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 19259*********************************************************
 19260
 19261 4599A-CALC-IBNR.
 19262
 19263     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 19264        (((EP-PRM-78 + EP-PRM-78-ADJ)
 19265                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 19266         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 19267                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 19268                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 19269
 19270     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 19271         MOVE ZEROS                 TO EW-CLM-IBNR
 19272         GO TO 4599A-CALC-EXIT.
 19273
 19274     IF EP-REIN = 'R'
 19275         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 19276
 19277     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 19278
 19279 4599A-CALC-EXIT.
 19280      EXIT.
 19281 4599B-SEARCH.
 19282      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 368
* ECS010D.cbl
 19284******************************************************************
 19285***         CALCULATE OPTIONAL METHOD I B N R                  ***
 19286******************************************************************
 19287
 19288 4600-GET-OPT-IBNR.
 19289
 19290     IF  CR-POLICY-IS-ACTIVE
 19291         IF  CR-POLICY-IS-REISSUE
 19292             OR CR-POLICY-IS-MONTHLY
 19293             IF  W-LIFE
 19294                 GO TO 4600-EXIT
 19295             ELSE
 19296                 NEXT SENTENCE
 19297         ELSE
 19298             NEXT SENTENCE
 19299     ELSE
 19300         IF  W-LIFE
 19301             GO TO 4600-EXIT.
 19302
 19303     IF  W-LIFE
 19304         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 19305     ELSE
 19306         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 19307
 19308 4600-EXIT.
 19309     EXIT.
 19310
 19311 4620-DETERMINE-LIFE-IBNR.
 19312
 19313     IF  CR-LF-POLICY-IS-ACTIVE
 19314         ADD +1                  TO W-LF-ACTIVE
 19315         IF  CR-LF-POLICY-IS-REISSUE
 19316             OR CR-LF-POLICY-IS-MONTHLY
 19317             MOVE ZEROS          TO W-WK-IBNR
 19318             ADD +1              TO W-LF-REISSUE
 19319             GO TO 4620-EXIT
 19320         ELSE
 19321             NEXT SENTENCE
 19322     ELSE
 19323         ADD +1                  TO W-LF-INACTIVE
 19324         MOVE ZEROS              TO W-WK-IBNR
 19325         GO TO 4620-EXIT.
 19326
 19327     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 19328         MOVE ZEROS              TO W-WK-IBNR
 19329         ADD +1                  TO W-LF-CALC-B
 19330         GO TO 4620-EXIT.
 19331
 19332     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 19333                 AND
 19334             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19335                 AND
 19336             W-BAL-REMTRM NOT GREATER THAN ZERO)
 19337             OR
 19338         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 19339                 AND
 19340             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 19341                 AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 369
* ECS010D.cbl
 19342             REM-TRM2 NOT GREATER THAN ZERO)
 19343         MOVE ZEROS              TO W-WK-IBNR
 19344         ADD +1                  TO W-LF-BALLOON
 19345         GO TO 4620-EXIT
 19346     ELSE
 19347         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19348                 AND
 19349             REM-TRM2 NOT GREATER THAN ZERO)
 19350             ADD +1              TO W-LF-REMTERM-0
 19351             MOVE ZEROS          TO W-WK-IBNR
 19352             GO TO 4620-EXIT.
 19353
 19354     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 19355
 19356     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 19357         ADD +1                  TO W-LF-REMAMT-0
 19358         MOVE ZEROS              TO W-WK-IBNR
 19359         GO TO 4620-EXIT.
 19360
 19361     IF  AM-LIFE-IBNR-PCT NUMERIC
 19362             AND
 19363         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 19364         COMPUTE W-WK-IBNR ROUNDED
 19365             = CP-REMAINING-AMT
 19366             / 1000
 19367             * AM-LIFE-IBNR-PCT
 19368     ELSE
 19369         COMPUTE W-WK-IBNR ROUNDED
 19370             = CP-REMAINING-AMT
 19371             / 1000
 19372             * COMPANY-IBNR-LIFE-FACTOR.
 19373
 19374     IF  CR-LF-IS-REIN-ONLY
 19375         ADD +1                  TO W-LF-REIN
 19376     ELSE
 19377         ADD +1                  TO W-LF-DATA-USED
 19378         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 19379         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 19380         IF  CR-LFTYP = '01'
 19381             ADD CP-REMAINING-AMT
 19382                                 TO W-01-REMAMT
 19383             ADD +1              TO W-01-DATA-USED
 19384         ELSE
 19385         IF  CR-LFTYP = '02'
 19386             ADD CP-REMAINING-AMT
 19387                                 TO W-02-REMAMT
 19388             ADD +1              TO W-02-DATA-USED
 19389         ELSE
 19390         IF  CR-LFTYP = '03'
 19391             ADD CP-REMAINING-AMT
 19392                                 TO W-03-REMAMT
 19393             ADD +1              TO W-03-DATA-USED
 19394         ELSE
 19395         IF  CR-LFTYP = '04'
 19396             ADD CP-REMAINING-AMT
 19397                                 TO W-04-REMAMT
 19398             ADD +1              TO W-04-DATA-USED
 19399         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 370
* ECS010D.cbl
 19400         IF  CR-LFTYP = '05'
 19401             ADD CP-REMAINING-AMT
 19402                                 TO W-05-REMAMT
 19403             ADD +1              TO W-05-DATA-USED
 19404         ELSE
 19405         IF  CR-LFTYP = '06'
 19406             ADD CP-REMAINING-AMT
 19407                                 TO W-06-REMAMT
 19408             ADD +1              TO W-06-DATA-USED
 19409         ELSE
 19410         IF  CR-LFTYP = '30'
 19411             ADD CP-REMAINING-AMT
 19412                                 TO W-30-REMAMT
 19413             ADD +1              TO W-30-DATA-USED
 19414         ELSE
 19415         IF  CR-LFTYP = '31'
 19416             ADD CP-REMAINING-AMT
 19417                                 TO W-31-REMAMT
 19418             ADD +1              TO W-31-DATA-USED
 19419         ELSE
 19420             ADD CP-REMAINING-AMT
 19421                                 TO W-XX-REMAMT
 19422             ADD +1              TO W-XX-DATA-USED.
 19423
 19424     IF  CR-POLICY-IS-REIN-ONLY
 19425             OR
 19426         CR-LF-IS-REIN-ONLY
 19427         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 19428         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 19429         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 19430     ELSE
 19431         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 19432
 19433 4620-EXIT.
 19434     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 371
* ECS010D.cbl
 19436 4640-GET-A-H-EARNED-PREMIUM.
 19437
 19438     IF  CR-AH-POLICY-IS-ACTIVE
 19439         ADD +1                  TO W-AH-ACTIVE
 19440         IF  CR-AH-POLICY-IS-REISSUE
 19441             OR CR-AH-POLICY-IS-MONTHLY
 19442             ADD +1              TO W-AH-REISSUE
 19443         ELSE
 19444             NEXT SENTENCE
 19445     ELSE
 19446         ADD +1                  TO W-AH-INACTIVE.
 19447
 19448     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19449         ADD +1                  TO W-AH-CALC-B
 19450         GO TO 4640-EXIT.
 19451
 19452     IF  REM-TRM2 NOT GREATER THAN ZEROS
 19453         MOVE 'Y'                TO W-RTRM-0-SW
 19454     ELSE
 19455         MOVE SPACES             TO W-RTRM-0-SW.
 19456
 19457     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 19458
 19459****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 19460******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 19461******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 19462******        THAT CLAIM.
 19463
 19464     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 19465
 19466     IF  CR-POLICY-IS-REIN-ONLY
 19467              OR
 19468         CR-AH-IS-REIN-ONLY
 19469         ADD +1                  TO W-AH-REIN
 19470         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 19471         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 19472         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 19473         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 19474         GO TO 4640-EXIT.
 19475
 19476     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 19477                                    W-EPEC-EP-IN.
 19478     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 19479                                    W-CLAIMS-MADE-PAID-IN.
 19480     ADD +1                      TO W-AH-DATA-USED.
 19481     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 19482     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 19483
 19484     IF  W-CLMAMT GREATER THAN ZEROS
 19485         ADD +1                  TO W-AH-CLAIM-CTR
 19486         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 19487
 19488     IF  W-RTRM-0
 19489             AND
 19490         NOT CR-POLICY-IS-REIN-ONLY
 19491             AND
 19492         NOT CR-AH-IS-REIN-ONLY
 19493         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 372
* ECS010D.cbl
 19494         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 19495         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 19496         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 19497         ADD +1                  TO W-AH-REMTERM-0.
 19498
 19499 4640-EXIT.
 19500     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 373
* ECS010D.cbl
 19502 4650-DETERMINE-CLM-AMT-AH.
 19503
 19504     MOVE ZEROS                  TO W-CLMAMT.
 19505
 19506     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 19507             OR
 19508         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 19509         GO TO 4650-EXIT.
 19510
 19511     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 19512             AND
 19513         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 19514         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 19515         MOVE 'L'                    TO DC-OPTION-CODE
 19516         PERFORM 8000-DATE-CONVERT-ROUTINE
 19517             THRU 8099-DATE-CONVERT-X
 19518         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 19519         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 19520         MOVE 'L'                    TO DC-OPTION-CODE
 19521         PERFORM 8000-DATE-CONVERT-ROUTINE
 19522             THRU 8099-DATE-CONVERT-X
 19523         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 19524         IF  DATE-CONVERSION-ERROR
 19525             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 19526             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 19527             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 19528             MOVE 0303               TO WS-ABEND-CODE
 19529             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 19530             GO TO ABEND-PGM
 19531         ELSE
 19532             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 19533             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 19534             MOVE '1'                TO DC-OPTION-CODE
 19535             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 19536                                        DC-ELAPSED-DAYS
 19537             PERFORM 8000-DATE-CONVERT-ROUTINE
 19538                 THRU 8099-DATE-CONVERT-X
 19539             IF  DATE-CONVERSION-ERROR
 19540                 DISPLAY 'DIS TO PTO DATE ERROR '
 19541                     CR-FULL-CONTROL
 19542                 MOVE 'DIS TO PTO DATE ERROR '
 19543                                     TO WS-ABEND-MESSAGE
 19544                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 19545                 MOVE 0303           TO WS-ABEND-CODE
 19546                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 19547                 GO TO ABEND-PGM
 19548             ELSE
 19549                 COMPUTE W-CLMAMT ROUNDED
 19550                     = CR-AHAMT
 19551                     * (DC-ELAPSED-DAYS / 30)
 19552                 GO TO 4650-EXIT.
 19553
 19554     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 19555             OR
 19556         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 19557         GO TO 4650-EXIT.
 19558
 19559     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 374
* ECS010D.cbl
 19560         = CR-AHAMT * 3.
 19561
 19562     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 19563         MOVE CR-DISAMT          TO W-CLMAMT
 19564     ELSE
 19565         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 19566
 19567     IF  NOT CR-POLICY-IS-REIN-ONLY
 19568              AND
 19569         NOT CR-AH-IS-REIN-ONLY
 19570         ADD +1          TO W-CLM-EXCEPT-CNT
 19571         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 19572
 19573 4650-EXIT.
 19574     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 375
* ECS010D.cbl
 19576 4660-DETERMINE-EARNED-PREMIUM.
 19577
 19578     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 19579
 19580     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 19581
 19582     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 19583
 19584     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 19585         MOVE ZEROS              TO W-EARNED-PREMIUM
 19586         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 19587         MOVE '7'                TO W-VAL-SOURCE
 19588         PERFORM 8500-REMAINING-TERM-ROUTINE
 19589             THRU 8599-REM-TERM-X
 19590         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 19591         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 19592         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 19593         MOVE EPR-R78            TO W-OPT-R78
 19594         MOVE EPR-PRO            TO W-OPT-PRO
 19595         MOVE EPR-ST             TO W-OPT-ST
 19596         PERFORM 4670-CALC-EP THRU 4670-EXIT
 19597         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 19598     ELSE
 19599         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 19600
 19601     COMPUTE W-EARNED-PREMIUM ROUNDED
 19602         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 19603
 19604     IF  W-EARNED-PREMIUM LESS THAN ZERO
 19605         ADD +1                  TO W-EP-LESS-THAN-0
 19606         MOVE ZERO               TO W-EARNED-PREMIUM.
 19607
 19608 4660-EXIT.
 19609     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 376
* ECS010D.cbl
 19611 4666-SAVE-AHCR-DATA.
 19612
 19613     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 19614                                    WX-STATUS-AT-SETTLEMENT.
 19615
 19616     MOVE ZEROS                  TO WX-CANC-DT
 19617                                    WX-EOM-RUN-DATE
 19618                                    WX-SETTLEMENT-EXIT-DATE.
 19619
 19620     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 19621         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 19622         MOVE CR-AH-STATUS-AT-CANCEL
 19623                                 TO WX-STATUS-AT-CANCEL
 19624         MOVE ZEROS              TO CR-AH-CANC-DT
 19625                                    WS-CR-AH-CANC-DT-N
 19626         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 19627
 19628     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 19629         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 19630                                 TO WX-SETTLEMENT-EXIT-DATE
 19631         MOVE CR-AH-STATUS-AT-SETTLEMENT
 19632                                 TO WX-STATUS-AT-SETTLEMENT
 19633         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 19634                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 19635         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 19636
 19637     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 19638     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 19639
 19640 4666-EXIT.
 19641     EXIT.
 19642
 19643 4668-RESTORE-AHCR-DATA.
 19644
 19645     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 19646         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 19647                                    WS-CR-AH-CANC-DT-N
 19648         MOVE WX-STATUS-AT-CANCEL
 19649                                 TO CR-AH-STATUS-AT-CANCEL.
 19650
 19651     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 19652         MOVE WX-SETTLEMENT-EXIT-DATE
 19653                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 19654                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 19655         MOVE WX-STATUS-AT-SETTLEMENT
 19656                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 19657
 19658     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 19659
 19660 4668-EXIT.
 19661     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 377
* ECS010D.cbl
 19663 4670-CALC-EP.
 19664
 19665     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 19666         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 19667         ADD W-EARNED-PREMIUM    TO W-WY-EP
 19668         GO TO 4670-EXIT.
 19669
 19670     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 19671         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 19672         ADD W-EARNED-PREMIUM    TO W-VA-EP
 19673         GO TO 4670-EXIT.
 19674
 19675***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 19676
 19677     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 19678         COMPUTE W-EARNED-PREMIUM
 19679             = (W-OPT-PRO + W-OPT-R78) / +2
 19680         ADD W-EARNED-PREMIUM    TO W-M-EP
 19681     ELSE
 19682         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 19683             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 19684             ADD W-EARNED-PREMIUM
 19685                                 TO W-R-EP
 19686         ELSE
 19687             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 19688                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 19689                 ADD W-EARNED-PREMIUM
 19690                                 TO W-P-EP
 19691             ELSE
 19692                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 19693                     COMPUTE W-EARNED-PREMIUM ROUNDED
 19694                         = (W-OPT-PRO * +.6667)
 19695                         + (W-OPT-R78 * +.3333)
 19696                     ADD W-EARNED-PREMIUM
 19697                                 TO W-1-EP
 19698                 ELSE
 19699                     ADD +1      TO W-OTHERS-COUNT
 19700                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 19701
 19702 4670-EXIT.
 19703     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 378
* ECS010D.cbl
 19705 4680-CALC-REMAINING-AMT-LF.
 19706
 19707     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 19708     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 19709     MOVE CR-APR                 TO CP-LOAN-APR.
 19710     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 19711
 19712     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 19713         MOVE +1                 TO CR-PMT-FREQ.
 19714
 19715     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 19716
 19717     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 19718     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 19719                                    CP-RATING-BENEFIT-AMT.
 19720     IF CP-STATE-STD-ABBRV = 'OR'
 19721         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 19722     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 19723     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 19724     MOVE ZEROS                  TO CP-REMAINING-AMT
 19725                                    CP-REMAINING-AMT-PRV
 19726                                    CP-RETURN-CODE
 19727                                    CP-RETURN-CODE-2.
 19728
 19729
 19730     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 19731
 19732     IF  CP-RETURN-CODE NOT = ZERO
 19733         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 19734                             TO WS-ABEND-MESSAGE
 19735         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 19736         MOVE 2001           TO WS-ABEND-CODE
 19737         GO TO ABEND-PGM.
 19738
 19739 4680-EXIT.
 19740     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 379
* ECS010D.cbl
 19742******************************************************************
 19743***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 19744******************************************************************
 19745
 19746 4700-CALC-OPT-IBNR.
 19747
 19748     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19749     MOVE SPACE                  TO W-UNDERWRITING-SW.
 19750
 19751     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 19752             VARYING
 19753         SUB2 FROM +1 BY +1
 19754             UNTIL
 19755*        SUB2 GREATER THAN 300.
 19756*        SUB2 GREATER THAN 220.
 19757         SUB2 GREATER THAN 900.
 19758
 19759     MOVE EPEC-UNDW-OPT-DATA-TABLE
 19760                                 TO EPEC-OPT-WORK-TABLE.
 19761     MOVE '*'                    TO W-UNDERWRITING-SW.
 19762
 19763     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 19764             VARYING
 19765         SUB2 FROM +1 BY +1
 19766             UNTIL
 19767*        SUB2 GREATER THAN 300.
 19768*        SUB2 GREATER THAN 220.
 19769         SUB2 GREATER THAN 900.
 19770
 19771 4700-EXIT.
 19772     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 380
* ECS010D.cbl
 19774 4710-PROCESS-THRU-EPEC-TABLE.
 19775
 19776     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 19777         GO TO 4710-EXIT.
 19778
 19779     IF  W-UNDERWRITTEN-DATA
 19780         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 19781     ELSE
 19782         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 19783
 19784     IF EW-LEVEL-USED NOT = 'Y'
 19785         GO TO 4710-EXIT.
 19786
 19787     IF  EW-REIN-CO GREATER THAN SPACES
 19788         MOVE 'Y'                TO W-REIN-PROCESS-SW
 19789         IF  EPEC-REIN-ONLY-DATA (SUB2)
 19790             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 19791             IF  W-WK-IBNR GREATER THAN ZEROS
 19792                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 19793                 GO TO 4710-EXIT
 19794             ELSE
 19795                 GO TO 4710-EXIT
 19796         ELSE
 19797             IF  EW-CLM-IBNR GREATER THAN ZEROS
 19798                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 19799                 GO TO 4710-EXIT
 19800             ELSE
 19801                 GO TO 4710-EXIT.
 19802
 19803     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 19804
 19805     IF  EW-LF-AH EQUAL 'L'
 19806         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 19807             GO TO 4710-EXIT
 19808         ELSE
 19809             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 19810             ADD W-WK-IBNR       TO W-LIFE-IBNR
 19811     ELSE
 19812         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 19813                 GREATER THAN ZEROS
 19814             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 19815             ADD W-WK-IBNR       TO W-AH-IBNR
 19816         ELSE
 19817             GO TO 4710-EXIT.
 19818
 19819     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 19820     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 19821     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 19822
 19823     IF  W-UNDERWRITTEN-DATA
 19824         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 19825     ELSE
 19826         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 19827
 19828
 19829     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 19830     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 19831
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 381
* ECS010D.cbl
 19832 4710-EXIT.
 19833     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 382
* ECS010D.cbl
 19835 4720-PROCESS-LIFE.
 19836
 19837     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 19838
 19839 4720-EXIT.
 19840     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 383
* ECS010D.cbl
 19842 4730-PROCESS-A-H.
 19843
 19844     IF  AM-TARGET-LOSS-RATIO NUMERIC
 19845             AND
 19846         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 19847         MOVE AM-TARGET-LOSS-RATIO
 19848                                 TO W-TARGET-LOSS-RATIO
 19849     ELSE
 19850         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 19851             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 19852                                 TO W-TARGET-LOSS-RATIO
 19853             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 19854
 19855     IF  W-NOT-REIN-PROCESS
 19856         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 19857         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 19858
 19859     COMPUTE W-IBNR-1 ROUNDED
 19860         = EPEC-EARNED-PREMIUM-AH (SUB2)
 19861         * COMPANY-IBNR-AH-FACTOR
 19862         * W-TARGET-LOSS-RATIO.
 19863
 19864     COMPUTE W-IBNR-2 ROUNDED
 19865         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 19866         * W-TARGET-LOSS-RATIO)
 19867         - EPEC-CLAIMS-MADE-PAID (SUB2).
 19868
 19869     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 19870         MOVE W-IBNR-1           TO W-WK-IBNR
 19871         IF  W-NOT-REIN-PROCESS
 19872             ADD +1              TO W-AH-IBNR-1-CNT
 19873             ADD W-IBNR-1        TO W-AH-IBNR-1
 19874         ELSE
 19875             NEXT SENTENCE
 19876     ELSE
 19877         MOVE W-IBNR-2           TO W-WK-IBNR
 19878         IF  W-NOT-REIN-PROCESS
 19879             ADD +1              TO W-AH-IBNR-2-CNT
 19880             ADD W-IBNR-2        TO W-AH-IBNR-2.
 19881
 19882 4730-EXIT.
 19883     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 384
* ECS010D.cbl
 19885 4735-GET-BUSINESS-ADJUSTMENT.
 19886
 19887     IF  CR-GRPTYP NOT NUMERIC
 19888         MOVE '99'               TO INDEXBS
 19889     ELSE
 19890         MOVE CR-GRPTYP          TO INDEXBS.
 19891
 19892     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 19893             AND
 19894         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 19895             NOT EQUAL ZEROS
 19896             AND
 19897         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 19898             NOT EQUAL +1.0000
 19899         MOVE INDEXBS           TO W-EDIT-7
 19900         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 19901             = W-TARGET-LOSS-RATIO
 19902             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 19903
 19904 4735-EXIT.
 19905     EXIT.
 19906
 19907 4740-CREATE-DETAIL-EXTR.
 19908
 19909     IF DTE-PGM-OPT NOT = '1'
 19910         GO TO 4740-EXIT.
 19911
 19912     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 19913         GO TO 4740-EXIT.
 19914
 19915     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 19916     MOVE ZEROS                  TO REPORTED-DATE
 19917                                    PAY-TO-DATE.
 19918
 19919     MOVE SPACES                 TO TR-DTL2.
 19920     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 19921
 19922     MOVE EOM-YR                 TO TRD-ISYR.
 19923     MOVE EOM-MO                 TO TRD-ISMO.
 19924     MOVE EOM-DA                 TO TRD-ISDA.
 19925     MOVE ZERO                   TO TRD-AGE.
 19926
 19927     IF  EW-LF-AH EQUAL 'L'
 19928         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 19929     ELSE
 19930         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 19931
 19932     MOVE SPACES                 TO TRD-PAYCURX
 19933                                    TRD-PAYCUR-SPACE
 19934                                    TRD-FUTRSV-SPACE
 19935                                    TRD-FUTRSVX.
 19936
 19937     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 19938     MOVE 'IBNR'                 TO TRD-IBNRX.
 19939     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 19940     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 19941
 19942     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 385
* ECS010D.cbl
 19943         IF  W-REIN-IN-PROCESS
 19944             MOVE ' ACCT/BEN REIN RSV UW'
 19945                                 TO TRD-RSV-ACTION
 19946         ELSE
 19947             MOVE ' ACCT/BEN RESERVES UW'
 19948                                 TO TRD-RSV-ACTION
 19949     ELSE
 19950         IF  W-REIN-IN-PROCESS
 19951             MOVE ' ACCT/BEN REIN RSV'
 19952                                 TO TRD-RSV-ACTION
 19953         ELSE
 19954             MOVE ' ACCT/BEN RESERVES'
 19955                                 TO TRD-RSV-ACTION.
 19956
 19957     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 19958
 19959     MOVE SPACES                 TO DETAIL-EXTRACT.
 19960
 19961     IF  W-REIN-IN-PROCESS
 19962         MOVE EW-REIN-CO         TO DE-REI-COMP
 19963         MOVE 'R'                TO DE-REIN
 19964         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 19965         MOVE ZEROS              TO DE-IBNR
 19966     ELSE
 19967         MOVE EW-CLM-IBNR        TO DE-IBNR
 19968         MOVE ZEROS              TO DE-REI-IBNR.
 19969
 19970     MOVE 'DE'                   TO DE-RECORD-ID.
 19971     MOVE 'Y'                    TO DE-TRANS.
 19972     MOVE 'IBNRRSV'              TO DE-CLMNO.
 19973     MOVE '1'                    TO DE-ENTRY-STATUS.
 19974     MOVE 'ACTBENIBNR'           TO DE-CERT.
 19975
 19976     MOVE EOM-RUN-DATE           TO DE-EFF
 19977                                    WS-DE-EFF-N
 19978                                    DE-ENTRY-DTE
 19979                                    WS-DE-ENTRY-DTE-N.
 19980     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 19981                                    WS-DE-RSV-INCUR-N.
 19982
 19983     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 19984     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 19985     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 19986                                    WS-DE-ACC-EXP-DTE-RSV-N.
 19987     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 19988                                    WS-DE-ACC-EFF-DTE-RSV-N.
 19989
 19990     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 19991     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 19992     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 19993     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 19994     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 19995     MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 19996     MOVE AM-IG                  TO DE-IG.
 19997
 19998     IF W-UNDERWRITTEN-DATA
 19999         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 20000     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 386
* ECS010D.cbl
 20001         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 20002
 20003     IF  EW-LF-AH EQUAL 'L'
 20004         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 20005         MOVE '1'                TO DE-RESERVE-TYPE
 20006         MOVE ZEROS              TO DE-AH-TYPE
 20007     ELSE
 20008         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 20009         MOVE '2'                TO DE-RESERVE-TYPE
 20010         MOVE ZEROS              TO DE-LF-TYPE.
 20011
 20012     MOVE SPACES                 TO DE-NAME
 20013                                    DE-ACC-GPCD
 20014                                    DE-AH-STAT-CDE
 20015                                    DE-LF-STAT-CDE
 20016                                    DE-MEMBER-NO
 20017                                    DE-NAME
 20018                                    DE-SEX.
 20019     MOVE ZEROS                  TO DE-AGE
 20020                                    DE-AH-BEN
 20021                                    DE-AH-CANC-DTE
 20022                                    WS-DE-AH-CANC-DTE-N
 20023                                    DE-AH-CANC-EXIT-DT
 20024                                    WS-DE-AH-CANC-EXIT-DT-N
 20025                                    DE-AH-PRM
 20026                                    DE-AH-RFND
 20027                                    DE-AH-TERM
 20028                                    DE-APR
 20029                                    DE-CANCEL-CNT-ITD
 20030                                    DE-CANCEL-CNT-YTD
 20031                                    DE-FUTRSV
 20032                                    DE-LF-BEN
 20033                                    DE-LF-BEN-ALT
 20034                                    DE-LF-CANC-DTE
 20035                                    WS-DE-LF-CANC-DTE-N
 20036                                    DE-LF-CANC-EXIT-DT
 20037                                    WS-DE-LF-CANC-EXIT-DT-N
 20038                                    DE-LF-CNBEN
 20039                                    DE-LF-CNBEN-ALT
 20040                                    DE-LF-PRM
 20041                                    DE-LF-PRM-ALT
 20042                                    DE-LF-RFND
 20043                                    DE-LF-TERM
 20044                                    DE-LIVES
 20045                                    DE-PAYCUR
 20046                                    DE-PMT-FREQ
 20047                                    DE-REI-AHAMT
 20048                                    DE-REI-AHPRM
 20049                                    DE-REI-AHRFND
 20050                                    DE-REI-CNAMT
 20051                                    DE-REI-FUTRSV
 20052                                    DE-REI-LFAMT
 20053                                    DE-REI-LFPRM
 20054                                    DE-REI-LFRFND
 20055                                    DE-REI-PAYCUR
 20056                                    DE-RSV-REPORTED
 20057                                    DE-RSV-PAYTO
 20058                                    WS-DE-RSV-PAYTO-N
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 387
* ECS010D.cbl
 20059                                    DE-MOB-NET-TOT-FEES
 20060                                    DE-SOC-SEC-NO.
 20061
 20062     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 20063
 20064     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 20065         THRU 2599-WRT-DETAIL-X.
 20066     ADD +1                      TO BC-G-CRS.
 20067
 20068 4740-EXIT.
 20069     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 388
* ECS010D.cbl
 20071 4750-UPDATE-REIN.
 20072
 20073     COMPUTE SUB3 = SUB2 + 1.
 20074
 20075     IF  W-UNDERWRITTEN-DATA
 20076         MOVE EPEC-SUB-KEY-II (SUB2)
 20077                                 TO W-SUB-KEY
 20078     ELSE
 20079         MOVE EPEC-SUB-KEY (SUB2)
 20080                                 TO W-SUB-KEY.
 20081
 20082     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 20083             VARYING
 20084         SUB3 FROM SUB3 BY +1
 20085             UNTIL
 20086         SUB3 GREATER THAN +900
 20087*        SUB3 GREATER THAN +220
 20088*        SUB3 GREATER THAN +300
 20089             OR
 20090         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 20091
 20092 4750-EXIT.
 20093     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 389
* ECS010D.cbl
 20095 4755-MATCH-REIN-EPEC.
 20096
 20097     IF  W-UNDERWRITTEN-DATA
 20098         MOVE EPEC-LEVELS-II (SUB3)
 20099                                 TO EPEC-WORK
 20100     ELSE
 20101         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 20102
 20103     IF  EPEC-LINE-NOT-USED (SUB3)
 20104         GO TO 4755-EXIT.
 20105
 20106     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 20107             OR
 20108         EW-REIN-CO EQUAL SPACES
 20109         GO TO 4755-EXIT.
 20110
 20111     IF  W-ISS-BEN GREATER THAN ZEROS
 20112         IF  EPEC-REIN-ONLY-DATA (SUB3)
 20113             COMPUTE W-FACTOR ROUNDED
 20114                 = (EW-ISS-BEN
 20115                 - EPEC-REIN-ISS-BEN (SUB3))
 20116                 / W-ISS-BEN
 20117         ELSE
 20118             COMPUTE W-FACTOR ROUNDED
 20119                 = EW-ISS-BEN
 20120                 / W-ISS-BEN.
 20121
 20122     COMPUTE EW-CLM-IBNR ROUNDED
 20123         = EW-CLM-IBNR
 20124         + (W-WK-IBNR * W-FACTOR).
 20125
 20126     IF  W-UNDERWRITTEN-DATA
 20127         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 20128     ELSE
 20129         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 20130
 20131 4755-EXIT.
 20132     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 390
* ECS010D.cbl
 20134 4760-PROCESS-REIN-ONLY.
 20135
 20136     MOVE ZEROS                  TO W-WK-IBNR.
 20137
 20138     IF  EPEC-LINE-NOT-USED (SUB2)
 20139         GO TO 4760-EXIT.
 20140
 20141     IF  EW-LF-AH EQUAL 'L'
 20142         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 20143             GO TO 4760-EXIT
 20144         ELSE
 20145             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 20146             ADD W-WK-IBNR       TO EW-CLM-IBNR
 20147     ELSE
 20148         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 20149             GO TO 4760-EXIT
 20150         ELSE
 20151             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 20152             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 20153
 20154 4760-EXIT.
 20155     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 391
* ECS010D.cbl
 20157 4770-CREATE-REIN-DETAIL.
 20158
 20159     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 20160     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20161
 20162 4770-EXIT.
 20163     EXIT.
 20164
 20165 4799-EXIT.
 20166     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 392
* ECS010D.cbl
 20168 4800-CALC-EARNED-PREMIUM-AH.
 20169
 20170     MOVE +0                         TO CNC-BEN  EPR-R78
 20171                                        ISS-PRM  EPR-PRO
 20172                                        CNC-PRM  EPR-ST
 20173                                        WX-CLM-AMT
 20174                                        WX-CLM-EXP
 20175                                        WX-CLM-CNT
 20176                                        WX-CLM-CRT
 20177                                        WX-CNC-CNT
 20178                                        ISS-PRMTAX
 20179                                        WX-ACTIVE-COUNT.
 20180     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 20181
 20182     MOVE WE-AHPRM TO ISS-PRM.
 20183
 20184     IF DTE-CLIENT = 'GIC'
 20185         IF REIN-EP-FLG NOT = 'R'  AND
 20186            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 20187            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 20188            MOVE CR-AHPRM-CALC TO ISS-PRM.
 20189
 20190     IF REIN-EP-FLG = 'R'  AND
 20191        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 20192         NEXT SENTENCE
 20193     ELSE
 20194         GO TO 4810-EP-DO-AH-CLM.
 20195
 20196     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 20197         IF WE-DSPY-AMT NOT = +0
 20198             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 20199             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 20200             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 20201             ADD +1             TO WX-CLM-CNT.
 20202
 20203     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 20204         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 20205             GO TO 4830-EP-DO-AH-EP.
 20206
 20207     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 20208         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 20209             GO TO 4830-EP-DO-AH-EP.
 20210
 20211     GO TO 4815-EP-DO-AH-CLM-EPR.
 20212
 20213 4810-EP-DO-AH-CLM.
 20214
 20215     IF WE-DSPY-AMT NOT = +0
 20216         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 20217         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 20218         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 20219         ADD +1             TO WX-CLM-CNT.
 20220
 20221 4815-EP-DO-AH-CLM-EPR.
 20222
 20223     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 20224         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 20225
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 393
* ECS010D.cbl
 20226 4820-EP-DO-AH-CNCL.
 20227
 20228     IF CR-AH-STATUS-AT-CANCEL = ' '
 20229         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 20230            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 20231             GO TO 4899-EXIT
 20232         ELSE
 20233             GO TO 4830-EP-DO-AH-EP.
 20234
 20235     IF (DTE-CLIENT = 'DCC')
 20236        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 20237        IF CR-AHRFND NOT = ZEROS
 20238           ADD +1                TO WX-CNC-CNT
 20239        END-IF
 20240     ELSE
 20241        ADD +1                   TO WX-CNC-CNT
 20242     END-IF
 20243
 20244     MOVE WE-AHRFND TO CNC-PRM.
 20245
 20246*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 20247*    MOVE 'L'                   TO  DC-OPTION-CODE.
 20248*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20249*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 20250
 20251     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 20252     MOVE 'L'                   TO  DC-OPTION-CODE.
 20253     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20254     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 20255
 20256     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 20257     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 20258     MOVE '1'                     TO  DC-OPTION-CODE.
 20259     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 20260     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 20261                                      DC-ODD-DAYS-OVER
 20262                                      DC-ELAPSED-DAYS.
 20263     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20264     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 20265
 20266     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 20267         ADD  +1                  TO  MONTHS-DIFF-AH.
 20268
 20269     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
 20270
 20271     IF DTE-CLIENT = 'ACE'
 20272         GO TO 4820-CONTINUE-AH-CANCEL.
 20273
 20274     MOVE  ZEROS                  TO  SUB.
 20275
 20276 4820-AH-CHARGEBACK-LOOP.
 20277
 20278     ADD    +1                    TO  SUB.
 20279
 20280     IF  SUB  GREATER THAN  +10
 20281         GO TO  4820-CONTINUE-AH-CANCEL.
 20282
 20283     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 394
* ECS010D.cbl
 20284         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 20285         GO TO  4820-AH-CHARGEBACK-LOOP.
 20286
 20287     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 20288         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 20289
 20290     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 20291         OR (CR-AHRFND = ZEROS)
 20292         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 20293     END-IF
 20294
 20295     GO TO  4820-AH-CHARGEBACK-LOOP.
 20296
 20297
 20298 4820-CONTINUE-AH-CANCEL.
 20299
 20300     IF DTE-CLIENT = 'GIC'
 20301         IF REIN-EP-FLG NOT = 'R'  AND
 20302            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 20303            MOVE CR-AHRFND-CALC TO CNC-PRM.
 20304
 20305     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 20306     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 20307
 20308     IF CR-AH-LUMP-SUM-DISAB
 20309         GO TO 4899-EXIT.
 20310
 20311     MOVE WE-AHAMT TO CNC-BEN.
 20312
 20313     GO TO 4899-EXIT.
 20314
 20315 4825-EP-DO-AH-CNCL-SUM.
 20316
 20317     IF WE-DSPY-AMT NOT = +0
 20318         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 20319         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 20320         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 20321         ADD +1             TO WX-CLM-CNT.
 20322
 20323     IF WE-AHRFND = ZERO
 20324        GO TO 4830-EP-DO-AH-EP.
 20325
 20326     MOVE WE-AHRFND TO CNC-PRM.
 20327
 20328     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 20329
 20330     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
 20331
 20332     IF WE-AHRFND NOT LESS WE-AHPRM
 20333         MOVE WE-AHAMT TO CNC-BEN
 20334          GO TO 4830-EP-DO-AH-EP.
 20335
 20336     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 20337     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 20338     MOVE TEMP-7 TO CNC-BEN.
 20339
 20340 4830-EP-DO-AH-EP.
 20341
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 395
* ECS010D.cbl
 20342     MOVE EOM-RUN-DATE TO VALUATION-DT.
 20343     MOVE '8'           TO W-VAL-SOURCE.
 20344
 20345     IF REIN-EP-FLG = 'R'
 20346       IF REIN-REM-SW (SUB5) = 'I'
 20347           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 20348           GO TO 4899-EXIT.
 20349
 20350     IF REIN-EP-FLG = 'R'
 20351         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 20352            EARNING-STOP-DATE LESS THAN VALUATION-DT
 20353             MOVE '*'               TO A-H-EARNED-SWITCH
 20354             MOVE EARNING-STOP-DATE TO VALUATION-DT
 20355             MOVE '10'              TO W-VAL-SOURCE.
 20356
 20357     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 20358
 20359     IF REM-TRM2 GREATER CR-AH-TERM
 20360         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 20361         GO TO 4899-EXIT.
 20362
 20363     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 20364         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 20365*
 20366 4835-CHECK-OB-AH-NCL.
 20367
 20368     IF (DTE-CLIENT EQUAL 'NCL') AND
 20369        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 20370           MOVE WE-AHPRM         TO EPR-R78
 20371                                    EPR-PRO
 20372                                    EPR-ST
 20373        IF (CR-CCYY EQUAL EOM-CCYY) AND
 20374           (CR-MO EQUAL EOM-MO)
 20375           MOVE '*'            TO OB-DATE-1-SWITCH
 20376           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 20377           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 20378           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 20379           COMPUTE WS-EPR-R78 (SUB3 1) =
 20380                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 20381           GO TO 4899-EXIT
 20382        ELSE
 20383        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 20384           (CR-MO EQUAL OB-MO (1))
 20385           MOVE '*'            TO OB-DATE-2-SWITCH
 20386           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 20387           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 20388           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 20389           COMPUTE WS-EPR-R78 (SUB3 2) =
 20390                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 20391           GO TO 4899-EXIT
 20392        ELSE
 20393        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 20394           (CR-MO EQUAL OB-MO (2))
 20395           MOVE '*'            TO OB-DATE-3-SWITCH
 20396           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 20397           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 20398           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 20399           COMPUTE WS-EPR-R78 (SUB3 3) =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 396
* ECS010D.cbl
 20400                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 20401           GO TO 4899-EXIT
 20402        ELSE
 20403           GO TO 4899-EXIT.
 20404
 20405     IF REM-TRM2 NOT GREATER +0
 20406         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 20407         GO TO 4899-EXIT.
 20408
 20409     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 20410         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 20411         GO TO 4899-EXIT.
 20412
 20413     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 20414         MOVE +1 TO WX-ACTIVE-COUNT
 20415     ELSE
 20416         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 20417
 20418     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 20419     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 20420     IF DTE-R78 = '1'
 20421         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 20422     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 20423
 20424     IF DTE-CLIENT = 'MIC' OR 'MCC'
 20425         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 20426     ELSE
 20427         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 20428
 20429     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 20430     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 20431
 20432     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 20433     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 20434
 20435     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 20436
 20437*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 20438*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 20439
 20440     MOVE SPACES TO STATUTORY-SWITCH-AH.
 20441
 20442     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 20443        (CR-DT GREATER THAN  19921231)
 20444        AND (DTE-CLIENT NOT = 'DCC')
 20445         IF CR-AH-TERM GREATER THAN  +61
 20446             MOVE 'A' TO AH-EARN-METHOD
 20447             MOVE '*' TO STATUTORY-SWITCH-AH
 20448             GO TO 4845-EP-DO-AH-EP-AN
 20449         ELSE
 20450             GO TO 4860-EP-DO-AH-STATUTORY.
 20451
 20452     IF (AH-EARN-METHOD EQUAL 'N')
 20453                  OR
 20454        ((DTE-CLIENT = 'DCC')
 20455         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 20456         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) NOT = 'G'))
 20457         GO TO 4840-EP-DO-AH-EP-NP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 397
* ECS010D.cbl
 20458     END-IF
 20459
 20460     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 20461         MOVE 'A' TO AH-EARN-METHOD
 20462         GO TO 4845-EP-DO-AH-EP-AN.
 20463
 20464     GO TO 4860-EP-DO-AH-STATUTORY.
 20465
 20466 4840-EP-DO-AH-EP-NP.
 20467
 20468     IF WE-AHPRM = ZERO
 20469         GO TO 4860-EP-DO-AH-STATUTORY.
 20470
 20471     IF CR-APR GREATER THAN +0
 20472         NEXT SENTENCE
 20473     ELSE
 20474         GO TO 4860-EP-DO-AH-STATUTORY.
 20475
 20476     IF DTE-CLIENT = 'NCL'
 20477       IF CR-DT LESS THAN 19910101
 20478           GO TO 4860-EP-DO-AH-STATUTORY.
 20479
 20480     IF REM-TRM1 = CR-AH-TERM
 20481         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 20482         GO TO 4899-EXIT.
 20483
 20484     MOVE CR-APR TO NP-APR.
 20485     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 20486     MOVE REM-TRM1 TO NP-REM.
 20487     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 20488     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 20489         MOVE CR-LOAN-TERM TO NP-ORIG.
 20490
 20491     IF (DTE-CLIENT = 'DCC')
 20492        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 20493        MOVE 'S'                 TO NP-OPT
 20494     ELSE
 20495        MOVE 'R'                 TO NP-OPT
 20496     END-IF
 20497
 20498
 20499*    MOVE 'R' TO NP-OPT.
 20500     CALL 'ECSNETRM'
 20501         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 20502
 20503     IF (DTE-CLIENT = 'DCC')
 20504        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 20505        COMPUTE EPR-ST ROUNDED =
 20506           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 20507        GO TO 4899-EXIT
 20508     ELSE
 20509        COMPUTE EPR-R78 ROUNDED =
 20510           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 20511     END-IF
 20512
 20513     GO TO 4860-EP-DO-AH-STATUTORY.
 20514
 20515 4845-EP-DO-AH-EP-AN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 398
* ECS010D.cbl
 20516     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 20517     MOVE 'L'                        TO DC-OPTION-CODE.
 20518     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20519     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 20520     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 20521     MOVE SPACES                     TO CP-ACCT-FLD-5.
 20522     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 20523     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 20524     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 20525     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 20526     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 20527     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 20528                                        CP-RATING-BENEFIT-AMT.
 20529     IF CP-STATE-STD-ABBRV = 'OR'
 20530         COMPUTE CP-RATING-BENEFIT-AMT =
 20531                                  CR-AHAMT * REM-TRM1.
 20532     MOVE CR-APR                     TO CP-LOAN-APR.
 20533     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 20534     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 20535     MOVE '3'                        TO CP-PROCESS-TYPE.
 20536     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 20537     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 20538     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 20539         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 20540     ELSE
 20541         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 20542     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 20543     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 20544     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 20545     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 20546     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 20547     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 20548
 20549     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 20550
 20551     IF CP-ERROR-RATE-NOT-FOUND  OR
 20552        CP-ERROR-RATE-IS-ZERO  OR
 20553        CP-ERROR-IN-DATES
 20554         GO TO 4860-EP-DO-AH-STATUTORY.
 20555
 20556     COMPUTE EPR-R78 ROUNDED =
 20557             ((REM-TRM1 * WE-AHAMT) / +100) *
 20558               CP-PREMIUM-RATE.
 20559
 20560     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 20561
 20562     IF STATUTORY-REQUIREMENT-AH
 20563         MOVE EPR-R78                TO EPR-ST
 20564         GO TO 4899-EXIT.
 20565
 20566 4860-EP-DO-AH-STATUTORY.
 20567     IF (DTE-CLIENT EQUAL 'CID') AND
 20568        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 20569         GO TO 4867-EP-DO-AH-STAT-ROA
 20570     END-IF.
 20571
 20572 4860-EP-DO-AH-STATUTORY-VA.
 20573
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 399
* ECS010D.cbl
 20574     IF (DTE-CLIENT = 'DCC')
 20575        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 20576        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 20577        AND (CLAS-I-BEN (CLAS-INDEXA) NOT = '55' AND '56')
 20578        MOVE EPR-R78             TO EPR-ST
 20579        GO TO 4899-EXIT
 20580     END-IF
 20581
 20582     IF (DTE-CLIENT = 'DCC')
 20583        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 20584        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 20585        AND (CLAS-I-BEN (CLAS-INDEXA) = '55' OR '56')
 20586        MOVE +1.0000                TO TEMP-6
 20587        IF REM-TRM1 < +9
 20588           COMPUTE TEMP-6 =
 20589              ((9 - (9 - REM-TRM1)) - 1)
 20590              * +.125
 20591        END-IF
 20592        COMPUTE EPR-ST ROUNDED = WE-AHPRM - (WE-AHPRM * TEMP-6)
 20593        MOVE EPR-ST              TO EPR-R78
 20594                                    EPR-PRO
 20595        GO TO 4899-EXIT
 20596     END-IF
 20597
 20598     MOVE EPR-R78                    TO EPR-ST.
 20599
 20600     MOVE +0                         TO SUB1.
 20601
 20602 4865-EP-AH-STAT-LOOP.
 20603     ADD +1 TO SUB1.
 20604
 20605     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 20606         MOVE EPR-PRO                TO EPR-ST
 20607     ELSE
 20608         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 20609             GO TO 4865-EP-AH-STAT-LOOP.
 20610
 20611     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 20612         CR-DT GREATER THAN 19831031)  OR
 20613
 20614        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 20615         CR-DT GREATER THAN 19820629)  OR
 20616
 20617        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 20618         CR-DT GREATER THAN 19830831)
 20619
 20620         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 20621
 20622     IF DTE-CLIENT = 'CSO'  OR  'CID'
 20623       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 20624         IF CR-DT LESS THAN 19970101
 20625             MOVE EPR-R78            TO EPR-ST
 20626         ELSE
 20627             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 20628
 20629     IF DTE-CLIENT = 'DCC'
 20630        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 20631           MOVE EPR-PRO          TO EPR-ST
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 400
* ECS010D.cbl
 20632        ELSE
 20633           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 20634        END-IF
 20635     END-IF
 20636     .
 20637     GO TO 4899-EXIT.
 20638
 20639 4867-EP-DO-AH-STAT-ROA.
 20640     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 20641     MOVE 'L'                        TO DC-OPTION-CODE.
 20642     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20643     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 20644     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 20645     MOVE SPACES                     TO CP-ACCT-FLD-5.
 20646     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 20647     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 20648     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 20649     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 20650     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 20651     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 20652                                        CP-RATING-BENEFIT-AMT.
 20653     IF CP-STATE-STD-ABBRV = 'OR'
 20654         COMPUTE CP-RATING-BENEFIT-AMT =
 20655                                  CR-AHAMT * REM-TRM1.
 20656     MOVE CR-APR                     TO CP-LOAN-APR.
 20657     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 20658     MOVE 'A'                        TO CP-EARNING-METHOD.
 20659     MOVE '3'                        TO CP-PROCESS-TYPE.
 20660     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 20661     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 20662     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 20663         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 20664     ELSE
 20665         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 20666     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 20667     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 20668     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 20669     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 20670     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 20671     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 20672
 20673     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 20674
 20675     IF CP-ERROR-RATE-NOT-FOUND  OR
 20676        CP-ERROR-RATE-IS-ZERO  OR
 20677        CP-ERROR-IN-DATES
 20678         GO TO 4860-EP-DO-AH-STATUTORY-VA.
 20679
 20680     COMPUTE EPR-ST ROUNDED =
 20681             ((REM-TRM1 * WE-AHAMT) / +100) *
 20682               CP-PREMIUM-RATE.
 20683
 20684     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 20685
 20686     GO TO 4899-EXIT.
 20687
 20688 4899-EXIT.
 20689     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 401
* ECS010D.cbl
 20690******************************************************************
 20691***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 20692******************************************************************
 20693
 20694 4900-WRITE-SUMMARY-EXTRACTS.
 20695
 20696     IF DTE-CLIENT = 'HER'
 20697         IF EP-RECORD-ID = 'EC'  AND
 20698            EP-REINCO = 'LNL'
 20699             GO TO 4999-WRT-SUMMARY-X.
 20700
 20701     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 20702                                     WS-EP-RUN-DTE-N.
 20703
 20704     IF W-UNDERWRITTEN-DATA
 20705         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
 20706     ELSE
 20707         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 20708
 20709     IF  DTE-OPT-RESERVE-METHOD-AUTH
 20710         IF VALID-EP-ID
 20711             MOVE 'Y'             TO EP-NEW-DATA-IND.
 20712
 20713     WRITE EP-RECORD.
 20714
 20715     ADD +1                       TO EP-CNT.
 20716
 20717 4999-WRT-SUMMARY-X.
 20718     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 402
* ECS010D.cbl
 20720******************************************************************
 20721***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 20722******************************************************************
 20723
 20724 5000-DATE-RANGE-BREAK.
 20725
 20726     IF NO-TRANSACTION-WAS-PROCESSED
 20727         GO TO 5099-DATE-RANGE-BREAK-X.
 20728
 20729     ADD +1  TO RANGE-CNT.
 20730     MOVE +1 TO SUB6.
 20731     MOVE +2 TO SUB7.
 20732     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20733     IF LN-CNT GREATER +50
 20734         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 20735                 8750-PRT-RANGE-HEADING.
 20736
 20737     MOVE SPACES                     TO PRT.
 20738     PERFORM 8800-PRINT-ROUTINE.
 20739     MOVE 'DATE RANGE'               TO TPH2-DESC.
 20740     MOVE '  TOTALS'                 TO TPH3-DESC.
 20741     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20742     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20743     PERFORM 5900-CLEAR-TOTAL-PAGES
 20744         THRU 5999-CLEAR-TOTAL-PAGES-X
 20745             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 20746
 20747 5099-DATE-RANGE-BREAK-X.
 20748     EXIT.
 20749
 20750 5100-ACCOUNT-BREAK.
 20751
 20752     IF RANGE-CNT NOT = +0
 20753         PERFORM 5000-DATE-RANGE-BREAK
 20754             THRU 5099-DATE-RANGE-BREAK-X
 20755     ELSE
 20756         MOVE +1 TO SUB6
 20757         MOVE +2 TO SUB7
 20758         PERFORM 5800-ADD-PAGES-LEVELS
 20759             THRU 5899-ADD-PAGES-LEVELS-X
 20760         PERFORM 5900-CLEAR-TOTAL-PAGES
 20761             THRU 5999-CLEAR-TOTAL-PAGES-X
 20762                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 20763
 20764     MOVE +0 TO RANGE-CNT.
 20765     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 20766         VARYING B-SUB FROM 1 BY 1
 20767             UNTIL B-SUB GREATER THAN 50  OR
 20768                   RB-COMPANY (B-SUB) = SPACES.
 20769     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 20770         VARYING B-SUB FROM 1 BY 1
 20771             UNTIL B-SUB GREATER THAN 50.
 20772
 20773     IF ACCT-FLG = SPACE
 20774         GO TO 5199-ACCOUNT-BREAK-X.
 20775
 20776     MOVE SPACE TO ACCT-FLG.
 20777     MOVE +2 TO SUB6.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 403
* ECS010D.cbl
 20778     MOVE +3 TO SUB7.
 20779     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20780     IF LN-CNT GREATER +50
 20781         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 20782                 8725-PRT-ACCT-HEADING.
 20783
 20784     MOVE SPACES                     TO PRT.
 20785     PERFORM 8800-PRINT-ROUTINE.
 20786     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 20787     MOVE ' TOTALS'                  TO TPH3-DESC.
 20788     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20789     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20790     PERFORM 5900-CLEAR-TOTAL-PAGES
 20791         THRU 5999-CLEAR-TOTAL-PAGES-X
 20792             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 20793
 20794 5199-ACCOUNT-BREAK-X.
 20795     EXIT.
 20796
 20797 5200-STATE-BREAK.
 20798
 20799     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 20800     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 20801     MOVE +3 TO SUB6.
 20802     MOVE +4 TO SUB7.
 20803     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20804
 20805     IF STATE-FLG = SPACE
 20806         GO TO 5299-STATE-BREAK-X.
 20807
 20808     MOVE SPACE         TO STATE-FLG.
 20809     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20810     MOVE 'STATE'       TO TPH1-TYPE.
 20811     MOVE HLD-STATE     TO STATE-L.
 20812
 20813     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 20814
 20815     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 20816         MOVE SPACES          TO TPH1-DESC
 20817         MOVE HLD-STATE       TO TPH1-ST-CODE
 20818         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 20819     ELSE
 20820         MOVE SPACES TO TPH1-DESC
 20821         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 20822         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 20823
 20824     MOVE 'STATE'  TO TPH2-DESC.
 20825     MOVE 'TOTALS' TO TPH3-DESC.
 20826     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20827     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20828     PERFORM 5900-CLEAR-TOTAL-PAGES
 20829         THRU 5999-CLEAR-TOTAL-PAGES-X
 20830             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 20831
 20832 5299-STATE-BREAK-X.
 20833     EXIT.
 20834
 20835 5300-COMP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 404
* ECS010D.cbl
 20836
 20837     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 20838     MOVE +4 TO SUB6.
 20839     MOVE +5 TO SUB7.
 20840     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20841
 20842     IF COMP-FLG = SPACE
 20843         GO TO 5399-COMP-BREAK-X.
 20844
 20845     MOVE ' ' TO COMP-FLG.
 20846     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20847     MOVE 'COMPANY'                   TO TPH1-TYPE.
 20848     MOVE HLD-GROUPING                TO TPH1-DESC.
 20849     MOVE 'COMPANY'                   TO TPH2-DESC.
 20850     MOVE ' TOTALS'                   TO TPH3-DESC.
 20851     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20852     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20853     PERFORM 5900-CLEAR-TOTAL-PAGES
 20854         THRU 5999-CLEAR-TOTAL-PAGES-X
 20855             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 20856
 20857 5399-COMP-BREAK-X.
 20858     EXIT.
 20859
 20860 5400-CARR-BREAK.
 20861
 20862     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 20863     MOVE +5 TO SUB6.
 20864     MOVE +6 TO SUB7.
 20865     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20866
 20867     IF CARR-FLG = SPACE
 20868         GO TO 5499-CARR-BREAK-X.
 20869
 20870     MOVE ' ' TO CARR-FLG.
 20871     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20872     MOVE 'CARRIER'               TO TPH1-TYPE.
 20873     MOVE HLD-CARRIER             TO TPH1-DESC.
 20874     MOVE 'CARRIER'               TO TPH2-DESC.
 20875     MOVE ' TOTALS'               TO TPH3-DESC.
 20876     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20877     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20878     PERFORM 5900-CLEAR-TOTAL-PAGES
 20879         THRU 5999-CLEAR-TOTAL-PAGES-X
 20880             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 20881
 20882 5499-CARR-BREAK-X.
 20883     EXIT.
 20884
 20885 5500-FINAL-BREAK.
 20886
 20887     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 20888
 20889     IF FINAL-FLG = SPACE
 20890         GO TO 5599-FINAL-BREAK-X.
 20891
 20892     IF DTE-FICH = '1'
 20893         MOVE '2'  TO  DTE-FICH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 405
* ECS010D.cbl
 20894     MOVE +6 TO SUB6.
 20895     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20896     MOVE SPACES   TO TPH1-TYPE.
 20897     MOVE SPACES   TO TPH1-DESC.
 20898     MOVE 'FINAL'  TO TPH2-DESC.
 20899     MOVE 'TOTALS' TO TPH3-DESC.
 20900     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20901     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20902
 20903 5599-FINAL-BREAK-X.
 20904     EXIT.
 20905
 20906 5800-ADD-PAGES-LEVELS.
 20907
 20908     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 20909     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 20910     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 20911     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 20912     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 20913     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 20914     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 20915     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 20916
 20917 5899-ADD-PAGES-LEVELS-X.
 20918     EXIT.
 20919
 20920 5900-CLEAR-TOTAL-PAGES.
 20921
 20922     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 20923             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 20924             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 20925             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 20926
 20927 5999-CLEAR-TOTAL-PAGES-X.
 20928     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 406
* ECS010D.cbl
 20930******************************************************************
 20931***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 20932******************************************************************
 20933
 20934 6000-TOTAL-PAGE-HEADINGS.
 20935
 20936     MOVE TOTAL-PAGE-HD1 TO PRT.
 20937     PERFORM 8800-PRINT-ROUTINE.
 20938
 20939 6100-ACCT-TOTAL-HEADINGS.
 20940
 20941     MOVE TOTAL-PAGE-HD2 TO PRT.
 20942     MOVE '0' TO P-CTL.
 20943     PERFORM 8800-PRINT-ROUTINE.
 20944     MOVE TOTAL-PAGE-HD3 TO PRT.
 20945     MOVE ' ' TO P-CTL.
 20946     PERFORM 8800-PRINT-ROUTINE.
 20947     PERFORM 8800-PRINT-ROUTINE.
 20948     MOVE +81 TO LN-CNT.
 20949
 20950 6199-PAGE-HEADINGS-X.
 20951     EXIT.
 20952
 20953 6500-PRINT-TOTAL-PAGE.
 20954
 20955     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 20956     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 20957     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 20958
 20959     IF SUB6 = 6 AND ME-DO-UPDATE
 20960         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 20961
 20962     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 20963
 20964     IF SUB6 = 6 AND ME-DO-UPDATE
 20965         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 20966
 20967     COMPUTE TPD-NET-PRM =
 20968         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 20969
 20970     IF SUB6 = 6 AND ME-DO-UPDATE
 20971         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 20972         GIVING ME-010-NET-L.
 20973
 20974     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 20975
 20976     IF SUB6 = 6 AND ME-DO-UPDATE
 20977         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 20978
 20979     COMPUTE TPD-PREM-COMP =
 20980         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 20981                            - TPL-ACCT-COM (SUB6).
 20982     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 20983
 20984     IF SUB6 = 6 AND ME-DO-UPDATE
 20985         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 20986
 20987     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 407
* ECS010D.cbl
 20988         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 20989         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 20990         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 20991     END-IF.
 20992
 20993     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 20994     PERFORM 8800-PRINT-ROUTINE.
 20995     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 20996     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 20997     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 20998     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 20999
 21000     IF SUB6 = 6 AND ME-DO-UPDATE
 21001         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 21002         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 21003
 21004     COMPUTE TPD-NET-PRM =
 21005         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 21006
 21007     IF SUB6 = 6 AND ME-DO-UPDATE
 21008         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 21009         GIVING ME-010-NET-AH.
 21010
 21011     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 21012
 21013     IF SUB6 = 6 AND ME-DO-UPDATE
 21014         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 21015
 21016     COMPUTE TPD-PREM-COMP =
 21017         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 21018                            - TPA-ACCT-COM (SUB6).
 21019     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 21020
 21021     IF SUB6 = 6 AND ME-DO-UPDATE
 21022         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 21023
 21024     IF SUB6 = 6
 21025         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 21026         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 21027         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 21028     END-IF.
 21029
 21030     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 21031     PERFORM 8800-PRINT-ROUTINE.
 21032
 21033     MOVE 'TOTAL' TO TPD-DESC.
 21034
 21035     COMPUTE TPD-ISS-PRM =
 21036         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 21037
 21038     COMPUTE TPD-CNC-PRM =
 21039         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 21040
 21041     COMPUTE TPD-NET-PRM =
 21042         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 21043         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 21044
 21045     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 408
* ECS010D.cbl
 21046         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 21047
 21048     COMPUTE TPD-PREM-COMP =
 21049         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 21050         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 21051         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 21052
 21053     COMPUTE TPD-CLAIMS =
 21054         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 21055
 21056     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 21057         NEXT SENTENCE
 21058     ELSE
 21059         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 21060         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 21061         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 21062*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 21063*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 21064*        MOVE ZEROS               TO SV-LO-CERT
 21065*                                    SV-HI-CERT.
 21066
 21067     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 21068     MOVE '0'                     TO P-CTL.
 21069     PERFORM 8800-PRINT-ROUTINE.
 21070     PERFORM 8800-PRINT-ROUTINE.
 21071
 21072 6599-TOTAL-PAGE-PRINT-X.
 21073     EXIT.
 21074*
 21075*
 21076*
 21077**START***********************************************************
 21078*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 21079*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 21080******************************************************************
 21081*
 21082 6650-GET-RES-STATE-COMM.
 21083*6650-BROWSE-FORWARD.
 21084
 21085     IF DTE-CLIENT NOT = 'DMD'
 21086         GO TO 6700-COMM-EXIT.
 21087
 21088     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 21089     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 21090     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 21091     MOVE CR-STATE            TO WS-ERRESC-STATE.
 21092     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 21093     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 21094     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 21095     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 21096
 21097     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 21098
 21099*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 21100*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 21101*VALUE OF PB-CERT-EFF-DT
 21102*
 21103     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 409
* ECS010D.cbl
 21104
 21105     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 21106
 21107     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 21108         GO TO 6700-COMM-EXIT.
 21109
 21110*GET RECORD WHERE POSITIONED
 21111
 21112 6650-READ-ERRESC-NEXT.
 21113     READ ERRESC-IN NEXT RECORD.
 21114
 21115     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 21116         GO TO 6700-COMM-EXIT.
 21117
 21118*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 21119
 21120     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 21121        NEXT SENTENCE
 21122     ELSE
 21123         GO TO 6700-COMM-EXIT.
 21124
 21125     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 21126         NEXT SENTENCE
 21127     ELSE
 21128         GO TO 6650-READ-ERRESC-NEXT.
 21129
 21130*  CR-DT  = WS-YYYYMMDD-DT
 21131*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 21132*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 21133
 21134     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 21135         GO TO 6700-COMM-EXIT.
 21136
 21137* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 21138
 21139     MOVE ZEROS               TO WS-SUB WS-SUB1.
 21140
 21141     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 21142
 21143     IF WS-SUB1 IS GREATER THAN ZERO
 21144         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 21145             PERFORM 6680-SET-TABLE-CODE
 21146         ELSE
 21147             PERFORM 6680-SET-COMMISSION.
 21148
 21149     GO TO 6700-COMM-EXIT.
 21150
 21151 6680-SET-TABLE-CODE.
 21152     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 21153        MOVE ZEROS             TO WS-SUB1
 21154     ELSE
 21155* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 21156* TO COMPUTE AH COMMISSION.
 21157        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 21158        MOVE CR-AH-TERM        TO WS-COMM-TERM
 21159        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 21160        MOVE RESC-COMMISSION-TAB (WS-SUB)
 21161                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 410
* ECS010D.cbl
 21162        PERFORM 6680-READ-CTBL-TABLE
 21163        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 21164           MOVE ZEROS          TO WS-SUB1.
 21165
 21166 6680-READ-CTBL-TABLE.
 21167*
 21168* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 21169* TO COMPUTE LIFE COMMISSION
 21170
 21171     IF CR-AHTYP = ZERO
 21172        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 21173        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 21174        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 21175
 21176     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 21177
 21178     IF ERCTBL-FILE-STATUS EQUAL '00'
 21179* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 21180        IF CR-AHTYP NOT = ZERO
 21181             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 21182             MOVE CR-AH-TERM        TO WS-COMM-TERM
 21183             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 21184             MOVE WK-RATE           TO WS-COMMISSION
 21185                                       PB-I-AH-COMMISSION
 21186        ELSE
 21187* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 21188             MOVE CR-LFAMT    TO COMM-CK-AMT
 21189             MOVE CR-LF-TERM  TO WS-COMM-TERM
 21190             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 21191             MOVE WK-RATE     TO WS-COMMISSION
 21192                                 PB-I-LIFE-COMMISSION.
 21193
 21194 6680-SET-COMMISSION.
 21195     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 21196           MOVE ZEROS         TO WS-SUB1
 21197       ELSE
 21198           MOVE RESC-COMMISSION-PER (WS-SUB)
 21199                              TO WS-COMMISSION WK-RATE
 21200           IF CR-AHTYP NOT = ZERO
 21201                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 21202           ELSE
 21203                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 21204
 21205 6680-SEARCH-CATEGORY.
 21206     ADD +1 TO WS-SUB.
 21207
 21208     IF WS-SUB IS GREATER THAN +12
 21209         GO TO 6680-EXIT.
 21210
 21211     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 21212          MOVE WS-SUB         TO WS-SUB1
 21213          GO TO 6680-EXIT.
 21214
 21215     GO TO 6680-SEARCH-CATEGORY.
 21216
 21217 6680-EXIT.
 21218     EXIT.
 21219
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 411
* ECS010D.cbl
 21220 6700-COMM-EXIT.
 21221     EXIT.
 21222*
 21223*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 21224
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 412
* ECS010D.cbl
 21226******************************************************************
 21227***         C L I E N T   B I L L I N G   R O U T I N E        ***
 21228******************************************************************
 21229
 21230 7000-CLIENT-BILLING-ROUTINE.
 21231*
 21232*
 21233* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 21234
 21235     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 21236                BC-G-ISS      BC-G-CNC   BC-G-CLM
 21237                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 21238                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 21239                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 21240                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 21241                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 21242
 21243 7099-BILL-X.
 21244     EXIT.
 21245
 21246
 21247 7500-ADD-UP-REIN-CO.
 21248
 21249     IF RB-COMPANY (B-SUB) NOT = SPACES
 21250         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 21251
 21252 7599-ADD-UP-REIN-X.
 21253     EXIT.
 21254
 21255 7900-CLEAR-BILLING-TABLE.
 21256
 21257     MOVE SPACES TO RB-COMPANY (B-SUB).
 21258     MOVE 0      TO RB-COUNT (B-SUB).
 21259
 21260 7999-CLEAR-BILLING-X.
 21261     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 413
* ECS010D.cbl
 21263******************************************************************
 21264***         M I S C E L L A N E O U S   R O U T I N E S        ***
 21265******************************************************************
 21266
 21267 8000-DATE-CONVERT-ROUTINE.
 21268
 21269     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 21270
 21271 8099-DATE-CONVERT-X.
 21272     EXIT.
 21273
 21274 8000R-CONVERT-STOP-DATE.
 21275
 21276     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 21277     MOVE 'L'                     TO DC-OPTION-CODE.
 21278     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21279     MOVE +0                      TO DC-ELAPSED-MONTHS.
 21280     MOVE -1                      TO DC-ELAPSED-DAYS.
 21281     MOVE '6'                     TO DC-OPTION-CODE.
 21282     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21283     MOVE +0                      TO DC-ELAPSED-MONTHS
 21284                                     DC-ELAPSED-DAYS.
 21285     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 21286     MOVE ' '                     TO DC-OPTION-CODE.
 21287     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21288
 21289     IF NO-CONVERSION-ERROR
 21290         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 21291     ELSE
 21292         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 21293                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 21294                 '  STOP DATE: ' RWF-EP-STOP-DATE
 21295         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 21296                                  TO WS-ABEND-MESSAGE
 21297         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 21298         MOVE 4002                TO WS-ABEND-CODE
 21299         GO TO ABEND-PGM.
 21300
 21301 8099R-STOP-DATE-X.
 21302     EXIT.
 21303
 21304
 21305 8100-GET-RATE.
 21306
 21307     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 21308
 21309 8199-GET-RATE-X.
 21310     EXIT.
 21311
 21312
 21313 8200-STATE-CODE-LOOKUP.
 21314
 21315     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 21316        CLAS-INDEXS NOT = ZERO
 21317         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 21318             GO TO 8299-STATE-LOOKUP-X.
 21319
 21320     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 414
* ECS010D.cbl
 21321
 21322 8250-STATE-LOOKUP-LOOP.
 21323
 21324     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 21325         MOVE 0302 TO WS-ABEND-CODE
 21326         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 21327         DISPLAY '******************************'
 21328         DISPLAY '***** ERROR LOCATION 022 *****'
 21329         DISPLAY '******************************'
 21330         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21331         GO TO ABEND-PGM.
 21332
 21333     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 21334         ADD +1 TO CLAS-INDEXS
 21335         GO TO 8250-STATE-LOOKUP-LOOP.
 21336
 21337 8299-STATE-LOOKUP-X.
 21338     EXIT.
 21339
 21340
 21341 8300-LIFE-TYPE-LOOKUP.
 21342
 21343     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 21344        CLAS-INDEXL NOT = ZERO
 21345         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 21346             GO TO 8399-LIFE-LOOKUP-X.
 21347
 21348     MOVE CLAS-STARTL TO CLAS-INDEXL.
 21349
 21350 8350-LIFE-LOOKUP-LOOP.
 21351
 21352     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 21353         MOVE 0401 TO WS-ABEND-CODE
 21354         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 21355         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 21356         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 21357         DISPLAY '******************************'
 21358         DISPLAY '***** ERROR LOCATION 023 *****'
 21359         DISPLAY '******************************'
 21360         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21361         IF DTE-CLIENT = 'NCL'
 21362                      OR 'CID'
 21363             MOVE CLAS-STARTL      TO CLAS-INDEXL
 21364             MOVE '05'             TO CLAS-LOOK
 21365             GO TO 8350-LIFE-LOOKUP-LOOP
 21366         ELSE
 21367             GO TO ABEND-PGM.
 21368
 21369     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 21370         ADD +1 TO CLAS-INDEXL
 21371         GO TO 8350-LIFE-LOOKUP-LOOP.
 21372
 21373     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 21374         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 21375
 21376 8399-LIFE-LOOKUP-X.
 21377     EXIT.
 21378
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 415
* ECS010D.cbl
 21379
 21380 8400-A-H-TYPE-LOOKUP.
 21381
 21382     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 21383        CLAS-INDEXA NOT = ZERO
 21384         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 21385             GO TO 8499-A-H-LOOKUP-X.
 21386
 21387     MOVE CLAS-STARTA TO CLAS-INDEXA.
 21388
 21389 8450-A-H-LOOKUP-LOOP.
 21390
 21391     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 21392         MOVE 0402 TO WS-ABEND-CODE
 21393         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 21394         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 21395         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 21396         DISPLAY '******************************'
 21397         DISPLAY '***** ERROR LOCATION 024 *****'
 21398         DISPLAY '******************************'
 21399         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21400         IF DTE-CLIENT = 'NCL'
 21401             MOVE CLAS-STARTA      TO CLAS-INDEXA
 21402             MOVE '05'             TO CLAS-LOOK
 21403             GO TO 8450-A-H-LOOKUP-LOOP
 21404         ELSE
 21405             GO TO ABEND-PGM.
 21406
 21407     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 21408         ADD +1 TO CLAS-INDEXA
 21409         GO TO 8450-A-H-LOOKUP-LOOP.
 21410
 21411 8499-A-H-LOOKUP-X.
 21412     EXIT.
 21413
 21414 8500-REMAINING-TERM-ROUTINE.
 21415
 21416     MOVE ZEROS                      TO CP-REMAINING-TERM
 21417                                        CP-REMAINING-TERM-1
 21418                                        CP-REMAINING-TERM-2
 21419                                        CP-REMAINING-TERM-3
 21420                                        CP-RETURN-CODE
 21421                                        CP-RETURN-CODE-2
 21422                                        REM-TRM1
 21423                                        REM-TRM2
 21424                                        REM-TRM3
 21425                                        TEM-TRM1.
 21426     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 21427
 21428     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21429     MOVE 'L'                        TO DC-OPTION-CODE.
 21430     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21431
 21432     IF  NO-CONVERSION-ERROR
 21433         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 21434     ELSE
 21435         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 21436                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 416
* ECS010D.cbl
 21437         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 21438         MOVE 3001                   TO WS-ABEND-CODE
 21439         GO TO ABEND-PGM.
 21440
 21441     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 21442
 21443     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 21444         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 21445
 21446     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 21447         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 21448         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 21449                                        DC-ELAPSED-DAYS
 21450         MOVE '3'                    TO DC-OPTION-CODE
 21451         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 21452                 8099-DATE-CONVERT-X
 21453         IF  NO-CONVERSION-ERROR
 21454             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 21455         ELSE
 21456             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 21457
 21458     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 21459         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 21460
 21461     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 21462         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 21463         MOVE +1                     TO DC-ELAPSED-MONTHS
 21464         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 21465         MOVE '6'                    TO DC-OPTION-CODE
 21466         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 21467                 8099-DATE-CONVERT-X
 21468         IF  NO-CONVERSION-ERROR
 21469             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 21470             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 21471         ELSE
 21472             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 21473                                     TO WS-ABEND-MESSAGE
 21474             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 21475             MOVE 3002               TO WS-ABEND-CODE
 21476             GO TO ABEND-PGM.
 21477
 21478     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 21479     MOVE 'L'                        TO DC-OPTION-CODE.
 21480     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21481
 21482     IF  NO-CONVERSION-ERROR
 21483         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 21484     ELSE
 21485         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 21486             W-VAL-ERROR (W-VAL-SOURCE)
 21487         DISPLAY '   KEY - ' CR-FULL-CONTROL
 21488             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 21489             DC-ERROR-CODE
 21490         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 21491         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 21492             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 21493             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 21494             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 417
* ECS010D.cbl
 21495*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 21496*                                    TO WS-ABEND-MESSAGE
 21497*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 21498*        MOVE 3003                   TO WS-ABEND-CODE
 21499*        GO TO ABEND-PGM.
 21500
 21501     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21502     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21503     MOVE '3'                        TO CP-PROCESS-TYPE.
 21504     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21505     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21506     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21507
 21508*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 21509*                                    TO CP-REM-TERM-METHOD.
 21510
 21511     IF  DTE-CLIENT = 'FIM'
 21512         MOVE '5'                    TO CP-REM-TERM-METHOD.
 21513
 21514     IF DTE-CLIENT = 'FLI' OR 'FLU'
 21515         IF WE-LF-AH = AH-OVERRIDE-L1
 21516             MOVE '2'                TO CP-REM-TERM-METHOD
 21517         ELSE
 21518             IF CR-LFTYP = '01' OR '03'
 21519                 MOVE '4'            TO CP-REM-TERM-METHOD
 21520             ELSE
 21521                 IF CR-LFTYP = '02' OR '04'
 21522                     MOVE '2'        TO CP-REM-TERM-METHOD.
 21523
 21524     IF  DTE-CLIENT = 'CSL'
 21525         IF  CR-CARRIER = '2'
 21526             IF  CR-LFTYP = '07' OR  '08'
 21527                 MOVE '4'            TO CP-REM-TERM-METHOD.
 21528
 21529     IF  DTE-CLIENT = 'POS'
 21530         IF  CR-CARRIER = '1'
 21531             MOVE '1'                TO CP-REM-TERM-METHOD
 21532         ELSE
 21533             MOVE '2'                TO CP-REM-TERM-METHOD.
 21534
 21535     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 21536         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 21537
 21538     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 21539         GO TO 8540-CALC-REM-TERM-AH.
 21540
 21541 8520-CALC-REM-TERM-LIFE.
 21542
 21543     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 21544     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 21545     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 21546*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 21547     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 21548                                        CP-LOAN-TERM.
 21549
 21550     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 21551             AND
 21552         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 418
* ECS010D.cbl
 21553         ADD +1                      TO CP-ORIGINAL-TERM
 21554                                        CP-LOAN-TERM.
 21555
 21556     IF  CP-TERM-IS-DAYS
 21557         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 21558     ELSE
 21559         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 21560
 21561     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 21562
 21563     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 21564         ADD +1                      TO W-ORGTRM-0-LF
 21565         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 21566             CR-FULL-CONTROL
 21567         GO TO 8599-REM-TERM-X.
 21568
 21569     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 21570
 21571     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 21572         ADD +1                      TO W-RET-CODE-LF
 21573         GO TO 8599-REM-TERM-X.
 21574*
 21575*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 21576*                                    TO WS-ABEND-MESSAGE
 21577*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 21578*        MOVE 2002                   TO WS-ABEND-CODE
 21579*        GO TO ABEND-PGM.
 21580
 21581     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 21582             AND
 21583         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 21584         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 21585         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 21586         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 21587
 21588     IF  CP-REMAINING-TERM-1 NEGATIVE
 21589         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 21590
 21591     IF  CP-REMAINING-TERM-2 NEGATIVE
 21592         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 21593
 21594     IF DTE-CLIENT = 'NCL'
 21595         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 21596                                        CP-REMAINING-TERM-3.
 21597
 21598     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 21599     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 21600     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 21601     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 21602
 21603     GO TO 8599-REM-TERM-X.
 21604
 21605 8520-EXIT.
 21606     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 419
* ECS010D.cbl
 21608 8540-CALC-REM-TERM-AH.
 21609
 21610     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 21611     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21612     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21613     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 21614                                        CP-LOAN-TERM.
 21615     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 21616
 21617     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 21618
 21619     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 21620         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 21621             CR-FULL-CONTROL
 21622         ADD +1                      TO W-ORGTRM-0-AH
 21623         GO TO 8599-REM-TERM-X.
 21624
 21625     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 21626
 21627     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 21628         ADD +1                      TO W-RET-CODE-AH
 21629         GO TO 8599-REM-TERM-X.
 21630*
 21631*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 21632*                                    TO WS-ABEND-MESSAGE
 21633*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 21634*        MOVE 2001                   TO WS-ABEND-CODE
 21635*        GO TO ABEND-PGM.
 21636
 21637     IF DTE-CLIENT = 'NCL'
 21638         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 21639                                        CP-REMAINING-TERM-3.
 21640
 21641     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 21642     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 21643     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 21644     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 21645
 21646 8599-REM-TERM-X.
 21647     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 420
* ECS010D.cbl
 21649
 21650******************************************************************
 21651***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 21652******************************************************************
 21653
 21654 8600-DISPLAY-PRT.
 21655
 21656     IF  DIS-LINE-CNT GREATER THAN 59
 21657         PERFORM 8600-DISPLAY-HD THRU
 21658             8600-HD-EXIT.
 21659
 21660     ADD  1  TO DIS-LINE-CNT.
 21661     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 21662     MOVE  SPACES TO DISPLAY-REC
 21663                     DISPLAY-LINE.
 21664
 21665 8600-DISPLAY-EXIT.
 21666     EXIT.
 21667
 21668
 21669 8600-DISPLAY-HD.
 21670
 21671     MOVE '1'  TO  DISPLAY-CC.
 21672     MOVE ZEROS TO DIS-LINE-CNT.
 21673     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 21674     ADD +1 TO DIS-LINE-CNT.
 21675     MOVE ' '  TO  DISPLAY-CC.
 21676     MOVE SPACES TO DISPLAY-REC.
 21677     WRITE DISPLAY-REC.
 21678     ADD +1 TO DIS-LINE-CNT.
 21679     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 21680     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 21681     ADD +1 TO DIS-LINE-CNT.
 21682     MOVE SPACES TO DISPLAY-REC.
 21683     ADD +1 TO DIS-LINE-CNT.
 21684     WRITE DISPLAY-REC.
 21685
 21686 8600-HD-EXIT.
 21687     EXIT.
 21688
 21689******************************************************************
 21690***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 21691******************************************************************
 21692
 21693 8600-SETUP-DETAIL-LINE.
 21694
 21695     MOVE SPACES                TO TR-DTL2.
 21696
 21697     MOVE CR-CERT-NO            TO TRD-CERT.
 21698     MOVE CR-YR                 TO TRD-ISYR.
 21699     MOVE CR-MO                 TO TRD-ISMO.
 21700     MOVE CR-DA                 TO TRD-ISDA.
 21701     MOVE CR-AGE                TO TRD-AGE.
 21702
 21703 8689-SETUP-DETAIL-X.
 21704     EXIT.
 21705
 21706 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 421
* ECS010D.cbl
 21707
 21708     IF LN-CNT GREATER THAN LN-MX
 21709         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 21710                 8799-PRT-HEADINGS-X.
 21711     MOVE TRD-CERT TO SV-TRD-CERT.
 21712     MOVE TRD-ISDT TO SV-TRD-ISDT.
 21713
 21714     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 21715         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 21716
 21717     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 21718     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 21719     MOVE TR-DTL TO PRT.
 21720
 21721     IF NOT WS-CHANGE-REC
 21722         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 21723     ELSE
 21724         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 21725
 21726     PERFORM 8800-PRINT-ROUTINE.
 21727
 21728 8699-PRT-DETAIL-X.
 21729     EXIT.
 21730
 21731 8700-PRINT-REPORT-HEADINGS.
 21732     ADD +1 TO PG-CNT.
 21733     MOVE PG-CNT TO TR-PG.
 21734     MOVE +0 TO LN-CNT.
 21735     MOVE TR-HD-1 TO PRT.
 21736     PERFORM 8800-PRINT-ROUTINE.
 21737     MOVE TR-HD-2 TO PRT.
 21738     PERFORM 8800-PRINT-ROUTINE.
 21739     MOVE TR-HD-3 TO PRT.
 21740     PERFORM 8800-PRINT-ROUTINE.
 21741     ADD +1 TO LN-CNT.
 21742
 21743 8725-PRT-ACCT-HEADING.
 21744     MOVE TR-HD-4 TO PRT.
 21745     PERFORM 8800-PRINT-ROUTINE.
 21746     MOVE TR-HD-5 TO PRT.
 21747     PERFORM 8800-PRINT-ROUTINE.
 21748
 21749 8750-PRT-RANGE-HEADING.
 21750     MOVE TR-HD-6 TO PRT.
 21751     PERFORM 8800-PRINT-ROUTINE.
 21752
 21753 8775-PRT-COLUMN-HEADINGS.
 21754     MOVE TR-HD-7 TO PRT.
 21755     PERFORM 8800-PRINT-ROUTINE.
 21756     MOVE TR-HD-8 TO PRT.
 21757     PERFORM 8800-PRINT-ROUTINE.
 21758     MOVE TR-HD-9 TO PRT.
 21759     PERFORM 8800-PRINT-ROUTINE.
 21760     PERFORM 8800-PRINT-ROUTINE.
 21761
 21762 8799-PRT-HEADINGS-X.
 21763     EXIT.
 21764
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 422
* ECS010D.cbl
 21765 8800-PRINT-ROUTINE.
 21766     MOVE P-CTL TO X.
 21767     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 21768     ADD +1 TO LN-CNT.
 21769     MOVE SPACES TO PRT.
 21770
 21771 8900-PRINT-A-LINE.
*21772                             COPY ELCPRT2.
 21773******************************************************************04/15/98
 21774*                                                                *ELCPRT2
 21775*                                                                *ELCPRT2
 21776*                            ELCPRT2                             *   LV005
 21777*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 21778*                            VMOD=2.002                          *   CL**5
 21779*                                                                *   CL**4
 21780******************************************************************   CL**4
 21781                                                                     CL**4
 21782     IF DTE-FICH NOT = SPACE AND                                     CL**4
 21783        FICH-OPEN    = SPACE                                         CL**4
 21784         MOVE 'X'                TO  FICH-OPEN                       CL**4
 21785         OPEN OUTPUT FICH.                                           CL**4
 21786                                                                     CL**4
 21787     IF DTE-FICH NOT = SPACE                                         CL**4
 21788         MOVE X                  TO  P-CTL                           CL**4
 21789         WRITE FICH-REC FROM PRT.                                    CL**4
 21790                                                                     CL**4
 21791     IF DTE-FICH = SPACE OR '2'                                      CL**4
 21792       MOVE X                    TO  P-CTL                           CL**4
 21793       IF P-CTL = ' '                                                CL**4
 21794         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 21795       ELSE                                                          CL**4
 21796         IF P-CTL = '0'                                              CL**4
 21797           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 21798         ELSE                                                        CL**4
 21799           IF P-CTL = '-'                                            CL**4
 21800             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 21801           ELSE                                                      CL**4
 21802             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 21803                                                                     CL**4
 21804******************************************************************   CL**4
 21805
 21806 8999-PRT-LINE-X.
 21807     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 423
* ECS010D.cbl
 21809******************************************************************
 21810***          E N D   O F   J O B   P R O C E S S I N G         ***
 21811******************************************************************
 21812
 21813 9910-EOJ-1.
 21814     IF TR-CNT = ZERO
 21815         IF (DTE-PGM-OPT = '2' OR '3') OR
 21816            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 21817                          'ITY' OR 'DAC' OR 'FLC')
 21818             NEXT SENTENCE
 21819         ELSE
 21820             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 21821             MOVE 0703                    TO WS-ABEND-CODE
 21822             DISPLAY '******************************'
 21823             DISPLAY '***** ERROR LOCATION 025 *****'
 21824             DISPLAY '******************************'
 21825             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 21826             GO TO ABEND-PGM.
 21827
 21828     MOVE '*'         TO TRANS-EOF-FLAG.
 21829     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 21830
 21831     IF EOF-ON-CERT
 21832         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 21833         GO TO 9940-EOJ-FIN.
 21834
 21835     GO TO 0330-MATCH-PENDING-TO-CERT.
 21836
 21837 9920-EOJ-2.
 21838     MOVE '*'         TO CERT-EOF-FLAG.
 21839     MOVE HIGH-VALUES TO CIR-CONTROL.
 21840
 21841     IF EOF-ON-TRANS
 21842         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 21843         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 21844         GO TO 9940-EOJ-FIN.
 21845
 21846     GO TO 0299-READ-CERT-X.
 21847
 21848 9930-EOJ-3.
 21849     IF PROCESSING-COMPLETED
 21850         GO TO 9950-EOJ-FIN-GO.
 21851
 21852     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 21853     MOVE 'MISSING ACCOUNT MASTER'
 21854                               TO WS-ABEND-MESSAGE.
 21855     MOVE 0302                 TO WS-ABEND-CODE.
 21856     DISPLAY '******************************'
 21857     DISPLAY '***** ERROR LOCATION 026 *****'
 21858     DISPLAY '******************************'
 21859     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 21860     GO TO ABEND-PGM.
 21861
 21862 9940-EOJ-FIN.
 21863     MOVE '*'        TO PROCESSING-FLAG.
 21864     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 21865
 21866     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 424
* ECS010D.cbl
 21867             0199-READ-ACCOUNT-X.
 21868     GO TO 9940-EOJ-FIN.
 21869
 21870 9950-EOJ-FIN-GO.
 21871     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 21872     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 21873*
 21874*
 21875* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 21876     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 21877
 21878 9960-NO-TOTS.
 21879
 21880     MOVE +15                    TO LN-CNT.
 21881     MOVE CMIN-CNT               TO TTL-PT-CNT.
 21882     IF ME-DO-UPDATE
 21883         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 21884
 21885     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 21886     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 21887     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 21888
 21889
 21890     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 21891     MOVE TR-TTL-HD              TO PRT.
 21892     PERFORM 8800-PRINT-ROUTINE.
 21893     ADD +1 TO LN-CNT.
 21894     MOVE TR-CNT                TO TTL-PT-CNT.
 21895     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 21896     MOVE TR-TTL-HD             TO PRT.
 21897     PERFORM 8800-PRINT-ROUTINE.
 21898     ADD +1 TO LN-CNT.
 21899
 21900     IF DUP-CNT = ZERO
 21901         GO TO 9969-CHECK-MISMATCHED-TOTS.
 21902
 21903     MOVE DUP-CNT                 TO TTL-PT-CNT.
 21904
 21905     IF ME-DO-UPDATE
 21906         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 21907
 21908     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 21909     MOVE TR-TTL-HD               TO PRT.
 21910     PERFORM 8800-PRINT-ROUTINE.
 21911     PERFORM 8800-PRINT-ROUTINE.
 21912     ADD +1 TO LN-CNT.
 21913
 21914     MOVE '1'                           TO  DTL-REC-TYPE.
 21915     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 21916     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 21917     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 21918                                        TO  DTL-CERT-OUT-CONTROL.
 21919     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 21920     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 21921     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 21922
 21923     MOVE +1 TO SUB3.
 21924 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 425
* ECS010D.cbl
 21925
 21926     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 21927         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 21928         MOVE MISMATCH-PAGE-NUMBER
 21929                                 TO  TR-PG
 21930         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 21931         MOVE MR-CTL             TO  X
 21932         MOVE X TO LCP-ASA
 21933         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21934             THRU LCP-WRITE-END-MISMATCH-RPT
 21935         MOVE TR-HD-2            TO  MISMATCH-RPT
 21936         MOVE MR-CTL             TO  X
 21937         MOVE X TO LCP-ASA
 21938         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21939             THRU LCP-WRITE-END-MISMATCH-RPT
 21940         MOVE TR-HD-3            TO  MISMATCH-RPT
 21941         MOVE MR-CTL             TO  X
 21942         MOVE X TO LCP-ASA
 21943         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21944             THRU LCP-WRITE-END-MISMATCH-RPT
 21945         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 21946         MOVE MR-CTL             TO  X
 21947         MOVE X TO LCP-ASA
 21948         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21949             THRU LCP-WRITE-END-MISMATCH-RPT
 21950         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 21951
 21952     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 21953
 21954     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 21955     MOVE MR-CTL                        TO  X.
 21956     ADD +2                             TO  MISMATCH-LINE-COUNT.
 21957
 21958     MOVE X TO LCP-ASA
 21959     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21960         THRU LCP-WRITE-END-MISMATCH-RPT.
 21961
 21962     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 21963     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 21964
 21965     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 21966     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 21967
 21968     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 21969     IF  DUPE-STATUS (SUB3)  =  '2'
 21970         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 21971     IF  DUPE-STATUS (SUB3)  =  '5'
 21972         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 21973     IF  DUPE-STATUS (SUB3)  =  'M'
 21974         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 21975     IF  DUPE-STATUS (SUB3)  =  '9'
 21976         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 21977     IF  DUPE-STATUS (SUB3)  =  'D'
 21978         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 21979     IF  DUPE-STATUS (SUB3)  =  'V'
 21980         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 21981     IF  DUPE-STATUS (SUB3)  =  'P'
 21982         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 426
* ECS010D.cbl
 21983
 21984     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 21985     MOVE MR-CTL                        TO  X.
 21986     ADD +1                             TO  MISMATCH-LINE-COUNT.
 21987
 21988     MOVE X TO LCP-ASA
 21989     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21990         THRU LCP-WRITE-END-MISMATCH-RPT.
 21991
 21992     IF SUB3 LESS THAN DUP-CNT
 21993         ADD +1 TO SUB3
 21994         GO TO 9965-PRT-DUPES.
 21995
 21996 9969-CHECK-MISMATCHED-TOTS.
 21997
 21998     IF W-MM-LF-PRM = ZEROS  AND
 21999        W-MM-AH-PRM = ZEROS  AND
 22000        W-MM-LF-RFD = ZEROS  AND
 22001        W-MM-AH-RFD = ZEROS  AND
 22002        W-MM-LF-CLM = ZEROS  AND
 22003        W-MM-AH-CLM = ZEROS
 22004         GO TO 9970-FIN-TOTS.
 22005
 22006     MOVE SPACES                        TO  MISMATCH-RPT.
 22007     MOVE '0'                           TO  MR-CTL  X.
 22008     MOVE X TO LCP-ASA
 22009     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 22010         THRU LCP-WRITE-END-MISMATCH-RPT.
 22011
 22012     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 22013     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 22014     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 22015
 22016     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 22017     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 22018     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 22019
 22020     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 22021     MOVE '0'                           TO  MR-CTL  X.
 22022     MOVE X TO LCP-ASA
 22023     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 22024         THRU LCP-WRITE-END-MISMATCH-RPT.
 22025
 22026     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 22027     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 22028     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 22029
 22030     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 22031     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 22032     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 22033
 22034     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 22035     MOVE '0'                           TO  MR-CTL  X.
 22036     MOVE X TO LCP-ASA
 22037     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 22038         THRU LCP-WRITE-END-MISMATCH-RPT.
 22039
 22040     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 427
* ECS010D.cbl
 22041     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 22042     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 22043
 22044     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 22045     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 22046     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 22047
 22048     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 22049     MOVE '0'                           TO  MR-CTL  X.
 22050     MOVE X TO LCP-ASA
 22051     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 22052         THRU LCP-WRITE-END-MISMATCH-RPT.
 22053
 22054 9970-FIN-TOTS.
 22055
 22056     MOVE CMOT-CNT                TO TTL-PT-CNT.
 22057
 22058     IF ME-DO-UPDATE
 22059         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 22060
 22061     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 22062     MOVE TR-TTL-HD               TO PRT.
 22063     PERFORM 8800-PRINT-ROUTINE.
 22064
 22065     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 22066     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 22067     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 22068     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 22069
 22070     MOVE DE-CNT                  TO TTL-PT-CNT.
 22071     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 22072     MOVE TR-TTL-HD               TO PRT.
 22073     PERFORM 8800-PRINT-ROUTINE.
 22074
 22075     MOVE EP-CNT                  TO TTL-PT-CNT.
 22076     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 22077     MOVE TR-TTL-HD               TO PRT.
 22078     PERFORM 8800-PRINT-ROUTINE.
 22079     PERFORM 8800-PRINT-ROUTINE.
 22080
 22081     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 22082     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 22083     MOVE TR-TTL-HD               TO PRT.
 22084     PERFORM 8800-PRINT-ROUTINE.
 22085
 22086     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 22087     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 22088     MOVE TR-TTL-HD               TO PRT.
 22089     PERFORM 8800-PRINT-ROUTINE.
 22090
 22091     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 22092     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 22093     MOVE TR-TTL-HD               TO PRT.
 22094     PERFORM 8800-PRINT-ROUTINE.
 22095
 22096     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 22097         GO TO 9990-FINAL-CLOSE.
 22098
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 428
* ECS010D.cbl
 22099**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 22100**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 22101**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 22102**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 22103
 22104     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 22105     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 22106     MOVE TR-TTL-HD               TO PRT.
 22107     PERFORM 8800-PRINT-ROUTINE.
 22108
 22109     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 22110     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 22111     MOVE TR-TTL-HD               TO PRT.
 22112     PERFORM 8800-PRINT-ROUTINE.
 22113
 22114     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 22115     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 22116     MOVE TR-TTL-HD               TO PRT.
 22117     PERFORM 8800-PRINT-ROUTINE.
 22118
 22119     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 22120     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 22121     MOVE TR-TTL-HD               TO PRT.
 22122     PERFORM 8800-PRINT-ROUTINE.
 22123
 22124     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 22125     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 22126     MOVE TR-TTL-HD               TO PRT.
 22127     PERFORM 8800-PRINT-ROUTINE.
 22128
 22129     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 22130     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 22131     MOVE TR-TTL-HD               TO PRT.
 22132     PERFORM 8800-PRINT-ROUTINE.
 22133
 22134     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 22135     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 22136     MOVE TR-TTL-HD               TO PRT.
 22137     PERFORM 8800-PRINT-ROUTINE.
 22138
 22139     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 22140     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 22141     MOVE TR-TTL-HD               TO PRT.
 22142     PERFORM 8800-PRINT-ROUTINE.
 22143
 22144     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 22145     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 22146     MOVE TR-TTL-HD               TO PRT.
 22147     PERFORM 8800-PRINT-ROUTINE.
 22148
 22149     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 22150     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 22151     MOVE TR-TTL-HD               TO PRT.
 22152     PERFORM 8800-PRINT-ROUTINE.
 22153
 22154     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 22155     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 22156     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 429
* ECS010D.cbl
 22157     PERFORM 8800-PRINT-ROUTINE.
 22158
 22159     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 22160     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 22161     MOVE TR-TTL-HD               TO PRT.
 22162     PERFORM 8800-PRINT-ROUTINE.
 22163
 22164     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 22165     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 22166     MOVE TR-TTL-HD               TO PRT.
 22167     PERFORM 8800-PRINT-ROUTINE.
 22168
 22169     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 22170     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 22171     MOVE TR-TTL-HD               TO PRT.
 22172     PERFORM 8800-PRINT-ROUTINE.
 22173
 22174     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 22175     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 22176     MOVE TR-TTL-HD               TO PRT.
 22177     PERFORM 8800-PRINT-ROUTINE.
 22178
 22179     MOVE W-AH-REIN               TO TTL-PT-CNT.
 22180     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 22181     MOVE TR-TTL-HD               TO PRT.
 22182     PERFORM 8800-PRINT-ROUTINE.
 22183
 22184     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 22185     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 22186     MOVE TR-TTL-HD               TO PRT.
 22187     PERFORM 8800-PRINT-ROUTINE.
 22188
 22189     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 22190     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 22191     MOVE TR-TTL-HD               TO PRT.
 22192     PERFORM 8800-PRINT-ROUTINE.
 22193
 22194     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 22195     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 22196     MOVE TR-TTL-HD               TO PRT.
 22197     PERFORM 8800-PRINT-ROUTINE.
 22198
 22199     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 22200     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 22201     MOVE TR-TTL-HD               TO PRT.
 22202     PERFORM 8800-PRINT-ROUTINE.
 22203
 22204     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 22205     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 22206     MOVE TR-TTL-HD               TO PRT.
 22207     PERFORM 8800-PRINT-ROUTINE.
 22208
 22209     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 22210     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 22211     MOVE TR-TTL-HD               TO PRT.
 22212     PERFORM 8800-PRINT-ROUTINE.
 22213
 22214     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 430
* ECS010D.cbl
 22215     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 22216     MOVE TR-TTL-HD               TO PRT.
 22217     PERFORM 8800-PRINT-ROUTINE.
 22218
 22219     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 22220     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 22221     MOVE TR-TTL-HD               TO PRT.
 22222     PERFORM 8800-PRINT-ROUTINE.
 22223
 22224     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 22225     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 22226     MOVE TR-TTL-HD               TO PRT.
 22227     PERFORM 8800-PRINT-ROUTINE.
 22228
 22229     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 22230     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 22231     MOVE TR-TTL-HD               TO PRT.
 22232     PERFORM 8800-PRINT-ROUTINE.
 22233
 22234     MOVE W-LF-REIN               TO TTL-PT-CNT.
 22235     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 22236     MOVE TR-TTL-HD               TO PRT.
 22237     PERFORM 8800-PRINT-ROUTINE.
 22238
 22239     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 22240     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 22241     MOVE TR-TTL-HD               TO PRT.
 22242     PERFORM 8800-PRINT-ROUTINE.
 22243
 22244     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 22245     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 22246     MOVE TR-TTL-HD               TO PRT.
 22247     PERFORM 8800-PRINT-ROUTINE.
 22248
 22249     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 22250     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 22251     MOVE TR-TTL-HD               TO PRT.
 22252     PERFORM 8800-PRINT-ROUTINE.
 22253
 22254     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 22255     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 22256     MOVE TR-TTL-HD               TO PRT.
 22257     PERFORM 8800-PRINT-ROUTINE.
 22258
 22259     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 22260     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 22261     MOVE TR-TTL-HD               TO PRT.
 22262     PERFORM 8800-PRINT-ROUTINE.
 22263
 22264     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 22265     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 22266     MOVE TR-TTL-HD               TO PRT.
 22267     PERFORM 8800-PRINT-ROUTINE.
 22268
 22269     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 22270     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 22271     MOVE TR-TTL-HD               TO PRT.
 22272     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 431
* ECS010D.cbl
 22273
 22274     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 22275     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 22276     MOVE TR-TTL-HD               TO PRT.
 22277     PERFORM 8800-PRINT-ROUTINE.
 22278
 22279     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 22280     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 22281     MOVE TR-TTL-HD               TO PRT.
 22282     PERFORM 8800-PRINT-ROUTINE.
 22283
 22284     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 22285     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 22286     MOVE TR-TTL-HD               TO PRT.
 22287     PERFORM 8800-PRINT-ROUTINE.
 22288
 22289     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 22290     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 22291     MOVE TR-TTL-HD               TO PRT.
 22292     PERFORM 8800-PRINT-ROUTINE.
 22293
 22294     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 22295     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 22296     MOVE TR-TTL-HD               TO PRT.
 22297     PERFORM 8800-PRINT-ROUTINE.
 22298
 22299     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 22300     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 22301                                  TO TTL-HD-DS.
 22302     MOVE TR-TTL-HD               TO PRT.
 22303     PERFORM 8800-PRINT-ROUTINE.
 22304
 22305     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 22306     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 22307                                  TO TTL-HD-DS.
 22308     MOVE TR-TTL-HD               TO PRT.
 22309     PERFORM 8800-PRINT-ROUTINE.
 22310
 22311     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 22312     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 22313                                  TO TTL-HD-DS.
 22314     MOVE TR-TTL-HD               TO PRT.
 22315     PERFORM 8800-PRINT-ROUTINE.
 22316
 22317     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 22318     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 22319                                  TO TTL-HD-DS.
 22320     MOVE TR-TTL-HD               TO PRT.
 22321     PERFORM 8800-PRINT-ROUTINE.
 22322
 22323     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 22324     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 22325                                  TO TTL-HD-DS.
 22326     MOVE TR-TTL-HD               TO PRT.
 22327     PERFORM 8800-PRINT-ROUTINE.
 22328
 22329     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 22330     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 432
* ECS010D.cbl
 22331                                  TO TTL-HD-DS.
 22332     MOVE TR-TTL-HD               TO PRT.
 22333     PERFORM 8800-PRINT-ROUTINE.
 22334
 22335     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 22336     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 22337     MOVE TR-TTL-HD               TO PRT.
 22338     PERFORM 8800-PRINT-ROUTINE.
 22339
 22340     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 22341     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 22342     MOVE TR-TTL-HD               TO PRT.
 22343     PERFORM 8800-PRINT-ROUTINE.
 22344
 22345     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 22346     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 22347     MOVE TR-TTL-HD               TO PRT.
 22348     PERFORM 8800-PRINT-ROUTINE.
 22349
 22350     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 22351     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 22352     MOVE TR-TTL-HD               TO PRT.
 22353     PERFORM 8800-PRINT-ROUTINE.
 22354
 22355     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 22356     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 22357     MOVE TR-TTL-HD               TO PRT.
 22358     PERFORM 8800-PRINT-ROUTINE.
 22359
 22360     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 22361     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 22362     MOVE TR-TTL-HD               TO PRT.
 22363     PERFORM 8800-PRINT-ROUTINE.
 22364
 22365     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 22366     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 22367     MOVE TR-TTL-HD               TO PRT.
 22368     PERFORM 8800-PRINT-ROUTINE.
 22369
 22370     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 22371     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 22372     MOVE TR-TTL-HD               TO PRT.
 22373     PERFORM 8800-PRINT-ROUTINE.
 22374
 22375     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 22376     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 22377     MOVE TR-TTL-HD               TO PRT.
 22378     PERFORM 8800-PRINT-ROUTINE.
 22379
 22380     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 22381     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 22382     MOVE TR-TTL-HD               TO PRT.
 22383     PERFORM 8800-PRINT-ROUTINE.
 22384
 22385     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 22386     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 22387     MOVE TR-TTL-HD               TO PRT.
 22388     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 433
* ECS010D.cbl
 22389
 22390     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 22391     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 22392     MOVE TR-TTL-HD               TO PRT.
 22393     PERFORM 8800-PRINT-ROUTINE.
 22394
 22395     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 22396     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 22397     MOVE TR-TTL-HD               TO PRT.
 22398     PERFORM 8800-PRINT-ROUTINE.
 22399
 22400     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 22401     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 22402     MOVE TR-TTL-HD               TO PRT.
 22403     PERFORM 8800-PRINT-ROUTINE.
 22404
 22405     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 22406     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 22407     MOVE TR-TTL-HD               TO PRT.
 22408     PERFORM 8800-PRINT-ROUTINE.
 22409
 22410     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 22411     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 22412     MOVE TR-TTL-HD               TO PRT.
 22413     PERFORM 8800-PRINT-ROUTINE.
 22414
 22415     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 22416     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 22417     MOVE TR-TTL-HD               TO PRT.
 22418     PERFORM 8800-PRINT-ROUTINE.
 22419
 22420     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 22421     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 22422     MOVE TR-TTL-HD               TO PRT.
 22423     PERFORM 8800-PRINT-ROUTINE.
 22424
 22425     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 22426     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 22427     MOVE TR-TTL-HD               TO PRT.
 22428     PERFORM 8800-PRINT-ROUTINE.
 22429
 22430     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 22431     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 22432     MOVE TR-TTL-HD               TO PRT.
 22433     PERFORM 8800-PRINT-ROUTINE.
 22434
 22435     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 22436     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 22437     MOVE TR-TTL-HD               TO PRT.
 22438     PERFORM 8800-PRINT-ROUTINE.
 22439
 22440     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 22441     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 22442     MOVE TR-TTL-HD               TO PRT.
 22443     PERFORM 8800-PRINT-ROUTINE.
 22444
 22445     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 22446     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 434
* ECS010D.cbl
 22447     MOVE TR-TTL-HD               TO PRT.
 22448     PERFORM 8800-PRINT-ROUTINE.
 22449
 22450     MOVE W-1-EP                  TO TTL-PT-CNT.
 22451     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 22452     MOVE TR-TTL-HD               TO PRT.
 22453     PERFORM 8800-PRINT-ROUTINE.
 22454
 22455     MOVE W-P-EP                  TO TTL-PT-CNT.
 22456     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 22457     MOVE TR-TTL-HD               TO PRT.
 22458     PERFORM 8800-PRINT-ROUTINE.
 22459
 22460     MOVE W-M-EP                  TO TTL-PT-CNT.
 22461     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 22462     MOVE TR-TTL-HD               TO PRT.
 22463     PERFORM 8800-PRINT-ROUTINE.
 22464
 22465     MOVE W-R-EP                  TO TTL-PT-CNT.
 22466     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 22467     MOVE TR-TTL-HD               TO PRT.
 22468     PERFORM 8800-PRINT-ROUTINE.
 22469
 22470     MOVE W-WY-EP                 TO TTL-PT-CNT.
 22471     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 22472     MOVE TR-TTL-HD               TO PRT.
 22473     PERFORM 8800-PRINT-ROUTINE.
 22474
 22475     MOVE W-VA-EP                 TO TTL-PT-CNT.
 22476     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 22477     MOVE TR-TTL-HD               TO PRT.
 22478     PERFORM 8800-PRINT-ROUTINE.
 22479
 22480     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 22481     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 22482     MOVE TR-TTL-HD               TO PRT.
 22483     PERFORM 8800-PRINT-ROUTINE.
 22484
 22485     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 22486     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 22487     MOVE TR-TTL-HD               TO PRT.
 22488     PERFORM 8800-PRINT-ROUTINE.
 22489
 22490     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 22491     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 22492     MOVE TR-TTL-HD               TO PRT.
 22493     PERFORM 8800-PRINT-ROUTINE.
 22494
 22495     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 22496     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 22497     MOVE TR-TTL-HD               TO PRT.
 22498     PERFORM 8800-PRINT-ROUTINE.
 22499
 22500     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 22501     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 22502     MOVE TR-TTL-HD               TO PRT.
 22503     PERFORM 8800-PRINT-ROUTINE.
 22504
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 435
* ECS010D.cbl
 22505     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 22506     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 22507     MOVE TR-TTL-HD               TO PRT.
 22508     PERFORM 8800-PRINT-ROUTINE.
 22509
 22510     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 22511     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 22512     MOVE TR-TTL-HD               TO PRT.
 22513     PERFORM 8800-PRINT-ROUTINE.
 22514
 22515     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 22516     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 22517     MOVE TR-TTL-HD               TO PRT.
 22518     PERFORM 8800-PRINT-ROUTINE.
 22519
 22520     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 22521     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 22522     MOVE TR-TTL-HD               TO PRT.
 22523     PERFORM 8800-PRINT-ROUTINE.
 22524
 22525 9990-FINAL-CLOSE.
*22526                             COPY ELCPRTC.
 22527******************************************************************04/15/98
 22528*                                                                *ELCPRTC
 22529*                                                                *ELCPRTC
 22530*                            ELCPRTC.                            *   LV003
 22531*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22532*                            VMOD=2.002                          *   CL**2
 22533*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 22534*                                                                *ELCPRTC
 22535* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 22536******************************************************************ELCPRTC
 22537                                                                  ELCPRTC
 22538      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 22539          CLOSE FICH.                                             ELCPRTC
 22540                                                                  ELCPRTC
 22541******************************************************************ELCPRTC
 22542
 22543     IF DTE-CLIENT = 'DMD'
 22544         CLOSE ERRESC-IN.
 22545
 22546     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 22547
 22548     DISPLAY ' '.
 22549     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 22550     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 22551     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 22552     DISPLAY ' '.
 22553
 22554     MOVE    ' DISPLAY ERROR COUNT = '
 22555       TO  DIS-LINE-REASON.
 22556     MOVE  ERROR-COUNT
 22557       TO  DIS-LINE-REC.
 22558         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 22559
 22560     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 22561           DISPLAY-PRT
 22562           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 436
* ECS010D.cbl
 22563           ME50-ECS010-BALANCE
 22564           PENDING-EXTRACT  SUMMARY-EXTR.
 22565
 22566     IF DTE-PGM-OPT = '1'
 22567         CLOSE CERT-MASTER-OUT
 22568               DETAIL-EXTR.
 22569
 22570     IF ERACCTT-FILE-STATUS NOT = '00'
 22571         MOVE '12'                TO ABEND-CODE-1
 22572         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 22573         DISPLAY '******************************'
 22574         DISPLAY '***** ERROR LOCATION 027 *****'
 22575         DISPLAY '******************************'
 22576         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22577           GO TO ABEND-PGM.
 22578
 22579     IF COMM-OPEN-SW = 'X'
 22580         CLOSE ERCTBL
 22581         IF ERCTBL-FILE-STATUS NOT = '00'
 22582             MOVE '42'               TO ABEND-CODE-1
 22583             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 22584             DISPLAY '******************************'
 22585             DISPLAY '***** ERROR LOCATION 028 *****'
 22586             DISPLAY '******************************'
 22587             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22588             GO TO ABEND-PGM.
 22589
 22590     IF REIN-OPEN-SW = 'X'
 22591         CLOSE ERRTBL-IN
 22592         IF ERRTBL-FILE-STATUS NOT = '00'
 22593             MOVE '22'               TO ABEND-CODE-1
 22594             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 22595             DISPLAY '******************************'
 22596             DISPLAY '***** ERROR LOCATION 029 *****'
 22597             DISPLAY '******************************'
 22598             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22599             GO TO ABEND-PGM.
 22600
 22601     MOVE 'C'                         TO CP-IO-FUNCTION.
 22602     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 22603     IF IO-ERROR
 22604         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 22605                                      TO WS-ABEND-MESSAGE
 22606         MOVE 0302                    TO WS-RETURN-CODE
 22607         DISPLAY '******************************'
 22608         DISPLAY '***** ERROR LOCATION 030 *****'
 22609         DISPLAY '******************************'
 22610         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22611         GO TO ABEND-PGM.
 22612
 22613     IF ME-DO-UPDATE
 22614           MOVE ME-START-TIME        TO ME-010-START
*  12-S***************************************************             ( 283)**
**    Operand ME-010-START is not declared
 22615           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 22616           ACCEPT WS-TIME-OF-DAY   FROM TIME
 22617           MOVE WS-TIME              TO ME-010-END
*  12-S*************************************************               ( 436)**
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 437
* ECS010D.cbl
**    Operand ME-010-END is not declared
 22618           ADD 1 TO ME-010-RUN-CT
 22619           REWRITE MONTH-END-BALANCES
 22620           DISPLAY 'MONTH-END BALANCES POSTED'
 22621           CLOSE ERMEBL-INOUT
 22622     ELSE
 22623         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 22624
 22625     GO TO 9999-END-THE-JOB.
 22626
 22627 CERT-DATE-LOAD.
*22628     COPY ELCCRTM1.
 22629******************************************************************04/15/98
 22630*                                                                *ELCCRTM1
 22631*                                                                *ELCCRTM1
 22632*                            ELCCRTM1                            *   LV003
 22633*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22634*                            VMOD=2.001                          *ELCCRTM1
 22635*                                                                *ELCCRTM1
 22636*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 22637*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 22638*                                                                *ELCCRTM1
 22639******************************************************************ELCCRTM1
 22640     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 22641     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 22642     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 22643     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 22644     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 22645     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 22646     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 22647     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 22648     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 22649                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 22650     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 22651                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 22652     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 22653     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 22654     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 22655     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 22656     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 22657     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 22658           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 22659                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 22660     END-PERFORM.                                                 ELCCRTM1
 22661                                                                  ELCCRTM1
 22662
 22663 EXTRACT-DATE-LOAD.
*22664     COPY ELCEXTM1.
 22665******************************************************************04/15/98
 22666*                                                                *ELCEXTM1
 22667*                                                                *ELCEXTM1
 22668*                            ELCEXTM1                            *   LV010
 22669*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 22670*                            VMOD=2.001                          *ELCEXTM1
 22671*                                                                *ELCEXTM1
 22672*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
 22673*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 22674*                                                                *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 438
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 22675******************************************************************ELCEXTM1
 22676                                                                  ELCEXTM1
 22677     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 22678     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 22679     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 22680     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 22681     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 22682     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 22683                                                                     CL**9
 22684     EVALUATE TRUE                                                   CL**5
 22685        WHEN DE-ISSUE      OR                                        CL**8
 22686             DE-RC-ISSUE   OR                                        CL**8
 22687             DE-RR-RC-ISS  OR                                        CL**8
 22688             DE-CANCEL     OR                                        CL**8
 22689             DE-RC-CANCEL  OR                                        CL**8
 22690             DE-RR-RC-CNC                                            CL**8
 22691           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 22692                                                                     CL**9
 22693        WHEN DE-CLAIM      OR                                        CL**8
 22694             DE-RR-RC-CLM                                            CL**6
 22695           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 22696           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 22697           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 22698           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 22699           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 22700           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 22701                                                                     CL**9
 22702        WHEN DE-RESERVE                                              CL**9
 22703           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 22704           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 22705           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 22706                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 22707           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 22708                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 22709           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 22710     END-EVALUATE.                                                   CL**9
 22711                                                                     CL**9
 22712
 22713 EXTRACT-DATE-RELOAD.
*22714     COPY ELCEXTM2.
 22715******************************************************************04/15/98
 22716*                                                                *ELCEXTM2
 22717*                                                                *ELCEXTM2
 22718*                            ELCEXTM2                            *   LV011
 22719*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 22720*                            VMOD=2.001                          *ELCEXTM2
 22721*                                                                *ELCEXTM2
 22722*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 22723*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 22724*                                                                *   CL**9
 22725******************************************************************ELCEXTM2
 22726                                                                  ELCEXTM2
 22727     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 22728     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 22729     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 22730     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
 22731     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 22732     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 439
* ECS010D.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 22733                                                                     CL*10
 22734     EVALUATE TRUE                                                   CL*10
 22735        WHEN DE-ISSUE      OR                                        CL*10
 22736             DE-RC-ISSUE   OR                                        CL*10
 22737             DE-RR-RC-ISS  OR                                        CL*10
 22738             DE-CANCEL     OR                                        CL*10
 22739             DE-RC-CANCEL  OR                                        CL*10
 22740             DE-RR-RC-CNC                                            CL*10
 22741           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 22742                                                                     CL*10
 22743        WHEN DE-CLAIM      OR                                        CL*10
 22744             DE-RR-RC-CLM                                            CL**7
 22745           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 22746           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 22747           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 22748           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 22749           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 22750           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 22751                                                                     CL*10
 22752        WHEN DE-RESERVE                                              CL**7
 22753            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 22754            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 22755            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 22756                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 22757            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 22758                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 22759            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 22760     END-EVALUATE.                                                   CL**5
 22761                                                                  ELCEXTM2
 22762
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 440
* ECS010D.cbl
 22764 ABEND-PGM.
 22765     DISPLAY '******************************'
 22766     DISPLAY '***** ABEND PGM **************'
 22767     DISPLAY '******************************'
*22768                             COPY ELCABEND.
 22769***************************************************************** 04/14/98
 22770*                                                               * ELCABEND
 22771*                            ELCABEND.                          *    LV003
 22772*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22773*                            VMOD 2.002                              CL**2
 22774*                                                               * ELCABEND
 22775*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22776*            AND THEN ABENDS.                                   * ELCABEND
 22777*                                                               * ELCABEND
 22778*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 22779*                                                               * ELCABEND
 22780***************************************************************** ELCABEND
 22781*APS-010.                                                         ELCABEND
 22782     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22783     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22784                                                                  ELCABEND
 22785     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22786         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22787         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22788                                 UPON CONSOLE.                    ELCABEND
 22789                                                                  ELCABEND
 22790     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22791         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22792         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22793                                 UPON CONSOLE.                    ELCABEND
 22794                                                                  ELCABEND
 22795     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22796     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22797                                 UPON CONSOLE.                    ELCABEND
 22798                                                                  ELCABEND
 22799     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22800     CALL 'ABORTME'.
 22801                                                                  ELCABEND
 22802 APS-EXIT.                                                        ELCABEND
 22803     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 441
* ECS010D.cbl
 22805 9999-END-THE-JOB.
 22806
 22807     DISPLAY ' '.
 22808     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 22809         'ECS010 ******'
 22810     DISPLAY ' '.
 22811     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 442
* ECS010D.cbl
 22812/
 22813 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 22814     IF LCP-ASA = '+'
 22815         WRITE MISMATCH-RPT AFTER 0 LINE
 22816     ELSE
 22817     IF LCP-ASA = ' '
 22818         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 22819     ELSE
 22820     IF LCP-ASA = '0'
 22821         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 22822     ELSE
 22823     IF LCP-ASA = '-'
 22824         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 22825     ELSE
 22826     IF LCP-ASA = '1'
 22827         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 22828     ELSE
 22829     IF LCP-ASA = '2'
 22830         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 22831     ELSE
 22832     IF LCP-ASA = '3'
 22833         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 22834     ELSE
 22835     IF LCP-ASA = '4'
 22836         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 22837     ELSE
 22838     IF LCP-ASA = '5'
 22839         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 22840     ELSE
 22841     IF LCP-ASA = '6'
 22842         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 22843     ELSE
 22844     IF LCP-ASA = '7'
 22845         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 22846     ELSE
 22847     IF LCP-ASA = '8'
 22848         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 22849     ELSE
 22850     IF LCP-ASA = '9'
 22851         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 22852     ELSE
 22853     IF LCP-ASA = 'A'
 22854         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 22855     ELSE
 22856     IF LCP-ASA = 'B'
 22857         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 22858     ELSE
 22859     IF LCP-ASA = 'C'
 22860         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 22861     ELSE
 22862     IF LCP-ASA = 'V'
 22863         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 22864     ELSE
 22865     IF LCP-ASA = 'W'
 22866         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 22867     ELSE
 22868     DISPLAY 'ASA CODE ERROR'.
 22869 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 443
* ECS010D.cbl
 22870     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  436
* Total Messages:     5
* Unrecoverable :     0                    Severe  :     2
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     2176773     Code:           0
