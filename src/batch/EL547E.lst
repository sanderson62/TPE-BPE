* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* EL547E.cbl
* Options: int("EL547E.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL547E.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL547E.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL547E.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EL547E.
     3 AUTHOR.        CENTRAL STATES HEALTH AND LIFE.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     6*REMARKS.
     7*    THIS PROGRAM READS THE MONTH END CERT FILE AND CLMS FILE
     8*    AND BUILDS AN EXTRACT BY ISSUE YEAR.  THE EXTRACT IS
     9*    PRIMARLIY USED BY ACTUARIAL.  THE REFUNDS SELECTED ARE
    10*    PLACED IN THE VALUATION YEAR BASED ON THE CANCEL DATE.
    11*    THE CLAIMS SELECTED ARE PLACED IN THE VALUATION YEAR
    12*    BASED ON INCURRED DATE.  THE LOWEST ISSUE YEAR WILL ALWAYS
    13*    BE 1986.  IF YOU NEED TO CHANGE THAT SIMPLY CHANGE THE
    14*    HARD CODING WHERE YOU FIND MOVE 1986 TO LO-ISSUE AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* EL547E.cbl
    15*    LO-VALUATION.  ANY CHANGES MADE TO THE SPECIAL ECS083
    16*    MUST ALSO BE MADE IN THIS PROGRAM.
    18 ENVIRONMENT DIVISION.
    19 INPUT-OUTPUT SECTION.
    20 FILE-CONTROL.
    21
    22     SELECT CERTS        ASSIGN TO
    23*       '/data/seqfiles/ZI.XX.CERT.PEMA'.
    24        SYS010.
    25     SELECT EXTRACT      ASSIGN TO
    26*       '/data/seqfiles/ZI.XX.EXTR547'
    27        SYS011
    28        ORGANIZATION IS LINE SEQUENTIAL.
    29     SELECT CLMS-HIST    ASSIGN TO
    30*       '/data/seqfiles/ZI.XX.CLMS.A15860'.
    31        SYS013.
    32     SELECT DISK-DATE    ASSIGN TO
    33*       '/data/seqfiles/ZI.DD.ER.DATECARD.EL547'.
    34        SYS019.
    35     SELECT PRINTX       ASSIGN TO
    36*       '/data/seqfiles/sys008'.
    37        SYS008.
    38
    39 DATA DIVISION.
    40 FILE SECTION.
    41
    42 FD  CLMS-HIST
*   43                                 COPY ECSEXTFD.
    44******************************************************************07/10/97
    45*                                                                *ECSEXTFD
    46*                            ECSEXTFD                            *   LV001
    47*                            VMOD=2.001                          *ECSEXTFD
    48*                                                                *ECSEXTFD
    49*  NO  CID  MODS  IN  COPYBOOK  ECSEXTFD                         *ECSEXTFD
    50*                                                                *ECSEXTFD
    51******************************************************************ECSEXTFD
    52     RECORDING MODE F                                             ECSEXTFD
    53     LABEL RECORDS STANDARD                                       ECSEXTFD
    54     BLOCK CONTAINS 0 RECORDS
    55     RECORD CONTAINS 510 CHARACTERS.                              ECSEXTFD
    56******************************************************************ECSEXTFD
*   57                                 COPY ECSEXT01.
    58******************************************************************04/29/98
    59*                                                                *ECSEXT01
    60*                            ECSEXT01                            *   LV015
    61*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
    62*                            VMOD=2.015                          *ECSEXT01
    63*                                                                *ECSEXT01
    64*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
    65*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
    66*                                                                *ECSEXT01
    67*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
    68*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
    69*                                                                *ECSEXT01
    70*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
    71*                                                                *ECSEXT01
    72******************************************************************ECSEXT01
    73******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* EL547E.cbl (/apps/prod/cid1p/copy/ECSEXT01)
    74*                   C H A N G E   L O G
    75*
    76* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    77*-----------------------------------------------------------------
    78*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    79* EFFECTIVE    NUMBER
    80*-----------------------------------------------------------------
    81* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    82* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
    83* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    84* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
    85* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    86* 032612  CR2011110200001  PEMA  AHL CHANGES
    87******************************************************************
    88                                                                  ECSEXT01
    89 01  DETAIL-EXTRACT.                                              ECSEXT01
    90     02 DETAIL-FILE.                                              ECSEXT01
    91     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
    92         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
    93                                                                  ECSEXT01
    94     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
    95                                                                  ECSEXT01
    96     12  DE-REIN                           PIC X.                 ECSEXT01
    97                                                                  ECSEXT01
    98     12  DE-CONTROL.                                              ECSEXT01
    99         16  DE-CNTRL1.                                           ECSEXT01
   100             20  DE-CARRIER                PIC X.                 ECSEXT01
   101             20  DE-GROUPING.                                     ECSEXT01
   102                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
   103                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
   104             20  DE-STATE                  PIC XX.                ECSEXT01
   105             20  DE-ACCOUNT.                                      ECSEXT01
   106                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
   107                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
   108         16  DE-CNTRL2.                                           ECSEXT01
   109             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
   110             20  DE-CERT.                                         ECSEXT01
   111                 24 DE-CERT-NO.                                   ECSEXT01
   112                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
   113                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
   114                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
   115                                                                  ECSEXT01
   116     12  DE-TRANS                          PIC X.                 ECSEXT01
   117         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
   118         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
   119         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
   120         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
   121         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
   122         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
   123         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
   124         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
   125         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
   126         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
   127                                                                  ECSEXT01
   128     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
   129     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
   130                                                                  ECSEXT01
   131     12  DE-NAME.                                                 ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* EL547E.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   132         16  DE-LNAME                      PIC X(15).             ECSEXT01
   133         16  DE-FNAME.                                            ECSEXT01
   134             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
   135             20  FILLER                    PIC X(9).              ECSEXT01
   136         16  DE-INIT                       PIC X.                 ECSEXT01
   137     12  DE-AGE                            PIC 99.                ECSEXT01
   138     12  DE-SEX                            PIC X.                 ECSEXT01
   139     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
   140                                                                  ECSEXT01
   141     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
   142     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
   143     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
   144     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
   145     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   146     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
   147     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
   148     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
   149     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   150                                                                  ECSEXT01
   151     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
   152     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
   153     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
   154     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
   155                                                                  ECSEXT01
   156     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
   157     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
   158     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
   159     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   160     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   161                                                                  ECSEXT01
   162     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
   163     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
   164     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   165     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
   166                                                                  ECSEXT01
   167     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
   168     12  DE-ADDL-CLP REDEFINES DE-LIVES
   169                                           PIC S9(5)V99   COMP-3.
   170     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
   171     12  FILLER REDEFINES DE-NUM-BILLED.
   172         16  DE-CLP-STATE                  PIC XX.
   173         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
   174     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
   175     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
   176                                                                  ECSEXT01
   177     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
   178     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
   179     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
   180     12  DE-IG                             PIC X.                 ECSEXT01
   181     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
   182*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
   183     12  DE-MEMBER-NO.                                            ECSEXT01
   184         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
   185         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
   186         16  FILLER                        PIC X(03).             ECSEXT01
   187     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
   188                                                                  ECSEXT01
   189     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* EL547E.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   190         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
   191                                                                  ECSEXT01
   192     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
   193     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
   194                                                                  ECSEXT01
   195     12  DE-REI-AREA.                                             ECSEXT01
   196         16  DE-REI-COMP.                                         ECSEXT01
   197             20  DE-REINCO                 PIC XXX.               ECSEXT01
   198             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
   199         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   200         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   201         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   202         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
   203         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   204         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   205         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   206                                                                  ECSEXT01
   207     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   208     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
   209         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
   210         16  F                             PIC X.
   211*    12  FILLER                            PIC X(5).              ECSEXT01
   212                                                                  ECSEXT01
   213     12  DE-BILLED-AREA.                                          ECSEXT01
   214         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
   215             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
   216                                                                  ECSEXT01
   217         16  DE-BILL-SW                    PIC X.                 ECSEXT01
   218             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
   219             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
   220             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
   221             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
   222             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
   223             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
   224                                                                  ECSEXT01
   225         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
   226             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
   227                                                                  ECSEXT01
   228         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   229         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   230         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   231         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   232                                                                  ECSEXT01
   233         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
   234*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
   235*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
   236                                                                  ECSEXT01
   237     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
   238         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
   239         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
   240         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
   241                                                                  ECSEXT01
   242     12  DE-REVERSE-REASONS.                                      ECSEXT01
   243         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
   244         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
   245     12  DE-CANCEL-REASON                  PIC X.
   246                                                                  ECSEXT01
   247     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* EL547E.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   248     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
   249                                                                  ECSEXT01
   250     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
   251         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   252             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
   253         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   254             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
   255                                                                  ECSEXT01
   256     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
   257         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
   258                                                                  ECSEXT01
   259     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
   260     12  FILLER REDEFINES DE-NCL-POOL-CODE.
   261         16  DE-LOAN-TERM                  PIC S999 COMP-3.
   262         16  FILLER                        PIC X.
   263                                                                  ECSEXT01
   264****************************************************************  ECSEXT01
   265**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
   266****************************************************************  ECSEXT01
   267     12  DE-COMM-LEVELS.                                          ECSEXT01
   268         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
   269             20  DE-AGT.                                          ECSEXT01
   270                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
   271                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
   272             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
   273             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   274             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   275                                                                  ECSEXT01
   276     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
   277****************************************************************  ECSEXT01
   278*******                 CLAIM EXTRACT                      *****  ECSEXT01
   279****************************************************************  ECSEXT01
   280     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
   281     12  FILLER                            PIC X(334).            ECSEXT01
   282     12  DE-TYPE                           PIC X.                 ECSEXT01
   283         88  DE-DTH                           VALUE '1'.          ECSEXT01
   284         88  DE-AH                            VALUE '2'.          ECSEXT01
   285         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
   286         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
   287         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
   288         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
   289                                                                  ECSEXT01
   290     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
   291     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   292                                                                  ECSEXT01
   293     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
   294     12  DE-REPORTED.                                             ECSEXT01
   295         16  DE-RPT-YR                     PIC 99.                ECSEXT01
   296         16  DE-RPT-MO                     PIC 99.                ECSEXT01
   297         16  DE-RPT-DA                     PIC 99.                ECSEXT01
   298     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
   299     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
   300                                                                  ECSEXT01
   301     12  DE-CNUM                           PIC X(7).              ECSEXT01
   302     12  DE-CHECK                          PIC X(7).              ECSEXT01
   303     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
   304     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
   305     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* EL547E.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   306     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
   307         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
   308         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
   309         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
   310         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
   311         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
   312         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
   313         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
   314                                                                  ECSEXT01
   315     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
   316                                                                  ECSEXT01
   317     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
   318     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   319     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   320     12  FILLER                            PIC XX.                ECSEXT01
   321     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
   322                                                                  ECSEXT01
   323     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
   324     12  DE-BENEFICIARY                    PIC X(10).
   325     12  filler redefines de-beneficiary.
   326         16  de-birth-date                 pic 9(11)  comp-3.
   327         16  f                             pic x(4).
   328     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
   329     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
   330     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
   331     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
   332     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
   333     12  DE-CLM-CLASS                      PIC XX.
   334     12  DE-CLM-DEV                        PIC XXX.
   335     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
   336     12  de-xycor-cert-seq                 pic x(3).
   337     12  DE-XYCOR-CHECK-NO                 PIC X(8).
   338     12  DE-XYCOR-ACTION-CD                PIC XXX.
   339     12  DE-XYCOR-STATUS                   PIC X.
   340     12  FILLER                            PIC X(4).              ECSEXT01
   341                                                                  ECSEXT01
   342     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   343                                                                  ECSEXT01
   344****************************************************************  ECSEXT01
   345*******               RESERVE EXTRACT                      *****  ECSEXT01
   346****************************************************************  ECSEXT01
   347     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
   348     12  FILLER                            PIC X(334).            ECSEXT01
   349                                                                  ECSEXT01
   350     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
   351         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
   352         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
   353                                                                  ECSEXT01
   354     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
   355     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
   356     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
   357                                                                  ECSEXT01
   358     12  DE-CLMNO                          PIC X(7).              ECSEXT01
   359                                                                  ECSEXT01
   360     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
   361     12  DE-RSV-REPORTED.                                         ECSEXT01
   362         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
   363         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* EL547E.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   364         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
   365     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
   366                                                                  ECSEXT01
   367     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
   368     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
   369     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
   370                                                                  ECSEXT01
   371     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
   372     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   373     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   374                                                                  ECSEXT01
   375     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
   376                                                                  ECSEXT01
   377     12  DE-RATE-CLASS                     PIC XX.
   378     12  DE-DEV-CODE                       PIC XXX.
   379     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
   380     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
   381     12  FILLER                            PIC X(58).             ECSEXT01
   382                                                                  ECSEXT01
   383     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   384******************************************************************ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* EL547E.cbl
   385/
   386
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* EL547E.cbl
   388 FD  CERTS
*  389                                 COPY ECSCRIFD.
   390******************************************************************07/10/97
   391*                                                                *ECSCRIFD
   392*                            ECSCRIFD                            *   LV001
   393*                            VMOD 2.005                          *ECSCRIFD
   394*                                                                *ECSCRIFD
   395*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   396*                                                                *ECSCRIFD
   397******************************************************************ECSCRIFD
   398     BLOCK CONTAINS 0 RECORDS
   399     RECORDING MODE F.                                            ECSCRIFD
   400                                                                  ECSCRIFD
   401 01  CERT-IN-RECORD.                                              ECSCRIFD
   402                                                                  ECSCRIFD
   403     12  FILLER                            PIC XXX.               ECSCRIFD
   404     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   405     12  FILLER                            PIC X(66).             ECSCRIFD
   406     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   407     12  FILLER                            PIC X(20).             ECSCRIFD
   408     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   409     12  FILLER                            PIC X(14).             ECSCRIFD
   410     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   411     12  FILLER                            PIC X(39).             ECSCRIFD
   412     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   413     12  FILLER                            PIC X(45).             ECSCRIFD
   414     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   415     12  FILLER                            PIC X(35).             ECSCRIFD
   416     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   417     12  FILLER                            PIC X(41).             ECSCRIFD
   418     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   419     12  FILLER                            PIC X(48).             ECSCRIFD
   420     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   421     12  FILLER                            PIC X(9).              ECSCRIFD
   422     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   423     12  FILLER                            PIC X(120).            ECSCRIFD
   424     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   425     12  FILLER                            PIC X(73).             ECSCRIFD
   426     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   427     12  FILLER                            PIC X(464).            ECSCRIFD
   428                                                                  ECSCRIFD
   429******************************************************************ECSCRIFD
*  430                                 COPY ECSCRT01.
   431******************************************************************
   432*                                                                *
   433*                            ECSCRT01                            *
   434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   435*                            VMOD=2.016                          *
   436*                                                                *
   437*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   438*                                                                *
   439*   FILE TYPE = SEQUENTIAL
   440*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   441*                                                                *
   442*   KEY DATA =                         START=4, LEN=36           *
   443*                                                                *
   444*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
   445*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* EL547E.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   446******************************************************************
   447******************************************************************
   448*                   C H A N G E   L O G
   449*
   450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   451*-----------------------------------------------------------------
   452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   453* EFFECTIVE    NUMBER
   454*-----------------------------------------------------------------
   455* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   456* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   457* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   458* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   459* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   460* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   461* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   462* 032612  CR2011110200001  PEMA  AHL CHANGES
   463* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
   464* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   465******************************************************************
   466
   467 01  CERTIFICATE-RECORD.
   468     12  CR-RECORD-ID                      PIC XX.
   469         88  VALID-CR-ID                      VALUE 'CR'.
   470
   471     12  CR-COMPANY-CD                     PIC X.
   472
   473     12  CR-FULL-CONTROL.
   474         16  CR-CONTROL-1.
   475             20  CR-ACCT-CONTROL.
   476                 24  CR-CARRIER            PIC X.
   477                 24  CR-GROUPING.
   478                     28  CR-GROUP-PREFIX   PIC XXX.
   479                     28  CR-GROUP-PRIME    PIC XXX.
   480                 24  CR-STATE              PIC XX.
   481                 24  CR-ACCOUNT.
   482                     28  CR-ACCT-PREFIX    PIC X(4).
   483                     28  CR-ACCT-PRIME     PIC X(6).
   484             20  CR-DT                     PIC 9(11)  COMP-3.
   485         16  CR-CERT-NO.
   486             20  CR-CERT.
   487                 24  CR-CERT-PREFIX        PIC X(3).
   488                 24  CR-CERT-PRIME         PIC X(7).
   489             20  CR-CERT-SFX               PIC X.
   490
   491     12  CR-INSUREDS-PROFILE.
   492         16  CR-NAME.
   493             20  CR-LNAME                  PIC X(15).
   494             20  CR-FNAME.
   495                 24  CR-1ST-INITIAL        PIC X.
   496                 24  FILLER                PIC X(9).
   497             20  CR-INIT                   PIC X.
   498         16  CR-AGE                        PIC 99.
   499         16  CR-SEX                        PIC X.
   500             88  CR-SEX-MALE                  VALUE 'M'.
   501             88  CR-SEX-FEMALE                VALUE 'F'.
   502         16  CR-SOC-SEC                    PIC X(11).
   503         16  CR-JOINT-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* EL547E.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   504             20  CR-JT-LNAME               PIC X(15).
   505             20  CR-JT-FNAME.
   506                 24  CR-JT-1ST-INIT        PIC X.
   507                 24  FILLER                PIC X(9).
   508             20  CR-JT-INIT                PIC X.
   509         16  CR-JOINT-AGE                  PIC 99.
   510
   511         16  cr-ahl-ah-claim-no            pic x(9).
   512         16  cr-ahl-ah-cert-seq            pic x(3).
   513         16  cr-hst-proc-lf                pic x.
   514         16  f                             pic x(7).
   515
   516     12  CR-LF-COVERAGE-DATA.
   517         16  CR-LFTYP                      PIC XX.
   518         16  CR-LF-TERM                    PIC S999       COMP-3.
   519         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   520         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   521         16  CR-LF-DEV-CODE                PIC XXX.
   522         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   523
   524         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   525         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   526         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   527         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   528
   529         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   530         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   531         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   532         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   533
   534         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   535         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   536
   537         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   538         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   539
   540         16  CR-LF-REFUND-TYPE             PIC X.
   541         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   542
   543         16  CR-LF-COMM-CHARGEBACK         PIC X.
   544             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   545
   546         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   547
   548         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   549         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   550         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   551
   552         16  cr-ahl-lf-claim-no            pic x(9).
   553         16  cr-ahl-lf-cert-seq            pic x(3).
   554         16  FILLER                        PIC XX.
   555
   556     12  CR-AH-COVERAGE-DATA.
   557         16  CR-AHTYP                      PIC XX.
   558         16  CR-AH-TERM                    PIC S999       COMP-3.
   559         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   560         16  CR-AH-DEV-CODE                PIC XXX.
   561         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* EL547E.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   562
   563         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   564         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   565         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   566         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   567
   568         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   569         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   570
   571         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   572         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   573
   574         16  CR-AH-REFUND-TYPE             PIC X.
   575         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   576
   577         16  CR-AH-COMM-CHARGEBACK         PIC X.
   578             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   579
   580         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   581
   582         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   583         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   584         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   585
   586         16  FILLER                        PIC XX.
   587*        16  FILLER                        PIC X(8).
   588
   589     12  CR-LOAN-DATA.
   590         16  CR-LIVES                      PIC S9(7)      COMP-3.
   591         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   592                                           PIC S9(5)V99   COMP-3.
   593         16  CR-BILLED                     PIC S9(7)      COMP-3.
   594         16  CR-APR                        PIC S999V9(4)  COMP-3.
   595         16  CR-PMT-FREQ                   PIC 99.
   596         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   597         16  CR-RATING-CLASS               PIC XX.
   598         16  CR-POLICY-FORM-NO             PIC X(12).
   599         16  CR-GRPTYP                     PIC XX.
   600         16  CR-IND-GRP                    PIC X.
   601             88  CR-INDIVIDUAL                VALUE '1'.
   602             88  CR-GROUP                     VALUE '2'.
   603         16  CR-SKIP                       PIC 99.
   604             88  NO-MONTHS-SKIPPED            VALUE 00.
   605             88  SKIP-JULY                    VALUE 01.
   606             88  SKIP-AUGUST                  VALUE 02.
   607             88  SKIP-SEPTEMBER               VALUE 03.
   608             88  SKIP-JULY-AUG                VALUE 04.
   609             88  SKIP-AUG-SEPT                VALUE 05.
   610             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   611             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   612             88  SKIP-JUNE                    VALUE 08.
   613             88  SKIP-JUNE-JULY               VALUE 09.
   614             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   615             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   616         16  CR-RESIDENT-STATE             PIC XX.
   617         16  CR-RATE-CODE.
   618             20  CR-LF-CLASS-CD            PIC XX.
   619             20  CR-AH-CLASS-CD            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* EL547E.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   620         16  CR-MORT.
   621             20  CR-TAB                    PIC X.
   622             20  CR-INT                    PIC 99.
   623             20  CR-GRP                    PIC X.
   624         16  CR-MEMBER-NO                  PIC X(12).
   625         16  CR-OLD-LOF                    PIC XXX.
   626*        16  CR-LOAN-OFFICER               PIC XXX.
   627         16  CR-REIN-TABLE                 PIC XXX.
   628         16  CR-REIN-SPEC                  PIC X.
   629         16  CR-LOAN-1ST-PMT-DT.
   630             20  CR-1ST-PMT-YR             PIC 99.
   631             20  CR-1ST-PMT-MO             PIC 99.
   632             20  CR-1ST-PMT-DA             PIC 99.
   633         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   634         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   635         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   636         16  CR-LAST-ADD-ON-DT             PIC XX.
   637
   638         16  CR-UNDERWRITING-CODE          PIC X.
   639             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   640
   641         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   642         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   643         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   644         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   645
   646     12  CR-STATUS-INFORMATION.
   647         16  CR-ENTRY-STATUS               PIC X.
   648             88  CR-NORMAL-ENTRY              VALUE '1'.
   649             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   650             88  CR-CONVERSION-ENTRY          VALUE '4'.
   651             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   652             88  CR-POLICY-IS-CASH            VALUE 'C'.
   653             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   654             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   655             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   656             88  CR-POLICY-IS-VOID            VALUE 'V'.
   657             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   658             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   659                                                'C' '5' '9' 'P'.
   660         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   661
   662         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   663         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   664         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   665
   666         16  CR-LF-STATUS-AT-DEATH         PIC X.
   667         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   668
   669         16  CR-LF-CURRENT-STATUS          PIC X.
   670             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   671             88  CR-LF-POLICY-PENDING         VALUE '2'.
   672             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   673             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   674             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   675             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   676             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   677             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* EL547E.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   678             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   679             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   680             88  CR-LF-IS-DECLINED            VALUE 'D'.
   681             88  CR-LF-IS-VOID                VALUE 'V'.
   682             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   683                                                    '4' '5' '9'.
   684
   685         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   686
   687         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   688         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   689
   690         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   691         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   692
   693         16  CR-AH-CURRENT-STATUS          PIC X.
   694             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   695             88  CR-AH-POLICY-PENDING         VALUE '2'.
   696             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   697             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   698             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   699             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   700             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   701             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   702             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   703             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   704             88  CR-AH-IS-DECLINED            VALUE 'D'.
   705             88  CR-AH-IS-VOID                VALUE 'V'.
   706             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   707                                                    '4' '5' '9'.
   708         16  CR-LOAN-OFFICER               PIC X(5).
   709         16  CR-CANCEL-REASON              PIC X.
   710         16  cr-xycor-lf-cov-code          pic x(4).
   711         16  cr-xycor-ah-cov-code          pic x(4).
   712         16  cr-temp-epiq                  pic x(4).
   713         16  FILLER                        PIC XX.
   714
   715     12  CR-DEATH-CLAIM-DATA.
   716         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   717
   718         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   719         16  CR-DTH-RPT-DT.
   720             20  CR-DTH-RPT-YR             PIC 99.
   721             20  CR-DTH-RPT-MO             PIC 99.
   722             20  CR-DTH-RPT-DA             PIC 99.
   723         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   724
   725         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   726         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   727         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   728         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   729         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   730
   731         16  CR-DTH-AGE                    PIC 99.
   732         16  CR-DTH-PAY-CD                 PIC X.
   733         16  CR-DEATH-CAUSE                PIC X(6).
   734
   735         16  FILLER                        PIC X(16).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* EL547E.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   736
   737     12  CR-DISAB-CLAIM-DATA.
   738         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   739
   740         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   741         16  CR-DIS-RPT-DT.
   742             20  CR-DIS-RPT-YR             PIC 99.
   743             20  CR-DIS-RPT-MO             PIC 99.
   744             20  CR-DIS-RPT-DA             PIC 99.
   745         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   746         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   747
   748         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   749         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   750         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   751         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   752         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   753
   754         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   755         16  CR-DIS-PAY-CD                 PIC X.
   756         16  FILLER                        PIC XX.
   757
   758         16  CR-DISAB-INCURRED-DETAIL.
   759             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   760**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   761                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   762                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   763                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   764
   765         16  CR-DISAB-CAUSE                PIC X(6).
   766         16  FILLER                        PIC X(14).
   767
   768     12  CR-REMIT-TO                       PIC 99.
   769
   770     12  CR-COMPENSATION-LEVELS.
   771         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   772             20  CR-COM-AGT.
   773                 24  CR-COM-AGT-PREFIX     PIC X(4).
   774                 24  CR-COM-AGT-PRIME      PIC X(6).
   775             20  CR-AGT-TYPE               PIC X.
   776             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   777             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   778
   779     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   780     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   781     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   782     12  CR-CLP-STATE                      PIC XX.
   783     12  CR-POST-CARD-IND                  PIC X.
   784     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   785     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   786     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   787     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   788     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   789     12  FILLER                            PIC X(07).
   790
   791     12  CR-CSR-CODE                       PIC XXX.
   792
   793     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* EL547E.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   794     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   795
   796     12  CR-MICROFILM-NUMBERS.
   797*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   798         16  FILLER                        PIC X(5).
   799     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   800
   801     12  CR-USER-CODE                      PIC X.
   802     12  CR-USER-FUTURE                    PIC X(9).
   803
   804     12  CR-BENEFICIARY.
   805         16  CR-BANK-NO                    PIC X(10).
   806         16  FILLER                        PIC X(15).
   807
   808     12  CR-ENTRY-BATCH                    PIC X(6).
   809     12  CR-LF-EXIT-BATCH                  PIC X(6).
   810     12  CR-AH-EXIT-BATCH                  PIC X(6).
   811
   812     12  CR-NOTE-SW                        PIC X.
   813
   814     12  CR-ORIGIN-INDICATOR               PIC X.
   815         88  CR-ENTERED-MANUALLY              VALUE '1'.
   816         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   817
   818     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   819     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   820     12  FILLER                            PIC X(33).
   821
   822******************************************************************
   823
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* EL547E.cbl
   825 FD  EXTRACT
   826     BLOCK CONTAINS 0 RECORDS
   827     RECORDING MODE IS F.
   828
   829 01  EXTRACT-RECORD-OUT          PIC X(302).
   830 01  EXTRACT-RECORD-OUT-HD       PIC X(400).
   831
   832
   833 FD  DISK-DATE
*  834                                 COPY ELCDTEFD.
   835******************************************************************04/15/98
   836*                                                                *ELCDTEFD
   837*                                                                *ELCDTEFD
   838*                            ELCDTEFD.                           *   LV002
   839*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   840*                            VMOD=2.007                          *   CL**2
   841*                                                                *ELCDTEFD
   842******************************************************************ELCDTEFD
   843     BLOCK CONTAINS 0 RECORDS
   844     RECORDING MODE F.                                            ELCDTEFD
   845                                                                  ELCDTEFD
   846 01  DATE-DISK.                                                   ELCDTEFD
   847     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   848     12  FILLER                      PIC  X(14).                  ELCDTEFD
   849     12  DD-CR1                      PIC  9.                      ELCDTEFD
   850     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   851     12  DD-CR2                      PIC  9.                      ELCDTEFD
   852     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   853     12  FILLER                      PIC  X(20).                  ELCDTEFD
   854                                                                  ELCDTEFD
   855 01  DATE-DISK-R.                                                 ELCDTEFD
   856     12  FILLER                      PIC  X(4).                   ELCDTEFD
   857     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   858                                     PIC  X(32).                  ELCDTEFD
   859                                                                  ELCDTEFD
   860 01  DATE-DISK-T.                                                 ELCDTEFD
   861     12  FILLER                      PIC  X(4).                   ELCDTEFD
   862     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   863                                     PIC  X(48).                  ELCDTEFD
   864                                                                  ELCDTEFD
   865 01  DATE-DISK-M.                                                 ELCDTEFD
   866     12  FILLER                      PIC  X(4).                   ELCDTEFD
   867     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   868                                     PIC  X(48).                  ELCDTEFD
   869                                                                  ELCDTEFD
   870 01  DATE-DISK-P.                                                 ELCDTEFD
   871     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   872     12  DD-IDX                      PIC  99.                     ELCDTEFD
   873     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   874     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   875         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   876                                     PIC  X.                      ELCDTEFD
   877         16  FILLER                  PIC  X(46).                  ELCDTEFD
   878     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   879         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   880             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   881             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   882             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   883             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   884         16  FILLER                  PIC  X(16).                  ELCDTEFD
   885                                                                  ELCDTEFD
   886 01  DATE-DISK-E.                                                 ELCDTEFD
   887     12  FILLER                      PIC  X(4).                   ELCDTEFD
   888     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   889                                     PIC  X(4).                   ELCDTEFD
   890                                                                  ELCDTEFD
   891 01  DATE-DISK-C.                                                 ELCDTEFD
   892     12  FILLER                      PIC  X(7).                   ELCDTEFD
   893     12  DD-CARR1-SECPAY-SW          PIC  X.
   894     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   895     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   896     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   897     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   898     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   899     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   900     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   901     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   902     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   903     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   904     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   905     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   906     12  DD-CARR2-SECPAY-SW          PIC  X.
   907     12  FILLER                      PIC  X(7).                   ELCDTEFD
   908                                                                  ELCDTEFD
   909 01  DATE-DISK-OPT.                                               ELCDTEFD
   910     12  FILLER                      PIC  X(04).                  ELCDTEFD
   911     12  DD-TLR-DATA.                                             ELCDTEFD
   912         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   913                                     PIC  X(03).                  ELCDTEFD
   914     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   915         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   916                                     PIC  X(06).                  ELCDTEFD
   917     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   918         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   919                                     PIC  X(07).                  ELCDTEFD
   920         16  FILLER                  PIC  X(05).                  ELCDTEFD
   921     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   922                                     PIC  X(96).                  ELCDTEFD
   923******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* EL547E.cbl
   925 FD  PRINTX
*  926                                 COPY ELCPRTFD.
   927******************************************************************04/15/98
   928*                                                                *ELCPRTFD
   929*                                                                *ELCPRTFD
   930*                            ELCPRTFD.                           *   LV003
   931*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   932*                            VMOD=2.006                          *ELCPRTFD
   933******************************************************************ELCPRTFD
   934     RECORDING MODE F                                             ELCPRTFD
   935     LABEL RECORDS OMITTED                                        ELCPRTFD
   936     BLOCK CONTAINS 0 RECORDS
   937     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   938 01  PRT.                                                         ELCPRTFD
   939     12  P-CTL               PIC  X.                                 CL**2
   940     12  P-DATA              PIC  X(132).                         ELCPRTFD
   941******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* EL547E.cbl
   943 WORKING-STORAGE SECTION.
   944 77  FILLER  PIC X(32) VALUE '********************************'.
   945 77  FILLER  PIC X(32) VALUE '      EL547E  WORKING STORAGE   '.
   946 77  FILLER  PIC X(32) VALUE '********************************'.
   947
   948 77  WS-EOF-SW                   PIC X  VALUE SPACES.
   949     88  THERE-ARE-NO-MORE-RECORDS  VALUE 'Y'.
   950     88  THERE-ARE-MORE-RECORDS     VALUE 'N'.
   951 77  IYR                         PIC S999   COMP-3 VALUE +0.
   952 77  VYR                         PIC S999   COMP-3 VALUE +0.
   953 77  PAGE-CTR                    PIC S9(07) VALUE +0  COMP-3.
   954 77  LINE-CTR                    PIC S9(03) VALUE +99 COMP-3.
   955 77  X                           PIC X      VALUE ' '.
   956 77  WS-CRT-CNT                  PIC S9(9)  COMP-3 VALUE +0.
   957 77  WS-CLM-CNT                  PIC S9(9)  COMP-3 VALUE +0.
   958 77  WS-CRT-CNT-TOT              PIC S9(9)  COMP-3 VALUE +0.
   959 77  WS-CLM-CNT-TOT              PIC S9(9)  COMP-3 VALUE +0.
   960 77  INTERMED                    PIC S9(9)V9(6)  COMP-3.
   961 77  WS-REM-AMT                  PIC S9(11)V99 COMP-3 VALUE +0.
   962 77  LF-REM-TRM1                 PIC S999V99  COMP-3  VALUE +0.
   963 77  AH-REM-TRM1                 PIC S999V99  COMP-3  VALUE +0.
   964 77  LF-REM-TRM2                 PIC S999V99  COMP-3  VALUE +0.
   965 77  AH-REM-TRM2                 PIC S999V99  COMP-3  VALUE +0.
   966 77  REM-TRM1                    PIC S9(3)V99    COMP-3.
   967 77  REM-TRM2                    PIC S9(3)V99    COMP-3.
   968 77  WS-CERT-PREV-ST             PIC S9(7)V99    COMP-3 VALUE +0.
   969 77  WS-CERT-PREV-R78            PIC S9(7)V99    COMP-3 VALUE +0.
   970 77  WS-CERT-PREV-PRO            PIC S9(7)V99    COMP-3 VALUE +0.
   971
   972 01  WS-INIT-EXT-RECORD          PIC X(302)  VALUE LOW-VALUES.
   973
   974 01  WS-EXTRACT-RECORD.
   975     05  EXT-ISSUE-CCYYMM        PIC 9(6).
   976     05  WS-TAB1                 PIC X.
   977     05  EXT-VALUE-CCYYMM        PIC 9(6).
   978     05  WS-TAB2                 PIC X.
   979     05  EXT-LF-INFORCE          PIC ZZZ,ZZZ,ZZZ,ZZ9.99.
   980     05  WS-TAB3                 PIC X.
   981     05  EXT-LF-WRITTEN          PIC ZZZ,ZZZ,ZZ9.99.
   982     05  WS-TAB4                 PIC X.
   983     05  EXT-AH-WRITTEN          PIC ZZZ,ZZZ,ZZ9.99.
   984     05  WS-TAB5                 PIC X.
   985     05  EXT-LF-REFUNDS          PIC ZZZ,ZZZ,ZZ9.99.
   986     05  WS-TAB6                 PIC X.
   987     05  EXT-AH-REFUNDS          PIC ZZZ,ZZZ,ZZ9.99.
   988     05  WS-TAB7                 PIC X.
   989     05  EXT-LF-R78              PIC ZZZ,ZZZ,ZZ9.99.
   990     05  WS-TAB8                 PIC X.
   991     05  EXT-LF-PRO              PIC ZZZ,ZZZ,ZZ9.99.
   992     05  WS-TAB9                 PIC X.
   993     05  EXT-LF-ST               PIC ZZZ,ZZZ,ZZ9.99.
   994     05  WS-TAB10                PIC X.
   995     05  EXT-LF-R78-EP           PIC ZZZ,ZZZ,ZZ9.99.
   996     05  WS-TAB11                PIC X.
   997     05  EXT-LF-PRO-EP           PIC ZZZ,ZZZ,ZZ9.99.
   998     05  WS-TAB12                PIC X.
   999     05  EXT-LF-ST-EP            PIC ZZZ,ZZZ,ZZ9.99.
  1000     05  WS-TAB13                PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* EL547E.cbl
  1001     05  EXT-AH-R78              PIC ZZZ,ZZZ,ZZ9.99.
  1002     05  WS-TAB14                PIC X.
  1003     05  EXT-AH-PRO              PIC ZZZ,ZZZ,ZZ9.99.
  1004     05  WS-TAB15                PIC X.
  1005     05  EXT-AH-ST               PIC ZZZ,ZZZ,ZZ9.99.
  1006     05  WS-TAB16                PIC X.
  1007     05  EXT-AH-R78-EP           PIC ZZZ,ZZZ,ZZ9.99.
  1008     05  WS-TAB17                PIC X.
  1009     05  EXT-AH-PRO-EP           PIC ZZZ,ZZZ,ZZ9.99.
  1010     05  WS-TAB18                PIC X.
  1011     05  EXT-AH-ST-EP            PIC ZZZ,ZZZ,ZZ9.99.
  1012     05  WS-TAB19                PIC X.
  1013     05  EXT-LF-CLAIM            PIC ZZZ,ZZZ,ZZ9.99.
  1014     05  WS-TAB20                PIC X.
  1015     05  EXT-AH-CLAIM            PIC ZZZ,ZZZ,ZZ9.99.
  1016
  1017 01  WS-HEAD-RECORD.
  1018     05  FILLER                  PIC X(8)    VALUE 'ISS DATE'.
  1019     05  WS-HTAB1                PIC X.
  1020     05  FILLER                  PIC X(8)    VALUE 'VAL DATE'.
  1021     05  WS-HTAB2                PIC X.
  1022     05  FILLER                  PIC X(10)   VALUE 'LF INFORCE'.
  1023     05  WS-HTAB3                PIC X.
  1024     05  FILLER                  PIC X(10)   VALUE 'LF WRITTEN'.
  1025     05  WS-HTAB4                PIC X.
  1026     05  FILLER                  PIC X(10)   VALUE 'AH WRITTEN'.
  1027     05  WS-HTAB5                PIC X.
  1028     05  FILLER                  PIC X(10)   VALUE 'LF REFUNDS'.
  1029     05  WS-HTAB6                PIC X.
  1030     05  FILLER                  PIC X(10)   VALUE 'AH REFUNDS'.
  1031     05  WS-HTAB7                PIC X.
  1032     05  FILLER                  PIC X(10)   VALUE 'LF UEP R78'.
  1033     05  WS-HTAB8                PIC X.
  1034     05  FILLER                  PIC X(10)   VALUE 'LF UEP PRO'.
  1035     05  WS-HTAB9                PIC X.
  1036     05  FILLER                  PIC X(9)    VALUE 'LF UEP ST'.
  1037     05  WS-HTAB10               PIC X.
  1038     05  FILLER                  PIC X(9)    VALUE 'LF EP R78'.
  1039     05  WS-HTAB11               PIC X.
  1040     05  FILLER                  PIC X(9)    VALUE 'LF EP PRO'.
  1041     05  WS-HTAB12               PIC X.
  1042     05  FILLER                  PIC X(8)    VALUE 'LF EP ST'.
  1043     05  WS-HTAB13               PIC X.
  1044     05  FILLER                  PIC X(10)   VALUE 'AH UEP R78'.
  1045     05  WS-HTAB14               PIC X.
  1046     05  FILLER                  PIC X(10)   VALUE 'AH UEP PRO'.
  1047     05  WS-HTAB15               PIC X.
  1048     05  FILLER                  PIC X(9)    VALUE 'AH UEP ST'.
  1049     05  WS-HTAB16               PIC X.
  1050     05  FILLER                  PIC X(9)    VALUE 'AH EP R78'.
  1051     05  WS-HTAB17               PIC X.
  1052     05  FILLER                  PIC X(9)    VALUE 'AH EP PRO'.
  1053     05  WS-HTAB18               PIC X.
  1054     05  FILLER                  PIC X(8)    VALUE 'AH EP ST'.
  1055     05  WS-HTAB19               PIC X.
  1056     05  FILLER                  PIC X(9)    VALUE 'LF CLAIMS'.
  1057     05  WS-HTAB20               PIC X.
  1058     05  FILLER                  PIC X(9)    VALUE 'AH CLAIMS'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* EL547E.cbl
  1059
  1060
  1061
  1062 01  WS-ISSUE-YR-TABLE.
  1063     05  WS-ISSUE         OCCURS 600.
  1064         10  WS-ISSUE-CCYYMM     PIC 9(6).
  1065         10  FILLER              PIC XX.
  1066         10  WS-VALUATION OCCURS 600.
  1067           12  WS-RECORD.
  1068             15  WS-VALUATION-CCYYMM PIC 9(6).
  1069             15  WS-LF-INFORCE   PIC S9(12)V99 COMP-3.
  1070             15  WS-LF-WRITTEN   PIC S9(9)V99 COMP-3.
  1071             15  WS-AH-WRITTEN   PIC S9(9)V99 COMP-3.
  1072             15  WS-LF-REFUNDS   PIC S9(9)V99 COMP-3.
  1073             15  WS-AH-REFUNDS   PIC S9(9)V99 COMP-3.
  1074             15  WS-LF-R78       PIC S9(9)V99 COMP-3.
  1075             15  WS-LF-PRO       PIC S9(9)V99 COMP-3.
  1076             15  WS-LF-ST        PIC S9(9)V99 COMP-3.
  1077             15  WS-LF-R78-EP    PIC S9(9)V99 COMP-3.
  1078             15  WS-LF-PRO-EP    PIC S9(9)V99 COMP-3.
  1079             15  WS-LF-ST-EP     PIC S9(9)V99 COMP-3.
  1080             15  WS-AH-R78       PIC S9(9)V99 COMP-3.
  1081             15  WS-AH-PRO       PIC S9(9)V99 COMP-3.
  1082             15  WS-AH-ST        PIC S9(9)V99 COMP-3.
  1083             15  WS-AH-R78-EP    PIC S9(9)V99 COMP-3.
  1084             15  WS-AH-PRO-EP    PIC S9(9)V99 COMP-3.
  1085             15  WS-AH-ST-EP     PIC S9(9)V99 COMP-3.
  1086             15  WS-LF-CLAIM     PIC S9(9)V99 COMP-3.
  1087             15  WS-AH-CLAIM     PIC S9(9)V99 COMP-3.
  1088
  1089 01  FILLER                  PIC X(400)  VALUE LOW-VALUES.
  1090
  1091 01  WS-DISPLAY-DATE         PIC ZZZ9(8).
  1092 01  WS-DISPLAY-TERM         PIC Z99.
  1093 01  WS-DISPLAY-RTERM        PIC Z99.99.
  1094 01  WS-DISPLAY-AMT          PIC ZZZZZZZ.99.
  1095 01  WS-DISPLAY-RAMT         PIC ZZZZZZZ.99.
  1096 01  WS-DISPLAY-PRM          PIC ZZZZZZZ.99.
  1097 01  WS-DISPLAY-UEP          PIC ZZZZZZZ.99.
  1098 01  WS-BIN-CR-DT            PIC XX  VALUE LOW-VALUES.
  1099 01  WS-BIN-LF-END-DATE      PIC XX  VALUE LOW-VALUES.
  1100 01  WS-BIN-AH-END-DATE      PIC XX  VALUE LOW-VALUES.
  1101 01  FILLER.
  1102     05  WS-END-YEAR             PIC 9(11)  VALUE ZEROS.
  1103     05  FILLER REDEFINES WS-END-YEAR.
  1104         10  FILLER              PIC 999.
  1105         10  WS-CCYYMM           PIC 9(6).
  1106         10  FILLER REDEFINES WS-CCYYMM.
  1107             15  WS-CCYY         PIC 9999.
  1108             15  WS-MM           PIC 99.
  1109         10  WS-DD               PIC 99.
  1110 01  WS-DEBUG-AREA.
  1111     12  WS-DEBUG-SW             PIC X(01) VALUE ' '.
  1112         88  DEBUG-IS-ON                VALUES '1' '2' '3' '4'.
  1113         88  DEBUG-LF-INFORCE-CNT       VALUE '1'.
  1114         88  DEBUG-AH-INFORCE-CNT       VALUE '2'.
  1115         88  DEBUG-LF-STATUTORY         VALUE '3'.
  1116         88  DEBUG-AH-STATUTORY         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* EL547E.cbl
  1117
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* EL547E.cbl
  1119
  1120 01  TEXAS-REGS-WORK-AREAS.
  1121     12  TEX-FACT-1              PIC S9(7)V9(2)    COMP-3.
  1122     12  TEX-FACT-2              PIC S9(3)   COMP-3.
  1123     12  TEX-FACT-3              PIC S9(3)   COMP-3.
  1124     12  TEX-FACT-4              PIC S9(7)   COMP-3.
  1125     12  TEX-FACT-5              PIC S9(3)   COMP-3.
  1126     12  TEX-FACT-6              PIC S9(3)   COMP-3.
  1127     12  TEX-FACT-7              PIC S9(7)   COMP-3.
  1128     12  TEX-FACT-8              PIC S9V9(6) COMP-3.
  1129     12  TEX-FACT-9              PIC S9(4)V9(11)   COMP-3.
  1130
  1131*01  NET-PAY-INTERFACE.
  1132*    05  NP-APR                  PIC S9(3)V9(4)    COMP-3.
  1133*    05  NP-ORIG                 PIC S9(3)         COMP-3.
  1134*    05  NP-REM                  PIC S9(3)         COMP-3.
  1135*    05  NP-OPT                  PIC X(01).
  1136*    05  NP-CAP                  PIC S9(3)         COMP-3.
  1137*    05  NP-FACTOR               PIC S9(4)V9(9)    COMP-3.
  1138*    05  NP-WORK1                PIC S9(6)V9(9)    COMP-3.
  1139*    05  NP-WORK2                PIC S9(6)V9(9)    COMP-3.
  1140
  1141 01  WS-ABEND-AREA.
  1142     05  WS-ABEND-FILE-STATUS    PIC X(02).
  1143     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
  1144     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
  1145     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
  1146
  1147 01  WORK-ABEND-CODE.
  1148     12  WAC-1                   PIC X.
  1149     12  WAC-2                   PIC X.
  1150     12  WAC-3-4.
  1151         16  WAC-3               PIC X.
  1152         16  WAC-4               PIC X.
  1153
  1154 01  FILLER.
  1155     05  WS-WORK-DATE            PIC 9(11).
  1156     05  FILLER REDEFINES WS-WORK-DATE.
  1157         10  FILLER              PIC XXX.
  1158         10  WS-WORK-CCYYMM      PIC 9(6).
  1159         10  FILLER REDEFINES WS-WORK-CCYYMM.
  1160             15  WS-WORK-CCYY    PIC 9999.
  1161             15  WS-WORK-MM      PIC 99.
  1162         10  WS-WORK-DD          PIC 99.
  1163 01  FILLER.
  1164     05  WS-EFFECT-DATE          PIC 9(11).
  1165     05  FILLER REDEFINES WS-EFFECT-DATE.
  1166         10  FILLER              PIC 999.
  1167         10  WS-EFFECT-CCYYMM     PIC 9(6).
  1168         10  WS-EFFECT-DD        PIC 99.
  1169 01  FILLER.
  1170     05  WS-ENTRY-DATE           PIC 9(11).
  1171     05  FILLER REDEFINES        WS-ENTRY-DATE.
  1172         10  FILLER              PIC 999.
  1173         10  WS-ENTRY-CCYYMM     PIC 9(6).
  1174         10  WS-ENTRY-DD         PIC 99.
  1175 01  FILLER.
  1176     05  WS-CANCEL-DATE          PIC 9(11).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* EL547E.cbl
  1177     05  FILLER REDEFINES WS-CANCEL-DATE.
  1178         10  FILLER              PIC 999.
  1179         10  WS-CANCEL-CCYYMM    PIC 9(6).
  1180         10  WS-CANCEL-DD        PIC 99.
  1181 01  FILLER.
  1182     05  WS-CLAIM-DATE           PIC 9(11).
  1183     05  FILLER REDEFINES WS-CLAIM-DATE.
  1184         10  FILLER              PIC 999.
  1185         10  WS-CLAIM-CCYYMM     PIC 9(6).
  1186         10  WS-CLAIM-DD         PIC 99.
  1187 01  FILLER.
  1188     05  WS-HI-ISSUE-CCYYMM      PIC 9(6) VALUE ZEROS.
  1189     05  WS-LO-ISSUE-CCYYMM      PIC 9(6) VALUE ZEROS.
  1190 01  FILLER.
  1191     05  WS-HI-VALUATION-CCYYMM  PIC 9(6) VALUE ZEROS.
  1192     05  WS-LO-VALUATION-CCYYMM  PIC 9(6) VALUE ZEROS.
  1193     05  FILLER REDEFINES WS-LO-VALUATION-CCYYMM.
  1194         10  WS-LO-VAL-CCYY      PIC 9999.
  1195         10  WS-LO-VAL-MM        PIC 99.
  1196 01  FILLER.
  1197     05  WS-BIN-VAL-DATES OCCURS 600
  1198                                 PIC XX.
  1199
  1200 01  ABEND-FIELDS.
  1201     12  PGM-SUB                 PIC S999 COMP  VALUE +158.
  1202     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
  1203         88  FIRST-TIME                 VALUE 'Y'.
  1204
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* EL547E.cbl
* 1206                                 COPY ELCCALC.
  1207******************************************************************04/15/98
  1208*                                                                *ELCCALC
  1209*                           ELCCALC.                            *    LV003
  1210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1211*                            VMOD=2.025                          *   CL**3
  1212*                                                                *   CL**2
  1213*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  1214*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  1215*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  1216*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  1217*                                                                *   CL**2
  1218*  PASSED TO ELRTRM                                              *   CL**2
  1219*  -----------------                                             *   CL**2
  1220*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  1221*  ORIGINAL TERM                                                 *   CL**2
  1222*  BEGINNING DATE                                                *   CL**2
  1223*  ENDING DATE                                                   *   CL**2
  1224*  COMPANY I.D.                                                  *   CL**2
  1225*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  1226*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  1227*  FREE LOOK DAYS                                                *   CL**2
  1228*                                                                *   CL**2
  1229*  RETURNED FROM ELRTRM                                          *   CL**2
  1230*  ---------------------                                         *   CL**2
  1231*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  1232*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  1233*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  1234*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  1235*----------------------------------------------------------------*   CL**2
  1236*  PASSED TO ELRAMT                                              *   CL**2
  1237*  ----------------                                              *   CL**2
  1238*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  1239*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1240*  ORIGINAL AMOUNT                                               *   CL**2
  1241*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  1242*  A.P.R. - NET PAY ONLY                                         *   CL**2
  1243*  METHOD                                                            CL**2
  1244*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  1245*  COMPANY I.D.                                                  *   CL**2
  1246*  BENEFIT TYPE                                                  *   CL**2
  1247*                                                                *   CL**2
  1248*  RETURNED FROM ELRAMT                                          *   CL**2
  1249*  --------------------                                          *   CL**2
  1250*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  1251*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  1252*  REMAINING AMOUNT FACTOR                                           CL**2
  1253*----------------------------------------------------------------*   CL**2
  1254*  PASSED TO ELRESV                                              *   CL**2
  1255*  -----------------                                             *   CL**2
  1256*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  1257*  VALUATION DATE                                                *   CL**2
  1258*  PAID THRU DATE                                                *   CL**2
  1259*  BENEFIT                                                       *   CL**2
  1260*  INCURRED DATE                                                 *   CL**2
  1261*  REPORTED DATE                                                 *   CL**2
  1262*  ISSUE AGE                                                     *   CL**2
  1263*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* EL547E.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1264*  CDT PERCENT                                                   *   CL**2
  1265*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  1266* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  1267* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  1268* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  1269*                                                                *   CL**2
  1270*  RETURNED FROM ELRESV                                          *   CL**2
  1271*  --------------------                                          *   CL**2
  1272*  CDT TABLE USED                                                *   CL**2
  1273*  CDT FACTOR USED                                               *   CL**2
  1274*  PAY TO CURRENT RESERVE                                        *   CL**2
  1275*  I.B.N.R. - A/H ONLY                                           *   CL**2
  1276*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  1277*----------------------------------------------------------------*   CL**2
  1278*  PASSED TO ELRATE                                              *   CL**2
  1279*  ----------------                                              *   CL**2
  1280*  CERT ISSUE DATE                                               *   CL**2
  1281*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1282*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1283*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  1284*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1285*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1286*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1287*  DEVIATION CODE                                                *   CL**2
  1288*  ISSUE AGE                                                     *   CL**2
  1289*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1290*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1291*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  1292*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1293*  A.P.R.                                                        *   CL**2
  1294*  METHOD                                                            CL**2
  1295*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1296*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1297*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1298*  BENEFIT CODE                                                  *   CL**2
  1299*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1300*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  1301*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  1302*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  1303*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  1304*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  1305*                                                                *   CL**2
  1306*  RETURNED FROM ELRATE                                          *   CL**2
  1307*  --------------------                                          *   CL**2
  1308*  CALCULATED PREMIUM                                            *   CL**2
  1309*  PREMIUM RATE                                                  *   CL**2
  1310*  MORTALITY CODE                                                *   CL**2
  1311*  MAX ATTAINED AGE                                              *   CL**2
  1312*  MAX AGE                                                       *   CL**2
  1313*  MAX TERM                                                      *   CL**2
  1314*  MAX MONTHLY BENEFIT                                           *   CL**2
  1315*  MAX TOTAL BENIFIT                                             *   CL**2
  1316*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  1317*----------------------------------------------------------------*   CL**2
  1318*  PASSED TO ELRFND                                              *   CL**2
  1319*  ----------------                                              *   CL**2
  1320*  CERT ISSUE DATE                                               *   CL**2
  1321*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* EL547E.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1322*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1323*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1324*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1325*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1326*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1327*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1328*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1329*  DEVIATION CODE                                                *   CL**2
  1330*  ISSUE AGE                                                     *   CL**2
  1331*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1332*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1333*  PROCESS TYPE (CANCEL)                                         *   CL**2
  1334*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1335*  A.P.R.                                                        *   CL**2
  1336*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  1337*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  1338*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1339*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1340*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1341*  BENEFIT CODE                                                  *   CL**2
  1342*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1343*                                                                *   CL**2
  1344*  RETURNED FROM ELRFND                                          *   CL**2
  1345*  --------------------                                          *   CL**2
  1346*  CALCULATED REFUND                                             *   CL**2
  1347*----------------------------------------------------------------*   CL**2
  1348*  PASSED TO ELEARN                                              *   CL**2
  1349*  ----------------                                              *   CL**2
  1350*  CERT ISSUE DATE                                               *   CL**2
  1351*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1352*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1353*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1354*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1355*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1356*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1357*  DEVIATION CODE                                                *   CL**2
  1358*  ISSUE AGE                                                     *   CL**2
  1359*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1360*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1361*  A.P.R.                                                        *   CL**2
  1362*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  1363*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1364*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1365*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1366*  BENEFIT CODE                                                  *   CL**2
  1367*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1368*                                                                *   CL**2
  1369*  RETURNED FROM ELEARN                                          *   CL**2
  1370*  --------------------                                          *   CL**2
  1371*  INDICATED  EARNINGS                                           *   CL**2
  1372*----------------------------------------------------------------*   CL**2
  1373*                 LENGTH = 450                                   *   CL**2
  1374*                                                                *   CL**2
  1375******************************************************************   CL**2
  1376******************************************************************
  1377*                   C H A N G E   L O G
  1378*
  1379* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* EL547E.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1380*-----------------------------------------------------------------
  1381*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1382* EFFECTIVE    NUMBER
  1383*-----------------------------------------------------------------
  1384* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1385* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1386* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1387* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1388* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1389* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1390* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1391* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1392* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1393* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1394******************************************************************
  1395                                                                     CL**2
  1396 01  CALCULATION-PASS-AREA.                                          CL**2
  1397     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  1398                                     COMP.                           CL**2
  1399                                                                     CL**2
  1400     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  1401       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  1402       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  1403                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  1404       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  1405       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  1406       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  1407       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  1408       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  1409       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  1410       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  1411       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  1412       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  1413       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  1414       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  1415       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  1416       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  1417       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  1418       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  1419       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  1420       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  1421                                                                     CL**2
  1422     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  1423       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  1424***********************  INPUT AREAS ****************************    CL**2
  1425                                                                     CL**2
  1426     12  CP-CALCULATION-AREA.                                        CL**2
  1427         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  1428         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  1429         16  CP-VALUATION-DT       PIC XX.                           CL**2
  1430         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  1431         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  1432           88  CP-AH                               VALUE 'A' 'D'     CL**2
  1433                                                   'I' 'U'.          CL**2
  1434           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  1435           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  1436         16  CP-INCURRED-DT        PIC XX.                           CL**2
  1437         16  CP-REPORTED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* EL547E.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1438         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  1439         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  1440         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  1441                                     COMP-3.                         CL**2
  1442         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  1443                                     COMP-3.                         CL**2
  1444         16  CP-CDT-METHOD         PIC X.                            CL**2
  1445           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  1446           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  1447           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  1448         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  1449           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  1450           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  1451         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  1452                                     COMP-3.                         CL**2
  1453         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  1454                                     COMP-3.                         CL**2
  1455         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  1456                                     COMP-3.                         CL**2
  1457         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  1458                                     COMP-3.                         CL**2
  1459         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1460                                     COMP-3.                         CL**2
  1461         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  1462                                     COMP-3.                         CL**2
  1463         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  1464                                     COMP-3.                         CL**2
  1465         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  1466           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  1467           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  1468           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  1469           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  1470           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  1471           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  1472           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  1473         16  CP-EARNING-METHOD     PIC X.                            CL**2
  1474           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  1475           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  1476           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1477           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1478           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1479           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1480           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  1481           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1482           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  1483           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1484           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1485           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1486           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1487           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1488         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  1489           88  CP-CLAIM                            VALUE '1'.        CL**2
  1490           88  CP-CANCEL                           VALUE '2'.        CL**2
  1491           88  CP-ISSUE                            VALUE '3'.        CL**2
  1492         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  1493           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  1494           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  1495           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* EL547E.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1496           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  1497           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  1498           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  1499           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  1500           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  1501           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  1502           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  1503           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  1504           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  1505           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  1506           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  1507           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  1508           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  1509           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  1510           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  1511                                                     'W' 'X'.        CL**2
  1512           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  1513           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  1514           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  1515           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  1516           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  1517           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  1518           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  1519           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  1520           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  1521           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  1522           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  1523           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  1524           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  1525                                                                     CL**2
  1526         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  1527                                     COMP-3.                         CL**2
  1528         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  1529         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  1530         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  1531         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  1532         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  1533           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  1534               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  1535         16  CP-R78-OPTION         PIC X.                            CL**2
  1536           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  1537           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  1538                                                                     CL**2
  1539         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  1540         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  1541         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  1542         16  CP-RATE-FILE          PIC X.                            CL**2
  1543         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  1544                                     COMP-3.                         CL**2
  1545                                                                     CL**2
  1546         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  1547         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  1548                                                                     CL**2
  1549         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  1550                                     COMP-3.
  1551         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1552                                   PIC S9(5)V99 COMP-3.
  1553         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* EL547E.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1554                                     COMP-3.                         CL**2
  1555         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1556                                     COMP-3.                         CL**2
  1557         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  1558                                     COMP-3.
  1559         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1560                                  PIC S9(7)V99 COMP-3.
  1561                                                                     CL**2
  1562         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  1563         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  1564         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  1565           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  1566           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  1567           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  1568           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  1569         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  1570         16  CP-CARRIER            PIC X.                            CL**2
  1571         16  CP-REIN-FLAG          PIC X.                            CL**2
  1572         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  1573           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  1574                      '2' '3' '4' '5'.                               CL**2
  1575           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  1576           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  1577           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  1578           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  1579           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  1580           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  1581           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  1582           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1583         16  CP-SIG-SWITCH         PIC X.                            CL**2
  1584         16  CP-RATING-METHOD      PIC X.                            CL**2
  1585           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  1586           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  1587           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1588           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1589           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1590           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1591           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  1592           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1593           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1594         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  1595                                     COMP-3.                         CL**2
  1596         16  CP-BEN-CATEGORY       PIC X.
  1597         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1598         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1599                                   PIC S99V9(5) COMP-3.
  1600         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1601         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1602                                   PIC S99V9(5) COMP-3.
  1603         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1604         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1605         16  CP-EXPIRE-DT          PIC XX.
  1606         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1607         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1608         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1609         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1610         16  CP-DDF-SPEC-CALC      PIC X.
  1611             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* EL547E.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1612             88  CP-CALC-CLP              VALUE 'C'.
  1613         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1614         16  CP-CANCEL-REASON      PIC X.
  1615         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1616         16  CP-PMT-MODE           PIC X.
  1617         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1618         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1619         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1620         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1621         16  FILLER                PIC X.
  1622                                                                     CL**2
  1623***************    OUTPUT FROM ELRESV   ************************     CL**2
  1624                                                                     CL**2
  1625         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  1626                                                                     CL**2
  1627         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  1628                                     COMP-3.                         CL**2
  1629         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  1630                                     COMP-3.                         CL**2
  1631         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  1632                                     COMP-3.                         CL**2
  1633         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  1634                                     COMP-3.                         CL**2
  1635         16  FILLER                PIC X(09).                        CL**2
  1636***************    OUTPUT FROM ELRTRM   *************************    CL**2
  1637                                                                     CL**2
  1638         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  1639                                     COMP-3.                         CL**2
  1640         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  1641                                     COMP-3.                         CL**2
  1642         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  1643                                     COMP-3.                         CL**2
  1644         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  1645                                     COMP-3.                         CL**2
  1646         16  FILLER                PIC X(12).                        CL**2
  1647                                                                     CL**2
  1648***************    OUTPUT FROM ELRAMT   *************************    CL**2
  1649                                                                     CL**2
  1650         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  1651                                     COMP-3.                         CL**2
  1652         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  1653                                     COMP-3.                         CL**2
  1654         16  FILLER                PIC X(12).                        CL**2
  1655                                                                     CL**2
  1656***************    OUTPUT FROM ELRATE   *************************    CL**2
  1657                                                                     CL**2
  1658         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  1659                                     COMP-3.                         CL**2
  1660         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  1661                                     COMP-3.                         CL**2
  1662         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  1663         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  1664             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  1665         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  1666                                     COMP-3.                         CL**2
  1667         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  1668         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1669         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* EL547E.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1670                                   PIC S9(7)V99 COMP-3.
  1671         16  FILLER                PIC X(07).                        CL**2
  1672                                                                     CL**2
  1673***************    OUTPUT FROM ELRFND   *************************    CL**2
  1674                                                                     CL**2
  1675         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  1676                                     COMP-3.                         CL**2
  1677         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  1678           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  1679           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  1680           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  1681           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  1682           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1683           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  1684           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  1685           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  1686           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1687           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1688           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1689           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1690           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1691           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1692         16  FILLER                PIC X(12).                        CL**2
  1693                                                                     CL**2
  1694***************    OUTPUT FROM ELEARN   *************************    CL**2
  1695                                                                     CL**2
  1696         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  1697                                     COMP-3.                         CL**2
  1698         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  1699                                     COMP-3.                         CL**2
  1700         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  1701                                     COMP-3.                         CL**2
  1702         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  1703                                     COMP-3.                         CL**2
  1704         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  1705                                     COMP-3.                         CL**2
  1706         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  1707                                     COMP-3.                         CL**2
  1708         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1709           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1710           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1711           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1712           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1713           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1714           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1715           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1716           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1717           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1718         16  FILLER                PIC X(12).                        CL**2
  1719                                                                     CL**2
  1720***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1721                                                                     CL**2
  1722         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1723                                     COMP-3.                         CL**2
  1724         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1725                                     COMP-3.                         CL**2
  1726         16  FILLER                PIC X(12).                        CL**2
  1727                                                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* EL547E.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1728***************   MISC WORK AREAS    *****************************   CL**2
  1729         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1730                                     COMP-3.                         CL**2
  1731         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1732                                     COMP-3.                         CL**2
  1733         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1734                                     COMP-3.                         CL**2
  1735         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1736                                     COMP-3.                         CL**2
  1737         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1738                                     COMP-3.                         CL**2
  1739         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1740                                     COMP-3.                         CL**2
  1741         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1742             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1743             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1744             88  IO-ERROR                         VALUE 'E'.         CL**2
  1745                                                                     CL**2
  1746         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1747                                                                     CL**2
  1748         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1749                                                                     CL**2
  1750         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1751                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1752                                     COMP-3.                         CL**2
  1753                                                                     CL**2
  1754         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1755                                                                     CL**2
  1756         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1757                                     COMP-3.                         CL**2
  1758                                                                     CL**2
  1759         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1760                                     COMP-3.                         CL**2
  1761                                                                     CL**2
  1762         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1763                                     COMP-3.                         CL**2
  1764                                                                     CL**2
  1765         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1766                                     COMP-3.                         CL**2
  1767                                                                     CL**2
  1768         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1769                                     COMP-3.                         CL**2
  1770                                                                     CL**2
  1771         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1772                                     COMP-3.                         CL**2
  1773                                                                     CL**2
  1774         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1775                                     COMP-3.                         CL**2
  1776                                                                     CL**2
  1777         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1778             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1779                                                                     CL**2
  1780         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1781                                     COMP-3.                         CL**2
  1782         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1783                                     COMP-3.
  1784         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1785         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* EL547E.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1786         16  cp-net-only-state     pic x value spaces.
  1787         16  FILLER                PIC X(13).                        CL**2
  1788******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* EL547E.cbl
  1789/
* 1790                                 COPY ELCDATE.
  1791******************************************************************06/11/98
  1792*                                                                *ELCDATE
  1793*                                                                *ELCDATE
  1794*                            ELCDATE.                            *   LV023
  1795*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1796*                            VMOD=2.003                           ELCDATE
  1797*                                                                *ELCDATE
  1798*                                                                *ELCDATE
  1799*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1800*                 LENGTH = 200                                   *   CL*19
  1801******************************************************************ELCDATE
  1802                                                                  ELCDATE
  1803 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1804     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1805     12  DC-OPTION-CODE                PIC X.                        CL*15
  1806         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1807         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1808         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1809         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1810         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1811         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1812         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1813         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1814         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1815         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1816         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1817         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1818         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1819         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1820         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1821         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1822         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1823         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1824         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1825         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1826         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1827         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1828         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1829         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1830         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1831         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1832         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1833         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1834         88  THREE-CHARACTER-BIN                                  ELCDATE
  1835                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1836         88  GREGORIAN-TO-BIN                                        CL**2
  1837                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1838         88  BIN-TO-GREGORIAN                                        CL**2
  1839                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1840         88  JULIAN-TO-BINARY                                        CL**2
  1841                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1842     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1843         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1844         88  DATE-CONVERSION-ERROR                                ELCDATE
  1845                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1846         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1847         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1848         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1849         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1850         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1851         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1852         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1853         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1854         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1855         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1856     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1857         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1858     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1859         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1860         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1861         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1862     12  FILLER                        PIC X.                        CL*15
  1863     12  DC-CONVERSION-DATES.                                        CL*15
  1864         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1865         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1866         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1867         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1868                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1869             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1870             20  SLASH1-1              PIC X.                        CL*15
  1871             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1872             20  SLASH1-2              PIC X.                        CL*15
  1873             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1874         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1875         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1876                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1877             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1878             20  SLASH2-1              PIC X.                        CL*15
  1879             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1880             20  SLASH2-2              PIC X.                        CL*15
  1881             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1882         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1883         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1884                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1885             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1886             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1887             20  DC-YMD-DAY            PIC 99.                       CL*15
  1888         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1889         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1890                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1891             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1892             20  DC-MDY-DAY            PIC 99.                       CL*15
  1893             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1894         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1895             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1896             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1897             20  FILLER                PIC XX.                       CL*15
  1898             20  DC-ALPHA-CENTURY.                                   CL*15
  1899                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1900             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1901         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1902         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1903         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1904         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1905         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1906                                       PIC 9(05).                    CL*20
  1907         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1908             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1909             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1910         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1911         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1912         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1913     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1914         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1915         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1916             20  FILLER                PIC 9(3).                     CL*15
  1917             20  HOLD-CEN-1-CCYY.                                    CL*15
  1918                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1919                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1920             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1921             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1922         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1923             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1924             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1925             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1926                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1927                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1928             20  FILLER                PIC 9(3).                     CL*15
  1929         16  HOLD-CENTURY-1-X.                                       CL*15
  1930             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1931             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1932                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1933                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1934             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1935             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1936         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1937             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1938             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1939             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1940                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1941                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1942             20  FILLER                PIC XXX.                      CL*23
  1943         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1944         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1945         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1946         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1947             20  DC-JULIAN-1-CCYY.                                   CL*15
  1948                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1949                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1950             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1951         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1952         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1953             20  DC-JULIAN-2-CCYY.                                   CL*15
  1954                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1955                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1956             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1957         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1958             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1959             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1960             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1961             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1962             20  DC-EDITA-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1963                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1964                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1965         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1966             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1967             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1968             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1969             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1970             20  DC-EDITB-CCYY.                                      CL*15
  1971                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1972                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1973         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1974         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1975                              DC-GREG-DATE-CYMD.                  ELCDATE
  1976             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1977             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1978             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1979             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1980         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1981         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1982                              DC-GREG-DATE-MDCY.                  ELCDATE
  1983             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1984             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1985             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1986             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1987    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1988        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1989    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1990    12  FILLER                         PIC X(28).                    CL*26
* 1991                                 COPY ELCFUNDT.
  1992***************************************************************** 12/03/98
  1993*                                                               * ELCFUNDT
  1994*                            ELCFUNDT.                          *    LV004
  1995*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  1996*                            VMOD=2.001                         * ELCFUNDT
  1997*                                                               * ELCFUNDT
  1998*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  1999*                                                               * ELCFUNDT
  2000***************************************************************** ELCFUNDT
  2001                                                                  ELCFUNDT
  2002                                                                  ELCFUNDT
  2003 01  FUNCTION-DATE.                                                  CL**2
  2004     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  2005     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  2006         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  2007         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  2008             15  WS-FN-CC          PIC 99.                           CL**3
  2009             15  WS-FN-YR          PIC 99.                           CL**3
  2010         10  WS-FN-MO              PIC 99.                           CL**3
  2011         10  WS-FN-DA              PIC 99.                           CL**3
  2012     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  2013     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  2014     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  2015     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  2016     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  2017         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  2018         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  2019         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  2020     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* EL547E.cbl
  2021     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
  2022
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* EL547E.cbl
  2023/
* 2024                                 COPY ELCDTECX.
  2025******************************************************************06/05/98
  2026*                                                                *ELCDTECX
  2027*                            ELCDTECX.                           *   LV005
  2028*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2029*                            VMOD=2.015                          *ELCDTECX
  2030*                                                                *ELCDTECX
  2031*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  2032*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  2033*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  2034*                                                                *ELCDTECX
  2035******************************************************************ELCDTECX
  2036******************************************************************
  2037*                   C H A N G E   L O G
  2038*
  2039* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2040*-----------------------------------------------------------------
  2041*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2042* EFFECTIVE    NUMBER
  2043*-----------------------------------------------------------------
  2044* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  2045*                                  BENEFIT CODES FROM 300 TO 900
  2046* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  2047* 051304    2003080800002  SMVA  ADD REFUND METHOD
  2048* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  2049******************************************************************
  2050 01  DATE-CARD.                                                   ELCDTECX
  2051     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  2052     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  2053     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  2054     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  2055     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  2056     12  EP-SW                       PIC  X.                      ELCDTECX
  2057         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  2058     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  2059         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  2060     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  2061     12  RUN-CENTURY.                                             ELCDTECX
  2062         16 RUN-CENTURY-N            PIC  99.                        CL**4
  2063     12  FILLER                      PIC  X.                         CL**4
  2064     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  2065     12  FILLER                      PIC  XXX.                    ELCDTECX
  2066     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  2067                                                                  ELCDTECX
  2068 01  FILLER                          PIC  X(7)                       CL**6
  2069                                          VALUE 'OPTIONS'.        ELCDTECX
  2070 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  2071     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  2072     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  2073     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  2074         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  2075         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  2076     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  2077     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  2078     12  FILLER                      PIC  X.                      ELCDTECX
  2079     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  2080     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2081     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  2082     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  2083     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  2084     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  2085     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  2086     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  2087     12  FILLER                      PIC  X.                      ELCDTECX
  2088     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  2089     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  2090     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  2091     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  2092     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  2093     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  2094     12  FILLER                      PIC  X.                      ELCDTECX
  2095     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  2096     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  2097     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  2098     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  2099     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  2100     12  DTE-R78                     PIC  X.                      ELCDTECX
  2101     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  2102     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  2103     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  2104     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  2105     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  2106     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  2107     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  2108                                     PIC  X.                      ELCDTECX
  2109         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  2110                                                 ' '.             ELCDTECX
  2111         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  2112         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  2113     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  2114         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  2115         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  2116     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  2117     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  2118                                     PIC  9.                         CL**4
  2119     12  DTE-SYSTEM.                                              ELCDTECX
  2120         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  2121         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  2122         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  2123         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  2124         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  2125         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  2126         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  2127         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  2128         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  2129         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  2130         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  2131         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  2132         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  2133         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  2134         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  2135         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  2136         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  2137         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  2138         16  DTE-SYS-S               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2139         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  2140         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  2141         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  2142         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  2143         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  2144         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  2145         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  2146     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  2147         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  2148                                     PIC  X.                      ELCDTECX
  2149     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  2150                                                                  ELCDTECX
  2151 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  2152     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  2153     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  2154     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  2155*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  2156     12  FILLER                      PIC  X.                      ELCDTECX
  2157     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  2158     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  2159     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  2160     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  2161     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  2162     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  2163     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  2164                                                                  ELCDTECX
  2165     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  2166     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  2167     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  2168     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  2169                                                                  ELCDTECX
  2170     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  2171     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  2172     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  2173     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  2174                                                                  ELCDTECX
  2175     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  2176     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  2177                                                                  ELCDTECX
  2178     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  2179     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  2180                                                                  ELCDTECX
  2181     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  2182                                                                  ELCDTECX
  2183 01  DATE-CARD-FACTORS.                                           ELCDTECX
  2184     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  2185     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  2186     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  2187     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  2188     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  2189     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  2190     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  2191                                                                  ELCDTECX
  2192 01  FILLER                          PIC  X(12)                   ELCDTECX
  2193                                          VALUE 'COMPANY NAME'.   ELCDTECX
  2194 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  2195     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  2196         16  CNT-ID                  PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2197         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  2198                                                                  ELCDTECX
  2199 01  FILLER                          PIC  X(11)                   ELCDTECX
  2200                                          VALUE 'STATE NAMES'.    ELCDTECX
  2201 01  STATE-NAMES.                                                 ELCDTECX
  2202     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  2203         16  STATE-SUB               PIC  XX.                     ELCDTECX
  2204         16  STATE-PIC1.                                          ELCDTECX
  2205             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  2206             20  FILLER              PIC  XXX.                    ELCDTECX
  2207             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  2208             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  2209             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  2210             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  2211                                                                  ELCDTECX
  2212 01  FILLER                          PIC  X(13)                   ELCDTECX
  2213                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  2214 01  CARRIER-NAMES.                                               ELCDTECX
  2215     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  2216         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  2217         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  2218         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  2219         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2220         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2221         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2222*        16  FILLER                  PIC  X.                      ELCDTECX
  2223         16  CARRIER-SEC-PAY         PIC  X.
  2224             88  SEC-PAY-CARRIER          VALUE 'Y'.
  2225                                                                  ELCDTECX
  2226 01  FILLER                          PIC  X(9)                       CL**6
  2227                                          VALUE 'INS TYPES'.      ELCDTECX
  2228 01  CLAS-INS-TYPES.                                              ELCDTECX
  2229*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  2230     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  2231         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  2232         16  CLAS-I-AB3.                                          ELCDTECX
  2233             20  FILLER              PIC  X.                      ELCDTECX
  2234             20  CLAS-I-AB2.                                      ELCDTECX
  2235                 24  FILLER          PIC  X.                      ELCDTECX
  2236                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  2237         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  2238             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  2239             20  FILLER              PIC  X.                         CL**4
  2240         16  CLAS-I-AB10.                                         ELCDTECX
  2241             20  FILLER              PIC  X(9).                   ELCDTECX
  2242             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  2243         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  2244         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  2245         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  2246         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  2247             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  2248         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  2249         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  2250         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  2251         16  CLAS-I-BEN-CATEGORY     PIC  X.
  2252         16  CLAS-I-REFUND-METHOD    PIC  X.
  2253         16  CLAS-I-MAX-BENEFITS     PIC 99.
  2254         16  FILLER                  PIC  XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2255                                                                  ELCDTECX
  2256 01  FILLER                          PIC  X(16)                   ELCDTECX
  2257                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  2258 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  2259     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  2260                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  2261         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  2262         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  2263         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  2264         16  CLAS-MORT-DESC.                                      ELCDTECX
  2265             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  2266             20  FILLER              PIC  XX.                        CL**5
  2267             20  CLAS-YEAR           PIC  X(4).                      CL**6
  2268             20  FILLER              PIC  X.                         CL**5
  2269             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  2270             20  FILLER              PIC  X.                         CL**5
  2271             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  2272             20  FILLER              PIC  X.                         CL**5
  2273             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  2274             20  FILLER              PIC  X(5).                      CL**6
  2275                                                                  ELCDTECX
  2276 01  FILLER                          PIC  X(15)                   ELCDTECX
  2277                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  2278 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  2279     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  2280         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  2281         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  2282         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  2283         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  2284         16  FILLER                  PIC  X(4).                      CL**6
  2285                                                                  ELCDTECX
  2286 01  FILLER                          PIC  X(7)                       CL**6
  2287                                     VALUE 'INDEXES'.             ELCDTECX
  2288 01  CLAS-INDEX-TBL.                                              ELCDTECX
  2289     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  2290     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  2291     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  2292     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  2293     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  2294     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  2295     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  2296     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  2297     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  2298     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  2299     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  2300     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  2301     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  2302     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  2303     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  2304     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  2305     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  2306                                                                  ELCDTECX
  2307 01  CLAS-TYPE-MISC.                                              ELCDTECX
  2308     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  2309     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  2310     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  2311     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  2312     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2313     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  2314     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  2315     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  2316     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  2317     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  2318     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  2319                                                                  ELCDTECX
  2320 01  FILLER                          PIC  X(13)                   ELCDTECX
  2321                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  2322 01  CLAS-MISC.                                                   ELCDTECX
  2323     12  DTE-FICH                    PIC  X.                      ELCDTECX
  2324         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  2325         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  2326         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  2327     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  2328     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  2329     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  2330     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  2331     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  2332     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  2333     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  2334     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  2335     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  2336     12  STATE-L                     PIC  XX.                     ELCDTECX
  2337     12  CLAS-CN                     PIC  99.                     ELCDTECX
  2338     12  CLAS-CO                     PIC  99.                     ELCDTECX
  2339     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  2340         16  DTE-F-1                 PIC  X.                      ELCDTECX
  2341         16  DTE-F-2                 PIC  X.                      ELCDTECX
  2342     12  DTE-ABEND-WORK.                                          ELCDTECX
  2343         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  2344         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  2345                                                                  ELCDTECX
  2346 01  FILLER                          PIC  X(12)                   ELCDTECX
  2347                                     VALUE 'WORKING DATE'.        ELCDTECX
  2348 01  WS-DATE-AND-TIME.                                            ELCDTECX
  2349     12  WS-ACCEPT-DATE.                                          ELCDTECX
  2350         16  WS-AD-YY                PIC  99.                     ELCDTECX
  2351         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2352         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2353     12  WS-CURRENT-DATE.                                         ELCDTECX
  2354         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2355         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2356         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2357         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2358         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2359     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2360         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2361         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2362                                                                  ELCDTECX
  2363 01  FILLER                          PIC  X(12)                   ELCDTECX
  2364                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2365 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2366     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2367         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2368         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2369         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  2370                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2371 01  FILLER                          PIC  X(10)                   ELCDTECX
  2372                                     VALUE 'STATE TLRS'.          ELCDTECX
  2373 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2374     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2375         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2376         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2377                                                                  ELCDTECX
  2378 01  FILLER                          PIC  X(13)                   ELCDTECX
  2379                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2380 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2381     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2382         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2383                                                                  ELCDTECX
  2384 01  FILLER                          PIC  X(13)                   ELCDTECX
  2385                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2386 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2387     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2388     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2389     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2390                                     PIC  X.                         CL**5
  2391     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2392     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2393     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2394     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2395     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2396     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2397     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2398     12  FILLER                      PIC  X(75).                  ELCDTECX
  2399******************************************************************ELCDTECX
  2400*01  MISC-CARR-PCT-DATA.                                          00001521
  2401*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2402*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2403*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2404*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2405*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2406*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2407******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* EL547E.cbl
  2408/
* 2409                                 COPY ELCDTEVR.
  2410***************************************************************** 04/15/98
  2411*                                                                *ELCDTEVR
  2412*                                                                *ELCDTEVR
  2413*                            ELCDTEVR.                           *   LV003
  2414*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2415*                            VMOD=2.001                          *   CL**2
  2416*                                                                *ELCDTEVR
  2417*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2418*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2419*                                                                *ELCDTEVR
  2420******************************************************************ELCDTEVR
  2421 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2422     05  WS-RUN-DATE.                                             ELCDTEVR
  2423         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2424         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2425         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2426             15  RUN-CC              PIC  99.                     ELCDTEVR
  2427             15  RUN-YR              PIC  99.                     ELCDTEVR
  2428         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2429         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2430     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2431            WS-RUN-DATE              PIC 9(11).                      CL**2
  2432     05  WS-EP-DT.                                                ELCDTEVR
  2433         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2434         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2435         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2436             15  EP-CC               PIC  99.                     ELCDTEVR
  2437             15  EP-YR               PIC  99.                     ELCDTEVR
  2438         10  EP-MO                   PIC  99.                     ELCDTEVR
  2439         10  EP-DA                   PIC  99.                     ELCDTEVR
  2440     05  WS-EP-DT-N REDEFINES                                        CL**2
  2441            WS-EP-DT                 PIC 9(11).                      CL**2
  2442     05  WS-DTE-CONV-DT.                                             CL**4
  2443         10  FILLER                  PIC  9(03).                     CL**4
  2444         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2445         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2446             15  DTE-CONV-CC         PIC  99.                        CL**4
  2447             15  DTE-CONV-YR         PIC  99.                        CL**4
  2448         10  DTE-CONV-MO             PIC  99.                        CL**4
  2449         10  DTE-CONV-DA             PIC  99.                        CL**4
  2450     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2451            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2452 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2453     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2454         10  FILLER                            PIC 999.           ELCDTEVR
  2455         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2456         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2457             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2458             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2459         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2460         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2461     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2462            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2463     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2464         10  FILLER                            PIC 999.           ELCDTEVR
  2465         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2466         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2467         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2468         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2469     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2470            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2471 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2472     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2473         10  FILLER                            PIC 999.           ELCDTEVR
  2474         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2475         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2476             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2477             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2478         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2479         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2480     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2481            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2482     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2483         10  FILLER                            PIC 999.           ELCDTEVR
  2484         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2485         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  2486             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2487             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2488         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2489         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2490     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2491            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2492     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2493         10  FILLER                            PIC 999.           ELCDTEVR
  2494         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2495         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2496             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2497             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2498         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2499         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2500     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2501            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2502 01  WS-RATE-RECORD.                                              ELCDTEVR
  2503         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2504             10  FILLER                        PIC 999.           ELCDTEVR
  2505             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2506             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2507                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2508                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2509             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2510             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2511         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2512                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* EL547E.cbl
  2513/
  2514 PROCEDURE DIVISION.
  2515
  2516 0001-DT-CRD-READ SECTION.
* 2517                                 COPY ELCDTERX.
  2518******************************************************************04/15/98
  2519*                                                                *ELCDTERX
  2520*                                                                *ELCDTERX
  2521*                            ELCDTERX.                           *   LV002
  2522*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2523*                            VMOD=2.007                          *ELCDTERX
  2524*                                                                *ELCDTERX
  2525*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  2526*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  2527*      = ELCDTEFD)                                               *ELCDTERX
  2528*                                                                *ELCDTERX
  2529******************************************************************ELCDTERX
  2530                                                                  ELCDTERX
  2531     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  2532                                                                  ELCDTERX
  2533     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  2534     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  2535     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  2536                                                                  ELCDTERX
  2537     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  2538                                                                  ELCDTERX
  2539******************************************************************ELCDTERX
  2540*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  2541*          WARNING MESSAGES.                                      ELCDTERX
  2542******************************************************************ELCDTERX
  2543     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  2544         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  2545                                                                  ELCDTERX
  2546     OPEN INPUT DISK-DATE.                                        ELCDTERX
  2547                                                                  ELCDTERX
  2548     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  2549                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  2550                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  2551                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  2552                   CLAX-ID           CLAS-MISC                    ELCDTERX
  2553                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  2554                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  2555                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  2556                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  2557                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  2558                                                                  ELCDTERX
  2559     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  2560                                                                  ELCDTERX
  2561     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  2562                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  2563                                                                  ELCDTERX
  2564     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  2565     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  2566     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  2567     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  2568                                                                  ELCDTERX
  2569     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  2570         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2571     ELSE                                                         ELCDTERX
  2572         ADD +1                 TO CLAS-CN.                       ELCDTERX
  2573                                                                  ELCDTERX
  2574     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  2575         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  2576     ELSE                                                         ELCDTERX
  2577         ADD +1                 TO CLAS-CO.                       ELCDTERX
  2578                                                                  ELCDTERX
  2579 0005-READ--CARD.                                                 ELCDTERX
  2580     READ DISK-DATE                                               ELCDTERX
  2581         AT END CLOSE DISK-DATE                                   ELCDTERX
  2582             GO TO 0060-READ--TEST.                               ELCDTERX
  2583                                                                  ELCDTERX
  2584     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  2585                                                                  ELCDTERX
  2586     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  2587         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  2588         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  2589         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  2590         GO TO 0005-READ--CARD.                                   ELCDTERX
  2591                                                                  ELCDTERX
  2592     IF DD-ID = 'CLAD'                                            ELCDTERX
  2593         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  2594         GO TO 0005-READ--CARD.                                   ELCDTERX
  2595                                                                  ELCDTERX
  2596     IF DD-ID = 'CLAX'                                            ELCDTERX
  2597         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  2598         GO TO 0005-READ--CARD.                                   ELCDTERX
  2599                                                                  ELCDTERX
  2600     IF DD-ID = 'CLAF'                                            ELCDTERX
  2601         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  2602         GO TO 0005-READ--CARD.                                   ELCDTERX
  2603                                                                  ELCDTERX
  2604     IF DD-ID = 'CLAC'                                            ELCDTERX
  2605         GO TO 0010-READ--CLAC.                                   ELCDTERX
  2606                                                                  ELCDTERX
  2607     IF DD-ID = 'CARR'                                            ELCDTERX
  2608         GO TO 0015-READ--CARR.                                   ELCDTERX
  2609                                                                  ELCDTERX
  2610     IF DD-ID = 'STAT'                                            ELCDTERX
  2611         GO TO 0020-READ--STAT.                                   ELCDTERX
  2612                                                                  ELCDTERX
  2613     IF DD-ID = 'BUSC'                                            ELCDTERX
  2614         GO TO 0025-READ--BUSC.                                   ELCDTERX
  2615                                                                  ELCDTERX
  2616     IF DD-ID = 'MORT'                                            ELCDTERX
  2617         GO TO 0030-READ--MORT.                                   ELCDTERX
  2618                                                                  ELCDTERX
  2619     IF DD-ID = 'CLAI'                                            ELCDTERX
  2620         GO TO 0040-READ--CLAI.                                   ELCDTERX
  2621                                                                  ELCDTERX
  2622     IF DD-ID = 'COLC'                                            ELCDTERX
  2623         GO TO 0065-READ--COLC.                                   ELCDTERX
  2624                                                                  ELCDTERX
  2625     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2626        DD-IDA = 'CL'                                             ELCDTERX
  2627         GO TO 0035-READ--CLXX.                                   ELCDTERX
  2628                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2629     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2630        DD-IDA = 'PO'                                             ELCDTERX
  2631         GO TO 0050-READ--POXX.                                   ELCDTERX
  2632                                                                  ELCDTERX
  2633     IF DD-ID = 'OPCA'                                            ELCDTERX
  2634         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2635                                                                  ELCDTERX
  2636     IF DD-ID = 'OPST'                                            ELCDTERX
  2637         GO TO 0072-READ--OPST.                                   ELCDTERX
  2638                                                                  ELCDTERX
  2639     IF DD-ID = 'OPBS'                                            ELCDTERX
  2640         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2641                                                                  ELCDTERX
  2642     IF DD-ID = 'OPMS'                                            ELCDTERX
  2643         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2644                                                                  ELCDTERX
  2645     GO TO 0005-READ--CARD.                                       ELCDTERX
  2646                                                                  ELCDTERX
  2647 0010-READ--CLAC.                                                 ELCDTERX
  2648     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2649     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2650     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2651     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2652     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2653     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2654     GO TO 0005-READ--CARD.                                       ELCDTERX
  2655                                                                  ELCDTERX
  2656 0015-READ--CARR.                                                 ELCDTERX
  2657     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2658     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2659        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2660        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2661        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2662        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2663        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2664        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2665        MOVE DD-CARR1-SECPAY-SW
  2666                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2667     END-IF
  2668                                                                  ELCDTERX
  2669     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2670     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2671        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2672        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2673        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2674        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2675        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2676        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2677        MOVE DD-CARR2-SECPAY-SW
  2678                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2679     END-IF
  2680                                                                  ELCDTERX
  2681                                                                  ELCDTERX
  2682     GO TO 0005-READ--CARD.                                       ELCDTERX
  2683                                                                  ELCDTERX
  2684 0020-READ--STAT.                                                 ELCDTERX
  2685     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2686     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2687        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2688         GO TO 0005-READ--CARD.                                   ELCDTERX
  2689                                                                  ELCDTERX
  2690     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2691     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2692     GO TO 0020-READ--STAT.                                       ELCDTERX
  2693                                                                  ELCDTERX
  2694 0025-READ--BUSC.                                                 ELCDTERX
  2695     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2696     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2697        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2698         GO TO 0005-READ--CARD.                                   ELCDTERX
  2699                                                                  ELCDTERX
  2700     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2701     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2702     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2703                                                                  ELCDTERX
  2704 0030-READ--MORT.                                                 ELCDTERX
  2705     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2706     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2707        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2708         GO TO 0005-READ--CARD.                                   ELCDTERX
  2709                                                                  ELCDTERX
  2710     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2711     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2712     GO TO 0030-READ--MORT.                                       ELCDTERX
  2713                                                                  ELCDTERX
  2714 0035-READ--CLXX.                                                 ELCDTERX
  2715     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2716          GO TO 0005-READ--CARD.                                  ELCDTERX
  2717                                                                  ELCDTERX
  2718     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2719         DISPLAY '***********************************************'ELCDTERX
  2720         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2721         DISPLAY '***********************************************'ELCDTERX
  2722         GO TO 0055-READ--STOP.                                   ELCDTERX
  2723                                                                  ELCDTERX
  2724     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2725        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2726         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2727                                                                  ELCDTERX
  2728     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2729        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2730         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2731                                                                  ELCDTERX
  2732*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2733     GO TO 0005-READ--CARD.                                       ELCDTERX
  2734                                                                  ELCDTERX
  2735 0040-READ--CLAI.                                                 ELCDTERX
  2736     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2737     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2738        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2739         GO TO 0005-READ--CARD.                                   ELCDTERX
  2740                                                                  ELCDTERX
  2741     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2742     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2743     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2744                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2745 0045-READ--DUMP.                                                 ELCDTERX
  2746     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2747     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2748                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2749     PERFORM ABEND-PGM.                                           ELCDTERX
  2750                                                                  ELCDTERX
  2751 0050-READ--POXX.                                                 ELCDTERX
  2752     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2753         GO TO 0005-READ--CARD.                                   ELCDTERX
  2754                                                                  ELCDTERX
  2755     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2756         DISPLAY '***********************************************'ELCDTERX
  2757         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2758         DISPLAY '***********************************************'ELCDTERX
  2759         GO TO 0055-READ--STOP.                                   ELCDTERX
  2760                                                                  ELCDTERX
  2761     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2762     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2763     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2764     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2765                                                                  ELCDTERX
  2766     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2767         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2768     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2769         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2770                                                                  ELCDTERX
  2771     GO TO 0005-READ--CARD.                                       ELCDTERX
  2772                                                                  ELCDTERX
  2773 0055-READ--STOP.                                                 ELCDTERX
  2774     GOBACK.                                                      ELCDTERX
  2775                                                                  ELCDTERX
  2776 0060-READ--TEST.                                                 ELCDTERX
  2777     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2778        CLAX-ID         = SPACE  OR                               ELCDTERX
  2779        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2780         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2781                                                                  ELCDTERX
  2782     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2783     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2784                                                                  ELCDTERX
  2785 0065-READ--COLC.                                                 ELCDTERX
  2786     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2787     GO TO 0005-READ--CARD.                                       ELCDTERX
  2788                                                                  ELCDTERX
  2789 0070-READ--OPCA.                                                 ELCDTERX
  2790                                                                  ELCDTERX
  2791     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2792                                                                  ELCDTERX
  2793     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2794             OR                                                   ELCDTERX
  2795         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2796         GO TO 0005-READ--CARD.                                   ELCDTERX
  2797                                                                  ELCDTERX
  2798     ADD 1                       TO INDEXCA.                      ELCDTERX
  2799     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2800                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2801     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2802                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* EL547E.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2803 0072-READ--OPST.                                                 ELCDTERX
  2804                                                                  ELCDTERX
  2805     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2806                                                                  ELCDTERX
  2807     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2808             OR                                                   ELCDTERX
  2809         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2810         GO TO 0005-READ--CARD.                                   ELCDTERX
  2811                                                                  ELCDTERX
  2812     ADD 1                       TO INDEXST.                      ELCDTERX
  2813     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2814                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2815     GO TO 0072-READ--OPST.                                       ELCDTERX
  2816                                                                  ELCDTERX
  2817 0074-READ--OPBS.                                                 ELCDTERX
  2818                                                                  ELCDTERX
  2819     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2820                                                                  ELCDTERX
  2821     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2822             OR                                                   ELCDTERX
  2823         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2824         GO TO 0005-READ--CARD.                                   ELCDTERX
  2825                                                                  ELCDTERX
  2826     ADD 1                       TO INDEXBS.                      ELCDTERX
  2827     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2828     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2829                                                                  ELCDTERX
  2830 0079-READ--EXIT.                                                 ELCDTERX
  2831*    EXIT.                                                        ELCDTERX
  2832******************************************************************ELCDTERX
  2833
  2834     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2835     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  2836     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  2837
  2838
  2839     PERFORM 0010-INITIALIZE     THRU 0010-EXIT
  2840
  2841     PERFORM 0020-OPEN-FILES     THRU 0020-EXIT
  2842
  2843     PERFORM 0050-PROCESS-FILE   THRU 0050-EXIT
  2844
  2845     PERFORM 0030-CLOSE-FILES    THRU 0030-EXIT
  2846
  2847
  2848     GOBACK
  2849     .
  2850
  2851 0010-INITIALIZE.
  2852
  2853*    DISPLAY ' MADE IT TO 0010 '
  2854     MOVE RUN-DATE               TO WS-WORK-DATE
  2855
  2856     MOVE 198601                 TO WS-LO-ISSUE-CCYYMM
  2857                                    WS-LO-VALUATION-CCYYMM
  2858*    MOVE 1990                   TO WS-LO-ISSUE-CCYYMM
  2859*                                   WS-LO-VALUATION-CCYYMM
  2860     MOVE WS-WORK-CCYYMM         TO WS-HI-ISSUE-CCYYMM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* EL547E.cbl
  2861     PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  2862            (IYR > +600) OR
  2863            (WS-ISSUE-CCYYMM (IYR) > WS-HI-ISSUE-CCYYMM)
  2864        MOVE WS-LO-VALUATION-CCYYMM TO WS-ISSUE-CCYYMM (IYR)
  2865        ADD +1 TO WS-LO-VALUATION-CCYYMM
  2866        IF WS-LO-VAL-MM > 12
  2867           MOVE 01               TO WS-LO-VAL-MM
  2868           ADD 1                 TO WS-LO-VAL-CCYY
  2869        END-IF
  2870     END-PERFORM
  2871
  2872     MOVE WS-LO-ISSUE-CCYYMM     TO WS-LO-VALUATION-CCYYMM
  2873                                    WS-WORK-CCYYMM
  2874
  2875     PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  2876            VYR > +600
  2877          PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  2878             IYR > +600
  2879             MOVE WS-WORK-CCYYMM TO WS-VALUATION-CCYYMM (IYR VYR)
  2880          END-PERFORM
  2881        MOVE WS-WORK-CCYYMM      TO WS-CCYYMM
  2882
  2883        IF WS-MM = 01 OR 03 OR 05 OR 07 OR 08 OR 10 OR 12
  2884           MOVE 31               TO WS-DD
  2885        ELSE
  2886           IF WS-MM = 04 OR 06 OR 09 OR 11
  2887              MOVE 30            TO WS-DD
  2888           ELSE
  2889              MOVE 01            TO WS-DD
  2890              MOVE WS-END-YEAR   TO DC-GREG-DATE-CYMD
  2891              MOVE 'L'           TO DC-OPTION-CODE
  2892              PERFORM 8510-DATE-CONVERSION
  2893                                 THRU 8590-EXIT
  2894              IF NO-CONVERSION-ERROR
  2895                 DISPLAY ' FEB DAYS ' DC-DAYS-IN-MONTH
  2896                 MOVE DC-DAYS-IN-MONTH
  2897                                 TO WS-DD
  2898              ELSE
  2899                 DISPLAY ' PROBLEMOS WITH FEB VAL DTE CONV '
  2900                 PERFORM ABEND-PGM
  2901              END-IF
  2902           END-IF
  2903        END-IF
  2904
  2905        MOVE WS-END-YEAR         TO DC-GREG-DATE-CYMD
  2906        MOVE 'L'                 TO DC-OPTION-CODE
  2907        PERFORM 8510-DATE-CONVERSION
  2908                                 THRU 8590-EXIT
  2909        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DATES (VYR)
  2910        ADD 1                    TO WS-WORK-CCYYMM
  2911        IF WS-WORK-MM > 12
  2912           MOVE 01               TO WS-WORK-MM
  2913           ADD 1                 TO WS-WORK-CCYY
  2914        END-IF
  2915     END-PERFORM
  2916
  2917     SUBTRACT +1 FROM WS-WORK-CCYYMM
  2918     IF WS-WORK-MM = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* EL547E.cbl
  2919        MOVE 12                  TO WS-WORK-MM
  2920        SUBTRACT 1               FROM WS-WORK-CCYY
  2921     END-IF
  2922     MOVE WS-WORK-CCYYMM         TO WS-HI-VALUATION-CCYYMM
  2923
  2924     PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  2925         IYR > +600
  2926         PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  2927            VYR > +600
  2928            MOVE +0              TO WS-LF-INFORCE (IYR VYR)
  2929                                    WS-LF-WRITTEN (IYR VYR)
  2930                                    WS-AH-WRITTEN (IYR VYR)
  2931                                    WS-LF-REFUNDS (IYR VYR)
  2932                                    WS-AH-REFUNDS (IYR VYR)
  2933                                    WS-LF-R78     (IYR VYR)
  2934                                    WS-LF-PRO     (IYR VYR)
  2935                                    WS-LF-ST      (IYR VYR)
  2936                                    WS-LF-R78-EP  (IYR VYR)
  2937                                    WS-LF-PRO-EP  (IYR VYR)
  2938                                    WS-LF-ST-EP   (IYR VYR)
  2939                                    WS-AH-R78     (IYR VYR)
  2940                                    WS-AH-PRO     (IYR VYR)
  2941                                    WS-AH-ST      (IYR VYR)
  2942                                    WS-AH-R78-EP  (IYR VYR)
  2943                                    WS-AH-PRO-EP  (IYR VYR)
  2944                                    WS-AH-ST-EP   (IYR VYR)
  2945                                    WS-LF-CLAIM   (IYR VYR)
  2946                                    WS-AH-CLAIM   (IYR VYR)
  2947         END-PERFORM
  2948     END-PERFORM
  2949
  2950     MOVE SPACES                 TO WS-EXTRACT-RECORD
  2951     MOVE ';'                    TO WS-TAB1
  2952                                    WS-TAB2
  2953                                    WS-TAB3
  2954                                    WS-TAB4
  2955                                    WS-TAB5
  2956                                    WS-TAB6
  2957                                    WS-TAB7
  2958                                    WS-TAB8
  2959                                    WS-TAB9
  2960                                    WS-TAB10
  2961                                    WS-TAB11
  2962                                    WS-TAB12
  2963                                    WS-TAB13
  2964                                    WS-TAB14
  2965                                    WS-TAB15
  2966                                    WS-TAB16
  2967                                    WS-TAB17
  2968                                    WS-TAB18
  2969                                    WS-TAB19
  2970                                    WS-TAB20
  2971     MOVE WS-EXTRACT-RECORD      TO WS-INIT-EXT-RECORD
  2972
  2973     MOVE ';'                    TO WS-HTAB1
  2974                                    WS-HTAB2
  2975                                    WS-HTAB3
  2976                                    WS-HTAB4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* EL547E.cbl
  2977                                    WS-HTAB5
  2978                                    WS-HTAB6
  2979                                    WS-HTAB7
  2980                                    WS-HTAB8
  2981                                    WS-HTAB9
  2982                                    WS-HTAB10
  2983                                    WS-HTAB11
  2984                                    WS-HTAB12
  2985                                    WS-HTAB13
  2986                                    WS-HTAB14
  2987                                    WS-HTAB15
  2988                                    WS-HTAB16
  2989                                    WS-HTAB17
  2990                                    WS-HTAB18
  2991                                    WS-HTAB19
  2992                                    WS-HTAB20
  2993
  2994
  2995     DISPLAY '  LO ISSUE  ' WS-LO-ISSUE-CCYYMM
  2996           '    HI ISSUE  ' WS-HI-ISSUE-CCYYMM
  2997     DISPLAY '  LO VALUE  ' WS-LO-VALUATION-CCYYMM
  2998           '    HI VALUE  ' WS-HI-VALUATION-CCYYMM
  2999
  3000     .
  3001
  3002 0010-EXIT.
  3003     EXIT.
  3004
  3005 0020-OPEN-FILES.
  3006
  3007     DISPLAY ' MADE IT TO 0020 '
  3008     OPEN INPUT CERTS CLMS-HIST
  3009         OUTPUT EXTRACT
  3010
  3011     .
  3012
  3013 0020-EXIT.
  3014     EXIT.
  3015
  3016 0030-CLOSE-FILES.
  3017     DISPLAY ' MADE IT TO 0030 '
  3018
  3019     CLOSE CERTS CLMS-HIST
  3020         EXTRACT
  3021
  3022     .
  3023
  3024 0030-EXIT.
  3025     EXIT.
  3026
  3027 0050-PROCESS-FILE.
  3028
  3029*    DISPLAY ' MADE IT TO 0050 '
  3030     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  3031     PERFORM 0080-PROCESS-CERT   THRU 0080-EXIT UNTIL
  3032           THERE-ARE-NO-MORE-RECORDS
  3033
  3034     DISPLAY ' FINISHED CERTS '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* EL547E.cbl
  3035
  3036     SET THERE-ARE-MORE-RECORDS TO TRUE
  3037
  3038     PERFORM 0070-READ-CLMS      THRU 0070-EXIT UNTIL
  3039         (THERE-ARE-NO-MORE-RECORDS) OR
  3040         ((DE-REIN = SPACES) AND
  3041         (DE-CLAIM))
  3042
  3043     DISPLAY ' POSITIONED CLAIMS '
  3044
  3045     IF NOT THERE-ARE-NO-MORE-RECORDS
  3046        PERFORM 0090-PROCESS-CLMS
  3047                                 THRU 0090-EXIT UNTIL
  3048           THERE-ARE-NO-MORE-RECORDS
  3049     END-IF
  3050
  3051     DISPLAY ' FINISHED CLMS  '
  3052
  3053     PERFORM 0500-EMPTY-TABLE    THRU 0500-EXIT
  3054
  3055     .
  3056
  3057 0050-EXIT.
  3058     EXIT.
  3059
  3060 0060-READ-CERT.
  3061
  3062*    DISPLAY ' MADE IT TO 0060 '
  3063     READ CERTS AT END
  3064         SET THERE-ARE-NO-MORE-RECORDS TO TRUE
  3065     END-READ
  3066
  3067     IF NOT THERE-ARE-NO-MORE-RECORDS
  3068        ADD +1                   TO WS-CRT-CNT
  3069                                    WS-CRT-CNT-TOT
  3070        IF WS-CRT-CNT = +10000
  3071           DISPLAY ' CERTS READ ' WS-CRT-CNT-TOT
  3072           MOVE +0               TO WS-CRT-CNT
  3073        END-IF
  3074        IF CR-CERT-NO = '0000109489 '
  3075           DISPLAY ' FOUND BAD CERT '
  3076        END-IF
  3077     END-IF
  3078
  3079     .
  3080
  3081 0060-EXIT.
  3082     EXIT.
  3083
  3084 0070-READ-CLMS.
  3085
  3086*    DISPLAY ' MADE IT TO 0070 '
  3087     READ CLMS-HIST AT END
  3088         SET THERE-ARE-NO-MORE-RECORDS TO TRUE
  3089     END-READ
  3090
  3091     IF NOT THERE-ARE-NO-MORE-RECORDS
  3092        ADD +1                   TO WS-CLM-CNT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* EL547E.cbl
  3093                                    WS-CLM-CNT-TOT
  3094        IF WS-CLM-CNT = +10000
  3095           DISPLAY ' CLMS  READ ' WS-CLM-CNT-TOT
  3096           MOVE +0               TO WS-CLM-CNT
  3097        END-IF
  3098     END-IF
  3099
  3100     .
  3101
  3102 0070-EXIT.
  3103     EXIT.
  3104
  3105 0080-PROCESS-CERT.
  3106
  3107*    DISPLAY ' MADE IT TO 0080 '
  3108     MOVE CR-DT                  TO WS-EFFECT-DATE
  3109     MOVE CR-ENTRY-DATE          TO WS-ENTRY-DATE
  3110
  3111     IF (WS-EFFECT-CCYYMM < WS-LO-ISSUE-CCYYMM) OR
  3112        (WS-EFFECT-CCYYMM > WS-HI-ISSUE-CCYYMM) OR
  3113        (CR-ENTRY-STATUS = '9' OR 'D' OR 'V' OR 'M')
  3114        CONTINUE
  3115     ELSE
  3116        PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  3117           WS-EFFECT-CCYYMM = WS-ISSUE-CCYYMM (IYR)
  3118        END-PERFORM
  3119        PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3120           WS-ENTRY-CCYYMM = WS-VALUATION-CCYYMM (IYR VYR)
  3121        END-PERFORM
  3122        IF CR-ENTRY-STATUS = '5'
  3123           CONTINUE
  3124        ELSE
  3125           IF CR-LFTYP NOT = '00' AND '  '
  3126             COMPUTE WS-LF-WRITTEN (IYR VYR) =
  3127               WS-LF-WRITTEN (IYR VYR) +
  3128               CR-LFPRM + CR-LFPRM-ALT
  3129           END-IF
  3130           COMPUTE WS-AH-WRITTEN (IYR VYR) =
  3131               WS-AH-WRITTEN (IYR VYR) + CR-AHPRM
  3132        END-IF
  3133*       IF (CR-LF-CANC-DT NOT = ZEROS)
  3134*       IF (CR-LF-CANC-DT > 19851231)
  3135*          MOVE CR-LF-CANC-DT    TO WS-CANCEL-DATE
  3136        IF (CR-LF-CANCEL-EXIT-DATE > 19851231)
  3137           MOVE CR-LF-CANCEL-EXIT-DATE    TO WS-CANCEL-DATE
  3138           PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3139              WS-CANCEL-CCYYMM = WS-VALUATION-CCYYMM (IYR VYR)
  3140           END-PERFORM
  3141           COMPUTE WS-LF-REFUNDS (IYR VYR) =
  3142                 WS-LF-REFUNDS (IYR VYR) + CR-LFRFND
  3143        END-IF
  3144*       IF (CR-AH-CANC-DT NOT = ZEROS)
  3145*       IF (CR-AH-CANC-DT > 19851231)
  3146*          MOVE CR-AH-CANC-DT    TO WS-CANCEL-DATE
  3147        IF (CR-AH-CANCEL-EXIT-DATE > 19851231)
  3148           MOVE CR-AH-CANCEL-EXIT-DATE    TO WS-CANCEL-DATE
  3149           PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3150              WS-CANCEL-CCYYMM = WS-VALUATION-CCYYMM (IYR VYR)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* EL547E.cbl
  3151           END-PERFORM
  3152           COMPUTE WS-AH-REFUNDS (IYR VYR) =
  3153                 WS-AH-REFUNDS (IYR VYR) + CR-AHRFND
  3154        END-IF
  3155        IF CR-ENTRY-STATUS NOT = '5'
  3156           PERFORM 0200-CALC-UEP    THRU 0200-EXIT
  3157        END-IF
  3158     END-IF
  3159
  3160     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  3161
  3162     .
  3163
  3164 0080-EXIT.
  3165     EXIT.
  3166
  3167 0090-PROCESS-CLMS.
  3168
  3169*    DISPLAY ' MADE IT TO 0090 '
  3170*    MOVE DE-EFF                 TO WS-EFFECT-DATE
  3171     MOVE DE-ENTRY-DTE           TO WS-EFFECT-DATE
  3172     MOVE DE-CLM-PROC-DT         TO WS-CLAIM-DATE
  3173*    MOVE DE-PAY                 TO WS-CLAIM-DATE
  3174*    MOVE DE-INCUR               TO WS-CLAIM-DATE
  3175
  3176     IF (DE-REIN = ' ') AND
  3177        (DE-TRANS = 'X')
  3178     IF (DE-CLM-PROC-DT > RUN-DATE)
  3179        CONTINUE
  3180     ELSE
  3181        IF (WS-EFFECT-CCYYMM < WS-LO-ISSUE-CCYYMM) OR
  3182           (WS-EFFECT-CCYYMM > WS-HI-ISSUE-CCYYMM)
  3183           CONTINUE
  3184        ELSE
  3185           PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  3186              WS-EFFECT-CCYYMM = WS-ISSUE-CCYYMM (IYR)
  3187           END-PERFORM
  3188           PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3189              WS-CLAIM-CCYYMM = WS-VALUATION-CCYYMM (IYR VYR)
  3190           END-PERFORM
  3191           IF DE-DEATH
  3192              COMPUTE WS-LF-CLAIM (IYR VYR) =
  3193                     WS-LF-CLAIM (IYR VYR) +
  3194                     DE-CLAIM-AMT
  3195           ELSE
  3196              COMPUTE WS-AH-CLAIM (IYR VYR) =
  3197                     WS-AH-CLAIM (IYR VYR) +
  3198                     DE-CLAIM-AMT
  3199           END-IF
  3200        END-IF
  3201     END-IF
  3202     END-IF
  3203
  3204     PERFORM 0070-READ-CLMS      THRU 0070-EXIT
  3205
  3206     .
  3207
  3208 0090-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* EL547E.cbl
  3209     EXIT.
  3210
  3211 0200-CALC-UEP.
  3212
  3213*    DISPLAY ' MADE IT TO 0200 '
  3214     IF CR-STATE = STATE-SUB (CLAS-INDEXS)
  3215        CONTINUE
  3216     ELSE
  3217        PERFORM VARYING CLAS-INDEXS FROM +1 BY +1 UNTIL
  3218            (CLAS-INDEXS > CLAS-MAXS) OR
  3219            CR-STATE = STATE-SUB (CLAS-INDEXS)
  3220        END-PERFORM
  3221        IF CR-STATE = STATE-SUB (CLAS-INDEXS)
  3222           CONTINUE
  3223        ELSE
  3224           DISPLAY 'STATE ' CR-STATE ' NOT IN TABLE'
  3225           MOVE 0302 TO WS-RETURN-CODE
  3226           PERFORM ABEND-PGM
  3227        END-IF
  3228     END-IF
  3229
  3230     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  3231     MOVE 'L'                    TO DC-OPTION-CODE
  3232     PERFORM 8510-DATE-CONVERSION
  3233                                 THRU 8590-EXIT
  3234     MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
  3235                                    WS-BIN-CR-DT
  3236
  3237     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  3238        MOVE ZEROS               TO CR-LOAN-1ST-PMT-DT
  3239     END-IF
  3240
  3241     MOVE LOW-VALUES             TO CP-FIRST-PAY-DATE
  3242
  3243     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  3244        MOVE CR-LOAN-1ST-PMT-DT  TO DC-GREG-DATE-1-YMD
  3245        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  3246                                    DC-ELAPSED-DAYS
  3247        MOVE '3'                 TO DC-OPTION-CODE
  3248        PERFORM 8510-DATE-CONVERSION
  3249                                 THRU 8590-EXIT
  3250        IF NO-CONVERSION-ERROR
  3251           MOVE DC-BIN-DATE-1   TO CP-FIRST-PAY-DATE
  3252        ELSE
  3253           MOVE ZEROS           TO CR-LOAN-1ST-PMT-DT
  3254        END-IF
  3255      END-IF
  3256
  3257     IF CP-FIRST-PAY-DATE  LESS THAN  CP-CERT-EFF-DT
  3258        MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT
  3259     END-IF
  3260
  3261     IF CR-LOAN-1ST-PMT-DT = ZEROS
  3262        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  3263        MOVE +1                  TO DC-ELAPSED-MONTHS
  3264        MOVE ZEROS               TO DC-ELAPSED-DAYS
  3265        MOVE '6'                 TO DC-OPTION-CODE
  3266        PERFORM 8510-DATE-CONVERSION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* EL547E.cbl
  3267                                 THRU 8590-EXIT
  3268        MOVE DC-BIN-DATE-2       TO CP-FIRST-PAY-DATE
  3269        MOVE DC-GREG-DATE-1-YMD  TO CR-LOAN-1ST-PMT-DT
  3270     END-IF
  3271
  3272     MOVE CR-LF-EXPIRE-DATE          TO WS-WORK-DATE
  3273
  3274     IF (CR-LF-CANC-DT NOT = ZEROS) AND
  3275        (CR-LF-CANC-DT < WS-WORK-DATE)
  3276        MOVE CR-LF-CANC-DT           TO WS-WORK-DATE
  3277     END-IF
  3278
  3279     IF (CR-LF-CLAIM-EXIT-DATE NOT = ZEROS) AND
  3280        (CR-LF-CLAIM-EXIT-DATE < WS-WORK-DATE)
  3281        MOVE CR-LF-CLAIM-EXIT-DATE   TO WS-WORK-DATE
  3282     END-IF
  3283
  3284     MOVE WS-WORK-DATE           TO DC-GREG-DATE-CYMD
  3285     MOVE 'L'                    TO DC-OPTION-CODE
  3286     PERFORM 8510-DATE-CONVERSION
  3287                                 THRU 8590-EXIT
  3288     MOVE DC-BIN-DATE-1          TO WS-BIN-LF-END-DATE
  3289
  3290     MOVE CR-AH-EXPIRE-DATE          TO WS-WORK-DATE
  3291
  3292     IF (CR-AH-CANC-DT NOT = ZEROS) AND
  3293        (CR-AH-CANC-DT < WS-WORK-DATE)
  3294        MOVE CR-AH-CANC-DT           TO WS-WORK-DATE
  3295     END-IF
  3296
  3297     IF (CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS) AND
  3298        (CR-AH-SETTLEMENT-EXIT-DATE < WS-WORK-DATE)
  3299        MOVE CR-AH-SETTLEMENT-EXIT-DATE
  3300                                     TO WS-WORK-DATE
  3301     END-IF
  3302
  3303     MOVE WS-WORK-DATE           TO DC-GREG-DATE-CYMD
  3304     MOVE 'L'                    TO DC-OPTION-CODE
  3305     PERFORM 8510-DATE-CONVERSION
  3306                                 THRU 8590-EXIT
  3307     MOVE DC-BIN-DATE-1          TO WS-BIN-AH-END-DATE
  3308
  3309
  3310     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE
  3311     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV
  3312     MOVE '3'                        TO CP-PROCESS-TYPE
  3313     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD
  3314     MOVE DTE-CLIENT                 TO CP-COMPANY-ID
  3315     MOVE SPACES                     TO CP-ACCT-FLD-5
  3316     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD
  3317
  3318     IF CR-LFTYP = '00' OR '  '
  3319        CONTINUE
  3320     ELSE
  3321        PERFORM 0210-CALC-LIFE-UEP   THRU 0210-EXIT
  3322     END-IF
  3323
  3324     IF CR-AHTYP = '00' OR '  '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* EL547E.cbl
  3325        CONTINUE
  3326     ELSE
  3327        PERFORM 0410-CALC-AH-UEP   THRU 0410-EXIT
  3328     END-IF
  3329
  3330     .
  3331
  3332 0200-EXIT.
  3333     EXIT.
  3334
  3335 0210-CALC-LIFE-UEP.
  3336
  3337*    DISPLAY ' MADE IT TO 0210 '
  3338     IF CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL)
  3339        CONTINUE
  3340     ELSE
  3341        PERFORM VARYING CLAS-INDEXL FROM +1 BY +1 UNTIL
  3342            (CLAS-INDEXL = CLAS-MAXL) OR
  3343            (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
  3344        END-PERFORM
  3345        IF CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL)
  3346           CONTINUE
  3347        ELSE
  3348           DISPLAY 'LIFE BENEFIT ' CR-LFTYP ' NOT IN TABLE'
  3349           DISPLAY 'RETURN CODE - 0401'
  3350           MOVE 0401 TO WS-RETURN-CODE
  3351           PERFORM ABEND-PGM
  3352        END-IF
  3353     END-IF
  3354
  3355     COMPUTE WS-CERT-PREV-R78 = CR-LFPRM + CR-LFPRM-ALT
  3356     MOVE WS-CERT-PREV-R78       TO WS-CERT-PREV-PRO
  3357                                    WS-CERT-PREV-ST
  3358
  3359     PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3360         (VYR > +600) OR
  3361         (WS-BIN-VAL-DATES (VYR) NOT < CP-CERT-EFF-DT)
  3362     END-PERFORM
  3363
  3364     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  3365        CONTINUE
  3366     ELSE
  3367       PERFORM VARYING VYR FROM VYR BY +1 UNTIL
  3368         (VYR > +600) OR
  3369         (WS-BIN-VAL-DATES (VYR) NOT < WS-BIN-LF-END-DATE)
  3370
  3371        PERFORM 0220-CALC-LF-REM-TERM
  3372                                 THRU 0220-EXIT
  3373        MOVE ZEROS               TO WS-REM-AMT
  3374        IF LF-REM-TRM2 > ZERO
  3375           PERFORM 2000-CALC-REM-AMT
  3376                                 THRU 2999-CALC-REM-AMT-X
  3377        END-IF
  3378        COMPUTE WS-LF-INFORCE (IYR VYR) =
  3379            WS-LF-INFORCE (IYR VYR) + WS-REM-AMT
  3380        PERFORM 0230-CALC-LF-UEP THRU 0230-EXIT
  3381       END-PERFORM
  3382     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* EL547E.cbl
  3383
  3384     .
  3385
  3386 0210-EXIT.
  3387     EXIT.
  3388
  3389 0220-CALC-LF-REM-TERM.
  3390
  3391*    DISPLAY ' MADE IT TO 0220 '
  3392     MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
  3393
  3394     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  3395                                 TO CP-BENEFIT-TYPE
  3396     MOVE CLAS-I-BAL (CLAS-INDEXL)
  3397                                 TO CP-SPECIAL-CALC-CD
  3398     MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  3399                                    CP-LOAN-TERM
  3400
  3401     IF ((CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L') AND
  3402        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L')
  3403        ADD +1                   TO CP-ORIGINAL-TERM
  3404                                    CP-LOAN-TERM
  3405     END-IF
  3406
  3407     IF CP-TERM-IS-DAYS
  3408        MOVE CR-LF-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
  3409     ELSE
  3410        MOVE ZEROS               TO CP-TERM-OR-EXT-DAYS
  3411     END-IF
  3412
  3413     MOVE DTE-REM-TRM-CALC-OPTION
  3414                                 TO CP-REM-TRM-CALC-OPTION
  3415
  3416     PERFORM 0510-GET-REMAINING-TERM
  3417                                 THRU 0510-EXIT
  3418
  3419     IF ((CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  3420          CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  3421*       MOVE CP-REMAINING-TERM-2 TO LF-BAL-REMTERM
  3422        COMPUTE CP-REMAINING-TERM-1 =
  3423                       CP-REMAINING-TERM-1 - 1
  3424        COMPUTE CP-REMAINING-TERM-2 =
  3425                       CP-REMAINING-TERM-2 - 1
  3426     END-IF
  3427
  3428     IF CP-REMAINING-TERM-1 NEGATIVE
  3429         MOVE ZEROS              TO CP-REMAINING-TERM-1
  3430     END-IF
  3431
  3432     IF CP-REMAINING-TERM-2 NEGATIVE
  3433         MOVE ZEROS              TO CP-REMAINING-TERM-2
  3434     END-IF
  3435
  3436     MOVE CP-REMAINING-TERM-1    TO LF-REM-TRM1
  3437     MOVE CP-REMAINING-TERM-2    TO LF-REM-TRM2
  3438
  3439     .
  3440
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* EL547E.cbl
  3441 0220-EXIT.
  3442     EXIT.
  3443
  3444 0230-CALC-LF-UEP.
  3445
  3446*    DISPLAY ' MADE IT TO 0230 '
  3447     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM
  3448     MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  3449     MOVE LF-REM-TRM1            TO CP-REMAINING-TERM
  3450     MOVE CLAS-I-EP (CLAS-INDEXL)
  3451                                 TO CP-EARNING-METHOD
  3452     MOVE CR-LFPRM-ALT           TO CP-ALTERNATE-PREMIUM
  3453     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  3454                                 TO CP-BENEFIT-TYPE
  3455     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
  3456                                 TO CP-SPECIAL-CALC-CD
  3457     MOVE CR-LFTYP               TO CP-BENEFIT-CD
  3458     MOVE LIFE-OVERRIDE-L1       TO CP-LIFE-OVERRIDE-CODE
  3459
  3460     MOVE WS-BIN-CR-DT           TO CP-CERT-EFF-DT
  3461
  3462     MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
  3463
  3464     MOVE DTE-R78                TO CP-R78-OPTION
  3465     MOVE SPACES                 TO CP-ACCT-FLD-5
  3466     MOVE DTE-CLIENT             TO CP-COMPANY-ID
  3467     MOVE CR-AGE                 TO CP-ISSUE-AGE
  3468     MOVE CR-APR                 TO CP-LOAN-APR
  3469     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY
  3470     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM
  3471     MOVE CR-CARRIER             TO CP-CARRIER
  3472
  3473     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  3474        MOVE CR-RATING-CLASS     TO CP-CLASS-CODE
  3475     END-IF
  3476
  3477     MOVE STATE-SUB (CLAS-INDEXS)
  3478                                 TO CP-STATE
  3479     MOVE STATE-ABBR (CLAS-INDEXS)
  3480                                 TO CP-STATE-STD-ABBRV
  3481     MOVE DTE-CLASIC-COMPANY-CD  TO CP-COMPANY-CD
  3482     MOVE CR-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS
  3483
  3484     CALL 'ELUPRMX' USING CALCULATION-PASS-AREA
  3485
  3486     COMPUTE WS-LF-ST  (IYR VYR) =
  3487             WS-LF-ST  (IYR VYR) + CP-STATE-U-PRM
  3488
  3489     COMPUTE WS-LF-R78 (IYR VYR) =
  3490             WS-LF-R78 (IYR VYR) + CP-R78-U-PRM
  3491*            + CP-R78-U-PRM-ALT
  3492
  3493     COMPUTE WS-LF-PRO (IYR VYR) =
  3494             WS-LF-PRO (IYR VYR) + CP-PRORATA-U-PRM
  3495*            + CP-PRORATA-U-PRM-ALT
  3496
  3497     COMPUTE WS-LF-ST-EP (IYR VYR) =
  3498             WS-LF-ST-EP (IYR VYR) + (WS-CERT-PREV-ST
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* EL547E.cbl
  3499             - CP-STATE-U-PRM)
  3500
  3501     COMPUTE WS-LF-R78-EP (IYR VYR) =
  3502             WS-LF-R78-EP (IYR VYR) + (WS-CERT-PREV-R78
  3503             - CP-R78-U-PRM)
  3504
  3505     COMPUTE WS-LF-PRO-EP (IYR VYR) =
  3506             WS-LF-PRO-EP (IYR VYR) + (WS-CERT-PREV-PRO
  3507             - CP-PRORATA-U-PRM)
  3508
  3509     MOVE CP-STATE-U-PRM         TO WS-CERT-PREV-ST
  3510     COMPUTE WS-CERT-PREV-R78 = CP-R78-U-PRM
  3511
  3512     COMPUTE WS-CERT-PREV-PRO = CP-PRORATA-U-PRM
  3513
  3514*    IF (CR-DT > 19921231) AND
  3515*       (CR-DT < 19940101) AND
  3516*       (WS-BIN-VAL-DATES (VYR) = X'95FF')
  3517*       MOVE CR-DT TO WS-DISPLAY-DATE
  3518*       MOVE CR-LF-TERM TO WS-DISPLAY-TERM
  3519*       MOVE LF-REM-TRM2 TO WS-DISPLAY-RTERM
  3520*       MOVE CR-LFPRM TO WS-DISPLAY-PRM
  3521*       MOVE WS-REM-AMT   TO WS-DISPLAY-RAMT
  3522*       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
  3523*        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
  3524*        WS-DISPLAY-PRM '   ' WS-DISPLAY-RAMT
  3525*    END-IF
  3526
  3527     .
  3528
  3529 0230-EXIT.
  3530     EXIT.
  3531
  3532 0410-CALC-AH-UEP.
  3533
  3534*    DISPLAY ' MADE IT TO 0410 '
  3535     IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
  3536        CONTINUE
  3537     ELSE
  3538        PERFORM VARYING CLAS-INDEXA FROM CLAS-STARTA BY +1 UNTIL
  3539            (CLAS-INDEXA = CLAS-MAXA) OR
  3540            (CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA))
  3541        END-PERFORM
  3542        IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
  3543           CONTINUE
  3544        ELSE
  3545           DISPLAY ' AH  BENEFIT ' CR-AHTYP ' NOT IN TABLE'
  3546           DISPLAY 'RETURN CODE - 0402'
  3547           MOVE 0402 TO WS-RETURN-CODE
  3548           PERFORM ABEND-PGM
  3549        END-IF
  3550     END-IF
  3551
  3552     PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3553         (VYR > +600) OR
  3554         (WS-BIN-VAL-DATES (VYR) NOT < CP-CERT-EFF-DT)
  3555     END-PERFORM
  3556
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* EL547E.cbl
  3557     MOVE CR-AHPRM            TO WS-CERT-PREV-R78
  3558                                 WS-CERT-PREV-PRO
  3559                                 WS-CERT-PREV-ST
  3560
  3561     PERFORM VARYING VYR FROM VYR BY +1 UNTIL
  3562         (VYR > +600) OR
  3563         (WS-BIN-VAL-DATES (VYR) NOT < WS-BIN-AH-END-DATE)
  3564
  3565        PERFORM 0420-CALC-AH-REM-TERM THRU 0420-EXIT
  3566        PERFORM 0430-CALC-AH-UEP THRU 0430-EXIT
  3567
  3568     END-PERFORM
  3569
  3570     .
  3571
  3572 0410-EXIT.
  3573     EXIT.
  3574
  3575 0420-CALC-AH-REM-TERM.
  3576
  3577*    DISPLAY ' MADE IT TO 0420 '
  3578     MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
  3579
  3580     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  3581                                 TO CP-BENEFIT-TYPE
  3582     MOVE CLAS-I-BAL (CLAS-INDEXA)
  3583                                 TO CP-SPECIAL-CALC-CD
  3584     MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  3585                                    CP-LOAN-TERM
  3586
  3587     MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS
  3588
  3589     MOVE DTE-REM-TRM-CALC-OPTION
  3590                                 TO CP-REM-TRM-CALC-OPTION
  3591
  3592     PERFORM 0510-GET-REMAINING-TERM
  3593                                 THRU 0510-EXIT
  3594
  3595     IF CP-REMAINING-TERM-1 NEGATIVE
  3596         MOVE ZEROS              TO CP-REMAINING-TERM-1
  3597     END-IF
  3598
  3599     IF CP-REMAINING-TERM-2 NEGATIVE
  3600         MOVE ZEROS              TO CP-REMAINING-TERM-2
  3601     END-IF
  3602
  3603     MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
  3604     MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
  3605
  3606     .
  3607
  3608 0420-EXIT.
  3609     EXIT.
  3610
  3611 0430-CALC-AH-UEP.
  3612
  3613*    DISPLAY ' MADE IT TO 0430 '
  3614     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* EL547E.cbl
  3615     MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  3616     MOVE CR-AHAMT               TO CP-ORIGINAL-BENEFIT
  3617                                    CP-RATING-BENEFIT-AMT
  3618     MOVE AH-REM-TRM1            TO CP-REMAINING-TERM
  3619     MOVE CLAS-I-EP (CLAS-INDEXA)
  3620                                 TO CP-EARNING-METHOD
  3621     MOVE ZEROS                  TO CP-ALTERNATE-PREMIUM
  3622     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  3623                                 TO CP-BENEFIT-TYPE
  3624     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA)
  3625                                 TO CP-SPECIAL-CALC-CD
  3626     MOVE CR-AHTYP               TO CP-BENEFIT-CD
  3627     MOVE AH-OVERRIDE-L1         TO CP-AH-OVERRIDE-CODE
  3628
  3629     MOVE WS-BIN-CR-DT           TO CP-CERT-EFF-DT
  3630
  3631     MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
  3632
  3633     MOVE DTE-R78                TO CP-R78-OPTION
  3634     MOVE SPACES                 TO CP-ACCT-FLD-5
  3635     MOVE DTE-CLIENT             TO CP-COMPANY-ID
  3636     MOVE CR-AGE                 TO CP-ISSUE-AGE
  3637     MOVE CR-APR                 TO CP-LOAN-APR
  3638     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY
  3639     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM
  3640     MOVE CR-CARRIER             TO CP-CARRIER
  3641
  3642     MOVE STATE-SUB (CLAS-INDEXS)
  3643                                 TO CP-STATE
  3644     MOVE STATE-ABBR (CLAS-INDEXS)
  3645                                 TO CP-STATE-STD-ABBRV
  3646     MOVE DTE-CLASIC-COMPANY-CD  TO CP-COMPANY-CD
  3647
  3648     CALL 'ELUPRMX' USING CALCULATION-PASS-AREA
  3649
  3650     COMPUTE WS-AH-R78 (IYR VYR) =
  3651             WS-AH-R78 (IYR VYR) + CP-R78-U-PRM
  3652     COMPUTE WS-AH-PRO (IYR VYR) =
  3653             WS-AH-PRO (IYR VYR) + CP-PRORATA-U-PRM
  3654     COMPUTE WS-AH-ST  (IYR VYR) =
  3655             WS-AH-ST  (IYR VYR) + CP-STATE-U-PRM
  3656
  3657     COMPUTE WS-AH-R78-EP (IYR VYR) =
  3658             WS-AH-R78-EP (IYR VYR) + (WS-CERT-PREV-R78
  3659             - CP-R78-U-PRM)
  3660     COMPUTE WS-AH-PRO-EP (IYR VYR) =
  3661             WS-AH-PRO-EP (IYR VYR) + (WS-CERT-PREV-PRO
  3662             - CP-PRORATA-U-PRM)
  3663     COMPUTE WS-AH-ST-EP (IYR VYR) =
  3664             WS-AH-ST-EP (IYR VYR) + (WS-CERT-PREV-ST
  3665             - CP-STATE-U-PRM)
  3666
  3667     MOVE CP-R78-U-PRM           TO WS-CERT-PREV-R78
  3668     MOVE CP-PRORATA-U-PRM       TO WS-CERT-PREV-PRO
  3669     MOVE CP-STATE-U-PRM         TO WS-CERT-PREV-ST
  3670
  3671*    IF CR-STATE = 'CA' OR 'OR' OR 'WA'
  3672*       COMPUTE WS-AH-ST (IYR VYR) =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* EL547E.cbl
  3673*            WS-AH-ST (IYR VYR) + CP-PRORATA-U-PRM
  3674*    ELSE
  3675*       IF (CR-STATE = 'OH' OR 'TX')
  3676*                   OR
  3677*          ((CR-STATE = 'CO') AND
  3678*          (CR-DT > + 19961231))
  3679*          COMPUTE WS-AH-ST (IYR VYR) =
  3680*            WS-AH-ST (IYR VYR) + ((CP-PRORATA-U-PRM +
  3681*              CP-R78-U-PRM) * .5)
  3682*       ELSE
  3683*          COMPUTE WS-AH-ST (IYR VYR) =
  3684*            WS-AH-ST  (IYR VYR) + CP-R78-U-PRM
  3685*       END-IF
  3686*    END-IF
  3687
  3688*    IF (CR-DT > 19971231) AND
  3689*       (CR-DT < 19990101) AND
  3690*       (WS-BIN-VAL-DATES (VYR) = X'947F')
  3691*       MOVE CR-DT TO WS-DISPLAY-DATE
  3692*       MOVE CR-AH-TERM TO WS-DISPLAY-TERM
  3693*       MOVE AH-REM-TRM1 TO WS-DISPLAY-RTERM
  3694*       MOVE CR-AHPRM TO WS-DISPLAY-PRM
  3695*       MOVE CP-R78-U-PRM TO WS-DISPLAY-UEP
  3696*       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
  3697*        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
  3698*        WS-DISPLAY-PRM '   ' WS-DISPLAY-UEP
  3699*    END-IF
  3700
  3701     .
  3702
  3703 0430-EXIT.
  3704     EXIT.
  3705
  3706 0500-EMPTY-TABLE.
  3707
  3708     WRITE EXTRACT-RECORD-OUT-HD FROM WS-HEAD-RECORD
  3709     MOVE WS-INIT-EXT-RECORD     TO WS-EXTRACT-RECORD
  3710     DISPLAY ' MADE IT TO 0500 '
  3711     PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  3712             IYR > +600
  3713         PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3714                VYR > +600
  3715             MOVE WS-ISSUE-CCYYMM (IYR)
  3716                                 TO EXT-ISSUE-CCYYMM
  3717             MOVE WS-VALUATION-CCYYMM (IYR VYR)
  3718                                 TO EXT-VALUE-CCYYMM
  3719             MOVE WS-LF-INFORCE (IYR VYR)
  3720                                 TO EXT-LF-INFORCE
  3721             MOVE WS-LF-WRITTEN (IYR VYR)
  3722                                 TO EXT-LF-WRITTEN
  3723             MOVE WS-AH-WRITTEN (IYR VYR)
  3724                                 TO EXT-AH-WRITTEN
  3725             MOVE WS-LF-REFUNDS (IYR VYR)
  3726                                 TO EXT-LF-REFUNDS
  3727             MOVE WS-AH-REFUNDS (IYR VYR)
  3728                                 TO EXT-AH-REFUNDS
  3729             MOVE WS-LF-R78     (IYR VYR)
  3730                                 TO EXT-LF-R78
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* EL547E.cbl
  3731             MOVE WS-LF-PRO     (IYR VYR)
  3732                                 TO EXT-LF-PRO
  3733             MOVE WS-LF-ST      (IYR VYR)
  3734                                 TO EXT-LF-ST
  3735             MOVE WS-LF-R78-EP  (IYR VYR)
  3736                                 TO EXT-LF-R78-EP
  3737             MOVE WS-LF-PRO-EP  (IYR VYR)
  3738                                 TO EXT-LF-PRO-EP
  3739             MOVE WS-LF-ST-EP   (IYR VYR)
  3740                                 TO EXT-LF-ST-EP
  3741             MOVE WS-AH-R78     (IYR VYR)
  3742                                 TO EXT-AH-R78
  3743             MOVE WS-AH-PRO     (IYR VYR)
  3744                                 TO EXT-AH-PRO
  3745             MOVE WS-AH-ST      (IYR VYR)
  3746                                 TO EXT-AH-ST
  3747             MOVE WS-AH-R78-EP  (IYR VYR)
  3748                                 TO EXT-AH-R78-EP
  3749             MOVE WS-AH-PRO-EP  (IYR VYR)
  3750                                 TO EXT-AH-PRO-EP
  3751             MOVE WS-AH-ST-EP   (IYR VYR)
  3752                                 TO EXT-AH-ST-EP
  3753             MOVE WS-LF-CLAIM   (IYR VYR)
  3754                                 TO EXT-LF-CLAIM
  3755             MOVE WS-AH-CLAIM   (IYR VYR)
  3756                                 TO EXT-AH-CLAIM
  3757             IF (EXT-ISSUE-CCYYMM > EXT-VALUE-CCYYMM) OR
  3758                (ZERO = WS-LF-INFORCE (IYR VYR) AND
  3759                        WS-LF-ST      (IYR VYR) AND
  3760                        WS-AH-ST      (IYR VYR) AND
  3761                        WS-LF-CLAIM   (IYR VYR) AND
  3762                        WS-AH-CLAIM   (IYR VYR) AND
  3763                        WS-LF-REFUNDS (IYR VYR) AND
  3764                        WS-AH-REFUNDS (IYR VYR))
  3765                CONTINUE
  3766             ELSE
  3767                WRITE EXTRACT-RECORD-OUT
  3768                                 FROM WS-EXTRACT-RECORD
  3769             END-IF
  3770         END-PERFORM
  3771     END-PERFORM
  3772
  3773     .
  3774
  3775 0500-EXIT.
  3776     EXIT.
  3777
  3778 0510-GET-REMAINING-TERM.
  3779
  3780*    DISPLAY ' MADE IT TO 0510 '
  3781     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA
  3782
  3783     .
  3784
  3785 0510-EXIT.
  3786     EXIT.
  3787
  3788
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* EL547E.cbl
  3789 2000-CALC-REM-AMT.
  3790
  3791*    DISPLAY ' MADE IT TO 2000 '
  3792     IF CR-LFTYP = 'QD'
  3793        MOVE +15.0               TO CR-APR
  3794     END-IF
  3795
  3796     MOVE +0                     TO WS-REM-AMT
  3797     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  3798        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3799           COMPUTE WS-REM-AMT =
  3800             CR-LFAMT + CR-LFAMT-ALT
  3801        ELSE
  3802           MOVE CR-LFAMT         TO WS-REM-AMT
  3803        END-IF
  3804        GO TO 2900-DISPLAY-AMTS
  3805     END-IF
  3806
  3807     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
  3808
  3809     IF LF-REM-TRM2 = CR-LF-TERM
  3810        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3811           COMPUTE WS-REM-AMT =
  3812             CR-LFAMT + CR-LFAMT-ALT
  3813        ELSE
  3814           MOVE CR-LFAMT         TO WS-REM-AMT
  3815        END-IF
  3816        GO TO 2900-DISPLAY-AMTS
  3817     END-IF
  3818
  3819     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3820        GO TO 2010-ORDINARY-REM
  3821     END-IF
  3822
  3823     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  3824        GO TO 2020-CALC-TEXAS-REM
  3825     END-IF
  3826
  3827     IF CR-LFTYP = 'QD'
  3828        MOVE +15.0               TO CR-APR
  3829        MOVE 'N'                 TO
  3830                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
  3831        GO TO 2030-CALC-NET-PAY-REM
  3832     END-IF
  3833
  3834     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  3835        GO TO 2030-CALC-NET-PAY-REM
  3836     END-IF
  3837
  3838     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  3839        (CR-RATING-CLASS NOT = 'L ')
  3840         IF (CR-LF-TERM GREATER THAN +60) AND
  3841            (CR-DT GREATER THAN 19831031) AND
  3842            (CR-APR GREATER THAN ZERO)
  3843             GO TO 2030-CALC-NET-PAY-REM
  3844        END-IF
  3845     END-IF
  3846
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* EL547E.cbl
  3847     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  3848         IF (CR-LF-TERM GREATER THAN +61) AND
  3849            (CR-DT  GREATER THAN 19830318) AND
  3850            (CR-APR GREATER THAN ZERO)
  3851             GO TO 2030-CALC-NET-PAY-REM
  3852        END-IF
  3853     END-IF
  3854
  3855     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  3856         IF (CR-LF-TERM GREATER THAN +62) AND
  3857            (CR-DT  GREATER THAN 19810831) AND
  3858            (CR-DT  LESS THAN 19830901) AND
  3859            (CR-APR GREATER THAN ZERO)
  3860             GO TO 2030-CALC-NET-PAY-REM
  3861        END-IF
  3862     END-IF
  3863
  3864     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  3865         IF (CR-LF-TERM GREATER THAN +60) AND
  3866            (CR-DT  GREATER THAN 19831231) AND
  3867            (CR-APR GREATER THAN ZERO)
  3868             GO TO 2030-CALC-NET-PAY-REM
  3869        END-IF
  3870     END-IF
  3871
  3872     .
  3873 2010-ORDINARY-REM.
  3874
  3875*    DISPLAY ' MADE IT TO 2010 '
  3876     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3877         COMPUTE WS-REM-AMT ROUNDED =
  3878                  (INTERMED * LF-REM-TRM2) + CR-LFAMT-ALT
  3879     ELSE
  3880         COMPUTE WS-REM-AMT ROUNDED = INTERMED * LF-REM-TRM2
  3881     END-IF
  3882
  3883     GO TO 2900-DISPLAY-AMTS
  3884
  3885     .
  3886 2020-CALC-TEXAS-REM.
  3887
  3888*    DISPLAY ' MADE IT TO 2020 '
  3889
  3890     IF (CR-LF-TERM = ZEROS)
  3891        OR (CR-PMT-FREQ = ZEROS)
  3892        DISPLAY ' ZEROS KEY = ' CR-FULL-CONTROL
  3893        '  PMT FREQ = ' CR-PMT-FREQ
  3894        '  LF TERM  = ' CR-LF-TERM
  3895        MOVE ZEROS               TO WS-REM-AMT
  3896        GO TO 2900-DISPLAY-AMTS
  3897     END-IF
  3898
  3899     IF (CR-LF-TERM NOT = ZEROS)
  3900        AND (CR-PMT-FREQ) NOT = ZEROS
  3901     DIVIDE CR-LFAMT BY CR-LF-TERM
  3902         GIVING TEX-FACT-1.
  3903     DIVIDE LF-REM-TRM2 BY CR-PMT-FREQ
  3904         GIVING TEX-FACT-2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* EL547E.cbl
  3905         REMAINDER TEX-FACT-3.
  3906
  3907     IF TEX-FACT-3 NOT = ZERO
  3908         ADD +1                  TO TEX-FACT-2
  3909     END-IF
  3910
  3911     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
  3912         MOVE CR-LFAMT           TO WS-REM-AMT
  3913     ELSE
  3914         COMPUTE WS-REM-AMT ROUNDED =
  3915             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
  3916     END-IF
  3917
  3918     GO TO 2900-DISPLAY-AMTS
  3919
  3920     .
  3921 2030-CALC-NET-PAY-REM.
  3922
  3923*    DISPLAY ' MADE IT TO 2030 '
  3924     MOVE WS-BIN-CR-DT           TO  CP-CERT-EFF-DT
  3925
  3926     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
  3927        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
  3928        MOVE '3'                 TO  DC-OPTION-CODE
  3929        PERFORM 8510-DATE-CONVERSION
  3930                                 THRU 8590-EXIT
  3931        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
  3932     ELSE
  3933        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
  3934        MOVE +1                  TO  DC-ELAPSED-MONTHS
  3935        MOVE +0                  TO  DC-ELAPSED-DAYS
  3936        MOVE '6'                 TO  DC-OPTION-CODE
  3937        PERFORM 8510-DATE-CONVERSION
  3938                                 THRU 8590-EXIT
  3939        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
  3940     END-IF
  3941
  3942     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3943        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
  3944     ELSE
  3945        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
  3946     END-IF
  3947     MOVE CR-APR                 TO  CP-LOAN-APR
  3948     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
  3949     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
  3950     MOVE LF-REM-TRM2            TO  CP-REMAINING-TERM
  3951     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
  3952                                 TO CP-SPECIAL-CALC-CD
  3953     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  3954                                 TO  CP-BENEFIT-TYPE
  3955     MOVE CLAS-I-EP (CLAS-INDEXL)
  3956                                 TO  CP-EARNING-METHOD
  3957
  3958     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
  3959
  3960     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
  3961
  3962     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* EL547E.cbl
  3963 2900-DISPLAY-AMTS.
  3964
  3965*    DISPLAY ' MADE IT TO 2900 '
  3966*    IF (CR-DT > 19921231) AND
  3967*       (CR-DT < 19940101) AND
  3968*    IF (WS-BIN-VAL-DATES (VYR) = X'95FF')
  3969*       MOVE CR-DT TO WS-DISPLAY-DATE
  3970*       MOVE CR-LF-TERM TO WS-DISPLAY-TERM
  3971*       MOVE LF-REM-TRM2 TO WS-DISPLAY-RTERM
  3972*       MOVE CR-LFPRM TO WS-DISPLAY-PRM
  3973*       IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L'
  3974*          ADD CR-LFAMT CR-LFAMT-ALT GIVING WS-DISPLAY-AMT
  3975*       ELSE
  3976*          MOVE CR-LFAMT     TO WS-DISPLAY-AMT
  3977*       END-IF
  3978*       MOVE WS-REM-AMT   TO WS-DISPLAY-RAMT
  3979*       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
  3980*        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
  3981*        WS-DISPLAY-AMT '   ' WS-DISPLAY-RAMT
  3982*    END-IF
  3983
  3984     .
  3985 2999-CALC-REM-AMT-X.
  3986     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* EL547E.cbl
  3988 8510-DATE-CONVERSION.
  3989
  3990*    DISPLAY ' MADE IT TO 8510 '
  3991     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  3992
  3993     .
  3994
  3995 8590-EXIT.
  3996     EXIT.
  3997
  3998
  3999
  4000
  4001 ABEND-PGM.
* 4002                                 COPY ELCABEND.
  4003***************************************************************** 04/14/98
  4004*                                                               * ELCABEND
  4005*                            ELCABEND.                          *    LV003
  4006*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4007*                            VMOD 2.002                              CL**2
  4008*                                                               * ELCABEND
  4009*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  4010*            AND THEN ABENDS.                                   * ELCABEND
  4011*                                                               * ELCABEND
  4012*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  4013*                                                               * ELCABEND
  4014***************************************************************** ELCABEND
  4015*APS-010.                                                         ELCABEND
  4016     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  4017     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  4018                                                                  ELCABEND
  4019     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  4020         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  4021         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  4022                                 UPON CONSOLE.                    ELCABEND
  4023                                                                  ELCABEND
  4024     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  4025         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  4026         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  4027                                 UPON CONSOLE.                    ELCABEND
  4028                                                                  ELCABEND
  4029     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  4030     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  4031                                 UPON CONSOLE.                    ELCABEND
  4032                                                                  ELCABEND
  4033     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  4034     CALL 'ABORTME'.
  4035                                                                  ELCABEND
  4036 APS-EXIT.                                                        ELCABEND
  4037     EXIT.                                                        ELCABEND
  4038
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:    43978152     Code:       11903
