* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* ELRTRMX.cbl
* Options: int("ELRTRMX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ELRTRMX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRTRMX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRTRMX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         04/18/98
     2                                                                  ELRTRMX
     3 PROGRAM-ID.                 ELRTRMX.                                LV016
     4*              PROGRAM CONVERTED BY                                  CL**7
     5*              COBOL CONVERSION AID PO 5785-ABJ                      CL**7
     6*              CONVERSION DATE 12/20/95 07:27:00.                    CL**7
     7*                            VMOD=2.009                              CL*13
     8*                                                                 ELRTRMX
     9*AUTHOR.       LOGIC, INC.                                           CL**7
    10*              DALLAS, TEXAS.                                        CL**7
    11                                                                  ELRTRMX
    12*DATE-COMPILED.                                                      CL**7
    13                                                                  ELRTRMX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* ELRTRMX.cbl
    14*SECURITY.   *****************************************************   CL**7
    15*            *                                                   *   CL**7
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *   CL**7
    17*            *                                                   *   CL**7
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *   CL**7
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *   CL**7
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *   CL**7
    21*            *                                                   *   CL**7
    22*            *****************************************************   CL**7
    23                                                                  ELRTRMX
    24*REMARKS.    *****************************************************   CL**7
    25*            *                                                   *   CL**7
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *   CL**7
    27*            *    OPTION SPECIFIED, COMPUTE REMAINING TERMS      *   CL**7
    28*            *    FOR A CERTIFICATE.                             *   CL**7
    29*            *                                                   *   CL**7
    30*            *    START DATE = CP-CERT-EFF-DATE                  *   CL**7
    31*            *    END-DATE   = VALUATION-DATE                    *   CL**7
    32*            *    METHOD     = CP-REM-TERM-METHOD                *   CL**7
    33*            *    IF COMPANY SPECIAL METHOD METHOD - PUT COMPANY *   CL**7
    34*            *    I.D. IN CP-COMPANY-ID.                         *   CL**7
    35*            *                                                   *   CL**7
    36*            *****************************************************   CL**7
    37 ENVIRONMENT DIVISION.                                            ELRTRMX
    38                                                                  ELRTRMX
    39 DATA DIVISION.                                                   ELRTRMX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* ELRTRMX.cbl
    41 WORKING-STORAGE SECTION.                                         ELRTRMX
    42 77  FILLER   PIC X(32) VALUE '********************************'. ELRTRMX
    43 77  FILLER   PIC X(32) VALUE '**  ELRTRMX WORKING STORAGE   **'. ELRTRMX
    44 77  FILLER   PIC X(32) VALUE '******** VMOD=2.009 ************'.    CL*13
    45                                                                  ELRTRMX
    46*01  RT-BGN-DATE.                                                    CL*11
    47*    12  RT-BGN-YR          PIC 99.                                  CL*11
    48*    12  RT-BGN-MO          PIC 99.                                  CL*11
    49*    12  RT-BGN-DA          PIC 99.                                  CL*11
    50                                                                  ELRTRMX
    51*01  RT-END-DATE.                                                    CL*11
    52*    12  RT-END-YR          PIC 99.                                  CL*11
    53*    12  RT-END-MO          PIC 99.                                  CL*11
    54*    12  RT-END-DA          PIC 99.                                  CL*11
    55                                                                  ELRTRMX
    56*01  RT-SAVE-DATE           PIC XX.                                  CL*11
    57                                                                  ELRTRMX
    58 01  MISC-CALCULATION-AREAS.                                         CL**3
    59     03  MONTHS-EARNED          PIC 9             VALUE ZERO.        CL**3
    60     03  MONTHS-EARNED-1        PIC 9             VALUE ZERO.        CL**3
    61     03  MONTHS-EARNED-2        PIC 9             VALUE ZERO.        CL**3
    62     03  TERM-IN-MONTHS         PIC S9(3)         VALUE ZERO.        CL**3
    63                                                                     CL**3
    64     03  WS-TOP-NUMBER          PIC 9(8).                            CL*13
    65     03  WS-TOP-NUMBER-R  REDEFINES  WS-TOP-NUMBER.                  CL*11
    66         05  WS-TOP-CCYR        PIC 9(4).                            CL*11
    67         05  WS-TOP-MO          PIC 99.                              CL*11
    68         05  WS-TOP-DA          PIC 99.                              CL*11
    69                                                                     CL*11
    70     03  WS-BOTTOM-NUMBER       PIC 9(8).                            CL*13
    71     03  WS-BOTTOM-NUMBER-R  REDEFINES  WS-BOTTOM-NUMBER.            CL*11
    72         05  WS-BOTTOM-CCYR     PIC 9(4).                            CL*11
    73         05  WS-BOTTOM-MO       PIC 99.                              CL*11
    74         05  WS-BOTTOM-DA       PIC 99.                              CL*11
    75                                                                     CL*11
    76     03  WS-RESULT-NUMBER.                                           CL*14
    77         05  WS-RESULT-CCYR     PIC S9(4).                           CL*14
    78         05  WS-RESULT-MO       PIC S99.                             CL*14
    79         05  WS-RESULT-DA       PIC S99.                             CL*14
    80                                                                     CL**3
    81     03  WS-SAVE-EFFECTIVE-DATE PIC 9(8).                            CL*13
    82     03  WS-SAVE-EFF-DATE-R  REDEFINES  WS-SAVE-EFFECTIVE-DATE.      CL*11
    83         05  FILLER             PIC 9(6).                            CL*13
    84         05  SAVE-EFF-DAYS      PIC 99.                              CL*11
    85                                                                     CL**3
    86     03  WS-SAVE-PAYMENT-DATE   PIC 9(8).                            CL*13
    87     03  WS-SAVE-PAY-DATE-R  REDEFINES  WS-SAVE-PAYMENT-DATE.        CL*11
    88         05  FILLER             PIC 9(4).                            CL*13
    89         05  SAVE-PAY-MO        PIC 99.                              CL*11
    90         05  SAVE-PAY-DAYS      PIC 99.                              CL*11
    91                                                                     CL**3
    92     03  WS-SAVE-VALUATION-DATE PIC 9(8).                            CL*13
    93     03  WS-SAVE-VAL-DATE-R  REDEFINES  WS-SAVE-VALUATION-DATE.      CL*11
    94         05  FILLER             PIC 9(6).                            CL*13
    95         05  SAVE-VAL-DAYS      PIC 99.                              CL*11
    96                                                                     CL**3
    97     03  WS-SAVE-EXPIRATION-DATE PIC 9(8).                           CL*13
    98     03  WS-SAVE-EXP-DATE-R  REDEFINES  WS-SAVE-EXPIRATION-DATE.     CL*11
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* ELRTRMX.cbl
    99         05  FILLER             PIC 9(6).                            CL*13
   100         05  SAVE-EXP-DAYS      PIC 99.                              CL*11
   101                                                                     CL**3
   102     03  WS-SAVE-BINARY-DATE    PIC XX.                              CL**3
   103                                                                     CL**3
   104*    03  WS-SAVE-MONTH-END-DATE PIC 9(8).                            CL*13
   105*    03  WS-SAVE-MTH-END-DT-R REDEFINES WS-SAVE-MONTH-END-DATE.      CL*13
   106*        05  FILLER             PIC 9(6).                            CL*13
   107*        05  WS-DAYS-IN-THIS-MO PIC 99.                              CL*13
   108                                                                     CL**3
   109 01  MISC-SWITCHES.                                                  CL**3
   110     03  PAYMENT-EOM        PIC X.                                   CL**3
   111         88 PAYMENT-DATE-EOM    VALUE 'Y'.                           CL**3
   112     03  EFFECTIVE-EOM      PIC X.                                   CL**3
   113         88 EFFECTIVE-DATE-EOM  VALUE 'Y'.                           CL**3
   114     03  VALUATION-EOM      PIC X.                                   CL**3
   115         88 VALUATION-DATE-EOM  VALUE 'Y'.                           CL**3
   116     03  TOP-EOM            PIC X.                                   CL**3
   117         88 TOP-NUMBER-EOM      VALUE 'Y'.                           CL**3
   118     03  BOTTOM-EOM         PIC X.                                   CL**3
   119         88 BOTTOM-NUMBER-EOM   VALUE 'Y'.                           CL**3
   120     03  EXPIRATION-EOM     PIC X.                                   CL**8
   121         88 EXPIRATION-DATE-EOM VALUE 'Y'.                           CL**8
   122                                                                     CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* ELRTRMX.cbl
*  124     COPY ELCDATE.                                                   CL*16
   125******************************************************************06/11/98
   126*                                                                *ELCDATE
   127*                                                                *ELCDATE
   128*                            ELCDATE.                            *   LV023
   129*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   130*                            VMOD=2.003                           ELCDATE
   131*                                                                *ELCDATE
   132*                                                                *ELCDATE
   133*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   134*                 LENGTH = 200                                   *   CL*19
   135******************************************************************ELCDATE
   136                                                                  ELCDATE
   137 01  DATE-CONVERSION-DATA.                                        ELCDATE
   138     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   139     12  DC-OPTION-CODE                PIC X.                        CL*15
   140         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   141         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   142         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   143         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   144         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   145         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   146         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   147         88  FIND-CENTURY               VALUE '7'.                   CL*22
   148         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   149         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   150         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   151         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   152         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   153         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   154         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   155         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   156         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   157         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   158         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   159         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   160         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   161         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   162         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   163         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   164         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   165         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   166         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   167         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   168         88  THREE-CHARACTER-BIN                                  ELCDATE
   169                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   170         88  GREGORIAN-TO-BIN                                        CL**2
   171                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   172         88  BIN-TO-GREGORIAN                                        CL**2
   173                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   174         88  JULIAN-TO-BINARY                                        CL**2
   175                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   176     12  DC-ERROR-CODE                 PIC X.                        CL*15
   177         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   178         88  DATE-CONVERSION-ERROR                                ELCDATE
   179                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   180         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   181         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   182         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   183         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   184         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   185         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   186         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   187         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   188         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   189         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   190     12  DC-END-OF-MONTH               PIC X.                        CL*15
   191         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   192     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   193         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   194         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   195         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   196     12  FILLER                        PIC X.                        CL*15
   197     12  DC-CONVERSION-DATES.                                        CL*15
   198         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   199         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   200         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   201         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   202                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   203             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   204             20  SLASH1-1              PIC X.                        CL*15
   205             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   206             20  SLASH1-2              PIC X.                        CL*15
   207             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   208         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   209         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   210                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   211             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   212             20  SLASH2-1              PIC X.                        CL*15
   213             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   214             20  SLASH2-2              PIC X.                        CL*15
   215             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   216         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   217         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   218                     DC-GREG-DATE-1-YMD.                          ELCDATE
   219             20  DC-YMD-YEAR           PIC 99.                       CL*15
   220             20  DC-YMD-MONTH          PIC 99.                       CL*15
   221             20  DC-YMD-DAY            PIC 99.                       CL*15
   222         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   223         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   224                      DC-GREG-DATE-1-MDY.                         ELCDATE
   225             20  DC-MDY-MONTH          PIC 99.                       CL*15
   226             20  DC-MDY-DAY            PIC 99.                       CL*15
   227             20  DC-MDY-YEAR           PIC 99.                       CL*15
   228         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   229             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   230             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   231             20  FILLER                PIC XX.                       CL*15
   232             20  DC-ALPHA-CENTURY.                                   CL*15
   233                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   234             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   235         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   236         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   237         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   238         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   239         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   240                                       PIC 9(05).                    CL*20
   241         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   242             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   243             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   244         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   245         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   246         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   247     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   248         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   249         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   250             20  FILLER                PIC 9(3).                     CL*15
   251             20  HOLD-CEN-1-CCYY.                                    CL*15
   252                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   253                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   254             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   255             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   256         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   257             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   258             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   259             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   260                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   261                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   262             20  FILLER                PIC 9(3).                     CL*15
   263         16  HOLD-CENTURY-1-X.                                       CL*15
   264             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   265             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   266                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   267                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   268             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   269             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   270         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   271             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   272             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   273             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   274                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   275                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   276             20  FILLER                PIC XXX.                      CL*23
   277         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   278         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   279         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   280         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   281             20  DC-JULIAN-1-CCYY.                                   CL*15
   282                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   283                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   284             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   285         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   286         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   287             20  DC-JULIAN-2-CCYY.                                   CL*15
   288                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   289                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   290             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   291         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   292             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   293             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   294             20  DC-EDITA-DAY          PIC 99.                       CL*15
   295             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   296             20  DC-EDITA-CCYY.                                      CL*15
   297                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   298                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   299         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   300             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   301             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   302             20  DC-EDITB-DAY          PIC 99.                       CL*15
   303             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   304             20  DC-EDITB-CCYY.                                      CL*15
   305                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   306                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   307         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   308         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   309                              DC-GREG-DATE-CYMD.                  ELCDATE
   310             20  DC-CYMD-CEN           PIC 99.                       CL*15
   311             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   312             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   313             20  DC-CYMD-DAY           PIC 99.                       CL*15
   314         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   315         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   316                              DC-GREG-DATE-MDCY.                  ELCDATE
   317             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   318             20  DC-MDCY-DAY           PIC 99.                       CL*15
   319             20  DC-MDCY-CEN           PIC 99.                       CL*15
   320             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   321    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   322        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   323    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   324    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* ELRTRMX.cbl
   326 LINKAGE SECTION.                                                 ELRTRMX
*  327     COPY ELCCALC.                                                   CL**4
   328******************************************************************04/15/98
   329*                                                                *ELCCALC
   330*                           ELCCALC.                            *    LV003
   331*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   332*                            VMOD=2.025                          *   CL**3
   333*                                                                *   CL**2
   334*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   335*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   336*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   337*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   338*                                                                *   CL**2
   339*  PASSED TO ELRTRM                                              *   CL**2
   340*  -----------------                                             *   CL**2
   341*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   342*  ORIGINAL TERM                                                 *   CL**2
   343*  BEGINNING DATE                                                *   CL**2
   344*  ENDING DATE                                                   *   CL**2
   345*  COMPANY I.D.                                                  *   CL**2
   346*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   347*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   348*  FREE LOOK DAYS                                                *   CL**2
   349*                                                                *   CL**2
   350*  RETURNED FROM ELRTRM                                          *   CL**2
   351*  ---------------------                                         *   CL**2
   352*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   353*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   354*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   355*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   356*----------------------------------------------------------------*   CL**2
   357*  PASSED TO ELRAMT                                              *   CL**2
   358*  ----------------                                              *   CL**2
   359*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   360*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   361*  ORIGINAL AMOUNT                                               *   CL**2
   362*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   363*  A.P.R. - NET PAY ONLY                                         *   CL**2
   364*  METHOD                                                            CL**2
   365*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   366*  COMPANY I.D.                                                  *   CL**2
   367*  BENEFIT TYPE                                                  *   CL**2
   368*                                                                *   CL**2
   369*  RETURNED FROM ELRAMT                                          *   CL**2
   370*  --------------------                                          *   CL**2
   371*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   372*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   373*  REMAINING AMOUNT FACTOR                                           CL**2
   374*----------------------------------------------------------------*   CL**2
   375*  PASSED TO ELRESV                                              *   CL**2
   376*  -----------------                                             *   CL**2
   377*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   378*  VALUATION DATE                                                *   CL**2
   379*  PAID THRU DATE                                                *   CL**2
   380*  BENEFIT                                                       *   CL**2
   381*  INCURRED DATE                                                 *   CL**2
   382*  REPORTED DATE                                                 *   CL**2
   383*  ISSUE AGE                                                     *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   384*  TERM                                                          *   CL**2
   385*  CDT PERCENT                                                   *   CL**2
   386*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   387* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   388* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   389* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   390*                                                                *   CL**2
   391*  RETURNED FROM ELRESV                                          *   CL**2
   392*  --------------------                                          *   CL**2
   393*  CDT TABLE USED                                                *   CL**2
   394*  CDT FACTOR USED                                               *   CL**2
   395*  PAY TO CURRENT RESERVE                                        *   CL**2
   396*  I.B.N.R. - A/H ONLY                                           *   CL**2
   397*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   398*----------------------------------------------------------------*   CL**2
   399*  PASSED TO ELRATE                                              *   CL**2
   400*  ----------------                                              *   CL**2
   401*  CERT ISSUE DATE                                               *   CL**2
   402*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   403*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   404*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   405*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   406*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   407*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   408*  DEVIATION CODE                                                *   CL**2
   409*  ISSUE AGE                                                     *   CL**2
   410*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   411*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   412*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   413*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   414*  A.P.R.                                                        *   CL**2
   415*  METHOD                                                            CL**2
   416*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   417*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   418*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   419*  BENEFIT CODE                                                  *   CL**2
   420*  BENEFIT OVERRIDE CODE                                         *   CL**2
   421*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   422*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   423*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   424*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   425*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   426*                                                                *   CL**2
   427*  RETURNED FROM ELRATE                                          *   CL**2
   428*  --------------------                                          *   CL**2
   429*  CALCULATED PREMIUM                                            *   CL**2
   430*  PREMIUM RATE                                                  *   CL**2
   431*  MORTALITY CODE                                                *   CL**2
   432*  MAX ATTAINED AGE                                              *   CL**2
   433*  MAX AGE                                                       *   CL**2
   434*  MAX TERM                                                      *   CL**2
   435*  MAX MONTHLY BENEFIT                                           *   CL**2
   436*  MAX TOTAL BENIFIT                                             *   CL**2
   437*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   438*----------------------------------------------------------------*   CL**2
   439*  PASSED TO ELRFND                                              *   CL**2
   440*  ----------------                                              *   CL**2
   441*  CERT ISSUE DATE                                               *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   442*  REFUND DATE                                                   *   CL**2
   443*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   444*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   445*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   446*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   447*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   448*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   449*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   450*  DEVIATION CODE                                                *   CL**2
   451*  ISSUE AGE                                                     *   CL**2
   452*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   453*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   454*  PROCESS TYPE (CANCEL)                                         *   CL**2
   455*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   456*  A.P.R.                                                        *   CL**2
   457*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   458*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   459*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   460*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   461*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   462*  BENEFIT CODE                                                  *   CL**2
   463*  BENEFIT OVERRIDE CODE                                         *   CL**2
   464*                                                                *   CL**2
   465*  RETURNED FROM ELRFND                                          *   CL**2
   466*  --------------------                                          *   CL**2
   467*  CALCULATED REFUND                                             *   CL**2
   468*----------------------------------------------------------------*   CL**2
   469*  PASSED TO ELEARN                                              *   CL**2
   470*  ----------------                                              *   CL**2
   471*  CERT ISSUE DATE                                               *   CL**2
   472*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   473*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   474*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   475*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   476*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   477*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   478*  DEVIATION CODE                                                *   CL**2
   479*  ISSUE AGE                                                     *   CL**2
   480*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   481*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   482*  A.P.R.                                                        *   CL**2
   483*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
   484*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   485*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   486*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   487*  BENEFIT CODE                                                  *   CL**2
   488*  BENEFIT OVERRIDE CODE                                         *   CL**2
   489*                                                                *   CL**2
   490*  RETURNED FROM ELEARN                                          *   CL**2
   491*  --------------------                                          *   CL**2
   492*  INDICATED  EARNINGS                                           *   CL**2
   493*----------------------------------------------------------------*   CL**2
   494*                 LENGTH = 450                                   *   CL**2
   495*                                                                *   CL**2
   496******************************************************************   CL**2
   497******************************************************************
   498*                   C H A N G E   L O G
   499*
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   500* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   501*-----------------------------------------------------------------
   502*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   503* EFFECTIVE    NUMBER
   504*-----------------------------------------------------------------
   505* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   506* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   507* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   508* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   509* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   510* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   511* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   512* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   513* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   514* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   515******************************************************************
   516                                                                     CL**2
   517 01  CALCULATION-PASS-AREA.                                          CL**2
   518     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
   519                                     COMP.                           CL**2
   520                                                                     CL**2
   521     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
   522       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
   523       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
   524                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
   525       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
   526       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
   527       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
   528       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
   529       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
   530       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
   531       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
   532       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
   533       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
   534       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
   535       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
   536       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
   537       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
   538       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
   539       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
   540       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
   541       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
   542                                                                     CL**2
   543     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
   544       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
   545***********************  INPUT AREAS ****************************    CL**2
   546                                                                     CL**2
   547     12  CP-CALCULATION-AREA.                                        CL**2
   548         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
   549         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
   550         16  CP-VALUATION-DT       PIC XX.                           CL**2
   551         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
   552         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
   553           88  CP-AH                               VALUE 'A' 'D'     CL**2
   554                                                   'I' 'U'.          CL**2
   555           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
   556           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
   557         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   558         16  CP-REPORTED-DT        PIC XX.                           CL**2
   559         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
   560         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
   561         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
   562                                     COMP-3.                         CL**2
   563         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
   564                                     COMP-3.                         CL**2
   565         16  CP-CDT-METHOD         PIC X.                            CL**2
   566           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
   567           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
   568           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
   569         16  CP-CLAIM-TYPE         PIC X.                            CL**2
   570           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
   571           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
   572         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
   573                                     COMP-3.                         CL**2
   574         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
   575                                     COMP-3.                         CL**2
   576         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
   577                                     COMP-3.                         CL**2
   578         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
   579                                     COMP-3.                         CL**2
   580         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   581                                     COMP-3.                         CL**2
   582         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
   583                                     COMP-3.                         CL**2
   584         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
   585                                     COMP-3.                         CL**2
   586         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
   587           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
   588           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
   589           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
   590           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
   591           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
   592           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
   593           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
   594         16  CP-EARNING-METHOD     PIC X.                            CL**2
   595           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
   596           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
   597           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
   598           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   599           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   600           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   601           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
   602           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
   603           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
   604           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
   605           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   606           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   607           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   608           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   609         16  CP-PROCESS-TYPE       PIC X.                            CL**2
   610           88  CP-CLAIM                            VALUE '1'.        CL**2
   611           88  CP-CANCEL                           VALUE '2'.        CL**2
   612           88  CP-ISSUE                            VALUE '3'.        CL**2
   613         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
   614           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
   615           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   616           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
   617           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
   618           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
   619           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
   620           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
   621           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
   622           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
   623           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
   624           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
   625           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
   626           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
   627           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
   628           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
   629           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
   630           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
   631           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
   632                                                     'W' 'X'.        CL**2
   633           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
   634           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
   635           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
   636           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
   637           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
   638           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
   639           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
   640           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
   641           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
   642           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
   643           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
   644           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
   645           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
   646                                                                     CL**2
   647         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
   648                                     COMP-3.                         CL**2
   649         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
   650         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
   651         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
   652         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
   653         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
   654           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
   655               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
   656         16  CP-R78-OPTION         PIC X.                            CL**2
   657           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
   658           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
   659                                                                     CL**2
   660         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
   661         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
   662         16  CP-CLAIM-STATUS       PIC X.                            CL**2
   663         16  CP-RATE-FILE          PIC X.                            CL**2
   664         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
   665                                     COMP-3.                         CL**2
   666                                                                     CL**2
   667         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
   668         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
   669                                                                     CL**2
   670         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
   671                                     COMP-3.
   672         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   673                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   674         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
   675                                     COMP-3.                         CL**2
   676         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   677                                     COMP-3.                         CL**2
   678         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
   679                                     COMP-3.
   680         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   681                                  PIC S9(7)V99 COMP-3.
   682                                                                     CL**2
   683         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
   684         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
   685         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
   686           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
   687           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
   688           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
   689           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
   690         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
   691         16  CP-CARRIER            PIC X.                            CL**2
   692         16  CP-REIN-FLAG          PIC X.                            CL**2
   693         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
   694           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
   695                      '2' '3' '4' '5'.                               CL**2
   696           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
   697           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
   698           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
   699           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
   700           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
   701           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
   702           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
   703           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   704         16  CP-SIG-SWITCH         PIC X.                            CL**2
   705         16  CP-RATING-METHOD      PIC X.                            CL**2
   706           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
   707           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
   708           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
   709           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   710           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   711           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   712           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
   713           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
   714           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
   715         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
   716                                     COMP-3.                         CL**2
   717         16  CP-BEN-CATEGORY       PIC X.
   718         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   719         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   720                                   PIC S99V9(5) COMP-3.
   721         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   722         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   723                                   PIC S99V9(5) COMP-3.
   724         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   725         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   726         16  CP-EXPIRE-DT          PIC XX.
   727         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   728         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   729         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   730         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   731         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   732             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   733             88  CP-CALC-CLP              VALUE 'C'.
   734         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   735         16  CP-CANCEL-REASON      PIC X.
   736         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   737         16  CP-PMT-MODE           PIC X.
   738         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   739         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   740         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   741         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   742         16  FILLER                PIC X.
   743                                                                     CL**2
   744***************    OUTPUT FROM ELRESV   ************************     CL**2
   745                                                                     CL**2
   746         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
   747                                                                     CL**2
   748         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
   749                                     COMP-3.                         CL**2
   750         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
   751                                     COMP-3.                         CL**2
   752         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
   753                                     COMP-3.                         CL**2
   754         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
   755                                     COMP-3.                         CL**2
   756         16  FILLER                PIC X(09).                        CL**2
   757***************    OUTPUT FROM ELRTRM   *************************    CL**2
   758                                                                     CL**2
   759         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
   760                                     COMP-3.                         CL**2
   761         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
   762                                     COMP-3.                         CL**2
   763         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
   764                                     COMP-3.                         CL**2
   765         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
   766                                     COMP-3.                         CL**2
   767         16  FILLER                PIC X(12).                        CL**2
   768                                                                     CL**2
   769***************    OUTPUT FROM ELRAMT   *************************    CL**2
   770                                                                     CL**2
   771         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
   772                                     COMP-3.                         CL**2
   773         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
   774                                     COMP-3.                         CL**2
   775         16  FILLER                PIC X(12).                        CL**2
   776                                                                     CL**2
   777***************    OUTPUT FROM ELRATE   *************************    CL**2
   778                                                                     CL**2
   779         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
   780                                     COMP-3.                         CL**2
   781         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
   782                                     COMP-3.                         CL**2
   783         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
   784         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
   785             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
   786         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
   787                                     COMP-3.                         CL**2
   788         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
   789         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   790         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   791                                   PIC S9(7)V99 COMP-3.
   792         16  FILLER                PIC X(07).                        CL**2
   793                                                                     CL**2
   794***************    OUTPUT FROM ELRFND   *************************    CL**2
   795                                                                     CL**2
   796         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
   797                                     COMP-3.                         CL**2
   798         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
   799           88  CP-R-AS-R78                         VALUE '1'.        CL**2
   800           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
   801           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
   802           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
   803           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
   804           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
   805           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
   806           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
   807           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   808           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   809           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   810           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   811           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   812           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   813         16  FILLER                PIC X(12).                        CL**2
   814                                                                     CL**2
   815***************    OUTPUT FROM ELEARN   *************************    CL**2
   816                                                                     CL**2
   817         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
   818                                     COMP-3.                         CL**2
   819         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
   820                                     COMP-3.                         CL**2
   821         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
   822                                     COMP-3.                         CL**2
   823         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
   824                                     COMP-3.                         CL**2
   825         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
   826                                     COMP-3.                         CL**2
   827         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
   828                                     COMP-3.                         CL**2
   829         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
   830           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
   831           88  CP-E-AS-R78                         VALUE '1'.        CL**2
   832           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
   833           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
   834           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
   835           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
   836           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
   837           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
   838           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   839         16  FILLER                PIC X(12).                        CL**2
   840                                                                     CL**2
   841***************    OUTPUT FROM ELPMNT   *************************    CL**2
   842                                                                     CL**2
   843         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
   844                                     COMP-3.                         CL**2
   845         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
   846                                     COMP-3.                         CL**2
   847         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   848                                                                     CL**2
   849***************   MISC WORK AREAS    *****************************   CL**2
   850         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
   851                                     COMP-3.                         CL**2
   852         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
   853                                     COMP-3.                         CL**2
   854         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
   855                                     COMP-3.                         CL**2
   856         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
   857                                     COMP-3.                         CL**2
   858         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
   859                                     COMP-3.                         CL**2
   860         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
   861                                     COMP-3.                         CL**2
   862         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
   863             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
   864             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
   865             88  IO-ERROR                         VALUE 'E'.         CL**2
   866                                                                     CL**2
   867         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
   868                                                                     CL**2
   869         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
   870                                                                     CL**2
   871         16  CP-RESERVE-REMAINING-TERM                               CL**2
   872                                   PIC S9(4)V9    VALUE ZERO         CL**2
   873                                     COMP-3.                         CL**2
   874                                                                     CL**2
   875         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
   876                                                                     CL**2
   877         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
   878                                     COMP-3.                         CL**2
   879                                                                     CL**2
   880         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
   881                                     COMP-3.                         CL**2
   882                                                                     CL**2
   883         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
   884                                     COMP-3.                         CL**2
   885                                                                     CL**2
   886         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
   887                                     COMP-3.                         CL**2
   888                                                                     CL**2
   889         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
   890                                     COMP-3.                         CL**2
   891                                                                     CL**2
   892         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
   893                                     COMP-3.                         CL**2
   894                                                                     CL**2
   895         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
   896                                     COMP-3.                         CL**2
   897                                                                     CL**2
   898         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
   899             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
   900                                                                     CL**2
   901         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
   902                                     COMP-3.                         CL**2
   903         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   904                                     COMP-3.
   905         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   906         16  cp-extra-periods      pic 9 value zeros.
   907         16  cp-net-only-state     pic x value spaces.
   908         16  FILLER                PIC X(13).                        CL**2
   909******************************************************************   CL**2
   910                                                                  ELRTRMX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* ELRTRMX.cbl
   912 PROCEDURE DIVISION USING CALCULATION-PASS-AREA.                  ELRTRMX
   913                                                                  ELRTRMX
   914                                                                     CL*10
   915 000-RT-REMAINING-TERM-RTN.                                          CL**3
*  916                            COPY ELCRTMPD.                           CL**3
   917******************************************************************04/20/98
   918*                                                                *ELCRTMPD
   919*                                                                *ELCRTMPD
   920*                            ELCRTMPD                            *   LV005
   921*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
   922*                            VMOD=2.012.                         *   CL**4
   923*                                                                *ELCRTMPD
   924******************************************************************ELCRTMPD
   925                                                                  ELCRTMPD
   926     MOVE SPACE                  TO EFFECTIVE-EOM                 ELCRTMPD
   927                                    VALUATION-EOM                 ELCRTMPD
   928                                    PAYMENT-EOM                   ELCRTMPD
   929                                    EXPIRATION-EOM                ELCRTMPD
   930                                    TOP-EOM                       ELCRTMPD
   931                                    BOTTOM-EOM.                   ELCRTMPD
   932                                                                  ELCRTMPD
   933     MOVE ZERO                   TO CP-RETURN-CODE                ELCRTMPD
   934                                    CP-RETURN-CODE-2              ELCRTMPD
   935                                    CP-REMAINING-TERM-1           ELCRTMPD
   936                                    CP-REMAINING-TERM-2           ELCRTMPD
   937                                    CP-REMAINING-TERM-3           ELCRTMPD
   938                                    CP-ODD-DAYS.                  ELCRTMPD
   939                                                                  ELCRTMPD
   940******************************************************************ELCRTMPD
   941*   IF THE ORIGINAL TERM IS NOT VALID, THEN EXIT FROM THE        *ELCRTMPD
   942*  ROUTINE INDICATING THAT THERE WAS AN ERROR DETECTED WITH      *ELCRTMPD
   943*  THE TERM.                                                     *ELCRTMPD
   944******************************************************************ELCRTMPD
   945                                                                  ELCRTMPD
   946     IF CP-ORIGINAL-TERM NOT NUMERIC                              ELCRTMPD
   947         MOVE ZERO               TO CP-ORIGINAL-TERM.             ELCRTMPD
   948                                                                  ELCRTMPD
   949     IF CP-ORIGINAL-TERM = ZERO                                   ELCRTMPD
   950         MOVE '4'                TO CP-RETURN-CODE                ELCRTMPD
   951         GO TO 9999-RT-REMAINING-TERM-XIT.                        ELCRTMPD
   952                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
   954                                                                  ELCRTMPD
   955     IF CP-FIRST-PAY-DATE = SPACES  OR  LOW-VALUES                ELCRTMPD
   956         NEXT SENTENCE                                            ELCRTMPD
   957     ELSE                                                         ELCRTMPD
   958         IF CP-FIRST-PAY-DATE NOT GREATER THAN CP-CERT-EFF-DT     ELCRTMPD
   959             MOVE LOW-VALUES     TO CP-FIRST-PAY-DATE.            ELCRTMPD
   960                                                                  ELCRTMPD
   961******************************************************************ELCRTMPD
   962*   IF THE FIRST PAYMENT DATE IS NOT A VALID DATE, THEN          *ELCRTMPD
   963*  CALCULATE A DEFAULT PAYMENT DATE I.E. ONE MONTH AFTER         *ELCRTMPD
   964*  THE EFFECTIVE, AND CONTINUE PROCESSING.                       *ELCRTMPD
   965******************************************************************ELCRTMPD
   966                                                                  ELCRTMPD
   967     IF CP-FIRST-PAY-DATE = SPACES  OR  LOW-VALUES                ELCRTMPD
   968         MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1                 ELCRTMPD
   969         MOVE +1                 TO DC-ELAPSED-MONTHS             ELCRTMPD
   970         MOVE ZEROS              TO DC-ELAPSED-DAYS               ELCRTMPD
   971         MOVE '6'                TO DC-OPTION-CODE                ELCRTMPD
   972         PERFORM 8000-DATE-CONVERT THRU 8000-EXIT                 ELCRTMPD
   973         IF NO-CONVERSION-ERROR                                   ELCRTMPD
   974             MOVE DC-BIN-DATE-2  TO CP-FIRST-PAY-DATE             ELCRTMPD
   975         ELSE                                                     ELCRTMPD
   976             MOVE '2'            TO CP-RETURN-CODE                ELCRTMPD
   977             GO TO 9999-RT-REMAINING-TERM-XIT.                    ELCRTMPD
   978                                                                  ELCRTMPD
   979     MOVE CP-ORIGINAL-TERM       TO CP-REMAINING-TERM-1           ELCRTMPD
   980                                    CP-REMAINING-TERM-2           ELCRTMPD
   981                                    CP-REMAINING-TERM-3.          ELCRTMPD
   982                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
   984******************************************************************ELCRTMPD
   985*   IF THE CERT EFFECTIVE DATE EQUAL TO THE CANCEL DATE,         *ELCRTMPD
   986*  EXIT FROM THE ROUTINE WITH THE ORIGINAL TERM EQUAL TO THE     *ELCRTMPD
   987*  REMAINING TERM - NO PREMIUM EARNED.                           *ELCRTMPD
   988******************************************************************ELCRTMPD
   989                                                                  ELCRTMPD
   990     IF CP-CERT-EFF-DT NOT LESS THAN CP-VALUATION-DT              ELCRTMPD
   991         GO TO 9999-RT-REMAINING-TERM-XIT.                        ELCRTMPD
   992                                                                  ELCRTMPD
   993     IF VALID-REM-TRM-CALC-OPTION                                 ELCRTMPD
   994         NEXT SENTENCE                                            ELCRTMPD
   995     ELSE                                                         ELCRTMPD
   996         GO TO 1000-CONTROL-CALCULATION.                          ELCRTMPD
   997                                                                  ELCRTMPD
   998******************************************************************ELCRTMPD
   999*  IF THE POLICY IS CANCELED DURING A "FREE-LOOK" PERIOD,        *ELCRTMPD
  1000*  EXIT FROM THE ROUTINE WITH THE ORGINAL TERM EQUAL TO THE      *ELCRTMPD
  1001*  REMAINING TERM - NO PREMIUM EARNED.                           *ELCRTMPD
  1002*  (ELASPED DAYS FROM EFFECTIVE DATE TO CANCEL DATE IS COMPARED  *ELCRTMPD
  1003*  TO FREE LOOK DAYS)                                            *ELCRTMPD
  1004******************************************************************ELCRTMPD
  1005                                                                  ELCRTMPD
  1006     IF CP-FREE-LOOK NOT NUMERIC                                  ELCRTMPD
  1007          MOVE ZERO               TO CP-FREE-LOOK.                ELCRTMPD
  1008                                                                  ELCRTMPD
  1009     IF CP-FREE-LOOK NOT = ZERO                                   ELCRTMPD
  1010          MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1                ELCRTMPD
  1011          MOVE CP-VALUATION-DT    TO DC-BIN-DATE-2                ELCRTMPD
  1012          MOVE '1'                TO DC-OPTION-CODE               ELCRTMPD
  1013          PERFORM 8000-DATE-CONVERT THRU 8000-EXIT                ELCRTMPD
  1014          IF DATE-CONVERSION-ERROR                                ELCRTMPD
  1015            MOVE '2'                TO CP-RETURN-CODE             ELCRTMPD
  1016            GO TO 9999-RT-REMAINING-TERM-XIT                      ELCRTMPD
  1017          ELSE                                                    ELCRTMPD
  1018             IF DC-ELAPSED-DAYS NOT GREATER THAN CP-FREE-LOOK     ELCRTMPD
  1019                GO TO 9999-RT-REMAINING-TERM-XIT.                 ELCRTMPD
  1020                                                                  ELCRTMPD
  1021******************************************************************ELCRTMPD
  1022*   INITIALIZE DATE FIELDS USED LATER TO CALCULATE ELAPSED TIME  *ELCRTMPD
  1023******************************************************************ELCRTMPD
  1024                                                                  ELCRTMPD
  1025     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELCRTMPD
  1026     MOVE ' '                    TO DC-OPTION-CODE.               ELCRTMPD
  1027     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT                     ELCRTMPD
  1028     IF DATE-CONVERSION-ERROR                                     ELCRTMPD
  1029         MOVE '2'                TO CP-RETURN-CODE                ELCRTMPD
  1030         GO TO 9999-RT-REMAINING-TERM-XIT.                        ELCRTMPD
  1031                                                                  ELCRTMPD
  1032     MOVE DC-GREG-DATE-CYMD      TO WS-SAVE-EFFECTIVE-DATE.          CL**2
  1033     IF SAVE-EFF-DAYS EQUAL DC-DAYS-IN-MONTH                      ELCRTMPD
  1034         MOVE 'Y'                TO EFFECTIVE-EOM.                ELCRTMPD
  1035                                                                  ELCRTMPD
  1036     MOVE CP-VALUATION-DT        TO DC-BIN-DATE-1.                ELCRTMPD
  1037     MOVE ' '                    TO DC-OPTION-CODE.               ELCRTMPD
  1038     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT                     ELCRTMPD
  1039     IF DATE-CONVERSION-ERROR                                     ELCRTMPD
  1040         MOVE '2'                TO CP-RETURN-CODE                ELCRTMPD
  1041         GO TO 9999-RT-REMAINING-TERM-XIT.                        ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1042                                                                  ELCRTMPD
  1043     MOVE DC-GREG-DATE-CYMD      TO WS-SAVE-VALUATION-DATE.          CL**2
  1044     IF SAVE-VAL-DAYS EQUAL DC-DAYS-IN-MONTH                      ELCRTMPD
  1045         MOVE 'Y'                TO VALUATION-EOM.                ELCRTMPD
  1046                                                                  ELCRTMPD
  1047                                                                  ELCRTMPD
  1048     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-1.                ELCRTMPD
  1049     MOVE ' '                    TO DC-OPTION-CODE.               ELCRTMPD
  1050     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT                     ELCRTMPD
  1051     IF DATE-CONVERSION-ERROR                                     ELCRTMPD
  1052         MOVE '2'                TO CP-RETURN-CODE                ELCRTMPD
  1053         GO TO 9999-RT-REMAINING-TERM-XIT.                        ELCRTMPD
  1054                                                                  ELCRTMPD
  1055     MOVE DC-GREG-DATE-CYMD      TO WS-SAVE-PAYMENT-DATE.            CL**2
  1056     IF SAVE-PAY-DAYS EQUAL DC-DAYS-IN-MONTH                      ELCRTMPD
  1057         MOVE 'Y'                TO PAYMENT-EOM.                  ELCRTMPD
  1058                                                                  ELCRTMPD
  1059                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1061****************************************************************  ELCRTMPD
  1062*   THREE OPTIONS:                                             *  ELCRTMPD
  1063*     1) CALCULATE TIME ELAPSED FROM PAYMENT DATE              *  ELCRTMPD
  1064*       TO CANCEL DATE CONSIDERING EXTENSION DAYS              *  ELCRTMPD
  1065*                                                              *  ELCRTMPD
  1066*     2) CALCULATE TIME ELAPSED FROM EFFECTIVE DATE            *  ELCRTMPD
  1067*       TO CANCEL DATE NOT CONSIDERING EXTENSION DAYS          *  ELCRTMPD
  1068*                                                              *  ELCRTMPD
  1069*     3) IF COMPANY ID IS 'NCL' AND ELASPED TIME METHOD IS     *  ELCRTMPD
  1070*       '3' OR '4', CALCULATE REMAINING TIME AS                *  ELCRTMPD
  1071*      (EXPIRATION DATE - CANCEL DATE = REMAINING TIME)        *  ELCRTMPD
  1072*                                                              *  ELCRTMPD
  1073*   IF THE CANCEL DATE IS LESS THAN THE 1ST PAYMENT DATE,      *  ELCRTMPD
  1074*   OPTION 2 WILL BE USED (DOES NOT APPLY IF OPTION 3 IS TRUE) *  ELCRTMPD
  1075****************************************************************  ELCRTMPD
  1076                                                                  ELCRTMPD
  1077 001-CONTROL-OPTIONS.                                             ELCRTMPD
  1078                                                                  ELCRTMPD
  1079     IF (CP-CONSIDER-EXTENSION)
  1080                 AND
  1081        ((CP-COMPANY-ID = 'NCL')
  1082          OR (CP-USE-EXP-AND-1ST-PMT))
  1083        GO TO 600-PROCESS-FOR-NCL
  1084     END-IF
  1085
  1086*    IF CP-CONSIDER-EXTENSION AND                                 ELCRTMPD
  1087*       CP-COMPANY-ID = 'NCL'                                     ELCRTMPD
  1088*        GO TO 600-PROCESS-FOR-NCL.                               ELCRTMPD
  1089                                                                  ELCRTMPD
  1090     IF CP-VALUATION-DT LESS THAN CP-FIRST-PAY-DATE               ELCRTMPD
  1091         GO TO 100-CANCELLED-BEFORE-PAYMENT.                      ELCRTMPD
  1092                                                                  ELCRTMPD
  1093     IF CP-CONSIDER-EXTENSION                                     ELCRTMPD
  1094         GO TO 200-PROCESS-WITH-1ST-PMT-DATE                      ELCRTMPD
  1095     ELSE                                                         ELCRTMPD
  1096         GO TO 300-PROCESS-WITH-CERT-EFF-DATE.                    ELCRTMPD
  1097                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1099                                                                     CL**5
  1100****************************************************************  ELCRTMPD
  1101*                                                              *  ELCRTMPD
  1102*   PROCESSING WHEN VALUATION DATE LESS THAN 1ST PAYMENT DATE  *  ELCRTMPD
  1103*   OR WHEN REMAINING TERM OPTION '1' OR '2' IS CHOSEN.        *  ELCRTMPD
  1104*                                                              *  ELCRTMPD
  1105****************************************************************  ELCRTMPD
  1106                                                                  ELCRTMPD
  1107****************************************************************  ELCRTMPD
  1108*                                                              *  ELCRTMPD
  1109*   CALCULATE THE TIME ELAPSED BETWEEN THE CANCEL DATE AND     *  ELCRTMPD
  1110*   THE CERT EFFECTIVE DATE.                                   *  ELCRTMPD
  1111*                                                              *  ELCRTMPD
  1112****************************************************************  ELCRTMPD
  1113 100-CANCELLED-BEFORE-PAYMENT.                                    ELCRTMPD
  1114                                                                  ELCRTMPD
  1115     MOVE WS-SAVE-EFFECTIVE-DATE TO WS-BOTTOM-NUMBER.             ELCRTMPD
  1116                                                                  ELCRTMPD
  1117     MOVE WS-SAVE-VALUATION-DATE TO WS-TOP-NUMBER.                ELCRTMPD
  1118     MOVE CP-VALUATION-DT        TO WS-SAVE-BINARY-DATE.          ELCRTMPD
  1119     IF VALUATION-DATE-EOM AND EFFECTIVE-DATE-EOM                 ELCRTMPD
  1120         MOVE ZEROS              TO WS-TOP-DA                     ELCRTMPD
  1121                                    WS-BOTTOM-DA.                 ELCRTMPD
  1122                                                                  ELCRTMPD
  1123     PERFORM 500-SIMPLE-ARITHMETIC THRU 500-EXIT.                 ELCRTMPD
  1124                                                                  ELCRTMPD
  1125     IF CP-EARN-AFTER-15TH                                        ELCRTMPD
  1126        GO TO 110-METHOD-1.                                       ELCRTMPD
  1127     IF CP-EARN-ON-HALF-MONTH                                     ELCRTMPD
  1128        GO TO 120-METHOD-2.                                       ELCRTMPD
  1129     IF CP-EARN-ON-1ST-DAY                                        ELCRTMPD
  1130        GO TO 130-METHOD-3.                                       ELCRTMPD
  1131     IF CP-EARN-ON-FULL-MONTH                                     ELCRTMPD
  1132        GO TO 140-METHOD-4.                                       ELCRTMPD
  1133     IF CP-EARN-WITH-NO-DAYS                                      ELCRTMPD
  1134        GO TO 150-METHOD-5.                                       ELCRTMPD
  1135     IF CP-EARN-AFTER-14TH                                        ELCRTMPD
  1136        GO TO 160-METHOD-6.                                       ELCRTMPD
  1137     IF CP-EARN-AFTER-16TH                                        ELCRTMPD
  1138        GO TO 170-METHOD-7.                                       ELCRTMPD
  1139                                                                  ELCRTMPD
  1140****************************************************************  ELCRTMPD
  1141*                                                              *  ELCRTMPD
  1142*   IF NONE OF THE ABOVE OPTIONS HAVE BEEN SPECIFIED, THEN     *  ELCRTMPD
  1143*   INDICATE THERE WAS AN ERROR IN THE OPTION SELECTION AND    *  ELCRTMPD
  1144*   EXIT FROM THE ROUTINE.                                     *  ELCRTMPD
  1145*                                                              *  ELCRTMPD
  1146****************************************************************  ELCRTMPD
  1147     MOVE '3' TO CP-RETURN-CODE                                   ELCRTMPD
  1148     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  1149                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1151****************************************************************  ELCRTMPD
  1152*                                                              *  ELCRTMPD
  1153*                       NUMBER OF DAYS                         *  ELCRTMPD
  1154*         POLICY MUST BE INFORCE FOR 15 DAYS TO EARN A MONTH   *  ELCRTMPD
  1155*                                                              *  ELCRTMPD
  1156****************************************************************  ELCRTMPD
  1157                                                                  ELCRTMPD
  1158 110-METHOD-1.                                                    ELCRTMPD
  1159                                                                  ELCRTMPD
  1160                                                                  ELCRTMPD
  1161     IF WS-RESULT-DA     GREATER THAN +15  OR                     ELCRTMPD
  1162        TERM-IN-MONTHS    GREATER THAN +0                         ELCRTMPD
  1163         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1164                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  1165                                                                  ELCRTMPD
  1166     GO TO 199-END-CERT-DATE-PROCESSING.                          ELCRTMPD
  1167                                                                  ELCRTMPD
  1168****************************************************************  ELCRTMPD
  1169*                                                              *  ELCRTMPD
  1170*                       HALF MONTH ADJUSTMENT                  *  ELCRTMPD
  1171*            PREMIUM EARNS ON 1/2 MONTH MORE ASSUMPTION        *  ELCRTMPD
  1172*                                                              *  ELCRTMPD
  1173****************************************************************  ELCRTMPD
  1174                                                                  ELCRTMPD
  1175 120-METHOD-2.                                                    ELCRTMPD
  1176                                                                  ELCRTMPD
  1177     IF TERM-IN-MONTHS    GREATER THAN +0                         ELCRTMPD
  1178         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1179                       CP-REMAINING-TERM-1 - (+1.5)               ELCRTMPD
  1180     ELSE                                                         ELCRTMPD
  1181         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1182                       CP-REMAINING-TERM-1 - (+.5).               ELCRTMPD
  1183                                                                  ELCRTMPD
  1184     IF CP-REMAINING-TERM-1 NEGATIVE                              ELCRTMPD
  1185         MOVE ZEROS                 TO CP-REMAINING-TERM-1.       ELCRTMPD
  1186                                                                  ELCRTMPD
  1187                                                                  ELCRTMPD
  1188     GO TO 199-END-CERT-DATE-PROCESSING.                          ELCRTMPD
  1189                                                                  ELCRTMPD
  1190                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1192****************************************************************  ELCRTMPD
  1193*                                                              *  ELCRTMPD
  1194*                       FIRST DAY METHOD                       *  ELCRTMPD
  1195*                  PREMIUM EARNS ON FIRST DAY                  *  ELCRTMPD
  1196*                                                              *  ELCRTMPD
  1197****************************************************************  ELCRTMPD
  1198                                                                  ELCRTMPD
  1199 130-METHOD-3.                                                    ELCRTMPD
  1200                                                                  ELCRTMPD
  1201     IF WS-RESULT-DA     GREATER THAN +0  OR                      ELCRTMPD
  1202        TERM-IN-MONTHS    GREATER THAN +0                         ELCRTMPD
  1203         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1204                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  1205                                                                  ELCRTMPD
  1206     GO TO 199-END-CERT-DATE-PROCESSING.                          ELCRTMPD
  1207                                                                  ELCRTMPD
  1208****************************************************************  ELCRTMPD
  1209*                                                              *  ELCRTMPD
  1210*                       FULL MONTH METHOD                      *  ELCRTMPD
  1211*          PREMIUM EARNS ON FULL MONTH - SAME AS BENEFIT       *  ELCRTMPD
  1212*                                                              *  ELCRTMPD
  1213****************************************************************  ELCRTMPD
  1214                                                                  ELCRTMPD
  1215 140-METHOD-4.                                                    ELCRTMPD
  1216                                                                  ELCRTMPD
  1217                                                                  ELCRTMPD
  1218*    WILL NOT REDUCE REMAINING TERM ON 'FULL' MONTH UNTIL         ELCRTMPD
  1219*        PAST THE FIRST PAYMENT DATE.                             ELCRTMPD
  1220                                                                  ELCRTMPD
  1221     GO TO 199-END-CERT-DATE-PROCESSING.                          ELCRTMPD
  1222                                                                  ELCRTMPD
  1223                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1225****************************************************************  ELCRTMPD
  1226*                                                              *  ELCRTMPD
  1227*                       FULL MONTH - NO DAYS                   *  ELCRTMPD
  1228*          PREMIUM EARNS A FULL MONTH STARTING THE FIRST MONTH *  ELCRTMPD
  1229*       (THIS METHOD WILL EARN WITHOUT A FLUCTUATION IN SHORT  *  ELCRTMPD
  1230*        MONTHS )                                              *  ELCRTMPD
  1231****************************************************************  ELCRTMPD
  1232                                                                  ELCRTMPD
  1233 150-METHOD-5.                                                    ELCRTMPD
  1234                                                                  ELCRTMPD
  1235                                                                  ELCRTMPD
  1236     COMPUTE CP-REMAINING-TERM-1 =                                ELCRTMPD
  1237                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  1238                                                                  ELCRTMPD
  1239     GO TO 199-END-CERT-DATE-PROCESSING.                          ELCRTMPD
  1240                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1242****************************************************************  ELCRTMPD
  1243*                                                              *  ELCRTMPD
  1244*                       NUMBER OF DAYS                         *  ELCRTMPD
  1245*         POLICY MUST BE INFORCE FOR 14 DAYS TO EARN A MONTH   *  ELCRTMPD
  1246*                                                              *  ELCRTMPD
  1247****************************************************************  ELCRTMPD
  1248                                                                  ELCRTMPD
  1249 160-METHOD-6.                                                    ELCRTMPD
  1250                                                                  ELCRTMPD
  1251                                                                  ELCRTMPD
  1252     IF WS-RESULT-DA     GREATER THAN +14  OR                     ELCRTMPD
  1253        TERM-IN-MONTHS    GREATER THAN +0                         ELCRTMPD
  1254         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1255                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  1256                                                                  ELCRTMPD
  1257     GO TO 199-END-CERT-DATE-PROCESSING.                          ELCRTMPD
  1258                                                                  ELCRTMPD
  1259****************************************************************  ELCRTMPD
  1260*                                                              *  ELCRTMPD
  1261*                       NUMBER OF DAYS                         *  ELCRTMPD
  1262*         POLICY MUST BE INFORCE FOR 16 DAYS TO EARN A MONTH   *  ELCRTMPD
  1263*                                                              *  ELCRTMPD
  1264****************************************************************  ELCRTMPD
  1265                                                                  ELCRTMPD
  1266 170-METHOD-7.                                                    ELCRTMPD
  1267                                                                  ELCRTMPD
  1268                                                                  ELCRTMPD
  1269     IF WS-RESULT-DA     GREATER THAN +16  OR                     ELCRTMPD
  1270        TERM-IN-MONTHS    GREATER THAN +0                         ELCRTMPD
  1271         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1272                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  1273                                                                  ELCRTMPD
  1274     GO TO 199-END-CERT-DATE-PROCESSING.                          ELCRTMPD
  1275                                                                  ELCRTMPD
  1276                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1278 199-END-CERT-DATE-PROCESSING.                                    ELCRTMPD
  1279                                                                  ELCRTMPD
  1280     IF CP-REMAINING-TERM-1 NEGATIVE                              ELCRTMPD
  1281        MOVE ZERO                TO CP-REMAINING-TERM-1           ELCRTMPD
  1282                                    CP-REMAINING-TERM-2           ELCRTMPD
  1283                                    CP-REMAINING-TERM-3           ELCRTMPD
  1284        GO TO 9999-RT-REMAINING-TERM-XIT.                         ELCRTMPD
  1285                                                                  ELCRTMPD
  1286     MOVE WS-RESULT-DA           TO CP-ODD-DAYS.                  ELCRTMPD
  1287                                                                  ELCRTMPD
  1288     IF CP-EARN-AS-REG-BALLOON                                    ELCRTMPD
  1289        IF CP-BALLOON-LAST-PMT                                    ELCRTMPD
  1290           ADD +1 TO CP-REMAINING-TERM-3.                         ELCRTMPD
  1291                                                                  ELCRTMPD
  1292     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  1293                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1295                                                                     CL**5
  1296****************************************************************  ELCRTMPD
  1297*                                                              *  ELCRTMPD
  1298*  PROCESSING FOR VALUATION DATE ON OR AFTER 1ST PAYMENT DATE  *  ELCRTMPD
  1299*  AND CONSIDERING EXTENSION DAYS.                             *  ELCRTMPD
  1300*                                                              *  ELCRTMPD
  1301****************************************************************  ELCRTMPD
  1302                                                                  ELCRTMPD
  1303 200-PROCESS-WITH-1ST-PMT-DATE.                                   ELCRTMPD
  1304                                                                  ELCRTMPD
  1305****************************************************************  ELCRTMPD
  1306*                                                              *  ELCRTMPD
  1307*  COMPUTE AN EXPIRATION DATE USING THE 1ST PAYMENT DATE  AND  *  ELCRTMPD
  1308*  THE (REMAINING TERM - 1). IF THE VALUATION DATE IS GREATER  *  ELCRTMPD
  1309*  THAN THIS ESTIMATED DATE, THEN THE TERM IS CONSIDERED TO    *  ELCRTMPD
  1310*  BE FULLY EXPIRED.                                           *  ELCRTMPD
  1311*                                                              *  ELCRTMPD
  1312****************************************************************  ELCRTMPD
  1313                                                                  ELCRTMPD
  1314     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-1.                ELCRTMPD
  1315                                                                  ELCRTMPD
  1316     COMPUTE DC-ELAPSED-MONTHS EQUAL                              ELCRTMPD
  1317         (CP-ORIGINAL-TERM - +1).                                 ELCRTMPD
  1318                                                                  ELCRTMPD
  1319     MOVE ZEROS                  TO DC-ELAPSED-DAYS.              ELCRTMPD
  1320     MOVE '6'                    TO DC-OPTION-CODE.               ELCRTMPD
  1321     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT.                    ELCRTMPD
  1322                                                                  ELCRTMPD
  1323     IF DATE-CONVERSION-ERROR                                     ELCRTMPD
  1324        MOVE '2' TO CP-RETURN-CODE                                ELCRTMPD
  1325        GO TO 9999-RT-REMAINING-TERM-XIT                          ELCRTMPD
  1326     ELSE                                                         ELCRTMPD
  1327        IF DC-BIN-DATE-2 NOT GREATER CP-VALUATION-DT              ELCRTMPD
  1328            MOVE ZEROS TO CP-REMAINING-TERM-1                     ELCRTMPD
  1329                          CP-REMAINING-TERM-2                     ELCRTMPD
  1330                          CP-REMAINING-TERM-3                     ELCRTMPD
  1331            GO TO 9999-RT-REMAINING-TERM-XIT.                     ELCRTMPD
  1332                                                                  ELCRTMPD
  1333                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1335****************************************************************  ELCRTMPD
  1336*  REMAINING-TERM-2 REFLECTS THE NUMBER OF PAYMENTS THAT A     *  ELCRTMPD
  1337*  INSURED HAS LEFT TO PAY. REQUARDLESS OF THE AMOUNT OF TIME  *  ELCRTMPD
  1338*  THAT HAS ELAPSED FROM THE EFFECTIVE DATE TO THE FIRST       *  ELCRTMPD
  1339*  PAYMENT DATE, ONLY ONE MONTH IS EARNED.  THE NUMBER OF      *  ELCRTMPD
  1340*  PAYMENTS IS THEN EVALUATED FROM THE FIRST PAYMENT DATE TO   *  ELCRTMPD
  1341*  THE VALUATION DATE.                                         *  ELCRTMPD
  1342*                                                              *  ELCRTMPD
  1343*  IF THE VALUATION DATE IS GREATER THAN THE 1ST PAYMENT       *  ELCRTMPD
  1344*  DATE, ONE MONTH HAS BEEN EARNED FOR REMAINING TERM-2.       *  ELCRTMPD
  1345*                                                              *  ELCRTMPD
  1346*   NOTE : THE MAXIMUM MONTHS EARNED FORM THE EFFECTIVE DATE   *  ELCRTMPD
  1347*     TO THE PAYMENT DATE IS 1.                                *  ELCRTMPD
  1348*                                                              *  ELCRTMPD
  1349****************************************************************  ELCRTMPD
  1350                                                                  ELCRTMPD
  1351     IF CP-VALUATION-DT NOT LESS THAN CP-FIRST-PAY-DATE           ELCRTMPD
  1352         MOVE 1                  TO MONTHS-EARNED-2               ELCRTMPD
  1353     ELSE                                                         ELCRTMPD
  1354         MOVE 0                  TO MONTHS-EARNED-2.              ELCRTMPD
  1355                                                                  ELCRTMPD
  1356     MOVE WS-SAVE-VALUATION-DATE TO WS-TOP-NUMBER.                ELCRTMPD
  1357     MOVE CP-VALUATION-DT        TO WS-SAVE-BINARY-DATE.          ELCRTMPD
  1358                                                                  ELCRTMPD
  1359     MOVE WS-SAVE-PAYMENT-DATE   TO WS-BOTTOM-NUMBER.             ELCRTMPD
  1360                                                                  ELCRTMPD
  1361     PERFORM 500-SIMPLE-ARITHMETIC THRU 500-EXIT.                 ELCRTMPD
  1362                                                                  ELCRTMPD
  1363     COMPUTE CP-REMAINING-TERM-2 = CP-ORIGINAL-TERM -             ELCRTMPD
  1364                          (TERM-IN-MONTHS  + MONTHS-EARNED-2).    ELCRTMPD
  1365                                                                  ELCRTMPD
  1366     IF CP-REMAINING-TERM-2 NEGATIVE                              ELCRTMPD
  1367        MOVE 0                   TO CP-REMAINING-TERM-1           ELCRTMPD
  1368                                    CP-REMAINING-TERM-2           ELCRTMPD
  1369                                    CP-REMAINING-TERM-3           ELCRTMPD
  1370                                    CP-ODD-DAYS                   ELCRTMPD
  1371        GO TO 9999-RT-REMAINING-TERM-XIT.                         ELCRTMPD
  1372                                                                  ELCRTMPD
  1373     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM-3.          ELCRTMPD
  1374                                                                  ELCRTMPD
  1375     IF CP-EARN-AS-REG-BALLOON                                    ELCRTMPD
  1376        IF CP-BALLOON-LAST-PMT                                    ELCRTMPD
  1377           ADD +1 TO CP-REMAINING-TERM-3.                         ELCRTMPD
  1378                                                                  ELCRTMPD
  1379     IF CP-EARN-ON-FULL-MONTH                                     ELCRTMPD
  1380        MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM-1        ELCRTMPD
  1381        MOVE 0                      TO CP-ODD-DAYS                ELCRTMPD
  1382        GO TO 9999-RT-REMAINING-TERM-XIT.                         ELCRTMPD
  1383                                                                  ELCRTMPD
  1384                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1386****************************************************************  ELCRTMPD
  1387*  REMAINING-TERM-1 IS USED FOR REFUNDS ETC.  THE TERM IS      *  ELCRTMPD
  1388*  CALCULATED FROM THE FIRST PAYMENT DATE TO THE VALUATION     *  ELCRTMPD
  1389*  DATE EARNING NO MORE THAN ONE MONTH FROM EFFECTIVE DATE TO  *  ELCRTMPD
  1390*  1ST PAYMENT DATE.                                           *  ELCRTMPD
  1391*                                                              *  ELCRTMPD
  1392*  THE TIME ELAPSED FROM THE EFFECTIVE DATE AND THE FIRST      *  ELCRTMPD
  1393*  PAYMENT DATE MUST BE 1 MONTH BEFORE IT IS CONSIDERED        *  ELCRTMPD
  1394*  EARNED.                                                     *  ELCRTMPD
  1395*                                                              *  ELCRTMPD
  1396*   NOTE : THE MAXIMUM MONTHS EARNED FORM THE EFFECTIVE DATE   *  ELCRTMPD
  1397*     TO THE PAYMENT DATE IS 1.                                *  ELCRTMPD
  1398*                                                              *  ELCRTMPD
  1399****************************************************************  ELCRTMPD
  1400                                                                  ELCRTMPD
  1401     MOVE WS-SAVE-PAYMENT-DATE   TO WS-TOP-NUMBER.                ELCRTMPD
  1402     MOVE CP-FIRST-PAY-DATE      TO WS-SAVE-BINARY-DATE.          ELCRTMPD
  1403                                                                  ELCRTMPD
  1404     MOVE WS-SAVE-EFFECTIVE-DATE TO WS-BOTTOM-NUMBER.             ELCRTMPD
  1405                                                                  ELCRTMPD
  1406     IF PAYMENT-DATE-EOM AND EFFECTIVE-DATE-EOM                   ELCRTMPD
  1407         MOVE ZEROS              TO WS-TOP-DA                     ELCRTMPD
  1408                                    WS-BOTTOM-DA.                 ELCRTMPD
  1409                                                                  ELCRTMPD
  1410     PERFORM 500-SIMPLE-ARITHMETIC THRU 500-EXIT.                 ELCRTMPD
  1411                                                                  ELCRTMPD
  1412     MOVE ZERO                   TO MONTHS-EARNED-1.              ELCRTMPD
  1413                                                                  ELCRTMPD
  1414     IF TERM-IN-MONTHS  GREATER THAN +0                           ELCRTMPD
  1415         MOVE 1                    TO MONTHS-EARNED-1             ELCRTMPD
  1416         MOVE WS-SAVE-PAYMENT-DATE TO WS-BOTTOM-NUMBER            ELCRTMPD
  1417         GO TO 205-1ST-PAY-TO-VALUATION-DATE                      ELCRTMPD
  1418     ELSE                                                         ELCRTMPD
  1419         MOVE WS-SAVE-EFFECTIVE-DATE TO WS-BOTTOM-NUMBER          ELCRTMPD
  1420         GO TO 205-1ST-PAY-TO-VALUATION-DATE.                     ELCRTMPD
  1421                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1423****************************************************************  ELCRTMPD
  1424*                                                              *  ELCRTMPD
  1425*  COMPUTE THE ELAPSED TIME BETWEEN THE 1ST PAYMENT DATE       *  ELCRTMPD
  1426*  AND THE VALUATION/CANCEL DATE.                              *  ELCRTMPD
  1427*   THE REMAINING TERM THEN BECOMES :                          *  ELCRTMPD
  1428*                                                              *  ELCRTMPD
  1429*  ORIGINAL TERM - (CALCULATED ELAPSED MONTHS + MONTHS EARNED) *  ELCRTMPD
  1430*                                                              *  ELCRTMPD
  1431****************************************************************  ELCRTMPD
  1432                                                                  ELCRTMPD
  1433 205-1ST-PAY-TO-VALUATION-DATE.                                   ELCRTMPD
  1434                                                                  ELCRTMPD
  1435     MOVE WS-SAVE-VALUATION-DATE TO WS-TOP-NUMBER.                ELCRTMPD
  1436     MOVE CP-VALUATION-DT        TO WS-SAVE-BINARY-DATE.          ELCRTMPD
  1437                                                                  ELCRTMPD
  1438     PERFORM 500-SIMPLE-ARITHMETIC THRU 500-EXIT.                 ELCRTMPD
  1439                                                                  ELCRTMPD
  1440     MOVE WS-RESULT-DA           TO CP-ODD-DAYS.                  ELCRTMPD
  1441                                                                  ELCRTMPD
  1442     COMPUTE CP-REMAINING-TERM-1 = CP-ORIGINAL-TERM -             ELCRTMPD
  1443                          (TERM-IN-MONTHS  + MONTHS-EARNED-1).    ELCRTMPD
  1444                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1446****************************************************************  ELCRTMPD
  1447* IF THIS TERM IS NEGATIVE, THE TERM IS CONSIDERED TO BE       *  ELCRTMPD
  1448*  EXPIRED AND ALL PREMIUM IS EARNED.                          *  ELCRTMPD
  1449****************************************************************  ELCRTMPD
  1450     IF CP-REMAINING-TERM-1 NEGATIVE                              ELCRTMPD
  1451        MOVE ZERO                TO CP-REMAINING-TERM-1           ELCRTMPD
  1452                                    CP-ODD-DAYS                   ELCRTMPD
  1453        GO TO 9999-RT-REMAINING-TERM-XIT.                         ELCRTMPD
  1454                                                                  ELCRTMPD
  1455     IF CP-EARN-AFTER-15TH                                        ELCRTMPD
  1456        GO TO 410-METHOD-1.                                       ELCRTMPD
  1457     IF CP-EARN-ON-HALF-MONTH                                     ELCRTMPD
  1458        GO TO 420-METHOD-2.                                       ELCRTMPD
  1459     IF CP-EARN-ON-1ST-DAY                                        ELCRTMPD
  1460        GO TO 430-METHOD-3.                                       ELCRTMPD
  1461     IF CP-EARN-ON-FULL-MONTH                                     ELCRTMPD
  1462        GO TO 440-METHOD-4.                                       ELCRTMPD
  1463     IF CP-EARN-WITH-NO-DAYS                                      ELCRTMPD
  1464        GO TO 450-METHOD-5.                                       ELCRTMPD
  1465     IF CP-EARN-AFTER-14TH                                        ELCRTMPD
  1466        GO TO 460-METHOD-6.                                       ELCRTMPD
  1467     IF CP-EARN-AFTER-16TH                                        ELCRTMPD
  1468        GO TO 470-METHOD-7.                                       ELCRTMPD
  1469                                                                  ELCRTMPD
  1470                                                                  ELCRTMPD
  1471****************************************************************  ELCRTMPD
  1472*                                                              *  ELCRTMPD
  1473*   IF NONE OF THE ABOVE OPTIONS HAVE BEEN SPECIFIED, THEN     *  ELCRTMPD
  1474*   INDICATE THERE WAS AN ERROR IN THE OPTION SELECTION AND    *  ELCRTMPD
  1475*   EXIT FROM THE ROUTINE.                                     *  ELCRTMPD
  1476*                                                              *  ELCRTMPD
  1477****************************************************************  ELCRTMPD
  1478                                                                  ELCRTMPD
  1479     MOVE '3' TO CP-RETURN-CODE                                   ELCRTMPD
  1480     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  1481                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  36
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1483****************************************************************  ELCRTMPD
  1484*                                                              *  ELCRTMPD
  1485*  PROCESSING FOR VALUATION DATE AFTER THE CERT-EFFECTIVE DATE *  ELCRTMPD
  1486*  NOT CONSIDERING EXTENSION DAYS.                             *  ELCRTMPD
  1487*                                                              *  ELCRTMPD
  1488****************************************************************  ELCRTMPD
  1489                                                                  ELCRTMPD
  1490 300-PROCESS-WITH-CERT-EFF-DATE.                                  ELCRTMPD
  1491                                                                  ELCRTMPD
  1492****************************************************************  ELCRTMPD
  1493*                                                              *  ELCRTMPD
  1494*  COMPUTE AN EXPIRATION DATE USING THE CERTIFICATE EFFECTIVE  *  ELCRTMPD
  1495*  DATE AND ORIGINAL TERM. IF THE CANCEL DATE IS GREATER THAN  *  ELCRTMPD
  1496*  THIS ESTIMATED DATE, THEN THE TERM IS CONSIDERED TO BE FULLY*  ELCRTMPD
  1497*  EXHAUSTED.                                                  *  ELCRTMPD
  1498*                                                              *  ELCRTMPD
  1499****************************************************************  ELCRTMPD
  1500                                                                  ELCRTMPD
  1501     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELCRTMPD
  1502     MOVE CP-ORIGINAL-TERM       TO DC-ELAPSED-MONTHS.            ELCRTMPD
  1503     MOVE ZEROS                  TO DC-ELAPSED-DAYS.              ELCRTMPD
  1504     MOVE '6'                    TO DC-OPTION-CODE.               ELCRTMPD
  1505     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT.                    ELCRTMPD
  1506                                                                  ELCRTMPD
  1507     IF DATE-CONVERSION-ERROR                                     ELCRTMPD
  1508        MOVE '2' TO CP-RETURN-CODE                                ELCRTMPD
  1509        GO TO 9999-RT-REMAINING-TERM-XIT                          ELCRTMPD
  1510     ELSE                                                         ELCRTMPD
  1511        IF DC-BIN-DATE-2 LESS THAN CP-VALUATION-DT                ELCRTMPD
  1512            MOVE ZEROS TO CP-REMAINING-TERM-1                     ELCRTMPD
  1513                          CP-REMAINING-TERM-2                     ELCRTMPD
  1514                          CP-REMAINING-TERM-3                     ELCRTMPD
  1515            GO TO 9999-RT-REMAINING-TERM-XIT.                     ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  37
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1517****************************************************************  ELCRTMPD
  1518*                                                              *  ELCRTMPD
  1519*  COMPUTE THE ELAPSED TIME BETWEEN THE EFFECTIVE DATE         *  ELCRTMPD
  1520*  AND THE CANCEL DATE.                                        *  ELCRTMPD
  1521*                                                              *  ELCRTMPD
  1522****************************************************************  ELCRTMPD
  1523                                                                  ELCRTMPD
  1524 305-EFF-TO-VALUATION-DATE.                                       ELCRTMPD
  1525                                                                  ELCRTMPD
  1526     MOVE WS-SAVE-VALUATION-DATE TO WS-TOP-NUMBER.                ELCRTMPD
  1527     MOVE CP-VALUATION-DT        TO WS-SAVE-BINARY-DATE.          ELCRTMPD
  1528                                                                  ELCRTMPD
  1529     MOVE WS-SAVE-EFFECTIVE-DATE TO WS-BOTTOM-NUMBER.             ELCRTMPD
  1530                                                                  ELCRTMPD
  1531     IF VALUATION-DATE-EOM AND EFFECTIVE-DATE-EOM                 ELCRTMPD
  1532         MOVE ZEROS              TO WS-TOP-DA                     ELCRTMPD
  1533                                    WS-BOTTOM-DA.                 ELCRTMPD
  1534                                                                  ELCRTMPD
  1535     PERFORM 500-SIMPLE-ARITHMETIC THRU 500-EXIT.                 ELCRTMPD
  1536                                                                  ELCRTMPD
  1537     COMPUTE CP-REMAINING-TERM-1 = CP-ORIGINAL-TERM -             ELCRTMPD
  1538                            TERM-IN-MONTHS.                       ELCRTMPD
  1539                                                                  ELCRTMPD
  1540     MOVE WS-RESULT-DA           TO CP-ODD-DAYS.                  ELCRTMPD
  1541                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  38
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1543****************************************************************  ELCRTMPD
  1544* IF THIS TERM IS NEGATIVE, THE TERM IS CONSIDERED TO BE       *  ELCRTMPD
  1545*  EXPIRED AND ALL PREMIUM IS EARNED.                          *  ELCRTMPD
  1546****************************************************************  ELCRTMPD
  1547     IF CP-REMAINING-TERM-1 NEGATIVE                              ELCRTMPD
  1548        MOVE ZERO                TO CP-REMAINING-TERM-1           ELCRTMPD
  1549                                    CP-REMAINING-TERM-2           ELCRTMPD
  1550                                    CP-REMAINING-TERM-3           ELCRTMPD
  1551                                    CP-ODD-DAYS                   ELCRTMPD
  1552        GO TO 9999-RT-REMAINING-TERM-XIT.                         ELCRTMPD
  1553                                                                  ELCRTMPD
  1554     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2           ELCRTMPD
  1555                                    CP-REMAINING-TERM-3.          ELCRTMPD
  1556                                                                  ELCRTMPD
  1557     IF CP-EARN-AS-REG-BALLOON                                    ELCRTMPD
  1558        IF CP-BALLOON-LAST-PMT                                    ELCRTMPD
  1559           ADD +1 TO CP-REMAINING-TERM-3.                         ELCRTMPD
  1560                                                                  ELCRTMPD
  1561     IF CP-EARN-AFTER-15TH                                        ELCRTMPD
  1562        GO TO 410-METHOD-1.                                       ELCRTMPD
  1563     IF CP-EARN-ON-HALF-MONTH                                     ELCRTMPD
  1564        GO TO 420-METHOD-2.                                       ELCRTMPD
  1565     IF CP-EARN-ON-1ST-DAY                                        ELCRTMPD
  1566        GO TO 430-METHOD-3.                                       ELCRTMPD
  1567     IF CP-EARN-ON-FULL-MONTH                                     ELCRTMPD
  1568        GO TO 440-METHOD-4.                                       ELCRTMPD
  1569     IF CP-EARN-WITH-NO-DAYS                                      ELCRTMPD
  1570        GO TO 450-METHOD-5.                                       ELCRTMPD
  1571     IF CP-EARN-AFTER-14TH                                        ELCRTMPD
  1572        GO TO 460-METHOD-6.                                       ELCRTMPD
  1573     IF CP-EARN-AFTER-16TH                                        ELCRTMPD
  1574        GO TO 470-METHOD-7.                                       ELCRTMPD
  1575                                                                  ELCRTMPD
  1576                                                                  ELCRTMPD
  1577****************************************************************  ELCRTMPD
  1578*                                                              *  ELCRTMPD
  1579*   IF NONE OF THE ABOVE OPTIONS HAVE BEEN SPECIFIED, THEN     *  ELCRTMPD
  1580*   INDICATE THERE WAS AN ERROR IN THE OPTION SELECTION AND    *  ELCRTMPD
  1581*   EXIT FROM THE ROUTINE.                                     *  ELCRTMPD
  1582*                                                              *  ELCRTMPD
  1583****************************************************************  ELCRTMPD
  1584                                                                  ELCRTMPD
  1585     MOVE '3' TO CP-RETURN-CODE                                   ELCRTMPD
  1586     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  1587                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  39
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1589****************************************************************  ELCRTMPD
  1590*                                                              *  ELCRTMPD
  1591*                       NUMBER OF DAYS                         *  ELCRTMPD
  1592*         POLICY MUST BE INFORCE FOR 15 DAYS TO EARN A MONTH   *  ELCRTMPD
  1593*                                                              *  ELCRTMPD
  1594****************************************************************  ELCRTMPD
  1595                                                                  ELCRTMPD
  1596 410-METHOD-1.                                                    ELCRTMPD
  1597                                                                  ELCRTMPD
  1598                                                                  ELCRTMPD
  1599     IF WS-RESULT-DA     GREATER THAN +15                         ELCRTMPD
  1600         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1601                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  1602                                                                  ELCRTMPD
  1603     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  1604                                                                  ELCRTMPD
  1605                                                                  ELCRTMPD
  1606****************************************************************  ELCRTMPD
  1607*                                                              *  ELCRTMPD
  1608*                       HALF MONTH ADJUSTMENT                  *  ELCRTMPD
  1609*            PREMIUM EARNS ON 1/2 MONTH MORE ASSUMPTION        *  ELCRTMPD
  1610*                                                              *  ELCRTMPD
  1611****************************************************************  ELCRTMPD
  1612                                                                  ELCRTMPD
  1613 420-METHOD-2.                                                    ELCRTMPD
  1614                                                                  ELCRTMPD
  1615     IF CP-REMAINING-TERM-1 NOT = ZERO                            ELCRTMPD
  1616         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1617                             CP-REMAINING-TERM-1 - (+.5).         ELCRTMPD
  1618                                                                  ELCRTMPD
  1619     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  1620                                                                  ELCRTMPD
  1621*     NO ADJUSTMENT TO CP-REMAINING-TERM-3 FOR DAYS - TYPE 2.     ELCRTMPD
  1622                                                                  ELCRTMPD
  1623                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  40
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1625****************************************************************  ELCRTMPD
  1626*                                                              *  ELCRTMPD
  1627*                       FIRST DAY METHOD                       *  ELCRTMPD
  1628*                  PREMIUM EARNS ON FIRST DAY                  *  ELCRTMPD
  1629*                                                              *  ELCRTMPD
  1630****************************************************************  ELCRTMPD
  1631                                                                  ELCRTMPD
  1632 430-METHOD-3.                                                    ELCRTMPD
  1633                                                                  ELCRTMPD
  1634     IF WS-RESULT-DA     GREATER THAN +0                          ELCRTMPD
  1635         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1636                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  1637                                                                  ELCRTMPD
  1638     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  1639                                                                  ELCRTMPD
  1640                                                                  ELCRTMPD
  1641****************************************************************  ELCRTMPD
  1642*                                                              *  ELCRTMPD
  1643*                       FULL MONTH METHOD                      *  ELCRTMPD
  1644*          PREMIUM EARNS ON FULL MONTH - SAME AS BENEFIT       *  ELCRTMPD
  1645*                                                              *  ELCRTMPD
  1646****************************************************************  ELCRTMPD
  1647                                                                  ELCRTMPD
  1648 440-METHOD-4.                                                    ELCRTMPD
  1649                                                                  ELCRTMPD
  1650*  NO ADJUSTMENT FOR CP-REMAINING-TERM-1 - TYPE 4.                ELCRTMPD
  1651                                                                  ELCRTMPD
  1652                                                                  ELCRTMPD
  1653     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  1654                                                                  ELCRTMPD
  1655                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  41
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1657****************************************************************  ELCRTMPD
  1658*                                                              *  ELCRTMPD
  1659*                       FULL MONTH - NO DAYS                   *  ELCRTMPD
  1660*          PREMIUM EARNS A FULL MONTH STARTING THE FIRST MONTH *  ELCRTMPD
  1661*       (THIS METHOD WILL EARN WITHOUT A FLUCTUATION IN SHORT  *  ELCRTMPD
  1662*        MONTHS )                                              *  ELCRTMPD
  1663****************************************************************  ELCRTMPD
  1664                                                                  ELCRTMPD
  1665 450-METHOD-5.                                                    ELCRTMPD
  1666                                                                  ELCRTMPD
  1667                                                                  ELCRTMPD
  1668     IF CP-REMAINING-TERM-1 NOT = ZERO                            ELCRTMPD
  1669         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1670                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  1671                                                                  ELCRTMPD
  1672     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  1673                                                                  ELCRTMPD
  1674****************************************************************  ELCRTMPD
  1675*                                                              *  ELCRTMPD
  1676*                       NUMBER OF DAYS                         *  ELCRTMPD
  1677*         POLICY MUST BE INFORCE FOR 14 DAYS TO EARN A MONTH   *  ELCRTMPD
  1678*                                                              *  ELCRTMPD
  1679****************************************************************  ELCRTMPD
  1680                                                                  ELCRTMPD
  1681 460-METHOD-6.                                                    ELCRTMPD
  1682                                                                  ELCRTMPD
  1683                                                                  ELCRTMPD
  1684     IF WS-RESULT-DA     GREATER THAN +14                         ELCRTMPD
  1685         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1686                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  1687                                                                  ELCRTMPD
  1688     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  1689                                                                  ELCRTMPD
  1690****************************************************************  ELCRTMPD
  1691*                                                              *  ELCRTMPD
  1692*                       NUMBER OF DAYS                         *  ELCRTMPD
  1693*     POLICY MUST BE INFORCE FOR 16 DAYS TO EARN A MONTH       *  ELCRTMPD
  1694*                                                              *  ELCRTMPD
  1695****************************************************************  ELCRTMPD
  1696                                                                  ELCRTMPD
  1697 470-METHOD-7.                                                    ELCRTMPD
  1698                                                                  ELCRTMPD
  1699                                                                  ELCRTMPD
  1700     IF WS-RESULT-DA     GREATER THAN +16                         ELCRTMPD
  1701         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1702                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  1703                                                                  ELCRTMPD
  1704     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  1705                                                                  ELCRTMPD
  1706****************************************************************  ELCRTMPD
  1707*                                                              *  ELCRTMPD
  1708*                                                              *  ELCRTMPD
  1709*                                                              *  ELCRTMPD
  1710*                                                              *  ELCRTMPD
  1711*                                                              *  ELCRTMPD
  1712****************************************************************  ELCRTMPD
  1713                                                                  ELCRTMPD
  1714 500-SIMPLE-ARITHMETIC.                                           ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  42
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1715                                                                  ELCRTMPD
  1716 500-BORROW-IF-LESS.                                              ELCRTMPD
  1717     IF WS-TOP-DA NOT LESS THAN WS-BOTTOM-DA                      ELCRTMPD
  1718        GO TO 500-CHECK-MONTH.                                    ELCRTMPD
  1719                                                                  ELCRTMPD
  1720* BORROW BASED ON 30 DAY MONTH                                    ELCRTMPD
  1721                                                                  ELCRTMPD
  1722     IF CP-30-DAY-MONTH                                           ELCRTMPD
  1723         COMPUTE WS-TOP-DA = WS-TOP-DA + 30                       ELCRTMPD
  1724     ELSE                                                         ELCRTMPD
  1725         MOVE WS-SAVE-BINARY-DATE    TO DC-BIN-DATE-1             ELCRTMPD
  1726         MOVE -1                     TO DC-ELAPSED-MONTHS         ELCRTMPD
  1727         MOVE '1'                    TO DC-END-OF-MONTH           ELCRTMPD
  1728         MOVE ZERO                   TO DC-ELAPSED-DAYS           ELCRTMPD
  1729         MOVE '6'                    TO DC-OPTION-CODE            ELCRTMPD
  1730         PERFORM 8000-DATE-CONVERT THRU 8000-EXIT                 ELCRTMPD
  1731         IF DATE-CONVERSION-ERROR                                 ELCRTMPD
  1732             MOVE '2'                TO CP-RETURN-CODE            ELCRTMPD
  1733             GO TO 500-EXIT                                       ELCRTMPD
  1734         ELSE                                                     ELCRTMPD
  1735             COMPUTE WS-TOP-DA = WS-TOP-DA + DC-DAYS-IN-MONTH.    ELCRTMPD
  1736                                                                  ELCRTMPD
  1737     COMPUTE WS-TOP-MO = WS-TOP-MO - 1.                           ELCRTMPD
  1738                                                                  ELCRTMPD
  1739     IF WS-TOP-MO EQUAL 0                                         ELCRTMPD
  1740        COMPUTE WS-TOP-CCYR = WS-TOP-CCYR - 1                        CL**2
  1741        MOVE 12             TO WS-TOP-MO.                         ELCRTMPD
  1742                                                                  ELCRTMPD
  1743 500-CHECK-MONTH.                                                 ELCRTMPD
  1744     IF WS-TOP-MO NOT LESS THAN WS-BOTTOM-MO                      ELCRTMPD
  1745        GO TO 500-SUBTRACT.                                       ELCRTMPD
  1746                                                                  ELCRTMPD
  1747     COMPUTE WS-TOP-CCYR = WS-TOP-CCYR - 1.                          CL**2
  1748                                                                     CL**2
  1749     COMPUTE WS-TOP-MO = WS-TOP-MO + 12.                          ELCRTMPD
  1750                                                                  ELCRTMPD
  1751 500-SUBTRACT.                                                    ELCRTMPD
  1752                                                                  ELCRTMPD
  1753     COMPUTE WS-RESULT-CCYR = WS-TOP-CCYR - WS-BOTTOM-CCYR.          CL**2
  1754                                                                  ELCRTMPD
  1755     COMPUTE WS-RESULT-MO = WS-TOP-MO - WS-BOTTOM-MO.             ELCRTMPD
  1756     IF WS-RESULT-CCYR GREATER THAN ZERO                             CL**3
  1757        COMPUTE TERM-IN-MONTHS = WS-RESULT-MO +                   ELCRTMPD
  1758                      (WS-RESULT-CCYR * 12)                          CL**3
  1759     ELSE                                                         ELCRTMPD
  1760        MOVE WS-RESULT-MO          TO TERM-IN-MONTHS.             ELCRTMPD
  1761                                                                  ELCRTMPD
  1762     COMPUTE WS-RESULT-DA = WS-TOP-DA - WS-BOTTOM-DA.             ELCRTMPD
  1763                                                                  ELCRTMPD
  1764*    IF CP-30-DAY-MONTH                                           ELCRTMPD
  1765*       AND WS-RESULT-DA EQUAL 30                                 ELCRTMPD
  1766*         COMPUTE WS-RESULT-MO = WS-RESULT-MO + 1                 ELCRTMPD
  1767*         MOVE 0                   TO WS-RESULT-DA.               ELCRTMPD
  1768                                                                  ELCRTMPD
  1769                                                                  ELCRTMPD
  1770 500-EXIT.                                                        ELCRTMPD
  1771     EXIT.                                                        ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  43
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1773****************************************************************  ELCRTMPD
  1774 600-PROCESS-FOR-NCL.                                             ELCRTMPD
  1775****************************************************************  ELCRTMPD
  1776*                                                              *  ELCRTMPD
  1777*  COMPUTE AN EXPIRATION DATE USING THE 1ST PAYMENT DATE  AND  *  ELCRTMPD
  1778*  THE (REMAINING TERM - 1). IF THE VALUATION DATE IS GREATER  *  ELCRTMPD
  1779*  THAN THIS ESTIMATED DATE, THEN THE TERM IS CONSIDERED TO    *  ELCRTMPD
  1780*  BE FULLY EXPIRED.                                           *  ELCRTMPD
  1781*                                                              *  ELCRTMPD
  1782****************************************************************  ELCRTMPD
  1783                                                                  ELCRTMPD
  1784     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-1.                ELCRTMPD
  1785                                                                  ELCRTMPD
  1786     COMPUTE DC-ELAPSED-MONTHS EQUAL                              ELCRTMPD
  1787         (CP-ORIGINAL-TERM - +1).                                 ELCRTMPD
  1788                                                                  ELCRTMPD
  1789     MOVE ZEROS                  TO DC-ELAPSED-DAYS.              ELCRTMPD
  1790     MOVE '6'                    TO DC-OPTION-CODE.               ELCRTMPD
  1791     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT.                    ELCRTMPD
  1792                                                                  ELCRTMPD
  1793     IF DATE-CONVERSION-ERROR                                     ELCRTMPD
  1794        MOVE '2' TO CP-RETURN-CODE                                ELCRTMPD
  1795        GO TO 9999-RT-REMAINING-TERM-XIT                          ELCRTMPD
  1796     ELSE                                                         ELCRTMPD
  1797        IF DC-BIN-DATE-2 NOT GREATER CP-VALUATION-DT              ELCRTMPD
  1798            MOVE ZEROS TO CP-REMAINING-TERM-1                     ELCRTMPD
  1799                          CP-REMAINING-TERM-2                     ELCRTMPD
  1800                          CP-REMAINING-TERM-3                     ELCRTMPD
  1801            GO TO 9999-RT-REMAINING-TERM-XIT.                     ELCRTMPD
  1802                                                                  ELCRTMPD
  1803     MOVE DC-BIN-DATE-2          TO WS-SAVE-BINARY-DATE.          ELCRTMPD
  1804     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.                ELCRTMPD
  1805     MOVE ' '                    TO DC-OPTION-CODE.               ELCRTMPD
  1806     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT                     ELCRTMPD
  1807     IF DATE-CONVERSION-ERROR                                     ELCRTMPD
  1808         MOVE '2'                TO CP-RETURN-CODE                ELCRTMPD
  1809         GO TO 9999-RT-REMAINING-TERM-XIT.                        ELCRTMPD
  1810                                                                  ELCRTMPD
  1811     MOVE DC-GREG-DATE-CYMD      TO WS-SAVE-EXPIRATION-DATE.         CL**2
  1812     IF SAVE-EXP-DAYS EQUAL DC-DAYS-IN-MONTH                      ELCRTMPD
  1813         MOVE 'Y'                TO EXPIRATION-EOM.               ELCRTMPD
  1814****************************************************************  ELCRTMPD
  1815*                                                              *  ELCRTMPD
  1816*  COMPUTE THE ELAPSED TIME BETWEEN THE CANCEL DATE AND        *  ELCRTMPD
  1817*  EXPIRATION (MATURITY DATE). THIS WILL BE THE REMAINING      *  ELCRTMPD
  1818*  TERM.                                                       *  ELCRTMPD
  1819****************************************************************  ELCRTMPD
  1820                                                                  ELCRTMPD
  1821     MOVE WS-SAVE-EXPIRATION-DATE TO WS-TOP-NUMBER.               ELCRTMPD
  1822     MOVE DC-BIN-DATE-2          TO WS-SAVE-BINARY-DATE.          ELCRTMPD
  1823                                                                  ELCRTMPD
  1824     MOVE WS-SAVE-VALUATION-DATE TO WS-BOTTOM-NUMBER.             ELCRTMPD
  1825                                                                  ELCRTMPD
  1826     IF VALUATION-DATE-EOM AND EXPIRATION-DATE-EOM                ELCRTMPD
  1827         MOVE ZEROS              TO WS-TOP-DA                     ELCRTMPD
  1828                                    WS-BOTTOM-DA.                 ELCRTMPD
  1829                                                                  ELCRTMPD
  1830     PERFORM 500-SIMPLE-ARITHMETIC THRU 500-EXIT.                 ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  44
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1831                                                                  ELCRTMPD
  1832     MOVE TERM-IN-MONTHS         TO CP-REMAINING-TERM-1           ELCRTMPD
  1833                                                                  ELCRTMPD
  1834     MOVE WS-RESULT-DA           TO CP-ODD-DAYS.                  ELCRTMPD
  1835                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  45
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1837****************************************************************  ELCRTMPD
  1838* IF THIS TERM IS NEGATIVE, THE TERM IS CONSIDERED TO BE       *  ELCRTMPD
  1839*  EXPIRED AND ALL PREMIUM IS EARNED.                          *  ELCRTMPD
  1840****************************************************************  ELCRTMPD
  1841     IF CP-REMAINING-TERM-1 NEGATIVE                              ELCRTMPD
  1842        MOVE ZERO                TO CP-REMAINING-TERM-1           ELCRTMPD
  1843                                    CP-REMAINING-TERM-2           ELCRTMPD
  1844                                    CP-REMAINING-TERM-3           ELCRTMPD
  1845                                    CP-ODD-DAYS                   ELCRTMPD
  1846        GO TO 9999-RT-REMAINING-TERM-XIT.                         ELCRTMPD
  1847                                                                  ELCRTMPD
  1848     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2           ELCRTMPD
  1849                                    CP-REMAINING-TERM-3.          ELCRTMPD
  1850                                                                  ELCRTMPD
  1851     IF CP-ODD-DAYS GREATER THAN ZERO                             ELCRTMPD
  1852        ADD +1                   TO CP-REMAINING-TERM-2           ELCRTMPD
  1853        ADD +1                   TO CP-REMAINING-TERM-3.          ELCRTMPD
  1854                                                                  ELCRTMPD
  1855     IF CP-EARN-AS-REG-BALLOON                                    ELCRTMPD
  1856        IF CP-BALLOON-LAST-PMT                                    ELCRTMPD
  1857           ADD +1 TO CP-REMAINING-TERM-3.                         ELCRTMPD
  1858                                                                  ELCRTMPD
  1859     IF CP-EARN-AFTER-15TH                                        ELCRTMPD
  1860        GO TO 610-METHOD-1.                                       ELCRTMPD
  1861     IF CP-EARN-ON-HALF-MONTH                                     ELCRTMPD
  1862        GO TO 620-METHOD-2.                                       ELCRTMPD
  1863     IF CP-EARN-ON-1ST-DAY                                        ELCRTMPD
  1864        GO TO 630-METHOD-3.                                       ELCRTMPD
  1865     IF CP-EARN-ON-FULL-MONTH                                     ELCRTMPD
  1866        GO TO 640-METHOD-4.                                       ELCRTMPD
  1867     IF CP-EARN-WITH-NO-DAYS                                      ELCRTMPD
  1868        GO TO 650-METHOD-5.                                       ELCRTMPD
  1869     IF CP-EARN-AFTER-14TH                                        ELCRTMPD
  1870        GO TO 660-METHOD-6.                                       ELCRTMPD
  1871     IF CP-EARN-AFTER-16TH                                        ELCRTMPD
  1872        GO TO 670-METHOD-7.                                       ELCRTMPD
  1873****************************************************************  ELCRTMPD
  1874*                                                              *  ELCRTMPD
  1875*   IF NONE OF THE ABOVE OPTIONS HAVE BEEN SPECIFIED, THEN     *  ELCRTMPD
  1876*   INDICATE THERE WAS AN ERROR IN THE OPTION SELECTION AND    *  ELCRTMPD
  1877*   EXIT FROM THE ROUTINE.                                     *  ELCRTMPD
  1878*                                                              *  ELCRTMPD
  1879****************************************************************  ELCRTMPD
  1880                                                                  ELCRTMPD
  1881                                                                  ELCRTMPD
  1882     MOVE '3' TO CP-RETURN-CODE                                   ELCRTMPD
  1883     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  1884                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  46
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1886                                                                  ELCRTMPD
  1887****************************************************************  ELCRTMPD
  1888*                                                              *  ELCRTMPD
  1889*                       NUMBER OF DAYS                         *  ELCRTMPD
  1890*         POLICY MUST BE INFORCE FOR 15 DAYS TO EARN A MONTH   *  ELCRTMPD
  1891*                                                              *  ELCRTMPD
  1892****************************************************************  ELCRTMPD
  1893                                                                  ELCRTMPD
  1894 610-METHOD-1.                                                    ELCRTMPD
  1895                                                                  ELCRTMPD
  1896     IF WS-RESULT-DA     GREATER THAN +14                         ELCRTMPD
  1897         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1898                             CP-REMAINING-TERM-1 + (+1).          ELCRTMPD
  1899                                                                  ELCRTMPD
  1900     GO TO 680-END-NCL-PROCESSING.                                ELCRTMPD
  1901                                                                  ELCRTMPD
  1902                                                                  ELCRTMPD
  1903****************************************************************  ELCRTMPD
  1904*                                                              *  ELCRTMPD
  1905*                       HALF MONTH ADJUSTMENT                  *  ELCRTMPD
  1906*            PREMIUM EARNS ON 1/2 MONTH MORE ASSUMPTION        *  ELCRTMPD
  1907*                                                              *  ELCRTMPD
  1908****************************************************************  ELCRTMPD
  1909                                                                  ELCRTMPD
  1910 620-METHOD-2.                                                    ELCRTMPD
  1911                                                                  ELCRTMPD
  1912     COMPUTE CP-REMAINING-TERM-1 =                                ELCRTMPD
  1913                             CP-REMAINING-TERM-1 + (+.5).         ELCRTMPD
  1914                                                                  ELCRTMPD
  1915     GO TO 680-END-NCL-PROCESSING.                                ELCRTMPD
  1916                                                                  ELCRTMPD
  1917                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  47
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1919****************************************************************  ELCRTMPD
  1920*                                                              *  ELCRTMPD
  1921*                       FIRST DAY METHOD                       *  ELCRTMPD
  1922*                  PREMIUM EARNS ON FIRST DAY                  *  ELCRTMPD
  1923*                                                              *  ELCRTMPD
  1924****************************************************************  ELCRTMPD
  1925                                                                  ELCRTMPD
  1926 630-METHOD-3.                                                    ELCRTMPD
  1927                                                                  ELCRTMPD
  1928*  NO ADJUSTMENT FOR CP-REMAINING-TERM-1 - TYPE 3 FOR NCL.        ELCRTMPD
  1929                                                                  ELCRTMPD
  1930     GO TO 680-END-NCL-PROCESSING.                                ELCRTMPD
  1931                                                                  ELCRTMPD
  1932                                                                  ELCRTMPD
  1933****************************************************************  ELCRTMPD
  1934*                                                              *  ELCRTMPD
  1935*                       FULL MONTH METHOD                      *  ELCRTMPD
  1936*          PREMIUM EARNS ON FULL MONTH - SAME AS BENEFIT       *  ELCRTMPD
  1937*                                                              *  ELCRTMPD
  1938****************************************************************  ELCRTMPD
  1939                                                                  ELCRTMPD
  1940 640-METHOD-4.                                                    ELCRTMPD
  1941                                                                  ELCRTMPD
  1942     MOVE CP-REMAINING-TERM-2       TO CP-REMAINING-TERM-1.       ELCRTMPD
  1943     MOVE 0                         TO CP-ODD-DAYS.               ELCRTMPD
  1944                                                                  ELCRTMPD
  1945     GO TO 680-END-NCL-PROCESSING.                                ELCRTMPD
  1946                                                                  ELCRTMPD
  1947                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  48
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  1949****************************************************************  ELCRTMPD
  1950*                                                              *  ELCRTMPD
  1951*                       FULL MONTH - NO DAYS                   *  ELCRTMPD
  1952*          PREMIUM EARNS A FULL MONTH STARTING THE FIRST MONTH *  ELCRTMPD
  1953*       (THIS METHOD WILL EARN WITHOUT A FLUCTUATION IN SHORT  *  ELCRTMPD
  1954*        MONTHS )                                              *  ELCRTMPD
  1955****************************************************************  ELCRTMPD
  1956                                                                  ELCRTMPD
  1957 650-METHOD-5.                                                    ELCRTMPD
  1958                                                                  ELCRTMPD
  1959                                                                  ELCRTMPD
  1960*  NO ADJUSTMENT FOR CP-REMAINING-TERM-1 - TYPE 5 FOR NCL.        ELCRTMPD
  1961                                                                  ELCRTMPD
  1962     GO TO 680-END-NCL-PROCESSING.                                ELCRTMPD
  1963                                                                  ELCRTMPD
  1964                                                                  ELCRTMPD
  1965****************************************************************  ELCRTMPD
  1966*                                                              *  ELCRTMPD
  1967*                       NUMBER OF DAYS                         *  ELCRTMPD
  1968*         POLICY MUST BE INFORCE FOR 14 DAYS TO EARN A MONTH   *  ELCRTMPD
  1969*                                                              *  ELCRTMPD
  1970****************************************************************  ELCRTMPD
  1971                                                                  ELCRTMPD
  1972 660-METHOD-6.                                                    ELCRTMPD
  1973                                                                  ELCRTMPD
  1974                                                                  ELCRTMPD
  1975     IF WS-RESULT-DA     GREATER THAN +13                         ELCRTMPD
  1976         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1977                             CP-REMAINING-TERM-1 + (+1).          ELCRTMPD
  1978                                                                  ELCRTMPD
  1979     GO TO 680-END-NCL-PROCESSING.                                ELCRTMPD
  1980                                                                  ELCRTMPD
  1981                                                                  ELCRTMPD
  1982****************************************************************  ELCRTMPD
  1983*                                                              *  ELCRTMPD
  1984*                       NUMBER OF DAYS                         *  ELCRTMPD
  1985*     POLICY MUST BE INFORCE FOR 16 DAYS TO EARN A MONTH       *  ELCRTMPD
  1986*                                                              *  ELCRTMPD
  1987****************************************************************  ELCRTMPD
  1988                                                                  ELCRTMPD
  1989 670-METHOD-7.                                                    ELCRTMPD
  1990                                                                  ELCRTMPD
  1991     IF WS-RESULT-DA     GREATER THAN +15                         ELCRTMPD
  1992         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  1993                             CP-REMAINING-TERM-1 + (+1).          ELCRTMPD
  1994                                                                  ELCRTMPD
  1995     GO TO 680-END-NCL-PROCESSING.                                ELCRTMPD
  1996                                                                  ELCRTMPD
  1997                                                                  ELCRTMPD
  1998 680-END-NCL-PROCESSING.                                          ELCRTMPD
  1999                                                                  ELCRTMPD
  2000     IF CP-REMAINING-TERM-1 > CP-ORIGINAL-TERM                    ELCRTMPD
  2001        MOVE CP-ORIGINAL-TERM    TO CP-REMAINING-TERM-1           ELCRTMPD
  2002                                    CP-REMAINING-TERM-2           ELCRTMPD
  2003                                    CP-REMAINING-TERM-3           ELCRTMPD
  2004        MOVE ZEROS               TO CP-ODD-DAYS.                  ELCRTMPD
  2005                                                                  ELCRTMPD
  2006     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  49
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  2007                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  50
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  2009                                                                  ELCRTMPD
  2010 1000-CONTROL-CALCULATION.                                        ELCRTMPD
  2011                                                                  ELCRTMPD
  2012     IF CP-VALUATION-DT NOT LESS THAN CP-FIRST-PAY-DATE           ELCRTMPD
  2013         GO TO 2000-PROCESS-WITH-1ST-PMT-DATE.                    ELCRTMPD
  2014                                                                  ELCRTMPD
  2015                                                                     CL**5
  2016****************************************************************  ELCRTMPD
  2017*                                                              *  ELCRTMPD
  2018*  ORIGINAL                                                    *  ELCRTMPD
  2019*   PROCESSING WHEN VALUATION DATE LESS THAN 1ST PAYMENT DATE  *  ELCRTMPD
  2020*                                                              *  ELCRTMPD
  2021****************************************************************  ELCRTMPD
  2022                                                                  ELCRTMPD
  2023                                                                  ELCRTMPD
  2024 1000-PROCESS-WITH-CERT-EFF-DT.                                   ELCRTMPD
  2025                                                                  ELCRTMPD
  2026     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELCRTMPD
  2027     MOVE CP-VALUATION-DT        TO DC-BIN-DATE-2.                ELCRTMPD
  2028     MOVE '1'                    TO DC-OPTION-CODE.               ELCRTMPD
  2029     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT                     ELCRTMPD
  2030     IF DATE-CONVERSION-ERROR                                     ELCRTMPD
  2031         MOVE '2'                TO CP-RETURN-CODE                ELCRTMPD
  2032         GO TO 9999-RT-REMAINING-TERM-XIT.                        ELCRTMPD
  2033                                                                  ELCRTMPD
  2034     IF CP-EARN-AFTER-15TH                                        ELCRTMPD
  2035        GO TO 1110-METHOD-1.                                      ELCRTMPD
  2036     IF CP-EARN-ON-HALF-MONTH                                     ELCRTMPD
  2037        GO TO 1200-METHOD-2.                                      ELCRTMPD
  2038     IF CP-EARN-ON-1ST-DAY                                        ELCRTMPD
  2039        GO TO 1300-METHOD-3.                                      ELCRTMPD
  2040     IF CP-EARN-ON-FULL-MONTH                                     ELCRTMPD
  2041        GO TO 1400-METHOD-4.                                      ELCRTMPD
  2042     IF CP-EARN-WITH-NO-DAYS                                      ELCRTMPD
  2043        GO TO 1500-METHOD-5.                                      ELCRTMPD
  2044                                                                  ELCRTMPD
  2045     IF CP-EARN-AFTER-14TH                                        ELCRTMPD
  2046        GO TO 1600-METHOD-6.                                      ELCRTMPD
  2047     IF CP-EARN-AFTER-16TH                                        ELCRTMPD
  2048        GO TO 1700-METHOD-7.                                      ELCRTMPD
  2049                                                                  ELCRTMPD
  2050     MOVE '3' TO CP-RETURN-CODE                                   ELCRTMPD
  2051     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  2052                                                                  ELCRTMPD
  2053 1110-METHOD-1.                                                   ELCRTMPD
  2054                                                                  ELCRTMPD
  2055****************************************************************  ELCRTMPD
  2056*                                                              *  ELCRTMPD
  2057*  ORIGINAL                                                    *  ELCRTMPD
  2058*                       NUMBER OF DAYS                         *  ELCRTMPD
  2059*         POLICY MUST BE INFORCE FOR 15 DAYS TO EARN A MONTH   *  ELCRTMPD
  2060*                                                              *  ELCRTMPD
  2061****************************************************************  ELCRTMPD
  2062                                                                  ELCRTMPD
  2063                                                                  ELCRTMPD
  2064     IF DC-ODD-DAYS-OVER GREATER THAN +15  OR                     ELCRTMPD
  2065        DC-ELAPSED-MONTHS GREATER THAN +0                         ELCRTMPD
  2066         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  51
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  2067                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  2068                                                                  ELCRTMPD
  2069                                                                  ELCRTMPD
  2070     GO TO 1999-END-CERT-DATE-PROCESSING.                         ELCRTMPD
  2071                                                                  ELCRTMPD
  2072 1200-METHOD-2.                                                   ELCRTMPD
  2073                                                                  ELCRTMPD
  2074****************************************************************  ELCRTMPD
  2075*                                                              *  ELCRTMPD
  2076*  ORIGINAL                                                    *  ELCRTMPD
  2077*                       HALF MONTH ADJUSTMENT                  *  ELCRTMPD
  2078*            PREMIUM EARNS ON 1/2 MONTH MORE ASSUMPTION        *  ELCRTMPD
  2079*                                                              *  ELCRTMPD
  2080****************************************************************  ELCRTMPD
  2081                                                                  ELCRTMPD
  2082     IF DC-ELAPSED-MONTHS GREATER THAN +0                         ELCRTMPD
  2083         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  2084                       CP-REMAINING-TERM-1 - (+1.5)               ELCRTMPD
  2085     ELSE                                                         ELCRTMPD
  2086         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  2087                       CP-REMAINING-TERM-1 - (+.5).               ELCRTMPD
  2088                                                                  ELCRTMPD
  2089     IF CP-REMAINING-TERM-1 NEGATIVE                              ELCRTMPD
  2090         MOVE ZEROS                 TO CP-REMAINING-TERM-1.       ELCRTMPD
  2091                                                                  ELCRTMPD
  2092                                                                  ELCRTMPD
  2093     GO TO 1999-END-CERT-DATE-PROCESSING.                         ELCRTMPD
  2094                                                                  ELCRTMPD
  2095                                                                  ELCRTMPD
  2096 1300-METHOD-3.                                                   ELCRTMPD
  2097                                                                  ELCRTMPD
  2098****************************************************************  ELCRTMPD
  2099*                                                              *  ELCRTMPD
  2100*  ORIGINAL                                                    *  ELCRTMPD
  2101*                       FIRST DAY METHOD                       *  ELCRTMPD
  2102*                  PREMIUM EARNS ON FIRST DAY                  *  ELCRTMPD
  2103*                                                              *  ELCRTMPD
  2104****************************************************************  ELCRTMPD
  2105                                                                  ELCRTMPD
  2106     IF DC-ODD-DAYS-OVER GREATER THAN +0  OR                      ELCRTMPD
  2107        DC-ELAPSED-MONTHS GREATER THAN +0                         ELCRTMPD
  2108         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  2109                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  2110                                                                  ELCRTMPD
  2111     GO TO 1999-END-CERT-DATE-PROCESSING.                         ELCRTMPD
  2112                                                                  ELCRTMPD
  2113 1400-METHOD-4.                                                   ELCRTMPD
  2114                                                                  ELCRTMPD
  2115****************************************************************  ELCRTMPD
  2116*                                                              *  ELCRTMPD
  2117*  ORIGINAL                                                    *  ELCRTMPD
  2118*                       FULL MONTH METHOD                      *  ELCRTMPD
  2119*          PREMIUM EARNS ON FULL MONTH - SAME AS BENEFIT       *  ELCRTMPD
  2120*                                                              *  ELCRTMPD
  2121****************************************************************  ELCRTMPD
  2122                                                                  ELCRTMPD
  2123                                                                  ELCRTMPD
  2124*    WILL NOT REDUCE REMAINING TERM ON 'FULL' MONTH UNTIL         ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  52
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  2125*        PAST THE FIRST PAYMENT DATE.                             ELCRTMPD
  2126                                                                  ELCRTMPD
  2127     GO TO 1999-END-CERT-DATE-PROCESSING.                         ELCRTMPD
  2128                                                                  ELCRTMPD
  2129                                                                  ELCRTMPD
  2130 1500-METHOD-5.                                                   ELCRTMPD
  2131                                                                  ELCRTMPD
  2132****************************************************************  ELCRTMPD
  2133*                                                              *  ELCRTMPD
  2134*  ORIGINAL                                                    *  ELCRTMPD
  2135*                       FULL MONTH - NO DAYS                   *  ELCRTMPD
  2136*          PREMIUM EARNS A FULL MONTH STARTING THE FIRST MONTH *  ELCRTMPD
  2137*       (THIS METHOD WILL EARN WITHOUT A FLUCTUATION IN SHORT  *  ELCRTMPD
  2138*        MONTHS )                                              *  ELCRTMPD
  2139****************************************************************  ELCRTMPD
  2140                                                                  ELCRTMPD
  2141                                                                  ELCRTMPD
  2142     COMPUTE CP-REMAINING-TERM-1 =                                ELCRTMPD
  2143                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  2144                                                                  ELCRTMPD
  2145     GO TO 1999-END-CERT-DATE-PROCESSING.                         ELCRTMPD
  2146                                                                  ELCRTMPD
  2147 1600-METHOD-6.                                                   ELCRTMPD
  2148                                                                  ELCRTMPD
  2149****************************************************************  ELCRTMPD
  2150*                                                              *  ELCRTMPD
  2151*  ORIGINAL                                                    *  ELCRTMPD
  2152*                       NUMBER OF DAYS                         *  ELCRTMPD
  2153*         POLICY MUST BE INFORCE FOR 14 DAYS TO EARN A MONTH   *  ELCRTMPD
  2154*                                                              *  ELCRTMPD
  2155****************************************************************  ELCRTMPD
  2156                                                                  ELCRTMPD
  2157                                                                  ELCRTMPD
  2158     IF DC-ODD-DAYS-OVER GREATER THAN +14  OR                     ELCRTMPD
  2159        DC-ELAPSED-MONTHS GREATER THAN +0                         ELCRTMPD
  2160         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  2161                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  2162                                                                  ELCRTMPD
  2163                                                                  ELCRTMPD
  2164     GO TO 1999-END-CERT-DATE-PROCESSING.                         ELCRTMPD
  2165                                                                  ELCRTMPD
  2166 1700-METHOD-7.                                                   ELCRTMPD
  2167                                                                  ELCRTMPD
  2168****************************************************************  ELCRTMPD
  2169*                                                              *  ELCRTMPD
  2170*  ORIGINAL                                                    *  ELCRTMPD
  2171*                       NUMBER OF DAYS                         *  ELCRTMPD
  2172*         POLICY MUST BE INFORCE FOR 16 DAYS TO EARN A MONTH   *  ELCRTMPD
  2173*                                                              *  ELCRTMPD
  2174****************************************************************  ELCRTMPD
  2175                                                                  ELCRTMPD
  2176                                                                  ELCRTMPD
  2177     IF DC-ODD-DAYS-OVER GREATER THAN +16  OR                     ELCRTMPD
  2178        DC-ELAPSED-MONTHS GREATER THAN +0                         ELCRTMPD
  2179         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  2180                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  2181                                                                  ELCRTMPD
  2182                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  53
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  2183     GO TO 1999-END-CERT-DATE-PROCESSING.                         ELCRTMPD
  2184                                                                  ELCRTMPD
  2185                                                                  ELCRTMPD
  2186                                                                  ELCRTMPD
  2187 1999-END-CERT-DATE-PROCESSING.                                   ELCRTMPD
  2188                                                                  ELCRTMPD
  2189     IF CP-REMAINING-TERM-1 NEGATIVE                              ELCRTMPD
  2190        MOVE ZERO                TO CP-REMAINING-TERM-1           ELCRTMPD
  2191                                    CP-REMAINING-TERM-2           ELCRTMPD
  2192                                    CP-REMAINING-TERM-3           ELCRTMPD
  2193        GO TO 9999-RT-REMAINING-TERM-XIT.                         ELCRTMPD
  2194                                                                  ELCRTMPD
  2195     MOVE DC-ODD-DAYS-OVER       TO CP-ODD-DAYS.                  ELCRTMPD
  2196                                                                  ELCRTMPD
  2197     IF CP-EARN-AS-REG-BALLOON                                    ELCRTMPD
  2198        IF CP-BALLOON-LAST-PMT                                    ELCRTMPD
  2199           ADD +1 TO CP-REMAINING-TERM-3.                         ELCRTMPD
  2200                                                                  ELCRTMPD
  2201     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  2202                                                                  ELCRTMPD
  2203                                                                     CL**5
  2204****************************************************************  ELCRTMPD
  2205*                                                              *  ELCRTMPD
  2206*  ORIGINAL                                                    *  ELCRTMPD
  2207*  PROCESSING FOR VALUATION DATE ON OR AFTER 1ST PAYMENT DATE  *  ELCRTMPD
  2208*                                                              *  ELCRTMPD
  2209****************************************************************  ELCRTMPD
  2210                                                                  ELCRTMPD
  2211                                                                  ELCRTMPD
  2212 2000-PROCESS-WITH-1ST-PMT-DATE.                                  ELCRTMPD
  2213                                                                  ELCRTMPD
  2214     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-1                 ELCRTMPD
  2215     COMPUTE DC-ELAPSED-MONTHS EQUAL                              ELCRTMPD
  2216         (CP-ORIGINAL-TERM - +1)                                  ELCRTMPD
  2217     MOVE ZEROS                  TO DC-ELAPSED-DAYS               ELCRTMPD
  2218     MOVE '6'                    TO DC-OPTION-CODE                ELCRTMPD
  2219     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT                     ELCRTMPD
  2220                                                                  ELCRTMPD
  2221     IF DATE-CONVERSION-ERROR                                     ELCRTMPD
  2222        MOVE '2' TO CP-RETURN-CODE                                ELCRTMPD
  2223        GO TO 9999-RT-REMAINING-TERM-XIT                          ELCRTMPD
  2224     ELSE                                                         ELCRTMPD
  2225     IF DC-BIN-DATE-2 LESS THAN CP-VALUATION-DT                   ELCRTMPD
  2226        MOVE ZEROS TO CP-REMAINING-TERM-1                         ELCRTMPD
  2227                      CP-REMAINING-TERM-2                         ELCRTMPD
  2228                      CP-REMAINING-TERM-3                         ELCRTMPD
  2229        GO TO 9999-RT-REMAINING-TERM-XIT.                         ELCRTMPD
  2230                                                                  ELCRTMPD
  2231     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELCRTMPD
  2232     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.                ELCRTMPD
  2233     MOVE '1'                    TO DC-OPTION-CODE.               ELCRTMPD
  2234     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT.                    ELCRTMPD
  2235     IF DATE-CONVERSION-ERROR                                     ELCRTMPD
  2236         MOVE '2' TO CP-RETURN-CODE                               ELCRTMPD
  2237         GO TO 9999-RT-REMAINING-TERM-XIT.                        ELCRTMPD
  2238                                                                  ELCRTMPD
  2239     MOVE ZERO                   TO MONTHS-EARNED.                ELCRTMPD
  2240                                                                  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  54
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  2241     IF DC-ELAPSED-MONTHS GREATER THAN +0  OR                     ELCRTMPD
  2242        CP-EARN-WITH-NO-DAYS OR                                   ELCRTMPD
  2243        CP-EARN-ON-FULL-MONTH                                     ELCRTMPD
  2244         MOVE 1                  TO MONTHS-EARNED                 ELCRTMPD
  2245         GO TO 2050-1ST-PAY-TO-VALUATION-DATE.                    ELCRTMPD
  2246                                                                  ELCRTMPD
  2247     IF CP-EARN-ON-1ST-DAY                                        ELCRTMPD
  2248         IF DC-ODD-DAYS-OVER GREATER THAN +0                      ELCRTMPD
  2249             MOVE 1              TO MONTHS-EARNED                 ELCRTMPD
  2250             GO TO 2050-1ST-PAY-TO-VALUATION-DATE.                ELCRTMPD
  2251                                                                  ELCRTMPD
  2252     IF CP-EARN-AFTER-15TH                                        ELCRTMPD
  2253         IF DC-ODD-DAYS-OVER GREATER THAN +15                     ELCRTMPD
  2254             MOVE 1              TO MONTHS-EARNED                 ELCRTMPD
  2255             GO TO 2050-1ST-PAY-TO-VALUATION-DATE.                ELCRTMPD
  2256                                                                  ELCRTMPD
  2257     IF CP-EARN-AFTER-14TH                                        ELCRTMPD
  2258         IF DC-ODD-DAYS-OVER GREATER THAN +14                     ELCRTMPD
  2259             MOVE 1              TO MONTHS-EARNED                 ELCRTMPD
  2260             GO TO 2050-1ST-PAY-TO-VALUATION-DATE.                ELCRTMPD
  2261                                                                  ELCRTMPD
  2262     IF CP-EARN-AFTER-16TH                                        ELCRTMPD
  2263         IF DC-ODD-DAYS-OVER GREATER THAN +16                     ELCRTMPD
  2264             MOVE 1              TO MONTHS-EARNED.                ELCRTMPD
  2265                                                                  ELCRTMPD
  2266 2050-1ST-PAY-TO-VALUATION-DATE.                                  ELCRTMPD
  2267                                                                  ELCRTMPD
  2268     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-1.                ELCRTMPD
  2269     MOVE CP-VALUATION-DT        TO DC-BIN-DATE-2.                ELCRTMPD
  2270     MOVE '1'                    TO DC-OPTION-CODE.               ELCRTMPD
  2271     PERFORM 8000-DATE-CONVERT THRU 8000-EXIT.                    ELCRTMPD
  2272     IF DATE-CONVERSION-ERROR                                     ELCRTMPD
  2273         MOVE '2' TO CP-RETURN-CODE                               ELCRTMPD
  2274         GO TO 9999-RT-REMAINING-TERM-XIT.                        ELCRTMPD
  2275                                                                  ELCRTMPD
  2276     COMPUTE CP-REMAINING-TERM-1 = CP-ORIGINAL-TERM -             ELCRTMPD
  2277                              (DC-ELAPSED-MONTHS + MONTHS-EARNED).ELCRTMPD
  2278                                                                  ELCRTMPD
  2279     MOVE DC-ODD-DAYS-OVER       TO CP-ODD-DAYS.                  ELCRTMPD
  2280                                                                  ELCRTMPD
  2281     IF CP-REMAINING-TERM-1 NEGATIVE                              ELCRTMPD
  2282        MOVE ZERO                TO CP-REMAINING-TERM-1           ELCRTMPD
  2283                                    CP-REMAINING-TERM-2           ELCRTMPD
  2284                                    CP-REMAINING-TERM-3           ELCRTMPD
  2285                                    CP-ODD-DAYS                   ELCRTMPD
  2286        GO TO 9999-RT-REMAINING-TERM-XIT.                         ELCRTMPD
  2287                                                                  ELCRTMPD
  2288     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2           ELCRTMPD
  2289                                    CP-REMAINING-TERM-3.          ELCRTMPD
  2290                                                                  ELCRTMPD
  2291     IF CP-EARN-AS-REG-BALLOON                                    ELCRTMPD
  2292        IF CP-BALLOON-LAST-PMT                                    ELCRTMPD
  2293           ADD +1 TO CP-REMAINING-TERM-3.                         ELCRTMPD
  2294                                                                  ELCRTMPD
  2295     IF CP-EARN-AFTER-15TH                                        ELCRTMPD
  2296        GO TO 2100-METHOD-1.                                      ELCRTMPD
  2297     IF CP-EARN-ON-HALF-MONTH                                     ELCRTMPD
  2298        GO TO 2200-METHOD-2.                                      ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  55
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  2299     IF CP-EARN-ON-1ST-DAY                                        ELCRTMPD
  2300        GO TO 2300-METHOD-3.                                      ELCRTMPD
  2301     IF CP-EARN-ON-FULL-MONTH                                     ELCRTMPD
  2302        GO TO 2400-METHOD-4.                                      ELCRTMPD
  2303     IF CP-EARN-WITH-NO-DAYS                                      ELCRTMPD
  2304        GO TO 2500-METHOD-5.                                      ELCRTMPD
  2305                                                                  ELCRTMPD
  2306     IF CP-EARN-AFTER-14TH                                        ELCRTMPD
  2307        GO TO 2600-METHOD-6.                                      ELCRTMPD
  2308     IF CP-EARN-AFTER-16TH                                        ELCRTMPD
  2309        GO TO 2700-METHOD-7.                                      ELCRTMPD
  2310                                                                  ELCRTMPD
  2311     MOVE '3' TO CP-RETURN-CODE                                   ELCRTMPD
  2312     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  2313                                                                  ELCRTMPD
  2314 2100-METHOD-1.                                                   ELCRTMPD
  2315                                                                  ELCRTMPD
  2316****************************************************************  ELCRTMPD
  2317*  ORIGINAL                                                    *  ELCRTMPD
  2318*                                                              *  ELCRTMPD
  2319*                       NUMBER OF DAYS                         *  ELCRTMPD
  2320*         POLICY MUST BE INFORCE FOR 15 DAYS TO EARN A MONTH   *  ELCRTMPD
  2321*                                                              *  ELCRTMPD
  2322****************************************************************  ELCRTMPD
  2323                                                                  ELCRTMPD
  2324                                                                  ELCRTMPD
  2325     IF DC-ODD-DAYS-OVER GREATER THAN +15                         ELCRTMPD
  2326         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  2327                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  2328                                                                  ELCRTMPD
  2329     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  2330                                                                  ELCRTMPD
  2331                                                                  ELCRTMPD
  2332 2200-METHOD-2.                                                   ELCRTMPD
  2333                                                                  ELCRTMPD
  2334****************************************************************  ELCRTMPD
  2335*                                                              *  ELCRTMPD
  2336*  ORIGINAL                                                    *  ELCRTMPD
  2337*                       HALF MONTH ADJUSTMENT                  *  ELCRTMPD
  2338*            PREMIUM EARNS ON 1/2 MONTH MORE ASSUMPTION        *  ELCRTMPD
  2339*                                                              *  ELCRTMPD
  2340****************************************************************  ELCRTMPD
  2341                                                                  ELCRTMPD
  2342     IF CP-REMAINING-TERM-1 NOT = ZERO                            ELCRTMPD
  2343         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  2344                             CP-REMAINING-TERM-1 - (+.5).         ELCRTMPD
  2345                                                                  ELCRTMPD
  2346     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  2347                                                                  ELCRTMPD
  2348*     NO ADJUSTMENT TO CP-REMAINING-TERM-3 FOR DAYS - TYPE 2.     ELCRTMPD
  2349                                                                  ELCRTMPD
  2350                                                                  ELCRTMPD
  2351 2300-METHOD-3.                                                   ELCRTMPD
  2352                                                                  ELCRTMPD
  2353****************************************************************  ELCRTMPD
  2354*                                                              *  ELCRTMPD
  2355*  ORIGINAL                                                    *  ELCRTMPD
  2356*                       FIRST DAY METHOD                       *  ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  56
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  2357*                  PREMIUM EARNS ON FIRST DAY                  *  ELCRTMPD
  2358*                                                              *  ELCRTMPD
  2359****************************************************************  ELCRTMPD
  2360                                                                  ELCRTMPD
  2361     IF DC-ODD-DAYS-OVER GREATER THAN +0                          ELCRTMPD
  2362         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  2363                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  2364                                                                  ELCRTMPD
  2365     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  2366                                                                  ELCRTMPD
  2367                                                                  ELCRTMPD
  2368 2400-METHOD-4.                                                   ELCRTMPD
  2369                                                                  ELCRTMPD
  2370****************************************************************  ELCRTMPD
  2371*                                                              *  ELCRTMPD
  2372*  ORIGINAL                                                    *  ELCRTMPD
  2373*                       FULL MONTH METHOD                      *  ELCRTMPD
  2374*          PREMIUM EARNS ON FULL MONTH - SAME AS BENEFIT       *  ELCRTMPD
  2375*                                                              *  ELCRTMPD
  2376****************************************************************  ELCRTMPD
  2377                                                                  ELCRTMPD
  2378*  NO ADJUSTMENT FOR CP-REMAINING-TERM-1 - TYPE 4.                ELCRTMPD
  2379                                                                  ELCRTMPD
  2380                                                                  ELCRTMPD
  2381     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  2382                                                                  ELCRTMPD
  2383                                                                  ELCRTMPD
  2384 2500-METHOD-5.                                                   ELCRTMPD
  2385                                                                  ELCRTMPD
  2386****************************************************************  ELCRTMPD
  2387*                                                              *  ELCRTMPD
  2388*  ORIGINAL                                                    *  ELCRTMPD
  2389*                       FULL MONTH - NO DAYS                   *  ELCRTMPD
  2390*          PREMIUM EARNS A FULL MONTH STARTING THE FIRST MONTH *  ELCRTMPD
  2391*       (THIS METHOD WILL EARN WITHOUT A FLUCTUATION IN SHORT  *  ELCRTMPD
  2392*        MONTHS )                                              *  ELCRTMPD
  2393****************************************************************  ELCRTMPD
  2394                                                                  ELCRTMPD
  2395                                                                  ELCRTMPD
  2396     IF CP-REMAINING-TERM-1 NOT = ZERO                            ELCRTMPD
  2397         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  2398                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  2399                                                                  ELCRTMPD
  2400     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  2401                                                                  ELCRTMPD
  2402 2600-METHOD-6.                                                   ELCRTMPD
  2403                                                                  ELCRTMPD
  2404****************************************************************  ELCRTMPD
  2405*  ORIGINAL                                                    *  ELCRTMPD
  2406*                                                              *  ELCRTMPD
  2407*                       NUMBER OF DAYS                         *  ELCRTMPD
  2408*         POLICY MUST BE INFORCE FOR 14 DAYS TO EARN A MONTH   *  ELCRTMPD
  2409*                                                              *  ELCRTMPD
  2410****************************************************************  ELCRTMPD
  2411                                                                  ELCRTMPD
  2412                                                                  ELCRTMPD
  2413     IF DC-ODD-DAYS-OVER GREATER THAN +14                         ELCRTMPD
  2414         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  57
* ELRTRMX.cbl (/apps/prod/cid1p/copy/ELCRTMPD)
  2415                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  2416                                                                  ELCRTMPD
  2417     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  2418                                                                  ELCRTMPD
  2419 2700-METHOD-7.                                                   ELCRTMPD
  2420                                                                  ELCRTMPD
  2421****************************************************************  ELCRTMPD
  2422*  ORIGINAL                                                    *  ELCRTMPD
  2423*                                                              *  ELCRTMPD
  2424*                       NUMBER OF DAYS                         *  ELCRTMPD
  2425*         POLICY MUST BE INFORCE FOR 16 DAYS TO EARN A MONTH   *  ELCRTMPD
  2426*                                                              *  ELCRTMPD
  2427****************************************************************  ELCRTMPD
  2428                                                                  ELCRTMPD
  2429                                                                  ELCRTMPD
  2430     IF DC-ODD-DAYS-OVER GREATER THAN +16                         ELCRTMPD
  2431         COMPUTE CP-REMAINING-TERM-1 =                            ELCRTMPD
  2432                             CP-REMAINING-TERM-1 - (+1).          ELCRTMPD
  2433                                                                  ELCRTMPD
  2434     GO TO 9999-RT-REMAINING-TERM-XIT.                            ELCRTMPD
  2435                                                                  ELCRTMPD
  2436                                                                  ELCRTMPD
  2437******************************************************************ELCRTMPD
  2438                                                                  ELRTRMX
  2439 8000-DATE-CONVERT.                                                  CL**3
  2440     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELRTRMX
  2441 8000-EXIT.                                                          CL**3
  2442     EXIT.                                                        ELRTRMX
  2443                                                                  ELRTRMX
  2444 9999-RT-REMAINING-TERM-XIT.                                         CL**3
  2445     GOBACK.                                                      ELRTRMX
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:         932     Code:        5062
