* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMCAB1.cbl
* Options: int("PEMCAB1.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMCAB1.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMCAB1.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"PEMCAB1.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. PEMCAB1.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:19.
     6 ENVIRONMENT DIVISION.
     7 INPUT-OUTPUT SECTION.
     8 FILE-CONTROL.
     9
    10     SELECT CERT-IN          ASSIGN TO CERTIN.
    11     SELECT ECCERT           ASSIGN TO ECCERT
    12                             ORGANIZATION IS INDEXED
    13                             ACCESS IS DYNAMIC
    14                             RECORD KEY IS CA-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMCAB1.cbl
    15                             FILE STATUS IS ECCERT-FILE-STATUS.
    16
    17 DATA DIVISION.
    18 FILE SECTION.
    19
    20 FD  CERT-IN
    21     RECORDING MODE F
    22     LABEL RECORDS STANDARD
    23     BLOCK CONTAINS 0 RECORDS.
    24
*   25                                 COPY ECSCRT01.
    26******************************************************************
    27*                                                                *
    28*                            ECSCRT01                            *
    29*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    30*                            VMOD=2.016                          *
    31*                                                                *
    32*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
    33*                                                                *
    34*   FILE TYPE = SEQUENTIAL
    35*   RECORD SIZE = 1056 RECFORM = FIXED                           *
    36*                                                                *
    37*   KEY DATA =                         START=4, LEN=36           *
    38*                                                                *
    39*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
    40*                                                                *
    41******************************************************************
    42******************************************************************
    43*                   C H A N G E   L O G
    44*
    45* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    46*-----------------------------------------------------------------
    47*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    48* EFFECTIVE    NUMBER
    49*-----------------------------------------------------------------
    50* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    51* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    52* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    53* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
    54* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    55* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    56* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    57* 032612  CR2011110200001  PEMA  AHL CHANGES
    58* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    59* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    60******************************************************************
    61
    62 01  CERTIFICATE-RECORD.
    63     12  CR-RECORD-ID                      PIC XX.
    64         88  VALID-CR-ID                      VALUE 'CR'.
    65
    66     12  CR-COMPANY-CD                     PIC X.
    67
    68     12  CR-FULL-CONTROL.
    69         16  CR-CONTROL-1.
    70             20  CR-ACCT-CONTROL.
    71                 24  CR-CARRIER            PIC X.
    72                 24  CR-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMCAB1.cbl (/apps/prod/cid1p/copy/ECSCRT01)
    73                     28  CR-GROUP-PREFIX   PIC XXX.
    74                     28  CR-GROUP-PRIME    PIC XXX.
    75                 24  CR-STATE              PIC XX.
    76                 24  CR-ACCOUNT.
    77                     28  CR-ACCT-PREFIX    PIC X(4).
    78                     28  CR-ACCT-PRIME     PIC X(6).
    79             20  CR-DT                     PIC 9(11)  COMP-3.
    80         16  CR-CERT-NO.
    81             20  CR-CERT.
    82                 24  CR-CERT-PREFIX        PIC X(3).
    83                 24  CR-CERT-PRIME         PIC X(7).
    84             20  CR-CERT-SFX               PIC X.
    85
    86     12  CR-INSUREDS-PROFILE.
    87         16  CR-NAME.
    88             20  CR-LNAME                  PIC X(15).
    89             20  CR-FNAME.
    90                 24  CR-1ST-INITIAL        PIC X.
    91                 24  FILLER                PIC X(9).
    92             20  CR-INIT                   PIC X.
    93         16  CR-AGE                        PIC 99.
    94         16  CR-SEX                        PIC X.
    95             88  CR-SEX-MALE                  VALUE 'M'.
    96             88  CR-SEX-FEMALE                VALUE 'F'.
    97         16  CR-SOC-SEC                    PIC X(11).
    98         16  CR-JOINT-NAME.
    99             20  CR-JT-LNAME               PIC X(15).
   100             20  CR-JT-FNAME.
   101                 24  CR-JT-1ST-INIT        PIC X.
   102                 24  FILLER                PIC X(9).
   103             20  CR-JT-INIT                PIC X.
   104         16  CR-JOINT-AGE                  PIC 99.
   105
   106         16  cr-ahl-ah-claim-no            pic x(9).
   107         16  cr-ahl-ah-cert-seq            pic x(3).
   108         16  cr-hst-proc-lf                pic x.
   109         16  f                             pic x(7).
   110
   111     12  CR-LF-COVERAGE-DATA.
   112         16  CR-LFTYP                      PIC XX.
   113         16  CR-LF-TERM                    PIC S999       COMP-3.
   114         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   115         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   116         16  CR-LF-DEV-CODE                PIC XXX.
   117         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   118
   119         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   120         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   121         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   122         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   123
   124         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   125         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   126         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   127         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   128
   129         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   130         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMCAB1.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   131
   132         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   133         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   134
   135         16  CR-LF-REFUND-TYPE             PIC X.
   136         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   137
   138         16  CR-LF-COMM-CHARGEBACK         PIC X.
   139             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   140
   141         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   142
   143         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   144         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   145         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   146
   147         16  cr-ahl-lf-claim-no            pic x(9).
   148         16  cr-ahl-lf-cert-seq            pic x(3).
   149         16  FILLER                        PIC XX.
   150
   151     12  CR-AH-COVERAGE-DATA.
   152         16  CR-AHTYP                      PIC XX.
   153         16  CR-AH-TERM                    PIC S999       COMP-3.
   154         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   155         16  CR-AH-DEV-CODE                PIC XXX.
   156         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   157
   158         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   159         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   160         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   161         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   162
   163         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   164         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   165
   166         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   167         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   168
   169         16  CR-AH-REFUND-TYPE             PIC X.
   170         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   171
   172         16  CR-AH-COMM-CHARGEBACK         PIC X.
   173             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   174
   175         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   176
   177         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   178         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   179         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   180
   181         16  FILLER                        PIC XX.
   182*        16  FILLER                        PIC X(8).
   183
   184     12  CR-LOAN-DATA.
   185         16  CR-LIVES                      PIC S9(7)      COMP-3.
   186         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   187                                           PIC S9(5)V99   COMP-3.
   188         16  CR-BILLED                     PIC S9(7)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMCAB1.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   189         16  CR-APR                        PIC S999V9(4)  COMP-3.
   190         16  CR-PMT-FREQ                   PIC 99.
   191         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   192         16  CR-RATING-CLASS               PIC XX.
   193         16  CR-POLICY-FORM-NO             PIC X(12).
   194         16  CR-GRPTYP                     PIC XX.
   195         16  CR-IND-GRP                    PIC X.
   196             88  CR-INDIVIDUAL                VALUE '1'.
   197             88  CR-GROUP                     VALUE '2'.
   198         16  CR-SKIP                       PIC 99.
   199             88  NO-MONTHS-SKIPPED            VALUE 00.
   200             88  SKIP-JULY                    VALUE 01.
   201             88  SKIP-AUGUST                  VALUE 02.
   202             88  SKIP-SEPTEMBER               VALUE 03.
   203             88  SKIP-JULY-AUG                VALUE 04.
   204             88  SKIP-AUG-SEPT                VALUE 05.
   205             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   206             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   207             88  SKIP-JUNE                    VALUE 08.
   208             88  SKIP-JUNE-JULY               VALUE 09.
   209             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   210             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   211         16  CR-RESIDENT-STATE             PIC XX.
   212         16  CR-RATE-CODE.
   213             20  CR-LF-CLASS-CD            PIC XX.
   214             20  CR-AH-CLASS-CD            PIC XX.
   215         16  CR-MORT.
   216             20  CR-TAB                    PIC X.
   217             20  CR-INT                    PIC 99.
   218             20  CR-GRP                    PIC X.
   219         16  CR-MEMBER-NO                  PIC X(12).
   220         16  CR-OLD-LOF                    PIC XXX.
   221*        16  CR-LOAN-OFFICER               PIC XXX.
   222         16  CR-REIN-TABLE                 PIC XXX.
   223         16  CR-REIN-SPEC                  PIC X.
   224         16  CR-LOAN-1ST-PMT-DT.
   225             20  CR-1ST-PMT-YR             PIC 99.
   226             20  CR-1ST-PMT-MO             PIC 99.
   227             20  CR-1ST-PMT-DA             PIC 99.
   228         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   229         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   230         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   231         16  CR-LAST-ADD-ON-DT             PIC XX.
   232
   233         16  CR-UNDERWRITING-CODE          PIC X.
   234             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   235
   236         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   237         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   238         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   239         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   240
   241     12  CR-STATUS-INFORMATION.
   242         16  CR-ENTRY-STATUS               PIC X.
   243             88  CR-NORMAL-ENTRY              VALUE '1'.
   244             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   245             88  CR-CONVERSION-ENTRY          VALUE '4'.
   246             88  CR-POLICY-IS-REISSUE         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMCAB1.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   247             88  CR-POLICY-IS-CASH            VALUE 'C'.
   248             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   249             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   250             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   251             88  CR-POLICY-IS-VOID            VALUE 'V'.
   252             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   253             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   254                                                'C' '5' '9' 'P'.
   255         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   256
   257         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   258         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   259         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   260
   261         16  CR-LF-STATUS-AT-DEATH         PIC X.
   262         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   263
   264         16  CR-LF-CURRENT-STATUS          PIC X.
   265             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   266             88  CR-LF-POLICY-PENDING         VALUE '2'.
   267             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   268             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   269             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   270             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   271             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   272             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   273             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   274             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   275             88  CR-LF-IS-DECLINED            VALUE 'D'.
   276             88  CR-LF-IS-VOID                VALUE 'V'.
   277             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   278                                                    '4' '5' '9'.
   279
   280         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   281
   282         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   283         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   284
   285         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   286         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   287
   288         16  CR-AH-CURRENT-STATUS          PIC X.
   289             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   290             88  CR-AH-POLICY-PENDING         VALUE '2'.
   291             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   292             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   293             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   294             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   295             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   296             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   297             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   298             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   299             88  CR-AH-IS-DECLINED            VALUE 'D'.
   300             88  CR-AH-IS-VOID                VALUE 'V'.
   301             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   302                                                    '4' '5' '9'.
   303         16  CR-LOAN-OFFICER               PIC X(5).
   304         16  CR-CANCEL-REASON              PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMCAB1.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   305         16  cr-xycor-lf-cov-code          pic x(4).
   306         16  cr-xycor-ah-cov-code          pic x(4).
   307         16  cr-temp-epiq                  pic x(4).
   308         16  FILLER                        PIC XX.
   309
   310     12  CR-DEATH-CLAIM-DATA.
   311         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   312
   313         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   314         16  CR-DTH-RPT-DT.
   315             20  CR-DTH-RPT-YR             PIC 99.
   316             20  CR-DTH-RPT-MO             PIC 99.
   317             20  CR-DTH-RPT-DA             PIC 99.
   318         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   319
   320         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   321         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   322         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   323         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   324         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   325
   326         16  CR-DTH-AGE                    PIC 99.
   327         16  CR-DTH-PAY-CD                 PIC X.
   328         16  CR-DEATH-CAUSE                PIC X(6).
   329
   330         16  FILLER                        PIC X(16).
   331
   332     12  CR-DISAB-CLAIM-DATA.
   333         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   334
   335         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   336         16  CR-DIS-RPT-DT.
   337             20  CR-DIS-RPT-YR             PIC 99.
   338             20  CR-DIS-RPT-MO             PIC 99.
   339             20  CR-DIS-RPT-DA             PIC 99.
   340         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   341         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   342
   343         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   344         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   345         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   346         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   347         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   348
   349         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   350         16  CR-DIS-PAY-CD                 PIC X.
   351         16  FILLER                        PIC XX.
   352
   353         16  CR-DISAB-INCURRED-DETAIL.
   354             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   355**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   356                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   357                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   358                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   359
   360         16  CR-DISAB-CAUSE                PIC X(6).
   361         16  FILLER                        PIC X(14).
   362
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMCAB1.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   363     12  CR-REMIT-TO                       PIC 99.
   364
   365     12  CR-COMPENSATION-LEVELS.
   366         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   367             20  CR-COM-AGT.
   368                 24  CR-COM-AGT-PREFIX     PIC X(4).
   369                 24  CR-COM-AGT-PRIME      PIC X(6).
   370             20  CR-AGT-TYPE               PIC X.
   371             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   372             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   373
   374     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   375     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   376     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   377     12  CR-CLP-STATE                      PIC XX.
   378     12  CR-POST-CARD-IND                  PIC X.
   379     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   380     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   381     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   382     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   383     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   384     12  FILLER                            PIC X(07).
   385
   386     12  CR-CSR-CODE                       PIC XXX.
   387
   388     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   389     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   390
   391     12  CR-MICROFILM-NUMBERS.
   392*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   393         16  FILLER                        PIC X(5).
   394     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   395
   396     12  CR-USER-CODE                      PIC X.
   397     12  CR-USER-FUTURE                    PIC X(9).
   398
   399     12  CR-BENEFICIARY.
   400         16  CR-BANK-NO                    PIC X(10).
   401         16  FILLER                        PIC X(15).
   402
   403     12  CR-ENTRY-BATCH                    PIC X(6).
   404     12  CR-LF-EXIT-BATCH                  PIC X(6).
   405     12  CR-AH-EXIT-BATCH                  PIC X(6).
   406
   407     12  CR-NOTE-SW                        PIC X.
   408
   409     12  CR-ORIGIN-INDICATOR               PIC X.
   410         88  CR-ENTERED-MANUALLY              VALUE '1'.
   411         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   412
   413     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   414     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   415     12  FILLER                            PIC X(33).
   416
   417******************************************************************
   418
   419 FD  ECCERT.
   420
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMCAB1.cbl
*  421                                 COPY ECCCERT.
   422******************************************************************
   423*                                                                *
   424*                            ECCCERT.                            *
   425*                            VMOD=2.001                          *
   426*                                                                *
   427*   FILE DESCRIPTION = BATCH CERT FILE KEYS                      *
   428*                                                                *
   429*   FILE TYPE = VSAM,KSDS                                        *
   430*   RECORD SIZE = 110  RECFORM = FIXED                           *
   431*                                                                *
   432*   BASE CLUSTER = ECCERT                         RKP=2,LEN=33   *
   433*                                                                *
   434*   LOG = YES                                                    *
   435*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   436******************************************************************
   437*                   C H A N G E   L O G
   438*
   439* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   440*-----------------------------------------------------------------
   441*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   442* EFFECTIVE    NUMBER
   443*-----------------------------------------------------------------
   444* 031408                   PEMA  NEW COPYBOOK
   445******************************************************************
   446
   447 01  BATCH-CERT-FILE-KEYS.
   448     12  CA-RECORD-ID                      PIC XX.
   449         88  VALID-CA-ID                      VALUE 'CA'.
   450
   451     12  CA-CONTROL-PRIMARY.
   452         16  CA-COMPANY-CD                 PIC X.
   453         16  CA-CARRIER                    PIC X.
   454         16  CA-GROUPING.
   455             20  CA-GROUPING-PREFIX        PIC X(3).
   456             20  CA-GROUPING-PRIME         PIC X(3).
   457         16  CA-STATE                      PIC XX.
   458         16  CA-ACCOUNT.
   459             20  CA-ACCOUNT-PREFIX         PIC X(4).
   460             20  CA-ACCOUNT-PRIME          PIC X(6).
   461         16  CA-CERT-EFF-DT                PIC XX.
   462         16  CA-CERT-NO.
   463             20  CA-CERT-PRIME             PIC X(10).
   464             20  CA-CERT-SFX               PIC X.
   465
   466     12  CA-RECORD-BODY.
   467         16  CA-INSURED-LAST-NAME          PIC X(15).
   468         16  CA-INSURED-FIRST-NAME         PIC X(10).
   469         16  CA-INSURED-MID-INIT           PIC X.
   470     12  CA-POST-CARD-IND                  PIC X.
   471     12  FILLER                            PIC X(48).
   472******************************************************************
   473
   474 WORKING-STORAGE SECTION.
   475 01  WS-STATUS-CODES.
   476     05  ECCERT-FILE-STATUS      PIC XX  VALUE SPACES.
   477         88  ECCERT-FOUND              VALUE '00'.
   478     05  WS-EOF-SW               PIC X   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMCAB1.cbl
   479         88  END-OF-INPUT                VALUE 'Y'.
   480
   481 01  WS-HOLD-ECCERT              PIC X(110)  VALUE LOW-VALUES.
   482 01  WS-BIN-EFF-DT               PIC XX   VALUE LOW-VALUES.
   483 01  WS-WORK-FIELDS.
   484     05  WS-ABEND-FLD            PIC 9         VALUE ZEROS.
   485     05  WS-ZERO-FLD             PIC 9         VALUE ZEROS.
   486     05  WS-CERT-RECS-IN         PIC 9(9)      VALUE ZEROS.
   487     05  WS-ECCERT-RECS-BUILT    PIC 9(9)      VALUE ZEROS.
   488     05  WS-DISPLAY-CNT          PIC Z,ZZZ,ZZ9 VALUE ZEROS.
   489
*  490                                 COPY ELCDATE.
   491******************************************************************06/11/98
   492*                                                                *ELCDATE
   493*                                                                *ELCDATE
   494*                            ELCDATE.                            *   LV023
   495*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   496*                            VMOD=2.003                           ELCDATE
   497*                                                                *ELCDATE
   498*                                                                *ELCDATE
   499*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   500*                 LENGTH = 200                                   *   CL*19
   501******************************************************************ELCDATE
   502                                                                  ELCDATE
   503 01  DATE-CONVERSION-DATA.                                        ELCDATE
   504     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   505     12  DC-OPTION-CODE                PIC X.                        CL*15
   506         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   507         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   508         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   509         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   510         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   511         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   512         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   513         88  FIND-CENTURY               VALUE '7'.                   CL*22
   514         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   515         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   516         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   517         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   518         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   519         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   520         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   521         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   522         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   523         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   524         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   525         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   526         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   527         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   528         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   529         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   530         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   531         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   532         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   533         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   534         88  THREE-CHARACTER-BIN                                  ELCDATE
   535                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   536         88  GREGORIAN-TO-BIN                                        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMCAB1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   537                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   538         88  BIN-TO-GREGORIAN                                        CL**2
   539                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   540         88  JULIAN-TO-BINARY                                        CL**2
   541                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   542     12  DC-ERROR-CODE                 PIC X.                        CL*15
   543         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   544         88  DATE-CONVERSION-ERROR                                ELCDATE
   545                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   546         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   547         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   548         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   549         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   550         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   551         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   552         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   553         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   554         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   555         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   556     12  DC-END-OF-MONTH               PIC X.                        CL*15
   557         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   558     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   559         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   560         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   561         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   562     12  FILLER                        PIC X.                        CL*15
   563     12  DC-CONVERSION-DATES.                                        CL*15
   564         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   565         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   566         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   567         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   568                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   569             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   570             20  SLASH1-1              PIC X.                        CL*15
   571             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   572             20  SLASH1-2              PIC X.                        CL*15
   573             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   574         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   575         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   576                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   577             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   578             20  SLASH2-1              PIC X.                        CL*15
   579             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   580             20  SLASH2-2              PIC X.                        CL*15
   581             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   582         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   583         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   584                     DC-GREG-DATE-1-YMD.                          ELCDATE
   585             20  DC-YMD-YEAR           PIC 99.                       CL*15
   586             20  DC-YMD-MONTH          PIC 99.                       CL*15
   587             20  DC-YMD-DAY            PIC 99.                       CL*15
   588         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   589         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   590                      DC-GREG-DATE-1-MDY.                         ELCDATE
   591             20  DC-MDY-MONTH          PIC 99.                       CL*15
   592             20  DC-MDY-DAY            PIC 99.                       CL*15
   593             20  DC-MDY-YEAR           PIC 99.                       CL*15
   594         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMCAB1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   595             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   596             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   597             20  FILLER                PIC XX.                       CL*15
   598             20  DC-ALPHA-CENTURY.                                   CL*15
   599                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   600             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   601         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   602         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   603         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   604         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   605         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   606                                       PIC 9(05).                    CL*20
   607         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   608             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   609             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   610         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   611         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   612         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   613     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   614         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   615         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   616             20  FILLER                PIC 9(3).                     CL*15
   617             20  HOLD-CEN-1-CCYY.                                    CL*15
   618                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   619                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   620             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   621             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   622         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   623             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   624             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   625             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   626                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   627                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   628             20  FILLER                PIC 9(3).                     CL*15
   629         16  HOLD-CENTURY-1-X.                                       CL*15
   630             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   631             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   632                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   633                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   634             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   635             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   636         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   637             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   638             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   639             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   640                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   641                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   642             20  FILLER                PIC XXX.                      CL*23
   643         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   644         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   645         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   646         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   647             20  DC-JULIAN-1-CCYY.                                   CL*15
   648                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   649                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   650             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   651         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   652         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMCAB1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   653             20  DC-JULIAN-2-CCYY.                                   CL*15
   654                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   655                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   656             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   657         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   658             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   659             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   660             20  DC-EDITA-DAY          PIC 99.                       CL*15
   661             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   662             20  DC-EDITA-CCYY.                                      CL*15
   663                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   664                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   665         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   666             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   667             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   668             20  DC-EDITB-DAY          PIC 99.                       CL*15
   669             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   670             20  DC-EDITB-CCYY.                                      CL*15
   671                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   672                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   673         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   674         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   675                              DC-GREG-DATE-CYMD.                  ELCDATE
   676             20  DC-CYMD-CEN           PIC 99.                       CL*15
   677             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   678             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   679             20  DC-CYMD-DAY           PIC 99.                       CL*15
   680         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   681         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   682                              DC-GREG-DATE-MDCY.                  ELCDATE
   683             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   684             20  DC-MDCY-DAY           PIC 99.                       CL*15
   685             20  DC-MDCY-CEN           PIC 99.                       CL*15
   686             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   687    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   688        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   689    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   690    12  FILLER                         PIC X(28).                    CL*26
   691
   692 PROCEDURE DIVISION.
   693 0000-MAINLINE.
   694
   695     PERFORM 0100-OPEN-FILES     THRU 0100-EXIT
   696     PERFORM 0200-INITIALIZE     THRU 0200-EXIT
   697     PERFORM 1000-PROCESS        THRU 1000-EXIT UNTIL
   698        END-OF-INPUT
   699     PERFORM 3000-CLOSE-FILES    THRU 3000-EXIT
   700     PERFORM 4000-FINAL-TOTALS   THRU 4000-EXIT
   701     GOBACK
   702
   703     .
   704 0000-EXIT.
   705     EXIT.
   706
   707 0100-OPEN-FILES.
   708
   709     OPEN INPUT CERT-IN
   710     OPEN I-O   ECCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMCAB1.cbl
   711*    OPEN INPUT ECCERT
   712
   713     IF ECCERT-FILE-STATUS = '00' OR '97'
   714        CONTINUE
   715     ELSE
   716        DISPLAY ' ERROR - ECCERT - OPEN ' ECCERT-FILE-STATUS
   717        PERFORM ABEND-PGM
   718     END-IF
   719
   720     .
   721 0100-EXIT.
   722     EXIT.
   723
   724 0200-INITIALIZE.
   725
   726     MOVE SPACES                 TO WS-EOF-SW
   727     MOVE ZEROS                  TO WS-CERT-RECS-IN
   728                                    WS-ECCERT-RECS-BUILT
   729
   730     PERFORM 1100-READ-INPUT     THRU 1100-EXIT
   731
   732     .
   733 0200-EXIT.
   734     EXIT.
   735
   736 1000-PROCESS.
   737
   738     MOVE SPACES                 TO BATCH-CERT-FILE-KEYS
   739     MOVE 'CA'                   TO CA-RECORD-ID
   740     MOVE X'04'                  TO CA-COMPANY-CD
   741     MOVE CR-ACCT-CONTROL        TO CA-CONTROL-PRIMARY (2:19)
   742
   743     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
   744     MOVE 'L'                    TO DC-OPTION-CODE
   745     MOVE +0                     TO DC-ELAPSED-MONTHS
   746                                    DC-ELAPSED-DAYS
   747     PERFORM 8000-DATE-CONVERT   THRU 8000-EXIT
   748     IF NO-CONVERSION-ERROR
   749        MOVE DC-BIN-DATE-1       TO CA-CERT-EFF-DT
   750     ELSE
   751        DISPLAY ' ERROR CONVERTING EFF DT '
   752           CR-ACCT-CONTROL '  ' CR-CERT-NO
   753         PERFORM ABEND-PGM
   754     END-IF
   755     MOVE CR-CERT-NO             TO CA-CERT-NO
   756     MOVE CR-LNAME               TO CA-INSURED-LAST-NAME
   757     MOVE CR-FNAME               TO CA-INSURED-FIRST-NAME
   758     MOVE CR-INIT                TO CA-INSURED-MID-INIT
   759     MOVE CR-POST-CARD-IND       TO CA-POST-CARD-IND
   760
   761     PERFORM 2100-WRITE-ECCERT   THRU 2100-EXIT
   762
   763     PERFORM 1100-READ-INPUT     THRU 1100-EXIT
   764
   765     .
   766 1000-EXIT.
   767     EXIT.
   768
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMCAB1.cbl
   769 1100-READ-INPUT.
   770
   771     READ CERT-IN AT END
   772        SET END-OF-INPUT         TO TRUE
   773     END-READ
   774
   775     IF NOT END-OF-INPUT
   776        ADD +1                   TO WS-CERT-RECS-IN
   777     END-IF
   778
   779     .
   780 1100-EXIT.
   781     EXIT.
   782
   783 1200-READ-ECCERT.
   784
   785     READ ECCERT
   786
   787     IF ECCERT-FILE-STATUS = '00'
   788        SET ECCERT-FOUND         TO TRUE
   789     ELSE
   790        IF ECCERT-FILE-STATUS NOT = '10' AND '23'
   791           DISPLAY 'ECCERT, BAD READ '
   792                ECCERT-FILE-STATUS
   793           PERFORM ABEND-PGM
   794        END-IF
   795     END-IF
   796
   797     .
   798 1200-EXIT.
   799     EXIT.
   800
   801
   802 2100-WRITE-ECCERT.
   803
   804     WRITE BATCH-CERT-FILE-KEYS
   805
   806     IF ECCERT-FILE-STATUS = '00'
   807        ADD 1                    TO WS-ECCERT-RECS-BUILT
   808     ELSE
   809        DISPLAY ' ERROR - ECCERT - WRITE ' ECCERT-FILE-STATUS
   810        PERFORM ABEND-PGM
   811     END-IF
   812
   813     .
   814 2100-EXIT.
   815     EXIT.
   816
   817 3000-CLOSE-FILES.
   818
   819     CLOSE ECCERT CERT-IN
   820
   821     .
   822 3000-EXIT.
   823     EXIT.
   824
   825 4000-FINAL-TOTALS.
   826
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* PEMCAB1.cbl
   827     DISPLAY '**************************************************'
   828     DISPLAY '***                                            ***'
   829
   830     MOVE WS-CERT-RECS-IN      TO WS-DISPLAY-CNT
   831     DISPLAY '***  CERT MASTER RECS IN         = ' WS-DISPLAY-CNT
   832
   833     MOVE WS-ECCERT-RECS-BUILT   TO WS-DISPLAY-CNT
   834     DISPLAY '***  CERT MASTER RECS BUILT      = ' WS-DISPLAY-CNT
   835
   836
   837     DISPLAY '***                                            ***'
   838     DISPLAY '**************************************************'
   839
   840     .
   841 4000-EXIT.
   842     EXIT.
   843
   844 8000-DATE-CONVERT.
   845
   846     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
   847
   848 8000-EXIT.
   849     EXIT.
   850
   851 ABEND-PGM.
   852
   853      CALL 'ABORTME'
   854
   855     .
   856 9999-EXIT.
   857     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2964     Code:        1284
