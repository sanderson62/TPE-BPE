* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* EL551NS.cbl
* Options: int("EL551NS.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL551NS.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL551NS.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL551NS.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EL551NS.
     3 AUTHOR.        PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:19.
     6*REMARKS.
     7*    THIS PROGRAM READS THE LETTER ARCHIVE FILE AND CREATES
     8*    2 REPORTS AND 2 EXTRACT FILES THAT MAKE UP THE DATA ON
     9*    EACH REPORT. FIRST REPORT IS OF THE LETTERS THAT SOMETHING
    10*    IS GOING TO HAPPEN THE NEXT BUSINESS DAY.
    11*    THE SECOND REPORT IS OF WHAT HAPPENED THAT BUSINESS DAY.
    12******************************************************************
    13*                   C H A N G E   L O G
    14*
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* EL551NS.cbl
    15* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    16*-----------------------------------------------------------------
    17*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    18* EFFECTIVE    NUMBER
    19*-----------------------------------------------------------------
    20* 011013    2012122700004  AJRA  IGNORE TEMP LETTERS
    21******************************************************************
    23 ENVIRONMENT DIVISION.
    24 INPUT-OUTPUT SECTION.
    25 FILE-CONTROL.
    26
    27     SELECT DISK-DATE            ASSIGN TO SYS019.
    28     SELECT PRINTX               ASSIGN TO SYS008.
    29     SELECT FICH                 ASSIGN TO SYS020.
    30     SELECT ERARCH               ASSIGN TO ERARCH
    31            ACCESS IS DYNAMIC
    32            ORGANIZATION IS INDEXED
    33            FILE STATUS IS ERARCH-FILE-STATUS
    34            RECORD KEY IS ERARCH-KEY.
    35
    36     SELECT SORTFL               ASSIGN TO SORTWK1.
    37
    38     SELECT PENDING-EXTRACT      ASSIGN TO SYS011
    39        ORGANIZATION IS LINE SEQUENTIAL.
    40
    41     SELECT ACTIVITY-EXTRACT     ASSIGN TO SYS012
    42        ORGANIZATION IS LINE SEQUENTIAL.
    43
    44 DATA DIVISION.
    45 FILE SECTION.
    46
    47 FD  DISK-DATE
*   48                                 COPY ELCDTEFD.
    49******************************************************************04/15/98
    50*                                                                *ELCDTEFD
    51*                                                                *ELCDTEFD
    52*                            ELCDTEFD.                           *   LV002
    53*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    54*                            VMOD=2.007                          *   CL**2
    55*                                                                *ELCDTEFD
    56******************************************************************ELCDTEFD
    57     BLOCK CONTAINS 0 RECORDS
    58     RECORDING MODE F.                                            ELCDTEFD
    59                                                                  ELCDTEFD
    60 01  DATE-DISK.                                                   ELCDTEFD
    61     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    62     12  FILLER                      PIC  X(14).                  ELCDTEFD
    63     12  DD-CR1                      PIC  9.                      ELCDTEFD
    64     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    65     12  DD-CR2                      PIC  9.                      ELCDTEFD
    66     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    67     12  FILLER                      PIC  X(20).                  ELCDTEFD
    68                                                                  ELCDTEFD
    69 01  DATE-DISK-R.                                                 ELCDTEFD
    70     12  FILLER                      PIC  X(4).                   ELCDTEFD
    71     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
    72                                     PIC  X(32).                  ELCDTEFD
    73                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
    74 01  DATE-DISK-T.                                                 ELCDTEFD
    75     12  FILLER                      PIC  X(4).                   ELCDTEFD
    76     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
    77                                     PIC  X(48).                  ELCDTEFD
    78                                                                  ELCDTEFD
    79 01  DATE-DISK-M.                                                 ELCDTEFD
    80     12  FILLER                      PIC  X(4).                   ELCDTEFD
    81     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
    82                                     PIC  X(48).                  ELCDTEFD
    83                                                                  ELCDTEFD
    84 01  DATE-DISK-P.                                                 ELCDTEFD
    85     12  DD-IDA                      PIC  XX.                     ELCDTEFD
    86     12  DD-IDX                      PIC  99.                     ELCDTEFD
    87     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
    88     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    89         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
    90                                     PIC  X.                      ELCDTEFD
    91         16  FILLER                  PIC  X(46).                  ELCDTEFD
    92     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    93         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
    94             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
    95             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
    96             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
    97             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
    98         16  FILLER                  PIC  X(16).                  ELCDTEFD
    99                                                                  ELCDTEFD
   100 01  DATE-DISK-E.                                                 ELCDTEFD
   101     12  FILLER                      PIC  X(4).                   ELCDTEFD
   102     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   103                                     PIC  X(4).                   ELCDTEFD
   104                                                                  ELCDTEFD
   105 01  DATE-DISK-C.                                                 ELCDTEFD
   106     12  FILLER                      PIC  X(7).                   ELCDTEFD
   107     12  DD-CARR1-SECPAY-SW          PIC  X.
   108     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   109     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   110     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   111     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   112     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   113     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   114     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   115     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   116     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   117     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   118     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   119     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   120     12  DD-CARR2-SECPAY-SW          PIC  X.
   121     12  FILLER                      PIC  X(7).                   ELCDTEFD
   122                                                                  ELCDTEFD
   123 01  DATE-DISK-OPT.                                               ELCDTEFD
   124     12  FILLER                      PIC  X(04).                  ELCDTEFD
   125     12  DD-TLR-DATA.                                             ELCDTEFD
   126         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   127                                     PIC  X(03).                  ELCDTEFD
   128     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   129         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   130                                     PIC  X(06).                  ELCDTEFD
   131     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   132         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   133                                     PIC  X(07).                  ELCDTEFD
   134         16  FILLER                  PIC  X(05).                  ELCDTEFD
   135     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   136                                     PIC  X(96).                  ELCDTEFD
   137******************************************************************ELCDTEFD
   138
   139 FD  PRINTX
*  140                                 COPY ELCPRTFD.
   141******************************************************************04/15/98
   142*                                                                *ELCPRTFD
   143*                                                                *ELCPRTFD
   144*                            ELCPRTFD.                           *   LV003
   145*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   146*                            VMOD=2.006                          *ELCPRTFD
   147******************************************************************ELCPRTFD
   148     RECORDING MODE F                                             ELCPRTFD
   149     LABEL RECORDS OMITTED                                        ELCPRTFD
   150     BLOCK CONTAINS 0 RECORDS
   151     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   152 01  PRT.                                                         ELCPRTFD
   153     12  P-CTL               PIC  X.                                 CL**2
   154     12  P-DATA              PIC  X(132).                         ELCPRTFD
   155******************************************************************ELCPRTFD
   156
   157 FD  FICH
*  158                                 COPY ELCFCHFD.
   159******************************************************************04/15/98
   160*                                                                *ELCFCHFD
   161*                            ELCFCHFD.                           *   LV003
   162*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   163*                            VMOD=2.004                          *   CL**3
   164*                                                                *ELCFCHFD
   165******************************************************************ELCFCHFD
   166     BLOCK CONTAINS 0 RECORDS
   167     RECORDING MODE F.                                            ELCFCHFD
   168                                                                  ELCFCHFD
   169 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   170******************************************************************ELCFCHFD
   171
   172 FD  ERARCH.
   173
   174 01  ERARCH-IN-RECORD.
   175     12  FILLER                  PIC XX.
   176     12  ERARCH-KEY              PIC X(5).
   177     12  FILLER                  PIC X(243).
   178
   179 SD  SORTFL.
   180
   181 01  SRT-REC.
   182     12  SRT-REC-TYPE            PIC X.
   183     12  SRT-ARCH-REC.
   184         16  FILLER              PIC X(73).
   185         16  SRT-PROC-ID         PIC X(4).
   186         16  FILLER              PIC X(173).
   187
   188 FD  PENDING-EXTRACT
   189     LABEL RECORDS ARE STANDARD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* EL551NS.cbl
   190     RECORDING MODE IS F
   191     BLOCK CONTAINS 0 RECORDS.
   192 01  PENDING-RECORD              PIC X(250).
   193
   194 FD  ACTIVITY-EXTRACT
   195     LABEL RECORDS ARE STANDARD
   196     RECORDING MODE IS F
   197     BLOCK CONTAINS 0 RECORDS.
   198 01  ACTIVITY-RECORD             PIC X(250).
   199
   200 WORKING-STORAGE SECTION.
   201 77  FILLER  PIC X(32) VALUE '********************************'.
   202 77  FILLER  PIC X(32) VALUE '      EL551NS WORKING STORAGE   '.
   203 77  FILLER  PIC X(32) VALUE '********************************'.
   204 77  WS-CURRENT-BIN-DATE         PIC XX  VALUE LOW-VALUES.
   205 77  WS-CURRENT-DATE-PLUS-5      PIC XX  VALUE LOW-VALUES.
   206 77  WS-CURRENT-DATE-MINUS-5     PIC XX  VALUE LOW-VALUES.
   207 77  WS-PASS-RESEND-DT           PIC XX  VALUE LOW-VALUES.
   208 77  WS-EOF-SW                   PIC X  VALUE SPACES.
   209     88  END-OF-ERARCH              VALUE 'Y'.
   210     88  MORE-ERARCH                VALUE 'N'.
   211 77  WS-A                       PIC S9(03) COMP-3 VALUE +0.
   212 77  IYR                         PIC S9(03) COMP-3 VALUE +0.
   213 77  VYR                         PIC S9(03) COMP-3 VALUE +0.
   214 77  PAGE-CTR                    PIC S9(07) VALUE +0  COMP-3.
   215 77  LINE-CTR                    PIC S9(03) VALUE +99 COMP-3.
   216 77  SPACE-NP                    PIC X      VALUE '1'.
   217 77  SPACE-1                     PIC X      VALUE ' '.
   218 77  SPACE-2                     PIC X      VALUE '0'.
   219 77  SPACE-3                     PIC X      VALUE '-'.
   220 77  X                           PIC X      VALUE ' '.
   221 77  LNCTR                       PIC S999   VALUE +60 COMP-3.
   222 77  PGCTR                       PIC S9(5)  VALUE +0 COMP-3.
   223 77  ERARCH-IN-CNT               PIC 9(11)   VALUE ZEROS.
   224 77  RETURN-CNT                  PIC 9(11)   VALUE ZEROS.
   225 77  RELEASE-CNT                 PIC 9(11)   VALUE ZEROS.
   226 77  WS-SAVE-PROC-ID             PIC X(04)   VALUE SPACES.
   227 77  WS-HOLD-TYPE                PIC X(20)   VALUE SPACES.
   228 77  WS-PREV-REC-TYPE            PIC X       VALUE ' '.
   229 77  WS-DAY-OF-WEEK              PIC S9      VALUE ZEROS.
   230 77  WS-NEXT-CYCLE-BIN           PIC XX      VALUE LOW-VALUES.
   231 77  WS-CURR-CYCLE-BIN           PIC XX      VALUE LOW-VALUES.
   232
   233 01  HDA-1.
   234     12  FILLER              PIC  X(44)      VALUE SPACES.
   235     12  FILLER              PIC  X(42)      VALUE
   236             '      PENDING CORRESPONDENCE REPORT       '.
   237     12  FILLER              PIC  X(31)      VALUE SPACES.
   238     12  FILLER              PIC  X(08)      VALUE 'EL551A '.
   239
   240 01  HDB-1.
   241     12  FILLER              PIC  X(44)      VALUE SPACES.
   242     12  FILLER              PIC  X(42)      VALUE
   243             '      CORRESPONDENCE ACTIVITY REPORT      '.
   244     12  FILLER              PIC  X(31)      VALUE SPACES.
   245     12  FILLER              PIC  X(08)      VALUE 'EL551B '.
   246
   247 01  HD2.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* EL551NS.cbl
   248     12  FILLER              PIC  X(51)      VALUE SPACES.
   249     12  HD-CO               PIC  X(30).
   250     12  FILLER              PIC  X(38)      VALUE SPACES.
   251     12  HD-RUN-DT           PIC  X(08)      VALUE SPACES.
   252
   253 01  HD3.
   254     12  FILLER              PIC  X(57)      VALUE SPACES.
   255     12  HD-DT               PIC  X(18).
   256     12  FILLER              PIC  X(44)      VALUE SPACES.
   257     12  FILLER              PIC  X(05)      VALUE 'PAGE '.
   258     12  HD-PG               PIC ZZ,ZZ9.
   259
   260 01  HD4.
   261     12  FILLER              PIC X(15)   VALUE SPACES.
   262     12  FILLER              PIC X(15)   VALUE 'PROCESSOR ID - '.
   263     12  HD4-PROC-ID         PIC X(4)    VALUE SPACES.
   264
   265 01  HDA-5.
   266     12  FILLER                  PIC X(098)  VALUE
   267         '      CERT       ACCT            FORM  ARCHIVE  ORIG
   268-        '  ORIG  RESEND SCHEDULED            FINAL '.
   269
   270 01  HDA-6.
   271     12  FILLER                  PIC X(121)  VALUE
   272         ' CAR NUMBER      NUMBER    SRCE  TYPE  NUMBER  CREATED
   273-        ' PRINT   FORM  TO RESEND  RESENT   ACTION  CSR   TYPE
   274-        '   STATUS'.
   275
   276 01  HDB-5.
   277     12  FILLER                  PIC X(126)  VALUE
   278         '      CERT       ACCT            FORM  ARCHIVE  ORIG
   279-        '  ORIG     SCHEDULED            FINAL      ACTIVITY  ACT
   280-        'IVITY  CURRENT'.
   281
   282 01  HDB-6.
   283     12  FILLER                  PIC X(126)  VALUE
   284         ' CAR NUMBER      NUMBER    SRCE  TYPE  NUMBER  CREATED
   285-        ' PRINT      RE-SEND   RESENT   ACTION  CSR   TYPE     DA
   286-        'TE      STATUS'.
   287
   288
   289 01  WS-DETAIL                   PIC X(133)  VALUE SPACES.
   290
   291 01  WS-DETAILA REDEFINES WS-DETAIL.
   292     12  FILLER                  PIC XX.
   293     12  WS-DA-CARRIER           PIC X.
   294     12  FILLER                  PIC X.
   295     12  WS-DA-CERT-NO           PIC X(11).
   296     12  FILLER                  PIC X.
   297     12  WS-DA-ACCT-NO           PIC X(10).
   298     12  FILLER                  PIC X.
   299     12  WS-DA-DATA-SOURCE       PIC X(4).
   300     12  FILLER                  PIC XX.
   301     12  WS-DA-FORM-TYPE         PIC X(4).
   302     12  FILLER                  PIC X.
   303     12  WS-DA-ARCHIVE-NO        PIC Z(7)9.
   304     12  WS-DA-ARCHIVE-NO-X          REDEFINES
   305         WS-DA-ARCHIVE-NO        PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* EL551NS.cbl
   306     12  FILLER                  PIC X.
   307     12  WS-DA-ORIG-CREATE-DT    PIC X(8).
   308     12  FILLER                  PIC XX.
   309     12  WS-DA-ORIG-PRINT-DT     PIC X(8).
   310     12  FILLER                  PIC X.
   311     12  WS-DA-RESEND-FORM       PIC X(4).
   312     12  FILLER                  PIC XX.
   313     12  WS-DA-RESEND-SCHED      PIC X(8).
   314     12  FILLER                  PIC X.
   315     12  WS-DA-RESENT            PIC X(8).
   316     12  F                       PIC X.
   317     12  WS-DA-FINAL-ACTION-DT   PIC X(8).
   318     12  F                       PIC X.
   319     12  WS-DA-CSR               PIC X(4).
   320     12  F                       PIC XX.
   321     12  WS-DA-TYPE              PIC X(9).
   322     12  F                       PIC X.
   323     12  WS-DA-STATUS            PIC X(10).
   324
   325 01  WS-DETAILB REDEFINES WS-DETAIL.
   326     12  FILLER                  PIC XX.
   327     12  WS-DB-CARRIER           PIC X.
   328     12  FILLER                  PIC X.
   329     12  WS-DB-CERT-NO           PIC X(11).
   330     12  FILLER                  PIC X.
   331     12  WS-DB-ACCT-NO           PIC X(10).
   332     12  FILLER                  PIC X.
   333     12  WS-DB-DATA-SOURCE       PIC X(4).
   334     12  FILLER                  PIC XX.
   335     12  WS-DB-FORM-TYPE         PIC X(4).
   336     12  FILLER                  PIC X.
   337     12  WS-DB-ARCHIVE-NO        PIC Z(7)9.
   338     12  WS-DB-ARCHIVE-NO-X          REDEFINES
   339         WS-DB-ARCHIVE-NO        PIC X(8).
   340     12  FILLER                  PIC X.
   341     12  WS-DB-ORIG-CREATE-DT    PIC X(8).
   342     12  FILLER                  PIC XX.
   343     12  WS-DB-ORIG-PRINT-DT     PIC X(8).
   344     12  FILLER                  PIC XXX.
   345     12  WS-DB-RESEND-SCHED      PIC X(8).
   346     12  FILLER                  PIC XX.
   347     12  WS-DB-RESENT            PIC X(8).
   348     12  F                       PIC X.
   349     12  WS-DB-FINAL-ACTION-DT   PIC X(8).
   350     12  F                       PIC X.
   351     12  WS-DB-CSR               PIC X(4).
   352     12  F                       PIC X.
   353     12  WS-DB-TYPE              PIC X(8).
   354     12  F                       PIC X.
   355     12  WS-DB-ACTIVITY-DT       PIC X(8).
   356     12  F                       PIC XX.
   357     12  WS-DB-STATUS            PIC X(10).
   358
   359 01  WS-REPORT-WORK.
   360     12  WS-CARRIER              PIC X.
   361     12  WS-CERT-NO              PIC X(11).
   362     12  WS-ACCT-NO              PIC X(10).
   363     12  WS-DATA-SOURCE          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* EL551NS.cbl
   364     12  WS-FORM-TYPE            PIC X(4).
   365     12  WS-ARCHIVE-NO           PIC Z(7)9.
   366     12  WS-ARCHIVE-NO-X             REDEFINES
   367         WS-ARCHIVE-NO           PIC X(8).
   368     12  WS-ORIG-CREATE-DT       PIC X(8).
   369     12  WS-ORIG-PRINT-DT        PIC X(8).
   370     12  WS-RESEND-FORM          PIC X(4).
   371     12  WS-RESEND-SCHED         PIC X(8).
   372     12  WS-RESENT               PIC X(8).
   373     12  WS-FINAL-ACTION-DT      PIC X(8).
   374     12  WS-CSR                  PIC X(4).
   375     12  WS-TYPE                 PIC X(9).
   376     12  WS-STATUS               PIC X(10).
   377     12  WS-ACTIVITY-DT          PIC X(8).
   378
   379 01  WS-MISC.
   380     05  ERARCH-FILE-STATUS      PIC XX.
   381     05  WS-HOLD-PRT             PIC X(133).
   382     05  INTERMED                PIC S9(9)V9(6)  COMP-3.
   383     05  WS-BIN-CR-DT            PIC XX  VALUE LOW-VALUES.
   384     05  WS-BIN-LF-END-DATE      PIC XX  VALUE LOW-VALUES.
   385     05  WS-BIN-AH-END-DATE      PIC XX  VALUE LOW-VALUES.
   386     05  WS-END-YEAR             PIC 9(11)  VALUE ZEROS.
   387     05  FILLER REDEFINES WS-END-YEAR.
   388         10  WS-CCYY             PIC 9(7).
   389         10  WS-MMDD             PIC 9(4).
   390 01  WS-DEBUG-AREA.
   391     12  WS-DEBUG-SW             PIC X(01) VALUE ' '.
   392         88  DEBUG-IS-ON                VALUES '1' '2' '3' '4'.
   393         88  DEBUG-LF-INFORCE-CNT       VALUE '1'.
   394         88  DEBUG-AH-INFORCE-CNT       VALUE '2'.
   395         88  DEBUG-LF-STATUTORY         VALUE '3'.
   396         88  DEBUG-AH-STATUTORY         VALUE '4'.
   397
   398 01  WS-ABEND-AREA.
   399     05  WS-ABEND-FILE-STATUS    PIC X(02).
   400     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
   401     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
   402     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
   403
   404 01  WORK-ABEND-CODE.
   405     12  WAC-1                   PIC X.
   406     12  WAC-2                   PIC X.
   407     12  WAC-3-4.
   408         16  WAC-3               PIC X.
   409         16  WAC-4               PIC X.
   410
   411 01  DATE-AREAS.
   412     05  WS-NEXT-WORK-DT         PIC XX.
   413     05  WS-CURR-WORK-DT         PIC XX.
   414     05  WS-TEST-RUN-DATE        PIC 9(11).
   415     05  WS-WORK-DATE            PIC 9(11).
   416     05  FILLER REDEFINES WS-WORK-DATE.
   417         10  FILLER              PIC XXX.
   418         10  WS-WORK-CCYY        PIC 9(4).
   419         10  WS-WORK-MMDD        PIC 9(4).
   420     05  WS-ISSUE-DATE           PIC 9(11).
   421     05  FILLER REDEFINES WS-ISSUE-DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* EL551NS.cbl
   422         10  FILLER              PIC XXX.
   423         10  WS-ISSUE-CCYY       PIC 9(4).
   424         10  WS-ISSUE-MMDD       PIC 9(4).
   425     05  WS-EXPIRE-DATE          PIC 9(11).
   426     05  FILLER REDEFINES WS-EXPIRE-DATE.
   427         10  FILLER              PIC XXX.
   428         10  WS-EXPIRE-CCYY      PIC 9(4).
   429         10  WS-EXPIRE-MMDD      PIC 9(4).
   430     05  WS-ENTRY-DATE           PIC 9(11).
   431     05  FILLER REDEFINES WS-ENTRY-DATE.
   432         10  FILLER              PIC XXX.
   433         10  WS-ENTRY-CCYY       PIC 9(4).
   434         10  WS-ENTRY-MMDD       PIC 9(4).
   435     05  WS-CANCEL-DATE          PIC 9(11).
   436     05  FILLER REDEFINES WS-CANCEL-DATE.
   437         10  FILLER              PIC XXX.
   438         10  WS-CANCEL-CCYY      PIC 9(4).
   439         10  WS-CANCEL-MMDD      PIC 9(4).
   440     05  WS-CLAIM-DATE           PIC 9(11).
   441     05  FILLER REDEFINES WS-CLAIM-DATE.
   442         10  FILLER              PIC XXX.
   443         10  WS-CLAIM-CCYY       PIC 9(4).
   444         10  WS-CLAIM-MMDD       PIC 9(4).
   445     05  WS-POSTING-DATE         PIC X(8).
   446     05  WS-HI-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
   447     05  WS-LO-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
   448     05  WS-HI-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
   449     05  WS-LO-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
   450     05  WS-BIN-VAL-DATES OCCURS 50
   451                                 PIC XX.
   452
   453 01  ABEND-FIELDS.
   454     12  PGM-SUB                 PIC S999 COMP  VALUE +064.
   455     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
   456         88  FIRST-TIME                 VALUE 'Y'.
   457
*  458                                 COPY ERCARCH.
   459******************************************************************04/19/98
   460*                                                                *ERCARCH
   461*                            ERCARCH.                            *   LV002
   462*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   463*                            VMOD=2.002                          *   CL**2
   464*                                                                *ERCARCH
   465*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *ERCARCH
   466*                                                                *ERCARCH
   467*   FILE TYPE = VSAM,KSDS                                        *ERCARCH
   468*   RECORD SIZE = 250  RECFORM = FIXED                           *ERCARCH
   469*                                                                *ERCARCH
   470*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *ERCARCH
   471*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *ERCARCH
   472*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *ERCARCH
   473*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *ERCARCH
   474*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *ERCARCH
   475*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *ERCARCH
   476*                                                                *ERCARCH
   477*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCARCH
   478******************************************************************ERCARCH
   479*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* EL551NS.cbl (/apps/prod/cid1p/copy/ERCARCH)
   480*
   481* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   482*-----------------------------------------------------------------
   483*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   484* EFFECTIVE    NUMBER
   485*-----------------------------------------------------------------
   486* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   487* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
   488* 110612    2012101700002  AJRA  ADD NEW FIELDS
   489******************************************************************
   490 01  LETTER-ARCHIVE.                                              ERCARCH
   491     12  LA-RECORD-ID                PIC  X(02).                  ERCARCH
   492         88  LA-VALID-ID                VALUE 'LA'.               ERCARCH
   493                                                                  ERCARCH
   494     12  LA-CONTROL-PRIMARY.                                      ERCARCH
   495         16  LA-COMPANY-CD           PIC  X(01).                  ERCARCH
   496         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.          ERCARCH
   497                                                                  ERCARCH
   498     12  LA-CONTROL-BY-CERT-RESP.                                 ERCARCH
   499         16  LA-COMPANY-CD-A2        PIC  X(01).                  ERCARCH
   500         16  LA-CERT-NO-A2.                                       ERCARCH
   501             20  LA-CERT-PRIME-A2    PIC  X(10).                  ERCARCH
   502             20  LA-CERT-SUFFIX-A2   PIC  X(01).                  ERCARCH
   503         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.            ERCARCH
   504             20  LA-RESP-PERSON-A2   PIC  X(10).                  ERCARCH
   505             20  LA-TYPE-A2          PIC  X(01).                  ERCARCH
   506         16  LA-CARRIER-A2           PIC  X(01).                  ERCARCH
   507         16  LA-GROUPING-A2          PIC  X(06).                  ERCARCH
   508         16  LA-STATE-A2             PIC  X(02).                  ERCARCH
   509         16  LA-ACCOUNT-A2           PIC  X(10).                  ERCARCH
   510         16  LA-EFFECT-DATE-A2       PIC  X(02).                  ERCARCH
   511         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.          ERCARCH
   512                                                                  ERCARCH
   513     12  LA-CONTROL-BY-FORM.                                      ERCARCH
   514         16  LA-COMPANY-CD-A3        PIC  X(01).                  ERCARCH
   515         16  LA-FORM-A3              PIC  X(04).                  ERCARCH
   516         16  LA-CARRIER-A3           PIC  X(01).                  ERCARCH
   517         16  LA-GROUPING-A3          PIC  X(06).                  ERCARCH
   518         16  LA-STATE-A3             PIC  X(02).                  ERCARCH
   519         16  LA-ACCOUNT-A3           PIC  X(10).                  ERCARCH
   520         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.          ERCARCH
   521                                                                  ERCARCH
   522     12  LA-CONTROL-BY-PROCESSOR.                                 ERCARCH
   523         16  LA-COMPANY-CD-A4        PIC  X(01).                  ERCARCH
   524         16  LA-PROCESSOR-CD         PIC  X(04).                  ERCARCH
   525         16  LA-CARRIER-A4           PIC  X(01).                  ERCARCH
   526         16  LA-GROUPING-A4          PIC  X(06).                  ERCARCH
   527         16  LA-STATE-A4             PIC  X(02).                  ERCARCH
   528         16  LA-ACCOUNT-A4           PIC  X(10).                  ERCARCH
   529         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.          ERCARCH
   530                                                                  ERCARCH
   531     12  LA-CONTROL-BY-KEY-FIELDS.                                ERCARCH
   532         16  LA-COMPANY-CD-A5        PIC  X(01).                  ERCARCH
   533         16  LA-CARRIER-A5           PIC  X(01).                  ERCARCH
   534         16  LA-GROUPING-A5          PIC  X(06).                  ERCARCH
   535         16  LA-STATE-A5             PIC  X(02).                  ERCARCH
   536         16  LA-ACCOUNT-A5           PIC  X(10).                  ERCARCH
   537         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.          ERCARCH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* EL551NS.cbl (/apps/prod/cid1p/copy/ERCARCH)
   538                                                                  ERCARCH
   539     12  LA-CONTROL-BY-GROUP-CODE.                                ERCARCH
   540         16  LA-COMPANY-CD-A6        PIC  X(01).                  ERCARCH
   541         16  LA-ENTRY-A6.                                         ERCARCH
   542             20  LA-FILLER           PIC  X(02).                  ERCARCH
   543             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.          ERCARCH
   544         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.          ERCARCH
   545                                                                  ERCARCH
   546     12  FILLER                      PIC  X(09).                  ERCARCH
   547                                                                  ERCARCH
   548     12  LA-HEADER-RECORD.                                        ERCARCH
   549         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.          ERCARCH
   550         16  LA-CREATION-DATE        PIC  X(02).                  ERCARCH
   551         16  LA-FOLLOW-UP-DATE       PIC  X(02).                  ERCARCH
   552         16  LA-FINAL-ACT-DATE       REDEFINES
   553               LA-FOLLOW-UP-DATE     PIC  X(02).
   554         16  LA-INITIAL-PRINT-DATE   PIC  X(02).                  ERCARCH
   555         16  LA-NO-OF-COPIES         PIC S9(01).                  ERCARCH
   556         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.          ERCARCH
   557         16  LA-REPLY-DATE           PIC  X(02).                  ERCARCH
   558         16  LA-RESEND-DATES.                                     ERCARCH
   559             20  LA-RESEND-DATE      PIC  X(02).                  ERCARCH
   560             20  LA-SENT-DATE        PIC  X(02).                  ERCARCH
   561             20  FILLER              PIC  X(08).
   562         16  LA-SOURCE-INFORMATION.                               ERCARCH
   563             20  LA-DATA-SOURCE      PIC  X(01).                  ERCARCH
   564             20  LA-ADDR-SOURCE      PIC  X(01).                  ERCARCH
   565         16  LA-STATUS               PIC  X(01).                  ERCARCH
   566             88  LA-STATUS-ACTIVE         VALUE 'A'.              ERCARCH
   567             88  LA-STATUS-COMPLETED      VALUE 'C'.              ERCARCH
   568             88  LA-STATUS-ON-HOLD        VALUE 'H'.              ERCARCH
   569             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.              ERCARCH
   570             88  LA-STATUS-PURGED         VALUE 'P'.              ERCARCH
   571             88  LA-STATUS-VOIDED         VALUE 'V'.              ERCARCH
   572         16  LA-LAST-RESENT-PRINT-DATE                            ERCARCH
   573                                     PIC  X(02).                  ERCARCH
   574         16  LA-PRINT-RESTRICTION    PIC  X(01).                  ERCARCH
   575             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN                    ERCARCH
   576                                          VALUE 'C'.              ERCARCH
   577             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN                    ERCARCH
   578                                          VALUE 'F'.              ERCARCH
   579             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN                    ERCARCH
   580                                          VALUE 'P'.              ERCARCH
   581         16  LA-PURGED-DATE          PIC  X(02).                  ERCARCH
   582         16  LA-VOIDED-DATE          PIC  X(02).
   583         16  LA-RESEND-LETR          PIC  X(4).
   584         16  FILLER                  PIC  X(08).
   585*        16  LA-RESEND-LETR-2        PIC  X(4).
   586*        16  LA-RESEND-LETR-3        PIC  X(4).
   587*        16  FILLER                  PIC  X(59).
   588         16  LA-ARCHIVE-STATUS       PIC  X.
   589             88  LA-TEMP                VALUE 'T'.
   590             88  LA-QWS                 VALUE 'Q'.
   591             88  LA-BATCH               VALUE 'B'.
   592         16  LA-FINAL-ACT-IND        PIC  X(1).
   593         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
   594         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
   595         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* EL551NS.cbl (/apps/prod/cid1p/copy/ERCARCH)
   596                                     PIC X(4).
   597         16  FILLER                  PIC  X(42).
   598*        16  FILLER                  PIC  X(71).                  ERCARCH
   599         16  LA-LAST-MAINT-DATE      PIC  X(2).
   600         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
   601         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
   602                                     PIC  X(4).
   603         16  LA-LAST-UPDATED-BY      PIC  X(4).
   604                                                                  ERCARCH
   605******************************************************************ERCARCH
   606
*  607                                 COPY ELCDATE.
   608******************************************************************06/11/98
   609*                                                                *ELCDATE
   610*                                                                *ELCDATE
   611*                            ELCDATE.                            *   LV023
   612*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   613*                            VMOD=2.003                           ELCDATE
   614*                                                                *ELCDATE
   615*                                                                *ELCDATE
   616*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   617*                 LENGTH = 200                                   *   CL*19
   618******************************************************************ELCDATE
   619                                                                  ELCDATE
   620 01  DATE-CONVERSION-DATA.                                        ELCDATE
   621     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   622     12  DC-OPTION-CODE                PIC X.                        CL*15
   623         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   624         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   625         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   626         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   627         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   628         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   629         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   630         88  FIND-CENTURY               VALUE '7'.                   CL*22
   631         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   632         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   633         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   634         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   635         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   636         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   637         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   638         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   639         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   640         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   641         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   642         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   643         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   644         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   645         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   646         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   647         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   648         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   649         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   650         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   651         88  THREE-CHARACTER-BIN                                  ELCDATE
   652                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   653         88  GREGORIAN-TO-BIN                                        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDATE)
   654                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   655         88  BIN-TO-GREGORIAN                                        CL**2
   656                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   657         88  JULIAN-TO-BINARY                                        CL**2
   658                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   659     12  DC-ERROR-CODE                 PIC X.                        CL*15
   660         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   661         88  DATE-CONVERSION-ERROR                                ELCDATE
   662                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   663         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   664         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   665         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   666         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   667         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   668         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   669         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   670         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   671         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   672         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   673     12  DC-END-OF-MONTH               PIC X.                        CL*15
   674         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   675     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   676         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   677         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   678         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   679     12  FILLER                        PIC X.                        CL*15
   680     12  DC-CONVERSION-DATES.                                        CL*15
   681         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   682         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   683         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   684         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   685                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   686             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   687             20  SLASH1-1              PIC X.                        CL*15
   688             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   689             20  SLASH1-2              PIC X.                        CL*15
   690             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   691         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   692         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   693                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   694             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   695             20  SLASH2-1              PIC X.                        CL*15
   696             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   697             20  SLASH2-2              PIC X.                        CL*15
   698             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   699         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   700         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   701                     DC-GREG-DATE-1-YMD.                          ELCDATE
   702             20  DC-YMD-YEAR           PIC 99.                       CL*15
   703             20  DC-YMD-MONTH          PIC 99.                       CL*15
   704             20  DC-YMD-DAY            PIC 99.                       CL*15
   705         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   706         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   707                      DC-GREG-DATE-1-MDY.                         ELCDATE
   708             20  DC-MDY-MONTH          PIC 99.                       CL*15
   709             20  DC-MDY-DAY            PIC 99.                       CL*15
   710             20  DC-MDY-YEAR           PIC 99.                       CL*15
   711         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDATE)
   712             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   713             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   714             20  FILLER                PIC XX.                       CL*15
   715             20  DC-ALPHA-CENTURY.                                   CL*15
   716                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   717             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   718         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   719         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   720         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   721         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   722         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   723                                       PIC 9(05).                    CL*20
   724         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   725             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   726             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   727         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   728         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   729         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   730     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   731         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   732         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   733             20  FILLER                PIC 9(3).                     CL*15
   734             20  HOLD-CEN-1-CCYY.                                    CL*15
   735                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   736                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   737             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   738             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   739         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   740             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   741             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   742             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   743                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   744                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   745             20  FILLER                PIC 9(3).                     CL*15
   746         16  HOLD-CENTURY-1-X.                                       CL*15
   747             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   748             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   749                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   750                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   751             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   752             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   753         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   754             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   755             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   756             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   757                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   758                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   759             20  FILLER                PIC XXX.                      CL*23
   760         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   761         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   762         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   763         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   764             20  DC-JULIAN-1-CCYY.                                   CL*15
   765                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   766                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   767             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   768         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   769         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDATE)
   770             20  DC-JULIAN-2-CCYY.                                   CL*15
   771                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   772                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   773             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   774         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   775             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   776             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   777             20  DC-EDITA-DAY          PIC 99.                       CL*15
   778             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   779             20  DC-EDITA-CCYY.                                      CL*15
   780                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   781                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   782         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   783             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   784             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   785             20  DC-EDITB-DAY          PIC 99.                       CL*15
   786             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   787             20  DC-EDITB-CCYY.                                      CL*15
   788                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   789                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   790         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   791         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   792                              DC-GREG-DATE-CYMD.                  ELCDATE
   793             20  DC-CYMD-CEN           PIC 99.                       CL*15
   794             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   795             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   796             20  DC-CYMD-DAY           PIC 99.                       CL*15
   797         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   798         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   799                              DC-GREG-DATE-MDCY.                  ELCDATE
   800             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   801             20  DC-MDCY-DAY           PIC 99.                       CL*15
   802             20  DC-MDCY-CEN           PIC 99.                       CL*15
   803             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   804    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   805        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   806    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   807    12  FILLER                         PIC X(28).                    CL*26
*  808                                 COPY ELCDTECX.
   809******************************************************************06/05/98
   810*                                                                *ELCDTECX
   811*                            ELCDTECX.                           *   LV005
   812*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   813*                            VMOD=2.015                          *ELCDTECX
   814*                                                                *ELCDTECX
   815*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   816*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   817*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   818*                                                                *ELCDTECX
   819******************************************************************ELCDTECX
   820******************************************************************
   821*                   C H A N G E   L O G
   822*
   823* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   824*-----------------------------------------------------------------
   825*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   826* EFFECTIVE    NUMBER
   827*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   828* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   829*                                  BENEFIT CODES FROM 300 TO 900
   830* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   831* 051304    2003080800002  SMVA  ADD REFUND METHOD
   832* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   833******************************************************************
   834 01  DATE-CARD.                                                   ELCDTECX
   835     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   836     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   837     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   838     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   839     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   840     12  EP-SW                       PIC  X.                      ELCDTECX
   841         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   842     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   843         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   844     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   845     12  RUN-CENTURY.                                             ELCDTECX
   846         16 RUN-CENTURY-N            PIC  99.                        CL**4
   847     12  FILLER                      PIC  X.                         CL**4
   848     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   849     12  FILLER                      PIC  XXX.                    ELCDTECX
   850     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   851                                                                  ELCDTECX
   852 01  FILLER                          PIC  X(7)                       CL**6
   853                                          VALUE 'OPTIONS'.        ELCDTECX
   854 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   855     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   856     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   857     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   858         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   859         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   860     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   861     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   862     12  FILLER                      PIC  X.                      ELCDTECX
   863     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   864     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   865     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   866     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   867     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   868     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   869     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   870     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   871     12  FILLER                      PIC  X.                      ELCDTECX
   872     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   873     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   874     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   875     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   876     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   877     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   878     12  FILLER                      PIC  X.                      ELCDTECX
   879     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   880     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   881     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   882     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   883     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   884     12  DTE-R78                     PIC  X.                      ELCDTECX
   885     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   886     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   887     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   888     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   889     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   890     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   891     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   892                                     PIC  X.                      ELCDTECX
   893         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   894                                                 ' '.             ELCDTECX
   895         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   896         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   897     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   898         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   899         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   900     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   901     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   902                                     PIC  9.                         CL**4
   903     12  DTE-SYSTEM.                                              ELCDTECX
   904         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   905         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   906         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   907         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   908         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   909         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   910         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   911         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   912         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   913         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   914         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   915         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   916         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   917         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   918         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   919         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   920         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   921         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   922         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   923         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   924         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   925         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   926         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   927         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   928         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   929         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   930     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   931         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   932                                     PIC  X.                      ELCDTECX
   933     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   934                                                                  ELCDTECX
   935 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   936     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   937     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   938     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   939*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   940     12  FILLER                      PIC  X.                      ELCDTECX
   941     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   942     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   943     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   944     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   945     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   946     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   947     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   948                                                                  ELCDTECX
   949     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   950     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   951     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   952     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   953                                                                  ELCDTECX
   954     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   955     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   956     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   957     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   958                                                                  ELCDTECX
   959     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   960     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   961                                                                  ELCDTECX
   962     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   963     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   964                                                                  ELCDTECX
   965     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   966                                                                  ELCDTECX
   967 01  DATE-CARD-FACTORS.                                           ELCDTECX
   968     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   969     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   970     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   971     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   972     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   973     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   974     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   975                                                                  ELCDTECX
   976 01  FILLER                          PIC  X(12)                   ELCDTECX
   977                                          VALUE 'COMPANY NAME'.   ELCDTECX
   978 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   979     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   980         16  CNT-ID                  PIC  X.                      ELCDTECX
   981         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   982                                                                  ELCDTECX
   983 01  FILLER                          PIC  X(11)                   ELCDTECX
   984                                          VALUE 'STATE NAMES'.    ELCDTECX
   985 01  STATE-NAMES.                                                 ELCDTECX
   986     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   987         16  STATE-SUB               PIC  XX.                     ELCDTECX
   988         16  STATE-PIC1.                                          ELCDTECX
   989             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   990             20  FILLER              PIC  XXX.                    ELCDTECX
   991             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   992             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   993             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   994             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   995                                                                  ELCDTECX
   996 01  FILLER                          PIC  X(13)                   ELCDTECX
   997                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   998 01  CARRIER-NAMES.                                               ELCDTECX
   999     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1000         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1001         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1002         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1003         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1004         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1005         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1006*        16  FILLER                  PIC  X.                      ELCDTECX
  1007         16  CARRIER-SEC-PAY         PIC  X.
  1008             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1009                                                                  ELCDTECX
  1010 01  FILLER                          PIC  X(9)                       CL**6
  1011                                          VALUE 'INS TYPES'.      ELCDTECX
  1012 01  CLAS-INS-TYPES.                                              ELCDTECX
  1013*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1014     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1015         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1016         16  CLAS-I-AB3.                                          ELCDTECX
  1017             20  FILLER              PIC  X.                      ELCDTECX
  1018             20  CLAS-I-AB2.                                      ELCDTECX
  1019                 24  FILLER          PIC  X.                      ELCDTECX
  1020                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1021         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1022             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1023             20  FILLER              PIC  X.                         CL**4
  1024         16  CLAS-I-AB10.                                         ELCDTECX
  1025             20  FILLER              PIC  X(9).                   ELCDTECX
  1026             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1027         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1028         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1029         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1030         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1031             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1032         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1033         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1034         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1035         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1036         16  CLAS-I-REFUND-METHOD    PIC  X.
  1037         16  CLAS-I-MAX-BENEFITS     PIC 99.
  1038         16  FILLER                  PIC  XXX.
  1039                                                                  ELCDTECX
  1040 01  FILLER                          PIC  X(16)                   ELCDTECX
  1041                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1042 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1043     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1044                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1045         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1046         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1047         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1048         16  CLAS-MORT-DESC.                                      ELCDTECX
  1049             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1050             20  FILLER              PIC  XX.                        CL**5
  1051             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1052             20  FILLER              PIC  X.                         CL**5
  1053             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1054             20  FILLER              PIC  X.                         CL**5
  1055             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1056             20  FILLER              PIC  X.                         CL**5
  1057             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1058             20  FILLER              PIC  X(5).                      CL**6
  1059                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1060 01  FILLER                          PIC  X(15)                   ELCDTECX
  1061                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1062 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1063     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1064         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1065         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1066         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1067         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1068         16  FILLER                  PIC  X(4).                      CL**6
  1069                                                                  ELCDTECX
  1070 01  FILLER                          PIC  X(7)                       CL**6
  1071                                     VALUE 'INDEXES'.             ELCDTECX
  1072 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1073     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1074     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1075     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1076     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1077     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1078     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1079     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1080     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1081     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1082     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1083     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1084     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1085     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1086     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1087     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1088     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1089     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1090                                                                  ELCDTECX
  1091 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1092     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1093     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1094     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1095     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1096     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1097     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1098     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1099     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1100     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1101     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1102     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1103                                                                  ELCDTECX
  1104 01  FILLER                          PIC  X(13)                   ELCDTECX
  1105                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1106 01  CLAS-MISC.                                                   ELCDTECX
  1107     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1108         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1109         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1110         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1111     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1112     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1113     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1114     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1115     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1116     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1117     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1118     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1119     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1120     12  STATE-L                     PIC  XX.                     ELCDTECX
  1121     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1122     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1123     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1124         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1125         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1126     12  DTE-ABEND-WORK.                                          ELCDTECX
  1127         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1128         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1129                                                                  ELCDTECX
  1130 01  FILLER                          PIC  X(12)                   ELCDTECX
  1131                                     VALUE 'WORKING DATE'.        ELCDTECX
  1132 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1133     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1134         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1135         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1136         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1137     12  WS-CURRENT-DATE.                                         ELCDTECX
  1138         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1139         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1140         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1141         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1142         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1143     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1144         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1145         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1146                                                                  ELCDTECX
  1147 01  FILLER                          PIC  X(12)                   ELCDTECX
  1148                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1149 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1150     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1151         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1152         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1153         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1154                                                                  ELCDTECX
  1155 01  FILLER                          PIC  X(10)                   ELCDTECX
  1156                                     VALUE 'STATE TLRS'.          ELCDTECX
  1157 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1158     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1159         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1160         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1161                                                                  ELCDTECX
  1162 01  FILLER                          PIC  X(13)                   ELCDTECX
  1163                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1164 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1165     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1166         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1167                                                                  ELCDTECX
  1168 01  FILLER                          PIC  X(13)                   ELCDTECX
  1169                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1170 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1171     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1172     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1173     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1174                                     PIC  X.                         CL**5
  1175     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1176     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1177     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1178     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1179     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1180     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1181     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1182     12  FILLER                      PIC  X(75).                  ELCDTECX
  1183******************************************************************ELCDTECX
  1184*01  MISC-CARR-PCT-DATA.                                          00001521
  1185*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1186*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1187*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1188*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1189*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1190*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1191******************************************************************ELCDTECX
* 1192                                 COPY ELCDTEVR.
  1193***************************************************************** 04/15/98
  1194*                                                                *ELCDTEVR
  1195*                                                                *ELCDTEVR
  1196*                            ELCDTEVR.                           *   LV003
  1197*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1198*                            VMOD=2.001                          *   CL**2
  1199*                                                                *ELCDTEVR
  1200*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1201*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1202*                                                                *ELCDTEVR
  1203******************************************************************ELCDTEVR
  1204 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1205     05  WS-RUN-DATE.                                             ELCDTEVR
  1206         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1207         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1208         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1209             15  RUN-CC              PIC  99.                     ELCDTEVR
  1210             15  RUN-YR              PIC  99.                     ELCDTEVR
  1211         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1212         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1213     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1214            WS-RUN-DATE              PIC 9(11).                      CL**2
  1215     05  WS-EP-DT.                                                ELCDTEVR
  1216         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1217         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1218         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1219             15  EP-CC               PIC  99.                     ELCDTEVR
  1220             15  EP-YR               PIC  99.                     ELCDTEVR
  1221         10  EP-MO                   PIC  99.                     ELCDTEVR
  1222         10  EP-DA                   PIC  99.                     ELCDTEVR
  1223     05  WS-EP-DT-N REDEFINES                                        CL**2
  1224            WS-EP-DT                 PIC 9(11).                      CL**2
  1225     05  WS-DTE-CONV-DT.                                             CL**4
  1226         10  FILLER                  PIC  9(03).                     CL**4
  1227         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1228         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1229             15  DTE-CONV-CC         PIC  99.                        CL**4
  1230             15  DTE-CONV-YR         PIC  99.                        CL**4
  1231         10  DTE-CONV-MO             PIC  99.                        CL**4
  1232         10  DTE-CONV-DA             PIC  99.                        CL**4
  1233     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1234            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1235 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1236     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1237         10  FILLER                            PIC 999.           ELCDTEVR
  1238         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1239         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1240             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1241             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1242         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1243         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1244     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1245            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1246     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1247         10  FILLER                            PIC 999.           ELCDTEVR
  1248         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1249         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1250         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1251         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1252     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1253            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1254 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1255     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1256         10  FILLER                            PIC 999.           ELCDTEVR
  1257         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1258         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1259             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1260             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1261         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1262         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1263     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1264            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1265     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1266         10  FILLER                            PIC 999.           ELCDTEVR
  1267         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1268         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1269             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1270             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1271         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1272         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1273     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1274            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1275     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1276         10  FILLER                            PIC 999.           ELCDTEVR
  1277         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1278         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1279             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1280             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1281         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1282         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1283     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1284            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1285 01  WS-RATE-RECORD.                                              ELCDTEVR
  1286         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1287             10  FILLER                        PIC 999.           ELCDTEVR
  1288             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1289             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1290                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1291                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1292             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1293             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1294         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1295                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1296
  1297 LINKAGE SECTION.
  1298
  1299 01  PARM.
  1300     05  PARM-LENGTH             PIC 9(04) BINARY VALUE ZEROS.
  1301     05  PARM-CURR-CYCLE-DT      PIC X(08)     VALUE SPACES.
  1302     05  PARM-NEXT-CYCLE-DT      PIC X(08)     VALUE SPACES.
  1303
  1304 PROCEDURE DIVISION USING PARM.
  1305
  1306 0001-DT-CRD-READ.
* 1307                                 COPY ELCDTERX.
  1308******************************************************************04/15/98
  1309*                                                                *ELCDTERX
  1310*                                                                *ELCDTERX
  1311*                            ELCDTERX.                           *   LV002
  1312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1313*                            VMOD=2.007                          *ELCDTERX
  1314*                                                                *ELCDTERX
  1315*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1316*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1317*      = ELCDTEFD)                                               *ELCDTERX
  1318*                                                                *ELCDTERX
  1319******************************************************************ELCDTERX
  1320                                                                  ELCDTERX
  1321     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1322                                                                  ELCDTERX
  1323     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1324     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1325     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1326                                                                  ELCDTERX
  1327     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1328                                                                  ELCDTERX
  1329******************************************************************ELCDTERX
  1330*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1331*          WARNING MESSAGES.                                      ELCDTERX
  1332******************************************************************ELCDTERX
  1333     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1334         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1335                                                                  ELCDTERX
  1336     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1337                                                                  ELCDTERX
  1338     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1339                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1340                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1341                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1342                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1343                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1344                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1345                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1346                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1347                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1348                                                                  ELCDTERX
  1349     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1350                                                                  ELCDTERX
  1351     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1352                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1353                                                                  ELCDTERX
  1354     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1355     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1356     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1357     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1358                                                                  ELCDTERX
  1359     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1360         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1361     ELSE                                                         ELCDTERX
  1362         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1363                                                                  ELCDTERX
  1364     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1365         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1366     ELSE                                                         ELCDTERX
  1367         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1368                                                                  ELCDTERX
  1369 0005-READ--CARD.                                                 ELCDTERX
  1370     READ DISK-DATE                                               ELCDTERX
  1371         AT END CLOSE DISK-DATE                                   ELCDTERX
  1372             GO TO 0060-READ--TEST.                               ELCDTERX
  1373                                                                  ELCDTERX
  1374     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1375                                                                  ELCDTERX
  1376     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1377         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1378         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1379         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1380         GO TO 0005-READ--CARD.                                   ELCDTERX
  1381                                                                  ELCDTERX
  1382     IF DD-ID = 'CLAD'                                            ELCDTERX
  1383         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1384         GO TO 0005-READ--CARD.                                   ELCDTERX
  1385                                                                  ELCDTERX
  1386     IF DD-ID = 'CLAX'                                            ELCDTERX
  1387         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1388         GO TO 0005-READ--CARD.                                   ELCDTERX
  1389                                                                  ELCDTERX
  1390     IF DD-ID = 'CLAF'                                            ELCDTERX
  1391         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1392         GO TO 0005-READ--CARD.                                   ELCDTERX
  1393                                                                  ELCDTERX
  1394     IF DD-ID = 'CLAC'                                            ELCDTERX
  1395         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1396                                                                  ELCDTERX
  1397     IF DD-ID = 'CARR'                                            ELCDTERX
  1398         GO TO 0015-READ--CARR.                                   ELCDTERX
  1399                                                                  ELCDTERX
  1400     IF DD-ID = 'STAT'                                            ELCDTERX
  1401         GO TO 0020-READ--STAT.                                   ELCDTERX
  1402                                                                  ELCDTERX
  1403     IF DD-ID = 'BUSC'                                            ELCDTERX
  1404         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1405                                                                  ELCDTERX
  1406     IF DD-ID = 'MORT'                                            ELCDTERX
  1407         GO TO 0030-READ--MORT.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1408                                                                  ELCDTERX
  1409     IF DD-ID = 'CLAI'                                            ELCDTERX
  1410         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1411                                                                  ELCDTERX
  1412     IF DD-ID = 'COLC'                                            ELCDTERX
  1413         GO TO 0065-READ--COLC.                                   ELCDTERX
  1414                                                                  ELCDTERX
  1415     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1416        DD-IDA = 'CL'                                             ELCDTERX
  1417         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1418                                                                  ELCDTERX
  1419     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1420        DD-IDA = 'PO'                                             ELCDTERX
  1421         GO TO 0050-READ--POXX.                                   ELCDTERX
  1422                                                                  ELCDTERX
  1423     IF DD-ID = 'OPCA'                                            ELCDTERX
  1424         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1425                                                                  ELCDTERX
  1426     IF DD-ID = 'OPST'                                            ELCDTERX
  1427         GO TO 0072-READ--OPST.                                   ELCDTERX
  1428                                                                  ELCDTERX
  1429     IF DD-ID = 'OPBS'                                            ELCDTERX
  1430         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1431                                                                  ELCDTERX
  1432     IF DD-ID = 'OPMS'                                            ELCDTERX
  1433         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1434                                                                  ELCDTERX
  1435     GO TO 0005-READ--CARD.                                       ELCDTERX
  1436                                                                  ELCDTERX
  1437 0010-READ--CLAC.                                                 ELCDTERX
  1438     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1439     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1440     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1441     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1442     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1443     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1444     GO TO 0005-READ--CARD.                                       ELCDTERX
  1445                                                                  ELCDTERX
  1446 0015-READ--CARR.                                                 ELCDTERX
  1447     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1448     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1449        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1450        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1451        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1452        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1453        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1454        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1455        MOVE DD-CARR1-SECPAY-SW
  1456                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1457     END-IF
  1458                                                                  ELCDTERX
  1459     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1460     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1461        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1462        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1463        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1464        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1465        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1466        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1467        MOVE DD-CARR2-SECPAY-SW
  1468                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1469     END-IF
  1470                                                                  ELCDTERX
  1471                                                                  ELCDTERX
  1472     GO TO 0005-READ--CARD.                                       ELCDTERX
  1473                                                                  ELCDTERX
  1474 0020-READ--STAT.                                                 ELCDTERX
  1475     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1476     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1477        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1478         GO TO 0005-READ--CARD.                                   ELCDTERX
  1479                                                                  ELCDTERX
  1480     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1481     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1482     GO TO 0020-READ--STAT.                                       ELCDTERX
  1483                                                                  ELCDTERX
  1484 0025-READ--BUSC.                                                 ELCDTERX
  1485     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1486     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1487        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1488         GO TO 0005-READ--CARD.                                   ELCDTERX
  1489                                                                  ELCDTERX
  1490     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1491     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1492     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1493                                                                  ELCDTERX
  1494 0030-READ--MORT.                                                 ELCDTERX
  1495     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1496     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1497        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1498         GO TO 0005-READ--CARD.                                   ELCDTERX
  1499                                                                  ELCDTERX
  1500     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1501     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1502     GO TO 0030-READ--MORT.                                       ELCDTERX
  1503                                                                  ELCDTERX
  1504 0035-READ--CLXX.                                                 ELCDTERX
  1505     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1506          GO TO 0005-READ--CARD.                                  ELCDTERX
  1507                                                                  ELCDTERX
  1508     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1509         DISPLAY '***********************************************'ELCDTERX
  1510         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1511         DISPLAY '***********************************************'ELCDTERX
  1512         GO TO 0055-READ--STOP.                                   ELCDTERX
  1513                                                                  ELCDTERX
  1514     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1515        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1516         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1517                                                                  ELCDTERX
  1518     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1519        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1520         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1521                                                                  ELCDTERX
  1522*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1523     GO TO 0005-READ--CARD.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1524                                                                  ELCDTERX
  1525 0040-READ--CLAI.                                                 ELCDTERX
  1526     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1527     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1528        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1529         GO TO 0005-READ--CARD.                                   ELCDTERX
  1530                                                                  ELCDTERX
  1531     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1532     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1533     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1534                                                                  ELCDTERX
  1535 0045-READ--DUMP.                                                 ELCDTERX
  1536     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1537     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1538                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1539     PERFORM ABEND-PGM.                                           ELCDTERX
  1540                                                                  ELCDTERX
  1541 0050-READ--POXX.                                                 ELCDTERX
  1542     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1543         GO TO 0005-READ--CARD.                                   ELCDTERX
  1544                                                                  ELCDTERX
  1545     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1546         DISPLAY '***********************************************'ELCDTERX
  1547         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1548         DISPLAY '***********************************************'ELCDTERX
  1549         GO TO 0055-READ--STOP.                                   ELCDTERX
  1550                                                                  ELCDTERX
  1551     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1552     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1553     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1554     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1555                                                                  ELCDTERX
  1556     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1557         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1558     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1559         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1560                                                                  ELCDTERX
  1561     GO TO 0005-READ--CARD.                                       ELCDTERX
  1562                                                                  ELCDTERX
  1563 0055-READ--STOP.                                                 ELCDTERX
  1564     GOBACK.                                                      ELCDTERX
  1565                                                                  ELCDTERX
  1566 0060-READ--TEST.                                                 ELCDTERX
  1567     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1568        CLAX-ID         = SPACE  OR                               ELCDTERX
  1569        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1570         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1571                                                                  ELCDTERX
  1572     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1573     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1574                                                                  ELCDTERX
  1575 0065-READ--COLC.                                                 ELCDTERX
  1576     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1577     GO TO 0005-READ--CARD.                                       ELCDTERX
  1578                                                                  ELCDTERX
  1579 0070-READ--OPCA.                                                 ELCDTERX
  1580                                                                  ELCDTERX
  1581     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* EL551NS.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1582                                                                  ELCDTERX
  1583     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1584             OR                                                   ELCDTERX
  1585         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1586         GO TO 0005-READ--CARD.                                   ELCDTERX
  1587                                                                  ELCDTERX
  1588     ADD 1                       TO INDEXCA.                      ELCDTERX
  1589     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1590                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1591     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1592                                                                  ELCDTERX
  1593 0072-READ--OPST.                                                 ELCDTERX
  1594                                                                  ELCDTERX
  1595     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1596                                                                  ELCDTERX
  1597     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1598             OR                                                   ELCDTERX
  1599         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1600         GO TO 0005-READ--CARD.                                   ELCDTERX
  1601                                                                  ELCDTERX
  1602     ADD 1                       TO INDEXST.                      ELCDTERX
  1603     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1604                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1605     GO TO 0072-READ--OPST.                                       ELCDTERX
  1606                                                                  ELCDTERX
  1607 0074-READ--OPBS.                                                 ELCDTERX
  1608                                                                  ELCDTERX
  1609     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1610                                                                  ELCDTERX
  1611     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1612             OR                                                   ELCDTERX
  1613         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1614         GO TO 0005-READ--CARD.                                   ELCDTERX
  1615                                                                  ELCDTERX
  1616     ADD 1                       TO INDEXBS.                      ELCDTERX
  1617     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1618     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1619                                                                  ELCDTERX
  1620 0079-READ--EXIT.                                                 ELCDTERX
  1621*    EXIT.                                                        ELCDTERX
  1622******************************************************************ELCDTERX
  1623
  1624     SORT SORTFL ON ASCENDING KEY SRT-REC-TYPE SRT-PROC-ID
  1625        INPUT PROCEDURE
  1626           0001-INPUT-RTN        THRU 0001-EXIT
  1627        OUTPUT PROCEDURE
  1628           0100-OUTPUT-RTN       THRU 0100-EXIT.
  1629
  1630     IF SORT-RETURN NOT = ZEROES
  1631        MOVE +0101               TO WS-RETURN-CODE
  1632        MOVE '   SORT ABORTED'   TO WS-ABEND-MESSAGE
  1633        PERFORM ABEND-PGM
  1634     END-IF
  1635
  1636     GOBACK
  1637     .
  1638 0001-INPUT-RTN.
  1639
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* EL551NS.cbl
  1640     DISPLAY ' BEGIN SORT INPUT ROUTINE '
  1641
  1642     PERFORM 0010-OPEN-ERARCH    THRU 0010-EXIT
  1643     PERFORM 0020-INITIALIZE     THRU 0020-EXIT
  1644
  1645     PERFORM 0025-SELECT-RECS    THRU 0025-EXIT UNTIL
  1646        END-OF-ERARCH
  1647
  1648     SET MORE-ERARCH             TO TRUE
  1649     DISPLAY ' ERARCH RECORDS READ ' ERARCH-IN-CNT
  1650     DISPLAY ' RECORDS RELEASED    ' RELEASE-CNT
  1651
  1652     PERFORM 0070-CLOSE-ERARCH   THRU 0070-EXIT
  1653
  1654     .
  1655 0001-EXIT.
  1656     EXIT.
  1657
  1658 0010-OPEN-ERARCH.
  1659
  1660     OPEN INPUT ERARCH
  1661
  1662     IF ERARCH-FILE-STATUS = '00' OR '97'
  1663        CONTINUE
  1664     ELSE
  1665        DISPLAY ' ERROR ON ERARCH OPEN  '
  1666           ERARCH-FILE-STATUS
  1667        MOVE ' ERROR ON ERARCH OPEN  '
  1668                                 TO WS-ABEND-MESSAGE
  1669        MOVE ERARCH-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  1670        PERFORM ABEND-PGM
  1671     END-IF
  1672
  1673     .
  1674 0010-EXIT.
  1675     EXIT.
  1676
  1677 0020-INITIALIZE.
  1678
  1679     DISPLAY ' ACCEPT DATE ' WS-ACCEPT-DATE
  1680
  1681     MOVE WS-ACCEPT-DATE         TO DC-GREG-DATE-1-YMD
  1682     MOVE '3'                    TO DC-OPTION-CODE
  1683     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1684     IF NO-CONVERSION-ERROR
  1685        MOVE DC-BIN-DATE-1       TO WS-CURRENT-BIN-DATE
  1686                                    WS-CURR-WORK-DT
  1687        MOVE DC-DAY-OF-WEEK      TO WS-DAY-OF-WEEK
  1688     ELSE
  1689        DISPLAY ' ERROR CONVERTING CURRENT DATE '
  1690     END-IF
  1691
  1692     MOVE COMPANY-NAME           TO HD-CO
  1693*    MOVE ALPH-DATE              TO HD-DT
  1694     MOVE WS-CURRENT-DATE        TO HD-RUN-DT
  1695
  1696     MOVE RUN-DATE               TO WS-TEST-RUN-DATE
  1697
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* EL551NS.cbl
  1698     IF PARM-LENGTH = ZEROS
  1699        DISPLAY ' MISSING OR INVALID PARM '
  1700        PERFORM ABEND-PGM
  1701     END-IF
  1702
  1703     DISPLAY ' CURR CYCLE DT ' PARM-CURR-CYCLE-DT
  1704     DISPLAY ' NEXT CYCLE DT ' PARM-NEXT-CYCLE-DT
  1705     MOVE PARM-CURR-CYCLE-DT     TO DC-GREG-DATE-CYMD
  1706     MOVE 'L'                    TO DC-OPTION-CODE
  1707     MOVE +0                     TO DC-ELAPSED-DAYS
  1708                                    DC-ELAPSED-MONTHS
  1709
  1710     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1711     IF DATE-CONVERSION-ERROR
  1712        DISPLAY 'CURR CYCLE DATE CONVERSION ERROR: '
  1713           DC-ERROR-CODE  '  USING CURR DT ' PARM-CURR-CYCLE-DT
  1714     ELSE
  1715        MOVE DC-BIN-DATE-1      TO WS-CURR-CYCLE-BIN
  1716        MOVE DC-GREG-DATE-1-ALPHA   TO HD-DT
  1717     END-IF
  1718
  1719     MOVE PARM-NEXT-CYCLE-DT     TO DC-GREG-DATE-CYMD
  1720     MOVE 'L'                    TO DC-OPTION-CODE
  1721     MOVE +0                     TO DC-ELAPSED-DAYS
  1722                                    DC-ELAPSED-MONTHS
  1723
  1724     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1725     IF DATE-CONVERSION-ERROR
  1726        DISPLAY 'NEXT CYCLE DATE CONVERSION ERROR: '
  1727           DC-ERROR-CODE  '  USING NEXT DT ' PARM-NEXT-CYCLE-DT
  1728     ELSE
  1729        MOVE DC-BIN-DATE-1      TO WS-NEXT-CYCLE-BIN
  1730     END-IF
  1731
  1732     PERFORM 0050-START-ERARCH   THRU 0050-EXIT
  1733     PERFORM 0060-READ-ERARCH    THRU 0060-EXIT
  1734
  1735     .
  1736 0020-EXIT.
  1737     EXIT.
  1738
  1739 0025-SELECT-RECS.
  1740
  1741     IF LA-FORM-A3 = '9999'
  1742        GO TO 0025-CONTINUE
  1743     END-IF
  1744
  1745     IF LA-TEMP
  1746        GO TO 0025-CONTINUE
  1747     END-IF
  1748
  1749     IF WS-CURR-CYCLE-BIN = LA-INITIAL-PRINT-DATE OR LA-SENT-DATE
  1750        OR LA-PURGED-DATE OR LA-VOIDED-DATE OR LA-FINAL-ACT-DATE
  1751        OR LA-REPLY-DATE
  1752        MOVE 'A'                 TO SRT-REC-TYPE
  1753        MOVE LETTER-ARCHIVE      TO SRT-ARCH-REC
  1754        DISPLAY ' ABOUT TO RELEASE A ' LA-CERT-NO-A2
  1755        RELEASE SRT-REC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* EL551NS.cbl
  1756        ADD 1                    TO RELEASE-CNT
  1757     END-IF
  1758
  1759     IF LA-STATUS = 'A'
  1760     IF (LA-FINAL-ACT-DATE > WS-CURR-CYCLE-BIN
  1761        AND <= WS-NEXT-CYCLE-BIN)
  1762                  OR
  1763        (LA-RESEND-DATE > WS-CURR-CYCLE-BIN
  1764        AND <= WS-NEXT-CYCLE-BIN)
  1765        MOVE 'B'              TO SRT-REC-TYPE
  1766        MOVE LETTER-ARCHIVE   TO SRT-ARCH-REC
  1767        DISPLAY ' ABOUT TO RELEASE B ' LA-CERT-NO-A2
  1768        RELEASE SRT-REC
  1769        ADD 1                 TO RELEASE-CNT
  1770     END-IF
  1771     END-IF
  1772
  1773     .
  1774 0025-CONTINUE.
  1775
  1776     PERFORM 0060-READ-ERARCH    THRU 0060-EXIT
  1777
  1778     .
  1779 0025-EXIT.
  1780     EXIT.
  1781
  1782 0050-START-ERARCH.
  1783
  1784     MOVE LOW-VALUES             TO ERARCH-KEY
  1785     MOVE DTE-CLASIC-COMPANY-CD  TO ERARCH-KEY (1:1)
  1786     START ERARCH KEY >= ERARCH-KEY
  1787
  1788     IF ERARCH-FILE-STATUS = '10' OR '23'
  1789        SET END-OF-ERARCH        TO TRUE
  1790     ELSE
  1791        IF ERARCH-FILE-STATUS NOT = '00'
  1792           MOVE ' ERROR ON ERARCH  START     '
  1793                                 TO WS-ABEND-MESSAGE
  1794           MOVE ERARCH-FILE-STATUS
  1795                                 TO WS-ABEND-FILE-STATUS
  1796           DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  1797           PERFORM ABEND-PGM
  1798        END-IF
  1799     END-IF
  1800
  1801     .
  1802 0050-EXIT.
  1803     EXIT.
  1804
  1805 0060-READ-ERARCH.
  1806
  1807     READ ERARCH NEXT RECORD INTO LETTER-ARCHIVE
  1808
  1809     IF (ERARCH-FILE-STATUS = '10' OR '23')
  1810        OR (LA-COMPANY-CD NOT = DTE-CLASIC-COMPANY-CD)
  1811        SET END-OF-ERARCH        TO TRUE
  1812     ELSE
  1813        IF ERARCH-FILE-STATUS NOT = '00'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* EL551NS.cbl
  1814           MOVE ' ERROR ON ERARCH READ NEXT  '
  1815                                 TO WS-ABEND-MESSAGE
  1816           MOVE ERARCH-FILE-STATUS
  1817                                 TO WS-ABEND-FILE-STATUS
  1818           DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  1819           PERFORM ABEND-PGM
  1820        ELSE
  1821           ADD +1                TO ERARCH-IN-CNT
  1822        END-IF
  1823     END-IF
  1824
  1825     .
  1826 0060-EXIT.
  1827     EXIT.
  1828
  1829 0070-CLOSE-ERARCH.
  1830
  1831     CLOSE ERARCH
  1832
  1833     IF ERARCH-FILE-STATUS = '00' OR '97'
  1834        CONTINUE
  1835     ELSE
  1836        DISPLAY ' ERROR ON ERARCH CLOSE '
  1837           ERARCH-FILE-STATUS
  1838        MOVE ' ERROR ON ERARCH CLOSE '
  1839                                 TO WS-ABEND-MESSAGE
  1840        MOVE ERARCH-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  1841        PERFORM ABEND-PGM
  1842     END-IF
  1843
  1844     .
  1845 0070-EXIT.
  1846     EXIT.
  1847
  1848 0100-OUTPUT-RTN.
  1849
  1850     DISPLAY ' BEGIN SORT OUTPUT ROUTINE '
  1851
  1852     PERFORM 0110-OPEN-OUTPUT    THRU 0110-EXIT
  1853
  1854     PERFORM 0120-INITIALIZE     THRU 0120-EXIT
  1855
  1856     PERFORM 0130-PROCESS-FILE   THRU 0130-EXIT UNTIL
  1857        END-OF-ERARCH
  1858
  1859     PERFORM 0200-CLOSE-OUTPUT   THRU 0200-EXIT
  1860
  1861     DISPLAY ' RETURNED RECORDS   ' RETURN-CNT
  1862
  1863     .
  1864 0100-EXIT.
  1865     EXIT.
  1866
  1867 0110-OPEN-OUTPUT.
  1868
  1869     OPEN OUTPUT PRINTX PENDING-EXTRACT ACTIVITY-EXTRACT
  1870
  1871     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* EL551NS.cbl
  1872 0110-EXIT.
  1873     EXIT.
  1874
  1875 0120-INITIALIZE.
  1876
  1877     PERFORM 0170-RETURN-ERARCH  THRU 0170-EXIT
  1878
  1879     MOVE LA-PROCESSOR-CD        TO WS-SAVE-PROC-ID
  1880                                    HD4-PROC-ID
  1881     MOVE SRT-REC-TYPE           TO WS-PREV-REC-TYPE
  1882
  1883     .
  1884 0120-EXIT.
  1885     EXIT.
  1886
  1887 0130-PROCESS-FILE.
  1888
  1889     IF SRT-REC-TYPE NOT = WS-PREV-REC-TYPE
  1890        MOVE SRT-REC-TYPE        TO WS-PREV-REC-TYPE
  1891        MOVE +60                 TO LNCTR
  1892     END-IF
  1893
  1894     IF LA-PROCESSOR-CD NOT = WS-SAVE-PROC-ID
  1895        MOVE LA-PROCESSOR-CD     TO HD4-PROC-ID
  1896                                    WS-SAVE-PROC-ID
  1897        MOVE +60                 TO LNCTR
  1898     END-IF
  1899
  1900     PERFORM 0140-BUILD-COMMON   THRU 0140-EXIT
  1901
  1902     IF WS-PREV-REC-TYPE = 'A'
  1903        PERFORM 0150-REPORT-A    THRU 0150-EXIT
  1904     ELSE
  1905        PERFORM 0160-REPORT-B    THRU 0160-EXIT
  1906     END-IF
  1907
  1908     PERFORM 0170-RETURN-ERARCH  THRU 0170-EXIT
  1909
  1910     .
  1911 0130-EXIT.
  1912     EXIT.
  1913
  1914 0140-BUILD-COMMON.
  1915
  1916     MOVE SPACES                 TO WS-REPORT-WORK
  1917
  1918     MOVE LA-CARRIER-A2          TO WS-CARRIER
  1919     MOVE LA-CERT-NO-A2          TO WS-CERT-NO
  1920     MOVE LA-ACCOUNT-A2          TO WS-ACCT-NO
  1921     EVALUATE LA-DATA-SOURCE
  1922        WHEN '1'
  1923           MOVE 'ACCT'           TO WS-DATA-SOURCE
  1924        WHEN '2'
  1925           MOVE 'CERT'           TO WS-DATA-SOURCE
  1926        WHEN '3'
  1927           MOVE 'COMP'           TO WS-DATA-SOURCE
  1928        WHEN '4'
  1929           MOVE 'PEND'           TO WS-DATA-SOURCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* EL551NS.cbl
  1930        WHEN OTHER
  1931           MOVE 'ERR '           TO WS-DATA-SOURCE
  1932     END-EVALUATE
  1933
  1934     MOVE LA-FORM-A3             TO WS-FORM-TYPE
  1935     MOVE LA-ARCHIVE-NO          TO WS-ARCHIVE-NO
  1936     IF LA-CREATION-DATE NOT = LOW-VALUES AND SPACES
  1937        MOVE LA-CREATION-DATE    TO DC-BIN-DATE-1
  1938        MOVE ' '                 TO DC-OPTION-CODE
  1939        PERFORM 8500-DATE-CONVERT THRU 8590-EXIT
  1940        IF NO-CONVERSION-ERROR
  1941           MOVE DC-GREG-DATE-1-EDIT TO WS-ORIG-CREATE-DT
  1942        ELSE
  1943           MOVE ' ERROR  '       TO WS-ORIG-CREATE-DT
  1944        END-IF
  1945     ELSE
  1946        MOVE '********'          TO WS-ORIG-CREATE-DT
  1947     END-IF
  1948
  1949     IF LA-INITIAL-PRINT-DATE NOT = LOW-VALUES AND SPACES
  1950        MOVE LA-INITIAL-PRINT-DATE
  1951                                 TO DC-BIN-DATE-1
  1952        MOVE ' '                 TO DC-OPTION-CODE
  1953        PERFORM 8500-DATE-CONVERT THRU 8590-EXIT
  1954        IF NO-CONVERSION-ERROR
  1955           MOVE DC-GREG-DATE-1-EDIT TO WS-ORIG-PRINT-DT
  1956        ELSE
  1957           MOVE ' ERROR  '       TO WS-ORIG-PRINT-DT
  1958        END-IF
  1959     ELSE
  1960        MOVE '********'          TO WS-ORIG-PRINT-DT
  1961     END-IF
  1962
  1963     MOVE LA-RESEND-LETR         TO WS-RESEND-FORM
  1964
  1965     IF LA-RESEND-DATE NOT = LOW-VALUES AND SPACES
  1966        MOVE LA-RESEND-DATE      TO DC-BIN-DATE-1
  1967        MOVE ' '                 TO DC-OPTION-CODE
  1968        PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1969        IF NO-CONVERSION-ERROR
  1970           MOVE DC-GREG-DATE-1-EDIT TO WS-RESEND-SCHED
  1971        ELSE
  1972           MOVE ' ERROR  '        TO WS-RESEND-SCHED
  1973        END-IF
  1974     ELSE
  1975        MOVE '********'           TO WS-RESEND-SCHED
  1976     END-IF
  1977
  1978     IF LA-SENT-DATE NOT = LOW-VALUES AND SPACES
  1979        MOVE LA-SENT-DATE        TO DC-BIN-DATE-1
  1980        MOVE ' '                 TO DC-OPTION-CODE
  1981        PERFORM 8500-DATE-CONVERT THRU 8590-EXIT
  1982        IF NO-CONVERSION-ERROR
  1983           MOVE DC-GREG-DATE-1-EDIT TO WS-RESENT
  1984        ELSE
  1985           MOVE ' ERROR  '       TO WS-RESENT
  1986        END-IF
  1987     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  36
* EL551NS.cbl
  1988        MOVE '********'          TO WS-RESENT
  1989     END-IF
  1990
  1991     IF LA-FINAL-ACT-DATE NOT = LOW-VALUES AND SPACES
  1992        MOVE LA-FINAL-ACT-DATE   TO DC-BIN-DATE-1
  1993        MOVE ' '                 TO DC-OPTION-CODE
  1994        PERFORM 8500-DATE-CONVERT THRU 8590-EXIT
  1995        IF NO-CONVERSION-ERROR
  1996           MOVE DC-GREG-DATE-1-EDIT TO WS-FINAL-ACTION-DT
  1997        ELSE
  1998           MOVE ' ERROR  '       TO WS-FINAL-ACTION-DT
  1999        END-IF
  2000     ELSE
  2001        MOVE '********'          TO WS-FINAL-ACTION-DT
  2002     END-IF
  2003
  2004     MOVE LA-PROCESSOR-CD        TO WS-CSR
  2005
  2006     IF SRT-REC-TYPE = 'A'
  2007        EVALUATE TRUE
  2008           WHEN LA-REPLY-DATE = WS-CURR-CYCLE-BIN
  2009              MOVE 'REPLY'          TO WS-TYPE
  2010           WHEN LA-FINAL-ACT-DATE = WS-CURR-CYCLE-BIN
  2011              MOVE 'FINAL'          TO WS-TYPE
  2012           WHEN LA-VOIDED-DATE = WS-CURR-CYCLE-BIN
  2013              MOVE 'VOIDED'         TO WS-TYPE
  2014           WHEN LA-PURGED-DATE = WS-CURR-CYCLE-BIN
  2015              MOVE 'PURGED'         TO WS-TYPE
  2016           WHEN LA-SENT-DATE = WS-CURR-CYCLE-BIN
  2017              MOVE 'RESENT'         TO WS-TYPE
  2018           WHEN LA-INITIAL-PRINT-DATE = WS-CURR-CYCLE-BIN
  2019              MOVE 'INITIAL'        TO WS-TYPE
  2020        END-EVALUATE
  2021     ELSE
  2022        EVALUATE TRUE
  2023           WHEN LA-FINAL-ACT-DATE > WS-CURR-CYCLE-BIN
  2024              AND <= WS-NEXT-CYCLE-BIN
  2025              MOVE 'FINAL'       TO WS-TYPE
  2026
  2027              MOVE LA-FINAL-ACT-DATE
  2028                                 TO DC-BIN-DATE-1
  2029              MOVE ' '           TO DC-OPTION-CODE
  2030              PERFORM 8500-DATE-CONVERT THRU 8590-EXIT
  2031              IF NO-CONVERSION-ERROR
  2032                 MOVE DC-GREG-DATE-1-EDIT
  2033                                 TO WS-ACTIVITY-DT
  2034              ELSE
  2035                 MOVE '********' TO WS-ACTIVITY-DT
  2036              END-IF
  2037           WHEN LA-RESEND-DATE > WS-CURR-CYCLE-BIN
  2038              AND <= WS-NEXT-CYCLE-BIN
  2039              MOVE 'RESEND'      TO WS-TYPE
  2040              MOVE LA-RESEND-DATE
  2041                                 TO DC-BIN-DATE-1
  2042              MOVE ' '           TO DC-OPTION-CODE
  2043              PERFORM 8500-DATE-CONVERT THRU 8590-EXIT
  2044              IF NO-CONVERSION-ERROR
  2045                 MOVE DC-GREG-DATE-1-EDIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  37
* EL551NS.cbl
  2046                                 TO WS-ACTIVITY-DT
  2047              ELSE
  2048                 MOVE '********' TO WS-ACTIVITY-DT
  2049              END-IF
  2050        END-EVALUATE
  2051     END-IF
  2052
  2053     EVALUATE LA-STATUS
  2054        WHEN 'A'
  2055           MOVE 'ACTIVE'         TO WS-STATUS
  2056        WHEN 'C'
  2057           MOVE 'COMPLETE'       TO WS-STATUS
  2058        WHEN 'H'
  2059           MOVE 'ON HOLD'        TO WS-STATUS
  2060        WHEN 'X'
  2061           MOVE 'TO BE PURGED'   TO WS-STATUS
  2062        WHEN 'P'
  2063           MOVE 'PURGED'         TO WS-STATUS
  2064        WHEN 'V'
  2065           MOVE 'VOIDED'         TO WS-STATUS
  2066        WHEN OTHER
  2067           MOVE 'INVALID'        TO WS-STATUS
  2068     END-EVALUATE
  2069
  2070
  2071     .
  2072 0140-EXIT.
  2073     EXIT.
  2074
  2075 0150-REPORT-A.
  2076
  2077     MOVE SPACES                 TO WS-DETAILA
  2078     MOVE WS-CARRIER             TO WS-DA-CARRIER
  2079     MOVE WS-CERT-NO             TO WS-DA-CERT-NO
  2080     MOVE WS-ACCT-NO             TO WS-DA-ACCT-NO
  2081     MOVE WS-DATA-SOURCE         TO WS-DA-DATA-SOURCE
  2082     MOVE WS-FORM-TYPE           TO WS-DA-FORM-TYPE
  2083     MOVE WS-ARCHIVE-NO-X        TO WS-DA-ARCHIVE-NO-X
  2084     MOVE WS-ORIG-CREATE-DT      TO WS-DA-ORIG-CREATE-DT
  2085     MOVE WS-ORIG-PRINT-DT       TO WS-DA-ORIG-PRINT-DT
  2086     MOVE WS-RESEND-FORM         TO WS-DA-RESEND-FORM
  2087     MOVE WS-RESEND-SCHED        TO WS-DA-RESEND-SCHED
  2088     MOVE WS-RESENT              TO WS-DA-RESENT
  2089     MOVE WS-FINAL-ACTION-DT     TO WS-DA-FINAL-ACTION-DT
  2090     MOVE WS-CSR                 TO WS-DA-CSR
  2091     MOVE WS-TYPE                TO WS-DA-TYPE
  2092     MOVE WS-STATUS              TO WS-DA-STATUS
  2093
  2094     MOVE WS-DETAILA             TO P-DATA
  2095     MOVE SPACE-1                TO P-CTL
  2096     PERFORM 8800-PRT-RTN        THRU 8800-EXIT
  2097
  2098     .
  2099 0150-EXIT.
  2100     EXIT.
  2101
  2102
  2103 0160-REPORT-B.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  38
* EL551NS.cbl
  2104
  2105     MOVE SPACES                 TO WS-DETAILB
  2106     MOVE WS-CARRIER             TO WS-DB-CARRIER
  2107     MOVE WS-CERT-NO             TO WS-DB-CERT-NO
  2108     MOVE WS-ACCT-NO             TO WS-DB-ACCT-NO
  2109     MOVE WS-DATA-SOURCE         TO WS-DB-DATA-SOURCE
  2110     MOVE WS-FORM-TYPE           TO WS-DB-FORM-TYPE
  2111     MOVE WS-ARCHIVE-NO-X        TO WS-DB-ARCHIVE-NO-X
  2112     MOVE WS-ORIG-CREATE-DT      TO WS-DB-ORIG-CREATE-DT
  2113     MOVE WS-ORIG-PRINT-DT       TO WS-DB-ORIG-PRINT-DT
  2114
  2115     MOVE WS-RESEND-SCHED        TO WS-DB-RESEND-SCHED
  2116     MOVE WS-RESENT              TO WS-DB-RESENT
  2117     MOVE WS-FINAL-ACTION-DT     TO WS-DB-FINAL-ACTION-DT
  2118     MOVE WS-CSR                 TO WS-DB-CSR
  2119     MOVE WS-TYPE                TO WS-DB-TYPE
  2120     MOVE WS-STATUS              TO WS-DB-STATUS
  2121     MOVE WS-ACTIVITY-DT         TO WS-DB-ACTIVITY-DT
  2122
  2123     MOVE WS-DETAILB             TO P-DATA
  2124     MOVE SPACE-1                TO P-CTL
  2125     PERFORM 8800-PRT-RTN        THRU 8800-EXIT
  2126
  2127     .
  2128 0160-EXIT.
  2129     EXIT.
  2130
  2131 0170-RETURN-ERARCH.
  2132
  2133     RETURN SORTFL AT END
  2134        SET END-OF-ERARCH        TO TRUE
  2135     END-RETURN
  2136
  2137     IF NOT END-OF-ERARCH
  2138        MOVE SRT-ARCH-REC        TO LETTER-ARCHIVE
  2139        ADD 1                    TO RETURN-CNT
  2140     END-IF
  2141
  2142     .
  2143 0170-EXIT.
  2144     EXIT.
  2145
  2146 0200-CLOSE-OUTPUT.
  2147
  2148     CLOSE PRINTX  PENDING-EXTRACT ACTIVITY-EXTRACT
  2149
  2150     .
  2151 0200-EXIT.
  2152     EXIT.
  2153
  2154 8600-HD-RTN.
  2155     MOVE +0                     TO LNCTR
  2156     IF WS-PREV-REC-TYPE = 'A'
  2157        MOVE HDA-1               TO P-DATA
  2158     ELSE
  2159        MOVE HDB-1               TO P-DATA
  2160     END-IF
  2161     MOVE SPACE-NP               TO P-CTL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  39
* EL551NS.cbl
  2162
  2163     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2164
  2165     ADD +1                      TO PGCTR
  2166
  2167     MOVE PGCTR                  TO HD-PG
  2168     MOVE HD2                    TO P-DATA
  2169     MOVE SPACE-1                TO P-CTL
  2170
  2171     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2172
  2173     MOVE HD3                    TO P-DATA
  2174     MOVE SPACE-1                TO P-CTL
  2175
  2176     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2177
  2178     MOVE HD4                    TO P-DATA
  2179     MOVE SPACE-1                TO P-CTL
  2180
  2181     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2182
  2183     IF WS-PREV-REC-TYPE = 'A'
  2184        MOVE HDA-5               TO P-DATA
  2185     ELSE
  2186        MOVE HDB-5               TO P-DATA
  2187     END-IF
  2188     MOVE SPACE-2                TO P-CTL
  2189     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2190
  2191     IF WS-PREV-REC-TYPE = 'A'
  2192        MOVE HDA-6               TO P-DATA
  2193     ELSE
  2194        MOVE HDB-6               TO P-DATA
  2195     END-IF
  2196     MOVE SPACE-1                TO P-CTL
  2197     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2198
  2199     MOVE SPACES                 TO P-DATA
  2200     MOVE SPACE-1                TO P-CTL
  2201     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2202
  2203     MOVE +10                    TO LNCTR
  2204*    MOVE SPACE-2                TO P-CTL
  2205
  2206     .
  2207 8699-EXIT.
  2208     EXIT.
  2209
  2210 8800-PRT-RTN.
  2211
  2212     IF LNCTR > +56
  2213        MOVE PRT                 TO WS-HOLD-PRT
  2214        PERFORM 8600-HD-RTN      THRU 8699-EXIT
  2215        MOVE WS-HOLD-PRT         TO PRT
  2216     END-IF
  2217
  2218     MOVE P-CTL                  TO X
  2219     IF P-CTL = SPACE-1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  40
* EL551NS.cbl
  2220        ADD +1                   TO LNCTR
  2221     ELSE
  2222        IF P-CTL = SPACE-2
  2223           ADD +2                TO LNCTR
  2224        ELSE
  2225           IF P-CTL = SPACE-3
  2226              ADD +3             TO LNCTR
  2227           END-IF
  2228        END-IF
  2229     END-IF
  2230
  2231     .
  2232 8850-COPY-PRT-RTN.
* 2233                                 COPY ELCPRT2.
  2234******************************************************************04/15/98
  2235*                                                                *ELCPRT2
  2236*                                                                *ELCPRT2
  2237*                            ELCPRT2                             *   LV005
  2238*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  2239*                            VMOD=2.002                          *   CL**5
  2240*                                                                *   CL**4
  2241******************************************************************   CL**4
  2242                                                                     CL**4
  2243     IF DTE-FICH NOT = SPACE AND                                     CL**4
  2244        FICH-OPEN    = SPACE                                         CL**4
  2245         MOVE 'X'                TO  FICH-OPEN                       CL**4
  2246         OPEN OUTPUT FICH.                                           CL**4
  2247                                                                     CL**4
  2248     IF DTE-FICH NOT = SPACE                                         CL**4
  2249         MOVE X                  TO  P-CTL                           CL**4
  2250         WRITE FICH-REC FROM PRT.                                    CL**4
  2251                                                                     CL**4
  2252     IF DTE-FICH = SPACE OR '2'                                      CL**4
  2253       MOVE X                    TO  P-CTL                           CL**4
  2254       IF P-CTL = ' '                                                CL**4
  2255         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  2256       ELSE                                                          CL**4
  2257         IF P-CTL = '0'                                              CL**4
  2258           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  2259         ELSE                                                        CL**4
  2260           IF P-CTL = '-'                                            CL**4
  2261             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  2262           ELSE                                                      CL**4
  2263             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  2264                                                                     CL**4
  2265******************************************************************   CL**4
  2266
  2267 8800-EXIT.
  2268     EXIT.
  2269
  2270 8500-DATE-CONVERT.
  2271
  2272     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  2273
  2274     .
  2275 8590-EXIT.
  2276     EXIT.
  2277
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  41
* EL551NS.cbl
  2278 ABEND-PGM.
* 2279                                 COPY ELCABEND.
  2280***************************************************************** 04/14/98
  2281*                                                               * ELCABEND
  2282*                            ELCABEND.                          *    LV003
  2283*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2284*                            VMOD 2.002                              CL**2
  2285*                                                               * ELCABEND
  2286*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2287*            AND THEN ABENDS.                                   * ELCABEND
  2288*                                                               * ELCABEND
  2289*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2290*                                                               * ELCABEND
  2291***************************************************************** ELCABEND
  2292*APS-010.                                                         ELCABEND
  2293     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2294     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2295                                                                  ELCABEND
  2296     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2297         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2298         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2299                                 UPON CONSOLE.                    ELCABEND
  2300                                                                  ELCABEND
  2301     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2302         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2303         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2304                                 UPON CONSOLE.                    ELCABEND
  2305                                                                  ELCABEND
  2306     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2307     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2308                                 UPON CONSOLE.                    ELCABEND
  2309                                                                  ELCABEND
  2310     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2311     CALL 'ABORTME'.
  2312                                                                  ELCABEND
  2313 APS-EXIT.                                                        ELCABEND
  2314     EXIT.                                                        ELCABEND
  2315
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       52304     Code:        7944
