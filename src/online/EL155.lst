* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL155.cbl
* Options: int("EL155.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL155.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL155.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL155.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL155 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 11/01/95 08:50:15.
     7*                            VMOD=2.003.
     8*
     9*
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL155.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS. EX31 - POLICY FORM DISPLAY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL155.cbl
    27 ENVIRONMENT DIVISION.
    28 DATA DIVISION.
    29 WORKING-STORAGE SECTION.
    30 01  DFH-START PIC X(04).
    31 01  LCP-TIME-OF-DAY-XX.
    32     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    33     05  FILLER                    PIC 99.
    34 01  LCP-CICS-TIME                 PIC 9(15).
    35 77  FILLER  PIC X(32)  VALUE '********************************'.
    36 77  FILLER  PIC X(32)  VALUE '*   EL155  WORKING STORAGE     *'.
    37 77  FILLER  PIC X(32)  VALUE '************ V/M 2.003 *********'.
    38
    39 01  WS-DATE-AREA.
    40     05  SAVE-DATE               PIC X(8)    VALUE SPACES.
    41     05  SAVE-BIN-DATE           PIC X(2)    VALUE SPACES.
    42
    43 01  LITERALS-NUMBERS.
    44     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
    45     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
    46     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
    47
    48     12  THIS-PROG               PIC X(8)    VALUE 'EL155'.
    49     12  TRANS-ID                PIC X(4)    VALUE 'EX31'.
    50     12  WS-DMD-PASSED-KEY       PIC X(6).
    51
    52 01  ERROR-NUMBERS.
    53     12  ER-0004                 PIC X(4)    VALUE '0004'.
    54     12  ER-7008                 PIC X(4)    VALUE '7008'.
    55     12  ER-0015                 PIC X(4)    VALUE '0015'.
    56     12  ER-0029                 PIC X(4)    VALUE '0029'.
    57     12  ER-0126                 PIC X(4)    VALUE '0126'.
    58     12  ER-0130                 PIC X(4)    VALUE '0130'.
    59     12  ER-0131                 PIC X(4)    VALUE '0131'.
    60     12  ER-0418                 PIC X(4)    VALUE '0418'.
    61
    62 01  EDIT-WORK-AREA.
    63     12  COUNT-1                 PIC 99.
    64     12  CHECK-PFKEYS            PIC 99.
    65     12  CALL-PGM                PIC X(8).
    66
    67 01  FORMATTED-LINE.
    68     12  FILLER                  PIC X(2)    VALUE SPACES.
    69     12  HOLD-LINE               PIC X(70).
    70     12  FILLER                  PIC X(7)    VALUE SPACES.
    71
    72 01  TIME-UNFORMATTED.
    73     12  UN-HOURS                PIC X(2).
    74     12  UN-MINUTES              PIC X(2).
    75     12  FILLER                  PIC X(2).
    76
    77 01  TIME-FORMATTED.
    78     12  FOR-HOURS               PIC X(2).
    79     12  FILLER                  PIC X       VALUE '.'.
    80     12  FOR-MINUTES             PIC X(2).
    81
    82 01  ERROR-SWITCHES.
    83     12  ERROR-SWITCH            PIC X       VALUE SPACE.
    84         88  END-OF-FILE                     VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL155.cbl
    85         88  SCREEN-ERROR                    VALUE 'X'.
    86
    87 01  ELFORM-KEY.
    88     12  FILE-PARTIAL-KEY.
    89         16  COMPANY-CODE        PIC X.
    90         16  FORM-NO             PIC X(12).
    91     12  LINE-SEQUENCE           PIC S9(4)   COMP.
    92
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL155.cbl
    94*    COPY ELCLOGOF.
    95******************************************************************
    96*                                                                *
    97*                                                                *
    98*                            ELCLOGOF.                           *
    99*                            VMOD=2.001                          *
   100*                                                                *
   101*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   102*                                                                *
   103******************************************************************
   104 01  CLASIC-LOGOFF.
   105     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   106     12  LOGOFF-TEXT.
   107         16  FILLER          PIC X(5)    VALUE SPACES.
   108         16  LOGOFF-MSG.
   109             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   110             20  FILLER      PIC X       VALUE SPACES.
   111             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   112         16  FILLER          PIC X(80)
   113           VALUE '* YOU ARE NOW LOGGED OFF'.
   114         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   115         16  FILLER          PIC X       VALUE QUOTE.
   116         16  LOGOFF-SYS-MSG  PIC X(17)
   117           VALUE 'S CLAS-IC SYSTEM '.
   118     12  TEXT-MESSAGES.
   119         16  UNACCESS-MSG    PIC X(29)
   120             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   121         16  PGMIDERR-MSG    PIC X(17)
   122             VALUE 'PROGRAM NOT FOUND'.
   123
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL155.cbl
   125*    COPY ELCDATE.
   126******************************************************************
   127*                                                                *
   128*                                                                *
   129*                            ELCDATE.                            *
   130*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   131*                            VMOD=2.003
   132*                                                                *
   133*                                                                *
   134*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   135*                 LENGTH = 200                                   *
   136******************************************************************
   137
   138 01  DATE-CONVERSION-DATA.
   139     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   140     12  DC-OPTION-CODE                PIC X.
   141         88  BIN-TO-GREG                VALUE ' '.
   142         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   143         88  EDIT-GREG-TO-BIN           VALUE '2'.
   144         88  YMD-GREG-TO-BIN            VALUE '3'.
   145         88  MDY-GREG-TO-BIN            VALUE '4'.
   146         88  JULIAN-TO-BIN              VALUE '5'.
   147         88  BIN-PLUS-ELAPSED           VALUE '6'.
   148         88  FIND-CENTURY               VALUE '7'.
   149         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   150         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   151         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   152         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   153         88  JULIAN-TO-BIN-3            VALUE 'C'.
   154         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   155         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   156         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   157         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   158         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   159         88  CHECK-LEAP-YEAR            VALUE 'H'.
   160         88  BIN-3-TO-GREG              VALUE 'I'.
   161         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   162         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   163         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   164         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   165         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   166         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   167         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   168         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   169         88  THREE-CHARACTER-BIN
   170                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   171         88  GREGORIAN-TO-BIN
   172                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   173         88  BIN-TO-GREGORIAN
   174                  VALUES ' ' '1' 'I' '8' 'G'.
   175         88  JULIAN-TO-BINARY
   176                  VALUES '5' 'C' 'E' 'F'.
   177     12  DC-ERROR-CODE                 PIC X.
   178         88  NO-CONVERSION-ERROR        VALUE ' '.
   179         88  DATE-CONVERSION-ERROR
   180                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   181         88  DATE-IS-ZERO               VALUE '1'.
   182         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL155.cbl
   183         88  DATE-IS-INVALID            VALUE '3'.
   184         88  DATE1-GREATER-DATE2        VALUE '4'.
   185         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   186         88  DATE-INVALID-OPTION        VALUE '9'.
   187         88  INVALID-CENTURY            VALUE 'A'.
   188         88  ONLY-CENTURY               VALUE 'B'.
   189         88  ONLY-LEAP-YEAR             VALUE 'C'.
   190         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   191     12  DC-END-OF-MONTH               PIC X.
   192         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   193     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   194         88  USE-NORMAL-PROCESS         VALUE ' '.
   195         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   196         88  ADJUST-UP-100-YRS          VALUE '2'.
   197     12  FILLER                        PIC X.
   198     12  DC-CONVERSION-DATES.
   199         16  DC-BIN-DATE-1             PIC XX.
   200         16  DC-BIN-DATE-2             PIC XX.
   201         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   202         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   203                       DC-GREG-DATE-1-EDIT.
   204             20  DC-EDIT1-MONTH        PIC 99.
   205             20  SLASH1-1              PIC X.
   206             20  DC-EDIT1-DAY          PIC 99.
   207             20  SLASH1-2              PIC X.
   208             20  DC-EDIT1-YEAR         PIC 99.
   209         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   210         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   211                     DC-GREG-DATE-2-EDIT.
   212             20  DC-EDIT2-MONTH        PIC 99.
   213             20  SLASH2-1              PIC X.
   214             20  DC-EDIT2-DAY          PIC 99.
   215             20  SLASH2-2              PIC X.
   216             20  DC-EDIT2-YEAR         PIC 99.
   217         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   218         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   219                     DC-GREG-DATE-1-YMD.
   220             20  DC-YMD-YEAR           PIC 99.
   221             20  DC-YMD-MONTH          PIC 99.
   222             20  DC-YMD-DAY            PIC 99.
   223         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   224         16  DC-GREG-DATE-1-MDY-R REDEFINES
   225                      DC-GREG-DATE-1-MDY.
   226             20  DC-MDY-MONTH          PIC 99.
   227             20  DC-MDY-DAY            PIC 99.
   228             20  DC-MDY-YEAR           PIC 99.
   229         16  DC-GREG-DATE-1-ALPHA.
   230             20  DC-ALPHA-MONTH        PIC X(10).
   231             20  DC-ALPHA-DAY          PIC 99.
   232             20  FILLER                PIC XX.
   233             20  DC-ALPHA-CENTURY.
   234                 24 DC-ALPHA-CEN-N     PIC 99.
   235             20  DC-ALPHA-YEAR         PIC 99.
   236         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   237         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   238         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   239         16  DC-JULIAN-DATE            PIC 9(05).
   240         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL155.cbl
   241                                       PIC 9(05).
   242         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   243             20  DC-JULIAN-YEAR        PIC 99.
   244             20  DC-JULIAN-DAYS        PIC 999.
   245         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   246         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   247         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   248     12  DATE-CONVERSION-VARIBLES.
   249         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   250         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   251             20  FILLER                PIC 9(3).
   252             20  HOLD-CEN-1-CCYY.
   253                 24  HOLD-CEN-1-CC     PIC 99.
   254                 24  HOLD-CEN-1-YY     PIC 99.
   255             20  HOLD-CEN-1-MO         PIC 99.
   256             20  HOLD-CEN-1-DA         PIC 99.
   257         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   258             20  HOLD-CEN-1-R-MO       PIC 99.
   259             20  HOLD-CEN-1-R-DA       PIC 99.
   260             20  HOLD-CEN-1-R-CCYY.
   261                 24  HOLD-CEN-1-R-CC   PIC 99.
   262                 24  HOLD-CEN-1-R-YY   PIC 99.
   263             20  FILLER                PIC 9(3).
   264         16  HOLD-CENTURY-1-X.
   265             20  FILLER                PIC X(3)  VALUE SPACES.
   266             20  HOLD-CEN-1-X-CCYY.
   267                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   268                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   269             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   270             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   271         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   272             20  HOLD-CEN-1-R-X-MO     PIC XX.
   273             20  HOLD-CEN-1-R-X-DA     PIC XX.
   274             20  HOLD-CEN-1-R-X-CCYY.
   275                 24  HOLD-CEN-1-R-X-CC PIC XX.
   276                 24  HOLD-CEN-1-R-X-YY PIC XX.
   277             20  FILLER                PIC XXX.
   278         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   279         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   280         16  DC-JULIAN-DATE-1          PIC 9(07).
   281         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   282             20  DC-JULIAN-1-CCYY.
   283                 24  DC-JULIAN-1-CC    PIC 99.
   284                 24  DC-JULIAN-1-YR    PIC 99.
   285             20  DC-JULIAN-DA-1        PIC 999.
   286         16  DC-JULIAN-DATE-2          PIC 9(07).
   287         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   288             20  DC-JULIAN-2-CCYY.
   289                 24  DC-JULIAN-2-CC    PIC 99.
   290                 24  DC-JULIAN-2-YR    PIC 99.
   291             20  DC-JULIAN-DA-2        PIC 999.
   292         16  DC-GREG-DATE-A-EDIT.
   293             20  DC-EDITA-MONTH        PIC 99.
   294             20  SLASHA-1              PIC X VALUE '/'.
   295             20  DC-EDITA-DAY          PIC 99.
   296             20  SLASHA-2              PIC X VALUE '/'.
   297             20  DC-EDITA-CCYY.
   298                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL155.cbl
   299                 24  DC-EDITA-YEAR     PIC 99.
   300         16  DC-GREG-DATE-B-EDIT.
   301             20  DC-EDITB-MONTH        PIC 99.
   302             20  SLASHB-1              PIC X VALUE '/'.
   303             20  DC-EDITB-DAY          PIC 99.
   304             20  SLASHB-2              PIC X VALUE '/'.
   305             20  DC-EDITB-CCYY.
   306                 24  DC-EDITB-CENT     PIC 99.
   307                 24  DC-EDITB-YEAR     PIC 99.
   308         16  DC-GREG-DATE-CYMD         PIC 9(08).
   309         16  DC-GREG-DATE-CYMD-R REDEFINES
   310                              DC-GREG-DATE-CYMD.
   311             20  DC-CYMD-CEN           PIC 99.
   312             20  DC-CYMD-YEAR          PIC 99.
   313             20  DC-CYMD-MONTH         PIC 99.
   314             20  DC-CYMD-DAY           PIC 99.
   315         16  DC-GREG-DATE-MDCY         PIC 9(08).
   316         16  DC-GREG-DATE-MDCY-R REDEFINES
   317                              DC-GREG-DATE-MDCY.
   318             20  DC-MDCY-MONTH         PIC 99.
   319             20  DC-MDCY-DAY           PIC 99.
   320             20  DC-MDCY-CEN           PIC 99.
   321             20  DC-MDCY-YEAR          PIC 99.
   322    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   323        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   324    12  DC-EL310-DATE                  PIC X(21).
   325    12  FILLER                         PIC X(28).
   326
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL155.cbl
   328*    COPY EL155S.
   329 01  EL155AI.
   330     05  FILLER            PIC  X(0012).
   331*    -------------------------------
   332     05  DATEL PIC S9(0004) COMP.
   333     05  DATEF PIC  X(0001).
   334     05  FILLER REDEFINES DATEF.
   335         10  DATEA PIC  X(0001).
   336     05  DATEI PIC  X(0008).
   337*    -------------------------------
   338     05  TIMEL PIC S9(0004) COMP.
   339     05  TIMEF PIC  X(0001).
   340     05  FILLER REDEFINES TIMEF.
   341         10  TIMEA PIC  X(0001).
   342     05  TIMEI PIC  X(0005).
   343*    -------------------------------
   344     05  FORMNOL PIC S9(0004) COMP.
   345     05  FORMNOF PIC  X(0001).
   346     05  FILLER REDEFINES FORMNOF.
   347         10  FORMNOA PIC  X(0001).
   348     05  FORMNOI PIC  X(0012).
   349     05  INFOD OCCURS 15  TIMES.
   350*    -------------------------------
   351         10  INFOL PIC S9(0004) COMP.
   352         10  INFOF PIC  X(0001).
   353         10  FILLER REDEFINES INFOF.
   354             15  INFOA PIC  X(0001).
   355         10  INFOI PIC  X(0079).
   356*    -------------------------------
   357     05  MSGL PIC S9(0004) COMP.
   358     05  MSGF PIC  X(0001).
   359     05  FILLER REDEFINES MSGF.
   360         10  MSGA PIC  X(0001).
   361     05  MSGI PIC  X(0075).
   362*    -------------------------------
   363     05  PFKEYL PIC S9(0004) COMP.
   364     05  PFKEYF PIC  X(0001).
   365     05  FILLER REDEFINES PFKEYF.
   366         10  PFKEYA PIC  X(0001).
   367     05  PFKEYI PIC  X(0002).
   368 01  EL155AO REDEFINES EL155AI.
   369     05  FILLER            PIC  X(0012).
   370*    -------------------------------
   371     05  FILLER            PIC  X(0003).
   372     05  DATEO PIC  X(0008).
   373*    -------------------------------
   374     05  FILLER            PIC  X(0003).
   375     05  TIMEO PIC  X(0005).
   376*    -------------------------------
   377     05  FILLER            PIC  X(0003).
   378     05  FORMNOO PIC  X(0012).
   379*    -------------------------------
   380     05  INFOD OCCURS 15  TIMES.
   381         10  FILLER        PIC  X(0003).
   382         10  INFOO PIC  X(0079).
   383*    -------------------------------
   384     05  FILLER            PIC  X(0003).
   385     05  MSGO PIC  X(0075).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL155.cbl
   386*    -------------------------------
   387     05  FILLER            PIC  X(0003).
   388     05  PFKEYO PIC  X(0002).
   389*    -------------------------------
   390
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL155.cbl
   392*    COPY ELCAID.
   393******************************************************************
   394*                                                                *
   395*                            ELCAID.                             *
   396*                            VMOD=2.001                          *
   397*                                                                *
   398*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   399*                                                                *
   400*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   401*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   402******************************************************************
   403
   404 01  DFHAID.
   405   02  DFHNULL   PIC  X  VALUE  ' '.
   406   02  DFHENTER  PIC  X  VALUE  QUOTE.
   407   02  DFHCLEAR  PIC  X  VALUE  '_'.
   408   02  DFHPEN    PIC  X  VALUE  '='.
   409   02  DFHOPID   PIC  X  VALUE  'W'.
   410   02  DFHPA1    PIC  X  VALUE  '%'.
   411   02  DFHPA2    PIC  X  VALUE  '>'.
   412   02  DFHPA3    PIC  X  VALUE  ','.
   413   02  DFHPF1    PIC  X  VALUE  '1'.
   414   02  DFHPF2    PIC  X  VALUE  '2'.
   415   02  DFHPF3    PIC  X  VALUE  '3'.
   416   02  DFHPF4    PIC  X  VALUE  '4'.
   417   02  DFHPF5    PIC  X  VALUE  '5'.
   418   02  DFHPF6    PIC  X  VALUE  '6'.
   419   02  DFHPF7    PIC  X  VALUE  '7'.
   420   02  DFHPF8    PIC  X  VALUE  '8'.
   421   02  DFHPF9    PIC  X  VALUE  '9'.
   422   02  DFHPF10   PIC  X  VALUE  ':'.
   423   02  DFHPF11   PIC  X  VALUE  '#'.
   424   02  DFHPF12   PIC  X  VALUE  '@'.
   425   02  DFHPF13   PIC  X  VALUE  'A'.
   426   02  DFHPF14   PIC  X  VALUE  'B'.
   427   02  DFHPF15   PIC  X  VALUE  'C'.
   428   02  DFHPF16   PIC  X  VALUE  'D'.
   429   02  DFHPF17   PIC  X  VALUE  'E'.
   430   02  DFHPF18   PIC  X  VALUE  'F'.
   431   02  DFHPF19   PIC  X  VALUE  'G'.
   432   02  DFHPF20   PIC  X  VALUE  'H'.
   433   02  DFHPF21   PIC  X  VALUE  'I'.
   434*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   435   02  DFHPF22   PIC  X  VALUE  '['.
   436   02  DFHPF23   PIC  X  VALUE  '.'.
   437   02  DFHPF24   PIC  X  VALUE  '<'.
   438   02  DFHMSRE   PIC  X  VALUE  'X'.
   439   02  DFHSTRF   PIC  X  VALUE  'h'.
   440   02  DFHTRIG   PIC  X  VALUE  '"'.
   441
   442 01  FILLER REDEFINES DFHAID.
   443     12  FILLER                  PIC X(8).
   444     12  AID-KEYS OCCURS 24 TIMES.
   445         16  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL155.cbl
   447*    COPY ELCINTF.
   448******************************************************************
   449*                                                                *
   450*                                                                *
   451*                            ELCINTF.                            *
   452*                            VMOD=2.017                          *
   453*                                                                *
   454*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   455*                                                                *
   456*       LENGTH = 1024                                            *
   457*                                                                *
   458******************************************************************
   459 01  PROGRAM-INTERFACE-BLOCK.
   460     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   461     12  PI-CALLING-PROGRAM              PIC X(8).
   462     12  PI-SAVED-PROGRAM-1              PIC X(8).
   463     12  PI-SAVED-PROGRAM-2              PIC X(8).
   464     12  PI-SAVED-PROGRAM-3              PIC X(8).
   465     12  PI-SAVED-PROGRAM-4              PIC X(8).
   466     12  PI-SAVED-PROGRAM-5              PIC X(8).
   467     12  PI-SAVED-PROGRAM-6              PIC X(8).
   468     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   469     12  PI-COMPANY-ID                   PIC XXX.
   470     12  PI-COMPANY-CD                   PIC X.
   471
   472     12  PI-COMPANY-PASSWORD             PIC X(8).
   473
   474     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   475
   476     12  PI-CONTROL-IN-PROGRESS.
   477         16  PI-CARRIER                  PIC X.
   478         16  PI-GROUPING                 PIC X(6).
   479         16  PI-STATE                    PIC XX.
   480         16  PI-ACCOUNT                  PIC X(10).
   481         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   482                                         PIC X(10).
   483         16  PI-CLAIM-CERT-GRP.
   484             20  PI-CLAIM-NO             PIC X(7).
   485             20  PI-CERT-NO.
   486                 25  PI-CERT-PRIME       PIC X(10).
   487                 25  PI-CERT-SFX         PIC X.
   488             20  PI-CERT-EFF-DT          PIC XX.
   489         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   490             20  PI-PLAN-CODE            PIC X(2).
   491             20  PI-REVISION-NUMBER      PIC X(3).
   492             20  PI-PLAN-EFF-DT          PIC X(2).
   493             20  PI-PLAN-EXP-DT          PIC X(2).
   494             20  FILLER                  PIC X(11).
   495         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   496             20  PI-OE-REFERENCE-1.
   497                 25  PI-OE-REF-1-PRIME   PIC X(18).
   498                 25  PI-OE-REF-1-SUFF    PIC XX.
   499
   500     12  PI-SESSION-IN-PROGRESS          PIC X.
   501         88  CLAIM-SESSION                   VALUE '1'.
   502         88  CREDIT-SESSION                  VALUE '2'.
   503         88  WARRANTY-SESSION                VALUE '3'.
   504         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL155.cbl
   505         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   506
   507
   508*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   509
   510     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   511     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   512
   513     12  PI-CREDIT-USER                  PIC X.
   514         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   515         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   516
   517     12  PI-CLAIM-USER                   PIC X.
   518         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   519         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   520
   521     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   522         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   523         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   524         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   525         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   526         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   527
   528     12  PI-PROCESSOR-ID                 PIC X(4).
   529
   530     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   531
   532     12  PI-MEMBER-CAPTION               PIC X(10).
   533
   534     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   535         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   536
   537     12  PI-LIFE-OVERRIDE-L1             PIC X.
   538     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   539     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   540     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   541
   542     12  PI-AH-OVERRIDE-L1               PIC X.
   543     12  PI-AH-OVERRIDE-L2               PIC XX.
   544     12  PI-AH-OVERRIDE-L6               PIC X(6).
   545     12  PI-AH-OVERRIDE-L12              PIC X(12).
   546
   547     12  PI-NEW-SYSTEM                   PIC X(2).
   548
   549     12  PI-PRIMARY-CERT-NO              PIC X(11).
   550     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   551         88  PI-USES-PAID-TO                 VALUE '1'.
   552     12  PI-CRDTCRD-SYSTEM.
   553         16  PI-CRDTCRD-USER             PIC X.
   554             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   555             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   556         16  PI-CC-MONTH-END-DT          PIC XX.
   557     12  PI-PROCESSOR-PRINTER            PIC X(4).
   558
   559     12  PI-OE-REFERENCE-2.
   560         16  PI-OE-REF-2-PRIME           PIC X(10).
   561         16  PI-OE-REF-2-SUFF            PIC X.
   562
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL155.cbl
   563     12  PI-REM-TRM-CALC-OPTION          PIC X.
   564
   565     12  PI-LANGUAGE-TYPE                PIC X.
   566             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   567             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   568             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   569
   570     12  PI-POLICY-LINKAGE-IND           PIC X.
   571         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   572         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   573                                                   LOW-VALUES.
   574
   575     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   576     12  PI-CLAIM-PW-SESSION             PIC X(1).
   577         88  PI-CLAIM-CREDIT                 VALUE '1'.
   578         88  PI-CLAIM-CONVEN                 VALUE '2'.
   579     12  FILLER                          PIC X(4).
   580
   581     12  PI-SYSTEM-LEVEL                 PIC X(145).
   582
   583     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   584         PI-SYSTEM-LEVEL.
   585
   586         16  PI-ENTRY-CODES.
   587             20  PI-ENTRY-CD-1           PIC X.
   588             20  PI-ENTRY-CD-2           PIC X.
   589
   590         16  PI-RETURN-CODES.
   591             20  PI-RETURN-CD-1          PIC X.
   592             20  PI-RETURN-CD-2          PIC X.
   593
   594         16  PI-UPDATE-STATUS-SAVE.
   595             20  PI-UPDATE-BY            PIC X(4).
   596             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   597
   598         16  PI-LOWER-CASE-LETTERS       PIC X.
   599             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   600
   601*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   602*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   603*            88  CARRIER-CLM-CNTL            VALUE '2'.
   604
   605         16  PI-CERT-ACCESS-CONTROL      PIC X.
   606             88  ST-ACCNT-CNTL               VALUE ' '.
   607             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   608             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   609             88  ACCNT-CNTL                  VALUE '3'.
   610             88  CARR-ACCNT-CNTL             VALUE '4'.
   611
   612         16  PI-PROCESSOR-CAP-LIST.
   613             20  PI-SYSTEM-CONTROLS.
   614                24 PI-SYSTEM-DISPLAY     PIC X.
   615                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   616                24 PI-SYSTEM-MODIFY      PIC X.
   617                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   618             20  FILLER                  PIC XX.
   619             20  PI-DISPLAY-CAP          PIC X.
   620                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL155.cbl
   621             20  PI-MODIFY-CAP           PIC X.
   622                 88  MODIFY-CAP              VALUE 'Y'.
   623             20  PI-MSG-AT-LOGON-CAP     PIC X.
   624                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   625             20  PI-FORCE-CAP            PIC X.
   626                 88  FORCE-CAP               VALUE 'Y'.
   627
   628         16  PI-PROGRAM-CONTROLS.
   629             20  PI-PGM-PRINT-OPT        PIC X.
   630             20  PI-PGM-FORMAT-OPT       PIC X.
   631             20  PI-PGM-PROCESS-OPT      PIC X.
   632             20  PI-PGM-TOTALS-OPT       PIC X.
   633
   634         16  PI-HELP-INTERFACE.
   635             20  PI-LAST-ERROR-NO        PIC X(4).
   636             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   637
   638         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   639             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   640
   641         16  PI-CR-CONTROL-IN-PROGRESS.
   642             20  PI-CR-CARRIER           PIC X.
   643             20  PI-CR-GROUPING          PIC X(6).
   644             20  PI-CR-STATE             PIC XX.
   645             20  PI-CR-ACCOUNT           PIC X(10).
   646             20  PI-CR-FIN-RESP          PIC X(10).
   647             20  PI-CR-TYPE              PIC X.
   648
   649         16  PI-CR-BATCH-NUMBER          PIC X(6).
   650
   651         16  PI-CR-MONTH-END-DT          PIC XX.
   652
   653         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   654             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   655             88  PI-ZERO-CARRIER             VALUE '1'.
   656             88  PI-ZERO-GROUPING            VALUE '2'.
   657             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   658
   659         16  PI-CARRIER-SECURITY         PIC X.
   660             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   661
   662         16  PI-ACCOUNT-SECURITY         PIC X(10).
   663             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   664             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   665
   666         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   667             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   668                                         INDEXED BY PI-ACCESS-NDX
   669                                         PIC X.
   670
   671         16  PI-GA-BILLING-CONTROL       PIC X.
   672             88  PI-GA-BILLING               VALUE '1'.
   673
   674         16  PI-MAIL-PROCESSING          PIC X.
   675             88  PI-MAIL-YES                 VALUE 'Y'.
   676
   677         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   678
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL155.cbl
   679         16  PI-AR-SYSTEM.
   680             20  PI-AR-PROCESSING-CNTL   PIC X.
   681                 88  PI-AR-PROCESSING        VALUE 'Y'.
   682             20  PI-AR-SUMMARY-CODE      PIC X(6).
   683             20  PI-AR-MONTH-END-DT      PIC XX.
   684
   685         16  PI-MP-SYSTEM.
   686             20  PI-MORTGAGE-USER            PIC X.
   687                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   688                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   689             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   690                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   691                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   692                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   693                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   694                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   695             20  PI-MP-MONTH-END-DT          PIC XX.
   696             20  PI-MP-REFERENCE-NO.
   697                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   698                 24  PI-MP-REFERENCE-SFX     PIC XX.
   699
   700         16  PI-LABEL-CONTROL            PIC X(01).
   701             88  PI-CREATE-LABELS                    VALUE 'Y'.
   702             88  PI-BYPASS-LABELS                    VALUE 'N'.
   703
   704         16  PI-BILL-GROUPING-CODE       PIC X(01).
   705             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   706
   707         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   708             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   709             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   710
   711         16  FILLER                      PIC X(14).
   712
   713     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   714******************************************************************
   715
   716     12  EL155-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
   717         16  PASSED-KEY          PIC X(12).
   718         16  SAVE-KEY.
   719          20  SAVE-PARTIAL-KEY.
   720                 24  FILLER          PIC X.
   721                 24  SAVE-CONTROL    PIC X(12).
   722             20  SAVE-LINE           PIC S9(4)   COMP.
   723         16  EOF-SWITCH          PIC X.
   724             88  TOP-OF-FILE                 VALUE 'X'.
   725             88  BOTTOM-OF-FILE              VALUE 'Y'.
   726             88  BAD-BROWSE                  VALUE 'Z'.
   727         16  FILLER              PIC X(514).
   728         16  PASSED-FORM-EL150   PIC X(12).
   729         16  FILLER              PIC X(86).
   730
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL155.cbl
   732*    COPY ELCEMIB.
   733******************************************************************
   734*                                                                *
   735*                                                                *
   736*                            ELCEMIB.                            *
   737*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   738*                            VMOD=2.005                          *
   739*                                                                *
   740*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   741*                                                                *
   742******************************************************************
   743 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   744     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   745     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   746     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   747     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   748     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   749     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   750     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   751     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   752     12  EMI-SWITCH1             PIC X        VALUE '1'.
   753         88  EMI-NO-ERRORS                    VALUE '1'.
   754         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   755         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   756     12  EMI-SWITCH2             PIC X        VALUE '1'.
   757         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   758     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   759         88  EMI-AREA1-EMPTY                  VALUE '1'.
   760         88  EMI-AREA1-FULL                   VALUE '2'.
   761     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   762         88  EMI-AREA2-EMPTY                  VALUE '1'.
   763         88  EMI-AREA2-FULL                   VALUE '2'.
   764     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   765         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   766         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   767         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   768         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   769         88  EMI-BYPASS-FATALS                VALUE 'X'.
   770     12  EMI-ERROR-LINES.
   771         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   772         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   773         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   774         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   775             20  EMI-ERR-CODES OCCURS 10 TIMES.
   776                 24  EMI-ERR-NUM         PIC X(4).
   777                 24  EMI-FILLER          PIC X.
   778                 24  EMI-SEV             PIC X.
   779                 24  FILLER              PIC X.
   780             20  FILLER                  PIC X(02).
   781     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   782         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   783             20  EMI-ERROR-NUMBER    PIC X(4).
   784             20  EMI-FILL            PIC X.
   785             20  EMI-SEVERITY        PIC X.
   786             20  FILLER              PIC X.
   787             20  EMI-ERROR-TEXT.
   788                 24  EMI-TEXT-VARIABLE   PIC X(10).
   789                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL155.cbl
   790     12  EMI-SEVERITY-SAVE           PIC X.
   791         88  EMI-NOTE                    VALUE 'N'.
   792         88  EMI-WARNING                 VALUE 'W'.
   793         88  EMI-FORCABLE                VALUE 'F'.
   794         88  EMI-FATAL                   VALUE 'X'.
   795     12  EMI-MESSAGE-FLAG            PIC X.
   796         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   797         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   798     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   799     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   800         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   801         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   802         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   803     12  FILLER                      PIC X(137)  VALUE SPACES.
   804     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   805     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   806     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   807     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   808
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL155.cbl
   810****************************************************************
   811*
   812* Copyright (c) 2007 by Clerity Solutions, Inc.
   813* All rights reserved.
   814*
   815****************************************************************
   816 01  DFHEIV.
   817   02  DFHEIV0               PIC X(35).
   818   02  DFHEIV1               PIC X(08).
   819   02  DFHEIV2               PIC X(08).
   820   02  DFHEIV3               PIC X(08).
   821   02  DFHEIV4               PIC X(06).
   822   02  DFHEIV5               PIC X(04).
   823   02  DFHEIV6               PIC X(04).
   824   02  DFHEIV7               PIC X(02).
   825   02  DFHEIV8               PIC X(02).
   826   02  DFHEIV9               PIC X(01).
   827   02  DFHEIV10              PIC S9(7) COMP-3.
   828   02  DFHEIV11              PIC S9(4) COMP SYNC.
   829   02  DFHEIV12              PIC S9(4) COMP SYNC.
   830   02  DFHEIV13              PIC S9(4) COMP SYNC.
   831   02  DFHEIV14              PIC S9(4) COMP SYNC.
   832   02  DFHEIV15              PIC S9(4) COMP SYNC.
   833   02  DFHEIV16              PIC S9(9) COMP SYNC.
   834   02  DFHEIV17              PIC X(04).
   835   02  DFHEIV18              PIC X(04).
   836   02  DFHEIV19              PIC X(04).
   837   02  DFHEIV20              USAGE IS POINTER.
   838   02  DFHEIV21              USAGE IS POINTER.
   839   02  DFHEIV22              USAGE IS POINTER.
   840   02  DFHEIV23              USAGE IS POINTER.
   841   02  DFHEIV24              USAGE IS POINTER.
   842   02  DFHEIV25              PIC S9(9) COMP SYNC.
   843   02  DFHEIV26              PIC S9(9) COMP SYNC.
   844   02  DFHEIV27              PIC S9(9) COMP SYNC.
   845   02  DFHEIV28              PIC S9(9) COMP SYNC.
   846   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   847   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   848   02  FILLER                PIC X(02).
   849   02  DFHEIV99              PIC X(08) VALUE SPACE.
   850   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   851   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   852   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   853   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   854 LINKAGE  SECTION.
   855*****************************************************************
   856*                                                               *
   857* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   858* All rights reserved.                                          *
   859*                                                               *
   860*****************************************************************
   861 01  dfheiblk.
   862     02  eibtime          pic s9(7) comp-3.
   863     02  eibdate          pic s9(7) comp-3.
   864     02  eibtrnid         pic x(4).
   865     02  eibtaskn         pic s9(7) comp-3.
   866     02  eibtrmid         pic x(4).
   867     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL155.cbl
   868     02  eibcposn         pic s9(4) comp.
   869     02  eibcalen         pic s9(4) comp.
   870     02  eibaid           pic x(1).
   871     02  eibfiller1       pic x(1).
   872     02  eibfn            pic x(2).
   873     02  eibfiller2       pic x(2).
   874     02  eibrcode         pic x(6).
   875     02  eibfiller3       pic x(2).
   876     02  eibds            pic x(8).
   877     02  eibreqid         pic x(8).
   878     02  eibrsrce         pic x(8).
   879     02  eibsync          pic x(1).
   880     02  eibfree          pic x(1).
   881     02  eibrecv          pic x(1).
   882     02  eibsend          pic x(1).
   883     02  eibatt           pic x(1).
   884     02  eibeoc           pic x(1).
   885     02  eibfmh           pic x(1).
   886     02  eibcompl         pic x(1).
   887     02  eibsig           pic x(1).
   888     02  eibconf          pic x(1).
   889     02  eiberr           pic x(1).
   890     02  eibrldbk         pic x(1).
   891     02  eiberrcd         pic x(4).
   892     02  eibsynrb         pic x(1).
   893     02  eibnodat         pic x(1).
   894     02  eibfiller5       pic x(2).
   895     02  eibresp          pic 9(09) comp.
   896     02  eibresp2         pic 9(09) comp.
   897     02  dfheigdj         pic s9(4) comp.
   898     02  dfheigdk         pic s9(4) comp.
   899 01  DFHCOMMAREA                 PIC X(1024).
   900
   901*    COPY ELCTEXT.
   902******************************************************************
   903*                                                                *
   904*                                                                *
   905*                            ELCTEXT.                            *
   906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   907*                            VMOD=2.008                          *
   908*                                                                *
   909*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   910*                                     FORM LETTERS,              *
   911*                                     CERT FORM DISPLAY.
   912*                                                                *
   913*   FILE TYPE = VSAM,KSDS                                        *
   914*   RECORD SIZE = 100   RECFORM = FIXED                          *
   915*                                                                *
   916*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   917*       ALTERNATE INDEX = NONE                                   *
   918*                                                                *
   919*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   920*       ALTERNATE INDEX = NONE                                   *
   921*                                                                *
   922*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   923*       ALTERNATE INDEX = NONE                                   *
   924*                                                                *
   925*   LOG = NO                                                     *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL155.cbl
   926*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   927******************************************************************
   928 01  TEXT-FILES.
   929     12  TEXT-FILE-ID                PIC XX.
   930         88  FORMS-FILE-TEXT            VALUE 'TF'.
   931         88  LETTER-FILE-TEXT           VALUE 'TL'.
   932         88  HELP-FILE-TEXT             VALUE 'TH'.
   933
   934     12  TX-CONTROL-PRIMARY.
   935         16  TX-COMPANY-CD           PIC X.
   936             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   937         16  TX-ACCESS-CD-GENL       PIC X(12).
   938
   939         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   940             20  TX-LETTER-NO        PIC X(4).
   941             20  FILLER              PIC X(8).
   942
   943         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   944             20  TX-FORM-NO          PIC X(12).
   945
   946         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   947             20  TX-HELP-TYPE        PIC X.
   948                 88  HELP-FOR-GENERAL   VALUE ' '.
   949                 88  HELP-BY-SCREEN     VALUE 'S'.
   950                 88  HELP-BY-ERROR      VALUE 'E'.
   951             20  TX-SCREEN-OR-ERROR  PIC X(4).
   952                 88  GENERAL-INFO-HELP  VALUE '0000'.
   953             20  TX-HELP-FOR-COMPANY  PIC XXX.
   954                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   955             20  FILLER              PIC X(4).
   956
   957         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   958
   959     12  TX-PROCESS-CONTROL          PIC XX.
   960         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   961
   962     12  TX-TEXT-LINE                PIC X(70).
   963
   964     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   965         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   966         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   967         88  TX-VALID-FORM-SQUEEZE-VALUE
   968                                        VALUE 'Y' ' '.
   969
   970     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   971         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   972         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   973         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   974         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   975         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   976         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   977         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   978                                              'K' 'N' ' '
   979                                              'Z'.
   980
   981     12  TX-ARCHIVE-SW               PIC X.
   982         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   983         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL155.cbl
   984         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   985
   986     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   987     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   988
   989     12  TX-BSR-CODE                 PIC X.
   990         88  TX-BSR-LETTER              VALUE 'B'.
   991         88  TX-NON-BSR-LETTER          VALUE ' '.
   992
   993     12  FILLER                      PIC X.
   994*****************************************************************
   995
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL155.cbl
   997 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES.
   998 0000-DFHEXIT SECTION.
   999     MOVE '9#                    $   ' TO DFHEIV0.
  1000     MOVE 'EL155' TO DFHEIV1.
  1001     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1002
  1003     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1004     MOVE '5'                   TO DC-OPTION-CODE.
  1005     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  1006     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1007     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1008
  1009     IF EIBCALEN = ZERO
  1010         GO TO 8800-UNAUTHORIZED-ACCESS.
  1011
  1012     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1013
  1014     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1015         MOVE LOW-VALUES         TO EL155AO
  1016         MOVE ER-7008            TO EMI-ERROR
  1017         PERFORM 9900-ERROR-FORMAT THRU 9900-ERROR-FORMAT-EXIT
  1018         GO TO 8110-SEND-DATA.
  1019
  1020     IF PI-CALLING-PROGRAM NOT = THIS-PROG
  1021         MOVE LOW-VALUES         TO EL155AO
  1022         GO TO 0100-UPDATE-PI.
  1023
  1024     IF EIBAID = DFHCLEAR
  1025         GO TO 8200-RETURN-PRIOR.
  1026
  1027
  1028* EXEC CICS HANDLE CONDITION
  1029*        PGMIDERR  (8820-PGMID-ERROR)
  1030*        MAPFAIL   (8100-SEND-MAP)
  1031*        ERROR     (9990-ABEND)
  1032*    END-EXEC.
  1033*    MOVE '"$L?.                 ! " #00001023' TO DFHEIV0
  1034     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  1035     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1036     MOVE X'2220233030303031303233' TO DFHEIV0(25:11)
  1037     CALL 'kxdfhei1' USING DFHEIV0
  1038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1039
  1040
  1041
  1042* EXEC CICS RECEIVE
  1043*        MAP     ('EL155A')
  1044*        MAPSET  ('EL155S')
  1045*    END-EXEC.
  1046     MOVE 'EL155A' TO DFHEIV1
  1047     MOVE 'EL155S' TO DFHEIV2
  1048*    MOVE '8"T                   ''   #00001029' TO DFHEIV0
  1049     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  1050     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1051     MOVE X'2020233030303031303239' TO DFHEIV0(25:11)
  1052     CALL 'kxdfhei1' USING DFHEIV0,
  1053           DFHEIV1,
  1054           EL155AI,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL155.cbl
  1055           DFHEIV99,
  1056           DFHEIV2,
  1057           DFHEIV99,
  1058           DFHEIV99
  1059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1060
  1061
  1062     IF PFKEYL GREATER THAN ZERO
  1063         PERFORM 0200-TRANS-PF THRU 0210-TRANS-PF-EXIT.
  1064
  1065     IF SCREEN-ERROR
  1066         MOVE ER-7008            TO EMI-ERROR
  1067         PERFORM 9900-ERROR-FORMAT THRU 9900-ERROR-FORMAT-EXIT
  1068         GO TO 8110-SEND-DATA.
  1069
  1070     IF EIBAID = DFHPF12
  1071         GO TO 8300-GET-HELP.
  1072
  1073     IF EIBAID = DFHPF23
  1074         GO TO 8810-PF23-ENTERED.
  1075
  1076     IF EIBAID = DFHPF24
  1077         GO TO 8400-RETURN-MASTER.
  1078
  1079     IF EIBAID = DFHPF1 OR DFHPF3
  1080         GO TO 2000-BROWSE-FORWARD.
  1081
  1082     IF EIBAID = DFHPF2 OR DFHPF4
  1083         GO TO 2100-BROWSE-BACKWARD.
  1084
  1085     IF EIBAID = DFHENTER
  1086         GO TO 2000-BROWSE-FORWARD.
  1087
  1088     MOVE ER-0029                TO EMI-ERROR.
  1089     PERFORM 9900-ERROR-FORMAT THRU 9900-ERROR-FORMAT-EXIT.
  1090     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL155.cbl
  1092
  1093 0100-UPDATE-PI.
  1094     IF PI-CALLING-PROGRAM = 'EL150'
  1095         MOVE PASSED-FORM-EL150  TO PASSED-KEY.
  1096
  1097     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  1098     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  1099     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  1100     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  1101     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  1102     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  1103     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  1104     MOVE THIS-PROG              TO PI-CALLING-PROGRAM.
  1105     MOVE ZEROS                  TO SAVE-LINE   SAVE-PARTIAL-KEY.
  1106     MOVE SPACES                 TO EOF-SWITCH.
  1107
  1108     IF PI-RETURN-TO-PROGRAM NOT = XCTL-EL126
  1109        IF PASSED-KEY = SPACES
  1110           MOVE ER-0418          TO EMI-ERROR
  1111           PERFORM 9900-ERROR-FORMAT
  1112              THRU 9900-ERROR-FORMAT-EXIT
  1113           GO TO 8110-SEND-DATA
  1114        ELSE
  1115        IF PI-COMPANY-ID = 'DMD'
  1116           MOVE PASSED-KEY (7:6)  TO WS-DMD-PASSED-KEY
  1117           MOVE WS-DMD-PASSED-KEY TO PASSED-KEY
  1118        END-IF
  1119           MOVE PASSED-KEY        TO FORMNOO
  1120           GO TO 2000-BROWSE-FORWARD.
  1121
  1122     GO TO 8100-SEND-MAP.
  1123
  1124 0200-TRANS-PF.
  1125
  1126     IF EIBAID NOT = DFHENTER
  1127        MOVE ER-0004             TO EMI-ERROR
  1128        PERFORM 9900-ERROR-FORMAT THRU 9900-ERROR-FORMAT-EXIT
  1129        MOVE -1                  TO PFKEYL
  1130        GO TO 8110-SEND-DATA.
  1131
  1132     IF PFKEYI NOT NUMERIC
  1133         MOVE 'X'                TO ERROR-SWITCH
  1134         GO TO 0210-TRANS-PF-EXIT.
  1135
  1136     IF PFKEYI LESS THAN 1
  1137       OR
  1138        PFKEYI GREATER THAN 24
  1139         MOVE 'X'                TO ERROR-SWITCH
  1140         GO TO 0210-TRANS-PF-EXIT.
  1141
  1142     MOVE PFKEYI                 TO CHECK-PFKEYS.
  1143     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  1144
  1145 0210-TRANS-PF-EXIT.
  1146     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL155.cbl
  1148 2000-BROWSE-FORWARD.
  1149
  1150     IF FORMNOI NOT = SAVE-CONTROL
  1151        MOVE SPACE               TO EOF-SWITCH
  1152        MOVE ZEROS               TO LINE-SEQUENCE
  1153        MOVE FORMNOI             TO FORM-NO
  1154        MOVE PI-COMPANY-CD       TO COMPANY-CODE
  1155        MOVE ELFORM-KEY          TO SAVE-KEY
  1156        GO TO 2010-SKIP-ADD.
  1157
  1158     IF BOTTOM-OF-FILE
  1159         MOVE ER-0130            TO EMI-ERROR
  1160         PERFORM 9900-ERROR-FORMAT
  1161             THRU 9900-ERROR-FORMAT-EXIT
  1162        GO TO 8110-SEND-DATA.
  1163
  1164     MOVE SPACE                  TO EOF-SWITCH.
  1165
  1166     IF EIBAID = DFHPF1
  1167        ADD 15                   TO SAVE-LINE
  1168     ELSE
  1169        ADD 5                    TO SAVE-LINE.
  1170
  1171     MOVE SAVE-KEY               TO ELFORM-KEY.
  1172
  1173 2010-SKIP-ADD.
  1174     MOVE 1                      TO COUNT-1
  1175     MOVE SPACES TO ERROR-SWITCH FORMATTED-LINE.
  1176
  1177     PERFORM 4000-START-BROWSE THRU 4010-START-BROWSE-EXIT.
  1178
  1179     IF BAD-BROWSE
  1180        MOVE ER-0126             TO EMI-ERROR
  1181        PERFORM 9900-ERROR-FORMAT
  1182           THRU 9900-ERROR-FORMAT-EXIT
  1183        MOVE 'Y'                 TO EOF-SWITCH
  1184        PERFORM 3100-FILL-SCREEN THRU 3110-FILL-SCREEN-EXIT
  1185                VARYING COUNT-1 FROM 1 BY 1 UNTIL COUNT-1 > 15
  1186        GO TO 8110-SEND-DATA.
  1187
  1188     PERFORM 4020-READ-FILE THRU 4040-READ-FILE-EXIT.
  1189
  1190     IF END-OF-FILE
  1191        GO TO 2020-END-FILE.
  1192
  1193     MOVE ELFORM-KEY TO SAVE-KEY.
  1194
  1195     IF TX-FORM-NO NOT = FORMNOI
  1196         MOVE TX-FORM-NO TO FORMNOO.
  1197
  1198     PERFORM 3000-BUILD-SCREEN THRU 3010-BUILD-SCREEN-EXIT
  1199         VARYING COUNT-1 FROM 1 BY 1 UNTIL COUNT-1 > 15
  1200                 OR END-OF-FILE.
  1201
  1202 2020-END-FILE.
  1203
  1204     IF END-OF-FILE
  1205         PERFORM 3100-FILL-SCREEN THRU 3110-FILL-SCREEN-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL155.cbl
  1206           VARYING COUNT-1 FROM COUNT-1 BY 1 UNTIL COUNT-1 > 15.
  1207
  1208     PERFORM 4050-END-BROWSE THRU 4060-END-BROWSE-EXIT.
  1209     GO TO 8110-SEND-DATA.
  1210
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL155.cbl
  1212 2100-BROWSE-BACKWARD.
  1213
  1214     IF FORMNOI NOT = SAVE-CONTROL
  1215        GO TO 2000-BROWSE-FORWARD.
  1216
  1217     IF TOP-OF-FILE
  1218         MOVE ER-0131            TO EMI-ERROR
  1219         PERFORM 9900-ERROR-FORMAT
  1220             THRU 9900-ERROR-FORMAT-EXIT
  1221         GO TO 8110-SEND-DATA.
  1222
  1223     MOVE SPACE TO EOF-SWITCH.
  1224
  1225     IF SAVE-LINE = 1
  1226         GO TO 2500-NEW-SCREEN.
  1227
  1228     IF EIBAID = DFHPF2
  1229        SUBTRACT 15              FROM SAVE-LINE
  1230     ELSE
  1231        SUBTRACT 5               FROM SAVE-LINE.
  1232
  1233     IF SAVE-LINE LESS THAN ZEROES
  1234         MOVE ZEROES             TO SAVE-LINE.
  1235
  1236     MOVE SAVE-KEY               TO ELFORM-KEY.
  1237     GO TO 2010-SKIP-ADD.
  1238
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL155.cbl
  1240 2500-NEW-SCREEN.
  1241     MOVE SAVE-KEY               TO ELFORM-KEY.
  1242     PERFORM 4000-START-BROWSE THRU 4010-START-BROWSE-EXIT.
  1243     PERFORM 4070-READ-PREV THRU 4090-READ-PREV-EXIT.
  1244     PERFORM 4070-READ-PREV THRU 4090-READ-PREV-EXIT.
  1245
  1246     IF END-OF-FILE
  1247        MOVE LOW-VALUES          TO FORMNOI
  1248     ELSE
  1249        MOVE TX-FORM-NO          TO FORMNOI.
  1250
  1251     PERFORM 4050-END-BROWSE  THRU 4060-END-BROWSE-EXIT.
  1252     GO TO 2000-BROWSE-FORWARD.
  1253
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL155.cbl
  1255 3000-BUILD-SCREEN.
  1256     MOVE TX-TEXT-LINE           TO HOLD-LINE.
  1257     MOVE FORMATTED-LINE         TO INFOO (COUNT-1).
  1258     PERFORM 4020-READ-FILE THRU 4040-READ-FILE-EXIT.
  1259
  1260     IF TX-FORM-NO NOT = SAVE-CONTROL
  1261         MOVE 'E'                TO ERROR-SWITCH.
  1262
  1263 3010-BUILD-SCREEN-EXIT.
  1264     EXIT.
  1265
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL155.cbl
  1267 3100-FILL-SCREEN.
  1268     MOVE SPACES                 TO FORMATTED-LINE.
  1269     MOVE FORMATTED-LINE         TO INFOO (COUNT-1).
  1270
  1271 3110-FILL-SCREEN-EXIT.
  1272     EXIT.
  1273
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL155.cbl
  1275 4000-START-BROWSE.
  1276
  1277
  1278* EXEC CICS HANDLE CONDITION
  1279*        NOTOPEN  (5000-FORM-NOT-OPEN)
  1280*        NOTFND   (4005-KEY-NOT-FOUND)
  1281*    END-EXEC.
  1282*    MOVE '"$JI                  ! # #00001249' TO DFHEIV0
  1283     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  1284     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1285     MOVE X'2320233030303031323439' TO DFHEIV0(25:11)
  1286     CALL 'kxdfhei1' USING DFHEIV0
  1287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1288
  1289
  1290
  1291* EXEC CICS STARTBR
  1292*        DATASET  ('ELFORM')
  1293*        RIDFLD   (ELFORM-KEY)
  1294*    END-EXEC.
  1295     MOVE 'ELFORM' TO DFHEIV1
  1296     MOVE 0
  1297       TO DFHEIV11
  1298*    MOVE '&,         G          &   #00001254' TO DFHEIV0
  1299     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1300     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1301     MOVE X'2020233030303031323534' TO DFHEIV0(25:11)
  1302     CALL 'kxdfhei1' USING DFHEIV0,
  1303           DFHEIV1,
  1304           ELFORM-KEY,
  1305           DFHEIV99,
  1306           DFHEIV11,
  1307           DFHEIV99
  1308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1309
  1310
  1311     GO TO 4010-START-BROWSE-EXIT.
  1312
  1313 4005-KEY-NOT-FOUND.
  1314     MOVE 'Z'                    TO EOF-SWITCH.
  1315
  1316 4010-START-BROWSE-EXIT.
  1317     EXIT.
  1318
  1319 4020-READ-FILE.
  1320
  1321
  1322* EXEC CICS HANDLE CONDITION
  1323*        NOTFND   (4030-END-OF-FILE)
  1324*        ENDFILE  (4030-END-OF-FILE)
  1325*    END-EXEC.
  1326*    MOVE '"$I''                  ! $ #00001269' TO DFHEIV0
  1327     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  1328     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1329     MOVE X'2420233030303031323639' TO DFHEIV0(25:11)
  1330     CALL 'kxdfhei1' USING DFHEIV0
  1331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1332
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL155.cbl
  1333
  1334
  1335* EXEC CICS READNEXT
  1336*        SET      (ADDRESS OF TEXT-FILES)
  1337*        DATASET  ('ELFORM')
  1338*        RIDFLD   (ELFORM-KEY)
  1339*    END-EXEC.
  1340     MOVE 'ELFORM' TO DFHEIV1
  1341     MOVE 0
  1342       TO DFHEIV11
  1343*    MOVE '&.S                   )   #00001274' TO DFHEIV0
  1344     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1345     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1346     MOVE X'2020233030303031323734' TO DFHEIV0(25:11)
  1347     CALL 'kxdfhei1' USING DFHEIV0,
  1348           DFHEIV1,
  1349           DFHEIV20,
  1350           DFHEIV99,
  1351           ELFORM-KEY,
  1352           DFHEIV99,
  1353           DFHEIV11,
  1354           DFHEIV99,
  1355           DFHEIV99
  1356     SET ADDRESS OF TEXT-FILES TO
  1357         DFHEIV20
  1358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1359
  1360
  1361     IF PI-COMPANY-CD = TX-COMPANY-CD
  1362        GO TO 4040-READ-FILE-EXIT.
  1363
  1364 4030-END-OF-FILE.
  1365     MOVE 'E'                    TO ERROR-SWITCH.
  1366     MOVE 'Y'                    TO EOF-SWITCH
  1367     MOVE ER-0130                TO EMI-ERROR.
  1368     PERFORM 9900-ERROR-FORMAT THRU 9900-ERROR-FORMAT-EXIT.
  1369     GO TO 8110-SEND-DATA.
  1370
  1371 4040-READ-FILE-EXIT.
  1372     EXIT.
  1373
  1374 4050-END-BROWSE.
  1375
  1376
  1377* EXEC CICS ENDBR
  1378*        DATASET ('ELFORM')
  1379*    END-EXEC.
  1380     MOVE 'ELFORM' TO DFHEIV1
  1381     MOVE 0
  1382       TO DFHEIV11
  1383*    MOVE '&2                    $   #00001295' TO DFHEIV0
  1384     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1385     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1386     MOVE X'2020233030303031323935' TO DFHEIV0(25:11)
  1387     CALL 'kxdfhei1' USING DFHEIV0,
  1388           DFHEIV1,
  1389           DFHEIV11,
  1390           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL155.cbl
  1391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1392
  1393
  1394 4060-END-BROWSE-EXIT.
  1395     EXIT.
  1396
  1397 4070-READ-PREV.
  1398
  1399
  1400* EXEC CICS HANDLE CONDITION
  1401*        NOTFND   (4080-END-OF-FILE)
  1402*        ENDFILE  (4080-END-OF-FILE)
  1403*    END-EXEC.
  1404*    MOVE '"$I''                  ! % #00001304' TO DFHEIV0
  1405     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  1406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1407     MOVE X'2520233030303031333034' TO DFHEIV0(25:11)
  1408     CALL 'kxdfhei1' USING DFHEIV0
  1409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1410
  1411
  1412
  1413* EXEC CICS READPREV
  1414*        SET      (ADDRESS OF TEXT-FILES)
  1415*        DATASET  ('ELFORM')
  1416*        RIDFLD   (ELFORM-KEY)
  1417*    END-EXEC.
  1418     MOVE 'ELFORM' TO DFHEIV1
  1419     MOVE 0
  1420       TO DFHEIV11
  1421*    MOVE '&0S                   )   #00001309' TO DFHEIV0
  1422     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  1423     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1424     MOVE X'2020233030303031333039' TO DFHEIV0(25:11)
  1425     CALL 'kxdfhei1' USING DFHEIV0,
  1426           DFHEIV1,
  1427           DFHEIV20,
  1428           DFHEIV99,
  1429           ELFORM-KEY,
  1430           DFHEIV99,
  1431           DFHEIV11,
  1432           DFHEIV99,
  1433           DFHEIV99
  1434     SET ADDRESS OF TEXT-FILES TO
  1435         DFHEIV20
  1436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1437
  1438
  1439     CONTINUE.
  1440
  1441     IF PI-COMPANY-CD = TX-COMPANY-CD
  1442        GO TO 4090-READ-PREV-EXIT.
  1443
  1444 4080-END-OF-FILE.
  1445     MOVE 'X'                    TO EOF-SWITCH
  1446     MOVE 'E'                    TO ERROR-SWITCH.
  1447     MOVE ER-0131                TO EMI-ERROR.
  1448     PERFORM 9900-ERROR-FORMAT THRU 9900-ERROR-FORMAT-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL155.cbl
  1449     GO TO 8110-SEND-DATA.
  1450
  1451 4090-READ-PREV-EXIT.
  1452     EXIT.
  1453
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL155.cbl
  1455 5000-FORM-NOT-OPEN.
  1456     MOVE ER-0015                TO EMI-ERROR.
  1457     PERFORM 9900-ERROR-FORMAT THRU 9900-ERROR-FORMAT-EXIT.
  1458     GO TO 8110-SEND-DATA.
  1459
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL155.cbl
  1461 8100-SEND-MAP.
  1462     PERFORM 8120-FORMAT-TIME-DATE
  1463         THRU 8130-FORMAT-TIME-DATE-EXIT.
  1464
  1465     IF PFKEYL NOT = -1
  1466        MOVE -1                  TO FORMNOL.
  1467
  1468
  1469* EXEC CICS SEND
  1470*        MAP     ('EL155A')
  1471*        MAPSET  ('EL155S')
  1472*        ERASE
  1473*        CURSOR
  1474*        FREEKB
  1475*    END-EXEC.
  1476     MOVE 'EL155A' TO DFHEIV1
  1477     MOVE -1
  1478       TO DFHEIV11
  1479     MOVE 'EL155S' TO DFHEIV2
  1480*    MOVE '8$     CT  E F  H     ,   #00001344' TO DFHEIV0
  1481     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1482     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  1483     MOVE X'2020233030303031333434' TO DFHEIV0(25:11)
  1484     CALL 'kxdfhei1' USING DFHEIV0,
  1485           DFHEIV1,
  1486           EL155AO,
  1487           DFHEIV99,
  1488           DFHEIV2,
  1489           DFHEIV99,
  1490           DFHEIV99,
  1491           DFHEIV99,
  1492           DFHEIV11,
  1493           DFHEIV99,
  1494           DFHEIV99,
  1495           DFHEIV99
  1496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1497
  1498
  1499     GO TO 9000-RETURN-TRANS.
  1500
  1501 8110-SEND-DATA.
  1502
  1503     IF EIBTRNID NOT = TRANS-ID
  1504         GO TO 8100-SEND-MAP.
  1505
  1506     PERFORM 8120-FORMAT-TIME-DATE
  1507         THRU 8130-FORMAT-TIME-DATE-EXIT.
  1508
  1509     IF PFKEYL NOT = -1
  1510        MOVE -1                  TO FORMNOL.
  1511
  1512
  1513* EXEC CICS SEND
  1514*        MAP     ('EL155A')
  1515*        MAPSET  ('EL155S')
  1516*        DATAONLY
  1517*        CURSOR
  1518*        FREEKB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL155.cbl
  1519*    END-EXEC.
  1520     MOVE 'EL155A' TO DFHEIV1
  1521     MOVE -1
  1522       TO DFHEIV11
  1523     MOVE 'EL155S' TO DFHEIV2
  1524*    MOVE '8$D    CT    F  H     ,   #00001365' TO DFHEIV0
  1525     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  1526     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  1527     MOVE X'2020233030303031333635' TO DFHEIV0(25:11)
  1528     CALL 'kxdfhei1' USING DFHEIV0,
  1529           DFHEIV1,
  1530           EL155AO,
  1531           DFHEIV99,
  1532           DFHEIV2,
  1533           DFHEIV99,
  1534           DFHEIV99,
  1535           DFHEIV99,
  1536           DFHEIV11,
  1537           DFHEIV99,
  1538           DFHEIV99,
  1539           DFHEIV99
  1540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1541
  1542
  1543     GO TO 9000-RETURN-TRANS.
  1544
  1545 8120-FORMAT-TIME-DATE.
  1546     MOVE SAVE-DATE              TO DATEO.
  1547
  1548
  1549* EXEC CICS ASKTIME
  1550*        ABSTIME(LCP-CICS-TIME)
  1551*    END-EXEC.
  1552*    MOVE '0"A                   "   #00001378' TO DFHEIV0
  1553     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
  1554     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  1555     MOVE X'2020233030303031333738' TO DFHEIV0(25:11)
  1556     CALL 'kxdfhei1' USING DFHEIV0,
  1557           LCP-CICS-TIME
  1558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1559
  1560
  1561
  1562* EXEC CICS FORMATTIME
  1563*        ABSTIME(LCP-CICS-TIME)
  1564*        TIME(LCP-TIME-OF-DAY-XX)
  1565*    END-EXEC.
  1566*    MOVE 'j$(     (             #   #00001382' TO DFHEIV0
  1567     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
  1568     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1569     MOVE X'2020233030303031333832' TO DFHEIV0(25:11)
  1570     CALL 'kxdfhei1' USING DFHEIV0,
  1571           LCP-CICS-TIME,
  1572           LCP-TIME-OF-DAY-XX
  1573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1574
  1575
  1576     MOVE LCP-TIME-OF-DAY-68     TO TIME-UNFORMATTED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL155.cbl
  1577     MOVE UN-HOURS               TO FOR-HOURS.
  1578     MOVE UN-MINUTES             TO FOR-MINUTES.
  1579     MOVE TIME-FORMATTED         TO TIMEO.
  1580     MOVE '155A'                 TO PI-CURRENT-SCREEN-NO.
  1581     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  1582     MOVE EMI-MESSAGE-AREA (1)   TO MSGO.
  1583
  1584 8130-FORMAT-TIME-DATE-EXIT.
  1585     EXIT.
  1586
  1587 8200-RETURN-PRIOR.
  1588     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
  1589     GO TO 9200-XCTL.
  1590
  1591 8300-GET-HELP.
  1592     MOVE XCTL-EL010             TO CALL-PGM.
  1593     GO TO 9200-XCTL.
  1594
  1595 8400-RETURN-MASTER.
  1596     MOVE XCTL-EL126             TO CALL-PGM.
  1597     GO TO 9200-XCTL.
  1598
  1599 8800-UNAUTHORIZED-ACCESS.
  1600     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  1601     GO TO 8990-SEND-TEXT.
  1602
  1603 8810-PF23-ENTERED.
  1604     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  1605     MOVE XCTL-EL005             TO CALL-PGM.
  1606     GO TO 9200-XCTL.
  1607
  1608 8820-PGMID-ERROR.
  1609
  1610
  1611* EXEC CICS HANDLE CONDITION
  1612*        PGMIDERR (8990-SEND-TEXT)
  1613*    END-EXEC.
  1614*    MOVE '"$L                   ! & #00001421' TO DFHEIV0
  1615     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  1616     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1617     MOVE X'2620233030303031343231' TO DFHEIV0(25:11)
  1618     CALL 'kxdfhei1' USING DFHEIV0
  1619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1620
  1621
  1622     MOVE SPACE                  TO PI-ENTRY-CD-1.
  1623     MOVE CALL-PGM               TO PI-CALLING-PROGRAM LOGOFF-PGM
  1624     MOVE XCTL-EL005             TO CALL-PGM.
  1625     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  1626     GO TO 9200-XCTL.
  1627
  1628 8990-SEND-TEXT.
  1629
  1630
  1631* EXEC CICS SEND TEXT
  1632*        FROM    (LOGOFF-TEXT)
  1633*        LENGTH  (LOGOFF-LENGTH)
  1634*        ERASE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL155.cbl
  1635*        FREEKB
  1636*    END-EXEC.
  1637*    MOVE '8&      T  E F  H   F -   #00001433' TO DFHEIV0
  1638     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  1639     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  1640     MOVE X'2020233030303031343333' TO DFHEIV0(25:11)
  1641     CALL 'kxdfhei1' USING DFHEIV0,
  1642           LOGOFF-TEXT,
  1643           LOGOFF-LENGTH,
  1644           DFHEIV99,
  1645           DFHEIV99,
  1646           DFHEIV99,
  1647           DFHEIV99,
  1648           DFHEIV99,
  1649           DFHEIV99,
  1650           DFHEIV99,
  1651           DFHEIV99,
  1652           DFHEIV99,
  1653           DFHEIV99
  1654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1655
  1656
  1657     GO TO 9100-RETURN-CICS.
  1658
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL155.cbl
  1660 9000-RETURN-TRANS.
  1661
  1662
  1663* EXEC CICS RETURN
  1664*        TRANSID   (TRANS-ID)
  1665*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  1666*        LENGTH    (PI-COMM-LENGTH)
  1667*    END-EXEC.
  1668*    MOVE '.(CT                  &   #00001445' TO DFHEIV0
  1669     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1670     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1671     MOVE X'2020233030303031343435' TO DFHEIV0(25:11)
  1672     CALL 'kxdfhei1' USING DFHEIV0,
  1673           TRANS-ID,
  1674           PROGRAM-INTERFACE-BLOCK,
  1675           PI-COMM-LENGTH,
  1676           DFHEIV99,
  1677           DFHEIV99
  1678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1679
  1680
  1681
  1682* GOBACK.
  1683     MOVE '9%                    "   ' TO DFHEIV0
  1684     MOVE 'EL155' TO DFHEIV1
  1685     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1686     GOBACK.
  1687
  1688 9100-RETURN-CICS.
  1689
  1690
  1691* EXEC CICS RETURN
  1692*    END-EXEC.
  1693*    MOVE '.(                    &   #00001455' TO DFHEIV0
  1694     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1695     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1696     MOVE X'2020233030303031343535' TO DFHEIV0(25:11)
  1697     CALL 'kxdfhei1' USING DFHEIV0,
  1698           DFHEIV99,
  1699           DFHEIV99,
  1700           DFHEIV99,
  1701           DFHEIV99,
  1702           DFHEIV99
  1703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1704
  1705
  1706
  1707* GOBACK.
  1708     MOVE '9%                    "   ' TO DFHEIV0
  1709     MOVE 'EL155' TO DFHEIV1
  1710     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1711     GOBACK.
  1712
  1713 9200-XCTL.
  1714
  1715
  1716* EXEC CICS XCTL
  1717*        PROGRAM   (CALL-PGM)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL155.cbl
  1718*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  1719*        LENGTH    (PI-COMM-LENGTH)
  1720*    END-EXEC.
  1721*    MOVE '.$C                   $   #00001462' TO DFHEIV0
  1722     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  1723     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1724     MOVE X'2020233030303031343632' TO DFHEIV0(25:11)
  1725     CALL 'kxdfhei1' USING DFHEIV0,
  1726           CALL-PGM,
  1727           PROGRAM-INTERFACE-BLOCK,
  1728           PI-COMM-LENGTH
  1729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1730
  1731
  1732 9700-LINK-DATE-CONVERT.
  1733
  1734
  1735* EXEC CICS LINK
  1736*        PROGRAM    ('ELDATCV')
  1737*        COMMAREA   (DATE-CONVERSION-DATA)
  1738*        LENGTH     (DC-COMM-LENGTH)
  1739*        END-EXEC.
  1740     MOVE 'ELDATCV' TO DFHEIV1
  1741*    MOVE '."C                   ''   #00001470' TO DFHEIV0
  1742     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1743     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1744     MOVE X'2020233030303031343730' TO DFHEIV0(25:11)
  1745     CALL 'kxdfhei1' USING DFHEIV0,
  1746           DFHEIV1,
  1747           DATE-CONVERSION-DATA,
  1748           DC-COMM-LENGTH,
  1749           DFHEIV99,
  1750           DFHEIV99,
  1751           DFHEIV99
  1752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1753
  1754
  1755 9700-EXIT.
  1756     EXIT.
  1757
  1758 9900-ERROR-FORMAT.
  1759
  1760     IF NOT EMI-ERRORS-COMPLETE
  1761
  1762* EXEC CICS LINK
  1763*            PROGRAM   ('EL001')
  1764*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  1765*            LENGTH    (EMI-COMM-LENGTH)
  1766*        END-EXEC.
  1767     MOVE 'EL001' TO DFHEIV1
  1768*    MOVE '."C                   ''   #00001482' TO DFHEIV0
  1769     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1770     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1771     MOVE X'2020233030303031343832' TO DFHEIV0(25:11)
  1772     CALL 'kxdfhei1' USING DFHEIV0,
  1773           DFHEIV1,
  1774           ERROR-MESSAGE-INTERFACE-BLOCK,
  1775           EMI-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL155.cbl
  1776           DFHEIV99,
  1777           DFHEIV99,
  1778           DFHEIV99
  1779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1780
  1781
  1782 9900-ERROR-FORMAT-EXIT.
  1783     EXIT.
  1784
  1785 9990-ABEND.
  1786     MOVE DFHEIBLK TO EMI-LINE1.
  1787
  1788
  1789* EXEC CICS LINK
  1790*        PROGRAM   ('EL004')
  1791*        COMMAREA  (EMI-LINE1)
  1792*        LENGTH    (72)
  1793*    END-EXEC.
  1794     MOVE 'EL004' TO DFHEIV1
  1795     MOVE 72
  1796       TO DFHEIV11
  1797*    MOVE '."C                   ''   #00001494' TO DFHEIV0
  1798     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1799     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1800     MOVE X'2020233030303031343934' TO DFHEIV0(25:11)
  1801     CALL 'kxdfhei1' USING DFHEIV0,
  1802           DFHEIV1,
  1803           EMI-LINE1,
  1804           DFHEIV11,
  1805           DFHEIV99,
  1806           DFHEIV99,
  1807           DFHEIV99
  1808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1809
  1810
  1811     GO TO 8110-SEND-DATA.
  1812
  1813 9999-DFHBACK SECTION.
  1814     MOVE '9%                    "   ' TO DFHEIV0
  1815     MOVE 'EL155' TO DFHEIV1
  1816     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1817     GOBACK.
  1818 9999-DFHEXIT.
  1819     IF DFHEIGDJ EQUAL 0001
  1820         NEXT SENTENCE
  1821     ELSE IF DFHEIGDJ EQUAL 2
  1822         GO TO 8820-PGMID-ERROR,
  1823               8100-SEND-MAP,
  1824               9990-ABEND
  1825         DEPENDING ON DFHEIGDI
  1826     ELSE IF DFHEIGDJ EQUAL 3
  1827         GO TO 5000-FORM-NOT-OPEN,
  1828               4005-KEY-NOT-FOUND
  1829         DEPENDING ON DFHEIGDI
  1830     ELSE IF DFHEIGDJ EQUAL 4
  1831         GO TO 4030-END-OF-FILE,
  1832               4030-END-OF-FILE
  1833         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL155.cbl
  1834     ELSE IF DFHEIGDJ EQUAL 5
  1835         GO TO 4080-END-OF-FILE,
  1836               4080-END-OF-FILE
  1837         DEPENDING ON DFHEIGDI
  1838     ELSE IF DFHEIGDJ EQUAL 6
  1839         GO TO 8990-SEND-TEXT
  1840         DEPENDING ON DFHEIGDI.
  1841     MOVE '9%                    "   ' TO DFHEIV0
  1842     MOVE 'EL155' TO DFHEIV1
  1843     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1844     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4576     Code:        4669
