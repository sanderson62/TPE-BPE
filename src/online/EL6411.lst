* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6411.cbl
* Options: int("EL6411.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6411.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6411.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6411.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6411.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:56:12.
     7*                            VMOD=2.007.
     8*
     9*AUTHOR.           LOGIC,INC.
    10*                  DALLAS,TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6411.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            * THIS PROGRAM IS THE PROPERTY OF LOCIC, INC. *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS. TRANSACTION EXC9 - BILLING STATEMENT PRINT.
    25*        THIS PROGRAM IS USED TO PRINT THE STORED STATEMENTS AND
    26*        LABELS  DEPENDING ON THE VALUE OF THE PI-ENTRY-CODES.
    27
    28*        PRINT INITIAL STATEMENTS CODE-1 = 1
    29*                                 CODE-2 = 1
    30
    31*        RE-PRINT STATEMENTS      CODE-1 = 0
    32*                                 CODE-2 = 3
    33
    34*        PRINT ADDRESS LABELS     CODE-1 = 0
    35*                                 CODE-2 = 2
    36
    37*        PRINT SINGLE STATEMENT   CODE-1 = 0
    38*                                 CODE-2 = 4
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6411.cbl
    40 ENVIRONMENT DIVISION.
    41 DATA DIVISION.
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*   EL6411 WORKING STORAGE     *'.
    46 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.007 ************'.
    47
    48*                                COPY ELCDMD34.
    49******************************************************************
    50*                                                                *
    51*                                                                *
    52*                            ELCDMD34.                           *
    53*                            VMOD=2.001                          *
    54*                                                                *
    55*   FILE DESCRIPTION = DMD DLO034 PARAMETER AREA                 *
    56*                                                                *
    57*    LENGTH = 272    RECFRM = FIXED                              *
    58*                                                                *
    59******************************************************************
    60 01  DLO034-COMMUNICATION-AREA.
    61     12  DL34-PROCESS-TYPE             PIC X.
    62     12  DL34-COMPANY-ID               PIC XXX.
    63     12  DL34-PRINT-PROGRAM-ID         PIC X(8).
    64     12  DL34-USERID                   PIC X(4).
    65     12  DL34-PRINT-LINE               PIC X(250).
    66     12  DL34-OVERRIDE-PRINTER-ID      PIC X(4).
    67     12  DL34-RETURN-CODE              PIC XX.
    68 01  DLO034-REC-LENGTH                 PIC S9(4) COMP VALUE +272.
    69*                                COPY ELCSCTM.
    70******************************************************************
    71*                                                                *
    72*                                                                *
    73*                            ELCSCTM                             *
    74*                            VMOD=2.001                          *
    75*                                                                *
    76*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    77*                                                                *
    78******************************************************************
    79 01  SECURITY-MESSAGE.
    80     12  FILLER                          PIC X(30)
    81            VALUE '** LOGIC SECURITY VIOLATION -'.
    82     12  SM-READ                         PIC X(6).
    83     12  FILLER                          PIC X(5)
    84            VALUE ' PGM='.
    85     12  SM-PGM                          PIC X(6).
    86     12  FILLER                          PIC X(5)
    87            VALUE ' OPR='.
    88     12  SM-PROCESSOR-ID                 PIC X(4).
    89     12  FILLER                          PIC X(6)
    90            VALUE ' TERM='.
    91     12  SM-TERMID                       PIC X(4).
    92     12  FILLER                          PIC XX   VALUE SPACE.
    93     12  SM-JUL-DATE                     PIC 9(5).
    94     12  FILLER                          PIC X    VALUE SPACE.
    95     12  SM-TIME                         PIC 99.99.
    96
    97*                                COPY ELCSCRTY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6411.cbl
    98******************************************************************
    99*                                                                *
   100*                                                                *
   101*                            ELCSCRTY                            *
   102*                            VMOD=2.001                          *
   103*                                                                *
   104*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   105*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   106*        SAVED IN PI-SECURITY-ADDRESS.                           *
   107*                                                                *
   108******************************************************************
   109 01  SECURITY-CONTROL.
   110     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   111     12  FILLER                       PIC XX    VALUE 'SC'.
   112     12  SC-CREDIT-CODES.
   113         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   114             20  SC-CREDIT-DISPLAY    PIC X.
   115             20  SC-CREDIT-UPDATE     PIC X.
   116     12  SC-CLAIMS-CODES.
   117         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   118             20  SC-CLAIMS-DISPLAY    PIC X.
   119             20  SC-CLAIMS-UPDATE     PIC X.
   120
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6411.cbl
   122 01  REMOTE-PRINTER-CTRL.
   123     12  CTRL-BUFFER-LENGTH      PIC S9(04) COMP.
   124     12  CTRL-BUFFER-AREA        PIC X(20).

   126 01  WS-CONSTANTS.
   127     12  SC-ITEM                 PIC S9(4) COMP VALUE +1.
   128     12  TIME-IN                 PIC S9(7).
   129     12  FILLER REDEFINES TIME-IN.
   130        16  FILLER               PIC X.
   131        16  TIME-OUT             PIC 99V99.
   132        16  FILLER               PIC XX.
   133     12  THIS-PGM                PIC X(8)    VALUE 'EL6411'.
   134     12  PGM-EL6401              PIC X(8)    VALUE 'EL6401'.
   135     12  PGM-NAME                PIC X(8).
   136     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   137     12  BILL-ID                 PIC X(8)    VALUE 'ERBILL'.
   138     12  BILL-KEY.
   139         16  BILL-PARTIAL-KEY.
   140             20  BILL-CO         PIC X.
   141             20  BILL-CARRIER    PIC X            VALUE SPACE.
   142             20  BILL-GROUPING   PIC X(6)         VALUE SPACES.
   143             20  BILL-ACCOUNT    PIC X(10)        VALUE SPACES.
   144             20  BILL-FIN-RESP   PIC X(10)        VALUE SPACES.
   145         16  BILL-RECORD-TYPE    PIC X            VALUE SPACE.
   146         16  BILL-SEQ-NO         PIC S9(4)  COMP  VALUE +0.
   147
   148     12  BILL-SAVE-KEY           PIC X(31)        VALUE SPACES.
   149     12  BILL-SAVE-PARTIAL-KEY   PIC X(28)        VALUE SPACES.
   150
   151     12  ERROR-LINE              PIC X(80)        VALUE SPACES.
   152     12  CURRENT-SAVE            PIC XX           VALUE SPACES.
   153     12  WS-BROWSE-STARTED       PIC X VALUE 'N'.
   154     12  SUB                     PIC 9   COMP-3   VALUE ZEROS.
   155     12  WS-SKIP                 PIC 99           VALUE ZEROS.
   156     12  WS-COPIES               PIC 9            VALUE ZEROS.
   157     12  HEADER-SW               PIC X            VALUE SPACE.
   158         88  HEADER-REC-FOUND                     VALUE SPACE.
   159
   160     12  CORRESPOND-SW           PIC X            VALUE SPACE.
   161         88  CORR-REC-FOUND                       VALUE SPACE.
   162
   163     12  ADDR-SW                 PIC X            VALUE SPACE.
   164         88  ADDRESS-REC-FOUND                    VALUE SPACE.
   165
   166     12  OPTION-CODES            PIC XX           VALUE SPACES.
   167         88  PRINT-STATEMENTS        VALUE '11'.
   168         88  PRINT-LABELS            VALUE ' 2'.
   169         88  REPRINT-STATEMENTS      VALUE ' 3'.
   170         88  PRINT-SINGLE-STATEMENT  VALUE ' 4'.
   171
   172     12  COMP-132                PIC S9(4)   COMP VALUE +132.
   173     12  COMP-80                 PIC S9(4)   COMP VALUE +80.
   174     12  J-BILL-LENGTH           PIC S9(4)   COMP VALUE +210.
   175     12  JOURNAL-LENGTH          PIC S9(4)   COMP.
   176
   177     12  WS-LABEL-HOLD-AREA.
   178         16  WS-LABEL-LINES OCCURS 6 TIMES INDEXED BY L-INDX.
   179           18  WS-LABEL-ZIP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6411.cbl
   180             20  WS-LABEL-1ST-ZIP    PIC X(4).
   181             20  WS-LABEL-2ND-ZIP    PIC X(5).
   182           18  FILLER                PIC X(12).
   183           18  WS-LAST-ZIP.
   184             20  WS-LAST-1ST-ZIP     PIC X(4).
   185             20  WS-LAST-2ND-ZIP     PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6411.cbl
   187*                                COPY ELCINTF.
   188******************************************************************
   189*                                                                *
   190*                                                                *
   191*                            ELCINTF.                            *
   192*                            VMOD=2.017                          *
   193*                                                                *
   194*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   195*                                                                *
   196*       LENGTH = 1024                                            *
   197*                                                                *
   198******************************************************************
   199 01  PROGRAM-INTERFACE-BLOCK.
   200     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   201     12  PI-CALLING-PROGRAM              PIC X(8).
   202     12  PI-SAVED-PROGRAM-1              PIC X(8).
   203     12  PI-SAVED-PROGRAM-2              PIC X(8).
   204     12  PI-SAVED-PROGRAM-3              PIC X(8).
   205     12  PI-SAVED-PROGRAM-4              PIC X(8).
   206     12  PI-SAVED-PROGRAM-5              PIC X(8).
   207     12  PI-SAVED-PROGRAM-6              PIC X(8).
   208     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   209     12  PI-COMPANY-ID                   PIC XXX.
   210     12  PI-COMPANY-CD                   PIC X.
   211
   212     12  PI-COMPANY-PASSWORD             PIC X(8).
   213
   214     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   215
   216     12  PI-CONTROL-IN-PROGRESS.
   217         16  PI-CARRIER                  PIC X.
   218         16  PI-GROUPING                 PIC X(6).
   219         16  PI-STATE                    PIC XX.
   220         16  PI-ACCOUNT                  PIC X(10).
   221         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   222                                         PIC X(10).
   223         16  PI-CLAIM-CERT-GRP.
   224             20  PI-CLAIM-NO             PIC X(7).
   225             20  PI-CERT-NO.
   226                 25  PI-CERT-PRIME       PIC X(10).
   227                 25  PI-CERT-SFX         PIC X.
   228             20  PI-CERT-EFF-DT          PIC XX.
   229         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   230             20  PI-PLAN-CODE            PIC X(2).
   231             20  PI-REVISION-NUMBER      PIC X(3).
   232             20  PI-PLAN-EFF-DT          PIC X(2).
   233             20  PI-PLAN-EXP-DT          PIC X(2).
   234             20  FILLER                  PIC X(11).
   235         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   236             20  PI-OE-REFERENCE-1.
   237                 25  PI-OE-REF-1-PRIME   PIC X(18).
   238                 25  PI-OE-REF-1-SUFF    PIC XX.
   239
   240     12  PI-SESSION-IN-PROGRESS          PIC X.
   241         88  CLAIM-SESSION                   VALUE '1'.
   242         88  CREDIT-SESSION                  VALUE '2'.
   243         88  WARRANTY-SESSION                VALUE '3'.
   244         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6411.cbl
   245         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   246
   247
   248*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   249
   250     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   251     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   252
   253     12  PI-CREDIT-USER                  PIC X.
   254         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   255         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   256
   257     12  PI-CLAIM-USER                   PIC X.
   258         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   259         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   260
   261     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   262         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   263         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   264         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   265         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   266         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   267
   268     12  PI-PROCESSOR-ID                 PIC X(4).
   269
   270     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   271
   272     12  PI-MEMBER-CAPTION               PIC X(10).
   273
   274     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   275         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   276
   277     12  PI-LIFE-OVERRIDE-L1             PIC X.
   278     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   279     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   280     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   281
   282     12  PI-AH-OVERRIDE-L1               PIC X.
   283     12  PI-AH-OVERRIDE-L2               PIC XX.
   284     12  PI-AH-OVERRIDE-L6               PIC X(6).
   285     12  PI-AH-OVERRIDE-L12              PIC X(12).
   286
   287     12  PI-NEW-SYSTEM                   PIC X(2).
   288
   289     12  PI-PRIMARY-CERT-NO              PIC X(11).
   290     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   291         88  PI-USES-PAID-TO                 VALUE '1'.
   292     12  PI-CRDTCRD-SYSTEM.
   293         16  PI-CRDTCRD-USER             PIC X.
   294             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   295             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   296         16  PI-CC-MONTH-END-DT          PIC XX.
   297     12  PI-PROCESSOR-PRINTER            PIC X(4).
   298
   299     12  PI-OE-REFERENCE-2.
   300         16  PI-OE-REF-2-PRIME           PIC X(10).
   301         16  PI-OE-REF-2-SUFF            PIC X.
   302
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6411.cbl
   303     12  PI-REM-TRM-CALC-OPTION          PIC X.
   304
   305     12  PI-LANGUAGE-TYPE                PIC X.
   306             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   307             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   308             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   309
   310     12  PI-POLICY-LINKAGE-IND           PIC X.
   311         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   312         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   313                                                   LOW-VALUES.
   314
   315     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   316     12  PI-CLAIM-PW-SESSION             PIC X(1).
   317         88  PI-CLAIM-CREDIT                 VALUE '1'.
   318         88  PI-CLAIM-CONVEN                 VALUE '2'.
   319     12  FILLER                          PIC X(4).
   320
   321     12  PI-SYSTEM-LEVEL                 PIC X(145).
   322
   323     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   324         PI-SYSTEM-LEVEL.
   325
   326         16  PI-ENTRY-CODES.
   327             20  PI-ENTRY-CD-1           PIC X.
   328             20  PI-ENTRY-CD-2           PIC X.
   329
   330         16  PI-RETURN-CODES.
   331             20  PI-RETURN-CD-1          PIC X.
   332             20  PI-RETURN-CD-2          PIC X.
   333
   334         16  PI-UPDATE-STATUS-SAVE.
   335             20  PI-UPDATE-BY            PIC X(4).
   336             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   337
   338         16  PI-LOWER-CASE-LETTERS       PIC X.
   339             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   340
   341*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   342*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   343*            88  CARRIER-CLM-CNTL            VALUE '2'.
   344
   345         16  PI-CERT-ACCESS-CONTROL      PIC X.
   346             88  ST-ACCNT-CNTL               VALUE ' '.
   347             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   348             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   349             88  ACCNT-CNTL                  VALUE '3'.
   350             88  CARR-ACCNT-CNTL             VALUE '4'.
   351
   352         16  PI-PROCESSOR-CAP-LIST.
   353             20  PI-SYSTEM-CONTROLS.
   354                24 PI-SYSTEM-DISPLAY     PIC X.
   355                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   356                24 PI-SYSTEM-MODIFY      PIC X.
   357                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   358             20  FILLER                  PIC XX.
   359             20  PI-DISPLAY-CAP          PIC X.
   360                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6411.cbl
   361             20  PI-MODIFY-CAP           PIC X.
   362                 88  MODIFY-CAP              VALUE 'Y'.
   363             20  PI-MSG-AT-LOGON-CAP     PIC X.
   364                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   365             20  PI-FORCE-CAP            PIC X.
   366                 88  FORCE-CAP               VALUE 'Y'.
   367
   368         16  PI-PROGRAM-CONTROLS.
   369             20  PI-PGM-PRINT-OPT        PIC X.
   370             20  PI-PGM-FORMAT-OPT       PIC X.
   371             20  PI-PGM-PROCESS-OPT      PIC X.
   372             20  PI-PGM-TOTALS-OPT       PIC X.
   373
   374         16  PI-HELP-INTERFACE.
   375             20  PI-LAST-ERROR-NO        PIC X(4).
   376             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   377
   378         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   379             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   380
   381         16  PI-CR-CONTROL-IN-PROGRESS.
   382             20  PI-CR-CARRIER           PIC X.
   383             20  PI-CR-GROUPING          PIC X(6).
   384             20  PI-CR-STATE             PIC XX.
   385             20  PI-CR-ACCOUNT           PIC X(10).
   386             20  PI-CR-FIN-RESP          PIC X(10).
   387             20  PI-CR-TYPE              PIC X.
   388
   389         16  PI-CR-BATCH-NUMBER          PIC X(6).
   390
   391         16  PI-CR-MONTH-END-DT          PIC XX.
   392
   393         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   394             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   395             88  PI-ZERO-CARRIER             VALUE '1'.
   396             88  PI-ZERO-GROUPING            VALUE '2'.
   397             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   398
   399         16  PI-CARRIER-SECURITY         PIC X.
   400             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   401
   402         16  PI-ACCOUNT-SECURITY         PIC X(10).
   403             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   404             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   405
   406         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   407             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   408                                         INDEXED BY PI-ACCESS-NDX
   409                                         PIC X.
   410
   411         16  PI-GA-BILLING-CONTROL       PIC X.
   412             88  PI-GA-BILLING               VALUE '1'.
   413
   414         16  PI-MAIL-PROCESSING          PIC X.
   415             88  PI-MAIL-YES                 VALUE 'Y'.
   416
   417         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   418
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6411.cbl
   419         16  PI-AR-SYSTEM.
   420             20  PI-AR-PROCESSING-CNTL   PIC X.
   421                 88  PI-AR-PROCESSING        VALUE 'Y'.
   422             20  PI-AR-SUMMARY-CODE      PIC X(6).
   423             20  PI-AR-MONTH-END-DT      PIC XX.
   424
   425         16  PI-MP-SYSTEM.
   426             20  PI-MORTGAGE-USER            PIC X.
   427                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   428                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   429             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   430                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   431                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   432                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   433                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   434                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   435             20  PI-MP-MONTH-END-DT          PIC XX.
   436             20  PI-MP-REFERENCE-NO.
   437                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   438                 24  PI-MP-REFERENCE-SFX     PIC XX.
   439
   440         16  PI-LABEL-CONTROL            PIC X(01).
   441             88  PI-CREATE-LABELS                    VALUE 'Y'.
   442             88  PI-BYPASS-LABELS                    VALUE 'N'.
   443
   444         16  PI-BILL-GROUPING-CODE       PIC X(01).
   445             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   446
   447         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   448             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   449             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   450
   451         16  FILLER                      PIC X(14).
   452
   453     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   454******************************************************************
   455     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   456         16  PI-PRINT-DATE       PIC X(8).
   457         16  PI-PRINT-DATE-BIN   PIC XX.
   458         16  PI-PRINT-ID         PIC X(4).
   459         16  FILLER              PIC X(626).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6411.cbl
   461*                                COPY ELCJPFX.
   462******************************************************************
   463*                                                                *
   464*                                                                *
   465*                            ELCJPFX.                            *
   466*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   467*                            VMOD=2.002                          *
   468*                                                                *
   469*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   470*                                                                *
   471*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   472*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   473*        ELCNTL - CONTROL FILE                                   *
   474*        ELMSTR - CLAIM MASTERS                                  *
   475*        ELTRLR - ACTIVITY TRAILERS                              *
   476*        ELCHKQ - CHECK QUE                                      *
   477******************************************************************
   478 01  JOURNAL-RECORD.
   479     12  JP-USER-ID                  PIC X(4).
   480     12  JP-FILE-ID                  PIC X(8).
   481     12  JP-PROGRAM-ID               PIC X(8).
   482     12  JP-RECORD-TYPE              PIC X.
   483         88 JP-ADD              VALUE 'A'.
   484         88 JP-BEFORE-CHANGE    VALUE 'B'.
   485         88 JP-AFTER-CHANGE     VALUE 'C'.
   486         88 JP-DELETE           VALUE 'D'.
   487         88 JP-GENERIC-DELETE   VALUE 'G'.
   488         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   489         88 JP-KEY-CHG-ADD      VALUE 'N'.
   490     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   491     12  JP-RECORD-AREA
   492
   493
   494                                 PIC X(210).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6411.cbl
   496*                                COPY ELPRTCVD.
   497*****************************************************************
   498*                                                               *
   499*                            ELPRTCVD.                          *
   500*                            VMOD=2.001                         *
   501*****************************************************************.
   502
   503******************************************************************
   504***   WORK AREAS  FOR TERMINAL ONLINE PRINT ROUTINE
   505***                 -ELPRTCVD-
   506***   TO BE USED WITH PROCEDURE COPY MEMBER -ELPRTCVP-
   507******************************************************************
   508
   509 01  S-WORK-AREA                     SYNC.
   510     12  WS-LINE-LEN                 PIC S9(4)       VALUE +80
   511                                     COMP.
   512
   513     12  WS-LINE-LENGTH              PIC S9(4)       VALUE ZERO
   514                                     COMP.
   515
   516     12  WS-BUFFER-SIZE              PIC S9(4)       VALUE +1916
   517                                     COMP.
   518
   519     12  WS-BUFFER-LENGTH            PIC S9(4)       VALUE ZERO
   520                                     COMP.
   521
   522     12  WS-PROG-END                 PIC X           VALUE SPACES.
   523
   524     12  WS-PRINT-AREA.
   525         16  WS-PASSED-CNTL-CHAR     PIC X           VALUE SPACES.
   526           88  SINGLE-SPACE                          VALUE ' '.
   527           88  DOUBLE-SPACE                          VALUE '0'.
   528           88  TRIPLE-SPACE                          VALUE '-'.
   529           88  TOP-PAGE                              VALUE '1'.
   530
   531         16  WS-PASSED-DATA.
   532             20  WS-PRINT-BYTE       PIC X
   533                 OCCURS 132 TIMES    INDEXED BY PRT-INDEX.
   534
   535     12  WS-LINE-CNT                 PIC S9(3)        VALUE ZERO
   536                                     COMP-3.
   537     12  WS-WCC-CNTL                 PIC X(1)         VALUE 'H'.
   538
   539     12  WS-EM                       PIC S9(4)        VALUE +25
   540                                     COMP.
   541     12  FILLER   REDEFINES WS-EM.
   542         16  FILLER                  PIC X.
   543         16  T-EM                    PIC X.
   544
   545*    12  WS-SS                       PIC S9(4)        VALUE +21
   546     12  WS-SS                       PIC S9(4)        VALUE +10
   547                                     COMP.
   548     12  FILLER   REDEFINES WS-SS.
   549         16  FILLER                  PIC X.
   550         16  T-SS                    PIC X.
   551
   552     12  WS-TP                       PIC S9(4)      VALUE +12
   553                                     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6411.cbl
   554     12  FILLER   REDEFINES WS-TP.
   555         16  FILLER                  PIC X.
   556         16  T-TP                    PIC X.
   557
   558     12  WS-FIRST-TIME-SW            PIC X           VALUE '1'.
   559         88  FIRST-TIME                              VALUE '1'.
   560         88  FIRST-LINE-NEXT-BUFFER                  VALUE '2'.
   561
   562     12  WS-BUFFER-AREA.
   563         16  WS-BUFFER-BYTE          PIC X
   564             OCCURS 1920 TIMES       INDEXED BY BUFFER-INDEX
   565                                                BUFFER-INDEX2.
   566
   567******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6411.cbl
   569*                                COPY ELCDATE.
   570******************************************************************
   571*                                                                *
   572*                                                                *
   573*                            ELCDATE.                            *
   574*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   575*                            VMOD=2.003
   576*                                                                *
   577*                                                                *
   578*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   579*                 LENGTH = 200                                   *
   580******************************************************************
   581
   582 01  DATE-CONVERSION-DATA.
   583     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   584     12  DC-OPTION-CODE                PIC X.
   585         88  BIN-TO-GREG                VALUE ' '.
   586         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   587         88  EDIT-GREG-TO-BIN           VALUE '2'.
   588         88  YMD-GREG-TO-BIN            VALUE '3'.
   589         88  MDY-GREG-TO-BIN            VALUE '4'.
   590         88  JULIAN-TO-BIN              VALUE '5'.
   591         88  BIN-PLUS-ELAPSED           VALUE '6'.
   592         88  FIND-CENTURY               VALUE '7'.
   593         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   594         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   595         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   596         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   597         88  JULIAN-TO-BIN-3            VALUE 'C'.
   598         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   599         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   600         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   601         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   602         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   603         88  CHECK-LEAP-YEAR            VALUE 'H'.
   604         88  BIN-3-TO-GREG              VALUE 'I'.
   605         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   606         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   607         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   608         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   609         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   610         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   611         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   612         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   613         88  THREE-CHARACTER-BIN
   614                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   615         88  GREGORIAN-TO-BIN
   616                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   617         88  BIN-TO-GREGORIAN
   618                  VALUES ' ' '1' 'I' '8' 'G'.
   619         88  JULIAN-TO-BINARY
   620                  VALUES '5' 'C' 'E' 'F'.
   621     12  DC-ERROR-CODE                 PIC X.
   622         88  NO-CONVERSION-ERROR        VALUE ' '.
   623         88  DATE-CONVERSION-ERROR
   624                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   625         88  DATE-IS-ZERO               VALUE '1'.
   626         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6411.cbl
   627         88  DATE-IS-INVALID            VALUE '3'.
   628         88  DATE1-GREATER-DATE2        VALUE '4'.
   629         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   630         88  DATE-INVALID-OPTION        VALUE '9'.
   631         88  INVALID-CENTURY            VALUE 'A'.
   632         88  ONLY-CENTURY               VALUE 'B'.
   633         88  ONLY-LEAP-YEAR             VALUE 'C'.
   634         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   635     12  DC-END-OF-MONTH               PIC X.
   636         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   637     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   638         88  USE-NORMAL-PROCESS         VALUE ' '.
   639         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   640         88  ADJUST-UP-100-YRS          VALUE '2'.
   641     12  FILLER                        PIC X.
   642     12  DC-CONVERSION-DATES.
   643         16  DC-BIN-DATE-1             PIC XX.
   644         16  DC-BIN-DATE-2             PIC XX.
   645         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   646         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   647                       DC-GREG-DATE-1-EDIT.
   648             20  DC-EDIT1-MONTH        PIC 99.
   649             20  SLASH1-1              PIC X.
   650             20  DC-EDIT1-DAY          PIC 99.
   651             20  SLASH1-2              PIC X.
   652             20  DC-EDIT1-YEAR         PIC 99.
   653         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   654         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   655                     DC-GREG-DATE-2-EDIT.
   656             20  DC-EDIT2-MONTH        PIC 99.
   657             20  SLASH2-1              PIC X.
   658             20  DC-EDIT2-DAY          PIC 99.
   659             20  SLASH2-2              PIC X.
   660             20  DC-EDIT2-YEAR         PIC 99.
   661         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   662         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   663                     DC-GREG-DATE-1-YMD.
   664             20  DC-YMD-YEAR           PIC 99.
   665             20  DC-YMD-MONTH          PIC 99.
   666             20  DC-YMD-DAY            PIC 99.
   667         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   668         16  DC-GREG-DATE-1-MDY-R REDEFINES
   669                      DC-GREG-DATE-1-MDY.
   670             20  DC-MDY-MONTH          PIC 99.
   671             20  DC-MDY-DAY            PIC 99.
   672             20  DC-MDY-YEAR           PIC 99.
   673         16  DC-GREG-DATE-1-ALPHA.
   674             20  DC-ALPHA-MONTH        PIC X(10).
   675             20  DC-ALPHA-DAY          PIC 99.
   676             20  FILLER                PIC XX.
   677             20  DC-ALPHA-CENTURY.
   678                 24 DC-ALPHA-CEN-N     PIC 99.
   679             20  DC-ALPHA-YEAR         PIC 99.
   680         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   681         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   682         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   683         16  DC-JULIAN-DATE            PIC 9(05).
   684         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6411.cbl
   685                                       PIC 9(05).
   686         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   687             20  DC-JULIAN-YEAR        PIC 99.
   688             20  DC-JULIAN-DAYS        PIC 999.
   689         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   690         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   691         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   692     12  DATE-CONVERSION-VARIBLES.
   693         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   694         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   695             20  FILLER                PIC 9(3).
   696             20  HOLD-CEN-1-CCYY.
   697                 24  HOLD-CEN-1-CC     PIC 99.
   698                 24  HOLD-CEN-1-YY     PIC 99.
   699             20  HOLD-CEN-1-MO         PIC 99.
   700             20  HOLD-CEN-1-DA         PIC 99.
   701         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   702             20  HOLD-CEN-1-R-MO       PIC 99.
   703             20  HOLD-CEN-1-R-DA       PIC 99.
   704             20  HOLD-CEN-1-R-CCYY.
   705                 24  HOLD-CEN-1-R-CC   PIC 99.
   706                 24  HOLD-CEN-1-R-YY   PIC 99.
   707             20  FILLER                PIC 9(3).
   708         16  HOLD-CENTURY-1-X.
   709             20  FILLER                PIC X(3)  VALUE SPACES.
   710             20  HOLD-CEN-1-X-CCYY.
   711                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   712                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   713             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   714             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   715         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   716             20  HOLD-CEN-1-R-X-MO     PIC XX.
   717             20  HOLD-CEN-1-R-X-DA     PIC XX.
   718             20  HOLD-CEN-1-R-X-CCYY.
   719                 24  HOLD-CEN-1-R-X-CC PIC XX.
   720                 24  HOLD-CEN-1-R-X-YY PIC XX.
   721             20  FILLER                PIC XXX.
   722         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   723         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   724         16  DC-JULIAN-DATE-1          PIC 9(07).
   725         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   726             20  DC-JULIAN-1-CCYY.
   727                 24  DC-JULIAN-1-CC    PIC 99.
   728                 24  DC-JULIAN-1-YR    PIC 99.
   729             20  DC-JULIAN-DA-1        PIC 999.
   730         16  DC-JULIAN-DATE-2          PIC 9(07).
   731         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   732             20  DC-JULIAN-2-CCYY.
   733                 24  DC-JULIAN-2-CC    PIC 99.
   734                 24  DC-JULIAN-2-YR    PIC 99.
   735             20  DC-JULIAN-DA-2        PIC 999.
   736         16  DC-GREG-DATE-A-EDIT.
   737             20  DC-EDITA-MONTH        PIC 99.
   738             20  SLASHA-1              PIC X VALUE '/'.
   739             20  DC-EDITA-DAY          PIC 99.
   740             20  SLASHA-2              PIC X VALUE '/'.
   741             20  DC-EDITA-CCYY.
   742                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6411.cbl
   743                 24  DC-EDITA-YEAR     PIC 99.
   744         16  DC-GREG-DATE-B-EDIT.
   745             20  DC-EDITB-MONTH        PIC 99.
   746             20  SLASHB-1              PIC X VALUE '/'.
   747             20  DC-EDITB-DAY          PIC 99.
   748             20  SLASHB-2              PIC X VALUE '/'.
   749             20  DC-EDITB-CCYY.
   750                 24  DC-EDITB-CENT     PIC 99.
   751                 24  DC-EDITB-YEAR     PIC 99.
   752         16  DC-GREG-DATE-CYMD         PIC 9(08).
   753         16  DC-GREG-DATE-CYMD-R REDEFINES
   754                              DC-GREG-DATE-CYMD.
   755             20  DC-CYMD-CEN           PIC 99.
   756             20  DC-CYMD-YEAR          PIC 99.
   757             20  DC-CYMD-MONTH         PIC 99.
   758             20  DC-CYMD-DAY           PIC 99.
   759         16  DC-GREG-DATE-MDCY         PIC 9(08).
   760         16  DC-GREG-DATE-MDCY-R REDEFINES
   761                              DC-GREG-DATE-MDCY.
   762             20  DC-MDCY-MONTH         PIC 99.
   763             20  DC-MDCY-DAY           PIC 99.
   764             20  DC-MDCY-CEN           PIC 99.
   765             20  DC-MDCY-YEAR          PIC 99.
   766    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   767        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   768    12  DC-EL310-DATE                  PIC X(21).
   769    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6411.cbl
   771****************************************************************
   772*
   773* Copyright (c) 2007 by Clerity Solutions, Inc.
   774* All rights reserved.
   775*
   776****************************************************************
   777 01  DFHEIV.
   778   02  DFHEIV0               PIC X(35).
   779   02  DFHEIV1               PIC X(08).
   780   02  DFHEIV2               PIC X(08).
   781   02  DFHEIV3               PIC X(08).
   782   02  DFHEIV4               PIC X(06).
   783   02  DFHEIV5               PIC X(04).
   784   02  DFHEIV6               PIC X(04).
   785   02  DFHEIV7               PIC X(02).
   786   02  DFHEIV8               PIC X(02).
   787   02  DFHEIV9               PIC X(01).
   788   02  DFHEIV10              PIC S9(7) COMP-3.
   789   02  DFHEIV11              PIC S9(4) COMP SYNC.
   790   02  DFHEIV12              PIC S9(4) COMP SYNC.
   791   02  DFHEIV13              PIC S9(4) COMP SYNC.
   792   02  DFHEIV14              PIC S9(4) COMP SYNC.
   793   02  DFHEIV15              PIC S9(4) COMP SYNC.
   794   02  DFHEIV16              PIC S9(9) COMP SYNC.
   795   02  DFHEIV17              PIC X(04).
   796   02  DFHEIV18              PIC X(04).
   797   02  DFHEIV19              PIC X(04).
   798   02  DFHEIV20              USAGE IS POINTER.
   799   02  DFHEIV21              USAGE IS POINTER.
   800   02  DFHEIV22              USAGE IS POINTER.
   801   02  DFHEIV23              USAGE IS POINTER.
   802   02  DFHEIV24              USAGE IS POINTER.
   803   02  DFHEIV25              PIC S9(9) COMP SYNC.
   804   02  DFHEIV26              PIC S9(9) COMP SYNC.
   805   02  DFHEIV27              PIC S9(9) COMP SYNC.
   806   02  DFHEIV28              PIC S9(9) COMP SYNC.
   807   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   808   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   809   02  FILLER                PIC X(02).
   810   02  DFHEIV99              PIC X(08) VALUE SPACE.
   811   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   812   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   813   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   814   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   815 LINKAGE  SECTION.
   816*****************************************************************
   817*                                                               *
   818* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   819* All rights reserved.                                          *
   820*                                                               *
   821*****************************************************************
   822 01  dfheiblk.
   823     02  eibtime          pic s9(7) comp-3.
   824     02  eibdate          pic s9(7) comp-3.
   825     02  eibtrnid         pic x(4).
   826     02  eibtaskn         pic s9(7) comp-3.
   827     02  eibtrmid         pic x(4).
   828     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6411.cbl
   829     02  eibcposn         pic s9(4) comp.
   830     02  eibcalen         pic s9(4) comp.
   831     02  eibaid           pic x(1).
   832     02  eibfiller1       pic x(1).
   833     02  eibfn            pic x(2).
   834     02  eibfiller2       pic x(2).
   835     02  eibrcode         pic x(6).
   836     02  eibfiller3       pic x(2).
   837     02  eibds            pic x(8).
   838     02  eibreqid         pic x(8).
   839     02  eibrsrce         pic x(8).
   840     02  eibsync          pic x(1).
   841     02  eibfree          pic x(1).
   842     02  eibrecv          pic x(1).
   843     02  eibsend          pic x(1).
   844     02  eibatt           pic x(1).
   845     02  eibeoc           pic x(1).
   846     02  eibfmh           pic x(1).
   847     02  eibcompl         pic x(1).
   848     02  eibsig           pic x(1).
   849     02  eibconf          pic x(1).
   850     02  eiberr           pic x(1).
   851     02  eibrldbk         pic x(1).
   852     02  eiberrcd         pic x(4).
   853     02  eibsynrb         pic x(1).
   854     02  eibnodat         pic x(1).
   855     02  eibfiller5       pic x(2).
   856     02  eibresp          pic 9(09) comp.
   857     02  eibresp2         pic 9(09) comp.
   858     02  dfheigdj         pic s9(4) comp.
   859     02  dfheigdk         pic s9(4) comp.
   860*01 PARMLIST .
   861*    02  FILLER            PIC S9(8)   COMP.
   862*    02  BILL-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6411.cbl
   864*                            COPY ERCBILL.
   865******************************************************************
   866*                                                                *
   867*                                                                *
   868*                            ERCBILL                             *
   869*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   870*                            VMOD=2.007                          *
   871*                                                                *
   872*   FILE DESCRIPTION = BILLING STATEMENTS FOR PRINTING           *
   873*                                                                *
   874*   FILE TYPE = VSAM,KSDS                                        *
   875*   RECORD SIZE = 210  RECFORM = FIXED                           *
   876*                                                                *
   877*   BASE CLUSTER = ERBILL                        RKP=2,LEN=31    *
   878*                                                                *
   879*   LOG = NO                                                     *
   880*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   881******************************************************************
   882 01  DFHCOMMAREA       PIC X(01).
   883 01  BILLING-STATEMENT.
   884     02 BILLING-STATEMENT-FILE.
   885     12  BI-RECORD-ID                PIC XX.
   886         88  VALID-BI-ID                VALUE 'BI'.
   887
   888     12  BI-CONTROL-PRIMARY.
   889         16  BI-COMPANY-CD           PIC X.
   890         16  BI-CARRIER              PIC X.
   891         16  BI-GROUPING             PIC X(6).
   892         16  BI-ACCOUNT              PIC X(10).
   893         16  BI-FIN-RESP             PIC X(10).
   894         16  BI-RECORD-TYPE          PIC X.
   895             88  BI-HEADER-DATA         VALUE '1'.
   896             88  BI-ADDRESS-DATA        VALUE '2'.
   897             88  BI-TEXT-DATA           VALUE '3'.
   898         16  BI-LINE-SEQ-NO          PIC S9(4)     COMP.
   899
   900     12  BI-TEXT-RECORD.
   901         16  BI-SKIP-CONTROL         PIC X.
   902         16  BI-TEXT-LINE            PIC X(157).
   903         16  BI-TEXT-LINE-1 REDEFINES BI-TEXT-LINE.
   904             20  BI-ADDR-LIT         PIC X(14).
   905             20  BI-CO               PIC X(7).
   906             20  BI-DASH             PIC X.
   907             20  BI-ACCT             PIC X(10).
   908             20  FILLER              PIC XX.
   909             20  BI-ACCT-ADDR        PIC X(30).
   910             20  FILLER              PIC X.
   911             20  BI-REMIT-LIT        PIC X(11).
   912             20  FILLER              PIC XX.
   913             20  BI-REMIT-ADDR       PIC X(30).
   914             20  FILLER              PIC X(49).
   915         16  BI-TEXT-LINE-2 REDEFINES BI-TEXT-LINE.
   916             20  BI-INS-LAST-NAME    PIC X(15).
   917             20  FILLER              PIC X.
   918             20  BI-INS-1ST-NAME     PIC X(10).
   919             20  FILLER REDEFINES BI-INS-1ST-NAME.
   920                 24  BI-INS-INITS    PIC XX.
   921                 24  FILLER          PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6411.cbl
   922             20  FILLER              PIC X.
   923             20  BI-UNDRWRTR.
   924                 24  BI-INS-INIT     PIC X.
   925                 24  FILLER          PIC XXX.
   926             20  BI-CERT             PIC X(11).
   927             20  FILLER              PIC XX.
   928             20  BI-EFF-DT           PIC X(8).
   929             20  FILLER              PIC XX.
   930             20  BI-CAN-DT           PIC X(8).
   931             20  FILLER              PIC XX.
   932             20  BI-ED-TERM          PIC ZZZ.
   933             20  FILLER              PIC XX.
   934             20  BI-TYPE             PIC XXXX.
   935             20  FILLER              PIC X.
   936             20  BI-PREM             PIC ZZ,ZZZ,ZZZ.ZZ-.
   937             20  FILLER              PIC X(3).
   938             20  BI-ED-RATE          PIC ZZZ.ZZZ.
   939             20  FILLER              PIC XX.
   940             20  BI-COMM             PIC ZZ,ZZZ,ZZZ.ZZ-.
   941             20  FILLER              PIC XX.
   942             20  BI-FACE-AMT         PIC ZZZ,ZZZ,ZZZ.ZZ-.
   943             20  FILLER              PIC X(26).
   944         16  BI-TEXT-LINE-3 REDEFINES BI-TEXT-LINE.
   945             20  FILLER              PIC X(42).
   946             20  BI-TOT-DESC         PIC X(20).
   947             20  FILLER REDEFINES BI-TOT-DESC.
   948                 24  BI-TOT-LIT      PIC X(6).
   949                 24  BI-OVERRIDE-L6  PIC X(14).
   950             20  FILLER              PIC X(11).
   951             20  BI-TOT-PREM         PIC ZZZ,ZZZ,ZZZ.99-.
   952             20  BI-TOT-DASH REDEFINES
   953                 BI-TOT-PREM         PIC X(15).
   954             20  FILLER              PIC X(11).
   955             20  BI-COM-TOT          PIC ZZZ,ZZZ,ZZZ.99-.
   956             20  FILLER              PIC XX.
   957             20  BI-FACE-TOT         PIC ZZZ,ZZZ,ZZZ.99-.
   958             20  FILLER              PIC X(26).
   959         16  BI-TEXT-LINE-4 REDEFINES BI-TEXT-LINE.
   960             20  BI-ENTRY-DESC       PIC X(30).
   961             20  FILLER              PIC X(11).
   962             20  BI-ENTRY-AMT        PIC ZZZZ,ZZZ,ZZZ.99-.
   963             20  FILLER              PIC X(31).
   964             20  BI-ACCTG-COMMENT    PIC X(30).
   965             20  FILLER              PIC X(39).
   966         16  BI-TEXT-LINE-5 REDEFINES BI-TEXT-LINE.
   967             20  FILLER              PIC X(42).
   968             20  BI-TOT-DESC5        PIC X(20).
   969             20  FILLER              PIC X(11).
   970             20  BI-TOT-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
   971             20  BI-COM-TOT5         PIC ZZZ,ZZZ,ZZZ.99-.
   972             20  BI-NON-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
   973             20  BI-NON-COMM5        PIC ZZZ,ZZZ,ZZZ.99-.
   974             20  FILLER              PIC X(24).
   975         16  BI-TEXT-FIRST REDEFINES BI-TEXT-LINE.
   976             20  BI-TEXT-2-81        PIC X(80).
   977             20  FILLER              PIC X(77).
   978         16  BI-TEXT-LAST REDEFINES BI-TEXT-LINE.
   979             20  FILLER              PIC X(53).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6411.cbl
   980             20  BI-TEXT-55-133      PIC X(79).
   981             20  FILLER              PIC X(25).
   982         16  BI-TEXT-TYPE            PIC X.
   983             88 DETAIL-LINE              VALUE 'D'.
   984         16  BI-TERM                 PIC S999.
   985         16  BI-BENEFIT-AMT          PIC S9(9)V99 COMP-3.
   986         16  BI-PREMIUM-AMT          PIC S9(7)V99 COMP-3.
   987         16  BI-RATE                 PIC S99V9(5) COMP-3.
   988
   989     12  BI-ADDRESS-RECORD  REDEFINES  BI-TEXT-RECORD.
   990         16  FILLER                  PIC X.
   991         16  BI-ACCT-ADDRESS-LINE    PIC X(30).
   992         16  FILLER                  PIC X(10).
   993         16  BI-REMIT-ADDRESS-LINE   PIC X(30).
   994         16  FILLER                  PIC X(106).
   995
   996     12  BI-HEADER-RECORD  REDEFINES  BI-TEXT-RECORD.
   997         16  BI-PROCESSOR-CD         PIC X(4).
   998         16  BI-STATEMENT-TYPE       PIC X.
   999             88  BI-PREVIEW-ONLY         VALUE 'P'.
  1000         16  BI-NO-OF-COPIES         PIC S9.
  1001         16  BI-CREATION-DT          PIC XX.
  1002         16  BI-INITIAL-PRINT-DATE   PIC XX.
  1003         16  BI-ACCOUNT-TOTALS.
  1004             20  BI-BAL-FRWD         PIC S9(9)V99     COMP-3.
  1005             20  BI-PREMIUM          PIC S9(9)V99     COMP-3.
  1006             20  BI-REMITTED         PIC S9(9)V99     COMP-3.
  1007             20  BI-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  1008             20  BI-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  1009             20  BI-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  1010             20  BI-DISBURSED        PIC S9(9)V99     COMP-3.
  1011             20  BI-END-BAL          PIC S9(9)V99     COMP-3.
  1012         16  BI-FIN-RESP-ACCT        PIC X(10).
  1013         16  BI-FIN-RESP-NAME        PIC X(30).
  1014         16  FILLER                  PIC X(79).
  1015
  1016
  1017     02 GA-BILLING-STATEMENT REDEFINES BILLING-STATEMENT-FILE.
  1018     12  FILLER                      PIC XX.
  1019
  1020     12  GA-CONTROL-PRIMARY.
  1021         16  FILLER                  PIC X(31).
  1022
  1023     12  GA-TEXT-RECORD.
  1024         16  GA-SKIP-CONTROL         PIC X.
  1025         16  GA-TEXT-LINE            PIC X(132).
  1026         16  GA-TEXT-LINE-1 REDEFINES GA-TEXT-LINE.
  1027             20  FILLER              PIC X.
  1028             20  GA-CARRIER          PIC X.
  1029             20  GA-GROUPING         PIC X(6).
  1030             20  GA-DASH             PIC X.
  1031             20  GA-AGENT            PIC X(10).
  1032             20  FILLER              PIC X.
  1033             20  GA-AGENT-ADDR       PIC X(30).
  1034             20  FILLER              PIC X(82).
  1035         16  GA-TEXT-LINE-2 REDEFINES GA-TEXT-LINE.
  1036             20  GA-ACCT             PIC X(10).
  1037             20  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6411.cbl
  1038             20  GA-ACCT-NAME        PIC X(30).
  1039             20  GA-BEG-BAL          PIC ZZZZ,ZZZ.99-.
  1040             20  GA-NET-PREM         PIC ZZZZ,ZZZ.ZZ-.
  1041             20  GA-ACCT-COMP        PIC ZZZZ,ZZZ.ZZ-.
  1042             20  GA-PMTS-ADJS        PIC ZZZZ,ZZZ.ZZ-.
  1043             20  GA-UNPAID-NET-PREM  PIC ZZZZ,ZZZ.ZZ-.
  1044             20  GA-BEN-OVERRIDE-L6  PIC X(6).
  1045             20  FILLER              PIC X.
  1046             20  GA-OVERWRITE        PIC ZZZZ,ZZZ.ZZ-.
  1047             20  GA-AMT-DUE          PIC ZZZ,ZZZ.99-.
  1048             20  FILLER              PIC X.
  1049         16  GA-TEXT-LINE-3 REDEFINES GA-TEXT-LINE.
  1050             20  FILLER              PIC X(11).
  1051             20  GA-ENTRY-DESC       PIC X(30).
  1052             20  FILLER              PIC X(60).
  1053             20  GA-ENTRY-COMMENT    PIC X(30).
  1054             20  FILLER              PIC X.
  1055         16  FILLER.
  1056             20  GA-BENEFIT-CD       PIC XX.
  1057             20  GA-BEG-BAL-AMT      PIC S9(7)V99 COMP-3.
  1058             20  GA-END-BAL-AMT      PIC S9(7)V99 COMP-3.
  1059             20  GA-NET-PREM-AMT     PIC S9(7)V99 COMP-3.
  1060             20  GA-ACCT-COMP-AMT    PIC S9(7)V99 COMP-3.
  1061             20  GA-PMTS-ADJS-AMT    PIC S9(7)V99 COMP-3.
  1062             20  GA-UNPAID-NET-AMT   PIC S9(7)V99 COMP-3.
  1063             20  GA-OVERWRITE-AMT    PIC S9(7)V99 COMP-3.
  1064             20  GA-AMT-DUE-AMT      PIC S9(7)V99 COMP-3.
  1065
  1066     12  GA-ADDRESS-RECORD  REDEFINES  GA-TEXT-RECORD.
  1067         16  FILLER                  PIC X.
  1068         16  GA-ACCT-ADDRESS-LINE    PIC X(30).
  1069         16  FILLER                  PIC X(144).
  1070
  1071     12  GA-HEADER-RECORD  REDEFINES  GA-TEXT-RECORD.
  1072         16  GA-PROCESSOR-CD         PIC X(4).
  1073         16  GA-STATEMENT-TYPE       PIC X.
  1074             88  GA-PREVIEW-ONLY         VALUE 'P'.
  1075         16  GA-NO-OF-COPIES         PIC S9.
  1076         16  GA-CREATION-DT          PIC XX.
  1077         16  GA-INITIAL-PRINT-DATE   PIC XX.
  1078         16  GA-AGENT-TOTALS.
  1079             20  GA-NET-UNPD         PIC S9(9)V99     COMP-3.
  1080             20  GA-COMP-UNPD-PREM   PIC S9(9)V99     COMP-3.
  1081             20  GA-PREMIUM          PIC S9(9)V99     COMP-3.
  1082             20  GA-REMITTED         PIC S9(9)V99     COMP-3.
  1083             20  GA-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  1084             20  GA-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  1085             20  GA-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  1086             20  GA-DISBURSED        PIC S9(9)V99     COMP-3.
  1087             20  GA-END-BALANCE      PIC S9(9)V99     COMP-3.
  1088         16  GA-AGENTS-NAME          PIC X(30).
  1089         16  FILLER                  PIC X(81).
  1090     12  FILLER                      PIC XX.
  1091
  1092
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6411.cbl
  1094 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA BILLING-STATEMENT.
  1095 0000-DFHEXIT SECTION.
  1096     MOVE '9#                    $   ' TO DFHEIV0.
  1097     MOVE 'EL6411' TO DFHEIV1.
  1098     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1099
  1100     MOVE SPACES                 TO DL34-PROCESS-TYPE.
  1101
  1102 0100-RETRIEVE-LOOP.
  1103
  1104* EXEC CICS HANDLE CONDITION
  1105*         ENDDATA  (0200-END-DATA)
  1106*         NOTFND   (0300-NOT-FOUND)
  1107*    END-EXEC.
  1108*    MOVE '"$&I                  ! " #00001099' TO DFHEIV0
  1109     MOVE X'222426492020202020202020' TO DFHEIV0(1:12)
  1110     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1111     MOVE X'2220233030303031303939' TO DFHEIV0(25:11)
  1112     CALL 'kxdfhei1' USING DFHEIV0
  1113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1114
  1115
  1116
  1117* EXEC CICS RETRIEVE
  1118*         INTO   (PROGRAM-INTERFACE-BLOCK)
  1119*         LENGTH (PI-COMM-LENGTH)
  1120*    END-EXEC.
  1121*    MOVE '0*I L                 &   #00001104' TO DFHEIV0
  1122     MOVE X'302A49204C20202020202020' TO DFHEIV0(1:12)
  1123     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1124     MOVE X'2020233030303031313034' TO DFHEIV0(25:11)
  1125     CALL 'kxdfhei1' USING DFHEIV0,
  1126           PROGRAM-INTERFACE-BLOCK,
  1127           PI-COMM-LENGTH,
  1128           DFHEIV99,
  1129           DFHEIV99,
  1130           DFHEIV99
  1131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1132
  1133
  1134* DLO034 OPEN WHEN DMD OR CID
  1135     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  1136         IF DL34-PROCESS-TYPE IS EQUAL TO SPACES
  1137             MOVE 'O'                TO DL34-PROCESS-TYPE
  1138             MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1139             MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1140             MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1141             MOVE SPACES             TO DL34-PRINT-LINE
  1142             MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
  1143
  1144* EXEC CICS LINK
  1145*                PROGRAM    ('DLO034')
  1146*                COMMAREA   (DLO034-COMMUNICATION-AREA)
  1147*                LENGTH     (DLO034-REC-LENGTH)
  1148*            END-EXEC
  1149     MOVE 'DLO034' TO DFHEIV1
  1150*    MOVE '."C                   ''   #00001118' TO DFHEIV0
  1151     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6411.cbl
  1152     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1153     MOVE X'2020233030303031313138' TO DFHEIV0(25:11)
  1154     CALL 'kxdfhei1' USING DFHEIV0,
  1155           DFHEIV1,
  1156           DLO034-COMMUNICATION-AREA,
  1157           DLO034-REC-LENGTH,
  1158           DFHEIV99,
  1159           DFHEIV99,
  1160           DFHEIV99
  1161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1162             IF DL34-RETURN-CODE NOT = 'OK'
  1163                 MOVE  '**DLO034 OPEN ERROR - ABORT**'
  1164                                     TO ERROR-LINE
  1165                 PERFORM 0400-SEND-TEXT
  1166
  1167* EXEC CICS RETURN
  1168*                END-EXEC.
  1169*    MOVE '.(                    &   #00001127' TO DFHEIV0
  1170     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1171     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1172     MOVE X'2020233030303031313237' TO DFHEIV0(25:11)
  1173     CALL 'kxdfhei1' USING DFHEIV0,
  1174           DFHEIV99,
  1175           DFHEIV99,
  1176           DFHEIV99,
  1177           DFHEIV99,
  1178           DFHEIV99
  1179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1180
  1181
  1182     PERFORM 1000-INITIALIZE             THRU 1000-EXIT.
  1183
  1184     PERFORM 2000-BROWSE-BILLING-HEADERS THRU 2099-EXIT.
  1185
  1186 0200-END-DATA.
  1187
  1188* DLO034 CLOSE
  1189     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  1190         MOVE 'C'                TO DL34-PROCESS-TYPE
  1191         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1192         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1193         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1194         MOVE SPACES             TO DL34-PRINT-LINE
  1195                                    DL34-OVERRIDE-PRINTER-ID
  1196
  1197* EXEC CICS LINK
  1198*            PROGRAM    ('DLO034')
  1199*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  1200*            LENGTH     (DLO034-REC-LENGTH)
  1201*        END-EXEC
  1202     MOVE 'DLO034' TO DFHEIV1
  1203*    MOVE '."C                   ''   #00001144' TO DFHEIV0
  1204     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1205     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1206     MOVE X'2020233030303031313434' TO DFHEIV0(25:11)
  1207     CALL 'kxdfhei1' USING DFHEIV0,
  1208           DFHEIV1,
  1209           DLO034-COMMUNICATION-AREA,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6411.cbl
  1210           DLO034-REC-LENGTH,
  1211           DFHEIV99,
  1212           DFHEIV99,
  1213           DFHEIV99
  1214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1215         IF DL34-RETURN-CODE NOT = 'OK'
  1216             MOVE  '**DLO034 CLOSE ERROR - ABORT**'
  1217                                 TO ERROR-LINE
  1218             PERFORM 0400-SEND-TEXT.
  1219
  1220
  1221* EXEC CICS RETURN
  1222*    END-EXEC.
  1223*    MOVE '.(                    &   #00001154' TO DFHEIV0
  1224     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1225     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1226     MOVE X'2020233030303031313534' TO DFHEIV0(25:11)
  1227     CALL 'kxdfhei1' USING DFHEIV0,
  1228           DFHEIV99,
  1229           DFHEIV99,
  1230           DFHEIV99,
  1231           DFHEIV99,
  1232           DFHEIV99
  1233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1234
  1235
  1236* GOBACK.
  1237     MOVE '9%                    "   ' TO DFHEIV0
  1238     MOVE 'EL6411' TO DFHEIV1
  1239     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1240     GOBACK.
  1241
  1242 0300-NOT-FOUND.
  1243     MOVE 'NO COMMUNICATION AREA FOUND' TO ERROR-LINE
  1244     PERFORM 0400-SEND-TEXT
  1245     GO TO 0200-END-DATA.
  1246
  1247 0400-SEND-TEXT.
  1248
  1249* EXEC CICS SEND TEXT
  1250*         FROM   (ERROR-LINE)
  1251*         LENGTH (70)
  1252*    END-EXEC.
  1253     MOVE 70
  1254       TO DFHEIV11
  1255*    MOVE '8&      T       H   F -   #00001164' TO DFHEIV0
  1256     MOVE X'382620202020202054202020' TO DFHEIV0(1:12)
  1257     MOVE X'202020204820202046202D20' TO DFHEIV0(13:12)
  1258     MOVE X'2020233030303031313634' TO DFHEIV0(25:11)
  1259     CALL 'kxdfhei1' USING DFHEIV0,
  1260           ERROR-LINE,
  1261           DFHEIV11,
  1262           DFHEIV99,
  1263           DFHEIV99,
  1264           DFHEIV99,
  1265           DFHEIV99,
  1266           DFHEIV99,
  1267           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6411.cbl
  1268           DFHEIV99,
  1269           DFHEIV99,
  1270           DFHEIV99,
  1271           DFHEIV99
  1272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1273
  1274
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6411.cbl
  1276 1000-INITIALIZE.
  1277     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1278     MOVE '5'                    TO DC-OPTION-CODE.
  1279     PERFORM 9700-DATE-LINK THRU  9700-EXIT.
  1280     MOVE DC-BIN-DATE-1          TO CURRENT-SAVE.
  1281     MOVE PI-COMPANY-CD          TO BILL-CO.
  1282     MOVE PI-ENTRY-CODES         TO OPTION-CODES.
  1283     MOVE COMP-132               TO WS-LINE-LEN.
  1284
  1285 1000-EXIT.
  1286     EXIT.
  1287
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6411.cbl
  1289 2000-BROWSE-BILLING-HEADERS.
  1290     MOVE LOW-VALUES             TO BILL-KEY.
  1291
  1292     IF PRINT-SINGLE-STATEMENT
  1293         MOVE PI-COMPANY-CD  TO  BILL-CO
  1294         MOVE PI-CR-CARRIER  TO  BILL-CARRIER
  1295         MOVE PI-CR-GROUPING TO  BILL-GROUPING
  1296         MOVE PI-CR-ACCOUNT  TO  BILL-ACCOUNT
  1297         MOVE PI-CR-FIN-RESP TO  BILL-FIN-RESP
  1298         MOVE '1'            TO  BILL-RECORD-TYPE
  1299     ELSE
  1300         MOVE PI-COMPANY-CD  TO  BILL-CO.
  1301
  1302
  1303* EXEC CICS HANDLE CONDITION
  1304*         NOTFND (2099-EXIT)
  1305*         NOTOPEN(8890-BILL-NOT-OPEN)
  1306*    END-EXEC.
  1307*    MOVE '"$IJ                  ! # #00001196' TO DFHEIV0
  1308     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  1309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1310     MOVE X'2320233030303031313936' TO DFHEIV0(25:11)
  1311     CALL 'kxdfhei1' USING DFHEIV0
  1312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1313
  1314
  1315 2005-START.
  1316
  1317* EXEC CICS STARTBR
  1318*         DATASET(BILL-ID)
  1319*         RIDFLD (BILL-KEY)
  1320*     END-EXEC.
  1321     MOVE 0
  1322       TO DFHEIV11
  1323*    MOVE '&,         G          &   #00001202' TO DFHEIV0
  1324     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1325     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1326     MOVE X'2020233030303031323032' TO DFHEIV0(25:11)
  1327     CALL 'kxdfhei1' USING DFHEIV0,
  1328           BILL-ID,
  1329           BILL-KEY,
  1330           DFHEIV99,
  1331           DFHEIV11,
  1332           DFHEIV99
  1333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1334
  1335
  1336     MOVE 'Y'                    TO WS-BROWSE-STARTED.
  1337
  1338 2010-READ-NEXT.
  1339
  1340* EXEC CICS HANDLE CONDITION
  1341*         NOTFND (2050-END-BR)
  1342*         ENDFILE(2050-END-BR)
  1343*         NOTOPEN(8890-BILL-NOT-OPEN)
  1344*    END-EXEC.
  1345*    MOVE '"$I''J                 ! $ #00001210' TO DFHEIV0
  1346     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6411.cbl
  1347     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1348     MOVE X'2420233030303031323130' TO DFHEIV0(25:11)
  1349     CALL 'kxdfhei1' USING DFHEIV0
  1350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1351
  1352
  1353
  1354* EXEC CICS READNEXT
  1355*         DATASET(BILL-ID)
  1356*         RIDFLD (BILL-KEY)
  1357*         SET    (ADDRESS OF BILLING-STATEMENT)
  1358*    END-EXEC.
  1359     MOVE 0
  1360       TO DFHEIV11
  1361*    MOVE '&.S                   )   #00001216' TO DFHEIV0
  1362     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1363     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1364     MOVE X'2020233030303031323136' TO DFHEIV0(25:11)
  1365     CALL 'kxdfhei1' USING DFHEIV0,
  1366           BILL-ID,
  1367           DFHEIV20,
  1368           DFHEIV99,
  1369           BILL-KEY,
  1370           DFHEIV99,
  1371           DFHEIV11,
  1372           DFHEIV99,
  1373           DFHEIV99
  1374     SET ADDRESS OF BILLING-STATEMENT TO
  1375         DFHEIV20
  1376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1377
  1378
  1379     IF PI-COMPANY-CD NOT = BILL-CO
  1380        GO TO 2050-END-BR.
  1381
  1382     IF BILL-RECORD-TYPE = '1'
  1383            NEXT SENTENCE
  1384     ELSE
  1385        MOVE 9999                TO BILL-SEQ-NO
  1386        GO TO 2010-READ-NEXT.
  1387
  1388     MOVE BILL-KEY              TO BILL-SAVE-KEY.
  1389
  1390     IF PRINT-STATEMENTS
  1391        PERFORM 2900-PRINT-STATEMENTS THRU 2999-EXIT
  1392        IF WS-BROWSE-STARTED = 'N'
  1393           GO TO 2005-START
  1394          ELSE
  1395           GO TO 2010-READ-NEXT.
  1396
  1397     IF REPRINT-STATEMENTS
  1398        PERFORM 2200-REPRINT-STATEMENTS THRU 2299-EXIT
  1399        IF WS-BROWSE-STARTED = 'N'
  1400           GO TO 2005-START
  1401          ELSE
  1402        GO TO 2010-READ-NEXT.
  1403
  1404     IF PRINT-SINGLE-STATEMENT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6411.cbl
  1405        PERFORM 2900-PRINT-STATEMENTS THRU 2999-EXIT
  1406        GO TO 2050-END-BR.
  1407
  1408     PERFORM 2300-STATEMENT-LABELS THRU 2399-EXIT.
  1409     GO TO 2010-READ-NEXT.
  1410
  1411 2050-END-BR.
  1412     IF PRINT-LABELS
  1413        MOVE 'X'                 TO WS-PROG-END
  1414        PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1415
  1416     IF WS-BROWSE-STARTED = 'Y'
  1417        MOVE 'N'                 TO WS-BROWSE-STARTED
  1418
  1419* EXEC CICS ENDBR
  1420*            DATASET(BILL-ID)
  1421*        END-EXEC.
  1422     MOVE 0
  1423       TO DFHEIV11
  1424*    MOVE '&2                    $   #00001261' TO DFHEIV0
  1425     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1426     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1427     MOVE X'2020233030303031323631' TO DFHEIV0(25:11)
  1428     CALL 'kxdfhei1' USING DFHEIV0,
  1429           BILL-ID,
  1430           DFHEIV11,
  1431           DFHEIV99
  1432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1433
  1434
  1435 2099-EXIT.
  1436      EXIT.
  1437
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6411.cbl
  1439 2200-REPRINT-STATEMENTS.
  1440     IF BI-INITIAL-PRINT-DATE   = PI-PRINT-DATE-BIN
  1441        MOVE BI-NO-OF-COPIES     TO WS-COPIES
  1442        PERFORM 7200-PRINT-TEXT  THRU 7299-EXIT
  1443                WS-COPIES TIMES.
  1444
  1445 2299-EXIT.
  1446      EXIT.
  1447
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6411.cbl
  1449 2300-STATEMENT-LABELS.
  1450     IF FIRST-TIME
  1451        PERFORM 2400-ALIGNMENT-PRINT THRU 2450-EXIT.
  1452
  1453     IF BI-INITIAL-PRINT-DATE = PI-PRINT-DATE-BIN
  1454        PERFORM 7200-PRINT-TEXT THRU 7299-EXIT.
  1455
  1456 2399-EXIT.
  1457      EXIT.
  1458
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6411.cbl
  1460 2400-ALIGNMENT-PRINT.
  1461     MOVE ALL '*'                TO WS-LABEL-HOLD-AREA.
  1462     MOVE SPACE                  TO WS-PASSED-CNTL-CHAR.
  1463     MOVE SPACES                 TO WS-LABEL-LINES (6).
  1464     PERFORM 2480-MOVE-TO-PRINT THRU 2499-EXIT 6 TIMES.
  1465
  1466 2450-EXIT.
  1467      EXIT.
  1468
  1469 2480-MOVE-TO-PRINT.
  1470     MOVE WS-LABEL-LINES (1)     TO WS-PASSED-DATA.
  1471     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1472     MOVE WS-LABEL-LINES (2)     TO WS-PASSED-DATA.
  1473     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1474     MOVE WS-LABEL-LINES (3)     TO WS-PASSED-DATA.
  1475     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1476     MOVE WS-LABEL-LINES (4)     TO WS-PASSED-DATA.
  1477     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1478     MOVE WS-LABEL-LINES (5)     TO WS-PASSED-DATA.
  1479     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1480     MOVE WS-LABEL-LINES (6)     TO WS-PASSED-DATA.
  1481     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1482
  1483 2499-EXIT.
  1484      EXIT.
  1485
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6411.cbl
  1487 2900-PRINT-STATEMENTS.
  1488     IF BI-INITIAL-PRINT-DATE = LOW-VALUES
  1489       OR PRINT-SINGLE-STATEMENT
  1490        PERFORM 7300-UPDATE-BILLING-HEADER THRU 7399-EXIT
  1491        IF HEADER-REC-FOUND
  1492           PERFORM 7200-PRINT-TEXT THRU 7299-EXIT
  1493                   WS-COPIES TIMES.
  1494
  1495 2999-EXIT.
  1496     EXIT.
  1497
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6411.cbl
  1499 7200-PRINT-TEXT.
  1500     MOVE SPACES                 TO WS-PROG-END.
  1501
  1502     IF PRINT-LABELS
  1503        MOVE '2'                 TO BILL-RECORD-TYPE
  1504        SET L-INDX               TO 1
  1505     ELSE
  1506        MOVE '3'                 TO BILL-RECORD-TYPE.
  1507
  1508     MOVE ZEROS                  TO BILL-SEQ-NO.
  1509
  1510
  1511* EXEC CICS HANDLE CONDITION
  1512*         NOTFND (7250-CHECK-FIRST-SW)
  1513*         ENDFILE(7250-CHECK-FIRST-SW)
  1514*         NOTOPEN(8890-BILL-NOT-OPEN)
  1515*    END-EXEC.
  1516*    MOVE '"$I''J                 ! % #00001340' TO DFHEIV0
  1517     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  1518     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1519     MOVE X'2520233030303031333430' TO DFHEIV0(25:11)
  1520     CALL 'kxdfhei1' USING DFHEIV0
  1521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1522
  1523
  1524     IF WS-BROWSE-STARTED = 'Y'
  1525         NEXT SENTENCE
  1526     ELSE
  1527
  1528* EXEC CICS STARTBR
  1529*            DATASET(BILL-ID)
  1530*            RIDFLD (BILL-KEY)
  1531*        END-EXEC
  1532     MOVE 0
  1533       TO DFHEIV11
  1534*    MOVE '&,         G          &   #00001349' TO DFHEIV0
  1535     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1536     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1537     MOVE X'2020233030303031333439' TO DFHEIV0(25:11)
  1538     CALL 'kxdfhei1' USING DFHEIV0,
  1539           BILL-ID,
  1540           BILL-KEY,
  1541           DFHEIV99,
  1542           DFHEIV11,
  1543           DFHEIV99
  1544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1545         MOVE 'Y'                TO WS-BROWSE-STARTED.
  1546
  1547     MOVE BILL-PARTIAL-KEY       TO BILL-SAVE-PARTIAL-KEY.
  1548
  1549 7210-READ-NEXT.
  1550
  1551* EXEC CICS READNEXT
  1552*         DATASET(BILL-ID)
  1553*         RIDFLD (BILL-KEY)
  1554*         SET    (ADDRESS OF BILLING-STATEMENT)
  1555*    END-EXEC.
  1556     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6411.cbl
  1557       TO DFHEIV11
  1558*    MOVE '&.S                   )   #00001358' TO DFHEIV0
  1559     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1560     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1561     MOVE X'2020233030303031333538' TO DFHEIV0(25:11)
  1562     CALL 'kxdfhei1' USING DFHEIV0,
  1563           BILL-ID,
  1564           DFHEIV20,
  1565           DFHEIV99,
  1566           BILL-KEY,
  1567           DFHEIV99,
  1568           DFHEIV11,
  1569           DFHEIV99,
  1570           DFHEIV99
  1571     SET ADDRESS OF BILLING-STATEMENT TO
  1572         DFHEIV20
  1573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1574
  1575
  1576     IF BILL-PARTIAL-KEY NOT = BILL-SAVE-PARTIAL-KEY
  1577        GO TO 7250-CHECK-FIRST-SW.
  1578
  1579     IF PRINT-LABELS
  1580        MOVE BI-ACCT-ADDRESS-LINE TO WS-LABEL-LINES (L-INDX)
  1581        SET L-INDX               UP BY 1
  1582        GO TO 7210-READ-NEXT.
  1583
  1584     MOVE BI-TEXT-LINE           TO WS-PASSED-DATA.
  1585
  1586     MOVE BI-SKIP-CONTROL        TO WS-PASSED-CNTL-CHAR.
  1587
  1588     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1589
  1590     GO TO 7210-READ-NEXT.
  1591
  1592 7250-CHECK-FIRST-SW.
  1593     IF PRINT-LABELS
  1594        GO TO 7260-LABEL-PRINT.
  1595
  1596     IF FIRST-TIME
  1597        GO TO 7299-EXIT.
  1598
  1599     MOVE 'X'                 TO WS-PROG-END.
  1600     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1601     GO TO 7290-END-BR.
  1602
  1603 7260-LABEL-PRINT.
  1604     IF L-INDX = 1 OR
  1605        WS-LABEL-HOLD-AREA = SPACES
  1606        GO TO 7290-END-BR.
  1607
  1608     IF WS-LABEL-LINES (1) = SPACES
  1609        MOVE WS-LABEL-LINES (2)  TO WS-LABEL-LINES (1)
  1610        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
  1611        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
  1612        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
  1613        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
  1614        MOVE SPACES              TO WS-LABEL-LINES (6)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6411.cbl
  1615        GO TO 7260-LABEL-PRINT.
  1616
  1617     IF WS-LABEL-LINES (2) = SPACES
  1618        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
  1619        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
  1620        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
  1621        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
  1622        MOVE SPACES              TO WS-LABEL-LINES (6)
  1623        GO TO 7260-LABEL-PRINT.
  1624
  1625     IF WS-LABEL-LINES (3) = SPACES
  1626        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
  1627        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
  1628        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
  1629        MOVE SPACES              TO WS-LABEL-LINES (6)
  1630        GO TO 7260-LABEL-PRINT.
  1631
  1632     IF WS-LABEL-LINES (4) = SPACES
  1633        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
  1634        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
  1635        MOVE SPACES              TO WS-LABEL-LINES (6)
  1636        GO TO 7260-LABEL-PRINT.
  1637
  1638     IF WS-LABEL-LINES (5) = SPACES
  1639        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
  1640        MOVE SPACES              TO WS-LABEL-LINES (6).
  1641
  1642     IF WS-LABEL-LINES (6) NOT = SPACES
  1643        IF WS-LABEL-1ST-ZIP (6) NOT = ZEROS
  1644           MOVE WS-LABEL-ZIP (6)     TO WS-LAST-ZIP (5)
  1645           MOVE SPACES               TO WS-LABEL-LINES (6)
  1646           ELSE
  1647           MOVE WS-LABEL-2ND-ZIP (6) TO WS-LAST-2ND-ZIP (5)
  1648           MOVE SPACES               TO WS-LABEL-LINES (6)
  1649        ELSE
  1650        IF WS-LABEL-LINES (5) NOT = SPACES
  1651           IF WS-LABEL-1ST-ZIP (5) NOT = ZEROS
  1652              MOVE WS-LABEL-ZIP (5)     TO WS-LAST-ZIP (5)
  1653              MOVE SPACES               TO WS-LABEL-ZIP (5)
  1654              ELSE
  1655              MOVE WS-LABEL-2ND-ZIP (5) TO WS-LAST-2ND-ZIP (5)
  1656              MOVE SPACES               TO WS-LABEL-ZIP (5)
  1657           ELSE
  1658           IF WS-LABEL-LINES (4) NOT = SPACES
  1659              IF WS-LABEL-1ST-ZIP (4) NOT = ZEROS
  1660                 MOVE WS-LABEL-ZIP (4)     TO WS-LAST-ZIP (4)
  1661                 MOVE SPACES               TO WS-LABEL-ZIP (4)
  1662                 ELSE
  1663                 MOVE WS-LABEL-2ND-ZIP (4) TO WS-LAST-2ND-ZIP (4)
  1664                 MOVE SPACES               TO WS-LABEL-ZIP (4).
  1665
  1666     PERFORM 2480-MOVE-TO-PRINT THRU 2499-EXIT.
  1667
  1668 7290-END-BR.
  1669     IF WS-BROWSE-STARTED = 'Y'
  1670        MOVE 'N'                 TO WS-BROWSE-STARTED
  1671
  1672* EXEC CICS ENDBR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6411.cbl
  1673*            DATASET(BILL-ID)
  1674*        END-EXEC.
  1675     MOVE 0
  1676       TO DFHEIV11
  1677*    MOVE '&2                    $   #00001459' TO DFHEIV0
  1678     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1679     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1680     MOVE X'2020233030303031343539' TO DFHEIV0(25:11)
  1681     CALL 'kxdfhei1' USING DFHEIV0,
  1682           BILL-ID,
  1683           DFHEIV11,
  1684           DFHEIV99
  1685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1686
  1687
  1688
  1689* EXEC CICS SYNCPOINT
  1690*         END-EXEC.
  1691*    MOVE '6"                    !   #00001463' TO DFHEIV0
  1692     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  1693     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1694     MOVE X'2020233030303031343633' TO DFHEIV0(25:11)
  1695     CALL 'kxdfhei1' USING DFHEIV0
  1696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1697
  1698
  1699 7299-EXIT.
  1700      EXIT.
  1701
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6411.cbl
  1703 7300-UPDATE-BILLING-HEADER.
  1704     IF WS-BROWSE-STARTED = 'Y'
  1705        MOVE 'N'                 TO WS-BROWSE-STARTED
  1706
  1707* EXEC CICS ENDBR
  1708*            DATASET(BILL-ID)
  1709*       END-EXEC.
  1710     MOVE 0
  1711       TO DFHEIV11
  1712*    MOVE '&2                    $   #00001473' TO DFHEIV0
  1713     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1714     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1715     MOVE X'2020233030303031343733' TO DFHEIV0(25:11)
  1716     CALL 'kxdfhei1' USING DFHEIV0,
  1717           BILL-ID,
  1718           DFHEIV11,
  1719           DFHEIV99
  1720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1721
  1722
  1723     PERFORM 8100-READ-HEADER THRU 8199-EXIT.
  1724
  1725     IF HEADER-REC-FOUND
  1726         NEXT SENTENCE
  1727     ELSE
  1728         GO TO 7399-EXIT.
  1729
  1730     MOVE J-BILL-LENGTH          TO JOURNAL-LENGTH.
  1731     MOVE 'B'                    TO JP-RECORD-TYPE.
  1732     MOVE BILL-ID                TO JP-FILE-ID.
  1733     MOVE BILLING-STATEMENT      TO JP-RECORD-AREA.
  1734     PERFORM 8400-LOG-JOURNAL-RECORD.
  1735     MOVE CURRENT-SAVE           TO BI-INITIAL-PRINT-DATE.
  1736     MOVE BI-NO-OF-COPIES        TO WS-COPIES.
  1737     MOVE J-BILL-LENGTH          TO JOURNAL-LENGTH.
  1738     MOVE 'C'                    TO JP-RECORD-TYPE.
  1739     MOVE BILL-ID                TO JP-FILE-ID.
  1740     MOVE BILLING-STATEMENT      TO JP-RECORD-AREA.
  1741
  1742
  1743* EXEC CICS REWRITE
  1744*         DATASET(BILL-ID)
  1745*         FROM   (BILLING-STATEMENT)
  1746*    END-EXEC.
  1747     MOVE LENGTH OF
  1748      BILLING-STATEMENT
  1749       TO DFHEIV11
  1750*    MOVE '&& L                  %   #00001496' TO DFHEIV0
  1751     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1752     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1753     MOVE X'2020233030303031343936' TO DFHEIV0(25:11)
  1754     CALL 'kxdfhei1' USING DFHEIV0,
  1755           BILL-ID,
  1756           BILLING-STATEMENT,
  1757           DFHEIV11,
  1758           DFHEIV99
  1759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1760
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6411.cbl
  1761
  1762     PERFORM 8400-LOG-JOURNAL-RECORD.
  1763
  1764 7399-EXIT.
  1765     EXIT.
  1766
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6411.cbl
  1768 8100-READ-HEADER.
  1769     MOVE BILL-SAVE-KEY          TO BILL-KEY.
  1770
  1771
  1772* EXEC CICS HANDLE CONDITION
  1773*         NOTOPEN(8890-BILL-NOT-OPEN)
  1774*         NOTFND (8150-NOT-FOUND)
  1775*    END-EXEC.
  1776*    MOVE '"$JI                  ! & #00001510' TO DFHEIV0
  1777     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  1778     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1779     MOVE X'2620233030303031353130' TO DFHEIV0(25:11)
  1780     CALL 'kxdfhei1' USING DFHEIV0
  1781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1782
  1783
  1784
  1785* EXEC CICS READ
  1786*         DATASET(BILL-ID)
  1787*         RIDFLD (BILL-KEY)
  1788*         SET    (ADDRESS OF BILLING-STATEMENT)
  1789*         UPDATE
  1790*    END-EXEC.
  1791*    MOVE '&"S        EU         (   #00001515' TO DFHEIV0
  1792     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1793     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1794     MOVE X'2020233030303031353135' TO DFHEIV0(25:11)
  1795     CALL 'kxdfhei1' USING DFHEIV0,
  1796           BILL-ID,
  1797           DFHEIV20,
  1798           DFHEIV99,
  1799           BILL-KEY,
  1800           DFHEIV99,
  1801           DFHEIV99,
  1802           DFHEIV99
  1803     SET ADDRESS OF BILLING-STATEMENT TO
  1804         DFHEIV20
  1805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1806
  1807
  1808     GO TO 8199-EXIT.
  1809
  1810 8150-NOT-FOUND.
  1811     MOVE '1'                    TO HEADER-SW.
  1812
  1813 8199-EXIT.
  1814      EXIT.
  1815
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6411.cbl
  1817 8400-LOG-JOURNAL-RECORD.
  1818     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
  1819     MOVE THIS-PGM               TO JP-PROGRAM-ID.
  1820
  1821*    EXEC CICS JOURNAL
  1822*         JFILEID(PI-JOURNAL-FILE-ID)
  1823*         JTYPEID('EL')
  1824*         FROM   (JOURNAL-RECORD)
  1825*         LENGTH (JOURNAL-LENGTH)
  1826*    END-EXEC.
  1827
  1828 8890-BILL-NOT-OPEN.
  1829     MOVE 'BILLING STATEMENT FILE NOT OPEN - ERBILL' TO ERROR-LINE
  1830     PERFORM 0400-SEND-TEXT
  1831     GO TO 0200-END-DATA.
  1832
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6411.cbl
  1834 9700-DATE-LINK.
  1835     MOVE LINK-ELDATCV TO PGM-NAME
  1836
  1837* EXEC CICS LINK
  1838*        PROGRAM (PGM-NAME)
  1839*        COMMAREA(DATE-CONVERSION-DATA)
  1840*        LENGTH  (DC-COMM-LENGTH)
  1841*    END-EXEC.
  1842*    MOVE '."C                   ''   #00001550' TO DFHEIV0
  1843     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1844     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1845     MOVE X'2020233030303031353530' TO DFHEIV0(25:11)
  1846     CALL 'kxdfhei1' USING DFHEIV0,
  1847           PGM-NAME,
  1848           DATE-CONVERSION-DATA,
  1849           DC-COMM-LENGTH,
  1850           DFHEIV99,
  1851           DFHEIV99,
  1852           DFHEIV99
  1853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1854
  1855
  1856 9700-EXIT.
  1857      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6411.cbl
  1859*9800-PRINT-ROUTINE.             COPY ELPRTCVP.
  1860 9800-PRINT-ROUTINE.
  1861*    COPY ELPRTCVP.
  1862******************************************************************
  1863***                                                              *
  1864***                          ELPRTCVP.                           *
  1865***                          VMOD=2.003                          *
  1866***                                                              *
  1867***     COPY MEMBER FOR TERMINAL ONLINE PRINT ROUTINE.           *
  1868***     THIS ROUTINE WILL ACCOMODATE PRINTING TO A 3270          *
  1869***     TERMINAL PRINTER. A BUFFER OF UP TO 1920 CHARACTERS      *
  1870***     IS ACCUMULATED AND PRINTED COLLECTIVELY.                 *
  1871***                                                              *
  1872***     THIS ROUTINE TO BE USED ONLY WITH ACCOMPANIMENT          *
  1873***      OF THE WORKING-STORAGE COPY MEMBER ( ELPRTCVD )         *
  1874***     THE HOST PROGRAM MUST INITIALIZE THE FOLLOWING 3 FIELDS  *
  1875***      FROM THE ABOVE COPY MEMBER FOR THIS PROCEDURE TO BE     *
  1876***      SUCCESSFUL.                                             *
  1877***      05  WS-LINE-LEN    PIC  S9(4)  COMP  VALUE +80.         *
  1878***                         LENGTH OF THE LINE TO BE PRINTED     *
  1879***                         DEFAULT IS 80, YOU CAN USE ANY NUMBER*
  1880***                         UP TO 132.  THIS FIELD IS ONLY ACCEP-*
  1881***                         TED THE FIRST TIME THRU THE ROUTINE. *
  1882***      05  WS-PROG-END    PIC  X  VALUE SPACES.                *
  1883***                         PROGRAM END SWITCH. INITIALIZED      *
  1884***                         TO SPACE-     MOVE IN ANY NONBLANK   *
  1885***                         TO IT WHEN PROGRAM IS FINISHED.      *
  1886***      05  WS-PRINT-AREA.                                      *
  1887***          10  WS-PASSED-CNTL-CHAR     PIC X.                  *
  1888***          10  WS-PASSED-DATA          PIC X(132).             *
  1889***                         USE THE DATA TO BE PRINTED IN THE    *
  1890***                         WS-PASSED-DATA.                      *
  1891***                         USE THE STANDARD CARRIAGE CONTROL    *
  1892***                         CHARACTER IN THE WS-PASSED-CNTL-CHAR *
  1893***                           SINGLE-SPACE            VALUE ' '  *
  1894***                           DOUBLE-SPACE            VALUE '0'  *
  1895***                           TRIPLE-SPACE            VALUE '-'  *
  1896***                           TOP-PAGE                VALUE '1'  *
  1897***      NOTE: A LINE COUNT IS PROVIDED IN FIELDNAME -WS-LINE-CNT*
  1898***            THE USE OF THIS FIELD IS OPTIONAL.                *
  1899***            THIS ROUTINE WILL ONLY ADD 1, 2, OR 3             *
  1900***            TO THIS COUNT DEPENDING ON THE WS-PASSED-CNTL-CHAR*
  1901***            AND RESET THE COUNT TO ZERO WHEN TOP-PAGE         *
  1902***            CONDITION.                                        *
  1903***                                                              *
  1904******************************************************************
  1905
  1906 ELPRTCVP.
  1907
  1908*    IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'CID'
  1909     IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'XXX'
  1910         MOVE 'P'                TO DL34-PROCESS-TYPE
  1911         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1912         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1913         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1914         MOVE WS-PRINT-AREA      TO DL34-PRINT-LINE
  1915         MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
  1916
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6411.cbl
  1917
  1918* EXEC CICS LINK
  1919*            PROGRAM    ('DLO034')
  1920*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  1921*            LENGTH     (DLO034-REC-LENGTH)
  1922*        END-EXEC
  1923     MOVE 'DLO034' TO DFHEIV1
  1924*    MOVE '."C                   ''   #00001617' TO DFHEIV0
  1925     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1926     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1927     MOVE X'2020233030303031363137' TO DFHEIV0(25:11)
  1928     CALL 'kxdfhei1' USING DFHEIV0,
  1929           DFHEIV1,
  1930           DLO034-COMMUNICATION-AREA,
  1931           DLO034-REC-LENGTH,
  1932           DFHEIV99,
  1933           DFHEIV99,
  1934           DFHEIV99
  1935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1936
  1937            IF DL34-RETURN-CODE = 'OK'
  1938                GO TO ELPRTCVP-EXIT
  1939            ELSE
  1940*               MOVE '8339'     TO EMI-ERROR ?????ERROR MESSAGE???
  1941                GO TO ELPRTCVP-EXIT.
  1942
  1943     IF NOT FIRST-TIME
  1944         GO TO ELPRTCVP-020.
  1945
  1946     IF WS-LINE-LEN NOT GREATER ZERO
  1947         GO TO ELPRTCVP-EXIT.
  1948
  1949     MOVE '2'                    TO WS-FIRST-TIME-SW.
  1950     MOVE LOW-VALUES             TO WS-BUFFER-AREA.
  1951
  1952     SET BUFFER-INDEX TO +1
  1953
  1954     IF EIBTRMID IS EQUAL TO 'AFLP'
  1955         NEXT SENTENCE
  1956     ELSE
  1957         IF NOT TOP-PAGE
  1958             MOVE T-TP           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1959             SET BUFFER-INDEX UP BY +1.
  1960
  1961 ELPRTCVP-020.
  1962     IF WS-PROG-END = SPACES
  1963         GO TO ELPRTCVP-030.
  1964
  1965     MOVE SPACES                 TO WS-PROG-END.
  1966
  1967     IF BUFFER-INDEX GREATER +1
  1968         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  1969
  1970     MOVE '1'                    TO WS-FIRST-TIME-SW.
  1971
  1972     GO TO ELPRTCVP-EXIT.
  1973
  1974 ELPRTCVP-030.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6411.cbl
  1975     IF WS-PASSED-DATA = SPACES
  1976         SET PRT-INDEX TO +1
  1977         GO TO ELPRTCVP-050.
  1978
  1979     SET PRT-INDEX TO WS-LINE-LEN.
  1980
  1981 ELPRTCVP-040.
  1982     IF WS-PRINT-BYTE (PRT-INDEX) NOT = SPACES
  1983         GO TO ELPRTCVP-050.
  1984
  1985     IF PRT-INDEX GREATER +1
  1986         SET PRT-INDEX DOWN BY +1
  1987         GO TO ELPRTCVP-040.
  1988
  1989 ELPRTCVP-050.
  1990     SET WS-LINE-LENGTH TO PRT-INDEX.
  1991     SET BUFFER-INDEX2 TO BUFFER-INDEX.
  1992     SET BUFFER-INDEX2 UP BY WS-LINE-LENGTH.
  1993
  1994     IF BUFFER-INDEX2 NOT LESS WS-BUFFER-SIZE
  1995         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  1996
  1997     IF TRIPLE-SPACE
  1998          ADD +2  TO  WS-LINE-CNT
  1999          MOVE T-SS           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2000                                 WS-BUFFER-BYTE (BUFFER-INDEX + 1)
  2001          SET BUFFER-INDEX UP BY +2.
  2002
  2003     IF DOUBLE-SPACE
  2004          ADD +1  TO  WS-LINE-CNT
  2005          MOVE T-SS             TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2006          SET BUFFER-INDEX UP BY +1.
  2007
  2008     ADD +1 TO WS-LINE-CNT
  2009************************************************************
  2010*     BYPASS NEW LINE SYMBOL                               *
  2011*        IF FIRST BUFFER SENT AND TOP-OF-FORM SET.         *
  2012*     OR IF FIRST LINE OF SUBSEQUENT BUFFERS.              *
  2013************************************************************
  2014
  2015     IF (BUFFER-INDEX GREATER +1 AND
  2016         WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-TP)  OR
  2017         FIRST-LINE-NEXT-BUFFER
  2018         MOVE ZERO               TO WS-FIRST-TIME-SW
  2019     ELSE
  2020         MOVE T-SS               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2021         SET BUFFER-INDEX UP BY +1.
  2022
  2023**   NOTE, SINGLE SPACE IS REQUIRED BEFORE TOP PAGE CHAR
  2024
  2025     IF TOP-PAGE
  2026         MOVE +1                TO WS-LINE-CNT
  2027         MOVE T-TP              TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2028         SET BUFFER-INDEX UP BY +1.
  2029
  2030     SET PRT-INDEX TO +1.
  2031
  2032 ELPRTCVP-060.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6411.cbl
  2033     MOVE WS-PRINT-BYTE (PRT-INDEX)
  2034                                 TO WS-BUFFER-BYTE (BUFFER-INDEX).
  2035     SET BUFFER-INDEX UP BY +1.
  2036
  2037     IF PRT-INDEX LESS WS-LINE-LENGTH
  2038         SET PRT-INDEX UP BY +1
  2039         GO TO ELPRTCVP-060.
  2040
  2041 ELPRTCVP-EXIT.
  2042     EXIT.
  2043
  2044 ELPRTCVP-PRINT-BUFFER.
  2045     IF WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-SS
  2046        MOVE SPACE               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2047        SET BUFFER-INDEX UP BY 1.
  2048
  2049     MOVE  T-EM                  TO  WS-BUFFER-BYTE (BUFFER-INDEX)
  2050     SET WS-BUFFER-LENGTH TO BUFFER-INDEX.
  2051
  2052
  2053* EXEC CICS SEND
  2054*        FROM    (WS-BUFFER-AREA)
  2055*        LENGTH  (WS-BUFFER-LENGTH)
  2056*        CTLCHAR (WS-WCC-CNTL)
  2057*        ERASE
  2058*    END-EXEC.
  2059*    MOVE '$$    C E         L F ,   #00001738' TO DFHEIV0
  2060     MOVE X'242420202020432045202020' TO DFHEIV0(1:12)
  2061     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
  2062     MOVE X'2020233030303031373338' TO DFHEIV0(25:11)
  2063     CALL 'kxdfhei1' USING DFHEIV0,
  2064           WS-BUFFER-AREA,
  2065           WS-BUFFER-LENGTH,
  2066           DFHEIV99,
  2067           DFHEIV99,
  2068           WS-WCC-CNTL,
  2069           DFHEIV99,
  2070           DFHEIV99,
  2071           DFHEIV99,
  2072           DFHEIV99,
  2073           DFHEIV99,
  2074           DFHEIV99
  2075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2076
  2077
  2078     SET BUFFER-INDEX TO +1.
  2079     MOVE '2'                    TO WS-FIRST-TIME-SW.
  2080
  2081 ELPRTCVP-PRINT-EXIT.
  2082     EXIT.
  2083
  2084
  2085 9995-SECURITY-VIOLATION.
  2086*                            COPY ELCSCTP.
  2087******************************************************************
  2088*                                                                *
  2089*                            ELCSCTP                             *
  2090*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6411.cbl
  2091*                                                                *
  2092*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2093******************************************************************
  2094
  2095
  2096     MOVE EIBDATE          TO SM-JUL-DATE.
  2097     MOVE EIBTRMID         TO SM-TERMID.
  2098     MOVE THIS-PGM         TO SM-PGM.
  2099     MOVE EIBTIME          TO TIME-IN.
  2100     MOVE TIME-OUT         TO SM-TIME.
  2101     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2102
  2103
  2104* EXEC CICS LINK
  2105*         PROGRAM  ('EL003')
  2106*         COMMAREA (SECURITY-MESSAGE)
  2107*         LENGTH   (80)
  2108*    END-EXEC.
  2109     MOVE 'EL003' TO DFHEIV1
  2110     MOVE 80
  2111       TO DFHEIV11
  2112*    MOVE '."C                   ''   #00001770' TO DFHEIV0
  2113     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2114     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2115     MOVE X'2020233030303031373730' TO DFHEIV0(25:11)
  2116     CALL 'kxdfhei1' USING DFHEIV0,
  2117           DFHEIV1,
  2118           SECURITY-MESSAGE,
  2119           DFHEIV11,
  2120           DFHEIV99,
  2121           DFHEIV99,
  2122           DFHEIV99
  2123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2124
  2125
  2126******************************************************************
  2127
  2128
  2129 9995-EXIT.
  2130     EXIT.
  2131
  2132 9999-DFHBACK SECTION.
  2133     MOVE '9%                    "   ' TO DFHEIV0
  2134     MOVE 'EL6411' TO DFHEIV1
  2135     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2136     GOBACK.
  2137 9999-DFHEXIT.
  2138     IF DFHEIGDJ EQUAL 0001
  2139         NEXT SENTENCE
  2140     ELSE IF DFHEIGDJ EQUAL 2
  2141         GO TO 0200-END-DATA,
  2142               0300-NOT-FOUND
  2143         DEPENDING ON DFHEIGDI
  2144     ELSE IF DFHEIGDJ EQUAL 3
  2145         GO TO 2099-EXIT,
  2146               8890-BILL-NOT-OPEN
  2147         DEPENDING ON DFHEIGDI
  2148     ELSE IF DFHEIGDJ EQUAL 4
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6411.cbl
  2149         GO TO 2050-END-BR,
  2150               2050-END-BR,
  2151               8890-BILL-NOT-OPEN
  2152         DEPENDING ON DFHEIGDI
  2153     ELSE IF DFHEIGDJ EQUAL 5
  2154         GO TO 7250-CHECK-FIRST-SW,
  2155               7250-CHECK-FIRST-SW,
  2156               8890-BILL-NOT-OPEN
  2157         DEPENDING ON DFHEIGDI
  2158     ELSE IF DFHEIGDJ EQUAL 6
  2159         GO TO 8890-BILL-NOT-OPEN,
  2160               8150-NOT-FOUND
  2161         DEPENDING ON DFHEIGDI.
  2162     MOVE '9%                    "   ' TO DFHEIV0
  2163     MOVE 'EL6411' TO DFHEIV1
  2164     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2165     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5596     Code:        6018
