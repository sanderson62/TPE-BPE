* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* ELPMNT.cbl
* Options: int("ELPMNT.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELPMNT.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELPMNT.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELPMNT.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELPMNT.
     4*                            VMOD=2.006
     5
     6*AUTHOR.     LOGIC,INC.
     7*            DALLAS, TEXAS.
     8*
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* ELPMNT.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    17*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *****************************************************
    20
    21*REMARKS.    THIS SUBROUTINE CALCULATES A CLAIM PAYMENT
    22*            FROM THE INFORMATION PASSED VIA THE ELCCALC
    23*            COPYBOOK.
    24
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* ELPMNT.cbl
    26 ENVIRONMENT DIVISION.
    27
    28 DATA DIVISION.
    29
    30 WORKING-STORAGE SECTION.
    31 01  DFH-START PIC X(04).
    32
    33 77  FILLER  PIC X(32)  VALUE '********************************'.
    34 77  FILLER  PIC X(32)  VALUE '*   ELPMNT WORKING STORAGE     *'.
    35 77  FILLER  PIC X(32)  VALUE '******* VMOD=2.006 *************'.
    36
    37*                                   COPY ELCDATE.
    38******************************************************************
    39*                                                                *
    40*                                                                *
    41*                            ELCDATE.                            *
    42*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    43*                            VMOD=2.003
    44*                                                                *
    45*                                                                *
    46*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
    47*                 LENGTH = 200                                   *
    48******************************************************************
    49
    50 01  DATE-CONVERSION-DATA.
    51     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
    52     12  DC-OPTION-CODE                PIC X.
    53         88  BIN-TO-GREG                VALUE ' '.
    54         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
    55         88  EDIT-GREG-TO-BIN           VALUE '2'.
    56         88  YMD-GREG-TO-BIN            VALUE '3'.
    57         88  MDY-GREG-TO-BIN            VALUE '4'.
    58         88  JULIAN-TO-BIN              VALUE '5'.
    59         88  BIN-PLUS-ELAPSED           VALUE '6'.
    60         88  FIND-CENTURY               VALUE '7'.
    61         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
    62         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
    63         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
    64         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
    65         88  JULIAN-TO-BIN-3            VALUE 'C'.
    66         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
    67         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
    68         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
    69         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
    70         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
    71         88  CHECK-LEAP-YEAR            VALUE 'H'.
    72         88  BIN-3-TO-GREG              VALUE 'I'.
    73         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
    74         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
    75         88  CYMD-GREG-TO-BIN           VALUE 'L'.
    76         88  MDCY-GREG-TO-BIN           VALUE 'M'.
    77         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
    78         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
    79         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
    80         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
    81         88  THREE-CHARACTER-BIN
    82                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
    83         88  GREGORIAN-TO-BIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* ELPMNT.cbl
    84                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
    85         88  BIN-TO-GREGORIAN
    86                  VALUES ' ' '1' 'I' '8' 'G'.
    87         88  JULIAN-TO-BINARY
    88                  VALUES '5' 'C' 'E' 'F'.
    89     12  DC-ERROR-CODE                 PIC X.
    90         88  NO-CONVERSION-ERROR        VALUE ' '.
    91         88  DATE-CONVERSION-ERROR
    92                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
    93         88  DATE-IS-ZERO               VALUE '1'.
    94         88  DATE-IS-NON-NUMERIC        VALUE '2'.
    95         88  DATE-IS-INVALID            VALUE '3'.
    96         88  DATE1-GREATER-DATE2        VALUE '4'.
    97         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
    98         88  DATE-INVALID-OPTION        VALUE '9'.
    99         88  INVALID-CENTURY            VALUE 'A'.
   100         88  ONLY-CENTURY               VALUE 'B'.
   101         88  ONLY-LEAP-YEAR             VALUE 'C'.
   102         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   103     12  DC-END-OF-MONTH               PIC X.
   104         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   105     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   106         88  USE-NORMAL-PROCESS         VALUE ' '.
   107         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   108         88  ADJUST-UP-100-YRS          VALUE '2'.
   109     12  FILLER                        PIC X.
   110     12  DC-CONVERSION-DATES.
   111         16  DC-BIN-DATE-1             PIC XX.
   112         16  DC-BIN-DATE-2             PIC XX.
   113         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   114         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   115                       DC-GREG-DATE-1-EDIT.
   116             20  DC-EDIT1-MONTH        PIC 99.
   117             20  SLASH1-1              PIC X.
   118             20  DC-EDIT1-DAY          PIC 99.
   119             20  SLASH1-2              PIC X.
   120             20  DC-EDIT1-YEAR         PIC 99.
   121         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   122         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   123                     DC-GREG-DATE-2-EDIT.
   124             20  DC-EDIT2-MONTH        PIC 99.
   125             20  SLASH2-1              PIC X.
   126             20  DC-EDIT2-DAY          PIC 99.
   127             20  SLASH2-2              PIC X.
   128             20  DC-EDIT2-YEAR         PIC 99.
   129         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   130         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   131                     DC-GREG-DATE-1-YMD.
   132             20  DC-YMD-YEAR           PIC 99.
   133             20  DC-YMD-MONTH          PIC 99.
   134             20  DC-YMD-DAY            PIC 99.
   135         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   136         16  DC-GREG-DATE-1-MDY-R REDEFINES
   137                      DC-GREG-DATE-1-MDY.
   138             20  DC-MDY-MONTH          PIC 99.
   139             20  DC-MDY-DAY            PIC 99.
   140             20  DC-MDY-YEAR           PIC 99.
   141         16  DC-GREG-DATE-1-ALPHA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* ELPMNT.cbl
   142             20  DC-ALPHA-MONTH        PIC X(10).
   143             20  DC-ALPHA-DAY          PIC 99.
   144             20  FILLER                PIC XX.
   145             20  DC-ALPHA-CENTURY.
   146                 24 DC-ALPHA-CEN-N     PIC 99.
   147             20  DC-ALPHA-YEAR         PIC 99.
   148         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   149         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   150         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   151         16  DC-JULIAN-DATE            PIC 9(05).
   152         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   153                                       PIC 9(05).
   154         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   155             20  DC-JULIAN-YEAR        PIC 99.
   156             20  DC-JULIAN-DAYS        PIC 999.
   157         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   158         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   159         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   160     12  DATE-CONVERSION-VARIBLES.
   161         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   162         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   163             20  FILLER                PIC 9(3).
   164             20  HOLD-CEN-1-CCYY.
   165                 24  HOLD-CEN-1-CC     PIC 99.
   166                 24  HOLD-CEN-1-YY     PIC 99.
   167             20  HOLD-CEN-1-MO         PIC 99.
   168             20  HOLD-CEN-1-DA         PIC 99.
   169         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   170             20  HOLD-CEN-1-R-MO       PIC 99.
   171             20  HOLD-CEN-1-R-DA       PIC 99.
   172             20  HOLD-CEN-1-R-CCYY.
   173                 24  HOLD-CEN-1-R-CC   PIC 99.
   174                 24  HOLD-CEN-1-R-YY   PIC 99.
   175             20  FILLER                PIC 9(3).
   176         16  HOLD-CENTURY-1-X.
   177             20  FILLER                PIC X(3)  VALUE SPACES.
   178             20  HOLD-CEN-1-X-CCYY.
   179                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   180                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   181             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   182             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   183         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   184             20  HOLD-CEN-1-R-X-MO     PIC XX.
   185             20  HOLD-CEN-1-R-X-DA     PIC XX.
   186             20  HOLD-CEN-1-R-X-CCYY.
   187                 24  HOLD-CEN-1-R-X-CC PIC XX.
   188                 24  HOLD-CEN-1-R-X-YY PIC XX.
   189             20  FILLER                PIC XXX.
   190         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   191         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   192         16  DC-JULIAN-DATE-1          PIC 9(07).
   193         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   194             20  DC-JULIAN-1-CCYY.
   195                 24  DC-JULIAN-1-CC    PIC 99.
   196                 24  DC-JULIAN-1-YR    PIC 99.
   197             20  DC-JULIAN-DA-1        PIC 999.
   198         16  DC-JULIAN-DATE-2          PIC 9(07).
   199         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* ELPMNT.cbl
   200             20  DC-JULIAN-2-CCYY.
   201                 24  DC-JULIAN-2-CC    PIC 99.
   202                 24  DC-JULIAN-2-YR    PIC 99.
   203             20  DC-JULIAN-DA-2        PIC 999.
   204         16  DC-GREG-DATE-A-EDIT.
   205             20  DC-EDITA-MONTH        PIC 99.
   206             20  SLASHA-1              PIC X VALUE '/'.
   207             20  DC-EDITA-DAY          PIC 99.
   208             20  SLASHA-2              PIC X VALUE '/'.
   209             20  DC-EDITA-CCYY.
   210                 24  DC-EDITA-CENT     PIC 99.
   211                 24  DC-EDITA-YEAR     PIC 99.
   212         16  DC-GREG-DATE-B-EDIT.
   213             20  DC-EDITB-MONTH        PIC 99.
   214             20  SLASHB-1              PIC X VALUE '/'.
   215             20  DC-EDITB-DAY          PIC 99.
   216             20  SLASHB-2              PIC X VALUE '/'.
   217             20  DC-EDITB-CCYY.
   218                 24  DC-EDITB-CENT     PIC 99.
   219                 24  DC-EDITB-YEAR     PIC 99.
   220         16  DC-GREG-DATE-CYMD         PIC 9(08).
   221         16  DC-GREG-DATE-CYMD-R REDEFINES
   222                              DC-GREG-DATE-CYMD.
   223             20  DC-CYMD-CEN           PIC 99.
   224             20  DC-CYMD-YEAR          PIC 99.
   225             20  DC-CYMD-MONTH         PIC 99.
   226             20  DC-CYMD-DAY           PIC 99.
   227         16  DC-GREG-DATE-MDCY         PIC 9(08).
   228         16  DC-GREG-DATE-MDCY-R REDEFINES
   229                              DC-GREG-DATE-MDCY.
   230             20  DC-MDCY-MONTH         PIC 99.
   231             20  DC-MDCY-DAY           PIC 99.
   232             20  DC-MDCY-CEN           PIC 99.
   233             20  DC-MDCY-YEAR          PIC 99.
   234    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   235        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   236    12  DC-EL310-DATE                  PIC X(21).
   237    12  FILLER                         PIC X(28).
   238
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* ELPMNT.cbl
   240*                                   COPY ELCCALC.
   241******************************************************************
   242*                                                                *
   243*                           ELCCALC.                            *
   244*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   245*                            VMOD=2.025                          *
   246*                                                                *
   247*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   248*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   249*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   250*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   251*                                                                *
   252*  PASSED TO ELRTRM                                              *
   253*  -----------------                                             *
   254*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   255*  ORIGINAL TERM                                                 *
   256*  BEGINNING DATE                                                *
   257*  ENDING DATE                                                   *
   258*  COMPANY I.D.                                                  *
   259*  ACCOUNT MASTER USER FIELD                                     *
   260*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   261*  FREE LOOK DAYS                                                *
   262*                                                                *
   263*  RETURNED FROM ELRTRM                                          *
   264*  ---------------------                                         *
   265*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   266*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   267*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   268*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   269*----------------------------------------------------------------*
   270*  PASSED TO ELRAMT                                              *
   271*  ----------------                                              *
   272*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   273*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   274*  ORIGINAL AMOUNT                                               *
   275*  ALTERNATE BENEFIT (BALLON)                                    *
   276*  A.P.R. - NET PAY ONLY                                         *
   277*  METHOD
   278*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   279*  COMPANY I.D.                                                  *
   280*  BENEFIT TYPE                                                  *
   281*                                                                *
   282*  RETURNED FROM ELRAMT                                          *
   283*  --------------------                                          *
   284*  REMAINING AMOUNT 1 - CURRENT                                  *
   285*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   286*  REMAINING AMOUNT FACTOR
   287*----------------------------------------------------------------*
   288*  PASSED TO ELRESV                                              *
   289*  -----------------                                             *
   290*  CERTIFICATE EFFECTIVE DATE                                    *
   291*  VALUATION DATE                                                *
   292*  PAID THRU DATE                                                *
   293*  BENEFIT                                                       *
   294*  INCURRED DATE                                                 *
   295*  REPORTED DATE                                                 *
   296*  ISSUE AGE                                                     *
   297*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* ELPMNT.cbl
   298*  CDT PERCENT                                                   *
   299*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   300* *CLAIM TYPE (LIFE, A/H)                                        *
   301* *REMAINING BENEFIT (FROM ELRAMT)                               *
   302* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   303*                                                                *
   304*  RETURNED FROM ELRESV                                          *
   305*  --------------------                                          *
   306*  CDT TABLE USED                                                *
   307*  CDT FACTOR USED                                               *
   308*  PAY TO CURRENT RESERVE                                        *
   309*  I.B.N.R. - A/H ONLY                                           *
   310*  FUTURE (ACCRUED) AH ONLY                                      *
   311*----------------------------------------------------------------*
   312*  PASSED TO ELRATE                                              *
   313*  ----------------                                              *
   314*  CERT ISSUE DATE                                               *
   315*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   316*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   317*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   318*  STATE CODE (CLIENT DEFINED)                                   *
   319*  STATE CODE (STANDARD P.O. ABBRV)                              *
   320*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   321*  DEVIATION CODE                                                *
   322*  ISSUE AGE                                                     *
   323*  ORIGINAL BENEFIT AMOUNT                                       *
   324*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   325*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   326*  BENEFIT KIND (LIFE OR A/H)                                    *
   327*  A.P.R.                                                        *
   328*  METHOD
   329*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   330*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   331*  COMPANY I.D. (3 CHARACTER)                                    *
   332*  BENEFIT CODE                                                  *
   333*  BENEFIT OVERRIDE CODE                                         *
   334*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   335*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   336*  JOINT INDICATOR (CSL ONLY)                                    *
   337*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   338*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   339*                                                                *
   340*  RETURNED FROM ELRATE                                          *
   341*  --------------------                                          *
   342*  CALCULATED PREMIUM                                            *
   343*  PREMIUM RATE                                                  *
   344*  MORTALITY CODE                                                *
   345*  MAX ATTAINED AGE                                              *
   346*  MAX AGE                                                       *
   347*  MAX TERM                                                      *
   348*  MAX MONTHLY BENEFIT                                           *
   349*  MAX TOTAL BENIFIT                                             *
   350*  COMPOSITE RATE (OPEN-END ONLY)                                *
   351*----------------------------------------------------------------*
   352*  PASSED TO ELRFND                                              *
   353*  ----------------                                              *
   354*  CERT ISSUE DATE                                               *
   355*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* ELPMNT.cbl
   356*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   357*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   358*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   359*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   360*  STATE CODE (CLIENT DEFINED)                                   *
   361*  STATE CODE (STANDARD P.O. ABBRV)                              *
   362*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   363*  DEVIATION CODE                                                *
   364*  ISSUE AGE                                                     *
   365*  ORIGINAL BENEFIT AMOUNT                                       *
   366*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   367*  PROCESS TYPE (CANCEL)                                         *
   368*  BENEFIT KIND (LIFE OR A/H)                                    *
   369*  A.P.R.                                                        *
   370*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   371*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   372*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   373*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   374*  COMPANY I.D. (3 CHARACTER)                                    *
   375*  BENEFIT CODE                                                  *
   376*  BENEFIT OVERRIDE CODE                                         *
   377*                                                                *
   378*  RETURNED FROM ELRFND                                          *
   379*  --------------------                                          *
   380*  CALCULATED REFUND                                             *
   381*----------------------------------------------------------------*
   382*  PASSED TO ELEARN                                              *
   383*  ----------------                                              *
   384*  CERT ISSUE DATE                                               *
   385*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   386*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   387*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   388*  STATE CODE (CLIENT DEFINED)                                   *
   389*  STATE CODE (STANDARD P.O. ABBRV)                              *
   390*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   391*  DEVIATION CODE                                                *
   392*  ISSUE AGE                                                     *
   393*  ORIGINAL BENEFIT AMOUNT                                       *
   394*  BENEFIT KIND (LIFE OR A/H)                                    *
   395*  A.P.R.                                                        *
   396*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   397*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   398*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   399*  COMPANY I.D. (3 CHARACTER)                                    *
   400*  BENEFIT CODE                                                  *
   401*  BENEFIT OVERRIDE CODE                                         *
   402*                                                                *
   403*  RETURNED FROM ELEARN                                          *
   404*  --------------------                                          *
   405*  INDICATED  EARNINGS                                           *
   406*----------------------------------------------------------------*
   407*                 LENGTH = 450                                   *
   408*                                                                *
   409******************************************************************
   410******************************************************************
   411*                   C H A N G E   L O G
   412*
   413* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* ELPMNT.cbl
   414*-----------------------------------------------------------------
   415*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   416* EFFECTIVE    NUMBER
   417*-----------------------------------------------------------------
   418* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   419* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   420* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   421* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   422* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   423* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   424* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   425******************************************************************
   426
   427 01  CALCULATION-PASS-AREA.
   428     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   429                                     COMP.
   430
   431     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   432       88  NO-CP-ERROR                             VALUE ZERO.
   433       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   434                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   435       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   436       88  CP-ERROR-IN-DATES                       VALUE '2'.
   437       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   438       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   439       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   440       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   441       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   442       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   443       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   444       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   445       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   446       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   447       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   448       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   449       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   450       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   451       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   452
   453     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   454       88  NO-CP-ERROR-2                           VALUE ZERO.
   455***********************  INPUT AREAS ****************************
   456
   457     12  CP-CALCULATION-AREA.
   458         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   459         16  CP-CERT-EFF-DT        PIC XX.
   460         16  CP-VALUATION-DT       PIC XX.
   461         16  CP-PAID-THRU-DT       PIC XX.
   462         16  CP-BENEFIT-TYPE       PIC X.
   463           88  CP-AH                               VALUE 'A' 'D'
   464                                                   'I' 'U'.
   465           88  CP-REDUCING-LIFE                    VALUE 'R'.
   466           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   467         16  CP-INCURRED-DT        PIC XX.
   468         16  CP-REPORTED-DT        PIC XX.
   469         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   470         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   471         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* ELPMNT.cbl
   472                                     COMP-3.
   473         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   474                                     COMP-3.
   475         16  CP-CDT-METHOD         PIC X.
   476           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   477           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   478           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   479         16  CP-CLAIM-TYPE         PIC X.
   480           88  CP-AH-CLAIM                         VALUE 'A'.
   481           88  CP-LIFE-CLAIM                       VALUE 'L'.
   482         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   483                                     COMP-3.
   484         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   485                                     COMP-3.
   486         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   487                                     COMP-3.
   488         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   489                                     COMP-3.
   490         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   491                                     COMP-3.
   492         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   493                                     COMP-3.
   494         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   495                                     COMP-3.
   496         16  CP-REM-TERM-METHOD    PIC X.
   497           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   498           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   499           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   500           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   501           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   502           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   503           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   504         16  CP-EARNING-METHOD     PIC X.
   505           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   506           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   507           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   508           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   509           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   510           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   511           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   512           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   513           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   514           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   515           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   516           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   517         16  CP-PROCESS-TYPE       PIC X.
   518           88  CP-CLAIM                            VALUE '1'.
   519           88  CP-CANCEL                           VALUE '2'.
   520           88  CP-ISSUE                            VALUE '3'.
   521         16  CP-SPECIAL-CALC-CD    PIC X.
   522           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   523           88  CP-1-MTH-INTEREST               VALUE ' '.
   524           88  CP-0-MTH-INTEREST               VALUE 'A'.
   525           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   526           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   527           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   528           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   529           88  CP-FARM-PLAN                    VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* ELPMNT.cbl
   530           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   531           88  CP-2-MTH-INTEREST               VALUE 'I'.
   532           88  CP-3-MTH-INTEREST               VALUE 'J'.
   533           88  CP-4-MTH-INTEREST               VALUE 'K'.
   534           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   535           88  CP-MORTGAGE-REC                 VALUE 'M'.
   536           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   537           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   538           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   539           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   540                                                     'W' 'X'.
   541           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   542           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   543           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   544           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   545           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   546           88  CP-SUMMARY-REC                  VALUE 'Z'.
   547           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   548           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   549           88  CP-AD-D-BENEFIT                 VALUE '4'.
   550           88  CP-CSL-METH-1                   VALUE '5'.
   551           88  CP-CSL-METH-2                   VALUE '6'.
   552           88  CP-CSL-METH-3                   VALUE '7'.
   553           88  CP-CSL-METH-4                   VALUE '8'.
   554
   555         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   556                                     COMP-3.
   557         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   558         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   559         16  CP-STATE              PIC XX          VALUE SPACE.
   560         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   561         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   562           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   563               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   564         16  CP-R78-OPTION         PIC X.
   565           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   566           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   567
   568         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   569         16  CP-IBNR-RESERVE-SW    PIC X.
   570         16  CP-CLAIM-STATUS       PIC X.
   571         16  CP-RATE-FILE          PIC X.
   572         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   573                                     COMP-3.
   574
   575         16  CP-LIFE-OVERRIDE-CODE PIC X.
   576         16  CP-AH-OVERRIDE-CODE   PIC X.
   577
   578         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   579                                     COMP-3.
   580         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   581                                     COMP-3.
   582         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   583                                     COMP-3.
   584         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   585                                     COMP-3.
   586
   587         16  CP-PAID-FROM-DATE     PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* ELPMNT.cbl
   588         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   589         16  CP-EXT-DAYS-CALC      PIC X.
   590           88  CP-EXT-NO-CHG                   VALUE ' '.
   591           88  CP-EXT-CHG-LF                   VALUE '1'.
   592           88  CP-EXT-CHG-AH                   VALUE '2'.
   593           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   594         16  CP-DOMICILE-STATE     PIC XX.
   595         16  CP-CARRIER            PIC X.
   596         16  CP-REIN-FLAG          PIC X.
   597         16  CP-REM-TRM-CALC-OPTION PIC X.
   598           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   599                      '2' '3' '4' '5'.
   600           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   601           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   602           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   603           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   604           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   605           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   606           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   607           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   608         16  CP-SIG-SWITCH         PIC X.
   609         16  CP-RATING-METHOD      PIC X.
   610           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   611           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   612           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   613           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   614           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   615           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   616           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   617           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   618           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   619         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   620                                     COMP-3.
   621         16  CP-BEN-CATEGORY       PIC X.
   622         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   623         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   624                                   PIC S99V9(5) COMP-3.
   625         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   626         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   627                                   PIC S99V9(5) COMP-3.
   628         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   629         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   630         16  CP-EXPIRE-DT          PIC XX.
   631         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   632         16  FILLER                PIC X(35).
   633*        16  FILLER                PIC X(50).
   634
   635***************    OUTPUT FROM ELRESV   ************************
   636
   637         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   638
   639         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   640                                     COMP-3.
   641         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   642                                     COMP-3.
   643         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   644                                     COMP-3.
   645         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* ELPMNT.cbl
   646                                     COMP-3.
   647         16  FILLER                PIC X(09).
   648***************    OUTPUT FROM ELRTRM   *************************
   649
   650         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   651                                     COMP-3.
   652         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   653                                     COMP-3.
   654         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   655                                     COMP-3.
   656         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   657                                     COMP-3.
   658         16  FILLER                PIC X(12).
   659
   660***************    OUTPUT FROM ELRAMT   *************************
   661
   662         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   663                                     COMP-3.
   664         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   665                                     COMP-3.
   666         16  FILLER                PIC X(12).
   667
   668***************    OUTPUT FROM ELRATE   *************************
   669
   670         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   671                                     COMP-3.
   672         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   673                                     COMP-3.
   674         16  CP-MORTALITY-CODE     PIC X(4).
   675         16  CP-RATE-EDIT-FLAG     PIC X.
   676             88  CP-RATES-NEED-APR                  VALUE '1'.
   677         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   678                                     COMP-3.
   679         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   680         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   681         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   682                                   PIC S9(7)V99 COMP-3.
   683         16  FILLER                PIC X(07).
   684
   685***************    OUTPUT FROM ELRFND   *************************
   686
   687         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   688                                     COMP-3.
   689         16  CP-REFUND-TYPE-USED   PIC X.
   690           88  CP-R-AS-R78                         VALUE '1'.
   691           88  CP-R-AS-PRORATA                     VALUE '2'.
   692           88  CP-R-AS-CALIF                       VALUE '3'.
   693           88  CP-R-AS-TEXAS                       VALUE '4'.
   694           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   695           88  CP-R-AS-NET-PAY                     VALUE '5'.
   696           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   697           88  CP-R-AS-MEAN                        VALUE '8'.
   698           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   699           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   700           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   701         16  FILLER                PIC X(12).
   702
   703***************    OUTPUT FROM ELEARN   *************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* ELPMNT.cbl
   704
   705         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   706                                     COMP-3.
   707         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   708                                     COMP-3.
   709         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   710                                     COMP-3.
   711         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   712                                     COMP-3.
   713         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   714                                     COMP-3.
   715         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   716                                     COMP-3.
   717         16  CP-EARNING-TYPE-USED  PIC X.
   718           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   719           88  CP-E-AS-R78                         VALUE '1'.
   720           88  CP-E-AS-PRORATA                     VALUE '2'.
   721           88  CP-E-AS-TEXAS                       VALUE '4'.
   722           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
   723           88  CP-E-AS-NET-PAY                     VALUE '5'.
   724           88  CP-E-AS-ANTICIPATION                VALUE '6'.
   725           88  CP-E-AS-MEAN                        VALUE '8'.
   726           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
   727         16  FILLER                PIC X(12).
   728
   729***************    OUTPUT FROM ELPMNT   *************************
   730
   731         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
   732                                     COMP-3.
   733         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
   734                                     COMP-3.
   735         16  FILLER                PIC X(12).
   736
   737***************   MISC WORK AREAS    *****************************
   738         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
   739                                     COMP-3.
   740         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
   741                                     COMP-3.
   742         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
   743                                     COMP-3.
   744         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
   745                                     COMP-3.
   746         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
   747                                     COMP-3.
   748         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
   749                                     COMP-3.
   750         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
   751             88  OPEN-RATE-FILE                   VALUE 'O'.
   752             88  CLOSE-RATE-FILE                  VALUE 'C'.
   753             88  IO-ERROR                         VALUE 'E'.
   754
   755         16  CP-FIRST-PAY-DATE     PIC XX.
   756
   757         16  CP-JOINT-INDICATOR    PIC X.
   758
   759         16  CP-RESERVE-REMAINING-TERM
   760                                   PIC S9(4)V9    VALUE ZERO
   761                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* ELPMNT.cbl
   762
   763         16  CP-INSURED-BIRTH-DT   PIC XX.
   764
   765         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
   766                                     COMP-3.
   767
   768         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
   769                                     COMP-3.
   770
   771         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
   772                                     COMP-3.
   773
   774         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
   775                                     COMP-3.
   776
   777         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
   778                                     COMP-3.
   779
   780         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
   781                                     COMP-3.
   782
   783         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
   784                                     COMP-3.
   785
   786         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
   787             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
   788
   789         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
   790                                     COMP-3.
   791         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   792                                     COMP-3.
   793         16  FILLER                PIC X(17).
   794******************************************************************
   795
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* ELPMNT.cbl
   797 01  MISC-WORK-AREAS.
   798     12  WS-DAYS-TOL         PIC S9(5)     VALUE +0      COMP-3.
   799     12  WS-PMT-TOL          PIC S9(7)V99  VALUE +0      COMP-3.
   800     12  WS-MAX-DAYS-TOL     PIC S9(5)     VALUE +0      COMP-3.
   801     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   802     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   803     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   804     12  WS-COMPUTE-AMT      PIC S9(9)V999 VALUE +0      COMP-3.
   805     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   806     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   807     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   808     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   809     12  WORK-DATE-FROM      PIC 9(8)      VALUE ZERO.
   810     12  WORK-DATE-FROM-R  REDEFINES  WORK-DATE-FROM.
   811         16  WDF-CCYY        PIC 9(4).
   812         16  WDF-CCYR  REDEFINES  WDF-CCYY.
   813             20  WDF-CC      PIC 99.
   814             20  WDF-YR      PIC 99.
   815         16  WDF-MONTH       PIC 99.
   816         16  WDF-DAY         PIC 99.
   817     12  WORK-DATE-THRU      PIC 9(8)      VALUE ZERO.
   818     12  WORK-DATE-THRU-R  REDEFINES  WORK-DATE-THRU.
   819         16  WDT-CCYY        PIC 9(4).
   820         16  WDT-CCYR  REDEFINES  WDT-CCYY.
   821             20  WDT-CC      PIC 99.
   822             20  WDT-YR      PIC 99.
   823         16  WDT-MONTH       PIC 99.
   824         16  WDT-DAY         PIC 99.
   825     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   826     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   827     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   828     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   829     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   830     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   831     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   832     12  SAVE-ODD-DAYS-OVER  PIC 9(03)     VALUE ZERO.
   833     12  WS-DAILY-RATE       PIC S9(3)V99.
   834     12  WST-DAILY-RATE      PIC S9(3)V99999.
   835     12  WS-PY-WORK          PIC S9(8)V99.
   836     12  WS-PY-WK REDEFINES WS-PY-WORK.
   837         16  WS-PY-NUM       PIC S9(7)V99.
   838         16  WS-PY-SIGN      PIC X.
   839     12  WS-DY-WORK          PIC S9(5).
   840     12  WS-DY-WK REDEFINES WS-DY-WORK.
   841         16  WS-DY-NUM       PIC S9(4).
   842         16  WS-DY-SIGN      PIC X.
   843     12  WS-ACCESS.
   844         16  FILLER          PIC XX      VALUE SPACES.
   845         16  WS-BEN-CD       PIC 99.
   846     12  DATE-WORK.
   847         16  FILLER          PIC X(2).
   848         16  NUM-WORK        PIC X(6).
   849     12  WS-SAVE-INPUT.
   850         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   851         16  WS-PAYEE        PIC X(02)   VALUE SPACE.
   852         16  WS-PMTNOTE1     PIC X(40)   VALUE SPACES.
   853         16  WS-PMTNOTE2     PIC X(40)   VALUE SPACES.
   854         16  WS-OFFLINE      PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* ELPMNT.cbl
   855         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   856         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   857         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   858         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   859         16  WS-ERESV        PIC S9(7)V99 VALUE 0.
   860         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   861         16  WS-ETYPE        PIC X       VALUE SPACE.
   862         16  WS-CASH         PIC X       VALUE SPACE.
   863         16  WS-GROUPED      PIC X       VALUE SPACE.
   864     12  LAST-ERROR-LINE.
   865         16  WS-FATAL-CTR        PIC ZZ9.
   866         16  FILLER              PIC X(30)
   867             VALUE ' FATAL ERRORS ENCOUNTERED'.
   868         16  WS-FORCE-CTR        PIC ZZ9.
   869         16  FILLER              PIC X(28)
   870             VALUE ' FORCABLE ERRORS ENCOUNTERED'.
   871     12  WS-CHECK-AREA.
   872         16  WS-CHECK-CARR       PIC X.
   873         16  WS-CHECK-NUM        PIC 9(6).
   874     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   875     12  OPTION-1-SAVE-AREA.
   876         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   877         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   878
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* ELPMNT.cbl
   880****************************************************************
   881*
   882* Copyright (c) 2007 by Clerity Solutions, Inc.
   883* All rights reserved.
   884*
   885****************************************************************
   886 01  DFHEIV.
   887   02  DFHEIV0               PIC X(35).
   888   02  DFHEIV1               PIC X(08).
   889   02  DFHEIV2               PIC X(08).
   890   02  DFHEIV3               PIC X(08).
   891   02  DFHEIV4               PIC X(06).
   892   02  DFHEIV5               PIC X(04).
   893   02  DFHEIV6               PIC X(04).
   894   02  DFHEIV7               PIC X(02).
   895   02  DFHEIV8               PIC X(02).
   896   02  DFHEIV9               PIC X(01).
   897   02  DFHEIV10              PIC S9(7) COMP-3.
   898   02  DFHEIV11              PIC S9(4) COMP SYNC.
   899   02  DFHEIV12              PIC S9(4) COMP SYNC.
   900   02  DFHEIV13              PIC S9(4) COMP SYNC.
   901   02  DFHEIV14              PIC S9(4) COMP SYNC.
   902   02  DFHEIV15              PIC S9(4) COMP SYNC.
   903   02  DFHEIV16              PIC S9(9) COMP SYNC.
   904   02  DFHEIV17              PIC X(04).
   905   02  DFHEIV18              PIC X(04).
   906   02  DFHEIV19              PIC X(04).
   907   02  DFHEIV20              USAGE IS POINTER.
   908   02  DFHEIV21              USAGE IS POINTER.
   909   02  DFHEIV22              USAGE IS POINTER.
   910   02  DFHEIV23              USAGE IS POINTER.
   911   02  DFHEIV24              USAGE IS POINTER.
   912   02  DFHEIV25              PIC S9(9) COMP SYNC.
   913   02  DFHEIV26              PIC S9(9) COMP SYNC.
   914   02  DFHEIV27              PIC S9(9) COMP SYNC.
   915   02  DFHEIV28              PIC S9(9) COMP SYNC.
   916   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   917   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   918   02  FILLER                PIC X(02).
   919   02  DFHEIV99              PIC X(08) VALUE SPACE.
   920   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   921   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   922   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   923   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   924 LINKAGE  SECTION.
   925*****************************************************************
   926*                                                               *
   927* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   928* All rights reserved.                                          *
   929*                                                               *
   930*****************************************************************
   931 01  dfheiblk.
   932     02  eibtime          pic s9(7) comp-3.
   933     02  eibdate          pic s9(7) comp-3.
   934     02  eibtrnid         pic x(4).
   935     02  eibtaskn         pic s9(7) comp-3.
   936     02  eibtrmid         pic x(4).
   937     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* ELPMNT.cbl
   938     02  eibcposn         pic s9(4) comp.
   939     02  eibcalen         pic s9(4) comp.
   940     02  eibaid           pic x(1).
   941     02  eibfiller1       pic x(1).
   942     02  eibfn            pic x(2).
   943     02  eibfiller2       pic x(2).
   944     02  eibrcode         pic x(6).
   945     02  eibfiller3       pic x(2).
   946     02  eibds            pic x(8).
   947     02  eibreqid         pic x(8).
   948     02  eibrsrce         pic x(8).
   949     02  eibsync          pic x(1).
   950     02  eibfree          pic x(1).
   951     02  eibrecv          pic x(1).
   952     02  eibsend          pic x(1).
   953     02  eibatt           pic x(1).
   954     02  eibeoc           pic x(1).
   955     02  eibfmh           pic x(1).
   956     02  eibcompl         pic x(1).
   957     02  eibsig           pic x(1).
   958     02  eibconf          pic x(1).
   959     02  eiberr           pic x(1).
   960     02  eibrldbk         pic x(1).
   961     02  eiberrcd         pic x(4).
   962     02  eibsynrb         pic x(1).
   963     02  eibnodat         pic x(1).
   964     02  eibfiller5       pic x(2).
   965     02  eibresp          pic 9(09) comp.
   966     02  eibresp2         pic 9(09) comp.
   967     02  dfheigdj         pic s9(4) comp.
   968     02  dfheigdk         pic s9(4) comp.
   969 01  DFHCOMMAREA             PIC X(450).
   970
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* ELPMNT.cbl
   972 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
   973 0000-DFHEXIT SECTION.
   974     MOVE '9#                    $   ' TO DFHEIV0.
   975     MOVE 'ELPMNT' TO DFHEIV1.
   976     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   977
   978     MOVE DFHCOMMAREA       TO CALCULATION-PASS-AREA.
   979
   980     MOVE ZERO              TO CP-RETURN-CODE.
   981
   982*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
   983
   984****************************************************************
   985****************************************************************
   986*                  CALCULATED FROM      PAYMENT      PAYMENT
   987*   DATES           DATE ROUTINE        OPT  1       OPT  6
   988* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
   989*1-01-83  1-15-83    0    15     15        15           15
   990*1-01-83  1-30-83    0    30     30        30           30
   991*1-01-83  1-31-83    1     0     31        30           30
   992*1-01-83  2-01-83    1     1     32        31           31
   993*1-01-83  2-15-83    1    15     46        45           45
   994*1-01-83  2-28-83    2     0     59        60           60
   995*1-01-83  3-01-83    2     1     60        61           61
   996*1-01-83  3-31-83    3     0     90        90           90
   997*1-15-83  1-31-83    0    17     17        17           16
   998*1-15-83  2-01-83    0    18     18        18           17
   999*1-15-83  2-28-83    1    14     45        44           46
  1000*1-21-83  3-09-83    1    20     48        50           49
  1001*2-05-83  3-06-83    1     2     30        32           32
  1002*2-05-83  3-23-83    1    19     47        49           49
  1003*2-15-83  2-28-83    0    14     14        14           16
  1004*2-15-83  3-01-83    0    15     15        15           17
  1005*2-21-83  3-19-83    0    27     27        27           29
  1006*2-21-83  3-20-83    1     0     28        30           30
  1007*2-21-83  4-10-83    1    18     49        30           50
  1008*2-21-83  5-19-83    2    27     88        87           89
  1009*2-21-83  5-22-83    3     2     91        92           92
  1010*3-21-83  5-19-83    1    30     60        60           59
  1011****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* ELPMNT.cbl
  1013 0000-CALC-PAYMENT.
  1014
  1015     MOVE CP-PAID-FROM-DATE      TO DC-BIN-DATE-1
  1016     MOVE ' '                    TO DC-OPTION-CODE
  1017     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1018     IF NO-CONVERSION-ERROR
  1019        MOVE DC-DAYS-IN-MONTH    TO FROM-DAYS-IN-MONTH
  1020        MOVE DC-GREG-DATE-CYMD   TO WORK-DATE-FROM
  1021     ELSE
  1022        MOVE '2'                 TO CP-RETURN-CODE
  1023        GO TO 0100-RETURN.
  1024
  1025     MOVE CP-PAID-THRU-DT        TO DC-BIN-DATE-1
  1026     MOVE ' '                    TO DC-OPTION-CODE
  1027     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1028     IF NO-CONVERSION-ERROR
  1029        MOVE DC-GREG-DATE-CYMD      TO WORK-DATE-THRU
  1030        MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH
  1031     ELSE
  1032        MOVE '2'                 TO CP-RETURN-CODE
  1033        GO TO 0100-RETURN.
  1034
  1035     MOVE CP-PAID-FROM-DATE      TO DC-BIN-DATE-1
  1036     MOVE -1                     TO DC-ELAPSED-DAYS
  1037     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  1038     MOVE '6'                    TO DC-OPTION-CODE
  1039     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1040     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH
  1041
  1042     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
  1043     MOVE CP-PAID-THRU-DT        TO DC-BIN-DATE-2
  1044     MOVE '1'                    TO DC-OPTION-CODE
  1045     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1046
  1047     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS
  1048     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER
  1049     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS
  1050                                    CP-ACTUAL-DAYS
  1051
  1052******************************************************************
  1053*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
  1054*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
  1055*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
  1056******************************************************************
  1057
  1058     IF CP-CLAIM-CALC-METHOD EQUAL '1'  AND
  1059        DC-ELAPSED-MONTHS GREATER ZERO AND
  1060        DC-ODD-DAYS-OVER NOT = ZEROS   AND
  1061        WDF-DAY GREATER THAN WDT-DAY
  1062        MOVE CP-PAID-THRU-DT     TO DC-BIN-DATE-1
  1063        MOVE ZEROS               TO DC-ELAPSED-DAYS
  1064        MOVE -1                  TO DC-ELAPSED-MONTHS
  1065        MOVE '6'                 TO DC-OPTION-CODE
  1066        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1067        MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
  1068        COMPUTE WS-SAVE-ODD-DAYS =
  1069         (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
  1070        ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* ELPMNT.cbl
  1071
  1072     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
  1073     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
  1074     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
  1075
  1076     IF (CP-COMPANY-ID EQUAL 'FIA' AND
  1077        CP-ACCOUNT-NUMBER EQUAL '0000011043')
  1078        COMPUTE WS-DAILY-RATE ROUNDED =
  1079                    (CP-ORIGINAL-BENEFIT * 13) / 365
  1080         COMPUTE CP-CLAIM-PAYMENT ROUNDED EQUAL
  1081                           WS-DAILY-RATE * DC-ELAPSED-DAYS
  1082         GO TO 0100-RETURN.
  1083
  1084     IF CP-CLAIM-CALC-METHOD EQUAL '1'
  1085         COMPUTE WST-DAILY-RATE ROUNDED EQUAL
  1086                  CP-ORIGINAL-BENEFIT / 30
  1087         COMPUTE CP-CLAIM-PAYMENT ROUNDED EQUAL
  1088             (CP-ORIGINAL-BENEFIT * DC-ELAPSED-MONTHS) +
  1089             (WST-DAILY-RATE     * DC-ODD-DAYS-OVER)
  1090              MOVE WST-DAILY-RATE TO WS-DAILY-RATE
  1091         GO TO 0100-RETURN.
  1092
  1093     IF CP-CLAIM-CALC-METHOD EQUAL '2'
  1094         COMPUTE WS-DAILY-RATE ROUNDED =
  1095                   (CP-ORIGINAL-BENEFIT * 12) / 365
  1096         COMPUTE CP-CLAIM-PAYMENT ROUNDED EQUAL
  1097           (CP-ORIGINAL-BENEFIT * DC-ELAPSED-MONTHS) +
  1098             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
  1099         GO TO 0100-RETURN.
  1100
  1101     IF CP-CLAIM-CALC-METHOD EQUAL '4'
  1102         MOVE CP-ORIGINAL-BENEFIT     TO  WS-AH-BEN-AMT
  1103         COMPUTE WST-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
  1104         MOVE WST-DAILY-RATE TO WS-DAILY-RATE
  1105         COMPUTE CP-CLAIM-PAYMENT ROUNDED EQUAL
  1106                           WST-DAILY-RATE * DC-ELAPSED-DAYS
  1107         GO TO 0100-RETURN.
  1108
  1109     IF CP-CLAIM-CALC-METHOD EQUAL '5'
  1110         COMPUTE WS-DAILY-RATE ROUNDED =
  1111                   (CP-ORIGINAL-BENEFIT * 12) / 365
  1112         COMPUTE CP-CLAIM-PAYMENT ROUNDED =
  1113                           WS-DAILY-RATE * DC-ELAPSED-DAYS
  1114         GO TO 0100-RETURN.
  1115
  1116     IF CP-CLAIM-CALC-METHOD NOT EQUAL '3'
  1117        GO TO 0010-CHECK-PAYMENT.
  1118
  1119******   CALCULATION METHOD  3  ROUTINE
  1120     COMPUTE WS-DAILY-RATE =
  1121             CP-ORIGINAL-BENEFIT / FROM-DAYS-IN-MONTH.
  1122
  1123******CHECK TO SEE IF WITHIN SAME MONTH
  1124     IF (WDF-MONTH = WDT-MONTH) AND (WDF-CCYY = WDT-CCYY)
  1125        COMPUTE CP-CLAIM-PAYMENT ROUNDED EQUAL
  1126              SAVE-ELAPSED-DAYS *
  1127              (CP-ORIGINAL-BENEFIT / FROM-DAYS-IN-MONTH)
  1128         GO TO 0100-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* ELPMNT.cbl
  1129
  1130******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
  1131     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
  1132             SAVE-ODD-DAYS-OVER = ZEROS
  1133      COMPUTE CP-CLAIM-PAYMENT ROUNDED EQUAL
  1134            CP-ORIGINAL-BENEFIT * SAVE-ELAPSED-MONTHS
  1135      GO TO 0100-RETURN.
  1136
  1137******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
  1138******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
  1139     IF SAVE-ELAPSED-MONTHS NOT = ZERO
  1140        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
  1141        IF WDF-MONTH GREATER THAN 12
  1142           ADD 1                 TO WDF-CCYY
  1143           SUBTRACT 12         FROM WDF-MONTH.
  1144******CONVERT THE NEW FROM MONTH TO BINARY
  1145     IF SAVE-ELAPSED-MONTHS NOT = ZERO
  1146        MOVE WORK-DATE-FROM TO DC-GREG-DATE-CYMD
  1147        MOVE 'L' TO DC-OPTION-CODE
  1148        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1149        MOVE DC-DAYS-IN-MONTH    TO FROM-DAYS-IN-MONTH.
  1150
  1151     IF (WDF-MONTH = WDT-MONTH) AND (WDF-CCYY = WDT-CCYY)
  1152       COMPUTE CP-CLAIM-PAYMENT ROUNDED EQUAL
  1153                      ((WDT-DAY  -  WDF-DAY)  *
  1154             (CP-ORIGINAL-BENEFIT / FROM-DAYS-IN-MONTH)) +
  1155                (CP-ORIGINAL-BENEFIT * SAVE-ELAPSED-MONTHS)
  1156        ELSE
  1157       COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
  1158       MOVE WDT-DAY              TO THRU-PMT-DAYS
  1159       COMPUTE CP-CLAIM-PAYMENT ROUNDED EQUAL
  1160       (FROM-PMT-DAYS * (CP-ORIGINAL-BENEFIT /
  1161                         FROM-DAYS-IN-MONTH))
  1162       +
  1163       (THRU-PMT-DAYS * (CP-ORIGINAL-BENEFIT /
  1164                         THRU-DAYS-IN-MONTH))
  1165       +
  1166       (CP-ORIGINAL-BENEFIT * SAVE-ELAPSED-MONTHS).
  1167     GO TO 0100-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* ELPMNT.cbl
  1169 0010-CHECK-PAYMENT.
  1170******PAYMENT OPTION 6
  1171******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
  1172     IF SAVE-ELAPSED-MONTHS GREATER THAN ZERO
  1173        IF SAVE-ODD-DAYS-OVER = ZEROS
  1174           GO TO 0020-CHECK-TO-DAY
  1175        ELSE
  1176           IF WDF-DAY GREATER THAN WDT-DAY
  1177              IF WDF-MONTH = 02
  1178                  PERFORM 0050-CHECK-LEAP-YEAR THRU 0050-EXIT
  1179                  ADD 2          TO  SAVE-ODD-DAYS-OVER
  1180                  GO TO 0020-CHECK-TO-DAY
  1181              ELSE
  1182                  IF FROM-DAYS-IN-MONTH = 31 AND WDF-DAY NOT = 31
  1183                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
  1184                     GO TO 0020-CHECK-TO-DAY
  1185                  ELSE
  1186                     GO TO 0020-CHECK-TO-DAY
  1187           ELSE
  1188               GO TO 0020-CHECK-TO-DAY.
  1189
  1190     IF WDF-MONTH NOT = WDT-MONTH
  1191        IF WDF-MONTH = 02
  1192           PERFORM 0050-CHECK-LEAP-YEAR THRU 0050-EXIT
  1193           IF WDF-DAY = 29
  1194              ADD 1              TO SAVE-ODD-DAYS-OVER
  1195           ELSE
  1196              ADD 2              TO SAVE-ODD-DAYS-OVER
  1197        ELSE
  1198           IF FROM-DAYS-IN-MONTH = 31 AND WDF-DAY NOT = 31
  1199              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
  1200
  1201 0020-CHECK-TO-DAY.
  1202        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
  1203           IF WDT-DAY = 28
  1204              ADD 2              TO SAVE-ODD-DAYS-OVER
  1205           ELSE
  1206              IF WDT-DAY = 29
  1207                 ADD 1           TO SAVE-ODD-DAYS-OVER
  1208              ELSE
  1209                 NEXT SENTENCE
  1210        ELSE
  1211           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
  1212              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
  1213
  1214     COMPUTE WST-DAILY-RATE ROUNDED EQUAL
  1215                            CP-ORIGINAL-BENEFIT / 30
  1216     MOVE WST-DAILY-RATE          TO WS-DAILY-RATE
  1217     COMPUTE CP-CLAIM-PAYMENT ROUNDED EQUAL
  1218         (CP-ORIGINAL-BENEFIT * SAVE-ELAPSED-MONTHS) +
  1219         (WST-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
  1220
  1221     GO TO 0100-RETURN.
  1222
  1223 0050-CHECK-LEAP-YEAR.
  1224
  1225     IF FROM-DAYS-IN-MONTH = 29
  1226        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* ELPMNT.cbl
  1227
  1228 0050-EXIT.
  1229     EXIT.
  1230
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* ELPMNT.cbl
  1232 0100-RETURN.
  1233
  1234     MOVE CALCULATION-PASS-AREA TO DFHCOMMAREA.
  1235
  1236
  1237* EXEC CICS RETURN
  1238*    END-EXEC.
  1239*    MOVE '.(                    &   #00001232' TO DFHEIV0
  1240     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1241     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1242     MOVE X'2020233030303031323332' TO DFHEIV0(25:11)
  1243     CALL 'kxdfhei1' USING DFHEIV0,
  1244           DFHEIV99,
  1245           DFHEIV99,
  1246           DFHEIV99,
  1247           DFHEIV99,
  1248           DFHEIV99
  1249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1250
  1251
  1252
  1253* GOBACK.
  1254     MOVE '9%                    "   ' TO DFHEIV0
  1255     MOVE 'ELPMNT' TO DFHEIV1
  1256     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1257     GOBACK.
  1258
  1259 9700-LINK-DATE-CONVERT.
  1260
  1261
  1262* EXEC CICS LINK
  1263*         PROGRAM    ('ELDATCV')
  1264*         COMMAREA   (DATE-CONVERSION-DATA)
  1265*         LENGTH     (DC-COMM-LENGTH)
  1266*    END-EXEC.
  1267     MOVE 'ELDATCV' TO DFHEIV1
  1268*    MOVE '."C                   ''   #00001239' TO DFHEIV0
  1269     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1270     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1271     MOVE X'2020233030303031323339' TO DFHEIV0(25:11)
  1272     CALL 'kxdfhei1' USING DFHEIV0,
  1273           DFHEIV1,
  1274           DATE-CONVERSION-DATA,
  1275           DC-COMM-LENGTH,
  1276           DFHEIV99,
  1277           DFHEIV99,
  1278           DFHEIV99
  1279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1280
  1281
  1282 9700-EXIT.
  1283     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* ELPMNT.cbl
  1286
  1287 9999-DFHBACK SECTION.
  1288     MOVE '9%                    "   ' TO DFHEIV0
  1289     MOVE 'ELPMNT' TO DFHEIV1
  1290     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1291     GOBACK.
  1292 9999-DFHEXIT.
  1293     IF DFHEIGDJ EQUAL 0001
  1294         NEXT SENTENCE.
  1295     MOVE '9%                    "   ' TO DFHEIV0
  1296     MOVE 'ELPMNT' TO DFHEIV1
  1297     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1298     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2024     Code:        2089
