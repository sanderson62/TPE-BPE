* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page   1
* EL151.cbl
* Options: int("EL151.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL151.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL151.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL151.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL151 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/06/95 13:08:11.
     7*                            VMOD=2.012.
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page   2
* EL151.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24******************************************************************
    25*                   C H A N G E   L O G
    26*
    27* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    28*-----------------------------------------------------------------
    29*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    30* EFFECTIVE    NUMBER
    31*-----------------------------------------------------------------
    32* 050506    2006030600001  AJRA  ADD PROOF DATE TO DENIAL SCREEN
    33* 120808    2008100900001  PEMA  ADD FOR DENIAL CODE
    34* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    35* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    36* 043019  IR2019042300001  PEMA  DISALLOW PROOF DT > REC DT OR < I
    37* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    38******************************************************************
    39*REMARKS.
    40
    41*    SCREENS     - EL151S - DENIALS
    42
    43*    ENTERED BY  - EL150 - STATUS AND DISPOSITION
    44
    45*    EXIT TO     - EL150 - CALLING PROGRAM
    46
    47*    INPUT FILE  - ELMSTR - CLAIM MASTER
    48*                - ELTRLR - ACTIVITY TRAILERS
    49*                - ERNOTE - CERTIFICATE NOTES
    50
    51*    OUTPUT FILE - ELMSTR - CLAIM MASTER
    52*                - ELTRLR - ACTIVITY TRAILERS
    53
    54*    COMMAREA    - PASSED
    55
    56*    ERROR-CODES ACCESSED - 132,  133, 270, 137, 29, 315, 008, 50
    57
    58*    NARRATIVE   - 1- PROVIDE CREATION OF DENIAL TRAILERS
    59*                  2- UPDATE CLAIM STATUS TYPE TO CLOSED (ELMSTR)
    60*                  3- UPDATE RESERVE-EXPENSE TRAILER STATUS TO
    61*                     CLOSED, REASON DENIAL
    62
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page   3
* EL151.cbl
    64 ENVIRONMENT DIVISION.
    65
    66 DATA DIVISION.
    67
    68 WORKING-STORAGE SECTION.
    69 01  DFH-START PIC X(04).
    70
    71 77  FILLER  PIC X(32)  VALUE '********************************'.
    72 77  FILLER  PIC X(32)  VALUE '*   EL151  WORKING STORAGE     *'.
    73 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.012 ********'.
    74
    75*                            COPY ELCSCTM.
    76******************************************************************
    77*                                                                *
    78*                                                                *
    79*                            ELCSCTM                             *
    80*                            VMOD=2.001                          *
    81*                                                                *
    82*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    83*                                                                *
    84******************************************************************
    85 01  SECURITY-MESSAGE.
    86     12  FILLER                          PIC X(30)
    87            VALUE '** LOGIC SECURITY VIOLATION -'.
    88     12  SM-READ                         PIC X(6).
    89     12  FILLER                          PIC X(5)
    90            VALUE ' PGM='.
    91     12  SM-PGM                          PIC X(6).
    92     12  FILLER                          PIC X(5)
    93            VALUE ' OPR='.
    94     12  SM-PROCESSOR-ID                 PIC X(4).
    95     12  FILLER                          PIC X(6)
    96            VALUE ' TERM='.
    97     12  SM-TERMID                       PIC X(4).
    98     12  FILLER                          PIC XX   VALUE SPACE.
    99     12  SM-JUL-DATE                     PIC 9(5).
   100     12  FILLER                          PIC X    VALUE SPACE.
   101     12  SM-TIME                         PIC 99.99.
   102
   103
   104*                            COPY ELCSCRTY.
   105******************************************************************
   106*                                                                *
   107*                                                                *
   108*                            ELCSCRTY                            *
   109*                            VMOD=2.001                          *
   110*                                                                *
   111*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   112*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   113*        SAVED IN PI-SECURITY-ADDRESS.                           *
   114*                                                                *
   115******************************************************************
   116 01  SECURITY-CONTROL.
   117     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   118     12  FILLER                       PIC XX    VALUE 'SC'.
   119     12  SC-CREDIT-CODES.
   120         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   121             20  SC-CREDIT-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page   4
* EL151.cbl
   122             20  SC-CREDIT-UPDATE     PIC X.
   123     12  SC-CLAIMS-CODES.
   124         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   125             20  SC-CLAIMS-DISPLAY    PIC X.
   126             20  SC-CLAIMS-UPDATE     PIC X.
   127
   128*                            COPY ELCNWA.
   129*****************************************************************
   130*                                                               *
   131*                                                               *
   132*                            ELCNWA.                            *
   133*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   134*                            VMOD=2.003                         *
   135*                                                               *
   136*            M O V E   N A M E   W O R K   A R E A.             *
   137*                                                               *
   138*****************************************************************.
   139
   140 01  WS-NAME-WORK-AREA.
   141     05  WS-INSURED-LAST-NAME        PIC X(15).
   142     05  WS-INSURED-1ST-NAME         PIC X(12).
   143     05  WS-INSURED-MID-INIT         PIC X.
   144
   145     05  WS-NAME-WORK.
   146         10  WS-NW                   PIC X
   147             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   148
   149     05  WS-NAME-WORK2.
   150         10  WS-NW2                  PIC X
   151             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   152                                        NWA-INDEX0.
   153
   154     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   155                                     COMP-3.
   156
   157
   158 01  WS-DATE-AREA.
   159     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   160     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   161     05  WS-BLANK            PIC X       VALUE ' '.
   162
   163 01  WS-SCRATCH-AREA.
   164     05  GETMAIN-SPACE               PIC X     VALUE SPACE.
   165     05  WS-TRLR-LENGTH              PIC S9(4) VALUE +200  COMP.
   166     05  WS-DMO-LENGTH               PIC S9(4) VALUE +108  COMP.
   167     05  WS-DCT-LENGTH               PIC S9(4) VALUE +53   COMP.
   168     05  SC-ITEM                     PIC S9(4) VALUE +0001 COMP.
   169
   170     05  WS-TRANS-ID                 PIC X(4)   VALUE 'EX32'.
   171     05  WS-SEQ-NO-SAVED             PIC S9(4)   VALUE ZEROS.
   172
   173     05  WS-ORIG-SEQ-CNT             PIC S9(4)   VALUE ZEROS.
   174
   175     05  TR-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   176     05  TR-SUB-2                    PIC S9(4)   VALUE ZERO  COMP.
   177     05  MISC-SUB                    PIC S9(03)  COMP-3  VALUE +0.
   178
   179     05  MAP-NAME                    PIC X(08)   VALUE 'EL151A'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page   5
* EL151.cbl
   180     05  MAPSET-NAME                 PIC X(08)   VALUE 'EL151S'.
   181
   182     05  ELTRLR-FILE-ID              PIC X(08)   VALUE 'ELTRLR'.
   183     05  ELMSTR-FILE-ID              PIC X(08)   VALUE 'ELMSTR'.
   184     05  ELCNTL-FILE-ID              PIC X(08)   VALUE 'ELCNTL'.
   185     05  ELARCH-FILE-ID              PIC X(08)   VALUE 'ELARCH'.
   186
   187     05  THIS-PGM                    PIC X(08)   VALUE  'EL151'.
   188
   189     05  WS-OC-LOAD-SW               PIC X(01)   VALUE SPACE.
   190         88  OC-HISTORY-LOADED       VALUE 'X'.
   191
   192     05  WS-CLAIM-SEQ-SW             PIC X(01)   VALUE SPACE.
   193         88  NO-SEQ-NUMBER           VALUE 'X'.
   194         88  SEQ-NUMBER-EXIST        VALUE ' '.
   195         88  NO-ACCT-TRLR            VALUE 'Y'.
   196
   197     05  WS-RESET-SW                 PIC X(01)   VALUE 'N'.
   198     05  WS-REC-FOUND-SW             PIC X(01)   VALUE 'N'.
   199     05  WS-BROWSE-SW                PIC X(01)   VALUE 'N'.
   200     05  WS-UPDATE-SW                PIC X(01)   VALUE 'N'.
   201
   202     05  TIME-IN                     PIC S9(7).
   203     05  TIME-OUT-R REDEFINES TIME-IN.
   204         10  FILLER                  PIC X(01).
   205         10  TIME-OUT                PIC 99V99.
   206         10  FILLER                  PIC X(02).
   207
   208     05  DEEDIT-FIELD                PIC X(15).
   209     05  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   210
   211     05  WS-PRF-DT                   PIC X(2).
   212     05  WS-MAX-LETTER-ANSWER-DT     PIC X(2)  VALUE LOW-VALUES.
   213
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page   6
* EL151.cbl
   215     05  DENIAL-TABLE.
   216         10  FILLER                  PIC X(44)    VALUE
   217             'DPE  PRE-EXISTING DISABILITY                '.
   218         10  FILLER                  PIC X(44)    VALUE
   219             'DDN  DISABILITY NOT COVERED DUE TO NATURE   '.
   220         10  FILLER                  PIC X(44)    VALUE
   221             'DIR  INSURED RECOVERED FROM DISABILITY      '.
   222         10  FILLER                  PIC X(44)    VALUE
   223             'DEM  EMPLOYMENT INDICATES OCCUPATION NOT MET'.
   224         10  FILLER                  PIC X(44)    VALUE
   225             'DWP  DISABILITY WAITING PERIOD NOT SATISFIED'.
   226         10  FILLER                  PIC X(44)    VALUE
   227             'DNC  NO COVERAGE                            '.
   228         10  FILLER                  PIC X(44)    VALUE
   229             'DAP  APPLICATION MISREPRESENTATION          '.
   230         10  FILLER                  PIC X(44)    VALUE
   231             'DMA  MIS-STATEMENT OF AGE                   '.
   232         10  FILLER                  PIC X(44)    VALUE
   233             'DSU  SUICIDE OR SELF-INFLICTED INJURY       '.
   234         10  FILLER                  PIC X(44)    VALUE
   235             'DOT  OTHER                                  '.
   236         10  FILLER                  PIC X(44)    VALUE
   237             'DAR  AWARE OF UNEMPLOY./RED. AT INCEPTION   '.
   238         10  FILLER                  PIC X(44)    VALUE
   239             'DNE  NOT EMPLOYED SIX MONTHS PRIOR          '.
   240         10  FILLER                  PIC X(44)    VALUE
   241             'DNR  NOT MADE REDUNDANT/NOT UNEMPLOYED      '.
   242         10  FILLER                  PIC X(44)    VALUE
   243             'DSE  SELF EMPLOYED                          '.
   244         10  FILLER                  PIC X(44)    VALUE
   245             'DTW  TEMPORARY WORK                         '.
   246         10  FILLER                  PIC X(44)    VALUE
   247             'LAP  APPLICATION MISREPRESENTATION          '.
   248         10  FILLER                  PIC X(44)    VALUE
   249             'LMA  MIS-STATEMENT OF AGE                   '.
   250         10  FILLER                  PIC X(44)    VALUE
   251             'LNC  NO COVERAGE                            '.
   252         10  FILLER                  PIC X(44)    VALUE
   253             'LOT  OTHER                                  '.
   254     05  DEN-TABLE REDEFINES DENIAL-TABLE OCCURS 19
   255         INDEXED BY DEN-INDEX.
   256         10  DENIAL-CODE.
   257             15  DENIAL-1-1          PIC X(01).
   258             15  DENIAL-2-3          PIC X(02).
   259             15  DENIAL-4-4          PIC X(01).
   260         10  FILLER                  PIC X(01).
   261         10  DENIAL-DESC             PIC X(39).
   262
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page   7
* EL151.cbl
   264 01  ACCESS-KEYS.
   265     05  WS-TRAILER-KEY.
   266         10  WS-CLAIM-KEY.
   267             15  WS-KEY-COMPANY-CD       PIC X.
   268             15  WS-KEY-CARRIER          PIC X.
   269             15  WS-KEY-CLAIM-NO         PIC X(7).
   270             15  WS-KEY-CERT-NO.
   271                 20  WS-KEY-CERT-PRIME   PIC X(10).
   272                 20  WS-KEY-CERT-SFX     PIC X.
   273         10  WS-KEY-SEQUENCE-NO      PIC   S9(4) COMP.
   274
   275     05  ELARCH-KEY.
   276         10  ELARCH-COMPANY-CD   PIC X(01).
   277         10  ELARCH-ARCHIVE-NO   PIC S9(08)  COMP.
   278         10  ELARCH-RECORD-TYPE  PIC X(01).
   279         10  ELARCH-SEQ-NO       PIC S9(04)  COMP.
   280
   281     05  WS-ELDENY-KEY.
   282         10  ELDENY-COMPANY-CD   PIC X.
   283         10  ELDENY-DENIAL-CODE  PIC X(4).
   284         10  FILLER              PIC X(10).
   285     05  ELCNTL-KEY.
   286         10  ELCNTL-COMPANY-ID   PIC X(03).
   287         10  ELCNTL-RECORD-TYPE  PIC X(01).
   288         10  ELCNTL-ACCESS       PIC X(04).
   289         10  ELCNTL-SEQ-NO       PIC S9(04)  COMP.
   290
   291     05  W-NOTE-KEY.
   292         10  W-NOTE-COMP-CD      PIC X.
   293         10  W-NOTE-CERT-KEY.
   294             16  W-NOTE-CARRIER  PIC X.
   295             16  W-NOTE-GROUPING PIC X(6).
   296             16  W-NOTE-STATE    PIC XX.
   297             16  W-NOTE-ACCOUNT  PIC X(10).
   298             16  W-NOTE-EFF-DT   PIC XX.
   299             16  W-NOTE-CERT-NO  PIC X(11).
   300
   301 01  WS-RESPONSE             PIC S9(8)   COMP.
   302     88  RESP-NORMAL              VALUE +00.
   303     88  RESP-ERROR               VALUE +01.
   304     88  RESP-NOTFND              VALUE +13.
   305     88  RESP-NOTOPEN             VALUE +19.
   306     88  RESP-ENDFILE             VALUE +20.
   307 01  ERROR-MESSAGES.
   308     12  ER-0000                 PIC X(4)  VALUE '0000'.
   309     12  ER-0004                 PIC X(4)  VALUE '0004'.
   310     12  ER-0008                 PIC X(4)  VALUE '0008'.
   311     12  ER-0021                 PIC X(4)  VALUE '0021'.
   312     12  ER-0029                 PIC X(4)  VALUE '0029'.
   313     12  ER-0050                 PIC X(4)  VALUE '0050'.
   314     12  ER-0070                 PIC X(4)  VALUE '0070'.
   315     12  ER-0132                 PIC X(4)  VALUE '0132'.
   316     12  ER-0133                 PIC X(4)  VALUE '0133'.
   317     12  ER-0137                 PIC X(4)  VALUE '0137'.
   318     12  ER-0154                 PIC X(4)  VALUE '0154'.
   319     12  ER-0172                 PIC X(4)  VALUE '0172'.
   320     12  ER-0270                 PIC X(4)  VALUE '0270'.
   321     12  ER-0483                 PIC X(4)  VALUE '0483'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page   8
* EL151.cbl
   322     12  ER-0872                 PIC X(4)  VALUE '0872'.
   323     12  ER-0873                 PIC X(4)  VALUE '0873'.
   324     12  ER-0884                 PIC X(4)  VALUE '0884'.
   325     12  ER-0919                 PIC X(4)  VALUE '0919'.
   326     12  ER-0921                 PIC X(4)  VALUE '0921'.
   327     12  ER-0946                 PIC X(4)  VALUE '0946'.
   328     12  ER-0947                 PIC X(4)  VALUE '0947'.
   329     12  ER-0948                 PIC X(4)  VALUE '0948'.
   330     12  ER-0949                 PIC X(4)  VALUE '0949'.
   331     12  ER-0950                 PIC X(4)  VALUE '0950'.
   332     12  ER-0951                 PIC X(4)  VALUE '0951'.
   333     12  ER-0954                 PIC X(4)  VALUE '0954'.
   334     12  ER-0974                 PIC X(4)  VALUE '0974'.
   335     12  ER-0975                 PIC X(4)  VALUE '0975'.
   336     12  ER-8051                 PIC X(4)  VALUE '8051'.
   337     12  ER-8052                 PIC X(4)  VALUE '8052'.
   338     12  ER-8053                 PIC X(4)  VALUE '8053'.
   339     12  ER-8054                 PIC X(4)  VALUE '8054'.
   340     12  ER-8055                 PIC X(4)  VALUE '8055'.
   341     12  ER-8056                 PIC X(4)  VALUE '8056'.
   342     12  ER-8057                 PIC X(4)  VALUE '8057'.
   343     12  ER-8058                 PIC X(4)  VALUE '8058'.
   344     12  ER-8059                 PIC X(4)  VALUE '8059'.
   345     12  ER-8060                 PIC X(4)  VALUE '8060'.
   346     12  ER-8061                 PIC X(4)  VALUE '8061'.
   347     12  ER-8062                 PIC X(4)  VALUE '8062'.
   348     12  ER-8063                 PIC X(4)  VALUE '8063'.
   349     12  ER-8064                 PIC X(4)  VALUE '8064'.
   350     12  ER-8065                 PIC X(4)  VALUE '8065'.
   351     12  ER-8066                 PIC X(4)  VALUE '8066'.
   352     12  ER-8152                 PIC X(4)  VALUE '8152'.
   353     12  ER-8153                 PIC X(4)  VALUE '8153'.
   354     12  ER-8154                 PIC X(4)  VALUE '8154'.
   355     12  ER-8155                 PIC X(4)  VALUE '8155'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page   9
* EL151.cbl
   357*                                    COPY ELCAID.
   358******************************************************************
   359*                                                                *
   360*                            ELCAID.                             *
   361*                            VMOD=2.001                          *
   362*                                                                *
   363*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   364*                                                                *
   365*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   366*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   367******************************************************************
   368
   369 01  DFHAID.
   370   02  DFHNULL   PIC  X  VALUE  ' '.
   371   02  DFHENTER  PIC  X  VALUE  QUOTE.
   372   02  DFHCLEAR  PIC  X  VALUE  '_'.
   373   02  DFHPEN    PIC  X  VALUE  '='.
   374   02  DFHOPID   PIC  X  VALUE  'W'.
   375   02  DFHPA1    PIC  X  VALUE  '%'.
   376   02  DFHPA2    PIC  X  VALUE  '>'.
   377   02  DFHPA3    PIC  X  VALUE  ','.
   378   02  DFHPF1    PIC  X  VALUE  '1'.
   379   02  DFHPF2    PIC  X  VALUE  '2'.
   380   02  DFHPF3    PIC  X  VALUE  '3'.
   381   02  DFHPF4    PIC  X  VALUE  '4'.
   382   02  DFHPF5    PIC  X  VALUE  '5'.
   383   02  DFHPF6    PIC  X  VALUE  '6'.
   384   02  DFHPF7    PIC  X  VALUE  '7'.
   385   02  DFHPF8    PIC  X  VALUE  '8'.
   386   02  DFHPF9    PIC  X  VALUE  '9'.
   387   02  DFHPF10   PIC  X  VALUE  ':'.
   388   02  DFHPF11   PIC  X  VALUE  '#'.
   389   02  DFHPF12   PIC  X  VALUE  '@'.
   390   02  DFHPF13   PIC  X  VALUE  'A'.
   391   02  DFHPF14   PIC  X  VALUE  'B'.
   392   02  DFHPF15   PIC  X  VALUE  'C'.
   393   02  DFHPF16   PIC  X  VALUE  'D'.
   394   02  DFHPF17   PIC  X  VALUE  'E'.
   395   02  DFHPF18   PIC  X  VALUE  'F'.
   396   02  DFHPF19   PIC  X  VALUE  'G'.
   397   02  DFHPF20   PIC  X  VALUE  'H'.
   398   02  DFHPF21   PIC  X  VALUE  'I'.
   399*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   400   02  DFHPF22   PIC  X  VALUE  '['.
   401   02  DFHPF23   PIC  X  VALUE  '.'.
   402   02  DFHPF24   PIC  X  VALUE  '<'.
   403   02  DFHMSRE   PIC  X  VALUE  'X'.
   404   02  DFHSTRF   PIC  X  VALUE  'h'.
   405   02  DFHTRIG   PIC  X  VALUE  '"'.
   406 01  PF-AID REDEFINES DFHAID.
   407     05  FILLER                      PIC X(8).
   408     05  PF-VALUES  OCCURS 24        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  10
* EL151.cbl
   410*                                    COPY ELCINTF.
   411******************************************************************
   412*                                                                *
   413*                                                                *
   414*                            ELCINTF.                            *
   415*                            VMOD=2.017                          *
   416*                                                                *
   417*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   418*                                                                *
   419*       LENGTH = 1024                                            *
   420*                                                                *
   421******************************************************************
   422*                   C H A N G E   L O G
   423*
   424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   425*-----------------------------------------------------------------
   426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   427* EFFECTIVE    NUMBER
   428*-----------------------------------------------------------------
   429* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   430******************************************************************
   431 01  PROGRAM-INTERFACE-BLOCK.
   432     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   433     12  PI-CALLING-PROGRAM              PIC X(8).
   434     12  PI-SAVED-PROGRAM-1              PIC X(8).
   435     12  PI-SAVED-PROGRAM-2              PIC X(8).
   436     12  PI-SAVED-PROGRAM-3              PIC X(8).
   437     12  PI-SAVED-PROGRAM-4              PIC X(8).
   438     12  PI-SAVED-PROGRAM-5              PIC X(8).
   439     12  PI-SAVED-PROGRAM-6              PIC X(8).
   440     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   441     12  PI-COMPANY-ID                   PIC XXX.
   442     12  PI-COMPANY-CD                   PIC X.
   443
   444     12  PI-COMPANY-PASSWORD             PIC X(8).
   445
   446     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   447
   448     12  PI-CONTROL-IN-PROGRESS.
   449         16  PI-CARRIER                  PIC X.
   450         16  PI-GROUPING                 PIC X(6).
   451         16  PI-STATE                    PIC XX.
   452         16  PI-ACCOUNT                  PIC X(10).
   453         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   454                                         PIC X(10).
   455         16  PI-CLAIM-CERT-GRP.
   456             20  PI-CLAIM-NO             PIC X(7).
   457             20  PI-CERT-NO.
   458                 25  PI-CERT-PRIME       PIC X(10).
   459                 25  PI-CERT-SFX         PIC X.
   460             20  PI-CERT-EFF-DT          PIC XX.
   461         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   462             20  PI-PLAN-CODE            PIC X(2).
   463             20  PI-REVISION-NUMBER      PIC X(3).
   464             20  PI-PLAN-EFF-DT          PIC X(2).
   465             20  PI-PLAN-EXP-DT          PIC X(2).
   466             20  FILLER                  PIC X(11).
   467         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  11
* EL151.cbl
   468             20  PI-OE-REFERENCE-1.
   469                 25  PI-OE-REF-1-PRIME   PIC X(18).
   470                 25  PI-OE-REF-1-SUFF    PIC XX.
   471
   472     12  PI-SESSION-IN-PROGRESS          PIC X.
   473         88  CLAIM-SESSION                   VALUE '1'.
   474         88  CREDIT-SESSION                  VALUE '2'.
   475         88  WARRANTY-SESSION                VALUE '3'.
   476         88  MORTGAGE-SESSION                VALUE '4'.
   477         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   478
   479
   480*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   481
   482     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   483     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   484
   485     12  PI-CREDIT-USER                  PIC X.
   486         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   487         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   488
   489     12  PI-CLAIM-USER                   PIC X.
   490         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   491         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   492
   493     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   494         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   495         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   496         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   497         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   498         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   499
   500     12  PI-PROCESSOR-ID                 PIC X(4).
   501
   502     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   503
   504     12  PI-MEMBER-CAPTION               PIC X(10).
   505
   506     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   507         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   508
   509     12  PI-LIFE-OVERRIDE-L1             PIC X.
   510     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   511     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   512     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   513
   514     12  PI-AH-OVERRIDE-L1               PIC X.
   515     12  PI-AH-OVERRIDE-L2               PIC XX.
   516     12  PI-AH-OVERRIDE-L6               PIC X(6).
   517     12  PI-AH-OVERRIDE-L12              PIC X(12).
   518
   519     12  PI-NEW-SYSTEM                   PIC X(2).
   520
   521     12  PI-PRIMARY-CERT-NO              PIC X(11).
   522     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   523         88  PI-USES-PAID-TO                 VALUE '1'.
   524     12  PI-CRDTCRD-SYSTEM.
   525         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  12
* EL151.cbl
   526             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   527             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   528         16  PI-CC-MONTH-END-DT          PIC XX.
   529     12  PI-PROCESSOR-PRINTER            PIC X(4).
   530
   531     12  PI-OE-REFERENCE-2.
   532         16  PI-OE-REF-2-PRIME           PIC X(10).
   533         16  PI-OE-REF-2-SUFF            PIC X.
   534
   535     12  PI-REM-TRM-CALC-OPTION          PIC X.
   536
   537     12  PI-LANGUAGE-TYPE                PIC X.
   538             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   539             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   540             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   541
   542     12  PI-POLICY-LINKAGE-IND           PIC X.
   543         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   544         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   545                                                   LOW-VALUES.
   546
   547     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   548     12  PI-CLAIM-PW-SESSION             PIC X(1).
   549         88  PI-CLAIM-CREDIT                 VALUE '1'.
   550         88  PI-CLAIM-CONVEN                 VALUE '2'.
   551
   552     12  PI-PROCESSOR-CSR-IND            PIC X.
   553         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   554         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   555
   556     12  FILLER                          PIC X(3).
   557
   558     12  PI-SYSTEM-LEVEL                 PIC X(145).
   559
   560     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   561         PI-SYSTEM-LEVEL.
   562
   563         16  PI-ENTRY-CODES.
   564             20  PI-ENTRY-CD-1           PIC X.
   565             20  PI-ENTRY-CD-2           PIC X.
   566
   567         16  PI-RETURN-CODES.
   568             20  PI-RETURN-CD-1          PIC X.
   569             20  PI-RETURN-CD-2          PIC X.
   570
   571         16  PI-UPDATE-STATUS-SAVE.
   572             20  PI-UPDATE-BY            PIC X(4).
   573             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   574
   575         16  PI-LOWER-CASE-LETTERS       PIC X.
   576             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   577
   578*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   579*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   580*            88  CARRIER-CLM-CNTL            VALUE '2'.
   581
   582         16  PI-CERT-ACCESS-CONTROL      PIC X.
   583             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  13
* EL151.cbl
   584             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   585             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   586             88  ACCNT-CNTL                  VALUE '3'.
   587             88  CARR-ACCNT-CNTL             VALUE '4'.
   588
   589         16  PI-PROCESSOR-CAP-LIST.
   590             20  PI-SYSTEM-CONTROLS.
   591                24 PI-SYSTEM-DISPLAY     PIC X.
   592                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   593                24 PI-SYSTEM-MODIFY      PIC X.
   594                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   595             20  FILLER                  PIC XX.
   596             20  PI-DISPLAY-CAP          PIC X.
   597                 88  DISPLAY-CAP             VALUE 'Y'.
   598             20  PI-MODIFY-CAP           PIC X.
   599                 88  MODIFY-CAP              VALUE 'Y'.
   600             20  PI-MSG-AT-LOGON-CAP     PIC X.
   601                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   602             20  PI-FORCE-CAP            PIC X.
   603                 88  FORCE-CAP               VALUE 'Y'.
   604
   605         16  PI-PROGRAM-CONTROLS.
   606             20  PI-PGM-PRINT-OPT        PIC X.
   607             20  PI-PGM-FORMAT-OPT       PIC X.
   608             20  PI-PGM-PROCESS-OPT      PIC X.
   609             20  PI-PGM-TOTALS-OPT       PIC X.
   610
   611         16  PI-HELP-INTERFACE.
   612             20  PI-LAST-ERROR-NO        PIC X(4).
   613             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   614
   615         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   616             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   617
   618         16  PI-CR-CONTROL-IN-PROGRESS.
   619             20  PI-CR-CARRIER           PIC X.
   620             20  PI-CR-GROUPING          PIC X(6).
   621             20  PI-CR-STATE             PIC XX.
   622             20  PI-CR-ACCOUNT           PIC X(10).
   623             20  PI-CR-FIN-RESP          PIC X(10).
   624             20  PI-CR-TYPE              PIC X.
   625
   626         16  PI-CR-BATCH-NUMBER          PIC X(6).
   627
   628         16  PI-CR-MONTH-END-DT          PIC XX.
   629
   630         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   631             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   632             88  PI-ZERO-CARRIER             VALUE '1'.
   633             88  PI-ZERO-GROUPING            VALUE '2'.
   634             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   635
   636         16  PI-CARRIER-SECURITY         PIC X.
   637             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   638
   639         16  PI-ACCOUNT-SECURITY         PIC X(10).
   640             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   641             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  14
* EL151.cbl
   642
   643         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   644             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   645                                         INDEXED BY PI-ACCESS-NDX
   646                                         PIC X.
   647
   648         16  PI-GA-BILLING-CONTROL       PIC X.
   649             88  PI-GA-BILLING               VALUE '1'.
   650
   651         16  PI-MAIL-PROCESSING          PIC X.
   652             88  PI-MAIL-YES                 VALUE 'Y'.
   653
   654         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   655
   656         16  PI-AR-SYSTEM.
   657             20  PI-AR-PROCESSING-CNTL   PIC X.
   658                 88  PI-AR-PROCESSING        VALUE 'Y'.
   659             20  PI-AR-SUMMARY-CODE      PIC X(6).
   660             20  PI-AR-MONTH-END-DT      PIC XX.
   661
   662         16  PI-MP-SYSTEM.
   663             20  PI-MORTGAGE-USER            PIC X.
   664                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   665                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   666             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   667                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   668                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   669                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   670                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   671                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   672             20  PI-MP-MONTH-END-DT          PIC XX.
   673             20  PI-MP-REFERENCE-NO.
   674                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   675                 24  PI-MP-REFERENCE-SFX     PIC XX.
   676
   677         16  PI-LABEL-CONTROL            PIC X(01).
   678             88  PI-CREATE-LABELS                    VALUE 'Y'.
   679             88  PI-BYPASS-LABELS                    VALUE 'N'.
   680
   681         16  PI-BILL-GROUPING-CODE       PIC X(01).
   682             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   683
   684         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   685             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   686             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   687
   688         16  FILLER                      PIC X(14).
   689
   690     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   691******************************************************************
   692     12  PI-REDEFINES REDEFINES PI-PROGRAM-WORK-AREA.
   693         16  PI-PREV-TRLR-KEY        PIC X(22).
   694*00252          16  FILLER                  PIC X(618).
   695         16  PI-PROOF-DATE           PIC 9(6).
   696         16  FILLER                  PIC X(612).
   697
   698* DLO023
   699 01  DL23-COMM-LENGTH              PIC S9(4) COMP VALUE +132.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  15
* EL151.cbl
   700 01  WS-DLO-CODES-TABLE.
   701     12  DL23-SYSTEM-ID            PIC XX.
   702     12  DL23-RECORD-TYPE          PIC XX.
   703     12  DL23-RECORD-KEY           PIC X(6).
   704     12  DL23-RETURN-CODE          PIC XX.
   705     12  DL23-CODE-DESC.
   706         16  DL23-CODE-TEXT        PIC X(20).
   707         16  DL23-RET-CODE         PIC X(40).
   708     12  DL23-GEN-DESC-1           PIC X(20).
   709     12  DL23-GEN-DESC-2           PIC X(20).
   710     12  DL23-GEN-DESC-3           PIC X(20).
   711
   712 01  DMD-DATE-YYYYMMDD.
   713     12  DMD-DECADE          PIC XX      VALUE SPACES.
   714     12  DMD-YYMMDD.
   715         16  DMD-YY          PIC XX      VALUE SPACES.
   716         16  DMD-MM          PIC XX      VALUE SPACES.
   717         16  DMD-DD          PIC XX      VALUE SPACES.
   718
   719     12  W-NAME-LAST             PIC  X(15).
   720     12  W-NAME-FIRST            PIC  X(15).
   721     12  W-NAME-MIDDLE.
   722         16  FILLER              PIC  X(01).
   723         16  W-NAME-MIDDLE-2     PIC  X(01).
   724         16  FILLER              PIC  X(13).
   725
   726*                                    COPY ELCDCTB.
   727******************************************************************
   728*                                                                *
   729*                                                                *
   730*                            ELCDCTB.                            *
   731*                            VMOD=2.002                          *
   732*                                                                *
   733*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   734*       COMMUNICATIONS AREA                                      *
   735*                                                                *
   736******************************************************************
   737 01  DCT-COMMUNICATION-AREA.
   738     12  DCT-BILLING-BANK-ID      PIC  X(05).
   739     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   740     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   741     12  DCT-PRODUCT-CODE         PIC  X(02).
   742     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   743     12  DCT-RETURN-CODE          PIC  X(02).
   744     12  DCT-MAIL-CODE            PIC  X(05).
   745     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   746     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  16
* EL151.cbl
   748*                                    COPY ELCATTR.
   749******************************************************************
   750*                                                                *
   751*                            ELCATTR.                            *
   752*                            VMOD=2.001                          *
   753*                                                                *
   754*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   755*                                                                *
   756*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   757*                                                                *
   758*                   POS 1   P=PROTECTED                          *
   759*                           U=UNPROTECTED                        *
   760*                           S=ASKIP                              *
   761*                   POS 2   A=ALPHA/NUMERIC                      *
   762*                           N=NUMERIC                            *
   763*                   POS 3   N=NORMAL                             *
   764*                           B=BRIGHT                             *
   765*                           D=DARK                               *
   766*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   767*                           OF=MODIFIED DATA TAG OFF             *
   768*                                                                *
   769*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   770******************************************************************
   771 01  ATTRIBUTE-LIST.
   772     12  AL-PABOF            PIC X       VALUE 'Y'.
   773     12  AL-PABON            PIC X       VALUE 'Z'.
   774     12  AL-PADOF            PIC X       VALUE '%'.
   775     12  AL-PADON            PIC X       VALUE '_'.
   776     12  AL-PANOF            PIC X       VALUE '-'.
   777     12  AL-PANON            PIC X       VALUE '/'.
   778     12  AL-SABOF            PIC X       VALUE '8'.
   779     12  AL-SABON            PIC X       VALUE '9'.
   780     12  AL-SADOF            PIC X       VALUE '@'.
   781     12  AL-SADON            PIC X       VALUE QUOTE.
   782     12  AL-SANOF            PIC X       VALUE '0'.
   783     12  AL-SANON            PIC X       VALUE '1'.
   784     12  AL-UABOF            PIC X       VALUE 'H'.
   785     12  AL-UABON            PIC X       VALUE 'I'.
   786     12  AL-UADOF            PIC X       VALUE '<'.
   787     12  AL-UADON            PIC X       VALUE '('.
   788     12  AL-UANOF            PIC X       VALUE ' '.
   789     12  AL-UANON            PIC X       VALUE 'A'.
   790     12  AL-UNBOF            PIC X       VALUE 'Q'.
   791     12  AL-UNBON            PIC X       VALUE 'R'.
   792     12  AL-UNDOF            PIC X       VALUE '*'.
   793     12  AL-UNDON            PIC X       VALUE ')'.
   794     12  AL-UNNOF            PIC X       VALUE '&'.
   795     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  17
* EL151.cbl
   797*                                    COPY ELCLOGOF.
   798******************************************************************
   799*                                                                *
   800*                                                                *
   801*                            ELCLOGOF.                           *
   802*                            VMOD=2.001                          *
   803*                                                                *
   804*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   805*                                                                *
   806******************************************************************
   807 01  CLASIC-LOGOFF.
   808     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   809     12  LOGOFF-TEXT.
   810         16  FILLER          PIC X(5)    VALUE SPACES.
   811         16  LOGOFF-MSG.
   812             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   813             20  FILLER      PIC X       VALUE SPACES.
   814             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   815         16  FILLER          PIC X(80)
   816           VALUE '* YOU ARE NOW LOGGED OFF'.
   817         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   818         16  FILLER          PIC X       VALUE QUOTE.
   819         16  LOGOFF-SYS-MSG  PIC X(17)
   820           VALUE 'S CLAS-IC SYSTEM '.
   821     12  TEXT-MESSAGES.
   822         16  UNACCESS-MSG    PIC X(29)
   823             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   824         16  PGMIDERR-MSG    PIC X(17)
   825             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  18
* EL151.cbl
   827*                                    COPY ELCDATE.
   828******************************************************************
   829*                                                                *
   830*                                                                *
   831*                            ELCDATE.                            *
   832*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   833*                            VMOD=2.003
   834*                                                                *
   835*                                                                *
   836*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   837*                 LENGTH = 200                                   *
   838******************************************************************
   839
   840 01  DATE-CONVERSION-DATA.
   841     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   842     12  DC-OPTION-CODE                PIC X.
   843         88  BIN-TO-GREG                VALUE ' '.
   844         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   845         88  EDIT-GREG-TO-BIN           VALUE '2'.
   846         88  YMD-GREG-TO-BIN            VALUE '3'.
   847         88  MDY-GREG-TO-BIN            VALUE '4'.
   848         88  JULIAN-TO-BIN              VALUE '5'.
   849         88  BIN-PLUS-ELAPSED           VALUE '6'.
   850         88  FIND-CENTURY               VALUE '7'.
   851         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   852         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   853         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   854         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   855         88  JULIAN-TO-BIN-3            VALUE 'C'.
   856         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   857         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   858         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   859         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   860         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   861         88  CHECK-LEAP-YEAR            VALUE 'H'.
   862         88  BIN-3-TO-GREG              VALUE 'I'.
   863         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   864         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   865         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   866         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   867         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   868         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   869         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   870         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   871         88  THREE-CHARACTER-BIN
   872                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   873         88  GREGORIAN-TO-BIN
   874                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   875         88  BIN-TO-GREGORIAN
   876                  VALUES ' ' '1' 'I' '8' 'G'.
   877         88  JULIAN-TO-BINARY
   878                  VALUES '5' 'C' 'E' 'F'.
   879     12  DC-ERROR-CODE                 PIC X.
   880         88  NO-CONVERSION-ERROR        VALUE ' '.
   881         88  DATE-CONVERSION-ERROR
   882                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   883         88  DATE-IS-ZERO               VALUE '1'.
   884         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  19
* EL151.cbl
   885         88  DATE-IS-INVALID            VALUE '3'.
   886         88  DATE1-GREATER-DATE2        VALUE '4'.
   887         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   888         88  DATE-INVALID-OPTION        VALUE '9'.
   889         88  INVALID-CENTURY            VALUE 'A'.
   890         88  ONLY-CENTURY               VALUE 'B'.
   891         88  ONLY-LEAP-YEAR             VALUE 'C'.
   892         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   893     12  DC-END-OF-MONTH               PIC X.
   894         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   895     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   896         88  USE-NORMAL-PROCESS         VALUE ' '.
   897         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   898         88  ADJUST-UP-100-YRS          VALUE '2'.
   899     12  FILLER                        PIC X.
   900     12  DC-CONVERSION-DATES.
   901         16  DC-BIN-DATE-1             PIC XX.
   902         16  DC-BIN-DATE-2             PIC XX.
   903         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   904         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   905                       DC-GREG-DATE-1-EDIT.
   906             20  DC-EDIT1-MONTH        PIC 99.
   907             20  SLASH1-1              PIC X.
   908             20  DC-EDIT1-DAY          PIC 99.
   909             20  SLASH1-2              PIC X.
   910             20  DC-EDIT1-YEAR         PIC 99.
   911         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   912         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   913                     DC-GREG-DATE-2-EDIT.
   914             20  DC-EDIT2-MONTH        PIC 99.
   915             20  SLASH2-1              PIC X.
   916             20  DC-EDIT2-DAY          PIC 99.
   917             20  SLASH2-2              PIC X.
   918             20  DC-EDIT2-YEAR         PIC 99.
   919         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   920         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   921                     DC-GREG-DATE-1-YMD.
   922             20  DC-YMD-YEAR           PIC 99.
   923             20  DC-YMD-MONTH          PIC 99.
   924             20  DC-YMD-DAY            PIC 99.
   925         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   926         16  DC-GREG-DATE-1-MDY-R REDEFINES
   927                      DC-GREG-DATE-1-MDY.
   928             20  DC-MDY-MONTH          PIC 99.
   929             20  DC-MDY-DAY            PIC 99.
   930             20  DC-MDY-YEAR           PIC 99.
   931         16  DC-GREG-DATE-1-ALPHA.
   932             20  DC-ALPHA-MONTH        PIC X(10).
   933             20  DC-ALPHA-DAY          PIC 99.
   934             20  FILLER                PIC XX.
   935             20  DC-ALPHA-CENTURY.
   936                 24 DC-ALPHA-CEN-N     PIC 99.
   937             20  DC-ALPHA-YEAR         PIC 99.
   938         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   939         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   940         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   941         16  DC-JULIAN-DATE            PIC 9(05).
   942         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  20
* EL151.cbl
   943                                       PIC 9(05).
   944         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   945             20  DC-JULIAN-YEAR        PIC 99.
   946             20  DC-JULIAN-DAYS        PIC 999.
   947         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   948         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   949         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   950     12  DATE-CONVERSION-VARIBLES.
   951         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   952         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   953             20  FILLER                PIC 9(3).
   954             20  HOLD-CEN-1-CCYY.
   955                 24  HOLD-CEN-1-CC     PIC 99.
   956                 24  HOLD-CEN-1-YY     PIC 99.
   957             20  HOLD-CEN-1-MO         PIC 99.
   958             20  HOLD-CEN-1-DA         PIC 99.
   959         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   960             20  HOLD-CEN-1-R-MO       PIC 99.
   961             20  HOLD-CEN-1-R-DA       PIC 99.
   962             20  HOLD-CEN-1-R-CCYY.
   963                 24  HOLD-CEN-1-R-CC   PIC 99.
   964                 24  HOLD-CEN-1-R-YY   PIC 99.
   965             20  FILLER                PIC 9(3).
   966         16  HOLD-CENTURY-1-X.
   967             20  FILLER                PIC X(3)  VALUE SPACES.
   968             20  HOLD-CEN-1-X-CCYY.
   969                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   970                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   971             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   972             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   973         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   974             20  HOLD-CEN-1-R-X-MO     PIC XX.
   975             20  HOLD-CEN-1-R-X-DA     PIC XX.
   976             20  HOLD-CEN-1-R-X-CCYY.
   977                 24  HOLD-CEN-1-R-X-CC PIC XX.
   978                 24  HOLD-CEN-1-R-X-YY PIC XX.
   979             20  FILLER                PIC XXX.
   980         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   981         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   982         16  DC-JULIAN-DATE-1          PIC 9(07).
   983         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   984             20  DC-JULIAN-1-CCYY.
   985                 24  DC-JULIAN-1-CC    PIC 99.
   986                 24  DC-JULIAN-1-YR    PIC 99.
   987             20  DC-JULIAN-DA-1        PIC 999.
   988         16  DC-JULIAN-DATE-2          PIC 9(07).
   989         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   990             20  DC-JULIAN-2-CCYY.
   991                 24  DC-JULIAN-2-CC    PIC 99.
   992                 24  DC-JULIAN-2-YR    PIC 99.
   993             20  DC-JULIAN-DA-2        PIC 999.
   994         16  DC-GREG-DATE-A-EDIT.
   995             20  DC-EDITA-MONTH        PIC 99.
   996             20  SLASHA-1              PIC X VALUE '/'.
   997             20  DC-EDITA-DAY          PIC 99.
   998             20  SLASHA-2              PIC X VALUE '/'.
   999             20  DC-EDITA-CCYY.
  1000                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  21
* EL151.cbl
  1001                 24  DC-EDITA-YEAR     PIC 99.
  1002         16  DC-GREG-DATE-B-EDIT.
  1003             20  DC-EDITB-MONTH        PIC 99.
  1004             20  SLASHB-1              PIC X VALUE '/'.
  1005             20  DC-EDITB-DAY          PIC 99.
  1006             20  SLASHB-2              PIC X VALUE '/'.
  1007             20  DC-EDITB-CCYY.
  1008                 24  DC-EDITB-CENT     PIC 99.
  1009                 24  DC-EDITB-YEAR     PIC 99.
  1010         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1011         16  DC-GREG-DATE-CYMD-R REDEFINES
  1012                              DC-GREG-DATE-CYMD.
  1013             20  DC-CYMD-CEN           PIC 99.
  1014             20  DC-CYMD-YEAR          PIC 99.
  1015             20  DC-CYMD-MONTH         PIC 99.
  1016             20  DC-CYMD-DAY           PIC 99.
  1017         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1018         16  DC-GREG-DATE-MDCY-R REDEFINES
  1019                              DC-GREG-DATE-MDCY.
  1020             20  DC-MDCY-MONTH         PIC 99.
  1021             20  DC-MDCY-DAY           PIC 99.
  1022             20  DC-MDCY-CEN           PIC 99.
  1023             20  DC-MDCY-YEAR          PIC 99.
  1024    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1025        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1026    12  DC-EL310-DATE                  PIC X(21).
  1027    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  22
* EL151.cbl
  1029*                                    COPY ELCEMIB.
  1030******************************************************************
  1031*                                                                *
  1032*                                                                *
  1033*                            ELCEMIB.                            *
  1034*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1035*                            VMOD=2.005                          *
  1036*                                                                *
  1037*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1038*                                                                *
  1039******************************************************************
  1040 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1041     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1042     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1043     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1044     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1045     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1046     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1047     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1048     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1049     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1050         88  EMI-NO-ERRORS                    VALUE '1'.
  1051         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1052         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1053     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1054         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1055     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1056         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1057         88  EMI-AREA1-FULL                   VALUE '2'.
  1058     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1059         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1060         88  EMI-AREA2-FULL                   VALUE '2'.
  1061     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1062         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1063         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1064         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1065         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1066         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1067     12  EMI-ERROR-LINES.
  1068         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1069         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1070         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1071         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1072             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1073                 24  EMI-ERR-NUM         PIC X(4).
  1074                 24  EMI-FILLER          PIC X.
  1075                 24  EMI-SEV             PIC X.
  1076                 24  FILLER              PIC X.
  1077             20  FILLER                  PIC X(02).
  1078     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1079         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1080             20  EMI-ERROR-NUMBER    PIC X(4).
  1081             20  EMI-FILL            PIC X.
  1082             20  EMI-SEVERITY        PIC X.
  1083             20  FILLER              PIC X.
  1084             20  EMI-ERROR-TEXT.
  1085                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1086                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  23
* EL151.cbl
  1087     12  EMI-SEVERITY-SAVE           PIC X.
  1088         88  EMI-NOTE                    VALUE 'N'.
  1089         88  EMI-WARNING                 VALUE 'W'.
  1090         88  EMI-FORCABLE                VALUE 'F'.
  1091         88  EMI-FATAL                   VALUE 'X'.
  1092     12  EMI-MESSAGE-FLAG            PIC X.
  1093         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1094         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1095     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1096     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1097         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1098         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1099         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1100     12  emi-claim-no                pic x(7).
  1101     12  emi-claim-type              pic x(6).
  1102     12  FILLER                      PIC X(124)  VALUE SPACES.
  1103     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1104     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1105     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1106     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  24
* EL151.cbl
  1108*                                    COPY EL151S.
  1109 01  EL151AI.
  1110     05  FILLER            PIC  X(0012).
  1111*    -------------------------------
  1112     05  MRNDATEL PIC S9(0004) COMP.
  1113     05  MRNDATEF PIC  X(0001).
  1114     05  FILLER REDEFINES MRNDATEF.
  1115         10  MRNDATEA PIC  X(0001).
  1116     05  MRNDATEI PIC  X(0008).
  1117*    -------------------------------
  1118     05  MRNTIMEL PIC S9(0004) COMP.
  1119     05  MRNTIMEF PIC  X(0001).
  1120     05  FILLER REDEFINES MRNTIMEF.
  1121         10  MRNTIMEA PIC  X(0001).
  1122     05  MRNTIMEI PIC  X(0005).
  1123*    -------------------------------
  1124     05  MLINE1L PIC S9(0004) COMP.
  1125     05  MLINE1F PIC  X(0001).
  1126     05  FILLER REDEFINES MLINE1F.
  1127         10  MLINE1A PIC  X(0001).
  1128     05  MLINE1I PIC  X(0060).
  1129*    -------------------------------
  1130     05  MLINE2L PIC S9(0004) COMP.
  1131     05  MLINE2F PIC  X(0001).
  1132     05  FILLER REDEFINES MLINE2F.
  1133         10  MLINE2A PIC  X(0001).
  1134     05  MLINE2I PIC  X(0060).
  1135*    -------------------------------
  1136     05  MDENCDL PIC S9(0004) COMP.
  1137     05  MDENCDF PIC  X(0001).
  1138     05  FILLER REDEFINES MDENCDF.
  1139         10  MDENCDA PIC  X(0001).
  1140     05  MDENCDI PIC  X(0004).
  1141*    -------------------------------
  1142     05  MPRFDTL PIC S9(0004) COMP.
  1143     05  MPRFDTF PIC  X(0001).
  1144     05  FILLER REDEFINES MPRFDTF.
  1145         10  MPRFDTA PIC  X(0001).
  1146     05  MPRFDTI PIC  X(0008).
  1147*    -------------------------------
  1148     05  MERMSG1L PIC S9(0004) COMP.
  1149     05  MERMSG1F PIC  X(0001).
  1150     05  FILLER REDEFINES MERMSG1F.
  1151         10  MERMSG1A PIC  X(0001).
  1152     05  MERMSG1I PIC  X(0070).
  1153*    -------------------------------
  1154     05  MERMSG2L PIC S9(0004) COMP.
  1155     05  MERMSG2F PIC  X(0001).
  1156     05  FILLER REDEFINES MERMSG2F.
  1157         10  MERMSG2A PIC  X(0001).
  1158     05  MERMSG2I PIC  X(0070).
  1159*    -------------------------------
  1160     05  MPFNUMBL PIC S9(0004) COMP.
  1161     05  MPFNUMBF PIC  X(0001).
  1162     05  FILLER REDEFINES MPFNUMBF.
  1163         10  MPFNUMBA PIC  X(0001).
  1164     05  MPFNUMBI PIC  99.
  1165 01  EL151AO REDEFINES EL151AI.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  25
* EL151.cbl
  1166     05  FILLER            PIC  X(0012).
  1167*    -------------------------------
  1168     05  FILLER            PIC  X(0003).
  1169     05  MRNDATEO PIC  X(0008).
  1170*    -------------------------------
  1171     05  FILLER            PIC  X(0003).
  1172     05  MRNTIMEO PIC  99.99.
  1173*    -------------------------------
  1174     05  FILLER            PIC  X(0003).
  1175     05  MLINE1O PIC  X(0060).
  1176*    -------------------------------
  1177     05  FILLER            PIC  X(0003).
  1178     05  MLINE2O PIC  X(0060).
  1179*    -------------------------------
  1180     05  FILLER            PIC  X(0003).
  1181     05  MDENCDO PIC  X(0004).
  1182*    -------------------------------
  1183     05  FILLER            PIC  X(0003).
  1184     05  MPRFDTO PIC  99B99B99.
  1185*    -------------------------------
  1186     05  FILLER            PIC  X(0003).
  1187     05  MERMSG1O PIC  X(0070).
  1188*    -------------------------------
  1189     05  FILLER            PIC  X(0003).
  1190     05  MERMSG2O PIC  X(0070).
  1191*    -------------------------------
  1192     05  FILLER            PIC  X(0003).
  1193     05  MPFNUMBO PIC  99.
  1194*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  26
* EL151.cbl
  1196*                                    COPY ELCDMO.
  1197******************************************************************
  1198*                                                                *
  1199*                                                                *
  1200*                            ELCDMO.                             *
  1201*                            VMOD=2.004                          *
  1202*                                                                *
  1203*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  1204*        COMMUNICATION AREA                                      *
  1205*   FILE TYPE = NA                                               *
  1206*   RECORD SIZE = 110    RECFORM = FIXED                         *
  1207*                                                                *
  1208******************************************************************
  1209 01  DMO-COMMUNICATION-AREA.
  1210     12  DM-RECORD-TYPE                  PIC  X(02).
  1211             88  DM-ISSUE-TRAN                VALUE 'CC'.
  1212             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  1213             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  1214     12  DM-DIST-CODE                    PIC  X(04).
  1215     12  DM-MAIL-CODE                    PIC  X(05).
  1216     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  1217     12  DM-INSURED-NAME                 PIC  X(30).
  1218     12  DM-CLAIM-NO                     PIC  X(07).
  1219     12  DM-CLAIM-TYPE                   PIC  X.
  1220
  1221     12  DM-STATUS-DATA-AREA.
  1222         16  DM-CLAIM-STATUS             PIC  X.
  1223             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  1224             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  1225             88  DM-CLOSED                        VALUE '3'.
  1226             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  1227             88  DM-DEFAULT                       VALUE '9'.
  1228         16  DM-STATUS-DATE              PIC  X(08).
  1229******YYYYMMDD
  1230         16  DM-STAT-CHANGE-TYPE         PIC  X.
  1231             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  1232             88  DM-CLAIM-DENIED                  VALUE 'D'.
  1233             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  1234             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  1235             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  1236             88  DM-RE-OPENED                     VALUE 'R'.
  1237             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  1238             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  1239             88  DM-CLAIM-DELETED                 VALUE 'X'.
  1240         16  DM-STAT-CARRIER             PIC X.
  1241
  1242     12  DM-DRAFT-DATA-AREA.
  1243         16  DM-PAYMENT-TYPE             PIC  X.
  1244             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  1245         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  1246         16  DM-PAYMENT-DATE             PIC  X(08).
  1247******YYYYMMDD
  1248         16  DM-CERT-NO                  PIC  X(11).
  1249         16  DM-TRLR-SEQ-NO              PIC  9(04).
  1250         16  DM-CARRIER                  PIC  X.
  1251
  1252     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  27
* EL151.cbl
  1254****************************************************************
  1255*
  1256* Copyright (c) 2007-2013 Dell Inc.
  1257* All rights reserved.
  1258*
  1259****************************************************************
  1260 01  DFHEIV.
  1261   02  DFHEIV0               PIC X(35).
  1262   02  DFHEIV1               PIC X(08).
  1263   02  DFHEIV2               PIC X(08).
  1264   02  DFHEIV3               PIC X(08).
  1265   02  DFHEIV4               PIC X(06).
  1266   02  DFHEIV5               PIC X(04).
  1267   02  DFHEIV6               PIC X(04).
  1268   02  DFHEIV7               PIC X(02).
  1269   02  DFHEIV8               PIC X(02).
  1270   02  DFHEIV9               PIC X(01).
  1271   02  DFHEIV10              PIC S9(7) COMP-3.
  1272   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1273   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1274   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1275   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1276   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1277   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1278   02  DFHEIV17              PIC X(04).
  1279   02  DFHEIV18              PIC X(04).
  1280   02  DFHEIV19              PIC X(04).
  1281   02  DFHEIV20              USAGE IS POINTER.
  1282   02  DFHEIV21              USAGE IS POINTER.
  1283   02  DFHEIV22              USAGE IS POINTER.
  1284   02  DFHEIV23              USAGE IS POINTER.
  1285   02  DFHEIV24              USAGE IS POINTER.
  1286   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1287   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1288   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1289   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1290   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1291   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1292   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1293   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1294   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1295   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1296   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1297   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1298   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1299   02  FILLER                PIC X(02).
  1300   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1301   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1302   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1303   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1304   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1305   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1306   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1307 LINKAGE  SECTION.
  1308*****************************************************************
  1309*                                                               *
  1310* Copyright (c) 2007-2013 Dell Inc.                             *
  1311* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  28
* EL151.cbl
  1312*                                                               *
  1313*****************************************************************
  1314 01  dfheiblk.
  1315     02  eibtime          pic s9(7) comp-3.
  1316     02  eibdate          pic s9(7) comp-3.
  1317     02  eibtrnid         pic x(4).
  1318     02  eibtaskn         pic s9(7) comp-3.
  1319     02  eibtrmid         pic x(4).
  1320     02  dfheigdi         pic s9(4) comp.
  1321     02  eibcposn         pic s9(4) comp.
  1322     02  eibcalen         pic s9(4) comp.
  1323     02  eibaid           pic x(1).
  1324     02  eibfiller1       pic x(1).
  1325     02  eibfn            pic x(2).
  1326     02  eibfiller2       pic x(2).
  1327     02  eibrcode         pic x(6).
  1328     02  eibfiller3       pic x(2).
  1329     02  eibds            pic x(8).
  1330     02  eibreqid         pic x(8).
  1331     02  eibrsrce         pic x(8).
  1332     02  eibsync          pic x(1).
  1333     02  eibfree          pic x(1).
  1334     02  eibrecv          pic x(1).
  1335     02  eibsend          pic x(1).
  1336     02  eibatt           pic x(1).
  1337     02  eibeoc           pic x(1).
  1338     02  eibfmh           pic x(1).
  1339     02  eibcompl         pic x(1).
  1340     02  eibsig           pic x(1).
  1341     02  eibconf          pic x(1).
  1342     02  eiberr           pic x(1).
  1343     02  eibrldbk         pic x(1).
  1344     02  eiberrcd         pic x(4).
  1345     02  eibsynrb         pic x(1).
  1346     02  eibnodat         pic x(1).
  1347     02  eibfiller5       pic x(2).
  1348     02  eibresp          pic s9(8) comp.
  1349     02  eibresp2         pic s9(8) comp.
  1350     02  dfheigdj         pic s9(4) comp.
  1351     02  dfheigdk         pic s9(4) comp.
  1352 01  DFHCOMMAREA                     PICTURE X(1024).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  29
* EL151.cbl
  1354*                                    COPY ELCMSTR.
  1355******************************************************************
  1356*                                                                *
  1357*                            ELCMSTR.                            *
  1358*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1359*                            VMOD=2.012                          *
  1360*                                                                *
  1361*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1362*                                                                *
  1363*   FILE TYPE = VSAM,KSDS                                        *
  1364*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1365*                                                                *
  1366*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1367*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1368*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1369*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1370*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1371*                                                 RKP=75,LEN=21  *
  1372*                                                                *
  1373*   **** NOTE ****                                               *
  1374*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1375*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1376*                                                                *
  1377*   LOG = YES                                                    *
  1378*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1379******************************************************************
  1380*                   C H A N G E   L O G
  1381*
  1382* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1383*-----------------------------------------------------------------
  1384*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1385* EFFECTIVE    NUMBER
  1386*-----------------------------------------------------------------
  1387* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1388* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1389* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1390* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1391* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1392* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  1393* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1394******************************************************************
  1395 01  CLAIM-MASTER.
  1396     12  CL-RECORD-ID                PIC XX.
  1397         88  VALID-CL-ID         VALUE 'CL'.
  1398
  1399     12  CL-CONTROL-PRIMARY.
  1400         16  CL-COMPANY-CD           PIC X.
  1401         16  CL-CARRIER              PIC X.
  1402         16  CL-CLAIM-NO             PIC X(7).
  1403         16  CL-CERT-NO.
  1404             20  CL-CERT-PRIME       PIC X(10).
  1405             20  CL-CERT-SFX         PIC X.
  1406
  1407     12  CL-CONTROL-BY-NAME.
  1408         16  CL-COMPANY-CD-A1        PIC X.
  1409         16  CL-INSURED-LAST-NAME    PIC X(15).
  1410         16  CL-INSURED-NAME.
  1411             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  30
* EL151.cbl
  1412             20  CL-INSURED-MID-INIT PIC X.
  1413
  1414     12  CL-CONTROL-BY-SSN.
  1415         16  CL-COMPANY-CD-A2        PIC X.
  1416         16  CL-SOC-SEC-NO.
  1417             20  CL-SSN-STATE        PIC XX.
  1418             20  CL-SSN-ACCOUNT      PIC X(6).
  1419             20  CL-SSN-LN3          PIC X(3).
  1420
  1421     12  CL-CONTROL-BY-CERT-NO.
  1422         16  CL-COMPANY-CD-A4        PIC X.
  1423         16  CL-CERT-NO-A4.
  1424             20  CL-CERT-A4-PRIME    PIC X(10).
  1425             20  CL-CERT-A4-SFX      PIC X.
  1426
  1427     12  CL-CONTROL-BY-CCN.
  1428         16  CL-COMPANY-CD-A5        PIC X.
  1429         16  CL-CCN-A5.
  1430             20  CL-CCN.
  1431                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1432                 24  CL-CCN-PRIME-A5 PIC X(12).
  1433             20  CL-CCN-FILLER-A5    PIC X(4).
  1434
  1435     12  CL-INSURED-PROFILE-DATA.
  1436         16  CL-INSURED-BIRTH-DT     PIC XX.
  1437         16  CL-INSURED-SEX-CD       PIC X.
  1438             88  INSURED-IS-MALE        VALUE 'M'.
  1439             88  INSURED-IS-FEMALE      VALUE 'F'.
  1440             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1441         16  CL-INSURED-OCC-CD       PIC X(6).
  1442         16  FILLER                  PIC X(5).
  1443
  1444     12  CL-PROCESSING-INFO.
  1445         16  CL-PROCESSOR-ID         PIC X(4).
  1446         16  CL-CLAIM-STATUS         PIC X.
  1447             88  CLAIM-IS-OPEN          VALUE 'O'.
  1448             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1449         16  CL-CLAIM-TYPE           PIC X.
  1450*            88  AH-CLAIM               VALUE 'A'.
  1451*            88  LIFE-CLAIM             VALUE 'L'.
  1452*            88  PROPERTY-CLAIM         VALUE 'P'.
  1453*            88  IUI-CLAIM              VALUE 'I'.
  1454*            88  GAP-CLAIM              VALUE 'G'.
  1455*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  1456*            88  OTHER-CLAIM            VALUE 'O'.
  1457         16  CL-CLAIM-PREM-TYPE      PIC X.
  1458             88  SINGLE-PREMIUM         VALUE '1'.
  1459             88  O-B-COVERAGE           VALUE '2'.
  1460             88  OPEN-END-COVERAGE      VALUE '3'.
  1461         16  CL-INCURRED-DT          PIC XX.
  1462         16  CL-REPORTED-DT          PIC XX.
  1463         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1464         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1465         16  CL-LAST-PMT-DT          PIC XX.
  1466         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1467         16  CL-PAID-THRU-DT         PIC XX.
  1468         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1469         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  31
* EL151.cbl
  1470         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1471         16  CL-PMT-CALC-METHOD      PIC X.
  1472             88  CL-360-DAY-YR          VALUE '1'.
  1473             88  CL-365-DAY-YR          VALUE '2'.
  1474             88  CL-FULL-MONTHS         VALUE '3'.
  1475         16  CL-CAUSE-CD             PIC X(6).
  1476
  1477         16  CL-PRIME-CERT-NO.
  1478             20  CL-PRIME-CERT-PRIME PIC X(10).
  1479             20  CL-PRIME-CERT-SFX   PIC X.
  1480
  1481         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1482             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1483             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1484
  1485         16  CL-MICROFILM-NO         PIC X(10).
  1486         16  FILLER REDEFINES CL-MICROFILM-NO.
  1487             20  CL-BENEFIT-PERIOD   PIC 99.
  1488             20  FILLER              PIC X(8).
  1489         16  CL-PROG-FORM-TYPE       PIC X.
  1490         16  CL-LAST-ADD-ON-DT       PIC XX.
  1491
  1492         16  CL-LAST-REOPEN-DT       PIC XX.
  1493         16  CL-LAST-CLOSE-DT        PIC XX.
  1494         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1495             88  FINAL-PAID             VALUE '1'.
  1496             88  CLAIM-DENIED           VALUE '2'.
  1497             88  AUTO-CLOSE             VALUE '3'.
  1498             88  MANUAL-CLOSE           VALUE '4'.
  1499             88  BENEFITS-CHANGED       VALUE 'C'.
  1500             88  SETUP-ERRORS           VALUE 'E'.
  1501         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1502         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1503         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1504             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1505         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1506         16  FILLER                  PIC X.
  1507
  1508     12  CL-CERTIFICATE-DATA.
  1509         16  CL-CERT-ORIGIN          PIC X.
  1510             88  CERT-WAS-ONLINE        VALUE '1'.
  1511             88  CERT-WAS-CREATED       VALUE '2'.
  1512             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1513         16  CL-CERT-KEY-DATA.
  1514             20  CL-CERT-CARRIER     PIC X.
  1515             20  CL-CERT-GROUPING    PIC X(6).
  1516             20  CL-CERT-STATE       PIC XX.
  1517             20  CL-CERT-ACCOUNT.
  1518                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1519                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1520             20  CL-CERT-EFF-DT      PIC XX.
  1521
  1522     12  CL-STATUS-CONTROLS.
  1523         16  CL-PRIORITY-CD          PIC X.
  1524             88  CONFIDENTIAL-DATA      VALUE '8'.
  1525             88  HIGHEST-PRIORITY       VALUE '9'.
  1526         16  CL-SUPV-ATTN-CD         PIC X.
  1527             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  32
* EL151.cbl
  1528             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1529         16  CL-PURGED-DT            PIC XX.
  1530         16  CL-RESTORED-DT          PIC XX.
  1531         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1532         16  CL-NEXT-RESEND-DT       PIC XX.
  1533         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1534         16  CL-CRITICAL-PERIOD      PIC 99.
  1535*        16  FILLER                  PIC XX.
  1536         16  CL-LAST-MAINT-DT        PIC XX.
  1537         16  CL-LAST-MAINT-USER      PIC X(4).
  1538         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1539         16  CL-LAST-MAINT-TYPE      PIC X.
  1540             88  CLAIM-SET-UP           VALUE ' '.
  1541             88  PAYMENT-MADE           VALUE '1'.
  1542             88  LETTER-SENT            VALUE '2'.
  1543             88  MASTER-WAS-ALTERED     VALUE '3'.
  1544             88  MASTER-WAS-RESTORED    VALUE '4'.
  1545             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1546             88  FILE-CONVERTED         VALUE '6'.
  1547             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1548             88  ERROR-CORRECTION       VALUE 'E'.
  1549         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1550         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1551         16  CL-BENEFICIARY          PIC X(10).
  1552         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1553         16  CL-DENIAL-TYPE          PIC X.
  1554             88  CL-TYPE-DENIAL          VALUE '1'.
  1555             88  CL-TYPE-RESCISSION      VALUE '2'.
  1556             88  CL-TYPE-REFORMATION     VALUE '3'.
  1557             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1558             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1559         16  CL-NO-OF-EXTENSIONS     PIC 99.
  1560         16  filler                  pic x(3).
  1561*        16  CL-CRIT-PER-RECURRENT   PIC X.
  1562*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1563*        16  CL-RTW-DT               PIC XX.
  1564
  1565     12  CL-TRAILER-CONTROLS.
  1566         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1567             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1568             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1569             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1570         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1571         16  FILLER                  PIC XX.
  1572         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1573         16  CL-ADDRESS-TRAILER-CNT.
  1574             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1575                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1576             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1577                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1578             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1579                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1580             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1581                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1582             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1583                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1584             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1585                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  33
* EL151.cbl
  1586             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1587                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1588
  1589     12  CL-CV-REFERENCE-NO.
  1590         16  CL-CV-REFNO-PRIME       PIC X(18).
  1591         16  CL-CV-REFNO-SFX         PIC XX.
  1592
  1593     12  CL-FILE-LOCATION            PIC X(4).
  1594
  1595     12  CL-PROCESS-ERRORS.
  1596         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1597             88  NO-FATAL-ERRORS        VALUE ZERO.
  1598         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1599             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1600
  1601     12  CL-PRODUCT-CD               PIC X.
  1602
  1603     12  CL-CURRENT-KEY-DATA.
  1604         16  CL-CURRENT-CARRIER      PIC X.
  1605         16  CL-CURRENT-GROUPING     PIC X(6).
  1606         16  CL-CURRENT-STATE        PIC XX.
  1607         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1608
  1609     12  CL-ASSOCIATES               PIC X.
  1610         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1611         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1612         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1613         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1614
  1615     12  CL-ACTIVITY-CODE            PIC 99.
  1616     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1617     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1618
  1619     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1620     12  CL-LAG-REPORT-CODE          PIC 9.
  1621     12  CL-LOAN-TYPE                PIC XX.
  1622     12  CL-LEGAL-STATE              PIC XX.
  1623
  1624     12  CL-YESNOSW                  PIC X.
  1625     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  1626         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  1627         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  1628         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  1629     12  cl-insured-type             pic x.
  1630         88  cl-claim-on-primary         value 'P'.
  1631         88  cl-claim-on-co-borrower     value 'C'.
  1632     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  34
* EL151.cbl
  1634*                                    COPY ELCTRLR.
  1635******************************************************************
  1636*                                                                *
  1637*                            ELCTRLR.                            *
  1638*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1639*                            VMOD=2.014                          *
  1640*                                                                *
  1641*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  1642*                                                                *
  1643*   FILE TYPE = VSAM,KSDS                                        *
  1644*   RECORD SIZE = 200    RECFORM = FIXED                         *
  1645*                                                                *
  1646*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  1647*       ALTERNATE INDEX = NONE                                   *
  1648*                                                                *
  1649*   LOG = YES                                                    *
  1650*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1651******************************************************************
  1652*                   C H A N G E   L O G
  1653*
  1654* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1655*-----------------------------------------------------------------
  1656*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1657* EFFECTIVE    NUMBER
  1658*-----------------------------------------------------------------
  1659* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1660* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  1661* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  1662* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  1663* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  1664* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  1665* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  1666* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  1667* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  1668* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  1669* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  1670* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  1671* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  1672* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  1673* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  1674* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1675* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  1676* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  1677* 040814    2014030500002  AJRA  ADD ICD CODES
  1678* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1679* 013017  CR2016053100001  PEMA  ACH PROCESSING
  1680* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  1681* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1682* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  1683******************************************************************
  1684 01  ACTIVITY-TRAILERS.
  1685     12  AT-RECORD-ID                    PIC XX.
  1686         88  VALID-AT-ID                       VALUE 'AT'.
  1687
  1688     12  AT-CONTROL-PRIMARY.
  1689         16  AT-COMPANY-CD               PIC X.
  1690         16  AT-CARRIER                  PIC X.
  1691         16  AT-CLAIM-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  35
* EL151.cbl
  1692         16  AT-CERT-NO.
  1693             20  AT-CERT-PRIME           PIC X(10).
  1694             20  AT-CERT-SFX             PIC X.
  1695         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  1696             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  1697             88  AT-LAST-TRL-AVAIL            VALUE +100.
  1698             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  1699             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  1700             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  1701             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  1702             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  1703             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  1704             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  1705             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  1706             88  AT-DIAGNOSIS-TRL             VALUE +90.
  1707             88  AT-BENEFICIARY-TRL           VALUE +91.
  1708             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  1709             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  1710             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  1711             88  AT-ERROR-MSGS-TRL            VALUE +95.
  1712
  1713     12  AT-TRAILER-TYPE                 PIC X.
  1714         88  RESERVE-EXPENSE-TR               VALUE '1'.
  1715         88  PAYMENT-TR                       VALUE '2'.
  1716         88  AUTO-PAY-TR                      VALUE '3'.
  1717         88  CORRESPONDENCE-TR                VALUE '4'.
  1718         88  ADDRESS-TR                       VALUE '5'.
  1719         88  GENERAL-INFO-TR                  VALUE '6'.
  1720         88  AUTO-PROMPT-TR                   VALUE '7'.
  1721         88  DENIAL-TR                        VALUE '8'.
  1722         88  INCURRED-CHG-TR                  VALUE '9'.
  1723         88  FORM-CONTROL-TR                  VALUE 'A'.
  1724
  1725     12  AT-RECORDED-DT                  PIC XX.
  1726     12  AT-RECORDED-BY                  PIC X(4).
  1727     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  1728
  1729     12  AT-TRAILER-BODY                 PIC X(165).
  1730
  1731     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  1732         16  AT-RESERVE-CONTROLS.
  1733             20  AT-MANUAL-SW            PIC X.
  1734                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  1735             20  AT-FUTURE-SW            PIC X.
  1736                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  1737             20  AT-PTC-SW               PIC X.
  1738                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  1739             20  AT-IBNR-SW              PIC X.
  1740                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  1741             20  AT-PTC-LF-SW            PIC X.
  1742                 88  AT-LF-PTC-USED          VALUE '1'.
  1743             20  AT-CDT-ACCESS-METHOD    PIC X.
  1744                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  1745                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  1746                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  1747             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  1748         16  AT-LAST-COMPUTED-DT         PIC XX.
  1749         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  36
* EL151.cbl
  1750         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  1751         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  1752         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1753         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1754         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  1755         16  AT-EXPENSE-CONTROLS.
  1756             20  AT-EXPENSE-METHOD       PIC X.
  1757                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  1758                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  1759                 88  PERCENT-OF-PMT           VALUE '3'.
  1760                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  1761             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  1762             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  1763         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  1764         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  1765
  1766         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  1767         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  1768
  1769*        16  FILLER                      PIC X(53).
  1770         16  FILLER                      PIC X(47).
  1771
  1772         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  1773         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  1774
  1775         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  1776             20  AT-OPEN-CLOSE-DATE      PIC XX.
  1777             20  AT-OPEN-CLOSE-TYPE      PIC X.
  1778*                    C = CLOSED
  1779*                    O = OPEN
  1780             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  1781*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  1782
  1783     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  1784         16  AT-PAYMENT-TYPE             PIC X.
  1785             88  PARTIAL-PAYMENT                VALUE '1'.
  1786             88  FINAL-PAYMENT                  VALUE '2'.
  1787             88  LUMP-SUM-PAYMENT               VALUE '3'.
  1788             88  ADDITIONAL-PAYMENT             VALUE '4'.
  1789             88  CHARGEABLE-EXPENSE             VALUE '5'.
  1790             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  1791             88  VOIDED-PAYMENT                 VALUE '9'.
  1792             88  TRANSFER                       VALUE 'T'.
  1793             88  LIFE-INTEREST                  VALUE 'I'.
  1794
  1795         16  AT-CLAIM-TYPE               PIC X.
  1796             88  PAID-FOR-AH                    VALUE 'A'.
  1797             88  PAID-FOR-LIFE                  VALUE 'L'.
  1798             88  PAID-FOR-IUI                   VALUE 'I'.
  1799             88  PAID-FOR-GAP                   VALUE 'G'.
  1800             88  PAID-FOR-FAM                   VALUE 'F'.
  1801             88  PAID-FOR-OTH                   VALUE 'O'.
  1802         16  AT-CLAIM-PREM-TYPE          PIC X.
  1803             88  AT-SINGLE-PREMIUM              VALUE '1'.
  1804             88  AT-O-B-COVERAGE                VALUE '2'.
  1805             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  1806         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  1807         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  37
* EL151.cbl
  1808         16  AT-PAID-FROM-DT             PIC XX.
  1809         16  AT-PAID-THRU-DT             PIC XX.
  1810         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  1811         16  AT-ACH-PAYMENT              PIC X.
  1812*        16  FILLER                      PIC X.
  1813         16  AT-PAYEES-NAME              PIC X(30).
  1814         16  AT-PAYMENT-ORIGIN           PIC X.
  1815             88  ONLINE-MANUAL-PMT              VALUE '1'.
  1816             88  ONLINE-AUTO-PMT                VALUE '2'.
  1817             88  OFFLINE-PMT                    VALUE '3'.
  1818         16  AT-CHECK-WRITTEN-DT         PIC XX.
  1819         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  1820         16  AT-VOID-DATA.
  1821             20  AT-VOID-DT              PIC XX.
  1822*00144       20  AT-VOID-REASON          PIC X(30).
  1823             20  AT-VOID-REASON          PIC X(26).
  1824         16  AT-PMT-APPROVED-BY          PIC X(04).
  1825         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  1826         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  1827         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  1828                                         PIC S99V9(5)  COMP-3.
  1829         16  AT-CREDIT-INTERFACE.
  1830             20  AT-PMT-SELECT-DT        PIC XX.
  1831                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  1832             20  AT-PMT-ACCEPT-DT        PIC XX.
  1833                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  1834             20  AT-VOID-SELECT-DT       PIC XX.
  1835                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  1836             20  AT-VOID-ACCEPT-DT       PIC XX.
  1837                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  1838
  1839         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  1840                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  1841                 88  CONVERSION-PAYMENT           VALUE +99999999.
  1842         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  1843
  1844         16  AT-FORCE-CONTROL            PIC X.
  1845             88  PAYMENT-WAS-FORCED           VALUE '1'.
  1846         16  AT-PREV-LAST-PMT-DT         PIC XX.
  1847         16  AT-PREV-PAID-THRU-DT        PIC XX.
  1848         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1849         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  1850         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  1851         16  AT-BENEFIT-TYPE             PIC X.
  1852
  1853         16  AT-EXPENSE-TYPE             PIC X.
  1854         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  1855
  1856         16  AT-PAYEE-TYPE-CD.
  1857             20  AT-PAYEE-TYPE           PIC X.
  1858                 88  INSURED-PAID           VALUE 'I'.
  1859                 88  BENEFICIARY-PAID       VALUE 'B'.
  1860                 88  ACCOUNT-PAID           VALUE 'A'.
  1861                 88  OTHER-1-PAID           VALUE 'O'.
  1862                 88  OTHER-2-PAID           VALUE 'Q'.
  1863                 88  DOCTOR-PAID            VALUE 'P'.
  1864                 88  EMPLOYER-PAID          VALUE 'E'.
  1865             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  38
* EL151.cbl
  1866
  1867         16  AT-CASH-PAYMENT             PIC X.
  1868         16  AT-GROUPED-PAYMENT          PIC X.
  1869         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  1870         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  1871         16  AT-APPROVED-LEVEL           PIC X.
  1872         16  AT-VOID-TYPE                PIC X.
  1873             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  1874             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  1875         16  AT-AIG-UNEMP-IND            PIC X.
  1876             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  1877         16  AT-ASSOCIATES               PIC X.
  1878             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  1879             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  1880
  1881         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  1882         16  AT-CV-PMT-CODE              PIC X.
  1883             88  FULL-DEATH-PAYMENT         VALUE '1'.
  1884             88  HALF-DEATH-PAYMENT         VALUE '2'.
  1885             88  FULL-ADD-PAYMENT           VALUE '3'.
  1886             88  HALF-ADD-PAYMENT           VALUE '4'.
  1887             88  FULL-RIDER-PAYMENT         VALUE '5'.
  1888             88  HALF-RIDER-PAYMENT         VALUE '6'.
  1889             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  1890             88  ADDL-PAYMENT               VALUE '8'.
  1891
  1892         16  AT-EOB-CODE1                PIC XXX.
  1893         16  AT-EOB-CODE2                PIC XXX.
  1894         16  AT-EOB-CODE3                PIC XXX.
  1895         16  FILLER REDEFINES AT-EOB-CODE3.
  1896             20  AT-PRINT-CLM-FORM       PIC X.
  1897             20  AT-PRINT-SURVEY         PIC X.
  1898             20  AT-SPECIAL-RELEASE      PIC X.
  1899         16  AT-EOB-CODE4                PIC XXX.
  1900         16  FILLER REDEFINES AT-EOB-CODE4.
  1901             20  AT-INT-PMT-SELECT-DT    PIC XX.
  1902             20  FILLER                  PIC X.
  1903         16  AT-EOB-CODE5                PIC XXX.
  1904         16  FILLER REDEFINES AT-EOB-CODE5.
  1905             20  AT-PMT-PROOF-DT         PIC XX.
  1906             20  FILLER                  PIC X.
  1907
  1908         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  1909             88  AT-PRINT-EOB            VALUE 'Y'.
  1910
  1911         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  1912         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  1913
  1914     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  1915         16  AT-SCHEDULE-START-DT        PIC XX.
  1916         16  AT-SCHEDULE-END-DT          PIC XX.
  1917         16  AT-TERMINATED-DT            PIC XX.
  1918         16  AT-LAST-PMT-TYPE            PIC X.
  1919             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  1920             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  1921         16  AT-FIRST-PMT-DATA.
  1922             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1923             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  39
* EL151.cbl
  1924             20  AT-1ST-PAY-THRU-DT      PIC XX.
  1925         16  AT-REGULAR-PMT-DATA.
  1926             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  1927             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  1928             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  1929         16  AT-AUTO-PAYEE-CD.
  1930             20  AT-AUTO-PAYEE-TYPE      PIC X.
  1931                 88  INSURED-PAID-AUTO      VALUE 'I'.
  1932                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  1933                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  1934                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  1935                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  1936             20  AT-AUTO-PAYEE-SEQ       PIC X.
  1937         16  AT-AUTO-PAY-DAY             PIC 99.
  1938         16  AT-AUTO-CASH                PIC X.
  1939             88  AT-CASH                      VALUE 'Y'.
  1940             88  AT-NON-CASH                  VALUE 'N'.
  1941*        16  FILLER                      PIC X(129).
  1942         16  AT-AUTO-END-LETTER          PIC X(4).
  1943         16  FILLER                      PIC X(125).
  1944
  1945         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  1946         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  1947
  1948     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  1949         16  AT-LETTER-SENT-DT           PIC XX.
  1950         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  1951         16  AT-AUTO-RE-SEND-DT          PIC XX.
  1952         16  AT-LETTER-ANSWERED-DT       PIC XX.
  1953         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  1954         16  AT-LETTER-ORIGIN            PIC X.
  1955             88  ONLINE-CREATION              VALUE '1' '3'.
  1956             88  OFFLINE-CREATION             VALUE '2' '4'.
  1957             88  NAPER-ONLINE-CREATION        VALUE '3'.
  1958             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  1959         16  AT-STD-LETTER-FORM          PIC X(4).
  1960         16  AT-REASON-TEXT              PIC X(70).
  1961         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  1962         16  AT-ADDRESEE-TYPE            PIC X.
  1963              88  INSURED-ADDRESEE            VALUE 'I'.
  1964              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  1965              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  1966              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  1967              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  1968              88  OTHER-ADDRESEE-1            VALUE 'O'.
  1969              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  1970         16  AT-ADDRESSEE-NAME           PIC X(30).
  1971         16  AT-INITIAL-PRINT-DATE       PIC XX.
  1972         16  AT-RESEND-PRINT-DATE        PIC XX.
  1973         16  AT-CORR-SOL-UNSOL           PIC X.
  1974         16  AT-LETTER-PURGED-DT         PIC XX.
  1975*
  1976*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  1977*
  1978         16  AT-CSO-REDEFINITION.
  1979             20  AT-RESEND-LETTER-FORM   PIC X(4).
  1980             20  AT-AUTO-CLOSE-IND       PIC X(1).
  1981             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  40
* EL151.cbl
  1982             20  AT-STOP-LETTER-DT       PIC X(2).
  1983             20  AT-AUTH-RCVD            PIC X(1).
  1984             20  FILLER                  PIC X(18).
  1985*             20  FILLER                  PIC X(27).
  1986             20  AT-CSO-LETTER-STATUS    PIC X.
  1987                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  1988                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  1989                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  1990             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  1991             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  1992*
  1993*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  1994*
  1995*        16  FILLER                      PIC X(26).
  1996*
  1997*        16  AT-DMD-BSR-CODE             PIC X.
  1998*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  1999*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  2000*
  2001*        16  AT-DMD-LETTER-STATUS        PIC X.
  2002*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  2003*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  2004*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  2005*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  2006*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  2007
  2008         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  2009         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  2010
  2011     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  2012         16  AT-ADDRESS-TYPE             PIC X.
  2013             88  INSURED-ADDRESS               VALUE 'I'.
  2014             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  2015             88  ACCOUNT-ADDRESS               VALUE 'A'.
  2016             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  2017             88  EMPLOYER-ADDRESS              VALUE 'E'.
  2018             88  OTHER-ADDRESS-1               VALUE 'O'.
  2019             88  OTHER-ADDRESS-2               VALUE 'Q'.
  2020         16  AT-MAIL-TO-NAME             PIC X(30).
  2021         16  AT-ADDRESS-LINE-1           PIC X(30).
  2022         16  AT-ADDRESS-LINE-2           PIC X(30).
  2023         16  AT-CITY-STATE.
  2024             20  AT-CITY                 PIC X(28).
  2025             20  AT-STATE                PIC XX.
  2026         16  AT-ZIP.
  2027             20  AT-ZIP-CODE.
  2028                 24  AT-ZIP-1ST          PIC X.
  2029                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2030                 24  FILLER              PIC X(4).
  2031             20  AT-ZIP-PLUS4            PIC X(4).
  2032         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  2033             20  AT-CAN-POSTAL-1         PIC XXX.
  2034             20  AT-CAN-POSTAL-2         PIC XXX.
  2035             20  FILLER                  PIC XXX.
  2036         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  2037*         16  FILLER                      PIC X(23).
  2038         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  2039         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  41
* EL151.cbl
  2040         16  FILLER                      PIC X(13).
  2041         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  2042         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  2043
  2044     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2045         16  AT-INFO-LINE-1              PIC X(60).
  2046         16  FILLER REDEFINES AT-INFO-LINE-1.
  2047             20  AT-NOTE-ERROR-NO OCCURS 15
  2048                                         PIC X(4).
  2049         16  AT-INFO-LINE-2              PIC X(60).
  2050         16  FILLER REDEFINES AT-INFO-LINE-2.
  2051             20  AT-ICD-CODE-1           PIC X(8).
  2052             20  AT-ICD-CODE-2           PIC X(8).
  2053             20  FILLER                  PIC X(44).
  2054         16  AT-INFO-TRAILER-TYPE        PIC X.
  2055             88  AT-ERRORS-NOTE          VALUE 'E'.
  2056             88  AT-PAYMENT-NOTE         VALUE 'P'.
  2057             88  AT-CALL-NOTE            VALUE 'C'.
  2058             88  AT-MAINT-NOTE           VALUE 'M'.
  2059             88  AT-CERT-CHANGE          VALUE 'X'.
  2060             88  AT-APPROVAL-NOTE        VALUE 'R'.
  2061             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  2062             88  AT-CERT-CANCELLED       VALUE 'T'.
  2063         16  AT-CALL-TYPE                PIC X.
  2064             88  AT-PHONE-CALL-IN        VALUE 'I'.
  2065             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  2066             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  2067         16  AT-NOTE-CONTINUATION        PIC X.
  2068             88  AT-CONTINUED-NOTE       VALUE 'X'.
  2069         16  AT-EOB-CODES-EXIST          PIC X.
  2070             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  2071         16  FILLER                      PIC X(35).
  2072         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  2073         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  2074
  2075     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  2076         16  AT-PROMPT-LINE-1            PIC X(60).
  2077         16  AT-PROMPT-LINE-2            PIC X(60).
  2078         16  AT-PROMPT-START-DT          PIC XX.
  2079         16  AT-PROMPT-END-DT            PIC XX.
  2080         16  FILLER                      PIC X(35).
  2081         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  2082         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  2083
  2084     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2085         16  AT-DENIAL-INFO-1            PIC X(60).
  2086         16  AT-DENIAL-INFO-2            PIC X(60).
  2087         16  AT-DENIAL-DT                PIC XX.
  2088         16  AT-RETRACTION-DT            PIC XX.
  2089         16  AT-DENIAL-REASON-CODE       PIC X(4).
  2090*         16  FILLER                      PIC X(31).
  2091         16  AT-DENIAL-PROOF-DT          PIC XX.
  2092         16  FILLER                      PIC X(29).
  2093         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  2094         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  2095
  2096     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  2097         16  AT-OLD-INCURRED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  42
* EL151.cbl
  2098         16  AT-OLD-REPORTED-DT          PIC XX.
  2099         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  2100         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  2101         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  2102         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  2103         16  AT-OLD-PAID-THRU-DT         PIC XX.
  2104         16  AT-LAST-PMT-MADE-DT         PIC XX.
  2105         16  FILLER                      PIC X(26).
  2106         16  AT-OLD-DIAG-CODE            PIC X(6).
  2107         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  2108         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  2109         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  2110         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  2111         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  2112         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  2113         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  2114         16  AT-OLD-ICD-CODE-1           PIC X(8).
  2115         16  AT-OLD-ICD-CODE-2           PIC X(8).
  2116         16  FILLER                      PIC X(9).
  2117         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  2118
  2119     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  2120         16  AT-FORM-SEND-ON-DT          PIC XX.
  2121         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  2122         16  AT-FORM-RE-SEND-DT          PIC XX.
  2123         16  AT-FORM-ANSWERED-DT         PIC XX.
  2124         16  AT-FORM-PRINTED-DT          PIC XX.
  2125         16  AT-FORM-REPRINT-DT          PIC XX.
  2126         16  AT-FORM-TYPE                PIC X.
  2127             88  INITIAL-FORM                  VALUE '1'.
  2128             88  PROGRESS-FORM                 VALUE '2'.
  2129         16  AT-INSTRUCT-LN-1            PIC X(28).
  2130         16  AT-INSTRUCT-LN-2            PIC X(28).
  2131         16  AT-INSTRUCT-LN-3            PIC X(28).
  2132         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  2133         16  AT-FORM-ADDRESS             PIC X.
  2134             88  FORM-TO-INSURED              VALUE 'I'.
  2135             88  FORM-TO-ACCOUNT              VALUE 'A'.
  2136             88  FORM-TO-OTHER-1              VALUE 'O'.
  2137             88  FORM-TO-OTHER-2              VALUE 'Q'.
  2138         16  AT-RELATED-1.
  2139             20 AT-REL-CARR-1            PIC X.
  2140             20 AT-REL-CLAIM-1           PIC X(7).
  2141             20 AT-REL-CERT-1            PIC X(11).
  2142         16  AT-RELATED-2.
  2143             20 AT-REL-CARR-2            PIC X.
  2144             20 AT-REL-CLAIM-2           PIC X(7).
  2145             20 AT-REL-CERT-2            PIC X(11).
  2146         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  2147         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  2148         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  2149         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  2150         16  AT-FORM-REM-PRINT-DT        PIC XX.
  2151         16  AT-STOP-FORM-DT             PIC X(2).
  2152
  2153         16  FILLER                      PIC X(09).
  2154         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  2155         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  43
* EL151.cbl
  2156******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  44
* EL151.cbl
  2158*                                    COPY ELCARCH.
  2159******************************************************************
  2160*                                                                *
  2161*                            ELCARCH.                            *
  2162*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2163*                            VMOD=2.007                          *
  2164*                                                                *
  2165*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  2166*                                                                *
  2167*   FILE TYPE = VSAM,KSDS                                        *
  2168*   RECORD SIZE = 090  RECFORM = FIXED                           *
  2169*                                                                *
  2170*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  2171*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  2172*                                                                *
  2173*   LOG = NO                                                     *
  2174*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2175*                                                                *
  2176*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  2177******************************************************************
  2178 01  LETTER-ARCHIVE.
  2179     12  LA-RECORD-ID                PIC XX.
  2180         88  VALID-LA-ID                VALUE 'LA'.
  2181
  2182     12  LA-CONTROL-PRIMARY.
  2183         16  LA-COMPANY-CD           PIC X.
  2184         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  2185         16  LA-RECORD-TYPE          PIC X.
  2186             88  LA-HEADER-DATA         VALUE '1'.
  2187             88  LA-ADDRESS-DATA        VALUE '2'.
  2188             88  LA-TEXT-DATA           VALUE '3'.
  2189             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  2190         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  2191
  2192     12  LA-CONTROL-BY-TYPE.
  2193         16  LA-COMPANY-CD-A1        PIC X.
  2194         16  LA-RECORD-TYPE-A1       PIC X.
  2195         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  2196         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  2197
  2198     12  LA-TEXT-RECORD.
  2199         16  LA-SKIP-CONTROL         PIC XX.
  2200             88  NO-LINES-SKIPPED       VALUE SPACES.
  2201             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  2202         16  LA-TEXT-LINE            PIC X(70).
  2203
  2204     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  2205         16  FILLER                  PIC XX.
  2206         16  LA-ADDRESS-LINE         PIC X(30).
  2207         16  FILLER                  PIC X(40).
  2208
  2209     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  2210         16  FILLER                  PIC XX.
  2211         16  LA-CARRIER              PIC X.
  2212         16  LA-CLAIM-NO             PIC X(7).
  2213         16  LA-CERT-NO.
  2214             20  LA-CERT-PRIME       PIC X(10).
  2215             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  45
* EL151.cbl
  2216         16  LA-NO-OF-COPIES         PIC S9.
  2217         16  LA-RESEND-DATE          PIC XX.
  2218         16  LA-PROCESSOR-CD         PIC X(4).
  2219         16  LA-CREATION-DT          PIC XX.
  2220         16  LA-INITIAL-PRINT-DATE   PIC XX.
  2221         16  LA-RESEND-PRINT-DATE    PIC XX.
  2222         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  2223         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  2224*
  2225* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  2226*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  2227*   I        20  LA-DMD-PROD-CODE        PIC XX.
  2228*   I        20  LA-DMD-RES-ST           PIC XX.
  2229*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  2230*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  2231*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  2232*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  2233*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  2234*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  2235*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  2236*   I        20  LA-DMD-UND-CODE         PIC XX.
  2237*   I        20  LA-DMD-BEN-CODE         PIC XX.
  2238*   V    16  FILLER                  PIC X(15).
  2239* -----
  2240*
  2241* REINSERTED  CSO  MODS
  2242*
  2243         16  FILLER.
  2244             20  FILLER                  PIC X(29).
  2245             20  LA-CSO-LETTER-STATUS    PIC X.
  2246                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  2247                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  2248                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  2249             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  2250             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  2251*
  2252
  2253     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  2254         16  FILLER                  PIC XX.
  2255         16  LA4-CARRIER             PIC X.
  2256         16  LA4-CLAIM-NO            PIC X(7).
  2257         16  LA4-CERT-NO.
  2258             20  LA4-CERT-PRIME      PIC X(10).
  2259             20  LA4-CERT-SFX        PIC X.
  2260         16  LA4-NO-OF-COPIES        PIC S9.
  2261         16  LA4-RESEND-DATE         PIC XX.
  2262         16  LA4-PROCESSOR-CD        PIC X(4).
  2263         16  LA4-CREATION-DT         PIC XX.
  2264         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  2265         16  LA4-RESEND-PRINT-DATE   PIC XX.
  2266         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  2267         16  LA4-FORM-TYPE           PIC X.
  2268             88  LA4-INITIAL-FORM    VALUE '1'.
  2269             88  LA4-PROGRESS-FORM   VALUE '2'.
  2270         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  2271         16  LA4-STATE               PIC X(02).
  2272         16  FILLER                  PIC X(31).
  2273******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  46
* EL151.cbl
  2275*                                    COPY ELCCNTL.
  2276******************************************************************
  2277*                                                                *
  2278*                                                                *
  2279*                            ELCCNTL.                            *
  2280*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2281*                            VMOD=2.059                          *
  2282*                                                                *
  2283*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2284*                                                                *
  2285*   FILE TYPE = VSAM,KSDS                                        *
  2286*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2287*                                                                *
  2288*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2289*       ALTERNATE INDEX = NONE                                   *
  2290*                                                                *
  2291*   LOG = YES                                                    *
  2292*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2293******************************************************************
  2294*                   C H A N G E   L O G
  2295*
  2296* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2297*-----------------------------------------------------------------
  2298*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2299* EFFECTIVE    NUMBER
  2300*-----------------------------------------------------------------
  2301* 082503                   PEMA  ADD BENEFIT GROUP
  2302* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2303* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2304* 092705    2005050300006  PEMA  ADD SPP LEASES
  2305* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2306* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2307* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2308* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2309* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2310* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2311* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2312* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2313* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2314* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2315* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2316******************************************************************
  2317*
  2318 01  CONTROL-FILE.
  2319     12  CF-RECORD-ID                       PIC XX.
  2320         88  VALID-CF-ID                        VALUE 'CF'.
  2321
  2322     12  CF-CONTROL-PRIMARY.
  2323         16  CF-COMPANY-ID                  PIC XXX.
  2324         16  CF-RECORD-TYPE                 PIC X.
  2325             88  CF-COMPANY-MASTER              VALUE '1'.
  2326             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2327             88  CF-STATE-MASTER                VALUE '3'.
  2328             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2329             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2330             88  CF-CARRIER-MASTER              VALUE '6'.
  2331             88  CF-MORTALITY-MASTER            VALUE '7'.
  2332             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  47
* EL151.cbl
  2333             88  CF-TERMINAL-MASTER             VALUE '9'.
  2334             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2335             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2336             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2337             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2338             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2339             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2340             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2341             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2342             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2343         16  CF-ACCESS-CD-GENL              PIC X(4).
  2344         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2345             20  CF-PROCESSOR               PIC X(4).
  2346         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2347             20  CF-STATE-CODE              PIC XX.
  2348             20  FILLER                     PIC XX.
  2349         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2350             20  FILLER                     PIC XX.
  2351             20  CF-HI-BEN-IN-REC           PIC XX.
  2352         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2353             20  FILLER                     PIC XXX.
  2354             20  CF-CARRIER-CNTL            PIC X.
  2355         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2356             20  FILLER                     PIC XX.
  2357             20  CF-HI-TYPE-IN-REC          PIC 99.
  2358         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2359             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2360                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2361             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2362             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2363         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2364             20  FILLER                     PIC X.
  2365             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2366         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2367             20  FILLER                     PIC XX.
  2368             20  CF-MORTGAGE-PLAN           PIC XX.
  2369         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2370
  2371     12  CF-LAST-MAINT-DT                   PIC XX.
  2372     12  CF-LAST-MAINT-BY                   PIC X(4).
  2373     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2374
  2375     12  CF-RECORD-BODY                     PIC X(728).
  2376
  2377
  2378****************************************************************
  2379*             COMPANY MASTER RECORD                            *
  2380****************************************************************
  2381
  2382     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2383         16  CF-COMPANY-ADDRESS.
  2384             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2385             20  CF-CL-IN-CARE-OF           PIC X(30).
  2386             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2387             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2388             20  CF-CL-CITY-STATE           PIC X(30).
  2389             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2390             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  48
* EL151.cbl
  2391         16  CF-COMPANY-CD                  PIC X.
  2392         16  CF-COMPANY-PASSWORD            PIC X(8).
  2393         16  CF-SECURITY-OPTION             PIC X.
  2394             88  ALL-SECURITY                   VALUE '1'.
  2395             88  COMPANY-VERIFY                 VALUE '2'.
  2396             88  PROCESSOR-VERIFY               VALUE '3'.
  2397             88  NO-SECURITY                    VALUE '4'.
  2398             88  ALL-BUT-TERM                   VALUE '5'.
  2399         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2400             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2401         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2402             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2403         16  CF-INFORCE-LOCATION            PIC X.
  2404             88  CERTS-ARE-ONLINE               VALUE '1'.
  2405             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2406             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2407         16  CF-LOWER-CASE-LETTERS          PIC X.
  2408         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2409             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2410             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2411             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2412             88  CF-ACCNT-CNTL                  VALUE '3'.
  2413             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2414
  2415         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2416         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2417
  2418         16  CF-LGX-CREDIT-USER             PIC X.
  2419             88  CO-IS-NOT-USER                 VALUE 'N'.
  2420             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2421
  2422         16 CF-CREDIT-CALC-CODES.
  2423             20  CF-CR-REM-TERM-CALC PIC X.
  2424               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2425               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2426               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2427               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2428               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2429               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2430               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2431             20  CF-CR-R78-METHOD           PIC X.
  2432               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2433               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2434
  2435         16  CF-CLAIM-CONTROL-COUNTS.
  2436             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2437                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2438
  2439             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2440                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2441
  2442             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2443                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2444
  2445             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2446                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2447
  2448         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  49
* EL151.cbl
  2449
  2450         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2451             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2452             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2453             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2454             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2455                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2456                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2457             20  CF-CO-PREM-REJECT-SW       PIC X.
  2458                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2459                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2460             20  CF-CO-REF-REJECT-SW        PIC X.
  2461                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2462                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2463
  2464         16  CF-CO-REPORTING-DT             PIC XX.
  2465         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2466         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2467           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2468           88  CF-CO-MONTH-END                  VALUE '1'.
  2469
  2470         16  CF-LGX-CLAIM-USER              PIC X.
  2471             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2472             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2473
  2474         16  CF-CREDIT-EDIT-CONTROLS.
  2475             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2476             20  CF-MIN-AGE                 PIC 99.
  2477             20  CF-DEFAULT-AGE             PIC 99.
  2478             20  CF-MIN-TERM                PIC S999      COMP-3.
  2479             20  CF-MAX-TERM                PIC S999      COMP-3.
  2480             20  CF-DEFAULT-SEX             PIC X.
  2481             20  CF-JOINT-AGE-INPUT         PIC X.
  2482                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2483             20  CF-BIRTH-DATE-INPUT        PIC X.
  2484                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2485             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2486                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2487                 88  CF-ZERO-CARRIER            VALUE '1'.
  2488                 88  CF-ZERO-GROUPING           VALUE '2'.
  2489                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2490             20  CF-EDIT-SW                 PIC X.
  2491                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2492             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2493             20  CF-CR-PR-METHOD            PIC X.
  2494               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2495               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2496             20  FILLER                     PIC X.
  2497
  2498         16  CF-CREDIT-MISC-CONTROLS.
  2499             20  CF-REIN-TABLE-SW           PIC X.
  2500                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2501             20  CF-COMP-TABLE-SW           PIC X.
  2502                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2503             20  CF-EXPERIENCE-RETENTION-AGE
  2504                                            PIC S9        COMP-3.
  2505             20  CF-CONVERSION-DT           PIC XX.
  2506             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  50
* EL151.cbl
  2507             20  CF-RUN-FREQUENCY-SW        PIC X.
  2508                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2509                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2510
  2511             20  CF-CR-CHECK-NO-CONTROL.
  2512                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2513                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2514                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2515                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2516                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2517                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2518
  2519                 24  CF-CR-CHECK-COUNT       REDEFINES
  2520                     CF-CR-CHECK-COUNTER      PIC X(4).
  2521
  2522                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2523                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2524
  2525                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2526                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2527                 24  CF-MAIL-PROCESSING       PIC X.
  2528                     88  MAIL-PROCESSING          VALUE 'Y'.
  2529
  2530         16  CF-MISC-SYSTEM-CONTROL.
  2531             20  CF-SYSTEM-C                 PIC X.
  2532                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2533             20  CF-SYSTEM-D                 PIC X.
  2534                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2535             20  CF-SOC-SEC-NO-SW            PIC X.
  2536                 88  SOC-SEC-NO-USED             VALUE '1'.
  2537             20  CF-MEMBER-NO-SW             PIC X.
  2538                 88  MEMBER-NO-USED              VALUE '1'.
  2539             20  CF-TAX-ID-NUMBER            PIC X(11).
  2540             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2541             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2542                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2543                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2544                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2545                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2546             20  CF-SYSTEM-E                 PIC X.
  2547                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2548
  2549         16  CF-LGX-LIFE-USER               PIC X.
  2550             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2551             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2552
  2553         16  CF-CR-MONTH-END-DT             PIC XX.
  2554
  2555         16  CF-FILE-MAINT-DATES.
  2556             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2557                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2558             20  CF-LAST-BATCH       REDEFINES
  2559                 CF-LAST-BATCH-NO               PIC X(4).
  2560             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2561             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2562             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2563             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2564             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  51
* EL151.cbl
  2565             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2566             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2567             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2568             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2569             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2570
  2571         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2572         16  FILLER                         PIC X.
  2573
  2574         16  CF-ALT-MORT-CODE               PIC X(4).
  2575         16  CF-MEMBER-CAPTION              PIC X(10).
  2576
  2577         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2578             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2579             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2580             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2581             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2582             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2583
  2584         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2585
  2586         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2587         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2588         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2589         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2590
  2591         16  CF-AH-OVERRIDE-L1              PIC X.
  2592         16  CF-AH-OVERRIDE-L2              PIC XX.
  2593         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2594         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2595
  2596         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2597         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2598
  2599         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2600         16  CF-AR-LAST-EL860-DT            PIC XX.
  2601         16  CF-MP-MONTH-END-DT             PIC XX.
  2602
  2603         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2604         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2605             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2606
  2607         16  CF-AR-MONTH-END-DT             PIC XX.
  2608
  2609         16  CF-CRDTCRD-USER                PIC X.
  2610             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2611             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2612
  2613         16  CF-CC-MONTH-END-DT             PIC XX.
  2614
  2615         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2616
  2617         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2618             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2619             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2620             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2621         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2622         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  52
* EL151.cbl
  2623         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2624         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2625             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2626             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2627         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2628         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2629         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2630             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2631         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2632
  2633         16  CF-CL-ZIP-CODE.
  2634             20  CF-CL-ZIP-PRIME.
  2635                 24  CF-CL-ZIP-1ST          PIC X.
  2636                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2637                 24  FILLER                 PIC X(4).
  2638             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2639         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2640             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2641             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2642             20  FILLER                     PIC XXX.
  2643
  2644         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2645         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2646         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2647         16  CF-CO-OPTION-START-DATE        PIC XX.
  2648         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2649           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2650                                                      '3' '4'.
  2651           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2652           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2653           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2654           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2655           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2656           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2657
  2658         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2659
  2660         16  CF-PAYMENT-APPROVAL-LEVELS.
  2661             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2662             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2663             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2664             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2665             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2666             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2667
  2668         16  CF-END-USER-REPORTING-USER     PIC X.
  2669             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2670             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2671
  2672         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2673             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2674             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2675
  2676         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2677
  2678         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2679         16  FILLER                         PIC X.
  2680
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  53
* EL151.cbl
  2681         16  CF-CREDIT-ARCHIVE-CNTL.
  2682             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2683             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2684             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2685
  2686         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2687
  2688         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2689             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2690             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2691
  2692         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2693             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2694             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2695
  2696         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2697
  2698         16  CF-CO-ACH-ID-CODE              PIC  X.
  2699             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2700             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2701             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2702         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2703         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2704         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2705         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2706         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2707         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2708         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2709         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2710         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2711                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2712         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2713                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2714
  2715         16  CF-CO-OVER-SHORT.
  2716             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2717             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2718
  2719*         16  FILLER                         PIC X(102).
  2720         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2721             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2722             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2723
  2724         16  CF-AH-APPROVAL-DAYS.
  2725             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2726             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2727             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2728             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2729
  2730         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2731
  2732         16  CF-APPROV-LEV-5.
  2733             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2734             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2735             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2736
  2737         16  FILLER                         PIC X(68).
  2738****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  54
* EL151.cbl
  2739*             PROCESSOR/USER RECORD                            *
  2740****************************************************************
  2741
  2742     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2743         16  CF-PROCESSOR-NAME              PIC X(30).
  2744         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2745         16  CF-PROCESSOR-TITLE             PIC X(26).
  2746         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2747                 88  MESSAGE-YES                VALUE 'Y'.
  2748                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2749
  2750*****************************************************
  2751****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2752****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2753****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2754****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2755*****************************************************
  2756
  2757         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2758             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2759             20  CF-APPLICATION-FORCE       PIC X.
  2760             20  CF-INDIVIDUAL-APP.
  2761                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2762                     28  CF-BROWSE-APP      PIC X.
  2763                     28  CF-UPDATE-APP      PIC X.
  2764
  2765         16  CF-CURRENT-TERM-ON             PIC X(4).
  2766         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2767             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2768             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2769             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2770             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2771             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2772             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2773             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2774         16  CF-PROCESSOR-CARRIER           PIC X.
  2775             88  NO-CARRIER-SECURITY            VALUE ' '.
  2776         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2777             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2778         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2779             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2780         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2781             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2782
  2783         16  CF-PROC-SYS-ACCESS-SW.
  2784             20  CF-PROC-CREDIT-CLAIMS-SW.
  2785                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2786                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2787                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2788                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2789             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2790                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2791                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2792             20  CF-PROC-LIFE-GNRLDGR-SW.
  2793                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2794                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2795                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2796                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  55
* EL151.cbl
  2797             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2798                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2799                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2800         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2801             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2802             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2803         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2804
  2805         16  CF-APPROVAL-LEVEL                  PIC X.
  2806             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2807             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2808             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2809             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2810             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2811
  2812         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2813
  2814         16  CF-LANGUAGE-TYPE                   PIC X.
  2815             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2816             88  CF-LANG-IS-FR                      VALUE 'F'.
  2817
  2818         16  CF-CSR-IND                         PIC X.
  2819         16  FILLER                             PIC X(239).
  2820
  2821****************************************************************
  2822*             PROCESSOR/REMINDERS RECORD                       *
  2823****************************************************************
  2824
  2825     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2826         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2827             20  CF-START-REMIND-DT         PIC XX.
  2828             20  CF-END-REMIND-DT           PIC XX.
  2829             20  CF-REMINDER-TEXT           PIC X(50).
  2830         16  FILLER                         PIC X(296).
  2831
  2832
  2833****************************************************************
  2834*             STATE MASTER RECORD                              *
  2835****************************************************************
  2836
  2837     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2838         16  CF-STATE-ABBREVIATION          PIC XX.
  2839         16  CF-STATE-NAME                  PIC X(25).
  2840         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2841         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2842             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2843             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2844             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2845             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2846                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2847                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2848             20  CF-ST-PREM-REJECT-SW       PIC X.
  2849                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2850                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2851             20  CF-ST-REF-REJECT-SW        PIC X.
  2852                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2853                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2854         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  56
* EL151.cbl
  2855         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2856         16  CF-ST-REFUND-RULES.
  2857             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2858             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2859             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2860         16  CF-ST-FST-PMT-EXTENSION.
  2861             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2862             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2863                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2864                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2865                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2866                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2867         16  CF-ST-STATE-CALL.
  2868             20  CF-ST-CALL-UNEARNED        PIC X.
  2869             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2870             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2871         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2872             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2873             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2874         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2875         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2876         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2877         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2878         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2879         16  FILLER                         PIC X.
  2880         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2881             20  CF-ST-BENEFIT-CD           PIC XX.
  2882             20  CF-ST-BENEFIT-KIND         PIC X.
  2883                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2884                 88  CF-ST-AH-KIND              VALUE 'A'.
  2885             20  CF-ST-REM-TERM-CALC        PIC X.
  2886                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2887                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2888                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2889                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2890                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2891                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2892                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2893                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2894
  2895             20  CF-ST-REFUND-CALC          PIC X.
  2896                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2897                 88  ST-REFD-BY-R78             VALUE '1'.
  2898                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2899                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2900                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2901                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2902                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2903                 88  ST-REFD-UTAH               VALUE '7'.
  2904                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2905                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2906                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2907
  2908             20  CF-ST-EARNING-CALC         PIC X.
  2909                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2910                 88  ST-EARN-BY-R78             VALUE '1'.
  2911                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2912                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  57
* EL151.cbl
  2913                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2914                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2915                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2916                 88  ST-EARN-MEAN               VALUE '8'.
  2917                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2918
  2919             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2920                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2921                 88  ST-OVRD-BY-R78             VALUE '1'.
  2922                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2923                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2924                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2925                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2926                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2927                 88  ST-OVRD-MEAN               VALUE '8'.
  2928                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2929             20  cf-st-extra-periods        pic 9.
  2930*            20  FILLER                     PIC X.
  2931
  2932         16  CF-ST-COMMISSION-CAPS.
  2933             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2934             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2935             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2936             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2937         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2938                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2939                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2940                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2941
  2942         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2943
  2944         16  CF-ST-STATUTORY-INTEREST.
  2945             20  CF-ST-STAT-DATE-FROM       PIC X.
  2946                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2947                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2948             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2949             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2950             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2951             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2952             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2953
  2954         16  CF-ST-OVER-SHORT.
  2955             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2956             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2957
  2958         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2959
  2960         16  CF-ST-RT-CALC                  PIC X.
  2961
  2962         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2963         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2964         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2965         16  CF-ST-RF-LR-CALC               PIC X.
  2966         16  CF-ST-RF-LL-CALC               PIC X.
  2967         16  CF-ST-RF-LN-CALC               PIC X.
  2968         16  CF-ST-RF-AH-CALC               PIC X.
  2969         16  CF-ST-RF-CP-CALC               PIC X.
  2970*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  58
* EL151.cbl
  2971*CIDMOD         16  FILLER                         PIC X(192).
  2972         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2973             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2974         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2975         16  CF-ST-VFY-2ND-BENE             PIC X.
  2976         16  CF-ST-CAUSAL-STATE             PIC X.
  2977         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2978         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2979         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2980             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2981         16  CF-ST-NET-ONLY-STATE           PIC X.
  2982             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2983         16  cf-commission-cap-required     pic x.
  2984         16  CF-ST-GA-COMMISSION-CAPS.
  2985             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2986             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2987             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2988             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2989         16  CF-ST-TOT-COMMISSION-CAPS.
  2990             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2991             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2992             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2993             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2994         16  FILLER                         PIC X(156).
  2995
  2996****************************************************************
  2997*             BENEFIT MASTER RECORD                            *
  2998****************************************************************
  2999
  3000     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3001         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3002             20  CF-BENEFIT-CODE            PIC XX.
  3003             20  CF-BENEFIT-NUMERIC  REDEFINES
  3004                 CF-BENEFIT-CODE            PIC XX.
  3005             20  CF-BENEFIT-ALPHA           PIC XXX.
  3006             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3007             20  CF-BENEFIT-COMMENT         PIC X(10).
  3008
  3009             20  CF-LF-COVERAGE-TYPE        PIC X.
  3010                 88  CF-REDUCING                VALUE 'R'.
  3011                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3012
  3013             20  CF-SPECIAL-CALC-CD         PIC X.
  3014                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3015                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3016                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3017                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3018                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3019                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3020                 88  CF-FARM-PLAN               VALUE 'F'.
  3021                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3022                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3023                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3024                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3025                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3026                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3027                 88  CF-PRUDENTIAL              VALUE 'P'.
  3028                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  59
* EL151.cbl
  3029                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3030                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3031                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3032                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3033                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3034
  3035             20  CF-JOINT-INDICATOR         PIC X.
  3036                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3037
  3038*            20  FILLER                     PIC X(12).
  3039             20  cf-maximum-benefits        pic s999 comp-3.
  3040             20  FILLER                     PIC X(09).
  3041             20  CF-BENEFIT-CATEGORY        PIC X.
  3042             20  CF-LOAN-TYPE               PIC X(8).
  3043
  3044             20  CF-CO-REM-TERM-CALC        PIC X.
  3045                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3046                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3047                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3048                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3049                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3050
  3051             20  CF-CO-EARNINGS-CALC        PIC X.
  3052                 88  CO-EARN-BY-R78             VALUE '1'.
  3053                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3054                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3055                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3056                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3057                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3058                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3059                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3060
  3061             20  CF-CO-REFUND-CALC          PIC X.
  3062                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3063                 88  CO-REFD-BY-R78             VALUE '1'.
  3064                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3065                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3066                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3067                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3068                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3069                 88  CO-REFD-MEAN               VALUE '8'.
  3070                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3071                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3072                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3073
  3074             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3075                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3076                 88  CO-OVRD-BY-R78             VALUE '1'.
  3077                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3078                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3079                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3080                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3081                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3082                 88  CO-OVRD-MEAN               VALUE '8'.
  3083                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3084
  3085             20  CF-CO-BEN-I-G-CD           PIC X.
  3086                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  60
* EL151.cbl
  3087                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3088                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3089
  3090         16  FILLER                         PIC X(304).
  3091
  3092
  3093****************************************************************
  3094*             CARRIER MASTER RECORD                            *
  3095****************************************************************
  3096
  3097     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3098         16  CF-ADDRESS-DATA.
  3099             20  CF-MAIL-TO-NAME            PIC X(30).
  3100             20  CF-IN-CARE-OF              PIC X(30).
  3101             20  CF-ADDRESS-LINE-1          PIC X(30).
  3102             20  CF-ADDRESS-LINE-2          PIC X(30).
  3103             20  CF-CITY-STATE              PIC X(30).
  3104             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3105             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3106
  3107         16  CF-CLAIM-NO-CONTROL.
  3108             20  CF-CLAIM-NO-METHOD         PIC X.
  3109                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3110                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3111                 88  CLAIM-NO-SEQ               VALUE '3'.
  3112                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3113             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3114                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3115                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3116                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3117
  3118         16  CF-CHECK-NO-CONTROL.
  3119             20  CF-CHECK-NO-METHOD         PIC X.
  3120                 88  CHECK-NO-MANUAL            VALUE '1'.
  3121                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3122                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3123                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3124             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3125                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3126
  3127         16  CF-DOMICILE-STATE              PIC XX.
  3128
  3129         16  CF-EXPENSE-CONTROLS.
  3130             20  CF-EXPENSE-METHOD          PIC X.
  3131                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3132                 88  DOLLARS-PER-PMT            VALUE '2'.
  3133                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3134                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3135             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3136             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3137
  3138         16  CF-CORRESPONDENCE-CONTROL.
  3139             20  CF-LETTER-RESEND-OPT       PIC X.
  3140                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3141                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3142             20  FILLER                     PIC X(4).
  3143
  3144         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  61
* EL151.cbl
  3145             20  CF-MANUAL-SW               PIC X.
  3146                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3147             20  CF-FUTURE-SW               PIC X.
  3148                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3149             20  CF-PTC-SW                  PIC X.
  3150                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3151             20  CF-IBNR-SW                 PIC X.
  3152                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3153             20  CF-PTC-LF-SW               PIC X.
  3154                 88  CF-LF-PTC-USED             VALUE '1'.
  3155             20  CF-CDT-ACCESS-METHOD       PIC X.
  3156                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3157                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3158                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3159             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3160
  3161         16  CF-CLAIM-CALC-METHOD           PIC X.
  3162             88  360-PLUS-MONTHS                VALUE '1'.
  3163             88  365-PLUS-MONTHS                VALUE '2'.
  3164             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3165             88  360-DAILY                      VALUE '4'.
  3166             88  365-DAILY                      VALUE '5'.
  3167
  3168         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3169         16  FILLER                         PIC X(11).
  3170
  3171         16  CF-LIMIT-AMOUNTS.
  3172             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3173             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3174             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3175             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3176             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3177             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3178             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3179             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3180             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3181             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3182
  3183         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3184         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3185         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3186
  3187         16  CF-ZIP-CODE.
  3188             20  CF-ZIP-PRIME.
  3189                 24  CF-ZIP-1ST             PIC X.
  3190                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3191                 24  FILLER                 PIC X(4).
  3192             20  CF-ZIP-PLUS4               PIC X(4).
  3193         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3194             20  CF-CAN-POSTAL-1            PIC XXX.
  3195             20  CF-CAN-POSTAL-2            PIC XXX.
  3196             20  FILLER                     PIC XXX.
  3197
  3198         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3199         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3200         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3201
  3202         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  62
* EL151.cbl
  3203             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3204             88  CF-NO-RATING                   VALUE 'N'.
  3205
  3206         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3207
  3208         16  CF-CARRIER-OVER-SHORT.
  3209             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3210             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3211
  3212         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3213         16  CF-SECPAY-SWITCH               PIC X.
  3214             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3215             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3216         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3217         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3218         16  FILLER                         PIC X(444).
  3219*        16  FILLER                         PIC X(452).
  3220
  3221
  3222****************************************************************
  3223*             MORTALITY MASTER RECORD                          *
  3224****************************************************************
  3225
  3226     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3227         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3228                                INDEXED BY CF-MORT-NDX.
  3229             20  CF-MORT-TABLE              PIC X(5).
  3230             20  CF-MORT-TABLE-TYPE         PIC X.
  3231                 88  CF-MORT-JOINT              VALUE 'J'.
  3232                 88  CF-MORT-SINGLE             VALUE 'S'.
  3233                 88  CF-MORT-COMBINED           VALUE 'C'.
  3234                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3235                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3236             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3237             20  CF-MORT-AGE-METHOD         PIC XX.
  3238                 88  CF-AGE-LAST                VALUE 'AL'.
  3239                 88  CF-AGE-NEAR                VALUE 'AN'.
  3240             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3241             20  CF-MORT-ADJUSTMENT-DIRECTION
  3242                                            PIC X.
  3243                 88  CF-MINUS                   VALUE '-'.
  3244                 88  CF-PLUS                    VALUE '+'.
  3245             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3246             20  CF-MORT-JOINT-CODE         PIC X.
  3247                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3248             20  CF-MORT-PC-Q               PIC X.
  3249                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3250             20  CF-MORT-TABLE-CODE         PIC X(4).
  3251             20  CF-MORT-COMMENTS           PIC X(15).
  3252             20  FILLER                     PIC X(14).
  3253
  3254         16  FILLER                         PIC X(251).
  3255
  3256
  3257****************************************************************
  3258*             BUSSINESS TYPE MASTER RECORD                     *
  3259****************************************************************
  3260
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  63
* EL151.cbl
  3261     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3262* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3263* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3264* AND RECORD 05 IS TYPES 81-99
  3265         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3266             20  CF-BUSINESS-TITLE          PIC  X(19).
  3267             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3268                                            PIC S9V9(4) COMP-3.
  3269             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3270             20  FILLER                     PIC  X.
  3271         16  FILLER                         PIC  X(248).
  3272
  3273
  3274****************************************************************
  3275*             TERMINAL MASTER RECORD                           *
  3276****************************************************************
  3277
  3278     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3279
  3280         16  CF-COMPANY-TERMINALS.
  3281             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3282                                  PIC X(4).
  3283         16  FILLER               PIC X(248).
  3284
  3285
  3286****************************************************************
  3287*             LIFE EDIT MASTER RECORD                          *
  3288****************************************************************
  3289
  3290     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3291         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3292             20  CF-LIFE-CODE-IN            PIC XX.
  3293             20  CF-LIFE-CODE-OUT           PIC XX.
  3294         16  FILLER                         PIC X(248).
  3295
  3296
  3297****************************************************************
  3298*             AH EDIT MASTER RECORD                            *
  3299****************************************************************
  3300
  3301     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3302         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3303             20  CF-AH-CODE-IN              PIC XXX.
  3304             20  CF-AH-CODE-OUT             PIC XX.
  3305         16  FILLER                         PIC X(248).
  3306
  3307
  3308****************************************************************
  3309*             CREDIBILITY TABLES                               *
  3310****************************************************************
  3311
  3312     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3313         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3314                             INDEXED BY CF-CRDB-NDX.
  3315             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3316             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3317             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3318         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  64
* EL151.cbl
  3319
  3320
  3321****************************************************************
  3322*             REPORT CUSTOMIZATION RECORD                      *
  3323****************************************************************
  3324
  3325     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3326         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3327             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3328             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3329             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3330**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3331****       A T-TRANSFER.                                   ****
  3332             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3333
  3334         16  FILLER                         PIC XX.
  3335
  3336         16  CF-CARRIER-CNTL-OPT.
  3337             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3338                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3339                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3340             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3341                                            PIC X.
  3342         16  CF-GROUP-CNTL-OPT.
  3343             20  CF-GROUP-OPT-SEQ           PIC 9.
  3344                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3345                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3346             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3347                                            PIC X(6).
  3348         16  CF-STATE-CNTL-OPT.
  3349             20  CF-STATE-OPT-SEQ           PIC 9.
  3350                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3351                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3352             20  CF-STATE-SELECT OCCURS 3 TIMES
  3353                                            PIC XX.
  3354         16  CF-ACCOUNT-CNTL-OPT.
  3355             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3356                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3357                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3358             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3359                                            PIC X(10).
  3360         16  CF-BUS-TYP-CNTL-OPT.
  3361             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3362                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3363                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3364             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3365                                            PIC XX.
  3366         16  CF-LF-TYP-CNTL-OPT.
  3367             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3368                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3369                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3370             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3371                                            PIC XX.
  3372         16  CF-AH-TYP-CNTL-OPT.
  3373             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3374                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3375                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3376             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  65
* EL151.cbl
  3377                                            PIC XX.
  3378         16  CF-REPTCD1-CNTL-OPT.
  3379             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3380                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3381                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3382             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3383                                            PIC X(10).
  3384         16  CF-REPTCD2-CNTL-OPT.
  3385             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3386                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3387                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3388             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3389                                            PIC X(10).
  3390         16  CF-USER1-CNTL-OPT.
  3391             20  CF-USER1-OPT-SEQ           PIC 9.
  3392                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3393                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3394             20  CF-USER1-SELECT OCCURS 3 TIMES
  3395                                            PIC X(10).
  3396         16  CF-USER2-CNTL-OPT.
  3397             20  CF-USER2-OPT-SEQ           PIC 9.
  3398                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3399                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3400             20  CF-USER2-SELECT OCCURS 3 TIMES
  3401                                            PIC X(10).
  3402         16  CF-USER3-CNTL-OPT.
  3403             20  CF-USER3-OPT-SEQ           PIC 9.
  3404                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3405                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3406             20  CF-USER3-SELECT OCCURS 3 TIMES
  3407                                            PIC X(10).
  3408         16  CF-USER4-CNTL-OPT.
  3409             20  CF-USER4-OPT-SEQ           PIC 9.
  3410                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3411                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3412             20  CF-USER4-SELECT OCCURS 3 TIMES
  3413                                            PIC X(10).
  3414         16  CF-USER5-CNTL-OPT.
  3415             20  CF-USER5-OPT-SEQ           PIC 9.
  3416                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3417                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3418             20  CF-USER5-SELECT OCCURS 3 TIMES
  3419                                            PIC X(10).
  3420         16  CF-REINS-CNTL-OPT.
  3421             20  CF-REINS-OPT-SEQ           PIC 9.
  3422                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3423                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3424             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3425                 24  CF-REINS-PRIME         PIC XXX.
  3426                 24  CF-REINS-SUB           PIC XXX.
  3427
  3428         16  CF-AGENT-CNTL-OPT.
  3429             20  CF-AGENT-OPT-SEQ           PIC 9.
  3430                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3431                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3432             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3433                                            PIC X(10).
  3434
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  66
* EL151.cbl
  3435         16  FILLER                         PIC X(43).
  3436
  3437         16  CF-LOSS-RATIO-SELECT.
  3438             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3439             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3440         16  CF-ENTRY-DATE-SELECT.
  3441             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3442             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3443         16  CF-EFFECTIVE-DATE-SELECT.
  3444             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3445             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3446
  3447         16  CF-EXCEPTION-LIST-IND          PIC X.
  3448             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3449
  3450         16  FILLER                         PIC X(318).
  3451
  3452****************************************************************
  3453*                  EXCEPTION REPORTING RECORD                  *
  3454****************************************************************
  3455
  3456     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3457         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3458             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3459
  3460         16  CF-COMBINED-LIFE-AH-OPT.
  3461             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3462             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3463             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3464             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3465
  3466         16  CF-LIFE-OPT.
  3467             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3468             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3469             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3470             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3471             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3472             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3473             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3474             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3475             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3476             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3477
  3478         16  CF-AH-OPT.
  3479             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3480             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3481             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3482             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3483             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3484             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3485             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3486             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3487             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3488             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3489
  3490         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3491             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3492             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  67
* EL151.cbl
  3493             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3494
  3495         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3496
  3497         16  FILLER                         PIC X(673).
  3498
  3499
  3500****************************************************************
  3501*             MORTGAGE SYSTEM PLAN RECORD                      *
  3502****************************************************************
  3503
  3504     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3505         16  CF-PLAN-TYPE                   PIC X.
  3506             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3507             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3508             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3509         16  CF-PLAN-ABBREV                 PIC XXX.
  3510         16  CF-PLAN-DESCRIPT               PIC X(10).
  3511         16  CF-PLAN-NOTES                  PIC X(20).
  3512         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3513         16  CF-PLAN-UNDERWRITING.
  3514             20  CF-PLAN-TERM-DATA.
  3515                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3516                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3517             20  CF-PLAN-AGE-DATA.
  3518                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3519                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3520                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3521             20  CF-PLAN-BENEFIT-DATA.
  3522                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3523                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3524                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3525                                            PIC S9(7)V99  COMP-3.
  3526         16  CF-PLAN-POLICY-FORMS.
  3527             20  CF-POLICY-FORM             PIC X(12).
  3528             20  CF-MASTER-APPLICATION      PIC X(12).
  3529             20  CF-MASTER-POLICY           PIC X(12).
  3530         16  CF-PLAN-RATING.
  3531             20  CF-RATE-CODE               PIC X(5).
  3532             20  CF-SEX-RATING              PIC X.
  3533                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3534                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3535             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3536             20  CF-SUB-STD-TYPE            PIC X.
  3537                 88  CF-PCT-OF-PREM            VALUE '1'.
  3538                 88  CF-PCT-OF-BENE            VALUE '2'.
  3539         16  CF-PLAN-PREM-TOLERANCES.
  3540             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3541             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3542         16  CF-PLAN-PYMT-TOLERANCES.
  3543             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3544             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3545         16  CF-PLAN-MISC-DATA.
  3546             20  FILLER                     PIC X.
  3547             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3548             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3549         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3550         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  68
* EL151.cbl
  3551             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3552                                                     '1'.
  3553             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3554                                                     '2'.
  3555         16  CF-MIB-SEARCH-SW               PIC X.
  3556             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3557             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3558             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3559             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3560         16  CF-ALPHA-SEARCH-SW             PIC X.
  3561             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3562             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3563             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3564             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3565             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3566             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3567             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3568             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3569             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3570             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3571                                                     'A' 'B' 'C'
  3572                                                     'X' 'Y' 'Z'.
  3573         16  CF-EFF-DT-RULE-SW              PIC X.
  3574             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3575             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3576             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3577             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3578             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3579         16  FILLER                         PIC X(4).
  3580         16  CF-HEALTH-QUESTIONS            PIC X.
  3581             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3582         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3583         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3584         16  CF-PLAN-SNGL-JNT               PIC X.
  3585             88  CF-COMBINED-PLAN              VALUE 'C'.
  3586             88  CF-JNT-PLAN                   VALUE 'J'.
  3587             88  CF-SNGL-PLAN                  VALUE 'S'.
  3588         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3589         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3590         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3591         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3592         16  CF-RERATE-CNTL                 PIC  X.
  3593             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3594             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3595             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3596             88  CF-AUTO-RECALC                 VALUE '4'.
  3597         16  CF-BENEFIT-TYPE                PIC  X.
  3598             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3599             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3600         16  CF-POLICY-FEE                  PIC S999V99
  3601                                                    COMP-3.
  3602         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3603         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3604         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3605         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3606         16  FILLER                         PIC  X(32).
  3607         16  CF-TERMINATION-FORM            PIC  X(04).
  3608         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  69
* EL151.cbl
  3609         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3610                                                       COMP-3.
  3611         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3612         16  CF-ISSUE-LETTER                PIC  X(4).
  3613         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3614         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3615             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3616             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3617         16  CF-MP-REFUND-CALC              PIC X.
  3618             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3619             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3620             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3621             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3622             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3623             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3624             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3625             88  CF-MP-REFD-MEAN                VALUE '8'.
  3626         16  CF-ALT-RATE-CODE               PIC  X(5).
  3627
  3628
  3629         16  FILLER                         PIC X(498).
  3630****************************************************************
  3631*             MORTGAGE COMPANY MASTER RECORD                   *
  3632****************************************************************
  3633
  3634     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3635         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3636         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3637             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3638             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3639             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3640             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3641             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3642
  3643         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3644         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3645         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3646         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3647         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3648
  3649         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3650             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3651         16  CF-MP-RECON-USE-IND            PIC X(1).
  3652             88  CF-MP-USE-RECON             VALUE 'Y'.
  3653         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3654             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3655         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3656             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3657             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3658         16  FILLER                         PIC X(1).
  3659         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3660             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3661         16  CF-MORTG-MIB-VERSION           PIC X.
  3662             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3663             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3664             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3665         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3666             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  70
* EL151.cbl
  3667                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3668             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3669                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3670             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3671                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3672             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3673                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3674             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3675                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3676             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3677                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3678         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3679         16  FILLER                         PIC X(7).
  3680         16  CF-MORTG-DESTINATION-SYMBOL.
  3681             20  CF-MORTG-MIB-COMM          PIC X(5).
  3682             20  CF-MORTG-MIB-TERM          PIC X(5).
  3683         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3684             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3685         16  FILLER                         PIC X(03).
  3686         16  CF-MP-CHECK-NO-CONTROL.
  3687             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3688                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3689                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3690                                                ' ' LOW-VALUES.
  3691                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3692                                               VALUE '3'.
  3693         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3694         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3695         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3696             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3697                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3698             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3699                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3700             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3701                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3702             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3703                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3704             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3705                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3706             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3707                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3708         16  CF-MORTG-BILLING-AREA.
  3709             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3710                                            PIC X.
  3711         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3712         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3713         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3714         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3715             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3716             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3717         16  FILLER                         PIC X.
  3718         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3719             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3720             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3721         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3722         16  FILLER                         PIC X(8).
  3723         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3724         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  71
* EL151.cbl
  3725         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3726         16  CF-ACH-COMPANY-ID.
  3727             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3728                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3729                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3730                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3731             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3732         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3733             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3734         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3735             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3736             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3737         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3738         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3739         16  FILLER                         PIC X(536).
  3740
  3741****************************************************************
  3742*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3743****************************************************************
  3744
  3745     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3746         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3747             20  CF-FEMALE-HEIGHT.
  3748                 24  CF-FEMALE-FT           PIC 99.
  3749                 24  CF-FEMALE-IN           PIC 99.
  3750             20  CF-FEMALE-MIN-WT           PIC 999.
  3751             20  CF-FEMALE-MAX-WT           PIC 999.
  3752         16  FILLER                         PIC X(428).
  3753
  3754     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3755         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3756             20  CF-MALE-HEIGHT.
  3757                 24  CF-MALE-FT             PIC 99.
  3758                 24  CF-MALE-IN             PIC 99.
  3759             20  CF-MALE-MIN-WT             PIC 999.
  3760             20  CF-MALE-MAX-WT             PIC 999.
  3761         16  FILLER                         PIC X(428).
  3762******************************************************************
  3763*             AUTOMATIC ACTIVITY RECORD                          *
  3764******************************************************************
  3765     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3766         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3767             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3768             20  CF-SYS-LETTER-ID           PIC X(04).
  3769             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3770             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3771             20  CF-SYS-RESET-SW            PIC X(01).
  3772             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3773             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3774
  3775         16  FILLER                         PIC X(50).
  3776
  3777         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3778             20  CF-USER-ACTIVE-SW          PIC X(01).
  3779             20  CF-USER-LETTER-ID          PIC X(04).
  3780             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3781             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3782             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  72
* EL151.cbl
  3783             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3784             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3785             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3786
  3787         16  FILLER                         PIC X(246).
  3788*                                    COPY ELCDENY.
  3789******************************************************************
  3790*                                                                *
  3791*                                                                *
  3792*                            ELCDENY                             *
  3793*                            VMOD=2.001                          *
  3794*                                                                *
  3795*   CLAIM SYSTEM DENIAL/RECESSION/REFORMATION TABLE              *
  3796*                                                                *
  3797*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3798*   VSAM DENIAL TABLE                                            *
  3799*                                                                *
  3800*   FILE DESCRIPTION = DENIAL CODE TABLE                         *
  3801*                                                                *
  3802*   FILE TYPE = VSAM,KSDS                                        *
  3803*   RECORD SIZE = 125   RECFORM = FIX                            *
  3804*                                                                *
  3805*   BASE CLUSTER NAME = ELCDENY                   RKP=2,LEN=15   *
  3806*       ALTERNATE PATH1 = ELDENY2 (ALT GROUPING) RKP=17,LEN=16   *
  3807*                                                                *
  3808*   LOG = NO                                                     *
  3809*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3810*                                                                *
  3811*                                                                *
  3812******************************************************************
  3813*                   C H A N G E   L O G
  3814*
  3815* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3816*-----------------------------------------------------------------
  3817*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3818* EFFECTIVE    NUMBER
  3819*-----------------------------------------------------------------
  3820* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  3821******************************************************************
  3822 01  DENIAL-CODES.
  3823     12  DN-RECORD-ID                      PIC XX.
  3824         88  VALID-DN-ID                      VALUE 'DN'.
  3825     12  DN-CONTROL-PRIMARY.
  3826         16  DN-COMPANY-CD                 PIC X.
  3827         16  DN-DENIAL-CODE                PIC X(4).
  3828         16  FILLER                        PIC X(10).
  3829     12  DN-CONTROL-BY-TYPE.
  3830         16  DN-COMPANY-CD-A1              PIC X.
  3831         16  DN-RECORD-TYPE                PIC X.
  3832         16  DN-DENIAL-CODE-A1             PIC X(4).
  3833         16  FILLER                        PIC X(10).
  3834     12  DN-MAINT-INFORMATION.
  3835         16  DN-LAST-MAINT-DT              PIC XX.
  3836         16  DN-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3837         16  DN-LAST-MAINT-USER            PIC X(4).
  3838         16  FILLER                        PIC XX.
  3839     12  DN-DESCRIPTION                    PIC X(50).
  3840     12  FILLER                            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  73
* EL151.cbl
  3841******************************************************************
  3842*                                    COPY ELCDAR.
  3843******************************************************************
  3844*                                                                *
  3845*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  3846*   FILE TYPE = VSAM,KSDS                                        *
  3847*   RECORD SIZE = 25   RECFORM = FIXED                           *
  3848*   BASE CLUSTER = DLYACTV                                       *
  3849*   LOG = YES                                                    *
  3850*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  3851*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  3852*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  3853*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  3854*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  3855*               BY PROGRAM "LGINFCE".                            *
  3856*                                                                *
  3857******************************************************************
  3858 01  DAILY-ACTIVITY-RECORD.
  3859     05  DA-KEY.
  3860         10  DA-COMP-CD          PIC X.
  3861         10  DA-CARRIER          PIC X.
  3862         10  DA-CLAIM-NO         PIC X(7).
  3863         10  DA-CERT-NO.
  3864             15  DA-CERT-PRIME   PIC X(10).
  3865             15  DA-CERT-SFX     PIC X.
  3866     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  3867     05  DA-RECORD-TYPE          PIC X.
  3868     05  FILLER                  PIC X(2).
  3869******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  74
* EL151.cbl
  3871*                                    COPY ERCDMDNT.
  3872******************************************************************
  3873*                                                                *
  3874*                            ERCDMDNT                            *
  3875*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3876*                            VMOD=2.005                          *
  3877*                                                                *
  3878*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  3879*                                                                *
  3880*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  3881*                                                                *
  3882*        FILE TYPE= VSAM,KSDS                                    *
  3883*        RECORD SIZE = 825    RECFORM = FIXED                    *
  3884*                                                                *
  3885*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  3886*                                                                *
  3887*        LOG = YES                                               *
  3888*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  3889*                                                                *
  3890******************************************************************
  3891
  3892 01  CERTIFICATE-NOTE.
  3893     12  CN-RECORD-ID                     PIC  XX.
  3894         88  VALID-CN-ID                      VALUE 'CN'.
  3895
  3896     12  CN-CONTROL-PRIMARY.
  3897         16  CN-COMPANY-CD                PIC X.
  3898         16  CN-CERT-KEY.
  3899             20  CN-CARRIER               PIC X.
  3900             20  CN-GROUPING.
  3901                 24  CN-GROUPING-PREFIX   PIC XXX.
  3902                 24  CN-GROUPING-PRIME    PIC XXX.
  3903             20  CN-STATE                 PIC XX.
  3904             20  CN-ACCOUNT.
  3905                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  3906                 24  CN-ACCOUNT-PRIME     PIC X(6).
  3907             20  CN-CERT-EFF-DT           PIC XX.
  3908             20  CN-CERT-NO.
  3909                 24  CN-CERT-PRIME        PIC X(10).
  3910                 24  CN-CERT-SFX          PIC X.
  3911
  3912     12  CN-BILLING-START-LINE-NO         PIC 99.
  3913     12  CN-BILLING-END-LINE-NO           PIC 99.
  3914
  3915     12  CN-LINES.
  3916         16  CN-LINE                      PIC X(77)  OCCURS 10.
  3917
  3918     12  CN-CSI-NOTES REDEFINES CN-LINES.
  3919         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  3920         16  CN-CSI-GENERAL-DATA-AREA.
  3921             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  3922
  3923         16  CN-CSI-GENERAL-DATA-R REDEFINES
  3924             CN-CSI-GENERAL-DATA-AREA.
  3925             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  3926             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  3927             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  3928             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  75
* EL151.cbl
  3929             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  3930             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  3931             20  CN-CSI-GEN-INFRM-MI          PIC X.
  3932             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  3933             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  3934             20  FILLER                       PIC XX.
  3935             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  3936             20  FILLER                       PIC X(38).
  3937
  3938         16  CN-CSI-PRODUCT-DATA-AREA.
  3939             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  3940
  3941         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  3942             CN-CSI-PRODUCT-DATA-AREA.
  3943             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  3944             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  3945             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  3946             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  3947             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  3948             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  3949             20  FILLER                   PIC XX.
  3950             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  3951             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  3952             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  3953             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  3954             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  3955             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  3956             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  3957             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  3958             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  3959             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  3960             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  3961             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  3962             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  3963             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  3964             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  3965             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  3966             20  CN-CSI-CC-TERM-AGE       PIC 999.
  3967             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  3968             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  3969             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  3970             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  3971             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  3972             20  FILLER                   PIC X(25).
  3973
  3974         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  3975             CN-CSI-CREDIT-CARD-DATA.
  3976             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  3977             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  3978             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  3979             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  3980             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  3981             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  3982             20  FILLER                   PIC XX.
  3983             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  3984             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  3985             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  3986             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  76
* EL151.cbl
  3987             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  3988             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  3989             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  3990             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  3991             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  3992             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  3993             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  3994             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  3995             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  3996             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  3997             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  3998             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  3999             20  CN-CSI-FL-TERM-AGE       PIC 999.
  4000             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  4001             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  4002             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  4003             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  4004             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  4005             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  4006             20  FILLER                   PIC X(17).
  4007
  4008         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  4009             CN-CSI-FAMILY-LEAVE-DATA.
  4010             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  4011             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  4012             20  CN-CSI-SL-BENE-REL       PIC X(8).
  4013             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  4014             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  4015             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  4016             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  4017             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  4018             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  4019             20  CN-CSI-SL-INT-ON-PROCEEDS
  4020                                          PIC S9(5)V99  COMP-3.
  4021             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  4022             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  4023             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  4024             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  4025             20  CN-CSI-SL-POLICY-BENEFITS
  4026                                          PIC S9(5)V99  COMP-3.
  4027             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  4028             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  4029             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  4030             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  4031             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  4032             20  CN-CSI-SL-PREM-MODE      PIC 99.
  4033             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  4034             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  4035             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  4036             20  CN-CSI-SL-STATE-NOT      PIC X.
  4037             20  FILLER                   PIC XX.
  4038
  4039         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  4040             CN-CSI-SENIOR-LIFE-DATA.
  4041             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  4042             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  4043             20  CN-CSI-PP-BEN-PAID-TO-DATE
  4044                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  77
* EL151.cbl
  4045             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  4046             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  4047             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  4048             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  4049             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  4050             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  4051             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  4052             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  4053             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  4054             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  4055             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  4056             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  4057             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  4058             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  4059             20  CN-CSI-PP-REPAIR         PIC X.
  4060             20  CN-CSI-PP-REPLACE        PIC X.
  4061             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  4062             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  4063             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  4064             20  CN-CSI-PP-TERM-AGE       PIC 999.
  4065             20  FILLER                   PIC X(5).
  4066
  4067         16  CN-CSI-EXT-WARR-DATA REDEFINES
  4068             CN-CSI-PURCH-PROP-DATA.
  4069             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  4070             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  4071             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  4072             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  4073             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  4074             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  4075             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  4076             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  4077             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  4078             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  4079             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  4080             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  4081             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  4082             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  4083             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  4084             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  4085             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  4086             20  CN-CSI-EW-REPLACE        PIC X.
  4087             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  4088             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  4089             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  4090             20  CN-CSI-EW-TERM-AGE       PIC 999.
  4091             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  4092             20  FILLER                   PIC X(4).
  4093
  4094     12  CN-LAST-MAINT-DT                 PIC XX.
  4095     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  4096     12  CN-LAST-MAINT-USER               PIC X(4).
  4097     12  FILLER                           PIC X(6).
  4098
  4099******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  78
* EL151.cbl
  4101 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  4102                          ACTIVITY-TRAILERS LETTER-ARCHIVE
  4103                          CONTROL-FILE DENIAL-CODES
  4104                          DAILY-ACTIVITY-RECORD
  4105                          CERTIFICATE-NOTE.
  4106 0000-DFHEXIT SECTION.
  4107     MOVE '9#                    $   ' TO DFHEIV0.
  4108     MOVE 'EL151' TO DFHEIV1.
  4109     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4110
  4111     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  4112     MOVE '5'                    TO DC-OPTION-CODE.
  4113     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  4114     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4115     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4116
  4117 0001-PROCESSING-EXITS.
  4118     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  4119     IF EIBCALEN NOT GREATER THAN ZEROS
  4120       GO TO 8800-UNAUTHORIZED-ACCESS.
  4121
  4122
  4123* EXEC CICS  HANDLE CONDITION
  4124*           ERROR    (9990-ABEND)
  4125*           PGMIDERR (9600-PGMID-ERROR)
  4126*    END-EXEC.
  4127*    MOVE '"$.L                  ! " #00004118' TO DFHEIV0
  4128     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  4129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4130     MOVE X'2220233030303034313138' TO DFHEIV0(25:11)
  4131     CALL 'kxdfhei1' USING DFHEIV0
  4132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4133
  4134
  4135     IF PI-CALLING-PROGRAM  NOT  = THIS-PGM
  4136         IF PI-RETURN-TO-PROGRAM NOT  =  THIS-PGM
  4137             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  4138             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  4139             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  4140             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  4141             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  4142             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  4143             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  4144             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  4145         ELSE
  4146             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  4147             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  4148             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  4149             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  4150             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  4151             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  4152             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  4153             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  4154
  4155     IF EIBAID IS EQUAL TO DFHCLEAR
  4156         GO TO 9400-CLEAR.
  4157
  4158     IF PI-PROCESSOR-ID = 'LGXX'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  79
* EL151.cbl
  4159         NEXT SENTENCE
  4160     ELSE
  4161
  4162* EXEC CICS READQ TS
  4163*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4164*            INTO    (SECURITY-CONTROL)
  4165*            LENGTH  (SC-COMM-LENGTH)
  4166*            ITEM    (SC-ITEM)
  4167*        END-EXEC
  4168*    MOVE '*$II   L              ''   #00004149' TO DFHEIV0
  4169     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4170     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4171     MOVE X'2020233030303034313439' TO DFHEIV0(25:11)
  4172     CALL 'kxdfhei1' USING DFHEIV0,
  4173           PI-SECURITY-TEMP-STORE-ID,
  4174           SECURITY-CONTROL,
  4175           SC-COMM-LENGTH,
  4176           SC-ITEM,
  4177           DFHEIV99,
  4178           DFHEIV99
  4179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4180         MOVE SC-CLAIMS-DISPLAY (6)    TO  PI-DISPLAY-CAP
  4181         MOVE SC-CLAIMS-UPDATE  (6)    TO  PI-MODIFY-CAP.
  4182
  4183     IF EIBTRNID IS EQUAL TO WS-TRANS-ID
  4184         GO TO 0200-RECEIVE.
  4185
  4186 0100-FIRST-TIME-IN.
  4187
  4188     MOVE LOW-VALUES                 TO  EL151AO
  4189     MOVE -1                         TO  MLINE1L
  4190     MOVE 1                          TO  EMI-NUMBER-OF-LINES.
  4191
  4192     MOVE SPACE                      TO  DC-ERROR-CODE
  4193                                         WS-CLAIM-SEQ-SW
  4194                                         MERMSG2O.
  4195
  4196     MOVE '153A'                     TO  PI-CURRENT-SCREEN-NO.
  4197
  4198     MOVE 0                          TO  PI-PROOF-DATE.
  4199     PERFORM 3550-FIND-LETTER-TRLR THRU 3550-EXIT.
  4200
  4201     GO TO 8100-SEND-INITIAL-MAP.
  4202
  4203 0200-RECEIVE.
  4204
  4205     MOVE LOW-VALUES              TO  EL151AI.
  4206
  4207     IF (EIBAID IS EQUAL TO DFHPA1 OR DFHPA2 OR DFHPA3)
  4208         MOVE ER-0008             TO  EMI-ERROR
  4209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4210         MOVE -1                  TO  MPFNUMBL
  4211         GO TO 8200-SEND-DATAONLY.
  4212
  4213
  4214* EXEC CICS RECEIVE
  4215*        MAP      (MAP-NAME)
  4216*        MAPSET   (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  80
* EL151.cbl
  4217*        INTO     (EL151AI)
  4218*    END-EXEC.
  4219     MOVE LENGTH OF
  4220      EL151AI
  4221       TO DFHEIV11
  4222*    MOVE '8"T I  L              ''   #00004188' TO DFHEIV0
  4223     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4224     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4225     MOVE X'2020233030303034313838' TO DFHEIV0(25:11)
  4226     CALL 'kxdfhei1' USING DFHEIV0,
  4227           MAP-NAME,
  4228           EL151AI,
  4229           DFHEIV11,
  4230           MAPSET-NAME,
  4231           DFHEIV99,
  4232           DFHEIV99
  4233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4234
  4235
  4236     IF MPFNUMBL IS EQUAL TO +0
  4237         GO TO 0300-CHECK-PFKEYS.
  4238
  4239     IF EIBAID IS NOT EQUAL TO DFHENTER
  4240         MOVE ER-0004             TO  EMI-ERROR
  4241         GO TO 0320-INPUT-ERROR.
  4242
  4243     IF (MPFNUMBI NUMERIC) AND (MPFNUMBI GREATER 0 AND LESS 25)
  4244         MOVE PF-VALUES (MPFNUMBI)    TO  EIBAID
  4245     ELSE
  4246         MOVE ER-0029                 TO  EMI-ERROR
  4247         GO TO 0320-INPUT-ERROR.
  4248
  4249 0300-CHECK-PFKEYS.
  4250
  4251     IF EIBAID IS EQUAL TO DFHPF12
  4252        MOVE  'EL010'            TO  THIS-PGM
  4253        GO TO 9300-XCTL.
  4254
  4255     IF EIBAID IS EQUAL TO DFHPF23
  4256        MOVE EIBAID              TO  PI-ENTRY-CD-1
  4257        MOVE 'EL005'             TO  THIS-PGM
  4258        GO TO 9300-XCTL.
  4259
  4260     IF EIBAID IS EQUAL TO DFHPF24
  4261        MOVE EIBAID              TO  PI-ENTRY-CD-1
  4262        MOVE  'EL126'            TO  THIS-PGM
  4263        GO TO 9300-XCTL.
  4264
  4265     IF EIBAID IS EQUAL TO DFHENTER
  4266        GO TO 0330-EDIT-DATA.
  4267
  4268     MOVE ER-0029                TO  EMI-ERROR.
  4269
  4270 0320-INPUT-ERROR.
  4271     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4272
  4273     MOVE -1                     TO  MPFNUMBL.
  4274     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  81
* EL151.cbl
  4275
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  82
* EL151.cbl
  4277 0330-EDIT-DATA.
  4278     IF NOT MODIFY-CAP
  4279        MOVE 'UPDATE'             TO  SM-READ
  4280        PERFORM 9995-SECURITY-VIOLATION
  4281        MOVE ER-0070              TO  EMI-ERROR
  4282        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4283        GO TO 8100-SEND-INITIAL-MAP.
  4284
  4285     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CID' OR 'DCC'
  4286                     OR 'AHL' or 'VPP' or 'FNL'
  4287         IF MLINE1I = (LOW-VALUES OR SPACES) AND
  4288            MLINE2I = (LOW-VALUES OR SPACES) AND
  4289            MDENCDI = (LOW-VALUES OR SPACES)
  4290             MOVE ER-0483        TO  EMI-ERROR
  4291             MOVE -1             TO  MLINE1L
  4292             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4293             GO TO 8100-SEND-INITIAL-MAP
  4294         ELSE
  4295             NEXT SENTENCE
  4296     ELSE
  4297         IF MLINE1I  = (LOW-VALUES OR SPACES)  AND
  4298            MLINE2I  = (LOW-VALUES OR SPACES)
  4299             MOVE ER-0483        TO  EMI-ERROR
  4300             MOVE -1             TO  MLINE1L
  4301             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4302             GO TO 8100-SEND-INITIAL-MAP.
  4303
  4304     IF MPRFDTL > 0
  4305         MOVE MPRFDTI TO DEEDIT-FIELD
  4306         PERFORM 9650-DEEDIT      THRU 9650-EXIT
  4307         MOVE DEEDIT-FIELD-V0  TO PI-PROOF-DATE
  4308         MOVE PI-PROOF-DATE    TO MPRFDTO
  4309         INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  4310     END-IF.
  4311
  4312     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES
  4313*     IF  MPRFDTI  = LOW-VALUES OR SPACES
  4314         MOVE ER-0872             TO EMI-ERROR
  4315         MOVE -1                  TO MPRFDTL
  4316         MOVE AL-UABON            TO MPRFDTA
  4317         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4318         GO TO 8200-SEND-DATAONLY
  4319     END-IF.
  4320
  4321     IF  PI-PROOF-DATE > 0
  4322         MOVE PI-PROOF-DATE       TO DEEDIT-FIELD
  4323         PERFORM 9650-DEEDIT      THRU 9650-EXIT
  4324         MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  4325         MOVE '4'                 TO DC-OPTION-CODE
  4326         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
  4327         IF DATE-CONVERSION-ERROR
  4328            MOVE ER-0021          TO EMI-ERROR
  4329            MOVE -1               TO MPRFDTL
  4330            MOVE AL-UABON         TO MPRFDTA
  4331            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4332            GO TO 8200-SEND-DATAONLY
  4333         ELSE
  4334            IF DC-BIN-DATE-1 > SAVE-BIN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  83
* EL151.cbl
  4335                MOVE ER-0873      TO EMI-ERROR
  4336                MOVE -1           TO MPRFDTL
  4337                MOVE AL-UABON     TO MPRFDTA
  4338                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4339                GO TO 8200-SEND-DATAONLY
  4340            ELSE
  4341                MOVE DC-BIN-DATE-1    TO WS-PRF-DT
  4342                MOVE DEEDIT-FIELD-V0  TO PI-PROOF-DATE
  4343                MOVE PI-PROOF-DATE    TO MPRFDTO
  4344                INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  4345            END-IF
  4346         END-IF
  4347     END-IF.
  4348
  4349     MOVE LOW-VALUES             TO  WS-TRAILER-KEY.
  4350     MOVE PI-COMPANY-CD          TO  WS-KEY-COMPANY-CD.
  4351     MOVE PI-CARRIER             TO  WS-KEY-CARRIER.
  4352     MOVE PI-CLAIM-NO            TO  WS-KEY-CLAIM-NO.
  4353     MOVE PI-CERT-NO             TO  WS-KEY-CERT-NO.
  4354
  4355     PERFORM 7000-READ-ELMSTR-UPDATE THRU 7000-EXIT.
  4356
  4357     IF CL-LAST-TRL-AVAIL
  4358         MOVE ER-0137            TO  EMI-ERROR
  4359         MOVE -1                 TO  MLINE1L
  4360         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4361         GO TO 8200-SEND-DATAONLY.
  4362     if ws-prf-dt < cl-incurred-dt
  4363        MOVE ER-0873             TO EMI-ERROR
  4364        MOVE -1                  TO MPRFDTL
  4365        MOVE AL-UABON            TO MPRFDTA
  4366        PERFORM 9900-ERROR-FORMAT
  4367                                 THRU 9900-EXIT
  4368        GO TO 8200-SEND-DATAONLY
  4369     end-if
  4370     MOVE CL-TRAILER-SEQ-CNT     TO  WS-ORIG-SEQ-CNT.
  4371     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  4372     MOVE CL-TRAILER-SEQ-CNT     TO  WS-SEQ-NO-SAVED.
  4373     MOVE 'C'                    TO  CL-CLAIM-STATUS.
  4374     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
  4375     MOVE '3'                    TO  CL-LAST-MAINT-TYPE.
  4376     MOVE '2'                    TO  CL-LAST-CLOSE-REASON.
  4377     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
  4378     MOVE SAVE-BIN-DATE          TO  CL-LAST-MAINT-DT
  4379                                     CL-LAST-CLOSE-DT.
  4380
  4381     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  4382         IF MDENCDL IS GREATER THAN +0
  4383             MOVE MDENCDI        TO  CL-FILE-LOCATION.
  4384
  4385*************************************************************
  4386*****         START BUILDING ACTIVITY RECORD HERE          **
  4387*************************************************************
  4388     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL' OR 'FNL'
  4389         PERFORM 2300-GETMAIN-DLYACTV THRU
  4390                 2300-EXIT
  4391         PERFORM 3500-BUILD-ACTIVITY-RECORD THRU
  4392                 3500-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  84
* EL151.cbl
  4393         PERFORM 2350-WRITE-DLYACTV THRU
  4394                 2350-EXIT
  4395     END-IF.
  4396
  4397*************************************************************
  4398*****            END OF BUILDING ACTIVITY RECORD           **
  4399*************************************************************
  4400
  4401     PERFORM 7120-READ-ELTRLR-UPDATE THRU 7120-EXIT.
  4402
  4403     MOVE +1                     TO  MISC-SUB.
  4404     MOVE SPACES                 TO  WS-OC-LOAD-SW.
  4405     PERFORM 1000-SET-OPEN-CLOSE-HIST THRU 1000-EXIT.
  4406
  4407     MOVE +01                    TO  TR-SUB
  4408                                     TR-SUB-2.
  4409     PERFORM 1010-UPDATE-TR1-OC   THRU 1010-EXIT
  4410             UNTIL  OC-HISTORY-LOADED.
  4411
  4412     MOVE PI-PROCESSOR-ID        TO AT-RESERVES-LAST-UPDATED-BY
  4413     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  4414     MOVE SAVE-BIN-DATE          TO AT-RESERVES-LAST-MAINT-DT.
  4415
  4416     IF PI-COMPANY-ID = 'DMD'
  4417         PERFORM 2000-CREATE-DMD-DMO  THRU  2000-EXIT.
  4418
  4419     PERFORM 7130-REWRITE-ELTRLR THRU 7130-EXIT.
  4420
  4421     PERFORM 7100-GETMAIN-ELTRLR  THRU 7100-EXIT.
  4422     PERFORM 1050-BUILD-DENIAL-TRLR THRU 1090-EXIT.
  4423
  4424     PERFORM 7110-WRITE-ELTRLR    THRU 7110-EXIT.
  4425
  4426     PERFORM 6100-CHECK-AUTO-ACTIVITY THRU 6100-EXIT.
  4427
  4428     IF WS-REC-FOUND-SW IS EQUAL TO 'N'
  4429         GO TO 0340-FINISH-EDIT-DATA.
  4430
  4431     IF CL-ACTIVITY-CODE IS EQUAL TO 09
  4432         GO TO 0340-FINISH-EDIT-DATA.
  4433
  4434     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK') AND
  4435        (CL-ACTIVITY-CODE IS EQUAL TO 11)
  4436         GO TO 0340-FINISH-EDIT-DATA.
  4437
  4438     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  4439         PERFORM 6000-RESET-AUTO-ACTIVITY THRU 6000-EXIT
  4440         IF WS-UPDATE-SW IS EQUAL TO 'Y'
  4441             MOVE LOW-VALUES         TO  CL-NEXT-RESEND-DT
  4442                                         CL-NEXT-FOLLOWUP-DT.
  4443
  4444     IF WS-RESET-SW IS EQUAL TO 'Y'
  4445         MOVE ZEROS                  TO  CL-ACTIVITY-CODE
  4446         MOVE SAVE-BIN-DATE          TO  CL-ACTIVITY-MAINT-DT
  4447         MOVE 'DENY'                 TO  CL-ACTIVITY-MAINT-TYPE.
  4448
  4449 0340-FINISH-EDIT-DATA.
  4450
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  85
* EL151.cbl
  4451     PERFORM 7010-REWRITE-ELMSTR  THRU 7010-EXIT.
  4452
  4453     MOVE ER-0000                TO EMI-ERROR.
  4454     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4455     MOVE -1                     TO MLINE1L.
  4456*    MOVE LOW-VALUES             TO MLINE1O
  4457*                                   MLINE2O
  4458*                                   MDENCDO.
  4459     GO TO 8200-SEND-DATAONLY.
  4460
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  86
* EL151.cbl
  4462 1000-SET-OPEN-CLOSE-HIST.
  4463     PERFORM 1000-BUMP-OPEN-CLOSE-HIST UNTIL
  4464        (MISC-SUB GREATER THAN +6 OR
  4465        AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES).
  4466
  4467     IF MISC-SUB GREATER THAN +1
  4468        SUBTRACT +1 FROM MISC-SUB
  4469        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = 'C'
  4470           MOVE SAVE-BIN-DATE   TO AT-OPEN-CLOSE-DATE (MISC-SUB)
  4471           MOVE 'C'             TO AT-OPEN-CLOSE-TYPE (MISC-SUB)
  4472           MOVE 'DENIED'        TO AT-OPEN-CLOSE-REASON (MISC-SUB)
  4473           MOVE 'X'             TO WS-OC-LOAD-SW.
  4474
  4475     GO TO 1000-EXIT.
  4476
  4477 1000-BUMP-OPEN-CLOSE-HIST.
  4478     ADD +1 TO MISC-SUB.
  4479
  4480 1000-EXIT.
  4481     EXIT.
  4482
  4483 1010-UPDATE-TR1-OC.
  4484     IF  AT-OPEN-CLOSE-DATE (TR-SUB) = (LOW-VALUE OR SPACES)
  4485         MOVE SAVE-BIN-DATE      TO AT-OPEN-CLOSE-DATE (TR-SUB)
  4486         MOVE 'C'                TO AT-OPEN-CLOSE-TYPE (TR-SUB)
  4487         MOVE 'DENIED'           TO AT-OPEN-CLOSE-REASON (TR-SUB)
  4488         MOVE 'X'                TO WS-OC-LOAD-SW
  4489         GO TO 1010-EXIT.
  4490
  4491     ADD 1  TO TR-SUB.
  4492     IF  TR-SUB  GREATER THAN 6
  4493         MOVE +01                TO TR-SUB
  4494         MOVE +02                TO TR-SUB-2
  4495         PERFORM 1020-BUMP    THRU 1020-EXIT
  4496          UNTIL TR-SUB-2 GREATER THAN 6
  4497         MOVE SPACES             TO AT-OPEN-CLOSE-DATE (TR-SUB).
  4498
  4499 1010-EXIT.
  4500      EXIT.
  4501
  4502 1020-BUMP.
  4503     MOVE AT-OPEN-CLOSE-DATE (TR-SUB-2) TO
  4504                           AT-OPEN-CLOSE-DATE (TR-SUB).
  4505     MOVE AT-OPEN-CLOSE-TYPE (TR-SUB-2) TO
  4506                           AT-OPEN-CLOSE-TYPE (TR-SUB).
  4507     MOVE AT-OPEN-CLOSE-REASON (TR-SUB-2) TO
  4508                           AT-OPEN-CLOSE-REASON (TR-SUB).
  4509
  4510     ADD +1  TO TR-SUB
  4511                TR-SUB-2.
  4512
  4513 1020-EXIT.
  4514     EXIT.
  4515
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  87
* EL151.cbl
  4517 1050-BUILD-DENIAL-TRLR.
  4518
  4519     MOVE 'AT'                   TO AT-RECORD-ID.
  4520     MOVE '8'                    TO AT-TRAILER-TYPE.
  4521
  4522*DLO023
  4523     IF PI-COMPANY-ID NOT = 'DMD'
  4524         GO TO 1055-EDIT-CID-CODE
  4525     END-IF
  4526
  4527     IF MDENCDL GREATER +0
  4528         MOVE 'CL'               TO DL23-SYSTEM-ID
  4529         MOVE 'DN'               TO DL23-RECORD-TYPE
  4530         MOVE MDENCDI            TO DL23-RECORD-KEY
  4531
  4532* EXEC CICS LINK
  4533*            PROGRAM    ('DLO023')
  4534*            COMMAREA   (WS-DLO-CODES-TABLE)
  4535*            LENGTH     (DL23-COMM-LENGTH)
  4536*        END-EXEC
  4537     MOVE 'DLO023' TO DFHEIV1
  4538*    MOVE '."C                   (   #00004489' TO DFHEIV0
  4539     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4540     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4541     MOVE X'2020233030303034343839' TO DFHEIV0(25:11)
  4542     CALL 'kxdfhei1' USING DFHEIV0,
  4543           DFHEIV1,
  4544           WS-DLO-CODES-TABLE,
  4545           DL23-COMM-LENGTH,
  4546           DFHEIV99,
  4547           DFHEIV99,
  4548           DFHEIV99,
  4549           DFHEIV99
  4550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4551         IF DL23-RETURN-CODE = 'OK'
  4552             MOVE AL-UANON       TO MDENCDA
  4553          ELSE
  4554             MOVE AL-UABON       TO MDENCDA
  4555             MOVE -1             TO MDENCDL
  4556             MOVE ER-0884        TO EMI-ERROR
  4557             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4558             PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  4559             PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4560             GO TO 8200-SEND-DATAONLY.
  4561
  4562     IF MLINE1I = LOW-VALUES OR SPACES
  4563         MOVE SPACES         TO AT-DENIAL-INFO-1
  4564      ELSE
  4565         MOVE MLINE1I        TO AT-DENIAL-INFO-1.
  4566
  4567     GO TO 1070-CONTINUE.
  4568
  4569 1055-EDIT-CID-CODE.
  4570     IF MDENCDL > +0
  4571        MOVE LOW-VALUES          TO WS-ELDENY-KEY
  4572        MOVE PI-COMPANY-CD       TO ELDENY-COMPANY-CD
  4573        MOVE MDENCDI             TO ELDENY-DENIAL-CODE
  4574
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  88
* EL151.cbl
  4575* EXEC CICS READ
  4576*          DATASET('ELDENY')
  4577*          SET    (ADDRESS OF DENIAL-CODES)
  4578*          RIDFLD (WS-ELDENY-KEY)
  4579*          RESP   (WS-RESPONSE)
  4580*       END-EXEC
  4581     MOVE 'ELDENY' TO DFHEIV1
  4582*    MOVE '&"S        E          (  N#00004517' TO DFHEIV0
  4583     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4584     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4585     MOVE X'204E233030303034353137' TO DFHEIV0(25:11)
  4586     CALL 'kxdfhei1' USING DFHEIV0,
  4587           DFHEIV1,
  4588           DFHEIV20,
  4589           DFHEIV99,
  4590           WS-ELDENY-KEY,
  4591           DFHEIV99,
  4592           DFHEIV99,
  4593           DFHEIV99
  4594     SET ADDRESS OF DENIAL-CODES TO
  4595         DFHEIV20
  4596     MOVE EIBRESP  TO WS-RESPONSE
  4597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4598        IF RESP-NORMAL
  4599           IF MLINE1L > +0
  4600              STRING DN-DESCRIPTION ' ' MLINE1I
  4601                 DELIMITED BY '  ' INTO AT-DENIAL-INFO-1
  4602              END-STRING
  4603           ELSE
  4604              MOVE DN-DESCRIPTION
  4605                                 TO AT-DENIAL-INFO-1
  4606           END-IF
  4607           MOVE DN-RECORD-TYPE   TO CL-DENIAL-TYPE
  4608           MOVE AT-DENIAL-INFO-1 TO MLINE1O
  4609           MOVE +1               TO MLINE1L
  4610           MOVE AL-UANON         TO MLINE1A
  4611           MOVE DN-RECORD-TYPE
  4612                                 TO CL-DENIAL-TYPE
  4613        ELSE
  4614           MOVE AL-UABON         TO MDENCDA
  4615           MOVE -1               TO MDENCDL
  4616           MOVE ER-0884          TO EMI-ERROR
  4617           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4618           PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  4619           PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4620           GO TO 8200-SEND-DATAONLY
  4621        END-IF
  4622     ELSE
  4623        MOVE AL-UABON            TO MDENCDA
  4624        MOVE -1                  TO MDENCDL
  4625        MOVE ER-0884             TO EMI-ERROR
  4626        PERFORM 9900-ERROR-FORMAT
  4627                                 THRU 9900-EXIT
  4628        PERFORM 2250-UNLOCK-CLAIM-MSTR
  4629                                 THRU 2250-EXIT
  4630        PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4631        GO TO 8200-SEND-DATAONLY
  4632     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  89
* EL151.cbl
  4633     GO TO 1070-CONTINUE
  4634     .
  4635 1060-CONTINUE.
  4636     IF MDENCDL IS GREATER THAN +0
  4637         SET DEN-INDEX TO +1
  4638         SEARCH DEN-TABLE VARYING DEN-INDEX
  4639             AT END
  4640                 MOVE MLINE1I                TO  AT-DENIAL-INFO-1
  4641         WHEN MDENCDI IS EQUAL TO DENIAL-CODE (DEN-INDEX)
  4642             MOVE DENIAL-DESC (DEN-INDEX)    TO  AT-DENIAL-INFO-1
  4643                                                 MLINE1O
  4644     ELSE
  4645         IF MLINE1I = LOW-VALUES OR SPACES
  4646             MOVE SPACES         TO AT-DENIAL-INFO-1
  4647         ELSE
  4648             MOVE MLINE1I        TO AT-DENIAL-INFO-1.
  4649
  4650 1070-CONTINUE.
  4651     IF  MLINE2I  = LOW-VALUES OR SPACES
  4652         MOVE  SPACES            TO AT-DENIAL-INFO-2
  4653     ELSE
  4654         MOVE MLINE2I            TO AT-DENIAL-INFO-2.
  4655
  4656     IF (AT-DENIAL-INFO-1 IS EQUAL TO SPACES OR LOW-VALUES)
  4657         MOVE AT-DENIAL-INFO-2   TO AT-DENIAL-INFO-1
  4658         MOVE SPACES             TO AT-DENIAL-INFO-2.
  4659
  4660     MOVE WS-PRF-DT              TO AT-DENIAL-PROOF-DT.
  4661     MOVE WS-SEQ-NO-SAVED        TO WS-KEY-SEQUENCE-NO.
  4662
  4663     MOVE WS-TRAILER-KEY         TO AT-CONTROL-PRIMARY.
  4664     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  4665                                    AT-DENIAL-LAST-UPDATED-BY.
  4666     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  4667     MOVE SAVE-BIN-DATE          TO AT-RECORDED-DT
  4668                                    AT-DENIAL-DT
  4669                                    AT-DENIAL-LAST-MAINT-DT.
  4670     MOVE MDENCDI                TO AT-DENIAL-REASON-CODE.
  4671     MOVE LOW-VALUES             TO AT-RETRACTION-DT.
  4672
  4673 1090-EXIT.
  4674      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  90
* EL151.cbl
  4676******************************************************************
  4677*    DMD ONLY  -  CREATE THE DIRECT MARKETING OUTPUT FILE
  4678******************************************************************
  4679 2000-CREATE-DMD-DMO.
  4680
  4681     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
  4682     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
  4683     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
  4684
  4685
  4686* EXEC CICS HANDLE CONDITION
  4687*         NOTFND   (2000-NOTE-NOT-FOUND)
  4688*         END-EXEC.
  4689*    MOVE '"$I                   ! # #00004610' TO DFHEIV0
  4690     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4691     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4692     MOVE X'2320233030303034363130' TO DFHEIV0(25:11)
  4693     CALL 'kxdfhei1' USING DFHEIV0
  4694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4695
  4696
  4697
  4698* EXEC CICS READ
  4699*         DATASET('ERNOTE')
  4700*         SET    (ADDRESS OF CERTIFICATE-NOTE)
  4701*         RIDFLD (W-NOTE-KEY)
  4702*         END-EXEC.
  4703     MOVE 'ERNOTE' TO DFHEIV1
  4704*    MOVE '&"S        E          (   #00004614' TO DFHEIV0
  4705     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4706     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4707     MOVE X'2020233030303034363134' TO DFHEIV0(25:11)
  4708     CALL 'kxdfhei1' USING DFHEIV0,
  4709           DFHEIV1,
  4710           DFHEIV20,
  4711           DFHEIV99,
  4712           W-NOTE-KEY,
  4713           DFHEIV99,
  4714           DFHEIV99,
  4715           DFHEIV99
  4716     SET ADDRESS OF CERTIFICATE-NOTE TO
  4717         DFHEIV20
  4718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4719
  4720
  4721     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
  4722     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
  4723     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
  4724
  4725     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
  4726         MOVE 'CC'               TO DCT-PRODUCT-CODE
  4727     ELSE
  4728         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
  4729
  4730     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
  4731     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
  4732
  4733
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  91
* EL151.cbl
  4734* EXEC CICS LINK
  4735*        PROGRAM    ('DLO006')
  4736*        COMMAREA   (DCT-COMMUNICATION-AREA)
  4737*        LENGTH     (WS-DCT-LENGTH)
  4738*    END-EXEC.
  4739     MOVE 'DLO006' TO DFHEIV1
  4740*    MOVE '."C                   (   #00004632' TO DFHEIV0
  4741     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4742     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4743     MOVE X'2020233030303034363332' TO DFHEIV0(25:11)
  4744     CALL 'kxdfhei1' USING DFHEIV0,
  4745           DFHEIV1,
  4746           DCT-COMMUNICATION-AREA,
  4747           WS-DCT-LENGTH,
  4748           DFHEIV99,
  4749           DFHEIV99,
  4750           DFHEIV99,
  4751           DFHEIV99
  4752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4753
  4754
  4755     IF  DCT-RETURN-CODE = 'OK'
  4756         GO TO 2000-CONT.
  4757
  4758     IF  DCT-RETURN-CODE = '01' OR '02'
  4759         GO TO 2000-EXIT.
  4760
  4761     IF  DCT-RETURN-CODE = '03'
  4762         MOVE ER-0951            TO EMI-ERROR
  4763         MOVE -1                 TO MLINE1L
  4764         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4765         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4766             THRU 2250-EXIT
  4767         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4768         GO TO 8200-SEND-DATAONLY.
  4769
  4770     IF  DCT-RETURN-CODE = '06'
  4771         MOVE ER-0921            TO EMI-ERROR
  4772         MOVE -1                 TO MLINE1L
  4773         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4774         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4775             THRU 2250-EXIT
  4776         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4777         GO TO 8200-SEND-DATAONLY.
  4778
  4779     IF  DCT-RETURN-CODE = '07'
  4780         MOVE ER-0919            TO EMI-ERROR
  4781         MOVE -1                 TO MLINE1L
  4782         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4783         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4784             THRU 2250-EXIT
  4785         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4786         GO TO 8200-SEND-DATAONLY.
  4787
  4788     IF  DCT-RETURN-CODE = '04'
  4789         MOVE ER-0946            TO EMI-ERROR
  4790         MOVE -1                 TO MLINE1L
  4791         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  92
* EL151.cbl
  4792         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4793             THRU 2250-EXIT
  4794         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4795         GO TO 8200-SEND-DATAONLY.
  4796
  4797     IF  DCT-RETURN-CODE = '05'
  4798         MOVE ER-0947            TO EMI-ERROR
  4799         MOVE -1                 TO MLINE1L
  4800         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4801         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4802             THRU 2250-EXIT
  4803         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4804         GO TO 8200-SEND-DATAONLY.
  4805
  4806     IF  DCT-RETURN-CODE = '08'
  4807         MOVE ER-0948            TO EMI-ERROR
  4808         MOVE -1                 TO MLINE1L
  4809         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4810         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4811             THRU 2250-EXIT
  4812         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4813         GO TO 8200-SEND-DATAONLY.
  4814
  4815     IF  DCT-RETURN-CODE = 'N1'
  4816         MOVE ER-0950            TO EMI-ERROR
  4817         MOVE -1                 TO MLINE1L
  4818         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4819         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4820             THRU 2250-EXIT
  4821         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4822         GO TO 8200-SEND-DATAONLY.
  4823
  4824     IF DCT-RETURN-CODE = 'E1'
  4825         MOVE ER-0974            TO EMI-ERROR
  4826         MOVE -1                 TO MLINE1L
  4827         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4828         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4829             THRU 2250-EXIT
  4830         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4831         GO TO 8200-SEND-DATAONLY.
  4832
  4833     IF DCT-RETURN-CODE = 'E2'
  4834         MOVE ER-0975            TO EMI-ERROR
  4835         MOVE -1                 TO MLINE1L
  4836         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4837         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4838             THRU 2250-EXIT
  4839         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4840         GO TO 8200-SEND-DATAONLY.
  4841
  4842     IF DCT-RETURN-CODE NOT = 'OK'
  4843         MOVE ER-0949            TO EMI-ERROR
  4844         MOVE -1                 TO MLINE1L
  4845         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4846         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4847             THRU 2250-EXIT
  4848         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4849         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  93
* EL151.cbl
  4850
  4851 2000-CONT.
  4852
  4853     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
  4854     MOVE 'CS'                   TO DM-RECORD-TYPE.
  4855     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
  4856     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
  4857     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
  4858     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
  4859     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
  4860
  4861     MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1.
  4862     MOVE ' '                    TO  DC-OPTION-CODE.
  4863     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  4864     MOVE DC-GREG-DATE-1-YMD     TO  DMD-YYMMDD.
  4865
  4866     IF DMD-YY GREATER THAN 70
  4867         MOVE '19'               TO  DMD-DECADE
  4868     ELSE
  4869         MOVE '20'               TO  DMD-DECADE.
  4870
  4871     MOVE DMD-DATE-YYYYMMDD      TO  DM-STATUS-DATE.
  4872     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
  4873     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
  4874     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
  4875     PERFORM 2100-FORMAT-LAST-NAME-1ST THRU 2100-EXIT.
  4876     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
  4877
  4878     MOVE 'D'                    TO DM-STAT-CHANGE-TYPE.
  4879     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
  4880     MOVE '3'                    TO DM-CLAIM-STATUS.
  4881
  4882
  4883* EXEC CICS LINK
  4884*        PROGRAM    ('DLO025')
  4885*        COMMAREA   (DMO-COMMUNICATION-AREA)
  4886*        LENGTH     (WS-DMO-LENGTH)
  4887*    END-EXEC.
  4888     MOVE 'DLO025' TO DFHEIV1
  4889*    MOVE '."C                   (   #00004765' TO DFHEIV0
  4890     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4891     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4892     MOVE X'2020233030303034373635' TO DFHEIV0(25:11)
  4893     CALL 'kxdfhei1' USING DFHEIV0,
  4894           DFHEIV1,
  4895           DMO-COMMUNICATION-AREA,
  4896           WS-DMO-LENGTH,
  4897           DFHEIV99,
  4898           DFHEIV99,
  4899           DFHEIV99,
  4900           DFHEIV99
  4901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4902
  4903
  4904     IF  DM-RETURN-CODE = 'OK'
  4905         GO TO 2000-EXIT.
  4906
  4907     IF  DM-RETURN-CODE = '01'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  94
* EL151.cbl
  4908         MOVE ER-8051            TO EMI-ERROR
  4909         MOVE -1                 TO MLINE1L
  4910         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4911         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4912             THRU 2250-EXIT
  4913         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4914         GO TO 8200-SEND-DATAONLY.
  4915
  4916     IF  DM-RETURN-CODE = '02'
  4917         MOVE ER-8052            TO EMI-ERROR
  4918         MOVE -1                 TO MLINE1L
  4919         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4920         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4921             THRU 2250-EXIT
  4922         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4923         GO TO 8200-SEND-DATAONLY.
  4924
  4925     IF  DM-RETURN-CODE = '03'
  4926         MOVE ER-8053            TO EMI-ERROR
  4927         MOVE -1                 TO MLINE1L
  4928         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4929         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4930             THRU 2250-EXIT
  4931         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4932         GO TO 8200-SEND-DATAONLY.
  4933
  4934     IF  DM-RETURN-CODE = '04'
  4935         MOVE ER-8054            TO EMI-ERROR
  4936         MOVE -1                 TO MLINE1L
  4937         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4938         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4939             THRU 2250-EXIT
  4940         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4941         GO TO 8200-SEND-DATAONLY.
  4942
  4943     IF  DM-RETURN-CODE = '05'
  4944         MOVE ER-8055            TO EMI-ERROR
  4945         MOVE -1                 TO MLINE1L
  4946         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4947         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4948             THRU 2250-EXIT
  4949         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4950         GO TO 8200-SEND-DATAONLY.
  4951
  4952     IF  DM-RETURN-CODE = '06'
  4953         MOVE ER-8056            TO EMI-ERROR
  4954         MOVE -1                 TO MLINE1L
  4955         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4956         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4957             THRU 2250-EXIT
  4958         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4959         GO TO 8200-SEND-DATAONLY.
  4960
  4961     IF  DM-RETURN-CODE = '07'
  4962         MOVE ER-8057            TO EMI-ERROR
  4963         MOVE -1                 TO MLINE1L
  4964         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4965         PERFORM 2250-UNLOCK-CLAIM-MSTR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  95
* EL151.cbl
  4966             THRU 2250-EXIT
  4967         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4968         GO TO 8200-SEND-DATAONLY.
  4969
  4970     IF  DM-RETURN-CODE = '08'
  4971         MOVE ER-8058            TO EMI-ERROR
  4972         MOVE -1                 TO MLINE1L
  4973         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4974         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4975             THRU 2250-EXIT
  4976         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4977         GO TO 8200-SEND-DATAONLY.
  4978
  4979     IF  DM-RETURN-CODE = '09'
  4980         MOVE ER-8059            TO EMI-ERROR
  4981         MOVE -1                 TO MLINE1L
  4982         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4983         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4984             THRU 2250-EXIT
  4985         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4986         GO TO 8200-SEND-DATAONLY.
  4987
  4988     IF  DM-RETURN-CODE = '10'
  4989         MOVE ER-8060            TO EMI-ERROR
  4990         MOVE -1                 TO MLINE1L
  4991         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4992         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4993             THRU 2250-EXIT
  4994         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4995         GO TO 8200-SEND-DATAONLY.
  4996
  4997     IF  DM-RETURN-CODE = '11'
  4998         MOVE ER-8061            TO EMI-ERROR
  4999         MOVE -1                 TO MLINE1L
  5000         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5001         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5002             THRU 2250-EXIT
  5003         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5004         GO TO 8200-SEND-DATAONLY.
  5005
  5006     IF  DM-RETURN-CODE = '12'
  5007         MOVE ER-8062            TO EMI-ERROR
  5008         MOVE -1                 TO MLINE1L
  5009         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5010         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5011             THRU 2250-EXIT
  5012         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5013         GO TO 8200-SEND-DATAONLY.
  5014
  5015     IF  DM-RETURN-CODE = '13'
  5016         MOVE ER-8063            TO EMI-ERROR
  5017         MOVE -1                 TO MLINE1L
  5018         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5019         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5020             THRU 2250-EXIT
  5021         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5022         GO TO 8200-SEND-DATAONLY.
  5023
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  96
* EL151.cbl
  5024     IF  DM-RETURN-CODE = '14'
  5025         MOVE ER-8064            TO EMI-ERROR
  5026         MOVE -1                 TO MLINE1L
  5027         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5028         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5029             THRU 2250-EXIT
  5030         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5031         GO TO 8200-SEND-DATAONLY.
  5032
  5033     IF  DM-RETURN-CODE = '15'
  5034         MOVE ER-8065            TO EMI-ERROR
  5035         MOVE -1                 TO MLINE1L
  5036         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5037         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5038             THRU 2250-EXIT
  5039         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5040         GO TO 8200-SEND-DATAONLY.
  5041
  5042     IF DM-RETURN-CODE = '16'
  5043         MOVE ER-8154            TO EMI-ERROR
  5044         MOVE -1                 TO MLINE1L
  5045         PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  5046         PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  5047         PERFORM 2255-UNLOCK-TRLR       THRU 2255-EXIT
  5048         GO TO 8200-SEND-DATAONLY.
  5049
  5050     IF DM-RETURN-CODE = '17'
  5051         MOVE ER-8155            TO EMI-ERROR
  5052         MOVE -1                 TO MLINE1L
  5053         PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  5054         PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  5055         PERFORM 2255-UNLOCK-TRLR       THRU 2255-EXIT
  5056         GO TO 8200-SEND-DATAONLY.
  5057
  5058     IF DM-RETURN-CODE = 'N1'
  5059         MOVE ER-8152            TO EMI-ERROR
  5060         MOVE -1                 TO MLINE1L
  5061         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5062         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5063             THRU 2250-EXIT
  5064         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5065         GO TO 8200-SEND-DATAONLY.
  5066
  5067     IF DM-RETURN-CODE = 'E1'
  5068         MOVE ER-8153            TO EMI-ERROR
  5069         MOVE -1                 TO MLINE1L
  5070         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5071         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5072             THRU 2250-EXIT
  5073         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5074         GO TO 8200-SEND-DATAONLY.
  5075
  5076     MOVE ER-8066                TO EMI-ERROR.
  5077     MOVE -1                     TO MLINE1L.
  5078     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5079     PERFORM 2250-UNLOCK-CLAIM-MSTR
  5080         THRU 2250-EXIT.
  5081     PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  97
* EL151.cbl
  5082     GO TO 8200-SEND-DATAONLY.
  5083
  5084 2000-NOTE-NOT-FOUND.
  5085
  5086     MOVE ER-0954                TO EMI-ERROR.
  5087     MOVE -1                     TO MLINE1L.
  5088     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5089     PERFORM 2250-UNLOCK-CLAIM-MSTR
  5090         THRU 2250-EXIT.
  5091     PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT.
  5092     GO TO 8200-SEND-DATAONLY.
  5093
  5094 2000-EXIT.
  5095     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  98
* EL151.cbl
  5097
  5098 2100-FORMAT-LAST-NAME-1ST.
  5099*****************************************************************
  5100*             M O V E   N A M E   R O U T I N E                 *
  5101*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
  5102*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
  5103*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
  5104*                  FIELD                   VALUE                *
  5105*           W-NAME-LAST    (CL15)      SMITH                    *
  5106*           W-NAME-FIRST   (CL15)      JOHN                     *
  5107*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
  5108*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
  5109*     CONTAIN                                                   *
  5110*                SMITH, JOHN ALLEN                              *
  5111*     OR                                                        *
  5112*                SMITH, JOHN A.                                 *
  5113*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
  5114*     COPYBOOK, ELCNWA.                                         *
  5115*****************************************************************.
  5116
  5117     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  5118     MOVE ZERO                   TO  WS-NAME-SW.
  5119     SET NWA-INDEX               TO +1.
  5120
  5121     IF  W-NAME-LAST EQUAL SPACES
  5122             AND
  5123         W-NAME-MIDDLE EQUAL SPACES
  5124         MOVE +1                 TO WS-NAME-SW.
  5125
  5126     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
  5127     PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  5128
  5129     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
  5130     PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  5131
  5132     SET NWA-INDEX UP BY +1.
  5133
  5134     IF  W-NAME-MIDDLE NOT EQUAL SPACES
  5135
  5136         IF  W-NAME-MIDDLE-2 EQUAL SPACES
  5137             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
  5138             SET NWA-INDEX UP BY +1
  5139             MOVE '.'            TO WS-NW (NWA-INDEX)
  5140             SET NWA-INDEX UP BY +2
  5141
  5142         ELSE
  5143             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
  5144             PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  5145
  5146 2100-EXIT.
  5147     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page  99
* EL151.cbl
  5149 2150-MOVE-NAME.
  5150
  5151     IF  WS-NAME-SW GREATER THAN +1
  5152         GO TO 2150-EXIT.
  5153
  5154     IF  WS-NAME-WORK2 = SPACES
  5155         GO TO 2150-EXIT.
  5156
  5157     SET NWA-INDEX2            TO +1.
  5158     SET NWA-INDEX3            TO +2.
  5159
  5160 2150-MOVE-NAME-CYCLE.
  5161
  5162     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  5163
  5164     IF  NWA-INDEX LESS THAN +30
  5165         SET NWA-INDEX UP BY +1
  5166
  5167     ELSE
  5168         ADD +2                TO  WS-NAME-SW
  5169         GO TO 2150-EXIT.
  5170
  5171     IF  NWA-INDEX2 LESS THAN +20
  5172         SET NWA-INDEX3 UP BY +1
  5173         SET NWA-INDEX2 UP BY +1.
  5174
  5175     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
  5176             AND
  5177         WS-NW2 (NWA-INDEX3) EQUAL SPACES
  5178
  5179         IF  WS-NAME-SW EQUAL ZERO
  5180             MOVE ','            TO  WS-NW (NWA-INDEX)
  5181             SET NWA-INDEX UP BY +2
  5182             MOVE +1             TO  WS-NAME-SW
  5183             GO TO 2150-EXIT
  5184
  5185         ELSE
  5186             GO TO 2150-EXIT.
  5187
  5188     GO TO 2150-MOVE-NAME-CYCLE.
  5189
  5190 2150-EXIT.
  5191     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 100
* EL151.cbl
  5193 2250-UNLOCK-CLAIM-MSTR.
  5194
  5195* EXEC CICS UNLOCK
  5196*          DATASET  (ELMSTR-FILE-ID)
  5197*          END-EXEC.
  5198*    MOVE '&*                    #   #00005061' TO DFHEIV0
  5199     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5200     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5201     MOVE X'2020233030303035303631' TO DFHEIV0(25:11)
  5202     CALL 'kxdfhei1' USING DFHEIV0,
  5203           ELMSTR-FILE-ID,
  5204           DFHEIV99
  5205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5206
  5207 2250-EXIT.
  5208     EXIT.
  5209 2255-UNLOCK-TRLR.
  5210
  5211* EXEC CICS UNLOCK
  5212*          DATASET (ELTRLR-FILE-ID)
  5213*          END-EXEC.
  5214*    MOVE '&*                    #   #00005067' TO DFHEIV0
  5215     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5216     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5217     MOVE X'2020233030303035303637' TO DFHEIV0(25:11)
  5218     CALL 'kxdfhei1' USING DFHEIV0,
  5219           ELTRLR-FILE-ID,
  5220           DFHEIV99
  5221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5222
  5223 2255-EXIT.
  5224     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 101
* EL151.cbl
  5225/
  5226*************************************************************
  5227*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5228*************************************************************
  5229 2300-GETMAIN-DLYACTV.
  5230
  5231* EXEC CICS GETMAIN
  5232*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  5233*        LENGTH (25)
  5234*        INITIMG (WS-BLANK)
  5235*    END-EXEC.
  5236     MOVE 25
  5237       TO DFHEIV11
  5238*    MOVE ',"IL                  $   #00005077' TO DFHEIV0
  5239     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5240     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5241     MOVE X'2020233030303035303737' TO DFHEIV0(25:11)
  5242     CALL 'kxdfhei1' USING DFHEIV0,
  5243           DFHEIV20,
  5244           DFHEIV11,
  5245           WS-BLANK
  5246     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  5247         DFHEIV20
  5248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5249
  5250 2300-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 102
* EL151.cbl
  5251/
  5252*************************************************************
  5253*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5254*************************************************************
  5255 2350-WRITE-DLYACTV.
  5256
  5257* EXEC CICS HANDLE CONDITION
  5258*        NOTOPEN (9986-NOTOPEN-DLYACTV)
  5259*        DUPREC (2350-EXIT)
  5260*    END-EXEC.
  5261*    MOVE '"$J%                  ! $ #00005088' TO DFHEIV0
  5262     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  5263     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5264     MOVE X'2420233030303035303838' TO DFHEIV0(25:11)
  5265     CALL 'kxdfhei1' USING DFHEIV0
  5266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5267
  5268
  5269
  5270* EXEC CICS WRITE
  5271*        DATASET ('DLYACTV')
  5272*        RIDFLD (DA-KEY)
  5273*        FROM (DAILY-ACTIVITY-RECORD)
  5274*    END-EXEC.
  5275     MOVE LENGTH OF
  5276      DAILY-ACTIVITY-RECORD
  5277       TO DFHEIV11
  5278     MOVE 'DLYACTV' TO DFHEIV1
  5279*    MOVE '&$ L                  ''   #00005093' TO DFHEIV0
  5280     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5281     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5282     MOVE X'2020233030303035303933' TO DFHEIV0(25:11)
  5283     CALL 'kxdfhei1' USING DFHEIV0,
  5284           DFHEIV1,
  5285           DAILY-ACTIVITY-RECORD,
  5286           DFHEIV11,
  5287           DA-KEY,
  5288           DFHEIV99,
  5289           DFHEIV99
  5290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5291
  5292
  5293 2350-EXIT.
  5294     EXIT.
  5295
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 103
* EL151.cbl
  5296/
  5297*************************************************************
  5298*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5299*************************************************************
  5300
  5301 3500-BUILD-ACTIVITY-RECORD.
  5302
  5303     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  5304     MOVE WS-CLAIM-KEY           TO DA-KEY.
  5305     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
  5306                                 GIVING DA-TRAILER-SEQ-NO.
  5307     MOVE 'D'                    TO DA-RECORD-TYPE.
  5308
  5309 3500-EXIT.
  5310     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 104
* EL151.cbl
  5311/
  5312 3550-FIND-LETTER-TRLR.
  5313      MOVE PI-COMPANY-CD             TO  WS-KEY-COMPANY-CD.
  5314      MOVE PI-CARRIER                TO  WS-KEY-CARRIER.
  5315      MOVE PI-CLAIM-NO               TO  WS-KEY-CLAIM-NO.
  5316      MOVE PI-CERT-NO                TO  WS-KEY-CERT-NO.
  5317      MOVE +100                      TO  WS-KEY-SEQUENCE-NO.
  5318
  5319 3550-STARTBR-ELTRLR.
  5320
  5321
  5322* EXEC CICS HANDLE CONDITION
  5323*         ENDFILE   (3550-END)
  5324*         NOTFND    (3550-END)
  5325*     END-EXEC.
  5326*    MOVE '"$''I                  ! % #00005127' TO DFHEIV0
  5327     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5328     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5329     MOVE X'2520233030303035313237' TO DFHEIV0(25:11)
  5330     CALL 'kxdfhei1' USING DFHEIV0
  5331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5332
  5333
  5334
  5335* EXEC CICS STARTBR
  5336*         DATASET   (ELTRLR-FILE-ID)
  5337*         RIDFLD    (WS-TRAILER-KEY)
  5338*         GTEQ
  5339*     END-EXEC.
  5340     MOVE 0
  5341       TO DFHEIV11
  5342*    MOVE '&,         G          &   #00005132' TO DFHEIV0
  5343     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5344     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5345     MOVE X'2020233030303035313332' TO DFHEIV0(25:11)
  5346     CALL 'kxdfhei1' USING DFHEIV0,
  5347           ELTRLR-FILE-ID,
  5348           WS-TRAILER-KEY,
  5349           DFHEIV99,
  5350           DFHEIV11,
  5351           DFHEIV99
  5352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5353
  5354
  5355      MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
  5356
  5357 3550-READNEXT-ELTRLR.
  5358
  5359
  5360* EXEC CICS READNEXT
  5361*         DATASET   (ELTRLR-FILE-ID)
  5362*         RIDFLD    (WS-TRAILER-KEY)
  5363*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5364*     END-EXEC.
  5365     MOVE 0
  5366       TO DFHEIV11
  5367*    MOVE '&.S                   )   #00005142' TO DFHEIV0
  5368     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 105
* EL151.cbl
  5369     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5370     MOVE X'2020233030303035313432' TO DFHEIV0(25:11)
  5371     CALL 'kxdfhei1' USING DFHEIV0,
  5372           ELTRLR-FILE-ID,
  5373           DFHEIV20,
  5374           DFHEIV99,
  5375           WS-TRAILER-KEY,
  5376           DFHEIV99,
  5377           DFHEIV11,
  5378           DFHEIV99,
  5379           DFHEIV99
  5380     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5381         DFHEIV20
  5382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5383
  5384
  5385      IF (PI-COMPANY-CD IS NOT EQUAL TO  WS-KEY-COMPANY-CD) OR
  5386         (PI-CARRIER    IS NOT EQUAL TO  WS-KEY-CARRIER)    OR
  5387         (PI-CLAIM-NO   IS NOT EQUAL TO  WS-KEY-CLAIM-NO)   OR
  5388         (PI-CERT-NO    IS NOT EQUAL TO  WS-KEY-CERT-NO)
  5389          GO TO 3550-END.
  5390
  5391      IF AT-TRAILER-TYPE IS NOT EQUAL TO '4'
  5392          GO TO 3550-READNEXT-ELTRLR.
  5393
  5394     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-ANSWER-DT
  5395         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER-DT
  5396     END-IF.
  5397
  5398     GO TO 3550-READNEXT-ELTRLR.
  5399
  5400 3550-END.
  5401
  5402     IF WS-MAX-LETTER-ANSWER-DT NOT EQUAL LOW-VALUES AND SPACES
  5403         MOVE SPACES             TO  DC-OPTION-CODE
  5404         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
  5405         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5406         MOVE DC-GREG-DATE-1-MDY TO PI-PROOF-DATE
  5407         MOVE PI-PROOF-DATE TO  MPRFDTO
  5408         INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  5409     END-IF.
  5410
  5411
  5412* EXEC CICS ENDBR
  5413*         DATASET   (ELTRLR-FILE-ID)
  5414*     END-EXEC.
  5415     MOVE 0
  5416       TO DFHEIV11
  5417*    MOVE '&2                    $   #00005174' TO DFHEIV0
  5418     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5419     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5420     MOVE X'2020233030303035313734' TO DFHEIV0(25:11)
  5421     CALL 'kxdfhei1' USING DFHEIV0,
  5422           ELTRLR-FILE-ID,
  5423           DFHEIV11,
  5424           DFHEIV99
  5425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5426
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 106
* EL151.cbl
  5427
  5428 3550-EXIT.
  5429     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 107
* EL151.cbl
  5430/
  5431 6000-RESET-AUTO-ACTIVITY.
  5432******************************************************************
  5433*    RESET ALL FUTURE LETTER ACTIVITY AWAITING FURTHER ACTION    *
  5434*    (RESEND, FOLLOW-UP, ETC) BY MOVING LOW-VALUES TO THE        *
  5435*    FOLLOW-UP OR RESEND DATES IN THE ACTIVITY TRAILER AND THE   *
  5436*    RESEND DATE IS THE LETTER ARCHIVE, IF NECESSARY.            *
  5437******************************************************************
  5438      MOVE PI-COMPANY-CD             TO  WS-KEY-COMPANY-CD.
  5439      MOVE PI-CARRIER                TO  WS-KEY-CARRIER.
  5440      MOVE PI-CLAIM-NO               TO  WS-KEY-CLAIM-NO.
  5441      MOVE PI-CERT-NO                TO  WS-KEY-CERT-NO.
  5442      MOVE +100                      TO  WS-KEY-SEQUENCE-NO.
  5443
  5444 6000-STARTBR-ELTRLR.
  5445
  5446
  5447* EXEC CICS HANDLE CONDITION
  5448*         ENDFILE   (6000-END-RESET)
  5449*         NOTFND    (6000-END-RESET)
  5450*     END-EXEC.
  5451*    MOVE '"$''I                  ! & #00005196' TO DFHEIV0
  5452     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5453     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5454     MOVE X'2620233030303035313936' TO DFHEIV0(25:11)
  5455     CALL 'kxdfhei1' USING DFHEIV0
  5456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5457
  5458
  5459
  5460* EXEC CICS STARTBR
  5461*         DATASET   (ELTRLR-FILE-ID)
  5462*         RIDFLD    (WS-TRAILER-KEY)
  5463*         GTEQ
  5464*     END-EXEC.
  5465     MOVE 0
  5466       TO DFHEIV11
  5467*    MOVE '&,         G          &   #00005201' TO DFHEIV0
  5468     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5469     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5470     MOVE X'2020233030303035323031' TO DFHEIV0(25:11)
  5471     CALL 'kxdfhei1' USING DFHEIV0,
  5472           ELTRLR-FILE-ID,
  5473           WS-TRAILER-KEY,
  5474           DFHEIV99,
  5475           DFHEIV11,
  5476           DFHEIV99
  5477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5478
  5479
  5480      MOVE 'Y'                       TO  WS-BROWSE-SW.
  5481
  5482 6000-READNEXT-ELTRLR.
  5483
  5484
  5485* EXEC CICS READNEXT
  5486*         DATASET   (ELTRLR-FILE-ID)
  5487*         RIDFLD    (WS-TRAILER-KEY)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 108
* EL151.cbl
  5488*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5489*     END-EXEC.
  5490     MOVE 0
  5491       TO DFHEIV11
  5492*    MOVE '&.S                   )   #00005211' TO DFHEIV0
  5493     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5494     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5495     MOVE X'2020233030303035323131' TO DFHEIV0(25:11)
  5496     CALL 'kxdfhei1' USING DFHEIV0,
  5497           ELTRLR-FILE-ID,
  5498           DFHEIV20,
  5499           DFHEIV99,
  5500           WS-TRAILER-KEY,
  5501           DFHEIV99,
  5502           DFHEIV11,
  5503           DFHEIV99,
  5504           DFHEIV99
  5505     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5506         DFHEIV20
  5507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5508
  5509
  5510      IF (PI-COMPANY-CD IS NOT EQUAL TO  WS-KEY-COMPANY-CD) OR
  5511         (PI-CARRIER    IS NOT EQUAL TO  WS-KEY-CARRIER)    OR
  5512         (PI-CLAIM-NO   IS NOT EQUAL TO  WS-KEY-CLAIM-NO)   OR
  5513         (PI-CERT-NO    IS NOT EQUAL TO  WS-KEY-CERT-NO)
  5514          GO TO 6000-END-RESET.
  5515
  5516      IF WS-TRAILER-KEY IS EQUAL TO PI-PREV-TRLR-KEY
  5517          GO TO 6000-READNEXT-ELTRLR.
  5518
  5519      IF AT-TRAILER-TYPE IS NOT EQUAL TO '4'
  5520          GO TO 6000-READNEXT-ELTRLR.
  5521
  5522      IF (AT-LETTER-ANSWERED-DT NOT EQUAL LOW-VALUES AND SPACES)
  5523          GO TO 6000-READNEXT-ELTRLR.
  5524
  5525      IF (AT-AUTO-RE-SEND-DT EQUAL LOW-VALUES OR SPACES)
  5526        AND
  5527         (AT-RECEIPT-FOLLOW-UP EQUAL LOW-VALUES OR SPACES)
  5528          GO TO 6000-READNEXT-ELTRLR.
  5529
  5530      IF AT-RECEIPT-FOLLOW-UP IS LESS THAN SAVE-BIN-DATE AND
  5531         AT-AUTO-RE-SEND-DT IS LESS THAN SAVE-BIN-DATE   AND
  5532         AT-RESEND-PRINT-DATE IS LESS THAN SAVE-BIN-DATE
  5533          GO TO 6000-READNEXT-ELTRLR.
  5534
  5535      IF (AT-AUTO-RE-SEND-DT NOT EQUAL LOW-VALUES AND SPACES)
  5536        AND
  5537         (AT-RESEND-PRINT-DATE NOT EQUAL LOW-VALUES AND SPACES)
  5538        AND
  5539         (AT-RECEIPT-FOLLOW-UP EQUAL LOW-VALUES)
  5540          GO TO 6000-READNEXT-ELTRLR.
  5541
  5542 6000-END-BROWSE.
  5543
  5544      MOVE WS-TRAILER-KEY            TO  PI-PREV-TRLR-KEY.
  5545
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 109
* EL151.cbl
  5546
  5547* EXEC CICS ENDBR
  5548*         DATASET   (ELTRLR-FILE-ID)
  5549*     END-EXEC.
  5550     MOVE 0
  5551       TO DFHEIV11
  5552*    MOVE '&2                    $   #00005253' TO DFHEIV0
  5553     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5554     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5555     MOVE X'2020233030303035323533' TO DFHEIV0(25:11)
  5556     CALL 'kxdfhei1' USING DFHEIV0,
  5557           ELTRLR-FILE-ID,
  5558           DFHEIV11,
  5559           DFHEIV99
  5560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5561
  5562
  5563      MOVE 'N'                       TO  WS-BROWSE-SW.
  5564
  5565 6000-READ-ELTRLR-UPDATE.
  5566
  5567
  5568* EXEC CICS READ
  5569*         DATASET   (ELTRLR-FILE-ID)
  5570*         RIDFLD    (WS-TRAILER-KEY)
  5571*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5572*         UPDATE
  5573*     END-EXEC.
  5574*    MOVE '&"S        EU         (   #00005261' TO DFHEIV0
  5575     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5576     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5577     MOVE X'2020233030303035323631' TO DFHEIV0(25:11)
  5578     CALL 'kxdfhei1' USING DFHEIV0,
  5579           ELTRLR-FILE-ID,
  5580           DFHEIV20,
  5581           DFHEIV99,
  5582           WS-TRAILER-KEY,
  5583           DFHEIV99,
  5584           DFHEIV99,
  5585           DFHEIV99
  5586     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5587         DFHEIV20
  5588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5589
  5590
  5591      MOVE 'Y'                       TO  WS-UPDATE-SW.
  5592
  5593      IF AT-AUTO-RE-SEND-DT IS NOT LESS THAN SAVE-BIN-DATE
  5594          MOVE LOW-VALUES            TO  AT-AUTO-RE-SEND-DT
  5595          MOVE PI-COMPANY-CD         TO  ELARCH-COMPANY-CD
  5596          MOVE AT-LETTER-ARCHIVE-NO  TO  ELARCH-ARCHIVE-NO
  5597          MOVE '1'                   TO  ELARCH-RECORD-TYPE
  5598          MOVE +0                    TO  ELARCH-SEQ-NO
  5599          PERFORM 6200-READ-ELARCH-UPDATE THRU 6200-EXIT.
  5600
  5601      IF AT-RECEIPT-FOLLOW-UP IS NOT LESS THAN SAVE-BIN-DATE
  5602          MOVE LOW-VALUES            TO  AT-RECEIPT-FOLLOW-UP.
  5603
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 110
* EL151.cbl
  5604 6000-REWRITE-ELTRLR.
  5605
  5606
  5607* EXEC CICS REWRITE
  5608*         DATASET   (ELTRLR-FILE-ID)
  5609*         FROM      (ACTIVITY-TRAILERS)
  5610*     END-EXEC.
  5611     MOVE LENGTH OF
  5612      ACTIVITY-TRAILERS
  5613       TO DFHEIV11
  5614*    MOVE '&& L                  %   #00005283' TO DFHEIV0
  5615     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5616     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5617     MOVE X'2020233030303035323833' TO DFHEIV0(25:11)
  5618     CALL 'kxdfhei1' USING DFHEIV0,
  5619           ELTRLR-FILE-ID,
  5620           ACTIVITY-TRAILERS,
  5621           DFHEIV11,
  5622           DFHEIV99
  5623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5624
  5625
  5626      GO TO 6000-STARTBR-ELTRLR.
  5627
  5628 6000-END-RESET.
  5629
  5630      IF WS-BROWSE-SW IS EQUAL TO 'Y'
  5631          MOVE 'N'                   TO  WS-BROWSE-SW
  5632
  5633* EXEC CICS ENDBR
  5634*             DATASET   (ELTRLR-FILE-ID)
  5635*         END-EXEC.
  5636     MOVE 0
  5637       TO DFHEIV11
  5638*    MOVE '&2                    $   #00005294' TO DFHEIV0
  5639     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5640     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5641     MOVE X'2020233030303035323934' TO DFHEIV0(25:11)
  5642     CALL 'kxdfhei1' USING DFHEIV0,
  5643           ELTRLR-FILE-ID,
  5644           DFHEIV11,
  5645           DFHEIV99
  5646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5647
  5648
  5649 6000-EXIT.
  5650     EXIT.
  5651
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 111
* EL151.cbl
  5653 6100-CHECK-AUTO-ACTIVITY.
  5654******************************************************************
  5655*    READ THE AUTOMATIC ACTIVITY RECORD TO DETERMINE IF THE      *
  5656*    AUTOMATIC ACTIVITY CODE IN THE CLAIM MASTER IS TO BE RESET. *
  5657******************************************************************
  5658
  5659
  5660* EXEC CICS HANDLE CONDITION
  5661*         NOTFND   (6100-NOT-FOUND)
  5662*     END-EXEC.
  5663*    MOVE '"$I                   ! '' #00005308' TO DFHEIV0
  5664     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5666     MOVE X'2720233030303035333038' TO DFHEIV0(25:11)
  5667     CALL 'kxdfhei1' USING DFHEIV0
  5668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5669
  5670
  5671      MOVE PI-COMPANY-ID             TO  ELCNTL-COMPANY-ID.
  5672      MOVE 'T'                       TO  ELCNTL-RECORD-TYPE.
  5673      MOVE SPACES                    TO  ELCNTL-ACCESS.
  5674      MOVE +0                        TO  ELCNTL-SEQ-NO.
  5675
  5676
  5677* EXEC CICS READ
  5678*         DATASET   (ELCNTL-FILE-ID)
  5679*         RIDFLD    (ELCNTL-KEY)
  5680*         SET       (ADDRESS OF CONTROL-FILE)
  5681*     END-EXEC.
  5682*    MOVE '&"S        E          (   #00005317' TO DFHEIV0
  5683     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5684     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5685     MOVE X'2020233030303035333137' TO DFHEIV0(25:11)
  5686     CALL 'kxdfhei1' USING DFHEIV0,
  5687           ELCNTL-FILE-ID,
  5688           DFHEIV20,
  5689           DFHEIV99,
  5690           ELCNTL-KEY,
  5691           DFHEIV99,
  5692           DFHEIV99,
  5693           DFHEIV99
  5694     SET ADDRESS OF CONTROL-FILE TO
  5695         DFHEIV20
  5696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5697
  5698
  5699      IF CL-ACTIVITY-CODE IS NOT EQUAL TO ZEROS
  5700          MOVE CL-ACTIVITY-CODE      TO  MISC-SUB
  5701          IF MISC-SUB IS GREATER THAN +9
  5702              SUBTRACT +9 FROM MISC-SUB
  5703              MOVE CF-USER-RESET-SW (MISC-SUB) TO  WS-RESET-SW
  5704          ELSE
  5705              MOVE CF-SYS-RESET-SW  (MISC-SUB) TO  WS-RESET-SW.
  5706
  5707      MOVE 'Y'                       TO  WS-REC-FOUND-SW.
  5708      GO TO 6100-EXIT.
  5709
  5710 6100-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 112
* EL151.cbl
  5711
  5712     MOVE 'N'                        TO  WS-RESET-SW
  5713                                         WS-REC-FOUND-SW.
  5714
  5715 6100-EXIT.
  5716     EXIT.
  5717
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 113
* EL151.cbl
  5719 6200-READ-ELARCH-UPDATE.
  5720******************************************************************
  5721*  READ AND UPDATE THE RESEND DATE IN THE LETTER ARCHIVE RECORD  *
  5722******************************************************************
  5723
  5724
  5725* EXEC CICS HANDLE CONDITION
  5726*         NOTFND   (6200-EXIT)
  5727*     END-EXEC.
  5728*    MOVE '"$I                   ! ( #00005348' TO DFHEIV0
  5729     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5730     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5731     MOVE X'2820233030303035333438' TO DFHEIV0(25:11)
  5732     CALL 'kxdfhei1' USING DFHEIV0
  5733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5734
  5735
  5736
  5737* EXEC CICS READ
  5738*         DATASET   (ELARCH-FILE-ID)
  5739*         RIDFLD    (ELARCH-KEY)
  5740*         SET       (ADDRESS OF LETTER-ARCHIVE)
  5741*         UPDATE
  5742*     END-EXEC.
  5743*    MOVE '&"S        EU         (   #00005352' TO DFHEIV0
  5744     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5745     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5746     MOVE X'2020233030303035333532' TO DFHEIV0(25:11)
  5747     CALL 'kxdfhei1' USING DFHEIV0,
  5748           ELARCH-FILE-ID,
  5749           DFHEIV20,
  5750           DFHEIV99,
  5751           ELARCH-KEY,
  5752           DFHEIV99,
  5753           DFHEIV99,
  5754           DFHEIV99
  5755     SET ADDRESS OF LETTER-ARCHIVE TO
  5756         DFHEIV20
  5757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5758
  5759
  5760      MOVE LOW-VALUES                TO  LA-RESEND-DATE.
  5761
  5762 6200-REWRITE-ELARCH.
  5763
  5764
  5765* EXEC CICS REWRITE
  5766*         DATASET   (ELARCH-FILE-ID)
  5767*         FROM      (LETTER-ARCHIVE)
  5768*     END-EXEC.
  5769     MOVE LENGTH OF
  5770      LETTER-ARCHIVE
  5771       TO DFHEIV11
  5772*    MOVE '&& L                  %   #00005363' TO DFHEIV0
  5773     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5774     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5775     MOVE X'2020233030303035333633' TO DFHEIV0(25:11)
  5776     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 114
* EL151.cbl
  5777           ELARCH-FILE-ID,
  5778           LETTER-ARCHIVE,
  5779           DFHEIV11,
  5780           DFHEIV99
  5781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5782
  5783
  5784 6200-EXIT.
  5785     EXIT.
  5786
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 115
* EL151.cbl
  5788 7000-READ-ELMSTR-UPDATE.
  5789
  5790
  5791* EXEC CICS  HANDLE CONDITION
  5792*           NOTFND  (7000-NOTFND)
  5793*           NOTOPEN (9981-NOTOPEN-MSTR)
  5794*    END-EXEC.
  5795*    MOVE '"$IJ                  ! ) #00005374' TO DFHEIV0
  5796     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  5797     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5798     MOVE X'2920233030303035333734' TO DFHEIV0(25:11)
  5799     CALL 'kxdfhei1' USING DFHEIV0
  5800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5801
  5802
  5803
  5804* EXEC CICS  READ
  5805*        DATASET  (ELMSTR-FILE-ID)
  5806*        RIDFLD   (WS-CLAIM-KEY)
  5807*        SET      (ADDRESS OF CLAIM-MASTER)
  5808*        UPDATE
  5809*    END-EXEC.
  5810*    MOVE '&"S        EU         (   #00005379' TO DFHEIV0
  5811     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5812     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5813     MOVE X'2020233030303035333739' TO DFHEIV0(25:11)
  5814     CALL 'kxdfhei1' USING DFHEIV0,
  5815           ELMSTR-FILE-ID,
  5816           DFHEIV20,
  5817           DFHEIV99,
  5818           WS-CLAIM-KEY,
  5819           DFHEIV99,
  5820           DFHEIV99,
  5821           DFHEIV99
  5822     SET ADDRESS OF CLAIM-MASTER TO
  5823         DFHEIV20
  5824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5825
  5826
  5827     GO TO 7000-EXIT.
  5828
  5829 7000-NOTFND.
  5830
  5831     MOVE ER-0133                TO  EMI-ERROR.
  5832     MOVE -1                     TO  MLINE1L.
  5833     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5834     GO TO 8200-SEND-DATAONLY.
  5835
  5836 7000-EXIT.
  5837      EXIT.
  5838
  5839 7010-REWRITE-ELMSTR.
  5840
  5841
  5842* EXEC CICS HANDLE CONDITION
  5843*        DUPKEY (7010-EXIT)
  5844*        END-EXEC.
  5845*    MOVE '"$$                   ! * #00005400' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 116
* EL151.cbl
  5846     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  5847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5848     MOVE X'2A20233030303035343030' TO DFHEIV0(25:11)
  5849     CALL 'kxdfhei1' USING DFHEIV0
  5850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5851
  5852
  5853
  5854* EXEC CICS  REWRITE
  5855*        DATASET  (ELMSTR-FILE-ID)
  5856*        FROM     (CLAIM-MASTER)
  5857*    END-EXEC.
  5858     MOVE LENGTH OF
  5859      CLAIM-MASTER
  5860       TO DFHEIV11
  5861*    MOVE '&& L                  %   #00005404' TO DFHEIV0
  5862     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5863     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5864     MOVE X'2020233030303035343034' TO DFHEIV0(25:11)
  5865     CALL 'kxdfhei1' USING DFHEIV0,
  5866           ELMSTR-FILE-ID,
  5867           CLAIM-MASTER,
  5868           DFHEIV11,
  5869           DFHEIV99
  5870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5871
  5872
  5873 7010-EXIT.
  5874      EXIT.
  5875
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 117
* EL151.cbl
  5877 7100-GETMAIN-ELTRLR.
  5878
  5879
  5880* EXEC CICS GETMAIN
  5881*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  5882*        INITIMG (GETMAIN-SPACE)
  5883*        LENGTH  (WS-TRLR-LENGTH)
  5884*    END-EXEC.
  5885*    MOVE ',"IL                  $   #00005415' TO DFHEIV0
  5886     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5887     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5888     MOVE X'2020233030303035343135' TO DFHEIV0(25:11)
  5889     CALL 'kxdfhei1' USING DFHEIV0,
  5890           DFHEIV20,
  5891           WS-TRLR-LENGTH,
  5892           GETMAIN-SPACE
  5893     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5894         DFHEIV20
  5895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5896
  5897
  5898 7100-EXIT.
  5899     EXIT.
  5900
  5901 7110-WRITE-ELTRLR.
  5902
  5903* EXEC CICS  HANDLE CONDITION
  5904*           DUPREC   (7110-DUPREC)
  5905*    END-EXEC.
  5906*    MOVE '"$%                   ! + #00005425' TO DFHEIV0
  5907     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  5908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5909     MOVE X'2B20233030303035343235' TO DFHEIV0(25:11)
  5910     CALL 'kxdfhei1' USING DFHEIV0
  5911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5912
  5913
  5914
  5915* EXEC CICS  WRITE
  5916*           DATASET  (ELTRLR-FILE-ID)
  5917*           RIDFLD   (WS-TRAILER-KEY)
  5918*           FROM     (ACTIVITY-TRAILERS)
  5919*    END-EXEC.
  5920     MOVE LENGTH OF
  5921      ACTIVITY-TRAILERS
  5922       TO DFHEIV11
  5923*    MOVE '&$ L                  ''   #00005429' TO DFHEIV0
  5924     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5925     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5926     MOVE X'2020233030303035343239' TO DFHEIV0(25:11)
  5927     CALL 'kxdfhei1' USING DFHEIV0,
  5928           ELTRLR-FILE-ID,
  5929           ACTIVITY-TRAILERS,
  5930           DFHEIV11,
  5931           WS-TRAILER-KEY,
  5932           DFHEIV99,
  5933           DFHEIV99
  5934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 118
* EL151.cbl
  5935
  5936
  5937     GO TO 7110-EXIT.
  5938
  5939 7110-DUPREC.
  5940
  5941     MOVE ER-0132                TO  EMI-ERROR.
  5942     MOVE -1                     TO  MLINE1L.
  5943     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5944     GO TO 8200-SEND-DATAONLY.
  5945
  5946 7110-EXIT.
  5947      EXIT.
  5948
  5949 7120-READ-ELTRLR-UPDATE.
  5950
  5951
  5952* EXEC CICS  HANDLE CONDITION
  5953*           NOTFND  (9965-NO-TRLR-ERROR)
  5954*           NOTOPEN (9982-NOTOPEN-TRLR)
  5955*    END-EXEC.
  5956*    MOVE '"$IJ                  ! , #00005449' TO DFHEIV0
  5957     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  5958     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5959     MOVE X'2C20233030303035343439' TO DFHEIV0(25:11)
  5960     CALL 'kxdfhei1' USING DFHEIV0
  5961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5962
  5963
  5964
  5965* EXEC CICS  READ
  5966*        DATASET  (ELTRLR-FILE-ID)
  5967*        RIDFLD   (WS-TRAILER-KEY)
  5968*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  5969*        UPDATE
  5970*    END-EXEC.
  5971*    MOVE '&"S        EU         (   #00005454' TO DFHEIV0
  5972     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5973     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5974     MOVE X'2020233030303035343534' TO DFHEIV0(25:11)
  5975     CALL 'kxdfhei1' USING DFHEIV0,
  5976           ELTRLR-FILE-ID,
  5977           DFHEIV20,
  5978           DFHEIV99,
  5979           WS-TRAILER-KEY,
  5980           DFHEIV99,
  5981           DFHEIV99,
  5982           DFHEIV99
  5983     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5984         DFHEIV20
  5985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5986
  5987
  5988 7120-EXIT.
  5989      EXIT.
  5990
  5991 7130-REWRITE-ELTRLR.
  5992
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 119
* EL151.cbl
  5993
  5994* EXEC CICS  REWRITE
  5995*        DATASET  (ELTRLR-FILE-ID)
  5996*        FROM     (ACTIVITY-TRAILERS)
  5997*    END-EXEC.
  5998     MOVE LENGTH OF
  5999      ACTIVITY-TRAILERS
  6000       TO DFHEIV11
  6001*    MOVE '&& L                  %   #00005466' TO DFHEIV0
  6002     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6003     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6004     MOVE X'2020233030303035343636' TO DFHEIV0(25:11)
  6005     CALL 'kxdfhei1' USING DFHEIV0,
  6006           ELTRLR-FILE-ID,
  6007           ACTIVITY-TRAILERS,
  6008           DFHEIV11,
  6009           DFHEIV99
  6010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6011
  6012
  6013 7130-EXIT.
  6014      EXIT.
  6015
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 120
* EL151.cbl
  6017 8100-SEND-INITIAL-MAP.
  6018
  6019     MOVE SAVE-DATE                  TO  MRNDATEO.
  6020     MOVE EIBTIME                    TO  TIME-IN.
  6021     MOVE TIME-OUT                   TO  MRNTIMEO.
  6022
  6023
  6024* EXEC CICS  SEND
  6025*         MAP      (MAP-NAME)
  6026*         MAPSET   (MAPSET-NAME)
  6027*         FROM     (EL151AO)
  6028*         ERASE
  6029*         CURSOR
  6030*    END-EXEC.
  6031     MOVE LENGTH OF
  6032      EL151AO
  6033       TO DFHEIV12
  6034     MOVE -1
  6035       TO DFHEIV11
  6036*    MOVE '8$     CT  E    H L F ,   #00005481' TO DFHEIV0
  6037     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  6038     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  6039     MOVE X'2020233030303035343831' TO DFHEIV0(25:11)
  6040     CALL 'kxdfhei1' USING DFHEIV0,
  6041           MAP-NAME,
  6042           EL151AO,
  6043           DFHEIV12,
  6044           MAPSET-NAME,
  6045           DFHEIV99,
  6046           DFHEIV99,
  6047           DFHEIV99,
  6048           DFHEIV11,
  6049           DFHEIV99,
  6050           DFHEIV99,
  6051           DFHEIV99
  6052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6053
  6054
  6055     GO TO 9100-RETURN-TRAN.
  6056
  6057 8200-SEND-DATAONLY.
  6058
  6059     MOVE SAVE-DATE                  TO  MRNDATEO.
  6060     MOVE EIBTIME                    TO  TIME-IN.
  6061     MOVE TIME-OUT                   TO  MRNTIMEO.
  6062
  6063
  6064* EXEC CICS  SEND
  6065*        MAP       (MAP-NAME)
  6066*        MAPSET    (MAPSET-NAME)
  6067*        FROM      (EL151AO)
  6068*        DATAONLY
  6069*        CURSOR
  6070*    END-EXEC.
  6071     MOVE LENGTH OF
  6072      EL151AO
  6073       TO DFHEIV12
  6074     MOVE -1
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 121
* EL151.cbl
  6075       TO DFHEIV11
  6076*    MOVE '8$D    CT       H L F ,   #00005497' TO DFHEIV0
  6077     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  6078     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  6079     MOVE X'2020233030303035343937' TO DFHEIV0(25:11)
  6080     CALL 'kxdfhei1' USING DFHEIV0,
  6081           MAP-NAME,
  6082           EL151AO,
  6083           DFHEIV12,
  6084           MAPSET-NAME,
  6085           DFHEIV99,
  6086           DFHEIV99,
  6087           DFHEIV99,
  6088           DFHEIV11,
  6089           DFHEIV99,
  6090           DFHEIV99,
  6091           DFHEIV99
  6092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6093
  6094
  6095     GO TO 9100-RETURN-TRAN.
  6096
  6097 8300-SEND-TEXT.
  6098
  6099* EXEC CICS SEND TEXT
  6100*        FROM     (LOGOFF-TEXT)
  6101*        LENGTH   (LOGOFF-LENGTH)
  6102*        ERASE
  6103*        FREEKB
  6104*    END-EXEC.
  6105*    MOVE '8&      T  E F  H   F -   #00005508' TO DFHEIV0
  6106     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  6107     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  6108     MOVE X'2020233030303035353038' TO DFHEIV0(25:11)
  6109     CALL 'kxdfhei1' USING DFHEIV0,
  6110           LOGOFF-TEXT,
  6111           LOGOFF-LENGTH,
  6112           DFHEIV99,
  6113           DFHEIV99,
  6114           DFHEIV99,
  6115           DFHEIV99,
  6116           DFHEIV99,
  6117           DFHEIV99,
  6118           DFHEIV99,
  6119           DFHEIV99,
  6120           DFHEIV99,
  6121           DFHEIV99
  6122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6123
  6124
  6125
  6126* EXEC CICS RETURN
  6127*        END-EXEC.
  6128*    MOVE '.(                    ''   #00005515' TO DFHEIV0
  6129     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6130     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6131     MOVE X'2020233030303035353135' TO DFHEIV0(25:11)
  6132     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 122
* EL151.cbl
  6133           DFHEIV99,
  6134           DFHEIV99,
  6135           DFHEIV99,
  6136           DFHEIV99,
  6137           DFHEIV99,
  6138           DFHEIV99
  6139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6140
  6141
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 123
* EL151.cbl
  6143 9600-PGMID-ERROR.
  6144
  6145* EXEC CICS HANDLE CONDITION
  6146*        PGMIDERR (8300-SEND-TEXT)
  6147*    END-EXEC.
  6148*    MOVE '"$L                   ! - #00005520' TO DFHEIV0
  6149     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  6150     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6151     MOVE X'2D20233030303035353230' TO DFHEIV0(25:11)
  6152     CALL 'kxdfhei1' USING DFHEIV0
  6153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6154
  6155
  6156     MOVE THIS-PGM               TO LOGOFF-PGM
  6157                                    PI-CALLING-PROGRAM.
  6158     MOVE SPACES                 TO PI-ENTRY-CD-1.
  6159     MOVE 'EL005'                TO THIS-PGM.
  6160     MOVE THIS-PGM               TO LOGOFF-PGM.
  6161     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  6162     GO TO 9300-XCTL.
  6163
  6164 8800-UNAUTHORIZED-ACCESS.
  6165
  6166     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  6167     GO TO 8300-SEND-TEXT.
  6168
  6169 9100-RETURN-TRAN.
  6170     MOVE EMI-ERROR-NUMBER (1)    TO  PI-LAST-ERROR-NO.
  6171     MOVE '151A'                  TO  PI-CURRENT-SCREEN-NO.
  6172
  6173
  6174* EXEC CICS  RETURN
  6175*        TRANSID  (WS-TRANS-ID)
  6176*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  6177*        LENGTH   (PI-COMM-LENGTH)
  6178*    END-EXEC.
  6179*    MOVE '.(CT                  ''   #00005541' TO DFHEIV0
  6180     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  6181     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6182     MOVE X'2020233030303035353431' TO DFHEIV0(25:11)
  6183     CALL 'kxdfhei1' USING DFHEIV0,
  6184           WS-TRANS-ID,
  6185           PROGRAM-INTERFACE-BLOCK,
  6186           PI-COMM-LENGTH,
  6187           DFHEIV99,
  6188           DFHEIV99,
  6189           DFHEIV99
  6190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6191
  6192
  6193 9300-XCTL.
  6194
  6195* EXEC CICS XCTL
  6196*        PROGRAM  (THIS-PGM)
  6197*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  6198*        LENGTH   (PI-COMM-LENGTH)
  6199*    END-EXEC.
  6200*    MOVE '.$C                   %   #00005548' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 124
* EL151.cbl
  6201     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6202     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6203     MOVE X'2020233030303035353438' TO DFHEIV0(25:11)
  6204     CALL 'kxdfhei1' USING DFHEIV0,
  6205           THIS-PGM,
  6206           PROGRAM-INTERFACE-BLOCK,
  6207           PI-COMM-LENGTH,
  6208           DFHEIV99
  6209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6210
  6211
  6212 9400-CLEAR.
  6213     MOVE PI-RETURN-TO-PROGRAM       TO  THIS-PGM.
  6214     GO TO 9300-XCTL.
  6215
  6216 9650-DEEDIT.
  6217
  6218* EXEC CICS BIF DEEDIT
  6219*        FIELD (DEEDIT-FIELD)
  6220*        LENGTH(15)
  6221*    END-EXEC.
  6222     MOVE 15
  6223       TO DFHEIV11
  6224*    MOVE '@"L                   #   #00005559' TO DFHEIV0
  6225     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6226     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6227     MOVE X'2020233030303035353539' TO DFHEIV0(25:11)
  6228     CALL 'kxdfhei1' USING DFHEIV0,
  6229           DEEDIT-FIELD,
  6230           DFHEIV11
  6231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6232
  6233
  6234 9650-EXIT.
  6235      EXIT.
  6236
  6237 9700-LINK-DATE-CONVERT.
  6238
  6239* EXEC CICS LINK
  6240*           PROGRAM  ('ELDATCV')
  6241*           COMMAREA (DATE-CONVERSION-DATA)
  6242*           LENGTH   (DC-COMM-LENGTH)
  6243*    END-EXEC.
  6244     MOVE 'ELDATCV' TO DFHEIV1
  6245*    MOVE '."C                   (   #00005568' TO DFHEIV0
  6246     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6247     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6248     MOVE X'2020233030303035353638' TO DFHEIV0(25:11)
  6249     CALL 'kxdfhei1' USING DFHEIV0,
  6250           DFHEIV1,
  6251           DATE-CONVERSION-DATA,
  6252           DC-COMM-LENGTH,
  6253           DFHEIV99,
  6254           DFHEIV99,
  6255           DFHEIV99,
  6256           DFHEIV99
  6257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6258
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 125
* EL151.cbl
  6259
  6260 9700-EXIT.
  6261      EXIT.
  6262
  6263 9900-ERROR-FORMAT.
  6264
  6265
  6266* EXEC CICS LINK
  6267*        PROGRAM  ('EL001')
  6268*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  6269*        LENGTH   (EMI-COMM-LENGTH)
  6270*    END-EXEC.
  6271     MOVE 'EL001' TO DFHEIV1
  6272*    MOVE '."C                   (   #00005579' TO DFHEIV0
  6273     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6274     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6275     MOVE X'2020233030303035353739' TO DFHEIV0(25:11)
  6276     CALL 'kxdfhei1' USING DFHEIV0,
  6277           DFHEIV1,
  6278           ERROR-MESSAGE-INTERFACE-BLOCK,
  6279           EMI-COMM-LENGTH,
  6280           DFHEIV99,
  6281           DFHEIV99,
  6282           DFHEIV99,
  6283           DFHEIV99
  6284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6285
  6286
  6287     MOVE EMI-LINE1              TO  MERMSG1O.
  6288
  6289 9900-EXIT.
  6290      EXIT.
  6291
  6292 9965-NO-TRLR-ERROR.
  6293     MOVE ER-0270                TO  EMI-ERROR.
  6294     MOVE -1                     TO  MLINE1L.
  6295     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6296     GO TO 8200-SEND-DATAONLY.
  6297
  6298 9981-NOTOPEN-MSTR.
  6299     MOVE ER-0154                TO EMI-ERROR
  6300     MOVE -1                     TO  MLINE1L.
  6301     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6302     GO TO 8200-SEND-DATAONLY.
  6303
  6304 9982-NOTOPEN-TRLR.
  6305     MOVE ER-0172                TO EMI-ERROR
  6306     MOVE -1                     TO  MLINE1L.
  6307     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6308     GO TO 8200-SEND-DATAONLY.
  6309
  6310 9986-NOTOPEN-DLYACTV.
  6311     MOVE '2955'                 TO EMI-ERROR.
  6312     MOVE -1                     TO  MLINE1L.
  6313     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6314     GO TO 8200-SEND-DATAONLY.
  6315
  6316 9995-SECURITY-VIOLATION.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 126
* EL151.cbl
  6317*                            COPY ELCSCTP.
  6318******************************************************************
  6319*                                                                *
  6320*                            ELCSCTP                             *
  6321*                            VMOD=2.001                          *
  6322*                                                                *
  6323*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  6324******************************************************************
  6325
  6326
  6327     MOVE EIBDATE          TO SM-JUL-DATE.
  6328     MOVE EIBTRMID         TO SM-TERMID.
  6329     MOVE THIS-PGM         TO SM-PGM.
  6330     MOVE EIBTIME          TO TIME-IN.
  6331     MOVE TIME-OUT         TO SM-TIME.
  6332     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  6333
  6334
  6335* EXEC CICS LINK
  6336*         PROGRAM  ('EL003')
  6337*         COMMAREA (SECURITY-MESSAGE)
  6338*         LENGTH   (80)
  6339*    END-EXEC.
  6340     MOVE 'EL003' TO DFHEIV1
  6341     MOVE 80
  6342       TO DFHEIV11
  6343*    MOVE '."C                   (   #00005632' TO DFHEIV0
  6344     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6346     MOVE X'2020233030303035363332' TO DFHEIV0(25:11)
  6347     CALL 'kxdfhei1' USING DFHEIV0,
  6348           DFHEIV1,
  6349           SECURITY-MESSAGE,
  6350           DFHEIV11,
  6351           DFHEIV99,
  6352           DFHEIV99,
  6353           DFHEIV99,
  6354           DFHEIV99
  6355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6356
  6357
  6358******************************************************************
  6359
  6360
  6361 9995-EXIT.
  6362     EXIT.
  6363
  6364 9990-ABEND.
  6365     MOVE -1                      TO  MPFNUMBL.
  6366     MOVE DFHEIBLK                TO  EMI-LINE1.
  6367
  6368
  6369* EXEC CICS LINK
  6370*          PROGRAM  ('EL004')
  6371*          COMMAREA (EMI-LINE1)
  6372*          LENGTH   (72)
  6373*    END-EXEC.
  6374     MOVE 'EL004' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 127
* EL151.cbl
  6375     MOVE 72
  6376       TO DFHEIV11
  6377*    MOVE '."C                   (   #00005648' TO DFHEIV0
  6378     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6379     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6380     MOVE X'2020233030303035363438' TO DFHEIV0(25:11)
  6381     CALL 'kxdfhei1' USING DFHEIV0,
  6382           DFHEIV1,
  6383           EMI-LINE1,
  6384           DFHEIV11,
  6385           DFHEIV99,
  6386           DFHEIV99,
  6387           DFHEIV99,
  6388           DFHEIV99
  6389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6390
  6391
  6392     MOVE EMI-LINE1               TO  MERMSG1O.
  6393     GO TO 8200-SEND-DATAONLY.
  6394
  6395
  6396 9999-DFHBACK SECTION.
  6397     MOVE '9%                    "   ' TO DFHEIV0
  6398     MOVE 'EL151' TO DFHEIV1
  6399     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6400     GOBACK.
  6401 9999-DFHEXIT.
  6402     IF DFHEIGDJ EQUAL 0001
  6403         NEXT SENTENCE
  6404     ELSE IF DFHEIGDJ EQUAL 2
  6405         GO TO 9990-ABEND,
  6406               9600-PGMID-ERROR
  6407         DEPENDING ON DFHEIGDI
  6408     ELSE IF DFHEIGDJ EQUAL 3
  6409         GO TO 2000-NOTE-NOT-FOUND
  6410         DEPENDING ON DFHEIGDI
  6411     ELSE IF DFHEIGDJ EQUAL 4
  6412         GO TO 9986-NOTOPEN-DLYACTV,
  6413               2350-EXIT
  6414         DEPENDING ON DFHEIGDI
  6415     ELSE IF DFHEIGDJ EQUAL 5
  6416         GO TO 3550-END,
  6417               3550-END
  6418         DEPENDING ON DFHEIGDI
  6419     ELSE IF DFHEIGDJ EQUAL 6
  6420         GO TO 6000-END-RESET,
  6421               6000-END-RESET
  6422         DEPENDING ON DFHEIGDI
  6423     ELSE IF DFHEIGDJ EQUAL 7
  6424         GO TO 6100-NOT-FOUND
  6425         DEPENDING ON DFHEIGDI
  6426     ELSE IF DFHEIGDJ EQUAL 8
  6427         GO TO 6200-EXIT
  6428         DEPENDING ON DFHEIGDI
  6429     ELSE IF DFHEIGDJ EQUAL 9
  6430         GO TO 7000-NOTFND,
  6431               9981-NOTOPEN-MSTR
  6432         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:18 Page 128
* EL151.cbl
  6433     ELSE IF DFHEIGDJ EQUAL 10
  6434         GO TO 7010-EXIT
  6435         DEPENDING ON DFHEIGDI
  6436     ELSE IF DFHEIGDJ EQUAL 11
  6437         GO TO 7110-DUPREC
  6438         DEPENDING ON DFHEIGDI
  6439     ELSE IF DFHEIGDJ EQUAL 12
  6440         GO TO 9965-NO-TRLR-ERROR,
  6441               9982-NOTOPEN-TRLR
  6442         DEPENDING ON DFHEIGDI
  6443     ELSE IF DFHEIGDJ EQUAL 13
  6444         GO TO 8300-SEND-TEXT
  6445         DEPENDING ON DFHEIGDI.
  6446     MOVE '9%                    "   ' TO DFHEIV0
  6447     MOVE 'EL151' TO DFHEIV1
  6448     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6449     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5864     Code:       13394
