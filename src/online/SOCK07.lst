* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page   1
* SOCK07.cbl
* Options: int("SOCK07.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK07.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK07.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK07.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID. SOCK07.
     4 AUTHOR.     Cowtown.
     5 DATE-COMPILED. 15-May-17 13:04.
     6*SECURITY.   *****************************************************
     7*            *                                                   *
     8*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
     9*            *                                                   *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF     CSO     IS EXPRESSLY PROHIBITED WITHOUT  *
    12*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page   2
* SOCK07.cbl
    14*            *****************************************************
    15******************************************************************
    16*REMARKS.                                                        *
    17*  Returns premium calc based on info passed to me.              *
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 020617   2017020300002   PEMA  New Program
    27******************************************************************
    28 ENVIRONMENT DIVISION.
    29 data division.
    30 WORKING-STORAGE SECTION.
    31 01  DFH-START PIC X(04).
    32 77  FILLER  PIC X(32) VALUE '********************************'.
    33 77  FILLER  PIC X(32) VALUE '   SOCK07   WORKING STORAGE     '.
    34 77  FILLER  PIC X(32) VALUE '********************************'.
    35*
    36* program buffers
    37*
    38 77 ws-send-msg-size             pic s9(8) comp value 256.
    39 77 ws-recv-msg-size             pic s9(8) comp value 256.
    40 77 ws-recv-buf                  pic x(256).
    41 77 ws-send-buf                  pic x(256) VALUE SPACES.
    42 77 ws-recv-total                pic s9(8) comp value 0.
    43 77 ws-recv-left                 pic s9(8) comp value 0.
    44 77 ws-seq-num                   pic s9(8) comp value 0.
    45 77 ws-flags                     pic s9(8) comp value 0.
    46 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    47 77  ws-comp-id                  pic xxx value spaces.
    48 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    49 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    50 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    51 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    52 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    53 77 X1                           PIC S999 COMP-3 VALUE +0.
    54 77 S1                           PIC S999 COMP-3 VALUE +0.
    55 77 S2                           PIC S999 COMP-3 VALUE +0.
    56 77 WS-BUILD-SW                  PIC X.
    57    88  TIME-TO-BUILD               VALUE 'Y'.
    58 77 WS-SAVE-ERACCT               PIC X(2000).
    59 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    60 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    61    88  GET-RATES                    VALUE 'R'.
    62    88  GET-ACT-ACCTS                VALUE 'A'.
    63 77  ws-bin-current-dt           pic xx  value low-values.
    64 77 ws-bin-eff-dt                pic xx  value low-values.
    65 77  ws-bin-exp-dt               pic xx  value low-values.
    66 77 ws-bin-1st-pmt-dt            pic xx  value low-values.
    67 77 ws-bin-pri-birth-dt          pic xx  value low-values.
    68 77 ws-bin-cob-birth-dt          pic xx  value low-values.
    69 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    70 77 ws-disp-rate                 pic z9.99999.
    71 77  WS-ERACCT-SW                PIC X VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page   3
* SOCK07.cbl
    72     88  END-OF-ERACCT                 VALUE 'Y'.
    73 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    74     88  END-OF-ERCTBL                 VALUE 'Y'.
    75 77  WS-STATUS                   PIC X.
    76 77  ws-socket-sw                pic x value ' '.
    77     88  end-of-socket              value 'Y'.
    78 77  rec-cnt                     pic 9(5) value zeros.
    79 77  ws-stop-sw                  pic x value ' '.
    80     88  i-say-stop                 value 'Y'.
    81 77  ws-browse-sw                pic x value ' '.
    82     88  browse-started            value 'Y'.
    83 77  ws-contract-sw              pic x  value ' '.
    84     88  contract-no-assigned      value 'Y'.
    85 77  ws-error-sw                 pic x value ' '.
    86     88  error-in-one-coverage     value 'Y'.
    87 77  ws-connect-sw               pic x value ' '.
    88     88  connected-to-db           value 'Y'.
    89 01  P pointer.
    90 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    91 01  var-ptr pointer.
    92 01  env-var-len                 pic 9(4)  binary.
    93 01  rc                          pic 9(9)  binary.
    94 01  WS-KIXSYS.
    95     05  WS-KIX-FIL1             PIC X(10).
    96     05  WS-KIX-APPS             PIC X(10).
    97     05  WS-KIX-ENV              PIC X(10).
    98     05  WS-KIX-MYENV            PIC X(10).
    99     05  WS-KIX-SYS              PIC X(10).
*  100 EXEC SQL
*  101    INCLUDE SQLDA
*  102 END-EXEC
   103 01 SQLDA sync.
   104    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   105    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   106    05 SQLN                  PIC S9(4) COMP-5 value 0.
   107    05 SQLD                  PIC S9(4) COMP-5 value 0.
   108    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   109       10 SQLTYPE            PIC S9(4) COMP-5.
   110       10 SQLLEN             PIC S9(4) COMP-5.
   111$IF P64 SET
   112X      *> For 64-bit environments, ensure that SQLDATA is
   113X      *> aligned on an 8-byte boundary.
   114X      10 FILLER             PIC S9(9) COMP-5.
   115$END
   116       10 SQLDATA            USAGE POINTER.
   117       10 SQLIND             USAGE POINTER.
   118       10 SQLNAME.
   119          15 SQLNAMEL        PIC S9(4) COMP-5.
   120          15 SQLNAMEC        PIC X(30).
   121
   122* Values for SQLTYPE
   123
   124 78  ESQL-DATE-CHAR              VALUE 384.
   125 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   126 78  ESQL-DATE-REC               VALUE 386.
   127 78  ESQL-DATE-REC-NULL          VALUE 387.
   128 78  ESQL-TIME-CHAR              VALUE 388.
   129 78  ESQL-TIME-CHAR-NULL         VALUE 389.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page   4
* SOCK07.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-TIME-REC               VALUE 390.
   131 78  ESQL-TIME-REC-NULL          VALUE 391.
   132 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   133 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   134 78  ESQL-TIMESTAMP-REC          VALUE 394.
   135 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   136 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   137 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   138 78  ESQL-TS-OFFSET-REC          VALUE 398.
   139 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   140 78  ESQL-LONGVARBINARY          VALUE 404.
   141 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   142 78  ESQL-LONGVARCHAR            VALUE 408.
   143 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   144 78  ESQL-BINARY                 VALUE 444.
   145 78  ESQL-BINARY-NULL            VALUE 445.
   146 78  ESQL-VARBINARY              VALUE 446.
   147 78  ESQL-VARBINARY-NULL         VALUE 447.
   148 78  ESQL-VARCHAR                VALUE 448.
   149 78  ESQL-VARCHAR-NULL           VALUE 449.
   150
   151 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   152 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   153
   154 78  ESQL-CHAR                   VALUE 452.
   155 78  ESQL-CHAR-NULL              VALUE 453.
   156
   157 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   158 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   159
   160 78  ESQL-DOUBLE                 VALUE 480.
   161 78  ESQL-DOUBLE-NULL            VALUE 481.
   162 78  ESQL-REAL                   VALUE 482.
   163 78  ESQL-REAL-NULL              VALUE 483.
   164 78  ESQL-DECIMAL                VALUE 484.
   165 78  ESQL-DECIMAL-NULL           VALUE 485.
   166 78  ESQL-INTEGER                VALUE 496.
   167 78  ESQL-INTEGER-NULL           VALUE 497.
   168 78  ESQL-SMALLINT               VALUE 500.
   169 78  ESQL-SMALLINT-NULL          VALUE 501.
   170 78  ESQL-TINYINT                VALUE 502.
   171 78  ESQL-TINYINT-NULL           VALUE 503.
*  172 EXEC SQL
*  173    INCLUDE SQLCA
*  174 END-EXEC
   175 01 SQLCA.
   176     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   177     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   178     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   179     05  SQLERRM.
   180         49  SQLERRML    PIC S9(4) COMP-5.
   181         49  SQLERRMC    PIC X(70).
   182     05  SQLERRP         PIC X(8).
   183     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   184     05  SQLWARN.
   185         10  SQLWARN0    PIC X.
   186         10  SQLWARN1    PIC X.
   187         10  SQLWARN2    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page   5
* SOCK07.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         10  SQLWARN3    PIC X.
   189         10  SQLWARN4    PIC X.
   190         10  SQLWARN5    PIC X.
   191         10  SQLWARN6    PIC X.
   192         10  SQLWARN7    PIC X.
   193     05  SQLEXT.
   194         10  SQLWARN8    PIC X.
   195         10  SQLWARN9    PIC X.
   196         10  SQLWARN10   PIC X.
   197         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   198     05  SQLSTATE    PIC X(5).
   199 EXEC SQL
   200    BEGIN DECLARE SECTION
   201 END-EXEC
   202 01  ws-dealer-state             pic xx.
   203 01  ws-dealer-id                pic x(10).
   204 01  ws-contract-eff-dt          pic x(10).
   205 01  ws-contract-no              pic x(10) value spaces.
   206 01  ws-contract-suffix          pic x     value spaces.
   207 01  ws-key-stuff.
   208     05  ws-ks-contract-no       pic x(10) value spaces.
   209     05  ws-batch-no             pic x(6) value zeros.
   210     05  ws-batch-no-n redefines
   211         ws-batch-no             pic 9(6).
   212     05  ws-check-key            pic 9(7).
   213     05  ws-check-no             pic x(7).
   214     05  ws-compid               pic xxx.
   215     05  ws-carrier              pic x.
   216     05  ws-grouping             pic x(6).
   217     05  ws-state                pic xx.
   218     05  ws-account              pic x(10).
   219     05  ws-eff-date             pic x(10).
   220     05  ws-certificate          pic x(10).
   221     05  ws-cert-sfx             pic x.
   222     05  ws-seq-no               pic 999.
   223     05  ws-type                 pic 999.
   224 01  ws-status-code-a            pic x(7) value zeros.
   225 01  ws-status-code redefines
   226     ws-status-code-a            pic 9(7).
   227 01  ws-error-message            pic x(50) value spaces.
   228 01  ws-status-date              pic x(10).
   229 01  sqlcmd                      pic x(1024).
   230 01  svr                         pic x(32).
   231 01  usr                         pic x(32).
   232 01  pass                        pic x(32).
   233 01  usr-pass                    pic x(64).
   234 01  ws-disp-code                pic s9(11).
   235***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   236***                                                            ***
   237***  These indicators are used to determine if a variable      ***
   238***  is        null.           The indicator will be -1        ***
   239***  if the value        is null  and +0 if the value is       ***
   240***  something other than null.  Here is an example on how     ***
   241***  to use the indicator variables.                           ***
   242***                                                            ***
   243***     EXEC SQL                                               ***
   244***        fetch checkapp into                                 ***
   245***           :db-app-status :nu-app-status,                   ***
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page   6
* SOCK07.cbl
   246***           :db-app-by     :nu-app-by,                       ***
   247***           :db-app-date   :nu-app-date,                     ***
   248***           :db-app-batch  :nu-app-batch                     ***
   249***     END-EXEC                                               ***
   250***                                                            ***
   251***           OR This way on an update                         ***
   252***                                                            ***
   253***     EXEC SQL                                               ***
   254***        UPDATE                                              ***
   255***           CUC_Logic_Remittance                             ***
   256***        SET                                                 ***
   257***           LogicStatus     = :ws-status-code,               ***
   258***           LogicStatusDate = :ws-status-date,               ***
   259***           BatchNumber     = :ws-batch-no :nu-batchno       ***
   260***        WHERE                                               ***
   261***           RemitId = :ws-remit-id                           ***
   262***     END-EXEC                                               ***
   263***                                                            ***
   264***    Also, when the table has a column with a data type of   ***
   265***  "BIT" and used as true/false move the 1 byte receiving    ***
   266***  field to ws-bit and check out ws-bit-comp. if = zeros,    ***
   267***  then its false. I think true would be 256.                ***
   268***                                                            ***
   269***                                                            ***
   270***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   271 01  ws-bit                      pic x.
   272 01  ws-bit-comp redefines ws-bit pic s9(4) comp.
   273 01  indicator-vaiables-for-nulls.
   274     05  nu-app-status           pic s9(4) comp value +0.
   275     05  nu-app-by               pic s9(4) comp value +0.
   276     05  nu-app-date             pic s9(4) comp value +0.
   277     05  nu-app-batch            pic s9(4) comp value +0.
   278     05  nu-fincar               pic s9(4) comp value +0.
   279     05  nu-batchno              pic s9(4) comp value +0.
   280     05  nu-error-message        pic s9(4) comp value +0.
   281 01  sql-cert-records.
   282     05  sql-dlr-state           pic xx.
   283     05  sql-dlr-id              pic x(10).
   284     05  sql-eff-dt              pic x(10).
   285     05  sql-contr-no            pic x(10).
   286     05  sql-contr-suffix        pic x.
   287 EXEC SQL
   288    END DECLARE SECTION
   289 END-EXEC
   290 01  filler.
   291     05  ws-last-suffix          pic x value low-values.
   292     05  ws-tbl-last-suffix      pic x value low-values.
   293     05  filler.  *> Use X1 for this table.
   294         10  ws-codes            pic x(26) value
   295         ' ABCDEFGHIJKLMNOPQRSTUVWXY'.
   296         10  ws-suffix-value redefines ws-codes
   297           occurs 26             pic x.
   298 01  ws-work-date.
   299     05  ws-work-ccyy            pic x(4).
   300     05  ws-work-mm              pic xx.
   301     05  ws-work-dd              pic xx.
   302 01  ws-work-date-num redefines ws-work-date
   303                                 pic 9(8).
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page   7
* SOCK07.cbl
   304 01  ws-rate-work-area.
   305     05  ws-rate-benefit-type   pic x.
   306     05  ws-rate-benefit-cd     pic xx.
   307     05  ws-rate-benefit-a      pic x(8).
   308     05  ws-rate-benefit redefines
   309         ws-rate-benefit-a      pic 9(6)v99.
   310     05  ws-rate-premium-a      pic x(7).
   311     05  ws-rate-premium redefines
   312         ws-rate-premium-a      pic 9(5)v99.
   313     05  ws-rate-apr-a          pic x(7).
   314     05  ws-rate-apr redefines
   315         ws-rate-apr-a          pic 99v9(5).
   316     05  ws-rate-loan-term      pic 999  value zeros.
   317     05  ws-rate-ins-term       pic 999  value zeros.
   318     05  ws-issue-age           pic 999  value zeros.
   319     05  ws-cob-age             pic 999  value zeros.
   320     05  ws-rate-age            pic 999  value zeros.
   321     05  ws-max-benefit         pic 9(7)v99 value zeros.
   322     05  ws-rate-max-bens       pic 99.
   323 01  soc-client-in-data.
   324     05  rate-state              pic xx.
   325     05  rate-acct-no            pic x(10).
   326     05  rate-vin                pic x(17).
   327     05  rate-lf-ah              pic x.
   328     05  rate-ben-code           pic xx.
   329     05  rate-earn-meth          pic x.
   330     05  rate-pri-birth-date     pic x(10).
   331     05  rate-cob-birth-date     pic x(10).
   332     05  rate-benefit.
   333         10  rate-ben-dollars    pic x(6).
   334         10  f                   pic x.
   335         10  rate-ben-pennies    pic xx.
   336     05  rate-eff-date           pic x(10).
   337     05  rate-1st-pmt-dt         pic x(10).
   338     05  rate-premium.
   339         10  rate-prem-dollars   pic x(5).
   340         10  f                   pic x.
   341         10  rate-prem-pennies   pic xx.
   342     05  rate-loan-term          pic xxx.
   343     05  rate-loan-term-n redefines
   344             rate-loan-term      pic 999.
   345     05  rate-ins-term           pic XXX.
   346     05  rate-ins-term-n redefines
   347         rate-ins-term           pic 999.
   348     05  rate-apr.
   349         10  rate-apr-whole      pic xx.
   350         10  f                   pic x.
   351         10  rate-apr-dec        pic x(5).
   352     05  rate-sin-jnt-ind        pic x.
   353     05  rate-dismemberment      pic x.
   354     05  rate-retro-elim         pic x.
   355     05  rate-waiting-days       pic xx.
   356     05  rate-waiting-days-n redefines
   357         rate-waiting-days       pic 99.
   358     05  rate-crit-per           pic xx.
   359     05  rate-crit-per-n redefines
   360         rate-crit-per           pic 99.
   361 01  WS-AM-KEY.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page   8
* SOCK07.cbl
   362     05  WS-AM-COMPANY-CD        PIC X.
   363     05  WS-AM-CARRIER           PIC X.
   364     05  WS-AM-GROUP             PIC X(6).
   365     05  WS-AM-STATE             PIC XX.
   366     05  WS-AM-ACCOUNT           PIC X(10).
   367     05  WS-AM-EXP-DT            PIC XX.
   368     05  FILLER                  PIC X(4).
   369 01  ws-cm5-compare-key          pic x(12).
   370 01  WS-CM5-KEY.
   371     05  WS-CM5-COMPANY-CD       PIC X.
   372     05  WS-CM5-CERT-NO          PIC X(11).
   373 01  ws-cm-compare-key           pic x(33).
   374 01  WS-CM-KEY.
   375     05  WS-CM-COMPANY-CD        PIC X.
   376     05  WS-CM-CARRIER           PIC X.
   377     05  WS-CM-GROUP             PIC X(6).
   378     05  WS-CM-STATE             PIC XX.
   379     05  WS-CM-ACCOUNT           PIC X(10).
   380     05  WS-CM-EFF-DT            PIC XX.
   381     05  WS-CM-CERT-NO.
   382         10  ws-cm-cert-ten      pic x(10).
   383         10  ws-cm-cert-suffix   pic x.
   384 01  WS-CS-KEY.
   385     05  WS-CS-COMPANY-CD        PIC X.
   386     05  WS-CS-CARRIER           PIC X.
   387     05  WS-CS-GROUP             PIC X(6).
   388     05  WS-CS-STATE             PIC XX.
   389     05  WS-CS-ACCOUNT           PIC X(10).
   390     05  WS-CS-EFF-DT            PIC XX.
   391     05  WS-CS-CERT-NO           PIC X(11).
   392     05  WS-CS-TRLR-TYPE         PIC X.
   393 01  WS-AM-ALT-KEY.
   394     05  WS-AM-ALT-ACCOUNT       PIC X(10).
   395     05  WS-AM-ALT-EXP-DT        PIC XX.
   396 01  WS-CF-KEY-SAVE              PIC X(10).
   397 01  WS-CF-KEY.
   398     05  WS-CF-COMPANY-ID        PIC XXX.
   399     05  WS-CF-RECORD-TYPE       PIC X.
   400     05  WS-CF-ACCESS            PIC X(4).
   401     05  WS-CF-SEQ-NO            PIC S9(4) COMP.
   402 01  filler.
   403     05  ws-errors-table.
   404         10  filler              pic x(50) value
   405         '0000Transaction successfully completed'.
   406         10  filler              pic x(50) value
   407         '0101Problem with amounts'.
   408         10  filler              pic x(50) value
   409         '0102Problem with dates'.
   410         10  filler              pic x(50) value
   411         '0103Issue age outside limits'.
   412         10  filler              pic x(50) value
   413         '0104Attained age outside limits'.
   414         10  filler              pic x(50) value
   415         '0105Term is not valid must be gt 0 and lt 361'.
   416         10  filler              pic x(50) value
   417         '0106Term is outside limits'.
   418         10  filler              pic x(50) value
   419         '0107Amount is outside limits'.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page   9
* SOCK07.cbl
   420         10  filler              pic x(50) value
   421         '0108Loan term must be ge insurance term'.
   422         10  filler              pic x(50) value
   423         '0109Total benefit is outside limits'.
   424         10  filler              pic x(50) value
   425         '0110Rates found were zero'.
   426         10  filler              pic x(50) value
   427         '0111Rate table was not found'.
   428         10  filler              pic x(50) value
   429         '0112Rate file not open'.
   430         10  filler              pic x(50) value
   431         '0113Premium is out of tolerence'.
   432         10  filler              pic x(50) value
   433         '0114Duplicate contract and VIN on Logic'.
   434         10  filler              pic x(50) value
   435         '0115Problem with loan or insurance term'.
   436     05  filler redefines ws-errors-table occurs 16.
   437         10  ws-table-error-no   pic x(4).
   438         10  ws-table-error-mess pic x(46).
   439 01  ws-return-string.
   440     05  ws-return-error-no      pic x(4).
   441     05  ws-sc1                  pic x.
   442     05  ws-return-error-mess    pic x(46).
   443     05  ws-sc2                  pic x.
   444     05  ws-return-contract-no   pic x(11).
   445     05  ws-sc3                  pic x.
   446     05  ws-return-max-ben       pic z,zzz,z99.99.
   447     05  ws-sc4                  pic x.
   448     05  ws-return-prem          pic z,zzz,z99.99.
   449     05  ws-sc5                  pic x.
   450     05  ws-return-rate          pic z9.99999.
   451     05  ws-sc6                  pic x.
   452     05  ws-return-exp-dt        pic x(10).
   453     05  ws-sc7                  pic x.
   454     05  ws-return-benefit-cd    pic xx.
   455 01  WS-CID-NO                   PIC X(8).
   456 01  WS-DISP-RESP                PIC 9(5).
   457 01  WS-RESPONSE                 PIC S9(8)   COMP.
   458     88  RESP-NORMAL                  VALUE +00.
   459     88  RESP-NOTFND                  VALUE +13.
   460     88  resp-duprec                  value +14.
   461     88  resp-dupkey                  value +15.
   462     88  RESP-NOTOPEN                 VALUE +19.
   463     88  RESP-ENDFILE                 VALUE +20.
   464*                                 COPY ERCACCT.
   465******************************************************************
   466*                                                                *
   467*                                                                *
   468*                            ERCACCT                             *
   469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   470*                            VMOD=2.031                          *
   471*                                                                *
   472*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   473*                                                                *
   474*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   475*   VSAM ACCOUNT MASTER FILES.                                   *
   476*                                                                *
   477*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  10
* SOCK07.cbl
   478*                                                                *
   479*   FILE TYPE = VSAM,KSDS                                        *
   480*   RECORD SIZE = 2000  RECFORM = FIX                            *
   481*                                                                *
   482*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   483*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   484*                                                                *
   485*   LOG = NO                                                     *
   486*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   487*                                                                *
   488*                                                                *
   489******************************************************************
   490*                   C H A N G E   L O G
   491*
   492* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   493*-----------------------------------------------------------------
   494*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   495* EFFECTIVE    NUMBER
   496*-----------------------------------------------------------------
   497* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   498* 092705    2005050300006  PEMA  ADD SPP LEASES
   499* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   500* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   501* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   502* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   503* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   504* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
   505******************************************************************
   506
   507 01  ACCOUNT-MASTER.
   508     12  AM-RECORD-ID                      PIC XX.
   509         88  VALID-AM-ID                      VALUE 'AM'.
   510
   511     12  AM-CONTROL-PRIMARY.
   512         16  AM-COMPANY-CD                 PIC X.
   513         16  AM-MSTR-CNTRL.
   514             20  AM-CONTROL-A.
   515                 24  AM-CARRIER            PIC X.
   516                 24  AM-GROUPING.
   517                     28 AM-GROUPING-PREFIX PIC XXX.
   518                     28 AM-GROUPING-PRIME  PIC XXX.
   519                 24  AM-STATE              PIC XX.
   520                 24  AM-ACCOUNT.
   521                     28  AM-ACCOUNT-PREFIX PIC X(4).
   522                     28  AM-ACCOUNT-PRIME  PIC X(6).
   523             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   524                                           PIC X(19).
   525             20  AM-CNTRL-B.
   526                 24  AM-EXPIRATION-DT      PIC XX.
   527                 24  FILLER                PIC X(4).
   528             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   529                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   530
   531     12  AM-CONTROL-BY-VAR-GRP.
   532         16  AM-COMPANY-CD-A1              PIC X.
   533         16  AM-VG-CARRIER                 PIC X.
   534         16  AM-VG-GROUPING                PIC X(6).
   535         16  AM-VG-STATE                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  11
* SOCK07.cbl
   536         16  AM-VG-ACCOUNT                 PIC X(10).
   537         16  AM-VG-DATE.
   538             20  AM-VG-EXPIRATION-DT       PIC XX.
   539             20  FILLER                    PIC X(4).
   540         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   541                                           PIC 9(11)      COMP-3.
   542     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   543         16  FILLER                        PIC X(10).
   544         16  AM-VG-KEY3.
   545             20  AM-VG3-ACCOUNT            PIC X(10).
   546             20  AM-VG3-EXP-DT             PIC XX.
   547         16  FILLER                        PIC X(4).
   548     12  AM-MAINT-INFORMATION.
   549         16  AM-LAST-MAINT-DT              PIC XX.
   550         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   551         16  AM-LAST-MAINT-USER            PIC X(4).
   552         16  FILLER                        PIC XX.
   553
   554     12  AM-EFFECTIVE-DT                   PIC XX.
   555     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   556
   557     12  AM-PREV-DATES  COMP-3.
   558         16  AM-PREV-EXP-DT                PIC 9(11).
   559         16  AM-PREV-EFF-DT                PIC 9(11).
   560
   561     12  AM-REPORT-CODE-1                  PIC X(10).
   562     12  AM-REPORT-CODE-2                  PIC X(10).
   563
   564     12  AM-CITY-CODE                      PIC X(4).
   565     12  AM-COUNTY-PARISH                  PIC X(6).
   566
   567     12  AM-NAME                           PIC X(30).
   568     12  AM-PERSON                         PIC X(30).
   569     12  AM-ADDRS                          PIC X(30).
   570     12  AM-CITY.
   571         16  AM-ADDR-CITY                  PIC X(28).
   572         16  AM-ADDR-STATE                 PIC XX.
   573     12  AM-ZIP.
   574         16  AM-ZIP-PRIME.
   575             20  AM-ZIP-PRI-1ST            PIC X.
   576                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   577             20  FILLER                    PIC X(4).
   578         16  AM-ZIP-PLUS4                  PIC X(4).
   579     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   580         16  AM-CAN-POSTAL-1               PIC XXX.
   581         16  AM-CAN-POSTAL-2               PIC XXX.
   582         16  FILLER                        PIC XXX.
   583     12  AM-TEL-NO.
   584         16  AM-AREA-CODE                  PIC 999.
   585         16  AM-TEL-PRE                    PIC 999.
   586         16  AM-TEL-NBR                    PIC 9(4).
   587     12  AM-TEL-LOC                        PIC X.
   588         88  AM-TEL-AT-HOME                   VALUE 'H'.
   589         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   590
   591     12  AM-COMM-STRUCTURE.
   592         16  AM-DEFN-1.
   593             20  AM-AGT-COMMS       OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  12
* SOCK07.cbl
   594                 24  AM-AGT.
   595                     28  AM-AGT-PREFIX     PIC X(4).
   596                     28  AM-AGT-PRIME      PIC X(6).
   597                 24  AM-COM-TYP            PIC X.
   598                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   599                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   600                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   601                 24  AM-RECALC-LV-INDIC    PIC X.
   602                 24  AM-RETRO-LV-INDIC     PIC X.
   603                 24  AM-GL-CODES           PIC X.
   604                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   605                 24  FILLER                PIC X(01).
   606         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   607             20  AM-COM-TBLS        OCCURS 10 TIMES.
   608                 24  FILLER                PIC X(11).
   609                 24  AM-L-COMA             PIC XXX.
   610                 24  AM-J-COMA             PIC XXX.
   611                 24  AM-A-COMA             PIC XXX.
   612                 24  FILLER                PIC X(6).
   613
   614     12  AM-COMM-CHANGE-STATUS             PIC X.
   615         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   616
   617     12  AM-CSR-CODE                       PIC X(4).
   618
   619     12  AM-BILLING-STATUS                 PIC X.
   620         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   621         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   622     12  AM-AUTO-REFUND-SW                 PIC X.
   623         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   624         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   625     12  AM-GPCD                           PIC 99.
   626     12  AM-IG                             PIC X.
   627         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   628         88  AM-HAS-GROUP                     VALUE '2'.
   629     12  AM-STATUS                         PIC X.
   630         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   631         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   632         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   633         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   634         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   635         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   636         88  AM-ACCOUNT-DROPPED               VALUE '6'.
   637         88  AM-ACCOUNT-LAPSED                VALUE '7'.
   638         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
   639         88  AM-ACCOUNT-PENDING               VALUE '9'.
   640     12  AM-REMIT-TO                       PIC 99.
   641     12  AM-ID-NO                          PIC X(11).
   642
   643     12  AM-CAL-TABLE                      PIC XX.
   644     12  AM-LF-DEVIATION                   PIC XXX.
   645     12  AM-AH-DEVIATION                   PIC XXX.
   646     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   647     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   648     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   649     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   650     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   651     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  13
* SOCK07.cbl
   652
   653     12  AM-USER-FIELDS.
   654         16  AM-FLD-1                      PIC XX.
   655         16  AM-FLD-2                      PIC XX.
   656         16  AM-FLD-3                      PIC XX.
   657         16  AM-FLD-4                      PIC XX.
   658         16  AM-FLD-5                      PIC XX.
   659
   660     12  AM-1ST-PROD-DATE.
   661         16  AM-1ST-PROD-YR                PIC XX.
   662         16  AM-1ST-PROD-MO                PIC XX.
   663         16  AM-1ST-PROD-DA                PIC XX.
   664     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   665     12  AM-CERTS-PURGED-DATE.
   666         16  AM-PUR-YR                     PIC XX.
   667         16  AM-PUR-MO                     PIC XX.
   668         16  AM-PUR-DA                     PIC XX.
   669     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   670     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   671     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   672     12  AM-INACTIVE-DATE.
   673         16  AM-INA-MO                     PIC 99.
   674         16  AM-INA-DA                     PIC 99.
   675         16  AM-INA-YR                     PIC 99.
   676     12  AM-AR-HI-CERT-DATE                PIC XX.
   677
   678     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   679     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   680
   681     12  AM-OB-PAYMENT-MODE                PIC X.
   682         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   683         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   684         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   685         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   686
   687     12  AM-AH-ONLY-INDICATOR              PIC X.
   688         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   689         88  AM-NO-AH-ONLY                    VALUE 'N'.
   690
   691     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   692
   693     12  AM-OVER-SHORT.
   694         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   695         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   696
   697     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   698     12  AM-DCC-CLP-STATE                  PIC XX.
   699
   700     12  AM-RECALC-COMM                    PIC X.
   701     12  AM-RECALC-REIN                    PIC X.
   702
   703     12  AM-REI-TABLE                      PIC XXX.
   704     12  AM-REI-ET-LF                      PIC X.
   705     12  AM-REI-ET-AH                      PIC X.
   706     12  AM-REI-PE-LF                      PIC X.
   707     12  AM-REI-PE-AH                      PIC X.
   708     12  AM-REI-PRT-ST                     PIC X.
   709     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  14
* SOCK07.cbl
   710     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   711     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   712     12  AM-REI-GROUP-A                    PIC X(6).
   713     12  AM-REI-MORT                       PIC X(4).
   714     12  AM-REI-PRT-OW                     PIC X.
   715     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   716     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   717     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   718     12  AM-REI-GROUP-B                    PIC X(6).
   719
   720     12  AM-TRUST-TYPE                     PIC X(2).
   721
   722     12  AM-EMPLOYER-STMT-USED             PIC X.
   723     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   724
   725     12  AM-STD-AH-TYPE                    PIC XX.
   726     12  AM-EARN-METHODS.
   727         16  AM-EARN-METHOD-R              PIC X.
   728             88 AM-REF-RL-R78                 VALUE 'R'.
   729             88 AM-REF-RL-PR                  VALUE 'P'.
   730             88 AM-REF-RL-MEAN                VALUE 'M'.
   731             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   732         16  AM-EARN-METHOD-L              PIC X.
   733             88 AM-REF-LL-R78                 VALUE 'R'.
   734             88 AM-REF-LL-PR                  VALUE 'P'.
   735             88 AM-REF-LL-MEAN                VALUE 'M'.
   736             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   737         16  AM-EARN-METHOD-A              PIC X.
   738             88 AM-REF-AH-R78                 VALUE 'R'.
   739             88 AM-REF-AH-PR                  VALUE 'P'.
   740             88 AM-REF-AH-MEAN                VALUE 'M'.
   741             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   742             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   743             88 AM-REF-AH-NET                 VALUE 'N'.
   744
   745     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   746     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   747     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   748
   749     12  AM-RET-Y-N                        PIC X.
   750     12  AM-RET-P-E                        PIC X.
   751     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   752     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   753     12  AM-RET-GRP                        PIC X(6).
   754     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   755         16  AM-POOL-PRIME                 PIC XXX.
   756         16  AM-POOL-SUB                   PIC XXX.
   757     12  AM-RETRO-EARNINGS.
   758         16  AM-RET-EARN-R                 PIC X.
   759         16  AM-RET-EARN-L                 PIC X.
   760         16  AM-RET-EARN-A                 PIC X.
   761     12  AM-RET-ST-TAX-USE                 PIC X.
   762         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   763         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   764     12  AM-RETRO-BEG-EARNINGS.
   765         16  AM-RET-BEG-EARN-R             PIC X.
   766         16  AM-RET-BEG-EARN-L             PIC X.
   767         16  AM-RET-BEG-EARN-A             PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  15
* SOCK07.cbl
   768     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   769     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   770
   771     12  AM-USER-SELECT-OPTIONS.
   772         16  AM-USER-SELECT-1              PIC X(10).
   773         16  AM-USER-SELECT-2              PIC X(10).
   774         16  AM-USER-SELECT-3              PIC X(10).
   775         16  AM-USER-SELECT-4              PIC X(10).
   776         16  AM-USER-SELECT-5              PIC X(10).
   777
   778     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   779
   780     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   781
   782     12  AM-RPT045A-SWITCH                 PIC X.
   783         88  RPT045A-OFF                   VALUE 'N'.
   784
   785     12  AM-INSURANCE-LIMITS.
   786         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   787         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   788
   789     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   790         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   791
   792     12  AM-DISMBR-COVERAGE-SW             PIC X.
   793         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   794         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   795
   796     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   797
   798     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   799     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   800     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   801     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   802     12  AM-DCC-UEF-STATE                  PIC XX.
   803     12  FILLER                            PIC XXX.
   804     12  AM-REPORT-CODE-3                  PIC X(10).
   805*    12  FILLER                            PIC X(22).
   806
   807     12  AM-RESERVE-DATE.
   808         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   809         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   810         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   811
   812     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   813     12  AM-NOTIFICATION-TYPES.
   814         16  AM-NOTIF-OF-LETTERS           PIC X.
   815         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   816         16  AM-NOTIF-OF-REPORTS           PIC X.
   817         16  AM-NOTIF-OF-STATUS            PIC X.
   818
   819     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   820         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   821         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   822         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   823         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   824
   825     12  AM-BENEFIT-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  16
* SOCK07.cbl
   826         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   827             20  AM-BENEFIT-CODE           PIC XX.
   828             20  AM-BENEFIT-TYPE           PIC X.
   829             20  AM-BENEFIT-REVISION       PIC XXX.
   830             20  AM-BENEFIT-REM-TERM       PIC X.
   831             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   832             20  FILLER                    PIC XX.
   833         16  FILLER                        PIC X(80).
   834
   835     12  AM-TRANSFER-DATA.
   836         16  AM-TRANSFERRED-FROM.
   837             20  AM-TRNFROM-CARRIER        PIC X.
   838             20  AM-TRNFROM-GROUPING.
   839                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   840                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   841             20  AM-TRNFROM-STATE          PIC XX.
   842             20  AM-TRNFROM-ACCOUNT.
   843                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   844                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   845             20  AM-TRNFROM-DTE            PIC XX.
   846         16  AM-TRANSFERRED-TO.
   847             20  AM-TRNTO-CARRIER          PIC X.
   848             20  AM-TRNTO-GROUPING.
   849                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   850                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   851             20  AM-TRNTO-STATE            PIC XX.
   852             20  AM-TRNTO-ACCOUNT.
   853                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   854                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   855             20  AM-TRNTO-DTE              PIC XX.
   856         16  FILLER                        PIC X(10).
   857
   858     12  AM-SAVED-REMIT-TO                 PIC 99.
   859
   860     12  AM-COMM-STRUCTURE-SAVED.
   861         16  AM-DEFN-1-SAVED.
   862             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   863                 24  AM-AGT-SV             PIC X(10).
   864                 24  AM-COM-TYP-SV         PIC X.
   865                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   866                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
   867                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
   868                 24  AM-RECALC-LV-INDIC-SV PIC X.
   869                 24  FILLER                PIC X.
   870                 24  AM-GL-CODES-SV        PIC X.
   871                 24  AM-COM-CHARGEBACK-SV  PIC 99.
   872                 24  FILLER                PIC X.
   873         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
   874             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
   875                 24  FILLER                PIC X(11).
   876                 24  AM-L-COMA-SV          PIC XXX.
   877                 24  AM-J-COMA-SV          PIC XXX.
   878                 24  AM-A-COMA-SV          PIC XXX.
   879                 24  FILLER                PIC X(6).
   880
   881     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
   882         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
   883            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  17
* SOCK07.cbl
   884            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
   885            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
   886
   887     12  AM-ORIG-DEALER-NO                 PIC X(10).
   888     12  FILLER                            PIC X(120).
   889
   890     12  AM-ACCOUNT-EXECUTIVE-DATA.
   891         16  AM-CONTROL-NAME               PIC X(30).
   892         16  AM-EXECUTIVE-ONE.
   893             20  AM-EXEC1-NAME             PIC X(15).
   894             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
   895                                                          COMP-3.
   896             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
   897                                                          COMP-3.
   898         16  AM-EXECUTIVE-TWO.
   899             20  AM-EXEC2-NAME             PIC X(15).
   900             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
   901                                                          COMP-3.
   902             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
   903                                                          COMP-3.
   904
   905     12  AM-RETRO-ADDITIONAL-DATA.
   906         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
   907         16  AM-RETRO-PREM-P-E             PIC X.
   908         16  AM-RETRO-CLMS-P-I             PIC X.
   909         16  AM-RETRO-RET-BRACKET-LF.
   910             20  AM-RETRO-RET-METHOD-LF    PIC X.
   911                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
   912                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
   913             20  AM-RETRO-RET-BASIS-LF     PIC X.
   914                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
   915                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
   916             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
   917                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
   918                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
   919         16  AM-RETRO-RET-BRACKET-AH.
   920             20  AM-RETRO-RET-METHOD-AH    PIC X.
   921                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
   922                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
   923                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
   924             20  AM-RETRO-RET-BASIS-AH     PIC X.
   925                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
   926                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
   927             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
   928                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
   929                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
   930
   931     12  AM-COMMENTS.
   932         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
   933
   934     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
   935         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
   936         16  AM-FLI-BILLING-CODE           PIC X.
   937         16  AM-FLI-ALT-STATE-CODE         PIC XX.
   938         16  AM-FLI-UNITED-IDENT           PIC X.
   939         16  AM-FLI-INTEREST-LOST-DATA.
   940             20  AM-FLI-BANK-NO            PIC X(5).
   941             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  18
* SOCK07.cbl
   942             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
   943             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
   944         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
   945             20  AM-FLI-AGT                PIC X(9).
   946             20  AM-FLI-AGT-COMM-ACC       PIC X.
   947             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
   948         16  FILLER                        PIC X(102).
   949
   950     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
   951         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
   952             20  AM-BENEFIT-DMD-CODE         PIC XX.
   953             20  AM-BENEFIT-DMD-TYPE         PIC X.
   954             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
   955             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
   956             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
   957         16  FILLER                          PIC X(10).
   958******************************************************************
   959*                                 COPY ELCCERT.
   960******************************************************************
   961*                                                                *
   962*                            ELCCERT.                            *
   963*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   964*                            VMOD=2.013                          *
   965*                                                                *
   966*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   967*                                                                *
   968*   FILE TYPE = VSAM,KSDS                                        *
   969*   RECORD SIZE = 450  RECFORM = FIXED                           *
   970*                                                                *
   971*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   972*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   973*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   974*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   975*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   976*                                                                *
   977*   LOG = YES                                                    *
   978*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   979******************************************************************
   980*                   C H A N G E   L O G
   981*
   982* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   983*-----------------------------------------------------------------
   984*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   985* EFFECTIVE    NUMBER
   986*-----------------------------------------------------------------
   987* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   988* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   989* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   990* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   991* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   992* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   993* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   994* 032612  CR2011110200001  PEMA  AHL CHANGES
   995* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   996* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   997******************************************************************
   998
   999 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  19
* SOCK07.cbl
  1000     12  CM-RECORD-ID                      PIC XX.
  1001         88  VALID-CM-ID                      VALUE 'CM'.
  1002
  1003     12  CM-CONTROL-PRIMARY.
  1004         16  CM-COMPANY-CD                 PIC X.
  1005         16  CM-CARRIER                    PIC X.
  1006         16  CM-GROUPING.
  1007             20  CM-GROUPING-PREFIX        PIC X(3).
  1008             20  CM-GROUPING-PRIME         PIC X(3).
  1009         16  CM-STATE                      PIC XX.
  1010         16  CM-ACCOUNT.
  1011             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1012             20  CM-ACCOUNT-PRIME          PIC X(6).
  1013         16  CM-CERT-EFF-DT                PIC XX.
  1014         16  CM-CERT-NO.
  1015             20  CM-CERT-PRIME             PIC X(10).
  1016             20  CM-CERT-SFX               PIC X.
  1017
  1018     12  CM-CONTROL-BY-NAME.
  1019         16  CM-COMPANY-CD-A1              PIC X.
  1020         16  CM-INSURED-LAST-NAME          PIC X(15).
  1021         16  CM-INSURED-INITIALS.
  1022             20  CM-INSURED-INITIAL1       PIC X.
  1023             20  CM-INSURED-INITIAL2       PIC X.
  1024
  1025     12  CM-CONTROL-BY-SSN.
  1026         16  CM-COMPANY-CD-A2              PIC X.
  1027         16  CM-SOC-SEC-NO.
  1028             20  CM-SSN-STATE              PIC XX.
  1029             20  CM-SSN-ACCOUNT            PIC X(6).
  1030             20  CM-SSN-LN3.
  1031                 25  CM-INSURED-INITIALS-A2.
  1032                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1033                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1034                 25 CM-PART-LAST-NAME-A2         PIC X.
  1035
  1036     12  CM-CONTROL-BY-CERT-NO.
  1037         16  CM-COMPANY-CD-A4              PIC X.
  1038         16  CM-CERT-NO-A4                 PIC X(11).
  1039
  1040     12  CM-CONTROL-BY-MEMB.
  1041         16  CM-COMPANY-CD-A5              PIC X.
  1042         16  CM-MEMBER-NO.
  1043             20  CM-MEMB-STATE             PIC XX.
  1044             20  CM-MEMB-ACCOUNT           PIC X(6).
  1045             20  CM-MEMB-LN4.
  1046                 25  CM-INSURED-INITIALS-A5.
  1047                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1048                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1049                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1050
  1051     12  CM-INSURED-PROFILE-DATA.
  1052         16  CM-INSURED-FIRST-NAME.
  1053             20  CM-INSURED-1ST-INIT       PIC X.
  1054             20  FILLER                    PIC X(9).
  1055         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1056         16  CM-INSURED-SEX                PIC X.
  1057             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  20
* SOCK07.cbl
  1058             88  CM-SEX-FEMAL                 VALUE 'F'.
  1059         16  CM-INSURED-JOINT-AGE          PIC 99.
  1060         16  CM-JOINT-INSURED-NAME.
  1061             20  CM-JT-LAST-NAME           PIC X(15).
  1062             20  CM-JT-FIRST-NAME.
  1063                 24  CM-JT-1ST-INIT        PIC X.
  1064                 24  FILLER                PIC X(9).
  1065             20  CM-JT-INITIAL             PIC X.
  1066
  1067     12  CM-LIFE-DATA.
  1068         16  CM-LF-BENEFIT-CD              PIC XX.
  1069         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1070         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1071         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1072         16  CM-LF-DEV-CODE                PIC XXX.
  1073         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1074         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1075         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1076         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1077         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1078         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1079         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1080         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1081         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1082         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1083         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1084         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1085         16  cm-temp-epiq                  pic xx.
  1086             88  EPIQ-CLASS                  value 'EQ'.
  1087*        16  FILLER                        PIC XX.
  1088
  1089     12  CM-AH-DATA.
  1090         16  CM-AH-BENEFIT-CD              PIC XX.
  1091         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1092         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1093         16  CM-AH-DEV-CODE                PIC XXX.
  1094         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1095         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1096         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1097         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1098         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1099         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1100         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1101         16  CM-AH-PAID-THRU-DT            PIC XX.
  1102             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1103         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1104         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1105         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1106         16  FILLER                        PIC X.
  1107
  1108     12  CM-LOAN-INFORMATION.
  1109         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1110         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1111                                           PIC S9(5)V99  COMP-3.
  1112         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1113         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1114         16  CM-PAY-FREQUENCY              PIC S99.
  1115         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  21
* SOCK07.cbl
  1116         16  CM-RATE-CLASS                 PIC XX.
  1117         16  CM-BENEFICIARY                PIC X(25).
  1118         16  CM-POLICY-FORM-NO             PIC X(12).
  1119         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1120         16  CM-LAST-ADD-ON-DT             PIC XX.
  1121         16  CM-DEDUCTIBLE-AMOUNTS.
  1122             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1123             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1124         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1125             20  CM-RESIDENT-STATE         PIC XX.
  1126             20  CM-RATE-CODE              PIC X(4).
  1127             20  FILLER                    PIC XX.
  1128         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1129             20  CM-LOAN-OFFICER           PIC X(5).
  1130             20  FILLER                    PIC XXX.
  1131         16  CM-CSR-CODE                   PIC XXX.
  1132         16  CM-UNDERWRITING-CODE          PIC X.
  1133             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1134         16  CM-POST-CARD-IND              PIC X.
  1135         16  CM-NH-INTERFACE-SW            PIC X.
  1136         16  CM-PREMIUM-TYPE               PIC X.
  1137             88  CM-SING-PRM                  VALUE '1'.
  1138             88  CM-O-B-COVERAGE              VALUE '2'.
  1139             88  CM-OPEN-END                  VALUE '3'.
  1140         16  CM-IND-GRP-TYPE               PIC X.
  1141             88  CM-INDIVIDUAL                VALUE 'I'.
  1142             88  CM-GROUP                     VALUE 'G'.
  1143         16  CM-SKIP-CODE                  PIC X.
  1144             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1145             88  SKIP-JULY                    VALUE '1'.
  1146             88  SKIP-AUGUST                  VALUE '2'.
  1147             88  SKIP-SEPTEMBER               VALUE '3'.
  1148             88  SKIP-JULY-AUG                VALUE '4'.
  1149             88  SKIP-AUG-SEPT                VALUE '5'.
  1150             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1151             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1152             88  SKIP-JUNE                    VALUE '8'.
  1153             88  SKIP-JUNE-JULY               VALUE '9'.
  1154             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1155             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1156         16  CM-PAYMENT-MODE               PIC X.
  1157             88  PAY-MONTHLY                  VALUE SPACE.
  1158             88  PAY-WEEKLY                   VALUE '1'.
  1159             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1160             88  PAY-BI-WEEKLY                VALUE '3'.
  1161             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1162         16  CM-LOAN-NUMBER                PIC X(8).
  1163         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1164         16  CM-OLD-LOF                    PIC XXX.
  1165*        16  CM-LOAN-OFFICER               PIC XXX.
  1166         16  CM-REIN-TABLE                 PIC XXX.
  1167         16  CM-SPECIAL-REIN-CODE          PIC X.
  1168         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1169         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1170         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1171
  1172     12  CM-STATUS-DATA.
  1173         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  22
* SOCK07.cbl
  1174         16  CM-ENTRY-DT                   PIC XX.
  1175
  1176         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1177         16  CM-LF-CANCEL-DT               PIC XX.
  1178         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1179
  1180         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1181         16  CM-LF-DEATH-DT                PIC XX.
  1182         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1183
  1184         16  CM-LF-CURRENT-STATUS          PIC X.
  1185             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1186                                                'M' '4' '5' '9'.
  1187             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1188             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1189             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1190             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1191             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1192             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1193             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1194             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1195             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1196             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1197             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1198             88  CM-LF-DECLINED               VALUE 'D'.
  1199             88  CM-LF-VOIDED                 VALUE 'V'.
  1200
  1201         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1202         16  CM-AH-CANCEL-DT               PIC XX.
  1203         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1204
  1205         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1206         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1207         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1208
  1209         16  CM-AH-CURRENT-STATUS          PIC X.
  1210             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1211                                                'M' '4' '5' '9'.
  1212             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1213             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1214             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1215             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1216             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1217             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1218             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1219             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1220             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1221             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1222             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1223             88  CM-AH-DECLINED               VALUE 'D'.
  1224             88  CM-AH-VOIDED                 VALUE 'V'.
  1225
  1226         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1227             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1228             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1229             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1230         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1231
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  23
* SOCK07.cbl
  1232         16  CM-ENTRY-BATCH                PIC X(6).
  1233         16  CM-LF-EXIT-BATCH              PIC X(6).
  1234         16  CM-AH-EXIT-BATCH              PIC X(6).
  1235         16  CM-LAST-MONTH-END             PIC XX.
  1236
  1237     12  CM-NOTE-SW                        PIC X.
  1238         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1239         88  CERT-NOTES-PRESENT               VALUE '1'.
  1240         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1241         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1242         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1243         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1244         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1245         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1246     12  CM-COMP-EXCP-SW                   PIC X.
  1247         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1248         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1249     12  CM-INSURED-ADDRESS-SW             PIC X.
  1250         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1251         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1252
  1253*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1254     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1255     12  FILLER                            PIC X.
  1256
  1257*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1258     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1259     12  FILLER                            PIC X.
  1260*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1261     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  1262
  1263     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1264         88  CERT-ADDED-BATCH                 VALUE ' '.
  1265         88  CERT-ADDED-ONLINE                VALUE '1'.
  1266         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1267         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1268         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1269     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1270         88  CERT-AS-LOADED                   VALUE ' '.
  1271         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1272         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1273         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1274         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1275         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1276         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1277         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1278
  1279     12  CM-ACCOUNT-COMM-PCTS.
  1280         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1281         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1282
  1283     12  CM-USER-FIELD                     PIC X.
  1284     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1285     12  CM-CLP-STATE                      PIC XX.
  1286     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1287     12  CM-USER-RESERVED                  PIC XXX.
  1288     12  FILLER REDEFINES CM-USER-RESERVED.
  1289         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  24
* SOCK07.cbl
  1290         16  F                             PIC X.
  1291******************************************************************
  1292*                                 COPY ELCCRTT.
  1293******************************************************************
  1294*                                                                *
  1295*                            ELCCRTT.                            *
  1296*                                                                *
  1297*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  1298*                                                                *
  1299*   FILE TYPE = VSAM,KSDS                                        *
  1300*   RECORD SIZE = 552  RECFORM = FIXED                           *
  1301*                                                                *
  1302*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  1303*                                                                *
  1304*   LOG = YES                                                    *
  1305*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1306******************************************************************
  1307*                   C H A N G E   L O G
  1308*
  1309* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1310*-----------------------------------------------------------------
  1311*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1312* EFFECTIVE    NUMBER
  1313*-----------------------------------------------------------------
  1314* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  1315* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  1316* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  1317* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1318* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1319* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1320* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1321* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1322* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1323******************************************************************
  1324
  1325 01  CERTIFICATE-TRAILERS.
  1326     12  CS-RECORD-ID                      PIC XX.
  1327         88  VALID-CS-ID                      VALUE 'CS'.
  1328
  1329     12  CS-CONTROL-PRIMARY.
  1330         16  CS-COMPANY-CD                 PIC X.
  1331         16  CS-CARRIER                    PIC X.
  1332         16  CS-GROUPING                   PIC X(6).
  1333         16  CS-STATE                      PIC XX.
  1334         16  CS-ACCOUNT                    PIC X(10).
  1335         16  CS-CERT-EFF-DT                PIC XX.
  1336         16  CS-CERT-NO.
  1337             20  CS-CERT-PRIME             PIC X(10).
  1338             20  CS-CERT-SFX               PIC X.
  1339         16  CS-TRAILER-TYPE               PIC X.
  1340             88  COMM-TRLR           VALUE 'A'.
  1341             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1342             88  CERT-DATA-TRLR      VALUE 'C'.
  1343
  1344     12  CS-DATA-AREA                      PIC X(516).
  1345
  1346     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1347         16  CS-BANK-COMMISSION-AREA.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  25
* SOCK07.cbl
  1348             20  CS-BANK-COMMS       OCCURS 10.
  1349                 24  CS-AGT                PIC X(10).
  1350                 24  CS-COM-TYP            PIC X.
  1351                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1352                 24  CS-RECALC-LV-INDIC    PIC X.
  1353                 24  FILLER                PIC X(10).
  1354         16  FILLER                        PIC X(256).
  1355
  1356     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1357****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1358         16  CS-MB-CLAIM-DATA OCCURS 24.
  1359             20  CS-CLAIM-NO               PIC X(7).
  1360             20  CS-CLAIM-TYPE             PIC X.
  1361                 88  CS-AH-CLM               VALUE 'A'.
  1362                 88  CS-IU-CLM               VALUE 'I'.
  1363                 88  CS-GP-CLM               VALUE 'G'.
  1364                 88  CS-LF-CLM               VALUE 'L'.
  1365                 88  CS-PR-CLM               VALUE 'P'.
  1366                 88  CS-FL-CLM               VALUE 'F'.
  1367             20  CS-INSURED-TYPE           PIC X.
  1368                 88  CS-PRIM-INSURED          VALUE 'P'.
  1369                 88  CS-CO-BORROWER           VALUE 'C'.
  1370             20  CS-BENEFIT-PERIOD         PIC 99.
  1371             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  1372             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  1373             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1374         16  FILLER                        PIC X(12).
  1375     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1376         16  CS-VIN-NUMBER                 PIC X(17).
  1377         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1378         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1379         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1380         16  cs-agent-name.
  1381             20  cs-agent-fname            pic x(20).
  1382             20  cs-agent-mi               pic x.
  1383             20  cs-agent-lname            pic x(25).
  1384         16  cs-license-no                 pic x(15).
  1385         16  cs-npn-number                 pic x(10).
  1386         16  cs-agent-edit-status          pic x.
  1387             88  cs-ae-refer-to-manager      value 'M'.
  1388             88  cs-ae-cover-sheet           value 'C'.
  1389             88  cs-ae-sig-form              value 'S'.
  1390             88  cs-ae-verified              value 'V'.
  1391             88  cs-unidentified-signature   value 'U'.
  1392             88  cs-cert-returned            value 'R'.
  1393             88  cs-accept-no-commission     value 'N'.
  1394         16  cs-year                       pic 9999.
  1395         16  cs-make                       pic x(20).
  1396         16  cs-model                      pic x(20).
  1397         16  cs-future                     pic x(20).
  1398         16  cs-vehicle-odometer           pic s9(7) comp-3.
  1399         16  FILLER                        PIC X(356). *> was 420
  1400*        16  FILLER                        PIC X(496).
  1401*                                 COPY ELCCNTL.
  1402******************************************************************
  1403*                                                                *
  1404*                                                                *
  1405*                            ELCCNTL.                            *
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  26
* SOCK07.cbl
  1406*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1407*                            VMOD=2.059                          *
  1408*                                                                *
  1409*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1410*                                                                *
  1411*   FILE TYPE = VSAM,KSDS                                        *
  1412*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1413*                                                                *
  1414*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1415*       ALTERNATE INDEX = NONE                                   *
  1416*                                                                *
  1417*   LOG = YES                                                    *
  1418*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1419******************************************************************
  1420*                   C H A N G E   L O G
  1421*
  1422* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1423*-----------------------------------------------------------------
  1424*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1425* EFFECTIVE    NUMBER
  1426*-----------------------------------------------------------------
  1427* 082503                   PEMA  ADD BENEFIT GROUP
  1428* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1429* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1430* 092705    2005050300006  PEMA  ADD SPP LEASES
  1431* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1432* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1433* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1434* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1435* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1436* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1437* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1438* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1439* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1440* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1441******************************************************************
  1442*
  1443 01  CONTROL-FILE.
  1444     12  CF-RECORD-ID                       PIC XX.
  1445         88  VALID-CF-ID                        VALUE 'CF'.
  1446
  1447     12  CF-CONTROL-PRIMARY.
  1448         16  CF-COMPANY-ID                  PIC XXX.
  1449         16  CF-RECORD-TYPE                 PIC X.
  1450             88  CF-COMPANY-MASTER              VALUE '1'.
  1451             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1452             88  CF-STATE-MASTER                VALUE '3'.
  1453             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1454             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1455             88  CF-CARRIER-MASTER              VALUE '6'.
  1456             88  CF-MORTALITY-MASTER            VALUE '7'.
  1457             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1458             88  CF-TERMINAL-MASTER             VALUE '9'.
  1459             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1460             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1461             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1462             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1463             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  27
* SOCK07.cbl
  1464             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1465             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1466             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1467             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1468         16  CF-ACCESS-CD-GENL              PIC X(4).
  1469         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1470             20  CF-PROCESSOR               PIC X(4).
  1471         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1472             20  CF-STATE-CODE              PIC XX.
  1473             20  FILLER                     PIC XX.
  1474         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1475             20  FILLER                     PIC XX.
  1476             20  CF-HI-BEN-IN-REC           PIC XX.
  1477         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1478             20  FILLER                     PIC XXX.
  1479             20  CF-CARRIER-CNTL            PIC X.
  1480         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1481             20  FILLER                     PIC XX.
  1482             20  CF-HI-TYPE-IN-REC          PIC 99.
  1483         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1484             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1485                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1486             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1487             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1488         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1489             20  FILLER                     PIC X.
  1490             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1491         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1492             20  FILLER                     PIC XX.
  1493             20  CF-MORTGAGE-PLAN           PIC XX.
  1494         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1495
  1496     12  CF-LAST-MAINT-DT                   PIC XX.
  1497     12  CF-LAST-MAINT-BY                   PIC X(4).
  1498     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1499
  1500     12  CF-RECORD-BODY                     PIC X(728).
  1501
  1502
  1503****************************************************************
  1504*             COMPANY MASTER RECORD                            *
  1505****************************************************************
  1506
  1507     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1508         16  CF-COMPANY-ADDRESS.
  1509             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1510             20  CF-CL-IN-CARE-OF           PIC X(30).
  1511             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1512             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1513             20  CF-CL-CITY-STATE           PIC X(30).
  1514             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1515             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1516         16  CF-COMPANY-CD                  PIC X.
  1517         16  CF-COMPANY-PASSWORD            PIC X(8).
  1518         16  CF-SECURITY-OPTION             PIC X.
  1519             88  ALL-SECURITY                   VALUE '1'.
  1520             88  COMPANY-VERIFY                 VALUE '2'.
  1521             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  28
* SOCK07.cbl
  1522             88  NO-SECURITY                    VALUE '4'.
  1523             88  ALL-BUT-TERM                   VALUE '5'.
  1524         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1525             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1526         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1527             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1528         16  CF-INFORCE-LOCATION            PIC X.
  1529             88  CERTS-ARE-ONLINE               VALUE '1'.
  1530             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1531             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1532         16  CF-LOWER-CASE-LETTERS          PIC X.
  1533         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1534             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1535             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1536             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1537             88  CF-ACCNT-CNTL                  VALUE '3'.
  1538             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1539
  1540         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1541         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1542
  1543         16  CF-LGX-CREDIT-USER             PIC X.
  1544             88  CO-IS-NOT-USER                 VALUE 'N'.
  1545             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1546
  1547         16 CF-CREDIT-CALC-CODES.
  1548             20  CF-CR-REM-TERM-CALC PIC X.
  1549               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1550               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1551               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1552               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1553               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1554               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1555               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1556             20  CF-CR-R78-METHOD           PIC X.
  1557               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1558               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1559
  1560         16  CF-CLAIM-CONTROL-COUNTS.
  1561             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1562                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1563
  1564             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1565                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1566
  1567             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1568                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1569
  1570             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1571                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1572
  1573         16  CF-CURRENT-MONTH-END           PIC XX.
  1574
  1575         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1576             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1577             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1578             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1579             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  29
* SOCK07.cbl
  1580                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1581                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1582             20  CF-CO-PREM-REJECT-SW       PIC X.
  1583                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1584                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1585             20  CF-CO-REF-REJECT-SW        PIC X.
  1586                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1587                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1588
  1589         16  CF-CO-REPORTING-DT             PIC XX.
  1590         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1591         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1592           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1593           88  CF-CO-MONTH-END                  VALUE '1'.
  1594
  1595         16  CF-LGX-CLAIM-USER              PIC X.
  1596             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1597             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1598
  1599         16  CF-CREDIT-EDIT-CONTROLS.
  1600             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1601             20  CF-MIN-AGE                 PIC 99.
  1602             20  CF-DEFAULT-AGE             PIC 99.
  1603             20  CF-MIN-TERM                PIC S999      COMP-3.
  1604             20  CF-MAX-TERM                PIC S999      COMP-3.
  1605             20  CF-DEFAULT-SEX             PIC X.
  1606             20  CF-JOINT-AGE-INPUT         PIC X.
  1607                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1608             20  CF-BIRTH-DATE-INPUT        PIC X.
  1609                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1610             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1611                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1612                 88  CF-ZERO-CARRIER            VALUE '1'.
  1613                 88  CF-ZERO-GROUPING           VALUE '2'.
  1614                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1615             20  CF-EDIT-SW                 PIC X.
  1616                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1617             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1618             20  CF-CR-PR-METHOD            PIC X.
  1619               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1620               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1621             20  FILLER                     PIC X.
  1622
  1623         16  CF-CREDIT-MISC-CONTROLS.
  1624             20  CF-REIN-TABLE-SW           PIC X.
  1625                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1626             20  CF-COMP-TABLE-SW           PIC X.
  1627                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1628             20  CF-EXPERIENCE-RETENTION-AGE
  1629                                            PIC S9        COMP-3.
  1630             20  CF-CONVERSION-DT           PIC XX.
  1631             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1632             20  CF-RUN-FREQUENCY-SW        PIC X.
  1633                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1634                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1635
  1636             20  CF-CR-CHECK-NO-CONTROL.
  1637                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  30
* SOCK07.cbl
  1638                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1639                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1640                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1641                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1642                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1643
  1644                 24  CF-CR-CHECK-COUNT       REDEFINES
  1645                     CF-CR-CHECK-COUNTER      PIC X(4).
  1646
  1647                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1648                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1649
  1650                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1651                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1652                 24  CF-MAIL-PROCESSING       PIC X.
  1653                     88  MAIL-PROCESSING          VALUE 'Y'.
  1654
  1655         16  CF-MISC-SYSTEM-CONTROL.
  1656             20  CF-SYSTEM-C                 PIC X.
  1657                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1658             20  CF-SYSTEM-D                 PIC X.
  1659                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1660             20  CF-SOC-SEC-NO-SW            PIC X.
  1661                 88  SOC-SEC-NO-USED             VALUE '1'.
  1662             20  CF-MEMBER-NO-SW             PIC X.
  1663                 88  MEMBER-NO-USED              VALUE '1'.
  1664             20  CF-TAX-ID-NUMBER            PIC X(11).
  1665             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1666             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1667                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1668                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1669                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1670                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1671             20  CF-SYSTEM-E                 PIC X.
  1672                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1673
  1674         16  CF-LGX-LIFE-USER               PIC X.
  1675             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1676             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1677
  1678         16  CF-CR-MONTH-END-DT             PIC XX.
  1679
  1680         16  CF-FILE-MAINT-DATES.
  1681             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1682                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1683             20  CF-LAST-BATCH       REDEFINES
  1684                 CF-LAST-BATCH-NO               PIC X(4).
  1685             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1686             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1687             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1688             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1689             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1690             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1691             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1692             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1693             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1694             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1695
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  31
* SOCK07.cbl
  1696         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1697         16  FILLER                         PIC X.
  1698
  1699         16  CF-ALT-MORT-CODE               PIC X(4).
  1700         16  CF-MEMBER-CAPTION              PIC X(10).
  1701
  1702         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1703             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1704             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1705             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1706             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1707             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1708
  1709         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1710
  1711         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1712         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1713         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1714         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1715
  1716         16  CF-AH-OVERRIDE-L1              PIC X.
  1717         16  CF-AH-OVERRIDE-L2              PIC XX.
  1718         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1719         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1720
  1721         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1722         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1723
  1724         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1725         16  CF-AR-LAST-EL860-DT            PIC XX.
  1726         16  CF-MP-MONTH-END-DT             PIC XX.
  1727
  1728         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1729         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1730             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1731
  1732         16  CF-AR-MONTH-END-DT             PIC XX.
  1733
  1734         16  CF-CRDTCRD-USER                PIC X.
  1735             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1736             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1737
  1738         16  CF-CC-MONTH-END-DT             PIC XX.
  1739
  1740         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1741
  1742         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1743             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1744             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1745             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1746         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1747         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1748         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1749         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1750             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1751             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1752         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1753         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  32
* SOCK07.cbl
  1754         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1755             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1756         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1757
  1758         16  CF-CL-ZIP-CODE.
  1759             20  CF-CL-ZIP-PRIME.
  1760                 24  CF-CL-ZIP-1ST          PIC X.
  1761                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1762                 24  FILLER                 PIC X(4).
  1763             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1764         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1765             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1766             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1767             20  FILLER                     PIC XXX.
  1768
  1769         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1770         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1771         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1772         16  CF-CO-OPTION-START-DATE        PIC XX.
  1773         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1774           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1775                                                      '3' '4'.
  1776           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1777           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1778           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1779           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1780           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1781           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1782
  1783         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1784
  1785         16  CF-PAYMENT-APPROVAL-LEVELS.
  1786             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1787             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1788             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1789             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1790             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1791             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1792
  1793         16  CF-END-USER-REPORTING-USER     PIC X.
  1794             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1795             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1796
  1797         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1798             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1799             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1800
  1801         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1802
  1803         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1804         16  FILLER                         PIC X.
  1805
  1806         16  CF-CREDIT-ARCHIVE-CNTL.
  1807             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1808             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1809             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1810
  1811         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  33
* SOCK07.cbl
  1812
  1813         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1814             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1815             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1816
  1817         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1818             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1819             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1820
  1821         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1822
  1823         16  CF-CO-ACH-ID-CODE              PIC  X.
  1824             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1825             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1826             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1827         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1828         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1829         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1830         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1831         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1832         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1833         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1834         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1835         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1836                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1837         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1838                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1839
  1840         16  CF-CO-OVER-SHORT.
  1841             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1842             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1843
  1844*         16  FILLER                         PIC X(102).
  1845         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1846             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1847             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1848
  1849         16  CF-AH-APPROVAL-DAYS.
  1850             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1851             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1852             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1853             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1854
  1855         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1856
  1857         16  CF-APPROV-LEV-5.
  1858             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1859             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1860             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1861
  1862         16  FILLER                         PIC X(68).
  1863****************************************************************
  1864*             PROCESSOR/USER RECORD                            *
  1865****************************************************************
  1866
  1867     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1868         16  CF-PROCESSOR-NAME              PIC X(30).
  1869         16  CF-PROCESSOR-PASSWORD          PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  34
* SOCK07.cbl
  1870         16  CF-PROCESSOR-TITLE             PIC X(26).
  1871         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1872                 88  MESSAGE-YES                VALUE 'Y'.
  1873                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1874
  1875*****************************************************
  1876****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1877****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1878****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1879****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1880*****************************************************
  1881
  1882         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1883             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1884             20  CF-APPLICATION-FORCE       PIC X.
  1885             20  CF-INDIVIDUAL-APP.
  1886                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1887                     28  CF-BROWSE-APP      PIC X.
  1888                     28  CF-UPDATE-APP      PIC X.
  1889
  1890         16  CF-CURRENT-TERM-ON             PIC X(4).
  1891         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1892             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1893             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1894             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1895             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1896             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1897             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1898             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1899         16  CF-PROCESSOR-CARRIER           PIC X.
  1900             88  NO-CARRIER-SECURITY            VALUE ' '.
  1901         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1902             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1903         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1904             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1905         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1906             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1907
  1908         16  CF-PROC-SYS-ACCESS-SW.
  1909             20  CF-PROC-CREDIT-CLAIMS-SW.
  1910                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1911                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1912                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1913                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1914             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1915                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1916                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1917             20  CF-PROC-LIFE-GNRLDGR-SW.
  1918                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1919                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1920                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1921                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1922             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1923                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1924                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1925         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1926             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1927             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  35
* SOCK07.cbl
  1928         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1929
  1930         16  CF-APPROVAL-LEVEL                  PIC X.
  1931             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1932             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1933             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1934             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1935             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1936
  1937         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1938
  1939         16  CF-LANGUAGE-TYPE                   PIC X.
  1940             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1941             88  CF-LANG-IS-FR                      VALUE 'F'.
  1942
  1943         16  CF-CSR-IND                         PIC X.
  1944         16  FILLER                             PIC X(239).
  1945
  1946****************************************************************
  1947*             PROCESSOR/REMINDERS RECORD                       *
  1948****************************************************************
  1949
  1950     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1951         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1952             20  CF-START-REMIND-DT         PIC XX.
  1953             20  CF-END-REMIND-DT           PIC XX.
  1954             20  CF-REMINDER-TEXT           PIC X(50).
  1955         16  FILLER                         PIC X(296).
  1956
  1957
  1958****************************************************************
  1959*             STATE MASTER RECORD                              *
  1960****************************************************************
  1961
  1962     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1963         16  CF-STATE-ABBREVIATION          PIC XX.
  1964         16  CF-STATE-NAME                  PIC X(25).
  1965         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1966         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1967             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1968             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1969             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1970             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1971                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1972                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1973             20  CF-ST-PREM-REJECT-SW       PIC X.
  1974                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1975                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1976             20  CF-ST-REF-REJECT-SW        PIC X.
  1977                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1978                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1979         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1980         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1981         16  CF-ST-REFUND-RULES.
  1982             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1983             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1984             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1985         16  CF-ST-FST-PMT-EXTENSION.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  36
* SOCK07.cbl
  1986             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1987             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1988                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1989                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1990                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1991                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1992         16  CF-ST-STATE-CALL.
  1993             20  CF-ST-CALL-UNEARNED        PIC X.
  1994             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1995             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1996         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1997             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1998             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1999         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2000         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2001         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2002         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2003         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2004         16  FILLER                         PIC X.
  2005         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2006             20  CF-ST-BENEFIT-CD           PIC XX.
  2007             20  CF-ST-BENEFIT-KIND         PIC X.
  2008                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2009                 88  CF-ST-AH-KIND              VALUE 'A'.
  2010             20  CF-ST-REM-TERM-CALC        PIC X.
  2011                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2012                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2013                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2014                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2015                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2016                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2017                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2018                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2019
  2020             20  CF-ST-REFUND-CALC          PIC X.
  2021                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2022                 88  ST-REFD-BY-R78             VALUE '1'.
  2023                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2024                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2025                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2026                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2027                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2028                 88  ST-REFD-UTAH               VALUE '7'.
  2029                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2030                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2031                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2032
  2033             20  CF-ST-EARNING-CALC         PIC X.
  2034                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2035                 88  ST-EARN-BY-R78             VALUE '1'.
  2036                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2037                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2038                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2039                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2040                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2041                 88  ST-EARN-MEAN               VALUE '8'.
  2042                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2043
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  37
* SOCK07.cbl
  2044             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2045                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2046                 88  ST-OVRD-BY-R78             VALUE '1'.
  2047                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2048                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2049                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2050                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2051                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2052                 88  ST-OVRD-MEAN               VALUE '8'.
  2053                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2054             20  cf-st-extra-periods        pic 9.
  2055*            20  FILLER                     PIC X.
  2056
  2057         16  CF-ST-COMMISSION-CAPS.
  2058             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2059             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2060             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2061             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2062         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2063                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2064
  2065         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2066
  2067         16  CF-ST-STATUTORY-INTEREST.
  2068             20  CF-ST-STAT-DATE-FROM       PIC X.
  2069                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2070                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2071             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2072             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2073             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2074             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2075             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2076
  2077         16  CF-ST-OVER-SHORT.
  2078             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2079             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2080
  2081         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2082
  2083         16  CF-ST-RT-CALC                  PIC X.
  2084
  2085         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2086         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2087         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2088         16  CF-ST-RF-LR-CALC               PIC X.
  2089         16  CF-ST-RF-LL-CALC               PIC X.
  2090         16  CF-ST-RF-LN-CALC               PIC X.
  2091         16  CF-ST-RF-AH-CALC               PIC X.
  2092         16  CF-ST-RF-CP-CALC               PIC X.
  2093*        16  FILLER                         PIC X(206).
  2094*CIDMOD         16  FILLER                         PIC X(192).
  2095         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2096             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2097         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2098         16  CF-ST-VFY-2ND-BENE             PIC X.
  2099         16  CF-ST-CAUSAL-STATE             PIC X.
  2100         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2101         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  38
* SOCK07.cbl
  2102         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2103             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2104         16  CF-ST-NET-ONLY-STATE           PIC X.
  2105             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2106         16  FILLER                         PIC X(181).
  2107
  2108****************************************************************
  2109*             BENEFIT MASTER RECORD                            *
  2110****************************************************************
  2111
  2112     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2113         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2114             20  CF-BENEFIT-CODE            PIC XX.
  2115             20  CF-BENEFIT-NUMERIC  REDEFINES
  2116                 CF-BENEFIT-CODE            PIC XX.
  2117             20  CF-BENEFIT-ALPHA           PIC XXX.
  2118             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2119             20  CF-BENEFIT-COMMENT         PIC X(10).
  2120
  2121             20  CF-LF-COVERAGE-TYPE        PIC X.
  2122                 88  CF-REDUCING                VALUE 'R'.
  2123                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2124
  2125             20  CF-SPECIAL-CALC-CD         PIC X.
  2126                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2127                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2128                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2129                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2130                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2131                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2132                 88  CF-FARM-PLAN               VALUE 'F'.
  2133                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2134                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2135                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2136                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2137                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2138                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2139                 88  CF-PRUDENTIAL              VALUE 'P'.
  2140                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2141                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2142                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2143                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2144                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2145                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2146
  2147             20  CF-JOINT-INDICATOR         PIC X.
  2148                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2149
  2150*            20  FILLER                     PIC X(12).
  2151             20  cf-maximum-benefits        pic s999 comp-3.
  2152             20  FILLER                     PIC X(09).
  2153             20  CF-BENEFIT-CATEGORY        PIC X.
  2154             20  CF-LOAN-TYPE               PIC X(8).
  2155
  2156             20  CF-CO-REM-TERM-CALC        PIC X.
  2157                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2158                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2159                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  39
* SOCK07.cbl
  2160                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2161                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2162
  2163             20  CF-CO-EARNINGS-CALC        PIC X.
  2164                 88  CO-EARN-BY-R78             VALUE '1'.
  2165                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2166                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2167                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2168                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2169                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2170                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2171                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2172
  2173             20  CF-CO-REFUND-CALC          PIC X.
  2174                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2175                 88  CO-REFD-BY-R78             VALUE '1'.
  2176                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2177                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2178                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2179                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2180                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2181                 88  CO-REFD-MEAN               VALUE '8'.
  2182                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2183                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2184                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2185
  2186             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2187                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2188                 88  CO-OVRD-BY-R78             VALUE '1'.
  2189                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2190                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2191                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2192                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2193                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2194                 88  CO-OVRD-MEAN               VALUE '8'.
  2195                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2196
  2197             20  CF-CO-BEN-I-G-CD           PIC X.
  2198                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2199                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2200                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2201
  2202         16  FILLER                         PIC X(304).
  2203
  2204
  2205****************************************************************
  2206*             CARRIER MASTER RECORD                            *
  2207****************************************************************
  2208
  2209     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2210         16  CF-ADDRESS-DATA.
  2211             20  CF-MAIL-TO-NAME            PIC X(30).
  2212             20  CF-IN-CARE-OF              PIC X(30).
  2213             20  CF-ADDRESS-LINE-1          PIC X(30).
  2214             20  CF-ADDRESS-LINE-2          PIC X(30).
  2215             20  CF-CITY-STATE              PIC X(30).
  2216             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2217             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  40
* SOCK07.cbl
  2218
  2219         16  CF-CLAIM-NO-CONTROL.
  2220             20  CF-CLAIM-NO-METHOD         PIC X.
  2221                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2222                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2223                 88  CLAIM-NO-SEQ               VALUE '3'.
  2224                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2225             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2226                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2227                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2228                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2229
  2230         16  CF-CHECK-NO-CONTROL.
  2231             20  CF-CHECK-NO-METHOD         PIC X.
  2232                 88  CHECK-NO-MANUAL            VALUE '1'.
  2233                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2234                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2235                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2236             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2237                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2238
  2239         16  CF-DOMICILE-STATE              PIC XX.
  2240
  2241         16  CF-EXPENSE-CONTROLS.
  2242             20  CF-EXPENSE-METHOD          PIC X.
  2243                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2244                 88  DOLLARS-PER-PMT            VALUE '2'.
  2245                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2246                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2247             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2248             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2249
  2250         16  CF-CORRESPONDENCE-CONTROL.
  2251             20  CF-LETTER-RESEND-OPT       PIC X.
  2252                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2253                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2254             20  FILLER                     PIC X(4).
  2255
  2256         16  CF-RESERVE-CONTROLS.
  2257             20  CF-MANUAL-SW               PIC X.
  2258                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2259             20  CF-FUTURE-SW               PIC X.
  2260                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2261             20  CF-PTC-SW                  PIC X.
  2262                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2263             20  CF-IBNR-SW                 PIC X.
  2264                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2265             20  CF-PTC-LF-SW               PIC X.
  2266                 88  CF-LF-PTC-USED             VALUE '1'.
  2267             20  CF-CDT-ACCESS-METHOD       PIC X.
  2268                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2269                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2270                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2271             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2272
  2273         16  CF-CLAIM-CALC-METHOD           PIC X.
  2274             88  360-PLUS-MONTHS                VALUE '1'.
  2275             88  365-PLUS-MONTHS                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  41
* SOCK07.cbl
  2276             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2277             88  360-DAILY                      VALUE '4'.
  2278             88  365-DAILY                      VALUE '5'.
  2279
  2280         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2281         16  FILLER                         PIC X(11).
  2282
  2283         16  CF-LIMIT-AMOUNTS.
  2284             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2285             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2286             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2287             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2288             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2289             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2290             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2291             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2292             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2293             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2294
  2295         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2296         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2297         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2298
  2299         16  CF-ZIP-CODE.
  2300             20  CF-ZIP-PRIME.
  2301                 24  CF-ZIP-1ST             PIC X.
  2302                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2303                 24  FILLER                 PIC X(4).
  2304             20  CF-ZIP-PLUS4               PIC X(4).
  2305         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2306             20  CF-CAN-POSTAL-1            PIC XXX.
  2307             20  CF-CAN-POSTAL-2            PIC XXX.
  2308             20  FILLER                     PIC XXX.
  2309
  2310         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2311         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2312         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2313
  2314         16  CF-RATING-SWITCH               PIC X.
  2315             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2316             88  CF-NO-RATING                   VALUE 'N'.
  2317
  2318         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2319
  2320         16  CF-CARRIER-OVER-SHORT.
  2321             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2322             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2323
  2324         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2325         16  CF-SECPAY-SWITCH               PIC X.
  2326             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2327             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2328         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2329         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2330         16  FILLER                         PIC X(444).
  2331*        16  FILLER                         PIC X(452).
  2332
  2333
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  42
* SOCK07.cbl
  2334****************************************************************
  2335*             MORTALITY MASTER RECORD                          *
  2336****************************************************************
  2337
  2338     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2339         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2340                                INDEXED BY CF-MORT-NDX.
  2341             20  CF-MORT-TABLE              PIC X(5).
  2342             20  CF-MORT-TABLE-TYPE         PIC X.
  2343                 88  CF-MORT-JOINT              VALUE 'J'.
  2344                 88  CF-MORT-SINGLE             VALUE 'S'.
  2345                 88  CF-MORT-COMBINED           VALUE 'C'.
  2346                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2347                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2348             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2349             20  CF-MORT-AGE-METHOD         PIC XX.
  2350                 88  CF-AGE-LAST                VALUE 'AL'.
  2351                 88  CF-AGE-NEAR                VALUE 'AN'.
  2352             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2353             20  CF-MORT-ADJUSTMENT-DIRECTION
  2354                                            PIC X.
  2355                 88  CF-MINUS                   VALUE '-'.
  2356                 88  CF-PLUS                    VALUE '+'.
  2357             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2358             20  CF-MORT-JOINT-CODE         PIC X.
  2359                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2360             20  CF-MORT-PC-Q               PIC X.
  2361                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2362             20  CF-MORT-TABLE-CODE         PIC X(4).
  2363             20  CF-MORT-COMMENTS           PIC X(15).
  2364             20  FILLER                     PIC X(14).
  2365
  2366         16  FILLER                         PIC X(251).
  2367
  2368
  2369****************************************************************
  2370*             BUSSINESS TYPE MASTER RECORD                     *
  2371****************************************************************
  2372
  2373     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2374* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2375* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2376* AND RECORD 05 IS TYPES 81-99
  2377         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2378             20  CF-BUSINESS-TITLE          PIC  X(19).
  2379             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2380                                            PIC S9V9(4) COMP-3.
  2381             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2382             20  FILLER                     PIC  X.
  2383         16  FILLER                         PIC  X(248).
  2384
  2385
  2386****************************************************************
  2387*             TERMINAL MASTER RECORD                           *
  2388****************************************************************
  2389
  2390     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2391
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  43
* SOCK07.cbl
  2392         16  CF-COMPANY-TERMINALS.
  2393             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2394                                  PIC X(4).
  2395         16  FILLER               PIC X(248).
  2396
  2397
  2398****************************************************************
  2399*             LIFE EDIT MASTER RECORD                          *
  2400****************************************************************
  2401
  2402     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2403         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2404             20  CF-LIFE-CODE-IN            PIC XX.
  2405             20  CF-LIFE-CODE-OUT           PIC XX.
  2406         16  FILLER                         PIC X(248).
  2407
  2408
  2409****************************************************************
  2410*             AH EDIT MASTER RECORD                            *
  2411****************************************************************
  2412
  2413     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2414         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2415             20  CF-AH-CODE-IN              PIC XXX.
  2416             20  CF-AH-CODE-OUT             PIC XX.
  2417         16  FILLER                         PIC X(248).
  2418
  2419
  2420****************************************************************
  2421*             CREDIBILITY TABLES                               *
  2422****************************************************************
  2423
  2424     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2425         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2426                             INDEXED BY CF-CRDB-NDX.
  2427             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2428             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2429             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2430         16  FILLER                         PIC  X(332).
  2431
  2432
  2433****************************************************************
  2434*             REPORT CUSTOMIZATION RECORD                      *
  2435****************************************************************
  2436
  2437     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2438         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2439             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2440             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2441             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2442**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2443****       A T-TRANSFER.                                   ****
  2444             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2445
  2446         16  FILLER                         PIC XX.
  2447
  2448         16  CF-CARRIER-CNTL-OPT.
  2449             20  CF-CARRIER-OPT-SEQ         PIC 9.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  44
* SOCK07.cbl
  2450                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2451                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2452             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2453                                            PIC X.
  2454         16  CF-GROUP-CNTL-OPT.
  2455             20  CF-GROUP-OPT-SEQ           PIC 9.
  2456                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2457                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2458             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2459                                            PIC X(6).
  2460         16  CF-STATE-CNTL-OPT.
  2461             20  CF-STATE-OPT-SEQ           PIC 9.
  2462                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2463                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2464             20  CF-STATE-SELECT OCCURS 3 TIMES
  2465                                            PIC XX.
  2466         16  CF-ACCOUNT-CNTL-OPT.
  2467             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2468                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2469                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2470             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2471                                            PIC X(10).
  2472         16  CF-BUS-TYP-CNTL-OPT.
  2473             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2474                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2475                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2476             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2477                                            PIC XX.
  2478         16  CF-LF-TYP-CNTL-OPT.
  2479             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2480                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2481                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2482             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2483                                            PIC XX.
  2484         16  CF-AH-TYP-CNTL-OPT.
  2485             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2486                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2487                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2488             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2489                                            PIC XX.
  2490         16  CF-REPTCD1-CNTL-OPT.
  2491             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2492                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2493                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2494             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2495                                            PIC X(10).
  2496         16  CF-REPTCD2-CNTL-OPT.
  2497             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2498                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2499                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2500             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2501                                            PIC X(10).
  2502         16  CF-USER1-CNTL-OPT.
  2503             20  CF-USER1-OPT-SEQ           PIC 9.
  2504                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2505                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2506             20  CF-USER1-SELECT OCCURS 3 TIMES
  2507                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  45
* SOCK07.cbl
  2508         16  CF-USER2-CNTL-OPT.
  2509             20  CF-USER2-OPT-SEQ           PIC 9.
  2510                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2511                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2512             20  CF-USER2-SELECT OCCURS 3 TIMES
  2513                                            PIC X(10).
  2514         16  CF-USER3-CNTL-OPT.
  2515             20  CF-USER3-OPT-SEQ           PIC 9.
  2516                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2517                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2518             20  CF-USER3-SELECT OCCURS 3 TIMES
  2519                                            PIC X(10).
  2520         16  CF-USER4-CNTL-OPT.
  2521             20  CF-USER4-OPT-SEQ           PIC 9.
  2522                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2523                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2524             20  CF-USER4-SELECT OCCURS 3 TIMES
  2525                                            PIC X(10).
  2526         16  CF-USER5-CNTL-OPT.
  2527             20  CF-USER5-OPT-SEQ           PIC 9.
  2528                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2529                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2530             20  CF-USER5-SELECT OCCURS 3 TIMES
  2531                                            PIC X(10).
  2532         16  CF-REINS-CNTL-OPT.
  2533             20  CF-REINS-OPT-SEQ           PIC 9.
  2534                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2535                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2536             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2537                 24  CF-REINS-PRIME         PIC XXX.
  2538                 24  CF-REINS-SUB           PIC XXX.
  2539
  2540         16  CF-AGENT-CNTL-OPT.
  2541             20  CF-AGENT-OPT-SEQ           PIC 9.
  2542                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2543                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2544             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2545                                            PIC X(10).
  2546
  2547         16  FILLER                         PIC X(43).
  2548
  2549         16  CF-LOSS-RATIO-SELECT.
  2550             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2551             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2552         16  CF-ENTRY-DATE-SELECT.
  2553             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2554             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2555         16  CF-EFFECTIVE-DATE-SELECT.
  2556             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2557             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2558
  2559         16  CF-EXCEPTION-LIST-IND          PIC X.
  2560             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2561
  2562         16  FILLER                         PIC X(318).
  2563
  2564****************************************************************
  2565*                  EXCEPTION REPORTING RECORD                  *
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  46
* SOCK07.cbl
  2566****************************************************************
  2567
  2568     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2569         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2570             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2571
  2572         16  CF-COMBINED-LIFE-AH-OPT.
  2573             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2574             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2575             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2576             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2577
  2578         16  CF-LIFE-OPT.
  2579             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2580             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2581             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2582             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2583             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2584             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2585             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2586             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2587             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2588             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2589
  2590         16  CF-AH-OPT.
  2591             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2592             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2593             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2594             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2595             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2596             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2597             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2598             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2599             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2600             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2601
  2602         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2603             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2604             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2605             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2606
  2607         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2608
  2609         16  FILLER                         PIC X(673).
  2610
  2611
  2612****************************************************************
  2613*             MORTGAGE SYSTEM PLAN RECORD                      *
  2614****************************************************************
  2615
  2616     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2617         16  CF-PLAN-TYPE                   PIC X.
  2618             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2619             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2620             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2621         16  CF-PLAN-ABBREV                 PIC XXX.
  2622         16  CF-PLAN-DESCRIPT               PIC X(10).
  2623         16  CF-PLAN-NOTES                  PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  47
* SOCK07.cbl
  2624         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2625         16  CF-PLAN-UNDERWRITING.
  2626             20  CF-PLAN-TERM-DATA.
  2627                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2628                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2629             20  CF-PLAN-AGE-DATA.
  2630                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2631                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2632                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2633             20  CF-PLAN-BENEFIT-DATA.
  2634                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2635                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2636                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2637                                            PIC S9(7)V99  COMP-3.
  2638         16  CF-PLAN-POLICY-FORMS.
  2639             20  CF-POLICY-FORM             PIC X(12).
  2640             20  CF-MASTER-APPLICATION      PIC X(12).
  2641             20  CF-MASTER-POLICY           PIC X(12).
  2642         16  CF-PLAN-RATING.
  2643             20  CF-RATE-CODE               PIC X(5).
  2644             20  CF-SEX-RATING              PIC X.
  2645                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2646                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2647             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2648             20  CF-SUB-STD-TYPE            PIC X.
  2649                 88  CF-PCT-OF-PREM            VALUE '1'.
  2650                 88  CF-PCT-OF-BENE            VALUE '2'.
  2651         16  CF-PLAN-PREM-TOLERANCES.
  2652             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2653             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2654         16  CF-PLAN-PYMT-TOLERANCES.
  2655             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2656             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2657         16  CF-PLAN-MISC-DATA.
  2658             20  FILLER                     PIC X.
  2659             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2660             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2661         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2662         16  CF-PLAN-IND-GRP                PIC X.
  2663             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2664                                                     '1'.
  2665             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2666                                                     '2'.
  2667         16  CF-MIB-SEARCH-SW               PIC X.
  2668             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2669             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2670             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2671             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2672         16  CF-ALPHA-SEARCH-SW             PIC X.
  2673             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2674             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2675             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2676             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2677             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2678             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2679             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2680             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2681             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  48
* SOCK07.cbl
  2682             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2683                                                     'A' 'B' 'C'
  2684                                                     'X' 'Y' 'Z'.
  2685         16  CF-EFF-DT-RULE-SW              PIC X.
  2686             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2687             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2688             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2689             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2690             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2691         16  FILLER                         PIC X(4).
  2692         16  CF-HEALTH-QUESTIONS            PIC X.
  2693             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2694         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2695         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2696         16  CF-PLAN-SNGL-JNT               PIC X.
  2697             88  CF-COMBINED-PLAN              VALUE 'C'.
  2698             88  CF-JNT-PLAN                   VALUE 'J'.
  2699             88  CF-SNGL-PLAN                  VALUE 'S'.
  2700         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2701         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2702         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2703         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2704         16  CF-RERATE-CNTL                 PIC  X.
  2705             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2706             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2707             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2708             88  CF-AUTO-RECALC                 VALUE '4'.
  2709         16  CF-BENEFIT-TYPE                PIC  X.
  2710             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2711             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2712         16  CF-POLICY-FEE                  PIC S999V99
  2713                                                    COMP-3.
  2714         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2715         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2716         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2717         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2718         16  FILLER                         PIC  X(32).
  2719         16  CF-TERMINATION-FORM            PIC  X(04).
  2720         16  FILLER                         PIC  X(08).
  2721         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2722                                                       COMP-3.
  2723         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2724         16  CF-ISSUE-LETTER                PIC  X(4).
  2725         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2726         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2727             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2728             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2729         16  CF-MP-REFUND-CALC              PIC X.
  2730             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2731             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2732             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2733             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2734             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2735             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2736             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2737             88  CF-MP-REFD-MEAN                VALUE '8'.
  2738         16  CF-ALT-RATE-CODE               PIC  X(5).
  2739
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  49
* SOCK07.cbl
  2740
  2741         16  FILLER                         PIC X(498).
  2742****************************************************************
  2743*             MORTGAGE COMPANY MASTER RECORD                   *
  2744****************************************************************
  2745
  2746     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2747         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2748         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2749             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2750             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2751             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2752             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2753             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2754
  2755         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2756         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2757         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2758         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2759         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2760
  2761         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2762             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2763         16  CF-MP-RECON-USE-IND            PIC X(1).
  2764             88  CF-MP-USE-RECON             VALUE 'Y'.
  2765         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2766             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2767         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2768             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2769             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2770         16  FILLER                         PIC X(1).
  2771         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2772             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2773         16  CF-MORTG-MIB-VERSION           PIC X.
  2774             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2775             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2776             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2777         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2778             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2779                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2780             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2781                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2782             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2783                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2784             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2785                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2786             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2787                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2788             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2789                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2790         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2791         16  FILLER                         PIC X(7).
  2792         16  CF-MORTG-DESTINATION-SYMBOL.
  2793             20  CF-MORTG-MIB-COMM          PIC X(5).
  2794             20  CF-MORTG-MIB-TERM          PIC X(5).
  2795         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2796             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2797         16  FILLER                         PIC X(03).
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  50
* SOCK07.cbl
  2798         16  CF-MP-CHECK-NO-CONTROL.
  2799             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2800                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2801                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2802                                                ' ' LOW-VALUES.
  2803                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2804                                               VALUE '3'.
  2805         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2806         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2807         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2808             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2809                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2810             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2811                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2812             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2813                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2814             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2815                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2816             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2817                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2818             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2819                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2820         16  CF-MORTG-BILLING-AREA.
  2821             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2822                                            PIC X.
  2823         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2824         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2825         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2826         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2827             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2828             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2829         16  FILLER                         PIC X.
  2830         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2831             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2832             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2833         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2834         16  FILLER                         PIC X(8).
  2835         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2836         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2837         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2838         16  CF-ACH-COMPANY-ID.
  2839             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2840                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2841                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2842                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2843             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2844         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2845             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2846         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2847             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2848             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2849         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2850         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2851         16  FILLER                         PIC X(536).
  2852
  2853****************************************************************
  2854*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2855****************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  51
* SOCK07.cbl
  2856
  2857     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2858         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2859             20  CF-FEMALE-HEIGHT.
  2860                 24  CF-FEMALE-FT           PIC 99.
  2861                 24  CF-FEMALE-IN           PIC 99.
  2862             20  CF-FEMALE-MIN-WT           PIC 999.
  2863             20  CF-FEMALE-MAX-WT           PIC 999.
  2864         16  FILLER                         PIC X(428).
  2865
  2866     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2867         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2868             20  CF-MALE-HEIGHT.
  2869                 24  CF-MALE-FT             PIC 99.
  2870                 24  CF-MALE-IN             PIC 99.
  2871             20  CF-MALE-MIN-WT             PIC 999.
  2872             20  CF-MALE-MAX-WT             PIC 999.
  2873         16  FILLER                         PIC X(428).
  2874******************************************************************
  2875*             AUTOMATIC ACTIVITY RECORD                          *
  2876******************************************************************
  2877     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2878         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2879             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2880             20  CF-SYS-LETTER-ID           PIC X(04).
  2881             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2882             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2883             20  CF-SYS-RESET-SW            PIC X(01).
  2884             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2885             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2886
  2887         16  FILLER                         PIC X(50).
  2888
  2889         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2890             20  CF-USER-ACTIVE-SW          PIC X(01).
  2891             20  CF-USER-LETTER-ID          PIC X(04).
  2892             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2893             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2894             20  CF-USER-RESET-SW           PIC X(01).
  2895             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2896             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2897             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2898
  2899         16  FILLER                         PIC X(246).
  2900*                                 COPY ELCFUNDT.
  2901*****************************************************************
  2902*                                                               *
  2903*                            ELCFUNDT.                          *
  2904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
  2905*                            VMOD=2.001                         *
  2906*                                                               *
  2907*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
  2908*                                                               *
  2909*****************************************************************
  2910
  2911
  2912 01  FUNCTION-DATE.
  2913     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  52
* SOCK07.cbl
  2914     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
  2915         10  WS-FN-CCYR            PIC 9(4).
  2916         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
  2917             15  WS-FN-CC          PIC 99.
  2918             15  WS-FN-YR          PIC 99.
  2919         10  WS-FN-MO              PIC 99.
  2920         10  WS-FN-DA              PIC 99.
  2921     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
  2922     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
  2923     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
  2924     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
  2925     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
  2926         88  WS-BEHIND-GMT                     VALUE '-'.
  2927         88  WS-AFTER-GMT                      VALUE '+'.
  2928         88  WS-NO-GMT                         VALUE ZERO.
  2929     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
  2930     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
  2931*                                 COPY ELCDATE.
  2932******************************************************************
  2933*                                                                *
  2934*                                                                *
  2935*                            ELCDATE.                            *
  2936*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2937*                            VMOD=2.003
  2938*                                                                *
  2939*                                                                *
  2940*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2941*                 LENGTH = 200                                   *
  2942******************************************************************
  2943
  2944 01  DATE-CONVERSION-DATA.
  2945     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2946     12  DC-OPTION-CODE                PIC X.
  2947         88  BIN-TO-GREG                VALUE ' '.
  2948         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2949         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2950         88  YMD-GREG-TO-BIN            VALUE '3'.
  2951         88  MDY-GREG-TO-BIN            VALUE '4'.
  2952         88  JULIAN-TO-BIN              VALUE '5'.
  2953         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2954         88  FIND-CENTURY               VALUE '7'.
  2955         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2956         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2957         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2958         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2959         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2960         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2961         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2962         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2963         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2964         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2965         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2966         88  BIN-3-TO-GREG              VALUE 'I'.
  2967         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2968         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2969         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2970         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2971         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  53
* SOCK07.cbl
  2972         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2973         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2974         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2975         88  THREE-CHARACTER-BIN
  2976                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2977         88  GREGORIAN-TO-BIN
  2978                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2979         88  BIN-TO-GREGORIAN
  2980                  VALUES ' ' '1' 'I' '8' 'G'.
  2981         88  JULIAN-TO-BINARY
  2982                  VALUES '5' 'C' 'E' 'F'.
  2983     12  DC-ERROR-CODE                 PIC X.
  2984         88  NO-CONVERSION-ERROR        VALUE ' '.
  2985         88  DATE-CONVERSION-ERROR
  2986                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2987         88  DATE-IS-ZERO               VALUE '1'.
  2988         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2989         88  DATE-IS-INVALID            VALUE '3'.
  2990         88  DATE1-GREATER-DATE2        VALUE '4'.
  2991         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2992         88  DATE-INVALID-OPTION        VALUE '9'.
  2993         88  INVALID-CENTURY            VALUE 'A'.
  2994         88  ONLY-CENTURY               VALUE 'B'.
  2995         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2996         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2997     12  DC-END-OF-MONTH               PIC X.
  2998         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2999     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3000         88  USE-NORMAL-PROCESS         VALUE ' '.
  3001         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3002         88  ADJUST-UP-100-YRS          VALUE '2'.
  3003     12  FILLER                        PIC X.
  3004     12  DC-CONVERSION-DATES.
  3005         16  DC-BIN-DATE-1             PIC XX.
  3006         16  DC-BIN-DATE-2             PIC XX.
  3007         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3008         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3009                       DC-GREG-DATE-1-EDIT.
  3010             20  DC-EDIT1-MONTH        PIC 99.
  3011             20  SLASH1-1              PIC X.
  3012             20  DC-EDIT1-DAY          PIC 99.
  3013             20  SLASH1-2              PIC X.
  3014             20  DC-EDIT1-YEAR         PIC 99.
  3015         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3016         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3017                     DC-GREG-DATE-2-EDIT.
  3018             20  DC-EDIT2-MONTH        PIC 99.
  3019             20  SLASH2-1              PIC X.
  3020             20  DC-EDIT2-DAY          PIC 99.
  3021             20  SLASH2-2              PIC X.
  3022             20  DC-EDIT2-YEAR         PIC 99.
  3023         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3024         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3025                     DC-GREG-DATE-1-YMD.
  3026             20  DC-YMD-YEAR           PIC 99.
  3027             20  DC-YMD-MONTH          PIC 99.
  3028             20  DC-YMD-DAY            PIC 99.
  3029         16  DC-GREG-DATE-1-MDY        PIC 9(06).
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  54
* SOCK07.cbl
  3030         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3031                      DC-GREG-DATE-1-MDY.
  3032             20  DC-MDY-MONTH          PIC 99.
  3033             20  DC-MDY-DAY            PIC 99.
  3034             20  DC-MDY-YEAR           PIC 99.
  3035         16  DC-GREG-DATE-1-ALPHA.
  3036             20  DC-ALPHA-MONTH        PIC X(10).
  3037             20  DC-ALPHA-DAY          PIC 99.
  3038             20  FILLER                PIC XX.
  3039             20  DC-ALPHA-CENTURY.
  3040                 24 DC-ALPHA-CEN-N     PIC 99.
  3041             20  DC-ALPHA-YEAR         PIC 99.
  3042         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3043         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3044         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3045         16  DC-JULIAN-DATE            PIC 9(05).
  3046         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3047                                       PIC 9(05).
  3048         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3049             20  DC-JULIAN-YEAR        PIC 99.
  3050             20  DC-JULIAN-DAYS        PIC 999.
  3051         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3052         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3053         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3054     12  DATE-CONVERSION-VARIBLES.
  3055         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3056         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3057             20  FILLER                PIC 9(3).
  3058             20  HOLD-CEN-1-CCYY.
  3059                 24  HOLD-CEN-1-CC     PIC 99.
  3060                 24  HOLD-CEN-1-YY     PIC 99.
  3061             20  HOLD-CEN-1-MO         PIC 99.
  3062             20  HOLD-CEN-1-DA         PIC 99.
  3063         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3064             20  HOLD-CEN-1-R-MO       PIC 99.
  3065             20  HOLD-CEN-1-R-DA       PIC 99.
  3066             20  HOLD-CEN-1-R-CCYY.
  3067                 24  HOLD-CEN-1-R-CC   PIC 99.
  3068                 24  HOLD-CEN-1-R-YY   PIC 99.
  3069             20  FILLER                PIC 9(3).
  3070         16  HOLD-CENTURY-1-X.
  3071             20  FILLER                PIC X(3)  VALUE SPACES.
  3072             20  HOLD-CEN-1-X-CCYY.
  3073                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3074                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3075             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3076             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3077         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3078             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3079             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3080             20  HOLD-CEN-1-R-X-CCYY.
  3081                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3082                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3083             20  FILLER                PIC XXX.
  3084         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3085         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3086         16  DC-JULIAN-DATE-1          PIC 9(07).
  3087         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  55
* SOCK07.cbl
  3088             20  DC-JULIAN-1-CCYY.
  3089                 24  DC-JULIAN-1-CC    PIC 99.
  3090                 24  DC-JULIAN-1-YR    PIC 99.
  3091             20  DC-JULIAN-DA-1        PIC 999.
  3092         16  DC-JULIAN-DATE-2          PIC 9(07).
  3093         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3094             20  DC-JULIAN-2-CCYY.
  3095                 24  DC-JULIAN-2-CC    PIC 99.
  3096                 24  DC-JULIAN-2-YR    PIC 99.
  3097             20  DC-JULIAN-DA-2        PIC 999.
  3098         16  DC-GREG-DATE-A-EDIT.
  3099             20  DC-EDITA-MONTH        PIC 99.
  3100             20  SLASHA-1              PIC X VALUE '/'.
  3101             20  DC-EDITA-DAY          PIC 99.
  3102             20  SLASHA-2              PIC X VALUE '/'.
  3103             20  DC-EDITA-CCYY.
  3104                 24  DC-EDITA-CENT     PIC 99.
  3105                 24  DC-EDITA-YEAR     PIC 99.
  3106         16  DC-GREG-DATE-B-EDIT.
  3107             20  DC-EDITB-MONTH        PIC 99.
  3108             20  SLASHB-1              PIC X VALUE '/'.
  3109             20  DC-EDITB-DAY          PIC 99.
  3110             20  SLASHB-2              PIC X VALUE '/'.
  3111             20  DC-EDITB-CCYY.
  3112                 24  DC-EDITB-CENT     PIC 99.
  3113                 24  DC-EDITB-YEAR     PIC 99.
  3114         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3115         16  DC-GREG-DATE-CYMD-R REDEFINES
  3116                              DC-GREG-DATE-CYMD.
  3117             20  DC-CYMD-CEN           PIC 99.
  3118             20  DC-CYMD-YEAR          PIC 99.
  3119             20  DC-CYMD-MONTH         PIC 99.
  3120             20  DC-CYMD-DAY           PIC 99.
  3121         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3122         16  DC-GREG-DATE-MDCY-R REDEFINES
  3123                              DC-GREG-DATE-MDCY.
  3124             20  DC-MDCY-MONTH         PIC 99.
  3125             20  DC-MDCY-DAY           PIC 99.
  3126             20  DC-MDCY-CEN           PIC 99.
  3127             20  DC-MDCY-YEAR          PIC 99.
  3128    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3129        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3130    12  DC-EL310-DATE                  PIC X(21).
  3131    12  FILLER                         PIC X(28).
  3132*                                 COPY ELCCALC.
  3133******************************************************************
  3134*                                                                *
  3135*                           ELCCALC.                            *
  3136*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3137*                            VMOD=2.025                          *
  3138*                                                                *
  3139*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3140*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3141*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3142*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3143*                                                                *
  3144*  PASSED TO ELRTRM                                              *
  3145*  -----------------                                             *
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  56
* SOCK07.cbl
  3146*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3147*  ORIGINAL TERM                                                 *
  3148*  BEGINNING DATE                                                *
  3149*  ENDING DATE                                                   *
  3150*  COMPANY I.D.                                                  *
  3151*  ACCOUNT MASTER USER FIELD                                     *
  3152*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3153*  FREE LOOK DAYS                                                *
  3154*                                                                *
  3155*  RETURNED FROM ELRTRM                                          *
  3156*  ---------------------                                         *
  3157*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3158*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3159*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3160*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3161*----------------------------------------------------------------*
  3162*  PASSED TO ELRAMT                                              *
  3163*  ----------------                                              *
  3164*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3165*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3166*  ORIGINAL AMOUNT                                               *
  3167*  ALTERNATE BENEFIT (BALLON)                                    *
  3168*  A.P.R. - NET PAY ONLY                                         *
  3169*  METHOD
  3170*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3171*  COMPANY I.D.                                                  *
  3172*  BENEFIT TYPE                                                  *
  3173*                                                                *
  3174*  RETURNED FROM ELRAMT                                          *
  3175*  --------------------                                          *
  3176*  REMAINING AMOUNT 1 - CURRENT                                  *
  3177*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3178*  REMAINING AMOUNT FACTOR
  3179*----------------------------------------------------------------*
  3180*  PASSED TO ELRESV                                              *
  3181*  -----------------                                             *
  3182*  CERTIFICATE EFFECTIVE DATE                                    *
  3183*  VALUATION DATE                                                *
  3184*  PAID THRU DATE                                                *
  3185*  BENEFIT                                                       *
  3186*  INCURRED DATE                                                 *
  3187*  REPORTED DATE                                                 *
  3188*  ISSUE AGE                                                     *
  3189*  TERM                                                          *
  3190*  CDT PERCENT                                                   *
  3191*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3192* *CLAIM TYPE (LIFE, A/H)                                        *
  3193* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3194* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3195*                                                                *
  3196*  RETURNED FROM ELRESV                                          *
  3197*  --------------------                                          *
  3198*  CDT TABLE USED                                                *
  3199*  CDT FACTOR USED                                               *
  3200*  PAY TO CURRENT RESERVE                                        *
  3201*  I.B.N.R. - A/H ONLY                                           *
  3202*  FUTURE (ACCRUED) AH ONLY                                      *
  3203*----------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  57
* SOCK07.cbl
  3204*  PASSED TO ELRATE                                              *
  3205*  ----------------                                              *
  3206*  CERT ISSUE DATE                                               *
  3207*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3208*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3209*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3210*  STATE CODE (CLIENT DEFINED)                                   *
  3211*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3212*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3213*  DEVIATION CODE                                                *
  3214*  ISSUE AGE                                                     *
  3215*  ORIGINAL BENEFIT AMOUNT                                       *
  3216*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3217*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3218*  BENEFIT KIND (LIFE OR A/H)                                    *
  3219*  A.P.R.                                                        *
  3220*  METHOD
  3221*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3222*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3223*  COMPANY I.D. (3 CHARACTER)                                    *
  3224*  BENEFIT CODE                                                  *
  3225*  BENEFIT OVERRIDE CODE                                         *
  3226*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3227*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3228*  JOINT INDICATOR (CSL ONLY)                                    *
  3229*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3230*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3231*                                                                *
  3232*  RETURNED FROM ELRATE                                          *
  3233*  --------------------                                          *
  3234*  CALCULATED PREMIUM                                            *
  3235*  PREMIUM RATE                                                  *
  3236*  MORTALITY CODE                                                *
  3237*  MAX ATTAINED AGE                                              *
  3238*  MAX AGE                                                       *
  3239*  MAX TERM                                                      *
  3240*  MAX MONTHLY BENEFIT                                           *
  3241*  MAX TOTAL BENIFIT                                             *
  3242*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3243*----------------------------------------------------------------*
  3244*  PASSED TO ELRFND                                              *
  3245*  ----------------                                              *
  3246*  CERT ISSUE DATE                                               *
  3247*  REFUND DATE                                                   *
  3248*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3249*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3250*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3251*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3252*  STATE CODE (CLIENT DEFINED)                                   *
  3253*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3254*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3255*  DEVIATION CODE                                                *
  3256*  ISSUE AGE                                                     *
  3257*  ORIGINAL BENEFIT AMOUNT                                       *
  3258*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3259*  PROCESS TYPE (CANCEL)                                         *
  3260*  BENEFIT KIND (LIFE OR A/H)                                    *
  3261*  A.P.R.                                                        *
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  58
* SOCK07.cbl
  3262*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3263*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3264*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3265*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3266*  COMPANY I.D. (3 CHARACTER)                                    *
  3267*  BENEFIT CODE                                                  *
  3268*  BENEFIT OVERRIDE CODE                                         *
  3269*                                                                *
  3270*  RETURNED FROM ELRFND                                          *
  3271*  --------------------                                          *
  3272*  CALCULATED REFUND                                             *
  3273*----------------------------------------------------------------*
  3274*  PASSED TO ELEARN                                              *
  3275*  ----------------                                              *
  3276*  CERT ISSUE DATE                                               *
  3277*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3278*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3279*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3280*  STATE CODE (CLIENT DEFINED)                                   *
  3281*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3282*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3283*  DEVIATION CODE                                                *
  3284*  ISSUE AGE                                                     *
  3285*  ORIGINAL BENEFIT AMOUNT                                       *
  3286*  BENEFIT KIND (LIFE OR A/H)                                    *
  3287*  A.P.R.                                                        *
  3288*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3289*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3290*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3291*  COMPANY I.D. (3 CHARACTER)                                    *
  3292*  BENEFIT CODE                                                  *
  3293*  BENEFIT OVERRIDE CODE                                         *
  3294*                                                                *
  3295*  RETURNED FROM ELEARN                                          *
  3296*  --------------------                                          *
  3297*  INDICATED  EARNINGS                                           *
  3298*----------------------------------------------------------------*
  3299*                 LENGTH = 450                                   *
  3300*                                                                *
  3301******************************************************************
  3302******************************************************************
  3303*                   C H A N G E   L O G
  3304*
  3305* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3306*-----------------------------------------------------------------
  3307*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3308* EFFECTIVE    NUMBER
  3309*-----------------------------------------------------------------
  3310* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3311* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3312* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3313* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3314* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3315* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3316* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3317* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3318* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3319* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  59
* SOCK07.cbl
  3320* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3321******************************************************************
  3322
  3323 01  CALCULATION-PASS-AREA.
  3324     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3325                                     COMP.
  3326
  3327     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3328       88  NO-CP-ERROR                             VALUE ZERO.
  3329       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3330                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3331       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3332       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3333       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3334       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3335       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3336       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3337       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3338       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3339       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3340       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3341       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3342       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3343       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3344       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3345       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3346       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3347       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3348
  3349     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3350       88  NO-CP-ERROR-2                           VALUE ZERO.
  3351***********************  INPUT AREAS ****************************
  3352
  3353     12  CP-CALCULATION-AREA.
  3354         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3355         16  CP-CERT-EFF-DT        PIC XX.
  3356         16  CP-VALUATION-DT       PIC XX.
  3357         16  CP-PAID-THRU-DT       PIC XX.
  3358         16  CP-BENEFIT-TYPE       PIC X.
  3359           88  CP-AH                               VALUE 'A' 'D'
  3360                                                   'I' 'U'.
  3361           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3362           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3363         16  CP-INCURRED-DT        PIC XX.
  3364         16  CP-REPORTED-DT        PIC XX.
  3365         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3366         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3367         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3368                                     COMP-3.
  3369         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3370                                     COMP-3.
  3371         16  CP-CDT-METHOD         PIC X.
  3372           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3373           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3374           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3375         16  CP-CLAIM-TYPE         PIC X.
  3376           88  CP-AH-CLAIM                         VALUE 'A'.
  3377           88  CP-LIFE-CLAIM                       VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  60
* SOCK07.cbl
  3378         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3379                                     COMP-3.
  3380         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3381                                     COMP-3.
  3382         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3383                                     COMP-3.
  3384         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3385                                     COMP-3.
  3386         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3387                                     COMP-3.
  3388         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3389                                     COMP-3.
  3390         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3391                                     COMP-3.
  3392         16  CP-REM-TERM-METHOD    PIC X.
  3393           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3394           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3395           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3396           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3397           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3398           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3399           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3400         16  CP-EARNING-METHOD     PIC X.
  3401           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3402           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3403           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3404           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3405           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3406           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3407           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3408           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3409           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3410           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3411           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3412           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3413           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3414           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3415         16  CP-PROCESS-TYPE       PIC X.
  3416           88  CP-CLAIM                            VALUE '1'.
  3417           88  CP-CANCEL                           VALUE '2'.
  3418           88  CP-ISSUE                            VALUE '3'.
  3419         16  CP-SPECIAL-CALC-CD    PIC X.
  3420           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3421           88  CP-1-MTH-INTEREST               VALUE ' '.
  3422           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3423           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3424           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3425           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3426           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3427           88  CP-FARM-PLAN                    VALUE 'F'.
  3428           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3429           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3430           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3431           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3432           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3433           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3434           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3435           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  61
* SOCK07.cbl
  3436           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3437           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3438                                                     'W' 'X'.
  3439           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3440           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3441           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3442           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3443           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3444           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3445           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3446           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3447           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3448           88  CP-CSL-METH-1                   VALUE '5'.
  3449           88  CP-CSL-METH-2                   VALUE '6'.
  3450           88  CP-CSL-METH-3                   VALUE '7'.
  3451           88  CP-CSL-METH-4                   VALUE '8'.
  3452
  3453         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3454                                     COMP-3.
  3455         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3456         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3457         16  CP-STATE              PIC XX          VALUE SPACE.
  3458         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3459         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3460           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3461               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3462         16  CP-R78-OPTION         PIC X.
  3463           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3464           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3465
  3466         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3467         16  CP-IBNR-RESERVE-SW    PIC X.
  3468         16  CP-CLAIM-STATUS       PIC X.
  3469         16  CP-RATE-FILE          PIC X.
  3470         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3471                                     COMP-3.
  3472
  3473         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3474         16  CP-AH-OVERRIDE-CODE   PIC X.
  3475
  3476         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3477                                     COMP-3.
  3478         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3479                                   PIC S9(5)V99 COMP-3.
  3480         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3481                                     COMP-3.
  3482         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3483                                     COMP-3.
  3484         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3485                                     COMP-3.
  3486         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3487                                  PIC S9(7)V99 COMP-3.
  3488
  3489         16  CP-PAID-FROM-DATE     PIC X(02).
  3490         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3491         16  CP-EXT-DAYS-CALC      PIC X.
  3492           88  CP-EXT-NO-CHG                   VALUE ' '.
  3493           88  CP-EXT-CHG-LF                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  62
* SOCK07.cbl
  3494           88  CP-EXT-CHG-AH                   VALUE '2'.
  3495           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3496         16  CP-DOMICILE-STATE     PIC XX.
  3497         16  CP-CARRIER            PIC X.
  3498         16  CP-REIN-FLAG          PIC X.
  3499         16  CP-REM-TRM-CALC-OPTION PIC X.
  3500           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3501                      '2' '3' '4' '5'.
  3502           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3503           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3504           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3505           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3506           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3507           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3508           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3509           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3510         16  CP-SIG-SWITCH         PIC X.
  3511         16  CP-RATING-METHOD      PIC X.
  3512           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3513           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3514           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3515           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3516           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3517           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3518           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3519           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3520           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3521         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3522                                     COMP-3.
  3523         16  CP-BEN-CATEGORY       PIC X.
  3524         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3525         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3526                                   PIC S99V9(5) COMP-3.
  3527         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3528         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3529                                   PIC S99V9(5) COMP-3.
  3530         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3531         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3532         16  CP-EXPIRE-DT          PIC XX.
  3533         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3534         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3535         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3536         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3537         16  CP-DDF-SPEC-CALC      PIC X.
  3538             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3539             88  CP-CALC-CLP              VALUE 'C'.
  3540         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3541         16  CP-CANCEL-REASON      PIC X.
  3542         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3543         16  CP-PMT-MODE           PIC X.
  3544         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3545         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3546         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3547         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3548         16  FILLER                PIC X.
  3549
  3550***************    OUTPUT FROM ELRESV   ************************
  3551
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  63
* SOCK07.cbl
  3552         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3553
  3554         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3555                                     COMP-3.
  3556         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3557                                     COMP-3.
  3558         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3559                                     COMP-3.
  3560         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3561                                     COMP-3.
  3562         16  FILLER                PIC X(09).
  3563***************    OUTPUT FROM ELRTRM   *************************
  3564
  3565         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3566                                     COMP-3.
  3567         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3568                                     COMP-3.
  3569         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3570                                     COMP-3.
  3571         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3572                                     COMP-3.
  3573         16  FILLER                PIC X(12).
  3574
  3575***************    OUTPUT FROM ELRAMT   *************************
  3576
  3577         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3578                                     COMP-3.
  3579         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3580                                     COMP-3.
  3581         16  FILLER                PIC X(12).
  3582
  3583***************    OUTPUT FROM ELRATE   *************************
  3584
  3585         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3586                                     COMP-3.
  3587         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3588                                     COMP-3.
  3589         16  CP-MORTALITY-CODE     PIC X(4).
  3590         16  CP-RATE-EDIT-FLAG     PIC X.
  3591             88  CP-RATES-NEED-APR                  VALUE '1'.
  3592         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3593                                     COMP-3.
  3594         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3595         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3596         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3597                                   PIC S9(7)V99 COMP-3.
  3598         16  FILLER                PIC X(07).
  3599
  3600***************    OUTPUT FROM ELRFND   *************************
  3601
  3602         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3603                                     COMP-3.
  3604         16  CP-REFUND-TYPE-USED   PIC X.
  3605           88  CP-R-AS-R78                         VALUE '1'.
  3606           88  CP-R-AS-PRORATA                     VALUE '2'.
  3607           88  CP-R-AS-CALIF                       VALUE '3'.
  3608           88  CP-R-AS-TEXAS                       VALUE '4'.
  3609           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  64
* SOCK07.cbl
  3610           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3611           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3612           88  CP-R-AS-MEAN                        VALUE '8'.
  3613           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3614           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3615           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3616           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3617           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3618           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3619         16  FILLER                PIC X(12).
  3620
  3621***************    OUTPUT FROM ELEARN   *************************
  3622
  3623         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3624                                     COMP-3.
  3625         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3626                                     COMP-3.
  3627         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3628                                     COMP-3.
  3629         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3630                                     COMP-3.
  3631         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3632                                     COMP-3.
  3633         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3634                                     COMP-3.
  3635         16  CP-EARNING-TYPE-USED  PIC X.
  3636           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3637           88  CP-E-AS-R78                         VALUE '1'.
  3638           88  CP-E-AS-PRORATA                     VALUE '2'.
  3639           88  CP-E-AS-TEXAS                       VALUE '4'.
  3640           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3641           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3642           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3643           88  CP-E-AS-MEAN                        VALUE '8'.
  3644           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3645         16  FILLER                PIC X(12).
  3646
  3647***************    OUTPUT FROM ELPMNT   *************************
  3648
  3649         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3650                                     COMP-3.
  3651         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3652                                     COMP-3.
  3653         16  FILLER                PIC X(12).
  3654
  3655***************   MISC WORK AREAS    *****************************
  3656         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3657                                     COMP-3.
  3658         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3659                                     COMP-3.
  3660         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3661                                     COMP-3.
  3662         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3663                                     COMP-3.
  3664         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3665                                     COMP-3.
  3666         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3667                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  65
* SOCK07.cbl
  3668         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3669             88  OPEN-RATE-FILE                   VALUE 'O'.
  3670             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3671             88  IO-ERROR                         VALUE 'E'.
  3672
  3673         16  CP-FIRST-PAY-DATE     PIC XX.
  3674
  3675         16  CP-JOINT-INDICATOR    PIC X.
  3676
  3677         16  CP-RESERVE-REMAINING-TERM
  3678                                   PIC S9(4)V9    VALUE ZERO
  3679                                     COMP-3.
  3680
  3681         16  CP-INSURED-BIRTH-DT   PIC XX.
  3682
  3683         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3684                                     COMP-3.
  3685
  3686         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3687                                     COMP-3.
  3688
  3689         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3690                                     COMP-3.
  3691
  3692         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3693                                     COMP-3.
  3694
  3695         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3696                                     COMP-3.
  3697
  3698         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3699                                     COMP-3.
  3700
  3701         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3702                                     COMP-3.
  3703
  3704         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3705             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3706
  3707         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3708                                     COMP-3.
  3709         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3710                                     COMP-3.
  3711         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3712         16  cp-extra-periods      pic 9 value zeros.
  3713         16  cp-net-only-state     pic x value spaces.
  3714         16  FILLER                PIC X(13).
  3715******************************************************************
  3716****************************************************************
  3717*
  3718* Copyright (c) 2007-2013 Dell Inc.
  3719* All rights reserved.
  3720*
  3721****************************************************************
  3722 01  DFHEIV.
  3723   02  DFHEIV0               PIC X(35).
  3724   02  DFHEIV1               PIC X(08).
  3725   02  DFHEIV2               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  66
* SOCK07.cbl
  3726   02  DFHEIV3               PIC X(08).
  3727   02  DFHEIV4               PIC X(06).
  3728   02  DFHEIV5               PIC X(04).
  3729   02  DFHEIV6               PIC X(04).
  3730   02  DFHEIV7               PIC X(02).
  3731   02  DFHEIV8               PIC X(02).
  3732   02  DFHEIV9               PIC X(01).
  3733   02  DFHEIV10              PIC S9(7) COMP-3.
  3734   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3735   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3736   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3737   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3738   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3739   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3740   02  DFHEIV17              PIC X(04).
  3741   02  DFHEIV18              PIC X(04).
  3742   02  DFHEIV19              PIC X(04).
  3743   02  DFHEIV20              USAGE IS POINTER.
  3744   02  DFHEIV21              USAGE IS POINTER.
  3745   02  DFHEIV22              USAGE IS POINTER.
  3746   02  DFHEIV23              USAGE IS POINTER.
  3747   02  DFHEIV24              USAGE IS POINTER.
  3748   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3749   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3750   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3751   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3752   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3753   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3754   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3755   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3756   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3757   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3758   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3759   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3760   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3761   02  FILLER                PIC X(02).
  3762   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3763   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3764   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3765   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3766   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3767   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3768   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3769 LINKAGE  SECTION.
  3770*****************************************************************
  3771*                                                               *
  3772* Copyright (c) 2007-2013 Dell Inc.                             *
  3773* All rights reserved.                                          *
  3774*                                                               *
  3775*****************************************************************
  3776 01  dfheiblk.
  3777     02  eibtime          pic s9(7) comp-3.
  3778     02  eibdate          pic s9(7) comp-3.
  3779     02  eibtrnid         pic x(4).
  3780     02  eibtaskn         pic s9(7) comp-3.
  3781     02  eibtrmid         pic x(4).
  3782     02  dfheigdi         pic s9(4) comp.
  3783     02  eibcposn         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  67
* SOCK07.cbl
  3784     02  eibcalen         pic s9(4) comp.
  3785     02  eibaid           pic x(1).
  3786     02  eibfiller1       pic x(1).
  3787     02  eibfn            pic x(2).
  3788     02  eibfiller2       pic x(2).
  3789     02  eibrcode         pic x(6).
  3790     02  eibfiller3       pic x(2).
  3791     02  eibds            pic x(8).
  3792     02  eibreqid         pic x(8).
  3793     02  eibrsrce         pic x(8).
  3794     02  eibsync          pic x(1).
  3795     02  eibfree          pic x(1).
  3796     02  eibrecv          pic x(1).
  3797     02  eibsend          pic x(1).
  3798     02  eibatt           pic x(1).
  3799     02  eibeoc           pic x(1).
  3800     02  eibfmh           pic x(1).
  3801     02  eibcompl         pic x(1).
  3802     02  eibsig           pic x(1).
  3803     02  eibconf          pic x(1).
  3804     02  eiberr           pic x(1).
  3805     02  eibrldbk         pic x(1).
  3806     02  eiberrcd         pic x(4).
  3807     02  eibsynrb         pic x(1).
  3808     02  eibnodat         pic x(1).
  3809     02  eibfiller5       pic x(2).
  3810     02  eibresp          pic s9(8) comp.
  3811     02  eibresp2         pic s9(8) comp.
  3812     02  dfheigdj         pic s9(4) comp.
  3813     02  dfheigdk         pic s9(4) comp.
  3814 01  DFHCOMMAREA.
  3815   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3816   05 LSTN-NAME                PIC X(8).
  3817   05 LSTN-SUBNAME             PIC X(8).
  3818****   client-in-data must be 36 characters.  ****
  3819   05 CLIENT-IN-DATA.
  3820      15  CLIENT-KICK-OFF      PIC X(8).
  3821      15  CLIENT-ID            PIC XXX.
  3822      15  FILLER               PIC X(25).
  3823   05 SOCKADDR-IN-PARM.
  3824     15 SIN-FAMILY             PIC 9(4) COMP.
  3825     15 SIN-PORT               PIC 9(4) COMP.
  3826     15 SIN-ADDRESS            PIC 9(8) COMP.
  3827     15 SIN-ZERO               PIC X(8).
  3828 01  var  pic x(30).
  3829 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  3830 0000-DFHEXIT SECTION.
  3831     MOVE '9#                    $   ' TO DFHEIV0.
  3832     MOVE 'SOCK07' TO DFHEIV1.
  3833     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3834     display 'SOCK07:transaction data =', CLIENT-IN-DATA '**'
  3835     display 'SOCK07:socket number    =', GIVE-TAKE-SOCKET.
  3836     display 'SOCK07:socket name      =', lstn-name ' '
  3837        lstn-subname
  3838     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  3839     move ws-fn-cymd             to dc-greg-date-cymd
  3840     move 'L'                    to dc-option-code
  3841     perform 9700-date-link      thru 9700-exit
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  68
* SOCK07.cbl
  3842     if no-conversion-error
  3843        move dc-bin-date-1       to ws-bin-current-dt
  3844     else
  3845        display ' error current dt invalid ' dc-error-code
  3846     end-if
  3847     display ' current date/time '
  3848        ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  3849           ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  3850     set P to address of KIXSYS
  3851     CALL "getenv" using by value P returning var-ptr
  3852     if var-ptr = null then
  3853        display ' kixsys not set '
  3854     else
  3855        set address of var to var-ptr
  3856        move 0 to env-var-len
  3857        inspect var tallying env-var-len
  3858          for characters before X'00'
  3859        unstring var (1:env-var-len) delimited by '/'
  3860           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  3861              WS-KIX-SYS
  3862        end-unstring
  3863     end-if
  3864     perform 0000-init-contact   thru 0000-exit
  3865     perform 0100-process-socket thru 0100-exit until
  3866        end-of-socket
  3867     go to 0300-close-socket
  3868     .
  3869 0000-init-contact.
  3870     if client-kick-off = 'SOCKET07'
  3871        continue
  3872     else
  3873        move '9999;Unknown origin, who are you? '
  3874                                 to ws-return-string
  3875        PERFORM 0200-SEND-BUFFER thru 0200-exit
  3876        display ' Unknown origin ' client-in-data
  3877        go to 0300-close-socket
  3878     end-if
  3879     evaluate client-id
  3880        when 'DCC'
  3881           MOVE X'05'            TO WS-COMP-CD
  3882           MOVE 'DCC'            TO WS-COMP-ID
  3883        when 'CID'
  3884           MOVE X'04'            TO WS-COMP-CD
  3885           MOVE 'CID'            TO WS-COMP-ID
  3886        when 'AHL'
  3887           MOVE X'06'            TO WS-COMP-CD
  3888           MOVE 'AHL'            TO WS-COMP-ID
  3889        when other
  3890           move '0113;Invalid company id ' to ws-return-string
  3891           PERFORM 0200-SEND-BUFFER thru 0200-exit
  3892           display ' Invalid company id ' client-id
  3893           go to 0300-close-socket
  3894     END-evaluate
  3895     move 'SOCKET07READY'        to ws-send-buf
  3896     move +25                    to ws-send-msg-size
  3897     display 'SOCK07:sequence number  =', ws-seq-num.
  3898     display 'SOCK07:send buffer      =', ws-send-buf(1:25)
  3899     call "send" using by value GIVE-TAKE-SOCKET,
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  69
* SOCK07.cbl
  3900         by reference ws-send-buf,
  3901         by value ws-send-msg-size,
  3902         by value ws-flags
  3903     if return-code <= zero
  3904        display 'SOCK07:send error ' return-code
  3905        perform 0250-socket-error thru 0250-exit
  3906        go to 0300-close-socket
  3907     end-if
  3908     .
  3909 0000-exit.
  3910     exit.
  3911 0010-receive.
  3912     display 'SOCK07:About to recv '
  3913     call "recv" using by value GIVE-TAKE-SOCKET
  3914         by reference ws-recv-buf
  3915         by value ws-recv-msg-size
  3916         by value ws-flags.
  3917     if return-code < zero
  3918        display 'SOCK07:recv error ' return-code
  3919        perform 0250-socket-error thru 0250-exit
  3920        set end-of-socket to true
  3921        go to 0010-exit
  3922     end-if
  3923     if return-code = zero
  3924        display 'SOCK07:client disconnected',
  3925        perform 0250-socket-error thru 0250-exit
  3926        set end-of-socket to true
  3927        go to 0010-exit
  3928     end-if
  3929     display 'SOCK07:Good recv  '
  3930     display 'SOCK07:return code      = ', return-code
  3931     display 'SOCK07:receive buffer   = ', ws-recv-buf(1:51)
  3932     move +112                   to ws-send-msg-size
  3933     move ws-recv-buf (1:111)     to soc-client-in-data
  3934     if ws-recv-buf (1:4) = 'DONE' or 'done' or 'Done'
  3935        set end-of-socket to true
  3936     end-if
  3937     .
  3938 0010-exit.
  3939     exit.
  3940 0020-edit-received.
  3941     if rate-sin-jnt-ind = 'S' OR 'J'
  3942        continue
  3943     else
  3944        move 'S'                 to rate-sin-jnt-ind
  3945     end-if
  3946     if rate-dismemberment = ' ' or 'Y' or 'N'
  3947        continue
  3948     else
  3949        move 'N'                 to rate-dismemberment
  3950     end-if
  3951     if rate-retro-elim = 'R' or 'E'
  3952        continue
  3953     else
  3954        move 'R'                 to rate-retro-elim
  3955     end-if
  3956     inspect
  3957        rate-benefit replacing all spaces by zeros
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  70
* SOCK07.cbl
  3958     inspect
  3959        rate-premium replacing all spaces by zeros
  3960     inspect
  3961        rate-loan-term replacing all spaces by zeros
  3962     inspect
  3963        rate-ins-term replacing all spaces by zeros
  3964     inspect
  3965        rate-apr replacing all spaces by zeros
  3966     inspect
  3967        rate-waiting-days replacing all spaces by zeros
  3968     inspect
  3969        rate-crit-per replacing all spaces by zeros
  3970     if rate-ben-dollars not numeric
  3971        move zeros               to rate-ben-dollars
  3972     end-if
  3973     if rate-ben-pennies not numeric
  3974        move zeros               to rate-ben-pennies
  3975     end-if
  3976     string
  3977        rate-ben-dollars
  3978        rate-ben-pennies delimited by size
  3979           into                  ws-rate-benefit-a
  3980     end-string
  3981     if rate-prem-dollars not numeric
  3982        move zeros               to rate-prem-dollars
  3983     end-if
  3984     if rate-prem-pennies not numeric
  3985        move zeros               to rate-prem-pennies
  3986     end-if
  3987     string
  3988        rate-prem-dollars
  3989        rate-prem-pennies delimited by size
  3990           into                  ws-rate-premium-a
  3991     end-string
  3992     if rate-loan-term not numeric
  3993        move zeros               to rate-loan-term
  3994     end-if
  3995     move rate-loan-term         to ws-rate-loan-term
  3996     move rate-ins-term          to ws-rate-ins-term
  3997     if rate-apr-whole not numeric
  3998        move zeros               to rate-apr-whole
  3999     end-if
  4000     if rate-apr-dec not numeric
  4001        move zeros               to rate-apr-dec
  4002     end-if
  4003     string
  4004        rate-apr-whole
  4005        rate-apr-dec delimited by size
  4006           into                  ws-rate-apr-a
  4007     end-string
  4008     if rate-waiting-days-n not numeric
  4009        move zeros               to rate-waiting-days-n
  4010     end-if
  4011     if rate-crit-per-n not numeric
  4012        move zeros               to rate-crit-per-n
  4013     end-if
  4014     if ws-rate-ins-term = zeros
  4015        move '0115;Problem with insurance term '
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  71
* SOCK07.cbl
  4016                                 to ws-return-string
  4017        perform 0200-send-buffer thru 0200-exit
  4018        go to 0300-close-socket
  4019     end-if
  4020     if rate-lf-ah = 'L'
  4021        move 'L'                 to ws-rate-benefit-type
  4022     else
  4023        move 'A'                 to ws-rate-benefit-type
  4024     end-if
  4025**==============================================================**
  4026**                                                              **
  4027**  Validate passed effective date. Probably should add edits   **
  4028**                                                              **
  4029**==============================================================**
  4030     move rate-eff-date (7:4)    to ws-work-date (1:4)
  4031     move rate-eff-date (1:2)    to ws-work-date (5:2)
  4032     move rate-eff-date (4:2)    to ws-work-date (7:2)
  4033     move ws-work-date-num       to dc-greg-date-cymd
  4034     move 'L'                    to dc-option-code
  4035     perform 9700-date-link      thru 9700-exit
  4036     if no-conversion-error
  4037        move dc-bin-date-1       to ws-bin-eff-dt
  4038     else
  4039        move '0102;Problem with Eff Date' to ws-return-string
  4040        perform 0200-send-buffer thru 0200-exit
  4041        go to 0300-close-socket
  4042     end-if
  4043     if ws-bin-eff-dt > ws-bin-current-dt
  4044        move '0102;Future Effective Date' to ws-return-string
  4045        perform 0200-send-buffer thru 0200-exit
  4046        go to 0300-close-socket
  4047     end-if
  4048**==============================================================**
  4049**                                                              **
  4050**  Validate passed 1st pmt date.   Probably should add edits   **
  4051**                                                              **
  4052**==============================================================**
  4053     move rate-1st-pmt-dt (7:4)  to ws-work-date (1:4)
  4054     move rate-1st-pmt-dt (1:2)  to ws-work-date (5:2)
  4055     move rate-1st-pmt-dt (4:2)  to ws-work-date (7:2)
  4056     move ws-work-date-num       to dc-greg-date-cymd
  4057     move 'L'                    to dc-option-code
  4058     perform 9700-date-link      thru 9700-exit
  4059     if no-conversion-error
  4060        move dc-bin-date-1       to ws-bin-1st-pmt-dt
  4061     else
  4062        move low-values          to ws-bin-1st-pmt-dt
  4063        move '0102;Problem with 1st pmt Date'
  4064                                 to ws-return-string
  4065        perform 0200-send-buffer thru 0200-exit
  4066        go to 0300-close-socket
  4067     end-if
  4068     if ws-bin-1st-pmt-dt <= ws-bin-eff-dt
  4069        move low-values          to ws-bin-1st-pmt-dt
  4070        move '0102;1st Pmt Date not > Eff Dt '
  4071                                 to ws-return-string
  4072        perform 0200-send-buffer thru 0200-exit
  4073        go to 0300-close-socket
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  72
* SOCK07.cbl
  4074     end-if
  4075**==============================================================**
  4076**                                                              **
  4077**  Only use the code below if there is a time they don't       **
  4078**  send the 1st pmt date.                                      **
  4079**                                                              **
  4080**==============================================================**
  4081     if ws-bin-1st-pmt-dt = low-values
  4082        move +1                  to dc-elapsed-months
  4083        move +0                  to dc-elapsed-days
  4084        move '6'                 to dc-option-code
  4085        perform 9700-date-link   thru 9700-exit
  4086        if no-conversion-error
  4087           move dc-bin-date-2    to ws-bin-1st-pmt-dt
  4088        else
  4089           move '0102;Problem with 1st pmt Date'
  4090                                 to ws-return-string
  4091           perform 0200-send-buffer
  4092                                 thru 0200-exit
  4093           go to 0300-close-socket
  4094        end-if
  4095     end-if
  4096**==============================================================**
  4097**                                                              **
  4098**  Calculate the expiration date to be passed back.            **
  4099**                                                              **
  4100**==============================================================**
  4101     move ws-bin-1st-pmt-dt      to dc-bin-date-1
  4102     compute dc-elapsed-months = ws-rate-ins-term - 1
  4103     move +0                     to dc-elapsed-days
  4104     move '6'                    to dc-option-code
  4105     perform 9700-date-link      thru 9700-exit
  4106     if no-conversion-error
  4107        move dc-bin-date-2       to ws-bin-exp-dt
  4108        move dc-greg-date-a-edit to ws-exp-date
  4109     else
  4110        move '0102;Problem with calculating exp date'
  4111                              to ws-return-string
  4112        perform 0200-send-buffer
  4113                              thru 0200-exit
  4114        go to 0300-close-socket
  4115     end-if
  4116**==============================================================**
  4117**                                                              **
  4118**  Validate primary borrower birth date.                       **
  4119**                                                              **
  4120**==============================================================**
  4121     move rate-pri-birth-date (7:4)
  4122                                 to ws-work-date (1:4)
  4123     move rate-pri-birth-date (1:2)
  4124                                 to ws-work-date (5:2)
  4125     move rate-pri-birth-date (4:2)
  4126                                 to ws-work-date (7:2)
  4127     move ws-work-date-num       to dc-greg-date-cymd
  4128     move 'L'                    to dc-option-code
  4129     perform 9700-date-link      thru 9700-exit
  4130     if no-conversion-error
  4131        move dc-bin-date-1       to ws-bin-pri-birth-dt
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  73
* SOCK07.cbl
  4132     else
  4133        move '0102;Problem with Pri Birth Date'
  4134                                 to ws-return-string
  4135        perform 0200-send-buffer thru 0200-exit
  4136        go to 0300-close-socket
  4137     end-if
  4138**==============================================================**
  4139**                                                              **
  4140**  Validate co borrowers birth date.                           **
  4141**                                                              **
  4142**==============================================================**
  4143     if rate-cob-birth-date (7:4) = spaces
  4144        move zeros               to rate-cob-birth-date
  4145     end-if
  4146     move rate-cob-birth-date (7:4)
  4147                                 to ws-work-date (1:4)
  4148     move rate-cob-birth-date (1:2)
  4149                                 to ws-work-date (5:2)
  4150     move rate-cob-birth-date (4:2)
  4151                                 to ws-work-date (7:2)
  4152     move low-values             to ws-bin-cob-birth-dt
  4153     if ws-work-date-num not = zeros
  4154        move ws-work-date-num    to dc-greg-date-cymd
  4155        move 'L'                 to dc-option-code
  4156        perform 9700-date-link   thru 9700-exit
  4157        if no-conversion-error
  4158           move dc-bin-date-1    to ws-bin-cob-birth-dt
  4159        else
  4160           move '0102;Problem with Cob Birth Date'
  4161                                 to ws-return-string
  4162           perform 0200-send-buffer
  4163                                 thru 0200-exit
  4164           go to 0300-close-socket
  4165        end-if
  4166     end-if
  4167**==============================================================**
  4168**                                                              **
  4169**  Calculate primary borrowers age.                            **
  4170**                                                              **
  4171**==============================================================**
  4172     move ws-bin-pri-birth-dt    to dc-bin-date-1
  4173     move ws-bin-eff-dt          to dc-bin-date-2
  4174     move '1'                    to dc-option-code
  4175     perform 9700-date-link      thru 9700-exit
  4176     if no-conversion-error
  4177        compute ws-issue-age = dc-elapsed-months / +12
  4178        display ' issue age = 'ws-issue-age
  4179     else
  4180        move '0102;Problem with Pri Age calculation'
  4181                                 to ws-return-string
  4182        perform 0200-send-buffer thru 0200-exit
  4183        go to 0300-close-socket
  4184     end-if
  4185**==============================================================**
  4186**                                                              **
  4187**  Calculate co borrowers age.                                 **
  4188**                                                              **
  4189**==============================================================**
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  74
* SOCK07.cbl
  4190     move zeros                  to ws-cob-age
  4191     if ws-bin-cob-birth-dt not = low-values
  4192        move ws-bin-cob-birth-dt to dc-bin-date-1
  4193        move ws-bin-eff-dt       to dc-bin-date-2
  4194        move '1'                 to dc-option-code
  4195        perform 9700-date-link   thru 9700-exit
  4196        if no-conversion-error
  4197           compute ws-cob-age = dc-elapsed-months / +12
  4198           display ' cob   age = 'ws-cob-age
  4199        else
  4200           move '0102;Problem with Cob Age calculation'
  4201                                 to ws-return-string
  4202           perform 0200-send-buffer
  4203                                 thru 0200-exit
  4204           go to 0300-close-socket
  4205        end-if
  4206     end-if
  4207     move ws-issue-age           to ws-rate-age
  4208     if ws-cob-age > ws-rate-age
  4209        display ' Using Co borrower age ' ws-issue-age
  4210           ' ' ws-cob-age
  4211        move ws-cob-age          to ws-rate-age
  4212     end-if
  4213     .
  4214 0020-exit.
  4215     exit.
  4216 0025-assign-ben-cd.
  4217**==============================================================**
  4218**                                                              **
  4219**     Eventually, depending on how well this project takes off **
  4220**  we should figure out a much better way to assign benefit    **
  4221**  codes. For now since we only have 1 or 2 accounts in TX it  **
  4222**  will be hard coded.                                         **
  4223**                                                              **
  4224**==============================================================**
  4225     if ws-rate-benefit-type = 'L'
  4226        if rate-sin-jnt-ind = 'S'
  4227           move '01'             to ws-rate-benefit-cd
  4228        else
  4229           move '03'             to ws-rate-benefit-cd
  4230        end-if
  4231     else
  4232        if rate-sin-jnt-ind = 'J'
  4233           if rate-retro-elim = 'R'
  4234              if rate-waiting-days-n = 14
  4235                 move '54'       to ws-rate-benefit-cd
  4236              else
  4237                 if rate-waiting-days-n = 30
  4238                    move '55'    to ws-rate-benefit-cd
  4239                 end-if
  4240              end-if
  4241           else
  4242              if rate-retro-elim = 'E'
  4243                 if rate-waiting-days-n = 14
  4244                    move '56'    to ws-rate-benefit-cd
  4245                 else
  4246                    if rate-waiting-days-n = 30
  4247                       move '57' to ws-rate-benefit-cd
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  75
* SOCK07.cbl
  4248                    end-if
  4249                 end-if
  4250              end-if
  4251           end-if
  4252        else
  4253           if rate-retro-elim = 'R'
  4254              if rate-waiting-days-n = 14
  4255                 move '01'       to ws-rate-benefit-cd
  4256              else
  4257                 if rate-waiting-days-n = 30
  4258                    move '04'    to ws-rate-benefit-cd
  4259                 end-if
  4260              end-if
  4261           else
  4262              if rate-retro-elim = 'E'
  4263                 if rate-waiting-days-n = 14
  4264                    move '05'    to ws-rate-benefit-cd
  4265                 else
  4266                    if rate-waiting-days-n = 30
  4267                       move '02' to ws-rate-benefit-cd
  4268                    end-if
  4269                 end-if
  4270              end-if
  4271           end-if
  4272        end-if
  4273     end-if
  4274     .
  4275 0025-exit.
  4276     exit.
  4277 0030-get-rate.
  4278     perform 0050-get-account    thru 0050-exit
  4279*    move spaces                 to calculation-pass-area
  4280     move zeros                  to cp-r-max-mon-ben
  4281                                    cp-r-max-tot-ben
  4282                                    cp-rate-dev-pct
  4283                                    cp-original-premium
  4284                                    cp-critical-months
  4285                                    cp-term-or-ext-days
  4286     move am-cal-table           to cp-class-CODE
  4287     if ws-rate-benefit-type = 'L'
  4288        move am-lf-deviation     to cp-deviation-code
  4289     else
  4290        move am-ah-deviation     to cp-deviation-code
  4291     end-if
  4292     move rate-state             to cp-state
  4293                                    cp-state-std-abbrv
  4294     move ws-rate-benefit-type   to cp-benefit-type
  4295     move ws-rate-benefit-cd     to cp-benefit-cd
  4296     move ws-rate-benefit        to cp-original-benefit
  4297                                    cp-rating-benefit-amt
  4298     move ws-rate-age            to cp-issue-age
  4299     move ws-comp-id             to cp-company-id
  4300     move ws-comp-cd             to cp-company-cd
  4301     move ws-rate-apr            to cp-loan-apr
  4302     if ws-rate-loan-term = zeros
  4303        move ws-rate-ins-term    to ws-rate-loan-term
  4304     end-if
  4305     move ws-rate-ins-term       to cp-original-term
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  76
* SOCK07.cbl
  4306     move ws-rate-loan-term      to cp-loan-term
  4307     move 'L'                    to cp-life-override-code
  4308     move 'A'                    to cp-ah-override-code
  4309     move '3'                    to cp-process-type
  4310     move rate-earn-meth         to cp-earning-method
  4311                                    cp-rating-method
  4312     move 'R'                    to cp-rate-file
  4313     move ws-bin-eff-dt          to cp-cert-eff-dt
  4314     move ws-bin-1st-pmt-dt      to cp-first-pay-date
  4315     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4316     if no-cp-error
  4317        if ((cp-calc-premium - ws-rate-premium) > 9.99)
  4318                        or
  4319           ((ws-rate-premium - cp-calc-premium) > 9.99)
  4320           move 'Z'              to cp-return-code
  4321        end-if
  4322     end-if
  4323**==============================================================**
  4324**                                                              **
  4325** The below code will change as we add more states and forms   **
  4326** to this process.                                             **
  4327**                                                              **
  4328**==============================================================**
  4329     if ws-rate-benefit-type = 'L'
  4330        move cp-original-benefit to ws-max-benefit
  4331     else
  4332        compute ws-max-benefit =
  4333           cp-original-term * cp-original-benefit
  4334     end-if
  4335     .
  4336 0030-exit.
  4337     exit.
  4338 0040-format-buffer.
  4339     move spaces                 to ws-return-string
  4340     perform 0045-format-error   thru 0045-exit
  4341     move ';'                    to ws-sc1
  4342                                    ws-sc2
  4343                                    ws-sc3
  4344                                    ws-sc4
  4345                                    ws-sc5
  4346                                    ws-sc6
  4347                                    ws-sc7
  4348     if no-cp-error
  4349        if ws-contract-suffix = spaces or low-values
  4350           move ws-contract-no   to ws-return-contract-no (2:10)
  4351        else
  4352           move ws-contract-no   to ws-return-contract-no (1:10)
  4353           move ws-contract-suffix
  4354                                 to ws-return-contract-no (11:1)
  4355        end-if
  4356        move cp-calc-premium     to ws-return-prem
  4357        move cp-premium-rate     to ws-return-rate
  4358        move ws-max-benefit      to ws-return-max-ben
  4359        move ws-exp-date         to ws-return-exp-dt
  4360        move ws-rate-benefit-cd  to ws-return-benefit-cd
  4361     else
  4362        set error-in-one-coverage to true
  4363        move spaces              to ws-contract-no
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  77
* SOCK07.cbl
  4364                                    ws-contract-suffix
  4365     end-if
  4366     .
  4367 0040-exit.
  4368     exit.
  4369 0045-format-error.
  4370     evaluate true
  4371        when cp-return-code = '0'
  4372           move +1               to s1
  4373        when cp-return-code = '1'
  4374           move +2               to s1
  4375        when cp-return-code = '2'
  4376           move +3               to s1
  4377        when cp-return-code = 'A'
  4378           move +4               to s1
  4379        when cp-return-code = 'B'
  4380           move +5               to s1
  4381        when cp-return-code = '4'
  4382           move +6               to s1
  4383        when cp-return-code = '9'
  4384           move +7               to s1
  4385        when cp-return-code = '8'
  4386           move +8               to s1
  4387        when cp-return-code = 'H'
  4388           move +9               to s1
  4389        when cp-return-code = 'C'
  4390           move +10              to s1
  4391        when cp-return-code = '7'
  4392           move +11              to s1
  4393        when cp-return-code = '6'
  4394           move +12              to s1
  4395        when cp-return-code = 'D'
  4396           move +13              to s1
  4397        when cp-return-code = 'Z'
  4398           move +14              to s1
  4399           move cp-calc-premium  to ws-return-prem
  4400           move cp-premium-rate  to ws-return-rate
  4401           move ws-max-benefit   to ws-return-max-ben
  4402           move ws-exp-date      to ws-return-exp-dt
  4403           move ws-rate-benefit-cd to ws-return-benefit-cd
  4404        when cp-return-code = 'Y'
  4405           move +15              to s1
  4406           move cp-calc-premium  to ws-return-prem
  4407           move cp-premium-rate  to ws-return-rate
  4408           move ws-max-benefit   to ws-return-max-ben
  4409           move ws-exp-date      to ws-return-exp-dt
  4410           move ws-rate-benefit-cd to ws-return-benefit-cd
  4411     end-evaluate
  4412     move ws-table-error-no (s1) to ws-return-error-no
  4413     move ws-table-error-mess (s1)
  4414                                 to ws-return-error-mess
  4415     .
  4416 0045-exit.
  4417     exit.
  4418 0050-get-account.
  4419     move ws-comp-cd             to ws-am-company-cd
  4420     move '9'                    to ws-am-carrier
  4421     move '000000'               to ws-am-group
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  78
* SOCK07.cbl
  4422     move rate-state             to ws-am-state
  4423     move rate-acct-no           to ws-am-account
  4424     move ws-bin-eff-dt          to ws-am-exp-dt
  4425
  4426* exec cics read
  4427*       dataset      ('ERACCT')
  4428*       ridfld       (ws-am-key)
  4429*       into         (account-master)
  4430*       GTEQ
  4431*       resp         (ws-response)
  4432*    end-exec
  4433     MOVE LENGTH OF
  4434      account-master
  4435       TO DFHEIV11
  4436     MOVE 'ERACCT' TO DFHEIV1
  4437*    MOVE '&"IL       G          (  N#00004328' TO DFHEIV0
  4438     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4439     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4440     MOVE X'204E233030303034333238' TO DFHEIV0(25:11)
  4441     CALL 'kxdfhei1' USING DFHEIV0,
  4442           DFHEIV1,
  4443           account-master,
  4444           DFHEIV11,
  4445           ws-am-key,
  4446           DFHEIV99,
  4447           DFHEIV99,
  4448           DFHEIV99
  4449     MOVE EIBRESP  TO ws-response
  4450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4451     if resp-normal
  4452        and (ws-comp-cd = am-company-cd)
  4453        and (rate-state = am-state)
  4454        and (rate-acct-no = am-account)
  4455        and (ws-bin-eff-dt >= am-effective-dt)
  4456        and (ws-bin-eff-dt < am-expiration-dt)
  4457        continue
  4458     else
  4459        move '0114;No account mstr found ' to ws-return-string
  4460        perform 0200-send-buffer thru 0200-exit
  4461        go to 0300-close-socket
  4462     end-if
  4463     .
  4464 0050-exit.
  4465     exit.
  4466 0060-check-for-dup.
  4467**==============================================================**
  4468**                                                              **
  4469**    All i'm going to do here is check for a dup using         **
  4470**  the state, account, eff dt and last six of vin and a space  **
  4471**  in the cert suffix. If I do find one then I will have to    **
  4472**  find the last suffix and use the next available one in the  **
  4473**  suffix table.                                               **
  4474**                                                              **
  4475**==============================================================**
  4476     move +1                     to x1
  4477     move ' '                    to ws-browse-sw
  4478     move ws-comp-cd             to ws-cm-key
  4479     move '9'                    to ws-cm-carrier
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  79
* SOCK07.cbl
  4480     move '000000'               to ws-cm-group
  4481     move rate-state             to ws-cm-state
  4482     move rate-acct-no           to ws-cm-account
  4483     move ws-bin-eff-dt          to ws-cm-eff-dt
  4484     string
  4485        '0000'
  4486        rate-vin (12:6)
  4487        ' ' delimited by size into ws-cm-cert-no
  4488     end-string
  4489     move ws-cm-key              to ws-cm-compare-key
  4490     move ws-cm-cert-ten         to ws-contract-no
  4491     move low-values             to ws-last-suffix
  4492     display ' about to startbr ' ws-cm-key (2:19) ' '
  4493        rate-eff-date  ' ' ws-cm-key (23:11)
  4494
  4495* exec cics startbr
  4496*       dataset      ('ELCERT')
  4497*       ridfld       (ws-cm-key)
  4498*       gteq
  4499*       resp         (ws-response)
  4500*    end-exec
  4501     MOVE 'ELCERT' TO DFHEIV1
  4502     MOVE 0
  4503       TO DFHEIV11
  4504*    MOVE '&,         G          &  N#00004378' TO DFHEIV0
  4505     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4506     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4507     MOVE X'204E233030303034333738' TO DFHEIV0(25:11)
  4508     CALL 'kxdfhei1' USING DFHEIV0,
  4509           DFHEIV1,
  4510           ws-cm-key,
  4511           DFHEIV99,
  4512           DFHEIV11,
  4513           DFHEIV99
  4514     MOVE EIBRESP  TO ws-response
  4515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4516     evaluate true
  4517        when resp-normal
  4518           set browse-started to true
  4519        when resp-notfnd or resp-endfile
  4520           set i-say-stop to true
  4521        when other
  4522           move ws-response to ws-disp-resp
  4523           string
  4524              '9999' ';'
  4525              'Bad elcert startbr ' ';'
  4526              ws-disp-resp delimited by size
  4527                                 into ws-return-string
  4528           end-string
  4529           display ' something went wrong with start br '
  4530              ws-response
  4531        perform 0200-send-buffer thru 0200-exit
  4532        go to 0300-close-socket
  4533     end-evaluate
  4534     perform until i-say-stop
  4535
  4536* exec cics readnext
  4537*          dataset      ('ELCERT')
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  80
* SOCK07.cbl
  4538*          ridfld       (ws-cm-key)
  4539*          into         (certificate-master)
  4540*          resp         (ws-response)
  4541*       end-exec
  4542     MOVE LENGTH OF
  4543      certificate-master
  4544       TO DFHEIV12
  4545     MOVE 'ELCERT' TO DFHEIV1
  4546     MOVE 0
  4547       TO DFHEIV11
  4548*    MOVE '&.IL                  )  N#00004403' TO DFHEIV0
  4549     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4550     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4551     MOVE X'204E233030303034343033' TO DFHEIV0(25:11)
  4552     CALL 'kxdfhei1' USING DFHEIV0,
  4553           DFHEIV1,
  4554           certificate-master,
  4555           DFHEIV12,
  4556           ws-cm-key,
  4557           DFHEIV99,
  4558           DFHEIV11,
  4559           DFHEIV99,
  4560           DFHEIV99
  4561     MOVE EIBRESP  TO ws-response
  4562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4563        if resp-normal
  4564           if ws-cm-key (1:32) = ws-cm-compare-key (1:32)
  4565              move ws-cm-cert-suffix
  4566                                 to ws-last-suffix
  4567           else
  4568              set i-say-stop to true
  4569           end-if
  4570        else
  4571           set i-say-stop to true
  4572        end-if
  4573     end-perform
  4574     if browse-started
  4575
  4576* exec cics endbr
  4577*          dataset   ('ELCERT')
  4578*       END-EXEC
  4579     MOVE 'ELCERT' TO DFHEIV1
  4580     MOVE 0
  4581       TO DFHEIV11
  4582*    MOVE '&2                    $   #00004421' TO DFHEIV0
  4583     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4584     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4585     MOVE X'2020233030303034343231' TO DFHEIV0(25:11)
  4586     CALL 'kxdfhei1' USING DFHEIV0,
  4587           DFHEIV1,
  4588           DFHEIV11,
  4589           DFHEIV99
  4590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4591     end-if
  4592     if ws-last-suffix not = low-values
  4593        perform varying x1 from +1 by +1 until
  4594           (x1 > +26)
  4595           or (ws-last-suffix = ws-suffix-value (x1))
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  81
* SOCK07.cbl
  4596        end-perform
  4597        if x1 < +27
  4598           move ws-suffix-value (x1 + 1)
  4599                                 to ws-contract-suffix
  4600        else
  4601           MOVE 'BLEW SUFFIX TABLE ' to ws-return-string
  4602           display ' more than 26 suffix codes ' ws-last-suffix
  4603           perform 0200-send-buffer thru 0200-exit
  4604           go to 0300-close-socket
  4605        end-if
  4606     end-if
  4607     .
  4608 0060-exit.
  4609     exit.
  4610 0070-open-cursor.
  4611*    display ' declare cursor ' ws-begin-dt ' ' ws-end-dt
  4612***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  4613***                                                            ***
  4614***  The dates on the sql table have values in the time        ***
  4615***  so I convert it to a string and just use mm/dd/yyyy       ***
  4616***  to perform the comparison.                                ***
  4617***                                                            ***
  4618***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  4619     if not connected-to-db
  4620        perform 6000-connect-to-db thru 6000-exit
  4621     end-if
  4622     move rate-state             to ws-dealer-state
  4623     move rate-acct-no           to ws-dealer-id
  4624     move rate-eff-date          to ws-contract-eff-dt
  4625     move zeros                  to ws-ks-contract-no
  4626     move rate-vin (12:6)        to ws-ks-contract-no (5:6)
  4627     EXEC SQL
  4628        DECLARE
  4629           contracts cursor for
  4630        SELECT
  4631           DlrState,
  4632           DlrId,
  4633           EffDt,
  4634           ContractNo,
  4635           ContractSuffix
  4636        FROM
  4637           PendingContracts
  4638        WHERE
  4639           DlrState     = :ws-dealer-state
  4640           and DlrId    = :ws-dealer-id
  4641           and EffDt    = :ws-contract-eff-dt
  4642           and ContractNo  = :ws-ks-contract-no
  4643        ORDER BY
  4644           dlrstate,
  4645           dlrid,
  4646           effdt,
  4647           contractno,
  4648           contractsuffix
  4649     end-exec
  4650     if sqlcode not = 0
  4651        display "Error: cannot declare cursor "
  4652        display ' sql retrun code ' sqlcode
  4653        display ' sql err mess    ' sqlerrmc
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  82
* SOCK07.cbl
  4654        go to 0070-exit
  4655     end-if
  4656     EXEC SQL
  4657        open contracts
  4658     END-EXEC
  4659     if sqlcode not = 0
  4660        display "Error: cannot open cursor "
  4661        display ' sql retrun code ' sqlcode
  4662        display ' sql err mess    ' sqlerrmc
  4663        go to 0070-exit
  4664     end-if
  4665     .
  4666 0070-exit.
  4667     exit.
  4668 0080-process-input.
  4669     perform until sqlcode not = 0
  4670        EXEC SQL
  4671           fetch contracts into
  4672              :sql-dlr-state,
  4673              :sql-dlr-id,
  4674              :sql-eff-dt,
  4675              :sql-contr-no,
  4676              :sql-contr-suffix
  4677        END-EXEC
  4678        if sqlcode = 0
  4679           display ' got a hit ' sql-contr-no ' '
  4680              sql-contr-suffix
  4681           move sql-contr-suffix to ws-tbl-last-suffix
  4682        else
  4683           if sqlcode not = 0 and 100
  4684              display "Error: cannot fetch row "
  4685              display ' sql return code ' sqlcode
  4686              display ' sql err mess    ' sqlerrmc
  4687           end-if
  4688        end-if
  4689     end-perform
  4690     if ws-tbl-last-suffix = low-values
  4691        display ' tbl last suffix = LV '
  4692     else
  4693        if ws-tbl-last-suffix = spaces
  4694           display ' tbl last suffix = SPACES '
  4695        else
  4696           display ' tbl last suffix = ' ws-tbl-last-suffix
  4697        end-if
  4698     end-if
  4699     if ws-last-suffix = low-values
  4700        display ' last suffix = LV '
  4701     else
  4702        if ws-last-suffix = spaces
  4703           display ' last suffix = SPACES '
  4704        else
  4705           display ' last suffix = ' ws-last-suffix
  4706        end-if
  4707     end-if
  4708     if sqlcode = 100
  4709        display ' Normal end of record set '
  4710     end-if
  4711     if ws-tbl-last-suffix not = low-values
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  83
* SOCK07.cbl
  4712        and (ws-tbl-last-suffix > ws-last-suffix)
  4713        perform varying x1 from +1 by +1 until
  4714           (x1 > +26)
  4715           or (ws-tbl-last-suffix = ws-suffix-value (x1))
  4716        end-perform
  4717        if x1 < +27
  4718           move ws-suffix-value (x1 + 1)
  4719                                 to ws-contract-suffix
  4720        else
  4721           MOVE 'BLEW SUFFIX TABLE ' to ws-return-string
  4722           display ' more than 26 suffix codes ' ws-last-suffix
  4723           perform 0200-send-buffer thru 0200-exit
  4724           go to 0300-close-socket
  4725        end-if
  4726     end-if
  4727     EXEC SQL
  4728         close contracts
  4729     END-EXEC
  4730     if sqlcode not = 0
  4731        display "Error: cannot close cursor "
  4732        display ' sql retrun code ' sqlcode
  4733        display ' sql err mess    ' sqlerrmc
  4734     end-if
  4735     .
  4736 0080-exit.
  4737     exit.
  4738 0100-process-socket.
  4739     perform 0010-receive        thru 0010-exit
  4740     if end-of-socket
  4741        go to 0100-exit
  4742     end-if
  4743     perform 0020-edit-received  thru 0020-exit
  4744     perform 0025-assign-ben-cd  thru 0025-exit
  4745     perform 0030-get-rate       thru 0030-exit
  4746     if (contract-no-assigned)
  4747            or
  4748        (error-in-one-coverage)
  4749        continue
  4750     else
  4751        perform 0060-check-for-dup
  4752                                 thru 0060-exit
  4753        perform 0070-open-cursor thru 0070-exit
  4754        perform 0080-process-input
  4755                                 thru 0080-exit
  4756     end-if
  4757     perform 0040-format-buffer  thru 0040-exit
  4758     perform 0200-send-buffer    thru 0200-exit
  4759     set contract-no-assigned to true
  4760     .
  4761 0100-exit.
  4762     exit.
  4763 0170-PROCESS-BEN-CODE.
  4764     MOVE SPACES                 TO WS-CF-KEY
  4765     MOVE 'CID'                  TO WS-CF-COMPANY-ID
  4766     MOVE '5'                    TO WS-CF-RECORD-TYPE
  4767     MOVE ws-rate-benefit-cd     TO WS-CF-ACCESS (3:2)
  4768     MOVE +0                     TO WS-CF-SEQ-NO
  4769     MOVE WS-CF-KEY              TO WS-CF-KEY-SAVE
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  84
* SOCK07.cbl
  4770
  4771* EXEC CICS READ
  4772*         DATASET    ('ELCNTL')
  4773*         RIDFLD     (WS-CF-KEY)
  4774*         INTO       (CONTROL-FILE)
  4775*         GTEQ
  4776*         RESP       (WS-RESPONSE)
  4777*    END-EXEC
  4778     MOVE LENGTH OF
  4779      CONTROL-FILE
  4780       TO DFHEIV11
  4781     MOVE 'ELCNTL' TO DFHEIV1
  4782*    MOVE '&"IL       G          (  N#00004603' TO DFHEIV0
  4783     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4784     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4785     MOVE X'204E233030303034363033' TO DFHEIV0(25:11)
  4786     CALL 'kxdfhei1' USING DFHEIV0,
  4787           DFHEIV1,
  4788           CONTROL-FILE,
  4789           DFHEIV11,
  4790           WS-CF-KEY,
  4791           DFHEIV99,
  4792           DFHEIV99,
  4793           DFHEIV99
  4794     MOVE EIBRESP  TO WS-RESPONSE
  4795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4796     IF NOT RESP-NORMAL
  4797        MOVE WS-RESPONSE         TO WS-DISP-RESP
  4798        DISPLAY ' ERROR - ELCNTL - READ ' WS-DISP-RESP
  4799        GO TO 0170-EXIT
  4800     END-IF
  4801     IF WS-CF-KEY (1:4) = WS-CF-KEY-SAVE (1:4)
  4802        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  4803           (S2 > +8)
  4804           OR (ws-rate-BENefit-CD = CF-BENEFIT-CODE (S2))
  4805        END-PERFORM
  4806     END-IF
  4807     .
  4808 0170-EXIT.
  4809     EXIT.
  4810 0200-send-buffer.
  4811     move ws-return-string       to ws-send-buf
  4812     display 'SOCK07:About to send      ' ws-send-buf
  4813     display 'SOCK07:sequence number  =', ws-seq-num.
  4814     display ' msg size ' ws-send-msg-size
  4815     call "send" using by value GIVE-TAKE-SOCKET,
  4816         by reference ws-send-buf,
  4817         by value ws-send-msg-size,
  4818         by value ws-flags.
  4819     if return-code <= zero
  4820        display 'SOCK07:send error ',
  4821        perform 0250-socket-error thru 0250-exit
  4822        go to 0300-close-socket
  4823     end-if
  4824     .
  4825 0200-exit.
  4826     exit.
  4827 0250-socket-error.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  85
* SOCK07.cbl
  4828     display "SOCK07:did not complete"
  4829     display 'SOCK07:transaction data =', CLIENT-IN-DATA '**'
  4830     display 'SOCK07:socket number    =', GIVE-TAKE-SOCKET.
  4831     display 'SOCK07:socket name      =', lstn-name ' '
  4832        lstn-subname
  4833     display ' return code = ' return-code
  4834     .
  4835 0250-exit.
  4836     exit.
  4837 0300-close-socket.
  4838*    call "close" using by value GIVE-TAKE-SOCKET .
  4839     display 'SOCK07:done'
  4840
  4841* exec cics return end-exec.
  4842*    MOVE '.(                    ''   #00004654' TO DFHEIV0
  4843     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4844     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4845     MOVE X'2020233030303034363534' TO DFHEIV0(25:11)
  4846     CALL 'kxdfhei1' USING DFHEIV0,
  4847           DFHEIV99,
  4848           DFHEIV99,
  4849           DFHEIV99,
  4850           DFHEIV99,
  4851           DFHEIV99,
  4852           DFHEIV99
  4853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4854
  4855
  4856* goback.
  4857     MOVE '9%                    "   ' TO DFHEIV0
  4858     MOVE 'SOCK07' TO DFHEIV1
  4859     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4860     goback.
  4861     .
  4862 0300-exit.
  4863     exit.
  4864 6000-CONNECT-TO-DB.
  4865***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  4866***                                                            ***
  4867***                                                            ***
  4868***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  4869     MOVE 'NTSQLTST2_CrtManage'  TO SVR
  4870     move 'sa'                   to usr
  4871     move 'sql2008r2'            to pass
  4872     if ws-kix-myenv = 'cid1p'
  4873        MOVE 'NTCSO2_CrtManage'  TO SVR
  4874        move 'sa'                to usr
  4875        move 'ntcso2'            to pass
  4876     end-if
  4877     string
  4878         usr delimited space
  4879         "." delimited size
  4880         pass delimited space into usr-pass
  4881     end-string
  4882     display ' About to connect to ' svr ' ' usr-pass
  4883     EXEC SQL
  4884        CONNECT TO :svr USER :usr-pass
  4885     END-EXEC
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  86
* SOCK07.cbl
  4886     if sqlcode not = 0
  4887        display "Error: cannot connect to " svr
  4888        display sqlcode
  4889        display sqlerrmc
  4890     else
  4891        display ' Successful Connect ' sqlcode
  4892        set connected-to-db to true
  4893     end-if
  4894     .
  4895 6000-EXIT.
  4896     EXIT.
  4897 7000-GET-RATE.
  4898
  4899* EXEC CICS LINK
  4900*       PROGRAM ('ELRATE')
  4901*       COMMAREA (CALCULATION-PASS-AREA)
  4902*       LENGTH   (CP-COMM-LENGTH)
  4903*    END-EXEC
  4904     MOVE 'ELRATE' TO DFHEIV1
  4905*    MOVE '."C                   (   #00004693' TO DFHEIV0
  4906     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4907     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4908     MOVE X'2020233030303034363933' TO DFHEIV0(25:11)
  4909     CALL 'kxdfhei1' USING DFHEIV0,
  4910           DFHEIV1,
  4911           CALCULATION-PASS-AREA,
  4912           CP-COMM-LENGTH,
  4913           DFHEIV99,
  4914           DFHEIV99,
  4915           DFHEIV99,
  4916           DFHEIV99
  4917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4918     .
  4919 7000-EXIT.
  4920     EXIT.
  4921 8000-code-storage.
  4922*     move am-company-cd          to ws-cm5-company-cd
  4923*
  4924*     move spaces                 to ws-cm5-cert-no
  4925*     string
  4926*        '0000'
  4927*        rate-vin (12:6)
  4928*        ' ' delimited by size into ws-cm5-cert-no
  4929*     end-string
  4930*     move ws-cm5-key to ws-cm5-compare-key
  4931*     display ' about to startbr **' ws-cm5-cert-no '**'
  4932*     exec cics startbr
  4933*        dataset      ('ELCERT5')
  4934*        ridfld       (ws-cm5-key)
  4935*        equal
  4936*        resp         (ws-response)
  4937*     end-exec
  4938*     move ' ' to ws-stop-sw
  4939*
  4940*     if resp-normal or resp-dupkey
  4941*        perform until i-say-stop
  4942*           exec cics readnext
  4943*              dataset      ('ELCERT5')
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  87
* SOCK07.cbl
  4944*              ridfld       (ws-cm5-key)
  4945*              into         (certificate-master)
  4946*              resp         (ws-response)
  4947*           end-exec
  4948*           if (resp-normal or resp-dupkey)
  4949*              and (ws-cm5-key = ws-cm5-compare-key)
  4950*              display ' found cert ' cm-cert-no ' ' cm-state
  4951*                 ' ' cm-account ' ' cm-insured-last-name
  4952*              move cm-control-primary  to ws-cs-key
  4953*              move 'C'                 to ws-cs-trlr-type
  4954*              exec cics read
  4955*                 dataset      ('ELCRTT')
  4956*                 ridfld       (ws-cs-key)
  4957*                 into         (certificate-trailers)
  4958*                 resp         (ws-response)
  4959*              end-exec
  4960*              if resp-normal
  4961*                 if rate-vin = cs-vin-number
  4962*                    move 'Y'           to cp-return-code
  4963*                    set i-say-stop to true
  4964*                 end-if
  4965*              end-if
  4966*           else
  4967*              set i-say-stop to true
  4968*           end-if
  4969*        end-perform
  4970*        exec cics endbr
  4971*           dataset ('ELCERT5')
  4972*        end-exec
  4973*     else
  4974*        display ' bad resp on startbr ' ws-response
  4975*     end-if
  4976*
  4977*     if resp-normal
  4978*        move cm-control-primary  to ws-cs-key
  4979*        move 'C'                 to ws-cs-trlr-type
  4980*        exec cics read
  4981*           dataset      ('ELCRTT')
  4982*           ridfld       (ws-cs-key)
  4983*           into         (certificate-trailers)
  4984*           resp         (ws-response)
  4985*        end-exec
  4986*        if resp-normal
  4987*           if rate-vin = cs-vin-number
  4988*              move 'Y'           to cp-return-code
  4989*           end-if
  4990*        end-if
  4991*     end-if
  4992     .
  4993 8000-exit.
  4994     exit.
  4995 9700-DATE-LINK.
  4996
  4997* EXEC CICS LINK
  4998*         PROGRAM  ('ELDATCV')
  4999*         COMMAREA (DATE-CONVERSION-DATA)
  5000*         LENGTH   (DC-COMM-LENGTH)
  5001*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-May-17 13:04 Page  88
* SOCK07.cbl
  5002     MOVE 'ELDATCV' TO DFHEIV1
  5003*    MOVE '."C                   (   #00004776' TO DFHEIV0
  5004     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5005     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5006     MOVE X'2020233030303034373736' TO DFHEIV0(25:11)
  5007     CALL 'kxdfhei1' USING DFHEIV0,
  5008           DFHEIV1,
  5009           DATE-CONVERSION-DATA,
  5010           DC-COMM-LENGTH,
  5011           DFHEIV99,
  5012           DFHEIV99,
  5013           DFHEIV99,
  5014           DFHEIV99
  5015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5016
  5017 9700-EXIT.
  5018      EXIT.
  5019
  5020 9999-DFHBACK SECTION.
  5021     MOVE '9%                    "   ' TO DFHEIV0
  5022     MOVE 'SOCK07' TO DFHEIV1
  5023     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5024     GOBACK.
  5025 9999-DFHEXIT.
  5026     IF DFHEIGDJ EQUAL 0001
  5027         NEXT SENTENCE.
  5028     MOVE '9%                    "   ' TO DFHEIV0
  5029     MOVE 'SOCK07' TO DFHEIV1
  5030     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5031     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      143836     Code:       11080
