* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL112.cbl
* Options: int("EL112.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL112.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL112.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL112.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL112 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:48:50.
     7*                            VMOD=2.004.
     8*
     9*
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL112.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS. TRANSACTION EX37 - PROGRAM FILE MAINTENANCE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL112.cbl
    27 ENVIRONMENT DIVISION.
    28 DATA DIVISION.
    29 WORKING-STORAGE SECTION.
    30 01  DFH-START PIC X(04).
    31 01  LCP-TIME-OF-DAY-XX.
    32     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    33     05  FILLER                    PIC 99.
    34 01  LCP-CICS-TIME                 PIC 9(15).
    35
    36 77  FILLER  PIC X(32)  VALUE '********************************'.
    37 77  FILLER  PIC X(32)  VALUE '*    EL112 WORKING STORAGE     *'.
    38 77  FILLER  PIC X(32)  VALUE '*********** VMOD 2.004 *********'.
    39
    40 01  WS-DATE-AREA.
    41     05  SAVE-DATE               PIC X(8)    VALUE SPACES.
    42     05  SAVE-BIN-DATE           PIC X(2)    VALUE SPACES.
    43
    44 01  LITERALS-NUMBERS.
    45     12  XCTL-EL126              PIC X(5)    VALUE 'EL126'.
    46     12  XCTL-EL626              PIC X(5)    VALUE 'EL626'.
    47     12  XCTL-EM626              PIC X(5)    VALUE 'EM626'.
    48     12  XCTL-GL800              PIC X(8)    VALUE 'GL800'.
    49     12  LIT-A                   PIC X       VALUE 'A'.
    50     12  LIT-B                   PIC X       VALUE 'B'.
    51     12  LIT-C                   PIC X       VALUE 'C'.
    52     12  LIT-D                   PIC X       VALUE 'D'.
    53     12  LIT-E                   PIC X       VALUE 'E'.
    54     12  LIT-F                   PIC X       VALUE 'F'.
    55     12  LIT-S                   PIC X       VALUE 'S'.
    56     12  LIT-X                   PIC X       VALUE 'X'.
    57     12  LIT-PN                  PIC XX      VALUE 'PN'.
    58     12  LIT-CLAIM               PIC XX      VALUE 'EL'.
    59     12  LIT-GL                  PIC XX      VALUE 'GL'.
    60     12  LIT-MORTG               PIC XX      VALUE 'EM'.
    61     12  LIT-LF                  PIC XX      VALUE 'LF'.
    62     12  LIT-EC                  PIC XX      VALUE 'EC'.
    63     12  LIT-WA                  PIC XX      VALUE 'WA'.
    64     12  LIT-FILE                PIC X(8)    VALUE 'ELPGMN'.
    65     12  LIT-PROG                PIC X(8)    VALUE 'EL112'.
    66     12  SCREEN-NUMBER           PIC X(4)    VALUE '112A'.
    67     12  LIT-SYS                 PIC X(4)    VALUE 'SYS'.
    68     12  LIT-CICS                PIC X(4)    VALUE 'CICS'.
    69     12  LIT-MENU                PIC X(4)    VALUE 'MENU'.
    70     12  LIT-BATCH               PIC X(5)    VALUE 'BATCH'.
    71     12  LIT-SPACE               PIC X(5)    VALUE SPACE.
    72     12  LIT-TRANS               PIC X(4)    VALUE 'EX37'.
    73     12  CALL-PROG               PIC X(8)    VALUE 'EL119'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL112.cbl
    75 01  COUNT-FIELDS.
    76     12  COUNT-1                 PIC 99.
    77     12  COUNT-2                 PIC 99.
    78     12  COUNT-3                 PIC 99.
    79
    80 01  EDIT-WORK-AREA.
    81     12  CHECK-MAINT             PIC X.
    82         88  SHOW-OPTION                     VALUE 'S'.
    83         88  ADD-OPTION                      VALUE 'A'.
    84         88  CHANGE-OPTION                   VALUE 'C'.
    85         88  DELETE-OPTION                   VALUE 'D'.
    86         88  VALID-OPTION                  VALUE 'A' 'C' 'D' 'S'.
    87     12  CHECK-CALL              PIC X.
    88         88  CICS-CALL                       VALUE 'C'.
    89         88  MENU-CALL                       VALUE 'M'.
    90         88  BATCH-PROG                      VALUE 'B'.
    91         88  VALID-CALL                      VALUE 'M' 'C' 'B'.
    92     12  CHECK-PFKEYS            PIC 99.
    93     12  SCREEN-SWITCH           PIC X.
    94         88  END-OF-FILE                     VALUE 'E'.
    95         88  SCREEN-FULL                     VALUE 'F'.
    96         88  SCREEN-ERROR                    VALUE 'X'.
    97     12  BROWSE-KEY.
    98         16  PGM-PREF            PIC XX.
    99         16  FILLER              PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL112.cbl
   101 01  DISPLAY-LINE.
   102     12  FILLER                  PIC X.
   103     12  PGM-NO                  PIC X(5).
   104     12  FILLER                  PIC X(5).
   105     12  PGM-DESC                PIC X(40).
   106     12  FILLER                  PIC X(6).
   107     12  PGM-TRANS               PIC X(4).
   108     12  FILLER                  PIC X(7).
   109     12  PGM-CALLED              PIC X(5).
   110
   111 01  TIME-UNFORMATTED.
   112     12  UN-HOURS                PIC XX.
   113     12  UN-MINUTES              PIC XX.
   114     12  FILLER                  PIC X(4).
   115
   116 01  TIME-FORMATTED.
   117     12  FOR-HOURS               PIC XX.
   118     12  FILLER                  PIC X       VALUE '.'.
   119     12  FOR-MINUTES             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL112.cbl
   121 01  ERROR-MESSAGES.
   122     12  MAINT-MIS.
   123         16  FILLER              PIC X(39)
   124             VALUE 'MAINTENANCE FUNCTION INVALID OR UNAUTHO'.
   125         16  FILLER              PIC X(18)
   126             VALUE 'RIZED             '.
   127
   128     12  PGM-MIS.
   129         16  FILLER              PIC X(33)
   130             VALUE 'PROGRAM NUMBER MISSING OR INVALID'.
   131         16  FILLER              PIC X(18)
   132             VALUE ' - PLEASE RE-ENTER'.
   133
   134     12  PGM-DUP                 PIC X(42)
   135         VALUE 'PROGRAM NUMBER DUPLICATE - PLEASE RE-ENTER'.
   136
   137     12  DESC-MIS.
   138         16  FILLER              PIC X(38)
   139             VALUE 'PROGRAM DESCRIPTION MISSING OR INVALID'.
   140         16  FILLER              PIC X(18)
   141             VALUE ' - PLEASE RE-ENTER'.
   142     12  TRANS-MIS               PIC X(45)
   143         VALUE 'TRANSACTION MISSING OR INVALID - PLEASE ENTER'.
   144
   145     12  CALL-MIS.
   146         16  FILLER              PIC X(32)
   147             VALUE 'CALLABLE CODE MISSING OR INVALID'.
   148         16  FILLER              PIC X(18)
   149             VALUE ' - PLEASE RE-ENTER'.
   150     12  INVALID-PFKEY           PIC X(45)
   151         VALUE 'INVALID PF-OPTION REQUESTED - PLEASE RE-ENTER'.
   152
   153     12  END-MSG                 PIC X(11)
   154         VALUE 'END OF FILE'.
   155
   156     12  END-UPDATE              PIC X(16)
   157         VALUE 'UPDATE COMPLETED'.
   158
   159     12  SCREEN-TERM             PIC X(42)
   160           VALUE '     CLAS-IC PROGRAM MAINTENANCE COMPLETED'.
   161
   162     12  FILE-MSG                PIC X(25)
   163           VALUE '     FILE ELPGMN NOT OPEN'.
   164
   165 01  COMP-LENGTHS.
   166     12  LIT-IC                  PIC S9(4)  COMP VALUE -1.
   167     12  FILE-LENGTH             PIC S9(4)  COMP VALUE +25.
   168     12  TERM-LENGTH             PIC S9(4)  COMP VALUE +41.
   169     12  PGMN-LENGTH             PIC S9(4)  COMP VALUE +52.
   170     12  JOURNAL-LENGTH          PIC S9(4)  COMP VALUE +75.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL112.cbl
   172*    COPY ELCDATE.
   173******************************************************************
   174*                                                                *
   175*                                                                *
   176*                            ELCDATE.                            *
   177*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   178*                            VMOD=2.003
   179*                                                                *
   180*                                                                *
   181*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   182*                 LENGTH = 200                                   *
   183******************************************************************
   184
   185 01  DATE-CONVERSION-DATA.
   186     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   187     12  DC-OPTION-CODE                PIC X.
   188         88  BIN-TO-GREG                VALUE ' '.
   189         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   190         88  EDIT-GREG-TO-BIN           VALUE '2'.
   191         88  YMD-GREG-TO-BIN            VALUE '3'.
   192         88  MDY-GREG-TO-BIN            VALUE '4'.
   193         88  JULIAN-TO-BIN              VALUE '5'.
   194         88  BIN-PLUS-ELAPSED           VALUE '6'.
   195         88  FIND-CENTURY               VALUE '7'.
   196         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   197         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   198         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   199         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   200         88  JULIAN-TO-BIN-3            VALUE 'C'.
   201         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   202         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   203         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   204         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   205         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   206         88  CHECK-LEAP-YEAR            VALUE 'H'.
   207         88  BIN-3-TO-GREG              VALUE 'I'.
   208         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   209         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   210         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   211         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   212         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   213         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   214         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   215         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   216         88  THREE-CHARACTER-BIN
   217                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   218         88  GREGORIAN-TO-BIN
   219                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   220         88  BIN-TO-GREGORIAN
   221                  VALUES ' ' '1' 'I' '8' 'G'.
   222         88  JULIAN-TO-BINARY
   223                  VALUES '5' 'C' 'E' 'F'.
   224     12  DC-ERROR-CODE                 PIC X.
   225         88  NO-CONVERSION-ERROR        VALUE ' '.
   226         88  DATE-CONVERSION-ERROR
   227                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   228         88  DATE-IS-ZERO               VALUE '1'.
   229         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL112.cbl
   230         88  DATE-IS-INVALID            VALUE '3'.
   231         88  DATE1-GREATER-DATE2        VALUE '4'.
   232         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   233         88  DATE-INVALID-OPTION        VALUE '9'.
   234         88  INVALID-CENTURY            VALUE 'A'.
   235         88  ONLY-CENTURY               VALUE 'B'.
   236         88  ONLY-LEAP-YEAR             VALUE 'C'.
   237         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   238     12  DC-END-OF-MONTH               PIC X.
   239         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   240     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   241         88  USE-NORMAL-PROCESS         VALUE ' '.
   242         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   243         88  ADJUST-UP-100-YRS          VALUE '2'.
   244     12  FILLER                        PIC X.
   245     12  DC-CONVERSION-DATES.
   246         16  DC-BIN-DATE-1             PIC XX.
   247         16  DC-BIN-DATE-2             PIC XX.
   248         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   249         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   250                       DC-GREG-DATE-1-EDIT.
   251             20  DC-EDIT1-MONTH        PIC 99.
   252             20  SLASH1-1              PIC X.
   253             20  DC-EDIT1-DAY          PIC 99.
   254             20  SLASH1-2              PIC X.
   255             20  DC-EDIT1-YEAR         PIC 99.
   256         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   257         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   258                     DC-GREG-DATE-2-EDIT.
   259             20  DC-EDIT2-MONTH        PIC 99.
   260             20  SLASH2-1              PIC X.
   261             20  DC-EDIT2-DAY          PIC 99.
   262             20  SLASH2-2              PIC X.
   263             20  DC-EDIT2-YEAR         PIC 99.
   264         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   265         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   266                     DC-GREG-DATE-1-YMD.
   267             20  DC-YMD-YEAR           PIC 99.
   268             20  DC-YMD-MONTH          PIC 99.
   269             20  DC-YMD-DAY            PIC 99.
   270         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   271         16  DC-GREG-DATE-1-MDY-R REDEFINES
   272                      DC-GREG-DATE-1-MDY.
   273             20  DC-MDY-MONTH          PIC 99.
   274             20  DC-MDY-DAY            PIC 99.
   275             20  DC-MDY-YEAR           PIC 99.
   276         16  DC-GREG-DATE-1-ALPHA.
   277             20  DC-ALPHA-MONTH        PIC X(10).
   278             20  DC-ALPHA-DAY          PIC 99.
   279             20  FILLER                PIC XX.
   280             20  DC-ALPHA-CENTURY.
   281                 24 DC-ALPHA-CEN-N     PIC 99.
   282             20  DC-ALPHA-YEAR         PIC 99.
   283         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   284         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   285         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   286         16  DC-JULIAN-DATE            PIC 9(05).
   287         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL112.cbl
   288                                       PIC 9(05).
   289         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   290             20  DC-JULIAN-YEAR        PIC 99.
   291             20  DC-JULIAN-DAYS        PIC 999.
   292         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   293         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   294         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   295     12  DATE-CONVERSION-VARIBLES.
   296         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   297         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   298             20  FILLER                PIC 9(3).
   299             20  HOLD-CEN-1-CCYY.
   300                 24  HOLD-CEN-1-CC     PIC 99.
   301                 24  HOLD-CEN-1-YY     PIC 99.
   302             20  HOLD-CEN-1-MO         PIC 99.
   303             20  HOLD-CEN-1-DA         PIC 99.
   304         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   305             20  HOLD-CEN-1-R-MO       PIC 99.
   306             20  HOLD-CEN-1-R-DA       PIC 99.
   307             20  HOLD-CEN-1-R-CCYY.
   308                 24  HOLD-CEN-1-R-CC   PIC 99.
   309                 24  HOLD-CEN-1-R-YY   PIC 99.
   310             20  FILLER                PIC 9(3).
   311         16  HOLD-CENTURY-1-X.
   312             20  FILLER                PIC X(3)  VALUE SPACES.
   313             20  HOLD-CEN-1-X-CCYY.
   314                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   315                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   316             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   317             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   318         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   319             20  HOLD-CEN-1-R-X-MO     PIC XX.
   320             20  HOLD-CEN-1-R-X-DA     PIC XX.
   321             20  HOLD-CEN-1-R-X-CCYY.
   322                 24  HOLD-CEN-1-R-X-CC PIC XX.
   323                 24  HOLD-CEN-1-R-X-YY PIC XX.
   324             20  FILLER                PIC XXX.
   325         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   326         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   327         16  DC-JULIAN-DATE-1          PIC 9(07).
   328         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   329             20  DC-JULIAN-1-CCYY.
   330                 24  DC-JULIAN-1-CC    PIC 99.
   331                 24  DC-JULIAN-1-YR    PIC 99.
   332             20  DC-JULIAN-DA-1        PIC 999.
   333         16  DC-JULIAN-DATE-2          PIC 9(07).
   334         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   335             20  DC-JULIAN-2-CCYY.
   336                 24  DC-JULIAN-2-CC    PIC 99.
   337                 24  DC-JULIAN-2-YR    PIC 99.
   338             20  DC-JULIAN-DA-2        PIC 999.
   339         16  DC-GREG-DATE-A-EDIT.
   340             20  DC-EDITA-MONTH        PIC 99.
   341             20  SLASHA-1              PIC X VALUE '/'.
   342             20  DC-EDITA-DAY          PIC 99.
   343             20  SLASHA-2              PIC X VALUE '/'.
   344             20  DC-EDITA-CCYY.
   345                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL112.cbl
   346                 24  DC-EDITA-YEAR     PIC 99.
   347         16  DC-GREG-DATE-B-EDIT.
   348             20  DC-EDITB-MONTH        PIC 99.
   349             20  SLASHB-1              PIC X VALUE '/'.
   350             20  DC-EDITB-DAY          PIC 99.
   351             20  SLASHB-2              PIC X VALUE '/'.
   352             20  DC-EDITB-CCYY.
   353                 24  DC-EDITB-CENT     PIC 99.
   354                 24  DC-EDITB-YEAR     PIC 99.
   355         16  DC-GREG-DATE-CYMD         PIC 9(08).
   356         16  DC-GREG-DATE-CYMD-R REDEFINES
   357                              DC-GREG-DATE-CYMD.
   358             20  DC-CYMD-CEN           PIC 99.
   359             20  DC-CYMD-YEAR          PIC 99.
   360             20  DC-CYMD-MONTH         PIC 99.
   361             20  DC-CYMD-DAY           PIC 99.
   362         16  DC-GREG-DATE-MDCY         PIC 9(08).
   363         16  DC-GREG-DATE-MDCY-R REDEFINES
   364                              DC-GREG-DATE-MDCY.
   365             20  DC-MDCY-MONTH         PIC 99.
   366             20  DC-MDCY-DAY           PIC 99.
   367             20  DC-MDCY-CEN           PIC 99.
   368             20  DC-MDCY-YEAR          PIC 99.
   369    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   370        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   371    12  DC-EL310-DATE                  PIC X(21).
   372    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL112.cbl
   374*    COPY ELCATTR.
   375******************************************************************
   376*                                                                *
   377*                            ELCATTR.                            *
   378*                            VMOD=2.001                          *
   379*                                                                *
   380*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   381*                                                                *
   382*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   383*                                                                *
   384*                   POS 1   P=PROTECTED                          *
   385*                           U=UNPROTECTED                        *
   386*                           S=ASKIP                              *
   387*                   POS 2   A=ALPHA/NUMERIC                      *
   388*                           N=NUMERIC                            *
   389*                   POS 3   N=NORMAL                             *
   390*                           B=BRIGHT                             *
   391*                           D=DARK                               *
   392*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   393*                           OF=MODIFIED DATA TAG OFF             *
   394*                                                                *
   395*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   396******************************************************************
   397 01  ATTRIBUTE-LIST.
   398     12  AL-PABOF            PIC X       VALUE 'Y'.
   399     12  AL-PABON            PIC X       VALUE 'Z'.
   400     12  AL-PADOF            PIC X       VALUE '%'.
   401     12  AL-PADON            PIC X       VALUE '_'.
   402     12  AL-PANOF            PIC X       VALUE '-'.
   403     12  AL-PANON            PIC X       VALUE '/'.
   404     12  AL-SABOF            PIC X       VALUE '8'.
   405     12  AL-SABON            PIC X       VALUE '9'.
   406     12  AL-SADOF            PIC X       VALUE '@'.
   407     12  AL-SADON            PIC X       VALUE QUOTE.
   408     12  AL-SANOF            PIC X       VALUE '0'.
   409     12  AL-SANON            PIC X       VALUE '1'.
   410     12  AL-UABOF            PIC X       VALUE 'H'.
   411     12  AL-UABON            PIC X       VALUE 'I'.
   412     12  AL-UADOF            PIC X       VALUE '<'.
   413     12  AL-UADON            PIC X       VALUE '('.
   414     12  AL-UANOF            PIC X       VALUE ' '.
   415     12  AL-UANON            PIC X       VALUE 'A'.
   416     12  AL-UNBOF            PIC X       VALUE 'Q'.
   417     12  AL-UNBON            PIC X       VALUE 'R'.
   418     12  AL-UNDOF            PIC X       VALUE '*'.
   419     12  AL-UNDON            PIC X       VALUE ')'.
   420     12  AL-UNNOF            PIC X       VALUE '&'.
   421     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL112.cbl
   423*    COPY ELCAID.
   424******************************************************************
   425*                                                                *
   426*                            ELCAID.                             *
   427*                            VMOD=2.001                          *
   428*                                                                *
   429*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   430*                                                                *
   431*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   432*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   433******************************************************************
   434
   435 01  DFHAID.
   436   02  DFHNULL   PIC  X  VALUE  ' '.
   437   02  DFHENTER  PIC  X  VALUE  QUOTE.
   438   02  DFHCLEAR  PIC  X  VALUE  '_'.
   439   02  DFHPEN    PIC  X  VALUE  '='.
   440   02  DFHOPID   PIC  X  VALUE  'W'.
   441   02  DFHPA1    PIC  X  VALUE  '%'.
   442   02  DFHPA2    PIC  X  VALUE  '>'.
   443   02  DFHPA3    PIC  X  VALUE  ','.
   444   02  DFHPF1    PIC  X  VALUE  '1'.
   445   02  DFHPF2    PIC  X  VALUE  '2'.
   446   02  DFHPF3    PIC  X  VALUE  '3'.
   447   02  DFHPF4    PIC  X  VALUE  '4'.
   448   02  DFHPF5    PIC  X  VALUE  '5'.
   449   02  DFHPF6    PIC  X  VALUE  '6'.
   450   02  DFHPF7    PIC  X  VALUE  '7'.
   451   02  DFHPF8    PIC  X  VALUE  '8'.
   452   02  DFHPF9    PIC  X  VALUE  '9'.
   453   02  DFHPF10   PIC  X  VALUE  ':'.
   454   02  DFHPF11   PIC  X  VALUE  '#'.
   455   02  DFHPF12   PIC  X  VALUE  '@'.
   456   02  DFHPF13   PIC  X  VALUE  'A'.
   457   02  DFHPF14   PIC  X  VALUE  'B'.
   458   02  DFHPF15   PIC  X  VALUE  'C'.
   459   02  DFHPF16   PIC  X  VALUE  'D'.
   460   02  DFHPF17   PIC  X  VALUE  'E'.
   461   02  DFHPF18   PIC  X  VALUE  'F'.
   462   02  DFHPF19   PIC  X  VALUE  'G'.
   463   02  DFHPF20   PIC  X  VALUE  'H'.
   464   02  DFHPF21   PIC  X  VALUE  'I'.
   465*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   466   02  DFHPF22   PIC  X  VALUE  '['.
   467   02  DFHPF23   PIC  X  VALUE  '.'.
   468   02  DFHPF24   PIC  X  VALUE  '<'.
   469   02  DFHMSRE   PIC  X  VALUE  'X'.
   470   02  DFHSTRF   PIC  X  VALUE  'h'.
   471   02  DFHTRIG   PIC  X  VALUE  '"'.
   472 01  FILLER REDEFINES DFHAID.
   473     12  FILLER                  PIC X(8).
   474     12  AID-KEYS OCCURS 24 TIMES.
   475         16  FILLER              PIC X.
   476
   477*    COPY ELCINTF.
   478******************************************************************
   479*                                                                *
   480*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL112.cbl
   481*                            ELCINTF.                            *
   482*                            VMOD=2.017                          *
   483*                                                                *
   484*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   485*                                                                *
   486*       LENGTH = 1024                                            *
   487*                                                                *
   488******************************************************************
   489 01  PROGRAM-INTERFACE-BLOCK.
   490     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   491     12  PI-CALLING-PROGRAM              PIC X(8).
   492     12  PI-SAVED-PROGRAM-1              PIC X(8).
   493     12  PI-SAVED-PROGRAM-2              PIC X(8).
   494     12  PI-SAVED-PROGRAM-3              PIC X(8).
   495     12  PI-SAVED-PROGRAM-4              PIC X(8).
   496     12  PI-SAVED-PROGRAM-5              PIC X(8).
   497     12  PI-SAVED-PROGRAM-6              PIC X(8).
   498     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   499     12  PI-COMPANY-ID                   PIC XXX.
   500     12  PI-COMPANY-CD                   PIC X.
   501
   502     12  PI-COMPANY-PASSWORD             PIC X(8).
   503
   504     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   505
   506     12  PI-CONTROL-IN-PROGRESS.
   507         16  PI-CARRIER                  PIC X.
   508         16  PI-GROUPING                 PIC X(6).
   509         16  PI-STATE                    PIC XX.
   510         16  PI-ACCOUNT                  PIC X(10).
   511         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   512                                         PIC X(10).
   513         16  PI-CLAIM-CERT-GRP.
   514             20  PI-CLAIM-NO             PIC X(7).
   515             20  PI-CERT-NO.
   516                 25  PI-CERT-PRIME       PIC X(10).
   517                 25  PI-CERT-SFX         PIC X.
   518             20  PI-CERT-EFF-DT          PIC XX.
   519         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   520             20  PI-PLAN-CODE            PIC X(2).
   521             20  PI-REVISION-NUMBER      PIC X(3).
   522             20  PI-PLAN-EFF-DT          PIC X(2).
   523             20  PI-PLAN-EXP-DT          PIC X(2).
   524             20  FILLER                  PIC X(11).
   525         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   526             20  PI-OE-REFERENCE-1.
   527                 25  PI-OE-REF-1-PRIME   PIC X(18).
   528                 25  PI-OE-REF-1-SUFF    PIC XX.
   529
   530     12  PI-SESSION-IN-PROGRESS          PIC X.
   531         88  CLAIM-SESSION                   VALUE '1'.
   532         88  CREDIT-SESSION                  VALUE '2'.
   533         88  WARRANTY-SESSION                VALUE '3'.
   534         88  MORTGAGE-SESSION                VALUE '4'.
   535         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   536
   537
   538*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL112.cbl
   539
   540     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   541     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   542
   543     12  PI-CREDIT-USER                  PIC X.
   544         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   545         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   546
   547     12  PI-CLAIM-USER                   PIC X.
   548         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   549         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   550
   551     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   552         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   553         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   554         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   555         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   556         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   557
   558     12  PI-PROCESSOR-ID                 PIC X(4).
   559
   560     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   561
   562     12  PI-MEMBER-CAPTION               PIC X(10).
   563
   564     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   565         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   566
   567     12  PI-LIFE-OVERRIDE-L1             PIC X.
   568     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   569     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   570     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   571
   572     12  PI-AH-OVERRIDE-L1               PIC X.
   573     12  PI-AH-OVERRIDE-L2               PIC XX.
   574     12  PI-AH-OVERRIDE-L6               PIC X(6).
   575     12  PI-AH-OVERRIDE-L12              PIC X(12).
   576
   577     12  PI-NEW-SYSTEM                   PIC X(2).
   578
   579     12  PI-PRIMARY-CERT-NO              PIC X(11).
   580     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   581         88  PI-USES-PAID-TO                 VALUE '1'.
   582     12  PI-CRDTCRD-SYSTEM.
   583         16  PI-CRDTCRD-USER             PIC X.
   584             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   585             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   586         16  PI-CC-MONTH-END-DT          PIC XX.
   587     12  PI-PROCESSOR-PRINTER            PIC X(4).
   588
   589     12  PI-OE-REFERENCE-2.
   590         16  PI-OE-REF-2-PRIME           PIC X(10).
   591         16  PI-OE-REF-2-SUFF            PIC X.
   592
   593     12  PI-REM-TRM-CALC-OPTION          PIC X.
   594
   595     12  PI-LANGUAGE-TYPE                PIC X.
   596             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL112.cbl
   597             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   598             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   599
   600     12  PI-POLICY-LINKAGE-IND           PIC X.
   601         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   602         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   603                                                   LOW-VALUES.
   604
   605     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   606     12  PI-CLAIM-PW-SESSION             PIC X(1).
   607         88  PI-CLAIM-CREDIT                 VALUE '1'.
   608         88  PI-CLAIM-CONVEN                 VALUE '2'.
   609     12  FILLER                          PIC X(4).
   610
   611     12  PI-SYSTEM-LEVEL                 PIC X(145).
   612
   613     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   614         PI-SYSTEM-LEVEL.
   615
   616         16  PI-ENTRY-CODES.
   617             20  PI-ENTRY-CD-1           PIC X.
   618             20  PI-ENTRY-CD-2           PIC X.
   619
   620         16  PI-RETURN-CODES.
   621             20  PI-RETURN-CD-1          PIC X.
   622             20  PI-RETURN-CD-2          PIC X.
   623
   624         16  PI-UPDATE-STATUS-SAVE.
   625             20  PI-UPDATE-BY            PIC X(4).
   626             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   627
   628         16  PI-LOWER-CASE-LETTERS       PIC X.
   629             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   630
   631*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   632*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   633*            88  CARRIER-CLM-CNTL            VALUE '2'.
   634
   635         16  PI-CERT-ACCESS-CONTROL      PIC X.
   636             88  ST-ACCNT-CNTL               VALUE ' '.
   637             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   638             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   639             88  ACCNT-CNTL                  VALUE '3'.
   640             88  CARR-ACCNT-CNTL             VALUE '4'.
   641
   642         16  PI-PROCESSOR-CAP-LIST.
   643             20  PI-SYSTEM-CONTROLS.
   644                24 PI-SYSTEM-DISPLAY     PIC X.
   645                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   646                24 PI-SYSTEM-MODIFY      PIC X.
   647                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   648             20  FILLER                  PIC XX.
   649             20  PI-DISPLAY-CAP          PIC X.
   650                 88  DISPLAY-CAP             VALUE 'Y'.
   651             20  PI-MODIFY-CAP           PIC X.
   652                 88  MODIFY-CAP              VALUE 'Y'.
   653             20  PI-MSG-AT-LOGON-CAP     PIC X.
   654                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL112.cbl
   655             20  PI-FORCE-CAP            PIC X.
   656                 88  FORCE-CAP               VALUE 'Y'.
   657
   658         16  PI-PROGRAM-CONTROLS.
   659             20  PI-PGM-PRINT-OPT        PIC X.
   660             20  PI-PGM-FORMAT-OPT       PIC X.
   661             20  PI-PGM-PROCESS-OPT      PIC X.
   662             20  PI-PGM-TOTALS-OPT       PIC X.
   663
   664         16  PI-HELP-INTERFACE.
   665             20  PI-LAST-ERROR-NO        PIC X(4).
   666             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   667
   668         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   669             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   670
   671         16  PI-CR-CONTROL-IN-PROGRESS.
   672             20  PI-CR-CARRIER           PIC X.
   673             20  PI-CR-GROUPING          PIC X(6).
   674             20  PI-CR-STATE             PIC XX.
   675             20  PI-CR-ACCOUNT           PIC X(10).
   676             20  PI-CR-FIN-RESP          PIC X(10).
   677             20  PI-CR-TYPE              PIC X.
   678
   679         16  PI-CR-BATCH-NUMBER          PIC X(6).
   680
   681         16  PI-CR-MONTH-END-DT          PIC XX.
   682
   683         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   684             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   685             88  PI-ZERO-CARRIER             VALUE '1'.
   686             88  PI-ZERO-GROUPING            VALUE '2'.
   687             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   688
   689         16  PI-CARRIER-SECURITY         PIC X.
   690             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   691
   692         16  PI-ACCOUNT-SECURITY         PIC X(10).
   693             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   694             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   695
   696         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   697             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   698                                         INDEXED BY PI-ACCESS-NDX
   699                                         PIC X.
   700
   701         16  PI-GA-BILLING-CONTROL       PIC X.
   702             88  PI-GA-BILLING               VALUE '1'.
   703
   704         16  PI-MAIL-PROCESSING          PIC X.
   705             88  PI-MAIL-YES                 VALUE 'Y'.
   706
   707         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   708
   709         16  PI-AR-SYSTEM.
   710             20  PI-AR-PROCESSING-CNTL   PIC X.
   711                 88  PI-AR-PROCESSING        VALUE 'Y'.
   712             20  PI-AR-SUMMARY-CODE      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL112.cbl
   713             20  PI-AR-MONTH-END-DT      PIC XX.
   714
   715         16  PI-MP-SYSTEM.
   716             20  PI-MORTGAGE-USER            PIC X.
   717                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   718                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   719             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   720                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   721                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   722                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   723                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   724                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   725             20  PI-MP-MONTH-END-DT          PIC XX.
   726             20  PI-MP-REFERENCE-NO.
   727                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   728                 24  PI-MP-REFERENCE-SFX     PIC XX.
   729
   730         16  PI-LABEL-CONTROL            PIC X(01).
   731             88  PI-CREATE-LABELS                    VALUE 'Y'.
   732             88  PI-BYPASS-LABELS                    VALUE 'N'.
   733
   734         16  PI-BILL-GROUPING-CODE       PIC X(01).
   735             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   736
   737         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   738             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   739             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   740
   741         16  FILLER                      PIC X(14).
   742
   743     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   744******************************************************************
   745     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
   746         16  SAVE-BEGIN          PIC X(5).
   747         16  SAVE-ENDING         PIC X(5).
   748         16  SHOW-SWITCH         PIC X.
   749             88  NOT-SHOWN                   VALUE 'X'.
   750         16  FILLER              PIC X(629).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL112.cbl
   752*    COPY ELCJPFX.
   753******************************************************************
   754*                                                                *
   755*                                                                *
   756*                            ELCJPFX.                            *
   757*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   758*                            VMOD=2.002                          *
   759*                                                                *
   760*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   761*                                                                *
   762*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   763*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   764*        ELCNTL - CONTROL FILE                                   *
   765*        ELMSTR - CLAIM MASTERS                                  *
   766*        ELTRLR - ACTIVITY TRAILERS                              *
   767*        ELCHKQ - CHECK QUE                                      *
   768******************************************************************
   769 01  JOURNAL-RECORD.
   770     12  JP-USER-ID                  PIC X(4).
   771     12  JP-FILE-ID                  PIC X(8).
   772     12  JP-PROGRAM-ID               PIC X(8).
   773     12  JP-RECORD-TYPE              PIC X.
   774         88 JP-ADD              VALUE 'A'.
   775         88 JP-BEFORE-CHANGE    VALUE 'B'.
   776         88 JP-AFTER-CHANGE     VALUE 'C'.
   777         88 JP-DELETE           VALUE 'D'.
   778         88 JP-GENERIC-DELETE   VALUE 'G'.
   779         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   780         88 JP-KEY-CHG-ADD      VALUE 'N'.
   781     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   782     12  JP-RECORD-AREA
   783
   784
   785                                 PIC X(52).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL112.cbl
   787*    COPY EL112S.
   788 01  EL112AI.
   789     05  FILLER            PIC  X(0012).
   790*    -------------------------------
   791     05  DATEL PIC S9(0004) COMP.
   792     05  DATEF PIC  X(0001).
   793     05  FILLER REDEFINES DATEF.
   794         10  DATEA PIC  X(0001).
   795     05  DATEI PIC  X(0008).
   796*    -------------------------------
   797     05  TIMEL PIC S9(0004) COMP.
   798     05  TIMEF PIC  X(0001).
   799     05  FILLER REDEFINES TIMEF.
   800         10  TIMEA PIC  X(0001).
   801     05  TIMEI PIC  X(0005).
   802*    -------------------------------
   803     05  MAINTL PIC S9(0004) COMP.
   804     05  MAINTF PIC  X(0001).
   805     05  FILLER REDEFINES MAINTF.
   806         10  MAINTA PIC  X(0001).
   807     05  MAINTI PIC  X(0001).
   808*    -------------------------------
   809     05  PGRML PIC S9(0004) COMP.
   810     05  PGRMF PIC  X(0001).
   811     05  FILLER REDEFINES PGRMF.
   812         10  PGRMA PIC  X(0001).
   813     05  PGRMI PIC  X(0005).
   814*    -------------------------------
   815     05  DESCL PIC S9(0004) COMP.
   816     05  DESCF PIC  X(0001).
   817     05  FILLER REDEFINES DESCF.
   818         10  DESCA PIC  X(0001).
   819     05  DESCI PIC  X(0040).
   820*    -------------------------------
   821     05  TRANCDL PIC S9(0004) COMP.
   822     05  TRANCDF PIC  X(0001).
   823     05  FILLER REDEFINES TRANCDF.
   824         10  TRANCDA PIC  X(0001).
   825     05  TRANCDI PIC  X(0004).
   826*    -------------------------------
   827     05  CALLL PIC S9(0004) COMP.
   828     05  CALLF PIC  X(0001).
   829     05  FILLER REDEFINES CALLF.
   830         10  CALLA PIC  X(0001).
   831     05  CALLI PIC  X(0001).
   832     05  PGMDESCD OCCURS 11  TIMES.
   833*    -------------------------------
   834         10  PGMDESCL PIC S9(0004) COMP.
   835         10  PGMDESCF PIC  X(0001).
   836         10  FILLER REDEFINES PGMDESCF.
   837             15  PGMDESCA PIC  X(0001).
   838         10  PGMDESCI PIC  X(0079).
   839*    -------------------------------
   840     05  MSGL PIC S9(0004) COMP.
   841     05  MSGF PIC  X(0001).
   842     05  FILLER REDEFINES MSGF.
   843         10  MSGA PIC  X(0001).
   844     05  MSGI PIC  X(0070).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL112.cbl
   845*    -------------------------------
   846     05  PFKEYL PIC S9(0004) COMP.
   847     05  PFKEYF PIC  X(0001).
   848     05  FILLER REDEFINES PFKEYF.
   849         10  PFKEYA PIC  X(0001).
   850     05  PFKEYI PIC  X(0002).
   851 01  EL112AO REDEFINES EL112AI.
   852     05  FILLER            PIC  X(0012).
   853*    -------------------------------
   854     05  FILLER            PIC  X(0003).
   855     05  DATEO PIC  X(0008).
   856*    -------------------------------
   857     05  FILLER            PIC  X(0003).
   858     05  TIMEO PIC  X(0005).
   859*    -------------------------------
   860     05  FILLER            PIC  X(0003).
   861     05  MAINTO PIC  X(0001).
   862*    -------------------------------
   863     05  FILLER            PIC  X(0003).
   864     05  PGRMO PIC  X(0005).
   865*    -------------------------------
   866     05  FILLER            PIC  X(0003).
   867     05  DESCO PIC  X(0040).
   868*    -------------------------------
   869     05  FILLER            PIC  X(0003).
   870     05  TRANCDO PIC  X(0004).
   871*    -------------------------------
   872     05  FILLER            PIC  X(0003).
   873     05  CALLO PIC  X(0001).
   874*    -------------------------------
   875     05  PGMDESCD OCCURS 11  TIMES.
   876         10  FILLER        PIC  X(0003).
   877         10  PGMDESCO PIC  X(0079).
   878*    -------------------------------
   879     05  FILLER            PIC  X(0003).
   880     05  MSGO PIC  X(0070).
   881*    -------------------------------
   882     05  FILLER            PIC  X(0003).
   883     05  PFKEYO PIC  X(0002).
   884*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL112.cbl
   886****************************************************************
   887*
   888* Copyright (c) 2007 by Clerity Solutions, Inc.
   889* All rights reserved.
   890*
   891****************************************************************
   892 01  DFHEIV.
   893   02  DFHEIV0               PIC X(35).
   894   02  DFHEIV1               PIC X(08).
   895   02  DFHEIV2               PIC X(08).
   896   02  DFHEIV3               PIC X(08).
   897   02  DFHEIV4               PIC X(06).
   898   02  DFHEIV5               PIC X(04).
   899   02  DFHEIV6               PIC X(04).
   900   02  DFHEIV7               PIC X(02).
   901   02  DFHEIV8               PIC X(02).
   902   02  DFHEIV9               PIC X(01).
   903   02  DFHEIV10              PIC S9(7) COMP-3.
   904   02  DFHEIV11              PIC S9(4) COMP SYNC.
   905   02  DFHEIV12              PIC S9(4) COMP SYNC.
   906   02  DFHEIV13              PIC S9(4) COMP SYNC.
   907   02  DFHEIV14              PIC S9(4) COMP SYNC.
   908   02  DFHEIV15              PIC S9(4) COMP SYNC.
   909   02  DFHEIV16              PIC S9(9) COMP SYNC.
   910   02  DFHEIV17              PIC X(04).
   911   02  DFHEIV18              PIC X(04).
   912   02  DFHEIV19              PIC X(04).
   913   02  DFHEIV20              USAGE IS POINTER.
   914   02  DFHEIV21              USAGE IS POINTER.
   915   02  DFHEIV22              USAGE IS POINTER.
   916   02  DFHEIV23              USAGE IS POINTER.
   917   02  DFHEIV24              USAGE IS POINTER.
   918   02  DFHEIV25              PIC S9(9) COMP SYNC.
   919   02  DFHEIV26              PIC S9(9) COMP SYNC.
   920   02  DFHEIV27              PIC S9(9) COMP SYNC.
   921   02  DFHEIV28              PIC S9(9) COMP SYNC.
   922   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   923   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   924   02  FILLER                PIC X(02).
   925   02  DFHEIV99              PIC X(08) VALUE SPACE.
   926   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   927   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   928   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   929   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   930 LINKAGE  SECTION.
   931*****************************************************************
   932*                                                               *
   933* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   934* All rights reserved.                                          *
   935*                                                               *
   936*****************************************************************
   937 01  dfheiblk.
   938     02  eibtime          pic s9(7) comp-3.
   939     02  eibdate          pic s9(7) comp-3.
   940     02  eibtrnid         pic x(4).
   941     02  eibtaskn         pic s9(7) comp-3.
   942     02  eibtrmid         pic x(4).
   943     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL112.cbl
   944     02  eibcposn         pic s9(4) comp.
   945     02  eibcalen         pic s9(4) comp.
   946     02  eibaid           pic x(1).
   947     02  eibfiller1       pic x(1).
   948     02  eibfn            pic x(2).
   949     02  eibfiller2       pic x(2).
   950     02  eibrcode         pic x(6).
   951     02  eibfiller3       pic x(2).
   952     02  eibds            pic x(8).
   953     02  eibreqid         pic x(8).
   954     02  eibrsrce         pic x(8).
   955     02  eibsync          pic x(1).
   956     02  eibfree          pic x(1).
   957     02  eibrecv          pic x(1).
   958     02  eibsend          pic x(1).
   959     02  eibatt           pic x(1).
   960     02  eibeoc           pic x(1).
   961     02  eibfmh           pic x(1).
   962     02  eibcompl         pic x(1).
   963     02  eibsig           pic x(1).
   964     02  eibconf          pic x(1).
   965     02  eiberr           pic x(1).
   966     02  eibrldbk         pic x(1).
   967     02  eiberrcd         pic x(4).
   968     02  eibsynrb         pic x(1).
   969     02  eibnodat         pic x(1).
   970     02  eibfiller5       pic x(2).
   971     02  eibresp          pic 9(09) comp.
   972     02  eibresp2         pic 9(09) comp.
   973     02  dfheigdj         pic s9(4) comp.
   974     02  dfheigdk         pic s9(4) comp.
   975 01  DFHCOMMAREA                 PIC X(1024).
   976
   977*01 PARM-LIST .
   978*    12  FILLER                  PIC S9(8)  COMP.
   979*    12  PGMN-PNT                PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL112.cbl
   981*    COPY ELCPGMN.
   982******************************************************************
   983*                                                                *
   984*                                                                *
   985*                            ELCPGMN.                            *
   986*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   987*                            VMOD=2.002                          *
   988*                                                                *
   989*   FILE DESCRIPTION = PROGRAM DESCRIPTIONS                      *
   990*                                                                *
   991*   FILE TYPE = VSAM,KSDS                                        *
   992*   RECORD SIZE = 52    RECFORM = FIX                            *
   993*                                                                *
   994*   BASE CLUSTER NAME = ELPGMN                 RKP=2,LEN=5       *
   995*       ALTERNATE PATH  = NOT USED                               *
   996*                                                                *
   997*   LOG = NO                                                     *
   998*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   999******************************************************************
  1000 01  PROGRAM-DESCRIPTIONS.
  1001     12  PN-RECORD-ID                PIC XX.
  1002         88  VALID-PN-ID                VALUE 'PN'.
  1003
  1004     12  PN-CONTROL-PRIMARY.
  1005         16  PN-PROGRAM-NUMBER.
  1006             20  PN-SYSTEM-CODE      PIC XX.
  1007                 88  CLAS-IC-ONLINE     VALUE 'EL'.
  1008                 88  CLAS-IC-REPORT     VALUE 'EC'.
  1009                 88  CLAS-GL-BATCH      VALUE 'GL'.
  1010             20  PN-PROGRAM-SEQUENCE PIC 999.
  1011     12  PN-PROGRAM-DESCRIPTION      PIC X(40).
  1012     12  PN-TRANSACTION-CODE         PIC X(4).
  1013     12  PN-ENTRY-METHOD             PIC X.
  1014         88  ENTERED-FROM-CICS          VALUE 'C'.
  1015         88  ENTERED-FROM-CLASIC-MENU   VALUE 'M'.
  1016         88  ENTERED-FROM-BATCH         VALUE 'B'.
  1017
  1018******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL112.cbl
  1020 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1021                          PROGRAM-DESCRIPTIONS.
  1022 0000-DFHEXIT SECTION.
  1023     MOVE '9#                    $   ' TO DFHEIV0.
  1024     MOVE 'EL112' TO DFHEIV1.
  1025     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1026
  1027     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  1028
  1029     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1030     MOVE '5'                    TO DC-OPTION-CODE.
  1031     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  1032     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1033     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  1034
  1035     IF EIBCALEN = ZERO
  1036         MOVE HIGH-VALUES        TO SAVE-BEGIN
  1037         MOVE LOW-VALUES         TO SAVE-ENDING
  1038         MOVE LIT-X              TO SHOW-SWITCH
  1039         MOVE LOW-VALUES         TO EL112AO
  1040         MOVE ZEROS              TO COUNT-1
  1041         PERFORM 3100-FILL-SCREEN THRU 3110-EXIT
  1042             UNTIL SCREEN-FULL
  1043         MOVE LIT-IC             TO MAINTL
  1044         GO TO 8100-SEND-MAP.
  1045
  1046     IF PI-CALLING-PROGRAM NOT = LIT-PROG
  1047         IF PI-RETURN-TO-PROGRAM NOT = LIT-PROG
  1048             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1049             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1050             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1051             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1052             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1053             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1054             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1055             MOVE LIT-PROG             TO  PI-CALLING-PROGRAM
  1056           ELSE
  1057             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  1058             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  1059             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  1060             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  1061             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  1062             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  1063             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  1064             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  1065
  1066     IF EIBTRNID NOT = LIT-TRANS
  1067         MOVE HIGH-VALUES TO SAVE-BEGIN
  1068         MOVE LOW-VALUES TO SAVE-ENDING
  1069         MOVE LIT-X TO SHOW-SWITCH
  1070         MOVE LOW-VALUES         TO EL112AO
  1071         MOVE ZEROS              TO COUNT-1
  1072         PERFORM 3100-FILL-SCREEN THRU 3110-EXIT
  1073             UNTIL SCREEN-FULL
  1074         MOVE LIT-IC             TO MAINTL
  1075         GO TO 8100-SEND-MAP.
  1076
  1077     IF EIBAID = DFHCLEAR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL112.cbl
  1078         GO TO 9400-CLEAR.
  1079
  1080     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1081         MOVE LOW-VALUES         TO EL112AO
  1082         MOVE LIT-IC             TO PFKEYL
  1083         MOVE INVALID-PFKEY      TO MSGO
  1084         GO TO 8110-SEND-DATA.
  1085
  1086
  1087* EXEC CICS RECEIVE
  1088*        MAP     ('EL112A')
  1089*        MAPSET  ('EL112S')
  1090*    END-EXEC.
  1091     MOVE 'EL112A' TO DFHEIV1
  1092     MOVE 'EL112S' TO DFHEIV2
  1093*    MOVE '8"T                   ''   #00001082' TO DFHEIV0
  1094     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  1095     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1096     MOVE X'2020233030303031303832' TO DFHEIV0(25:11)
  1097     CALL 'kxdfhei1' USING DFHEIV0,
  1098           DFHEIV1,
  1099           EL112AI,
  1100           DFHEIV99,
  1101           DFHEIV2,
  1102           DFHEIV99,
  1103           DFHEIV99
  1104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1105
  1106
  1107     MOVE SPACE                  TO SCREEN-SWITCH.
  1108
  1109     IF PFKEYL GREATER ZERO
  1110         PERFORM 0300-TRANS-PF THRU 0310-EXIT.
  1111
  1112     IF SCREEN-ERROR
  1113         MOVE LIT-IC             TO PFKEYL
  1114         GO TO 8110-SEND-DATA.
  1115
  1116     IF EIBAID = DFHPF23
  1117         GO TO 9100-RETURN-CICS.
  1118
  1119     IF  EIBAID = DFHPF24
  1120
  1121         IF  CREDIT-SESSION
  1122             MOVE XCTL-EL626     TO CALL-PROG
  1123             GO TO 9000-XCTL
  1124
  1125         ELSE
  1126             IF  CLAIM-SESSION
  1127                 MOVE XCTL-EL126 TO CALL-PROG
  1128                 GO TO 9000-XCTL
  1129
  1130             ELSE
  1131                 IF  MORTGAGE-SESSION
  1132                     MOVE XCTL-EM626
  1133                                 TO CALL-PROG
  1134                     GO TO 9000-XCTL
  1135
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL112.cbl
  1136                 ELSE
  1137                     IF  GENERAL-LEDGER-SESSION
  1138                         MOVE XCTL-GL800
  1139                                 TO CALL-PROG
  1140                         GO TO 9000-XCTL.
  1141
  1142     IF EIBAID = DFHPF12
  1143         MOVE 'EL010'         TO  CALL-PROG
  1144         GO TO 9000-XCTL.
  1145
  1146     IF EIBAID = DFHPF1
  1147         GO TO 0100-PAGE-FORWARD.
  1148
  1149     IF EIBAID = DFHPF2
  1150         GO TO 0200-PAGE-BACKWARD.
  1151
  1152     IF EIBAID NOT = DFHENTER
  1153         MOVE INVALID-PFKEY      TO MSGO
  1154         MOVE LIT-IC             TO MAINTL
  1155         GO TO 8110-SEND-DATA.
  1156
  1157     PERFORM 0400-SET-ATTRB THRU 0410-EXIT.
  1158     MOVE SPACE                  TO SCREEN-SWITCH.
  1159     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  1160
  1161     IF SCREEN-ERROR
  1162         GO TO 8110-SEND-DATA.
  1163
  1164     PERFORM 1100-UPDATE-FILE THRU 1110-EXIT.
  1165     MOVE LIT-IC                 TO MAINTL.
  1166
  1167     IF SHOW-OPTION
  1168         MOVE SPACES             TO MSGO
  1169         GO TO 8110-SEND-DATA
  1170     ELSE
  1171         MOVE LIT-X TO SHOW-SWITCH
  1172         MOVE LOW-VALUES         TO EL112AO
  1173         MOVE LIT-IC             TO MAINTL
  1174         MOVE END-UPDATE         TO MSGO
  1175         MOVE HIGH-VALUES        TO SAVE-BEGIN
  1176         MOVE LOW-VALUES         TO SAVE-ENDING
  1177         GO TO 8100-SEND-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL112.cbl
  1179 0100-PAGE-FORWARD.
  1180     MOVE ZEROS                  TO COUNT-1.
  1181     MOVE SPACES                 TO SCREEN-SWITCH  MSGO
  1182                                    SHOW-SWITCH.
  1183
  1184     IF PGRML = ZEROS
  1185         MOVE SAVE-ENDING TO BROWSE-KEY
  1186     ELSE
  1187         MOVE AL-UANOF           TO PGRMA
  1188         MOVE PGRMI              TO BROWSE-KEY.
  1189
  1190     MOVE SPACES                 TO MAINTO
  1191                                    DESCO
  1192                                    TRANCDO
  1193                                    CALLO.
  1194
  1195
  1196* EXEC CICS HANDLE CONDITION
  1197*        NOTOPEN  (8230-NOT-OPEN)
  1198*        NOTFND   (0110-REC-NOT-FND)
  1199*    END-EXEC.
  1200*    MOVE '"$JI                  ! " #00001175' TO DFHEIV0
  1201     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  1202     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1203     MOVE X'2220233030303031313735' TO DFHEIV0(25:11)
  1204     CALL 'kxdfhei1' USING DFHEIV0
  1205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1206
  1207
  1208
  1209* EXEC CICS STARTBR
  1210*        DATASET  (LIT-FILE)
  1211*        RIDFLD   (BROWSE-KEY)
  1212*    END-EXEC.
  1213     MOVE 0
  1214       TO DFHEIV11
  1215*    MOVE '&,         G          &   #00001180' TO DFHEIV0
  1216     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1217     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1218     MOVE X'2020233030303031313830' TO DFHEIV0(25:11)
  1219     CALL 'kxdfhei1' USING DFHEIV0,
  1220           LIT-FILE,
  1221           BROWSE-KEY,
  1222           DFHEIV99,
  1223           DFHEIV11,
  1224           DFHEIV99
  1225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1226
  1227
  1228     PERFORM 3000-BUILD-FWD-PAGE THRU 3020-EXIT
  1229         UNTIL SCREEN-FULL OR END-OF-FILE.
  1230
  1231
  1232* EXEC CICS ENDBR
  1233*        DATASET (LIT-FILE)
  1234*    END-EXEC.
  1235     MOVE 0
  1236       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL112.cbl
  1237*    MOVE '&2                    $   #00001188' TO DFHEIV0
  1238     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1239     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1240     MOVE X'2020233030303031313838' TO DFHEIV0(25:11)
  1241     CALL 'kxdfhei1' USING DFHEIV0,
  1242           LIT-FILE,
  1243           DFHEIV11,
  1244           DFHEIV99
  1245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1246
  1247
  1248     MOVE LIT-IC                 TO MAINTL.
  1249     GO TO 8110-SEND-DATA.
  1250
  1251 0110-REC-NOT-FND.
  1252     MOVE HIGH-VALUES            TO SAVE-BEGIN SAVE-ENDING.
  1253     PERFORM 3100-FILL-SCREEN THRU 3110-EXIT
  1254         UNTIL SCREEN-FULL.
  1255     MOVE LIT-IC                 TO MAINTL.
  1256     MOVE END-MSG                TO MSGO.
  1257     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL112.cbl
  1259 0200-PAGE-BACKWARD.
  1260     MOVE 11                     TO COUNT-1.
  1261     MOVE SPACES                 TO SCREEN-SWITCH  MSGO
  1262                                    SHOW-SWITCH.
  1263
  1264     IF PGRML = ZEROS
  1265         MOVE SAVE-BEGIN         TO BROWSE-KEY
  1266     ELSE
  1267         MOVE AL-UANOF           TO PGRMA
  1268         MOVE PGRMI              TO BROWSE-KEY.
  1269
  1270     MOVE SPACES                 TO MAINTO
  1271                                    DESCO
  1272                                    TRANCDO
  1273                                    CALLO.
  1274
  1275
  1276* EXEC CICS HANDLE CONDITION
  1277*        NOTOPEN  (8230-NOT-OPEN)
  1278*        NOTFND   (0210-REC-NOT-FND)
  1279*    END-EXEC.
  1280*    MOVE '"$JI                  ! # #00001219' TO DFHEIV0
  1281     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  1282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1283     MOVE X'2320233030303031323139' TO DFHEIV0(25:11)
  1284     CALL 'kxdfhei1' USING DFHEIV0
  1285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1286
  1287
  1288
  1289* EXEC CICS STARTBR
  1290*        DATASET  (LIT-FILE)
  1291*        RIDFLD   (BROWSE-KEY)
  1292*    END-EXEC.
  1293     MOVE 0
  1294       TO DFHEIV11
  1295*    MOVE '&,         G          &   #00001224' TO DFHEIV0
  1296     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1297     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1298     MOVE X'2020233030303031323234' TO DFHEIV0(25:11)
  1299     CALL 'kxdfhei1' USING DFHEIV0,
  1300           LIT-FILE,
  1301           BROWSE-KEY,
  1302           DFHEIV99,
  1303           DFHEIV11,
  1304           DFHEIV99
  1305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1306
  1307
  1308     PERFORM 3030-BUILD-BCK-PAGE THRU 3050-EXIT
  1309         UNTIL SCREEN-FULL OR END-OF-FILE.
  1310
  1311
  1312* EXEC CICS ENDBR
  1313*        DATASET (LIT-FILE)
  1314*    END-EXEC.
  1315     MOVE 0
  1316       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL112.cbl
  1317*    MOVE '&2                    $   #00001232' TO DFHEIV0
  1318     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1319     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1320     MOVE X'2020233030303031323332' TO DFHEIV0(25:11)
  1321     CALL 'kxdfhei1' USING DFHEIV0,
  1322           LIT-FILE,
  1323           DFHEIV11,
  1324           DFHEIV99
  1325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1326
  1327
  1328     MOVE COUNT-1                TO COUNT-3.
  1329     PERFORM 3060-RAISE-PAGE THRU 3070-EXIT
  1330         COUNT-3 TIMES.
  1331     MOVE LIT-IC                 TO MAINTL.
  1332     GO TO 8110-SEND-DATA.
  1333
  1334 0210-REC-NOT-FND.
  1335     MOVE HIGH-VALUES            TO SAVE-BEGIN.
  1336     MOVE ZEROS                  TO PGRML.
  1337     GO TO 0200-PAGE-BACKWARD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL112.cbl
  1339 0300-TRANS-PF.
  1340     IF EIBAID NOT = DFHENTER
  1341         MOVE INVALID-PFKEY      TO MSGO
  1342         MOVE LIT-X              TO SCREEN-SWITCH
  1343         GO TO 0310-EXIT.
  1344
  1345     IF PFKEYI NOT NUMERIC
  1346         MOVE INVALID-PFKEY      TO MSGO
  1347         MOVE LIT-X              TO SCREEN-SWITCH
  1348         GO TO 0310-EXIT.
  1349
  1350     IF PFKEYI LESS 1 OR GREATER 24
  1351         MOVE INVALID-PFKEY      TO MSGO
  1352         MOVE LIT-X              TO SCREEN-SWITCH
  1353         GO TO 0310-EXIT.
  1354
  1355     MOVE PFKEYI                 TO CHECK-PFKEYS.
  1356     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  1357
  1358 0310-EXIT.
  1359     EXIT.
  1360
  1361 0400-SET-ATTRB.
  1362     MOVE AL-UANON               TO MAINTA
  1363                                    PGRMA
  1364                                    DESCA
  1365                                    TRANCDA
  1366                                    CALLA.
  1367
  1368 0410-EXIT.
  1369     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL112.cbl
  1371 1000-EDIT-SCREEN.
  1372     MOVE MAINTI                 TO CHECK-MAINT.
  1373
  1374     IF (NOT VALID-OPTION) OR
  1375*       (PI-PROCESSOR-ID NOT = 'LGXX' AND NOT SHOW-OPTION)
  1376        (PI-PROCESSOR-ID NOT = 'LGXX' AND 'PEMA' AND 'SMVA'
  1377                        AND NOT SHOW-OPTION)
  1378         MOVE LIT-IC             TO MAINTL
  1379         MOVE AL-UABON           TO MAINTA
  1380         MOVE MAINT-MIS          TO MSGO
  1381         MOVE LIT-X              TO SCREEN-SWITCH
  1382         GO TO 1010-EXIT.
  1383
  1384     IF PGRMI = ZEROS OR LOW-VALUES
  1385         MOVE LIT-IC             TO PGRML
  1386         MOVE AL-UABON           TO PGRMA
  1387         MOVE PGM-MIS            TO MSGO
  1388         MOVE LIT-X              TO SCREEN-SWITCH
  1389         GO TO 1010-EXIT.
  1390
  1391     MOVE PGRMI                  TO BROWSE-KEY.
  1392
  1393     IF PGM-PREF NOT = LIT-CLAIM AND LIT-EC AND LIT-WA
  1394       AND LIT-GL AND LIT-LF AND LIT-MORTG
  1395         MOVE LIT-IC             TO PGRML
  1396         MOVE AL-UABON           TO PGRMA
  1397         MOVE PGM-MIS            TO MSGO
  1398         MOVE LIT-X              TO SCREEN-SWITCH
  1399         GO TO 1010-EXIT.
  1400
  1401     IF CHANGE-OPTION AND NOT-SHOWN
  1402         MOVE SPACES             TO SHOW-SWITCH SCREEN-SWITCH
  1403         MOVE ZEROS              TO COUNT-1
  1404         PERFORM 3100-FILL-SCREEN THRU 3110-EXIT
  1405             UNTIL SCREEN-FULL
  1406         MOVE LIT-S              TO CHECK-MAINT.
  1407
  1408     PERFORM 1020-VERIFY-PGM THRU 1050-VERIFY-PGM-EXIT.
  1409
  1410     IF SCREEN-ERROR OR DELETE-OPTION
  1411         GO TO 1010-EXIT.
  1412
  1413     IF SHOW-OPTION
  1414         MOVE SPACES             TO SHOW-SWITCH SCREEN-SWITCH
  1415         MOVE ZEROS              TO COUNT-1
  1416         PERFORM 3100-FILL-SCREEN THRU 3110-EXIT
  1417             UNTIL SCREEN-FULL
  1418         GO TO 1010-EXIT.
  1419
  1420     IF DESCI = SPACES OR LOW-VALUES
  1421         MOVE LIT-IC             TO DESCL
  1422         MOVE AL-UABON           TO DESCA
  1423         MOVE DESC-MIS           TO MSGO
  1424         MOVE LIT-X              TO SCREEN-SWITCH
  1425         GO TO 1010-EXIT.
  1426
  1427     MOVE CALLI                  TO CHECK-CALL.
  1428
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL112.cbl
  1429     IF NOT VALID-CALL
  1430         MOVE LIT-IC             TO CALLL
  1431         MOVE AL-UABON           TO CALLA
  1432         MOVE CALL-MIS           TO MSGO
  1433         MOVE LIT-X              TO SCREEN-SWITCH.
  1434
  1435     IF TRANCDI = SPACES OR LOW-VALUES
  1436        IF NOT BATCH-PROG
  1437           MOVE LIT-IC           TO TRANCDL
  1438           MOVE AL-UABON         TO TRANCDA
  1439           MOVE TRANS-MIS        TO MSGO
  1440           MOVE LIT-X            TO SCREEN-SWITCH
  1441           GO TO 1010-EXIT.
  1442
  1443 1010-EXIT.
  1444     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL112.cbl
  1446 1020-VERIFY-PGM.
  1447
  1448* EXEC CICS HANDLE CONDITION
  1449*        NOTOPEN  (1040-RECORD-NOT-FOUND)
  1450*        NOTFND   (1040-RECORD-NOT-FOUND)
  1451*    END-EXEC.
  1452*    MOVE '"$JI                  ! $ #00001355' TO DFHEIV0
  1453     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  1454     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1455     MOVE X'2420233030303031333535' TO DFHEIV0(25:11)
  1456     CALL 'kxdfhei1' USING DFHEIV0
  1457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1458
  1459
  1460     MOVE PGRMI                  TO BROWSE-KEY.
  1461
  1462
  1463* EXEC CICS READ
  1464*        DATASET  (LIT-FILE)
  1465*        RIDFLD   (BROWSE-KEY)
  1466*        SET      (ADDRESS OF PROGRAM-DESCRIPTIONS)
  1467*    END-EXEC.
  1468*    MOVE '&"S        E          (   #00001362' TO DFHEIV0
  1469     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1470     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1471     MOVE X'2020233030303031333632' TO DFHEIV0(25:11)
  1472     CALL 'kxdfhei1' USING DFHEIV0,
  1473           LIT-FILE,
  1474           DFHEIV20,
  1475           DFHEIV99,
  1476           BROWSE-KEY,
  1477           DFHEIV99,
  1478           DFHEIV99,
  1479           DFHEIV99
  1480     SET ADDRESS OF PROGRAM-DESCRIPTIONS TO
  1481         DFHEIV20
  1482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1483
  1484
  1485     IF ADD-OPTION
  1486         MOVE PGM-DUP            TO MSGO
  1487         MOVE AL-UABON           TO PGRMA
  1488         MOVE LIT-IC             TO PGRML
  1489         MOVE LIT-X              TO SCREEN-SWITCH
  1490         GO TO 1050-VERIFY-PGM-EXIT.
  1491
  1492     IF NOT SHOW-OPTION
  1493         GO TO 1050-VERIFY-PGM-EXIT.
  1494
  1495     MOVE PN-PROGRAM-DESCRIPTION TO DESCO.
  1496     MOVE PN-TRANSACTION-CODE    TO TRANCDO.
  1497     MOVE PN-ENTRY-METHOD        TO CALLO.
  1498     GO TO 1050-VERIFY-PGM-EXIT.
  1499
  1500 1040-RECORD-NOT-FOUND.
  1501     IF ADD-OPTION
  1502         GO TO 1050-VERIFY-PGM-EXIT.
  1503
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL112.cbl
  1504     MOVE PGM-MIS                TO MSGO.
  1505     MOVE AL-UABON               TO PGRMA.
  1506     MOVE LIT-IC                 TO PGRML.
  1507     MOVE LIT-X                  TO SCREEN-SWITCH.
  1508
  1509 1050-VERIFY-PGM-EXIT.
  1510     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL112.cbl
  1512 1100-UPDATE-FILE.
  1513     IF SHOW-OPTION
  1514         GO TO 1110-EXIT.
  1515
  1516     IF ADD-OPTION
  1517         PERFORM 1120-ADD-OPTION THRU 1140-EXIT.
  1518
  1519     IF CHANGE-OPTION
  1520         PERFORM 1150-CHANGE-OPTION THRU 1160-EXIT.
  1521
  1522     IF DELETE-OPTION
  1523         PERFORM 1170-DELETE-OPTION THRU 1180-EXIT.
  1524
  1525 1110-EXIT.
  1526     EXIT.
  1527
  1528 1120-ADD-OPTION.
  1529
  1530* EXEC CICS HANDLE CONDITION
  1531*        NOTOPEN  (8230-NOT-OPEN)
  1532*        NOSPACE  (1130-FILE-FULL)
  1533*    END-EXEC.
  1534*    MOVE '"$JE                  ! % #00001412' TO DFHEIV0
  1535     MOVE X'22244A452020202020202020' TO DFHEIV0(1:12)
  1536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1537     MOVE X'2520233030303031343132' TO DFHEIV0(25:11)
  1538     CALL 'kxdfhei1' USING DFHEIV0
  1539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1540
  1541
  1542
  1543* EXEC CICS GETMAIN
  1544*        SET      (ADDRESS OF PROGRAM-DESCRIPTIONS)
  1545*        LENGTH   (PGMN-LENGTH)
  1546*        INITIMG  (LIT-SPACE)
  1547*    END-EXEC.
  1548*    MOVE ',"IL                  $   #00001417' TO DFHEIV0
  1549     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  1550     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1551     MOVE X'2020233030303031343137' TO DFHEIV0(25:11)
  1552     CALL 'kxdfhei1' USING DFHEIV0,
  1553           DFHEIV20,
  1554           PGMN-LENGTH,
  1555           LIT-SPACE
  1556     SET ADDRESS OF PROGRAM-DESCRIPTIONS TO
  1557         DFHEIV20
  1558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1559
  1560
  1561     MOVE LIT-PN                 TO PN-RECORD-ID.
  1562     MOVE PGRMI                  TO BROWSE-KEY PN-PROGRAM-NUMBER.
  1563     MOVE DESCI                  TO PN-PROGRAM-DESCRIPTION.
  1564     MOVE TRANCDI                TO PN-TRANSACTION-CODE.
  1565     MOVE CALLI                  TO PN-ENTRY-METHOD.
  1566     MOVE LIT-A                  TO JP-RECORD-TYPE.
  1567     MOVE PROGRAM-DESCRIPTIONS   TO JP-RECORD-AREA.
  1568
  1569
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL112.cbl
  1570* EXEC CICS WRITE
  1571*        DATASET  (LIT-FILE)
  1572*        FROM     (PROGRAM-DESCRIPTIONS)
  1573*        RIDFLD   (BROWSE-KEY)
  1574*    END-EXEC.
  1575     MOVE LENGTH OF
  1576      PROGRAM-DESCRIPTIONS
  1577       TO DFHEIV11
  1578*    MOVE '&$ L                  ''   #00001431' TO DFHEIV0
  1579     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  1580     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1581     MOVE X'2020233030303031343331' TO DFHEIV0(25:11)
  1582     CALL 'kxdfhei1' USING DFHEIV0,
  1583           LIT-FILE,
  1584           PROGRAM-DESCRIPTIONS,
  1585           DFHEIV11,
  1586           BROWSE-KEY,
  1587           DFHEIV99,
  1588           DFHEIV99
  1589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1590
  1591
  1592     PERFORM 2000-JOURNAL-WRITE THRU 2010-EXIT.
  1593
  1594 1130-FILE-FULL.
  1595     MOVE LIT-X                  TO SCREEN-SWITCH.
  1596
  1597 1140-EXIT.
  1598     EXIT.
  1599
  1600 1150-CHANGE-OPTION.
  1601
  1602* EXEC CICS HANDLE CONDITION
  1603*        NOTOPEN (8230-NOT-OPEN)
  1604*    END-EXEC.
  1605*    MOVE '"$J                   ! & #00001446' TO DFHEIV0
  1606     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  1607     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1608     MOVE X'2620233030303031343436' TO DFHEIV0(25:11)
  1609     CALL 'kxdfhei1' USING DFHEIV0
  1610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1611
  1612
  1613     MOVE PGRMI                  TO BROWSE-KEY.
  1614     PERFORM 1190-READ-FILE THRU 1200-EXIT.
  1615     MOVE LIT-B                  TO JP-RECORD-TYPE.
  1616     MOVE PROGRAM-DESCRIPTIONS   TO JP-RECORD-AREA.
  1617     PERFORM 2000-JOURNAL-WRITE THRU 2010-EXIT.
  1618     MOVE DESCI                  TO PN-PROGRAM-DESCRIPTION.
  1619     MOVE TRANCDI                TO PN-TRANSACTION-CODE.
  1620     MOVE CALLI                  TO PN-ENTRY-METHOD.
  1621     MOVE LIT-C                  TO JP-RECORD-TYPE.
  1622     MOVE PROGRAM-DESCRIPTIONS   TO JP-RECORD-AREA.
  1623
  1624
  1625* EXEC CICS REWRITE
  1626*        DATASET  (LIT-FILE)
  1627*        FROM     (PROGRAM-DESCRIPTIONS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL112.cbl
  1628*    END-EXEC.
  1629     MOVE LENGTH OF
  1630      PROGRAM-DESCRIPTIONS
  1631       TO DFHEIV11
  1632*    MOVE '&& L                  %   #00001461' TO DFHEIV0
  1633     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1634     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1635     MOVE X'2020233030303031343631' TO DFHEIV0(25:11)
  1636     CALL 'kxdfhei1' USING DFHEIV0,
  1637           LIT-FILE,
  1638           PROGRAM-DESCRIPTIONS,
  1639           DFHEIV11,
  1640           DFHEIV99
  1641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1642
  1643
  1644     PERFORM 2000-JOURNAL-WRITE THRU 2010-EXIT.
  1645
  1646 1160-EXIT.
  1647     EXIT.
  1648
  1649 1170-DELETE-OPTION.
  1650
  1651* EXEC CICS HANDLE CONDITION
  1652*        NOTOPEN (8230-NOT-OPEN)
  1653*    END-EXEC.
  1654*    MOVE '"$J                   ! '' #00001472' TO DFHEIV0
  1655     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  1656     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1657     MOVE X'2720233030303031343732' TO DFHEIV0(25:11)
  1658     CALL 'kxdfhei1' USING DFHEIV0
  1659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1660
  1661
  1662     MOVE PGRMI                  TO BROWSE-KEY.
  1663     PERFORM 1190-READ-FILE THRU 1200-EXIT.
  1664     MOVE LIT-D                  TO JP-RECORD-TYPE.
  1665     MOVE PROGRAM-DESCRIPTIONS   TO JP-RECORD-AREA.
  1666
  1667
  1668* EXEC CICS DELETE
  1669*        DATASET (LIT-FILE)
  1670*    END-EXEC.
  1671*    MOVE '&(                    &   #00001481' TO DFHEIV0
  1672     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1673     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1674     MOVE X'2020233030303031343831' TO DFHEIV0(25:11)
  1675     CALL 'kxdfhei1' USING DFHEIV0,
  1676           LIT-FILE,
  1677           DFHEIV99,
  1678           DFHEIV99,
  1679           DFHEIV99,
  1680           DFHEIV99
  1681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1682
  1683
  1684     PERFORM 2000-JOURNAL-WRITE THRU 2010-EXIT.
  1685
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL112.cbl
  1686 1180-EXIT.
  1687     EXIT.
  1688
  1689 1190-READ-FILE.
  1690
  1691* EXEC CICS READ
  1692*        DATASET  (LIT-FILE)
  1693*        RIDFLD   (BROWSE-KEY)
  1694*        SET      (ADDRESS OF PROGRAM-DESCRIPTIONS)
  1695*        UPDATE
  1696*    END-EXEC.
  1697*    MOVE '&"S        EU         (   #00001491' TO DFHEIV0
  1698     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1699     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1700     MOVE X'2020233030303031343931' TO DFHEIV0(25:11)
  1701     CALL 'kxdfhei1' USING DFHEIV0,
  1702           LIT-FILE,
  1703           DFHEIV20,
  1704           DFHEIV99,
  1705           BROWSE-KEY,
  1706           DFHEIV99,
  1707           DFHEIV99,
  1708           DFHEIV99
  1709     SET ADDRESS OF PROGRAM-DESCRIPTIONS TO
  1710         DFHEIV20
  1711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1712
  1713
  1714 1200-EXIT.
  1715     EXIT.
  1716
  1717 2000-JOURNAL-WRITE.
  1718     MOVE LIT-SYS                TO JP-USER-ID.
  1719     MOVE LIT-FILE               TO JP-FILE-ID.
  1720     MOVE LIT-PROG               TO JP-PROGRAM-ID.
  1721
  1722*    IF PI-JOURNAL-FILE-ID NOT = ZERO
  1723*        EXEC CICS JOURNAL
  1724*            JFILEID  (1)
  1725*            JTYPEID  ('EL')
  1726*            FROM     (JOURNAL-RECORD)
  1727*            LENGTH   (JOURNAL-LENGTH)
  1728*        END-EXEC.
  1729
  1730 2010-EXIT.
  1731     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL112.cbl
  1733 3000-BUILD-FWD-PAGE.
  1734
  1735* EXEC CICS HANDLE CONDITION
  1736*        ENDFILE  (3010-END-FILE)
  1737*        NOTFND   (3010-END-FILE)
  1738*    END-EXEC.
  1739*    MOVE '"$''I                  ! ( #00001518' TO DFHEIV0
  1740     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  1741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1742     MOVE X'2820233030303031353138' TO DFHEIV0(25:11)
  1743     CALL 'kxdfhei1' USING DFHEIV0
  1744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1745
  1746
  1747
  1748* EXEC CICS READNEXT
  1749*        DATASET  (LIT-FILE)
  1750*        RIDFLD   (BROWSE-KEY)
  1751*        SET      (ADDRESS OF PROGRAM-DESCRIPTIONS)
  1752*    END-EXEC.
  1753     MOVE 0
  1754       TO DFHEIV11
  1755*    MOVE '&.S                   )   #00001523' TO DFHEIV0
  1756     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1757     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1758     MOVE X'2020233030303031353233' TO DFHEIV0(25:11)
  1759     CALL 'kxdfhei1' USING DFHEIV0,
  1760           LIT-FILE,
  1761           DFHEIV20,
  1762           DFHEIV99,
  1763           BROWSE-KEY,
  1764           DFHEIV99,
  1765           DFHEIV11,
  1766           DFHEIV99,
  1767           DFHEIV99
  1768     SET ADDRESS OF PROGRAM-DESCRIPTIONS TO
  1769         DFHEIV20
  1770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1771
  1772
  1773     MOVE SPACES                 TO DISPLAY-LINE.
  1774     MOVE PN-PROGRAM-NUMBER      TO PGM-NO.
  1775     MOVE PN-PROGRAM-DESCRIPTION     TO PGM-DESC.
  1776     MOVE PN-TRANSACTION-CODE    TO PGM-TRANS.
  1777     MOVE PN-ENTRY-METHOD TO CHECK-CALL.
  1778
  1779     IF CICS-CALL
  1780         MOVE LIT-CICS           TO PGM-CALLED
  1781     ELSE
  1782         IF MENU-CALL
  1783             MOVE LIT-MENU       TO PGM-CALLED
  1784         ELSE
  1785             MOVE LIT-BATCH      TO PGM-CALLED.
  1786
  1787     ADD 1                       TO COUNT-1.
  1788     MOVE DISPLAY-LINE           TO PGMDESCO (COUNT-1).
  1789
  1790     IF COUNT-1 = 1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL112.cbl
  1791         MOVE PN-PROGRAM-NUMBER  TO SAVE-BEGIN.
  1792
  1793     IF COUNT-1 GREATER 10
  1794         MOVE PN-PROGRAM-NUMBER  TO SAVE-ENDING
  1795         MOVE LIT-F              TO SCREEN-SWITCH.
  1796
  1797     GO TO 3020-EXIT.
  1798
  1799 3010-END-FILE.
  1800     PERFORM 3100-FILL-SCREEN THRU 3110-EXIT
  1801         UNTIL SCREEN-FULL.
  1802     MOVE PGM-NO                 TO BROWSE-KEY.
  1803     MOVE BROWSE-KEY             TO SAVE-ENDING.
  1804     MOVE END-MSG                TO MSGO.
  1805     MOVE LIT-E                  TO SCREEN-SWITCH.
  1806
  1807 3020-EXIT.
  1808     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL112.cbl
  1810 3030-BUILD-BCK-PAGE.
  1811
  1812* EXEC CICS HANDLE CONDITION
  1813*        ENDFILE  (3040-END-FILE)
  1814*        NOTFND   (3040-END-FILE)
  1815*    END-EXEC.
  1816*    MOVE '"$''I                  ! ) #00001567' TO DFHEIV0
  1817     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  1818     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1819     MOVE X'2920233030303031353637' TO DFHEIV0(25:11)
  1820     CALL 'kxdfhei1' USING DFHEIV0
  1821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1822
  1823
  1824
  1825* EXEC CICS READPREV
  1826*        DATASET  (LIT-FILE)
  1827*        RIDFLD   (BROWSE-KEY)
  1828*        SET      (ADDRESS OF PROGRAM-DESCRIPTIONS)
  1829*    END-EXEC.
  1830     MOVE 0
  1831       TO DFHEIV11
  1832*    MOVE '&0S                   )   #00001572' TO DFHEIV0
  1833     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  1834     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1835     MOVE X'2020233030303031353732' TO DFHEIV0(25:11)
  1836     CALL 'kxdfhei1' USING DFHEIV0,
  1837           LIT-FILE,
  1838           DFHEIV20,
  1839           DFHEIV99,
  1840           BROWSE-KEY,
  1841           DFHEIV99,
  1842           DFHEIV11,
  1843           DFHEIV99,
  1844           DFHEIV99
  1845     SET ADDRESS OF PROGRAM-DESCRIPTIONS TO
  1846         DFHEIV20
  1847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1848
  1849
  1850     MOVE SPACES                 TO DISPLAY-LINE.
  1851     MOVE PN-PROGRAM-NUMBER      TO PGM-NO.
  1852     MOVE PN-PROGRAM-DESCRIPTION TO PGM-DESC.
  1853     MOVE PN-TRANSACTION-CODE    TO PGM-TRANS.
  1854     MOVE PN-ENTRY-METHOD        TO CHECK-CALL.
  1855
  1856     IF CICS-CALL
  1857         MOVE LIT-CICS           TO PGM-CALLED
  1858     ELSE
  1859         IF MENU-CALL
  1860             MOVE LIT-MENU       TO PGM-CALLED
  1861         ELSE
  1862             MOVE LIT-BATCH      TO PGM-CALLED.
  1863
  1864     MOVE DISPLAY-LINE           TO PGMDESCO (COUNT-1).
  1865
  1866     IF COUNT-1 = 11
  1867         MOVE PN-PROGRAM-NUMBER  TO SAVE-ENDING.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL112.cbl
  1868
  1869     IF COUNT-1 = 1
  1870         MOVE PN-PROGRAM-NUMBER  TO SAVE-BEGIN
  1871         MOVE LIT-F              TO SCREEN-SWITCH.
  1872
  1873     SUBTRACT 1 FROM COUNT-1.
  1874     GO TO 3050-EXIT.
  1875
  1876 3040-END-FILE.
  1877     MOVE PGM-NO                 TO BROWSE-KEY.
  1878     MOVE BROWSE-KEY             TO SAVE-BEGIN.
  1879     MOVE END-MSG                TO MSGO.
  1880     MOVE LIT-E                  TO SCREEN-SWITCH.
  1881
  1882 3050-EXIT.
  1883     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL112.cbl
  1885 3060-RAISE-PAGE.
  1886     MOVE 1                      TO COUNT-1.
  1887     MOVE 2                      TO COUNT-2.
  1888     PERFORM 3080-SHIFT-SCREEN THRU 3090-EXIT
  1889          UNTIL COUNT-1 GREATER 10.
  1890     MOVE SPACES                 TO PGMDESCO (COUNT-1).
  1891
  1892 3070-EXIT.
  1893     EXIT.
  1894
  1895 3080-SHIFT-SCREEN.
  1896     MOVE PGMDESCO (COUNT-2)     TO PGMDESCO (COUNT-1).
  1897     ADD 1                       TO COUNT-1 COUNT-2.
  1898
  1899 3090-EXIT.
  1900     EXIT.
  1901
  1902 3100-FILL-SCREEN.
  1903     ADD 1                       TO COUNT-1.
  1904     MOVE SPACES                 TO PGMDESCO (COUNT-1).
  1905
  1906     IF COUNT-1 GREATER 10
  1907         MOVE LIT-F              TO SCREEN-SWITCH.
  1908
  1909 3110-EXIT.
  1910     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL112.cbl
  1912 8100-SEND-MAP.
  1913     PERFORM 8130-FORMAT-DATE-TIME THRU 8140-EXIT.
  1914
  1915
  1916* EXEC CICS SEND
  1917*        MAP     ('EL112A')
  1918*        MAPSET  ('EL112S')
  1919*        ERASE
  1920*        FREEKB
  1921*        CURSOR
  1922*    END-EXEC.
  1923     MOVE 'EL112A' TO DFHEIV1
  1924     MOVE -1
  1925       TO DFHEIV11
  1926     MOVE 'EL112S' TO DFHEIV2
  1927*    MOVE '8$     CT  E F  H     ,   #00001643' TO DFHEIV0
  1928     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1929     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  1930     MOVE X'2020233030303031363433' TO DFHEIV0(25:11)
  1931     CALL 'kxdfhei1' USING DFHEIV0,
  1932           DFHEIV1,
  1933           EL112AO,
  1934           DFHEIV99,
  1935           DFHEIV2,
  1936           DFHEIV99,
  1937           DFHEIV99,
  1938           DFHEIV99,
  1939           DFHEIV11,
  1940           DFHEIV99,
  1941           DFHEIV99,
  1942           DFHEIV99
  1943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1944
  1945
  1946     GO TO 8120-RETURN-TRANS.
  1947
  1948 8110-SEND-DATA.
  1949     PERFORM 8130-FORMAT-DATE-TIME THRU 8140-EXIT.
  1950
  1951* EXEC CICS SEND
  1952*        MAP     ('EL112A')
  1953*        MAPSET  ('EL112S')
  1954*        DATAONLY
  1955*        ERASEAUP
  1956*        FREEKB
  1957*        CURSOR
  1958*    END-EXEC.
  1959     MOVE 'EL112A' TO DFHEIV1
  1960     MOVE -1
  1961       TO DFHEIV11
  1962     MOVE 'EL112S' TO DFHEIV2
  1963*    MOVE '8$D    CT  A F  H     ,   #00001655' TO DFHEIV0
  1964     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  1965     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  1966     MOVE X'2020233030303031363535' TO DFHEIV0(25:11)
  1967     CALL 'kxdfhei1' USING DFHEIV0,
  1968           DFHEIV1,
  1969           EL112AO,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL112.cbl
  1970           DFHEIV99,
  1971           DFHEIV2,
  1972           DFHEIV99,
  1973           DFHEIV99,
  1974           DFHEIV99,
  1975           DFHEIV11,
  1976           DFHEIV99,
  1977           DFHEIV99,
  1978           DFHEIV99
  1979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1980
  1981
  1982 8120-RETURN-TRANS.
  1983     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  1984
  1985* EXEC CICS RETURN
  1986*        TRANSID   (LIT-TRANS)
  1987*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  1988*        LENGTH    (PI-COMM-LENGTH)
  1989*    END-EXEC.
  1990*    MOVE '.(CT                  &   #00001666' TO DFHEIV0
  1991     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1992     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1993     MOVE X'2020233030303031363636' TO DFHEIV0(25:11)
  1994     CALL 'kxdfhei1' USING DFHEIV0,
  1995           LIT-TRANS,
  1996           PROGRAM-INTERFACE-BLOCK,
  1997           PI-COMM-LENGTH,
  1998           DFHEIV99,
  1999           DFHEIV99
  2000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2001
  2002
  2003
  2004* GOBACK.
  2005     MOVE '9%                    "   ' TO DFHEIV0
  2006     MOVE 'EL112' TO DFHEIV1
  2007     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2008     GOBACK.
  2009
  2010 8130-FORMAT-DATE-TIME.
  2011     MOVE SAVE-DATE              TO DATEO.
  2012
  2013* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
  2014*    END-EXEC
  2015*    MOVE '0"A                   "   #00001676' TO DFHEIV0
  2016     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
  2017     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  2018     MOVE X'2020233030303031363736' TO DFHEIV0(25:11)
  2019     CALL 'kxdfhei1' USING DFHEIV0,
  2020           LCP-CICS-TIME
  2021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2022
  2023* EXEC CICS FORMATTIME
  2024*              ABSTIME(LCP-CICS-TIME)
  2025*              TIME(LCP-TIME-OF-DAY-XX)
  2026*    END-EXEC
  2027*    MOVE 'j$(     (             #   #00001678' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL112.cbl
  2028     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
  2029     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2030     MOVE X'2020233030303031363738' TO DFHEIV0(25:11)
  2031     CALL 'kxdfhei1' USING DFHEIV0,
  2032           LCP-CICS-TIME,
  2033           LCP-TIME-OF-DAY-XX
  2034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2035     MOVE  LCP-TIME-OF-DAY-68 TO TIME-UNFORMATTED.
  2036     MOVE UN-HOURS               TO FOR-HOURS.
  2037     MOVE UN-MINUTES             TO FOR-MINUTES.
  2038     MOVE TIME-FORMATTED         TO TIMEO.
  2039
  2040 8140-EXIT.
  2041     EXIT.
  2042
  2043 8200-NO-UPDATES.
  2044
  2045* EXEC CICS SEND TEXT
  2046*        FROM    (SCREEN-TERM)
  2047*        LENGTH  (TERM-LENGTH)
  2048*        ERASE
  2049*        FREEKB
  2050*    END-EXEC.
  2051*    MOVE '8&      T  E F  H   F -   #00001691' TO DFHEIV0
  2052     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2053     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2054     MOVE X'2020233030303031363931' TO DFHEIV0(25:11)
  2055     CALL 'kxdfhei1' USING DFHEIV0,
  2056           SCREEN-TERM,
  2057           TERM-LENGTH,
  2058           DFHEIV99,
  2059           DFHEIV99,
  2060           DFHEIV99,
  2061           DFHEIV99,
  2062           DFHEIV99,
  2063           DFHEIV99,
  2064           DFHEIV99,
  2065           DFHEIV99,
  2066           DFHEIV99,
  2067           DFHEIV99
  2068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2069
  2070
  2071 8220-RETURN-CICS.
  2072
  2073* EXEC CICS RETURN
  2074*    END-EXEC.
  2075*    MOVE '.(                    &   #00001699' TO DFHEIV0
  2076     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2077     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2078     MOVE X'2020233030303031363939' TO DFHEIV0(25:11)
  2079     CALL 'kxdfhei1' USING DFHEIV0,
  2080           DFHEIV99,
  2081           DFHEIV99,
  2082           DFHEIV99,
  2083           DFHEIV99,
  2084           DFHEIV99
  2085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL112.cbl
  2086
  2087
  2088
  2089* GOBACK.
  2090     MOVE '9%                    "   ' TO DFHEIV0
  2091     MOVE 'EL112' TO DFHEIV1
  2092     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2093     GOBACK.
  2094
  2095 8230-NOT-OPEN.
  2096
  2097* EXEC CICS SEND TEXT
  2098*        FROM    (FILE-MSG)
  2099*        LENGTH  (FILE-LENGTH)
  2100*        ERASE
  2101*        FREEKB
  2102*    END-EXEC.
  2103*    MOVE '8&      T  E F  H   F -   #00001705' TO DFHEIV0
  2104     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2105     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2106     MOVE X'2020233030303031373035' TO DFHEIV0(25:11)
  2107     CALL 'kxdfhei1' USING DFHEIV0,
  2108           FILE-MSG,
  2109           FILE-LENGTH,
  2110           DFHEIV99,
  2111           DFHEIV99,
  2112           DFHEIV99,
  2113           DFHEIV99,
  2114           DFHEIV99,
  2115           DFHEIV99,
  2116           DFHEIV99,
  2117           DFHEIV99,
  2118           DFHEIV99,
  2119           DFHEIV99
  2120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2121
  2122
  2123     GO TO 8220-RETURN-CICS.
  2124
  2125 9000-XCTL.
  2126
  2127* EXEC CICS XCTL
  2128*        PROGRAM  (CALL-PROG)
  2129*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2130*        LENGTH   (PI-COMM-LENGTH)
  2131*    END-EXEC.
  2132*    MOVE '.$C                   $   #00001715' TO DFHEIV0
  2133     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2134     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2135     MOVE X'2020233030303031373135' TO DFHEIV0(25:11)
  2136     CALL 'kxdfhei1' USING DFHEIV0,
  2137           CALL-PROG,
  2138           PROGRAM-INTERFACE-BLOCK,
  2139           PI-COMM-LENGTH
  2140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2141
  2142
  2143
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL112.cbl
  2144* GOBACK.
  2145     MOVE '9%                    "   ' TO DFHEIV0
  2146     MOVE 'EL112' TO DFHEIV1
  2147     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2148     GOBACK.
  2149
  2150 9100-RETURN-CICS SECTION.
  2151     MOVE 'EL005'                TO  CALL-PROG.
  2152     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2153     GO TO 9000-XCTL.
  2154
  2155 9100-EXIT.
  2156     EXIT.
  2157
  2158 9400-CLEAR SECTION.
  2159     MOVE PI-RETURN-TO-PROGRAM  TO  CALL-PROG.
  2160     GO TO 9000-XCTL.
  2161
  2162 9400-EXIT.
  2163     EXIT.
  2164
  2165 9700-LINK-DATE-CONVERT.
  2166
  2167* EXEC CICS LINK
  2168*        PROGRAM    ('ELDATCV')
  2169*        COMMAREA   (DATE-CONVERSION-DATA)
  2170*        LENGTH     (DC-COMM-LENGTH)
  2171*        END-EXEC.
  2172     MOVE 'ELDATCV' TO DFHEIV1
  2173*    MOVE '."C                   ''   #00001739' TO DFHEIV0
  2174     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2175     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2176     MOVE X'2020233030303031373339' TO DFHEIV0(25:11)
  2177     CALL 'kxdfhei1' USING DFHEIV0,
  2178           DFHEIV1,
  2179           DATE-CONVERSION-DATA,
  2180           DC-COMM-LENGTH,
  2181           DFHEIV99,
  2182           DFHEIV99,
  2183           DFHEIV99
  2184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2185
  2186
  2187 9700-EXIT.
  2188     EXIT.
  2189
  2190 9999-DFHBACK SECTION.
  2191     MOVE '9%                    "   ' TO DFHEIV0
  2192     MOVE 'EL112' TO DFHEIV1
  2193     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2194     GOBACK.
  2195 9999-DFHEXIT.
  2196     IF DFHEIGDJ EQUAL 0001
  2197         NEXT SENTENCE
  2198     ELSE IF DFHEIGDJ EQUAL 2
  2199         GO TO 8230-NOT-OPEN,
  2200               0110-REC-NOT-FND
  2201         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL112.cbl
  2202     ELSE IF DFHEIGDJ EQUAL 3
  2203         GO TO 8230-NOT-OPEN,
  2204               0210-REC-NOT-FND
  2205         DEPENDING ON DFHEIGDI
  2206     ELSE IF DFHEIGDJ EQUAL 4
  2207         GO TO 1040-RECORD-NOT-FOUND,
  2208               1040-RECORD-NOT-FOUND
  2209         DEPENDING ON DFHEIGDI
  2210     ELSE IF DFHEIGDJ EQUAL 5
  2211         GO TO 8230-NOT-OPEN,
  2212               1130-FILE-FULL
  2213         DEPENDING ON DFHEIGDI
  2214     ELSE IF DFHEIGDJ EQUAL 6
  2215         GO TO 8230-NOT-OPEN
  2216         DEPENDING ON DFHEIGDI
  2217     ELSE IF DFHEIGDJ EQUAL 7
  2218         GO TO 8230-NOT-OPEN
  2219         DEPENDING ON DFHEIGDI
  2220     ELSE IF DFHEIGDJ EQUAL 8
  2221         GO TO 3010-END-FILE,
  2222               3010-END-FILE
  2223         DEPENDING ON DFHEIGDI
  2224     ELSE IF DFHEIGDJ EQUAL 9
  2225         GO TO 3040-END-FILE,
  2226               3040-END-FILE
  2227         DEPENDING ON DFHEIGDI.
  2228     MOVE '9%                    "   ' TO DFHEIV0
  2229     MOVE 'EL112' TO DFHEIV1
  2230     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2231     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4220     Code:        6995
