* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page   1
* EL6503.cbl
* Options: int("EL6503.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6503.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6503.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6503.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6503.
     3*                            VMOD=2.001.
     4*AUTHOR.    PABLO.
     5*           OMAHA, NEBRASKA.
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    10*            *                                                   *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page   2
* EL6503.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE BRANCH LOCATION AND SHIPPING ADDRESSES FOR PRODUCERS
    19*
    20*    SCREENS     - EL650I - BRANCH LOCAL AND SHIPPING ADDR MAINT
    21*
    22*    ENTERED BY  - EL650 - ACCOUNT MAINTENANCE MENU
    23*
    24*    EXIT TO     - EL650 - ACCOUNT MAINTENANCE MENU
    25*
    26*    COMMAREA    - PASSED
    27*
    28*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL650.  ON
    29*                  FIRST ENTRY, READ ERACNT TO DISPLAY INFO,  THE
    30*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    31*                  ENTRIES (XCTL FROM CICS VIA EXC7) THE SCREEN
    32*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    33*                  MAINTENANCE TYPE INDICATED.
    34******************************************************************
    35*                   C H A N G E   L O G
    36*
    37* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    38*-----------------------------------------------------------------
    39*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    40* EFFECTIVE    NUMBER
    41*-----------------------------------------------------------------
    42* 110706  CR2006071700004  PEMA  NEW PROGRAM
    43* 111407  CR2007010300001  PEMA  USE ACCT SEC FOR THIS PROGRAM
    44* 052918  CR2018040600002  PEMA  ADD REFUND DIRECT INDICATOR
    45******************************************************************
    46 ENVIRONMENT DIVISION.
    47 DATA DIVISION.
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50 77  FILLER  PIC X(32)  VALUE '********************************'.
    51 77  FILLER  PIC X(32)  VALUE '*   EL6503 WORKING STORAGE     *'.
    52 77  FILLER  PIC X(32)  VALUE '***********VMOD=2.001 **********'.
    53 77  CI1                PIC S999  COMP-3 VALUE +0.
    54 77  B1                 PIC S999  COMP-3 VALUE +0.
    55 77  WS-BROWSE-SW                PIC X   VALUE SPACES.
    56     88  ERACNT-BROWSE-STARTED         VALUE 'Y'.
    57*    COPY ELCSCTM.
    58******************************************************************
    59*                                                                *
    60*                                                                *
    61*                            ELCSCTM                             *
    62*                            VMOD=2.001                          *
    63*                                                                *
    64*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    65*                                                                *
    66******************************************************************
    67 01  SECURITY-MESSAGE.
    68     12  FILLER                          PIC X(30)
    69            VALUE '** LOGIC SECURITY VIOLATION -'.
    70     12  SM-READ                         PIC X(6).
    71     12  FILLER                          PIC X(5)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page   3
* EL6503.cbl
    72            VALUE ' PGM='.
    73     12  SM-PGM                          PIC X(6).
    74     12  FILLER                          PIC X(5)
    75            VALUE ' OPR='.
    76     12  SM-PROCESSOR-ID                 PIC X(4).
    77     12  FILLER                          PIC X(6)
    78            VALUE ' TERM='.
    79     12  SM-TERMID                       PIC X(4).
    80     12  FILLER                          PIC XX   VALUE SPACE.
    81     12  SM-JUL-DATE                     PIC 9(5).
    82     12  FILLER                          PIC X    VALUE SPACE.
    83     12  SM-TIME                         PIC 99.99.
    84
    85*    COPY ELCSCRTY.
    86******************************************************************
    87*                                                                *
    88*                                                                *
    89*                            ELCSCRTY                            *
    90*                            VMOD=2.001                          *
    91*                                                                *
    92*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    93*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    94*        SAVED IN PI-SECURITY-ADDRESS.                           *
    95*                                                                *
    96******************************************************************
    97 01  SECURITY-CONTROL.
    98     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    99     12  FILLER                       PIC XX    VALUE 'SC'.
   100     12  SC-CREDIT-CODES.
   101         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   102             20  SC-CREDIT-DISPLAY    PIC X.
   103             20  SC-CREDIT-UPDATE     PIC X.
   104     12  SC-CLAIMS-CODES.
   105         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   106             20  SC-CLAIMS-DISPLAY    PIC X.
   107             20  SC-CLAIMS-UPDATE     PIC X.
   108 01  WS-DATE-AREA.
   109     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   110     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   111 01  WS-INC-DATE                 PIC XX  VALUE LOW-VALUES.
   112 01  WS-RPT-DATE                 PIC XX  VALUE LOW-VALUES.
   113 01  WS-EST-DATE                 PIC XX  VALUE LOW-VALUES.
   114 01  WS-PRF-DATE                 PIC XX  VALUE LOW-VALUES.
   115 01  WS-LSTPD-DATE               PIC XX  VALUE LOW-VALUES.
   116 01  FILLER                          COMP-3.
   117     05  WS-RECORD-COUNT             PIC S9(3)   VALUE ZERO.
   118     05  WS-READNEXT-SW              PIC S9      VALUE ZERO.
   119     05  WS-LAST-ERROR-COUNT         PIC S9(3)   VALUE ZERO.
   120     05  WS-UPDATE-SW                PIC S9      VALUE ZERO.
   121     05  WS-COMPLETED-SUCCESSFUL     PIC S9      VALUE ZERO.
   122       88  TRANSACTION-SUCCESSFUL                    VALUE +1.
   123       88  INITIAL-TRANSACTION                       VALUE +2.
   124       88  CHANGE-SUCCESSFUL                         VALUE +3.
   125     05  TIME-IN                     PIC S9(7)   VALUE ZERO.
   126     05  TIME-OUT                    REDEFINES
   127         TIME-IN                     PIC S9(3)V9(4).
   128 01  FILLER                          COMP SYNC.
   129     05  WS-INDEX                    PIC S9(4)   VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page   4
* EL6503.cbl
   130     05  WS-JOURNAL-FILE-ID          PIC S9(4)   VALUE +1.
   131     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +773.
   132     05  ERACNT-LENGTH               PIC S9(4)   VALUE +120.
   133     05  GETMAIN-SPACE               PIC  X      VALUE SPACE.
   134 01  FILLER.
   135     12  DEEDIT-FIELD        PIC  X(10).
   136     12  DEEDIT-FIELD-V0  REDEFINES
   137         DEEDIT-FIELD        PIC S9(10).
   138     12  DEEDIT-FIELD-V2  REDEFINES
   139         DEEDIT-FIELD        PIC 9(8)V99.
   140     05  WS-BIN-DATES OCCURS 10.
   141         10  WS-BIN-DATE         PIC XX.
   142     05  WS-RESPONSE             PIC S9(8)   COMP.
   143         88  RESP-NORMAL              VALUE +00.
   144         88  RESP-ERROR               VALUE +01.
   145         88  RESP-NOTFND              VALUE +13.
   146         88  RESP-NOTOPEN             VALUE +19.
   147         88  RESP-ENDFILE             VALUE +20.
   148     05  WS-SAVE-ERACNT-KEY      PIC X(23)   VALUE LOW-VALUES.
   149     05  WS-CONTROL-PRIMARY.
   150         10  WS-COMPANY-CD           PIC X      VALUE SPACES.
   151         10  WS-CARRIER              PIC X      VALUE SPACES.
   152         10  WS-GROUPING             PIC X(6)   VALUE SPACES.
   153         10  WS-STATE                PIC XX     VALUE SPACES.
   154         10  WS-ACCOUNT              PIC X(10)  VALUE SPACES.
   155         10  WS-REC-TYPE             PIC X      VALUE SPACES.
   156         10  WS-SEQ-NO               PIC S9(4)  VALUE +0 COMP.
   157     05  WS-CONTROL-FILE-KEY.
   158         10  WS-CFK-COMPANY-ID       PIC X(3)    VALUE SPACES.
   159         10  WS-CFK-RECORD-TYPE      PIC X       VALUE SPACES.
   160         10  WS-CFK-STATE            PIC XX      VALUE SPACES.
   161         10  WS-CFK-BENEFIT-CD       PIC XX      VALUE SPACES.
   162         10  WS-CFK-SEQUENCE-NO      PIC S9(4)   VALUE ZERO COMP.
   163     05  WS-MAPSET-NAME              PIC X(8)  VALUE 'EL6503S'.
   164     05  WS-MAP-NAME                 PIC X(8)  VALUE 'EL6503A'.
   165     05  FILLER                      REDEFINES
   166         WS-MAP-NAME.
   167         10  FILLER                  PIC XX.
   168         10  WS-MAP-NUMBER           PIC X(4).
   169         10  FILLER                  PIC XX.
   170     05  THIS-PGM                    PIC X(8)  VALUE 'EL6503'.
   171     05  WS-JOURNAL-TYPE-ID          PIC XX      VALUE 'EL'.
   172     05  WS-LOW-VALUES               PIC X VALUE LOW-VALUES.
   173     05  WS-SPACE                    PIC X       VALUE SPACE.
   174     05  WS-TRANS-ID                 PIC X(4)    VALUE 'EXC7'.
   175     05  WS-TEMP-STORAGE-KEY.
   176         10  WS-TS-TERM-ID           PIC X(4)    VALUE 'XXXX'.
   177         10  FILLER                  PIC X(4)    VALUE '6503'.
   178     05  WS-ERROR-MESSAGE-AREA.
   179         10  ER-0000             PIC 9(4)   VALUE 0000.
   180         10  ER-0004             PIC 9(4)   VALUE 0004.
   181         10  ER-0006             PIC 9(4)   VALUE 0006.
   182         10  ER-0008             PIC 9(4)   VALUE 0008.
   183         10  ER-0023             PIC 9(4)   VALUE 0023.
   184         10  ER-0029             PIC 9(4)   VALUE 0029.
   185         10  ER-0070             PIC 9(4)   VALUE 0070.
   186         10  ER-3271             PIC 9(4)   VALUE 3271.
   187         10  ER-9999             PIC 9(4)   VALUE 9999.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page   5
* EL6503.cbl
   188*                                COPY ELCINTF.
   189******************************************************************
   190*                                                                *
   191*                                                                *
   192*                            ELCINTF.                            *
   193*                            VMOD=2.017                          *
   194*                                                                *
   195*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   196*                                                                *
   197*       LENGTH = 1024                                            *
   198*                                                                *
   199******************************************************************
   200*                   C H A N G E   L O G
   201*
   202* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   203*-----------------------------------------------------------------
   204*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   205* EFFECTIVE    NUMBER
   206*-----------------------------------------------------------------
   207* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   208******************************************************************
   209 01  PROGRAM-INTERFACE-BLOCK.
   210     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   211     12  PI-CALLING-PROGRAM              PIC X(8).
   212     12  PI-SAVED-PROGRAM-1              PIC X(8).
   213     12  PI-SAVED-PROGRAM-2              PIC X(8).
   214     12  PI-SAVED-PROGRAM-3              PIC X(8).
   215     12  PI-SAVED-PROGRAM-4              PIC X(8).
   216     12  PI-SAVED-PROGRAM-5              PIC X(8).
   217     12  PI-SAVED-PROGRAM-6              PIC X(8).
   218     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   219     12  PI-COMPANY-ID                   PIC XXX.
   220     12  PI-COMPANY-CD                   PIC X.
   221
   222     12  PI-COMPANY-PASSWORD             PIC X(8).
   223
   224     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   225
   226     12  PI-CONTROL-IN-PROGRESS.
   227         16  PI-CARRIER                  PIC X.
   228         16  PI-GROUPING                 PIC X(6).
   229         16  PI-STATE                    PIC XX.
   230         16  PI-ACCOUNT                  PIC X(10).
   231         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   232                                         PIC X(10).
   233         16  PI-CLAIM-CERT-GRP.
   234             20  PI-CLAIM-NO             PIC X(7).
   235             20  PI-CERT-NO.
   236                 25  PI-CERT-PRIME       PIC X(10).
   237                 25  PI-CERT-SFX         PIC X.
   238             20  PI-CERT-EFF-DT          PIC XX.
   239         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   240             20  PI-PLAN-CODE            PIC X(2).
   241             20  PI-REVISION-NUMBER      PIC X(3).
   242             20  PI-PLAN-EFF-DT          PIC X(2).
   243             20  PI-PLAN-EXP-DT          PIC X(2).
   244             20  FILLER                  PIC X(11).
   245         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page   6
* EL6503.cbl
   246             20  PI-OE-REFERENCE-1.
   247                 25  PI-OE-REF-1-PRIME   PIC X(18).
   248                 25  PI-OE-REF-1-SUFF    PIC XX.
   249
   250     12  PI-SESSION-IN-PROGRESS          PIC X.
   251         88  CLAIM-SESSION                   VALUE '1'.
   252         88  CREDIT-SESSION                  VALUE '2'.
   253         88  WARRANTY-SESSION                VALUE '3'.
   254         88  MORTGAGE-SESSION                VALUE '4'.
   255         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   256
   257
   258*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   259
   260     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   261     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   262
   263     12  PI-CREDIT-USER                  PIC X.
   264         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   265         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   266
   267     12  PI-CLAIM-USER                   PIC X.
   268         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   269         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   270
   271     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   272         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   273         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   274         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   275         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   276         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   277
   278     12  PI-PROCESSOR-ID                 PIC X(4).
   279
   280     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   281
   282     12  PI-MEMBER-CAPTION               PIC X(10).
   283
   284     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   285         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   286
   287     12  PI-LIFE-OVERRIDE-L1             PIC X.
   288     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   289     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   290     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   291
   292     12  PI-AH-OVERRIDE-L1               PIC X.
   293     12  PI-AH-OVERRIDE-L2               PIC XX.
   294     12  PI-AH-OVERRIDE-L6               PIC X(6).
   295     12  PI-AH-OVERRIDE-L12              PIC X(12).
   296
   297     12  PI-NEW-SYSTEM                   PIC X(2).
   298
   299     12  PI-PRIMARY-CERT-NO              PIC X(11).
   300     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   301         88  PI-USES-PAID-TO                 VALUE '1'.
   302     12  PI-CRDTCRD-SYSTEM.
   303         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page   7
* EL6503.cbl
   304             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   305             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   306         16  PI-CC-MONTH-END-DT          PIC XX.
   307     12  PI-PROCESSOR-PRINTER            PIC X(4).
   308
   309     12  PI-OE-REFERENCE-2.
   310         16  PI-OE-REF-2-PRIME           PIC X(10).
   311         16  PI-OE-REF-2-SUFF            PIC X.
   312
   313     12  PI-REM-TRM-CALC-OPTION          PIC X.
   314
   315     12  PI-LANGUAGE-TYPE                PIC X.
   316             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   317             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   318             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   319
   320     12  PI-POLICY-LINKAGE-IND           PIC X.
   321         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   322         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   323                                                   LOW-VALUES.
   324
   325     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   326     12  PI-CLAIM-PW-SESSION             PIC X(1).
   327         88  PI-CLAIM-CREDIT                 VALUE '1'.
   328         88  PI-CLAIM-CONVEN                 VALUE '2'.
   329
   330     12  PI-PROCESSOR-CSR-IND            PIC X.
   331         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   332         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   333
   334     12  FILLER                          PIC X(3).
   335
   336     12  PI-SYSTEM-LEVEL                 PIC X(145).
   337
   338     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   339         PI-SYSTEM-LEVEL.
   340
   341         16  PI-ENTRY-CODES.
   342             20  PI-ENTRY-CD-1           PIC X.
   343             20  PI-ENTRY-CD-2           PIC X.
   344
   345         16  PI-RETURN-CODES.
   346             20  PI-RETURN-CD-1          PIC X.
   347             20  PI-RETURN-CD-2          PIC X.
   348
   349         16  PI-UPDATE-STATUS-SAVE.
   350             20  PI-UPDATE-BY            PIC X(4).
   351             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   352
   353         16  PI-LOWER-CASE-LETTERS       PIC X.
   354             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   355
   356*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   357*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   358*            88  CARRIER-CLM-CNTL            VALUE '2'.
   359
   360         16  PI-CERT-ACCESS-CONTROL      PIC X.
   361             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page   8
* EL6503.cbl
   362             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   363             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   364             88  ACCNT-CNTL                  VALUE '3'.
   365             88  CARR-ACCNT-CNTL             VALUE '4'.
   366
   367         16  PI-PROCESSOR-CAP-LIST.
   368             20  PI-SYSTEM-CONTROLS.
   369                24 PI-SYSTEM-DISPLAY     PIC X.
   370                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   371                24 PI-SYSTEM-MODIFY      PIC X.
   372                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   373             20  FILLER                  PIC XX.
   374             20  PI-DISPLAY-CAP          PIC X.
   375                 88  DISPLAY-CAP             VALUE 'Y'.
   376             20  PI-MODIFY-CAP           PIC X.
   377                 88  MODIFY-CAP              VALUE 'Y'.
   378             20  PI-MSG-AT-LOGON-CAP     PIC X.
   379                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   380             20  PI-FORCE-CAP            PIC X.
   381                 88  FORCE-CAP               VALUE 'Y'.
   382
   383         16  PI-PROGRAM-CONTROLS.
   384             20  PI-PGM-PRINT-OPT        PIC X.
   385             20  PI-PGM-FORMAT-OPT       PIC X.
   386             20  PI-PGM-PROCESS-OPT      PIC X.
   387             20  PI-PGM-TOTALS-OPT       PIC X.
   388
   389         16  PI-HELP-INTERFACE.
   390             20  PI-LAST-ERROR-NO        PIC X(4).
   391             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   392
   393         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   394             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   395
   396         16  PI-CR-CONTROL-IN-PROGRESS.
   397             20  PI-CR-CARRIER           PIC X.
   398             20  PI-CR-GROUPING          PIC X(6).
   399             20  PI-CR-STATE             PIC XX.
   400             20  PI-CR-ACCOUNT           PIC X(10).
   401             20  PI-CR-FIN-RESP          PIC X(10).
   402             20  PI-CR-TYPE              PIC X.
   403
   404         16  PI-CR-BATCH-NUMBER          PIC X(6).
   405
   406         16  PI-CR-MONTH-END-DT          PIC XX.
   407
   408         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   409             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   410             88  PI-ZERO-CARRIER             VALUE '1'.
   411             88  PI-ZERO-GROUPING            VALUE '2'.
   412             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   413
   414         16  PI-CARRIER-SECURITY         PIC X.
   415             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   416
   417         16  PI-ACCOUNT-SECURITY         PIC X(10).
   418             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   419             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page   9
* EL6503.cbl
   420
   421         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   422             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   423                                         INDEXED BY PI-ACCESS-NDX
   424                                         PIC X.
   425
   426         16  PI-GA-BILLING-CONTROL       PIC X.
   427             88  PI-GA-BILLING               VALUE '1'.
   428
   429         16  PI-MAIL-PROCESSING          PIC X.
   430             88  PI-MAIL-YES                 VALUE 'Y'.
   431
   432         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   433
   434         16  PI-AR-SYSTEM.
   435             20  PI-AR-PROCESSING-CNTL   PIC X.
   436                 88  PI-AR-PROCESSING        VALUE 'Y'.
   437             20  PI-AR-SUMMARY-CODE      PIC X(6).
   438             20  PI-AR-MONTH-END-DT      PIC XX.
   439
   440         16  PI-MP-SYSTEM.
   441             20  PI-MORTGAGE-USER            PIC X.
   442                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   443                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   444             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   445                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   446                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   447                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   448                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   449                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   450             20  PI-MP-MONTH-END-DT          PIC XX.
   451             20  PI-MP-REFERENCE-NO.
   452                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   453                 24  PI-MP-REFERENCE-SFX     PIC XX.
   454
   455         16  PI-LABEL-CONTROL            PIC X(01).
   456             88  PI-CREATE-LABELS                    VALUE 'Y'.
   457             88  PI-BYPASS-LABELS                    VALUE 'N'.
   458
   459         16  PI-BILL-GROUPING-CODE       PIC X(01).
   460             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   461
   462         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   463             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   464             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   465
   466         16  FILLER                      PIC X(14).
   467
   468     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   469******************************************************************
   470*                                COPY ELC650PI.
   471******************************************************************
   472*
   473*                            ELC650PI.
   474*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   475*                            VMOD=2.007
   476*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
   477*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  10
* EL6503.cbl
   478* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
   479*
   480******************************************************************
   481******************************************************************
   482*                   C H A N G E   L O G
   483*
   484* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   485*-----------------------------------------------------------------
   486*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   487* EFFECTIVE    NUMBER
   488*-----------------------------------------------------------------
   489* 101916  IR2016101900001  PEMA  Inc tot line to 3 bytes
   490
   491     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   492         16  PI-MAINT                   PIC X.
   493         16  PI-PREV-ACCOUNT            PIC X(20).
   494         16  PI-PREV-VG-ACCOUNT         PIC X(20).
   495         16  PI-ACCT-KEY.
   496             20  PI-ACCT-CCGSA-KEY.
   497                 24  PI-ACCT-CO             PIC X.
   498                 24  PI-ACCT-CARRIER        PIC X.
   499                 24  PI-ACCT-GROUPING       PIC X(6).
   500                 24  PI-ACCT-STATE          PIC XX.
   501                 24  PI-ACCT-ACCOUNT        PIC X(10).
   502             20  PI-ACCT-EXP-DT           PIC XX.
   503             20  PI-ACCT-REST-OF-EXP      PIC X(4).
   504         16  PI-ACCT-ID                 PIC X(8).
   505         16  PI-PLAN-KEY.
   506             20  PI-PLAN-ACCT-KEY.
   507                 24  PI-PLAN-COMPANY-CD PIC X.
   508                 24  PI-PLAN-CARRIER    PIC X.
   509                 24  PI-PLAN-GROUP      PIC X(6).
   510                 24  PI-PLAN-STATE      PIC X(2).
   511                 24  PI-PLAN-ACCOUNT    PIC X(10).
   512             20  PI-PLAN-BEN-TYPE       PIC X.
   513             20  PI-PLAN-BEN            PIC XX.
   514             20  PI-PLAN-REVISION       PIC X(3).
   515         16  PI-WS-STATE                PIC XX.
   516         16  PI-WS-CLASS                PIC XX.
   517         16  PI-WS-DEV                  PIC X(3).
   518         16  PI-WS-TYPE                 PIC X.
   519         16  PI-WS-PLAN                 PIC XX.
   520
   521         16  PI-ERPNDB-ALT-KEY.
   522             20  PI-PB-COMPANY-CD-A1    PIC X.
   523             20  PI-PB-CARRIER          PIC X.
   524             20  PI-PB-GROUPING         PIC X(6).
   525             20  PI-PB-STATE            PIC XX.
   526             20  PI-PB-ACCOUNT          PIC X(10).
   527             20  PI-PB-CERT-EFF-DT      PIC XX.
   528             20  PI-PB-CERT-NO          PIC X(10).
   529             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
   530             20  PI-PB-RECORD-TYPE      PIC X.
   531
   532         16  PI-DATE-RANGE-TABLE.
   533             20  PI-TABLE-ENT OCCURS 32 TIMES
   534                            INDEXED BY T-INDEX.
   535                 24  PI-BIN-EFF-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  11
* EL6503.cbl
   536                 24  PI-BIN-EXP-DT          PIC XX.
   537                 24  PI-BIN-MAINT-DT        PIC XX.
   538                 24  PI-BIN-LO-CERT         PIC XX.
   539                 24  PI-BIN-AR-HI-CERT      PIC XX.
   540                 24  PI-BIN-HI-CERT         PIC XX.
   541         16  PI-PAGE-NUMBER             PIC S9.
   542             88  PI-FST-PAGE               VALUE +1.
   543             88  PI-2ND-PAGE               VALUE +2.
   544             88  PI-3RD-PAGE               VALUE +3.
   545             88  PI-LST-PAGE               VALUE +4.
   546         16  PI-TOTAL-LINES             PIC S999.
   547         16  PI-LINE-SELECTED    PIC S9.
   548***  Y2K PROJ 7744
   549         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
   550         16  BIN-EFFCHG-SAVE     PIC XX.
   551         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
   552***  Y2K PROJ 7744
   553         16  BIN-EXPCHG-SAVE     PIC XX.
   554         16  PI-RECORD-ADDED-SW  PIC X.
   555             88  PI-RECORD-ADDED            VALUE '1'.
   556             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
   557         16  PI-ACCNAME          PIC X(30).
   558         16  PI-COMM-POINTER     PIC S9(8)   COMP.
   559         16  PI-SV-MAINT         PIC X.
   560         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   561         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   562         16  PI-UPDATE-SW        PIC X.
   563             88  PI-CHANGES-MADE             VALUE '1'.
   564         16  PI-NOTE-TYPE        PIC X.
   565             88  PI-ACCT-NOTE                VALUE '1'.
   566         16  PI-DMD-FILE-SW      PIC X.
   567             88  END-OF-FILE                 VALUE 'E'.
   568             88  INTO-NEXT-BENEFITS          VALUE 'I'.
   569             88  FIRST-OCCURS                VALUE 'F'.
   570         16  PI-DMD-OCCURS       PIC S999.
   571         16  PI-DMD-SCREEN       PIC X.
   572             88  SCREEN-1-DISPLAYED  VALUE '1'.
   573             88  SCREEN-2-DISPLAYED  VALUE '2'.
   574             88  SCREEN-3-DISPLAYED  VALUE '3'.
   575         16  PI-NAMEFLG          PIC X.
   576         16  PI-EL650-DEL-SW     PIC X.
   577         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
   578         16  PI-DCC-PROD-CODE    PIC XXX.
   579         16  FILLER              PIC X(34).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  12
* EL6503.cbl
   581*                                COPY EL6503S.
   582 01  EL6503AI.
   583     05  FILLER            PIC  X(0012).
   584*    -------------------------------
   585     05  RUNDATEL PIC S9(0004) COMP.
   586     05  RUNDATEF PIC  X(0001).
   587     05  FILLER REDEFINES RUNDATEF.
   588         10  RUNDATEA PIC  X(0001).
   589     05  RUNDATEI PIC  X(0008).
   590*    -------------------------------
   591     05  RUNTIMEL PIC S9(0004) COMP.
   592     05  RUNTIMEF PIC  X(0001).
   593     05  FILLER REDEFINES RUNTIMEF.
   594         10  RUNTIMEA PIC  X(0001).
   595     05  RUNTIMEI PIC  X(0005).
   596*    -------------------------------
   597     05  CMPNYIDL PIC S9(0004) COMP.
   598     05  CMPNYIDF PIC  X(0001).
   599     05  FILLER REDEFINES CMPNYIDF.
   600         10  CMPNYIDA PIC  X(0001).
   601     05  CMPNYIDI PIC  X(0003).
   602*    -------------------------------
   603     05  USERIDL PIC S9(0004) COMP.
   604     05  USERIDF PIC  X(0001).
   605     05  FILLER REDEFINES USERIDF.
   606         10  USERIDA PIC  X(0001).
   607     05  USERIDI PIC  X(0004).
   608*    -------------------------------
   609     05  MAINTYPL PIC S9(0004) COMP.
   610     05  MAINTYPF PIC  X(0001).
   611     05  FILLER REDEFINES MAINTYPF.
   612         10  MAINTYPA PIC  X(0001).
   613     05  MAINTYPI PIC  X(0001).
   614*    -------------------------------
   615     05  LSTDTEL PIC S9(0004) COMP.
   616     05  LSTDTEF PIC  X(0001).
   617     05  FILLER REDEFINES LSTDTEF.
   618         10  LSTDTEA PIC  X(0001).
   619     05  LSTDTEI PIC  X(0008).
   620*    -------------------------------
   621     05  LSTTIMEL PIC S9(0004) COMP.
   622     05  LSTTIMEF PIC  X(0001).
   623     05  FILLER REDEFINES LSTTIMEF.
   624         10  LSTTIMEA PIC  X(0001).
   625     05  LSTTIMEI PIC  X(0005).
   626*    -------------------------------
   627     05  LSTUSRL PIC S9(0004) COMP.
   628     05  LSTUSRF PIC  X(0001).
   629     05  FILLER REDEFINES LSTUSRF.
   630         10  LSTUSRA PIC  X(0001).
   631     05  LSTUSRI PIC  X(0004).
   632*    -------------------------------
   633     05  CARRIERL PIC S9(0004) COMP.
   634     05  CARRIERF PIC  X(0001).
   635     05  FILLER REDEFINES CARRIERF.
   636         10  CARRIERA PIC  X(0001).
   637     05  CARRIERI PIC  X(0001).
   638*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  13
* EL6503.cbl
   639     05  GROUPL PIC S9(0004) COMP.
   640     05  GROUPF PIC  X(0001).
   641     05  FILLER REDEFINES GROUPF.
   642         10  GROUPA PIC  X(0001).
   643     05  GROUPI PIC  X(0006).
   644*    -------------------------------
   645     05  STATEL PIC S9(0004) COMP.
   646     05  STATEF PIC  X(0001).
   647     05  FILLER REDEFINES STATEF.
   648         10  STATEA PIC  X(0001).
   649     05  STATEI PIC  X(0002).
   650*    -------------------------------
   651     05  ACCTNOL PIC S9(0004) COMP.
   652     05  ACCTNOF PIC  X(0001).
   653     05  FILLER REDEFINES ACCTNOF.
   654         10  ACCTNOA PIC  X(0001).
   655     05  ACCTNOI PIC  X(0010).
   656*    -------------------------------
   657     05  ACTSPCL PIC S9(0004) COMP.
   658     05  ACTSPCF PIC  X(0001).
   659     05  FILLER REDEFINES ACTSPCF.
   660         10  ACTSPCA PIC  X(0001).
   661     05  ACTSPCI PIC  X(0001).
   662*    -------------------------------
   663     05  BLINE1L PIC S9(0004) COMP.
   664     05  BLINE1F PIC  X(0001).
   665     05  FILLER REDEFINES BLINE1F.
   666         10  BLINE1A PIC  X(0001).
   667     05  BLINE1I PIC  X(0060).
   668*    -------------------------------
   669     05  BLINE2L PIC S9(0004) COMP.
   670     05  BLINE2F PIC  X(0001).
   671     05  FILLER REDEFINES BLINE2F.
   672         10  BLINE2A PIC  X(0001).
   673     05  BLINE2I PIC  X(0060).
   674*    -------------------------------
   675     05  SNAME1L PIC S9(0004) COMP.
   676     05  SNAME1F PIC  X(0001).
   677     05  FILLER REDEFINES SNAME1F.
   678         10  SNAME1A PIC  X(0001).
   679     05  SNAME1I PIC  X(0060).
   680*    -------------------------------
   681     05  SNAME2L PIC S9(0004) COMP.
   682     05  SNAME2F PIC  X(0001).
   683     05  FILLER REDEFINES SNAME2F.
   684         10  SNAME2A PIC  X(0001).
   685     05  SNAME2I PIC  X(0060).
   686*    -------------------------------
   687     05  SADDR1L PIC S9(0004) COMP.
   688     05  SADDR1F PIC  X(0001).
   689     05  FILLER REDEFINES SADDR1F.
   690         10  SADDR1A PIC  X(0001).
   691     05  SADDR1I PIC  X(0060).
   692*    -------------------------------
   693     05  SADDR2L PIC S9(0004) COMP.
   694     05  SADDR2F PIC  X(0001).
   695     05  FILLER REDEFINES SADDR2F.
   696         10  SADDR2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  14
* EL6503.cbl
   697     05  SADDR2I PIC  X(0060).
   698*    -------------------------------
   699     05  SADDR3L PIC S9(0004) COMP.
   700     05  SADDR3F PIC  X(0001).
   701     05  FILLER REDEFINES SADDR3F.
   702         10  SADDR3A PIC  X(0001).
   703     05  SADDR3I PIC  X(0060).
   704*    -------------------------------
   705     05  SCITYL PIC S9(0004) COMP.
   706     05  SCITYF PIC  X(0001).
   707     05  FILLER REDEFINES SCITYF.
   708         10  SCITYA PIC  X(0001).
   709     05  SCITYI PIC  X(0060).
   710*    -------------------------------
   711     05  SSTATEL PIC S9(0004) COMP.
   712     05  SSTATEF PIC  X(0001).
   713     05  FILLER REDEFINES SSTATEF.
   714         10  SSTATEA PIC  X(0001).
   715     05  SSTATEI PIC  X(0002).
   716*    -------------------------------
   717     05  SZIPL PIC S9(0004) COMP.
   718     05  SZIPF PIC  X(0001).
   719     05  FILLER REDEFINES SZIPF.
   720         10  SZIPA PIC  X(0001).
   721     05  SZIPI PIC  X(0010).
   722*    -------------------------------
   723     05  ERRMSG1L PIC S9(0004) COMP.
   724     05  ERRMSG1F PIC  X(0001).
   725     05  FILLER REDEFINES ERRMSG1F.
   726         10  ERRMSG1A PIC  X(0001).
   727     05  ERRMSG1I PIC  X(0072).
   728*    -------------------------------
   729     05  PFKEYL PIC S9(0004) COMP.
   730     05  PFKEYF PIC  X(0001).
   731     05  FILLER REDEFINES PFKEYF.
   732         10  PFKEYA PIC  X(0001).
   733     05  PFKEYI PIC  99.
   734 01  EL6503AO REDEFINES EL6503AI.
   735     05  FILLER            PIC  X(0012).
   736*    -------------------------------
   737     05  FILLER            PIC  X(0003).
   738     05  RUNDATEO PIC  X(0008).
   739*    -------------------------------
   740     05  FILLER            PIC  X(0003).
   741     05  RUNTIMEO PIC  99.99.
   742*    -------------------------------
   743     05  FILLER            PIC  X(0003).
   744     05  CMPNYIDO PIC  X(0003).
   745*    -------------------------------
   746     05  FILLER            PIC  X(0003).
   747     05  USERIDO PIC  X(0004).
   748*    -------------------------------
   749     05  FILLER            PIC  X(0003).
   750     05  MAINTYPO PIC  X(0001).
   751*    -------------------------------
   752     05  FILLER            PIC  X(0003).
   753     05  LSTDTEO PIC  X(0008).
   754*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  15
* EL6503.cbl
   755     05  FILLER            PIC  X(0003).
   756     05  LSTTIMEO PIC  99.99.
   757*    -------------------------------
   758     05  FILLER            PIC  X(0003).
   759     05  LSTUSRO PIC  X(0004).
   760*    -------------------------------
   761     05  FILLER            PIC  X(0003).
   762     05  CARRIERO PIC  X(0001).
   763*    -------------------------------
   764     05  FILLER            PIC  X(0003).
   765     05  GROUPO PIC  X(0006).
   766*    -------------------------------
   767     05  FILLER            PIC  X(0003).
   768     05  STATEO PIC  X(0002).
   769*    -------------------------------
   770     05  FILLER            PIC  X(0003).
   771     05  ACCTNOO PIC  X(0010).
   772*    -------------------------------
   773     05  FILLER            PIC  X(0003).
   774     05  ACTSPCO PIC  X(0001).
   775*    -------------------------------
   776     05  FILLER            PIC  X(0003).
   777     05  BLINE1O PIC  X(0060).
   778*    -------------------------------
   779     05  FILLER            PIC  X(0003).
   780     05  BLINE2O PIC  X(0060).
   781*    -------------------------------
   782     05  FILLER            PIC  X(0003).
   783     05  SNAME1O PIC  X(0060).
   784*    -------------------------------
   785     05  FILLER            PIC  X(0003).
   786     05  SNAME2O PIC  X(0060).
   787*    -------------------------------
   788     05  FILLER            PIC  X(0003).
   789     05  SADDR1O PIC  X(0060).
   790*    -------------------------------
   791     05  FILLER            PIC  X(0003).
   792     05  SADDR2O PIC  X(0060).
   793*    -------------------------------
   794     05  FILLER            PIC  X(0003).
   795     05  SADDR3O PIC  X(0060).
   796*    -------------------------------
   797     05  FILLER            PIC  X(0003).
   798     05  SCITYO PIC  X(0060).
   799*    -------------------------------
   800     05  FILLER            PIC  X(0003).
   801     05  SSTATEO PIC  X(0002).
   802*    -------------------------------
   803     05  FILLER            PIC  X(0003).
   804     05  SZIPO PIC  X(0010).
   805*    -------------------------------
   806     05  FILLER            PIC  X(0003).
   807     05  ERRMSG1O PIC  X(0072).
   808*    -------------------------------
   809     05  FILLER            PIC  X(0003).
   810     05  PFKEYO PIC  X(0002).
   811*    -------------------------------
   812*                                COPY ELCJPFX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  16
* EL6503.cbl
   813******************************************************************
   814*                                                                *
   815*                                                                *
   816*                            ELCJPFX.                            *
   817*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   818*                            VMOD=2.002                          *
   819*                                                                *
   820*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   821*                                                                *
   822*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   823*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   824*        ELCNTL - CONTROL FILE                                   *
   825*        ELMSTR - CLAIM MASTERS                                  *
   826*        ELTRLR - ACTIVITY TRAILERS                              *
   827*        ELCHKQ - CHECK QUE                                      *
   828******************************************************************
   829 01  JOURNAL-RECORD.
   830     12  jp-date                     pic s9(5) comp-3.
   831     12  jp-time                     pic s9(7) comp-3.
   832     12  JP-USER-ID                  PIC X(4).
   833     12  JP-FILE-ID                  PIC X(8).
   834     12  JP-PROGRAM-ID               PIC X(8).
   835     12  JP-RECORD-TYPE              PIC X.
   836         88 JP-ADD              VALUE 'A'.
   837         88 JP-BEFORE-CHANGE    VALUE 'B'.
   838         88 JP-AFTER-CHANGE     VALUE 'C'.
   839         88 JP-DELETE           VALUE 'D'.
   840         88 JP-GENERIC-DELETE   VALUE 'G'.
   841         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   842         88 JP-KEY-CHG-ADD      VALUE 'N'.
   843     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   844     12  JP-RECORD-AREA
   845
   846
   847                                 PIC X(750).
   848*                                COPY ELCEMIB.
   849******************************************************************
   850*                                                                *
   851*                                                                *
   852*                            ELCEMIB.                            *
   853*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   854*                            VMOD=2.005                          *
   855*                                                                *
   856*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   857*                                                                *
   858******************************************************************
   859 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   860     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   861     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   862     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   863     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   864     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   865     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   866     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   867     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   868     12  EMI-SWITCH1             PIC X        VALUE '1'.
   869         88  EMI-NO-ERRORS                    VALUE '1'.
   870         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  17
* EL6503.cbl
   871         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   872     12  EMI-SWITCH2             PIC X        VALUE '1'.
   873         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   874     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   875         88  EMI-AREA1-EMPTY                  VALUE '1'.
   876         88  EMI-AREA1-FULL                   VALUE '2'.
   877     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   878         88  EMI-AREA2-EMPTY                  VALUE '1'.
   879         88  EMI-AREA2-FULL                   VALUE '2'.
   880     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   881         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   882         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   883         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   884         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   885         88  EMI-BYPASS-FATALS                VALUE 'X'.
   886     12  EMI-ERROR-LINES.
   887         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   888         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   889         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   890         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   891             20  EMI-ERR-CODES OCCURS 10 TIMES.
   892                 24  EMI-ERR-NUM         PIC X(4).
   893                 24  EMI-FILLER          PIC X.
   894                 24  EMI-SEV             PIC X.
   895                 24  FILLER              PIC X.
   896             20  FILLER                  PIC X(02).
   897     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   898         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   899             20  EMI-ERROR-NUMBER    PIC X(4).
   900             20  EMI-FILL            PIC X.
   901             20  EMI-SEVERITY        PIC X.
   902             20  FILLER              PIC X.
   903             20  EMI-ERROR-TEXT.
   904                 24  EMI-TEXT-VARIABLE   PIC X(10).
   905                 24  FILLER          PIC X(55).
   906     12  EMI-SEVERITY-SAVE           PIC X.
   907         88  EMI-NOTE                    VALUE 'N'.
   908         88  EMI-WARNING                 VALUE 'W'.
   909         88  EMI-FORCABLE                VALUE 'F'.
   910         88  EMI-FATAL                   VALUE 'X'.
   911     12  EMI-MESSAGE-FLAG            PIC X.
   912         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   913         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   914     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   915     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   916         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   917         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   918         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   919     12  emi-claim-no                pic x(7).
   920     12  emi-claim-type              pic x(6).
   921     12  FILLER                      PIC X(124)  VALUE SPACES.
   922     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   923     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   924     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   925     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   926*                                COPY ELCDATE.
   927******************************************************************
   928*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  18
* EL6503.cbl
   929*                                                                *
   930*                            ELCDATE.                            *
   931*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   932*                            VMOD=2.003
   933*                                                                *
   934*                                                                *
   935*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   936*                 LENGTH = 200                                   *
   937******************************************************************
   938
   939 01  DATE-CONVERSION-DATA.
   940     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   941     12  DC-OPTION-CODE                PIC X.
   942         88  BIN-TO-GREG                VALUE ' '.
   943         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   944         88  EDIT-GREG-TO-BIN           VALUE '2'.
   945         88  YMD-GREG-TO-BIN            VALUE '3'.
   946         88  MDY-GREG-TO-BIN            VALUE '4'.
   947         88  JULIAN-TO-BIN              VALUE '5'.
   948         88  BIN-PLUS-ELAPSED           VALUE '6'.
   949         88  FIND-CENTURY               VALUE '7'.
   950         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   951         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   952         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   953         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   954         88  JULIAN-TO-BIN-3            VALUE 'C'.
   955         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   956         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   957         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   958         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   959         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   960         88  CHECK-LEAP-YEAR            VALUE 'H'.
   961         88  BIN-3-TO-GREG              VALUE 'I'.
   962         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   963         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   964         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   965         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   966         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   967         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   968         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   969         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   970         88  THREE-CHARACTER-BIN
   971                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   972         88  GREGORIAN-TO-BIN
   973                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   974         88  BIN-TO-GREGORIAN
   975                  VALUES ' ' '1' 'I' '8' 'G'.
   976         88  JULIAN-TO-BINARY
   977                  VALUES '5' 'C' 'E' 'F'.
   978     12  DC-ERROR-CODE                 PIC X.
   979         88  NO-CONVERSION-ERROR        VALUE ' '.
   980         88  DATE-CONVERSION-ERROR
   981                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   982         88  DATE-IS-ZERO               VALUE '1'.
   983         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   984         88  DATE-IS-INVALID            VALUE '3'.
   985         88  DATE1-GREATER-DATE2        VALUE '4'.
   986         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  19
* EL6503.cbl
   987         88  DATE-INVALID-OPTION        VALUE '9'.
   988         88  INVALID-CENTURY            VALUE 'A'.
   989         88  ONLY-CENTURY               VALUE 'B'.
   990         88  ONLY-LEAP-YEAR             VALUE 'C'.
   991         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   992     12  DC-END-OF-MONTH               PIC X.
   993         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   994     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   995         88  USE-NORMAL-PROCESS         VALUE ' '.
   996         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   997         88  ADJUST-UP-100-YRS          VALUE '2'.
   998     12  FILLER                        PIC X.
   999     12  DC-CONVERSION-DATES.
  1000         16  DC-BIN-DATE-1             PIC XX.
  1001         16  DC-BIN-DATE-2             PIC XX.
  1002         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1003         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1004                       DC-GREG-DATE-1-EDIT.
  1005             20  DC-EDIT1-MONTH        PIC 99.
  1006             20  SLASH1-1              PIC X.
  1007             20  DC-EDIT1-DAY          PIC 99.
  1008             20  SLASH1-2              PIC X.
  1009             20  DC-EDIT1-YEAR         PIC 99.
  1010         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1011         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1012                     DC-GREG-DATE-2-EDIT.
  1013             20  DC-EDIT2-MONTH        PIC 99.
  1014             20  SLASH2-1              PIC X.
  1015             20  DC-EDIT2-DAY          PIC 99.
  1016             20  SLASH2-2              PIC X.
  1017             20  DC-EDIT2-YEAR         PIC 99.
  1018         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1019         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1020                     DC-GREG-DATE-1-YMD.
  1021             20  DC-YMD-YEAR           PIC 99.
  1022             20  DC-YMD-MONTH          PIC 99.
  1023             20  DC-YMD-DAY            PIC 99.
  1024         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1025         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1026                      DC-GREG-DATE-1-MDY.
  1027             20  DC-MDY-MONTH          PIC 99.
  1028             20  DC-MDY-DAY            PIC 99.
  1029             20  DC-MDY-YEAR           PIC 99.
  1030         16  DC-GREG-DATE-1-ALPHA.
  1031             20  DC-ALPHA-MONTH        PIC X(10).
  1032             20  DC-ALPHA-DAY          PIC 99.
  1033             20  FILLER                PIC XX.
  1034             20  DC-ALPHA-CENTURY.
  1035                 24 DC-ALPHA-CEN-N     PIC 99.
  1036             20  DC-ALPHA-YEAR         PIC 99.
  1037         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1038         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1039         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1040         16  DC-JULIAN-DATE            PIC 9(05).
  1041         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1042                                       PIC 9(05).
  1043         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1044             20  DC-JULIAN-YEAR        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  20
* EL6503.cbl
  1045             20  DC-JULIAN-DAYS        PIC 999.
  1046         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1047         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1048         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1049     12  DATE-CONVERSION-VARIBLES.
  1050         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1051         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1052             20  FILLER                PIC 9(3).
  1053             20  HOLD-CEN-1-CCYY.
  1054                 24  HOLD-CEN-1-CC     PIC 99.
  1055                 24  HOLD-CEN-1-YY     PIC 99.
  1056             20  HOLD-CEN-1-MO         PIC 99.
  1057             20  HOLD-CEN-1-DA         PIC 99.
  1058         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1059             20  HOLD-CEN-1-R-MO       PIC 99.
  1060             20  HOLD-CEN-1-R-DA       PIC 99.
  1061             20  HOLD-CEN-1-R-CCYY.
  1062                 24  HOLD-CEN-1-R-CC   PIC 99.
  1063                 24  HOLD-CEN-1-R-YY   PIC 99.
  1064             20  FILLER                PIC 9(3).
  1065         16  HOLD-CENTURY-1-X.
  1066             20  FILLER                PIC X(3)  VALUE SPACES.
  1067             20  HOLD-CEN-1-X-CCYY.
  1068                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1069                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1070             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1071             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1072         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1073             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1074             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1075             20  HOLD-CEN-1-R-X-CCYY.
  1076                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1077                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1078             20  FILLER                PIC XXX.
  1079         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1080         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1081         16  DC-JULIAN-DATE-1          PIC 9(07).
  1082         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1083             20  DC-JULIAN-1-CCYY.
  1084                 24  DC-JULIAN-1-CC    PIC 99.
  1085                 24  DC-JULIAN-1-YR    PIC 99.
  1086             20  DC-JULIAN-DA-1        PIC 999.
  1087         16  DC-JULIAN-DATE-2          PIC 9(07).
  1088         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1089             20  DC-JULIAN-2-CCYY.
  1090                 24  DC-JULIAN-2-CC    PIC 99.
  1091                 24  DC-JULIAN-2-YR    PIC 99.
  1092             20  DC-JULIAN-DA-2        PIC 999.
  1093         16  DC-GREG-DATE-A-EDIT.
  1094             20  DC-EDITA-MONTH        PIC 99.
  1095             20  SLASHA-1              PIC X VALUE '/'.
  1096             20  DC-EDITA-DAY          PIC 99.
  1097             20  SLASHA-2              PIC X VALUE '/'.
  1098             20  DC-EDITA-CCYY.
  1099                 24  DC-EDITA-CENT     PIC 99.
  1100                 24  DC-EDITA-YEAR     PIC 99.
  1101         16  DC-GREG-DATE-B-EDIT.
  1102             20  DC-EDITB-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  21
* EL6503.cbl
  1103             20  SLASHB-1              PIC X VALUE '/'.
  1104             20  DC-EDITB-DAY          PIC 99.
  1105             20  SLASHB-2              PIC X VALUE '/'.
  1106             20  DC-EDITB-CCYY.
  1107                 24  DC-EDITB-CENT     PIC 99.
  1108                 24  DC-EDITB-YEAR     PIC 99.
  1109         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1110         16  DC-GREG-DATE-CYMD-R REDEFINES
  1111                              DC-GREG-DATE-CYMD.
  1112             20  DC-CYMD-CEN           PIC 99.
  1113             20  DC-CYMD-YEAR          PIC 99.
  1114             20  DC-CYMD-MONTH         PIC 99.
  1115             20  DC-CYMD-DAY           PIC 99.
  1116         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1117         16  DC-GREG-DATE-MDCY-R REDEFINES
  1118                              DC-GREG-DATE-MDCY.
  1119             20  DC-MDCY-MONTH         PIC 99.
  1120             20  DC-MDCY-DAY           PIC 99.
  1121             20  DC-MDCY-CEN           PIC 99.
  1122             20  DC-MDCY-YEAR          PIC 99.
  1123    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1124        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1125    12  DC-EL310-DATE                  PIC X(21).
  1126    12  FILLER                         PIC X(28).
  1127*                                COPY ELCLOGOF.
  1128******************************************************************
  1129*                                                                *
  1130*                                                                *
  1131*                            ELCLOGOF.                           *
  1132*                            VMOD=2.001                          *
  1133*                                                                *
  1134*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1135*                                                                *
  1136******************************************************************
  1137 01  CLASIC-LOGOFF.
  1138     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1139     12  LOGOFF-TEXT.
  1140         16  FILLER          PIC X(5)    VALUE SPACES.
  1141         16  LOGOFF-MSG.
  1142             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1143             20  FILLER      PIC X       VALUE SPACES.
  1144             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1145         16  FILLER          PIC X(80)
  1146           VALUE '* YOU ARE NOW LOGGED OFF'.
  1147         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1148         16  FILLER          PIC X       VALUE QUOTE.
  1149         16  LOGOFF-SYS-MSG  PIC X(17)
  1150           VALUE 'S CLAS-IC SYSTEM '.
  1151     12  TEXT-MESSAGES.
  1152         16  UNACCESS-MSG    PIC X(29)
  1153             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1154         16  PGMIDERR-MSG    PIC X(17)
  1155             VALUE 'PROGRAM NOT FOUND'.
  1156*                                COPY ELCATTR.
  1157******************************************************************
  1158*                                                                *
  1159*                            ELCATTR.                            *
  1160*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  22
* EL6503.cbl
  1161*                                                                *
  1162*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1163*                                                                *
  1164*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1165*                                                                *
  1166*                   POS 1   P=PROTECTED                          *
  1167*                           U=UNPROTECTED                        *
  1168*                           S=ASKIP                              *
  1169*                   POS 2   A=ALPHA/NUMERIC                      *
  1170*                           N=NUMERIC                            *
  1171*                   POS 3   N=NORMAL                             *
  1172*                           B=BRIGHT                             *
  1173*                           D=DARK                               *
  1174*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1175*                           OF=MODIFIED DATA TAG OFF             *
  1176*                                                                *
  1177*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1178******************************************************************
  1179 01  ATTRIBUTE-LIST.
  1180     12  AL-PABOF            PIC X       VALUE 'Y'.
  1181     12  AL-PABON            PIC X       VALUE 'Z'.
  1182     12  AL-PADOF            PIC X       VALUE '%'.
  1183     12  AL-PADON            PIC X       VALUE '_'.
  1184     12  AL-PANOF            PIC X       VALUE '-'.
  1185     12  AL-PANON            PIC X       VALUE '/'.
  1186     12  AL-SABOF            PIC X       VALUE '8'.
  1187     12  AL-SABON            PIC X       VALUE '9'.
  1188     12  AL-SADOF            PIC X       VALUE '@'.
  1189     12  AL-SADON            PIC X       VALUE QUOTE.
  1190     12  AL-SANOF            PIC X       VALUE '0'.
  1191     12  AL-SANON            PIC X       VALUE '1'.
  1192     12  AL-UABOF            PIC X       VALUE 'H'.
  1193     12  AL-UABON            PIC X       VALUE 'I'.
  1194     12  AL-UADOF            PIC X       VALUE '<'.
  1195     12  AL-UADON            PIC X       VALUE '('.
  1196     12  AL-UANOF            PIC X       VALUE ' '.
  1197     12  AL-UANON            PIC X       VALUE 'A'.
  1198     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1199     12  AL-UNBON            PIC X       VALUE 'R'.
  1200     12  AL-UNDOF            PIC X       VALUE '*'.
  1201     12  AL-UNDON            PIC X       VALUE ')'.
  1202     12  AL-UNNOF            PIC X       VALUE '&'.
  1203     12  AL-UNNON            PIC X       VALUE 'J'.
  1204*                                COPY ELCAID.
  1205******************************************************************
  1206*                                                                *
  1207*                            ELCAID.                             *
  1208*                            VMOD=2.001                          *
  1209*                                                                *
  1210*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1211*                                                                *
  1212*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1213*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1214******************************************************************
  1215
  1216 01  DFHAID.
  1217   02  DFHNULL   PIC  X  VALUE  ' '.
  1218   02  DFHENTER  PIC  X  VALUE  QUOTE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  23
* EL6503.cbl
  1219   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1220   02  DFHPEN    PIC  X  VALUE  '='.
  1221   02  DFHOPID   PIC  X  VALUE  'W'.
  1222   02  DFHPA1    PIC  X  VALUE  '%'.
  1223   02  DFHPA2    PIC  X  VALUE  '>'.
  1224   02  DFHPA3    PIC  X  VALUE  ','.
  1225   02  DFHPF1    PIC  X  VALUE  '1'.
  1226   02  DFHPF2    PIC  X  VALUE  '2'.
  1227   02  DFHPF3    PIC  X  VALUE  '3'.
  1228   02  DFHPF4    PIC  X  VALUE  '4'.
  1229   02  DFHPF5    PIC  X  VALUE  '5'.
  1230   02  DFHPF6    PIC  X  VALUE  '6'.
  1231   02  DFHPF7    PIC  X  VALUE  '7'.
  1232   02  DFHPF8    PIC  X  VALUE  '8'.
  1233   02  DFHPF9    PIC  X  VALUE  '9'.
  1234   02  DFHPF10   PIC  X  VALUE  ':'.
  1235   02  DFHPF11   PIC  X  VALUE  '#'.
  1236   02  DFHPF12   PIC  X  VALUE  '@'.
  1237   02  DFHPF13   PIC  X  VALUE  'A'.
  1238   02  DFHPF14   PIC  X  VALUE  'B'.
  1239   02  DFHPF15   PIC  X  VALUE  'C'.
  1240   02  DFHPF16   PIC  X  VALUE  'D'.
  1241   02  DFHPF17   PIC  X  VALUE  'E'.
  1242   02  DFHPF18   PIC  X  VALUE  'F'.
  1243   02  DFHPF19   PIC  X  VALUE  'G'.
  1244   02  DFHPF20   PIC  X  VALUE  'H'.
  1245   02  DFHPF21   PIC  X  VALUE  'I'.
  1246*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1247   02  DFHPF22   PIC  X  VALUE  '['.
  1248   02  DFHPF23   PIC  X  VALUE  '.'.
  1249   02  DFHPF24   PIC  X  VALUE  '<'.
  1250   02  DFHMSRE   PIC  X  VALUE  'X'.
  1251   02  DFHSTRF   PIC  X  VALUE  'h'.
  1252   02  DFHTRIG   PIC  X  VALUE  '"'.
  1253 01  FILLER    REDEFINES DFHAID.
  1254     05  FILLER                      PIC X(8).
  1255     05  PF-VALUES                   PIC X
  1256         OCCURS 24 TIMES.
  1257*                                COPY ERCACNT.
  1258******************************************************************
  1259*                                                                *
  1260*                                                                *
  1261*                            ERCACNT.                            *
  1262*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1263*                            VMOD=2.002                          *
  1264*                                                                *
  1265*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1266*                                                                *
  1267*   FILE TYPE = VSAM,KSDS                                        *
  1268*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1269*                                                                *
  1270*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1271*       ALTERNATE INDEX = NONE                                   *
  1272*                                                                *
  1273*                                                                *
  1274*   LOG = YES                                                    *
  1275*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1276******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  24
* EL6503.cbl
  1277*                   C H A N G E   L O G
  1278*
  1279* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1280*-----------------------------------------------------------------
  1281*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1282* EFFECTIVE    NUMBER
  1283*-----------------------------------------------------------------
  1284* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1285*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1286******************************************************************
  1287 01  NOTE-FILE.
  1288     12  NT-FILE-ID                  PIC XX.
  1289         88  VALID-NOTE-ID              VALUE 'NT'.
  1290
  1291     12  NT-CONTROL-PRIMARY.
  1292         16  NT-COMPANY-CD           PIC X.
  1293         16  NT-ACCT-NOTE-KEY.
  1294             18  NT-CARRIER              PIC X.
  1295             18  NT-GROUPING             PIC X(06).
  1296             18  NT-STATE                PIC XX.
  1297             18  NT-ACCOUNT              PIC X(10).
  1298         16  NT-RECORD-TYPE          PIC X.
  1299              88  ACCT-NOTE          VALUE '1'.
  1300              88  ACCT-BRANCH-LOC    VALUE '2'.
  1301              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1302         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1303
  1304     12  NT-LAST-MAINT-DT            PIC XX.
  1305     12  NT-LAST-MAINT-BY            PIC X(4).
  1306     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1307
  1308*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1309*     SEQUENCE NUMBERS
  1310     12  NT-NOTE-INFORMATION.
  1311         16  NT-NOTE-LINE            PIC X(60).
  1312         16  FILLER                  PIC X(25).
  1313*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1314     12  NT-LOCATION-INFORMATION REDEFINES
  1315                         NT-NOTE-INFORMATION.
  1316         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1317         16  FILLER                  PIC X(25).
  1318* Account special indicator is record type '2', sequence 3
  1319     12  filler REDEFINES NT-NOTE-INFORMATION.
  1320         16  nt-account-special      PIC X.
  1321         16  FILLER                  PIC X(84).
  1322*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1323*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1324*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1325*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1326*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1327*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1328*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1329     12  NT-SHIPPING-INFORMATION REDEFINES
  1330                         NT-NOTE-INFORMATION.
  1331         16  NT-SHIPPING-LINE        PIC X(60).
  1332         16  NT-SHIP-STATE           PIC XX.
  1333         16  NT-SHIP-ZIP             PIC X(10).
  1334         16  FILLER                  PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  25
* EL6503.cbl
  1335*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  26
* EL6503.cbl
  1337****************************************************************
  1338*
  1339* Copyright (c) 2007-2013 Dell Inc.
  1340* All rights reserved.
  1341*
  1342****************************************************************
  1343 01  DFHEIV.
  1344   02  DFHEIV0               PIC X(35).
  1345   02  DFHEIV1               PIC X(08).
  1346   02  DFHEIV2               PIC X(08).
  1347   02  DFHEIV3               PIC X(08).
  1348   02  DFHEIV4               PIC X(06).
  1349   02  DFHEIV5               PIC X(04).
  1350   02  DFHEIV6               PIC X(04).
  1351   02  DFHEIV7               PIC X(02).
  1352   02  DFHEIV8               PIC X(02).
  1353   02  DFHEIV9               PIC X(01).
  1354   02  DFHEIV10              PIC S9(7) COMP-3.
  1355   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1356   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1357   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1358   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1359   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1360   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1361   02  DFHEIV17              PIC X(04).
  1362   02  DFHEIV18              PIC X(04).
  1363   02  DFHEIV19              PIC X(04).
  1364   02  DFHEIV20              USAGE IS POINTER.
  1365   02  DFHEIV21              USAGE IS POINTER.
  1366   02  DFHEIV22              USAGE IS POINTER.
  1367   02  DFHEIV23              USAGE IS POINTER.
  1368   02  DFHEIV24              USAGE IS POINTER.
  1369   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1370   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1371   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1372   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1373   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1374   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1375   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1376   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1377   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1378   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1379   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1380   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1381   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1382   02  FILLER                PIC X(02).
  1383   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1384   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1385   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1386   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1387   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1388   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1389   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1390 LINKAGE  SECTION.
  1391*****************************************************************
  1392*                                                               *
  1393* Copyright (c) 2007-2013 Dell Inc.                             *
  1394* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  27
* EL6503.cbl
  1395*                                                               *
  1396*****************************************************************
  1397 01  dfheiblk.
  1398     02  eibtime          pic s9(7) comp-3.
  1399     02  eibdate          pic s9(7) comp-3.
  1400     02  eibtrnid         pic x(4).
  1401     02  eibtaskn         pic s9(7) comp-3.
  1402     02  eibtrmid         pic x(4).
  1403     02  dfheigdi         pic s9(4) comp.
  1404     02  eibcposn         pic s9(4) comp.
  1405     02  eibcalen         pic s9(4) comp.
  1406     02  eibaid           pic x(1).
  1407     02  eibfiller1       pic x(1).
  1408     02  eibfn            pic x(2).
  1409     02  eibfiller2       pic x(2).
  1410     02  eibrcode         pic x(6).
  1411     02  eibfiller3       pic x(2).
  1412     02  eibds            pic x(8).
  1413     02  eibreqid         pic x(8).
  1414     02  eibrsrce         pic x(8).
  1415     02  eibsync          pic x(1).
  1416     02  eibfree          pic x(1).
  1417     02  eibrecv          pic x(1).
  1418     02  eibsend          pic x(1).
  1419     02  eibatt           pic x(1).
  1420     02  eibeoc           pic x(1).
  1421     02  eibfmh           pic x(1).
  1422     02  eibcompl         pic x(1).
  1423     02  eibsig           pic x(1).
  1424     02  eibconf          pic x(1).
  1425     02  eiberr           pic x(1).
  1426     02  eibrldbk         pic x(1).
  1427     02  eiberrcd         pic x(4).
  1428     02  eibsynrb         pic x(1).
  1429     02  eibnodat         pic x(1).
  1430     02  eibfiller5       pic x(2).
  1431     02  eibresp          pic s9(8) comp.
  1432     02  eibresp2         pic s9(8) comp.
  1433     02  dfheigdj         pic s9(4) comp.
  1434     02  dfheigdk         pic s9(4) comp.
  1435 01  DFHCOMMAREA                 PIC X(1024).
  1436 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1437 0000-DFHEXIT SECTION.
  1438     MOVE '9#                    $   ' TO DFHEIV0.
  1439     MOVE 'EL6503' TO DFHEIV1.
  1440     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1441     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1442     MOVE '5'                    TO DC-OPTION-CODE
  1443     PERFORM 8500-DATE-CONVERSION
  1444                                 THRU 8500-EXIT
  1445     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1446     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1447     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1448     MOVE +1                     TO EMI-NUMBER-OF-LINES
  1449                                    EMI-SWITCH2
  1450     IF EIBCALEN NOT > ZERO
  1451        MOVE UNACCESS-MSG        TO LOGOFF-MSG
  1452        GO TO 8300-SEND-TEXT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  28
* EL6503.cbl
  1453     END-IF
  1454
  1455* EXEC CICS HANDLE CONDITION
  1456*        PGMIDERR (9600-PGMIDERR)
  1457*        ERROR    (9990-ERROR)
  1458*    END-EXEC
  1459*    MOVE '"$L.                  ! " #00001450' TO DFHEIV0
  1460     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1462     MOVE X'2220233030303031343530' TO DFHEIV0(25:11)
  1463     CALL 'kxdfhei1' USING DFHEIV0
  1464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1465     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1466        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1467           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1468           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1469           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1470           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1471           MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1472           MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1473           MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1474           MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  1475        ELSE
  1476           MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  1477           MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  1478           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  1479           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  1480           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  1481           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  1482           MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  1483           MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  1484        END-IF
  1485     END-IF
  1486     IF EIBTRNID NOT = WS-TRANS-ID
  1487        GO TO 1000-INITIAL-SCREEN
  1488     END-IF
  1489     IF EIBAID = DFHCLEAR
  1490        GO TO 9400-CLEAR
  1491     END-IF
  1492     IF NOT DISPLAY-CAP
  1493        MOVE 'READ'              TO SM-READ
  1494        PERFORM 9995-SECURITY-VIOLATION
  1495        MOVE ER-0070             TO EMI-ERROR
  1496        PERFORM 9900-ERROR-FORMAT
  1497                                 THRU 9900-EXIT
  1498        GO TO 8100-SEND-INITIAL-MAP
  1499     END-IF
  1500     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1501        MOVE LOW-VALUES          TO EL6503AO
  1502        MOVE -1                  TO PFKEYL
  1503        MOVE ER-0008             TO EMI-ERROR
  1504        GO TO 8200-SEND-DATAONLY
  1505     END-IF
  1506
  1507* EXEC CICS RECEIVE
  1508*        INTO   (EL6503AI)
  1509*        MAPSET (WS-MAPSET-NAME)
  1510*        MAP    (WS-MAP-NAME)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  29
* EL6503.cbl
  1511*    END-EXEC
  1512     MOVE LENGTH OF
  1513      EL6503AI
  1514       TO DFHEIV11
  1515*    MOVE '8"T I  L              ''   #00001495' TO DFHEIV0
  1516     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1517     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1518     MOVE X'2020233030303031343935' TO DFHEIV0(25:11)
  1519     CALL 'kxdfhei1' USING DFHEIV0,
  1520           WS-MAP-NAME,
  1521           EL6503AI,
  1522           DFHEIV11,
  1523           WS-MAPSET-NAME,
  1524           DFHEIV99,
  1525           DFHEIV99
  1526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1527     IF PFKEYL > ZERO
  1528        IF EIBAID NOT = DFHENTER
  1529           MOVE ER-0004          TO EMI-ERROR
  1530           MOVE AL-UNBOF         TO PFKEYA
  1531           MOVE -1               TO PFKEYL
  1532           GO TO 8200-SEND-DATAONLY
  1533        ELSE
  1534           IF PFKEYO NUMERIC AND
  1535              (PFKEYO > ZERO AND LESS '25')
  1536              MOVE PF-VALUES (PFKEYI)
  1537                                 TO  EIBAID
  1538           ELSE
  1539              MOVE ER-0029       TO  EMI-ERROR
  1540              MOVE AL-UNBOF      TO  PFKEYA
  1541              MOVE -1            TO  PFKEYL
  1542              GO TO 8200-SEND-DATAONLY
  1543           END-IF
  1544        END-IF
  1545     END-IF
  1546     IF EIBAID = DFHPF12
  1547        MOVE 'EL010'             TO THIS-PGM
  1548        GO TO 9300-XCTL
  1549     END-IF
  1550     IF EIBAID = DFHPF23
  1551        GO TO 9000-RETURN-CICS
  1552     END-IF
  1553     IF EIBAID = DFHPF24
  1554        IF CREDIT-SESSION
  1555           MOVE 'EL626'          TO THIS-PGM
  1556           GO TO 9300-XCTL
  1557        ELSE
  1558           MOVE 'EL126'          TO THIS-PGM
  1559           GO TO 9300-XCTL
  1560        END-IF
  1561     END-IF
  1562     IF EIBAID = DFHENTER
  1563        CONTINUE
  1564     ELSE
  1565        MOVE ER-0008             TO EMI-ERROR
  1566        MOVE -1                  TO PFKEYL
  1567        GO TO 8200-SEND-DATAONLY
  1568     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  30
* EL6503.cbl
  1569     IF NOT MODIFY-CAP
  1570        MOVE 'UPDATE'            TO SM-READ
  1571        PERFORM 9995-SECURITY-VIOLATION
  1572                                 THRU 9995-EXIT
  1573        MOVE ER-0070             TO EMI-ERROR
  1574        PERFORM 9900-ERROR-FORMAT
  1575                                 THRU 9900-EXIT
  1576        MOVE AL-UANON            TO CARRIERA GROUPA
  1577                                    STATEA  ACCTNOA
  1578        GO TO 8100-SEND-INITIAL-MAP
  1579     END-IF
  1580     EVALUATE MAINTYPI
  1581        WHEN 'D'
  1582           PERFORM 2000-DELETE-ERACNT
  1583                                 THRU 2000-EXIT
  1584           MOVE ER-0000          TO EMI-ERROR
  1585           PERFORM 9900-ERROR-FORMAT
  1586                                 THRU 9900-EXIT
  1587           GO TO 8100-SEND-INITIAL-MAP
  1588        WHEN 'C'
  1589           PERFORM 3000-CHANGE-ERACNT
  1590                                 THRU 3000-EXIT
  1591           MOVE ER-0000          TO EMI-ERROR
  1592           PERFORM 9900-ERROR-FORMAT
  1593                                 THRU 9900-EXIT
  1594        WHEN 'A'
  1595           PERFORM 4000-ADD-ERACNT
  1596                                 THRU 4000-EXIT
  1597           MOVE ER-0000          TO EMI-ERROR
  1598           PERFORM 9900-ERROR-FORMAT
  1599                                 THRU 9900-EXIT
  1600        WHEN OTHER
  1601           MOVE ER-0023          TO EMI-ERROR
  1602           PERFORM 9900-ERROR-FORMAT
  1603                                 THRU 9900-EXIT
  1604           MOVE -1               TO MAINTYPL
  1605           MOVE AL-UABON         TO MAINTYPA
  1606     END-EVALUATE
  1607     .
  1608 1000-INITIAL-SCREEN.
  1609*    MOVE SPACES                 TO PI-PROGRAM-WORK-AREA
  1610     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  1611     MOVE PI-ACCT-CARRIER        TO WS-CARRIER
  1612                                    CARRIERO
  1613     MOVE PI-ACCT-GROUPING       TO WS-GROUPING
  1614                                    GROUPO
  1615     MOVE PI-ACCT-STATE          TO WS-STATE
  1616                                    STATEO
  1617     MOVE PI-ACCT-ACCOUNT        TO WS-ACCOUNT
  1618                                    ACCTNOO
  1619     MOVE AL-UANON               TO CARRIERA
  1620                                    GROUPA
  1621                                    STATEA
  1622                                    ACCTNOA
  1623     MOVE ' '                    TO MAINTYPO
  1624     MOVE -1                     TO MAINTYPL
  1625     MOVE '2'                    TO WS-REC-TYPE
  1626     MOVE +0                     TO WS-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  31
* EL6503.cbl
  1627     MOVE WS-CONTROL-PRIMARY     TO WS-SAVE-ERACNT-KEY
  1628
  1629* EXEC CICS STARTBR
  1630*        DATASET   ('ERACNT')
  1631*        RIDFLD    (WS-CONTROL-PRIMARY)
  1632*        GTEQ
  1633*        RESP      (WS-RESPONSE)
  1634*    END-EXEC
  1635     MOVE 'ERACNT' TO DFHEIV1
  1636     MOVE 0
  1637       TO DFHEIV11
  1638*    MOVE '&,         G          &  N#00001601' TO DFHEIV0
  1639     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1640     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1641     MOVE X'204E233030303031363031' TO DFHEIV0(25:11)
  1642     CALL 'kxdfhei1' USING DFHEIV0,
  1643           DFHEIV1,
  1644           WS-CONTROL-PRIMARY,
  1645           DFHEIV99,
  1646           DFHEIV11,
  1647           DFHEIV99
  1648     MOVE EIBRESP  TO WS-RESPONSE
  1649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1650     IF NOT RESP-NORMAL
  1651        GO TO 8100-SEND-INITIAL-MAP
  1652     END-IF
  1653     SET ERACNT-BROWSE-STARTED   TO TRUE
  1654
  1655* EXEC CICS READNEXT
  1656*        DATASET  ('ERACNT')
  1657*        INTO     (NOTE-FILE)
  1658*        RIDFLD   (WS-CONTROL-PRIMARY)
  1659*        RESP     (WS-RESPONSE)
  1660*    END-EXEC
  1661     MOVE LENGTH OF
  1662      NOTE-FILE
  1663       TO DFHEIV12
  1664     MOVE 'ERACNT' TO DFHEIV1
  1665     MOVE 0
  1666       TO DFHEIV11
  1667*    MOVE '&.IL                  )  N#00001611' TO DFHEIV0
  1668     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1669     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1670     MOVE X'204E233030303031363131' TO DFHEIV0(25:11)
  1671     CALL 'kxdfhei1' USING DFHEIV0,
  1672           DFHEIV1,
  1673           NOTE-FILE,
  1674           DFHEIV12,
  1675           WS-CONTROL-PRIMARY,
  1676           DFHEIV99,
  1677           DFHEIV11,
  1678           DFHEIV99,
  1679           DFHEIV99
  1680     MOVE EIBRESP  TO WS-RESPONSE
  1681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1682     IF (RESP-NORMAL)
  1683        AND (WS-CONTROL-PRIMARY (1:20) =
  1684           WS-SAVE-ERACNT-KEY (1:20))
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  32
* EL6503.cbl
  1685        IF (WS-REC-TYPE = '2')
  1686           AND (WS-SEQ-NO = 1)
  1687           MOVE NT-BRANCH-LOC-LINE
  1688                                 TO BLINE1O
  1689           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1690                                 THRU 1010-EXIT
  1691
  1692* EXEC CICS READNEXT
  1693*             DATASET  ('ERACNT')
  1694*             INTO     (NOTE-FILE)
  1695*             RIDFLD   (WS-CONTROL-PRIMARY)
  1696*             RESP     (WS-RESPONSE)
  1697*          END-EXEC
  1698     MOVE LENGTH OF
  1699      NOTE-FILE
  1700       TO DFHEIV12
  1701     MOVE 'ERACNT' TO DFHEIV1
  1702     MOVE 0
  1703       TO DFHEIV11
  1704*    MOVE '&.IL                  )  N#00001626' TO DFHEIV0
  1705     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1706     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1707     MOVE X'204E233030303031363236' TO DFHEIV0(25:11)
  1708     CALL 'kxdfhei1' USING DFHEIV0,
  1709           DFHEIV1,
  1710           NOTE-FILE,
  1711           DFHEIV12,
  1712           WS-CONTROL-PRIMARY,
  1713           DFHEIV99,
  1714           DFHEIV11,
  1715           DFHEIV99,
  1716           DFHEIV99
  1717     MOVE EIBRESP  TO WS-RESPONSE
  1718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1719        END-IF
  1720     ELSE
  1721        MOVE ER-0006             TO EMI-ERROR
  1722        PERFORM 9900-ERROR-FORMAT
  1723                                 THRU 9900-EXIT
  1724     END-IF
  1725     IF (RESP-NORMAL)
  1726        AND (WS-CONTROL-PRIMARY (1:20) =
  1727           WS-SAVE-ERACNT-KEY (1:20))
  1728        IF (WS-REC-TYPE = '2')
  1729           AND (WS-SEQ-NO = 2)
  1730           MOVE NT-BRANCH-LOC-LINE
  1731                                 TO BLINE2O
  1732           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1733                                 THRU 1010-EXIT
  1734
  1735* EXEC CICS READNEXT
  1736*             DATASET  ('ERACNT')
  1737*             INTO     (NOTE-FILE)
  1738*             RIDFLD   (WS-CONTROL-PRIMARY)
  1739*             RESP     (WS-RESPONSE)
  1740*          END-EXEC
  1741     MOVE LENGTH OF
  1742      NOTE-FILE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  33
* EL6503.cbl
  1743       TO DFHEIV12
  1744     MOVE 'ERACNT' TO DFHEIV1
  1745     MOVE 0
  1746       TO DFHEIV11
  1747*    MOVE '&.IL                  )  N#00001647' TO DFHEIV0
  1748     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1749     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1750     MOVE X'204E233030303031363437' TO DFHEIV0(25:11)
  1751     CALL 'kxdfhei1' USING DFHEIV0,
  1752           DFHEIV1,
  1753           NOTE-FILE,
  1754           DFHEIV12,
  1755           WS-CONTROL-PRIMARY,
  1756           DFHEIV99,
  1757           DFHEIV11,
  1758           DFHEIV99,
  1759           DFHEIV99
  1760     MOVE EIBRESP  TO WS-RESPONSE
  1761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1762        END-IF
  1763     END-IF
  1764     IF (RESP-NORMAL)
  1765        AND (WS-CONTROL-PRIMARY (1:20) =
  1766           WS-SAVE-ERACNT-KEY (1:20))
  1767        IF (WS-REC-TYPE = '2')
  1768           AND (WS-SEQ-NO = 3)
  1769           MOVE NT-account-special TO actspco
  1770           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1771                                 THRU 1010-EXIT
  1772
  1773* EXEC CICS READNEXT
  1774*             DATASET  ('ERACNT')
  1775*             INTO     (NOTE-FILE)
  1776*             RIDFLD   (WS-CONTROL-PRIMARY)
  1777*             RESP     (WS-RESPONSE)
  1778*          END-EXEC
  1779     MOVE LENGTH OF
  1780      NOTE-FILE
  1781       TO DFHEIV12
  1782     MOVE 'ERACNT' TO DFHEIV1
  1783     MOVE 0
  1784       TO DFHEIV11
  1785*    MOVE '&.IL                  )  N#00001663' TO DFHEIV0
  1786     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1787     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1788     MOVE X'204E233030303031363633' TO DFHEIV0(25:11)
  1789     CALL 'kxdfhei1' USING DFHEIV0,
  1790           DFHEIV1,
  1791           NOTE-FILE,
  1792           DFHEIV12,
  1793           WS-CONTROL-PRIMARY,
  1794           DFHEIV99,
  1795           DFHEIV11,
  1796           DFHEIV99,
  1797           DFHEIV99
  1798     MOVE EIBRESP  TO WS-RESPONSE
  1799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1800        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  34
* EL6503.cbl
  1801     END-IF
  1802     IF (RESP-NORMAL)
  1803        AND (WS-CONTROL-PRIMARY (1:20) =
  1804           WS-SAVE-ERACNT-KEY (1:20))
  1805        IF (WS-REC-TYPE = '3')
  1806           AND (WS-SEQ-NO = 1)
  1807           MOVE NT-SHIPPING-LINE TO SNAME1O
  1808           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1809                                 THRU 1010-EXIT
  1810
  1811* EXEC CICS READNEXT
  1812*             DATASET  ('ERACNT')
  1813*             INTO     (NOTE-FILE)
  1814*             RIDFLD   (WS-CONTROL-PRIMARY)
  1815*             RESP     (WS-RESPONSE)
  1816*          END-EXEC
  1817     MOVE LENGTH OF
  1818      NOTE-FILE
  1819       TO DFHEIV12
  1820     MOVE 'ERACNT' TO DFHEIV1
  1821     MOVE 0
  1822       TO DFHEIV11
  1823*    MOVE '&.IL                  )  N#00001679' TO DFHEIV0
  1824     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1825     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1826     MOVE X'204E233030303031363739' TO DFHEIV0(25:11)
  1827     CALL 'kxdfhei1' USING DFHEIV0,
  1828           DFHEIV1,
  1829           NOTE-FILE,
  1830           DFHEIV12,
  1831           WS-CONTROL-PRIMARY,
  1832           DFHEIV99,
  1833           DFHEIV11,
  1834           DFHEIV99,
  1835           DFHEIV99
  1836     MOVE EIBRESP  TO WS-RESPONSE
  1837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1838        END-IF
  1839     END-IF
  1840     IF (RESP-NORMAL)
  1841        AND (WS-CONTROL-PRIMARY (1:20) =
  1842           WS-SAVE-ERACNT-KEY (1:20))
  1843        IF (WS-REC-TYPE = '3')
  1844           AND (WS-SEQ-NO = 2)
  1845           MOVE NT-SHIPPING-LINE TO SNAME2O
  1846           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1847                                 THRU 1010-EXIT
  1848
  1849* EXEC CICS READNEXT
  1850*             DATASET  ('ERACNT')
  1851*             INTO     (NOTE-FILE)
  1852*             RIDFLD   (WS-CONTROL-PRIMARY)
  1853*             RESP     (WS-RESPONSE)
  1854*          END-EXEC
  1855     MOVE LENGTH OF
  1856      NOTE-FILE
  1857       TO DFHEIV12
  1858     MOVE 'ERACNT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  35
* EL6503.cbl
  1859     MOVE 0
  1860       TO DFHEIV11
  1861*    MOVE '&.IL                  )  N#00001695' TO DFHEIV0
  1862     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1863     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1864     MOVE X'204E233030303031363935' TO DFHEIV0(25:11)
  1865     CALL 'kxdfhei1' USING DFHEIV0,
  1866           DFHEIV1,
  1867           NOTE-FILE,
  1868           DFHEIV12,
  1869           WS-CONTROL-PRIMARY,
  1870           DFHEIV99,
  1871           DFHEIV11,
  1872           DFHEIV99,
  1873           DFHEIV99
  1874     MOVE EIBRESP  TO WS-RESPONSE
  1875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1876        END-IF
  1877     END-IF
  1878     IF (RESP-NORMAL)
  1879        AND (WS-CONTROL-PRIMARY (1:20) =
  1880           WS-SAVE-ERACNT-KEY (1:20))
  1881        IF (WS-REC-TYPE = '3')
  1882           AND (WS-SEQ-NO = 3)
  1883           MOVE NT-SHIPPING-LINE TO SADDR1O
  1884           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1885                                 THRU 1010-EXIT
  1886
  1887* EXEC CICS READNEXT
  1888*             DATASET  ('ERACNT')
  1889*             INTO     (NOTE-FILE)
  1890*             RIDFLD   (WS-CONTROL-PRIMARY)
  1891*             RESP     (WS-RESPONSE)
  1892*          END-EXEC
  1893     MOVE LENGTH OF
  1894      NOTE-FILE
  1895       TO DFHEIV12
  1896     MOVE 'ERACNT' TO DFHEIV1
  1897     MOVE 0
  1898       TO DFHEIV11
  1899*    MOVE '&.IL                  )  N#00001711' TO DFHEIV0
  1900     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1901     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1902     MOVE X'204E233030303031373131' TO DFHEIV0(25:11)
  1903     CALL 'kxdfhei1' USING DFHEIV0,
  1904           DFHEIV1,
  1905           NOTE-FILE,
  1906           DFHEIV12,
  1907           WS-CONTROL-PRIMARY,
  1908           DFHEIV99,
  1909           DFHEIV11,
  1910           DFHEIV99,
  1911           DFHEIV99
  1912     MOVE EIBRESP  TO WS-RESPONSE
  1913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1914        END-IF
  1915     END-IF
  1916     IF (RESP-NORMAL)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  36
* EL6503.cbl
  1917        AND (WS-CONTROL-PRIMARY (1:20) =
  1918           WS-SAVE-ERACNT-KEY (1:20))
  1919        IF (WS-REC-TYPE = '3')
  1920           AND (WS-SEQ-NO = 4)
  1921           MOVE NT-SHIPPING-LINE TO SADDR2O
  1922           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1923                                 THRU 1010-EXIT
  1924
  1925* EXEC CICS READNEXT
  1926*             DATASET  ('ERACNT')
  1927*             INTO     (NOTE-FILE)
  1928*             RIDFLD   (WS-CONTROL-PRIMARY)
  1929*             RESP     (WS-RESPONSE)
  1930*          END-EXEC
  1931     MOVE LENGTH OF
  1932      NOTE-FILE
  1933       TO DFHEIV12
  1934     MOVE 'ERACNT' TO DFHEIV1
  1935     MOVE 0
  1936       TO DFHEIV11
  1937*    MOVE '&.IL                  )  N#00001727' TO DFHEIV0
  1938     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1939     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1940     MOVE X'204E233030303031373237' TO DFHEIV0(25:11)
  1941     CALL 'kxdfhei1' USING DFHEIV0,
  1942           DFHEIV1,
  1943           NOTE-FILE,
  1944           DFHEIV12,
  1945           WS-CONTROL-PRIMARY,
  1946           DFHEIV99,
  1947           DFHEIV11,
  1948           DFHEIV99,
  1949           DFHEIV99
  1950     MOVE EIBRESP  TO WS-RESPONSE
  1951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1952        END-IF
  1953     END-IF
  1954     IF (RESP-NORMAL)
  1955        AND (WS-CONTROL-PRIMARY (1:20) =
  1956           WS-SAVE-ERACNT-KEY (1:20))
  1957        IF (WS-REC-TYPE = '3')
  1958           AND (WS-SEQ-NO = 5)
  1959           MOVE NT-SHIPPING-LINE TO SADDR3O
  1960           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1961                                 THRU 1010-EXIT
  1962
  1963* EXEC CICS READNEXT
  1964*             DATASET  ('ERACNT')
  1965*             INTO     (NOTE-FILE)
  1966*             RIDFLD   (WS-CONTROL-PRIMARY)
  1967*             RESP     (WS-RESPONSE)
  1968*          END-EXEC
  1969     MOVE LENGTH OF
  1970      NOTE-FILE
  1971       TO DFHEIV12
  1972     MOVE 'ERACNT' TO DFHEIV1
  1973     MOVE 0
  1974       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  37
* EL6503.cbl
  1975*    MOVE '&.IL                  )  N#00001743' TO DFHEIV0
  1976     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1977     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1978     MOVE X'204E233030303031373433' TO DFHEIV0(25:11)
  1979     CALL 'kxdfhei1' USING DFHEIV0,
  1980           DFHEIV1,
  1981           NOTE-FILE,
  1982           DFHEIV12,
  1983           WS-CONTROL-PRIMARY,
  1984           DFHEIV99,
  1985           DFHEIV11,
  1986           DFHEIV99,
  1987           DFHEIV99
  1988     MOVE EIBRESP  TO WS-RESPONSE
  1989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1990        END-IF
  1991     END-IF
  1992     IF (RESP-NORMAL)
  1993        AND (WS-CONTROL-PRIMARY (1:20) =
  1994           WS-SAVE-ERACNT-KEY (1:20))
  1995        IF (WS-REC-TYPE = '3')
  1996           AND (WS-SEQ-NO = 6)
  1997           MOVE NT-SHIPPING-LINE TO SCITYO
  1998           MOVE NT-SHIP-STATE    TO SSTATEO
  1999           MOVE NT-SHIP-ZIP      TO SZIPO
  2000           PERFORM 1010-BUILD-LAST-MAINT-INFO
  2001                                 THRU 1010-EXIT
  2002        END-IF
  2003     END-IF
  2004     IF ERACNT-BROWSE-STARTED
  2005
  2006* EXEC CICS ENDBR
  2007*          DATASET    ('ERACNT')
  2008*       END-EXEC
  2009     MOVE 'ERACNT' TO DFHEIV1
  2010     MOVE 0
  2011       TO DFHEIV11
  2012*    MOVE '&2                    $   #00001764' TO DFHEIV0
  2013     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2014     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2015     MOVE X'2020233030303031373634' TO DFHEIV0(25:11)
  2016     CALL 'kxdfhei1' USING DFHEIV0,
  2017           DFHEIV1,
  2018           DFHEIV11,
  2019           DFHEIV99
  2020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2021     END-IF
  2022     MOVE -1                     TO MAINTYPL
  2023     GO TO 8100-SEND-INITIAL-MAP
  2024     .
  2025 1000-EXIT.
  2026     EXIT.
  2027 1010-BUILD-LAST-MAINT-INFO.
  2028     MOVE NT-LAST-MAINT-BY       TO LSTUSRO
  2029     MOVE NT-LAST-MAINT-HHMMSS   TO TIME-IN
  2030     MOVE TIME-OUT               TO LSTTIMEO
  2031     MOVE NT-LAST-MAINT-DT       TO DC-BIN-DATE-1
  2032     MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  38
* EL6503.cbl
  2033     PERFORM 8500-DATE-CONVERSION
  2034                                 THRU 8500-EXIT
  2035     IF NO-CONVERSION-ERROR
  2036        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  2037     END-IF
  2038     .
  2039 1010-EXIT.
  2040     EXIT.
  2041 2000-DELETE-ERACNT.
  2042     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  2043     MOVE PI-ACCT-CARRIER        TO WS-CARRIER
  2044     MOVE PI-ACCT-GROUPING       TO WS-GROUPING
  2045     MOVE PI-ACCT-STATE          TO WS-STATE
  2046     MOVE PI-ACCT-ACCOUNT        TO WS-ACCOUNT
  2047     MOVE '2'                    TO WS-REC-TYPE
  2048     MOVE +1                     TO WS-SEQ-NO
  2049
  2050* EXEC CICS READ
  2051*       UPDATE
  2052*       DATASET  ('ERACNT')
  2053*       INTO     (NOTE-FILE)
  2054*       RIDFLD   (WS-CONTROL-PRIMARY)
  2055*       RESP     (WS-RESPONSE)
  2056*    END-EXEC
  2057     MOVE LENGTH OF
  2058      NOTE-FILE
  2059       TO DFHEIV11
  2060     MOVE 'ERACNT' TO DFHEIV1
  2061*    MOVE '&"IL       EU         (  N#00001795' TO DFHEIV0
  2062     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2063     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2064     MOVE X'204E233030303031373935' TO DFHEIV0(25:11)
  2065     CALL 'kxdfhei1' USING DFHEIV0,
  2066           DFHEIV1,
  2067           NOTE-FILE,
  2068           DFHEIV11,
  2069           WS-CONTROL-PRIMARY,
  2070           DFHEIV99,
  2071           DFHEIV99,
  2072           DFHEIV99
  2073     MOVE EIBRESP  TO WS-RESPONSE
  2074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2075     IF RESP-NORMAL
  2076
  2077* EXEC CICS DELETE
  2078*          DATASET    ('ERACNT')
  2079*          RESP       (WS-RESPONSE)
  2080*       END-EXEC
  2081     MOVE 'ERACNT' TO DFHEIV1
  2082*    MOVE '&(                    &  N#00001803' TO DFHEIV0
  2083     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2084     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2085     MOVE X'204E233030303031383033' TO DFHEIV0(25:11)
  2086     CALL 'kxdfhei1' USING DFHEIV0,
  2087           DFHEIV1,
  2088           DFHEIV99,
  2089           DFHEIV99,
  2090           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  39
* EL6503.cbl
  2091           DFHEIV99
  2092     MOVE EIBRESP  TO WS-RESPONSE
  2093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2094     END-IF
  2095     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  2096     MOVE PI-ACCT-CARRIER        TO WS-CARRIER
  2097     MOVE PI-ACCT-GROUPING       TO WS-GROUPING
  2098     MOVE PI-ACCT-STATE          TO WS-STATE
  2099     MOVE PI-ACCT-ACCOUNT        TO WS-ACCOUNT
  2100     MOVE '2'                    TO WS-REC-TYPE
  2101     MOVE +2                     TO WS-SEQ-NO
  2102
  2103* EXEC CICS READ
  2104*       UPDATE
  2105*       DATASET  ('ERACNT')
  2106*       INTO     (NOTE-FILE)
  2107*       RIDFLD   (WS-CONTROL-PRIMARY)
  2108*       RESP     (WS-RESPONSE)
  2109*    END-EXEC
  2110     MOVE LENGTH OF
  2111      NOTE-FILE
  2112       TO DFHEIV11
  2113     MOVE 'ERACNT' TO DFHEIV1
  2114*    MOVE '&"IL       EU         (  N#00001815' TO DFHEIV0
  2115     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2116     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2117     MOVE X'204E233030303031383135' TO DFHEIV0(25:11)
  2118     CALL 'kxdfhei1' USING DFHEIV0,
  2119           DFHEIV1,
  2120           NOTE-FILE,
  2121           DFHEIV11,
  2122           WS-CONTROL-PRIMARY,
  2123           DFHEIV99,
  2124           DFHEIV99,
  2125           DFHEIV99
  2126     MOVE EIBRESP  TO WS-RESPONSE
  2127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2128     IF RESP-NORMAL
  2129
  2130* EXEC CICS DELETE
  2131*          DATASET    ('ERACNT')
  2132*          RESP       (WS-RESPONSE)
  2133*       END-EXEC
  2134     MOVE 'ERACNT' TO DFHEIV1
  2135*    MOVE '&(                    &  N#00001823' TO DFHEIV0
  2136     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2137     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2138     MOVE X'204E233030303031383233' TO DFHEIV0(25:11)
  2139     CALL 'kxdfhei1' USING DFHEIV0,
  2140           DFHEIV1,
  2141           DFHEIV99,
  2142           DFHEIV99,
  2143           DFHEIV99,
  2144           DFHEIV99
  2145     MOVE EIBRESP  TO WS-RESPONSE
  2146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2147     END-IF
  2148     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  40
* EL6503.cbl
  2149     MOVE PI-ACCT-CARRIER        TO WS-CARRIER
  2150     MOVE PI-ACCT-GROUPING       TO WS-GROUPING
  2151     MOVE PI-ACCT-STATE          TO WS-STATE
  2152     MOVE PI-ACCT-ACCOUNT        TO WS-ACCOUNT
  2153     MOVE '2'                    TO WS-REC-TYPE
  2154     MOVE +3                     TO WS-SEQ-NO
  2155
  2156
  2157* EXEC CICS READ
  2158*       UPDATE
  2159*       DATASET  ('ERACNT')
  2160*       INTO     (NOTE-FILE)
  2161*       RIDFLD   (WS-CONTROL-PRIMARY)
  2162*       RESP     (WS-RESPONSE)
  2163*    END-EXEC
  2164     MOVE LENGTH OF
  2165      NOTE-FILE
  2166       TO DFHEIV11
  2167     MOVE 'ERACNT' TO DFHEIV1
  2168*    MOVE '&"IL       EU         (  N#00001836' TO DFHEIV0
  2169     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2170     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2171     MOVE X'204E233030303031383336' TO DFHEIV0(25:11)
  2172     CALL 'kxdfhei1' USING DFHEIV0,
  2173           DFHEIV1,
  2174           NOTE-FILE,
  2175           DFHEIV11,
  2176           WS-CONTROL-PRIMARY,
  2177           DFHEIV99,
  2178           DFHEIV99,
  2179           DFHEIV99
  2180     MOVE EIBRESP  TO WS-RESPONSE
  2181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2182
  2183     IF RESP-NORMAL
  2184
  2185* EXEC CICS DELETE
  2186*          DATASET    ('ERACNT')
  2187*          RESP       (WS-RESPONSE)
  2188*       END-EXEC
  2189     MOVE 'ERACNT' TO DFHEIV1
  2190*    MOVE '&(                    &  N#00001845' TO DFHEIV0
  2191     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2192     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2193     MOVE X'204E233030303031383435' TO DFHEIV0(25:11)
  2194     CALL 'kxdfhei1' USING DFHEIV0,
  2195           DFHEIV1,
  2196           DFHEIV99,
  2197           DFHEIV99,
  2198           DFHEIV99,
  2199           DFHEIV99
  2200     MOVE EIBRESP  TO WS-RESPONSE
  2201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2202     END-IF
  2203     PERFORM VARYING B1 FROM +1 BY +1 UNTIL
  2204        (B1 > +6)
  2205        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2206        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  41
* EL6503.cbl
  2207        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2208        MOVE PI-ACCT-STATE       TO WS-STATE
  2209        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2210        MOVE '3'                 TO WS-REC-TYPE
  2211        MOVE B1                  TO WS-SEQ-NO
  2212
  2213* EXEC CICS READ
  2214*          UPDATE
  2215*          DATASET  ('ERACNT')
  2216*          INTO     (NOTE-FILE)
  2217*          RIDFLD   (WS-CONTROL-PRIMARY)
  2218*          RESP     (WS-RESPONSE)
  2219*       END-EXEC
  2220     MOVE LENGTH OF
  2221      NOTE-FILE
  2222       TO DFHEIV11
  2223     MOVE 'ERACNT' TO DFHEIV1
  2224*    MOVE '&"IL       EU         (  N#00001859' TO DFHEIV0
  2225     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2226     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2227     MOVE X'204E233030303031383539' TO DFHEIV0(25:11)
  2228     CALL 'kxdfhei1' USING DFHEIV0,
  2229           DFHEIV1,
  2230           NOTE-FILE,
  2231           DFHEIV11,
  2232           WS-CONTROL-PRIMARY,
  2233           DFHEIV99,
  2234           DFHEIV99,
  2235           DFHEIV99
  2236     MOVE EIBRESP  TO WS-RESPONSE
  2237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2238        IF RESP-NORMAL
  2239
  2240* EXEC CICS DELETE
  2241*             DATASET    ('ERACNT')
  2242*             RESP       (WS-RESPONSE)
  2243*          END-EXEC
  2244     MOVE 'ERACNT' TO DFHEIV1
  2245*    MOVE '&(                    &  N#00001867' TO DFHEIV0
  2246     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2247     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2248     MOVE X'204E233030303031383637' TO DFHEIV0(25:11)
  2249     CALL 'kxdfhei1' USING DFHEIV0,
  2250           DFHEIV1,
  2251           DFHEIV99,
  2252           DFHEIV99,
  2253           DFHEIV99,
  2254           DFHEIV99
  2255     MOVE EIBRESP  TO WS-RESPONSE
  2256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2257        END-IF
  2258     END-PERFORM
  2259     .
  2260 2000-EXIT.
  2261     EXIT.
  2262 3000-CHANGE-ERACNT.
  2263     perform 3500-edit-screen-data
  2264                                 thru 3500-exit
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  42
* EL6503.cbl
  2265
  2266     if not emi-no-errors
  2267        go to 8200-send-dataonly
  2268     end-if
  2269     IF BLINE1L > ZEROS
  2270        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2271        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2272        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2273        MOVE PI-ACCT-STATE       TO WS-STATE
  2274        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2275        MOVE '2'                 TO WS-REC-TYPE
  2276        MOVE +1                  TO WS-SEQ-NO
  2277
  2278* EXEC CICS READ
  2279*          UPDATE
  2280*          DATASET  ('ERACNT')
  2281*          INTO     (NOTE-FILE)
  2282*          RIDFLD   (WS-CONTROL-PRIMARY)
  2283*          RESP     (WS-RESPONSE)
  2284*       END-EXEC
  2285     MOVE LENGTH OF
  2286      NOTE-FILE
  2287       TO DFHEIV11
  2288     MOVE 'ERACNT' TO DFHEIV1
  2289*    MOVE '&"IL       EU         (  N#00001891' TO DFHEIV0
  2290     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2291     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2292     MOVE X'204E233030303031383931' TO DFHEIV0(25:11)
  2293     CALL 'kxdfhei1' USING DFHEIV0,
  2294           DFHEIV1,
  2295           NOTE-FILE,
  2296           DFHEIV11,
  2297           WS-CONTROL-PRIMARY,
  2298           DFHEIV99,
  2299           DFHEIV99,
  2300           DFHEIV99
  2301     MOVE EIBRESP  TO WS-RESPONSE
  2302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2303        IF RESP-NORMAL
  2304           MOVE BLINE1I          TO NT-BRANCH-LOC-LINE
  2305           PERFORM 5020-REWRITE-ERACNT
  2306                                 THRU 5020-EXIT
  2307        ELSE
  2308           PERFORM 4010-ADD-BLINE1
  2309                                 THRU 4010-EXIT
  2310        END-IF
  2311     END-IF
  2312     IF BLINE2L > ZEROS
  2313        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2314        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2315        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2316        MOVE PI-ACCT-STATE       TO WS-STATE
  2317        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2318        MOVE '2'                 TO WS-REC-TYPE
  2319        MOVE +2                  TO WS-SEQ-NO
  2320
  2321* EXEC CICS READ
  2322*          UPDATE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  43
* EL6503.cbl
  2323*          DATASET  ('ERACNT')
  2324*          INTO     (NOTE-FILE)
  2325*          RIDFLD   (WS-CONTROL-PRIMARY)
  2326*          RESP     (WS-RESPONSE)
  2327*       END-EXEC
  2328     MOVE LENGTH OF
  2329      NOTE-FILE
  2330       TO DFHEIV11
  2331     MOVE 'ERACNT' TO DFHEIV1
  2332*    MOVE '&"IL       EU         (  N#00001915' TO DFHEIV0
  2333     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2334     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2335     MOVE X'204E233030303031393135' TO DFHEIV0(25:11)
  2336     CALL 'kxdfhei1' USING DFHEIV0,
  2337           DFHEIV1,
  2338           NOTE-FILE,
  2339           DFHEIV11,
  2340           WS-CONTROL-PRIMARY,
  2341           DFHEIV99,
  2342           DFHEIV99,
  2343           DFHEIV99
  2344     MOVE EIBRESP  TO WS-RESPONSE
  2345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2346        IF RESP-NORMAL
  2347           MOVE BLINE2I          TO NT-BRANCH-LOC-LINE
  2348           PERFORM 5020-REWRITE-ERACNT
  2349                                 THRU 5020-EXIT
  2350        ELSE
  2351           PERFORM 4012-ADD-BLINE2
  2352                                 THRU 4012-EXIT
  2353        END-IF
  2354     END-IF
  2355     IF actspcl > ZEROS
  2356        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2357        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2358        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2359        MOVE PI-ACCT-STATE       TO WS-STATE
  2360        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2361        MOVE '2'                 TO WS-REC-TYPE
  2362        MOVE +3                  TO WS-SEQ-NO
  2363
  2364
  2365* EXEC CICS READ
  2366*          UPDATE
  2367*          DATASET  ('ERACNT')
  2368*          INTO     (NOTE-FILE)
  2369*          RIDFLD   (WS-CONTROL-PRIMARY)
  2370*          RESP     (WS-RESPONSE)
  2371*       END-EXEC
  2372     MOVE LENGTH OF
  2373      NOTE-FILE
  2374       TO DFHEIV11
  2375     MOVE 'ERACNT' TO DFHEIV1
  2376*    MOVE '&"IL       EU         (  N#00001940' TO DFHEIV0
  2377     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2378     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2379     MOVE X'204E233030303031393430' TO DFHEIV0(25:11)
  2380     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  44
* EL6503.cbl
  2381           DFHEIV1,
  2382           NOTE-FILE,
  2383           DFHEIV11,
  2384           WS-CONTROL-PRIMARY,
  2385           DFHEIV99,
  2386           DFHEIV99,
  2387           DFHEIV99
  2388     MOVE EIBRESP  TO WS-RESPONSE
  2389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2390
  2391        IF RESP-NORMAL
  2392           MOVE actspci          TO NT-account-special
  2393           PERFORM 5020-REWRITE-ERACNT
  2394                                 THRU 5020-EXIT
  2395        ELSE
  2396           PERFORM 4013-ADD-actspc
  2397                                 THRU 4013-EXIT
  2398        END-IF
  2399     END-IF
  2400     IF SNAME1L > ZEROS
  2401        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2402        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2403        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2404        MOVE PI-ACCT-STATE       TO WS-STATE
  2405        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2406        MOVE '3'                 TO WS-REC-TYPE
  2407        MOVE +1                  TO WS-SEQ-NO
  2408
  2409* EXEC CICS READ
  2410*          UPDATE
  2411*          DATASET  ('ERACNT')
  2412*          INTO     (NOTE-FILE)
  2413*          RIDFLD   (WS-CONTROL-PRIMARY)
  2414*          RESP     (WS-RESPONSE)
  2415*       END-EXEC
  2416     MOVE LENGTH OF
  2417      NOTE-FILE
  2418       TO DFHEIV11
  2419     MOVE 'ERACNT' TO DFHEIV1
  2420*    MOVE '&"IL       EU         (  N#00001965' TO DFHEIV0
  2421     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2422     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2423     MOVE X'204E233030303031393635' TO DFHEIV0(25:11)
  2424     CALL 'kxdfhei1' USING DFHEIV0,
  2425           DFHEIV1,
  2426           NOTE-FILE,
  2427           DFHEIV11,
  2428           WS-CONTROL-PRIMARY,
  2429           DFHEIV99,
  2430           DFHEIV99,
  2431           DFHEIV99
  2432     MOVE EIBRESP  TO WS-RESPONSE
  2433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2434        IF RESP-NORMAL
  2435           MOVE SNAME1I          TO NT-SHIPPING-LINE
  2436           PERFORM 5020-REWRITE-ERACNT
  2437                                 THRU 5020-EXIT
  2438        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  45
* EL6503.cbl
  2439           PERFORM 4014-ADD-SNAME1
  2440                                 THRU 4014-EXIT
  2441        END-IF
  2442     END-IF
  2443     IF SNAME2L > ZEROS
  2444        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2445        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2446        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2447        MOVE PI-ACCT-STATE       TO WS-STATE
  2448        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2449        MOVE '3'                 TO WS-REC-TYPE
  2450        MOVE +2                  TO WS-SEQ-NO
  2451
  2452* EXEC CICS READ
  2453*          UPDATE
  2454*          DATASET  ('ERACNT')
  2455*          INTO     (NOTE-FILE)
  2456*          RIDFLD   (WS-CONTROL-PRIMARY)
  2457*          RESP     (WS-RESPONSE)
  2458*       END-EXEC
  2459     MOVE LENGTH OF
  2460      NOTE-FILE
  2461       TO DFHEIV11
  2462     MOVE 'ERACNT' TO DFHEIV1
  2463*    MOVE '&"IL       EU         (  N#00001989' TO DFHEIV0
  2464     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2465     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2466     MOVE X'204E233030303031393839' TO DFHEIV0(25:11)
  2467     CALL 'kxdfhei1' USING DFHEIV0,
  2468           DFHEIV1,
  2469           NOTE-FILE,
  2470           DFHEIV11,
  2471           WS-CONTROL-PRIMARY,
  2472           DFHEIV99,
  2473           DFHEIV99,
  2474           DFHEIV99
  2475     MOVE EIBRESP  TO WS-RESPONSE
  2476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2477        IF RESP-NORMAL
  2478           MOVE SNAME2I          TO NT-SHIPPING-LINE
  2479           PERFORM 5020-REWRITE-ERACNT
  2480                                 THRU 5020-EXIT
  2481        ELSE
  2482           PERFORM 4016-ADD-SNAME2
  2483                                 THRU 4016-EXIT
  2484        END-IF
  2485     END-IF
  2486     IF SADDR1L > ZEROS
  2487        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2488        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2489        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2490        MOVE PI-ACCT-STATE       TO WS-STATE
  2491        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2492        MOVE '3'                 TO WS-REC-TYPE
  2493        MOVE +3                  TO WS-SEQ-NO
  2494
  2495* EXEC CICS READ
  2496*          UPDATE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  46
* EL6503.cbl
  2497*          DATASET  ('ERACNT')
  2498*          INTO     (NOTE-FILE)
  2499*          RIDFLD   (WS-CONTROL-PRIMARY)
  2500*          RESP     (WS-RESPONSE)
  2501*       END-EXEC
  2502     MOVE LENGTH OF
  2503      NOTE-FILE
  2504       TO DFHEIV11
  2505     MOVE 'ERACNT' TO DFHEIV1
  2506*    MOVE '&"IL       EU         (  N#00002013' TO DFHEIV0
  2507     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2508     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2509     MOVE X'204E233030303032303133' TO DFHEIV0(25:11)
  2510     CALL 'kxdfhei1' USING DFHEIV0,
  2511           DFHEIV1,
  2512           NOTE-FILE,
  2513           DFHEIV11,
  2514           WS-CONTROL-PRIMARY,
  2515           DFHEIV99,
  2516           DFHEIV99,
  2517           DFHEIV99
  2518     MOVE EIBRESP  TO WS-RESPONSE
  2519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2520        IF RESP-NORMAL
  2521           MOVE SADDR1I          TO NT-SHIPPING-LINE
  2522           PERFORM 5020-REWRITE-ERACNT
  2523                                 THRU 5020-EXIT
  2524        ELSE
  2525           PERFORM 4018-ADD-SADDR1
  2526                                 THRU 4018-EXIT
  2527        END-IF
  2528     END-IF
  2529     IF SADDR2L > ZEROS
  2530        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2531        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2532        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2533        MOVE PI-ACCT-STATE       TO WS-STATE
  2534        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2535        MOVE '3'                 TO WS-REC-TYPE
  2536        MOVE +4                  TO WS-SEQ-NO
  2537
  2538* EXEC CICS READ
  2539*          UPDATE
  2540*          DATASET  ('ERACNT')
  2541*          INTO     (NOTE-FILE)
  2542*          RIDFLD   (WS-CONTROL-PRIMARY)
  2543*          RESP     (WS-RESPONSE)
  2544*       END-EXEC
  2545     MOVE LENGTH OF
  2546      NOTE-FILE
  2547       TO DFHEIV11
  2548     MOVE 'ERACNT' TO DFHEIV1
  2549*    MOVE '&"IL       EU         (  N#00002037' TO DFHEIV0
  2550     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2551     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2552     MOVE X'204E233030303032303337' TO DFHEIV0(25:11)
  2553     CALL 'kxdfhei1' USING DFHEIV0,
  2554           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  47
* EL6503.cbl
  2555           NOTE-FILE,
  2556           DFHEIV11,
  2557           WS-CONTROL-PRIMARY,
  2558           DFHEIV99,
  2559           DFHEIV99,
  2560           DFHEIV99
  2561     MOVE EIBRESP  TO WS-RESPONSE
  2562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2563        IF RESP-NORMAL
  2564           MOVE SADDR2I          TO NT-SHIPPING-LINE
  2565           PERFORM 5020-REWRITE-ERACNT
  2566                                 THRU 5020-EXIT
  2567        ELSE
  2568           PERFORM 4020-ADD-SADDR2
  2569                                 THRU 4020-EXIT
  2570        END-IF
  2571     END-IF
  2572     IF SADDR3L    > ZEROS
  2573        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2574        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2575        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2576        MOVE PI-ACCT-STATE       TO WS-STATE
  2577        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2578        MOVE '3'                 TO WS-REC-TYPE
  2579        MOVE +5                  TO WS-SEQ-NO
  2580
  2581* EXEC CICS READ
  2582*          UPDATE
  2583*          DATASET  ('ERACNT')
  2584*          INTO     (NOTE-FILE)
  2585*          RIDFLD   (WS-CONTROL-PRIMARY)
  2586*          RESP     (WS-RESPONSE)
  2587*       END-EXEC
  2588     MOVE LENGTH OF
  2589      NOTE-FILE
  2590       TO DFHEIV11
  2591     MOVE 'ERACNT' TO DFHEIV1
  2592*    MOVE '&"IL       EU         (  N#00002061' TO DFHEIV0
  2593     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2594     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2595     MOVE X'204E233030303032303631' TO DFHEIV0(25:11)
  2596     CALL 'kxdfhei1' USING DFHEIV0,
  2597           DFHEIV1,
  2598           NOTE-FILE,
  2599           DFHEIV11,
  2600           WS-CONTROL-PRIMARY,
  2601           DFHEIV99,
  2602           DFHEIV99,
  2603           DFHEIV99
  2604     MOVE EIBRESP  TO WS-RESPONSE
  2605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2606        IF RESP-NORMAL
  2607           MOVE SADDR3I          TO NT-SHIPPING-LINE
  2608           PERFORM 5020-REWRITE-ERACNT
  2609                                 THRU 5020-EXIT
  2610        ELSE
  2611           PERFORM 4022-ADD-SADDR3
  2612                                 THRU 4022-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  48
* EL6503.cbl
  2613        END-IF
  2614     END-IF
  2615     IF (SCITYL     > ZEROS)
  2616        OR (SSTATEL > ZEROS)
  2617        OR (SZIPL   > ZEROS)
  2618        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2619        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2620        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2621        MOVE PI-ACCT-STATE       TO WS-STATE
  2622        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2623        MOVE '3'                 TO WS-REC-TYPE
  2624        MOVE +6                  TO WS-SEQ-NO
  2625
  2626* EXEC CICS READ
  2627*          UPDATE
  2628*          DATASET  ('ERACNT')
  2629*          INTO     (NOTE-FILE)
  2630*          RIDFLD   (WS-CONTROL-PRIMARY)
  2631*          RESP     (WS-RESPONSE)
  2632*       END-EXEC
  2633     MOVE LENGTH OF
  2634      NOTE-FILE
  2635       TO DFHEIV11
  2636     MOVE 'ERACNT' TO DFHEIV1
  2637*    MOVE '&"IL       EU         (  N#00002087' TO DFHEIV0
  2638     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2639     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2640     MOVE X'204E233030303032303837' TO DFHEIV0(25:11)
  2641     CALL 'kxdfhei1' USING DFHEIV0,
  2642           DFHEIV1,
  2643           NOTE-FILE,
  2644           DFHEIV11,
  2645           WS-CONTROL-PRIMARY,
  2646           DFHEIV99,
  2647           DFHEIV99,
  2648           DFHEIV99
  2649     MOVE EIBRESP  TO WS-RESPONSE
  2650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2651        IF RESP-NORMAL
  2652           IF SCITYL > ZEROS
  2653              MOVE SCITYI        TO NT-SHIPPING-LINE
  2654           END-IF
  2655           IF SSTATEL > ZEROS
  2656              MOVE SSTATEI       TO NT-SHIP-STATE
  2657           END-IF
  2658           IF SZIPL > ZEROS
  2659              MOVE SZIPI         TO NT-SHIP-ZIP
  2660           END-IF
  2661           PERFORM 5020-REWRITE-ERACNT
  2662                                 THRU 5020-EXIT
  2663        ELSE
  2664           PERFORM 4024-ADD-SCITYSTZP
  2665                                 THRU 4024-EXIT
  2666        END-IF
  2667     END-IF
  2668     .
  2669 3000-EXIT.
  2670     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  49
* EL6503.cbl
  2671 3500-edit-screen-data.
  2672
  2673     if actspcl > zeros
  2674        if actspci <> 'Y' and 'N' and ' '
  2675           move al-uabon         to actspca
  2676           move -1               to actspcl
  2677           move er-3271          to emi-error
  2678           perform 9900-error-format
  2679                                 thru 9900-exit
  2680        else
  2681           move al-uanon         to actspca
  2682        end-if
  2683     end-if
  2684
  2685
  2686     .
  2687 3500-exit.
  2688     exit.
  2689 4000-ADD-ERACNT.
  2690     perform 3500-edit-screen-data
  2691                                 thru 3500-exit
  2692
  2693     if not emi-no-errors
  2694        go to 8200-send-dataonly
  2695     end-if
  2696     PERFORM 4010-ADD-BLINE1     THRU 4010-EXIT
  2697     PERFORM 4012-ADD-BLINE2     THRU 4012-EXIT
  2698     PERFORM 4013-ADD-actspc     THRU 4013-EXIT
  2699     PERFORM 4014-ADD-SNAME1     THRU 4014-EXIT
  2700     PERFORM 4016-ADD-SNAME2     THRU 4016-EXIT
  2701     PERFORM 4018-ADD-SADDR1     THRU 4018-EXIT
  2702     PERFORM 4020-ADD-SADDR2     THRU 4020-EXIT
  2703     PERFORM 4022-ADD-SADDR3     THRU 4022-EXIT
  2704     PERFORM 4024-ADD-SCITYSTZP  THRU 4024-EXIT
  2705     .
  2706 4000-EXIT.
  2707     EXIT.
  2708 4010-ADD-BLINE1.
  2709     IF BLINE1L > ZEROS
  2710        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2711        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2712        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2713        MOVE PI-ACCT-STATE       TO WS-STATE
  2714        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2715        MOVE '2'                 TO WS-REC-TYPE
  2716        MOVE +1                  TO WS-SEQ-NO
  2717
  2718* EXEC CICS READ
  2719*          DATASET  ('ERACNT')
  2720*          INTO     (NOTE-FILE)
  2721*          RIDFLD   (WS-CONTROL-PRIMARY)
  2722*          RESP     (WS-RESPONSE)
  2723*       END-EXEC
  2724     MOVE LENGTH OF
  2725      NOTE-FILE
  2726       TO DFHEIV11
  2727     MOVE 'ERACNT' TO DFHEIV1
  2728*    MOVE '&"IL       E          (  N#00002160' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  50
* EL6503.cbl
  2729     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2730     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2731     MOVE X'204E233030303032313630' TO DFHEIV0(25:11)
  2732     CALL 'kxdfhei1' USING DFHEIV0,
  2733           DFHEIV1,
  2734           NOTE-FILE,
  2735           DFHEIV11,
  2736           WS-CONTROL-PRIMARY,
  2737           DFHEIV99,
  2738           DFHEIV99,
  2739           DFHEIV99
  2740     MOVE EIBRESP  TO WS-RESPONSE
  2741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2742        IF RESP-NOTFND
  2743           PERFORM 5010-BUILD-ERACNT
  2744                                 THRU 5010-EXIT
  2745           MOVE BLINE1I          TO NT-BRANCH-LOC-LINE
  2746           PERFORM 5000-WRITE-ERACNT
  2747                                 THRU 5000-EXIT
  2748        END-IF
  2749     END-IF
  2750     .
  2751 4010-EXIT.
  2752     EXIT.
  2753 4012-ADD-BLINE2.
  2754     IF BLINE2L > ZEROS
  2755        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2756        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2757        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2758        MOVE PI-ACCT-STATE       TO WS-STATE
  2759        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2760        MOVE '2'                 TO WS-REC-TYPE
  2761        MOVE +2                  TO WS-SEQ-NO
  2762
  2763* EXEC CICS READ
  2764*          DATASET  ('ERACNT')
  2765*          INTO     (NOTE-FILE)
  2766*          RIDFLD   (WS-CONTROL-PRIMARY)
  2767*          RESP     (WS-RESPONSE)
  2768*       END-EXEC
  2769     MOVE LENGTH OF
  2770      NOTE-FILE
  2771       TO DFHEIV11
  2772     MOVE 'ERACNT' TO DFHEIV1
  2773*    MOVE '&"IL       E          (  N#00002186' TO DFHEIV0
  2774     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2775     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2776     MOVE X'204E233030303032313836' TO DFHEIV0(25:11)
  2777     CALL 'kxdfhei1' USING DFHEIV0,
  2778           DFHEIV1,
  2779           NOTE-FILE,
  2780           DFHEIV11,
  2781           WS-CONTROL-PRIMARY,
  2782           DFHEIV99,
  2783           DFHEIV99,
  2784           DFHEIV99
  2785     MOVE EIBRESP  TO WS-RESPONSE
  2786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  51
* EL6503.cbl
  2787        IF RESP-NOTFND
  2788           PERFORM 5010-BUILD-ERACNT
  2789                                 THRU 5010-EXIT
  2790           MOVE BLINE2I          TO NT-BRANCH-LOC-LINE
  2791           PERFORM 5000-WRITE-ERACNT
  2792                                 THRU 5000-EXIT
  2793        END-IF
  2794     END-IF
  2795     .
  2796 4012-EXIT.
  2797     EXIT.
  2798 4013-ADD-actspc.
  2799
  2800     IF actspcL > ZEROS
  2801        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2802        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2803        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2804        MOVE PI-ACCT-STATE       TO WS-STATE
  2805        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2806        MOVE '2'                 TO WS-REC-TYPE
  2807        MOVE +3                  TO WS-SEQ-NO
  2808
  2809
  2810* EXEC CICS READ
  2811*          DATASET  ('ERACNT')
  2812*          INTO     (NOTE-FILE)
  2813*          RIDFLD   (WS-CONTROL-PRIMARY)
  2814*          RESP     (WS-RESPONSE)
  2815*       END-EXEC
  2816     MOVE LENGTH OF
  2817      NOTE-FILE
  2818       TO DFHEIV11
  2819     MOVE 'ERACNT' TO DFHEIV1
  2820*    MOVE '&"IL       E          (  N#00002214' TO DFHEIV0
  2821     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2822     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2823     MOVE X'204E233030303032323134' TO DFHEIV0(25:11)
  2824     CALL 'kxdfhei1' USING DFHEIV0,
  2825           DFHEIV1,
  2826           NOTE-FILE,
  2827           DFHEIV11,
  2828           WS-CONTROL-PRIMARY,
  2829           DFHEIV99,
  2830           DFHEIV99,
  2831           DFHEIV99
  2832     MOVE EIBRESP  TO WS-RESPONSE
  2833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2834
  2835        IF RESP-NOTFND
  2836           PERFORM 5010-BUILD-ERACNT
  2837                                 THRU 5010-EXIT
  2838           MOVE actspci          TO NT-account-special
  2839           PERFORM 5000-WRITE-ERACNT
  2840                                 THRU 5000-EXIT
  2841        END-IF
  2842     END-IF
  2843
  2844     .
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  52
* EL6503.cbl
  2845 4013-EXIT.
  2846     EXIT.
  2847 4014-ADD-SNAME1.
  2848     IF SNAME1L > ZEROS
  2849        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2850        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2851        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2852        MOVE PI-ACCT-STATE       TO WS-STATE
  2853        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2854        MOVE '3'                 TO WS-REC-TYPE
  2855        MOVE +1                  TO WS-SEQ-NO
  2856
  2857* EXEC CICS READ
  2858*          DATASET  ('ERACNT')
  2859*          INTO     (NOTE-FILE)
  2860*          RIDFLD   (WS-CONTROL-PRIMARY)
  2861*          RESP     (WS-RESPONSE)
  2862*       END-EXEC
  2863     MOVE LENGTH OF
  2864      NOTE-FILE
  2865       TO DFHEIV11
  2866     MOVE 'ERACNT' TO DFHEIV1
  2867*    MOVE '&"IL       E          (  N#00002242' TO DFHEIV0
  2868     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2869     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2870     MOVE X'204E233030303032323432' TO DFHEIV0(25:11)
  2871     CALL 'kxdfhei1' USING DFHEIV0,
  2872           DFHEIV1,
  2873           NOTE-FILE,
  2874           DFHEIV11,
  2875           WS-CONTROL-PRIMARY,
  2876           DFHEIV99,
  2877           DFHEIV99,
  2878           DFHEIV99
  2879     MOVE EIBRESP  TO WS-RESPONSE
  2880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2881        IF RESP-NOTFND
  2882           PERFORM 5010-BUILD-ERACNT
  2883                                 THRU 5010-EXIT
  2884           MOVE SNAME1I          TO NT-SHIPPING-LINE
  2885           PERFORM 5000-WRITE-ERACNT
  2886                                 THRU 5000-EXIT
  2887        END-IF
  2888     END-IF
  2889     .
  2890 4014-EXIT.
  2891     EXIT.
  2892 4016-ADD-SNAME2.
  2893     IF SNAME2L > ZEROS
  2894        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2895        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2896        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2897        MOVE PI-ACCT-STATE       TO WS-STATE
  2898        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2899        MOVE '3'                 TO WS-REC-TYPE
  2900        MOVE +2                  TO WS-SEQ-NO
  2901
  2902* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  53
* EL6503.cbl
  2903*          DATASET  ('ERACNT')
  2904*          INTO     (NOTE-FILE)
  2905*          RIDFLD   (WS-CONTROL-PRIMARY)
  2906*          RESP     (WS-RESPONSE)
  2907*       END-EXEC
  2908     MOVE LENGTH OF
  2909      NOTE-FILE
  2910       TO DFHEIV11
  2911     MOVE 'ERACNT' TO DFHEIV1
  2912*    MOVE '&"IL       E          (  N#00002268' TO DFHEIV0
  2913     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2914     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2915     MOVE X'204E233030303032323638' TO DFHEIV0(25:11)
  2916     CALL 'kxdfhei1' USING DFHEIV0,
  2917           DFHEIV1,
  2918           NOTE-FILE,
  2919           DFHEIV11,
  2920           WS-CONTROL-PRIMARY,
  2921           DFHEIV99,
  2922           DFHEIV99,
  2923           DFHEIV99
  2924     MOVE EIBRESP  TO WS-RESPONSE
  2925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2926        IF RESP-NOTFND
  2927           PERFORM 5010-BUILD-ERACNT
  2928                                 THRU 5010-EXIT
  2929           MOVE SNAME2I          TO NT-SHIPPING-LINE
  2930           PERFORM 5000-WRITE-ERACNT
  2931                                 THRU 5000-EXIT
  2932        END-IF
  2933     END-IF
  2934     .
  2935 4016-EXIT.
  2936     EXIT.
  2937 4018-ADD-SADDR1.
  2938     IF SADDR1L > ZEROS
  2939        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2940        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2941        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2942        MOVE PI-ACCT-STATE       TO WS-STATE
  2943        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2944        MOVE '3'                 TO WS-REC-TYPE
  2945        MOVE +3                  TO WS-SEQ-NO
  2946
  2947* EXEC CICS READ
  2948*          DATASET  ('ERACNT')
  2949*          INTO     (NOTE-FILE)
  2950*          RIDFLD   (WS-CONTROL-PRIMARY)
  2951*          RESP     (WS-RESPONSE)
  2952*       END-EXEC
  2953     MOVE LENGTH OF
  2954      NOTE-FILE
  2955       TO DFHEIV11
  2956     MOVE 'ERACNT' TO DFHEIV1
  2957*    MOVE '&"IL       E          (  N#00002294' TO DFHEIV0
  2958     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2959     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2960     MOVE X'204E233030303032323934' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  54
* EL6503.cbl
  2961     CALL 'kxdfhei1' USING DFHEIV0,
  2962           DFHEIV1,
  2963           NOTE-FILE,
  2964           DFHEIV11,
  2965           WS-CONTROL-PRIMARY,
  2966           DFHEIV99,
  2967           DFHEIV99,
  2968           DFHEIV99
  2969     MOVE EIBRESP  TO WS-RESPONSE
  2970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2971        IF RESP-NOTFND
  2972           PERFORM 5010-BUILD-ERACNT
  2973                                 THRU 5010-EXIT
  2974           MOVE SADDR1I          TO NT-SHIPPING-LINE
  2975           PERFORM 5000-WRITE-ERACNT
  2976                                 THRU 5000-EXIT
  2977        END-IF
  2978     END-IF
  2979     .
  2980 4018-EXIT.
  2981     EXIT.
  2982 4020-ADD-SADDR2.
  2983     IF SADDR2L > ZEROS
  2984        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2985        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2986        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2987        MOVE PI-ACCT-STATE       TO WS-STATE
  2988        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2989        MOVE '3'                 TO WS-REC-TYPE
  2990        MOVE +4                  TO WS-SEQ-NO
  2991
  2992* EXEC CICS READ
  2993*          DATASET  ('ERACNT')
  2994*          INTO     (NOTE-FILE)
  2995*          RIDFLD   (WS-CONTROL-PRIMARY)
  2996*          RESP     (WS-RESPONSE)
  2997*       END-EXEC
  2998     MOVE LENGTH OF
  2999      NOTE-FILE
  3000       TO DFHEIV11
  3001     MOVE 'ERACNT' TO DFHEIV1
  3002*    MOVE '&"IL       E          (  N#00002320' TO DFHEIV0
  3003     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3004     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3005     MOVE X'204E233030303032333230' TO DFHEIV0(25:11)
  3006     CALL 'kxdfhei1' USING DFHEIV0,
  3007           DFHEIV1,
  3008           NOTE-FILE,
  3009           DFHEIV11,
  3010           WS-CONTROL-PRIMARY,
  3011           DFHEIV99,
  3012           DFHEIV99,
  3013           DFHEIV99
  3014     MOVE EIBRESP  TO WS-RESPONSE
  3015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3016        IF RESP-NOTFND
  3017           PERFORM 5010-BUILD-ERACNT
  3018                                 THRU 5010-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  55
* EL6503.cbl
  3019           MOVE SADDR2I          TO NT-SHIPPING-LINE
  3020           PERFORM 5000-WRITE-ERACNT
  3021                                 THRU 5000-EXIT
  3022        END-IF
  3023     END-IF
  3024    .
  3025 4020-EXIT.
  3026     EXIT.
  3027 4022-ADD-SADDR3.
  3028     IF SADDR3L    > ZEROS
  3029        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  3030        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  3031        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  3032        MOVE PI-ACCT-STATE       TO WS-STATE
  3033        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  3034        MOVE '3'                 TO WS-REC-TYPE
  3035        MOVE +5                  TO WS-SEQ-NO
  3036
  3037* EXEC CICS READ
  3038*          DATASET  ('ERACNT')
  3039*          INTO     (NOTE-FILE)
  3040*          RIDFLD   (WS-CONTROL-PRIMARY)
  3041*          RESP     (WS-RESPONSE)
  3042*       END-EXEC
  3043     MOVE LENGTH OF
  3044      NOTE-FILE
  3045       TO DFHEIV11
  3046     MOVE 'ERACNT' TO DFHEIV1
  3047*    MOVE '&"IL       E          (  N#00002346' TO DFHEIV0
  3048     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3049     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3050     MOVE X'204E233030303032333436' TO DFHEIV0(25:11)
  3051     CALL 'kxdfhei1' USING DFHEIV0,
  3052           DFHEIV1,
  3053           NOTE-FILE,
  3054           DFHEIV11,
  3055           WS-CONTROL-PRIMARY,
  3056           DFHEIV99,
  3057           DFHEIV99,
  3058           DFHEIV99
  3059     MOVE EIBRESP  TO WS-RESPONSE
  3060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3061        IF RESP-NOTFND
  3062           PERFORM 5010-BUILD-ERACNT
  3063                                 THRU 5010-EXIT
  3064           MOVE SADDR3I          TO NT-SHIPPING-LINE
  3065           PERFORM 5000-WRITE-ERACNT
  3066                                 THRU 5000-EXIT
  3067        END-IF
  3068     END-IF
  3069     .
  3070 4022-EXIT.
  3071     EXIT.
  3072 4024-ADD-SCITYSTZP.
  3073     IF (SCITYL     > ZEROS)
  3074        OR (SSTATEL > ZEROS)
  3075        OR (SZIPL   > ZEROS)
  3076        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  56
* EL6503.cbl
  3077        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  3078        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  3079        MOVE PI-ACCT-STATE       TO WS-STATE
  3080        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  3081        MOVE '3'                 TO WS-REC-TYPE
  3082        MOVE +6                  TO WS-SEQ-NO
  3083
  3084* EXEC CICS READ
  3085*          DATASET  ('ERACNT')
  3086*          INTO     (NOTE-FILE)
  3087*          RIDFLD   (WS-CONTROL-PRIMARY)
  3088*          RESP     (WS-RESPONSE)
  3089*       END-EXEC
  3090     MOVE LENGTH OF
  3091      NOTE-FILE
  3092       TO DFHEIV11
  3093     MOVE 'ERACNT' TO DFHEIV1
  3094*    MOVE '&"IL       E          (  N#00002374' TO DFHEIV0
  3095     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3096     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3097     MOVE X'204E233030303032333734' TO DFHEIV0(25:11)
  3098     CALL 'kxdfhei1' USING DFHEIV0,
  3099           DFHEIV1,
  3100           NOTE-FILE,
  3101           DFHEIV11,
  3102           WS-CONTROL-PRIMARY,
  3103           DFHEIV99,
  3104           DFHEIV99,
  3105           DFHEIV99
  3106     MOVE EIBRESP  TO WS-RESPONSE
  3107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3108        IF RESP-NOTFND
  3109           PERFORM 5010-BUILD-ERACNT
  3110                                 THRU 5010-EXIT
  3111           IF SCITYL > ZEROS
  3112              MOVE SCITYI        TO NT-SHIPPING-LINE
  3113           END-IF
  3114           IF SSTATEL > ZEROS
  3115              MOVE SSTATEI       TO NT-SHIP-STATE
  3116           END-IF
  3117           IF SZIPL > ZEROS
  3118              MOVE SZIPI         TO NT-SHIP-ZIP
  3119           END-IF
  3120           PERFORM 5000-WRITE-ERACNT
  3121                                 THRU 5000-EXIT
  3122        END-IF
  3123     END-IF
  3124     .
  3125 4024-EXIT.
  3126     EXIT.
  3127 5000-WRITE-ERACNT.
  3128     MOVE SAVE-BIN-DATE          TO NT-LAST-MAINT-DT
  3129     MOVE EIBTIME                TO NT-LAST-MAINT-HHMMSS
  3130     MOVE PI-PROCESSOR-ID        TO NT-LAST-MAINT-BY
  3131
  3132* EXEC CICS WRITE
  3133*         FROM    (NOTE-FILE)
  3134*         DATASET ('ERACNT')
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  57
* EL6503.cbl
  3135*         RIDFLD  (WS-CONTROL-PRIMARY)
  3136*         RESP    (WS-RESPONSE)
  3137*    END-EXEC
  3138     MOVE LENGTH OF
  3139      NOTE-FILE
  3140       TO DFHEIV11
  3141     MOVE 'ERACNT' TO DFHEIV1
  3142*    MOVE '&$ L                  ''  N#00002403' TO DFHEIV0
  3143     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3144     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3145     MOVE X'204E233030303032343033' TO DFHEIV0(25:11)
  3146     CALL 'kxdfhei1' USING DFHEIV0,
  3147           DFHEIV1,
  3148           NOTE-FILE,
  3149           DFHEIV11,
  3150           WS-CONTROL-PRIMARY,
  3151           DFHEIV99,
  3152           DFHEIV99
  3153     MOVE EIBRESP  TO WS-RESPONSE
  3154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3155     .
  3156 5000-EXIT.
  3157     EXIT.
  3158 5010-BUILD-ERACNT.
  3159     MOVE SPACES                 TO NOTE-FILE
  3160     MOVE 'NT'                   TO NT-FILE-ID
  3161     MOVE WS-CONTROL-PRIMARY     TO NT-CONTROL-PRIMARY
  3162     MOVE SAVE-BIN-DATE          TO NT-LAST-MAINT-DT
  3163     MOVE EIBTIME                TO NT-LAST-MAINT-HHMMSS
  3164     MOVE PI-PROCESSOR-ID        TO NT-LAST-MAINT-BY
  3165     .
  3166 5010-EXIT.
  3167     EXIT.
  3168 5020-REWRITE-ERACNT.
  3169     MOVE SAVE-BIN-DATE          TO NT-LAST-MAINT-DT
  3170     MOVE EIBTIME                TO NT-LAST-MAINT-HHMMSS
  3171     MOVE PI-PROCESSOR-ID        TO NT-LAST-MAINT-BY
  3172
  3173* EXEC CICS REWRITE
  3174*         FROM    (NOTE-FILE)
  3175*         DATASET ('ERACNT')
  3176*         RESP    (WS-RESPONSE)
  3177*    END-EXEC
  3178     MOVE LENGTH OF
  3179      NOTE-FILE
  3180       TO DFHEIV11
  3181     MOVE 'ERACNT' TO DFHEIV1
  3182*    MOVE '&& L                  %  N#00002426' TO DFHEIV0
  3183     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3184     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3185     MOVE X'204E233030303032343236' TO DFHEIV0(25:11)
  3186     CALL 'kxdfhei1' USING DFHEIV0,
  3187           DFHEIV1,
  3188           NOTE-FILE,
  3189           DFHEIV11,
  3190           DFHEIV99
  3191     MOVE EIBRESP  TO WS-RESPONSE
  3192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  58
* EL6503.cbl
  3193     .
  3194 5020-EXIT.
  3195     EXIT.
  3196 8100-SEND-INITIAL-MAP.
  3197     MOVE -1                     TO  MAINTYPL
  3198     MOVE SAVE-DATE              TO  RUNDATEO
  3199     MOVE EIBTIME                TO  TIME-IN
  3200     MOVE TIME-OUT               TO  RUNTIMEO
  3201     IF EMI-ERROR NOT = ZERO
  3202         PERFORM 9900-ERROR-FORMAT
  3203     END-IF
  3204     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  3205
  3206* EXEC CICS SEND
  3207*        FROM   (EL6503AO)
  3208*        MAPSET (WS-MAPSET-NAME)
  3209*        MAP    (WS-MAP-NAME)
  3210*        CURSOR ERASE
  3211*    END-EXEC.
  3212     MOVE LENGTH OF
  3213      EL6503AO
  3214       TO DFHEIV12
  3215     MOVE -1
  3216       TO DFHEIV11
  3217*    MOVE '8$     CT  E    H L F ,   #00002443' TO DFHEIV0
  3218     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3219     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3220     MOVE X'2020233030303032343433' TO DFHEIV0(25:11)
  3221     CALL 'kxdfhei1' USING DFHEIV0,
  3222           WS-MAP-NAME,
  3223           EL6503AO,
  3224           DFHEIV12,
  3225           WS-MAPSET-NAME,
  3226           DFHEIV99,
  3227           DFHEIV99,
  3228           DFHEIV99,
  3229           DFHEIV11,
  3230           DFHEIV99,
  3231           DFHEIV99,
  3232           DFHEIV99
  3233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3234
  3235     GO TO 9100-RETURN-TRAN
  3236     .
  3237 8100-EXIT.
  3238      EXIT.
  3239 8200-SEND-DATAONLY.
  3240     MOVE SAVE-DATE              TO  RUNDATEO
  3241     MOVE EIBTIME                TO  TIME-IN
  3242     MOVE TIME-OUT               TO  RUNTIMEO
  3243     IF EMI-ERROR NOT = ZERO
  3244        PERFORM 9900-ERROR-FORMAT
  3245     END-IF
  3246     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  3247
  3248* EXEC CICS SEND DATAONLY
  3249*        FROM   (EL6503AO)
  3250*        MAPSET (WS-MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  59
* EL6503.cbl
  3251*        MAP    (WS-MAP-NAME)
  3252*        CURSOR
  3253*    END-EXEC.
  3254     MOVE LENGTH OF
  3255      EL6503AO
  3256       TO DFHEIV12
  3257     MOVE -1
  3258       TO DFHEIV11
  3259*    MOVE '8$D    CT       H L F ,   #00002461' TO DFHEIV0
  3260     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3261     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3262     MOVE X'2020233030303032343631' TO DFHEIV0(25:11)
  3263     CALL 'kxdfhei1' USING DFHEIV0,
  3264           WS-MAP-NAME,
  3265           EL6503AO,
  3266           DFHEIV12,
  3267           WS-MAPSET-NAME,
  3268           DFHEIV99,
  3269           DFHEIV99,
  3270           DFHEIV99,
  3271           DFHEIV11,
  3272           DFHEIV99,
  3273           DFHEIV99,
  3274           DFHEIV99
  3275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3276
  3277     GO TO 9100-RETURN-TRAN
  3278     .
  3279 8200-EXIT.
  3280      EXIT.
  3281 8300-SEND-TEXT.
  3282
  3283* EXEC CICS SEND TEXT
  3284*        FROM   (LOGOFF-TEXT)
  3285*        LENGTH (LOGOFF-LENGTH)
  3286*        ERASE  FREEKB
  3287*    END-EXEC.
  3288*    MOVE '8&      T  E F  H   F -   #00002472' TO DFHEIV0
  3289     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3290     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3291     MOVE X'2020233030303032343732' TO DFHEIV0(25:11)
  3292     CALL 'kxdfhei1' USING DFHEIV0,
  3293           LOGOFF-TEXT,
  3294           LOGOFF-LENGTH,
  3295           DFHEIV99,
  3296           DFHEIV99,
  3297           DFHEIV99,
  3298           DFHEIV99,
  3299           DFHEIV99,
  3300           DFHEIV99,
  3301           DFHEIV99,
  3302           DFHEIV99,
  3303           DFHEIV99,
  3304           DFHEIV99
  3305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3306
  3307
  3308* EXEC CICS RETURN
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  60
* EL6503.cbl
  3309*    END-EXEC.
  3310*    MOVE '.(                    ''   #00002477' TO DFHEIV0
  3311     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3312     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3313     MOVE X'2020233030303032343737' TO DFHEIV0(25:11)
  3314     CALL 'kxdfhei1' USING DFHEIV0,
  3315           DFHEIV99,
  3316           DFHEIV99,
  3317           DFHEIV99,
  3318           DFHEIV99,
  3319           DFHEIV99,
  3320           DFHEIV99
  3321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3322
  3323 8300-EXIT.
  3324      EXIT.
  3325 8400-LOG-JOURNAL-RECORD.
  3326     IF PI-JOURNAL-FILE-ID = 0
  3327        GO TO 8400-EXIT
  3328     END-IF
  3329     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  3330     MOVE 'ELCNTL'               TO  JP-FILE-ID.
  3331     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  3332*    EXEC CICS JOURNAL
  3333*        JFILEID (PI-JOURNAL-FILE-ID)
  3334*        JTYPEID (WS-JOURNAL-TYPE-ID)
  3335*        FROM    (JOURNAL-RECORD)
  3336*        LENGTH  (WS-JOURNAL-RECORD-LENGTH)
  3337*    END-EXEC.
  3338 8400-EXIT.
  3339      EXIT.
  3340 8500-DATE-CONVERSION.
  3341
  3342* EXEC CICS LINK
  3343*        PROGRAM  ('ELDATCV')
  3344*        COMMAREA (DATE-CONVERSION-DATA)
  3345*        LENGTH   (DC-COMM-LENGTH)
  3346*    END-EXEC.
  3347     MOVE 'ELDATCV' TO DFHEIV1
  3348*    MOVE '."C                   (   #00002497' TO DFHEIV0
  3349     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3350     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3351     MOVE X'2020233030303032343937' TO DFHEIV0(25:11)
  3352     CALL 'kxdfhei1' USING DFHEIV0,
  3353           DFHEIV1,
  3354           DATE-CONVERSION-DATA,
  3355           DC-COMM-LENGTH,
  3356           DFHEIV99,
  3357           DFHEIV99,
  3358           DFHEIV99,
  3359           DFHEIV99
  3360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3361
  3362 8500-EXIT.
  3363      EXIT.
  3364 9000-RETURN-CICS.
  3365     MOVE 'EL005'                TO  THIS-PGM.
  3366     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  61
* EL6503.cbl
  3367     PERFORM 9300-XCTL.
  3368 9000-EXIT.
  3369      EXIT.
  3370 9100-RETURN-TRAN.
  3371     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  3372     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  3373
  3374* EXEC CICS RETURN
  3375*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3376*        LENGTH   (PI-COMM-LENGTH)
  3377*        TRANSID  (WS-TRANS-ID)
  3378*    END-EXEC.
  3379*    MOVE '.(CT                  ''   #00002513' TO DFHEIV0
  3380     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3381     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3382     MOVE X'2020233030303032353133' TO DFHEIV0(25:11)
  3383     CALL 'kxdfhei1' USING DFHEIV0,
  3384           WS-TRANS-ID,
  3385           PROGRAM-INTERFACE-BLOCK,
  3386           PI-COMM-LENGTH,
  3387           DFHEIV99,
  3388           DFHEIV99,
  3389           DFHEIV99
  3390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3391
  3392 9100-EXIT.
  3393      EXIT.
  3394*****************************************************************
  3395 9300-XCTL.
  3396*****************************************************************
  3397     MOVE DFHENTER               TO  EIBAID.
  3398
  3399* EXEC CICS XCTL
  3400*        PROGRAM  (THIS-PGM)
  3401*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3402*        LENGTH   (PI-COMM-LENGTH)
  3403*    END-EXEC.
  3404*    MOVE '.$C                   %   #00002524' TO DFHEIV0
  3405     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3406     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3407     MOVE X'2020233030303032353234' TO DFHEIV0(25:11)
  3408     CALL 'kxdfhei1' USING DFHEIV0,
  3409           THIS-PGM,
  3410           PROGRAM-INTERFACE-BLOCK,
  3411           PI-COMM-LENGTH,
  3412           DFHEIV99
  3413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3414
  3415 9300-EXIT.
  3416      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  62
* EL6503.cbl
  3418*****************************************************************
  3419 9400-CLEAR.
  3420*****************************************************************
  3421     MOVE PI-RETURN-TO-PROGRAM   TO THIS-PGM
  3422     PERFORM 9300-XCTL
  3423     .
  3424 9400-EXIT.
  3425      EXIT.
  3426*****************************************************************
  3427 9600-PGMIDERR.
  3428*****************************************************************
  3429
  3430* EXEC CICS HANDLE CONDITION
  3431*        PGMIDERR (8300-SEND-TEXT)
  3432*    END-EXEC.
  3433*    MOVE '"$L                   ! # #00002543' TO DFHEIV0
  3434     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3435     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3436     MOVE X'2320233030303032353433' TO DFHEIV0(25:11)
  3437     CALL 'kxdfhei1' USING DFHEIV0
  3438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3439
  3440     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  3441                                     LOGOFF-PGM.
  3442     MOVE 'EL005'                TO  THIS-PGM.
  3443     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  3444     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  3445     PERFORM 9300-XCTL.
  3446 9600-EXIT.
  3447      EXIT.
  3448*****************************************************************
  3449 9900-ERROR-FORMAT.
  3450*****************************************************************
  3451     IF EMI-ERRORS-COMPLETE
  3452         ADD +1             TO  EMI-FATAL-CTR
  3453         MOVE ZERO          TO  EMI-ERROR
  3454         GO TO 9900-EXIT.
  3455
  3456* EXEC CICS LINK
  3457*        PROGRAM  ('EL001')
  3458*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  3459*        LENGTH   (EMI-COMM-LENGTH)
  3460*    END-EXEC.
  3461     MOVE 'EL001' TO DFHEIV1
  3462*    MOVE '."C                   (   #00002561' TO DFHEIV0
  3463     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3464     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3465     MOVE X'2020233030303032353631' TO DFHEIV0(25:11)
  3466     CALL 'kxdfhei1' USING DFHEIV0,
  3467           DFHEIV1,
  3468           ERROR-MESSAGE-INTERFACE-BLOCK,
  3469           EMI-COMM-LENGTH,
  3470           DFHEIV99,
  3471           DFHEIV99,
  3472           DFHEIV99,
  3473           DFHEIV99
  3474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3475
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  63
* EL6503.cbl
  3476     MOVE ZERO              TO  EMI-ERROR.
  3477 9900-EXIT.
  3478      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  64
* EL6503.cbl
  3480*****************************************************************
  3481 9990-ERROR.
  3482*****************************************************************
  3483     MOVE DFHEIBLK               TO EMI-LINE1.
  3484
  3485* EXEC CICS LINK
  3486*        PROGRAM   ('EL004')
  3487*        COMMAREA  (EMI-LINE1)
  3488*        LENGTH    (72)
  3489*    END-EXEC.
  3490     MOVE 'EL004' TO DFHEIV1
  3491     MOVE 72
  3492       TO DFHEIV11
  3493*    MOVE '."C                   (   #00002574' TO DFHEIV0
  3494     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3495     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3496     MOVE X'2020233030303032353734' TO DFHEIV0(25:11)
  3497     CALL 'kxdfhei1' USING DFHEIV0,
  3498           DFHEIV1,
  3499           EMI-LINE1,
  3500           DFHEIV11,
  3501           DFHEIV99,
  3502           DFHEIV99,
  3503           DFHEIV99,
  3504           DFHEIV99
  3505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3506
  3507     PERFORM 8200-SEND-DATAONLY.
  3508     GO TO 9100-RETURN-TRAN.
  3509 9990-EXIT.
  3510      EXIT.
  3511*****************************************************************
  3512 9995-SECURITY-VIOLATION.
  3513*****************************************************************
  3514*           COPY ELCSCTP.
  3515******************************************************************
  3516*                                                                *
  3517*                            ELCSCTP                             *
  3518*                            VMOD=2.001                          *
  3519*                                                                *
  3520*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3521******************************************************************
  3522
  3523
  3524     MOVE EIBDATE          TO SM-JUL-DATE.
  3525     MOVE EIBTRMID         TO SM-TERMID.
  3526     MOVE THIS-PGM         TO SM-PGM.
  3527     MOVE EIBTIME          TO TIME-IN.
  3528     MOVE TIME-OUT         TO SM-TIME.
  3529     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3530
  3531
  3532* EXEC CICS LINK
  3533*         PROGRAM  ('EL003')
  3534*         COMMAREA (SECURITY-MESSAGE)
  3535*         LENGTH   (80)
  3536*    END-EXEC.
  3537     MOVE 'EL003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:17 Page  65
* EL6503.cbl
  3538     MOVE 80
  3539       TO DFHEIV11
  3540*    MOVE '."C                   (   #00002603' TO DFHEIV0
  3541     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3542     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3543     MOVE X'2020233030303032363033' TO DFHEIV0(25:11)
  3544     CALL 'kxdfhei1' USING DFHEIV0,
  3545           DFHEIV1,
  3546           SECURITY-MESSAGE,
  3547           DFHEIV11,
  3548           DFHEIV99,
  3549           DFHEIV99,
  3550           DFHEIV99,
  3551           DFHEIV99
  3552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3553
  3554
  3555******************************************************************
  3556
  3557 9995-EXIT.
  3558      EXIT.
  3559 9999-LAST-PARAGRAPH.
  3560
  3561* GOBACK.
  3562     MOVE '9%                    "   ' TO DFHEIV0
  3563     MOVE 'EL6503' TO DFHEIV1
  3564     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3565     GOBACK.
  3566
  3567 9999-DFHBACK SECTION.
  3568     MOVE '9%                    "   ' TO DFHEIV0
  3569     MOVE 'EL6503' TO DFHEIV1
  3570     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3571     GOBACK.
  3572 9999-DFHEXIT.
  3573     IF DFHEIGDJ EQUAL 0001
  3574         NEXT SENTENCE
  3575     ELSE IF DFHEIGDJ EQUAL 2
  3576         GO TO 9600-PGMIDERR,
  3577               9990-ERROR
  3578         DEPENDING ON DFHEIGDI
  3579     ELSE IF DFHEIGDJ EQUAL 3
  3580         GO TO 8300-SEND-TEXT
  3581         DEPENDING ON DFHEIGDI.
  3582     MOVE '9%                    "   ' TO DFHEIV0
  3583     MOVE 'EL6503' TO DFHEIV1
  3584     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3585     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5644     Code:       11821
