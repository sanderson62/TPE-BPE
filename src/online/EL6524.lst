* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6524.cbl
* Options: int("EL6524.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6524.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6524.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6524.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6524.
     3*
     4*AUTHOR.     CENTRAL STATES HEALTH AND LIFE.
     5*            OMAHA, NEBRASKA.
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    12*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6524.cbl
    14*            *****************************************************
    15*REMARKS.    TRANSACTION - EXDE - REPRESENTATIVE
    16*                                 MAINTENANCE.
    17 ENVIRONMENT DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6524.cbl
    19 DATA DIVISION.
    20 WORKING-STORAGE SECTION.
    21 01  DFH-START PIC X(04).
    22 77  FILLER  PIC X(32)  VALUE '********************************'.
    23 77  FILLER  PIC X(32)  VALUE '*    EL6524 WORKING STORAGE    *'.
    24 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    25 77  NDX     PIC S9(5)  COMP-3 VALUE +1.
    26 77  WSUB1   PIC S9(5)  COMP-3 VALUE +0.
    27 77  WSUB2   PIC S9(5)  COMP-3 VALUE +0.
    28 77  WSUB3   PIC S9(5)  COMP-3 VALUE +0.
    29 77  WS-TOT-FEES                 PIC S9(3)V99 COMP-3 VALUE +0.
    30 77  WS-TOT-LFEES                PIC S9(3)V99 COMP-3 VALUE +0.
    31 77  ERAGTC-LENGTH               PIC S9(4) COMP VALUE +450.
    32 77  TABLE-SW                    PIC X.
    33     88  TABLE-OVERLAP                   VALUE 'Y'.
    34 77  WS-CHECK-DATE-SW            PIC X   VALUE SPACES.
    35     88  DATE-CHECK-OVER                 VALUE 'Y'.
    36 77  WS-EFF-SW                   PIC X   VALUE SPACES.
    37     88  EFF-DT-CHANGE                   VALUE 'Y'.
    38 77  WS-EXP-SW                   PIC X   VALUE SPACES.
    39     88  EXP-DT-CHANGE                   VALUE 'Y'.
    40 77  WS-SKIP-KEY                 PIC X(21) VALUE LOW-VALUES.
    41 01  WS-DATE-AREA.
    42     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    43     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
    44 01  WS-SAVE-ERAGTC              PIC X(450).
    45 01  WS-ERCOMP-KEY.
    46     05  WS-COMP-COMPANY-CD      PIC X.
    47     05  WS-COMP-CARRIER         PIC X.
    48     05  WS-COMP-GROUPING        PIC X(6).
    49     05  WS-COMP-FINRESP         PIC X(10).
    50     05  WS-COMP-ACCOUNT         PIC X(10).
    51     05  WS-COMP-TYPE            PIC X.
    52 01  WS-DATE-TABLE.
    53     05  FILLER OCCURS 40.
    54         10  WS-TBL-EFF-DT       PIC XX.
    55         10  WS-TBL-EXP-DT       PIC XX.
    56 01  WS-CONTROL-PRIMARY.
    57     05  WS-COMPANY-CD       PIC X.
    58     05  WS-CARRIER          PIC X.
    59     05  WS-GROUP            PIC X(6).
    60     05  WS-BANK             PIC X(10).
    61     05  WS-EXP-DT           PIC XX.
    62     05  WS-TYPE             PIC X.
    63     05  WS-OPEN-COUNT       PIC S9(4)    COMP-3 VALUE ZEROS.
    64*                            COPY ELCATTR SUPPRESS.
    65******************************************************************
    66*                                                                *
    67*                            ELCATTR.                            *
    68*                            VMOD=2.001                          *
    69*                                                                *
    70*             LIST OF STANDARD ATTRIBUTE VALUES                  *
    71*                                                                *
    72*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
    73*                                                                *
    74*                   POS 1   P=PROTECTED                          *
    75*                           U=UNPROTECTED                        *
    76*                           S=ASKIP                              *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6524.cbl
    77*                   POS 2   A=ALPHA/NUMERIC                      *
    78*                           N=NUMERIC                            *
    79*                   POS 3   N=NORMAL                             *
    80*                           B=BRIGHT                             *
    81*                           D=DARK                               *
    82*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
    83*                           OF=MODIFIED DATA TAG OFF             *
    84*                                                                *
    85*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
    86******************************************************************
    87 01  ATTRIBUTE-LIST.
    88     12  AL-PABOF            PIC X       VALUE 'Y'.
    89     12  AL-PABON            PIC X       VALUE 'Z'.
    90     12  AL-PADOF            PIC X       VALUE '%'.
    91     12  AL-PADON            PIC X       VALUE '_'.
    92     12  AL-PANOF            PIC X       VALUE '-'.
    93     12  AL-PANON            PIC X       VALUE '/'.
    94     12  AL-SABOF            PIC X       VALUE '8'.
    95     12  AL-SABON            PIC X       VALUE '9'.
    96     12  AL-SADOF            PIC X       VALUE '@'.
    97     12  AL-SADON            PIC X       VALUE QUOTE.
    98     12  AL-SANOF            PIC X       VALUE '0'.
    99     12  AL-SANON            PIC X       VALUE '1'.
   100     12  AL-UABOF            PIC X       VALUE 'H'.
   101     12  AL-UABON            PIC X       VALUE 'I'.
   102     12  AL-UADOF            PIC X       VALUE '<'.
   103     12  AL-UADON            PIC X       VALUE '('.
   104     12  AL-UANOF            PIC X       VALUE ' '.
   105     12  AL-UANON            PIC X       VALUE 'A'.
   106     12  AL-UNBOF            PIC X       VALUE 'Q'.
   107     12  AL-UNBON            PIC X       VALUE 'R'.
   108     12  AL-UNDOF            PIC X       VALUE '*'.
   109     12  AL-UNDON            PIC X       VALUE ')'.
   110     12  AL-UNNOF            PIC X       VALUE '&'.
   111     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6524.cbl
   113 01  ERROR-MESSAGES.
   114     12  ER-0000                 PIC X(4)  VALUE '0000'.
   115     12  ER-0004                 PIC X(4)  VALUE '0004'.
   116     12  ER-0029                 PIC X(4)  VALUE '0029'.
   117     12  ER-0033                 PIC X(4)  VALUE '0033'.
   118     12  ER-0034                 PIC X(4)  VALUE '0034'.
   119     12  ER-0068                 PIC X(4)  VALUE '0068'.
   120     12  ER-0070                 PIC X(4)  VALUE '0070'.
   121     12  ER-0130                 PIC X(4)  VALUE '0130'.
   122     12  ER-0131                 PIC X(4)  VALUE '0131'.
   123     12  ER-0142                 PIC X(4)  VALUE '0142'.
   124     12  ER-0193                 PIC X(4)  VALUE '0193'.
   125     12  ER-0226                 PIC X(4)  VALUE '0226'.
   126     12  ER-0234                 PIC X(4)  VALUE '0234'.
   127     12  ER-0235                 PIC X(4)  VALUE '0235'.
   128     12  ER-0348                 PIC X(4)  VALUE '0348'.
   129     12  ER-0454                 PIC X(4)  VALUE '0454'.
   130     12  ER-1162                 PIC X(4)  VALUE '1162'.
   131     12  ER-1164                 PIC X(4)  VALUE '1164'.
   132     12  ER-2039                 PIC X(4)  VALUE '2039'.
   133     12  ER-2042                 PIC X(4)  VALUE '2042'.
   134     12  ER-2051                 PIC X(4)  VALUE '2051'.
   135     12  ER-2053                 PIC X(4)  VALUE '2053'.
   136     12  ER-2056                 PIC X(4)  VALUE '2056'.
   137     12  ER-2057                 PIC X(4)  VALUE '2057'.
   138     12  ER-2173                 PIC X(4)  VALUE '2173'.
   139     12  ER-2230                 PIC X(4)  VALUE '2230'.
   140     12  ER-2237                 PIC X(4)  VALUE '2237'.
   141     12  ER-2238                 PIC X(4)  VALUE '2238'.
   142     12  ER-2339                 PIC X(4)  VALUE '2339'.
   143     12  ER-2370                 PIC X(4)  VALUE '2370'.
   144     12  ER-2947                 PIC X(4)  VALUE '2947'.
   145     12  ER-2717                 PIC X(4)  VALUE '2717'.
   146     12  ER-3112                 PIC X(4)  VALUE '3112'.
   147     12  ER-5004                 PIC X(4)  VALUE '5004'.
   148     12  ER-5005                 PIC X(4)  VALUE '5005'.
   149     12  ER-6508                 PIC X(4)  VALUE '6508'.
   150*                          COPY ELCSCTM.
   151******************************************************************
   152*                                                                *
   153*                                                                *
   154*                            ELCSCTM                             *
   155*                            VMOD=2.001                          *
   156*                                                                *
   157*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   158*                                                                *
   159******************************************************************
   160 01  SECURITY-MESSAGE.
   161     12  FILLER                          PIC X(30)
   162            VALUE '** LOGIC SECURITY VIOLATION -'.
   163     12  SM-READ                         PIC X(6).
   164     12  FILLER                          PIC X(5)
   165            VALUE ' PGM='.
   166     12  SM-PGM                          PIC X(6).
   167     12  FILLER                          PIC X(5)
   168            VALUE ' OPR='.
   169     12  SM-PROCESSOR-ID                 PIC X(4).
   170     12  FILLER                          PIC X(6)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6524.cbl
   171            VALUE ' TERM='.
   172     12  SM-TERMID                       PIC X(4).
   173     12  FILLER                          PIC XX   VALUE SPACE.
   174     12  SM-JUL-DATE                     PIC 9(5).
   175     12  FILLER                          PIC X    VALUE SPACE.
   176     12  SM-TIME                         PIC 99.99.
   177
   178*                          COPY ELCSCRTY.
   179******************************************************************
   180*                                                                *
   181*                                                                *
   182*                            ELCSCRTY                            *
   183*                            VMOD=2.001                          *
   184*                                                                *
   185*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   186*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   187*        SAVED IN PI-SECURITY-ADDRESS.                           *
   188*                                                                *
   189******************************************************************
   190 01  SECURITY-CONTROL.
   191     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   192     12  FILLER                       PIC XX    VALUE 'SC'.
   193     12  SC-CREDIT-CODES.
   194         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   195             20  SC-CREDIT-DISPLAY    PIC X.
   196             20  SC-CREDIT-UPDATE     PIC X.
   197     12  SC-CLAIMS-CODES.
   198         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   199             20  SC-CLAIMS-DISPLAY    PIC X.
   200             20  SC-CLAIMS-UPDATE     PIC X.
   201 01  STANDARD-AREAS.
   202     12  WS-RESPONSE             PIC S9(8)   COMP.
   203         88  RESP-NORMAL                  VALUE +00.
   204         88  RESP-NOTFND                  VALUE +13.
   205         88  RESP-NOTOPEN                 VALUE +19.
   206         88  RESP-ENDFILE                 VALUE +20.
   207     12  WS-CHANGE-SW            PIC X  VALUE ' '.
   208         88  CHANGES-MADE               VALUE 'Y'.
   209         88  NO-CHANGES-MADE            VALUE 'N'.
   210     12  WS-LINE-CHANGE-SW       PIC X  VALUE ' '.
   211         88  LINE-CHANGES               VALUE 'Y'.
   212         88  NO-LINE-CHANGES            VALUE 'N'.
   213     12  GETMAIN-SPACE           PIC X     VALUE SPACE.
   214     12  DEEDIT-FIELD        PIC  X(08).
   215     12  DEEDIT-FIELD-V0  REDEFINES
   216         DEEDIT-FIELD        PIC 9(08).
   217     12  WS-DEEDIT-FIELD         PIC X(10) VALUE SPACES.
   218     12  WS-DT-DEEDIT-FIELD REDEFINES WS-DEEDIT-FIELD
   219                                      PIC X(10).
   220     12  WS-DEEDIT-FIELD-DATE REDEFINES WS-DT-DEEDIT-FIELD.
   221         16  FILLER                   PIC X(4).
   222         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   223     12  SC-ITEM-CL-CR       PIC S9(4)         VALUE +1   COMP.
   224     12  WS-ACCESS.
   225         16  FILLER          PIC  X(3)         VALUE SPACES.
   226         16  WS-ACARRIER     PIC  X.
   227     12  ELCNTL-KEY.
   228         16  CNTL-COMP-ID    PIC  X(3)         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6524.cbl
   229         16  CNTL-REC-TYPE   PIC  X            VALUE SPACES.
   230         16  CNTL-ACCESS     PIC  X(4)         VALUE SPACES.
   231         16  CNTL-SEQ-NO     PIC S9(4)         VALUE +0   COMP.
   232     12  QID.
   233         16  QID-TERM        PIC X(4).
   234         16  FILLER          PIC X(4)    VALUE '652E'.
   235     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   236     12  QID-MAP-LENGTH      PIC S9(4)   VALUE +1376   COMP.
   237     12  MAP-NAME                PIC X(8)    VALUE 'EL652E'.
   238     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6524S'.
   239     12  TRANS-ID                PIC X(4)    VALUE 'EXDE'.
   240     12  EL652-TRANS-ID          PIC X(4)    VALUE 'EXD4'.
   241     12  EL650-TRANS-ID          PIC X(4)    VALUE 'EXC4'.
   242     12  PGM-NAME                PIC X(8)    VALUE SPACES.
   243     12  THIS-PGM                PIC X(8)    VALUE 'EL6524'.
   244     12  XCTL-650                PIC X(8)    VALUE 'EL650'.
   245     12  AGTC-FILE-ID            PIC X(8)    VALUE 'ERAGTC'.
   246     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   247     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   248     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   249     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   250     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   251     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   252     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   253     12  TIME-IN                 PIC S9(7).
   254     12  TIME-OUT-R   REDEFINES TIME-IN.
   255         16  FILLER              PIC X.
   256         16  TIME-OUT            PIC 99V99.
   257         16  FILLER              PIC X(2).
   258     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   259         88  BROWSE-STARTED      VALUE 'Y'.
   260 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   261     12  AGTC-REC-LENGTH         PIC S9(4)    VALUE +0.
   262*                                COPY ELCDATE.
   263******************************************************************
   264*                                                                *
   265*                                                                *
   266*                            ELCDATE.                            *
   267*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   268*                            VMOD=2.003
   269*                                                                *
   270*                                                                *
   271*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   272*                 LENGTH = 200                                   *
   273******************************************************************
   274
   275 01  DATE-CONVERSION-DATA.
   276     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   277     12  DC-OPTION-CODE                PIC X.
   278         88  BIN-TO-GREG                VALUE ' '.
   279         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   280         88  EDIT-GREG-TO-BIN           VALUE '2'.
   281         88  YMD-GREG-TO-BIN            VALUE '3'.
   282         88  MDY-GREG-TO-BIN            VALUE '4'.
   283         88  JULIAN-TO-BIN              VALUE '5'.
   284         88  BIN-PLUS-ELAPSED           VALUE '6'.
   285         88  FIND-CENTURY               VALUE '7'.
   286         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6524.cbl
   287         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   288         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   289         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   290         88  JULIAN-TO-BIN-3            VALUE 'C'.
   291         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   292         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   293         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   294         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   295         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   296         88  CHECK-LEAP-YEAR            VALUE 'H'.
   297         88  BIN-3-TO-GREG              VALUE 'I'.
   298         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   299         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   300         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   301         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   302         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   303         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   304         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   305         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   306         88  THREE-CHARACTER-BIN
   307                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   308         88  GREGORIAN-TO-BIN
   309                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   310         88  BIN-TO-GREGORIAN
   311                  VALUES ' ' '1' 'I' '8' 'G'.
   312         88  JULIAN-TO-BINARY
   313                  VALUES '5' 'C' 'E' 'F'.
   314     12  DC-ERROR-CODE                 PIC X.
   315         88  NO-CONVERSION-ERROR        VALUE ' '.
   316         88  DATE-CONVERSION-ERROR
   317                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   318         88  DATE-IS-ZERO               VALUE '1'.
   319         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   320         88  DATE-IS-INVALID            VALUE '3'.
   321         88  DATE1-GREATER-DATE2        VALUE '4'.
   322         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   323         88  DATE-INVALID-OPTION        VALUE '9'.
   324         88  INVALID-CENTURY            VALUE 'A'.
   325         88  ONLY-CENTURY               VALUE 'B'.
   326         88  ONLY-LEAP-YEAR             VALUE 'C'.
   327         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   328     12  DC-END-OF-MONTH               PIC X.
   329         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   330     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   331         88  USE-NORMAL-PROCESS         VALUE ' '.
   332         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   333         88  ADJUST-UP-100-YRS          VALUE '2'.
   334     12  FILLER                        PIC X.
   335     12  DC-CONVERSION-DATES.
   336         16  DC-BIN-DATE-1             PIC XX.
   337         16  DC-BIN-DATE-2             PIC XX.
   338         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   339         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   340                       DC-GREG-DATE-1-EDIT.
   341             20  DC-EDIT1-MONTH        PIC 99.
   342             20  SLASH1-1              PIC X.
   343             20  DC-EDIT1-DAY          PIC 99.
   344             20  SLASH1-2              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6524.cbl
   345             20  DC-EDIT1-YEAR         PIC 99.
   346         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   347         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   348                     DC-GREG-DATE-2-EDIT.
   349             20  DC-EDIT2-MONTH        PIC 99.
   350             20  SLASH2-1              PIC X.
   351             20  DC-EDIT2-DAY          PIC 99.
   352             20  SLASH2-2              PIC X.
   353             20  DC-EDIT2-YEAR         PIC 99.
   354         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   355         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   356                     DC-GREG-DATE-1-YMD.
   357             20  DC-YMD-YEAR           PIC 99.
   358             20  DC-YMD-MONTH          PIC 99.
   359             20  DC-YMD-DAY            PIC 99.
   360         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   361         16  DC-GREG-DATE-1-MDY-R REDEFINES
   362                      DC-GREG-DATE-1-MDY.
   363             20  DC-MDY-MONTH          PIC 99.
   364             20  DC-MDY-DAY            PIC 99.
   365             20  DC-MDY-YEAR           PIC 99.
   366         16  DC-GREG-DATE-1-ALPHA.
   367             20  DC-ALPHA-MONTH        PIC X(10).
   368             20  DC-ALPHA-DAY          PIC 99.
   369             20  FILLER                PIC XX.
   370             20  DC-ALPHA-CENTURY.
   371                 24 DC-ALPHA-CEN-N     PIC 99.
   372             20  DC-ALPHA-YEAR         PIC 99.
   373         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   374         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   375         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   376         16  DC-JULIAN-DATE            PIC 9(05).
   377         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   378                                       PIC 9(05).
   379         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   380             20  DC-JULIAN-YEAR        PIC 99.
   381             20  DC-JULIAN-DAYS        PIC 999.
   382         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   383         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   384         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   385     12  DATE-CONVERSION-VARIBLES.
   386         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   387         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   388             20  FILLER                PIC 9(3).
   389             20  HOLD-CEN-1-CCYY.
   390                 24  HOLD-CEN-1-CC     PIC 99.
   391                 24  HOLD-CEN-1-YY     PIC 99.
   392             20  HOLD-CEN-1-MO         PIC 99.
   393             20  HOLD-CEN-1-DA         PIC 99.
   394         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   395             20  HOLD-CEN-1-R-MO       PIC 99.
   396             20  HOLD-CEN-1-R-DA       PIC 99.
   397             20  HOLD-CEN-1-R-CCYY.
   398                 24  HOLD-CEN-1-R-CC   PIC 99.
   399                 24  HOLD-CEN-1-R-YY   PIC 99.
   400             20  FILLER                PIC 9(3).
   401         16  HOLD-CENTURY-1-X.
   402             20  FILLER                PIC X(3)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6524.cbl
   403             20  HOLD-CEN-1-X-CCYY.
   404                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   405                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   406             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   407             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   408         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   409             20  HOLD-CEN-1-R-X-MO     PIC XX.
   410             20  HOLD-CEN-1-R-X-DA     PIC XX.
   411             20  HOLD-CEN-1-R-X-CCYY.
   412                 24  HOLD-CEN-1-R-X-CC PIC XX.
   413                 24  HOLD-CEN-1-R-X-YY PIC XX.
   414             20  FILLER                PIC XXX.
   415         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   416         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   417         16  DC-JULIAN-DATE-1          PIC 9(07).
   418         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   419             20  DC-JULIAN-1-CCYY.
   420                 24  DC-JULIAN-1-CC    PIC 99.
   421                 24  DC-JULIAN-1-YR    PIC 99.
   422             20  DC-JULIAN-DA-1        PIC 999.
   423         16  DC-JULIAN-DATE-2          PIC 9(07).
   424         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   425             20  DC-JULIAN-2-CCYY.
   426                 24  DC-JULIAN-2-CC    PIC 99.
   427                 24  DC-JULIAN-2-YR    PIC 99.
   428             20  DC-JULIAN-DA-2        PIC 999.
   429         16  DC-GREG-DATE-A-EDIT.
   430             20  DC-EDITA-MONTH        PIC 99.
   431             20  SLASHA-1              PIC X VALUE '/'.
   432             20  DC-EDITA-DAY          PIC 99.
   433             20  SLASHA-2              PIC X VALUE '/'.
   434             20  DC-EDITA-CCYY.
   435                 24  DC-EDITA-CENT     PIC 99.
   436                 24  DC-EDITA-YEAR     PIC 99.
   437         16  DC-GREG-DATE-B-EDIT.
   438             20  DC-EDITB-MONTH        PIC 99.
   439             20  SLASHB-1              PIC X VALUE '/'.
   440             20  DC-EDITB-DAY          PIC 99.
   441             20  SLASHB-2              PIC X VALUE '/'.
   442             20  DC-EDITB-CCYY.
   443                 24  DC-EDITB-CENT     PIC 99.
   444                 24  DC-EDITB-YEAR     PIC 99.
   445         16  DC-GREG-DATE-CYMD         PIC 9(08).
   446         16  DC-GREG-DATE-CYMD-R REDEFINES
   447                              DC-GREG-DATE-CYMD.
   448             20  DC-CYMD-CEN           PIC 99.
   449             20  DC-CYMD-YEAR          PIC 99.
   450             20  DC-CYMD-MONTH         PIC 99.
   451             20  DC-CYMD-DAY           PIC 99.
   452         16  DC-GREG-DATE-MDCY         PIC 9(08).
   453         16  DC-GREG-DATE-MDCY-R REDEFINES
   454                              DC-GREG-DATE-MDCY.
   455             20  DC-MDCY-MONTH         PIC 99.
   456             20  DC-MDCY-DAY           PIC 99.
   457             20  DC-MDCY-CEN           PIC 99.
   458             20  DC-MDCY-YEAR          PIC 99.
   459    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   460        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6524.cbl
   461    12  DC-EL310-DATE                  PIC X(21).
   462    12  FILLER                         PIC X(28).
   463*                                COPY ELCEMIB SUPPRESS.
   464******************************************************************
   465*                                                                *
   466*                                                                *
   467*                            ELCEMIB.                            *
   468*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   469*                            VMOD=2.005                          *
   470*                                                                *
   471*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   472*                                                                *
   473******************************************************************
   474 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   475     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   476     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   477     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   478     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   479     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   480     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   481     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   482     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   483     12  EMI-SWITCH1             PIC X        VALUE '1'.
   484         88  EMI-NO-ERRORS                    VALUE '1'.
   485         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   486         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   487     12  EMI-SWITCH2             PIC X        VALUE '1'.
   488         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   489     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   490         88  EMI-AREA1-EMPTY                  VALUE '1'.
   491         88  EMI-AREA1-FULL                   VALUE '2'.
   492     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   493         88  EMI-AREA2-EMPTY                  VALUE '1'.
   494         88  EMI-AREA2-FULL                   VALUE '2'.
   495     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   496         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   497         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   498         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   499         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   500         88  EMI-BYPASS-FATALS                VALUE 'X'.
   501     12  EMI-ERROR-LINES.
   502         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   503         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   504         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   505         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   506             20  EMI-ERR-CODES OCCURS 10 TIMES.
   507                 24  EMI-ERR-NUM         PIC X(4).
   508                 24  EMI-FILLER          PIC X.
   509                 24  EMI-SEV             PIC X.
   510                 24  FILLER              PIC X.
   511             20  FILLER                  PIC X(02).
   512     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   513         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   514             20  EMI-ERROR-NUMBER    PIC X(4).
   515             20  EMI-FILL            PIC X.
   516             20  EMI-SEVERITY        PIC X.
   517             20  FILLER              PIC X.
   518             20  EMI-ERROR-TEXT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6524.cbl
   519                 24  EMI-TEXT-VARIABLE   PIC X(10).
   520                 24  FILLER          PIC X(55).
   521     12  EMI-SEVERITY-SAVE           PIC X.
   522         88  EMI-NOTE                    VALUE 'N'.
   523         88  EMI-WARNING                 VALUE 'W'.
   524         88  EMI-FORCABLE                VALUE 'F'.
   525         88  EMI-FATAL                   VALUE 'X'.
   526     12  EMI-MESSAGE-FLAG            PIC X.
   527         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   528         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   529     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   530     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   531         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   532         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   533         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   534     12  FILLER                      PIC X(137)  VALUE SPACES.
   535     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   536     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   537     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   538     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   539*                  COPY ELCLOGOF SUPPRESS.
   540******************************************************************
   541*                                                                *
   542*                                                                *
   543*                            ELCLOGOF.                           *
   544*                            VMOD=2.001                          *
   545*                                                                *
   546*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   547*                                                                *
   548******************************************************************
   549 01  CLASIC-LOGOFF.
   550     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   551     12  LOGOFF-TEXT.
   552         16  FILLER          PIC X(5)    VALUE SPACES.
   553         16  LOGOFF-MSG.
   554             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   555             20  FILLER      PIC X       VALUE SPACES.
   556             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   557         16  FILLER          PIC X(80)
   558           VALUE '* YOU ARE NOW LOGGED OFF'.
   559         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   560         16  FILLER          PIC X       VALUE QUOTE.
   561         16  LOGOFF-SYS-MSG  PIC X(17)
   562           VALUE 'S CLAS-IC SYSTEM '.
   563     12  TEXT-MESSAGES.
   564         16  UNACCESS-MSG    PIC X(29)
   565             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   566         16  PGMIDERR-MSG    PIC X(17)
   567             VALUE 'PROGRAM NOT FOUND'.
   568*                                COPY ELCINTF.
   569******************************************************************
   570*                                                                *
   571*                                                                *
   572*                            ELCINTF.                            *
   573*                            VMOD=2.017                          *
   574*                                                                *
   575*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   576*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6524.cbl
   577*       LENGTH = 1024                                            *
   578*                                                                *
   579******************************************************************
   580 01  PROGRAM-INTERFACE-BLOCK.
   581     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   582     12  PI-CALLING-PROGRAM              PIC X(8).
   583     12  PI-SAVED-PROGRAM-1              PIC X(8).
   584     12  PI-SAVED-PROGRAM-2              PIC X(8).
   585     12  PI-SAVED-PROGRAM-3              PIC X(8).
   586     12  PI-SAVED-PROGRAM-4              PIC X(8).
   587     12  PI-SAVED-PROGRAM-5              PIC X(8).
   588     12  PI-SAVED-PROGRAM-6              PIC X(8).
   589     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   590     12  PI-COMPANY-ID                   PIC XXX.
   591     12  PI-COMPANY-CD                   PIC X.
   592
   593     12  PI-COMPANY-PASSWORD             PIC X(8).
   594
   595     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   596
   597     12  PI-CONTROL-IN-PROGRESS.
   598         16  PI-CARRIER                  PIC X.
   599         16  PI-GROUPING                 PIC X(6).
   600         16  PI-STATE                    PIC XX.
   601         16  PI-ACCOUNT                  PIC X(10).
   602         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   603                                         PIC X(10).
   604         16  PI-CLAIM-CERT-GRP.
   605             20  PI-CLAIM-NO             PIC X(7).
   606             20  PI-CERT-NO.
   607                 25  PI-CERT-PRIME       PIC X(10).
   608                 25  PI-CERT-SFX         PIC X.
   609             20  PI-CERT-EFF-DT          PIC XX.
   610         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   611             20  PI-PLAN-CODE            PIC X(2).
   612             20  PI-REVISION-NUMBER      PIC X(3).
   613             20  PI-PLAN-EFF-DT          PIC X(2).
   614             20  PI-PLAN-EXP-DT          PIC X(2).
   615             20  FILLER                  PIC X(11).
   616         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   617             20  PI-OE-REFERENCE-1.
   618                 25  PI-OE-REF-1-PRIME   PIC X(18).
   619                 25  PI-OE-REF-1-SUFF    PIC XX.
   620
   621     12  PI-SESSION-IN-PROGRESS          PIC X.
   622         88  CLAIM-SESSION                   VALUE '1'.
   623         88  CREDIT-SESSION                  VALUE '2'.
   624         88  WARRANTY-SESSION                VALUE '3'.
   625         88  MORTGAGE-SESSION                VALUE '4'.
   626         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   627
   628
   629*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   630
   631     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   632     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   633
   634     12  PI-CREDIT-USER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6524.cbl
   635         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   636         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   637
   638     12  PI-CLAIM-USER                   PIC X.
   639         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   640         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   641
   642     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   643         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   644         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   645         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   646         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   647         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   648
   649     12  PI-PROCESSOR-ID                 PIC X(4).
   650
   651     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   652
   653     12  PI-MEMBER-CAPTION               PIC X(10).
   654
   655     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   656         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   657
   658     12  PI-LIFE-OVERRIDE-L1             PIC X.
   659     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   660     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   661     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   662
   663     12  PI-AH-OVERRIDE-L1               PIC X.
   664     12  PI-AH-OVERRIDE-L2               PIC XX.
   665     12  PI-AH-OVERRIDE-L6               PIC X(6).
   666     12  PI-AH-OVERRIDE-L12              PIC X(12).
   667
   668     12  PI-NEW-SYSTEM                   PIC X(2).
   669
   670     12  PI-PRIMARY-CERT-NO              PIC X(11).
   671     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   672         88  PI-USES-PAID-TO                 VALUE '1'.
   673     12  PI-CRDTCRD-SYSTEM.
   674         16  PI-CRDTCRD-USER             PIC X.
   675             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   676             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   677         16  PI-CC-MONTH-END-DT          PIC XX.
   678     12  PI-PROCESSOR-PRINTER            PIC X(4).
   679
   680     12  PI-OE-REFERENCE-2.
   681         16  PI-OE-REF-2-PRIME           PIC X(10).
   682         16  PI-OE-REF-2-SUFF            PIC X.
   683
   684     12  PI-REM-TRM-CALC-OPTION          PIC X.
   685
   686     12  PI-LANGUAGE-TYPE                PIC X.
   687             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   688             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   689             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   690
   691     12  PI-POLICY-LINKAGE-IND           PIC X.
   692         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6524.cbl
   693         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   694                                                   LOW-VALUES.
   695
   696     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   697     12  PI-CLAIM-PW-SESSION             PIC X(1).
   698         88  PI-CLAIM-CREDIT                 VALUE '1'.
   699         88  PI-CLAIM-CONVEN                 VALUE '2'.
   700     12  FILLER                          PIC X(4).
   701
   702     12  PI-SYSTEM-LEVEL                 PIC X(145).
   703
   704     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   705         PI-SYSTEM-LEVEL.
   706
   707         16  PI-ENTRY-CODES.
   708             20  PI-ENTRY-CD-1           PIC X.
   709             20  PI-ENTRY-CD-2           PIC X.
   710
   711         16  PI-RETURN-CODES.
   712             20  PI-RETURN-CD-1          PIC X.
   713             20  PI-RETURN-CD-2          PIC X.
   714
   715         16  PI-UPDATE-STATUS-SAVE.
   716             20  PI-UPDATE-BY            PIC X(4).
   717             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   718
   719         16  PI-LOWER-CASE-LETTERS       PIC X.
   720             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   721
   722*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   723*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   724*            88  CARRIER-CLM-CNTL            VALUE '2'.
   725
   726         16  PI-CERT-ACCESS-CONTROL      PIC X.
   727             88  ST-ACCNT-CNTL               VALUE ' '.
   728             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   729             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   730             88  ACCNT-CNTL                  VALUE '3'.
   731             88  CARR-ACCNT-CNTL             VALUE '4'.
   732
   733         16  PI-PROCESSOR-CAP-LIST.
   734             20  PI-SYSTEM-CONTROLS.
   735                24 PI-SYSTEM-DISPLAY     PIC X.
   736                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   737                24 PI-SYSTEM-MODIFY      PIC X.
   738                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   739             20  FILLER                  PIC XX.
   740             20  PI-DISPLAY-CAP          PIC X.
   741                 88  DISPLAY-CAP             VALUE 'Y'.
   742             20  PI-MODIFY-CAP           PIC X.
   743                 88  MODIFY-CAP              VALUE 'Y'.
   744             20  PI-MSG-AT-LOGON-CAP     PIC X.
   745                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   746             20  PI-FORCE-CAP            PIC X.
   747                 88  FORCE-CAP               VALUE 'Y'.
   748
   749         16  PI-PROGRAM-CONTROLS.
   750             20  PI-PGM-PRINT-OPT        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6524.cbl
   751             20  PI-PGM-FORMAT-OPT       PIC X.
   752             20  PI-PGM-PROCESS-OPT      PIC X.
   753             20  PI-PGM-TOTALS-OPT       PIC X.
   754
   755         16  PI-HELP-INTERFACE.
   756             20  PI-LAST-ERROR-NO        PIC X(4).
   757             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   758
   759         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   760             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   761
   762         16  PI-CR-CONTROL-IN-PROGRESS.
   763             20  PI-CR-CARRIER           PIC X.
   764             20  PI-CR-GROUPING          PIC X(6).
   765             20  PI-CR-STATE             PIC XX.
   766             20  PI-CR-ACCOUNT           PIC X(10).
   767             20  PI-CR-FIN-RESP          PIC X(10).
   768             20  PI-CR-TYPE              PIC X.
   769
   770         16  PI-CR-BATCH-NUMBER          PIC X(6).
   771
   772         16  PI-CR-MONTH-END-DT          PIC XX.
   773
   774         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   775             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   776             88  PI-ZERO-CARRIER             VALUE '1'.
   777             88  PI-ZERO-GROUPING            VALUE '2'.
   778             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   779
   780         16  PI-CARRIER-SECURITY         PIC X.
   781             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   782
   783         16  PI-ACCOUNT-SECURITY         PIC X(10).
   784             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   785             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   786
   787         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   788             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   789                                         INDEXED BY PI-ACCESS-NDX
   790                                         PIC X.
   791
   792         16  PI-GA-BILLING-CONTROL       PIC X.
   793             88  PI-GA-BILLING               VALUE '1'.
   794
   795         16  PI-MAIL-PROCESSING          PIC X.
   796             88  PI-MAIL-YES                 VALUE 'Y'.
   797
   798         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   799
   800         16  PI-AR-SYSTEM.
   801             20  PI-AR-PROCESSING-CNTL   PIC X.
   802                 88  PI-AR-PROCESSING        VALUE 'Y'.
   803             20  PI-AR-SUMMARY-CODE      PIC X(6).
   804             20  PI-AR-MONTH-END-DT      PIC XX.
   805
   806         16  PI-MP-SYSTEM.
   807             20  PI-MORTGAGE-USER            PIC X.
   808                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6524.cbl
   809                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   810             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   811                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   812                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   813                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   814                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   815                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   816             20  PI-MP-MONTH-END-DT          PIC XX.
   817             20  PI-MP-REFERENCE-NO.
   818                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   819                 24  PI-MP-REFERENCE-SFX     PIC XX.
   820
   821         16  PI-LABEL-CONTROL            PIC X(01).
   822             88  PI-CREATE-LABELS                    VALUE 'Y'.
   823             88  PI-BYPASS-LABELS                    VALUE 'N'.
   824
   825         16  PI-BILL-GROUPING-CODE       PIC X(01).
   826             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   827
   828         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   829             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   830             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   831
   832         16  FILLER                      PIC X(14).
   833
   834     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   835******************************************************************
   836     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   837         16  PI-ERAGTC-KEY.
   838             20  PI-AGTC-COMP-CD     PIC X.
   839             20  PI-AGTC-CARRIER     PIC X.
   840             20  PI-AGTC-GROUPING    PIC X(6).
   841             20  PI-AGTC-BANK        PIC X(10).
   842             20  PI-AGTC-EXP-DT      PIC XX.
   843             20  PI-AGTC-TYPE        PIC X.
   844         16  PI-TOP-NDX              PIC S9(5)  COMP-3.
   845         16  PI-NDX                  PIC S9(5)  COMP-3.
   846         16  PI-EOF-SW               PIC X.
   847             88  PI-FILE-EOF             VALUE 'Y'.
   848         16  PI-CHECK-MAINT-TYPE     PIC  X.
   849             88  VALID-MAINT-TYPE            VALUE 'S' 'A'
   850                                                   'C' 'D'.
   851             88  ADD-FUNCTION                VALUE 'A'.
   852             88  SHOW-FUNCTION               VALUE 'S'.
   853             88  DELETE-FUNCTION             VALUE 'D'.
   854             88  CHANGE-FUNCTION             VALUE 'C'.
   855         16  PI-ERC-KEY.
   856             20  PI-ERC-COMPANY-CD   PIC  X.
   857             20  PI-ERC-CARRIER      PIC  X.
   858             20  PI-ERC-GROUP        PIC  X(6).
   859             20  PI-ERC-BANK         PIC  X(10).
   860             20  PI-ERC-EXP-DT       PIC  XX.
   861             20  PI-ERC-TYPE         PIC  X.
   862         16  PI-SAVE-ERAGTC-KEY      PIC  X(21).
   863         16  FILLER                  PIC X(617).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6524.cbl
   865*                            COPY ELCAID SUPPRESS.
   866******************************************************************
   867*                                                                *
   868*                            ELCAID.                             *
   869*                            VMOD=2.001                          *
   870*                                                                *
   871*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   872*                                                                *
   873*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   874*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   875******************************************************************
   876
   877 01  DFHAID.
   878   02  DFHNULL   PIC  X  VALUE  ' '.
   879   02  DFHENTER  PIC  X  VALUE  QUOTE.
   880   02  DFHCLEAR  PIC  X  VALUE  '_'.
   881   02  DFHPEN    PIC  X  VALUE  '='.
   882   02  DFHOPID   PIC  X  VALUE  'W'.
   883   02  DFHPA1    PIC  X  VALUE  '%'.
   884   02  DFHPA2    PIC  X  VALUE  '>'.
   885   02  DFHPA3    PIC  X  VALUE  ','.
   886   02  DFHPF1    PIC  X  VALUE  '1'.
   887   02  DFHPF2    PIC  X  VALUE  '2'.
   888   02  DFHPF3    PIC  X  VALUE  '3'.
   889   02  DFHPF4    PIC  X  VALUE  '4'.
   890   02  DFHPF5    PIC  X  VALUE  '5'.
   891   02  DFHPF6    PIC  X  VALUE  '6'.
   892   02  DFHPF7    PIC  X  VALUE  '7'.
   893   02  DFHPF8    PIC  X  VALUE  '8'.
   894   02  DFHPF9    PIC  X  VALUE  '9'.
   895   02  DFHPF10   PIC  X  VALUE  ':'.
   896   02  DFHPF11   PIC  X  VALUE  '#'.
   897   02  DFHPF12   PIC  X  VALUE  '@'.
   898   02  DFHPF13   PIC  X  VALUE  'A'.
   899   02  DFHPF14   PIC  X  VALUE  'B'.
   900   02  DFHPF15   PIC  X  VALUE  'C'.
   901   02  DFHPF16   PIC  X  VALUE  'D'.
   902   02  DFHPF17   PIC  X  VALUE  'E'.
   903   02  DFHPF18   PIC  X  VALUE  'F'.
   904   02  DFHPF19   PIC  X  VALUE  'G'.
   905   02  DFHPF20   PIC  X  VALUE  'H'.
   906   02  DFHPF21   PIC  X  VALUE  'I'.
   907*00039    02  DFHPF22   PIC  X  VALUE  ''.
   908   02  DFHPF22   PIC  X  VALUE  '['.
   909   02  DFHPF23   PIC  X  VALUE  '.'.
   910   02  DFHPF24   PIC  X  VALUE  '<'.
   911   02  DFHMSRE   PIC  X  VALUE  'X'.
   912   02  DFHSTRF   PIC  X  VALUE  'h'.
   913   02  DFHTRIG   PIC  X  VALUE  '"'.
   914 01  FILLER    REDEFINES DFHAID.
   915     12  FILLER              PIC X(8).
   916     12  PF-VALUES           PIC X       OCCURS 24.
   917 01  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
   918 01  WS-BIN-EXP-DT               PIC XX VALUE LOW-VALUES.
   919*                            COPY EL6524S.
   920 01  EL652EI.
   921     05  FILLER            PIC  X(0012).
   922*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6524.cbl
   923     05  TIMEL PIC S9(0004) COMP.
   924     05  TIMEF PIC  X(0001).
   925     05  FILLER REDEFINES TIMEF.
   926         10  TIMEA PIC  X(0001).
   927     05  TIMEI PIC  X(0005).
   928*    -------------------------------
   929     05  DATEL PIC S9(0004) COMP.
   930     05  DATEF PIC  X(0001).
   931     05  FILLER REDEFINES DATEF.
   932         10  DATEA PIC  X(0001).
   933     05  DATEI PIC  X(0008).
   934*    -------------------------------
   935     05  MAINTYPL PIC S9(0004) COMP.
   936     05  MAINTYPF PIC  X(0001).
   937     05  FILLER REDEFINES MAINTYPF.
   938         10  MAINTYPA PIC  X(0001).
   939     05  MAINTYPI PIC  X(0001).
   940*    -------------------------------
   941     05  MAINTDTL PIC S9(0004) COMP.
   942     05  MAINTDTF PIC  X(0001).
   943     05  FILLER REDEFINES MAINTDTF.
   944         10  MAINTDTA PIC  X(0001).
   945     05  MAINTDTI PIC  X(0008).
   946*    -------------------------------
   947     05  MAINTBYL PIC S9(0004) COMP.
   948     05  MAINTBYF PIC  X(0001).
   949     05  FILLER REDEFINES MAINTBYF.
   950         10  MAINTBYA PIC  X(0001).
   951     05  MAINTBYI PIC  X(0004).
   952*    -------------------------------
   953     05  CARRIERL PIC S9(0004) COMP.
   954     05  CARRIERF PIC  X(0001).
   955     05  FILLER REDEFINES CARRIERF.
   956         10  CARRIERA PIC  X(0001).
   957     05  CARRIERI PIC  X(0001).
   958*    -------------------------------
   959     05  GROUPL PIC S9(0004) COMP.
   960     05  GROUPF PIC  X(0001).
   961     05  FILLER REDEFINES GROUPF.
   962         10  GROUPA PIC  X(0001).
   963     05  GROUPI PIC  X(0006).
   964*    -------------------------------
   965     05  TYPEL PIC S9(0004) COMP.
   966     05  TYPEF PIC  X(0001).
   967     05  FILLER REDEFINES TYPEF.
   968         10  TYPEA PIC  X(0001).
   969     05  TYPEI PIC  X(0001).
   970*    -------------------------------
   971     05  BANKL PIC S9(0004) COMP.
   972     05  BANKF PIC  X(0001).
   973     05  FILLER REDEFINES BANKF.
   974         10  BANKA PIC  X(0001).
   975     05  BANKI PIC  X(0010).
   976*    -------------------------------
   977     05  EFFDTL PIC S9(0004) COMP.
   978     05  EFFDTF PIC  X(0001).
   979     05  FILLER REDEFINES EFFDTF.
   980         10  EFFDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6524.cbl
   981     05  EFFDTI PIC  X(0008).
   982*    -------------------------------
   983     05  EXPDTL PIC S9(0004) COMP.
   984     05  EXPDTF PIC  X(0001).
   985     05  FILLER REDEFINES EXPDTF.
   986         10  EXPDTA PIC  X(0001).
   987     05  EXPDTI PIC  X(0008).
   988*    -------------------------------
   989     05  REP1L PIC S9(0004) COMP.
   990     05  REP1F PIC  X(0001).
   991     05  FILLER REDEFINES REP1F.
   992         10  REP1A PIC  X(0001).
   993     05  REP1I PIC  X(0010).
   994*    -------------------------------
   995     05  TYPE1L PIC S9(0004) COMP.
   996     05  TYPE1F PIC  X(0001).
   997     05  FILLER REDEFINES TYPE1F.
   998         10  TYPE1A PIC  X(0001).
   999     05  TYPE1I PIC  X(0001).
  1000*    -------------------------------
  1001     05  FEES1L PIC S9(0004) COMP.
  1002     05  FEES1F PIC  X(0001).
  1003     05  FILLER REDEFINES FEES1F.
  1004         10  FEES1A PIC  X(0001).
  1005     05  FEES1I PIC  S9(6)V99.
  1006*    -------------------------------
  1007     05  RECAL1L PIC S9(0004) COMP.
  1008     05  RECAL1F PIC  X(0001).
  1009     05  FILLER REDEFINES RECAL1F.
  1010         10  RECAL1A PIC  X(0001).
  1011     05  RECAL1I PIC  X(0001).
  1012*    -------------------------------
  1013     05  LFEES1L PIC S9(0004) COMP.
  1014     05  LFEES1F PIC  X(0001).
  1015     05  FILLER REDEFINES LFEES1F.
  1016         10  LFEES1A PIC  X(0001).
  1017     05  LFEES1I PIC  S9(6)V99.
  1018*    -------------------------------
  1019     05  LRCAL1L PIC S9(0004) COMP.
  1020     05  LRCAL1F PIC  X(0001).
  1021     05  FILLER REDEFINES LRCAL1F.
  1022         10  LRCAL1A PIC  X(0001).
  1023     05  LRCAL1I PIC  X(0001).
  1024*    -------------------------------
  1025     05  REP2L PIC S9(0004) COMP.
  1026     05  REP2F PIC  X(0001).
  1027     05  FILLER REDEFINES REP2F.
  1028         10  REP2A PIC  X(0001).
  1029     05  REP2I PIC  X(0010).
  1030*    -------------------------------
  1031     05  TYPE2L PIC S9(0004) COMP.
  1032     05  TYPE2F PIC  X(0001).
  1033     05  FILLER REDEFINES TYPE2F.
  1034         10  TYPE2A PIC  X(0001).
  1035     05  TYPE2I PIC  X(0001).
  1036*    -------------------------------
  1037     05  FEES2L PIC S9(0004) COMP.
  1038     05  FEES2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6524.cbl
  1039     05  FILLER REDEFINES FEES2F.
  1040         10  FEES2A PIC  X(0001).
  1041     05  FEES2I PIC  S9(6)V99.
  1042*    -------------------------------
  1043     05  RECAL2L PIC S9(0004) COMP.
  1044     05  RECAL2F PIC  X(0001).
  1045     05  FILLER REDEFINES RECAL2F.
  1046         10  RECAL2A PIC  X(0001).
  1047     05  RECAL2I PIC  X(0001).
  1048*    -------------------------------
  1049     05  LFEES2L PIC S9(0004) COMP.
  1050     05  LFEES2F PIC  X(0001).
  1051     05  FILLER REDEFINES LFEES2F.
  1052         10  LFEES2A PIC  X(0001).
  1053     05  LFEES2I PIC  S9(6)V99.
  1054*    -------------------------------
  1055     05  LRCAL2L PIC S9(0004) COMP.
  1056     05  LRCAL2F PIC  X(0001).
  1057     05  FILLER REDEFINES LRCAL2F.
  1058         10  LRCAL2A PIC  X(0001).
  1059     05  LRCAL2I PIC  X(0001).
  1060*    -------------------------------
  1061     05  REP3L PIC S9(0004) COMP.
  1062     05  REP3F PIC  X(0001).
  1063     05  FILLER REDEFINES REP3F.
  1064         10  REP3A PIC  X(0001).
  1065     05  REP3I PIC  X(0010).
  1066*    -------------------------------
  1067     05  TYPE3L PIC S9(0004) COMP.
  1068     05  TYPE3F PIC  X(0001).
  1069     05  FILLER REDEFINES TYPE3F.
  1070         10  TYPE3A PIC  X(0001).
  1071     05  TYPE3I PIC  X(0001).
  1072*    -------------------------------
  1073     05  FEES3L PIC S9(0004) COMP.
  1074     05  FEES3F PIC  X(0001).
  1075     05  FILLER REDEFINES FEES3F.
  1076         10  FEES3A PIC  X(0001).
  1077     05  FEES3I PIC  S9(6)V99.
  1078*    -------------------------------
  1079     05  RECAL3L PIC S9(0004) COMP.
  1080     05  RECAL3F PIC  X(0001).
  1081     05  FILLER REDEFINES RECAL3F.
  1082         10  RECAL3A PIC  X(0001).
  1083     05  RECAL3I PIC  X(0001).
  1084*    -------------------------------
  1085     05  LFEES3L PIC S9(0004) COMP.
  1086     05  LFEES3F PIC  X(0001).
  1087     05  FILLER REDEFINES LFEES3F.
  1088         10  LFEES3A PIC  X(0001).
  1089     05  LFEES3I PIC  S9(6)V99.
  1090*    -------------------------------
  1091     05  LRCAL3L PIC S9(0004) COMP.
  1092     05  LRCAL3F PIC  X(0001).
  1093     05  FILLER REDEFINES LRCAL3F.
  1094         10  LRCAL3A PIC  X(0001).
  1095     05  LRCAL3I PIC  X(0001).
  1096*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6524.cbl
  1097     05  REP4L PIC S9(0004) COMP.
  1098     05  REP4F PIC  X(0001).
  1099     05  FILLER REDEFINES REP4F.
  1100         10  REP4A PIC  X(0001).
  1101     05  REP4I PIC  X(0010).
  1102*    -------------------------------
  1103     05  TYPE4L PIC S9(0004) COMP.
  1104     05  TYPE4F PIC  X(0001).
  1105     05  FILLER REDEFINES TYPE4F.
  1106         10  TYPE4A PIC  X(0001).
  1107     05  TYPE4I PIC  X(0001).
  1108*    -------------------------------
  1109     05  FEES4L PIC S9(0004) COMP.
  1110     05  FEES4F PIC  X(0001).
  1111     05  FILLER REDEFINES FEES4F.
  1112         10  FEES4A PIC  X(0001).
  1113     05  FEES4I PIC  S9(6)V99.
  1114*    -------------------------------
  1115     05  RECAL4L PIC S9(0004) COMP.
  1116     05  RECAL4F PIC  X(0001).
  1117     05  FILLER REDEFINES RECAL4F.
  1118         10  RECAL4A PIC  X(0001).
  1119     05  RECAL4I PIC  X(0001).
  1120*    -------------------------------
  1121     05  LFEES4L PIC S9(0004) COMP.
  1122     05  LFEES4F PIC  X(0001).
  1123     05  FILLER REDEFINES LFEES4F.
  1124         10  LFEES4A PIC  X(0001).
  1125     05  LFEES4I PIC  S9(6)V99.
  1126*    -------------------------------
  1127     05  LRCAL4L PIC S9(0004) COMP.
  1128     05  LRCAL4F PIC  X(0001).
  1129     05  FILLER REDEFINES LRCAL4F.
  1130         10  LRCAL4A PIC  X(0001).
  1131     05  LRCAL4I PIC  X(0001).
  1132*    -------------------------------
  1133     05  REP5L PIC S9(0004) COMP.
  1134     05  REP5F PIC  X(0001).
  1135     05  FILLER REDEFINES REP5F.
  1136         10  REP5A PIC  X(0001).
  1137     05  REP5I PIC  X(0010).
  1138*    -------------------------------
  1139     05  TYPE5L PIC S9(0004) COMP.
  1140     05  TYPE5F PIC  X(0001).
  1141     05  FILLER REDEFINES TYPE5F.
  1142         10  TYPE5A PIC  X(0001).
  1143     05  TYPE5I PIC  X(0001).
  1144*    -------------------------------
  1145     05  FEES5L PIC S9(0004) COMP.
  1146     05  FEES5F PIC  X(0001).
  1147     05  FILLER REDEFINES FEES5F.
  1148         10  FEES5A PIC  X(0001).
  1149     05  FEES5I PIC  S9(6)V99.
  1150*    -------------------------------
  1151     05  RECAL5L PIC S9(0004) COMP.
  1152     05  RECAL5F PIC  X(0001).
  1153     05  FILLER REDEFINES RECAL5F.
  1154         10  RECAL5A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6524.cbl
  1155     05  RECAL5I PIC  X(0001).
  1156*    -------------------------------
  1157     05  LFEES5L PIC S9(0004) COMP.
  1158     05  LFEES5F PIC  X(0001).
  1159     05  FILLER REDEFINES LFEES5F.
  1160         10  LFEES5A PIC  X(0001).
  1161     05  LFEES5I PIC  S9(6)V99.
  1162*    -------------------------------
  1163     05  LRCAL5L PIC S9(0004) COMP.
  1164     05  LRCAL5F PIC  X(0001).
  1165     05  FILLER REDEFINES LRCAL5F.
  1166         10  LRCAL5A PIC  X(0001).
  1167     05  LRCAL5I PIC  X(0001).
  1168*    -------------------------------
  1169     05  REP6L PIC S9(0004) COMP.
  1170     05  REP6F PIC  X(0001).
  1171     05  FILLER REDEFINES REP6F.
  1172         10  REP6A PIC  X(0001).
  1173     05  REP6I PIC  X(0010).
  1174*    -------------------------------
  1175     05  TYPE6L PIC S9(0004) COMP.
  1176     05  TYPE6F PIC  X(0001).
  1177     05  FILLER REDEFINES TYPE6F.
  1178         10  TYPE6A PIC  X(0001).
  1179     05  TYPE6I PIC  X(0001).
  1180*    -------------------------------
  1181     05  FEES6L PIC S9(0004) COMP.
  1182     05  FEES6F PIC  X(0001).
  1183     05  FILLER REDEFINES FEES6F.
  1184         10  FEES6A PIC  X(0001).
  1185     05  FEES6I PIC  S9(6)V99.
  1186*    -------------------------------
  1187     05  RECAL6L PIC S9(0004) COMP.
  1188     05  RECAL6F PIC  X(0001).
  1189     05  FILLER REDEFINES RECAL6F.
  1190         10  RECAL6A PIC  X(0001).
  1191     05  RECAL6I PIC  X(0001).
  1192*    -------------------------------
  1193     05  LFEES6L PIC S9(0004) COMP.
  1194     05  LFEES6F PIC  X(0001).
  1195     05  FILLER REDEFINES LFEES6F.
  1196         10  LFEES6A PIC  X(0001).
  1197     05  LFEES6I PIC  S9(6)V99.
  1198*    -------------------------------
  1199     05  LRCAL6L PIC S9(0004) COMP.
  1200     05  LRCAL6F PIC  X(0001).
  1201     05  FILLER REDEFINES LRCAL6F.
  1202         10  LRCAL6A PIC  X(0001).
  1203     05  LRCAL6I PIC  X(0001).
  1204*    -------------------------------
  1205     05  REP7L PIC S9(0004) COMP.
  1206     05  REP7F PIC  X(0001).
  1207     05  FILLER REDEFINES REP7F.
  1208         10  REP7A PIC  X(0001).
  1209     05  REP7I PIC  X(0010).
  1210*    -------------------------------
  1211     05  TYPE7L PIC S9(0004) COMP.
  1212     05  TYPE7F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6524.cbl
  1213     05  FILLER REDEFINES TYPE7F.
  1214         10  TYPE7A PIC  X(0001).
  1215     05  TYPE7I PIC  X(0001).
  1216*    -------------------------------
  1217     05  FEES7L PIC S9(0004) COMP.
  1218     05  FEES7F PIC  X(0001).
  1219     05  FILLER REDEFINES FEES7F.
  1220         10  FEES7A PIC  X(0001).
  1221     05  FEES7I PIC  S9(6)V99.
  1222*    -------------------------------
  1223     05  RECAL7L PIC S9(0004) COMP.
  1224     05  RECAL7F PIC  X(0001).
  1225     05  FILLER REDEFINES RECAL7F.
  1226         10  RECAL7A PIC  X(0001).
  1227     05  RECAL7I PIC  X(0001).
  1228*    -------------------------------
  1229     05  LFEES7L PIC S9(0004) COMP.
  1230     05  LFEES7F PIC  X(0001).
  1231     05  FILLER REDEFINES LFEES7F.
  1232         10  LFEES7A PIC  X(0001).
  1233     05  LFEES7I PIC  S9(6)V99.
  1234*    -------------------------------
  1235     05  LRCAL7L PIC S9(0004) COMP.
  1236     05  LRCAL7F PIC  X(0001).
  1237     05  FILLER REDEFINES LRCAL7F.
  1238         10  LRCAL7A PIC  X(0001).
  1239     05  LRCAL7I PIC  X(0001).
  1240*    -------------------------------
  1241     05  REP8L PIC S9(0004) COMP.
  1242     05  REP8F PIC  X(0001).
  1243     05  FILLER REDEFINES REP8F.
  1244         10  REP8A PIC  X(0001).
  1245     05  REP8I PIC  X(0010).
  1246*    -------------------------------
  1247     05  TYPE8L PIC S9(0004) COMP.
  1248     05  TYPE8F PIC  X(0001).
  1249     05  FILLER REDEFINES TYPE8F.
  1250         10  TYPE8A PIC  X(0001).
  1251     05  TYPE8I PIC  X(0001).
  1252*    -------------------------------
  1253     05  FEES8L PIC S9(0004) COMP.
  1254     05  FEES8F PIC  X(0001).
  1255     05  FILLER REDEFINES FEES8F.
  1256         10  FEES8A PIC  X(0001).
  1257     05  FEES8I PIC  S9(6)V99.
  1258*    -------------------------------
  1259     05  RECAL8L PIC S9(0004) COMP.
  1260     05  RECAL8F PIC  X(0001).
  1261     05  FILLER REDEFINES RECAL8F.
  1262         10  RECAL8A PIC  X(0001).
  1263     05  RECAL8I PIC  X(0001).
  1264*    -------------------------------
  1265     05  LFEES8L PIC S9(0004) COMP.
  1266     05  LFEES8F PIC  X(0001).
  1267     05  FILLER REDEFINES LFEES8F.
  1268         10  LFEES8A PIC  X(0001).
  1269     05  LFEES8I PIC  S9(6)V99.
  1270*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6524.cbl
  1271     05  LRCAL8L PIC S9(0004) COMP.
  1272     05  LRCAL8F PIC  X(0001).
  1273     05  FILLER REDEFINES LRCAL8F.
  1274         10  LRCAL8A PIC  X(0001).
  1275     05  LRCAL8I PIC  X(0001).
  1276*    -------------------------------
  1277     05  REP9L PIC S9(0004) COMP.
  1278     05  REP9F PIC  X(0001).
  1279     05  FILLER REDEFINES REP9F.
  1280         10  REP9A PIC  X(0001).
  1281     05  REP9I PIC  X(0010).
  1282*    -------------------------------
  1283     05  TYPE9L PIC S9(0004) COMP.
  1284     05  TYPE9F PIC  X(0001).
  1285     05  FILLER REDEFINES TYPE9F.
  1286         10  TYPE9A PIC  X(0001).
  1287     05  TYPE9I PIC  X(0001).
  1288*    -------------------------------
  1289     05  FEES9L PIC S9(0004) COMP.
  1290     05  FEES9F PIC  X(0001).
  1291     05  FILLER REDEFINES FEES9F.
  1292         10  FEES9A PIC  X(0001).
  1293     05  FEES9I PIC  S9(6)V99.
  1294*    -------------------------------
  1295     05  RECAL9L PIC S9(0004) COMP.
  1296     05  RECAL9F PIC  X(0001).
  1297     05  FILLER REDEFINES RECAL9F.
  1298         10  RECAL9A PIC  X(0001).
  1299     05  RECAL9I PIC  X(0001).
  1300*    -------------------------------
  1301     05  LFEES9L PIC S9(0004) COMP.
  1302     05  LFEES9F PIC  X(0001).
  1303     05  FILLER REDEFINES LFEES9F.
  1304         10  LFEES9A PIC  X(0001).
  1305     05  LFEES9I PIC  S9(6)V99.
  1306*    -------------------------------
  1307     05  LRCAL9L PIC S9(0004) COMP.
  1308     05  LRCAL9F PIC  X(0001).
  1309     05  FILLER REDEFINES LRCAL9F.
  1310         10  LRCAL9A PIC  X(0001).
  1311     05  LRCAL9I PIC  X(0001).
  1312*    -------------------------------
  1313     05  REP10L PIC S9(0004) COMP.
  1314     05  REP10F PIC  X(0001).
  1315     05  FILLER REDEFINES REP10F.
  1316         10  REP10A PIC  X(0001).
  1317     05  REP10I PIC  X(0010).
  1318*    -------------------------------
  1319     05  TYPE10L PIC S9(0004) COMP.
  1320     05  TYPE10F PIC  X(0001).
  1321     05  FILLER REDEFINES TYPE10F.
  1322         10  TYPE10A PIC  X(0001).
  1323     05  TYPE10I PIC  X(0001).
  1324*    -------------------------------
  1325     05  FEES10L PIC S9(0004) COMP.
  1326     05  FEES10F PIC  X(0001).
  1327     05  FILLER REDEFINES FEES10F.
  1328         10  FEES10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6524.cbl
  1329     05  FEES10I PIC  S9(6)V99.
  1330*    -------------------------------
  1331     05  RECAL10L PIC S9(0004) COMP.
  1332     05  RECAL10F PIC  X(0001).
  1333     05  FILLER REDEFINES RECAL10F.
  1334         10  RECAL10A PIC  X(0001).
  1335     05  RECAL10I PIC  X(0001).
  1336*    -------------------------------
  1337     05  LFEES10L PIC S9(0004) COMP.
  1338     05  LFEES10F PIC  X(0001).
  1339     05  FILLER REDEFINES LFEES10F.
  1340         10  LFEES10A PIC  X(0001).
  1341     05  LFEES10I PIC  S9(6)V99.
  1342*    -------------------------------
  1343     05  LRCAL10L PIC S9(0004) COMP.
  1344     05  LRCAL10F PIC  X(0001).
  1345     05  FILLER REDEFINES LRCAL10F.
  1346         10  LRCAL10A PIC  X(0001).
  1347     05  LRCAL10I PIC  X(0001).
  1348*    -------------------------------
  1349     05  ERRMSGL PIC S9(0004) COMP.
  1350     05  ERRMSGF PIC  X(0001).
  1351     05  FILLER REDEFINES ERRMSGF.
  1352         10  ERRMSGA PIC  X(0001).
  1353     05  ERRMSGI PIC  X(0076).
  1354*    -------------------------------
  1355     05  PFENTERL PIC S9(0004) COMP.
  1356     05  PFENTERF PIC  X(0001).
  1357     05  FILLER REDEFINES PFENTERF.
  1358         10  PFENTERA PIC  X(0001).
  1359     05  PFENTERI PIC  9(2).
  1360 01  EL652EO REDEFINES EL652EI.
  1361     05  FILLER            PIC  X(0012).
  1362*    -------------------------------
  1363     05  FILLER            PIC  X(0003).
  1364     05  TIMEO PIC  99.99.
  1365*    -------------------------------
  1366     05  FILLER            PIC  X(0003).
  1367     05  DATEO PIC  X(0008).
  1368*    -------------------------------
  1369     05  FILLER            PIC  X(0003).
  1370     05  MAINTYPO PIC  X(0001).
  1371*    -------------------------------
  1372     05  FILLER            PIC  X(0003).
  1373     05  MAINTDTO PIC  X(0008).
  1374*    -------------------------------
  1375     05  FILLER            PIC  X(0003).
  1376     05  MAINTBYO PIC  X(0004).
  1377*    -------------------------------
  1378     05  FILLER            PIC  X(0003).
  1379     05  CARRIERO PIC  X(0001).
  1380*    -------------------------------
  1381     05  FILLER            PIC  X(0003).
  1382     05  GROUPO PIC  X(0006).
  1383*    -------------------------------
  1384     05  FILLER            PIC  X(0003).
  1385     05  TYPEO PIC  X(0001).
  1386*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6524.cbl
  1387     05  FILLER            PIC  X(0003).
  1388     05  BANKO PIC  X(0010).
  1389*    -------------------------------
  1390     05  FILLER            PIC  X(0003).
  1391     05  EFFDTO PIC  X(0008).
  1392*    -------------------------------
  1393     05  FILLER            PIC  X(0003).
  1394     05  EXPDTO PIC  X(0008).
  1395*    -------------------------------
  1396     05  FILLER            PIC  X(0003).
  1397     05  REP1O PIC  X(0010).
  1398*    -------------------------------
  1399     05  FILLER            PIC  X(0003).
  1400     05  TYPE1O PIC  X(0001).
  1401*    -------------------------------
  1402     05  FILLER            PIC  X(0003).
  1403     05  FEES1O PIC  ZZZ99.99.
  1404*    -------------------------------
  1405     05  FILLER            PIC  X(0003).
  1406     05  RECAL1O PIC  X(0001).
  1407*    -------------------------------
  1408     05  FILLER            PIC  X(0003).
  1409     05  LFEES1O PIC  ZZZ99.99.
  1410*    -------------------------------
  1411     05  FILLER            PIC  X(0003).
  1412     05  LRCAL1O PIC  X(0001).
  1413*    -------------------------------
  1414     05  FILLER            PIC  X(0003).
  1415     05  REP2O PIC  X(0010).
  1416*    -------------------------------
  1417     05  FILLER            PIC  X(0003).
  1418     05  TYPE2O PIC  X(0001).
  1419*    -------------------------------
  1420     05  FILLER            PIC  X(0003).
  1421     05  FEES2O PIC  ZZZ99.99.
  1422*    -------------------------------
  1423     05  FILLER            PIC  X(0003).
  1424     05  RECAL2O PIC  X(0001).
  1425*    -------------------------------
  1426     05  FILLER            PIC  X(0003).
  1427     05  LFEES2O PIC  ZZZ99.99.
  1428*    -------------------------------
  1429     05  FILLER            PIC  X(0003).
  1430     05  LRCAL2O PIC  X(0001).
  1431*    -------------------------------
  1432     05  FILLER            PIC  X(0003).
  1433     05  REP3O PIC  X(0010).
  1434*    -------------------------------
  1435     05  FILLER            PIC  X(0003).
  1436     05  TYPE3O PIC  X(0001).
  1437*    -------------------------------
  1438     05  FILLER            PIC  X(0003).
  1439     05  FEES3O PIC  ZZZ99.99.
  1440*    -------------------------------
  1441     05  FILLER            PIC  X(0003).
  1442     05  RECAL3O PIC  X(0001).
  1443*    -------------------------------
  1444     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6524.cbl
  1445     05  LFEES3O PIC  ZZZ99.99.
  1446*    -------------------------------
  1447     05  FILLER            PIC  X(0003).
  1448     05  LRCAL3O PIC  X(0001).
  1449*    -------------------------------
  1450     05  FILLER            PIC  X(0003).
  1451     05  REP4O PIC  X(0010).
  1452*    -------------------------------
  1453     05  FILLER            PIC  X(0003).
  1454     05  TYPE4O PIC  X(0001).
  1455*    -------------------------------
  1456     05  FILLER            PIC  X(0003).
  1457     05  FEES4O PIC  ZZZ99.99.
  1458*    -------------------------------
  1459     05  FILLER            PIC  X(0003).
  1460     05  RECAL4O PIC  X(0001).
  1461*    -------------------------------
  1462     05  FILLER            PIC  X(0003).
  1463     05  LFEES4O PIC  ZZZ99.99.
  1464*    -------------------------------
  1465     05  FILLER            PIC  X(0003).
  1466     05  LRCAL4O PIC  X(0001).
  1467*    -------------------------------
  1468     05  FILLER            PIC  X(0003).
  1469     05  REP5O PIC  X(0010).
  1470*    -------------------------------
  1471     05  FILLER            PIC  X(0003).
  1472     05  TYPE5O PIC  X(0001).
  1473*    -------------------------------
  1474     05  FILLER            PIC  X(0003).
  1475     05  FEES5O PIC  ZZZ99.99.
  1476*    -------------------------------
  1477     05  FILLER            PIC  X(0003).
  1478     05  RECAL5O PIC  X(0001).
  1479*    -------------------------------
  1480     05  FILLER            PIC  X(0003).
  1481     05  LFEES5O PIC  ZZZ99.99.
  1482*    -------------------------------
  1483     05  FILLER            PIC  X(0003).
  1484     05  LRCAL5O PIC  X(0001).
  1485*    -------------------------------
  1486     05  FILLER            PIC  X(0003).
  1487     05  REP6O PIC  X(0010).
  1488*    -------------------------------
  1489     05  FILLER            PIC  X(0003).
  1490     05  TYPE6O PIC  X(0001).
  1491*    -------------------------------
  1492     05  FILLER            PIC  X(0003).
  1493     05  FEES6O PIC  ZZZ99.99.
  1494*    -------------------------------
  1495     05  FILLER            PIC  X(0003).
  1496     05  RECAL6O PIC  X(0001).
  1497*    -------------------------------
  1498     05  FILLER            PIC  X(0003).
  1499     05  LFEES6O PIC  ZZZ99.99.
  1500*    -------------------------------
  1501     05  FILLER            PIC  X(0003).
  1502     05  LRCAL6O PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6524.cbl
  1503*    -------------------------------
  1504     05  FILLER            PIC  X(0003).
  1505     05  REP7O PIC  X(0010).
  1506*    -------------------------------
  1507     05  FILLER            PIC  X(0003).
  1508     05  TYPE7O PIC  X(0001).
  1509*    -------------------------------
  1510     05  FILLER            PIC  X(0003).
  1511     05  FEES7O PIC  ZZZ99.99.
  1512*    -------------------------------
  1513     05  FILLER            PIC  X(0003).
  1514     05  RECAL7O PIC  X(0001).
  1515*    -------------------------------
  1516     05  FILLER            PIC  X(0003).
  1517     05  LFEES7O PIC  ZZZ99.99.
  1518*    -------------------------------
  1519     05  FILLER            PIC  X(0003).
  1520     05  LRCAL7O PIC  X(0001).
  1521*    -------------------------------
  1522     05  FILLER            PIC  X(0003).
  1523     05  REP8O PIC  X(0010).
  1524*    -------------------------------
  1525     05  FILLER            PIC  X(0003).
  1526     05  TYPE8O PIC  X(0001).
  1527*    -------------------------------
  1528     05  FILLER            PIC  X(0003).
  1529     05  FEES8O PIC  ZZZ99.99.
  1530*    -------------------------------
  1531     05  FILLER            PIC  X(0003).
  1532     05  RECAL8O PIC  X(0001).
  1533*    -------------------------------
  1534     05  FILLER            PIC  X(0003).
  1535     05  LFEES8O PIC  ZZZ99.99.
  1536*    -------------------------------
  1537     05  FILLER            PIC  X(0003).
  1538     05  LRCAL8O PIC  X(0001).
  1539*    -------------------------------
  1540     05  FILLER            PIC  X(0003).
  1541     05  REP9O PIC  X(0010).
  1542*    -------------------------------
  1543     05  FILLER            PIC  X(0003).
  1544     05  TYPE9O PIC  X(0001).
  1545*    -------------------------------
  1546     05  FILLER            PIC  X(0003).
  1547     05  FEES9O PIC  ZZZ99.99.
  1548*    -------------------------------
  1549     05  FILLER            PIC  X(0003).
  1550     05  RECAL9O PIC  X(0001).
  1551*    -------------------------------
  1552     05  FILLER            PIC  X(0003).
  1553     05  LFEES9O PIC  ZZZ99.99.
  1554*    -------------------------------
  1555     05  FILLER            PIC  X(0003).
  1556     05  LRCAL9O PIC  X(0001).
  1557*    -------------------------------
  1558     05  FILLER            PIC  X(0003).
  1559     05  REP10O PIC  X(0010).
  1560*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6524.cbl
  1561     05  FILLER            PIC  X(0003).
  1562     05  TYPE10O PIC  X(0001).
  1563*    -------------------------------
  1564     05  FILLER            PIC  X(0003).
  1565     05  FEES10O PIC  ZZZ99.99.
  1566*    -------------------------------
  1567     05  FILLER            PIC  X(0003).
  1568     05  RECAL10O PIC  X(0001).
  1569*    -------------------------------
  1570     05  FILLER            PIC  X(0003).
  1571     05  LFEES10O PIC  ZZZ99.99.
  1572*    -------------------------------
  1573     05  FILLER            PIC  X(0003).
  1574     05  LRCAL10O PIC  X(0001).
  1575*    -------------------------------
  1576     05  FILLER            PIC  X(0003).
  1577     05  ERRMSGO PIC  X(0076).
  1578*    -------------------------------
  1579     05  FILLER            PIC  X(0003).
  1580     05  PFENTERO PIC  X(0002).
  1581*    -------------------------------
  1582 01  MAP-R REDEFINES EL652EI.
  1583     12  FILLER                  PIC X(105).
  1584     12  MAP-AGENT-AREA.
  1585         16  AGENT-AREA OCCURS 10 TIMES INDEXED BY M-INDEX.
  1586             20  REPRL           PIC S9(4) COMP.
  1587             20  REPRA           PIC X.
  1588             20  REPR            PIC X(10).
  1589             20  ATYPEL          PIC S9(4) COMP.
  1590             20  ATYPEA          PIC X.
  1591             20  ATYPE           PIC X.
  1592             20  FEESL           PIC S9(4) COMP.
  1593             20  FEESA           PIC X.
  1594             20  FEES-COMM-T     PIC X(8).
  1595             20  FEES-COMM-N     REDEFINES FEES-COMM-T.
  1596                 24  FEES-COMM-R PIC 9(6)V99.
  1597             20  FEES-COMM-O     REDEFINES FEES-COMM-T
  1598                                 PIC ZZZZ9.99.
  1599             20  RECALL          PIC S9(4) COMP.
  1600             20  RECALA          PIC X.
  1601             20  RECAL           PIC X.
  1602             20  LFEESL          PIC S9(4) COMP.
  1603             20  LFEESA          PIC X.
  1604             20  LFEES-COMM-T    PIC X(8).
  1605             20  LFEES-COMM-N    REDEFINES LFEES-COMM-T.
  1606                 24  LFEES-COMM-R PIC 9(6)V99.
  1607             20  LFEES-COMM-O    REDEFINES LFEES-COMM-T
  1608                                 PIC ZZZZ9.99.
  1609             20  LRCALL          PIC S9(4) COMP.
  1610             20  LRCALA          PIC X.
  1611             20  LRCAL           PIC X.
  1612****************************************************************
  1613*
  1614* Copyright (c) 2007 by Clerity Solutions, Inc.
  1615* All rights reserved.
  1616*
  1617****************************************************************
  1618 01  DFHEIV.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6524.cbl
  1619   02  DFHEIV0               PIC X(35).
  1620   02  DFHEIV1               PIC X(08).
  1621   02  DFHEIV2               PIC X(08).
  1622   02  DFHEIV3               PIC X(08).
  1623   02  DFHEIV4               PIC X(06).
  1624   02  DFHEIV5               PIC X(04).
  1625   02  DFHEIV6               PIC X(04).
  1626   02  DFHEIV7               PIC X(02).
  1627   02  DFHEIV8               PIC X(02).
  1628   02  DFHEIV9               PIC X(01).
  1629   02  DFHEIV10              PIC S9(7) COMP-3.
  1630   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1631   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1632   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1633   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1634   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1635   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1636   02  DFHEIV17              PIC X(04).
  1637   02  DFHEIV18              PIC X(04).
  1638   02  DFHEIV19              PIC X(04).
  1639   02  DFHEIV20              USAGE IS POINTER.
  1640   02  DFHEIV21              USAGE IS POINTER.
  1641   02  DFHEIV22              USAGE IS POINTER.
  1642   02  DFHEIV23              USAGE IS POINTER.
  1643   02  DFHEIV24              USAGE IS POINTER.
  1644   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1645   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1646   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1647   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1648   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1649   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1650   02  FILLER                PIC X(02).
  1651   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1652   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1653   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1654   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1655   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1656 LINKAGE  SECTION.
  1657*****************************************************************
  1658*                                                               *
  1659* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1660* All rights reserved.                                          *
  1661*                                                               *
  1662*****************************************************************
  1663 01  dfheiblk.
  1664     02  eibtime          pic s9(7) comp-3.
  1665     02  eibdate          pic s9(7) comp-3.
  1666     02  eibtrnid         pic x(4).
  1667     02  eibtaskn         pic s9(7) comp-3.
  1668     02  eibtrmid         pic x(4).
  1669     02  dfheigdi         pic s9(4) comp.
  1670     02  eibcposn         pic s9(4) comp.
  1671     02  eibcalen         pic s9(4) comp.
  1672     02  eibaid           pic x(1).
  1673     02  eibfiller1       pic x(1).
  1674     02  eibfn            pic x(2).
  1675     02  eibfiller2       pic x(2).
  1676     02  eibrcode         pic x(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6524.cbl
  1677     02  eibfiller3       pic x(2).
  1678     02  eibds            pic x(8).
  1679     02  eibreqid         pic x(8).
  1680     02  eibrsrce         pic x(8).
  1681     02  eibsync          pic x(1).
  1682     02  eibfree          pic x(1).
  1683     02  eibrecv          pic x(1).
  1684     02  eibsend          pic x(1).
  1685     02  eibatt           pic x(1).
  1686     02  eibeoc           pic x(1).
  1687     02  eibfmh           pic x(1).
  1688     02  eibcompl         pic x(1).
  1689     02  eibsig           pic x(1).
  1690     02  eibconf          pic x(1).
  1691     02  eiberr           pic x(1).
  1692     02  eibrldbk         pic x(1).
  1693     02  eiberrcd         pic x(4).
  1694     02  eibsynrb         pic x(1).
  1695     02  eibnodat         pic x(1).
  1696     02  eibfiller5       pic x(2).
  1697     02  eibresp          pic 9(09) comp.
  1698     02  eibresp2         pic 9(09) comp.
  1699     02  dfheigdj         pic s9(4) comp.
  1700     02  dfheigdk         pic s9(4) comp.
  1701 01  DFHCOMMAREA                 PIC X(1024).
  1702*                                COPY ELCCNTL.
  1703******************************************************************
  1704*                                                                *
  1705*                                                                *
  1706*                            ELCCNTL.                            *
  1707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1708*                            VMOD=2.059                          *
  1709*                                                                *
  1710*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1711*                                                                *
  1712*   FILE TYPE = VSAM,KSDS                                        *
  1713*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1714*                                                                *
  1715*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1716*       ALTERNATE INDEX = NONE                                   *
  1717*                                                                *
  1718*   LOG = YES                                                    *
  1719*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1720******************************************************************
  1721*                   C H A N G E   L O G
  1722*
  1723* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1724*-----------------------------------------------------------------
  1725*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1726* EFFECTIVE    NUMBER
  1727*-----------------------------------------------------------------
  1728* 082503                   PEMA  ADD BENEFIT GROUP
  1729* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1730* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1731* 092705    2005050300006  PEMA  ADD SPP LEASES
  1732* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1733* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1734* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6524.cbl
  1735* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1736******************************************************************
  1737*
  1738 01  CONTROL-FILE.
  1739     12  CF-RECORD-ID                       PIC XX.
  1740         88  VALID-CF-ID                        VALUE 'CF'.
  1741
  1742     12  CF-CONTROL-PRIMARY.
  1743         16  CF-COMPANY-ID                  PIC XXX.
  1744         16  CF-RECORD-TYPE                 PIC X.
  1745             88  CF-COMPANY-MASTER              VALUE '1'.
  1746             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1747             88  CF-STATE-MASTER                VALUE '3'.
  1748             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1749             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1750             88  CF-CARRIER-MASTER              VALUE '6'.
  1751             88  CF-MORTALITY-MASTER            VALUE '7'.
  1752             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1753             88  CF-TERMINAL-MASTER             VALUE '9'.
  1754             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1755             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1756             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1757             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1758             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1759             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1760             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1761             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1762             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1763         16  CF-ACCESS-CD-GENL              PIC X(4).
  1764         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1765             20  CF-PROCESSOR               PIC X(4).
  1766         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1767             20  CF-STATE-CODE              PIC XX.
  1768             20  FILLER                     PIC XX.
  1769         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1770             20  FILLER                     PIC XX.
  1771             20  CF-HI-BEN-IN-REC           PIC XX.
  1772         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1773             20  FILLER                     PIC XXX.
  1774             20  CF-CARRIER-CNTL            PIC X.
  1775         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1776             20  FILLER                     PIC XX.
  1777             20  CF-HI-TYPE-IN-REC          PIC 99.
  1778         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1779             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1780                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1781             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1782             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1783         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1784             20  FILLER                     PIC X.
  1785             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1786         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1787             20  FILLER                     PIC XX.
  1788             20  CF-MORTGAGE-PLAN           PIC XX.
  1789         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1790
  1791     12  CF-LAST-MAINT-DT                   PIC XX.
  1792     12  CF-LAST-MAINT-BY                   PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6524.cbl
  1793     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1794
  1795     12  CF-RECORD-BODY                     PIC X(728).
  1796
  1797
  1798****************************************************************
  1799*             COMPANY MASTER RECORD                            *
  1800****************************************************************
  1801
  1802     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1803         16  CF-COMPANY-ADDRESS.
  1804             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1805             20  CF-CL-IN-CARE-OF           PIC X(30).
  1806             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1807             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1808             20  CF-CL-CITY-STATE           PIC X(30).
  1809             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1810             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1811         16  CF-COMPANY-CD                  PIC X.
  1812         16  CF-COMPANY-PASSWORD            PIC X(8).
  1813         16  CF-SECURITY-OPTION             PIC X.
  1814             88  ALL-SECURITY                   VALUE '1'.
  1815             88  COMPANY-VERIFY                 VALUE '2'.
  1816             88  PROCESSOR-VERIFY               VALUE '3'.
  1817             88  NO-SECURITY                    VALUE '4'.
  1818             88  ALL-BUT-TERM                   VALUE '5'.
  1819         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1820             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1821         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1822             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1823         16  CF-INFORCE-LOCATION            PIC X.
  1824             88  CERTS-ARE-ONLINE               VALUE '1'.
  1825             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1826             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1827         16  CF-LOWER-CASE-LETTERS          PIC X.
  1828         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1829             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1830             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1831             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1832             88  CF-ACCNT-CNTL                  VALUE '3'.
  1833             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1834
  1835         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1836         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1837
  1838         16  CF-LGX-CREDIT-USER             PIC X.
  1839             88  CO-IS-NOT-USER                 VALUE 'N'.
  1840             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1841
  1842         16 CF-CREDIT-CALC-CODES.
  1843             20  CF-CR-REM-TERM-CALC PIC X.
  1844               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1845               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1846               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1847               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1848               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1849               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1850               88  CR-EARN-AFTER-16TH           VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6524.cbl
  1851             20  CF-CR-R78-METHOD           PIC X.
  1852               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1853               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1854
  1855         16  CF-CLAIM-CONTROL-COUNTS.
  1856             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1857                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1858
  1859             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1860                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1861
  1862             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1863                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1864
  1865             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1866                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1867
  1868         16  CF-CURRENT-MONTH-END           PIC XX.
  1869
  1870         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1871             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1872             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1873             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1874             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1875                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1876                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1877             20  CF-CO-PREM-REJECT-SW       PIC X.
  1878                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1879                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1880             20  CF-CO-REF-REJECT-SW        PIC X.
  1881                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1882                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1883
  1884         16  CF-CO-REPORTING-DT             PIC XX.
  1885         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1886         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1887           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1888           88  CF-CO-MONTH-END                  VALUE '1'.
  1889
  1890         16  CF-LGX-CLAIM-USER              PIC X.
  1891             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1892             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1893
  1894         16  CF-CREDIT-EDIT-CONTROLS.
  1895             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1896             20  CF-MIN-AGE                 PIC 99.
  1897             20  CF-DEFAULT-AGE             PIC 99.
  1898             20  CF-MIN-TERM                PIC S999      COMP-3.
  1899             20  CF-MAX-TERM                PIC S999      COMP-3.
  1900             20  CF-DEFAULT-SEX             PIC X.
  1901             20  CF-JOINT-AGE-INPUT         PIC X.
  1902                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1903             20  CF-BIRTH-DATE-INPUT        PIC X.
  1904                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1905             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1906                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1907                 88  CF-ZERO-CARRIER            VALUE '1'.
  1908                 88  CF-ZERO-GROUPING           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6524.cbl
  1909                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1910             20  CF-EDIT-SW                 PIC X.
  1911                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1912             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1913             20  CF-CR-PR-METHOD            PIC X.
  1914               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1915               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1916             20  FILLER                     PIC X.
  1917
  1918         16  CF-CREDIT-MISC-CONTROLS.
  1919             20  CF-REIN-TABLE-SW           PIC X.
  1920                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1921             20  CF-COMP-TABLE-SW           PIC X.
  1922                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1923             20  CF-EXPERIENCE-RETENTION-AGE
  1924                                            PIC S9        COMP-3.
  1925             20  CF-CONVERSION-DT           PIC XX.
  1926             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1927             20  CF-RUN-FREQUENCY-SW        PIC X.
  1928                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1929                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1930
  1931             20  CF-CR-CHECK-NO-CONTROL.
  1932                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1933                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1934                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1935                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1936                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1937                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1938
  1939                 24  CF-CR-CHECK-COUNT       REDEFINES
  1940                     CF-CR-CHECK-COUNTER      PIC X(4).
  1941
  1942                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1943                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1944
  1945                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1946                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1947                 24  CF-MAIL-PROCESSING       PIC X.
  1948                     88  MAIL-PROCESSING          VALUE 'Y'.
  1949
  1950         16  CF-MISC-SYSTEM-CONTROL.
  1951             20  CF-SYSTEM-C                 PIC X.
  1952                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1953             20  CF-SYSTEM-D                 PIC X.
  1954                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1955             20  CF-SOC-SEC-NO-SW            PIC X.
  1956                 88  SOC-SEC-NO-USED             VALUE '1'.
  1957             20  CF-MEMBER-NO-SW             PIC X.
  1958                 88  MEMBER-NO-USED              VALUE '1'.
  1959             20  CF-TAX-ID-NUMBER            PIC X(11).
  1960             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1961             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1962                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1963                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1964                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1965                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1966             20  CF-SYSTEM-E                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6524.cbl
  1967                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1968
  1969         16  CF-LGX-LIFE-USER               PIC X.
  1970             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1971             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1972
  1973         16  CF-CR-MONTH-END-DT             PIC XX.
  1974
  1975         16  CF-FILE-MAINT-DATES.
  1976             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1977                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1978             20  CF-LAST-BATCH       REDEFINES
  1979                 CF-LAST-BATCH-NO               PIC X(4).
  1980             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1981             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1982             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1983             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1984             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1985             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1986             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1987             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1988             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1989             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1990
  1991         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1992         16  FILLER                         PIC X.
  1993
  1994         16  CF-ALT-MORT-CODE               PIC X(4).
  1995         16  CF-MEMBER-CAPTION              PIC X(10).
  1996
  1997         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1998             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1999             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2000             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2001             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2002             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2003
  2004         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2005
  2006         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2007         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2008         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2009         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2010
  2011         16  CF-AH-OVERRIDE-L1              PIC X.
  2012         16  CF-AH-OVERRIDE-L2              PIC XX.
  2013         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2014         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2015
  2016         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2017         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2018
  2019         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2020         16  CF-AR-LAST-EL860-DT            PIC XX.
  2021         16  CF-MP-MONTH-END-DT             PIC XX.
  2022
  2023         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2024         16  CF-CLAIM-PAID-THRU-TO          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6524.cbl
  2025             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2026
  2027         16  CF-AR-MONTH-END-DT             PIC XX.
  2028
  2029         16  CF-CRDTCRD-USER                PIC X.
  2030             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2031             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2032
  2033         16  CF-CC-MONTH-END-DT             PIC XX.
  2034
  2035         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2036
  2037         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2038             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2039             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2040             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2041         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2042         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2043         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2044         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2045             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2046             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2047         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2048         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2049         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2050             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2051         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2052
  2053         16  CF-CL-ZIP-CODE.
  2054             20  CF-CL-ZIP-PRIME.
  2055                 24  CF-CL-ZIP-1ST          PIC X.
  2056                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2057                 24  FILLER                 PIC X(4).
  2058             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2059         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2060             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2061             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2062             20  FILLER                     PIC XXX.
  2063
  2064         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2065         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2066         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2067         16  CF-CO-OPTION-START-DATE        PIC XX.
  2068         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2069           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2070                                                      '3' '4'.
  2071           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2072           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2073           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2074           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2075           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2076           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2077
  2078         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2079
  2080         16  CF-PAYMENT-APPROVAL-LEVELS.
  2081             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2082             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6524.cbl
  2083             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2084             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2085             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2086             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2087
  2088         16  CF-END-USER-REPORTING-USER     PIC X.
  2089             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2090             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2091
  2092         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2093             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2094             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2095
  2096         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2097
  2098         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2099         16  FILLER                         PIC X.
  2100
  2101         16  CF-CREDIT-ARCHIVE-CNTL.
  2102             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2103             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2104             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2105
  2106         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2107
  2108         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2109             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2110             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2111
  2112         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2113             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2114             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2115
  2116         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2117
  2118         16  CF-CO-ACH-ID-CODE              PIC  X.
  2119             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2120             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2121             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2122         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2123         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2124         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2125         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2126         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2127         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2128         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2129         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2130         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2131                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2132         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2133                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2134
  2135         16  CF-CO-OVER-SHORT.
  2136             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2137             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2138
  2139*         16  FILLER                         PIC X(102).
  2140         16  CF-PAYMENT-APPROVAL-LEVELS-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6524.cbl
  2141             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2142             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2143
  2144         16  CF-AH-APPROVAL-DAYS.
  2145             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2146             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2147             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2148             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2149
  2150         16  FILLER                         PIC X(82).
  2151****************************************************************
  2152*             PROCESSOR/USER RECORD                            *
  2153****************************************************************
  2154
  2155     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2156         16  CF-PROCESSOR-NAME              PIC X(30).
  2157         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2158         16  CF-PROCESSOR-TITLE             PIC X(26).
  2159         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2160                 88  MESSAGE-YES                VALUE 'Y'.
  2161                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2162
  2163*****************************************************
  2164****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2165****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2166****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2167****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2168*****************************************************
  2169
  2170         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2171             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2172             20  CF-APPLICATION-FORCE       PIC X.
  2173             20  CF-INDIVIDUAL-APP.
  2174                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2175                     28  CF-BROWSE-APP      PIC X.
  2176                     28  CF-UPDATE-APP      PIC X.
  2177
  2178         16  CF-CURRENT-TERM-ON             PIC X(4).
  2179         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2180             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2181             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2182             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2183             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2184             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2185             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2186             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2187         16  CF-PROCESSOR-CARRIER           PIC X.
  2188             88  NO-CARRIER-SECURITY            VALUE ' '.
  2189         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2190             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2191         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2192             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2193         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2194             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2195
  2196         16  CF-PROC-SYS-ACCESS-SW.
  2197             20  CF-PROC-CREDIT-CLAIMS-SW.
  2198                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6524.cbl
  2199                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2200                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2201                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2202             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2203                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2204                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2205             20  CF-PROC-LIFE-GNRLDGR-SW.
  2206                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2207                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2208                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2209                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2210             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2211                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2212                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2213         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2214             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2215             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2216         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2217
  2218         16  CF-APPROVAL-LEVEL                  PIC X.
  2219             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2220             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2221             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2222             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2223
  2224         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2225
  2226         16  CF-LANGUAGE-TYPE                   PIC X.
  2227             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2228             88  CF-LANG-IS-FR                      VALUE 'F'.
  2229         16  FILLER                             PIC  X(240).
  2230
  2231****************************************************************
  2232*             PROCESSOR/REMINDERS RECORD                       *
  2233****************************************************************
  2234
  2235     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2236         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2237             20  CF-START-REMIND-DT         PIC XX.
  2238             20  CF-END-REMIND-DT           PIC XX.
  2239             20  CF-REMINDER-TEXT           PIC X(50).
  2240         16  FILLER                         PIC X(296).
  2241
  2242
  2243****************************************************************
  2244*             STATE MASTER RECORD                              *
  2245****************************************************************
  2246
  2247     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2248         16  CF-STATE-ABBREVIATION          PIC XX.
  2249         16  CF-STATE-NAME                  PIC X(25).
  2250         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2251         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2252             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2253             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2254             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2255             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2256                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6524.cbl
  2257                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2258             20  CF-ST-PREM-REJECT-SW       PIC X.
  2259                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2260                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2261             20  CF-ST-REF-REJECT-SW        PIC X.
  2262                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2263                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2264         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2265         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2266         16  CF-ST-REFUND-RULES.
  2267             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2268             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2269             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2270         16  CF-ST-FST-PMT-EXTENSION.
  2271             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2272             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2273                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2274                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2275                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2276                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2277         16  CF-ST-STATE-CALL.
  2278             20  CF-ST-CALL-UNEARNED        PIC X.
  2279             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2280             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2281         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2282             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2283             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2284         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2285         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2286         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2287         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2288         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2289         16  FILLER                         PIC X.
  2290         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2291             20  CF-ST-BENEFIT-CD           PIC XX.
  2292             20  CF-ST-BENEFIT-KIND         PIC X.
  2293                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2294                 88  CF-ST-AH-KIND              VALUE 'A'.
  2295             20  CF-ST-REM-TERM-CALC        PIC X.
  2296                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2297                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2298                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2299                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2300                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2301                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2302                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2303                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2304
  2305             20  CF-ST-REFUND-CALC          PIC X.
  2306                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2307                 88  ST-REFD-BY-R78             VALUE '1'.
  2308                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2309                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2310                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2311                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2312                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2313                 88  ST-REFD-UTAH               VALUE '7'.
  2314                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6524.cbl
  2315                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2316                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2317
  2318             20  CF-ST-EARNING-CALC         PIC X.
  2319                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2320                 88  ST-EARN-BY-R78             VALUE '1'.
  2321                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2322                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2323                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2324                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2325                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2326                 88  ST-EARN-MEAN               VALUE '8'.
  2327                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2328
  2329             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2330                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2331                 88  ST-OVRD-BY-R78             VALUE '1'.
  2332                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2333                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2334                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2335                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2336                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2337                 88  ST-OVRD-MEAN               VALUE '8'.
  2338                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2339             20  FILLER                     PIC X.
  2340
  2341         16  CF-ST-COMMISSION-CAPS.
  2342             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2343             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2344             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2345             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2346         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2347                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2348
  2349         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2350
  2351         16  CF-ST-STATUTORY-INTEREST.
  2352             20  CF-ST-STAT-DATE-FROM       PIC X.
  2353                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2354                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2355             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2356             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2357             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2358             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2359             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2360
  2361         16  CF-ST-OVER-SHORT.
  2362             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2363             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2364
  2365         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2366
  2367         16  CF-ST-RT-CALC                  PIC X.
  2368
  2369         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2370         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2371         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2372         16  CF-ST-RF-LR-CALC               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6524.cbl
  2373         16  CF-ST-RF-LL-CALC               PIC X.
  2374         16  CF-ST-RF-LN-CALC               PIC X.
  2375         16  CF-ST-RF-AH-CALC               PIC X.
  2376         16  CF-ST-RF-CP-CALC               PIC X.
  2377*        16  FILLER                         PIC X(206).
  2378*CIDMOD         16  FILLER                         PIC X(192).
  2379         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2380             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2381         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2382         16  FILLER                         PIC X(187).
  2383
  2384****************************************************************
  2385*             BENEFIT MASTER RECORD                            *
  2386****************************************************************
  2387
  2388     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2389         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2390             20  CF-BENEFIT-CODE            PIC XX.
  2391             20  CF-BENEFIT-NUMERIC  REDEFINES
  2392                 CF-BENEFIT-CODE            PIC XX.
  2393             20  CF-BENEFIT-ALPHA           PIC XXX.
  2394             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2395             20  CF-BENEFIT-COMMENT         PIC X(10).
  2396
  2397             20  CF-LF-COVERAGE-TYPE        PIC X.
  2398                 88  CF-REDUCING                VALUE 'R'.
  2399                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2400
  2401             20  CF-SPECIAL-CALC-CD         PIC X.
  2402                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2403                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2404                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2405                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2406                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2407                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2408                 88  CF-FARM-PLAN               VALUE 'F'.
  2409                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2410                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2411                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2412                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2413                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2414                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2415                 88  CF-PRUDENTIAL              VALUE 'P'.
  2416                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2417                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2418                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2419                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2420                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2421                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2422
  2423             20  CF-JOINT-INDICATOR         PIC X.
  2424                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2425
  2426*            20  FILLER                     PIC X(12).
  2427             20  FILLER                     PIC X(11).
  2428             20  CF-BENEFIT-CATEGORY        PIC X.
  2429             20  CF-LOAN-TYPE               PIC X(8).
  2430
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6524.cbl
  2431             20  CF-CO-REM-TERM-CALC        PIC X.
  2432                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2433                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2434                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2435                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2436                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2437
  2438             20  CF-CO-EARNINGS-CALC        PIC X.
  2439                 88  CO-EARN-BY-R78             VALUE '1'.
  2440                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2441                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2442                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2443                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2444                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2445                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2446                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2447
  2448             20  CF-CO-REFUND-CALC          PIC X.
  2449                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2450                 88  CO-REFD-BY-R78             VALUE '1'.
  2451                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2452                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2453                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2454                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2455                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2456                 88  CO-REFD-MEAN               VALUE '8'.
  2457                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2458                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2459                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2460
  2461             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2462                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2463                 88  CO-OVRD-BY-R78             VALUE '1'.
  2464                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2465                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2466                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2467                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2468                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2469                 88  CO-OVRD-MEAN               VALUE '8'.
  2470                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2471
  2472             20  CF-CO-BEN-I-G-CD           PIC X.
  2473                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2474                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2475                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2476
  2477         16  FILLER                         PIC X(304).
  2478
  2479
  2480****************************************************************
  2481*             CARRIER MASTER RECORD                            *
  2482****************************************************************
  2483
  2484     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2485         16  CF-ADDRESS-DATA.
  2486             20  CF-MAIL-TO-NAME            PIC X(30).
  2487             20  CF-IN-CARE-OF              PIC X(30).
  2488             20  CF-ADDRESS-LINE-1          PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6524.cbl
  2489             20  CF-ADDRESS-LINE-2          PIC X(30).
  2490             20  CF-CITY-STATE              PIC X(30).
  2491             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2492             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2493
  2494         16  CF-CLAIM-NO-CONTROL.
  2495             20  CF-CLAIM-NO-METHOD         PIC X.
  2496                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2497                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2498                 88  CLAIM-NO-SEQ               VALUE '3'.
  2499                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2500             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2501                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2502                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2503                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2504
  2505         16  CF-CHECK-NO-CONTROL.
  2506             20  CF-CHECK-NO-METHOD         PIC X.
  2507                 88  CHECK-NO-MANUAL            VALUE '1'.
  2508                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2509                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2510                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2511             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2512                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2513
  2514         16  CF-DOMICILE-STATE              PIC XX.
  2515
  2516         16  CF-EXPENSE-CONTROLS.
  2517             20  CF-EXPENSE-METHOD          PIC X.
  2518                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2519                 88  DOLLARS-PER-PMT            VALUE '2'.
  2520                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2521                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2522             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2523             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2524
  2525         16  CF-CORRESPONDENCE-CONTROL.
  2526             20  CF-LETTER-RESEND-OPT       PIC X.
  2527                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2528                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2529             20  FILLER                     PIC X(4).
  2530
  2531         16  CF-RESERVE-CONTROLS.
  2532             20  CF-MANUAL-SW               PIC X.
  2533                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2534             20  CF-FUTURE-SW               PIC X.
  2535                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2536             20  CF-PTC-SW                  PIC X.
  2537                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2538             20  CF-IBNR-SW                 PIC X.
  2539                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2540             20  CF-PTC-LF-SW               PIC X.
  2541                 88  CF-LF-PTC-USED             VALUE '1'.
  2542             20  CF-CDT-ACCESS-METHOD       PIC X.
  2543                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2544                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2545                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2546             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6524.cbl
  2547
  2548         16  CF-CLAIM-CALC-METHOD           PIC X.
  2549             88  360-PLUS-MONTHS                VALUE '1'.
  2550             88  365-PLUS-MONTHS                VALUE '2'.
  2551             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2552             88  360-DAILY                      VALUE '4'.
  2553             88  365-DAILY                      VALUE '5'.
  2554
  2555         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2556         16  FILLER                         PIC X(11).
  2557
  2558         16  CF-LIMIT-AMOUNTS.
  2559             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2560             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2561             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2562             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2563             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2564             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2565             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2566             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2567             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2568             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2569
  2570         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2571         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2572         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2573
  2574         16  CF-ZIP-CODE.
  2575             20  CF-ZIP-PRIME.
  2576                 24  CF-ZIP-1ST             PIC X.
  2577                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2578                 24  FILLER                 PIC X(4).
  2579             20  CF-ZIP-PLUS4               PIC X(4).
  2580         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2581             20  CF-CAN-POSTAL-1            PIC XXX.
  2582             20  CF-CAN-POSTAL-2            PIC XXX.
  2583             20  FILLER                     PIC XXX.
  2584
  2585         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2586         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2587         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2588
  2589         16  CF-RATING-SWITCH               PIC X.
  2590             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2591             88  CF-NO-RATING                   VALUE 'N'.
  2592
  2593         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2594
  2595         16  CF-CARRIER-OVER-SHORT.
  2596             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2597             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2598
  2599         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2600         16  CF-SECPAY-SWITCH               PIC X.
  2601             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2602             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2603         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2604         16  FILLER                         PIC X(448).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6524.cbl
  2605*        16  FILLER                         PIC X(452).
  2606
  2607
  2608****************************************************************
  2609*             MORTALITY MASTER RECORD                          *
  2610****************************************************************
  2611
  2612     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2613         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2614                                INDEXED BY CF-MORT-NDX.
  2615             20  CF-MORT-TABLE              PIC X(5).
  2616             20  CF-MORT-TABLE-TYPE         PIC X.
  2617                 88  CF-MORT-JOINT              VALUE 'J'.
  2618                 88  CF-MORT-SINGLE             VALUE 'S'.
  2619                 88  CF-MORT-COMBINED           VALUE 'C'.
  2620                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2621                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2622             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2623             20  CF-MORT-AGE-METHOD         PIC XX.
  2624                 88  CF-AGE-LAST                VALUE 'AL'.
  2625                 88  CF-AGE-NEAR                VALUE 'AN'.
  2626             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2627             20  CF-MORT-ADJUSTMENT-DIRECTION
  2628                                            PIC X.
  2629                 88  CF-MINUS                   VALUE '-'.
  2630                 88  CF-PLUS                    VALUE '+'.
  2631             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2632             20  CF-MORT-JOINT-CODE         PIC X.
  2633                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2634             20  CF-MORT-PC-Q               PIC X.
  2635                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2636             20  CF-MORT-TABLE-CODE         PIC X(4).
  2637             20  CF-MORT-COMMENTS           PIC X(15).
  2638             20  FILLER                     PIC X(14).
  2639
  2640         16  FILLER                         PIC X(251).
  2641
  2642
  2643****************************************************************
  2644*             BUSSINESS TYPE MASTER RECORD                     *
  2645****************************************************************
  2646
  2647     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2648* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2649* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2650* AND RECORD 05 IS TYPES 81-99
  2651         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2652             20  CF-BUSINESS-TITLE          PIC  X(19).
  2653             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2654                                            PIC S9V9(4) COMP-3.
  2655             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2656             20  FILLER                     PIC  X.
  2657         16  FILLER                         PIC  X(248).
  2658
  2659
  2660****************************************************************
  2661*             TERMINAL MASTER RECORD                           *
  2662****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6524.cbl
  2663
  2664     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2665
  2666         16  CF-COMPANY-TERMINALS.
  2667             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2668                                  PIC X(4).
  2669         16  FILLER               PIC X(248).
  2670
  2671
  2672****************************************************************
  2673*             LIFE EDIT MASTER RECORD                          *
  2674****************************************************************
  2675
  2676     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2677         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2678             20  CF-LIFE-CODE-IN            PIC XX.
  2679             20  CF-LIFE-CODE-OUT           PIC XX.
  2680         16  FILLER                         PIC X(248).
  2681
  2682
  2683****************************************************************
  2684*             AH EDIT MASTER RECORD                            *
  2685****************************************************************
  2686
  2687     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2688         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2689             20  CF-AH-CODE-IN              PIC XXX.
  2690             20  CF-AH-CODE-OUT             PIC XX.
  2691         16  FILLER                         PIC X(248).
  2692
  2693
  2694****************************************************************
  2695*             CREDIBILITY TABLES                               *
  2696****************************************************************
  2697
  2698     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2699         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2700                             INDEXED BY CF-CRDB-NDX.
  2701             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2702             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2703             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2704         16  FILLER                         PIC  X(332).
  2705
  2706
  2707****************************************************************
  2708*             REPORT CUSTOMIZATION RECORD                      *
  2709****************************************************************
  2710
  2711     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2712         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2713             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2714             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2715             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2716**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2717****       A T-TRANSFER.                                   ****
  2718             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2719
  2720         16  FILLER                         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6524.cbl
  2721
  2722         16  CF-CARRIER-CNTL-OPT.
  2723             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2724                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2725                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2726             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2727                                            PIC X.
  2728         16  CF-GROUP-CNTL-OPT.
  2729             20  CF-GROUP-OPT-SEQ           PIC 9.
  2730                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2731                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2732             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2733                                            PIC X(6).
  2734         16  CF-STATE-CNTL-OPT.
  2735             20  CF-STATE-OPT-SEQ           PIC 9.
  2736                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2737                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2738             20  CF-STATE-SELECT OCCURS 3 TIMES
  2739                                            PIC XX.
  2740         16  CF-ACCOUNT-CNTL-OPT.
  2741             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2742                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2743                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2744             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2745                                            PIC X(10).
  2746         16  CF-BUS-TYP-CNTL-OPT.
  2747             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2748                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2749                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2750             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2751                                            PIC XX.
  2752         16  CF-LF-TYP-CNTL-OPT.
  2753             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2754                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2755                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2756             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2757                                            PIC XX.
  2758         16  CF-AH-TYP-CNTL-OPT.
  2759             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2760                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2761                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2762             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2763                                            PIC XX.
  2764         16  CF-REPTCD1-CNTL-OPT.
  2765             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2766                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2767                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2768             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2769                                            PIC X(10).
  2770         16  CF-REPTCD2-CNTL-OPT.
  2771             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2772                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2773                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2774             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2775                                            PIC X(10).
  2776         16  CF-USER1-CNTL-OPT.
  2777             20  CF-USER1-OPT-SEQ           PIC 9.
  2778                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6524.cbl
  2779                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2780             20  CF-USER1-SELECT OCCURS 3 TIMES
  2781                                            PIC X(10).
  2782         16  CF-USER2-CNTL-OPT.
  2783             20  CF-USER2-OPT-SEQ           PIC 9.
  2784                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2785                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2786             20  CF-USER2-SELECT OCCURS 3 TIMES
  2787                                            PIC X(10).
  2788         16  CF-USER3-CNTL-OPT.
  2789             20  CF-USER3-OPT-SEQ           PIC 9.
  2790                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2791                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2792             20  CF-USER3-SELECT OCCURS 3 TIMES
  2793                                            PIC X(10).
  2794         16  CF-USER4-CNTL-OPT.
  2795             20  CF-USER4-OPT-SEQ           PIC 9.
  2796                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2797                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2798             20  CF-USER4-SELECT OCCURS 3 TIMES
  2799                                            PIC X(10).
  2800         16  CF-USER5-CNTL-OPT.
  2801             20  CF-USER5-OPT-SEQ           PIC 9.
  2802                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2803                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2804             20  CF-USER5-SELECT OCCURS 3 TIMES
  2805                                            PIC X(10).
  2806         16  CF-REINS-CNTL-OPT.
  2807             20  CF-REINS-OPT-SEQ           PIC 9.
  2808                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2809                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2810             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2811                 24  CF-REINS-PRIME         PIC XXX.
  2812                 24  CF-REINS-SUB           PIC XXX.
  2813
  2814         16  CF-AGENT-CNTL-OPT.
  2815             20  CF-AGENT-OPT-SEQ           PIC 9.
  2816                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2817                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2818             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2819                                            PIC X(10).
  2820
  2821         16  FILLER                         PIC X(43).
  2822
  2823         16  CF-LOSS-RATIO-SELECT.
  2824             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2825             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2826         16  CF-ENTRY-DATE-SELECT.
  2827             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2828             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2829         16  CF-EFFECTIVE-DATE-SELECT.
  2830             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2831             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2832
  2833         16  CF-EXCEPTION-LIST-IND          PIC X.
  2834             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2835
  2836         16  FILLER                         PIC X(318).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6524.cbl
  2837
  2838****************************************************************
  2839*                  EXCEPTION REPORTING RECORD                  *
  2840****************************************************************
  2841
  2842     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2843         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2844             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2845
  2846         16  CF-COMBINED-LIFE-AH-OPT.
  2847             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2848             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2849             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2850             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2851
  2852         16  CF-LIFE-OPT.
  2853             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2854             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2855             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2856             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2857             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2858             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2859             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2860             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2861             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2862             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2863
  2864         16  CF-AH-OPT.
  2865             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2866             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2867             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2868             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2869             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2870             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2871             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2872             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2873             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2874             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2875
  2876         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2877             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2878             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2879             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2880
  2881         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2882
  2883         16  FILLER                         PIC X(673).
  2884
  2885
  2886****************************************************************
  2887*             MORTGAGE SYSTEM PLAN RECORD                      *
  2888****************************************************************
  2889
  2890     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2891         16  CF-PLAN-TYPE                   PIC X.
  2892             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2893             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2894             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6524.cbl
  2895         16  CF-PLAN-ABBREV                 PIC XXX.
  2896         16  CF-PLAN-DESCRIPT               PIC X(10).
  2897         16  CF-PLAN-NOTES                  PIC X(20).
  2898         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2899         16  CF-PLAN-UNDERWRITING.
  2900             20  CF-PLAN-TERM-DATA.
  2901                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2902                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2903             20  CF-PLAN-AGE-DATA.
  2904                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2905                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2906                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2907             20  CF-PLAN-BENEFIT-DATA.
  2908                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2909                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2910                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2911                                            PIC S9(7)V99  COMP-3.
  2912         16  CF-PLAN-POLICY-FORMS.
  2913             20  CF-POLICY-FORM             PIC X(12).
  2914             20  CF-MASTER-APPLICATION      PIC X(12).
  2915             20  CF-MASTER-POLICY           PIC X(12).
  2916         16  CF-PLAN-RATING.
  2917             20  CF-RATE-CODE               PIC X(5).
  2918             20  CF-SEX-RATING              PIC X.
  2919                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2920                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2921             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2922             20  CF-SUB-STD-TYPE            PIC X.
  2923                 88  CF-PCT-OF-PREM            VALUE '1'.
  2924                 88  CF-PCT-OF-BENE            VALUE '2'.
  2925         16  CF-PLAN-PREM-TOLERANCES.
  2926             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2927             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2928         16  CF-PLAN-PYMT-TOLERANCES.
  2929             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2930             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2931         16  CF-PLAN-MISC-DATA.
  2932             20  FILLER                     PIC X.
  2933             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2934             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2935         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2936         16  CF-PLAN-IND-GRP                PIC X.
  2937             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2938                                                     '1'.
  2939             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2940                                                     '2'.
  2941         16  CF-MIB-SEARCH-SW               PIC X.
  2942             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2943             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2944             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2945             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2946         16  CF-ALPHA-SEARCH-SW             PIC X.
  2947             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2948             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2949             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2950             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2951             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2952             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6524.cbl
  2953             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2954             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2955             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2956             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2957                                                     'A' 'B' 'C'
  2958                                                     'X' 'Y' 'Z'.
  2959         16  CF-EFF-DT-RULE-SW              PIC X.
  2960             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2961             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2962             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2963             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2964             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2965         16  FILLER                         PIC X(4).
  2966         16  CF-HEALTH-QUESTIONS            PIC X.
  2967             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2968         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2969         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2970         16  CF-PLAN-SNGL-JNT               PIC X.
  2971             88  CF-COMBINED-PLAN              VALUE 'C'.
  2972             88  CF-JNT-PLAN                   VALUE 'J'.
  2973             88  CF-SNGL-PLAN                  VALUE 'S'.
  2974         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2975         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2976         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2977         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2978         16  CF-RERATE-CNTL                 PIC  X.
  2979             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2980             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2981             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2982             88  CF-AUTO-RECALC                 VALUE '4'.
  2983         16  CF-BENEFIT-TYPE                PIC  X.
  2984             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2985             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2986         16  CF-POLICY-FEE                  PIC S999V99
  2987                                                    COMP-3.
  2988         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2989         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2990         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2991         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2992         16  FILLER                         PIC  X(32).
  2993         16  CF-TERMINATION-FORM            PIC  X(04).
  2994         16  FILLER                         PIC  X(08).
  2995         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2996                                                       COMP-3.
  2997         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2998         16  CF-ISSUE-LETTER                PIC  X(4).
  2999         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3000         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3001             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3002             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3003         16  CF-MP-REFUND-CALC              PIC X.
  3004             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3005             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3006             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3007             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3008             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3009             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3010             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6524.cbl
  3011             88  CF-MP-REFD-MEAN                VALUE '8'.
  3012         16  CF-ALT-RATE-CODE               PIC  X(5).
  3013
  3014
  3015         16  FILLER                         PIC X(498).
  3016****************************************************************
  3017*             MORTGAGE COMPANY MASTER RECORD                   *
  3018****************************************************************
  3019
  3020     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3021         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3022         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3023             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3024             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3025             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3026             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3027             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3028
  3029         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3030         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3031         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3032         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3033         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3034
  3035         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3036             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3037         16  CF-MP-RECON-USE-IND            PIC X(1).
  3038             88  CF-MP-USE-RECON             VALUE 'Y'.
  3039         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3040             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3041         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3042             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3043             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3044         16  FILLER                         PIC X(1).
  3045         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3046             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3047         16  CF-MORTG-MIB-VERSION           PIC X.
  3048             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3049             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3050             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3051         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3052             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3053                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3054             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3055                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3056             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3057                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3058             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3059                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3060             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3061                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3062             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3063                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3064         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3065         16  FILLER                         PIC X(7).
  3066         16  CF-MORTG-DESTINATION-SYMBOL.
  3067             20  CF-MORTG-MIB-COMM          PIC X(5).
  3068             20  CF-MORTG-MIB-TERM          PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6524.cbl
  3069         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3070             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3071         16  FILLER                         PIC X(03).
  3072         16  CF-MP-CHECK-NO-CONTROL.
  3073             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3074                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3075                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3076                                                ' ' LOW-VALUES.
  3077                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3078                                               VALUE '3'.
  3079         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3080         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3081         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3082             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3083                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3084             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3085                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3086             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3087                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3088             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3089                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3090             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3091                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3092             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3093                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3094         16  CF-MORTG-BILLING-AREA.
  3095             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3096                                            PIC X.
  3097         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3098         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3099         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3100         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3101             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3102             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3103         16  FILLER                         PIC X.
  3104         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3105             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3106             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3107         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3108         16  FILLER                         PIC X(8).
  3109         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3110         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3111         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3112         16  CF-ACH-COMPANY-ID.
  3113             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3114                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3115                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3116                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3117             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3118         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3119             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3120         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3121             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3122             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3123         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3124         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3125         16  FILLER                         PIC X(536).
  3126
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6524.cbl
  3127****************************************************************
  3128*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3129****************************************************************
  3130
  3131     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3132         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3133             20  CF-FEMALE-HEIGHT.
  3134                 24  CF-FEMALE-FT           PIC 99.
  3135                 24  CF-FEMALE-IN           PIC 99.
  3136             20  CF-FEMALE-MIN-WT           PIC 999.
  3137             20  CF-FEMALE-MAX-WT           PIC 999.
  3138         16  FILLER                         PIC X(428).
  3139
  3140     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3141         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3142             20  CF-MALE-HEIGHT.
  3143                 24  CF-MALE-FT             PIC 99.
  3144                 24  CF-MALE-IN             PIC 99.
  3145             20  CF-MALE-MIN-WT             PIC 999.
  3146             20  CF-MALE-MAX-WT             PIC 999.
  3147         16  FILLER                         PIC X(428).
  3148******************************************************************
  3149*             AUTOMATIC ACTIVITY RECORD                          *
  3150******************************************************************
  3151     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3152         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3153             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3154             20  CF-SYS-LETTER-ID           PIC X(04).
  3155             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3156             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3157             20  CF-SYS-RESET-SW            PIC X(01).
  3158             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3159             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3160
  3161         16  FILLER                         PIC X(50).
  3162
  3163         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3164             20  CF-USER-ACTIVE-SW          PIC X(01).
  3165             20  CF-USER-LETTER-ID          PIC X(04).
  3166             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3167             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3168             20  CF-USER-RESET-SW           PIC X(01).
  3169             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3170             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3171             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3172
  3173         16  FILLER                         PIC X(246).
  3174*                                COPY ERCAGTC.
  3175******************************************************************
  3176*                                                                *
  3177*                                                                *
  3178*                            ERCAGTC                             *
  3179*                            VMOD=2.001                          *
  3180*                                                                *
  3181*   ONLINE CREDIT SYSTEM                                         *
  3182*                                                                *
  3183*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  3184*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6524.cbl
  3185*   FILE TYPE = VSAM,KSDS                                        *
  3186*   RECORD SIZE = 450   RECFORM = FIXED                          *
  3187*                                                                *
  3188*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  3189*       ALTERNATE PATH = NONE                                    *
  3190*                                                                *
  3191*   LOG = NO                                                     *
  3192*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3193*                                                                *
  3194******************************************************************
  3195*                   C H A N G E   L O G
  3196*
  3197* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3198*-----------------------------------------------------------------
  3199*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3200* EFFECTIVE    NUMBER
  3201*-----------------------------------------------------------------
  3202* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  3203* 111004                         NEW FILE AND COPYBOOK
  3204* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  3205******************************************************************
  3206 01  AGENT-COMMISSIONS.
  3207     12  AG-RECORD-ID                          PIC XX.
  3208         88  VALID-CO-ID                          VALUE 'AG'.
  3209     12  AG-CONTROL-PRIMARY.
  3210         16  AG-COMPANY-CD                     PIC X.
  3211         16  AG-CONTROL.
  3212             20  AG-CTL-1.
  3213                 24  AG-CARR-GROUP.
  3214                     28  AG-CARRIER            PIC X.
  3215                     28  AG-GROUPING           PIC X(6).
  3216                 24  AG-BANK                   PIC X(10).
  3217             20  AG-CTL-2.
  3218                 24  AG-EXP-DT                 PIC XX.
  3219         16  AG-TYPE                           PIC X.
  3220             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  3221             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  3222     12  AG-MAINT-INFORMATION.
  3223         16  AG-LAST-MAINT-DT                  PIC XX.
  3224         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  3225         16  AG-LAST-MAINT-USER                PIC X(4).
  3226         16  FILLER                            PIC X(10).
  3227     12  AG-EFF-DT                             PIC XX.
  3228     12  AG-COMM-STRUCTURE.
  3229         16  AG-AGT-COMMS OCCURS 10.
  3230             20  AG-AGT                PIC X(10).
  3231             20  AG-COM-TYP            PIC X.
  3232             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  3233             20  AG-RECALC-LV-INDIC    PIC X.
  3234             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  3235             20  AG-LRCALC-LV-INDIC    PIC X.
  3236             20  FILLER                PIC X(05).
  3237     12  FILLER                  PIC X(145).
  3238******************************************************************
  3239*                                COPY ERCCOMP.
  3240******************************************************************
  3241*                                                                *
  3242*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6524.cbl
  3243*                            ERCCOMP                             *
  3244*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3245*                            VMOD=2.019                          *
  3246*                                                                *
  3247*   ONLINE CREDIT SYSTEM                                         *
  3248*                                                                *
  3249*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  3250*                                                                *
  3251*   FILE TYPE = VSAM,KSDS                                        *
  3252*   RECORD SIZE = 700   RECFORM = FIXED                          *
  3253*                                                                *
  3254*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  3255*       ALTERNATE PATH = NONE                                    *
  3256*                                                                *
  3257*   LOG = NO                                                     *
  3258*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3259*                                                                *
  3260******************************************************************
  3261*                   C H A N G E   L O G
  3262*
  3263* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3264*-----------------------------------------------------------------
  3265*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3266* EFFECTIVE    NUMBER
  3267*-----------------------------------------------------------------
  3268* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3269* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  3270* 092205    2005050300006  PEMA  ADD LEASE FEE
  3271* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  3272* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  3273* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  3274* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3275* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  3276******************************************************************
  3277
  3278 01  COMPENSATION-MASTER.
  3279     12  CO-RECORD-ID                          PIC XX.
  3280         88  VALID-CO-ID                          VALUE 'CO'.
  3281
  3282     12  CO-CONTROL-PRIMARY.
  3283         16  CO-COMPANY-CD                     PIC X.
  3284         16  CO-CONTROL.
  3285             20  CO-CTL-1.
  3286                 24  CO-CARR-GROUP.
  3287                     28  CO-CARRIER            PIC X.
  3288                     28  CO-GROUPING.
  3289                         32  CO-GROUP-PREFIX   PIC XXX.
  3290                         32  CO-GROUP-PRIME    PIC XXX.
  3291                 24  CO-RESP-NO.
  3292                     28  CO-RESP-PREFIX        PIC X(4).
  3293                     28  CO-RESP-PRIME         PIC X(6).
  3294             20  CO-CTL-2.
  3295                 24  CO-ACCOUNT.
  3296                     28  CO-ACCT-PREFIX        PIC X(4).
  3297                     28  CO-ACCT-PRIME         PIC X(6).
  3298         16  CO-TYPE                           PIC X.
  3299             88  CO-COMPANY-TYPE                  VALUE 'C'.
  3300             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6524.cbl
  3301             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  3302
  3303     12  CO-MAINT-INFORMATION.
  3304         16  CO-LAST-MAINT-DT                  PIC XX.
  3305         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  3306         16  CO-LAST-MAINT-USER                PIC X(4).
  3307     12  FILLER                                PIC XX.
  3308     12  CO-STMT-TYPE                          PIC XXX.
  3309     12  CO-COMP-TYPE                          PIC X.
  3310         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  3311     12  CO-STMT-OWNER                         PIC X(4).
  3312     12  CO-BALANCE-CONTROL                    PIC X.
  3313         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  3314         88  CO-NO-BALANCE                        VALUE 'N'.
  3315
  3316     12  CO-INTERNAL-CONTROL-1                 PIC X.
  3317         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  3318         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  3319         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  3320
  3321     12  CO-INTERNAL-CONTROL-2                 PIC X.
  3322         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  3323         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  3324
  3325     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  3326     12  CO-GA-DIRECT-DEP                      PIC X.
  3327     12  CO-FUTURE-SPACE                       PIC X.
  3328         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  3329
  3330     12  CO-ACCT-NAME                          PIC X(30).
  3331     12  CO-MAIL-NAME                          PIC X(30).
  3332     12  CO-ADDR-1                             PIC X(30).
  3333     12  CO-ADDR-2                             PIC X(30).
  3334     12  CO-ADDR-3.
  3335         16  CO-ADDR-CITY                      PIC X(27).
  3336         16  CO-ADDR-STATE                     PIC XX.
  3337     12  CO-CSO-1099                           PIC X.
  3338     12  CO-ZIP.
  3339         16  CO-ZIP-PRIME.
  3340             20  CO-ZIP-PRI-1ST                PIC X.
  3341                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3342             20  FILLER                        PIC X(4).
  3343         16  CO-ZIP-PLUS4                      PIC X(4).
  3344     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  3345         16  CO-CAN-POSTAL-1                   PIC XXX.
  3346         16  CO-CAN-POSTAL-2                   PIC XXX.
  3347         16  FILLER                            PIC XXX.
  3348     12  CO-SOC-SEC                            PIC X(13).
  3349     12  CO-TELEPHONE.
  3350         16  CO-AREA-CODE                      PIC XXX.
  3351         16  CO-PREFIX                         PIC XXX.
  3352         16  CO-PHONE                          PIC X(4).
  3353
  3354     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  3355
  3356     12  CO-AR-BAL-LEVEL                       PIC X.
  3357         88  CO-AR-REF-LVL                        VALUE '1'.
  3358         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6524.cbl
  3359         88  CO-AR-BILL-LVL                       VALUE '2'.
  3360         88  CO-AR-AGT-LVL                        VALUE '3'.
  3361         88  CO-AR-FR-LVL                         VALUE '4'.
  3362
  3363     12  CO-AR-NORMAL-PRINT                    PIC X.
  3364         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  3365         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  3366
  3367     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  3368
  3369     12  CO-AR-REPORTING                       PIC X.
  3370         88  CO-AR-NET-REPORT                     VALUE 'N'.
  3371         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  3372
  3373     12  CO-AR-PULL-CHECK                      PIC X.
  3374         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  3375         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  3376
  3377     12  CO-AR-BALANCE-PRINT                   PIC X.
  3378         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  3379
  3380     12  CO-AR-LAST-RUN-CODE                   PIC X.
  3381         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  3382         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  3383         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  3384
  3385     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  3386
  3387     12  CO-USER-CODE                          PIC X.
  3388     12  CO-REPORT-GROUP-ID                    PIC X(12).
  3389
  3390******************************************************************
  3391*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  3392*    THE LAST MONTH END RUN.
  3393******************************************************************
  3394
  3395     12  CO-LAST-ACTIVITY-DATE.
  3396         16  CO-ACT-YEAR                       PIC 99.
  3397         16  CO-ACT-MONTH                      PIC 99.
  3398         16  CO-ACT-DAY                        PIC 99.
  3399
  3400     12  CO-LAST-STMT-DT.
  3401         16  CO-LAST-STMT-YEAR                 PIC 99.
  3402         16  CO-LAST-STMT-MONTH                PIC 99.
  3403         16  CO-LAST-STMT-DAY                  PIC 99.
  3404
  3405     12  CO-MO-END-TOTALS.
  3406         16  CO-MONTHLY-TOTALS.
  3407             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  3408             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  3409             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  3410             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  3411             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  3412
  3413         16  CO-AGING-TOTALS.
  3414             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  3415             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  3416             20  CO-OV60                   PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6524.cbl
  3417             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  3418
  3419         16  CO-YTD-TOTALS.
  3420             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  3421             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  3422
  3423         16  CO-OVER-UNDER-TOTALS.
  3424             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  3425             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  3426
  3427     12  CO-MISCELLANEOUS-TOTALS.
  3428         16  CO-FICA-TOTALS.
  3429             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  3430             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  3431
  3432         16  CO-CLAIM-TOTALS.
  3433             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  3434             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  3435
  3436******************************************************************
  3437*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  3438*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  3439******************************************************************
  3440
  3441     12  CO-CURRENT-TOTALS.
  3442         16  CO-CURRENT-LAST-STMT-DT.
  3443             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  3444             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  3445             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  3446
  3447         16  CO-CURRENT-MONTHLY-TOTALS.
  3448             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  3449             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  3450             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  3451             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  3452             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  3453
  3454         16  CO-CURRENT-AGING-TOTALS.
  3455             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  3456             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  3457             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  3458             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  3459
  3460         16  CO-CURRENT-YTD-TOTALS.
  3461             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  3462             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  3463
  3464     12  CO-PAID-COMM-TOTALS.
  3465         16  CO-YTD-PAID-COMMS.
  3466             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  3467             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  3468
  3469     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  3470         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  3471         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  3472
  3473     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  3474         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6524.cbl
  3475         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  3476         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  3477         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  3478         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  3479         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  3480         88  CO-FINAL-LETTER                  VALUE 'F'.
  3481         88  CO-RECONCILING                   VALUE 'R'.
  3482         88  CO-PHONE-CALL                    VALUE 'P'.
  3483         88  CO-LEGAL                         VALUE 'L'.
  3484         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  3485         88  CO-WRITE-OFF                     VALUE 'W'.
  3486         88  CO-NO-ACTION                     VALUE 'N' ' '.
  3487
  3488     12  CO-CSR-CODE                       PIC X(4).
  3489
  3490     12  CO-GA-STATUS-INFO.
  3491         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3492         16  CO-GA-TERMINATION-DT          PIC XX.
  3493         16  CO-GA-STATUS-CODE             PIC X.
  3494             88  CO-GA-ACTIVE                 VALUE 'A'.
  3495             88  CO-GA-INACTIVE               VALUE 'I'.
  3496             88  CO-GA-PENDING                VALUE 'P'.
  3497         16  CO-GA-COMMENTS.
  3498             20  CO-GA-COMMENT-1           PIC X(40).
  3499             20  CO-GA-COMMENT-2           PIC X(40).
  3500             20  CO-GA-COMMENT-3           PIC X(40).
  3501             20  CO-GA-COMMENT-4           PIC X(40).
  3502
  3503     12  CO-RPTCD2                         PIC X(10).
  3504
  3505     12  CO-TYPE-AGENT                     PIC X(01).
  3506         88  CO-CORPORATION                   VALUE 'C'.
  3507         88  CO-PARTNERSHIP                   VALUE 'P'.
  3508         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3509         88  CO-TRUST                         VALUE 'T'.
  3510         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3511
  3512     12  CO-FAXNO.
  3513         16  CO-FAX-AREA-CODE                  PIC XXX.
  3514         16  CO-FAX-PREFIX                     PIC XXX.
  3515         16  CO-FAX-PHONE                      PIC X(4).
  3516
  3517     12  CO-BANK-INFORMATION.
  3518         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3519         16  CO-BANK-TRANSIT-NON REDEFINES
  3520             CO-BANK-TRANSIT-NO                PIC 9(8).
  3521
  3522         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3523     12  CO-MISC-DEDUCT-INFO REDEFINES
  3524                  CO-BANK-INFORMATION.
  3525         16  CO-MD-GL-ACCT                     PIC X(10).
  3526         16  CO-MD-DIV                         PIC XX.
  3527         16  CO-MD-CENTER                      PIC X(4).
  3528         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  3529         16  CO-CREATE-AP-CHECK                PIC X.
  3530         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3531         16  FILLER                            PIC XXX.
  3532     12  CO-ACH-STATUS                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6524.cbl
  3533         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3534         88  CO-ACH-PENDING                        VALUE 'P'.
  3535
  3536     12  CO-BILL-SW                            PIC X.
  3537     12  CO-CONTROL-NAME                       PIC X(30).
  3538     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3539     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3540     12  CO-CLP-STATE                          PIC XX.
  3541     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3542     12  CO-SPP-REFUND-EDIT                    PIC X.
  3543
  3544******************************************************************
  3545 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  3546                          AGENT-COMMISSIONS COMPENSATION-MASTER.
  3547 0000-DFHEXIT SECTION.
  3548     MOVE '9#                    $   ' TO DFHEIV0.
  3549     MOVE 'EL6524' TO DFHEIV1.
  3550     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3551     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  3552     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  3553     MOVE '5'                   TO DC-OPTION-CODE.
  3554     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  3555     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  3556     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  3557     MOVE EIBTRMID              TO QID-TERM.
  3558
  3559* EXEC CICS HANDLE CONDITION
  3560*        ERROR     (9990-ABEND)
  3561*        MAPFAIL   (8100-SEND-INITIAL-MAP)
  3562*    END-EXEC.
  3563*    MOVE '"$.?                  ! " #00003554' TO DFHEIV0
  3564     MOVE X'22242E3F2020202020202020' TO DFHEIV0(1:12)
  3565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3566     MOVE X'2220233030303033353534' TO DFHEIV0(25:11)
  3567     CALL 'kxdfhei1' USING DFHEIV0
  3568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3569
  3570     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3571         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3572*  THIS IS THE FIRST TIME THRU
  3573             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3574             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3575             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3576             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3577             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3578             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3579             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3580             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3581             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  3582         ELSE
  3583* THIS IS WHEN I COME BACK FROM WHERE I XCTL'D TO
  3584             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  3585             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3586             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3587             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3588             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3589             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3590             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6524.cbl
  3591             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  3592         END-IF
  3593* ALL SUBSEQUENT TIMES
  3594     END-IF
  3595     IF EIBTRNID = TRANS-ID
  3596         IF EIBAID = DFHCLEAR
  3597             GO TO 9400-CLEAR
  3598         ELSE
  3599             GO TO 0200-RECEIVE-MAP.
  3600     IF EIBTRNID  = EL652-TRANS-ID
  3601* THIS IS WHEN I COME FROM COMP MAINT
  3602         MOVE DFHENTER       TO EIBAID
  3603         MOVE PI-CR-CARRIER  TO CARRIERI
  3604         MOVE PI-CR-GROUPING TO GROUPI
  3605         MOVE PI-CR-FIN-RESP TO BANKI
  3606         MOVE PI-CR-TYPE     TO TYPEI
  3607         MOVE 'S'            TO MAINTYPI
  3608         MOVE 1              TO CARRIERL
  3609         MOVE 6              TO GROUPL
  3610         MOVE 10             TO BANKL
  3611         MOVE 1              TO TYPEL
  3612         MOVE 1              TO MAINTYPL
  3613         MOVE AL-UANON       TO CARRIERA GROUPA TYPEA
  3614                                BANKA MAINTYPA
  3615         GO TO 4000-EDIT-MAINT
  3616     END-IF
  3617     MOVE LOW-VALUES       TO PI-ERAGTC-KEY    EL652EI.
  3618     MOVE PI-COMPANY-CD    TO PI-AGTC-COMP-CD  WS-COMPANY-CD.
  3619     IF EIBTRNID  = EL650-TRANS-ID
  3620* THIS IS WHEN I CAME FROM ACCOUNT MAINT
  3621         GO TO 0600-RECOVER-TEMP-STORAGE.
  3622     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6524.cbl
  3624 0200-RECEIVE-MAP.
  3625     MOVE LOW-VALUES             TO EL652EI
  3626
  3627* EXEC CICS RECEIVE
  3628*        MAP (MAP-NAME)
  3629*        MAPSET (MAPSET-NAME)
  3630*        INTO (EL652EI)
  3631*    END-EXEC
  3632     MOVE LENGTH OF
  3633      EL652EI
  3634       TO DFHEIV11
  3635*    MOVE '8"T I  L              ''   #00003614' TO DFHEIV0
  3636     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3637     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3638     MOVE X'2020233030303033363134' TO DFHEIV0(25:11)
  3639     CALL 'kxdfhei1' USING DFHEIV0,
  3640           MAP-NAME,
  3641           EL652EI,
  3642           DFHEIV11,
  3643           MAPSET-NAME,
  3644           DFHEIV99,
  3645           DFHEIV99
  3646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3647     IF PFENTERL = 0
  3648        GO TO 0300-CHECK-PFKEYS
  3649     END-IF
  3650     IF EIBAID NOT = DFHENTER
  3651        MOVE ER-0004             TO EMI-ERROR
  3652        GO TO 0320-INPUT-ERROR
  3653     END-IF
  3654     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  3655        MOVE PF-VALUES (PFENTERI)
  3656                                 TO EIBAID
  3657     ELSE
  3658        MOVE ER-0029             TO EMI-ERROR
  3659        GO TO 0320-INPUT-ERROR
  3660     END-IF
  3661     .
  3662 0300-CHECK-PFKEYS.
  3663     IF EIBAID = DFHPF23
  3664         GO TO 8810-PF23.
  3665     IF EIBAID = DFHPF24
  3666         GO TO 9200-RETURN-MAIN-MENU.
  3667     IF EIBAID = DFHPF12
  3668         GO TO 9500-PF12.
  3669     IF EIBAID = DFHPF1 OR DFHPF2
  3670        GO TO 5000-BROWSE-FILE
  3671*       GO TO 4000-EDIT-MAINT
  3672     END-IF
  3673     IF EIBAID = DFHENTER
  3674        GO TO 4000-EDIT-MAINT
  3675     END-IF
  3676     MOVE ER-0029                TO EMI-ERROR
  3677     .
  3678 0320-INPUT-ERROR.
  3679     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3680     MOVE -1                     TO CARRIERL.
  3681     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6524.cbl
  3683 0500-CREATE-TEMP-STORAGE.
  3684
  3685* EXEC CICS WRITEQ TS
  3686*        QUEUE   (QID)
  3687*        FROM    (EL652EI)
  3688*        LENGTH  (QID-MAP-LENGTH)
  3689*        END-EXEC.
  3690*    MOVE '*"                    ''   #00003656' TO DFHEIV0
  3691     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  3692     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3693     MOVE X'2020233030303033363536' TO DFHEIV0(25:11)
  3694     CALL 'kxdfhei1' USING DFHEIV0,
  3695           QID,
  3696           EL652EI,
  3697           QID-MAP-LENGTH,
  3698           DFHEIV99,
  3699           DFHEIV99,
  3700           DFHEIV99
  3701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3702
  3703 0599-EXIT.
  3704      EXIT.
  3705 0600-RECOVER-TEMP-STORAGE.
  3706
  3707* EXEC CICS HANDLE CONDITION
  3708*        NOTFND  (1500-AGTC-NOT-FOUND)
  3709*        QIDERR  (0690-QIDERR)
  3710*        END-EXEC.
  3711*    MOVE '"$IN                  ! # #00003664' TO DFHEIV0
  3712     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  3713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3714     MOVE X'2320233030303033363634' TO DFHEIV0(25:11)
  3715     CALL 'kxdfhei1' USING DFHEIV0
  3716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3717
  3718
  3719* EXEC CICS READQ TS
  3720*        QUEUE    (QID)
  3721*        INTO     (EL652EI)
  3722*        LENGTH   (QID-MAP-LENGTH)
  3723*        END-EXEC.
  3724*    MOVE '*$I    L              ''   #00003668' TO DFHEIV0
  3725     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3726     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3727     MOVE X'2020233030303033363638' TO DFHEIV0(25:11)
  3728     CALL 'kxdfhei1' USING DFHEIV0,
  3729           QID,
  3730           EL652EI,
  3731           QID-MAP-LENGTH,
  3732           DFHEIV99,
  3733           DFHEIV99,
  3734           DFHEIV99
  3735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3736
  3737
  3738* EXEC CICS DELETEQ TS
  3739*        QUEUE   (QID)
  3740*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6524.cbl
  3741*    MOVE '*&                    #   #00003673' TO DFHEIV0
  3742     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3743     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3744     MOVE X'2020233030303033363733' TO DFHEIV0(25:11)
  3745     CALL 'kxdfhei1' USING DFHEIV0,
  3746           QID,
  3747           DFHEIV99
  3748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3749     IF CARRIERL NOT = 0
  3750         MOVE AL-UANON TO CARRIERA.
  3751     IF GROUPL NOT = 0
  3752         MOVE AL-UANON TO GROUPA.
  3753     IF BANKL NOT = 0
  3754         MOVE AL-UANON TO BANKA
  3755     END-IF
  3756     IF TYPEL NOT = 0
  3757         MOVE AL-UANON           TO TYPEA
  3758     END-IF
  3759     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  3760     MOVE CARRIERO               TO WS-CARRIER
  3761     MOVE GROUPO                 TO WS-GROUP
  3762     MOVE BANKO                  TO WS-BANK
  3763     MOVE TYPEO                  TO WS-TYPE
  3764     GO TO 1050-READ-AGTC.
  3765 0690-QIDERR.
  3766     MOVE ER-0033                TO EMI-ERROR
  3767     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  3768     GO TO 8100-SEND-INITIAL-MAP
  3769     .
  3770 4000-EDIT-MAINT.
  3771     IF MAINTYPL > ZERO
  3772        MOVE MAINTYPI            TO PI-CHECK-MAINT-TYPE
  3773        IF VALID-MAINT-TYPE
  3774           MOVE AL-UANON         TO MAINTYPA
  3775        ELSE
  3776           MOVE -1               TO MAINTYPL
  3777           MOVE AL-UABON         TO MAINTYPA
  3778           MOVE ER-2039          TO EMI-ERROR
  3779           PERFORM 9900-ERROR-FORMAT
  3780                                 THRU  9900-EXIT
  3781        END-IF
  3782     ELSE
  3783        MOVE -1                  TO MAINTYPL
  3784        MOVE AL-UABON            TO MAINTYPA
  3785        MOVE ER-2039             TO EMI-ERROR
  3786        PERFORM 9900-ERROR-FORMAT
  3787                                 THRU 9900-EXIT
  3788     END-IF
  3789     MOVE PI-COMPANY-CD          TO PI-ERC-COMPANY-CD
  3790     IF (NOT MODIFY-CAP)
  3791        AND (NOT SHOW-FUNCTION)
  3792        MOVE 'UPDATE'            TO SM-READ
  3793        PERFORM 9995-SECURITY-VIOLATION
  3794                                 THRU 9995-EXIT
  3795        MOVE ER-0070             TO EMI-ERROR
  3796        PERFORM 9900-ERROR-FORMAT
  3797                                 THRU 9900-EXIT
  3798        GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL6524.cbl
  3799     END-IF
  3800     IF CARRIERL > ZERO
  3801        IF PI-CARRIER-SECURITY > SPACES
  3802           IF CARRIERI = PI-CARRIER-SECURITY
  3803              CONTINUE
  3804           ELSE
  3805              MOVE -1            TO CARRIERL
  3806              MOVE ER-2370       TO EMI-ERROR
  3807              PERFORM 9900-ERROR-FORMAT
  3808                                 THRU 9900-EXIT
  3809              MOVE AL-UABON      TO CARRIERA
  3810              GO TO 8200-SEND-DATAONLY
  3811           END-IF
  3812        END-IF
  3813     END-IF
  3814     IF CARRIERL > ZERO
  3815         IF ADD-FUNCTION
  3816             IF PI-ZERO-CARRIER
  3817               OR PI-ZERO-CAR-GROUP
  3818                 MOVE ZEROS      TO  PI-ERC-CARRIER
  3819                                     CARRIERI
  3820                 MOVE AL-UANON   TO  CARRIERA
  3821             ELSE
  3822                 MOVE CARRIERI   TO  WS-ACARRIER
  3823                                     PI-ERC-CARRIER
  3824                 MOVE '6'        TO  CNTL-REC-TYPE
  3825                 PERFORM 7400-READ-CONTROL-FILE  THRU  7499-EXIT
  3826         ELSE
  3827             IF PI-ZERO-CARRIER
  3828               OR PI-ZERO-CAR-GROUP
  3829                 MOVE ZEROS      TO  PI-ERC-CARRIER
  3830                                     CARRIERI
  3831                 MOVE AL-UANON   TO  CARRIERA
  3832             ELSE
  3833                 MOVE AL-UANON   TO  CARRIERA
  3834                 MOVE CARRIERI   TO  PI-ERC-CARRIER
  3835     ELSE
  3836         IF ADD-FUNCTION
  3837             IF PI-ZERO-CARRIER
  3838               OR PI-ZERO-CAR-GROUP
  3839                 MOVE ZEROS      TO  PI-ERC-CARRIER
  3840                                     CARRIERI
  3841                 MOVE AL-UANON   TO  CARRIERA
  3842             ELSE
  3843                 MOVE -1         TO  CARRIERL
  3844                 MOVE AL-UABON   TO  CARRIERA
  3845                 MOVE ER-0193    TO  EMI-ERROR
  3846                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3847         ELSE
  3848             MOVE -1             TO  CARRIERL
  3849             MOVE AL-UABON       TO  CARRIERA
  3850             MOVE ER-0193        TO  EMI-ERROR
  3851             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3852     IF GROUPL > ZERO
  3853         IF PI-ZERO-GROUPING
  3854           OR PI-ZERO-CAR-GROUP
  3855             MOVE ZEROS          TO  PI-ERC-GROUP
  3856                                     GROUPI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL6524.cbl
  3857             MOVE AL-UANON       TO  GROUPA
  3858         ELSE
  3859             MOVE AL-UANON       TO  GROUPA
  3860             MOVE GROUPI         TO  PI-ERC-GROUP
  3861     ELSE
  3862         IF ADD-FUNCTION
  3863             IF PI-ZERO-GROUPING
  3864               OR PI-ZERO-CAR-GROUP
  3865                 MOVE ZEROS      TO  PI-ERC-GROUP
  3866                                     GROUPI
  3867                 MOVE AL-UANON   TO  GROUPA
  3868             ELSE
  3869                 MOVE LOW-VALUES  TO  PI-ERC-GROUP
  3870         ELSE
  3871             MOVE LOW-VALUES     TO  PI-ERC-GROUP.
  3872     IF BANKL > ZERO
  3873         MOVE AL-UANON           TO BANKA
  3874         MOVE BANKI              TO PI-ERC-BANK
  3875     ELSE
  3876         MOVE LOW-VALUES         TO PI-ERC-BANK
  3877     END-IF
  3878     IF TYPEL > ZERO
  3879         MOVE AL-UANON           TO TYPEA
  3880         MOVE TYPEI              TO PI-ERC-TYPE
  3881     ELSE
  3882         MOVE LOW-VALUES         TO PI-ERC-TYPE
  3883     END-IF
  3884     IF (EFFDTL NOT = ZEROS)
  3885        AND (EFFDTI NOT = SPACES)
  3886        MOVE EFFDTI                TO DEEDIT-FIELD
  3887        PERFORM 8600-DEEDIT
  3888        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  3889        MOVE '4'                    TO DC-OPTION-CODE
  3890        PERFORM 9700-DATE-CONVERSION
  3891        IF DATE-CONVERSION-ERROR
  3892           MOVE ER-0348             TO EMI-ERROR
  3893           MOVE -1                  TO EFFDTL
  3894           MOVE AL-UABON            TO EFFDTA
  3895           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3896        ELSE
  3897           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  3898           MOVE DC-GREG-DATE-1-EDIT TO EFFDTI
  3899           MOVE AL-UANON            TO EFFDTA
  3900           SET CHANGES-MADE         TO TRUE
  3901           IF CHANGE-FUNCTION
  3902              SET EFF-DT-CHANGE     TO TRUE
  3903           END-IF
  3904        END-IF
  3905     ELSE
  3906        IF ADD-FUNCTION
  3907           MOVE ER-0348             TO EMI-ERROR
  3908           MOVE -1                  TO EFFDTL
  3909           MOVE AL-UABON            TO EFFDTA
  3910           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3911        END-IF
  3912     END-IF
  3913     IF (EXPDTL NOT = ZEROS)
  3914        AND (EXPDTI NOT = SPACES)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL6524.cbl
  3915        MOVE EXPDTI              TO DEEDIT-FIELD
  3916        PERFORM 8600-DEEDIT
  3917        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3918        MOVE '4'                 TO DC-OPTION-CODE
  3919        IF DC-GREG-DATE-1-MDY = 999999
  3920           MOVE HIGH-VALUES      TO WS-BIN-EXP-DT
  3921                                    PI-ERC-EXP-DT
  3922           MOVE '99/99/99'       TO EXPDTI
  3923           MOVE AL-UANON         TO EXPDTA
  3924        ELSE
  3925           PERFORM 9700-DATE-CONVERSION
  3926           IF DATE-CONVERSION-ERROR
  3927              MOVE ER-0454       TO EMI-ERROR
  3928              MOVE -1            TO EXPDTL
  3929              MOVE AL-UABON      TO EXPDTA
  3930              PERFORM 9900-ERROR-FORMAT
  3931                                 THRU 9900-EXIT
  3932           ELSE
  3933              MOVE DC-BIN-DATE-1 TO WS-BIN-EXP-DT
  3934                                    PI-ERC-EXP-DT
  3935              MOVE DC-GREG-DATE-1-EDIT
  3936                                 TO EXPDTI
  3937              MOVE AL-UANON         TO EXPDTA
  3938           END-IF
  3939        END-IF
  3940     ELSE
  3941        IF ADD-FUNCTION
  3942           MOVE ER-0454             TO EMI-ERROR
  3943           MOVE -1                  TO EFFDTL
  3944           MOVE AL-UABON            TO EFFDTA
  3945           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3946        END-IF
  3947     END-IF
  3948     IF NOT MODIFY-CAP
  3949         IF SHOW-FUNCTION
  3950             GO TO 1000-EDIT-INPUT
  3951         ELSE
  3952             MOVE 'UPDATE'       TO SM-READ
  3953             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3954             MOVE ER-0070        TO  EMI-ERROR
  3955             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3956             GO TO 8100-SEND-INITIAL-MAP.
  3957     IF EMI-NO-ERRORS
  3958        CONTINUE
  3959     ELSE
  3960        IF EIBTRNID NOT = TRANS-ID
  3961           GO TO 8100-SEND-INITIAL-MAP
  3962        ELSE
  3963           GO TO 8200-SEND-DATAONLY
  3964        END-IF
  3965     END-IF
  3966     IF CHANGE-FUNCTION
  3967        GO TO 4400-CHANGE
  3968     END-IF
  3969     IF DELETE-FUNCTION
  3970        GO TO 4600-DELETE
  3971     END-IF
  3972     IF SHOW-FUNCTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL6524.cbl
  3973        GO TO 1000-EDIT-INPUT
  3974     END-IF
  3975     IF EMI-NO-ERRORS
  3976        CONTINUE
  3977     ELSE
  3978        GO TO 8200-SEND-DATAONLY
  3979     END-IF
  3980     IF ADD-FUNCTION
  3981        GO TO 4200-ADD
  3982     END-IF
  3983     MOVE -1                     TO MAINTYPL
  3984     MOVE ER-2056                TO EMI-ERROR
  3985     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  3986     GO TO 8200-SEND-DATAONLY
  3987     .
  3988 4000-EXIT.
  3989     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL6524.cbl
  3991 1000-EDIT-INPUT.
  3992     IF CARRIERL NOT = ZEROS
  3993        MOVE CARRIERI            TO WS-CARRIER
  3994     ELSE
  3995        MOVE ER-0234             TO EMI-ERROR
  3996        MOVE -1                  TO CARRIERL
  3997        MOVE AL-UABON            TO CARRIERA
  3998        PERFORM 9900-ERROR-FORMAT
  3999                                 THRU 9900-EXIT
  4000     END-IF
  4001     IF GROUPL NOT = ZEROS
  4002        MOVE GROUPI              TO WS-GROUP
  4003     ELSE
  4004        MOVE ER-0235             TO EMI-ERROR
  4005        MOVE -1                  TO GROUPL
  4006        MOVE AL-UABON            TO GROUPA
  4007        PERFORM 9900-ERROR-FORMAT
  4008                                 THRU 9900-EXIT
  4009     END-IF
  4010     IF BANKL  NOT = ZEROS
  4011        MOVE BANKI               TO WS-BANK
  4012     ELSE
  4013        MOVE ER-6508             TO EMI-ERROR
  4014        MOVE -1                  TO BANKL
  4015        MOVE AL-UABON            TO BANKA
  4016        PERFORM 9900-ERROR-FORMAT
  4017                                 THRU 9900-EXIT
  4018     END-IF
  4019     IF TYPEL     NOT = ZEROS
  4020        MOVE TYPEI               TO WS-TYPE
  4021     ELSE
  4022        MOVE ER-2042             TO EMI-ERROR
  4023        MOVE -1                  TO TYPEL
  4024        MOVE AL-UABON            TO TYPEA
  4025        PERFORM 9900-ERROR-FORMAT
  4026                                 THRU 9900-EXIT
  4027     END-IF
  4028     IF EXPDTL    NOT = ZEROS
  4029        MOVE WS-BIN-EXP-DT       TO WS-EXP-DT
  4030     ELSE
  4031        MOVE LOW-VALUES          TO WS-EXP-DT
  4032     END-IF
  4033     IF NOT EMI-NO-ERRORS
  4034        GO TO 8200-SEND-DATAONLY
  4035     END-IF
  4036     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  4037     .
  4038 1050-READ-AGTC.
  4039
  4040* EXEC CICS HANDLE CONDITION
  4041*         NOTFND (1500-AGTC-NOT-FOUND)
  4042*    END-EXEC
  4043*    MOVE '"$I                   ! $ #00003966' TO DFHEIV0
  4044     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4045     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4046     MOVE X'2420233030303033393636' TO DFHEIV0(25:11)
  4047     CALL 'kxdfhei1' USING DFHEIV0
  4048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL6524.cbl
  4049
  4050* EXEC CICS STARTBR
  4051*        DATASET (AGTC-FILE-ID)
  4052*        RIDFLD (WS-CONTROL-PRIMARY)
  4053*    END-EXEC
  4054     MOVE 0
  4055       TO DFHEIV11
  4056*    MOVE '&,         G          &   #00003969' TO DFHEIV0
  4057     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4058     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4059     MOVE X'2020233030303033393639' TO DFHEIV0(25:11)
  4060     CALL 'kxdfhei1' USING DFHEIV0,
  4061           AGTC-FILE-ID,
  4062           WS-CONTROL-PRIMARY,
  4063           DFHEIV99,
  4064           DFHEIV11,
  4065           DFHEIV99
  4066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4067     MOVE 'Y'                    TO BROWSE-STARTED-SW
  4068     MOVE +1                     TO PI-NDX
  4069     .
  4070 1060-READ-LOOP.
  4071
  4072* EXEC CICS READNEXT
  4073*        DATASET (AGTC-FILE-ID)
  4074*        SET     (ADDRESS OF AGENT-COMMISSIONS)
  4075*        RIDFLD  (WS-CONTROL-PRIMARY)
  4076*    END-EXEC
  4077     MOVE 0
  4078       TO DFHEIV11
  4079*    MOVE '&.S                   )   #00003977' TO DFHEIV0
  4080     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4081     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4082     MOVE X'2020233030303033393737' TO DFHEIV0(25:11)
  4083     CALL 'kxdfhei1' USING DFHEIV0,
  4084           AGTC-FILE-ID,
  4085           DFHEIV20,
  4086           DFHEIV99,
  4087           WS-CONTROL-PRIMARY,
  4088           DFHEIV99,
  4089           DFHEIV11,
  4090           DFHEIV99,
  4091           DFHEIV99
  4092     SET ADDRESS OF AGENT-COMMISSIONS TO
  4093         DFHEIV20
  4094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4095     IF (AG-COMPANY-CD NOT = PI-COMPANY-CD)
  4096        OR (WS-CARRIER NOT = PI-ERC-CARRIER)
  4097        OR (WS-GROUP   NOT = PI-ERC-GROUP)
  4098        OR (WS-BANK    NOT = PI-ERC-BANK)
  4099        OR (WS-TYPE    NOT = PI-ERC-TYPE)
  4100        GO TO 1500-AGTC-NOT-FOUND
  4101     END-IF
  4102     MOVE AG-LAST-MAINT-USER     TO PI-UPDATE-BY
  4103     IF AG-LAST-MAINT-HHMMSS NUMERIC
  4104        MOVE AG-LAST-MAINT-HHMMSS
  4105                                 TO PI-UPDATE-HHMMSS
  4106     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL6524.cbl
  4107        MOVE ZEROS               TO PI-UPDATE-HHMMSS
  4108     END-IF
  4109     MOVE AG-CONTROL-PRIMARY     TO PI-SAVE-ERAGTC-KEY
  4110     MOVE +1                     TO PI-NDX
  4111                                    PI-TOP-NDX
  4112     MOVE ER-0000                TO EMI-ERROR
  4113     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  4114     GO TO 5200-FORMAT-SCREEN
  4115     .
  4116 1500-AGTC-NOT-FOUND.
  4117     MOVE ER-0142                TO EMI-ERROR
  4118     MOVE -1                     TO CARRIERL
  4119     MOVE AL-UABON               TO CARRIERA
  4120     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  4121     IF EIBTRNID  = EL652-TRANS-ID
  4122        GO TO 8100-SEND-INITIAL-MAP
  4123     ELSE
  4124        GO TO 8200-SEND-DATAONLY
  4125     END-IF
  4126     .
  4127 3000-BLD-LINE.
  4128     PERFORM VARYING PI-NDX FROM +1 BY +1 UNTIL
  4129        (PI-NDX > +10)
  4130        IF AG-AGT (PI-NDX) NOT = SPACES AND ZEROS
  4131           MOVE AG-AGT (PI-NDX)  TO REPR (PI-NDX)
  4132           MOVE AG-COM-TYP (PI-NDX)
  4133                                 TO ATYPE (PI-NDX)
  4134           IF AG-SPP-FEES (PI-NDX) NOT = ZEROS
  4135              MOVE AG-SPP-FEES (PI-NDX)
  4136                                 TO FEES-COMM-O (PI-NDX)
  4137           END-IF
  4138           MOVE AG-RECALC-LV-INDIC (PI-NDX)
  4139                                 TO RECAL (PI-NDX)
  4140           IF AG-SPP-LFEES (PI-NDX) NOT NUMERIC
  4141              MOVE ZEROS         TO AG-SPP-LFEES (PI-NDX)
  4142           END-IF
  4143           IF AG-SPP-LFEES (PI-NDX) NOT = ZEROS
  4144              MOVE AG-SPP-LFEES (PI-NDX)
  4145                                 TO LFEES-COMM-O (PI-NDX)
  4146           END-IF
  4147           MOVE AG-LRCALC-LV-INDIC (PI-NDX)
  4148                                 TO LRCAL (PI-NDX)
  4149        END-IF
  4150     END-PERFORM
  4151     .
  4152 3000-XIT.
  4153     EXIT.
  4154 3100-GET-BANK-DATES.
  4155
  4156* EXEC CICS STARTBR
  4157*        DATASET (AGTC-FILE-ID)
  4158*        RIDFLD  (WS-CONTROL-PRIMARY)
  4159*        RESP    (WS-RESPONSE)
  4160*    END-EXEC
  4161     MOVE 0
  4162       TO DFHEIV11
  4163*    MOVE '&,         G          &  N#00004042' TO DFHEIV0
  4164     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL6524.cbl
  4165     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4166     MOVE X'204E233030303034303432' TO DFHEIV0(25:11)
  4167     CALL 'kxdfhei1' USING DFHEIV0,
  4168           AGTC-FILE-ID,
  4169           WS-CONTROL-PRIMARY,
  4170           DFHEIV99,
  4171           DFHEIV11,
  4172           DFHEIV99
  4173     MOVE EIBRESP  TO WS-RESPONSE
  4174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4175     IF NOT RESP-NORMAL
  4176        GO TO 3100-EXIT
  4177     END-IF
  4178     MOVE 'Y'                    TO BROWSE-STARTED-SW
  4179     MOVE +1                     TO PI-NDX
  4180     .
  4181 3100-READ-LOOP.
  4182
  4183* EXEC CICS READNEXT
  4184*        DATASET (AGTC-FILE-ID)
  4185*        SET     (ADDRESS OF AGENT-COMMISSIONS)
  4186*        RIDFLD  (WS-CONTROL-PRIMARY)
  4187*        RESP    (WS-RESPONSE)
  4188*    END-EXEC
  4189     MOVE 0
  4190       TO DFHEIV11
  4191*    MOVE '&.S                   )  N#00004054' TO DFHEIV0
  4192     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4193     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4194     MOVE X'204E233030303034303534' TO DFHEIV0(25:11)
  4195     CALL 'kxdfhei1' USING DFHEIV0,
  4196           AGTC-FILE-ID,
  4197           DFHEIV20,
  4198           DFHEIV99,
  4199           WS-CONTROL-PRIMARY,
  4200           DFHEIV99,
  4201           DFHEIV11,
  4202           DFHEIV99,
  4203           DFHEIV99
  4204     SET ADDRESS OF AGENT-COMMISSIONS TO
  4205         DFHEIV20
  4206     MOVE EIBRESP  TO WS-RESPONSE
  4207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4208     IF RESP-NORMAL
  4209        AND (AG-COMPANY-CD = PI-COMPANY-CD)
  4210        AND (WS-CARRIER = PI-ERC-CARRIER)
  4211        AND (WS-GROUP   = PI-ERC-GROUP)
  4212        AND (WS-BANK    = PI-ERC-BANK)
  4213        AND (WS-TYPE    = PI-ERC-TYPE)
  4214        MOVE AG-EFF-DT           TO WS-TBL-EFF-DT (PI-NDX)
  4215        MOVE AG-EXP-DT           TO WS-TBL-EXP-DT (PI-NDX)
  4216        ADD +1                   TO PI-NDX
  4217        GO TO 3100-READ-LOOP
  4218     END-IF
  4219     .
  4220 3100-EXIT.
  4221     EXIT.
  4222 4200-ADD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL6524.cbl
  4223     IF WS-BIN-EXP-DT NOT > WS-BIN-EFF-DT
  4224        MOVE ER-2053             TO EMI-ERROR
  4225        MOVE -1                  TO EFFDTL
  4226        MOVE AL-UABON            TO EFFDTA
  4227                                    EXPDTA
  4228        PERFORM 9900-ERROR-FORMAT
  4229                                 THRU 9900-EXIT
  4230     END-IF
  4231     IF EMI-NO-ERRORS
  4232        CONTINUE
  4233     ELSE
  4234        GO TO 8200-SEND-DATAONLY
  4235     END-IF
  4236
  4237* EXEC CICS HANDLE CONDITION
  4238*        NOTOPEN  (9990-ABEND)
  4239*        NOTFND   (4250-CONT)
  4240*    END-EXEC.
  4241*    MOVE '"$JI                  ! % #00004088' TO DFHEIV0
  4242     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  4243     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4244     MOVE X'2520233030303034303838' TO DFHEIV0(25:11)
  4245     CALL 'kxdfhei1' USING DFHEIV0
  4246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4247
  4248     MOVE PI-ERC-KEY             TO WS-CONTROL-PRIMARY
  4249     PERFORM 7050-READ-ERAGTC    THRU 7050-EXIT
  4250     MOVE ER-2057                TO EMI-ERROR
  4251     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  4252     MOVE LOW-VALUES             TO PI-SAVE-ERAGTC-KEY
  4253     MOVE -1                     TO  MAINTYPL
  4254     GO TO 8200-SEND-DATAONLY
  4255     .
  4256 4250-CONT.
  4257     MOVE LOW-VALUES             TO WS-DATE-TABLE
  4258     MOVE ' '                    TO TABLE-SW
  4259     MOVE WS-CONTROL-PRIMARY     TO PI-SAVE-ERAGTC-KEY
  4260     MOVE LOW-VALUES             TO PI-ERC-EXP-DT
  4261     MOVE PI-ERC-KEY             TO WS-CONTROL-PRIMARY
  4262     PERFORM 3100-GET-BANK-DATES THRU 3100-EXIT
  4263     PERFORM VARYING PI-NDX FROM +1 BY +1 UNTIL
  4264        (WS-TBL-EXP-DT (PI-NDX) = LOW-VALUES)
  4265        OR (PI-NDX > +40)
  4266        IF ((WS-BIN-EXP-DT > WS-TBL-EFF-DT (PI-NDX))
  4267           AND (WS-BIN-EXP-DT NOT > WS-TBL-EXP-DT (PI-NDX)))
  4268                     OR
  4269           ((WS-BIN-EFF-DT > WS-TBL-EFF-DT (PI-NDX))
  4270           AND (WS-BIN-EFF-DT < WS-TBL-EXP-DT (PI-NDX)))
  4271           SET TABLE-OVERLAP        TO TRUE
  4272        END-IF
  4273     END-PERFORM
  4274     IF BROWSE-STARTED
  4275
  4276* EXEC CICS ENDBR
  4277*            DATASET  (AGTC-FILE-ID)
  4278*       END-EXEC
  4279     MOVE 0
  4280       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL6524.cbl
  4281*    MOVE '&2                    $   #00004119' TO DFHEIV0
  4282     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4283     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4284     MOVE X'2020233030303034313139' TO DFHEIV0(25:11)
  4285     CALL 'kxdfhei1' USING DFHEIV0,
  4286           AGTC-FILE-ID,
  4287           DFHEIV11,
  4288           DFHEIV99
  4289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4290        MOVE ' '                 TO BROWSE-STARTED-SW
  4291     END-IF
  4292     IF TABLE-OVERLAP
  4293        MOVE ER-2051             TO EMI-ERROR
  4294        MOVE -1                  TO EFFDTL
  4295        MOVE AL-UABON            TO EFFDTA
  4296                                    EXPDTA
  4297        PERFORM 9900-ERROR-FORMAT
  4298                                 THRU 9900-EXIT
  4299        GO TO 8200-SEND-DATAONLY
  4300     END-IF
  4301     MOVE PI-SAVE-ERAGTC-KEY     TO WS-CONTROL-PRIMARY
  4302                                    PI-ERC-KEY
  4303
  4304* EXEC CICS GETMAIN
  4305*        SET      (ADDRESS OF AGENT-COMMISSIONS)
  4306*        INITIMG  (GETMAIN-SPACE)
  4307*        LENGTH   (ERAGTC-LENGTH)
  4308*    END-EXEC
  4309*    MOVE ',"IL                  $   #00004135' TO DFHEIV0
  4310     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4311     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4312     MOVE X'2020233030303034313335' TO DFHEIV0(25:11)
  4313     CALL 'kxdfhei1' USING DFHEIV0,
  4314           DFHEIV20,
  4315           ERAGTC-LENGTH,
  4316           GETMAIN-SPACE
  4317     SET ADDRESS OF AGENT-COMMISSIONS TO
  4318         DFHEIV20
  4319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4320     MOVE SPACES                 TO AGENT-COMMISSIONS
  4321     MOVE PI-COMPANY-CD          TO AG-COMPANY-CD
  4322     MOVE 'AG'                   TO AG-RECORD-ID
  4323     MOVE PI-ERC-KEY             TO AG-CONTROL-PRIMARY
  4324     PERFORM VARYING PI-NDX FROM +1 BY +1 UNTIL
  4325        PI-NDX > +10
  4326        MOVE +0                  TO AG-SPP-FEES (PI-NDX)
  4327        MOVE +0                  TO AG-SPP-LFEES (PI-NDX)
  4328     END-PERFORM
  4329     MOVE +1                     TO PI-NDX
  4330     SET NO-CHANGES-MADE         TO TRUE
  4331     MOVE WS-BIN-EFF-DT          TO AG-EFF-DT
  4332     PERFORM 7300-EDIT-DATA      THRU 7300-EXIT
  4333     IF EMI-NO-ERRORS
  4334        CONTINUE
  4335     ELSE
  4336
  4337* EXEC CICS UNLOCK
  4338*            DATASET  (AGTC-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL6524.cbl
  4339*       END-EXEC
  4340*    MOVE '&*                    #   #00004156' TO DFHEIV0
  4341     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4342     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4343     MOVE X'2020233030303034313536' TO DFHEIV0(25:11)
  4344     CALL 'kxdfhei1' USING DFHEIV0,
  4345           AGTC-FILE-ID,
  4346           DFHEIV99
  4347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4348        GO TO 8200-SEND-DATAONLY
  4349     END-IF
  4350     MOVE +0                     TO WS-TOT-FEES
  4351                                    WS-TOT-LFEES
  4352     PERFORM VARYING PI-NDX FROM +2 BY +1 UNTIL
  4353        PI-NDX > +10
  4354        COMPUTE WS-TOT-FEES = WS-TOT-FEES +
  4355           AG-SPP-FEES (PI-NDX)
  4356        COMPUTE WS-TOT-LFEES = WS-TOT-LFEES +
  4357           AG-SPP-LFEES (PI-NDX)
  4358     END-PERFORM
  4359     MOVE LOW-VALUES             TO WS-ERCOMP-KEY
  4360     MOVE PI-ERC-KEY (1:18)      TO WS-ERCOMP-KEY (1:18)
  4361     MOVE PI-ERC-TYPE            TO WS-COMP-TYPE
  4362     PERFORM 7350-VERIFY-ERCOMP  THRU 7350-EXIT
  4363     IF RESP-NORMAL
  4364        IF CO-MAX-BANK-FEE NOT NUMERIC
  4365           MOVE +0               TO CO-MAX-BANK-FEE
  4366        END-IF
  4367     ELSE
  4368        GO TO 8200-SEND-DATAONLY
  4369     END-IF
  4370     IF CO-MAX-BANK-FEE = ZEROS
  4371        CONTINUE
  4372     ELSE
  4373        IF WS-TOT-FEES > CO-MAX-BANK-FEE
  4374           MOVE ER-2717          TO EMI-ERROR
  4375           MOVE -1               TO CARRIERL
  4376           MOVE AL-UABON         TO CARRIERA
  4377                                    GROUPA
  4378                                    TYPEA
  4379                                    BANKA
  4380           PERFORM 9900-ERROR-FORMAT
  4381                                 THRU 9900-EXIT
  4382        ELSE
  4383           COMPUTE AG-SPP-FEES (1) = CO-MAX-BANK-FEE
  4384              - WS-TOT-FEES
  4385        END-IF
  4386     END-IF
  4387     IF CO-MAX-BANK-FEE-LEASE = ZEROS
  4388        CONTINUE
  4389     ELSE
  4390        IF WS-TOT-LFEES > CO-MAX-BANK-FEE-LEASE
  4391           MOVE ER-2717          TO EMI-ERROR
  4392           MOVE -1               TO CARRIERL
  4393           MOVE AL-UABON         TO CARRIERA
  4394                                    GROUPA
  4395                                    TYPEA
  4396                                    BANKA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL6524.cbl
  4397           PERFORM 9900-ERROR-FORMAT
  4398                                 THRU 9900-EXIT
  4399        ELSE
  4400           COMPUTE AG-SPP-LFEES (1) = CO-MAX-BANK-FEE-LEASE
  4401              - WS-TOT-LFEES
  4402        END-IF
  4403     END-IF
  4404     IF EMI-NO-ERRORS
  4405        CONTINUE
  4406     ELSE
  4407
  4408* EXEC CICS UNLOCK
  4409*            DATASET  (AGTC-FILE-ID)
  4410*       END-EXEC
  4411*    MOVE '&*                    #   #00004218' TO DFHEIV0
  4412     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4413     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4414     MOVE X'2020233030303034323138' TO DFHEIV0(25:11)
  4415     CALL 'kxdfhei1' USING DFHEIV0,
  4416           AGTC-FILE-ID,
  4417           DFHEIV99
  4418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4419        GO TO 8200-SEND-DATAONLY
  4420     END-IF
  4421     MOVE PI-PROCESSOR-ID        TO AG-LAST-MAINT-USER
  4422     MOVE EIBTIME                TO AG-LAST-MAINT-HHMMSS
  4423     MOVE SAVE-BIN-DATE          TO AG-LAST-MAINT-DT
  4424
  4425* EXEC CICS WRITE
  4426*        DATASET  (AGTC-FILE-ID)
  4427*        FROM     (AGENT-COMMISSIONS)
  4428*        RIDFLD   (AG-CONTROL-PRIMARY)
  4429*    END-EXEC
  4430     MOVE LENGTH OF
  4431      AGENT-COMMISSIONS
  4432       TO DFHEIV11
  4433*    MOVE '&$ L                  ''   #00004226' TO DFHEIV0
  4434     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4435     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4436     MOVE X'2020233030303034323236' TO DFHEIV0(25:11)
  4437     CALL 'kxdfhei1' USING DFHEIV0,
  4438           AGTC-FILE-ID,
  4439           AGENT-COMMISSIONS,
  4440           DFHEIV11,
  4441           AG-CONTROL-PRIMARY,
  4442           DFHEIV99,
  4443           DFHEIV99
  4444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4445     GO TO 1050-READ-AGTC
  4446*    MOVE LOW-VALUES             TO EL652EO
  4447*    MOVE 'S'                    TO MAINTYPO
  4448*    MOVE +1                     TO MAINTYPL
  4449*    MOVE AL-UANON               TO MAINTYPA
  4450*    MOVE PI-ERC-CARRIER         TO CARRIERO
  4451*    MOVE AL-UANON               TO CARRIERA
  4452*    MOVE +1                     TO CARRIERL
  4453*    IF PI-ERC-GROUP NOT = SPACES
  4454*        MOVE PI-ERC-GROUP       TO GROUPO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL6524.cbl
  4455*        MOVE AL-UANON           TO GROUPA
  4456*        MOVE +6                 TO GROUPL
  4457*    END-IF
  4458*
  4459*    IF PI-ERC-BANK NOT = SPACES
  4460*       MOVE PI-ERC-BANK         TO BANKO
  4461*       MOVE AL-UANON            TO BANKA
  4462*       MOVE +10                 TO BANKL
  4463*    END-IF
  4464*    IF PI-ERC-TYPE NOT = SPACES
  4465*       MOVE PI-ERC-TYPE         TO TYPEO
  4466*       MOVE AL-UANON            TO TYPEA
  4467*       MOVE +1                  TO TYPEL
  4468*    END-IF
  4469*    GO TO 1000-EDIT-INPUT
  4470     .
  4471 4200-EXIT.
  4472     EXIT.
  4473 4400-CHANGE.
  4474     IF PI-ERC-KEY = PI-SAVE-ERAGTC-KEY
  4475        CONTINUE
  4476     ELSE
  4477        IF PI-ERC-KEY (1:18) = PI-SAVE-ERAGTC-KEY (1:18)
  4478           PERFORM 4650-CHG-EXPDT THRU 4650-EXIT
  4479        ELSE
  4480           MOVE ER-2056          TO EMI-ERROR
  4481           PERFORM 9900-ERROR-FORMAT
  4482                                 THRU 9900-EXIT
  4483           MOVE -1               TO MAINTYPL
  4484           GO TO 8200-SEND-DATAONLY
  4485        END-IF
  4486     END-IF
  4487     IF EFF-DT-CHANGE
  4488        PERFORM 4660-DATE-CHANGE THRU 4660-EXIT
  4489        IF NOT EMI-NO-ERRORS
  4490           GO TO 8200-SEND-DATAONLY
  4491        END-IF
  4492     END-IF
  4493     MOVE PI-ERC-KEY             TO WS-CONTROL-PRIMARY
  4494     PERFORM 7200-READ-ERAGTC-UPDATE
  4495                                 THRU 7200-EXIT
  4496     IF (AG-LAST-MAINT-USER = PI-UPDATE-BY)
  4497        AND (AG-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS)
  4498        CONTINUE
  4499     ELSE
  4500
  4501* EXEC CICS UNLOCK
  4502*            DATASET  (AGTC-FILE-ID)
  4503*       END-EXEC
  4504*    MOVE '&*                    #   #00004286' TO DFHEIV0
  4505     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4506     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4507     MOVE X'2020233030303034323836' TO DFHEIV0(25:11)
  4508     CALL 'kxdfhei1' USING DFHEIV0,
  4509           AGTC-FILE-ID,
  4510           DFHEIV99
  4511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4512        MOVE ER-0068             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL6524.cbl
  4513        PERFORM 9900-ERROR-FORMAT
  4514                                 THRU  9900-EXIT
  4515        GO TO 8200-SEND-DATAONLY
  4516     END-IF
  4517     MOVE PI-TOP-NDX             TO PI-NDX
  4518*    SET NO-CHANGES-MADE         TO TRUE
  4519     PERFORM 7300-EDIT-DATA      THRU 7300-EXIT
  4520     IF EMI-NO-ERRORS
  4521        CONTINUE
  4522     ELSE
  4523
  4524* EXEC CICS UNLOCK
  4525*            DATASET  (AGTC-FILE-ID)
  4526*       END-EXEC
  4527*    MOVE '&*                    #   #00004300' TO DFHEIV0
  4528     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4529     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4530     MOVE X'2020233030303034333030' TO DFHEIV0(25:11)
  4531     CALL 'kxdfhei1' USING DFHEIV0,
  4532           AGTC-FILE-ID,
  4533           DFHEIV99
  4534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4535        GO TO 8200-SEND-DATAONLY
  4536     END-IF
  4537     IF (NO-CHANGES-MADE)
  4538        AND (NO-LINE-CHANGES)
  4539        MOVE ER-3112             TO EMI-ERROR
  4540        PERFORM 9900-ERROR-FORMAT
  4541                                 THRU 9900-EXIT
  4542        MOVE -1                  TO MAINTYPL
  4543        GO TO 8200-SEND-DATAONLY
  4544     END-IF
  4545     MOVE +0                     TO WS-TOT-FEES
  4546                                    WS-TOT-LFEES
  4547     PERFORM VARYING PI-NDX FROM +2 BY +1 UNTIL
  4548        PI-NDX > +10
  4549        COMPUTE WS-TOT-FEES = WS-TOT-FEES +
  4550           AG-SPP-FEES (PI-NDX)
  4551        COMPUTE WS-TOT-LFEES = WS-TOT-LFEES +
  4552           AG-SPP-LFEES (PI-NDX)
  4553     END-PERFORM
  4554     MOVE LOW-VALUES             TO WS-ERCOMP-KEY
  4555     MOVE PI-ERC-KEY (1:18)      TO WS-ERCOMP-KEY (1:18)
  4556     MOVE PI-ERC-TYPE            TO WS-COMP-TYPE
  4557     PERFORM 7350-VERIFY-ERCOMP  THRU 7350-EXIT
  4558     IF RESP-NORMAL
  4559        IF CO-MAX-BANK-FEE NOT NUMERIC
  4560           MOVE +0               TO CO-MAX-BANK-FEE
  4561        END-IF
  4562     ELSE
  4563        GO TO 8200-SEND-DATAONLY
  4564     END-IF
  4565     IF CO-MAX-BANK-FEE = ZEROS
  4566        CONTINUE
  4567     ELSE
  4568        IF WS-TOT-FEES > CO-MAX-BANK-FEE
  4569           MOVE ER-2717          TO EMI-ERROR
  4570           MOVE -1               TO CARRIERL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL6524.cbl
  4571           MOVE AL-UABON         TO CARRIERA
  4572                                    GROUPA
  4573                                    TYPEA
  4574                                    BANKA
  4575           PERFORM 9900-ERROR-FORMAT
  4576                                 THRU 9900-EXIT
  4577        ELSE
  4578           COMPUTE AG-SPP-FEES (1) = CO-MAX-BANK-FEE
  4579              - WS-TOT-FEES
  4580        END-IF
  4581     END-IF
  4582     IF CO-MAX-BANK-FEE-LEASE = ZEROS
  4583        CONTINUE
  4584     ELSE
  4585        IF WS-TOT-LFEES > CO-MAX-BANK-FEE-LEASE
  4586           MOVE ER-2717          TO EMI-ERROR
  4587           MOVE -1               TO CARRIERL
  4588           MOVE AL-UABON         TO CARRIERA
  4589                                    GROUPA
  4590                                    TYPEA
  4591                                    BANKA
  4592           PERFORM 9900-ERROR-FORMAT
  4593                                 THRU 9900-EXIT
  4594        ELSE
  4595           COMPUTE AG-SPP-LFEES (1) = CO-MAX-BANK-FEE-LEASE
  4596              - WS-TOT-LFEES
  4597        END-IF
  4598     END-IF
  4599     IF EFFDTL NOT = ZEROS
  4600        MOVE WS-BIN-EFF-DT       TO AG-EFF-DT
  4601     END-IF
  4602     IF EMI-NO-ERRORS
  4603        CONTINUE
  4604     ELSE
  4605
  4606* EXEC CICS UNLOCK
  4607*            DATASET  (AGTC-FILE-ID)
  4608*       END-EXEC
  4609*    MOVE '&*                    #   #00004373' TO DFHEIV0
  4610     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4611     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4612     MOVE X'2020233030303034333733' TO DFHEIV0(25:11)
  4613     CALL 'kxdfhei1' USING DFHEIV0,
  4614           AGTC-FILE-ID,
  4615           DFHEIV99
  4616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4617        GO TO 8200-SEND-DATAONLY
  4618     END-IF
  4619     MOVE PI-PROCESSOR-ID        TO AG-LAST-MAINT-USER
  4620     MOVE EIBTIME                TO AG-LAST-MAINT-HHMMSS
  4621     MOVE SAVE-BIN-DATE          TO AG-LAST-MAINT-DT
  4622
  4623* EXEC CICS REWRITE
  4624*        DATASET  (AGTC-FILE-ID)
  4625*        FROM     (AGENT-COMMISSIONS)
  4626*    END-EXEC
  4627     MOVE LENGTH OF
  4628      AGENT-COMMISSIONS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL6524.cbl
  4629       TO DFHEIV11
  4630*    MOVE '&& L                  %   #00004381' TO DFHEIV0
  4631     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4632     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4633     MOVE X'2020233030303034333831' TO DFHEIV0(25:11)
  4634     CALL 'kxdfhei1' USING DFHEIV0,
  4635           AGTC-FILE-ID,
  4636           AGENT-COMMISSIONS,
  4637           DFHEIV11,
  4638           DFHEIV99
  4639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4640     GO TO 1050-READ-AGTC
  4641*    GO TO 1000-EDIT-INPUT
  4642     .
  4643 4600-DELETE.
  4644     IF PI-ERC-KEY = PI-SAVE-ERAGTC-KEY
  4645        CONTINUE
  4646     ELSE
  4647        MOVE ER-2056             TO EMI-ERROR
  4648        PERFORM 9900-ERROR-FORMAT
  4649                                 THRU 9900-EXIT
  4650        MOVE -1                  TO MAINTYPL
  4651        GO TO 8200-SEND-DATAONLY
  4652     END-IF
  4653     MOVE PI-ERC-KEY             TO WS-CONTROL-PRIMARY
  4654     PERFORM 7200-READ-ERAGTC-UPDATE
  4655                                 THRU 7200-EXIT
  4656     IF (AG-LAST-MAINT-USER = PI-UPDATE-BY)
  4657        AND (AG-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS)
  4658        CONTINUE
  4659     ELSE
  4660
  4661* EXEC CICS UNLOCK
  4662*            DATASET  (AGTC-FILE-ID)
  4663*       END-EXEC
  4664*    MOVE '&*                    #   #00004405' TO DFHEIV0
  4665     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4666     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4667     MOVE X'2020233030303034343035' TO DFHEIV0(25:11)
  4668     CALL 'kxdfhei1' USING DFHEIV0,
  4669           AGTC-FILE-ID,
  4670           DFHEIV99
  4671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4672        MOVE ER-0068             TO EMI-ERROR
  4673        PERFORM 9900-ERROR-FORMAT
  4674                                 THRU  9900-EXIT
  4675        GO TO 8200-SEND-DATAONLY
  4676     END-IF
  4677
  4678* EXEC CICS DELETE
  4679*        DATASET  (AGTC-FILE-ID)
  4680*    END-EXEC
  4681*    MOVE '&(                    &   #00004413' TO DFHEIV0
  4682     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4683     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4684     MOVE X'2020233030303034343133' TO DFHEIV0(25:11)
  4685     CALL 'kxdfhei1' USING DFHEIV0,
  4686           AGTC-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL6524.cbl
  4687           DFHEIV99,
  4688           DFHEIV99,
  4689           DFHEIV99,
  4690           DFHEIV99
  4691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4692     MOVE ER-0000                TO  EMI-ERROR
  4693     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4694     MOVE LOW-VALUES             TO  EL652EO
  4695     MOVE PI-ERC-CARRIER         TO  CARRIERO
  4696     MOVE AL-UANON               TO  CARRIERA
  4697     IF PI-ERC-GROUP NOT = SPACES
  4698         MOVE PI-ERC-GROUP       TO  GROUPO
  4699         MOVE AL-UANON           TO  GROUPA
  4700     END-IF
  4701     IF PI-ERC-BANK    NOT = SPACES
  4702        MOVE PI-ERC-BANK        TO  BANKO
  4703        MOVE AL-UANON           TO  BANKA
  4704     END-IF
  4705     IF PI-ERC-TYPE NOT = SPACES
  4706        MOVE PI-ERC-TYPE        TO  TYPEO
  4707        MOVE AL-UANON           TO  TYPEA
  4708     END-IF
  4709     MOVE LOW-VALUES             TO  PI-SAVE-ERAGTC-KEY
  4710     GO TO 8100-SEND-INITIAL-MAP
  4711     .
  4712 4600-EXIT.
  4713     EXIT.
  4714 4650-CHG-EXPDT.
  4715     MOVE PI-ERC-KEY             TO WS-CONTROL-PRIMARY
  4716
  4717* EXEC CICS READ
  4718*         SET     (ADDRESS OF AGENT-COMMISSIONS)
  4719*         DATASET ('ERAGTC')
  4720*         RIDFLD  (WS-CONTROL-PRIMARY)
  4721*         RESP    (WS-RESPONSE)
  4722*    END-EXEC
  4723     MOVE 'ERAGTC' TO DFHEIV1
  4724*    MOVE '&"S        E          (  N#00004440' TO DFHEIV0
  4725     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4726     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4727     MOVE X'204E233030303034343430' TO DFHEIV0(25:11)
  4728     CALL 'kxdfhei1' USING DFHEIV0,
  4729           DFHEIV1,
  4730           DFHEIV20,
  4731           DFHEIV99,
  4732           WS-CONTROL-PRIMARY,
  4733           DFHEIV99,
  4734           DFHEIV99,
  4735           DFHEIV99
  4736     SET ADDRESS OF AGENT-COMMISSIONS TO
  4737         DFHEIV20
  4738     MOVE EIBRESP  TO WS-RESPONSE
  4739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4740     IF RESP-NORMAL
  4741        MOVE ER-2057             TO EMI-ERROR
  4742        PERFORM 9900-ERROR-FORMAT
  4743                                 THRU 9900-EXIT
  4744        MOVE LOW-VALUES          TO PI-SAVE-ERAGTC-KEY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL6524.cbl
  4745        MOVE -1                  TO  MAINTYPL
  4746        GO TO 8200-SEND-DATAONLY
  4747     END-IF
  4748     MOVE PI-SAVE-ERAGTC-KEY     TO WS-CONTROL-PRIMARY
  4749     PERFORM 7200-READ-ERAGTC-UPDATE
  4750                                 THRU 7200-EXIT
  4751     IF (AG-LAST-MAINT-USER = PI-UPDATE-BY)
  4752        AND (AG-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS)
  4753        CONTINUE
  4754     ELSE
  4755
  4756* EXEC CICS UNLOCK
  4757*            DATASET  (AGTC-FILE-ID)
  4758*       END-EXEC
  4759*    MOVE '&*                    #   #00004461' TO DFHEIV0
  4760     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4761     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4762     MOVE X'2020233030303034343631' TO DFHEIV0(25:11)
  4763     CALL 'kxdfhei1' USING DFHEIV0,
  4764           AGTC-FILE-ID,
  4765           DFHEIV99
  4766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4767        MOVE ER-0068             TO EMI-ERROR
  4768        PERFORM 9900-ERROR-FORMAT
  4769                                 THRU  9900-EXIT
  4770        GO TO 8200-SEND-DATAONLY
  4771     END-IF
  4772     MOVE AGENT-COMMISSIONS     TO WS-SAVE-ERAGTC
  4773
  4774* EXEC CICS DELETE
  4775*        DATASET  (AGTC-FILE-ID)
  4776*    END-EXEC
  4777*    MOVE '&(                    &   #00004470' TO DFHEIV0
  4778     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4779     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4780     MOVE X'2020233030303034343730' TO DFHEIV0(25:11)
  4781     CALL 'kxdfhei1' USING DFHEIV0,
  4782           AGTC-FILE-ID,
  4783           DFHEIV99,
  4784           DFHEIV99,
  4785           DFHEIV99,
  4786           DFHEIV99
  4787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4788     MOVE WS-SAVE-ERAGTC         TO AGENT-COMMISSIONS
  4789     MOVE PI-ERC-KEY             TO AG-CONTROL-PRIMARY
  4790     MOVE PI-PROCESSOR-ID        TO AG-LAST-MAINT-USER
  4791     MOVE EIBTIME                TO AG-LAST-MAINT-HHMMSS
  4792     MOVE SAVE-BIN-DATE          TO AG-LAST-MAINT-DT
  4793
  4794* EXEC CICS WRITE
  4795*        DATASET  (AGTC-FILE-ID)
  4796*        FROM     (AGENT-COMMISSIONS)
  4797*        RIDFLD   (AG-CONTROL-PRIMARY)
  4798*    END-EXEC
  4799     MOVE LENGTH OF
  4800      AGENT-COMMISSIONS
  4801       TO DFHEIV11
  4802*    MOVE '&$ L                  ''   #00004478' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL6524.cbl
  4803     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4804     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4805     MOVE X'2020233030303034343738' TO DFHEIV0(25:11)
  4806     CALL 'kxdfhei1' USING DFHEIV0,
  4807           AGTC-FILE-ID,
  4808           AGENT-COMMISSIONS,
  4809           DFHEIV11,
  4810           AG-CONTROL-PRIMARY,
  4811           DFHEIV99,
  4812           DFHEIV99
  4813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4814     MOVE PI-ERC-KEY             TO WS-CONTROL-PRIMARY
  4815     GO TO 1050-READ-AGTC
  4816     .
  4817 4650-EXIT.
  4818     EXIT.
  4819 4660-DATE-CHANGE.
  4820     MOVE PI-SAVE-ERAGTC-KEY     TO WS-SKIP-KEY
  4821     MOVE LOW-VALUES             TO WS-CONTROL-PRIMARY
  4822     MOVE PI-SAVE-ERAGTC-KEY (1:18)
  4823                                 TO WS-CONTROL-PRIMARY (1:18)
  4824
  4825* EXEC CICS STARTBR
  4826*        DATASET (AGTC-FILE-ID)
  4827*        RIDFLD  (WS-CONTROL-PRIMARY)
  4828*        GTEQ
  4829*        RESP    (WS-RESPONSE)
  4830*    END-EXEC
  4831     MOVE 0
  4832       TO DFHEIV11
  4833*    MOVE '&,         G          &  N#00004493' TO DFHEIV0
  4834     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4835     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4836     MOVE X'204E233030303034343933' TO DFHEIV0(25:11)
  4837     CALL 'kxdfhei1' USING DFHEIV0,
  4838           AGTC-FILE-ID,
  4839           WS-CONTROL-PRIMARY,
  4840           DFHEIV99,
  4841           DFHEIV11,
  4842           DFHEIV99
  4843     MOVE EIBRESP  TO WS-RESPONSE
  4844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4845     IF NOT RESP-NORMAL
  4846        GO TO 1500-AGTC-NOT-FOUND
  4847     END-IF
  4848     MOVE 'Y'                    TO BROWSE-STARTED-SW
  4849     MOVE SPACES                 TO WS-CHECK-DATE-SW
  4850     PERFORM UNTIL
  4851        (DATE-CHECK-OVER)
  4852        PERFORM 4095-READNEXT-ERAGTC
  4853                                 THRU 4095-EXIT
  4854        IF RESP-NORMAL
  4855           IF AG-CONTROL-PRIMARY (1:18) =
  4856                           PI-SAVE-ERAGTC-KEY (1:18)
  4857              IF AG-CONTROL-PRIMARY NOT = WS-SKIP-KEY
  4858                 IF (WS-BIN-EFF-DT NOT < AG-EFF-DT)
  4859                    AND (WS-BIN-EFF-DT < AG-EXP-DT)
  4860                    MOVE ER-0348 TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL6524.cbl
  4861                    MOVE -1      TO EFFDTL
  4862                    MOVE AL-UABON
  4863                                 TO EFFDTA
  4864                    PERFORM 9900-ERROR-FORMAT
  4865                                 THRU 9900-EXIT
  4866                    SET DATE-CHECK-OVER TO TRUE
  4867                 END-IF
  4868              END-IF
  4869           ELSE
  4870              SET DATE-CHECK-OVER TO TRUE
  4871           END-IF
  4872        ELSE
  4873           SET DATE-CHECK-OVER   TO TRUE
  4874        END-IF
  4875     END-PERFORM
  4876     IF BROWSE-STARTED
  4877
  4878* EXEC CICS ENDBR
  4879*            DATASET  (AGTC-FILE-ID)
  4880*       END-EXEC
  4881     MOVE 0
  4882       TO DFHEIV11
  4883*    MOVE '&2                    $   #00004531' TO DFHEIV0
  4884     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4885     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4886     MOVE X'2020233030303034353331' TO DFHEIV0(25:11)
  4887     CALL 'kxdfhei1' USING DFHEIV0,
  4888           AGTC-FILE-ID,
  4889           DFHEIV11,
  4890           DFHEIV99
  4891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4892        MOVE ' '                 TO BROWSE-STARTED-SW
  4893     END-IF
  4894     .
  4895 4660-EXIT.
  4896     EXIT.
  4897 4095-READNEXT-ERAGTC.
  4898
  4899* EXEC CICS READNEXT
  4900*        DATASET (AGTC-FILE-ID)
  4901*        SET     (ADDRESS OF AGENT-COMMISSIONS)
  4902*        RIDFLD  (WS-CONTROL-PRIMARY)
  4903*    END-EXEC
  4904     MOVE 0
  4905       TO DFHEIV11
  4906*    MOVE '&.S                   )   #00004540' TO DFHEIV0
  4907     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4908     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4909     MOVE X'2020233030303034353430' TO DFHEIV0(25:11)
  4910     CALL 'kxdfhei1' USING DFHEIV0,
  4911           AGTC-FILE-ID,
  4912           DFHEIV20,
  4913           DFHEIV99,
  4914           WS-CONTROL-PRIMARY,
  4915           DFHEIV99,
  4916           DFHEIV11,
  4917           DFHEIV99,
  4918           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL6524.cbl
  4919     SET ADDRESS OF AGENT-COMMISSIONS TO
  4920         DFHEIV20
  4921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4922     .
  4923 4095-EXIT.
  4924     EXIT.
  4925 5000-BROWSE-FILE.
  4926     MOVE SPACE                  TO BROWSE-STARTED-SW
  4927
  4928* EXEC CICS HANDLE CONDITION
  4929*        NOTFND (5800-NO-RECORD)
  4930*        ENDFILE (5900-END-OF-FILE)
  4931*    END-EXEC
  4932*    MOVE '"$I''                  ! & #00004550' TO DFHEIV0
  4933     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4935     MOVE X'2620233030303034353530' TO DFHEIV0(25:11)
  4936     CALL 'kxdfhei1' USING DFHEIV0
  4937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4938     MOVE PI-SAVE-ERAGTC-KEY     TO WS-CONTROL-PRIMARY
  4939                                    PI-ERC-KEY
  4940
  4941* EXEC CICS STARTBR
  4942*        DATASET (AGTC-FILE-ID)
  4943*        RIDFLD (WS-CONTROL-PRIMARY)
  4944*    END-EXEC
  4945     MOVE 0
  4946       TO DFHEIV11
  4947*    MOVE '&,         G          &   #00004556' TO DFHEIV0
  4948     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4949     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4950     MOVE X'2020233030303034353536' TO DFHEIV0(25:11)
  4951     CALL 'kxdfhei1' USING DFHEIV0,
  4952           AGTC-FILE-ID,
  4953           WS-CONTROL-PRIMARY,
  4954           DFHEIV99,
  4955           DFHEIV11,
  4956           DFHEIV99
  4957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4958     MOVE 'Y'                    TO BROWSE-STARTED-SW
  4959     IF EIBAID = DFHPF2
  4960        GO TO 5100-BROWSE-BKWD
  4961     END-IF
  4962     .
  4963 5010-READ-LOOP.
  4964     PERFORM 4095-READNEXT-ERAGTC
  4965                                 THRU 4095-EXIT
  4966     MOVE +1                     TO PI-NDX
  4967     IF AG-COMPANY-CD NOT = PI-COMPANY-CD
  4968        GO TO 5900-END-OF-FILE
  4969     END-IF
  4970*    IF EIBAID = DFHPF1
  4971*       IF CARRIERO          = AG-CARRIER
  4972*          AND GROUPO        = AG-GROUPING
  4973*          AND BANKO         = AG-BANK
  4974*          AND TYPEO         = AG-TYPE
  4975*          AND WS-BIN-EXP-DT = AG-EXP-DT
  4976*          GO TO 5010-READ-LOOP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL6524.cbl
  4977*       END-IF
  4978*    END-IF
  4979     IF EIBAID = DFHPF1
  4980        IF PI-ERC-CARRIER    = AG-CARRIER
  4981           AND PI-ERC-GROUP  = AG-GROUPING
  4982           AND PI-ERC-BANK   = AG-BANK
  4983           AND PI-ERC-TYPE   = AG-TYPE
  4984           AND PI-ERC-EXP-DT = AG-EXP-DT
  4985           GO TO 5010-READ-LOOP
  4986        END-IF
  4987     END-IF
  4988     MOVE AG-LAST-MAINT-USER     TO PI-UPDATE-BY
  4989     IF AG-LAST-MAINT-HHMMSS NUMERIC
  4990        MOVE AG-LAST-MAINT-HHMMSS
  4991                                 TO PI-UPDATE-HHMMSS
  4992     ELSE
  4993        MOVE ZEROS               TO PI-UPDATE-HHMMSS
  4994     END-IF
  4995     MOVE AG-CONTROL-PRIMARY     TO PI-SAVE-ERAGTC-KEY
  4996     GO TO 5200-FORMAT-SCREEN
  4997     .
  4998 5100-BROWSE-BKWD.
  4999
  5000* EXEC CICS HANDLE CONDITION
  5001*         NOTFND (5900-END-OF-FILE)
  5002*    END-EXEC
  5003*    MOVE '"$I                   ! '' #00004601' TO DFHEIV0
  5004     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5005     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5006     MOVE X'2720233030303034363031' TO DFHEIV0(25:11)
  5007     CALL 'kxdfhei1' USING DFHEIV0
  5008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5009
  5010* EXEC CICS READPREV
  5011*        DATASET (AGTC-FILE-ID)
  5012*        SET     (ADDRESS OF AGENT-COMMISSIONS)
  5013*        RIDFLD  (WS-CONTROL-PRIMARY)
  5014*    END-EXEC
  5015     MOVE 0
  5016       TO DFHEIV11
  5017*    MOVE '&0S                   )   #00004604' TO DFHEIV0
  5018     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  5019     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5020     MOVE X'2020233030303034363034' TO DFHEIV0(25:11)
  5021     CALL 'kxdfhei1' USING DFHEIV0,
  5022           AGTC-FILE-ID,
  5023           DFHEIV20,
  5024           DFHEIV99,
  5025           WS-CONTROL-PRIMARY,
  5026           DFHEIV99,
  5027           DFHEIV11,
  5028           DFHEIV99,
  5029           DFHEIV99
  5030     SET ADDRESS OF AGENT-COMMISSIONS TO
  5031         DFHEIV20
  5032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5033     IF PI-FILE-EOF
  5034        MOVE SPACE               TO PI-EOF-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL6524.cbl
  5035     ELSE
  5036
  5037* EXEC CICS READPREV
  5038*            DATASET (AGTC-FILE-ID)
  5039*            SET     (ADDRESS OF AGENT-COMMISSIONS)
  5040*            RIDFLD  (WS-CONTROL-PRIMARY)
  5041*       END-EXEC
  5042     MOVE 0
  5043       TO DFHEIV11
  5044*    MOVE '&0S                   )   #00004612' TO DFHEIV0
  5045     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  5046     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5047     MOVE X'2020233030303034363132' TO DFHEIV0(25:11)
  5048     CALL 'kxdfhei1' USING DFHEIV0,
  5049           AGTC-FILE-ID,
  5050           DFHEIV20,
  5051           DFHEIV99,
  5052           WS-CONTROL-PRIMARY,
  5053           DFHEIV99,
  5054           DFHEIV11,
  5055           DFHEIV99,
  5056           DFHEIV99
  5057     SET ADDRESS OF AGENT-COMMISSIONS TO
  5058         DFHEIV20
  5059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5060     END-IF
  5061     MOVE +1                     TO PI-NDX
  5062     IF AG-COMPANY-CD NOT = PI-COMPANY-CD
  5063        GO TO 5900-END-OF-FILE
  5064     END-IF
  5065     MOVE AG-LAST-MAINT-USER     TO PI-UPDATE-BY
  5066     IF AG-LAST-MAINT-HHMMSS NUMERIC
  5067        MOVE AG-LAST-MAINT-HHMMSS
  5068                                 TO PI-UPDATE-HHMMSS
  5069     ELSE
  5070        MOVE ZEROS               TO PI-UPDATE-HHMMSS
  5071     END-IF
  5072     MOVE AG-CONTROL-PRIMARY     TO PI-SAVE-ERAGTC-KEY
  5073     .
  5074 5200-FORMAT-SCREEN.
  5075     MOVE LOW-VALUES             TO EL652EI
  5076     MOVE AG-CONTROL-PRIMARY     TO PI-ERAGTC-KEY
  5077     MOVE AG-CARRIER             TO CARRIERO
  5078     MOVE AG-GROUPING            TO GROUPO
  5079     MOVE AG-BANK                TO BANKO
  5080     MOVE AG-TYPE                TO TYPEO
  5081     IF AG-LAST-MAINT-DT NOT = SPACES AND LOW-VALUES AND ZEROS
  5082        MOVE AG-LAST-MAINT-DT    TO DC-BIN-DATE-1
  5083        MOVE SPACE               TO DC-OPTION-CODE
  5084        PERFORM 8500-DATE-CONVERT
  5085                                 THRU 8500-EXIT
  5086        MOVE DC-GREG-DATE-1-EDIT TO MAINTDTO
  5087     ELSE
  5088        MOVE '00/00/00'          TO MAINTDTO
  5089     END-IF
  5090     MOVE AG-LAST-MAINT-USER     TO MAINTBYO
  5091     IF AG-EXP-DT NOT = HIGH-VALUES
  5092        MOVE AG-EXP-DT           TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL6524.cbl
  5093        MOVE SPACE               TO DC-OPTION-CODE
  5094        PERFORM 8500-DATE-CONVERT
  5095                                 THRU 8500-EXIT
  5096        MOVE DC-GREG-DATE-1-EDIT TO EXPDTO
  5097     ELSE
  5098        MOVE '99/99/99'          TO EXPDTO
  5099     END-IF
  5100     IF AG-EFF-DT NOT = LOW-VALUES AND ZEROS AND SPACES
  5101        MOVE AG-EFF-DT           TO DC-BIN-DATE-1
  5102        MOVE SPACE               TO DC-OPTION-CODE
  5103        PERFORM 8500-DATE-CONVERT
  5104                                 THRU 8500-EXIT
  5105        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  5106     ELSE
  5107        MOVE '00/00/00'          TO EFFDTO
  5108     END-IF
  5109     PERFORM 3000-BLD-LINE       THRU 3000-XIT
  5110     MOVE AL-UANON               TO CARRIERA GROUPA
  5111                                    BANKA TYPEA EXPDTA
  5112     GO TO 8100-SEND-INITIAL-MAP
  5113     .
  5114 5800-NO-RECORD.
  5115     MOVE -1                     TO CARRIERL
  5116     MOVE AL-UANON               TO CARRIERA  GROUPA
  5117                                     BANKA TYPEA
  5118     MOVE ER-1164                TO EMI-ERROR
  5119     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5120     IF BROWSE-STARTED
  5121
  5122* EXEC CICS ENDBR
  5123*            DATASET  (AGTC-FILE-ID)
  5124*       END-EXEC
  5125     MOVE 0
  5126       TO DFHEIV11
  5127*    MOVE '&2                    $   #00004678' TO DFHEIV0
  5128     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5129     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5130     MOVE X'2020233030303034363738' TO DFHEIV0(25:11)
  5131     CALL 'kxdfhei1' USING DFHEIV0,
  5132           AGTC-FILE-ID,
  5133           DFHEIV11,
  5134           DFHEIV99
  5135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5136     END-IF
  5137     GO TO 8200-SEND-DATAONLY
  5138     .
  5139 5900-END-OF-FILE.
  5140     IF EIBAID = DFHPF1
  5141        MOVE 'Y'                 TO PI-EOF-SW
  5142        MOVE ER-2237             TO EMI-ERROR
  5143     ELSE
  5144        MOVE LOW-VALUES          TO PI-ERAGTC-KEY
  5145        MOVE PI-COMPANY-CD       TO PI-AGTC-COMP-CD
  5146        MOVE ER-2238             TO EMI-ERROR
  5147     END-IF
  5148     MOVE -1                     TO CARRIERL
  5149     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  5150     IF BROWSE-STARTED
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL6524.cbl
  5151
  5152* EXEC CICS ENDBR
  5153*            DATASET  (AGTC-FILE-ID)
  5154*       END-EXEC
  5155     MOVE 0
  5156       TO DFHEIV11
  5157*    MOVE '&2                    $   #00004696' TO DFHEIV0
  5158     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5159     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5160     MOVE X'2020233030303034363936' TO DFHEIV0(25:11)
  5161     CALL 'kxdfhei1' USING DFHEIV0,
  5162           AGTC-FILE-ID,
  5163           DFHEIV11,
  5164           DFHEIV99
  5165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5166     END-IF
  5167     MOVE SPACE                  TO BROWSE-STARTED-SW
  5168     GO TO 8200-SEND-DATAONLY
  5169     .
  5170 7050-READ-ERAGTC.
  5171
  5172* EXEC CICS READ
  5173*         SET     (ADDRESS OF AGENT-COMMISSIONS)
  5174*         DATASET ('ERAGTC')
  5175*         RIDFLD  (WS-CONTROL-PRIMARY)
  5176*    END-EXEC
  5177     MOVE 'ERAGTC' TO DFHEIV1
  5178*    MOVE '&"S        E          (   #00004704' TO DFHEIV0
  5179     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5181     MOVE X'2020233030303034373034' TO DFHEIV0(25:11)
  5182     CALL 'kxdfhei1' USING DFHEIV0,
  5183           DFHEIV1,
  5184           DFHEIV20,
  5185           DFHEIV99,
  5186           WS-CONTROL-PRIMARY,
  5187           DFHEIV99,
  5188           DFHEIV99,
  5189           DFHEIV99
  5190     SET ADDRESS OF AGENT-COMMISSIONS TO
  5191         DFHEIV20
  5192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5193     .
  5194 7050-EXIT.
  5195     EXIT.
  5196 7200-READ-ERAGTC-UPDATE.
  5197
  5198* EXEC CICS HANDLE CONDITION
  5199*        NOTFND (7200-AGTC-NOT-FOUND)
  5200*    END-EXEC
  5201*    MOVE '"$I                   ! ( #00004713' TO DFHEIV0
  5202     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5203     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5204     MOVE X'2820233030303034373133' TO DFHEIV0(25:11)
  5205     CALL 'kxdfhei1' USING DFHEIV0
  5206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5207
  5208* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL6524.cbl
  5209*         SET     (ADDRESS OF AGENT-COMMISSIONS)
  5210*         DATASET ('ERAGTC')
  5211*         RIDFLD  (WS-CONTROL-PRIMARY)
  5212*         UPDATE
  5213*    END-EXEC
  5214     MOVE 'ERAGTC' TO DFHEIV1
  5215*    MOVE '&"S        EU         (   #00004716' TO DFHEIV0
  5216     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5217     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5218     MOVE X'2020233030303034373136' TO DFHEIV0(25:11)
  5219     CALL 'kxdfhei1' USING DFHEIV0,
  5220           DFHEIV1,
  5221           DFHEIV20,
  5222           DFHEIV99,
  5223           WS-CONTROL-PRIMARY,
  5224           DFHEIV99,
  5225           DFHEIV99,
  5226           DFHEIV99
  5227     SET ADDRESS OF AGENT-COMMISSIONS TO
  5228         DFHEIV20
  5229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5230     .
  5231 7200-EXIT.
  5232     EXIT.
  5233     .
  5234 7200-AGTC-NOT-FOUND.
  5235     MOVE ER-0142                TO EMI-ERROR
  5236     MOVE -1                     TO CARRIERL
  5237     MOVE AL-UABON               TO CARRIERA
  5238     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  5239     IF EIBTRNID  = EL652-TRANS-ID
  5240        GO TO 8100-SEND-INITIAL-MAP
  5241     ELSE
  5242        GO TO 8200-SEND-DATAONLY
  5243     END-IF
  5244     .
  5245 7300-EDIT-DATA.
  5246     SET NO-LINE-CHANGES         TO TRUE
  5247     PERFORM VARYING NDX FROM +1 BY +1 UNTIL
  5248        (NDX > +10)
  5249        IF (REPRL      (NDX) NOT > +0)
  5250           AND (ATYPEL  (NDX) NOT > +0)
  5251           AND (FEESL   (NDX) NOT > +0)
  5252           AND (RECALL   (NDX) NOT > +0)
  5253           AND (LFEESL   (NDX) NOT > +0)
  5254           AND (LRCALL   (NDX) NOT > +0)
  5255           CONTINUE
  5256        ELSE
  5257         IF REPRL (NDX) > +0
  5258           IF REPR (NDX) = SPACES OR ZEROS
  5259              MOVE SPACES        TO ATYPE (NDX)
  5260                                    RECAL (NDX)
  5261                                    LRCAL (NDX)
  5262              MOVE ZEROS         TO FEES-COMM-R (NDX)
  5263                                    LFEES-COMM-R (NDX)
  5264              MOVE +1            TO ATYPEL  (NDX)
  5265                                    FEESL   (NDX)
  5266                                    RECALL  (NDX)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL6524.cbl
  5267                                    LFEESL  (NDX)
  5268                                    LRCALL  (NDX)
  5269           ELSE
  5270              MOVE WS-CONTROL-PRIMARY (1:8)
  5271                                 TO WS-ERCOMP-KEY (1:8)
  5272              MOVE REPR (NDX)    TO WS-COMP-FINRESP
  5273              MOVE LOW-VALUES    TO WS-COMP-ACCOUNT
  5274              MOVE ATYPE (NDX)   TO WS-COMP-TYPE
  5275              PERFORM 7350-VERIFY-ERCOMP
  5276                                 THRU 7350-EXIT
  5277           END-IF
  5278           SET LINE-CHANGES      TO TRUE
  5279           MOVE REPR (NDX)       TO AG-AGT (NDX)
  5280         END-IF
  5281         IF ATYPEL (NDX) > +0
  5282           SET LINE-CHANGES      TO TRUE
  5283           MOVE ATYPE (NDX)      TO AG-COM-TYP (NDX)
  5284         END-IF
  5285         IF FEESL   (NDX) > +0
  5286           SET LINE-CHANGES      TO TRUE
  5287
  5288* EXEC CICS BIF
  5289*               DEEDIT
  5290*               FIELD   (FEES-COMM-R (NDX))
  5291*               LENGTH  (8)
  5292*          END-EXEC
  5293     MOVE 8
  5294       TO DFHEIV11
  5295*    MOVE '@"L                   #   #00004779' TO DFHEIV0
  5296     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5297     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5298     MOVE X'2020233030303034373739' TO DFHEIV0(25:11)
  5299     CALL 'kxdfhei1' USING DFHEIV0,
  5300           FEES-COMM-R(NDX),
  5301           DFHEIV11
  5302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5303           IF FEES-COMM-R (NDX) NUMERIC
  5304              MOVE FEES-COMM-R (NDX)
  5305                                 TO AG-SPP-FEES (NDX)
  5306           END-IF
  5307         END-IF
  5308         IF RECALL (NDX) > +0
  5309           SET LINE-CHANGES      TO TRUE
  5310           MOVE RECAL (NDX)      TO AG-RECALC-LV-INDIC (NDX)
  5311         END-IF
  5312         IF LFEESL   (NDX) > +0
  5313           SET LINE-CHANGES      TO TRUE
  5314
  5315* EXEC CICS BIF
  5316*               DEEDIT
  5317*               FIELD   (LFEES-COMM-R (NDX))
  5318*               LENGTH  (8)
  5319*          END-EXEC
  5320     MOVE 8
  5321       TO DFHEIV11
  5322*    MOVE '@"L                   #   #00004795' TO DFHEIV0
  5323     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5324     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL6524.cbl
  5325     MOVE X'2020233030303034373935' TO DFHEIV0(25:11)
  5326     CALL 'kxdfhei1' USING DFHEIV0,
  5327           LFEES-COMM-R(NDX),
  5328           DFHEIV11
  5329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5330           IF LFEES-COMM-R (NDX) NUMERIC
  5331              MOVE LFEES-COMM-R (NDX)
  5332                                 TO AG-SPP-LFEES (NDX)
  5333           END-IF
  5334         END-IF
  5335         IF LRCALL (NDX) > +0
  5336           SET LINE-CHANGES      TO TRUE
  5337           MOVE LRCAL (NDX)      TO AG-LRCALC-LV-INDIC (NDX)
  5338         END-IF
  5339         IF AG-AGT (NDX) NOT = SPACES AND ZEROS
  5340            IF AG-COM-TYP (NDX) = SPACES OR ZEROS
  5341               MOVE ER-2173      TO EMI-ERROR
  5342               MOVE -1           TO ATYPEL (NDX)
  5343               MOVE AL-UABON     TO ATYPEA (NDX)
  5344               PERFORM 9900-ERROR-FORMAT
  5345                                 THRU 9900-EXIT
  5346            END-IF
  5347         END-IF
  5348        END-IF
  5349     END-PERFORM
  5350     .
  5351 7300-EXIT.
  5352     EXIT.
  5353 7350-VERIFY-ERCOMP.
  5354
  5355* EXEC CICS READ
  5356*         DATASET  ('ERCOMP')
  5357*         SET      (ADDRESS OF COMPENSATION-MASTER)
  5358*         RIDFLD   (WS-ERCOMP-KEY)
  5359*         RESP     (WS-RESPONSE)
  5360*    END-EXEC
  5361     MOVE 'ERCOMP' TO DFHEIV1
  5362*    MOVE '&"S        E          (  N#00004824' TO DFHEIV0
  5363     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5364     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5365     MOVE X'204E233030303034383234' TO DFHEIV0(25:11)
  5366     CALL 'kxdfhei1' USING DFHEIV0,
  5367           DFHEIV1,
  5368           DFHEIV20,
  5369           DFHEIV99,
  5370           WS-ERCOMP-KEY,
  5371           DFHEIV99,
  5372           DFHEIV99,
  5373           DFHEIV99
  5374     SET ADDRESS OF COMPENSATION-MASTER TO
  5375         DFHEIV20
  5376     MOVE EIBRESP  TO WS-RESPONSE
  5377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5378     IF NOT RESP-NORMAL
  5379        MOVE ER-2230             TO EMI-ERROR
  5380        MOVE -1                  TO REPRL (NDX)
  5381        MOVE AL-UABON            TO REPRA (NDX)
  5382        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL6524.cbl
  5383                                 THRU 9900-EXIT
  5384     END-IF
  5385     .
  5386 7350-EXIT.
  5387     EXIT.
  5388 7375-READ-ERCOMP.
  5389     MOVE +0                     TO WS-TOT-FEES
  5390                                    WS-TOT-LFEES
  5391     MOVE WS-CONTROL-PRIMARY     TO WS-ERCOMP-KEY
  5392
  5393* EXEC CICS READ
  5394*         DATASET  ('ERCOMP')
  5395*         SET      (ADDRESS OF COMPENSATION-MASTER)
  5396*         RIDFLD   (WS-ERCOMP-KEY)
  5397*         RESP     (WS-RESPONSE)
  5398*    END-EXEC
  5399     MOVE 'ERCOMP' TO DFHEIV1
  5400*    MOVE '&"S        E          (  N#00004844' TO DFHEIV0
  5401     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5402     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5403     MOVE X'204E233030303034383434' TO DFHEIV0(25:11)
  5404     CALL 'kxdfhei1' USING DFHEIV0,
  5405           DFHEIV1,
  5406           DFHEIV20,
  5407           DFHEIV99,
  5408           WS-ERCOMP-KEY,
  5409           DFHEIV99,
  5410           DFHEIV99,
  5411           DFHEIV99
  5412     SET ADDRESS OF COMPENSATION-MASTER TO
  5413         DFHEIV20
  5414     MOVE EIBRESP  TO WS-RESPONSE
  5415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5416     IF RESP-NORMAL
  5417        CONTINUE
  5418     ELSE
  5419        MOVE ER-2230             TO EMI-ERROR
  5420        MOVE -1                  TO REPRL (NDX)
  5421        MOVE AL-UABON            TO REPRA (NDX)
  5422        PERFORM 9900-ERROR-FORMAT
  5423                                 THRU 9900-EXIT
  5424     END-IF
  5425     .
  5426 7375-EXIT.
  5427     EXIT.
  5428 7400-READ-CONTROL-FILE.
  5429     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  5430     MOVE WS-ACCESS              TO CNTL-ACCESS
  5431
  5432* EXEC CICS HANDLE CONDITION
  5433*        NOTFND  (7490-NOT-FOUND)
  5434*        ERROR   (9990-ABEND)
  5435*    END-EXEC
  5436*    MOVE '"$I.                  ! ) #00004865' TO DFHEIV0
  5437     MOVE X'2224492E2020202020202020' TO DFHEIV0(1:12)
  5438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5439     MOVE X'2920233030303034383635' TO DFHEIV0(25:11)
  5440     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL6524.cbl
  5441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5442
  5443* EXEC CICS READ
  5444*        DATASET  (CNTL-FILE-ID)
  5445*        SET      (ADDRESS OF CONTROL-FILE)
  5446*        RIDFLD   (ELCNTL-KEY)
  5447*    END-EXEC
  5448*    MOVE '&"S        E          (   #00004869' TO DFHEIV0
  5449     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5450     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5451     MOVE X'2020233030303034383639' TO DFHEIV0(25:11)
  5452     CALL 'kxdfhei1' USING DFHEIV0,
  5453           CNTL-FILE-ID,
  5454           DFHEIV20,
  5455           DFHEIV99,
  5456           ELCNTL-KEY,
  5457           DFHEIV99,
  5458           DFHEIV99,
  5459           DFHEIV99
  5460     SET ADDRESS OF CONTROL-FILE TO
  5461         DFHEIV20
  5462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5463     IF CNTL-REC-TYPE = '6'
  5464        MOVE AL-UANON           TO CARRIERA
  5465        MOVE CARRIERI           TO PI-ERC-CARRIER
  5466        GO TO 7499-EXIT
  5467     END-IF
  5468     .
  5469 7490-NOT-FOUND.
  5470     IF CNTL-REC-TYPE = '6'
  5471        MOVE -1                  TO CARRIERL
  5472        MOVE AL-UABON            TO CARRIERA
  5473        MOVE ER-0193             TO EMI-ERROR
  5474     END-IF
  5475     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  5476     .
  5477 7499-EXIT.
  5478     EXIT.
  5479 8100-SEND-INITIAL-MAP.
  5480     MOVE SAVE-DATE              TO DATEO.
  5481     MOVE EIBTIME                TO TIME-IN.
  5482     MOVE TIME-OUT               TO TIMEO.
  5483     MOVE -1                     TO MAINTYPL
  5484     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  5485
  5486* EXEC CICS SEND
  5487*        MAP    (MAP-NAME)
  5488*        MAPSET (MAPSET-NAME)
  5489*        FROM   (EL652EO)
  5490*        ERASE
  5491*        CURSOR
  5492*        END-EXEC.
  5493     MOVE LENGTH OF
  5494      EL652EO
  5495       TO DFHEIV12
  5496     MOVE -1
  5497       TO DFHEIV11
  5498*    MOVE '8$     CT  E    H L F ,   #00004896' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL6524.cbl
  5499     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5500     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5501     MOVE X'2020233030303034383936' TO DFHEIV0(25:11)
  5502     CALL 'kxdfhei1' USING DFHEIV0,
  5503           MAP-NAME,
  5504           EL652EO,
  5505           DFHEIV12,
  5506           MAPSET-NAME,
  5507           DFHEIV99,
  5508           DFHEIV99,
  5509           DFHEIV99,
  5510           DFHEIV11,
  5511           DFHEIV99,
  5512           DFHEIV99,
  5513           DFHEIV99
  5514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5515
  5516     GO TO 9100-RETURN-TRAN.
  5517 8200-SEND-DATAONLY.
  5518     MOVE SAVE-DATE              TO DATEO.
  5519     MOVE EIBTIME                TO TIME-IN.
  5520     MOVE TIME-OUT               TO TIMEO.
  5521     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  5522
  5523* EXEC CICS SEND
  5524*        MAP    (MAP-NAME)
  5525*        MAPSET (MAPSET-NAME)
  5526*        FROM   (EL652EO)
  5527*        DATAONLY
  5528*        CURSOR
  5529*    END-EXEC.
  5530     MOVE LENGTH OF
  5531      EL652EO
  5532       TO DFHEIV12
  5533     MOVE -1
  5534       TO DFHEIV11
  5535*    MOVE '8$D    CT       H L F ,   #00004909' TO DFHEIV0
  5536     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5537     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5538     MOVE X'2020233030303034393039' TO DFHEIV0(25:11)
  5539     CALL 'kxdfhei1' USING DFHEIV0,
  5540           MAP-NAME,
  5541           EL652EO,
  5542           DFHEIV12,
  5543           MAPSET-NAME,
  5544           DFHEIV99,
  5545           DFHEIV99,
  5546           DFHEIV99,
  5547           DFHEIV11,
  5548           DFHEIV99,
  5549           DFHEIV99,
  5550           DFHEIV99
  5551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5552
  5553     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL6524.cbl
  5555 8500-DATE-CONVERT.
  5556     MOVE LINK-ELDATCV           TO PGM-NAME.
  5557
  5558* EXEC CICS LINK
  5559*        PROGRAM    (PGM-NAME)
  5560*        COMMAREA   (DATE-CONVERSION-DATA)
  5561*        LENGTH     (DC-COMM-LENGTH)
  5562*        END-EXEC.
  5563*    MOVE '."C                   ''   #00004920' TO DFHEIV0
  5564     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5565     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5566     MOVE X'2020233030303034393230' TO DFHEIV0(25:11)
  5567     CALL 'kxdfhei1' USING DFHEIV0,
  5568           PGM-NAME,
  5569           DATE-CONVERSION-DATA,
  5570           DC-COMM-LENGTH,
  5571           DFHEIV99,
  5572           DFHEIV99,
  5573           DFHEIV99
  5574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5575
  5576 8500-EXIT.
  5577     EXIT.
  5578 8600-DEEDIT.
  5579
  5580* EXEC CICS  BIF DEEDIT
  5581*        FIELD   (DEEDIT-FIELD)
  5582*        LENGTH  (8)
  5583*    END-EXEC.
  5584     MOVE 8
  5585       TO DFHEIV11
  5586*    MOVE '@"L                   #   #00004928' TO DFHEIV0
  5587     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5588     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5589     MOVE X'2020233030303034393238' TO DFHEIV0(25:11)
  5590     CALL 'kxdfhei1' USING DFHEIV0,
  5591           DEEDIT-FIELD,
  5592           DFHEIV11
  5593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5594
  5595 8600-EXIT.
  5596      EXIT.
  5597 8810-PF23.
  5598     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  5599     MOVE XCTL-005               TO PGM-NAME.
  5600     GO TO 9300-XCTL.
  5601 9100-RETURN-TRAN.
  5602     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  5603     MOVE '652E'               TO PI-CURRENT-SCREEN-NO.
  5604
  5605* EXEC CICS RETURN
  5606*        TRANSID(TRANS-ID)
  5607*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  5608*        LENGTH(PI-COMM-LENGTH)
  5609*        END-EXEC.
  5610*    MOVE '.(CT                  &   #00004941' TO DFHEIV0
  5611     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5612     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL6524.cbl
  5613     MOVE X'2020233030303034393431' TO DFHEIV0(25:11)
  5614     CALL 'kxdfhei1' USING DFHEIV0,
  5615           TRANS-ID,
  5616           PROGRAM-INTERFACE-BLOCK,
  5617           PI-COMM-LENGTH,
  5618           DFHEIV99,
  5619           DFHEIV99
  5620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5621
  5622
  5623* GOBACK.
  5624     MOVE '9%                    "   ' TO DFHEIV0
  5625     MOVE 'EL6524' TO DFHEIV1
  5626     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5627     GOBACK.
  5628 9910-INITIALIZE-SECURITY.
  5629******************************************************************
  5630*                                                                *
  5631*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  5632*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
  5633*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  5634*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  5635*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  5636*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  5637*                                                                *
  5638******************************************************************
  5639     IF PI-PROCESSOR-ID NOT = 'LGXX'
  5640
  5641* EXEC CICS    READQ TS
  5642*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5643*            INTO    (SECURITY-CONTROL)
  5644*            LENGTH  (SC-COMM-LENGTH)
  5645*            ITEM    (SC-ITEM-CL-CR)
  5646*       END-EXEC
  5647*    MOVE '*$II   L              ''   #00004959' TO DFHEIV0
  5648     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5649     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5650     MOVE X'2020233030303034393539' TO DFHEIV0(25:11)
  5651     CALL 'kxdfhei1' USING DFHEIV0,
  5652           PI-SECURITY-TEMP-STORE-ID,
  5653           SECURITY-CONTROL,
  5654           SC-COMM-LENGTH,
  5655           SC-ITEM-CL-CR,
  5656           DFHEIV99,
  5657           DFHEIV99
  5658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5659        MOVE SC-CREDIT-DISPLAY (05)
  5660                                 TO PI-DISPLAY-CAP
  5661        MOVE SC-CREDIT-UPDATE  (05)
  5662                                 TO PI-MODIFY-CAP
  5663        IF  NOT DISPLAY-CAP
  5664            MOVE 'READ'          TO SM-READ
  5665            PERFORM 9995-SECURITY-VIOLATION
  5666                                 THRU 9995-EXIT
  5667            MOVE ER-0070         TO EMI-ERROR
  5668            PERFORM 9900-ERROR-FORMAT
  5669                                 THRU 9900-EXIT
  5670            GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL6524.cbl
  5671        END-IF
  5672     END-IF
  5673     .
  5674 9910-EXIT.
  5675     EXIT.
  5676 9200-RETURN-MAIN-MENU.
  5677     MOVE XCTL-626               TO PGM-NAME.
  5678     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL6524.cbl
  5680 9300-XCTL.
  5681
  5682* EXEC CICS XCTL
  5683*        PROGRAM    (PGM-NAME)
  5684*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  5685*        LENGTH     (PI-COMM-LENGTH)
  5686*        END-EXEC.
  5687*    MOVE '.$C                   $   #00004987' TO DFHEIV0
  5688     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5689     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5690     MOVE X'2020233030303034393837' TO DFHEIV0(25:11)
  5691     CALL 'kxdfhei1' USING DFHEIV0,
  5692           PGM-NAME,
  5693           PROGRAM-INTERFACE-BLOCK,
  5694           PI-COMM-LENGTH
  5695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5696
  5697 9400-CLEAR.
  5698     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  5699     GO TO 9300-XCTL.
  5700 9500-PF12.
  5701     MOVE XCTL-010               TO PGM-NAME.
  5702     GO TO 9300-XCTL.
  5703 9700-DATE-CONVERSION.
  5704
  5705* EXEC CICS LINK
  5706*        PROGRAM   ('ELDATCV')
  5707*        COMMAREA  (DATE-CONVERSION-DATA)
  5708*        LENGTH    (DC-COMM-LENGTH)
  5709*    END-EXEC.
  5710     MOVE 'ELDATCV' TO DFHEIV1
  5711*    MOVE '."C                   ''   #00004999' TO DFHEIV0
  5712     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5713     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5714     MOVE X'2020233030303034393939' TO DFHEIV0(25:11)
  5715     CALL 'kxdfhei1' USING DFHEIV0,
  5716           DFHEIV1,
  5717           DATE-CONVERSION-DATA,
  5718           DC-COMM-LENGTH,
  5719           DFHEIV99,
  5720           DFHEIV99,
  5721           DFHEIV99
  5722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5723
  5724 9700-EXIT.
  5725     EXIT.
  5726 9900-ERROR-FORMAT.
  5727     IF NOT EMI-ERRORS-COMPLETE
  5728         MOVE LINK-001 TO PGM-NAME
  5729
  5730* EXEC CICS LINK
  5731*            PROGRAM(PGM-NAME)
  5732*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  5733*            LENGTH(EMI-COMM-LENGTH)
  5734*            END-EXEC.
  5735*    MOVE '."C                   ''   #00005009' TO DFHEIV0
  5736     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5737     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL6524.cbl
  5738     MOVE X'2020233030303035303039' TO DFHEIV0(25:11)
  5739     CALL 'kxdfhei1' USING DFHEIV0,
  5740           PGM-NAME,
  5741           ERROR-MESSAGE-INTERFACE-BLOCK,
  5742           EMI-COMM-LENGTH,
  5743           DFHEIV99,
  5744           DFHEIV99,
  5745           DFHEIV99
  5746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5747
  5748 9900-EXIT.
  5749     EXIT.
  5750 9990-ABEND.
  5751     MOVE LINK-004 TO PGM-NAME.
  5752     MOVE DFHEIBLK TO EMI-LINE1.
  5753
  5754* EXEC CICS LINK
  5755*        PROGRAM   (PGM-NAME)
  5756*        COMMAREA  (EMI-LINE1)
  5757*        LENGTH    (72)
  5758*        END-EXEC.
  5759     MOVE 72
  5760       TO DFHEIV11
  5761*    MOVE '."C                   ''   #00005019' TO DFHEIV0
  5762     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5763     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5764     MOVE X'2020233030303035303139' TO DFHEIV0(25:11)
  5765     CALL 'kxdfhei1' USING DFHEIV0,
  5766           PGM-NAME,
  5767           EMI-LINE1,
  5768           DFHEIV11,
  5769           DFHEIV99,
  5770           DFHEIV99,
  5771           DFHEIV99
  5772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5773
  5774     GO TO 8200-SEND-DATAONLY.
  5775 9995-SECURITY-VIOLATION.
  5776*                                COPY ELCSCTP.
  5777******************************************************************
  5778*                                                                *
  5779*                            ELCSCTP                             *
  5780*                            VMOD=2.001                          *
  5781*                                                                *
  5782*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5783******************************************************************
  5784
  5785
  5786     MOVE EIBDATE          TO SM-JUL-DATE.
  5787     MOVE EIBTRMID         TO SM-TERMID.
  5788     MOVE THIS-PGM         TO SM-PGM.
  5789     MOVE EIBTIME          TO TIME-IN.
  5790     MOVE TIME-OUT         TO SM-TIME.
  5791     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5792
  5793
  5794* EXEC CICS LINK
  5795*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL6524.cbl
  5796*         COMMAREA (SECURITY-MESSAGE)
  5797*         LENGTH   (80)
  5798*    END-EXEC.
  5799     MOVE 'EL003' TO DFHEIV1
  5800     MOVE 80
  5801       TO DFHEIV11
  5802*    MOVE '."C                   ''   #00005043' TO DFHEIV0
  5803     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5804     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5805     MOVE X'2020233030303035303433' TO DFHEIV0(25:11)
  5806     CALL 'kxdfhei1' USING DFHEIV0,
  5807           DFHEIV1,
  5808           SECURITY-MESSAGE,
  5809           DFHEIV11,
  5810           DFHEIV99,
  5811           DFHEIV99,
  5812           DFHEIV99
  5813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5814
  5815
  5816******************************************************************
  5817
  5818 9995-EXIT.
  5819      EXIT.
  5820
  5821 9999-DFHBACK SECTION.
  5822     MOVE '9%                    "   ' TO DFHEIV0
  5823     MOVE 'EL6524' TO DFHEIV1
  5824     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5825     GOBACK.
  5826 9999-DFHEXIT.
  5827     IF DFHEIGDJ EQUAL 0001
  5828         NEXT SENTENCE
  5829     ELSE IF DFHEIGDJ EQUAL 2
  5830         GO TO 9990-ABEND,
  5831               8100-SEND-INITIAL-MAP
  5832         DEPENDING ON DFHEIGDI
  5833     ELSE IF DFHEIGDJ EQUAL 3
  5834         GO TO 1500-AGTC-NOT-FOUND,
  5835               0690-QIDERR
  5836         DEPENDING ON DFHEIGDI
  5837     ELSE IF DFHEIGDJ EQUAL 4
  5838         GO TO 1500-AGTC-NOT-FOUND
  5839         DEPENDING ON DFHEIGDI
  5840     ELSE IF DFHEIGDJ EQUAL 5
  5841         GO TO 9990-ABEND,
  5842               4250-CONT
  5843         DEPENDING ON DFHEIGDI
  5844     ELSE IF DFHEIGDJ EQUAL 6
  5845         GO TO 5800-NO-RECORD,
  5846               5900-END-OF-FILE
  5847         DEPENDING ON DFHEIGDI
  5848     ELSE IF DFHEIGDJ EQUAL 7
  5849         GO TO 5900-END-OF-FILE
  5850         DEPENDING ON DFHEIGDI
  5851     ELSE IF DFHEIGDJ EQUAL 8
  5852         GO TO 7200-AGTC-NOT-FOUND
  5853         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL6524.cbl
  5854     ELSE IF DFHEIGDJ EQUAL 9
  5855         GO TO 7490-NOT-FOUND,
  5856               9990-ABEND
  5857         DEPENDING ON DFHEIGDI.
  5858     MOVE '9%                    "   ' TO DFHEIV0
  5859     MOVE 'EL6524' TO DFHEIV1
  5860     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5861     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5104     Code:       14128
