* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page   1
* EL6501.cbl
* Options: int("EL6501.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6501.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6501.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6501.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6501.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/11/94 14:25:07.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.060.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page   2
* EL6501.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC5 - ACCOUNT MAINT (GENERAL)
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    36*                                ADJUSTED MAP-R REDEFINES FILLER
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38*                          SMVA  ADD CLP TOL PCT CODE
    39* 102004                   PEMA  ADD STATUS OF CANCEL
    40* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    41* 021506  CR2006021400002  PEMA  DARKEN DCC FIELDS FOR CID
    42* 052306  CR2006050800002  PEMA  ADD COMM TYPE J
    43* 111606  CR2002061800017  PEMA  FIX ERCOMP UPDATE ROUTINE
    44* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    45* 031607                   PEMA  PER TRWA AND KLSC DEFAULT TO P
    46* 062707  CR2007010300002  PEMA  REMOVE LEV 5 RESTRICTION FOR DCC
    47* 071207                   PEMA  ADD NEW TYPE 'M'
    48* 080807  CR2006062900001  PEMA  AUTOMATE STEPS TO CANCEL ACCT
    49* 022808  CR2007083100002  PEMA  ADD 'F' ACCT STATUS
    50* 042809    2007070200004  PEMA  ADD EDIT FOR KY ACCOUNTS
    51* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    52* 020210  CR2020010400006  PEMA  REMOVE CHANGES MADE ON 09/09
    53* 031811  CR2011012700001  PEMA  ADD 'S' ACCT STATUS
    54* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    55* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    56* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    57* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    58* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    59* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    60* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
    61* 102717  CR2017062000003  PEMA  Add comm cap edits
    62* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    63******************************************************************
    64
    65 ENVIRONMENT DIVISION.
    66 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page   3
* EL6501.cbl
    68 WORKING-STORAGE SECTION.
    69 01  DFH-START PIC X(04).
    70 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    71 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    72                                   USAGE POINTER.
    73 77  FILLER  PIC X(32)  VALUE '********************************'.
    74 77  FILLER  PIC X(32)  VALUE '*    EL6501 WORKING STORAGE    *'.
    75 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.060 ***********'.
    76 77  WS-LAST-DATE-RANGE-SW       PIC X    VALUE SPACES.
    77     88  ON-LAST-DATE-RANGE             VALUE 'Y'.
    78 77  WS-AUTO-CANCEL-SW           PIC X  VALUE ' '.
    79     88  AUTO-CANCEL-ACCOUNT            VALUE 'Y'.
    80 77  WS-DELAY-INT                PIC S9(7) VALUE +2.
    81 77  WS-CHANGE-ALL-CNT           PIC S999  VALUE +0.
    82 01  WS-DEGUG-AREA.
    83     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    84     05  FILLER PIC X(20) VALUE '  PAGE NUMBER HERE  '.
    85     05  WS-PAGE-NUMBER PIC 99 VALUE ZEROS.
    86     05  FILLER PIC X(20) VALUE '  TOTAL LINES HERE  '.
    87     05  WS-TOTAL-LINES PIC 99 VALUE ZEROS.
    88     05  FILLER PIC X(20) VALUE ' LINE SELECTED HERE '.
    89     05  WS-LINE-SELECTED PIC 99 VALUE ZEROS.
    90     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    91 01  S1                          PIC S999   VALUE +0    COMP.
    92 01  WS-WORK-FIELD.
    93     12  WS-WORK-NUM                 PIC 9(5)    VALUE ZEROS.
    94 01  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1500.
    95 01  WS-DATE-AREA.
    96     12  SAVE-DATE               PIC X(8)    VALUE SPACES.
    97     12  SAVE-BIN-DATE           PIC XX      VALUE SPACES.
    98
    99***DMD CUSTOM CODE *****START
   100     12  WS-DMD-EXPR-DATE        PIC 9(8) COMP-3.
   101     12  WS-DMD-AGENT            PIC X(10).
   102     12  WS-YYYYMMDD             PIC X(8).
   103     12  WS-COMP-DATE REDEFINES WS-YYYYMMDD
   104                                 PIC 9(8).
   105***DMD CUSTOM CODE *****END
   106
   107 01  WS-ACCOUNT-NUM-AREA.
   108     12  WS-ACCOUNT-FILLER       PIC X(06).
   109     12  WS-ACCT-BRANCH-CD       PIC X(04).
   110
   111 01  WS-NAME-AREA.
   112     12  WS-NAME-1-4             PIC X(04).
   113     12  WS-NAME-FILLER          PIC X(26).
   114
   115 01  STANDARD-AREAS.
   116     12  WS-STATE-MAX-SW         PIC X       VALUE ' '.
   117         88  EXCEEDS-STATE-MAX      VALUE 'Y'.
   118     12  WS-RESPONSE             PIC S9(8)   COMP.
   119         88  RESP-NORMAL                  VALUE +00.
   120         88  RESP-NOTFND                  VALUE +13.
   121         88  RESP-DUPREC                  VALUE +14.
   122         88  RESP-DUPKEY                  VALUE +15.
   123         88  RESP-NOTOPEN                 VALUE +19.
   124         88  RESP-ENDFILE                 VALUE +20.
   125
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page   4
* EL6501.cbl
   126     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   127     12  MAP-NAME                PIC X(8)    VALUE 'EL6501A'.
   128     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6501S'.
   129     12  SCREEN-NUMBER           PIC X(4)    VALUE '650B'.
   130     12  TRANS-ID                PIC X(4)    VALUE 'EXC5'.
   131     12  THIS-PGM                PIC X(8)    VALUE 'EL6501'.
   132     12  PGM-NAME                PIC X(8).
   133     12  TIME-IN                 PIC S9(7).
   134     12  TIME-OUT-R REDEFINES TIME-IN.
   135         16  FILLER              PIC X.
   136         16  TIME-OUT            PIC 99V99.
   137         16  FILLER              PIC XX.
   138     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   139     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   140     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   141     12  XCTL-601                PIC X(8)    VALUE 'EL601'.
   142     12  XCTL-608                PIC X(8)    VALUE 'EL608'.
   143     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   144     12  XCTL-650                PIC X(8)    VALUE 'EL650'.
   145     12  XCTL-6502               PIC X(8)    VALUE 'EL6502'.
   146     12  XCTL-6503               PIC X(8)    VALUE 'EL6503'.
   147     12  XCTL-6504               PIC X(8)    VALUE 'EL6504'.
   148     12  XCTL-6505               PIC X(8)    VALUE 'EL6505'.
   149     12  XCTL-6506               PIC X(8)    VALUE 'EL6506'.
   150     12  XCTL-652                PIC X(8)    VALUE 'EL652'.
   151     12  XCTL-689                PIC X(8)    VALUE 'EL689'.
   152     12  XCTL-690                PIC X(8)    VALUE 'EL690'.
   153     12  XCTL-653                PIC X(8)    VALUE 'EL653'.
   154     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   155     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   156     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   157     12  FILE-ID                 PIC X(8).
   158     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   159     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   160     12  ERACNT-FILE-ID          PIC X(8)    VALUE 'ERACNT'.
   161     12  REIN-FILE-ID            PIC X(8)    VALUE 'ERREIN'.
   162     12  COMM-FILE-ID            PIC X(8)    VALUE 'ERCTBL'.
   163     12  COMP-FILE-ID            PIC X(8)    VALUE 'ERCOMP'.
   164     12  NAME-FILE-ID            PIC X(8)    VALUE 'ERNAME'.
   165     12  RQST-FILE-ID            PIC X(8)    VALUE 'ERRQST'.
   166     12  RQST3-FILE-ID           PIC X(8)    VALUE 'ERRQST3'.
   167     12  ERGXRF-FILE-ID          PIC X(8)    VALUE 'ERGXRF'.
   168     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   169     12  ERACNT-REC-LEN          PIC S9(4)   VALUE +120   COMP.
   170     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   171     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   172     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   173     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   174     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   175     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   176     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   177     12  CNTL-REC-LEN            PIC S9(4)   VALUE +750   COMP.
   178     12  JRNL-REC-LEN            PIC S9(4)   VALUE ZERO   COMP.
   179*                                copy ERCGXRF.
   180******************************************************************
   181*                                                                *
   182*                                                                *
   183*                            ERCGXRF                             *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page   5
* EL6501.cbl
   184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   185*                            VMOD=2.002                          *
   186*                                                                *
   187*   ONLINE CREDIT SYSTEM                                         *
   188*                                                                *
   189*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   190*                                                                *
   191*   FILE TYPE = VSAM,KSDS                                        *
   192*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   193*                                                                *
   194*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   195*       ALTERNATE PATH = NONE                                    *
   196*                                                                *
   197*   LOG = NO                                                     *
   198*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   199*                                                                *
   200******************************************************************
   201
   202 01  AGENT-CROSS-REFERENCE.
   203     12  GX-RECORD-ID                PIC XX.
   204         88  VALID-GX-ID             VALUE 'GX'.
   205
   206     12  GX-CONTROL-PRIMARY.
   207         16  GX-COMPANY-CD           PIC X.
   208         16  GX-CARRIER              PIC X.
   209         16  GX-GROUPING             PIC X(6).
   210         16  GX-AGENT-NO             PIC X(10).
   211
   212     12  GX-MAINT-INFORMATION.
   213         16  GX-LAST-MAINT-DT        PIC XX.
   214         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   215         16  GX-LAST-MAINT-USER      PIC X(4).
   216         16  FILLER                  PIC X(9).
   217
   218     12  FILLER                      PIC X(37).
   219
   220     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   221
   222     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   223                            DEPENDING ON GX-AGENT-POINTER-CNT.
   224         16  GX-AM-CARRIER           PIC X.
   225         16  GX-AM-GROUPING          PIC X(6).
   226         16  GX-AM-STATE             PIC XX.
   227         16  GX-AM-ACCOUNT           PIC X(10).
   228         16  GX-AM-EXPIRATION-DT     PIC XX.
   229         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   230         16  GX-LAST-BILL-DT         PIC XX.
   231         16  GX-AM-EFF-DT            PIC XX.
   232         16  FILLER                  PIC X(4).
   233
   234******************************************************************
   235 01  ERPDEF-KEY-SAVE             PIC X(18).
   236 01  ERPDEF-KEY.
   237     12  ERPDEF-COMPANY-CD       PIC X.
   238     12  ERPDEF-STATE            PIC XX.
   239     12  ERPDEF-PROD-CD          PIC XXX.
   240     12  F                       PIC X(7).
   241     12  ERPDEF-BEN-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page   6
* EL6501.cbl
   242     12  ERPDEF-BEN-CODE         PIC XX.
   243     12  ERPDEF-EXP-DT           PIC XX.
   244 01  WORK-AREAS-AND-SWITCHES.
   245     12  ws-comp-cd-dis          pic s9(4) comp value +0.
   246     12  filler redefines ws-comp-cd-dis.
   247         16  filler              pic x.
   248         16  ws-comp-cd          pic x.
   249     12  W-ONE                   PIC S9(04)  COMP   VALUE +1.
   250     12  WS-TABLE-MAX            PIC S9V9(4) COMP-3 VALUE +0.
   251     12  WS-ST-COMMISSION-CAPS.
   252         16  WS-ST-COMM-CAP-SL     PIC S9V9(4) COMP-3 VALUE +0.
   253         16  WS-ST-COMM-CAP-JL     PIC S9V9(4) COMP-3 VALUE +0.
   254         16  WS-ST-COMM-CAP-SA     PIC S9V9(4) COMP-3 VALUE +0.
   255         16  WS-ST-COMM-CAP-JA     PIC S9V9(4) COMP-3 VALUE +0.
   256     12  WS-ST-GA-COMMISSION-CAPS.
   257         16  WS-ST-GA-COMM-CAP-SL  PIC S9V9(4) COMP-3 VALUE +0.
   258         16  WS-ST-GA-COMM-CAP-JL  PIC S9V9(4) COMP-3 VALUE +0.
   259         16  WS-ST-GA-COMM-CAP-SA  PIC S9V9(4) COMP-3 VALUE +0.
   260         16  WS-ST-GA-COMM-CAP-JA  PIC S9V9(4) COMP-3 VALUE +0.
   261     12  WS-ST-TOT-COMMISSION-CAPS.
   262         16  WS-ST-TOT-COMM-CAP-SL PIC S9V9(4) COMP-3 VALUE +0.
   263         16  WS-ST-TOT-COMM-CAP-JL PIC S9V9(4) COMP-3 VALUE +0.
   264         16  WS-ST-TOT-COMM-CAP-SA PIC S9V9(4) COMP-3 VALUE +0.
   265         16  WS-ST-TOT-COMM-CAP-JA PIC S9V9(4) COMP-3 VALUE +0.
   266     12  WS-DCC-MAX-MARKET-FEE   PIC S9(5)   COMP-3 VALUE +100.
   267     12  WS-COMM-CAP-LIMIT-TO    PIC X.
   268         88  WS-EXCLUDE-ACCOUNT              VALUE 'A'.
   269         88  WS-EXCLUDE-GA                   VALUE 'G'.
   270         88  WS-EXCLUDE-BOTH                 VALUE 'B'.
   271
   272     12  COMMISSION-ACCUMS.
   273         16  COMM-SL-ACCUM-AL    PIC S9V9(4) COMP-3 VALUE ZERO.
   274         16  COMM-JL-ACCUM-AL    PIC S9V9(4) COMP-3 VALUE ZERO.
   275         16  COMM-AH-ACCUM-AL    PIC S9V9(4) COMP-3 VALUE ZERO.
   276         16  COMM-SL-ACCUM-GL    PIC S9V9(4) COMP-3 VALUE ZERO.
   277         16  COMM-JL-ACCUM-GL    PIC S9V9(4) COMP-3 VALUE ZERO.
   278         16  COMM-AH-ACCUM-GL    PIC S9V9(4) COMP-3 VALUE ZERO.
   279         16  COMM-SL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   280         16  COMM-JL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   281         16  COMM-AH-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   282         16  COMM-MFEE-ACCUM     PIC S9(5)   COMP-3 VALUE ZERO.
   283
   284     12  SAVE-FIN-RESP           PIC X(10)   VALUE SPACES.
   285     12  SAVE-ACCT-AGENT         PIC X(10)   VALUE SPACES.
   286     12  SAVE-NEW-ACCT-AGENT     PIC X(10)   VALUE SPACES.
   287     12  SUB1                    PIC S9(4)   VALUE +0 COMP.
   288     12  WS-NDX                  PIC S9(5)   VALUE +0 COMP-3.
   289     12  CURRENT-SAVE            PIC 9(8).
   290     12  BIN-CURRENT-SAVE        PIC XX.
   291     12  CYMD-CURRENT-SAVE       PIC 9(8).
   292     12  SUB                     PIC 99.
   293     12  AGT-SUB                 PIC 99      VALUE ZEROS.
   294     12  VALID-AGT-SW            PIC X       VALUE 'N'.
   295     12  CHANGE-WAS-MADE-SW      PIC X       VALUE 'N'.
   296         88  CHANGE-WAS-MADE                 VALUE 'Y'.
   297
   298     12  WS-EDIT-BEN-CODE        PIC XX.
   299         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page   7
* EL6501.cbl
   300                                          '90' THRU '99'.
   301
   302     12  WS-KEY-SAVE.
   303           18  WS-ACCT-CCGSA-KEY.
   304             20  WS-ACCT-CO             PIC X.
   305             20  WS-ACCT-CARRIER        PIC X.
   306             20  WS-ACCT-GROUPING       PIC X(6).
   307             20  WS-ACCT-STATE          PIC XX.
   308             20  WS-ACCT-ACCOUNT        PIC X(10).
   309           18  WS-ACCT-EXP-DT           PIC XX.
   310           18  WS-ACCT-REST-OF-EXP      PIC X(4).
   311
   312     12  DEEDIT-FIELD                   PIC X(15).
   313     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   314     12  DEEDIT-FIELD-V1 REDEFINES DEEDIT-FIELD   PIC S9(14)V9.
   315     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD   PIC S9(13)V99.
   316     12  DEEDIT-FIELD-V5 REDEFINES DEEDIT-FIELD   PIC S9(10)V9(5).
   317     12  DEEDIT-FIELD-V6 REDEFINES DEEDIT-FIELD   PIC S9(9)V9(6).
   318
   319     12  ELCNTL-KEY.
   320         16  CNTL-COMP-ID        PIC XXX.
   321         16  CNTL-REC-TYPE       PIC X.
   322         16  CNTL-ACCESS.
   323             20  FILLER          PIC X(4).
   324         16  CNTL-BUS REDEFINES CNTL-ACCESS.
   325             20  FILLER          PIC XX.
   326             20  CNTL-BUS-TYPE   PIC XX.
   327         16  CNTL-BEN REDEFINES CNTL-ACCESS.
   328             20  FILLER          PIC XX.
   329             20  CNTL-BEN-TYPE   PIC XX.
   330         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   331
   332     12  REIN-KEY.
   333         16  REIN-COMP-CD        PIC X.
   334         16  REIN-CODE           PIC X.
   335         16  REIN-TABLE          PIC X(3).
   336         16  FILLER              PIC X(3).
   337
   338     12  WS-HOLD-COMM-KEY        PIC X(7) VALUE LOW-VALUES.
   339     12  COMM-KEY.
   340         16  COMM-COMP-CD        PIC X.
   341         16  COMM-TABLE          PIC XXX.
   342         16  COMM-LF-AH          PIC X.
   343         16  COMM-FILLER         PIC XX    VALUE LOW-VALUES.
   344
   345     12  RQST-KEY.
   346         16  RQST-COMPANY-CD     PIC X     VALUE SPACES.
   347         16  RQST-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   348
   349     12  RQST3-KEY.
   350         16  RQST3-COMPANY-CD    PIC X     VALUE SPACES.
   351         16  RQST3-CARRIER       PIC X     VALUE SPACES.
   352         16  RQST3-GROUPING      PIC X(6)  VALUE SPACES.
   353         16  RQST3-FIN-RESP      PIC X(10) VALUE SPACES.
   354         16  RQST3-ACCT-AGENT    PIC X(10) VALUE SPACES.
   355         16  RQST3-REFERENCE     PIC X(12) VALUE SPACES.
   356         16  RQST3-BATCH         PIC X(6)  VALUE SPACES.
   357
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page   8
* EL6501.cbl
   358     12  SAVE-RQST3-KEY.
   359         16  FILLER              PIC X     VALUE SPACES.
   360         16  FILLER              PIC X     VALUE SPACES.
   361         16  FILLER              PIC X(6)  VALUE SPACES.
   362         16  FILLER              PIC X(10) VALUE SPACES.
   363         16  FILLER              PIC X(10) VALUE SPACES.
   364         16  FILLER              PIC X(12) VALUE SPACES.
   365         16  FILLER              PIC X(6)  VALUE SPACES.
   366
   367     12  COMP-KEY.
   368         16  COMP-COMPANY-CD     PIC X.
   369         16  COMP-CARRIER        PIC X.
   370         16  COMP-GROUPING       PIC X(6).
   371         16  COMP-RESP-NO        PIC X(10).
   372         16  COMP-ACCOUNT        PIC X(10).
   373         16  COMP-TYPE           PIC X.
   374
   375     12  WS-AXRF-KEY.
   376         16  WS-AXRF-COMPANY-CD  PIC X.
   377         16  WS-AXRF-CARRIER     PIC X.
   378         16  WS-AXRF-GROUPING    PIC X(6).
   379         16  WS-AXRF-AGENT-NO    PIC X(10).
   380
   381     12  GX-AM-CONTROL-PRIMARY.
   382         16  GX-AM-COMPANY-CD    PIC X.
   383         16  GX-REST-OF-KEY      PIC X(20).
   384
   385     12  QID.
   386         16  QID-TERM            PIC X(4).
   387         16  FILLER              PIC X(4)    VALUE '6501'.
   388
   389     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   390         88  BROWSE-STARTED         VALUE 'Y'.
   391     12  FIRST-TIME-SW           PIC X       VALUE ' '.
   392         88  FIRST-TIME             VALUE 'Y'.
   393
   394     12  AXRF-SUB                PIC S9(4)  COMP VALUE ZEROS.
   395     12  GX-AGENT-SUB            PIC S9(4)  COMP VALUE ZEROS.
   396     12  COMM-WORK-SUB           PIC S9(4)  COMP VALUE ZEROS.
   397     12  FIND-AGENT-SUB1         PIC S9(4)  COMP VALUE ZEROS.
   398     12  FIND-AGENT-SUB2         PIC S9(4)  COMP VALUE ZEROS.
   399     12  FIND-AGENT-SUB3         PIC S9(4)  COMP VALUE ZEROS.
   400     12  GETMAIN-SW              PIC X       VALUE SPACES.
   401     12  COMMISSION-GETMAIN-SW   PIC X       VALUE SPACES.
   402         88  GETMAIN-ACQUIRED                VALUE 'X'.
   403
   404     12  ER-0000                 PIC X(4)    VALUE '0000'.
   405     12  ER-0002                 PIC X(4)    VALUE '0002'.
   406     12  ER-0004                 PIC X(4)    VALUE '0004'.
   407     12  ER-0008                 PIC X(4)    VALUE '0008'.
   408     12  ER-0023                 PIC X(4)    VALUE '0023'.
   409     12  ER-0029                 PIC X(4)    VALUE '0029'.
   410     12  ER-0033                 PIC X(4)    VALUE '0033'.
   411     12  ER-0144                 PIC X(4)    VALUE '0144'.
   412     12  ER-0070                 PIC X(4)    VALUE '0070'.
   413     12  ER-0250                 PIC X(4)    VALUE '0250'.
   414     12  ER-0348                 PIC X(4)    VALUE '0348'.
   415     12  ER-0454                 PIC X(4)    VALUE '0454'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page   9
* EL6501.cbl
   416     12  ER-0625                 PIC X(4)    VALUE '0625'.
   417     12  ER-0759                 PIC X(4)    VALUE '0759'.
   418     12  ER-0788                 PIC X(4)    VALUE '0788'.
   419     12  ER-0852                 PIC X(4)    VALUE '0852'.
   420     12  ER-0899                 PIC X(4)    VALUE '0899'.
   421     12  ER-1778                 PIC X(4)    VALUE '1778'.
   422     12  ER-1817                 PIC X(4)    VALUE '1817'.
   423     12  ER-1883                 PIC X(4)    VALUE '1883'.
   424     12  ER-1884                 PIC X(4)    VALUE '1884'.
   425     12  ER-1885                 PIC X(4)    VALUE '1885'.
   426     12  ER-1886                 PIC X(4)    VALUE '1886'.
   427     12  ER-1887                 PIC X(4)    VALUE '1887'.
   428     12  ER-1955                 PIC X(4)    VALUE '1955'.
   429     12  ER-1956                 PIC X(4)    VALUE '1956'.
   430     12  ER-1957                 PIC X(4)    VALUE '1957'.
   431     12  ER-1958                 PIC X(4)    VALUE '1958'.
   432     12  ER-1959                 PIC X(4)    VALUE '1959'.
   433     12  ER-1960                 PIC X(4)    VALUE '1960'.
   434     12  ER-1961                 PIC X(4)    VALUE '1961'.
   435     12  ER-1962                 PIC X(4)    VALUE '1962'.
   436     12  ER-1963                 PIC X(4)    VALUE '1963'.
   437     12  ER-2045                 PIC X(4)    VALUE '2045'.
   438     12  ER-2071                 PIC X(4)    VALUE '2071'.
   439     12  ER-2131                 PIC X(4)    VALUE '2131'.
   440*    12  ER-3057                 PIC X(4)    VALUE '3057'.
   441     12  ER-2151                 PIC X(4)    VALUE '2151'.
   442     12  ER-2152                 PIC X(4)    VALUE '2152'.
   443     12  ER-2153                 PIC X(4)    VALUE '2153'.
   444     12  ER-2154                 PIC X(4)    VALUE '2154'.
   445     12  ER-2155                 PIC X(4)    VALUE '2155'.
   446     12  ER-2156                 PIC X(4)    VALUE '2156'.
   447     12  ER-2157                 PIC X(4)    VALUE '2157'.
   448     12  ER-2158                 PIC X(4)    VALUE '2158'.
   449     12  ER-2159                 PIC X(4)    VALUE '2159'.
   450     12  ER-2160                 PIC X(4)    VALUE '2160'.
   451     12  ER-2165                 PIC X(4)    VALUE '2165'.
   452     12  ER-2168                 PIC X(4)    VALUE '2168'.
   453     12  ER-2169                 PIC X(4)    VALUE '2169'.
   454     12  ER-2170                 PIC X(4)    VALUE '2170'.
   455     12  ER-2172                 PIC X(4)    VALUE '2172'.
   456     12  ER-2173                 PIC X(4)    VALUE '2173'.
   457     12  ER-2174                 PIC X(4)    VALUE '2174'.
   458     12  ER-2175                 PIC X(4)    VALUE '2175'.
   459     12  ER-2176                 PIC X(4)    VALUE '2176'.
   460     12  ER-2177                 PIC X(4)    VALUE '2177'.
   461     12  ER-2178                 PIC X(4)    VALUE '2178'.
   462     12  ER-2179                 PIC X(4)    VALUE '2179'.
   463     12  ER-2180                 PIC X(4)    VALUE '2180'.
   464     12  ER-2181                 PIC X(4)    VALUE '2181'.
   465     12  ER-2182                 PIC X(4)    VALUE '2182'.
   466     12  ER-2183                 PIC X(4)    VALUE '2183'.
   467     12  ER-2189                 PIC X(4)    VALUE '2189'.
   468     12  ER-2572                 PIC X(4)    VALUE '2572'.
   469     12  ER-2615                 PIC X(4)    VALUE '2615'.
   470     12  ER-2949                 PIC X(4)    VALUE '2949'.
   471     12  ER-2970                 PIC X(4)    VALUE '2970'.
   472     12  ER-3065                 PIC X(4)    VALUE '3065'.
   473     12  ER-3066                 PIC X(4)    VALUE '3066'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  10
* EL6501.cbl
   474     12  ER-4009                 PIC X(4)    VALUE '4009'.
   475     12  ER-4010                 PIC X(4)    VALUE '4010'.
   476     12  ER-4011                 PIC X(4)    VALUE '4011'.
   477     12  ER-4012                 PIC X(4)    VALUE '4012'.
   478     12  ER-7717                 PIC X(4)    VALUE '7717'.
   479     12  er-8156                 pic x(4)    value '8156'.
   480     12  ER-9999                 PIC X(4)    VALUE '9999'.
   481     12  ER-XXXX                 PIC X(4)    VALUE 'XXXX'.
   482
   483     12  WSS-LINE-LIAB-LIMITS.
   484         16  WSS-LF-LIMITS.
   485             20  WSS-L-TYPE          PIC  XX    VALUE SPACES.
   486             20  WSS-LF-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   487             20  WSS-L-LIMITS        OCCURS 4 TIMES.
   488                 24  WSS-LF-LM-AGE   PIC S99     COMP-3.
   489                 24  WSS-LF-LM-DUR   PIC S999    COMP-3.
   490                 24  WSS-LF-LM-AMT   PIC S9(6)   COMP-3.
   491         16  WSS-AH-LIMITS.
   492             20  WSS-A-TYPE          PIC  XX    VALUE SPACES.
   493             20  WSS-AH-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   494             20  WSS-A-LIMITS        OCCURS 4 TIMES.
   495                 24  WSS-AH-LM-AGE   PIC S99     COMP-3.
   496                 24  WSS-AH-LM-DUR   PIC S999    COMP-3.
   497                 24  WSS-AH-LM-MOA   PIC S9(4)   COMP-3.
   498                 24  WSS-AH-LM-AMT   PIC S9(6)   COMP-3.
   499
   500     12  WSS-COMM-STRUCTURE.
   501         16  WSS-DEFN-1.
   502             20  WSS-AGT-COMMS.
   503                 24  WSS-AGT     PIC  X(10)   VALUE SPACES.
   504                 24  WSS-COM-TYP PIC  X       VALUE SPACES.
   505                 24  WSS-L-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   506                 24  WSS-J-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   507                 24  WSS-A-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   508                 24  FILLER      PIC X(6)     VALUE SPACES.
   509
   510     12  WS-PHONE.
   511         16  WS-PH1              PIC XXX.
   512         16  WS-PH2              PIC XXX.
   513         16  WS-PH3              PIC XXXX.
   514     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   515
   516     12  WS-LIFE-PSI             PIC S9V9(6)  VALUE +0    COMP-3.
   517     12  WS-AH-PSI               PIC S9V9(6)  VALUE +0    COMP-3.
   518     12  WS-ACCOUNT-CTR-C        PIC 99       VALUE ZEROS COMP-3.
   519     12  WS-ACCOUNT-CTR-R        PIC 99       VALUE ZEROS COMP-3.
   520     12  WS-ACCOUNT-CTR-D        PIC 99       VALUE ZEROS COMP-3.
   521     12  WS-BUS-TYPE             PIC 99.
   522     12  WS-BUS-ENTRY            PIC 99.
   523     12  WS-ANVR-DT              PIC 9(11)    VALUE ZEROS.
   524     12  WS-PEFF-DT              PIC 9(11)    VALUE ZEROS.
   525     12  WS-PEXP-DT              PIC 9(11)    VALUE ZEROS.
   526     12  WS-TOL-PREM             PIC S999V99  VALUE ZEROS.
   527     12  WS-TOL-REF              PIC S999V99  VALUE ZEROS.
   528     12  WS-TOL-CLM              PIC S999V99  VALUE ZEROS.
   529     12  WS-COMM-ERROR-SW        PIC 9   COMP-3.
   530         88  COMMISSION-ERROR    VALUE 1.
   531     12  WS-JTYPEID              PIC XX       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  11
* EL6501.cbl
   532     12  AGENT-FIND              PIC X        VALUE SPACES.
   533         88  AGENT-RECORD-NOT-FOUND           VALUE 'X'.
   534         88  ACCT-RECORD-NOT-FOUND            VALUE 'Y'.
   535         88  ACCT-LEVEL-DIFFERENT             VALUE 'Z'.
   536
   537     12  WS-ZIP-CODE.
   538         16  WS-ZIP-1            PIC X.
   539             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   540         16  WS-ZIP-2-3          PIC XX.
   541         16  WS-ZIP-4            PIC X.
   542         16  WS-ZIP-5            PIC X.
   543         16  WS-ZIP-6            PIC X.
   544         16  FILLER              PIC X(4).
   545     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   546         16  WS-ZIP-AM-1-CODE    PIC X(5).
   547         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   548         16  FILLER              PIC X.
   549     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   550         16  WS-ZIP-AM-2-CODE    PIC X(5).
   551         16  WS-ZIP-AM-2-DASH    PIC X.
   552         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   553     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   554         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   555         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   556         16  FILLER              PIC X(4).
   557     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   558         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   559         16  FILLER              PIC X.
   560         16  WS-ZIP-CAN-2-POST2  PIC XXX.
   561         16  FILLER              PIC XXX.
   562     12  WS-SOC-SEC-WORK.
   563         16  WS-SS-TYPE          PIC X.
   564         16  WS-SOC-SEC          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  12
* EL6501.cbl
   566*    COPY ELCSCTM.
   567******************************************************************
   568*                                                                *
   569*                                                                *
   570*                            ELCSCTM                             *
   571*                            VMOD=2.001                          *
   572*                                                                *
   573*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   574*                                                                *
   575******************************************************************
   576 01  SECURITY-MESSAGE.
   577     12  FILLER                          PIC X(30)
   578            VALUE '** LOGIC SECURITY VIOLATION -'.
   579     12  SM-READ                         PIC X(6).
   580     12  FILLER                          PIC X(5)
   581            VALUE ' PGM='.
   582     12  SM-PGM                          PIC X(6).
   583     12  FILLER                          PIC X(5)
   584            VALUE ' OPR='.
   585     12  SM-PROCESSOR-ID                 PIC X(4).
   586     12  FILLER                          PIC X(6)
   587            VALUE ' TERM='.
   588     12  SM-TERMID                       PIC X(4).
   589     12  FILLER                          PIC XX   VALUE SPACE.
   590     12  SM-JUL-DATE                     PIC 9(5).
   591     12  FILLER                          PIC X    VALUE SPACE.
   592     12  SM-TIME                         PIC 99.99.
   593
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  13
* EL6501.cbl
   595*    COPY ELCSCRTY.
   596******************************************************************
   597*                                                                *
   598*                                                                *
   599*                            ELCSCRTY                            *
   600*                            VMOD=2.001                          *
   601*                                                                *
   602*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   603*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   604*        SAVED IN PI-SECURITY-ADDRESS.                           *
   605*                                                                *
   606******************************************************************
   607 01  SECURITY-CONTROL.
   608     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   609     12  FILLER                       PIC XX    VALUE 'SC'.
   610     12  SC-CREDIT-CODES.
   611         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   612             20  SC-CREDIT-DISPLAY    PIC X.
   613             20  SC-CREDIT-UPDATE     PIC X.
   614     12  SC-CLAIMS-CODES.
   615         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   616             20  SC-CLAIMS-DISPLAY    PIC X.
   617             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  14
* EL6501.cbl
   619*    COPY ELCLOGOF.
   620******************************************************************
   621*                                                                *
   622*                                                                *
   623*                            ELCLOGOF.                           *
   624*                            VMOD=2.001                          *
   625*                                                                *
   626*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   627*                                                                *
   628******************************************************************
   629 01  CLASIC-LOGOFF.
   630     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   631     12  LOGOFF-TEXT.
   632         16  FILLER          PIC X(5)    VALUE SPACES.
   633         16  LOGOFF-MSG.
   634             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   635             20  FILLER      PIC X       VALUE SPACES.
   636             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   637         16  FILLER          PIC X(80)
   638           VALUE '* YOU ARE NOW LOGGED OFF'.
   639         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   640         16  FILLER          PIC X       VALUE QUOTE.
   641         16  LOGOFF-SYS-MSG  PIC X(17)
   642           VALUE 'S CLAS-IC SYSTEM '.
   643     12  TEXT-MESSAGES.
   644         16  UNACCESS-MSG    PIC X(29)
   645             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   646         16  PGMIDERR-MSG    PIC X(17)
   647             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  15
* EL6501.cbl
   649*    COPY ELCDATE.
   650******************************************************************
   651*                                                                *
   652*                                                                *
   653*                            ELCDATE.                            *
   654*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   655*                            VMOD=2.003
   656*                                                                *
   657*                                                                *
   658*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   659*                 LENGTH = 200                                   *
   660******************************************************************
   661
   662 01  DATE-CONVERSION-DATA.
   663     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   664     12  DC-OPTION-CODE                PIC X.
   665         88  BIN-TO-GREG                VALUE ' '.
   666         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   667         88  EDIT-GREG-TO-BIN           VALUE '2'.
   668         88  YMD-GREG-TO-BIN            VALUE '3'.
   669         88  MDY-GREG-TO-BIN            VALUE '4'.
   670         88  JULIAN-TO-BIN              VALUE '5'.
   671         88  BIN-PLUS-ELAPSED           VALUE '6'.
   672         88  FIND-CENTURY               VALUE '7'.
   673         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   674         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   675         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   676         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   677         88  JULIAN-TO-BIN-3            VALUE 'C'.
   678         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   679         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   680         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   681         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   682         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   683         88  CHECK-LEAP-YEAR            VALUE 'H'.
   684         88  BIN-3-TO-GREG              VALUE 'I'.
   685         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   686         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   687         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   688         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   689         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   690         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   691         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   692         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   693         88  THREE-CHARACTER-BIN
   694                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   695         88  GREGORIAN-TO-BIN
   696                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   697         88  BIN-TO-GREGORIAN
   698                  VALUES ' ' '1' 'I' '8' 'G'.
   699         88  JULIAN-TO-BINARY
   700                  VALUES '5' 'C' 'E' 'F'.
   701     12  DC-ERROR-CODE                 PIC X.
   702         88  NO-CONVERSION-ERROR        VALUE ' '.
   703         88  DATE-CONVERSION-ERROR
   704                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   705         88  DATE-IS-ZERO               VALUE '1'.
   706         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  16
* EL6501.cbl
   707         88  DATE-IS-INVALID            VALUE '3'.
   708         88  DATE1-GREATER-DATE2        VALUE '4'.
   709         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   710         88  DATE-INVALID-OPTION        VALUE '9'.
   711         88  INVALID-CENTURY            VALUE 'A'.
   712         88  ONLY-CENTURY               VALUE 'B'.
   713         88  ONLY-LEAP-YEAR             VALUE 'C'.
   714         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   715     12  DC-END-OF-MONTH               PIC X.
   716         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   717     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   718         88  USE-NORMAL-PROCESS         VALUE ' '.
   719         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   720         88  ADJUST-UP-100-YRS          VALUE '2'.
   721     12  FILLER                        PIC X.
   722     12  DC-CONVERSION-DATES.
   723         16  DC-BIN-DATE-1             PIC XX.
   724         16  DC-BIN-DATE-2             PIC XX.
   725         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   726         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   727                       DC-GREG-DATE-1-EDIT.
   728             20  DC-EDIT1-MONTH        PIC 99.
   729             20  SLASH1-1              PIC X.
   730             20  DC-EDIT1-DAY          PIC 99.
   731             20  SLASH1-2              PIC X.
   732             20  DC-EDIT1-YEAR         PIC 99.
   733         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   734         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   735                     DC-GREG-DATE-2-EDIT.
   736             20  DC-EDIT2-MONTH        PIC 99.
   737             20  SLASH2-1              PIC X.
   738             20  DC-EDIT2-DAY          PIC 99.
   739             20  SLASH2-2              PIC X.
   740             20  DC-EDIT2-YEAR         PIC 99.
   741         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   742         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   743                     DC-GREG-DATE-1-YMD.
   744             20  DC-YMD-YEAR           PIC 99.
   745             20  DC-YMD-MONTH          PIC 99.
   746             20  DC-YMD-DAY            PIC 99.
   747         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   748         16  DC-GREG-DATE-1-MDY-R REDEFINES
   749                      DC-GREG-DATE-1-MDY.
   750             20  DC-MDY-MONTH          PIC 99.
   751             20  DC-MDY-DAY            PIC 99.
   752             20  DC-MDY-YEAR           PIC 99.
   753         16  DC-GREG-DATE-1-ALPHA.
   754             20  DC-ALPHA-MONTH        PIC X(10).
   755             20  DC-ALPHA-DAY          PIC 99.
   756             20  FILLER                PIC XX.
   757             20  DC-ALPHA-CENTURY.
   758                 24 DC-ALPHA-CEN-N     PIC 99.
   759             20  DC-ALPHA-YEAR         PIC 99.
   760         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   761         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   762         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   763         16  DC-JULIAN-DATE            PIC 9(05).
   764         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  17
* EL6501.cbl
   765                                       PIC 9(05).
   766         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   767             20  DC-JULIAN-YEAR        PIC 99.
   768             20  DC-JULIAN-DAYS        PIC 999.
   769         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   770         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   771         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   772     12  DATE-CONVERSION-VARIBLES.
   773         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   774         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   775             20  FILLER                PIC 9(3).
   776             20  HOLD-CEN-1-CCYY.
   777                 24  HOLD-CEN-1-CC     PIC 99.
   778                 24  HOLD-CEN-1-YY     PIC 99.
   779             20  HOLD-CEN-1-MO         PIC 99.
   780             20  HOLD-CEN-1-DA         PIC 99.
   781         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   782             20  HOLD-CEN-1-R-MO       PIC 99.
   783             20  HOLD-CEN-1-R-DA       PIC 99.
   784             20  HOLD-CEN-1-R-CCYY.
   785                 24  HOLD-CEN-1-R-CC   PIC 99.
   786                 24  HOLD-CEN-1-R-YY   PIC 99.
   787             20  FILLER                PIC 9(3).
   788         16  HOLD-CENTURY-1-X.
   789             20  FILLER                PIC X(3)  VALUE SPACES.
   790             20  HOLD-CEN-1-X-CCYY.
   791                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   792                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   793             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   794             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   795         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   796             20  HOLD-CEN-1-R-X-MO     PIC XX.
   797             20  HOLD-CEN-1-R-X-DA     PIC XX.
   798             20  HOLD-CEN-1-R-X-CCYY.
   799                 24  HOLD-CEN-1-R-X-CC PIC XX.
   800                 24  HOLD-CEN-1-R-X-YY PIC XX.
   801             20  FILLER                PIC XXX.
   802         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   803         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   804         16  DC-JULIAN-DATE-1          PIC 9(07).
   805         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   806             20  DC-JULIAN-1-CCYY.
   807                 24  DC-JULIAN-1-CC    PIC 99.
   808                 24  DC-JULIAN-1-YR    PIC 99.
   809             20  DC-JULIAN-DA-1        PIC 999.
   810         16  DC-JULIAN-DATE-2          PIC 9(07).
   811         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   812             20  DC-JULIAN-2-CCYY.
   813                 24  DC-JULIAN-2-CC    PIC 99.
   814                 24  DC-JULIAN-2-YR    PIC 99.
   815             20  DC-JULIAN-DA-2        PIC 999.
   816         16  DC-GREG-DATE-A-EDIT.
   817             20  DC-EDITA-MONTH        PIC 99.
   818             20  SLASHA-1              PIC X VALUE '/'.
   819             20  DC-EDITA-DAY          PIC 99.
   820             20  SLASHA-2              PIC X VALUE '/'.
   821             20  DC-EDITA-CCYY.
   822                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  18
* EL6501.cbl
   823                 24  DC-EDITA-YEAR     PIC 99.
   824         16  DC-GREG-DATE-B-EDIT.
   825             20  DC-EDITB-MONTH        PIC 99.
   826             20  SLASHB-1              PIC X VALUE '/'.
   827             20  DC-EDITB-DAY          PIC 99.
   828             20  SLASHB-2              PIC X VALUE '/'.
   829             20  DC-EDITB-CCYY.
   830                 24  DC-EDITB-CENT     PIC 99.
   831                 24  DC-EDITB-YEAR     PIC 99.
   832         16  DC-GREG-DATE-CYMD         PIC 9(08).
   833         16  DC-GREG-DATE-CYMD-R REDEFINES
   834                              DC-GREG-DATE-CYMD.
   835             20  DC-CYMD-CEN           PIC 99.
   836             20  DC-CYMD-YEAR          PIC 99.
   837             20  DC-CYMD-MONTH         PIC 99.
   838             20  DC-CYMD-DAY           PIC 99.
   839         16  DC-GREG-DATE-MDCY         PIC 9(08).
   840         16  DC-GREG-DATE-MDCY-R REDEFINES
   841                              DC-GREG-DATE-MDCY.
   842             20  DC-MDCY-MONTH         PIC 99.
   843             20  DC-MDCY-DAY           PIC 99.
   844             20  DC-MDCY-CEN           PIC 99.
   845             20  DC-MDCY-YEAR          PIC 99.
   846    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   847        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   848    12  DC-EL310-DATE                  PIC X(21).
   849    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  19
* EL6501.cbl
   851*    COPY ELCATTR.
   852******************************************************************
   853*                                                                *
   854*                            ELCATTR.                            *
   855*                            VMOD=2.001                          *
   856*                                                                *
   857*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   858*                                                                *
   859*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   860*                                                                *
   861*                   POS 1   P=PROTECTED                          *
   862*                           U=UNPROTECTED                        *
   863*                           S=ASKIP                              *
   864*                   POS 2   A=ALPHA/NUMERIC                      *
   865*                           N=NUMERIC                            *
   866*                   POS 3   N=NORMAL                             *
   867*                           B=BRIGHT                             *
   868*                           D=DARK                               *
   869*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   870*                           OF=MODIFIED DATA TAG OFF             *
   871*                                                                *
   872*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   873******************************************************************
   874 01  ATTRIBUTE-LIST.
   875     12  AL-PABOF            PIC X       VALUE 'Y'.
   876     12  AL-PABON            PIC X       VALUE 'Z'.
   877     12  AL-PADOF            PIC X       VALUE '%'.
   878     12  AL-PADON            PIC X       VALUE '_'.
   879     12  AL-PANOF            PIC X       VALUE '-'.
   880     12  AL-PANON            PIC X       VALUE '/'.
   881     12  AL-SABOF            PIC X       VALUE '8'.
   882     12  AL-SABON            PIC X       VALUE '9'.
   883     12  AL-SADOF            PIC X       VALUE '@'.
   884     12  AL-SADON            PIC X       VALUE QUOTE.
   885     12  AL-SANOF            PIC X       VALUE '0'.
   886     12  AL-SANON            PIC X       VALUE '1'.
   887     12  AL-UABOF            PIC X       VALUE 'H'.
   888     12  AL-UABON            PIC X       VALUE 'I'.
   889     12  AL-UADOF            PIC X       VALUE '<'.
   890     12  AL-UADON            PIC X       VALUE '('.
   891     12  AL-UANOF            PIC X       VALUE ' '.
   892     12  AL-UANON            PIC X       VALUE 'A'.
   893     12  AL-UNBOF            PIC X       VALUE 'Q'.
   894     12  AL-UNBON            PIC X       VALUE 'R'.
   895     12  AL-UNDOF            PIC X       VALUE '*'.
   896     12  AL-UNDON            PIC X       VALUE ')'.
   897     12  AL-UNNOF            PIC X       VALUE '&'.
   898     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  20
* EL6501.cbl
   900*    COPY ELCEMIB.
   901******************************************************************
   902*                                                                *
   903*                                                                *
   904*                            ELCEMIB.                            *
   905*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   906*                            VMOD=2.005                          *
   907*                                                                *
   908*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   909*                                                                *
   910******************************************************************
   911 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   912     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   913     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   914     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   915     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   916     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   917     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   918     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   919     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   920     12  EMI-SWITCH1             PIC X        VALUE '1'.
   921         88  EMI-NO-ERRORS                    VALUE '1'.
   922         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   923         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   924     12  EMI-SWITCH2             PIC X        VALUE '1'.
   925         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   926     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   927         88  EMI-AREA1-EMPTY                  VALUE '1'.
   928         88  EMI-AREA1-FULL                   VALUE '2'.
   929     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   930         88  EMI-AREA2-EMPTY                  VALUE '1'.
   931         88  EMI-AREA2-FULL                   VALUE '2'.
   932     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   933         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   934         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   935         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   936         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   937         88  EMI-BYPASS-FATALS                VALUE 'X'.
   938     12  EMI-ERROR-LINES.
   939         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   940         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   941         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   942         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   943             20  EMI-ERR-CODES OCCURS 10 TIMES.
   944                 24  EMI-ERR-NUM         PIC X(4).
   945                 24  EMI-FILLER          PIC X.
   946                 24  EMI-SEV             PIC X.
   947                 24  FILLER              PIC X.
   948             20  FILLER                  PIC X(02).
   949     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   950         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   951             20  EMI-ERROR-NUMBER    PIC X(4).
   952             20  EMI-FILL            PIC X.
   953             20  EMI-SEVERITY        PIC X.
   954             20  FILLER              PIC X.
   955             20  EMI-ERROR-TEXT.
   956                 24  EMI-TEXT-VARIABLE   PIC X(10).
   957                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  21
* EL6501.cbl
   958     12  EMI-SEVERITY-SAVE           PIC X.
   959         88  EMI-NOTE                    VALUE 'N'.
   960         88  EMI-WARNING                 VALUE 'W'.
   961         88  EMI-FORCABLE                VALUE 'F'.
   962         88  EMI-FATAL                   VALUE 'X'.
   963     12  EMI-MESSAGE-FLAG            PIC X.
   964         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   965         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   966     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   967     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   968         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   969         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   970         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   971     12  emi-claim-no                pic x(7).
   972     12  emi-claim-type              pic x(6).
   973     12  FILLER                      PIC X(124)  VALUE SPACES.
   974     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   975     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   976     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   977     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  22
* EL6501.cbl
   979*    COPY ELCINTF.
   980******************************************************************
   981*                                                                *
   982*                                                                *
   983*                            ELCINTF.                            *
   984*                            VMOD=2.017                          *
   985*                                                                *
   986*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   987*                                                                *
   988*       LENGTH = 1024                                            *
   989*                                                                *
   990******************************************************************
   991*                   C H A N G E   L O G
   992*
   993* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   994*-----------------------------------------------------------------
   995*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   996* EFFECTIVE    NUMBER
   997*-----------------------------------------------------------------
   998* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   999******************************************************************
  1000 01  PROGRAM-INTERFACE-BLOCK.
  1001     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1002     12  PI-CALLING-PROGRAM              PIC X(8).
  1003     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1004     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1005     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1006     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1007     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1008     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1009     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1010     12  PI-COMPANY-ID                   PIC XXX.
  1011     12  PI-COMPANY-CD                   PIC X.
  1012
  1013     12  PI-COMPANY-PASSWORD             PIC X(8).
  1014
  1015     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1016
  1017     12  PI-CONTROL-IN-PROGRESS.
  1018         16  PI-CARRIER                  PIC X.
  1019         16  PI-GROUPING                 PIC X(6).
  1020         16  PI-STATE                    PIC XX.
  1021         16  PI-ACCOUNT                  PIC X(10).
  1022         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1023                                         PIC X(10).
  1024         16  PI-CLAIM-CERT-GRP.
  1025             20  PI-CLAIM-NO             PIC X(7).
  1026             20  PI-CERT-NO.
  1027                 25  PI-CERT-PRIME       PIC X(10).
  1028                 25  PI-CERT-SFX         PIC X.
  1029             20  PI-CERT-EFF-DT          PIC XX.
  1030         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1031             20  PI-PLAN-CODE            PIC X(2).
  1032             20  PI-REVISION-NUMBER      PIC X(3).
  1033             20  PI-PLAN-EFF-DT          PIC X(2).
  1034             20  PI-PLAN-EXP-DT          PIC X(2).
  1035             20  FILLER                  PIC X(11).
  1036         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  23
* EL6501.cbl
  1037             20  PI-OE-REFERENCE-1.
  1038                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1039                 25  PI-OE-REF-1-SUFF    PIC XX.
  1040
  1041     12  PI-SESSION-IN-PROGRESS          PIC X.
  1042         88  CLAIM-SESSION                   VALUE '1'.
  1043         88  CREDIT-SESSION                  VALUE '2'.
  1044         88  WARRANTY-SESSION                VALUE '3'.
  1045         88  MORTGAGE-SESSION                VALUE '4'.
  1046         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1047
  1048
  1049*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1050
  1051     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1052     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1053
  1054     12  PI-CREDIT-USER                  PIC X.
  1055         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1056         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1057
  1058     12  PI-CLAIM-USER                   PIC X.
  1059         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1060         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1061
  1062     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1063         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1064         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1065         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1066         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1067         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1068
  1069     12  PI-PROCESSOR-ID                 PIC X(4).
  1070
  1071     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1072
  1073     12  PI-MEMBER-CAPTION               PIC X(10).
  1074
  1075     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1076         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1077
  1078     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1079     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1080     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1081     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1082
  1083     12  PI-AH-OVERRIDE-L1               PIC X.
  1084     12  PI-AH-OVERRIDE-L2               PIC XX.
  1085     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1086     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1087
  1088     12  PI-NEW-SYSTEM                   PIC X(2).
  1089
  1090     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1091     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1092         88  PI-USES-PAID-TO                 VALUE '1'.
  1093     12  PI-CRDTCRD-SYSTEM.
  1094         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  24
* EL6501.cbl
  1095             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1096             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1097         16  PI-CC-MONTH-END-DT          PIC XX.
  1098     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1099
  1100     12  PI-OE-REFERENCE-2.
  1101         16  PI-OE-REF-2-PRIME           PIC X(10).
  1102         16  PI-OE-REF-2-SUFF            PIC X.
  1103
  1104     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1105
  1106     12  PI-LANGUAGE-TYPE                PIC X.
  1107             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1108             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1109             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1110
  1111     12  PI-POLICY-LINKAGE-IND           PIC X.
  1112         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1113         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1114                                                   LOW-VALUES.
  1115
  1116     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1117     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1118         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1119         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1120
  1121     12  PI-PROCESSOR-CSR-IND            PIC X.
  1122         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1123         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1124
  1125     12  FILLER                          PIC X(3).
  1126
  1127     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1128
  1129     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1130         PI-SYSTEM-LEVEL.
  1131
  1132         16  PI-ENTRY-CODES.
  1133             20  PI-ENTRY-CD-1           PIC X.
  1134             20  PI-ENTRY-CD-2           PIC X.
  1135
  1136         16  PI-RETURN-CODES.
  1137             20  PI-RETURN-CD-1          PIC X.
  1138             20  PI-RETURN-CD-2          PIC X.
  1139
  1140         16  PI-UPDATE-STATUS-SAVE.
  1141             20  PI-UPDATE-BY            PIC X(4).
  1142             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1143
  1144         16  PI-LOWER-CASE-LETTERS       PIC X.
  1145             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1146
  1147*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1148*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1149*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1150
  1151         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1152             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  25
* EL6501.cbl
  1153             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1154             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1155             88  ACCNT-CNTL                  VALUE '3'.
  1156             88  CARR-ACCNT-CNTL             VALUE '4'.
  1157
  1158         16  PI-PROCESSOR-CAP-LIST.
  1159             20  PI-SYSTEM-CONTROLS.
  1160                24 PI-SYSTEM-DISPLAY     PIC X.
  1161                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1162                24 PI-SYSTEM-MODIFY      PIC X.
  1163                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1164             20  FILLER                  PIC XX.
  1165             20  PI-DISPLAY-CAP          PIC X.
  1166                 88  DISPLAY-CAP             VALUE 'Y'.
  1167             20  PI-MODIFY-CAP           PIC X.
  1168                 88  MODIFY-CAP              VALUE 'Y'.
  1169             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1170                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1171             20  PI-FORCE-CAP            PIC X.
  1172                 88  FORCE-CAP               VALUE 'Y'.
  1173
  1174         16  PI-PROGRAM-CONTROLS.
  1175             20  PI-PGM-PRINT-OPT        PIC X.
  1176             20  PI-PGM-FORMAT-OPT       PIC X.
  1177             20  PI-PGM-PROCESS-OPT      PIC X.
  1178             20  PI-PGM-TOTALS-OPT       PIC X.
  1179
  1180         16  PI-HELP-INTERFACE.
  1181             20  PI-LAST-ERROR-NO        PIC X(4).
  1182             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1183
  1184         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1185             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1186
  1187         16  PI-CR-CONTROL-IN-PROGRESS.
  1188             20  PI-CR-CARRIER           PIC X.
  1189             20  PI-CR-GROUPING          PIC X(6).
  1190             20  PI-CR-STATE             PIC XX.
  1191             20  PI-CR-ACCOUNT           PIC X(10).
  1192             20  PI-CR-FIN-RESP          PIC X(10).
  1193             20  PI-CR-TYPE              PIC X.
  1194
  1195         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1196
  1197         16  PI-CR-MONTH-END-DT          PIC XX.
  1198
  1199         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1200             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1201             88  PI-ZERO-CARRIER             VALUE '1'.
  1202             88  PI-ZERO-GROUPING            VALUE '2'.
  1203             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1204
  1205         16  PI-CARRIER-SECURITY         PIC X.
  1206             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1207
  1208         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1209             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1210             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  26
* EL6501.cbl
  1211
  1212         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1213             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1214                                         INDEXED BY PI-ACCESS-NDX
  1215                                         PIC X.
  1216
  1217         16  PI-GA-BILLING-CONTROL       PIC X.
  1218             88  PI-GA-BILLING               VALUE '1'.
  1219
  1220         16  PI-MAIL-PROCESSING          PIC X.
  1221             88  PI-MAIL-YES                 VALUE 'Y'.
  1222
  1223         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1224
  1225         16  PI-AR-SYSTEM.
  1226             20  PI-AR-PROCESSING-CNTL   PIC X.
  1227                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1228             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1229             20  PI-AR-MONTH-END-DT      PIC XX.
  1230
  1231         16  PI-MP-SYSTEM.
  1232             20  PI-MORTGAGE-USER            PIC X.
  1233                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1234                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1235             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1236                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1237                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1238                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1239                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1240                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1241             20  PI-MP-MONTH-END-DT          PIC XX.
  1242             20  PI-MP-REFERENCE-NO.
  1243                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1244                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1245
  1246         16  PI-LABEL-CONTROL            PIC X(01).
  1247             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1248             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1249
  1250         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1251             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1252
  1253         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1254             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1255             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1256
  1257         16  FILLER                      PIC X(14).
  1258
  1259     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1260******************************************************************
  1261*    COPY ELC650PI.
  1262******************************************************************
  1263*
  1264*                            ELC650PI.
  1265*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1266*                            VMOD=2.007
  1267*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1268*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  27
* EL6501.cbl
  1269* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1270*
  1271******************************************************************
  1272******************************************************************
  1273*                   C H A N G E   L O G
  1274*
  1275* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1276*-----------------------------------------------------------------
  1277*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1278* EFFECTIVE    NUMBER
  1279*-----------------------------------------------------------------
  1280* 101916  IR2016101900001  PEMA  Inc tot line to 3 bytes
  1281
  1282     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1283         16  PI-MAINT                   PIC X.
  1284         16  PI-PREV-ACCOUNT            PIC X(20).
  1285         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1286         16  PI-ACCT-KEY.
  1287             20  PI-ACCT-CCGSA-KEY.
  1288                 24  PI-ACCT-CO             PIC X.
  1289                 24  PI-ACCT-CARRIER        PIC X.
  1290                 24  PI-ACCT-GROUPING       PIC X(6).
  1291                 24  PI-ACCT-STATE          PIC XX.
  1292                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1293             20  PI-ACCT-EXP-DT           PIC XX.
  1294             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1295         16  PI-ACCT-ID                 PIC X(8).
  1296         16  PI-PLAN-KEY.
  1297             20  PI-PLAN-ACCT-KEY.
  1298                 24  PI-PLAN-COMPANY-CD PIC X.
  1299                 24  PI-PLAN-CARRIER    PIC X.
  1300                 24  PI-PLAN-GROUP      PIC X(6).
  1301                 24  PI-PLAN-STATE      PIC X(2).
  1302                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1303             20  PI-PLAN-BEN-TYPE       PIC X.
  1304             20  PI-PLAN-BEN            PIC XX.
  1305             20  PI-PLAN-REVISION       PIC X(3).
  1306         16  PI-WS-STATE                PIC XX.
  1307         16  PI-WS-CLASS                PIC XX.
  1308         16  PI-WS-DEV                  PIC X(3).
  1309         16  PI-WS-TYPE                 PIC X.
  1310         16  PI-WS-PLAN                 PIC XX.
  1311
  1312         16  PI-ERPNDB-ALT-KEY.
  1313             20  PI-PB-COMPANY-CD-A1    PIC X.
  1314             20  PI-PB-CARRIER          PIC X.
  1315             20  PI-PB-GROUPING         PIC X(6).
  1316             20  PI-PB-STATE            PIC XX.
  1317             20  PI-PB-ACCOUNT          PIC X(10).
  1318             20  PI-PB-CERT-EFF-DT      PIC XX.
  1319             20  PI-PB-CERT-NO          PIC X(10).
  1320             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1321             20  PI-PB-RECORD-TYPE      PIC X.
  1322
  1323         16  PI-DATE-RANGE-TABLE.
  1324             20  PI-TABLE-ENT OCCURS 32 TIMES
  1325                            INDEXED BY T-INDEX.
  1326                 24  PI-BIN-EFF-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  28
* EL6501.cbl
  1327                 24  PI-BIN-EXP-DT          PIC XX.
  1328                 24  PI-BIN-MAINT-DT        PIC XX.
  1329                 24  PI-BIN-LO-CERT         PIC XX.
  1330                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1331                 24  PI-BIN-HI-CERT         PIC XX.
  1332         16  PI-PAGE-NUMBER             PIC S9.
  1333             88  PI-FST-PAGE               VALUE +1.
  1334             88  PI-2ND-PAGE               VALUE +2.
  1335             88  PI-3RD-PAGE               VALUE +3.
  1336             88  PI-LST-PAGE               VALUE +4.
  1337         16  PI-TOTAL-LINES             PIC S999.
  1338         16  PI-LINE-SELECTED    PIC S9.
  1339***  Y2K PROJ 7744
  1340         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1341         16  BIN-EFFCHG-SAVE     PIC XX.
  1342         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1343***  Y2K PROJ 7744
  1344         16  BIN-EXPCHG-SAVE     PIC XX.
  1345         16  PI-RECORD-ADDED-SW  PIC X.
  1346             88  PI-RECORD-ADDED            VALUE '1'.
  1347             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1348         16  PI-ACCNAME          PIC X(30).
  1349         16  PI-COMM-POINTER     PIC S9(8)   COMP.
  1350         16  PI-SV-MAINT         PIC X.
  1351         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1352         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1353         16  PI-UPDATE-SW        PIC X.
  1354             88  PI-CHANGES-MADE             VALUE '1'.
  1355         16  PI-NOTE-TYPE        PIC X.
  1356             88  PI-ACCT-NOTE                VALUE '1'.
  1357         16  PI-DMD-FILE-SW      PIC X.
  1358             88  END-OF-FILE                 VALUE 'E'.
  1359             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1360             88  FIRST-OCCURS                VALUE 'F'.
  1361         16  PI-DMD-OCCURS       PIC S999.
  1362         16  PI-DMD-SCREEN       PIC X.
  1363             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1364             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1365             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1366         16  PI-NAMEFLG          PIC X.
  1367         16  PI-EL650-DEL-SW     PIC X.
  1368         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1369         16  PI-DCC-PROD-CODE    PIC XXX.
  1370         16  FILLER              PIC X(34).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  29
* EL6501.cbl
  1372
  1373*    COPY ELCJPFX.
  1374******************************************************************
  1375*                                                                *
  1376*                                                                *
  1377*                            ELCJPFX.                            *
  1378*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1379*                            VMOD=2.002                          *
  1380*                                                                *
  1381*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1382*                                                                *
  1383*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1384*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1385*        ELCNTL - CONTROL FILE                                   *
  1386*        ELMSTR - CLAIM MASTERS                                  *
  1387*        ELTRLR - ACTIVITY TRAILERS                              *
  1388*        ELCHKQ - CHECK QUE                                      *
  1389******************************************************************
  1390 01  JOURNAL-RECORD.
  1391     12  jp-date                     pic s9(5) comp-3.
  1392     12  jp-time                     pic s9(7) comp-3.
  1393     12  JP-USER-ID                  PIC X(4).
  1394     12  JP-FILE-ID                  PIC X(8).
  1395     12  JP-PROGRAM-ID               PIC X(8).
  1396     12  JP-RECORD-TYPE              PIC X.
  1397         88 JP-ADD              VALUE 'A'.
  1398         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1399         88 JP-AFTER-CHANGE     VALUE 'C'.
  1400         88 JP-DELETE           VALUE 'D'.
  1401         88 JP-GENERIC-DELETE   VALUE 'G'.
  1402         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1403         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1404     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1405     12  JP-RECORD-AREA
  1406
  1407
  1408         PIC X(2000).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  30
* EL6501.cbl
  1410*    COPY ELCAID.
  1411******************************************************************
  1412*                                                                *
  1413*                            ELCAID.                             *
  1414*                            VMOD=2.001                          *
  1415*                                                                *
  1416*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1417*                                                                *
  1418*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1419*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1420******************************************************************
  1421
  1422 01  DFHAID.
  1423   02  DFHNULL   PIC  X  VALUE  ' '.
  1424   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1425   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1426   02  DFHPEN    PIC  X  VALUE  '='.
  1427   02  DFHOPID   PIC  X  VALUE  'W'.
  1428   02  DFHPA1    PIC  X  VALUE  '%'.
  1429   02  DFHPA2    PIC  X  VALUE  '>'.
  1430   02  DFHPA3    PIC  X  VALUE  ','.
  1431   02  DFHPF1    PIC  X  VALUE  '1'.
  1432   02  DFHPF2    PIC  X  VALUE  '2'.
  1433   02  DFHPF3    PIC  X  VALUE  '3'.
  1434   02  DFHPF4    PIC  X  VALUE  '4'.
  1435   02  DFHPF5    PIC  X  VALUE  '5'.
  1436   02  DFHPF6    PIC  X  VALUE  '6'.
  1437   02  DFHPF7    PIC  X  VALUE  '7'.
  1438   02  DFHPF8    PIC  X  VALUE  '8'.
  1439   02  DFHPF9    PIC  X  VALUE  '9'.
  1440   02  DFHPF10   PIC  X  VALUE  ':'.
  1441   02  DFHPF11   PIC  X  VALUE  '#'.
  1442   02  DFHPF12   PIC  X  VALUE  '@'.
  1443   02  DFHPF13   PIC  X  VALUE  'A'.
  1444   02  DFHPF14   PIC  X  VALUE  'B'.
  1445   02  DFHPF15   PIC  X  VALUE  'C'.
  1446   02  DFHPF16   PIC  X  VALUE  'D'.
  1447   02  DFHPF17   PIC  X  VALUE  'E'.
  1448   02  DFHPF18   PIC  X  VALUE  'F'.
  1449   02  DFHPF19   PIC  X  VALUE  'G'.
  1450   02  DFHPF20   PIC  X  VALUE  'H'.
  1451   02  DFHPF21   PIC  X  VALUE  'I'.
  1452*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1453   02  DFHPF22   PIC  X  VALUE  '['.
  1454   02  DFHPF23   PIC  X  VALUE  '.'.
  1455   02  DFHPF24   PIC  X  VALUE  '<'.
  1456   02  DFHMSRE   PIC  X  VALUE  'X'.
  1457   02  DFHSTRF   PIC  X  VALUE  'h'.
  1458   02  DFHTRIG   PIC  X  VALUE  '"'.
  1459 01  FILLER    REDEFINES DFHAID.
  1460     12  FILLER                  PIC X(8).
  1461     12  PF-VALUES               PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  31
* EL6501.cbl
  1463*    COPY EL6501S.
  1464 01  EL6501AI.
  1465     05  FILLER            PIC  X(0012).
  1466*    -------------------------------
  1467     05  DATEL PIC S9(0004) COMP.
  1468     05  DATEF PIC  X(0001).
  1469     05  FILLER REDEFINES DATEF.
  1470         10  DATEA PIC  X(0001).
  1471     05  DATEI PIC  X(0008).
  1472*    -------------------------------
  1473     05  TIMEL PIC S9(0004) COMP.
  1474     05  TIMEF PIC  X(0001).
  1475     05  FILLER REDEFINES TIMEF.
  1476         10  TIMEA PIC  X(0001).
  1477     05  TIMEI PIC  X(0005).
  1478*    -------------------------------
  1479     05  CMPNYIDL PIC S9(0004) COMP.
  1480     05  CMPNYIDF PIC  X(0001).
  1481     05  FILLER REDEFINES CMPNYIDF.
  1482         10  CMPNYIDA PIC  X(0001).
  1483     05  CMPNYIDI PIC  X(0003).
  1484*    -------------------------------
  1485     05  USERIDL PIC S9(0004) COMP.
  1486     05  USERIDF PIC  X(0001).
  1487     05  FILLER REDEFINES USERIDF.
  1488         10  USERIDA PIC  X(0001).
  1489     05  USERIDI PIC  X(0004).
  1490*    -------------------------------
  1491     05  MAINTL PIC S9(0004) COMP.
  1492     05  MAINTF PIC  X(0001).
  1493     05  FILLER REDEFINES MAINTF.
  1494         10  MAINTA PIC  X(0001).
  1495     05  MAINTI PIC  X(0001).
  1496*    -------------------------------
  1497     05  CARRL PIC S9(0004) COMP.
  1498     05  CARRF PIC  X(0001).
  1499     05  FILLER REDEFINES CARRF.
  1500         10  CARRA PIC  X(0001).
  1501     05  CARRI PIC  X(0001).
  1502*    -------------------------------
  1503     05  GROUPINL PIC S9(0004) COMP.
  1504     05  GROUPINF PIC  X(0001).
  1505     05  FILLER REDEFINES GROUPINF.
  1506         10  GROUPINA PIC  X(0001).
  1507     05  GROUPINI PIC  X(0006).
  1508*    -------------------------------
  1509     05  STATEL PIC S9(0004) COMP.
  1510     05  STATEF PIC  X(0001).
  1511     05  FILLER REDEFINES STATEF.
  1512         10  STATEA PIC  X(0001).
  1513     05  STATEI PIC  X(0002).
  1514*    -------------------------------
  1515     05  ACCOUNTL PIC S9(0004) COMP.
  1516     05  ACCOUNTF PIC  X(0001).
  1517     05  FILLER REDEFINES ACCOUNTF.
  1518         10  ACCOUNTA PIC  X(0001).
  1519     05  ACCOUNTI PIC  X(0010).
  1520*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  32
* EL6501.cbl
  1521     05  EFFDTEL PIC S9(0004) COMP.
  1522     05  EFFDTEF PIC  X(0001).
  1523     05  FILLER REDEFINES EFFDTEF.
  1524         10  EFFDTEA PIC  X(0001).
  1525     05  EFFDTEI PIC  X(0008).
  1526*    -------------------------------
  1527     05  EXPDTEL PIC S9(0004) COMP.
  1528     05  EXPDTEF PIC  X(0001).
  1529     05  FILLER REDEFINES EXPDTEF.
  1530         10  EXPDTEA PIC  X(0001).
  1531     05  EXPDTEI PIC  X(0008).
  1532*    -------------------------------
  1533     05  MAINTBYL PIC S9(0004) COMP.
  1534     05  MAINTBYF PIC  X(0001).
  1535     05  FILLER REDEFINES MAINTBYF.
  1536         10  MAINTBYA PIC  X(0001).
  1537     05  MAINTBYI PIC  X(0004).
  1538*    -------------------------------
  1539     05  PCONTL PIC S9(0004) COMP.
  1540     05  PCONTF PIC  X(0001).
  1541     05  FILLER REDEFINES PCONTF.
  1542         10  PCONTA PIC  X(0001).
  1543     05  PCONTI PIC  X(0030).
  1544*    -------------------------------
  1545     05  CSRL PIC S9(0004) COMP.
  1546     05  CSRF PIC  X(0001).
  1547     05  FILLER REDEFINES CSRF.
  1548         10  CSRA PIC  X(0001).
  1549     05  CSRI PIC  X(0004).
  1550*    -------------------------------
  1551     05  PDSPLYL PIC S9(0004) COMP.
  1552     05  PDSPLYF PIC  X(0001).
  1553     05  FILLER REDEFINES PDSPLYF.
  1554         10  PDSPLYA PIC  X(0001).
  1555     05  PDSPLYI PIC  X(0006).
  1556*    -------------------------------
  1557     05  PEFFDTEL PIC S9(0004) COMP.
  1558     05  PEFFDTEF PIC  X(0001).
  1559     05  FILLER REDEFINES PEFFDTEF.
  1560         10  PEFFDTEA PIC  X(0001).
  1561     05  PEFFDTEI PIC  X(0008).
  1562*    -------------------------------
  1563     05  PEXPDTEL PIC S9(0004) COMP.
  1564     05  PEXPDTEF PIC  X(0001).
  1565     05  FILLER REDEFINES PEXPDTEF.
  1566         10  PEXPDTEA PIC  X(0001).
  1567     05  PEXPDTEI PIC  X(0008).
  1568*    -------------------------------
  1569     05  NAMEL PIC S9(0004) COMP.
  1570     05  NAMEF PIC  X(0001).
  1571     05  FILLER REDEFINES NAMEF.
  1572         10  NAMEA PIC  X(0001).
  1573     05  NAMEI PIC  X(0030).
  1574*    -------------------------------
  1575     05  TAXNOL PIC S9(0004) COMP.
  1576     05  TAXNOF PIC  X(0001).
  1577     05  FILLER REDEFINES TAXNOF.
  1578         10  TAXNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  33
* EL6501.cbl
  1579     05  TAXNOI PIC  X(0011).
  1580*    -------------------------------
  1581     05  STATUSL PIC S9(0004) COMP.
  1582     05  STATUSF PIC  X(0001).
  1583     05  FILLER REDEFINES STATUSF.
  1584         10  STATUSA PIC  X(0001).
  1585     05  STATUSI PIC  X(0001).
  1586*    -------------------------------
  1587     05  INCAREL PIC S9(0004) COMP.
  1588     05  INCAREF PIC  X(0001).
  1589     05  FILLER REDEFINES INCAREF.
  1590         10  INCAREA PIC  X(0001).
  1591     05  INCAREI PIC  X(0030).
  1592*    -------------------------------
  1593     05  PHONEL PIC S9(0004) COMP.
  1594     05  PHONEF PIC  X(0001).
  1595     05  FILLER REDEFINES PHONEF.
  1596         10  PHONEA PIC  X(0001).
  1597     05  PHONEI PIC  X(0012).
  1598*    -------------------------------
  1599     05  INDGRPL PIC S9(0004) COMP.
  1600     05  INDGRPF PIC  X(0001).
  1601     05  FILLER REDEFINES INDGRPF.
  1602         10  INDGRPA PIC  X(0001).
  1603     05  INDGRPI PIC  X(0001).
  1604*    -------------------------------
  1605     05  ADDR1L PIC S9(0004) COMP.
  1606     05  ADDR1F PIC  X(0001).
  1607     05  FILLER REDEFINES ADDR1F.
  1608         10  ADDR1A PIC  X(0001).
  1609     05  ADDR1I PIC  X(0030).
  1610*    -------------------------------
  1611     05  CONTRL PIC S9(0004) COMP.
  1612     05  CONTRF PIC  X(0001).
  1613     05  FILLER REDEFINES CONTRF.
  1614         10  CONTRA PIC  X(0001).
  1615     05  CONTRI PIC  X(0008).
  1616*    -------------------------------
  1617     05  TYPEL PIC S9(0004) COMP.
  1618     05  TYPEF PIC  X(0001).
  1619     05  FILLER REDEFINES TYPEF.
  1620         10  TYPEA PIC  X(0001).
  1621     05  TYPEI PIC  99.
  1622*    -------------------------------
  1623     05  ACITYL PIC S9(0004) COMP.
  1624     05  ACITYF PIC  X(0001).
  1625     05  FILLER REDEFINES ACITYF.
  1626         10  ACITYA PIC  X(0001).
  1627     05  ACITYI PIC  X(0028).
  1628*    -------------------------------
  1629     05  ASTATEL PIC S9(0004) COMP.
  1630     05  ASTATEF PIC  X(0001).
  1631     05  FILLER REDEFINES ASTATEF.
  1632         10  ASTATEA PIC  X(0001).
  1633     05  ASTATEI PIC  X(0002).
  1634*    -------------------------------
  1635     05  PRODATEL PIC S9(0004) COMP.
  1636     05  PRODATEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  34
* EL6501.cbl
  1637     05  FILLER REDEFINES PRODATEF.
  1638         10  PRODATEA PIC  X(0001).
  1639     05  PRODATEI PIC  X(0008).
  1640*    -------------------------------
  1641     05  STDBENL PIC S9(0004) COMP.
  1642     05  STDBENF PIC  X(0001).
  1643     05  FILLER REDEFINES STDBENF.
  1644         10  STDBENA PIC  X(0001).
  1645     05  STDBENI PIC  X(0002).
  1646*    -------------------------------
  1647     05  ZIPL PIC S9(0004) COMP.
  1648     05  ZIPF PIC  X(0001).
  1649     05  FILLER REDEFINES ZIPF.
  1650         10  ZIPA PIC  X(0001).
  1651     05  ZIPI PIC  X(0010).
  1652*    -------------------------------
  1653     05  CTPLABLL PIC S9(0004) COMP.
  1654     05  CTPLABLF PIC  X(0001).
  1655     05  FILLER REDEFINES CTPLABLF.
  1656         10  CTPLABLA PIC  X(0001).
  1657     05  CTPLABLI PIC  X(0010).
  1658*    -------------------------------
  1659     05  CLPTOLPL PIC S9(0004) COMP.
  1660     05  CLPTOLPF PIC  X(0001).
  1661     05  FILLER REDEFINES CLPTOLPF.
  1662         10  CLPTOLPA PIC  X(0001).
  1663     05  CLPTOLPI PIC  S9(02)V9999.
  1664*    -------------------------------
  1665     05  RETROCDL PIC S9(0004) COMP.
  1666     05  RETROCDF PIC  X(0001).
  1667     05  FILLER REDEFINES RETROCDF.
  1668         10  RETROCDA PIC  X(0001).
  1669     05  RETROCDI PIC  X(0003).
  1670*    -------------------------------
  1671     05  BILLCDL PIC S9(0004) COMP.
  1672     05  BILLCDF PIC  X(0001).
  1673     05  FILLER REDEFINES BILLCDF.
  1674         10  BILLCDA PIC  X(0001).
  1675     05  BILLCDI PIC  X(0003).
  1676*    -------------------------------
  1677     05  LCLABLL PIC S9(0004) COMP.
  1678     05  LCLABLF PIC  X(0001).
  1679     05  FILLER REDEFINES LCLABLF.
  1680         10  LCLABLA PIC  X(0001).
  1681     05  LCLABLI PIC  X(0011).
  1682*    -------------------------------
  1683     05  LCOMML PIC S9(0004) COMP.
  1684     05  LCOMMF PIC  X(0001).
  1685     05  FILLER REDEFINES LCOMMF.
  1686         10  LCOMMA PIC  X(0001).
  1687     05  LCOMMI PIC  S9(6)V9(2).
  1688*    -------------------------------
  1689     05  MAXFEEHL PIC S9(0004) COMP.
  1690     05  MAXFEEHF PIC  X(0001).
  1691     05  FILLER REDEFINES MAXFEEHF.
  1692         10  MAXFEEHA PIC  X(0001).
  1693     05  MAXFEEHI PIC  X(0013).
  1694*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  35
* EL6501.cbl
  1695     05  MAXMFEEL PIC S9(0004) COMP.
  1696     05  MAXMFEEF PIC  X(0001).
  1697     05  FILLER REDEFINES MAXMFEEF.
  1698         10  MAXMFEEA PIC  X(0001).
  1699     05  MAXMFEEI PIC  X(0005).
  1700*    -------------------------------
  1701     05  CLPSTHL PIC S9(0004) COMP.
  1702     05  CLPSTHF PIC  X(0001).
  1703     05  FILLER REDEFINES CLPSTHF.
  1704         10  CLPSTHA PIC  X(0001).
  1705     05  CLPSTHI PIC  X(0010).
  1706*    -------------------------------
  1707     05  CLPSTL PIC S9(0004) COMP.
  1708     05  CLPSTF PIC  X(0001).
  1709     05  FILLER REDEFINES CLPSTF.
  1710         10  CLPSTA PIC  X(0001).
  1711     05  CLPSTI PIC  X(0002).
  1712*    -------------------------------
  1713     05  PRODCDHL PIC S9(0004) COMP.
  1714     05  PRODCDHF PIC  X(0001).
  1715     05  FILLER REDEFINES PRODCDHF.
  1716         10  PRODCDHA PIC  X(0001).
  1717     05  PRODCDHI PIC  X(0012).
  1718*    -------------------------------
  1719     05  PRODCDL PIC S9(0004) COMP.
  1720     05  PRODCDF PIC  X(0001).
  1721     05  FILLER REDEFINES PRODCDF.
  1722         10  PRODCDA PIC  X(0001).
  1723     05  PRODCDI PIC  X(0003).
  1724*    -------------------------------
  1725     05  REMITL PIC S9(0004) COMP.
  1726     05  REMITF PIC  X(0001).
  1727     05  FILLER REDEFINES REMITF.
  1728         10  REMITA PIC  X(0001).
  1729     05  REMITI PIC  99.
  1730*    -------------------------------
  1731     05  COMMCALL PIC S9(0004) COMP.
  1732     05  COMMCALF PIC  X(0001).
  1733     05  FILLER REDEFINES COMMCALF.
  1734         10  COMMCALA PIC  X(0001).
  1735     05  COMMCALI PIC  X(0001).
  1736*    -------------------------------
  1737     05  REINTABL PIC S9(0004) COMP.
  1738     05  REINTABF PIC  X(0001).
  1739     05  FILLER REDEFINES REINTABF.
  1740         10  REINTABA PIC  X(0001).
  1741     05  REINTABI PIC  X(0003).
  1742*    -------------------------------
  1743     05  REINCALL PIC S9(0004) COMP.
  1744     05  REINCALF PIC  X(0001).
  1745     05  FILLER REDEFINES REINCALF.
  1746         10  REINCALA PIC  X(0001).
  1747     05  REINCALI PIC  X(0001).
  1748*    -------------------------------
  1749     05  AHHEADL PIC S9(0004) COMP.
  1750     05  AHHEADF PIC  X(0001).
  1751     05  FILLER REDEFINES AHHEADF.
  1752         10  AHHEADA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  36
* EL6501.cbl
  1753     05  AHHEADI PIC  X(0006).
  1754*    -------------------------------
  1755     05  AGNT1L PIC S9(0004) COMP.
  1756     05  AGNT1F PIC  X(0001).
  1757     05  FILLER REDEFINES AGNT1F.
  1758         10  AGNT1A PIC  X(0001).
  1759     05  AGNT1I PIC  X(0010).
  1760*    -------------------------------
  1761     05  TYPE1L PIC S9(0004) COMP.
  1762     05  TYPE1F PIC  X(0001).
  1763     05  FILLER REDEFINES TYPE1F.
  1764         10  TYPE1A PIC  X(0001).
  1765     05  TYPE1I PIC  X(0001).
  1766*    -------------------------------
  1767     05  SINRT1L PIC S9(0004) COMP.
  1768     05  SINRT1F PIC  X(0001).
  1769     05  FILLER REDEFINES SINRT1F.
  1770         10  SINRT1A PIC  X(0001).
  1771     05  SINRT1I PIC  X(0006).
  1772*    -------------------------------
  1773     05  JNTRT1L PIC S9(0004) COMP.
  1774     05  JNTRT1F PIC  X(0001).
  1775     05  FILLER REDEFINES JNTRT1F.
  1776         10  JNTRT1A PIC  X(0001).
  1777     05  JNTRT1I PIC  X(0006).
  1778*    -------------------------------
  1779     05  AHRT1L PIC S9(0004) COMP.
  1780     05  AHRT1F PIC  X(0001).
  1781     05  FILLER REDEFINES AHRT1F.
  1782         10  AHRT1A PIC  X(0001).
  1783     05  AHRT1I PIC  X(0006).
  1784*    -------------------------------
  1785     05  RECAL1L PIC S9(0004) COMP.
  1786     05  RECAL1F PIC  X(0001).
  1787     05  FILLER REDEFINES RECAL1F.
  1788         10  RECAL1A PIC  X(0001).
  1789     05  RECAL1I PIC  X(0001).
  1790*    -------------------------------
  1791     05  COMM1L PIC S9(0004) COMP.
  1792     05  COMM1F PIC  X(0001).
  1793     05  FILLER REDEFINES COMM1F.
  1794         10  COMM1A PIC  X(0001).
  1795     05  COMM1I PIC  X(0001).
  1796*    -------------------------------
  1797     05  CHGBK1L PIC S9(0004) COMP.
  1798     05  CHGBK1F PIC  X(0001).
  1799     05  FILLER REDEFINES CHGBK1F.
  1800         10  CHGBK1A PIC  X(0001).
  1801     05  CHGBK1I PIC  X(0002).
  1802*    -------------------------------
  1803     05  CCE01L PIC S9(0004) COMP.
  1804     05  CCE01F PIC  X(0001).
  1805     05  FILLER REDEFINES CCE01F.
  1806         10  CCE01A PIC  X(0001).
  1807     05  CCE01I PIC  X(0001).
  1808*    -------------------------------
  1809     05  AGNT2L PIC S9(0004) COMP.
  1810     05  AGNT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  37
* EL6501.cbl
  1811     05  FILLER REDEFINES AGNT2F.
  1812         10  AGNT2A PIC  X(0001).
  1813     05  AGNT2I PIC  X(0010).
  1814*    -------------------------------
  1815     05  TYPE2L PIC S9(0004) COMP.
  1816     05  TYPE2F PIC  X(0001).
  1817     05  FILLER REDEFINES TYPE2F.
  1818         10  TYPE2A PIC  X(0001).
  1819     05  TYPE2I PIC  X(0001).
  1820*    -------------------------------
  1821     05  SINRT2L PIC S9(0004) COMP.
  1822     05  SINRT2F PIC  X(0001).
  1823     05  FILLER REDEFINES SINRT2F.
  1824         10  SINRT2A PIC  X(0001).
  1825     05  SINRT2I PIC  X(0006).
  1826*    -------------------------------
  1827     05  JNTRT2L PIC S9(0004) COMP.
  1828     05  JNTRT2F PIC  X(0001).
  1829     05  FILLER REDEFINES JNTRT2F.
  1830         10  JNTRT2A PIC  X(0001).
  1831     05  JNTRT2I PIC  X(0006).
  1832*    -------------------------------
  1833     05  AHRT2L PIC S9(0004) COMP.
  1834     05  AHRT2F PIC  X(0001).
  1835     05  FILLER REDEFINES AHRT2F.
  1836         10  AHRT2A PIC  X(0001).
  1837     05  AHRT2I PIC  X(0006).
  1838*    -------------------------------
  1839     05  RECAL2L PIC S9(0004) COMP.
  1840     05  RECAL2F PIC  X(0001).
  1841     05  FILLER REDEFINES RECAL2F.
  1842         10  RECAL2A PIC  X(0001).
  1843     05  RECAL2I PIC  X(0001).
  1844*    -------------------------------
  1845     05  COMM2L PIC S9(0004) COMP.
  1846     05  COMM2F PIC  X(0001).
  1847     05  FILLER REDEFINES COMM2F.
  1848         10  COMM2A PIC  X(0001).
  1849     05  COMM2I PIC  X(0001).
  1850*    -------------------------------
  1851     05  CHGBK2L PIC S9(0004) COMP.
  1852     05  CHGBK2F PIC  X(0001).
  1853     05  FILLER REDEFINES CHGBK2F.
  1854         10  CHGBK2A PIC  X(0001).
  1855     05  CHGBK2I PIC  X(0002).
  1856*    -------------------------------
  1857     05  CCE02L PIC S9(0004) COMP.
  1858     05  CCE02F PIC  X(0001).
  1859     05  FILLER REDEFINES CCE02F.
  1860         10  CCE02A PIC  X(0001).
  1861     05  CCE02I PIC  X(0001).
  1862*    -------------------------------
  1863     05  AGNT3L PIC S9(0004) COMP.
  1864     05  AGNT3F PIC  X(0001).
  1865     05  FILLER REDEFINES AGNT3F.
  1866         10  AGNT3A PIC  X(0001).
  1867     05  AGNT3I PIC  X(0010).
  1868*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  38
* EL6501.cbl
  1869     05  TYPE3L PIC S9(0004) COMP.
  1870     05  TYPE3F PIC  X(0001).
  1871     05  FILLER REDEFINES TYPE3F.
  1872         10  TYPE3A PIC  X(0001).
  1873     05  TYPE3I PIC  X(0001).
  1874*    -------------------------------
  1875     05  SINRT3L PIC S9(0004) COMP.
  1876     05  SINRT3F PIC  X(0001).
  1877     05  FILLER REDEFINES SINRT3F.
  1878         10  SINRT3A PIC  X(0001).
  1879     05  SINRT3I PIC  X(0006).
  1880*    -------------------------------
  1881     05  JNTRT3L PIC S9(0004) COMP.
  1882     05  JNTRT3F PIC  X(0001).
  1883     05  FILLER REDEFINES JNTRT3F.
  1884         10  JNTRT3A PIC  X(0001).
  1885     05  JNTRT3I PIC  X(0006).
  1886*    -------------------------------
  1887     05  AHRT3L PIC S9(0004) COMP.
  1888     05  AHRT3F PIC  X(0001).
  1889     05  FILLER REDEFINES AHRT3F.
  1890         10  AHRT3A PIC  X(0001).
  1891     05  AHRT3I PIC  X(0006).
  1892*    -------------------------------
  1893     05  RECAL3L PIC S9(0004) COMP.
  1894     05  RECAL3F PIC  X(0001).
  1895     05  FILLER REDEFINES RECAL3F.
  1896         10  RECAL3A PIC  X(0001).
  1897     05  RECAL3I PIC  X(0001).
  1898*    -------------------------------
  1899     05  COMM3L PIC S9(0004) COMP.
  1900     05  COMM3F PIC  X(0001).
  1901     05  FILLER REDEFINES COMM3F.
  1902         10  COMM3A PIC  X(0001).
  1903     05  COMM3I PIC  X(0001).
  1904*    -------------------------------
  1905     05  CHGBK3L PIC S9(0004) COMP.
  1906     05  CHGBK3F PIC  X(0001).
  1907     05  FILLER REDEFINES CHGBK3F.
  1908         10  CHGBK3A PIC  X(0001).
  1909     05  CHGBK3I PIC  X(0002).
  1910*    -------------------------------
  1911     05  CCE03L PIC S9(0004) COMP.
  1912     05  CCE03F PIC  X(0001).
  1913     05  FILLER REDEFINES CCE03F.
  1914         10  CCE03A PIC  X(0001).
  1915     05  CCE03I PIC  X(0001).
  1916*    -------------------------------
  1917     05  AGNT4L PIC S9(0004) COMP.
  1918     05  AGNT4F PIC  X(0001).
  1919     05  FILLER REDEFINES AGNT4F.
  1920         10  AGNT4A PIC  X(0001).
  1921     05  AGNT4I PIC  X(0010).
  1922*    -------------------------------
  1923     05  TYPE4L PIC S9(0004) COMP.
  1924     05  TYPE4F PIC  X(0001).
  1925     05  FILLER REDEFINES TYPE4F.
  1926         10  TYPE4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  39
* EL6501.cbl
  1927     05  TYPE4I PIC  X(0001).
  1928*    -------------------------------
  1929     05  SINRT4L PIC S9(0004) COMP.
  1930     05  SINRT4F PIC  X(0001).
  1931     05  FILLER REDEFINES SINRT4F.
  1932         10  SINRT4A PIC  X(0001).
  1933     05  SINRT4I PIC  X(0006).
  1934*    -------------------------------
  1935     05  JNTRT4L PIC S9(0004) COMP.
  1936     05  JNTRT4F PIC  X(0001).
  1937     05  FILLER REDEFINES JNTRT4F.
  1938         10  JNTRT4A PIC  X(0001).
  1939     05  JNTRT4I PIC  X(0006).
  1940*    -------------------------------
  1941     05  AHRT4L PIC S9(0004) COMP.
  1942     05  AHRT4F PIC  X(0001).
  1943     05  FILLER REDEFINES AHRT4F.
  1944         10  AHRT4A PIC  X(0001).
  1945     05  AHRT4I PIC  X(0006).
  1946*    -------------------------------
  1947     05  RECAL4L PIC S9(0004) COMP.
  1948     05  RECAL4F PIC  X(0001).
  1949     05  FILLER REDEFINES RECAL4F.
  1950         10  RECAL4A PIC  X(0001).
  1951     05  RECAL4I PIC  X(0001).
  1952*    -------------------------------
  1953     05  COMM4L PIC S9(0004) COMP.
  1954     05  COMM4F PIC  X(0001).
  1955     05  FILLER REDEFINES COMM4F.
  1956         10  COMM4A PIC  X(0001).
  1957     05  COMM4I PIC  X(0001).
  1958*    -------------------------------
  1959     05  CHGBK4L PIC S9(0004) COMP.
  1960     05  CHGBK4F PIC  X(0001).
  1961     05  FILLER REDEFINES CHGBK4F.
  1962         10  CHGBK4A PIC  X(0001).
  1963     05  CHGBK4I PIC  X(0002).
  1964*    -------------------------------
  1965     05  CCE04L PIC S9(0004) COMP.
  1966     05  CCE04F PIC  X(0001).
  1967     05  FILLER REDEFINES CCE04F.
  1968         10  CCE04A PIC  X(0001).
  1969     05  CCE04I PIC  X(0001).
  1970*    -------------------------------
  1971     05  AGNT5L PIC S9(0004) COMP.
  1972     05  AGNT5F PIC  X(0001).
  1973     05  FILLER REDEFINES AGNT5F.
  1974         10  AGNT5A PIC  X(0001).
  1975     05  AGNT5I PIC  X(0010).
  1976*    -------------------------------
  1977     05  TYPE5L PIC S9(0004) COMP.
  1978     05  TYPE5F PIC  X(0001).
  1979     05  FILLER REDEFINES TYPE5F.
  1980         10  TYPE5A PIC  X(0001).
  1981     05  TYPE5I PIC  X(0001).
  1982*    -------------------------------
  1983     05  SINRT5L PIC S9(0004) COMP.
  1984     05  SINRT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  40
* EL6501.cbl
  1985     05  FILLER REDEFINES SINRT5F.
  1986         10  SINRT5A PIC  X(0001).
  1987     05  SINRT5I PIC  X(0006).
  1988*    -------------------------------
  1989     05  JNTRT5L PIC S9(0004) COMP.
  1990     05  JNTRT5F PIC  X(0001).
  1991     05  FILLER REDEFINES JNTRT5F.
  1992         10  JNTRT5A PIC  X(0001).
  1993     05  JNTRT5I PIC  X(0006).
  1994*    -------------------------------
  1995     05  AHRT5L PIC S9(0004) COMP.
  1996     05  AHRT5F PIC  X(0001).
  1997     05  FILLER REDEFINES AHRT5F.
  1998         10  AHRT5A PIC  X(0001).
  1999     05  AHRT5I PIC  X(0006).
  2000*    -------------------------------
  2001     05  RECAL5L PIC S9(0004) COMP.
  2002     05  RECAL5F PIC  X(0001).
  2003     05  FILLER REDEFINES RECAL5F.
  2004         10  RECAL5A PIC  X(0001).
  2005     05  RECAL5I PIC  X(0001).
  2006*    -------------------------------
  2007     05  COMM5L PIC S9(0004) COMP.
  2008     05  COMM5F PIC  X(0001).
  2009     05  FILLER REDEFINES COMM5F.
  2010         10  COMM5A PIC  X(0001).
  2011     05  COMM5I PIC  X(0001).
  2012*    -------------------------------
  2013     05  CHGBK5L PIC S9(0004) COMP.
  2014     05  CHGBK5F PIC  X(0001).
  2015     05  FILLER REDEFINES CHGBK5F.
  2016         10  CHGBK5A PIC  X(0001).
  2017     05  CHGBK5I PIC  X(0002).
  2018*    -------------------------------
  2019     05  CCE05L PIC S9(0004) COMP.
  2020     05  CCE05F PIC  X(0001).
  2021     05  FILLER REDEFINES CCE05F.
  2022         10  CCE05A PIC  X(0001).
  2023     05  CCE05I PIC  X(0001).
  2024*    -------------------------------
  2025     05  AGNT6L PIC S9(0004) COMP.
  2026     05  AGNT6F PIC  X(0001).
  2027     05  FILLER REDEFINES AGNT6F.
  2028         10  AGNT6A PIC  X(0001).
  2029     05  AGNT6I PIC  X(0010).
  2030*    -------------------------------
  2031     05  TYPE6L PIC S9(0004) COMP.
  2032     05  TYPE6F PIC  X(0001).
  2033     05  FILLER REDEFINES TYPE6F.
  2034         10  TYPE6A PIC  X(0001).
  2035     05  TYPE6I PIC  X(0001).
  2036*    -------------------------------
  2037     05  SINRT6L PIC S9(0004) COMP.
  2038     05  SINRT6F PIC  X(0001).
  2039     05  FILLER REDEFINES SINRT6F.
  2040         10  SINRT6A PIC  X(0001).
  2041     05  SINRT6I PIC  X(0006).
  2042*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  41
* EL6501.cbl
  2043     05  JNTRT6L PIC S9(0004) COMP.
  2044     05  JNTRT6F PIC  X(0001).
  2045     05  FILLER REDEFINES JNTRT6F.
  2046         10  JNTRT6A PIC  X(0001).
  2047     05  JNTRT6I PIC  X(0006).
  2048*    -------------------------------
  2049     05  AHRT6L PIC S9(0004) COMP.
  2050     05  AHRT6F PIC  X(0001).
  2051     05  FILLER REDEFINES AHRT6F.
  2052         10  AHRT6A PIC  X(0001).
  2053     05  AHRT6I PIC  X(0006).
  2054*    -------------------------------
  2055     05  RECAL6L PIC S9(0004) COMP.
  2056     05  RECAL6F PIC  X(0001).
  2057     05  FILLER REDEFINES RECAL6F.
  2058         10  RECAL6A PIC  X(0001).
  2059     05  RECAL6I PIC  X(0001).
  2060*    -------------------------------
  2061     05  COMM6L PIC S9(0004) COMP.
  2062     05  COMM6F PIC  X(0001).
  2063     05  FILLER REDEFINES COMM6F.
  2064         10  COMM6A PIC  X(0001).
  2065     05  COMM6I PIC  X(0001).
  2066*    -------------------------------
  2067     05  CHGBK6L PIC S9(0004) COMP.
  2068     05  CHGBK6F PIC  X(0001).
  2069     05  FILLER REDEFINES CHGBK6F.
  2070         10  CHGBK6A PIC  X(0001).
  2071     05  CHGBK6I PIC  X(0002).
  2072*    -------------------------------
  2073     05  CCE06L PIC S9(0004) COMP.
  2074     05  CCE06F PIC  X(0001).
  2075     05  FILLER REDEFINES CCE06F.
  2076         10  CCE06A PIC  X(0001).
  2077     05  CCE06I PIC  X(0001).
  2078*    -------------------------------
  2079     05  AGNT7L PIC S9(0004) COMP.
  2080     05  AGNT7F PIC  X(0001).
  2081     05  FILLER REDEFINES AGNT7F.
  2082         10  AGNT7A PIC  X(0001).
  2083     05  AGNT7I PIC  X(0010).
  2084*    -------------------------------
  2085     05  TYPE7L PIC S9(0004) COMP.
  2086     05  TYPE7F PIC  X(0001).
  2087     05  FILLER REDEFINES TYPE7F.
  2088         10  TYPE7A PIC  X(0001).
  2089     05  TYPE7I PIC  X(0001).
  2090*    -------------------------------
  2091     05  SINRT7L PIC S9(0004) COMP.
  2092     05  SINRT7F PIC  X(0001).
  2093     05  FILLER REDEFINES SINRT7F.
  2094         10  SINRT7A PIC  X(0001).
  2095     05  SINRT7I PIC  X(0006).
  2096*    -------------------------------
  2097     05  JNTRT7L PIC S9(0004) COMP.
  2098     05  JNTRT7F PIC  X(0001).
  2099     05  FILLER REDEFINES JNTRT7F.
  2100         10  JNTRT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  42
* EL6501.cbl
  2101     05  JNTRT7I PIC  X(0006).
  2102*    -------------------------------
  2103     05  AHRT7L PIC S9(0004) COMP.
  2104     05  AHRT7F PIC  X(0001).
  2105     05  FILLER REDEFINES AHRT7F.
  2106         10  AHRT7A PIC  X(0001).
  2107     05  AHRT7I PIC  X(0006).
  2108*    -------------------------------
  2109     05  RECAL7L PIC S9(0004) COMP.
  2110     05  RECAL7F PIC  X(0001).
  2111     05  FILLER REDEFINES RECAL7F.
  2112         10  RECAL7A PIC  X(0001).
  2113     05  RECAL7I PIC  X(0001).
  2114*    -------------------------------
  2115     05  COMM7L PIC S9(0004) COMP.
  2116     05  COMM7F PIC  X(0001).
  2117     05  FILLER REDEFINES COMM7F.
  2118         10  COMM7A PIC  X(0001).
  2119     05  COMM7I PIC  X(0001).
  2120*    -------------------------------
  2121     05  CHGBK7L PIC S9(0004) COMP.
  2122     05  CHGBK7F PIC  X(0001).
  2123     05  FILLER REDEFINES CHGBK7F.
  2124         10  CHGBK7A PIC  X(0001).
  2125     05  CHGBK7I PIC  X(0002).
  2126*    -------------------------------
  2127     05  CCE07L PIC S9(0004) COMP.
  2128     05  CCE07F PIC  X(0001).
  2129     05  FILLER REDEFINES CCE07F.
  2130         10  CCE07A PIC  X(0001).
  2131     05  CCE07I PIC  X(0001).
  2132*    -------------------------------
  2133     05  AGNT8L PIC S9(0004) COMP.
  2134     05  AGNT8F PIC  X(0001).
  2135     05  FILLER REDEFINES AGNT8F.
  2136         10  AGNT8A PIC  X(0001).
  2137     05  AGNT8I PIC  X(0010).
  2138*    -------------------------------
  2139     05  TYPE8L PIC S9(0004) COMP.
  2140     05  TYPE8F PIC  X(0001).
  2141     05  FILLER REDEFINES TYPE8F.
  2142         10  TYPE8A PIC  X(0001).
  2143     05  TYPE8I PIC  X(0001).
  2144*    -------------------------------
  2145     05  SINRT8L PIC S9(0004) COMP.
  2146     05  SINRT8F PIC  X(0001).
  2147     05  FILLER REDEFINES SINRT8F.
  2148         10  SINRT8A PIC  X(0001).
  2149     05  SINRT8I PIC  X(0006).
  2150*    -------------------------------
  2151     05  JNTRT8L PIC S9(0004) COMP.
  2152     05  JNTRT8F PIC  X(0001).
  2153     05  FILLER REDEFINES JNTRT8F.
  2154         10  JNTRT8A PIC  X(0001).
  2155     05  JNTRT8I PIC  X(0006).
  2156*    -------------------------------
  2157     05  AHRT8L PIC S9(0004) COMP.
  2158     05  AHRT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  43
* EL6501.cbl
  2159     05  FILLER REDEFINES AHRT8F.
  2160         10  AHRT8A PIC  X(0001).
  2161     05  AHRT8I PIC  X(0006).
  2162*    -------------------------------
  2163     05  RECAL8L PIC S9(0004) COMP.
  2164     05  RECAL8F PIC  X(0001).
  2165     05  FILLER REDEFINES RECAL8F.
  2166         10  RECAL8A PIC  X(0001).
  2167     05  RECAL8I PIC  X(0001).
  2168*    -------------------------------
  2169     05  COMM8L PIC S9(0004) COMP.
  2170     05  COMM8F PIC  X(0001).
  2171     05  FILLER REDEFINES COMM8F.
  2172         10  COMM8A PIC  X(0001).
  2173     05  COMM8I PIC  X(0001).
  2174*    -------------------------------
  2175     05  CHGBK8L PIC S9(0004) COMP.
  2176     05  CHGBK8F PIC  X(0001).
  2177     05  FILLER REDEFINES CHGBK8F.
  2178         10  CHGBK8A PIC  X(0001).
  2179     05  CHGBK8I PIC  X(0002).
  2180*    -------------------------------
  2181     05  CCE08L PIC S9(0004) COMP.
  2182     05  CCE08F PIC  X(0001).
  2183     05  FILLER REDEFINES CCE08F.
  2184         10  CCE08A PIC  X(0001).
  2185     05  CCE08I PIC  X(0001).
  2186*    -------------------------------
  2187     05  AGNT9L PIC S9(0004) COMP.
  2188     05  AGNT9F PIC  X(0001).
  2189     05  FILLER REDEFINES AGNT9F.
  2190         10  AGNT9A PIC  X(0001).
  2191     05  AGNT9I PIC  X(0010).
  2192*    -------------------------------
  2193     05  TYPE9L PIC S9(0004) COMP.
  2194     05  TYPE9F PIC  X(0001).
  2195     05  FILLER REDEFINES TYPE9F.
  2196         10  TYPE9A PIC  X(0001).
  2197     05  TYPE9I PIC  X(0001).
  2198*    -------------------------------
  2199     05  SINRT9L PIC S9(0004) COMP.
  2200     05  SINRT9F PIC  X(0001).
  2201     05  FILLER REDEFINES SINRT9F.
  2202         10  SINRT9A PIC  X(0001).
  2203     05  SINRT9I PIC  X(0006).
  2204*    -------------------------------
  2205     05  JNTRT9L PIC S9(0004) COMP.
  2206     05  JNTRT9F PIC  X(0001).
  2207     05  FILLER REDEFINES JNTRT9F.
  2208         10  JNTRT9A PIC  X(0001).
  2209     05  JNTRT9I PIC  X(0006).
  2210*    -------------------------------
  2211     05  AHRT9L PIC S9(0004) COMP.
  2212     05  AHRT9F PIC  X(0001).
  2213     05  FILLER REDEFINES AHRT9F.
  2214         10  AHRT9A PIC  X(0001).
  2215     05  AHRT9I PIC  X(0006).
  2216*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  44
* EL6501.cbl
  2217     05  RECAL9L PIC S9(0004) COMP.
  2218     05  RECAL9F PIC  X(0001).
  2219     05  FILLER REDEFINES RECAL9F.
  2220         10  RECAL9A PIC  X(0001).
  2221     05  RECAL9I PIC  X(0001).
  2222*    -------------------------------
  2223     05  COMM9L PIC S9(0004) COMP.
  2224     05  COMM9F PIC  X(0001).
  2225     05  FILLER REDEFINES COMM9F.
  2226         10  COMM9A PIC  X(0001).
  2227     05  COMM9I PIC  X(0001).
  2228*    -------------------------------
  2229     05  CHGBK9L PIC S9(0004) COMP.
  2230     05  CHGBK9F PIC  X(0001).
  2231     05  FILLER REDEFINES CHGBK9F.
  2232         10  CHGBK9A PIC  X(0001).
  2233     05  CHGBK9I PIC  X(0002).
  2234*    -------------------------------
  2235     05  CCE09L PIC S9(0004) COMP.
  2236     05  CCE09F PIC  X(0001).
  2237     05  FILLER REDEFINES CCE09F.
  2238         10  CCE09A PIC  X(0001).
  2239     05  CCE09I PIC  X(0001).
  2240*    -------------------------------
  2241     05  AGNT10L PIC S9(0004) COMP.
  2242     05  AGNT10F PIC  X(0001).
  2243     05  FILLER REDEFINES AGNT10F.
  2244         10  AGNT10A PIC  X(0001).
  2245     05  AGNT10I PIC  X(0010).
  2246*    -------------------------------
  2247     05  TYPE10L PIC S9(0004) COMP.
  2248     05  TYPE10F PIC  X(0001).
  2249     05  FILLER REDEFINES TYPE10F.
  2250         10  TYPE10A PIC  X(0001).
  2251     05  TYPE10I PIC  X(0001).
  2252*    -------------------------------
  2253     05  SINRT10L PIC S9(0004) COMP.
  2254     05  SINRT10F PIC  X(0001).
  2255     05  FILLER REDEFINES SINRT10F.
  2256         10  SINRT10A PIC  X(0001).
  2257     05  SINRT10I PIC  X(0006).
  2258*    -------------------------------
  2259     05  JNTRT10L PIC S9(0004) COMP.
  2260     05  JNTRT10F PIC  X(0001).
  2261     05  FILLER REDEFINES JNTRT10F.
  2262         10  JNTRT10A PIC  X(0001).
  2263     05  JNTRT10I PIC  X(0006).
  2264*    -------------------------------
  2265     05  AHRT10L PIC S9(0004) COMP.
  2266     05  AHRT10F PIC  X(0001).
  2267     05  FILLER REDEFINES AHRT10F.
  2268         10  AHRT10A PIC  X(0001).
  2269     05  AHRT10I PIC  X(0006).
  2270*    -------------------------------
  2271     05  RECAL10L PIC S9(0004) COMP.
  2272     05  RECAL10F PIC  X(0001).
  2273     05  FILLER REDEFINES RECAL10F.
  2274         10  RECAL10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  45
* EL6501.cbl
  2275     05  RECAL10I PIC  X(0001).
  2276*    -------------------------------
  2277     05  COMM10L PIC S9(0004) COMP.
  2278     05  COMM10F PIC  X(0001).
  2279     05  FILLER REDEFINES COMM10F.
  2280         10  COMM10A PIC  X(0001).
  2281     05  COMM10I PIC  X(0001).
  2282*    -------------------------------
  2283     05  CHGBK10L PIC S9(0004) COMP.
  2284     05  CHGBK10F PIC  X(0001).
  2285     05  FILLER REDEFINES CHGBK10F.
  2286         10  CHGBK10A PIC  X(0001).
  2287     05  CHGBK10I PIC  X(0002).
  2288*    -------------------------------
  2289     05  CCE10L PIC S9(0004) COMP.
  2290     05  CCE10F PIC  X(0001).
  2291     05  FILLER REDEFINES CCE10F.
  2292         10  CCE10A PIC  X(0001).
  2293     05  CCE10I PIC  X(0001).
  2294*    -------------------------------
  2295     05  ERRMSG1L PIC S9(0004) COMP.
  2296     05  ERRMSG1F PIC  X(0001).
  2297     05  FILLER REDEFINES ERRMSG1F.
  2298         10  ERRMSG1A PIC  X(0001).
  2299     05  ERRMSG1I PIC  X(0075).
  2300*    -------------------------------
  2301     05  PFENTERL PIC S9(0004) COMP.
  2302     05  PFENTERF PIC  X(0001).
  2303     05  FILLER REDEFINES PFENTERF.
  2304         10  PFENTERA PIC  X(0001).
  2305     05  PFENTERI PIC  9(2).
  2306*    -------------------------------
  2307     05  PF1PF2L PIC S9(0004) COMP.
  2308     05  PF1PF2F PIC  X(0001).
  2309     05  FILLER REDEFINES PF1PF2F.
  2310         10  PF1PF2A PIC  X(0001).
  2311     05  PF1PF2I PIC  X(0035).
  2312 01  EL6501AO REDEFINES EL6501AI.
  2313     05  FILLER            PIC  X(0012).
  2314*    -------------------------------
  2315     05  FILLER            PIC  X(0003).
  2316     05  DATEO PIC  X(0008).
  2317*    -------------------------------
  2318     05  FILLER            PIC  X(0003).
  2319     05  TIMEO PIC  99.99.
  2320*    -------------------------------
  2321     05  FILLER            PIC  X(0003).
  2322     05  CMPNYIDO PIC  X(0003).
  2323*    -------------------------------
  2324     05  FILLER            PIC  X(0003).
  2325     05  USERIDO PIC  X(0004).
  2326*    -------------------------------
  2327     05  FILLER            PIC  X(0003).
  2328     05  MAINTO PIC  X(0001).
  2329*    -------------------------------
  2330     05  FILLER            PIC  X(0003).
  2331     05  CARRO PIC  X(0001).
  2332*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  46
* EL6501.cbl
  2333     05  FILLER            PIC  X(0003).
  2334     05  GROUPINO PIC  X(0006).
  2335*    -------------------------------
  2336     05  FILLER            PIC  X(0003).
  2337     05  STATEO PIC  X(0002).
  2338*    -------------------------------
  2339     05  FILLER            PIC  X(0003).
  2340     05  ACCOUNTO PIC  X(0010).
  2341*    -------------------------------
  2342     05  FILLER            PIC  X(0003).
  2343     05  EFFDTEO PIC  X(0008).
  2344*    -------------------------------
  2345     05  FILLER            PIC  X(0003).
  2346     05  EXPDTEO PIC  99B99B99.
  2347*    -------------------------------
  2348     05  FILLER            PIC  X(0003).
  2349     05  MAINTBYO PIC  X(0004).
  2350*    -------------------------------
  2351     05  FILLER            PIC  X(0003).
  2352     05  PCONTO PIC  X(0030).
  2353*    -------------------------------
  2354     05  FILLER            PIC  X(0003).
  2355     05  CSRO PIC  X(0004).
  2356*    -------------------------------
  2357     05  FILLER            PIC  X(0003).
  2358     05  PDSPLYO PIC  X(0006).
  2359*    -------------------------------
  2360     05  FILLER            PIC  X(0003).
  2361     05  PEFFDTEO PIC  X(0008).
  2362*    -------------------------------
  2363     05  FILLER            PIC  X(0003).
  2364     05  PEXPDTEO PIC  X(0008).
  2365*    -------------------------------
  2366     05  FILLER            PIC  X(0003).
  2367     05  NAMEO PIC  X(0030).
  2368*    -------------------------------
  2369     05  FILLER            PIC  X(0003).
  2370     05  TAXNOO PIC  X(0011).
  2371*    -------------------------------
  2372     05  FILLER            PIC  X(0003).
  2373     05  STATUSO PIC  X(0001).
  2374*    -------------------------------
  2375     05  FILLER            PIC  X(0003).
  2376     05  INCAREO PIC  X(0030).
  2377*    -------------------------------
  2378     05  FILLER            PIC  X(0003).
  2379     05  PHONEO PIC  999B999B9999.
  2380*    -------------------------------
  2381     05  FILLER            PIC  X(0003).
  2382     05  INDGRPO PIC  X(0001).
  2383*    -------------------------------
  2384     05  FILLER            PIC  X(0003).
  2385     05  ADDR1O PIC  X(0030).
  2386*    -------------------------------
  2387     05  FILLER            PIC  X(0003).
  2388     05  CONTRO PIC  X(0008).
  2389*    -------------------------------
  2390     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  47
* EL6501.cbl
  2391     05  TYPEO PIC  X(0002).
  2392*    -------------------------------
  2393     05  FILLER            PIC  X(0003).
  2394     05  ACITYO PIC  X(0028).
  2395*    -------------------------------
  2396     05  FILLER            PIC  X(0003).
  2397     05  ASTATEO PIC  X(0002).
  2398*    -------------------------------
  2399     05  FILLER            PIC  X(0003).
  2400     05  PRODATEO PIC  X(0008).
  2401*    -------------------------------
  2402     05  FILLER            PIC  X(0003).
  2403     05  STDBENO PIC  X(0002).
  2404*    -------------------------------
  2405     05  FILLER            PIC  X(0003).
  2406     05  ZIPO PIC  X(0010).
  2407*    -------------------------------
  2408     05  FILLER            PIC  X(0003).
  2409     05  CTPLABLO PIC  X(0010).
  2410*    -------------------------------
  2411     05  FILLER            PIC  X(0003).
  2412     05  CLPTOLPO PIC  Z.9999.
  2413*    -------------------------------
  2414     05  FILLER            PIC  X(0003).
  2415     05  RETROCDO PIC  X(0003).
  2416*    -------------------------------
  2417     05  FILLER            PIC  X(0003).
  2418     05  BILLCDO PIC  X(0003).
  2419*    -------------------------------
  2420     05  FILLER            PIC  X(0003).
  2421     05  LCLABLO PIC  X(0011).
  2422*    -------------------------------
  2423     05  FILLER            PIC  X(0003).
  2424     05  LCOMMO PIC  ZZ99.99-.
  2425*    -------------------------------
  2426     05  FILLER            PIC  X(0003).
  2427     05  MAXFEEHO PIC  X(0013).
  2428*    -------------------------------
  2429     05  FILLER            PIC  X(0003).
  2430     05  MAXMFEEO PIC  Z,Z99.
  2431*    -------------------------------
  2432     05  FILLER            PIC  X(0003).
  2433     05  CLPSTHO PIC  X(0010).
  2434*    -------------------------------
  2435     05  FILLER            PIC  X(0003).
  2436     05  CLPSTO PIC  X(0002).
  2437*    -------------------------------
  2438     05  FILLER            PIC  X(0003).
  2439     05  PRODCDHO PIC  X(0012).
  2440*    -------------------------------
  2441     05  FILLER            PIC  X(0003).
  2442     05  PRODCDO PIC  X(0003).
  2443*    -------------------------------
  2444     05  FILLER            PIC  X(0003).
  2445     05  REMITO PIC  X(0002).
  2446*    -------------------------------
  2447     05  FILLER            PIC  X(0003).
  2448     05  COMMCALO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  48
* EL6501.cbl
  2449*    -------------------------------
  2450     05  FILLER            PIC  X(0003).
  2451     05  REINTABO PIC  X(0003).
  2452*    -------------------------------
  2453     05  FILLER            PIC  X(0003).
  2454     05  REINCALO PIC  X(0001).
  2455*    -------------------------------
  2456     05  FILLER            PIC  X(0003).
  2457     05  AHHEADO PIC  X(0006).
  2458*    -------------------------------
  2459     05  FILLER            PIC  X(0003).
  2460     05  AGNT1O PIC  X(0010).
  2461*    -------------------------------
  2462     05  FILLER            PIC  X(0003).
  2463     05  TYPE1O PIC  X(0001).
  2464*    -------------------------------
  2465     05  FILLER            PIC  X(0003).
  2466     05  SINRT1O PIC  X(0006).
  2467*    -------------------------------
  2468     05  FILLER            PIC  X(0003).
  2469     05  JNTRT1O PIC  X(0006).
  2470*    -------------------------------
  2471     05  FILLER            PIC  X(0003).
  2472     05  AHRT1O PIC  X(0006).
  2473*    -------------------------------
  2474     05  FILLER            PIC  X(0003).
  2475     05  RECAL1O PIC  X(0001).
  2476*    -------------------------------
  2477     05  FILLER            PIC  X(0003).
  2478     05  COMM1O PIC  X(0001).
  2479*    -------------------------------
  2480     05  FILLER            PIC  X(0003).
  2481     05  CHGBK1O PIC  X(0002).
  2482*    -------------------------------
  2483     05  FILLER            PIC  X(0003).
  2484     05  CCE01O PIC  X(0001).
  2485*    -------------------------------
  2486     05  FILLER            PIC  X(0003).
  2487     05  AGNT2O PIC  X(0010).
  2488*    -------------------------------
  2489     05  FILLER            PIC  X(0003).
  2490     05  TYPE2O PIC  X(0001).
  2491*    -------------------------------
  2492     05  FILLER            PIC  X(0003).
  2493     05  SINRT2O PIC  X(0006).
  2494*    -------------------------------
  2495     05  FILLER            PIC  X(0003).
  2496     05  JNTRT2O PIC  X(0006).
  2497*    -------------------------------
  2498     05  FILLER            PIC  X(0003).
  2499     05  AHRT2O PIC  X(0006).
  2500*    -------------------------------
  2501     05  FILLER            PIC  X(0003).
  2502     05  RECAL2O PIC  X(0001).
  2503*    -------------------------------
  2504     05  FILLER            PIC  X(0003).
  2505     05  COMM2O PIC  X(0001).
  2506*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  49
* EL6501.cbl
  2507     05  FILLER            PIC  X(0003).
  2508     05  CHGBK2O PIC  X(0002).
  2509*    -------------------------------
  2510     05  FILLER            PIC  X(0003).
  2511     05  CCE02O PIC  X(0001).
  2512*    -------------------------------
  2513     05  FILLER            PIC  X(0003).
  2514     05  AGNT3O PIC  X(0010).
  2515*    -------------------------------
  2516     05  FILLER            PIC  X(0003).
  2517     05  TYPE3O PIC  X(0001).
  2518*    -------------------------------
  2519     05  FILLER            PIC  X(0003).
  2520     05  SINRT3O PIC  X(0006).
  2521*    -------------------------------
  2522     05  FILLER            PIC  X(0003).
  2523     05  JNTRT3O PIC  X(0006).
  2524*    -------------------------------
  2525     05  FILLER            PIC  X(0003).
  2526     05  AHRT3O PIC  X(0006).
  2527*    -------------------------------
  2528     05  FILLER            PIC  X(0003).
  2529     05  RECAL3O PIC  X(0001).
  2530*    -------------------------------
  2531     05  FILLER            PIC  X(0003).
  2532     05  COMM3O PIC  X(0001).
  2533*    -------------------------------
  2534     05  FILLER            PIC  X(0003).
  2535     05  CHGBK3O PIC  X(0002).
  2536*    -------------------------------
  2537     05  FILLER            PIC  X(0003).
  2538     05  CCE03O PIC  X(0001).
  2539*    -------------------------------
  2540     05  FILLER            PIC  X(0003).
  2541     05  AGNT4O PIC  X(0010).
  2542*    -------------------------------
  2543     05  FILLER            PIC  X(0003).
  2544     05  TYPE4O PIC  X(0001).
  2545*    -------------------------------
  2546     05  FILLER            PIC  X(0003).
  2547     05  SINRT4O PIC  X(0006).
  2548*    -------------------------------
  2549     05  FILLER            PIC  X(0003).
  2550     05  JNTRT4O PIC  X(0006).
  2551*    -------------------------------
  2552     05  FILLER            PIC  X(0003).
  2553     05  AHRT4O PIC  X(0006).
  2554*    -------------------------------
  2555     05  FILLER            PIC  X(0003).
  2556     05  RECAL4O PIC  X(0001).
  2557*    -------------------------------
  2558     05  FILLER            PIC  X(0003).
  2559     05  COMM4O PIC  X(0001).
  2560*    -------------------------------
  2561     05  FILLER            PIC  X(0003).
  2562     05  CHGBK4O PIC  X(0002).
  2563*    -------------------------------
  2564     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  50
* EL6501.cbl
  2565     05  CCE04O PIC  X(0001).
  2566*    -------------------------------
  2567     05  FILLER            PIC  X(0003).
  2568     05  AGNT5O PIC  X(0010).
  2569*    -------------------------------
  2570     05  FILLER            PIC  X(0003).
  2571     05  TYPE5O PIC  X(0001).
  2572*    -------------------------------
  2573     05  FILLER            PIC  X(0003).
  2574     05  SINRT5O PIC  X(0006).
  2575*    -------------------------------
  2576     05  FILLER            PIC  X(0003).
  2577     05  JNTRT5O PIC  X(0006).
  2578*    -------------------------------
  2579     05  FILLER            PIC  X(0003).
  2580     05  AHRT5O PIC  X(0006).
  2581*    -------------------------------
  2582     05  FILLER            PIC  X(0003).
  2583     05  RECAL5O PIC  X(0001).
  2584*    -------------------------------
  2585     05  FILLER            PIC  X(0003).
  2586     05  COMM5O PIC  X(0001).
  2587*    -------------------------------
  2588     05  FILLER            PIC  X(0003).
  2589     05  CHGBK5O PIC  X(0002).
  2590*    -------------------------------
  2591     05  FILLER            PIC  X(0003).
  2592     05  CCE05O PIC  X(0001).
  2593*    -------------------------------
  2594     05  FILLER            PIC  X(0003).
  2595     05  AGNT6O PIC  X(0010).
  2596*    -------------------------------
  2597     05  FILLER            PIC  X(0003).
  2598     05  TYPE6O PIC  X(0001).
  2599*    -------------------------------
  2600     05  FILLER            PIC  X(0003).
  2601     05  SINRT6O PIC  X(0006).
  2602*    -------------------------------
  2603     05  FILLER            PIC  X(0003).
  2604     05  JNTRT6O PIC  X(0006).
  2605*    -------------------------------
  2606     05  FILLER            PIC  X(0003).
  2607     05  AHRT6O PIC  X(0006).
  2608*    -------------------------------
  2609     05  FILLER            PIC  X(0003).
  2610     05  RECAL6O PIC  X(0001).
  2611*    -------------------------------
  2612     05  FILLER            PIC  X(0003).
  2613     05  COMM6O PIC  X(0001).
  2614*    -------------------------------
  2615     05  FILLER            PIC  X(0003).
  2616     05  CHGBK6O PIC  X(0002).
  2617*    -------------------------------
  2618     05  FILLER            PIC  X(0003).
  2619     05  CCE06O PIC  X(0001).
  2620*    -------------------------------
  2621     05  FILLER            PIC  X(0003).
  2622     05  AGNT7O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  51
* EL6501.cbl
  2623*    -------------------------------
  2624     05  FILLER            PIC  X(0003).
  2625     05  TYPE7O PIC  X(0001).
  2626*    -------------------------------
  2627     05  FILLER            PIC  X(0003).
  2628     05  SINRT7O PIC  X(0006).
  2629*    -------------------------------
  2630     05  FILLER            PIC  X(0003).
  2631     05  JNTRT7O PIC  X(0006).
  2632*    -------------------------------
  2633     05  FILLER            PIC  X(0003).
  2634     05  AHRT7O PIC  X(0006).
  2635*    -------------------------------
  2636     05  FILLER            PIC  X(0003).
  2637     05  RECAL7O PIC  X(0001).
  2638*    -------------------------------
  2639     05  FILLER            PIC  X(0003).
  2640     05  COMM7O PIC  X(0001).
  2641*    -------------------------------
  2642     05  FILLER            PIC  X(0003).
  2643     05  CHGBK7O PIC  X(0002).
  2644*    -------------------------------
  2645     05  FILLER            PIC  X(0003).
  2646     05  CCE07O PIC  X(0001).
  2647*    -------------------------------
  2648     05  FILLER            PIC  X(0003).
  2649     05  AGNT8O PIC  X(0010).
  2650*    -------------------------------
  2651     05  FILLER            PIC  X(0003).
  2652     05  TYPE8O PIC  X(0001).
  2653*    -------------------------------
  2654     05  FILLER            PIC  X(0003).
  2655     05  SINRT8O PIC  X(0006).
  2656*    -------------------------------
  2657     05  FILLER            PIC  X(0003).
  2658     05  JNTRT8O PIC  X(0006).
  2659*    -------------------------------
  2660     05  FILLER            PIC  X(0003).
  2661     05  AHRT8O PIC  X(0006).
  2662*    -------------------------------
  2663     05  FILLER            PIC  X(0003).
  2664     05  RECAL8O PIC  X(0001).
  2665*    -------------------------------
  2666     05  FILLER            PIC  X(0003).
  2667     05  COMM8O PIC  X(0001).
  2668*    -------------------------------
  2669     05  FILLER            PIC  X(0003).
  2670     05  CHGBK8O PIC  X(0002).
  2671*    -------------------------------
  2672     05  FILLER            PIC  X(0003).
  2673     05  CCE08O PIC  X(0001).
  2674*    -------------------------------
  2675     05  FILLER            PIC  X(0003).
  2676     05  AGNT9O PIC  X(0010).
  2677*    -------------------------------
  2678     05  FILLER            PIC  X(0003).
  2679     05  TYPE9O PIC  X(0001).
  2680*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  52
* EL6501.cbl
  2681     05  FILLER            PIC  X(0003).
  2682     05  SINRT9O PIC  X(0006).
  2683*    -------------------------------
  2684     05  FILLER            PIC  X(0003).
  2685     05  JNTRT9O PIC  X(0006).
  2686*    -------------------------------
  2687     05  FILLER            PIC  X(0003).
  2688     05  AHRT9O PIC  X(0006).
  2689*    -------------------------------
  2690     05  FILLER            PIC  X(0003).
  2691     05  RECAL9O PIC  X(0001).
  2692*    -------------------------------
  2693     05  FILLER            PIC  X(0003).
  2694     05  COMM9O PIC  X(0001).
  2695*    -------------------------------
  2696     05  FILLER            PIC  X(0003).
  2697     05  CHGBK9O PIC  X(0002).
  2698*    -------------------------------
  2699     05  FILLER            PIC  X(0003).
  2700     05  CCE09O PIC  X(0001).
  2701*    -------------------------------
  2702     05  FILLER            PIC  X(0003).
  2703     05  AGNT10O PIC  X(0010).
  2704*    -------------------------------
  2705     05  FILLER            PIC  X(0003).
  2706     05  TYPE10O PIC  X(0001).
  2707*    -------------------------------
  2708     05  FILLER            PIC  X(0003).
  2709     05  SINRT10O PIC  X(0006).
  2710*    -------------------------------
  2711     05  FILLER            PIC  X(0003).
  2712     05  JNTRT10O PIC  X(0006).
  2713*    -------------------------------
  2714     05  FILLER            PIC  X(0003).
  2715     05  AHRT10O PIC  X(0006).
  2716*    -------------------------------
  2717     05  FILLER            PIC  X(0003).
  2718     05  RECAL10O PIC  X(0001).
  2719*    -------------------------------
  2720     05  FILLER            PIC  X(0003).
  2721     05  COMM10O PIC  X(0001).
  2722*    -------------------------------
  2723     05  FILLER            PIC  X(0003).
  2724     05  CHGBK10O PIC  X(0002).
  2725*    -------------------------------
  2726     05  FILLER            PIC  X(0003).
  2727     05  CCE10O PIC  X(0001).
  2728*    -------------------------------
  2729     05  FILLER            PIC  X(0003).
  2730     05  ERRMSG1O PIC  X(0075).
  2731*    -------------------------------
  2732     05  FILLER            PIC  X(0003).
  2733     05  PFENTERO PIC  X(0002).
  2734*    -------------------------------
  2735     05  FILLER            PIC  X(0003).
  2736     05  PF1PF2O PIC  X(0035).
  2737*    -------------------------------
  2738 01  MAP-R REDEFINES EL6501AI.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  53
* EL6501.cbl
  2739*    12  FILLER                  PIC X(518).
  2740*    12  FILLER                  PIC X(543).
  2741     12  FILLER                  PIC X(546).
  2742     12  MAP-AGENT-AREA.
  2743         16  AGENT-AREA OCCURS 10 TIMES INDEXED BY M-INDEX.
  2744             20  AGENTL          PIC S9(4) COMP.
  2745             20  AGENTA          PIC X.
  2746             20  AGENT           PIC X(10).
  2747             20  ATYPEL          PIC S9(4) COMP.
  2748             20  ATYPEA          PIC X.
  2749             20  ATYPE           PIC X.
  2750             20  SINGLEL         PIC S9(4) COMP.
  2751             20  SINGLEA         PIC X.
  2752             20  SINGLE-COMM-T   PIC X(6).
  2753             20  SINGLE-COMM-N REDEFINES SINGLE-COMM-T.
  2754                 24  SINGLE-COMM-R PIC V9(5).
  2755                 24  SINGLE-DASH   PIC X.
  2756             20  SINGLE-COMM-O REDEFINES SINGLE-COMM-T
  2757                                 PIC V9(5)-.
  2758             20  JOINTL          PIC S9(4) COMP.
  2759             20  JOINTA          PIC X.
  2760             20  JOINT-COMM-T    PIC X(6).
  2761             20  JOINT-COMM-N REDEFINES JOINT-COMM-T.
  2762                 24  JOINT-COMM-R PIC V9(5).
  2763                 24  JOINT-DASH   PIC X.
  2764             20  JOINT-COMM-O REDEFINES JOINT-COMM-T
  2765                                 PIC V9(5)-.
  2766             20  A-HL            PIC S9(4) COMP.
  2767             20  A-HA            PIC X.
  2768             20  A-H-COMM-T      PIC X(6).
  2769             20  A-H-COMM-N  REDEFINES A-H-COMM-T.
  2770                 24  A-H-COMM-R  PIC V9(5).
  2771                 24  A-H-DASH    PIC X.
  2772             20  A-H-COMM-O  REDEFINES A-H-COMM-T
  2773                                 PIC V9(5)-.
  2774             20  RECALL          PIC S9(4) COMP.
  2775             20  RECALA          PIC X.
  2776             20  RECAL           PIC X.
  2777             20  RCOMML          PIC S9(4) COMP.
  2778             20  RCOMMA          PIC X.
  2779             20  RCOMM           PIC X.
  2780             20  CHGBCKL         PIC S9(4) COMP.
  2781             20  CHGBCKA         PIC X.
  2782             20  CHGBCK          PIC X(02).
  2783             20  CCEL            PIC S9(4) COMP.
  2784             20  CCEA            PIC X.
  2785             20  CCEIND          PIC X.
  2786****************************************************************
  2787*
  2788* Copyright (c) 2007-2013 Dell Inc.
  2789* All rights reserved.
  2790*
  2791****************************************************************
  2792 01  DFHEIV.
  2793   02  DFHEIV0               PIC X(35).
  2794   02  DFHEIV1               PIC X(08).
  2795   02  DFHEIV2               PIC X(08).
  2796   02  DFHEIV3               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  54
* EL6501.cbl
  2797   02  DFHEIV4               PIC X(06).
  2798   02  DFHEIV5               PIC X(04).
  2799   02  DFHEIV6               PIC X(04).
  2800   02  DFHEIV7               PIC X(02).
  2801   02  DFHEIV8               PIC X(02).
  2802   02  DFHEIV9               PIC X(01).
  2803   02  DFHEIV10              PIC S9(7) COMP-3.
  2804   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2805   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2806   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2807   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2808   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2809   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2810   02  DFHEIV17              PIC X(04).
  2811   02  DFHEIV18              PIC X(04).
  2812   02  DFHEIV19              PIC X(04).
  2813   02  DFHEIV20              USAGE IS POINTER.
  2814   02  DFHEIV21              USAGE IS POINTER.
  2815   02  DFHEIV22              USAGE IS POINTER.
  2816   02  DFHEIV23              USAGE IS POINTER.
  2817   02  DFHEIV24              USAGE IS POINTER.
  2818   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2819   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2820   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2821   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2822   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2823   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2824   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2825   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2826   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2827   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2828   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2829   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2830   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2831   02  FILLER                PIC X(02).
  2832   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2833   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2834   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2835   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2836   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2837   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2838   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2839 LINKAGE  SECTION.
  2840*****************************************************************
  2841*                                                               *
  2842* Copyright (c) 2007-2013 Dell Inc.                             *
  2843* All rights reserved.                                          *
  2844*                                                               *
  2845*****************************************************************
  2846 01  dfheiblk.
  2847     02  eibtime          pic s9(7) comp-3.
  2848     02  eibdate          pic s9(7) comp-3.
  2849     02  eibtrnid         pic x(4).
  2850     02  eibtaskn         pic s9(7) comp-3.
  2851     02  eibtrmid         pic x(4).
  2852     02  dfheigdi         pic s9(4) comp.
  2853     02  eibcposn         pic s9(4) comp.
  2854     02  eibcalen         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  55
* EL6501.cbl
  2855     02  eibaid           pic x(1).
  2856     02  eibfiller1       pic x(1).
  2857     02  eibfn            pic x(2).
  2858     02  eibfiller2       pic x(2).
  2859     02  eibrcode         pic x(6).
  2860     02  eibfiller3       pic x(2).
  2861     02  eibds            pic x(8).
  2862     02  eibreqid         pic x(8).
  2863     02  eibrsrce         pic x(8).
  2864     02  eibsync          pic x(1).
  2865     02  eibfree          pic x(1).
  2866     02  eibrecv          pic x(1).
  2867     02  eibsend          pic x(1).
  2868     02  eibatt           pic x(1).
  2869     02  eibeoc           pic x(1).
  2870     02  eibfmh           pic x(1).
  2871     02  eibcompl         pic x(1).
  2872     02  eibsig           pic x(1).
  2873     02  eibconf          pic x(1).
  2874     02  eiberr           pic x(1).
  2875     02  eibrldbk         pic x(1).
  2876     02  eiberrcd         pic x(4).
  2877     02  eibsynrb         pic x(1).
  2878     02  eibnodat         pic x(1).
  2879     02  eibfiller5       pic x(2).
  2880     02  eibresp          pic s9(8) comp.
  2881     02  eibresp2         pic s9(8) comp.
  2882     02  dfheigdj         pic s9(4) comp.
  2883     02  dfheigdk         pic s9(4) comp.
  2884 01  DFHCOMMAREA                 PIC X(1500).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  56
* EL6501.cbl
  2886*01 PARMLIST .
  2887*    02  FILLER                  PIC S9(8)   COMP.
  2888*    02  ERACCT-POINTER          PIC S9(8)   COMP.
  2889*    02  ELCNTL-POINTER          PIC S9(8)   COMP.
  2890*    02  REIN-POINTER            PIC S9(8)   COMP.
  2891*    02  CTBL-POINTER            PIC S9(8)   COMP.
  2892*    02  COMM-POINTER            PIC S9(8)   COMP.
  2893*    02  COMP-POINTER            PIC S9(8)   COMP.
  2894*    02  NAME-POINTER            PIC S9(8)   COMP.
  2895*    02  RQST-POINTER            PIC S9(8)   COMP.
  2896*    02  AXRF-POINTER            PIC S9(8)   COMP.
  2897*    02  AXRF2-POINTER           PIC S9(8)   COMP.
  2898*    02  AXRF3-POINTER           PIC S9(8)   COMP.
  2899*    02  AXRF4-POINTER           PIC S9(8)   COMP.
  2900*    02  AXRF5-POINTER           PIC S9(8)   COMP.
  2901*    02  AXRF6-POINTER           PIC S9(8)   COMP.
  2902*    02  AXRF7-POINTER           PIC S9(8)   COMP.
  2903*    02  AXRF8-POINTER           PIC S9(8)   COMP.
  2904*    COPY ERCACCT.
  2905******************************************************************
  2906*                                                                *
  2907*                                                                *
  2908*                            ERCACCT                             *
  2909*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2910*                            VMOD=2.031                          *
  2911*                                                                *
  2912*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2913*                                                                *
  2914*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2915*   VSAM ACCOUNT MASTER FILES.                                   *
  2916*                                                                *
  2917*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2918*                                                                *
  2919*   FILE TYPE = VSAM,KSDS                                        *
  2920*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2921*                                                                *
  2922*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2923*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2924*                                                                *
  2925*   LOG = NO                                                     *
  2926*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2927*                                                                *
  2928*                                                                *
  2929******************************************************************
  2930*                   C H A N G E   L O G
  2931*
  2932* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2933*-----------------------------------------------------------------
  2934*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2935* EFFECTIVE    NUMBER
  2936*-----------------------------------------------------------------
  2937* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2938* 092705    2005050300006  PEMA  ADD SPP LEASES
  2939* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2940* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2941* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2942* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2943* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  57
* EL6501.cbl
  2944* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2945******************************************************************
  2946
  2947 01  ACCOUNT-MASTER.
  2948     12  AM-RECORD-ID                      PIC XX.
  2949         88  VALID-AM-ID                      VALUE 'AM'.
  2950
  2951     12  AM-CONTROL-PRIMARY.
  2952         16  AM-COMPANY-CD                 PIC X.
  2953         16  AM-MSTR-CNTRL.
  2954             20  AM-CONTROL-A.
  2955                 24  AM-CARRIER            PIC X.
  2956                 24  AM-GROUPING.
  2957                     28 AM-GROUPING-PREFIX PIC XXX.
  2958                     28 AM-GROUPING-PRIME  PIC XXX.
  2959                 24  AM-STATE              PIC XX.
  2960                 24  AM-ACCOUNT.
  2961                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2962                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2963             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2964                                           PIC X(19).
  2965             20  AM-CNTRL-B.
  2966                 24  AM-EXPIRATION-DT      PIC XX.
  2967                 24  FILLER                PIC X(4).
  2968             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2969                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2970
  2971     12  AM-CONTROL-BY-VAR-GRP.
  2972         16  AM-COMPANY-CD-A1              PIC X.
  2973         16  AM-VG-CARRIER                 PIC X.
  2974         16  AM-VG-GROUPING                PIC X(6).
  2975         16  AM-VG-STATE                   PIC XX.
  2976         16  AM-VG-ACCOUNT                 PIC X(10).
  2977         16  AM-VG-DATE.
  2978             20  AM-VG-EXPIRATION-DT       PIC XX.
  2979             20  FILLER                    PIC X(4).
  2980         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2981                                           PIC 9(11)      COMP-3.
  2982     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2983         16  FILLER                        PIC X(10).
  2984         16  AM-VG-KEY3.
  2985             20  AM-VG3-ACCOUNT            PIC X(10).
  2986             20  AM-VG3-EXP-DT             PIC XX.
  2987         16  FILLER                        PIC X(4).
  2988     12  AM-MAINT-INFORMATION.
  2989         16  AM-LAST-MAINT-DT              PIC XX.
  2990         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2991         16  AM-LAST-MAINT-USER            PIC X(4).
  2992         16  FILLER                        PIC XX.
  2993
  2994     12  AM-EFFECTIVE-DT                   PIC XX.
  2995     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2996
  2997     12  AM-PREV-DATES  COMP-3.
  2998         16  AM-PREV-EXP-DT                PIC 9(11).
  2999         16  AM-PREV-EFF-DT                PIC 9(11).
  3000
  3001     12  AM-REPORT-CODE-1                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  58
* EL6501.cbl
  3002     12  AM-REPORT-CODE-2                  PIC X(10).
  3003
  3004     12  AM-CITY-CODE                      PIC X(4).
  3005     12  AM-COUNTY-PARISH                  PIC X(6).
  3006
  3007     12  AM-NAME                           PIC X(30).
  3008     12  AM-PERSON                         PIC X(30).
  3009     12  AM-ADDRS                          PIC X(30).
  3010     12  AM-CITY.
  3011         16  AM-ADDR-CITY                  PIC X(28).
  3012         16  AM-ADDR-STATE                 PIC XX.
  3013     12  AM-ZIP.
  3014         16  AM-ZIP-PRIME.
  3015             20  AM-ZIP-PRI-1ST            PIC X.
  3016                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3017             20  FILLER                    PIC X(4).
  3018         16  AM-ZIP-PLUS4                  PIC X(4).
  3019     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3020         16  AM-CAN-POSTAL-1               PIC XXX.
  3021         16  AM-CAN-POSTAL-2               PIC XXX.
  3022         16  FILLER                        PIC XXX.
  3023     12  AM-TEL-NO.
  3024         16  AM-AREA-CODE                  PIC 999.
  3025         16  AM-TEL-PRE                    PIC 999.
  3026         16  AM-TEL-NBR                    PIC 9(4).
  3027     12  AM-TEL-LOC                        PIC X.
  3028         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3029         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3030
  3031     12  AM-COMM-STRUCTURE.
  3032         16  AM-DEFN-1.
  3033             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3034                 24  AM-AGT.
  3035                     28  AM-AGT-PREFIX     PIC X(4).
  3036                     28  AM-AGT-PRIME      PIC X(6).
  3037                 24  AM-COM-TYP            PIC X.
  3038                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3039                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3040                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3041                 24  AM-RECALC-LV-INDIC    PIC X.
  3042                 24  AM-RETRO-LV-INDIC     PIC X.
  3043                 24  AM-GL-CODES           PIC X.
  3044                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3045                 24  FILLER                PIC X(01).
  3046         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3047             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3048                 24  FILLER                PIC X(11).
  3049                 24  AM-L-COMA             PIC XXX.
  3050                 24  AM-J-COMA             PIC XXX.
  3051                 24  AM-A-COMA             PIC XXX.
  3052                 24  FILLER                PIC X(6).
  3053
  3054     12  AM-COMM-CHANGE-STATUS             PIC X.
  3055         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3056
  3057     12  AM-CSR-CODE                       PIC X(4).
  3058
  3059     12  AM-BILLING-STATUS                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  59
* EL6501.cbl
  3060         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3061         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3062     12  AM-AUTO-REFUND-SW                 PIC X.
  3063         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3064         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3065     12  AM-GPCD                           PIC 99.
  3066     12  AM-IG                             PIC X.
  3067         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3068         88  AM-HAS-GROUP                     VALUE '2'.
  3069     12  AM-STATUS                         PIC X.
  3070         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3071         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3072         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3073         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3074         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3075         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3076         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  3077         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  3078         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  3079         88  AM-ACCOUNT-PENDING               VALUE '9'.
  3080     12  AM-REMIT-TO                       PIC 99.
  3081     12  AM-ID-NO                          PIC X(11).
  3082
  3083     12  AM-CAL-TABLE                      PIC XX.
  3084     12  AM-LF-DEVIATION                   PIC XXX.
  3085     12  AM-AH-DEVIATION                   PIC XXX.
  3086     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3087     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3088     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3089     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3090     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3091     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3092
  3093     12  AM-USER-FIELDS.
  3094         16  AM-FLD-1                      PIC XX.
  3095         16  AM-FLD-2                      PIC XX.
  3096         16  AM-FLD-3                      PIC XX.
  3097         16  AM-FLD-4                      PIC XX.
  3098         16  AM-FLD-5                      PIC XX.
  3099
  3100     12  AM-1ST-PROD-DATE.
  3101         16  AM-1ST-PROD-YR                PIC XX.
  3102         16  AM-1ST-PROD-MO                PIC XX.
  3103         16  AM-1ST-PROD-DA                PIC XX.
  3104     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3105     12  AM-CERTS-PURGED-DATE.
  3106         16  AM-PUR-YR                     PIC XX.
  3107         16  AM-PUR-MO                     PIC XX.
  3108         16  AM-PUR-DA                     PIC XX.
  3109     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3110     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3111     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3112     12  AM-INACTIVE-DATE.
  3113         16  AM-INA-MO                     PIC 99.
  3114         16  AM-INA-DA                     PIC 99.
  3115         16  AM-INA-YR                     PIC 99.
  3116     12  AM-AR-HI-CERT-DATE                PIC XX.
  3117
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  60
* EL6501.cbl
  3118     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3119     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3120
  3121     12  AM-OB-PAYMENT-MODE                PIC X.
  3122         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3123         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3124         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3125         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3126
  3127     12  AM-AH-ONLY-INDICATOR              PIC X.
  3128         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3129         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3130
  3131     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3132
  3133     12  AM-OVER-SHORT.
  3134         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3135         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3136
  3137     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3138     12  AM-DCC-CLP-STATE                  PIC XX.
  3139
  3140     12  AM-RECALC-COMM                    PIC X.
  3141     12  AM-RECALC-REIN                    PIC X.
  3142
  3143     12  AM-REI-TABLE                      PIC XXX.
  3144     12  AM-REI-ET-LF                      PIC X.
  3145     12  AM-REI-ET-AH                      PIC X.
  3146     12  AM-REI-PE-LF                      PIC X.
  3147     12  AM-REI-PE-AH                      PIC X.
  3148     12  AM-REI-PRT-ST                     PIC X.
  3149     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3150     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3151     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3152     12  AM-REI-GROUP-A                    PIC X(6).
  3153     12  AM-REI-MORT                       PIC X(4).
  3154     12  AM-REI-PRT-OW                     PIC X.
  3155     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3156     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3157     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3158     12  AM-REI-GROUP-B                    PIC X(6).
  3159
  3160     12  AM-TRUST-TYPE                     PIC X(2).
  3161
  3162     12  AM-EMPLOYER-STMT-USED             PIC X.
  3163     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3164
  3165     12  AM-STD-AH-TYPE                    PIC XX.
  3166     12  AM-EARN-METHODS.
  3167         16  AM-EARN-METHOD-R              PIC X.
  3168             88 AM-REF-RL-R78                 VALUE 'R'.
  3169             88 AM-REF-RL-PR                  VALUE 'P'.
  3170             88 AM-REF-RL-MEAN                VALUE 'M'.
  3171             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3172         16  AM-EARN-METHOD-L              PIC X.
  3173             88 AM-REF-LL-R78                 VALUE 'R'.
  3174             88 AM-REF-LL-PR                  VALUE 'P'.
  3175             88 AM-REF-LL-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  61
* EL6501.cbl
  3176             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3177         16  AM-EARN-METHOD-A              PIC X.
  3178             88 AM-REF-AH-R78                 VALUE 'R'.
  3179             88 AM-REF-AH-PR                  VALUE 'P'.
  3180             88 AM-REF-AH-MEAN                VALUE 'M'.
  3181             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3182             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3183             88 AM-REF-AH-NET                 VALUE 'N'.
  3184
  3185     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3186     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3187     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3188
  3189     12  AM-RET-Y-N                        PIC X.
  3190     12  AM-RET-P-E                        PIC X.
  3191     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3192     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3193     12  AM-RET-GRP                        PIC X(6).
  3194     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3195         16  AM-POOL-PRIME                 PIC XXX.
  3196         16  AM-POOL-SUB                   PIC XXX.
  3197     12  AM-RETRO-EARNINGS.
  3198         16  AM-RET-EARN-R                 PIC X.
  3199         16  AM-RET-EARN-L                 PIC X.
  3200         16  AM-RET-EARN-A                 PIC X.
  3201     12  AM-RET-ST-TAX-USE                 PIC X.
  3202         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3203         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3204     12  AM-RETRO-BEG-EARNINGS.
  3205         16  AM-RET-BEG-EARN-R             PIC X.
  3206         16  AM-RET-BEG-EARN-L             PIC X.
  3207         16  AM-RET-BEG-EARN-A             PIC X.
  3208     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3209     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3210
  3211     12  AM-USER-SELECT-OPTIONS.
  3212         16  AM-USER-SELECT-1              PIC X(10).
  3213         16  AM-USER-SELECT-2              PIC X(10).
  3214         16  AM-USER-SELECT-3              PIC X(10).
  3215         16  AM-USER-SELECT-4              PIC X(10).
  3216         16  AM-USER-SELECT-5              PIC X(10).
  3217
  3218     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3219
  3220     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3221
  3222     12  AM-RPT045A-SWITCH                 PIC X.
  3223         88  RPT045A-OFF                   VALUE 'N'.
  3224
  3225     12  AM-INSURANCE-LIMITS.
  3226         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3227         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3228
  3229     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3230         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3231
  3232     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3233         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  62
* EL6501.cbl
  3234         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3235
  3236     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3237
  3238     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3239     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3240     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3241     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3242     12  AM-DCC-UEF-STATE                  PIC XX.
  3243     12  FILLER                            PIC XXX.
  3244     12  AM-REPORT-CODE-3                  PIC X(10).
  3245*    12  FILLER                            PIC X(22).
  3246
  3247     12  AM-RESERVE-DATE.
  3248         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3249         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3250         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3251
  3252     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3253     12  AM-NOTIFICATION-TYPES.
  3254         16  AM-NOTIF-OF-LETTERS           PIC X.
  3255         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3256         16  AM-NOTIF-OF-REPORTS           PIC X.
  3257         16  AM-NOTIF-OF-STATUS            PIC X.
  3258
  3259     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3260         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3261         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3262         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3263         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3264
  3265     12  AM-BENEFIT-CONTROLS.
  3266         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3267             20  AM-BENEFIT-CODE           PIC XX.
  3268             20  AM-BENEFIT-TYPE           PIC X.
  3269             20  AM-BENEFIT-REVISION       PIC XXX.
  3270             20  AM-BENEFIT-REM-TERM       PIC X.
  3271             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  3272             20  FILLER                    PIC XX.
  3273         16  FILLER                        PIC X(80).
  3274
  3275     12  AM-TRANSFER-DATA.
  3276         16  AM-TRANSFERRED-FROM.
  3277             20  AM-TRNFROM-CARRIER        PIC X.
  3278             20  AM-TRNFROM-GROUPING.
  3279                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3280                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3281             20  AM-TRNFROM-STATE          PIC XX.
  3282             20  AM-TRNFROM-ACCOUNT.
  3283                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3284                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3285             20  AM-TRNFROM-DTE            PIC XX.
  3286         16  AM-TRANSFERRED-TO.
  3287             20  AM-TRNTO-CARRIER          PIC X.
  3288             20  AM-TRNTO-GROUPING.
  3289                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3290                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3291             20  AM-TRNTO-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  63
* EL6501.cbl
  3292             20  AM-TRNTO-ACCOUNT.
  3293                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3294                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3295             20  AM-TRNTO-DTE              PIC XX.
  3296         16  FILLER                        PIC X(10).
  3297
  3298     12  AM-SAVED-REMIT-TO                 PIC 99.
  3299
  3300     12  AM-COMM-STRUCTURE-SAVED.
  3301         16  AM-DEFN-1-SAVED.
  3302             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3303                 24  AM-AGT-SV             PIC X(10).
  3304                 24  AM-COM-TYP-SV         PIC X.
  3305                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3306                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3307                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3308                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3309                 24  FILLER                PIC X.
  3310                 24  AM-GL-CODES-SV        PIC X.
  3311                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3312                 24  FILLER                PIC X.
  3313         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3314             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3315                 24  FILLER                PIC X(11).
  3316                 24  AM-L-COMA-SV          PIC XXX.
  3317                 24  AM-J-COMA-SV          PIC XXX.
  3318                 24  AM-A-COMA-SV          PIC XXX.
  3319                 24  FILLER                PIC X(6).
  3320
  3321     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3322         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3323            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3324            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3325            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3326
  3327     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3328     12  FILLER                            PIC X(120).
  3329
  3330     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3331         16  AM-CONTROL-NAME               PIC X(30).
  3332         16  AM-EXECUTIVE-ONE.
  3333             20  AM-EXEC1-NAME             PIC X(15).
  3334             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3335                                                          COMP-3.
  3336             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3337                                                          COMP-3.
  3338         16  AM-EXECUTIVE-TWO.
  3339             20  AM-EXEC2-NAME             PIC X(15).
  3340             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3341                                                          COMP-3.
  3342             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3343                                                          COMP-3.
  3344
  3345     12  AM-RETRO-ADDITIONAL-DATA.
  3346         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3347         16  AM-RETRO-PREM-P-E             PIC X.
  3348         16  AM-RETRO-CLMS-P-I             PIC X.
  3349         16  AM-RETRO-RET-BRACKET-LF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  64
* EL6501.cbl
  3350             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3351                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3352                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3353             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3354                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3355                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3356             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3357                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3358                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3359         16  AM-RETRO-RET-BRACKET-AH.
  3360             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3361                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3362                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3363                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3364             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3365                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3366                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3367             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3368                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3369                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3370
  3371     12  AM-COMMENTS.
  3372         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3373
  3374     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3375         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3376         16  AM-FLI-BILLING-CODE           PIC X.
  3377         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3378         16  AM-FLI-UNITED-IDENT           PIC X.
  3379         16  AM-FLI-INTEREST-LOST-DATA.
  3380             20  AM-FLI-BANK-NO            PIC X(5).
  3381             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3382             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3383             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3384         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3385             20  AM-FLI-AGT                PIC X(9).
  3386             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3387             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3388         16  FILLER                        PIC X(102).
  3389
  3390     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3391         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3392             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3393             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3394             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3395             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3396             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3397         16  FILLER                          PIC X(10).
  3398******************************************************************
  3399*    copy ERCPDEF.
  3400******************************************************************
  3401*                                                                *
  3402*                                                                *
  3403*                            ERCPDEF.                            *
  3404*                                                                *
  3405*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3406*                                                                *
  3407*    FILE TYPE = VSAM,KSDS                                       *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  65
* EL6501.cbl
  3408*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3409*                                                                *
  3410*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3411*                                                                *
  3412*    LOG = YES                                                   *
  3413*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3414******************************************************************
  3415*                   C H A N G E   L O G
  3416*
  3417* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3418*-----------------------------------------------------------------
  3419*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3420* EFFECTIVE    NUMBER
  3421*-----------------------------------------------------------------
  3422* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3423* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3424* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3425* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3426******************************************************************
  3427 01  PRODUCT-MASTER.
  3428    12  PD-RECORD-ID                 PIC X(02).
  3429        88  VALID-PD-ID                  VALUE 'PD'.
  3430    12  PD-CONTROL-PRIMARY.
  3431        16  PD-COMPANY-CD            PIC X.
  3432        16  PD-STATE                 PIC XX.
  3433        16  PD-PRODUCT-CD            PIC XXX.
  3434        16  PD-FILLER                PIC X(7).
  3435        16  PD-BEN-TYPE              PIC X.
  3436        16  PD-BEN-CODE              PIC XX.
  3437        16  PD-PROD-EXP-DT           PIC XX.
  3438    12  FILLER                       PIC X(50).
  3439    12  PD-PRODUCT-DATA OCCURS 8.
  3440        16  PD-PROD-CODE             PIC X.
  3441            88  PD-PROD-LIFE           VALUE 'L'.
  3442            88  PD-PROD-PROP           VALUE 'P'.
  3443            88  PD-PROD-AH             VALUE 'A'.
  3444            88  PD-PROD-IU             VALUE 'I'.
  3445            88  PD-PROD-GAP            VALUE 'G'.
  3446            88  PD-PROD-FAML           VALUE 'F'.
  3447            88  PD-PROD-OTH            VALUE 'O'.
  3448        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3449        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3450        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3451        16  PD-MAX-TERM              PIC S999        COMP-3.
  3452        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3453        16  FILLER                   PIC X.
  3454        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3455        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3456        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3457        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3458        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3459        16  PD-REC-CRIT-PERIOD       PIC 99.
  3460        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3461            20  PD-RECURRING-YN      PIC X.
  3462            20  FILLER               PIC X.
  3463        16  PD-RTW-MOS               PIC 99.
  3464        16  PD-MAX-EXTENSION         PIC 99.
  3465        16  pd-ben-pct               pic sv999 comp-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  66
* EL6501.cbl
  3466*       16  FILLER                   PIC XX.
  3467    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3468    12  PD-TERM-LIMITS OCCURS 15.
  3469        16  PD-LOW-TERM              PIC S999        COMP-3.
  3470        16  PD-HI-TERM               PIC S999        COMP-3.
  3471*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3472    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3473        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3474        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3475    12  PD-EARN-FACTORS.
  3476        16  FILLER OCCURS 15.
  3477            20  FILLER OCCURS 15.
  3478                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3479    12  PD-PRODUCT-DESC              PIC X(80).
  3480    12  PD-TRUNCATED                 PIC X.
  3481    12  FILLER                       PIC X(59).
  3482    12  PD-MAINT-INFORMATION.
  3483        16  PD-LAST-MAINT-DT         PIC X(02).
  3484        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3485        16  PD-LAST-MAINT-BY         PIC X(04).
  3486*    COPY ELCCNTL.
  3487******************************************************************
  3488*                                                                *
  3489*                                                                *
  3490*                            ELCCNTL.                            *
  3491*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3492*                            VMOD=2.059                          *
  3493*                                                                *
  3494*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3495*                                                                *
  3496*   FILE TYPE = VSAM,KSDS                                        *
  3497*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3498*                                                                *
  3499*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3500*       ALTERNATE INDEX = NONE                                   *
  3501*                                                                *
  3502*   LOG = YES                                                    *
  3503*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3504******************************************************************
  3505*                   C H A N G E   L O G
  3506*
  3507* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3508*-----------------------------------------------------------------
  3509*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3510* EFFECTIVE    NUMBER
  3511*-----------------------------------------------------------------
  3512* 082503                   PEMA  ADD BENEFIT GROUP
  3513* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3514* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3515* 092705    2005050300006  PEMA  ADD SPP LEASES
  3516* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3517* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3518* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3519* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3520* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3521* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3522* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3523* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  67
* EL6501.cbl
  3524* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3525* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3526* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  3527******************************************************************
  3528*
  3529 01  CONTROL-FILE.
  3530     12  CF-RECORD-ID                       PIC XX.
  3531         88  VALID-CF-ID                        VALUE 'CF'.
  3532
  3533     12  CF-CONTROL-PRIMARY.
  3534         16  CF-COMPANY-ID                  PIC XXX.
  3535         16  CF-RECORD-TYPE                 PIC X.
  3536             88  CF-COMPANY-MASTER              VALUE '1'.
  3537             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3538             88  CF-STATE-MASTER                VALUE '3'.
  3539             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3540             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3541             88  CF-CARRIER-MASTER              VALUE '6'.
  3542             88  CF-MORTALITY-MASTER            VALUE '7'.
  3543             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3544             88  CF-TERMINAL-MASTER             VALUE '9'.
  3545             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3546             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3547             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3548             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3549             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3550             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3551             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3552             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3553             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3554         16  CF-ACCESS-CD-GENL              PIC X(4).
  3555         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3556             20  CF-PROCESSOR               PIC X(4).
  3557         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3558             20  CF-STATE-CODE              PIC XX.
  3559             20  FILLER                     PIC XX.
  3560         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3561             20  FILLER                     PIC XX.
  3562             20  CF-HI-BEN-IN-REC           PIC XX.
  3563         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3564             20  FILLER                     PIC XXX.
  3565             20  CF-CARRIER-CNTL            PIC X.
  3566         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3567             20  FILLER                     PIC XX.
  3568             20  CF-HI-TYPE-IN-REC          PIC 99.
  3569         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3570             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3571                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3572             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3573             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3574         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3575             20  FILLER                     PIC X.
  3576             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3577         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3578             20  FILLER                     PIC XX.
  3579             20  CF-MORTGAGE-PLAN           PIC XX.
  3580         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3581
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  68
* EL6501.cbl
  3582     12  CF-LAST-MAINT-DT                   PIC XX.
  3583     12  CF-LAST-MAINT-BY                   PIC X(4).
  3584     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3585
  3586     12  CF-RECORD-BODY                     PIC X(728).
  3587
  3588
  3589****************************************************************
  3590*             COMPANY MASTER RECORD                            *
  3591****************************************************************
  3592
  3593     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3594         16  CF-COMPANY-ADDRESS.
  3595             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3596             20  CF-CL-IN-CARE-OF           PIC X(30).
  3597             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3598             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3599             20  CF-CL-CITY-STATE           PIC X(30).
  3600             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3601             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3602         16  CF-COMPANY-CD                  PIC X.
  3603         16  CF-COMPANY-PASSWORD            PIC X(8).
  3604         16  CF-SECURITY-OPTION             PIC X.
  3605             88  ALL-SECURITY                   VALUE '1'.
  3606             88  COMPANY-VERIFY                 VALUE '2'.
  3607             88  PROCESSOR-VERIFY               VALUE '3'.
  3608             88  NO-SECURITY                    VALUE '4'.
  3609             88  ALL-BUT-TERM                   VALUE '5'.
  3610         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3611             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3612         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3613             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3614         16  CF-INFORCE-LOCATION            PIC X.
  3615             88  CERTS-ARE-ONLINE               VALUE '1'.
  3616             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3617             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3618         16  CF-LOWER-CASE-LETTERS          PIC X.
  3619         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3620             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3621             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3622             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3623             88  CF-ACCNT-CNTL                  VALUE '3'.
  3624             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3625
  3626         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3627         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3628
  3629         16  CF-LGX-CREDIT-USER             PIC X.
  3630             88  CO-IS-NOT-USER                 VALUE 'N'.
  3631             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3632
  3633         16 CF-CREDIT-CALC-CODES.
  3634             20  CF-CR-REM-TERM-CALC PIC X.
  3635               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3636               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3637               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3638               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3639               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  69
* EL6501.cbl
  3640               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3641               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3642             20  CF-CR-R78-METHOD           PIC X.
  3643               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3644               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3645
  3646         16  CF-CLAIM-CONTROL-COUNTS.
  3647             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3648                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3649
  3650             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3651                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3652
  3653             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3654                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3655
  3656             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3657                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3658
  3659         16  CF-CURRENT-MONTH-END           PIC XX.
  3660
  3661         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3662             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3663             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3664             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3665             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3666                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3667                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3668             20  CF-CO-PREM-REJECT-SW       PIC X.
  3669                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3670                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3671             20  CF-CO-REF-REJECT-SW        PIC X.
  3672                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3673                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3674
  3675         16  CF-CO-REPORTING-DT             PIC XX.
  3676         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3677         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3678           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3679           88  CF-CO-MONTH-END                  VALUE '1'.
  3680
  3681         16  CF-LGX-CLAIM-USER              PIC X.
  3682             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3683             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3684
  3685         16  CF-CREDIT-EDIT-CONTROLS.
  3686             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3687             20  CF-MIN-AGE                 PIC 99.
  3688             20  CF-DEFAULT-AGE             PIC 99.
  3689             20  CF-MIN-TERM                PIC S999      COMP-3.
  3690             20  CF-MAX-TERM                PIC S999      COMP-3.
  3691             20  CF-DEFAULT-SEX             PIC X.
  3692             20  CF-JOINT-AGE-INPUT         PIC X.
  3693                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3694             20  CF-BIRTH-DATE-INPUT        PIC X.
  3695                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3696             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3697                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  70
* EL6501.cbl
  3698                 88  CF-ZERO-CARRIER            VALUE '1'.
  3699                 88  CF-ZERO-GROUPING           VALUE '2'.
  3700                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3701             20  CF-EDIT-SW                 PIC X.
  3702                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3703             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3704             20  CF-CR-PR-METHOD            PIC X.
  3705               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3706               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3707             20  FILLER                     PIC X.
  3708
  3709         16  CF-CREDIT-MISC-CONTROLS.
  3710             20  CF-REIN-TABLE-SW           PIC X.
  3711                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3712             20  CF-COMP-TABLE-SW           PIC X.
  3713                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3714             20  CF-EXPERIENCE-RETENTION-AGE
  3715                                            PIC S9        COMP-3.
  3716             20  CF-CONVERSION-DT           PIC XX.
  3717             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3718             20  CF-RUN-FREQUENCY-SW        PIC X.
  3719                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3720                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3721
  3722             20  CF-CR-CHECK-NO-CONTROL.
  3723                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3724                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3725                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3726                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3727                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3728                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3729
  3730                 24  CF-CR-CHECK-COUNT       REDEFINES
  3731                     CF-CR-CHECK-COUNTER      PIC X(4).
  3732
  3733                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3734                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3735
  3736                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3737                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3738                 24  CF-MAIL-PROCESSING       PIC X.
  3739                     88  MAIL-PROCESSING          VALUE 'Y'.
  3740
  3741         16  CF-MISC-SYSTEM-CONTROL.
  3742             20  CF-SYSTEM-C                 PIC X.
  3743                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3744             20  CF-SYSTEM-D                 PIC X.
  3745                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3746             20  CF-SOC-SEC-NO-SW            PIC X.
  3747                 88  SOC-SEC-NO-USED             VALUE '1'.
  3748             20  CF-MEMBER-NO-SW             PIC X.
  3749                 88  MEMBER-NO-USED              VALUE '1'.
  3750             20  CF-TAX-ID-NUMBER            PIC X(11).
  3751             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3752             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3753                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3754                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3755                 88  CF-ALL-APPROVED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  71
* EL6501.cbl
  3756                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3757             20  CF-SYSTEM-E                 PIC X.
  3758                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3759
  3760         16  CF-LGX-LIFE-USER               PIC X.
  3761             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3762             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3763
  3764         16  CF-CR-MONTH-END-DT             PIC XX.
  3765
  3766         16  CF-FILE-MAINT-DATES.
  3767             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3768                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3769             20  CF-LAST-BATCH       REDEFINES
  3770                 CF-LAST-BATCH-NO               PIC X(4).
  3771             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3772             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3773             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3774             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3775             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3776             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3777             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3778             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3779             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3780             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3781
  3782         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3783         16  FILLER                         PIC X.
  3784
  3785         16  CF-ALT-MORT-CODE               PIC X(4).
  3786         16  CF-MEMBER-CAPTION              PIC X(10).
  3787
  3788         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3789             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3790             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3791             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3792             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3793             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3794
  3795         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3796
  3797         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3798         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3799         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3800         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3801
  3802         16  CF-AH-OVERRIDE-L1              PIC X.
  3803         16  CF-AH-OVERRIDE-L2              PIC XX.
  3804         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3805         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3806
  3807         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3808         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3809
  3810         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3811         16  CF-AR-LAST-EL860-DT            PIC XX.
  3812         16  CF-MP-MONTH-END-DT             PIC XX.
  3813
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  72
* EL6501.cbl
  3814         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3815         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3816             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3817
  3818         16  CF-AR-MONTH-END-DT             PIC XX.
  3819
  3820         16  CF-CRDTCRD-USER                PIC X.
  3821             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3822             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3823
  3824         16  CF-CC-MONTH-END-DT             PIC XX.
  3825
  3826         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3827
  3828         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3829             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3830             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3831             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3832         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3833         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3834         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3835         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3836             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3837             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3838         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3839         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3840         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3841             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3842         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3843
  3844         16  CF-CL-ZIP-CODE.
  3845             20  CF-CL-ZIP-PRIME.
  3846                 24  CF-CL-ZIP-1ST          PIC X.
  3847                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3848                 24  FILLER                 PIC X(4).
  3849             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3850         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3851             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3852             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3853             20  FILLER                     PIC XXX.
  3854
  3855         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3856         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3857         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3858         16  CF-CO-OPTION-START-DATE        PIC XX.
  3859         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3860           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3861                                                      '3' '4'.
  3862           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3863           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3864           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3865           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3866           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3867           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3868
  3869         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3870
  3871         16  CF-PAYMENT-APPROVAL-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  73
* EL6501.cbl
  3872             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3873             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3874             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3875             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3876             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3877             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3878
  3879         16  CF-END-USER-REPORTING-USER     PIC X.
  3880             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3881             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3882
  3883         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3884             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3885             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3886
  3887         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3888
  3889         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3890         16  FILLER                         PIC X.
  3891
  3892         16  CF-CREDIT-ARCHIVE-CNTL.
  3893             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3894             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3895             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3896
  3897         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3898
  3899         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3900             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3901             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3902
  3903         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3904             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3905             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3906
  3907         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3908
  3909         16  CF-CO-ACH-ID-CODE              PIC  X.
  3910             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3911             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3912             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3913         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3914         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3915         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3916         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3917         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3918         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3919         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3920         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3921         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3922                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3923         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3924                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3925
  3926         16  CF-CO-OVER-SHORT.
  3927             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3928             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3929
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  74
* EL6501.cbl
  3930*         16  FILLER                         PIC X(102).
  3931         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3932             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3933             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3934
  3935         16  CF-AH-APPROVAL-DAYS.
  3936             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3937             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3938             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3939             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3940
  3941         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3942
  3943         16  CF-APPROV-LEV-5.
  3944             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3945             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3946             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3947
  3948         16  FILLER                         PIC X(68).
  3949****************************************************************
  3950*             PROCESSOR/USER RECORD                            *
  3951****************************************************************
  3952
  3953     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3954         16  CF-PROCESSOR-NAME              PIC X(30).
  3955         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3956         16  CF-PROCESSOR-TITLE             PIC X(26).
  3957         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3958                 88  MESSAGE-YES                VALUE 'Y'.
  3959                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3960
  3961*****************************************************
  3962****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3963****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3964****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3965****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3966*****************************************************
  3967
  3968         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3969             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3970             20  CF-APPLICATION-FORCE       PIC X.
  3971             20  CF-INDIVIDUAL-APP.
  3972                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3973                     28  CF-BROWSE-APP      PIC X.
  3974                     28  CF-UPDATE-APP      PIC X.
  3975
  3976         16  CF-CURRENT-TERM-ON             PIC X(4).
  3977         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3978             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3979             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3980             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3981             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3982             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3983             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3984             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3985         16  CF-PROCESSOR-CARRIER           PIC X.
  3986             88  NO-CARRIER-SECURITY            VALUE ' '.
  3987         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  75
* EL6501.cbl
  3988             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3989         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3990             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3991         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3992             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3993
  3994         16  CF-PROC-SYS-ACCESS-SW.
  3995             20  CF-PROC-CREDIT-CLAIMS-SW.
  3996                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3997                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3998                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3999                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4000             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4001                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4002                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4003             20  CF-PROC-LIFE-GNRLDGR-SW.
  4004                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4005                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4006                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4007                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4008             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4009                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4010                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4011         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4012             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4013             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4014         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4015
  4016         16  CF-APPROVAL-LEVEL                  PIC X.
  4017             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4018             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4019             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4020             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4021             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4022
  4023         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4024
  4025         16  CF-LANGUAGE-TYPE                   PIC X.
  4026             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4027             88  CF-LANG-IS-FR                      VALUE 'F'.
  4028
  4029         16  CF-CSR-IND                         PIC X.
  4030         16  FILLER                             PIC X(239).
  4031
  4032****************************************************************
  4033*             PROCESSOR/REMINDERS RECORD                       *
  4034****************************************************************
  4035
  4036     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4037         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4038             20  CF-START-REMIND-DT         PIC XX.
  4039             20  CF-END-REMIND-DT           PIC XX.
  4040             20  CF-REMINDER-TEXT           PIC X(50).
  4041         16  FILLER                         PIC X(296).
  4042
  4043
  4044****************************************************************
  4045*             STATE MASTER RECORD                              *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  76
* EL6501.cbl
  4046****************************************************************
  4047
  4048     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4049         16  CF-STATE-ABBREVIATION          PIC XX.
  4050         16  CF-STATE-NAME                  PIC X(25).
  4051         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4052         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4053             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4054             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4055             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4056             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4057                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4058                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4059             20  CF-ST-PREM-REJECT-SW       PIC X.
  4060                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4061                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4062             20  CF-ST-REF-REJECT-SW        PIC X.
  4063                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4064                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4065         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4066         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4067         16  CF-ST-REFUND-RULES.
  4068             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4069             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4070             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4071         16  CF-ST-FST-PMT-EXTENSION.
  4072             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4073             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4074                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4075                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4076                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4077                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4078         16  CF-ST-STATE-CALL.
  4079             20  CF-ST-CALL-UNEARNED        PIC X.
  4080             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4081             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4082         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4083             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4084             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4085         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4086         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4087         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4088         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4089         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4090         16  FILLER                         PIC X.
  4091         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4092             20  CF-ST-BENEFIT-CD           PIC XX.
  4093             20  CF-ST-BENEFIT-KIND         PIC X.
  4094                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4095                 88  CF-ST-AH-KIND              VALUE 'A'.
  4096             20  CF-ST-REM-TERM-CALC        PIC X.
  4097                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4098                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4099                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4100                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4101                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4102                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4103                 88  ST-EARN-AFTER-14TH         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  77
* EL6501.cbl
  4104                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4105
  4106             20  CF-ST-REFUND-CALC          PIC X.
  4107                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4108                 88  ST-REFD-BY-R78             VALUE '1'.
  4109                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4110                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4111                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4112                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4113                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4114                 88  ST-REFD-UTAH               VALUE '7'.
  4115                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4116                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4117                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4118
  4119             20  CF-ST-EARNING-CALC         PIC X.
  4120                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4121                 88  ST-EARN-BY-R78             VALUE '1'.
  4122                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4123                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4124                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4125                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4126                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4127                 88  ST-EARN-MEAN               VALUE '8'.
  4128                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4129
  4130             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4131                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4132                 88  ST-OVRD-BY-R78             VALUE '1'.
  4133                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4134                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4135                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4136                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4137                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4138                 88  ST-OVRD-MEAN               VALUE '8'.
  4139                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4140             20  cf-st-extra-periods        pic 9.
  4141*            20  FILLER                     PIC X.
  4142
  4143         16  CF-ST-COMMISSION-CAPS.
  4144             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4145             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4146             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4147             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4148         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4149                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4150                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4151                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4152
  4153         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4154
  4155         16  CF-ST-STATUTORY-INTEREST.
  4156             20  CF-ST-STAT-DATE-FROM       PIC X.
  4157                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4158                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4159             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4160             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4161             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  78
* EL6501.cbl
  4162             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4163             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4164
  4165         16  CF-ST-OVER-SHORT.
  4166             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4167             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4168
  4169         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4170
  4171         16  CF-ST-RT-CALC                  PIC X.
  4172
  4173         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4174         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4175         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4176         16  CF-ST-RF-LR-CALC               PIC X.
  4177         16  CF-ST-RF-LL-CALC               PIC X.
  4178         16  CF-ST-RF-LN-CALC               PIC X.
  4179         16  CF-ST-RF-AH-CALC               PIC X.
  4180         16  CF-ST-RF-CP-CALC               PIC X.
  4181*        16  FILLER                         PIC X(206).
  4182*CIDMOD         16  FILLER                         PIC X(192).
  4183         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4184             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4185         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4186         16  CF-ST-VFY-2ND-BENE             PIC X.
  4187         16  CF-ST-CAUSAL-STATE             PIC X.
  4188         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4189         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4190         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4191             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4192         16  CF-ST-NET-ONLY-STATE           PIC X.
  4193             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4194         16  cf-commission-cap-required     pic x.
  4195         16  CF-ST-GA-COMMISSION-CAPS.
  4196             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4197             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4198             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4199             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4200         16  CF-ST-TOT-COMMISSION-CAPS.
  4201             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4202             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4203             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4204             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4205         16  FILLER                         PIC X(156).
  4206
  4207****************************************************************
  4208*             BENEFIT MASTER RECORD                            *
  4209****************************************************************
  4210
  4211     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4212         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4213             20  CF-BENEFIT-CODE            PIC XX.
  4214             20  CF-BENEFIT-NUMERIC  REDEFINES
  4215                 CF-BENEFIT-CODE            PIC XX.
  4216             20  CF-BENEFIT-ALPHA           PIC XXX.
  4217             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4218             20  CF-BENEFIT-COMMENT         PIC X(10).
  4219
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  79
* EL6501.cbl
  4220             20  CF-LF-COVERAGE-TYPE        PIC X.
  4221                 88  CF-REDUCING                VALUE 'R'.
  4222                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4223
  4224             20  CF-SPECIAL-CALC-CD         PIC X.
  4225                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4226                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4227                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4228                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4229                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4230                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4231                 88  CF-FARM-PLAN               VALUE 'F'.
  4232                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4233                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4234                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4235                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4236                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4237                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4238                 88  CF-PRUDENTIAL              VALUE 'P'.
  4239                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4240                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4241                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4242                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4243                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4244                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4245
  4246             20  CF-JOINT-INDICATOR         PIC X.
  4247                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4248
  4249*            20  FILLER                     PIC X(12).
  4250             20  cf-maximum-benefits        pic s999 comp-3.
  4251             20  FILLER                     PIC X(09).
  4252             20  CF-BENEFIT-CATEGORY        PIC X.
  4253             20  CF-LOAN-TYPE               PIC X(8).
  4254
  4255             20  CF-CO-REM-TERM-CALC        PIC X.
  4256                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4257                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4258                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4259                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4260                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4261
  4262             20  CF-CO-EARNINGS-CALC        PIC X.
  4263                 88  CO-EARN-BY-R78             VALUE '1'.
  4264                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4265                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4266                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4267                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4268                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4269                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4270                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4271
  4272             20  CF-CO-REFUND-CALC          PIC X.
  4273                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4274                 88  CO-REFD-BY-R78             VALUE '1'.
  4275                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4276                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4277                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  80
* EL6501.cbl
  4278                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4279                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4280                 88  CO-REFD-MEAN               VALUE '8'.
  4281                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4282                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4283                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4284
  4285             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4286                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4287                 88  CO-OVRD-BY-R78             VALUE '1'.
  4288                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4289                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4290                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4291                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4292                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4293                 88  CO-OVRD-MEAN               VALUE '8'.
  4294                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4295
  4296             20  CF-CO-BEN-I-G-CD           PIC X.
  4297                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4298                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4299                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4300
  4301         16  FILLER                         PIC X(304).
  4302
  4303
  4304****************************************************************
  4305*             CARRIER MASTER RECORD                            *
  4306****************************************************************
  4307
  4308     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4309         16  CF-ADDRESS-DATA.
  4310             20  CF-MAIL-TO-NAME            PIC X(30).
  4311             20  CF-IN-CARE-OF              PIC X(30).
  4312             20  CF-ADDRESS-LINE-1          PIC X(30).
  4313             20  CF-ADDRESS-LINE-2          PIC X(30).
  4314             20  CF-CITY-STATE              PIC X(30).
  4315             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4316             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4317
  4318         16  CF-CLAIM-NO-CONTROL.
  4319             20  CF-CLAIM-NO-METHOD         PIC X.
  4320                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4321                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4322                 88  CLAIM-NO-SEQ               VALUE '3'.
  4323                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4324             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4325                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4326                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4327                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4328
  4329         16  CF-CHECK-NO-CONTROL.
  4330             20  CF-CHECK-NO-METHOD         PIC X.
  4331                 88  CHECK-NO-MANUAL            VALUE '1'.
  4332                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4333                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4334                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4335             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  81
* EL6501.cbl
  4336                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4337
  4338         16  CF-DOMICILE-STATE              PIC XX.
  4339
  4340         16  CF-EXPENSE-CONTROLS.
  4341             20  CF-EXPENSE-METHOD          PIC X.
  4342                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4343                 88  DOLLARS-PER-PMT            VALUE '2'.
  4344                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4345                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4346             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4347             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4348
  4349         16  CF-CORRESPONDENCE-CONTROL.
  4350             20  CF-LETTER-RESEND-OPT       PIC X.
  4351                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4352                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4353             20  FILLER                     PIC X(4).
  4354
  4355         16  CF-RESERVE-CONTROLS.
  4356             20  CF-MANUAL-SW               PIC X.
  4357                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4358             20  CF-FUTURE-SW               PIC X.
  4359                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4360             20  CF-PTC-SW                  PIC X.
  4361                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4362             20  CF-IBNR-SW                 PIC X.
  4363                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4364             20  CF-PTC-LF-SW               PIC X.
  4365                 88  CF-LF-PTC-USED             VALUE '1'.
  4366             20  CF-CDT-ACCESS-METHOD       PIC X.
  4367                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4368                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4369                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4370             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4371
  4372         16  CF-CLAIM-CALC-METHOD           PIC X.
  4373             88  360-PLUS-MONTHS                VALUE '1'.
  4374             88  365-PLUS-MONTHS                VALUE '2'.
  4375             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4376             88  360-DAILY                      VALUE '4'.
  4377             88  365-DAILY                      VALUE '5'.
  4378
  4379         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4380         16  FILLER                         PIC X(11).
  4381
  4382         16  CF-LIMIT-AMOUNTS.
  4383             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4384             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4385             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4386             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4387             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4388             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4389             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4390             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4391             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4392             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4393
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  82
* EL6501.cbl
  4394         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4395         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4396         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4397
  4398         16  CF-ZIP-CODE.
  4399             20  CF-ZIP-PRIME.
  4400                 24  CF-ZIP-1ST             PIC X.
  4401                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4402                 24  FILLER                 PIC X(4).
  4403             20  CF-ZIP-PLUS4               PIC X(4).
  4404         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4405             20  CF-CAN-POSTAL-1            PIC XXX.
  4406             20  CF-CAN-POSTAL-2            PIC XXX.
  4407             20  FILLER                     PIC XXX.
  4408
  4409         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4410         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4411         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4412
  4413         16  CF-RATING-SWITCH               PIC X.
  4414             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4415             88  CF-NO-RATING                   VALUE 'N'.
  4416
  4417         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4418
  4419         16  CF-CARRIER-OVER-SHORT.
  4420             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4421             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4422
  4423         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4424         16  CF-SECPAY-SWITCH               PIC X.
  4425             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4426             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4427         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4428         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4429         16  FILLER                         PIC X(444).
  4430*        16  FILLER                         PIC X(452).
  4431
  4432
  4433****************************************************************
  4434*             MORTALITY MASTER RECORD                          *
  4435****************************************************************
  4436
  4437     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4438         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4439                                INDEXED BY CF-MORT-NDX.
  4440             20  CF-MORT-TABLE              PIC X(5).
  4441             20  CF-MORT-TABLE-TYPE         PIC X.
  4442                 88  CF-MORT-JOINT              VALUE 'J'.
  4443                 88  CF-MORT-SINGLE             VALUE 'S'.
  4444                 88  CF-MORT-COMBINED           VALUE 'C'.
  4445                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4446                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4447             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4448             20  CF-MORT-AGE-METHOD         PIC XX.
  4449                 88  CF-AGE-LAST                VALUE 'AL'.
  4450                 88  CF-AGE-NEAR                VALUE 'AN'.
  4451             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  83
* EL6501.cbl
  4452             20  CF-MORT-ADJUSTMENT-DIRECTION
  4453                                            PIC X.
  4454                 88  CF-MINUS                   VALUE '-'.
  4455                 88  CF-PLUS                    VALUE '+'.
  4456             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4457             20  CF-MORT-JOINT-CODE         PIC X.
  4458                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4459             20  CF-MORT-PC-Q               PIC X.
  4460                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4461             20  CF-MORT-TABLE-CODE         PIC X(4).
  4462             20  CF-MORT-COMMENTS           PIC X(15).
  4463             20  FILLER                     PIC X(14).
  4464
  4465         16  FILLER                         PIC X(251).
  4466
  4467
  4468****************************************************************
  4469*             BUSSINESS TYPE MASTER RECORD                     *
  4470****************************************************************
  4471
  4472     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4473* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4474* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4475* AND RECORD 05 IS TYPES 81-99
  4476         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4477             20  CF-BUSINESS-TITLE          PIC  X(19).
  4478             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4479                                            PIC S9V9(4) COMP-3.
  4480             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4481             20  FILLER                     PIC  X.
  4482         16  FILLER                         PIC  X(248).
  4483
  4484
  4485****************************************************************
  4486*             TERMINAL MASTER RECORD                           *
  4487****************************************************************
  4488
  4489     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4490
  4491         16  CF-COMPANY-TERMINALS.
  4492             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4493                                  PIC X(4).
  4494         16  FILLER               PIC X(248).
  4495
  4496
  4497****************************************************************
  4498*             LIFE EDIT MASTER RECORD                          *
  4499****************************************************************
  4500
  4501     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4502         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4503             20  CF-LIFE-CODE-IN            PIC XX.
  4504             20  CF-LIFE-CODE-OUT           PIC XX.
  4505         16  FILLER                         PIC X(248).
  4506
  4507
  4508****************************************************************
  4509*             AH EDIT MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  84
* EL6501.cbl
  4510****************************************************************
  4511
  4512     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4513         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4514             20  CF-AH-CODE-IN              PIC XXX.
  4515             20  CF-AH-CODE-OUT             PIC XX.
  4516         16  FILLER                         PIC X(248).
  4517
  4518
  4519****************************************************************
  4520*             CREDIBILITY TABLES                               *
  4521****************************************************************
  4522
  4523     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4524         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4525                             INDEXED BY CF-CRDB-NDX.
  4526             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4527             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4528             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4529         16  FILLER                         PIC  X(332).
  4530
  4531
  4532****************************************************************
  4533*             REPORT CUSTOMIZATION RECORD                      *
  4534****************************************************************
  4535
  4536     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4537         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4538             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4539             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4540             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4541**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4542****       A T-TRANSFER.                                   ****
  4543             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4544
  4545         16  FILLER                         PIC XX.
  4546
  4547         16  CF-CARRIER-CNTL-OPT.
  4548             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4549                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4550                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4551             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4552                                            PIC X.
  4553         16  CF-GROUP-CNTL-OPT.
  4554             20  CF-GROUP-OPT-SEQ           PIC 9.
  4555                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4556                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4557             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4558                                            PIC X(6).
  4559         16  CF-STATE-CNTL-OPT.
  4560             20  CF-STATE-OPT-SEQ           PIC 9.
  4561                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4562                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4563             20  CF-STATE-SELECT OCCURS 3 TIMES
  4564                                            PIC XX.
  4565         16  CF-ACCOUNT-CNTL-OPT.
  4566             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4567                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  85
* EL6501.cbl
  4568                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4569             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4570                                            PIC X(10).
  4571         16  CF-BUS-TYP-CNTL-OPT.
  4572             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4573                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4574                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4575             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4576                                            PIC XX.
  4577         16  CF-LF-TYP-CNTL-OPT.
  4578             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4579                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4580                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4581             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4582                                            PIC XX.
  4583         16  CF-AH-TYP-CNTL-OPT.
  4584             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4585                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4586                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4587             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4588                                            PIC XX.
  4589         16  CF-REPTCD1-CNTL-OPT.
  4590             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4591                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4592                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4593             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4594                                            PIC X(10).
  4595         16  CF-REPTCD2-CNTL-OPT.
  4596             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4597                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4598                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4599             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4600                                            PIC X(10).
  4601         16  CF-USER1-CNTL-OPT.
  4602             20  CF-USER1-OPT-SEQ           PIC 9.
  4603                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4604                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4605             20  CF-USER1-SELECT OCCURS 3 TIMES
  4606                                            PIC X(10).
  4607         16  CF-USER2-CNTL-OPT.
  4608             20  CF-USER2-OPT-SEQ           PIC 9.
  4609                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4610                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4611             20  CF-USER2-SELECT OCCURS 3 TIMES
  4612                                            PIC X(10).
  4613         16  CF-USER3-CNTL-OPT.
  4614             20  CF-USER3-OPT-SEQ           PIC 9.
  4615                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4616                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4617             20  CF-USER3-SELECT OCCURS 3 TIMES
  4618                                            PIC X(10).
  4619         16  CF-USER4-CNTL-OPT.
  4620             20  CF-USER4-OPT-SEQ           PIC 9.
  4621                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4622                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4623             20  CF-USER4-SELECT OCCURS 3 TIMES
  4624                                            PIC X(10).
  4625         16  CF-USER5-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  86
* EL6501.cbl
  4626             20  CF-USER5-OPT-SEQ           PIC 9.
  4627                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4628                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4629             20  CF-USER5-SELECT OCCURS 3 TIMES
  4630                                            PIC X(10).
  4631         16  CF-REINS-CNTL-OPT.
  4632             20  CF-REINS-OPT-SEQ           PIC 9.
  4633                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4634                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4635             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4636                 24  CF-REINS-PRIME         PIC XXX.
  4637                 24  CF-REINS-SUB           PIC XXX.
  4638
  4639         16  CF-AGENT-CNTL-OPT.
  4640             20  CF-AGENT-OPT-SEQ           PIC 9.
  4641                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4642                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4643             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4644                                            PIC X(10).
  4645
  4646         16  FILLER                         PIC X(43).
  4647
  4648         16  CF-LOSS-RATIO-SELECT.
  4649             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4650             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4651         16  CF-ENTRY-DATE-SELECT.
  4652             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4653             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4654         16  CF-EFFECTIVE-DATE-SELECT.
  4655             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4656             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4657
  4658         16  CF-EXCEPTION-LIST-IND          PIC X.
  4659             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4660
  4661         16  FILLER                         PIC X(318).
  4662
  4663****************************************************************
  4664*                  EXCEPTION REPORTING RECORD                  *
  4665****************************************************************
  4666
  4667     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4668         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4669             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4670
  4671         16  CF-COMBINED-LIFE-AH-OPT.
  4672             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4673             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4674             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4675             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4676
  4677         16  CF-LIFE-OPT.
  4678             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4679             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4680             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4681             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4682             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4683             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  87
* EL6501.cbl
  4684             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4685             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4686             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4687             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4688
  4689         16  CF-AH-OPT.
  4690             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4691             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4692             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4693             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4694             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4695             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4696             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4697             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4698             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4699             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4700
  4701         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4702             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4703             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4704             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4705
  4706         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4707
  4708         16  FILLER                         PIC X(673).
  4709
  4710
  4711****************************************************************
  4712*             MORTGAGE SYSTEM PLAN RECORD                      *
  4713****************************************************************
  4714
  4715     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4716         16  CF-PLAN-TYPE                   PIC X.
  4717             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4718             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4719             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4720         16  CF-PLAN-ABBREV                 PIC XXX.
  4721         16  CF-PLAN-DESCRIPT               PIC X(10).
  4722         16  CF-PLAN-NOTES                  PIC X(20).
  4723         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4724         16  CF-PLAN-UNDERWRITING.
  4725             20  CF-PLAN-TERM-DATA.
  4726                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4727                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4728             20  CF-PLAN-AGE-DATA.
  4729                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4730                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4731                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4732             20  CF-PLAN-BENEFIT-DATA.
  4733                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4734                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4735                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4736                                            PIC S9(7)V99  COMP-3.
  4737         16  CF-PLAN-POLICY-FORMS.
  4738             20  CF-POLICY-FORM             PIC X(12).
  4739             20  CF-MASTER-APPLICATION      PIC X(12).
  4740             20  CF-MASTER-POLICY           PIC X(12).
  4741         16  CF-PLAN-RATING.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  88
* EL6501.cbl
  4742             20  CF-RATE-CODE               PIC X(5).
  4743             20  CF-SEX-RATING              PIC X.
  4744                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4745                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4746             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4747             20  CF-SUB-STD-TYPE            PIC X.
  4748                 88  CF-PCT-OF-PREM            VALUE '1'.
  4749                 88  CF-PCT-OF-BENE            VALUE '2'.
  4750         16  CF-PLAN-PREM-TOLERANCES.
  4751             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4752             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4753         16  CF-PLAN-PYMT-TOLERANCES.
  4754             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4755             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4756         16  CF-PLAN-MISC-DATA.
  4757             20  FILLER                     PIC X.
  4758             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4759             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4760         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4761         16  CF-PLAN-IND-GRP                PIC X.
  4762             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4763                                                     '1'.
  4764             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4765                                                     '2'.
  4766         16  CF-MIB-SEARCH-SW               PIC X.
  4767             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4768             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4769             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4770             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4771         16  CF-ALPHA-SEARCH-SW             PIC X.
  4772             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4773             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4774             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4775             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4776             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4777             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4778             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4779             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4780             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4781             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4782                                                     'A' 'B' 'C'
  4783                                                     'X' 'Y' 'Z'.
  4784         16  CF-EFF-DT-RULE-SW              PIC X.
  4785             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4786             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4787             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4788             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4789             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4790         16  FILLER                         PIC X(4).
  4791         16  CF-HEALTH-QUESTIONS            PIC X.
  4792             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4793         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4794         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4795         16  CF-PLAN-SNGL-JNT               PIC X.
  4796             88  CF-COMBINED-PLAN              VALUE 'C'.
  4797             88  CF-JNT-PLAN                   VALUE 'J'.
  4798             88  CF-SNGL-PLAN                  VALUE 'S'.
  4799         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  89
* EL6501.cbl
  4800         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4801         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4802         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4803         16  CF-RERATE-CNTL                 PIC  X.
  4804             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4805             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4806             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4807             88  CF-AUTO-RECALC                 VALUE '4'.
  4808         16  CF-BENEFIT-TYPE                PIC  X.
  4809             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4810             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4811         16  CF-POLICY-FEE                  PIC S999V99
  4812                                                    COMP-3.
  4813         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4814         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4815         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4816         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4817         16  FILLER                         PIC  X(32).
  4818         16  CF-TERMINATION-FORM            PIC  X(04).
  4819         16  FILLER                         PIC  X(08).
  4820         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4821                                                       COMP-3.
  4822         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4823         16  CF-ISSUE-LETTER                PIC  X(4).
  4824         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4825         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4826             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4827             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4828         16  CF-MP-REFUND-CALC              PIC X.
  4829             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4830             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4831             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4832             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4833             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4834             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4835             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4836             88  CF-MP-REFD-MEAN                VALUE '8'.
  4837         16  CF-ALT-RATE-CODE               PIC  X(5).
  4838
  4839
  4840         16  FILLER                         PIC X(498).
  4841****************************************************************
  4842*             MORTGAGE COMPANY MASTER RECORD                   *
  4843****************************************************************
  4844
  4845     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4846         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4847         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4848             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4849             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4850             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4851             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4852             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4853
  4854         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4855         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4856         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4857         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  90
* EL6501.cbl
  4858         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4859
  4860         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4861             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4862         16  CF-MP-RECON-USE-IND            PIC X(1).
  4863             88  CF-MP-USE-RECON             VALUE 'Y'.
  4864         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4865             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4866         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4867             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4868             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4869         16  FILLER                         PIC X(1).
  4870         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4871             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4872         16  CF-MORTG-MIB-VERSION           PIC X.
  4873             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4874             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4875             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4876         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4877             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4878                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4879             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4880                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4881             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4882                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4883             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4884                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4885             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4886                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4887             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4888                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4889         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4890         16  FILLER                         PIC X(7).
  4891         16  CF-MORTG-DESTINATION-SYMBOL.
  4892             20  CF-MORTG-MIB-COMM          PIC X(5).
  4893             20  CF-MORTG-MIB-TERM          PIC X(5).
  4894         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4895             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4896         16  FILLER                         PIC X(03).
  4897         16  CF-MP-CHECK-NO-CONTROL.
  4898             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4899                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4900                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4901                                                ' ' LOW-VALUES.
  4902                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4903                                               VALUE '3'.
  4904         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4905         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4906         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4907             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4908                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4909             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4910                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4911             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4912                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4913             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4914                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4915             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  91
* EL6501.cbl
  4916                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4917             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4918                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4919         16  CF-MORTG-BILLING-AREA.
  4920             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4921                                            PIC X.
  4922         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4923         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4924         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4925         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4926             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4927             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4928         16  FILLER                         PIC X.
  4929         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4930             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4931             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4932         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4933         16  FILLER                         PIC X(8).
  4934         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4935         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4936         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4937         16  CF-ACH-COMPANY-ID.
  4938             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4939                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4940                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4941                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4942             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4943         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4944             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4945         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4946             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4947             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4948         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4949         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4950         16  FILLER                         PIC X(536).
  4951
  4952****************************************************************
  4953*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4954****************************************************************
  4955
  4956     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4957         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4958             20  CF-FEMALE-HEIGHT.
  4959                 24  CF-FEMALE-FT           PIC 99.
  4960                 24  CF-FEMALE-IN           PIC 99.
  4961             20  CF-FEMALE-MIN-WT           PIC 999.
  4962             20  CF-FEMALE-MAX-WT           PIC 999.
  4963         16  FILLER                         PIC X(428).
  4964
  4965     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4966         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4967             20  CF-MALE-HEIGHT.
  4968                 24  CF-MALE-FT             PIC 99.
  4969                 24  CF-MALE-IN             PIC 99.
  4970             20  CF-MALE-MIN-WT             PIC 999.
  4971             20  CF-MALE-MAX-WT             PIC 999.
  4972         16  FILLER                         PIC X(428).
  4973******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  92
* EL6501.cbl
  4974*             AUTOMATIC ACTIVITY RECORD                          *
  4975******************************************************************
  4976     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4977         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4978             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4979             20  CF-SYS-LETTER-ID           PIC X(04).
  4980             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4981             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4982             20  CF-SYS-RESET-SW            PIC X(01).
  4983             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4984             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4985
  4986         16  FILLER                         PIC X(50).
  4987
  4988         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4989             20  CF-USER-ACTIVE-SW          PIC X(01).
  4990             20  CF-USER-LETTER-ID          PIC X(04).
  4991             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4992             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4993             20  CF-USER-RESET-SW           PIC X(01).
  4994             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4995             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4996             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4997
  4998         16  FILLER                         PIC X(246).
  4999*    COPY ERCREIN.
  5000******************************************************************
  5001*                                                                *
  5002*                            ERCREIN                             *
  5003*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5004*                            VMOD=2.010                          *
  5005*                                                                *
  5006*   ONLINE CREDIT SYSTEM                                         *
  5007*                                                                *
  5008*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  5009*                                                                *
  5010*   FILE TYPE = VSAM,KSDS                                        *
  5011*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  5012*                                                                *
  5013*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  5014*       ALTERNATE PATH = NONE                                    *
  5015*                                                                *
  5016*   LOG = NO                                                     *
  5017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5018*                                                                *
  5019******************************************************************
  5020*                   C H A N G E   L O G
  5021*
  5022* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5023*-----------------------------------------------------------------
  5024*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5025* EFFECTIVE    NUMBER
  5026*-----------------------------------------------------------------
  5027* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  5028* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  5029******************************************************************
  5030 01  REINSURANCE-RECORD.
  5031     12  RE-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  93
* EL6501.cbl
  5032         88  VALID-RE-ID                      VALUE 'RE'.
  5033
  5034     12  RE-CONTROL-PRIMARY.
  5035         16  RE-COMPANY-CD                 PIC X.
  5036         16  RE-KEY.
  5037             20  RE-CODE                   PIC X.
  5038                 88  RE-TABLE-RECORD          VALUE 'A'.
  5039                 88  RE-COMPANY-RECORD        VALUE 'B'.
  5040             20  RE-TABLE                  PIC XXX.
  5041             20  FILLER                    PIC XXX.
  5042         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  5043             20  FILLER                    PIC X.
  5044             20  RE-COMPANY.
  5045                 24  RE-COMP-PRIME         PIC XXX.
  5046                 24  RE-COMP-SUB           PIC XXX.
  5047
  5048     12  RE-MAINT-INFORMATION.
  5049         16  RE-LAST-MAINT-DT              PIC XX.
  5050         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5051         16  RE-LAST-MAINT-USER            PIC X(4).
  5052         16  FILLER                        PIC X(10).
  5053
  5054     12  RE-TABLE-DATA.
  5055         16  RE-100-COMP                   PIC 99.
  5056
  5057         16  RE-COMP-INFO    OCCURS 30 TIMES.
  5058             20  RE-REI-COMP-NO.
  5059                 24  RE-REI-COMP           PIC XXX.
  5060                 24  RE-REI-COMP-SUB       PIC XXX.
  5061             20  RE-LF-QC                  PIC X.
  5062             20  RE-AH-QC                  PIC X.
  5063             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  5064             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  5065             20  RE-LFAGE-LO               PIC 99.
  5066             20  RE-LFAGE-HI               PIC 99.
  5067             20  RE-AHAGE-LO               PIC 99.
  5068             20  RE-AHAGE-HI               PIC 99.
  5069             20  RE-LFTRM-LO               PIC S999       COMP-3.
  5070             20  RE-LFTRM-HI               PIC S999       COMP-3.
  5071             20  RE-AHTRM-LO               PIC S999       COMP-3.
  5072             20  RE-AHTRM-HI               PIC S999       COMP-3.
  5073             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  5074             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  5075             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  5076             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  5077             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  5078             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  5079             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  5080             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  5081             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  5082             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  5083             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  5084             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  5085             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  5086             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  5087             20  RE-LF-BEN-CODE            PIC X.
  5088             20  RE-AH-BEN-CODE            PIC X.
  5089             20  RE-INTERACTIVE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  94
* EL6501.cbl
  5090             20  RE-REMAINING              PIC X.
  5091             20  RE-LF-RUNOFF-SW           PIC X.
  5092             20  RE-AH-RUNOFF-SW           PIC X.
  5093             20  FILLER                    PIC X(19).
  5094
  5095         16  RE-COMP-INFO-END              PIC X(6).
  5096         16  RE-NSP-ST-CD-LF               PIC XX.
  5097         16  RE-NSP-ST-CD-AH               PIC XX.
  5098         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  5099             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  5100
  5101         16  FILLER                        PIC X(27).
  5102
  5103     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  5104         16  RE-NAME                       PIC X(30).
  5105         16  RE-LF-PE                      PIC X.
  5106         16  RE-AH-PE                      PIC X.
  5107         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  5108         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  5109         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  5110         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  5111         16  RE-PRT-ST                     PIC X.
  5112         16  RE-PRT-OW                     PIC X.
  5113         16  RE-MORT-CODE                  PIC X(4).
  5114         16  RE-CLAIM-CODE                 PIC X.
  5115         16  RE-ZERO-LF-FEE                PIC X.
  5116         16  RE-ZERO-AH-FEE                PIC X.
  5117         16  RE-CEDE-NAME                  PIC X(30).
  5118         16  RE-LF-COMM                    PIC X.
  5119         16  RE-AH-COMM                    PIC X.
  5120         16  RE-LF-TAX                     PIC X.
  5121         16  RE-AH-TAX                     PIC X.
  5122         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  5123         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  5124         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  5125
  5126         16  RE-COMP-CARRIER-SECURITY      PIC X.
  5127             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  5128
  5129         16  RE-LF-CEDING-FEE-BRACKETS.
  5130             20  RE-LF-FEE-METHOD          PIC X.
  5131                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  5132                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  5133                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  5134                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  5135             20  RE-LF-FEE-BASIS           PIC X.
  5136                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  5137                 88  RE-LF-NET-CEDED               VALUE '2'.
  5138                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  5139                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  5140                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  5141                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  5142                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  5143                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  5144             20  FILLER                    PIC XXX.
  5145             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  5146                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  5147                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  95
* EL6501.cbl
  5148
  5149         16  RE-AH-CEDING-FEE-BRACKETS.
  5150             20  RE-AH-FEE-METHOD          PIC X.
  5151                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  5152                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  5153                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  5154                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  5155             20  RE-AH-FEE-BASIS           PIC X.
  5156                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  5157                 88  RE-AH-NET-CEDED               VALUE '2'.
  5158                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  5159                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  5160                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  5161                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  5162                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  5163                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  5164             20  FILLER                    PIC XXX.
  5165             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  5166                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  5167                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  5168
  5169         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  5170
  5171         16  RE-OLD-CEDING-STMT            PIC X.
  5172
  5173         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  5174         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  5175         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  5176         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  5177         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  5178         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  5179         16  RE-REINS-GROUPING-CODE        PIC X(6).
  5180         16  RE-MORT-SW                    PIC X.
  5181         16  RE-CEDING-TYPE-FLAG           PIC X.
  5182             88  RE-NO-CESSION-TYPE                VALUE ' '.
  5183             88  RE-CEDED                          VALUE 'C'.
  5184             88  RE-ASSUMED                        VALUE 'A'.
  5185             88  RE-PHANTOM                        VALUE 'P'.
  5186
  5187         16  RE-CEDING-STMT-OPT-A          PIC X.
  5188             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  5189         16  RE-CEDING-STMT-OPT-B          PIC X.
  5190             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  5191         16  RE-CEDING-STMT-OPT-C          PIC X.
  5192             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  5193         16  RE-CEDING-STMT-OPT-D          PIC X.
  5194             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  5195         16  RE-CEDING-STMT-OPT-E          PIC X.
  5196             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  5197
  5198         16  RE-PRT-CRSV                   PIC X.
  5199
  5200         16  RE-GL-CENTER                  PIC X(4).
  5201
  5202         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  5203
  5204         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  5205
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  96
* EL6501.cbl
  5206         16  RE-EARN-STOP-CODE             PIC X.
  5207             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  5208             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  5209
  5210         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  5211             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  5212
  5213         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  5214         16  FILLER                        PIC X(2281).
  5215
  5216         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  5217
  5218******************************************************************
  5219*    COPY ERCCTBL.
  5220******************************************************************
  5221*                                                                *
  5222*                                                                *
  5223*                            ERCCTBL                             *
  5224*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5225*                            VMOD=2.003
  5226*                                                                *
  5227*   ONLINE CREDIT SYSTEM                                         *
  5228*                                                                *
  5229*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  5230*                                                                *
  5231*   FILE TYPE = VSAM,KSDS                                        *
  5232*   RECORD SIZE = 200   RECFORM = FIXED                          *
  5233*                                                                *
  5234*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  5235*       ALTERNATE PATH = NONE                                    *
  5236*                                                                *
  5237*   LOG = NO                                                     *
  5238*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5239*                                                                *
  5240*                                                                *
  5241******************************************************************
  5242
  5243 01  COMM-TABLE-RECORD.
  5244     12  CT-RECORD-ID                      PIC XX.
  5245         88  VALID-CT-ID                      VALUE 'CT'.
  5246
  5247     12  CT-CONTROL-PRIMARY.
  5248         16  CT-COMPANY-CD                 PIC X.
  5249         16  CT-TABLE                      PIC XXX.
  5250         16  CT-CNTRL-2.
  5251             20  CT-BEN-TYPE               PIC X.
  5252             20  CT-BEN-CODE               PIC XX.
  5253
  5254     12  CT-MAINT-INFORMATION.
  5255         16  CT-LAST-MAINT-DT              PIC XX.
  5256         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5257         16  CT-LAST-MAINT-USER            PIC X(4).
  5258         16  FILLER                        PIC X(31).
  5259
  5260     12  CT-LIMITS.
  5261         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  5262
  5263         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  97
* EL6501.cbl
  5264
  5265         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  5266
  5267     12  CT-RATES.
  5268         16  CT-RTX          OCCURS 27 TIMES.
  5269             20  CT-RT                     PIC SV9(5)     COMP-3.
  5270             20  CT-RT-R   REDEFINES
  5271                 CT-RT                     PIC XXX.
  5272
  5273     12  FILLER                            PIC  X(42).
  5274
  5275******************************************************************
  5276*                                COPY ERCACNT.
  5277******************************************************************
  5278*                                                                *
  5279*                                                                *
  5280*                            ERCACNT.                            *
  5281*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5282*                            VMOD=2.002                          *
  5283*                                                                *
  5284*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  5285*                                                                *
  5286*   FILE TYPE = VSAM,KSDS                                        *
  5287*   RECORD SIZE = 120   RECFORM = FIXED                          *
  5288*                                                                *
  5289*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  5290*       ALTERNATE INDEX = NONE                                   *
  5291*                                                                *
  5292*                                                                *
  5293*   LOG = YES                                                    *
  5294*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5295******************************************************************
  5296*                   C H A N G E   L O G
  5297*
  5298* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5299*-----------------------------------------------------------------
  5300*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5301* EFFECTIVE    NUMBER
  5302*-----------------------------------------------------------------
  5303* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  5304*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  5305******************************************************************
  5306 01  NOTE-FILE.
  5307     12  NT-FILE-ID                  PIC XX.
  5308         88  VALID-NOTE-ID              VALUE 'NT'.
  5309
  5310     12  NT-CONTROL-PRIMARY.
  5311         16  NT-COMPANY-CD           PIC X.
  5312         16  NT-ACCT-NOTE-KEY.
  5313             18  NT-CARRIER              PIC X.
  5314             18  NT-GROUPING             PIC X(06).
  5315             18  NT-STATE                PIC XX.
  5316             18  NT-ACCOUNT              PIC X(10).
  5317         16  NT-RECORD-TYPE          PIC X.
  5318              88  ACCT-NOTE          VALUE '1'.
  5319              88  ACCT-BRANCH-LOC    VALUE '2'.
  5320              88  ACCT-SHIPPING-ADDR VALUE '3'.
  5321         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  98
* EL6501.cbl
  5322
  5323     12  NT-LAST-MAINT-DT            PIC XX.
  5324     12  NT-LAST-MAINT-BY            PIC X(4).
  5325     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  5326
  5327*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  5328*     SEQUENCE NUMBERS
  5329     12  NT-NOTE-INFORMATION.
  5330         16  NT-NOTE-LINE            PIC X(60).
  5331         16  FILLER                  PIC X(25).
  5332*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  5333     12  NT-LOCATION-INFORMATION REDEFINES
  5334                         NT-NOTE-INFORMATION.
  5335         16  NT-BRANCH-LOC-LINE      PIC X(60).
  5336         16  FILLER                  PIC X(25).
  5337* Account special indicator is record type '2', sequence 3
  5338     12  filler REDEFINES NT-NOTE-INFORMATION.
  5339         16  nt-account-special      PIC X.
  5340         16  FILLER                  PIC X(84).
  5341*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  5342*     SEQUENCE NUMBER 1 IS NAME LINE 1
  5343*     SEQUENCE NUMBER 2 IS NAME LINE 2
  5344*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  5345*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  5346*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  5347*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  5348     12  NT-SHIPPING-INFORMATION REDEFINES
  5349                         NT-NOTE-INFORMATION.
  5350         16  NT-SHIPPING-LINE        PIC X(60).
  5351         16  NT-SHIP-STATE           PIC XX.
  5352         16  NT-SHIP-ZIP             PIC X(10).
  5353         16  FILLER                  PIC X(13).
  5354*****************************************************************
  5355
  5356 01  COMMISSION-WORK-AREA.
  5357     05  WK-AGT-COMMS   OCCURS 10 TIMES.
  5358         10  WK-AM-AGT           PIC X(10).
  5359         10  WK-AM-TYPE          PIC X.
  5360         10  WK-FILLER           PIC X(13).
  5361         10  WK-GA-BILL-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page  99
* EL6501.cbl
  5363*    COPY ERCCOMP.
  5364******************************************************************
  5365*                                                                *
  5366*                                                                *
  5367*                            ERCCOMP                             *
  5368*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5369*                            VMOD=2.019                          *
  5370*                                                                *
  5371*   ONLINE CREDIT SYSTEM                                         *
  5372*                                                                *
  5373*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  5374*                                                                *
  5375*   FILE TYPE = VSAM,KSDS                                        *
  5376*   RECORD SIZE = 700   RECFORM = FIXED                          *
  5377*                                                                *
  5378*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  5379*       ALTERNATE PATH = NONE                                    *
  5380*                                                                *
  5381*   LOG = NO                                                     *
  5382*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5383*                                                                *
  5384******************************************************************
  5385*                   C H A N G E   L O G
  5386*
  5387* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5388*-----------------------------------------------------------------
  5389*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5390* EFFECTIVE    NUMBER
  5391*-----------------------------------------------------------------
  5392* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5393* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  5394* 092205    2005050300006  PEMA  ADD LEASE FEE
  5395* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  5396* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  5397* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  5398* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5399* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  5400* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  5401******************************************************************
  5402
  5403 01  COMPENSATION-MASTER.
  5404     12  CO-RECORD-ID                          PIC XX.
  5405         88  VALID-CO-ID                          VALUE 'CO'.
  5406
  5407     12  CO-CONTROL-PRIMARY.
  5408         16  CO-COMPANY-CD                     PIC X.
  5409         16  CO-CONTROL.
  5410             20  CO-CTL-1.
  5411                 24  CO-CARR-GROUP.
  5412                     28  CO-CARRIER            PIC X.
  5413                     28  CO-GROUPING.
  5414                         32  CO-GROUP-PREFIX   PIC XXX.
  5415                         32  CO-GROUP-PRIME    PIC XXX.
  5416                 24  CO-RESP-NO.
  5417                     28  CO-RESP-PREFIX        PIC X(4).
  5418                     28  CO-RESP-PRIME         PIC X(6).
  5419             20  CO-CTL-2.
  5420                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 100
* EL6501.cbl
  5421                     28  CO-ACCT-PREFIX        PIC X(4).
  5422                     28  CO-ACCT-PRIME         PIC X(6).
  5423         16  CO-TYPE                           PIC X.
  5424             88  CO-COMPANY-TYPE                  VALUE 'C'.
  5425             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  5426             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  5427
  5428     12  CO-MAINT-INFORMATION.
  5429         16  CO-LAST-MAINT-DT                  PIC XX.
  5430         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  5431         16  CO-LAST-MAINT-USER                PIC X(4).
  5432     12  FILLER                                PIC XX.
  5433     12  CO-STMT-TYPE                          PIC XXX.
  5434     12  CO-COMP-TYPE                          PIC X.
  5435         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  5436     12  CO-STMT-OWNER                         PIC X(4).
  5437     12  CO-BALANCE-CONTROL                    PIC X.
  5438         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  5439         88  CO-NO-BALANCE                        VALUE 'N'.
  5440
  5441     12  CO-INTERNAL-CONTROL-1                 PIC X.
  5442         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  5443         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  5444         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  5445
  5446     12  CO-INTERNAL-CONTROL-2                 PIC X.
  5447         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  5448         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  5449
  5450     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  5451     12  CO-GA-DIRECT-DEP                      PIC X.
  5452     12  CO-FUTURE-SPACE                       PIC X.
  5453         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  5454
  5455     12  CO-ACCT-NAME                          PIC X(30).
  5456     12  CO-MAIL-NAME                          PIC X(30).
  5457     12  CO-ADDR-1                             PIC X(30).
  5458     12  CO-ADDR-2                             PIC X(30).
  5459     12  CO-ADDR-3.
  5460         16  CO-ADDR-CITY                      PIC X(27).
  5461         16  CO-ADDR-STATE                     PIC XX.
  5462     12  CO-CSO-1099                           PIC X.
  5463     12  CO-ZIP.
  5464         16  CO-ZIP-PRIME.
  5465             20  CO-ZIP-PRI-1ST                PIC X.
  5466                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5467             20  FILLER                        PIC X(4).
  5468         16  CO-ZIP-PLUS4                      PIC X(4).
  5469     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  5470         16  CO-CAN-POSTAL-1                   PIC XXX.
  5471         16  CO-CAN-POSTAL-2                   PIC XXX.
  5472         16  FILLER                            PIC XXX.
  5473     12  CO-SOC-SEC                            PIC X(13).
  5474     12  CO-TELEPHONE.
  5475         16  CO-AREA-CODE                      PIC XXX.
  5476         16  CO-PREFIX                         PIC XXX.
  5477         16  CO-PHONE                          PIC X(4).
  5478
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 101
* EL6501.cbl
  5479     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  5480
  5481     12  CO-AR-BAL-LEVEL                       PIC X.
  5482         88  CO-AR-REF-LVL                        VALUE '1'.
  5483         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  5484         88  CO-AR-BILL-LVL                       VALUE '2'.
  5485         88  CO-AR-AGT-LVL                        VALUE '3'.
  5486         88  CO-AR-FR-LVL                         VALUE '4'.
  5487
  5488     12  CO-AR-NORMAL-PRINT                    PIC X.
  5489         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  5490         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  5491
  5492     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  5493
  5494     12  CO-AR-REPORTING                       PIC X.
  5495         88  CO-AR-NET-REPORT                     VALUE 'N'.
  5496         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  5497
  5498     12  CO-AR-PULL-CHECK                      PIC X.
  5499         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  5500         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  5501
  5502     12  CO-AR-BALANCE-PRINT                   PIC X.
  5503         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  5504
  5505     12  CO-AR-LAST-RUN-CODE                   PIC X.
  5506         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  5507         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  5508         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  5509
  5510     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  5511
  5512     12  CO-USER-CODE                          PIC X.
  5513     12  CO-REPORT-GROUP-ID                    PIC X(12).
  5514
  5515******************************************************************
  5516*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  5517*    THE LAST MONTH END RUN.
  5518******************************************************************
  5519
  5520     12  CO-LAST-ACTIVITY-DATE.
  5521         16  CO-ACT-YEAR                       PIC 99.
  5522         16  CO-ACT-MONTH                      PIC 99.
  5523         16  CO-ACT-DAY                        PIC 99.
  5524
  5525     12  CO-LAST-STMT-DT.
  5526         16  CO-LAST-STMT-YEAR                 PIC 99.
  5527         16  CO-LAST-STMT-MONTH                PIC 99.
  5528         16  CO-LAST-STMT-DAY                  PIC 99.
  5529
  5530     12  CO-MO-END-TOTALS.
  5531         16  CO-MONTHLY-TOTALS.
  5532             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  5533             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  5534             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  5535             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  5536             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 102
* EL6501.cbl
  5537
  5538         16  CO-AGING-TOTALS.
  5539             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  5540             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  5541             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  5542             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  5543
  5544         16  CO-YTD-TOTALS.
  5545             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  5546             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  5547
  5548         16  CO-OVER-UNDER-TOTALS.
  5549             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5550             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5551
  5552     12  CO-MISCELLANEOUS-TOTALS.
  5553         16  CO-FICA-TOTALS.
  5554             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  5555             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  5556
  5557         16  CO-CLAIM-TOTALS.
  5558             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  5559             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  5560
  5561******************************************************************
  5562*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  5563*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  5564******************************************************************
  5565
  5566     12  CO-CURRENT-TOTALS.
  5567         16  CO-CURRENT-LAST-STMT-DT.
  5568             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  5569             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  5570             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  5571
  5572         16  CO-CURRENT-MONTHLY-TOTALS.
  5573             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  5574             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  5575             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  5576             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  5577             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  5578
  5579         16  CO-CURRENT-AGING-TOTALS.
  5580             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  5581             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  5582             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  5583             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  5584
  5585         16  CO-CURRENT-YTD-TOTALS.
  5586             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  5587             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  5588
  5589     12  CO-PAID-COMM-TOTALS.
  5590         16  CO-YTD-PAID-COMMS.
  5591             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  5592             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  5593
  5594     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 103
* EL6501.cbl
  5595         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  5596         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  5597
  5598     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  5599         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  5600         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  5601         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  5602         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  5603         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  5604         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  5605         88  CO-FINAL-LETTER                  VALUE 'F'.
  5606         88  CO-RECONCILING                   VALUE 'R'.
  5607         88  CO-PHONE-CALL                    VALUE 'P'.
  5608         88  CO-LEGAL                         VALUE 'L'.
  5609         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  5610         88  CO-WRITE-OFF                     VALUE 'W'.
  5611         88  CO-NO-ACTION                     VALUE 'N' ' '.
  5612
  5613     12  CO-CSR-CODE                       PIC X(4).
  5614
  5615     12  CO-GA-STATUS-INFO.
  5616         16  CO-GA-EFFECTIVE-DT            PIC XX.
  5617         16  CO-GA-TERMINATION-DT          PIC XX.
  5618         16  CO-GA-STATUS-CODE             PIC X.
  5619             88  CO-GA-ACTIVE                 VALUE 'A'.
  5620             88  CO-GA-INACTIVE               VALUE 'I'.
  5621             88  CO-GA-PENDING                VALUE 'P'.
  5622         16  CO-GA-COMMENTS.
  5623             20  CO-GA-COMMENT-1           PIC X(40).
  5624             20  CO-GA-COMMENT-2           PIC X(40).
  5625             20  CO-GA-COMMENT-3           PIC X(40).
  5626             20  CO-GA-COMMENT-4           PIC X(40).
  5627
  5628     12  CO-RPTCD2                         PIC X(10).
  5629     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  5630         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  5631         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  5632
  5633     12  CO-TYPE-AGENT                     PIC X(01).
  5634         88  CO-CORPORATION                   VALUE 'C'.
  5635         88  CO-PARTNERSHIP                   VALUE 'P'.
  5636         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  5637         88  CO-TRUST                         VALUE 'T'.
  5638         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  5639
  5640     12  CO-FAXNO.
  5641         16  CO-FAX-AREA-CODE                  PIC XXX.
  5642         16  CO-FAX-PREFIX                     PIC XXX.
  5643         16  CO-FAX-PHONE                      PIC X(4).
  5644
  5645     12  CO-BANK-INFORMATION.
  5646         16  CO-BANK-TRANSIT-NO                PIC X(8).
  5647         16  CO-BANK-TRANSIT-NON REDEFINES
  5648             CO-BANK-TRANSIT-NO                PIC 9(8).
  5649
  5650         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  5651     12  CO-MISC-DEDUCT-INFO REDEFINES
  5652                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 104
* EL6501.cbl
  5653         16  CO-MD-GL-ACCT                     PIC X(10).
  5654         16  CO-MD-DIV                         PIC XX.
  5655         16  CO-MD-CENTER                      PIC X(4).
  5656         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  5657         16  CO-CREATE-AP-CHECK                PIC X.
  5658         16  CO-DELIVER-CK-TO-MEL              PIC X.
  5659         16  FILLER                            PIC XXX.
  5660     12  CO-ACH-STATUS                         PIC X.
  5661         88  CO-ACH-ACTIVE                         VALUE 'A'.
  5662         88  CO-ACH-PENDING                        VALUE 'P'.
  5663
  5664     12  CO-BILL-SW                            PIC X.
  5665     12  CO-CONTROL-NAME                       PIC X(30).
  5666     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  5667     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  5668     12  CO-CLP-STATE                          PIC XX.
  5669     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  5670     12  CO-SPP-REFUND-EDIT                    PIC X.
  5671
  5672******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 105
* EL6501.cbl
  5674*    COPY ERCNAME.
  5675******************************************************************
  5676*                                                                *
  5677*                                                                *
  5678*                            ERCNAME                             *
  5679*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5680*                            VMOD=2.003                          *
  5681*                                                                *
  5682*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  5683*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  5684*                                                                *
  5685*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  5686*                                                                *
  5687*   FILE TYPE = VSAM,KSDS                                        *
  5688*   RECORD SIZE = 160   RECFORM = FIX                            *
  5689*                                                                *
  5690*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  5691*                                                                *
  5692*   LOG = NO                                                     *
  5693*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5694*                                                                *
  5695*                                                                *
  5696******************************************************************
  5697
  5698 01  NAME-LOOKUP-MASTER.
  5699     12  NL-RECORD-ID                PIC  X(02).
  5700         88  VALID-NL-ID                         VALUE 'NL'.
  5701
  5702     12  NL-RECORD-KEY.
  5703         16  NL-CONTROL-PRIMARY.
  5704             20  NL-COMPANY-CD       PIC  X(01).
  5705             20  NL-NAME             PIC  X(30).
  5706             20  NL-RECORD-TYPE      PIC  X(01).
  5707                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  5708                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  5709                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  5710
  5711         16  NL-ACCOUNT-MASTER.
  5712             20  NL-AM-COMPANY-CD    PIC  X(01).
  5713             20  NL-AM-CARRIER       PIC  X(01).
  5714             20  NL-AM-GROUPING      PIC  X(06).
  5715             20  NL-AM-STATE         PIC  X(02).
  5716             20  NL-AM-ACCOUNT       PIC  X(10).
  5717             20  FILLER              PIC  X(09).
  5718
  5719         16  NL-COMPENSATION-MASTER
  5720                                 REDEFINES  NL-ACCOUNT-MASTER.
  5721             20  NL-CO-COMPANY-CD    PIC  X(01).
  5722             20  NL-CO-CARRIER       PIC  X(01).
  5723             20  NL-CO-GROUPING      PIC  X(06).
  5724             20  NL-CO-RESP-NO       PIC  X(10).
  5725             20  NL-CO-ACCOUNT       PIC  X(10).
  5726             20  NL-CO-TYPE          PIC  X(01).
  5727
  5728         16  NL-REINSURANCE-RECORD
  5729                                 REDEFINES  NL-ACCOUNT-MASTER.
  5730             20  NL-RE-COMPANY-CD    PIC  X(01).
  5731             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 106
* EL6501.cbl
  5732             20  NL-RE-COMPANY.
  5733                 24  NL-RE-COMP      PIC  X(03).
  5734                 24  NL-RE-CO-SUB    PIC  X(03).
  5735             20  NL-RE-TABLE         PIC  X(03).
  5736             20  FILLER              PIC  X(18).
  5737
  5738     12  NL-MAINT-INFORMATION.
  5739         16  NL-LAST-MAINT-DT        PIC  X(02).
  5740         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  5741         16  NL-LAST-MAINT-USER      PIC  X(04).
  5742         16  FILLER                  PIC  X(10).
  5743
  5744     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  5745         16  NL-RE-LEVEL             PIC  9(02).
  5746
  5747     12  NL-CITY                     PIC  X(15).
  5748     12  NL-ST                       PIC  XX.
  5749
  5750******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 107
* EL6501.cbl
  5752*    COPY ERCRQST.
  5753******************************************************************
  5754*                                                                *
  5755*                                                                *
  5756*                            ERCRQST.                            *
  5757*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5758*                            VMOD=2.002                          *
  5759*                                                                *
  5760*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  5761*                                                                *
  5762*   FILE TYPE = VSAM,KSDS                                        *
  5763*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5764*                                                                *
  5765*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  5766*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  5767*                                   ACCOUNT, REF, BATCH)         *
  5768*                                                RKP=9, LEN=38   *
  5769*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  5770*                                   ACCOUNT, REF, BATCH)         *
  5771*                                                RKP=47, LEN=46  *
  5772*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  5773*                                   BATCH)                       *
  5774*                                                RKP=93, LEN=24  *
  5775*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  5776*                                   REF, BATCH)                  *
  5777*                                                RKP=117, LEN=35 *
  5778*   LOG = NO                                                     *
  5779*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5780******************************************************************
  5781
  5782 01  AR-REQUEST-RECORD.
  5783     12  RQ-RECORD-ID                     PIC XX.
  5784         88  VALID-RQ-ID                        VALUE 'RQ'.
  5785
  5786     12  RQ-CONTROL-PRIMARY.
  5787         16  RQ-COMPANY-CD                PIC X.
  5788         16  RQ-ENTRY-BATCH               PIC X(6).
  5789
  5790     12  RQ-CONTROL-BY-ACCT-REF.
  5791         16  RQ-COMPANY-CD-A1             PIC X.
  5792         16  RQ-CARRIER-A1                PIC X.
  5793         16  RQ-GROUPING-A1               PIC X(6).
  5794         16  RQ-STATE-A1                  PIC XX.
  5795         16  RQ-ACCOUNT-A1                PIC X(10).
  5796         16  RQ-REFERENCE-A1              PIC X(12).
  5797         16  RQ-BATCH-A1                  PIC X(6).
  5798
  5799     12  RQ-CONTROL-BY-FIN-RESP.
  5800         16  RQ-COMPANY-CD-A2             PIC X.
  5801         16  RQ-CARRIER-A2                PIC X.
  5802         16  RQ-GROUPING-A2               PIC X(6).
  5803         16  RQ-FIN-RESP-A2               PIC X(10).
  5804         16  RQ-ACCT-AGENT-A2             PIC X(10).
  5805         16  RQ-REFERENCE-A2              PIC X(12).
  5806         16  RQ-BATCH-A2                  PIC X(6).
  5807
  5808     12  RQ-CONTROL-BY-ACCT-AGENT.
  5809         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 108
* EL6501.cbl
  5810         16  RQ-CARRIER-A3                PIC X.
  5811         16  RQ-GROUPING-A3               PIC X(6).
  5812         16  RQ-ACCT-AGENT-A3             PIC X(10).
  5813         16  RQ-BATCH-A3                  PIC X(6).
  5814
  5815     12  RQ-CONTROL-BY-SUMMARY.
  5816         16  RQ-COMPANY-CD-A4             PIC X.
  5817         16  RQ-SUMMARY-CODE              PIC X(6).
  5818         16  RQ-ACCOUNT-A4                PIC X(10).
  5819         16  RQ-REFERENCE-A4              PIC X(12).
  5820         16  RQ-BATCH-A4                  PIC X(6).
  5821
  5822     12  RQ-REQUEST-METHOD                PIC X.
  5823         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  5824         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  5825         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  5826         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  5827     12  FILLER                           PIC X.
  5828     12  RQ-STATUS                        PIC X.
  5829         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  5830         88  RQ-RESUBMIT                      VALUE 'R'.
  5831     12  RQ-PROCESSOR-ID                  PIC X(4).
  5832     12  RQ-ENTRY-DT                      PIC XX.
  5833     12  RQ-MO-END-DT                     PIC XX.
  5834     12  RQ-REQUEST-DT                    PIC XX.
  5835     12  RQ-STMT-DT                       PIC XX.
  5836     12  RQ-REVERSAL-DT                   PIC XX.
  5837     12  RQ-CREDIT-SELECT-DT              PIC XX.
  5838     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  5839
  5840     12  FILLER                           PIC X(27).
  5841
  5842******************************************************************
  5843
  5844*EJECT
  5845*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 109
* EL6501.cbl
  5847 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  5848                          PRODUCT-MASTER CONTROL-FILE
  5849                          REINSURANCE-RECORD COMM-TABLE-RECORD
  5850                          NOTE-FILE COMMISSION-WORK-AREA
  5851                          COMPENSATION-MASTER
  5852                          NAME-LOOKUP-MASTER AR-REQUEST-RECORD.
  5853 0000-DFHEXIT SECTION.
  5854     MOVE '9#                    $   ' TO DFHEIV0.
  5855     MOVE 'EL6501' TO DFHEIV1.
  5856     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5857     MOVE EIBTRMID              TO QID-TERM.
  5858
  5859     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  5860     MOVE '5'                   TO DC-OPTION-CODE.
  5861     PERFORM 9700-DATE-LINK.
  5862     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  5863     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  5864
  5865***  Y2K PROJ 7744
  5866     MOVE DC-GREG-DATE-1-YMD    TO  CYMD-CURRENT-SAVE
  5867                                    CURRENT-SAVE
  5868     MOVE DC-ALPHA-CENTURY      TO  CYMD-CURRENT-SAVE(1:2)
  5869                                    CURRENT-SAVE(1:2)
  5870***  Y2K PROJ 7744
  5871
  5872     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5873     IF EIBCALEN = 0
  5874         GO TO 8800-UNAUTHORIZED-ACCESS.
  5875
  5876     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  5877     MOVE LOW-VALUES             TO EL6501AI.
  5878
  5879
  5880* EXEC CICS HANDLE CONDITION
  5881*        PGMIDERR  (9600-PGMID-ERROR)
  5882*        ERROR     (9990-ABEND)
  5883*        QIDERR    (0500-CHECK-MAINT-TYPE)
  5884*    END-EXEC.
  5885*    MOVE '"$L.N                 ! " #00005875' TO DFHEIV0
  5886     MOVE X'22244C2E4E20202020202020' TO DFHEIV0(1:12)
  5887     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5888     MOVE X'2220233030303035383735' TO DFHEIV0(25:11)
  5889     CALL 'kxdfhei1' USING DFHEIV0
  5890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5891
  5892
  5893     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5894         IF PI-CALLING-PROGRAM = XCTL-650
  5895             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5896             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5897             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5898             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5899             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5900             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5901             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5902             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5903             PERFORM 5200-DELETE-TS THRU 5299-EXIT
  5904             GO TO 0500-CHECK-MAINT-TYPE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 110
* EL6501.cbl
  5905         ELSE
  5906             PERFORM 5200-RECOVER-TS  THRU  5299-EXIT
  5907             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5908             GO TO 0600-DISPLAY-RECORD.
  5909
  5910     IF EIBAID = DFHCLEAR
  5911         GO TO 9400-CLEAR.
  5912
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 111
* EL6501.cbl
  5914 0200-RECEIVE.
  5915     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5916         MOVE ER-0008            TO EMI-ERROR
  5917         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5918         MOVE -1                 TO PFENTERL
  5919         GO TO 8200-SEND-DATAONLY.
  5920
  5921
  5922* EXEC CICS RECEIVE
  5923*        MAP      (MAP-NAME)
  5924*        MAPSET   (MAPSET-NAME)
  5925*        INTO     (EL6501AI)
  5926*    END-EXEC.
  5927     MOVE LENGTH OF
  5928      EL6501AI
  5929       TO DFHEIV11
  5930*    MOVE '8"T I  L              ''   #00005909' TO DFHEIV0
  5931     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5932     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5933     MOVE X'2020233030303035393039' TO DFHEIV0(25:11)
  5934     CALL 'kxdfhei1' USING DFHEIV0,
  5935           MAP-NAME,
  5936           EL6501AI,
  5937           DFHEIV11,
  5938           MAPSET-NAME,
  5939           DFHEIV99,
  5940           DFHEIV99
  5941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5942
  5943
  5944     IF PFENTERL = 0
  5945         GO TO 0300-CHECK-PFKEYS.
  5946     IF EIBAID NOT = DFHENTER
  5947         MOVE ER-0004            TO EMI-ERROR
  5948         GO TO 0320-INPUT-ERROR.
  5949     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  5950         MOVE PF-VALUES (PFENTERI) TO EIBAID
  5951     ELSE
  5952         MOVE ER-0029            TO EMI-ERROR
  5953         GO TO 0320-INPUT-ERROR.
  5954
  5955 0300-CHECK-PFKEYS.
  5956     IF EIBAID = DFHPF23
  5957         GO TO 8810-PF23.
  5958     IF EIBAID = DFHPF24
  5959         GO TO 9200-RETURN-MAIN-MENU.
  5960     IF EIBAID = DFHPF12
  5961         GO TO 9500-PF12.
  5962
  5963* CHECK PF10 KEY FOR A CALL TO EL608 TO BROWSE RESIDENT STATE TAX
  5964*             MASTER(ERRESC)
  5965*
  5966*    IF  EIBAID = DFHPF10
  5967*        IF PI-COMPANY-ID = 'DMD'
  5968*           PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5969*           MOVE LOW-VALUES TO WS-DMD-AGENT
  5970*           PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5971*           PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 112
* EL6501.cbl
  5972*           PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5973*           MOVE EIBAID       TO PI-ENTRY-CD-1
  5974*           MOVE WS-COMP-DATE TO PI-PREV-VG-ACCOUNT (11:5)
  5975*           MOVE WS-DMD-AGENT TO PI-PREV-VG-ACCOUNT (1:10)
  5976*           MOVE XCTL-608           TO PGM-NAME
  5977*                                      PI-RETURN-TO-PROGRAM
  5978*                                      PI-CALLING-PROGRAM
  5979*           MOVE '106E'             TO PI-CURRENT-SCREEN-NO
  5980*           GO TO 9300-XCTL.
  5981
  5982     IF (EIBAID = DFHPF1  OR  DFHPF2  OR DFHPF3 OR
  5983                  DFHPF4  OR  DFHPF5  OR DFHPF7 OR
  5984                  DFHPF8  OR  DFHPF9 OR DFHPF10)
  5985         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  5986             MOVE ER-0029        TO  EMI-ERROR
  5987             GO TO 0320-INPUT-ERROR
  5988         ELSE
  5989             GO TO 0800-CHECK-MAINT.
  5990
  5991     IF EIBAID = DFHENTER
  5992         GO TO 0330-EDIT-DATA.
  5993
  5994     MOVE ER-0029                TO EMI-ERROR.
  5995
  5996 0320-INPUT-ERROR.
  5997     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5998     MOVE AL-UNBON               TO PFENTERA.
  5999     MOVE -1                     TO PFENTERL.
  6000     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 113
* EL6501.cbl
  6002 0330-EDIT-DATA.
  6003     IF MAINTI  = 'S'
  6004        PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  6005        PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  6006        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  6007        PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  6008        MOVE -1                  TO MAINTL
  6009        GO TO 8100-SEND-INITIAL-MAP.
  6010
  6011     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  6012     PERFORM 6800-COMPANY-REC-READ THRU 6899-EXIT.
  6013
  6014     IF EMI-ERROR NOT = ZEROS
  6015         MOVE -1                 TO MAINTL
  6016         GO TO 8200-SEND-DATAONLY.
  6017
  6018     IF NOT MODIFY-CAP
  6019         MOVE 'UPDATE'           TO SM-READ
  6020         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6021         MOVE ER-0070            TO EMI-ERROR
  6022         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6023         GO TO 8100-SEND-INITIAL-MAP.
  6024
  6025     MOVE SAVE-BIN-DATE          TO BIN-CURRENT-SAVE.
  6026
  6027     IF MAINTI = 'A'
  6028        GO TO 1000-ADD-A-RECORD.
  6029
  6030     IF MAINTI = 'C'
  6031        IF PI-SV-MAINT  =  'L'
  6032            MOVE -1             TO MAINTL
  6033            MOVE AL-UABON       TO MAINTA
  6034            MOVE ER-0899        TO EMI-ERROR
  6035            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6036            GO TO 8200-SEND-DATAONLY
  6037        ELSE
  6038            GO TO 2000-CHANGE-A-RECORD.
  6039
  6040     IF MAINTI = 'L'
  6041        MOVE 'L'                TO PI-SV-MAINT
  6042        GO TO 3000-CHANGE-ALL-RECORDS.
  6043
  6044     MOVE ER-0023                TO EMI-ERROR.
  6045     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6046     MOVE -1                     TO MAINTL.
  6047     MOVE AL-UABON               TO MAINTA.
  6048     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 114
* EL6501.cbl
  6050 0500-CHECK-MAINT-TYPE.
  6051     IF PI-MAINT = 'A'
  6052        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  6053        PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT
  6054        MOVE -1                  TO NAMEL
  6055        GO TO 8100-SEND-INITIAL-MAP.
  6056
  6057 0600-DISPLAY-RECORD.
  6058     PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT.
  6059     PERFORM 6500-READ-ACCT       THRU 6599-EXIT.
  6060     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  6061     PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT.
  6062
  6063     IF PI-MAINT = 'A'
  6064        MOVE -1                  TO NAMEL
  6065     ELSE
  6066        MOVE -1                  TO MAINTL.
  6067
  6068     GO TO 8100-SEND-INITIAL-MAP.
  6069
  6070 0700-FORMAT-KEYDATA.
  6071     MOVE PI-MAINT               TO MAINTI.
  6072
  6073     IF PI-MAINT = 'A'
  6074        MOVE AL-PANON            TO MAINTA
  6075        SET T-INDEX TO 1
  6076     ELSE
  6077        SET T-INDEX              TO PI-LINE-SELECTED
  6078        MOVE AL-UANON            TO MAINTA.
  6079
  6080     IF PI-2ND-PAGE
  6081         SET T-INDEX UP BY 8
  6082     ELSE
  6083     IF PI-3RD-PAGE
  6084         SET T-INDEX UP BY 16
  6085     ELSE
  6086     IF PI-LST-PAGE
  6087         SET T-INDEX UP BY 24.
  6088
  6089     MOVE PI-ACCT-CARRIER        TO CARRI.
  6090     MOVE PI-ACCT-GROUPING       TO GROUPINI.
  6091     MOVE PI-ACCT-STATE          TO STATEI.
  6092     MOVE PI-ACCT-ACCOUNT        TO ACCOUNTI.
  6093
  6094     IF PI-ACCT-EXP-DT = LOW-VALUES
  6095        MOVE SPACES              TO EXPDTEI
  6096     ELSE
  6097        IF PI-ACCT-EXP-DT NOT = HIGH-VALUES
  6098           MOVE PI-ACCT-EXP-DT      TO DC-BIN-DATE-1
  6099           MOVE SPACE               TO DC-OPTION-CODE
  6100           PERFORM 9700-DATE-LINK
  6101           MOVE DC-GREG-DATE-1-EDIT TO EXPDTEI
  6102        ELSE
  6103           MOVE 999999              TO EXPDTEO
  6104           INSPECT EXPDTEI CONVERTING SPACES TO '/'.
  6105
  6106***DMD CUSTOM CODE *****START
  6107     MOVE EXPDTEI (1:2)             TO WS-YYYYMMDD (5:2).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 115
* EL6501.cbl
  6108     MOVE EXPDTEI (4:2)             TO WS-YYYYMMDD (7:2).
  6109     MOVE EXPDTEI (6:2)             TO WS-YYYYMMDD (3:2).
  6110     IF EXPDTEI (7:1) IS NOT EQUAL TO '9'
  6111        MOVE '20'                 TO WS-YYYYMMDD (1:2)
  6112     ELSE
  6113        MOVE '19'                 TO WS-YYYYMMDD (1:2).
  6114***DMD CUSTOM CODE *****END
  6115
  6116     MOVE PI-BIN-EFF-DT (T-INDEX) TO DC-BIN-DATE-1.
  6117     MOVE SPACE                   TO DC-OPTION-CODE.
  6118     PERFORM 9700-DATE-LINK.
  6119     MOVE DC-GREG-DATE-1-EDIT     TO EFFDTEI.
  6120
  6121 0700-EXIT.
  6122      EXIT.
  6123
  6124 0800-CHECK-MAINT.
  6125     IF PI-MAINT = 'A'
  6126        IF PI-RECORD-NOT-CREATED
  6127           MOVE ER-2071          TO EMI-ERROR
  6128           MOVE  -1              TO NAMEL
  6129           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6130           GO TO 8200-SEND-DATAONLY.
  6131
  6132     IF  EIBAID = DFHPF1
  6133             AND
  6134         CREDIT-SESSION
  6135         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6136         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6137         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6138         MOVE PI-ACCT-STATE      TO PI-STATE
  6139         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6140         MOVE PI-ACCT-EXP-DT     TO PI-CERT-EFF-DT
  6141         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  6142         MOVE XCTL-689           TO PGM-NAME
  6143         GO TO 9300-XCTL.
  6144
  6145     IF  EIBAID = DFHPF2 AND CREDIT-SESSION
  6146         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6147         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6148         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6149         MOVE PI-ACCT-STATE      TO PI-STATE
  6150         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6151         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
  6152         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  6153         MOVE XCTL-690           TO PGM-NAME
  6154         GO TO 9300-XCTL
  6155     END-IF.
  6156
  6157     IF EIBAID = DFHPF3
  6158             AND
  6159         CREDIT-SESSION
  6160         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6161         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6162         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6163         MOVE PI-ACCT-STATE      TO PI-STATE
  6164         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6165         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 116
* EL6501.cbl
  6166         MOVE XCTL-653           TO PGM-NAME
  6167         GO TO 9300-XCTL.
  6168
  6169     IF EIBAID = DFHPF4
  6170         PERFORM 5100-WRITE-TS  THRU  5199-EXIT
  6171         MOVE XCTL-652           TO PGM-NAME
  6172         GO TO 9300-XCTL.
  6173
  6174     IF EIBAID = DFHPF5
  6175         MOVE XCTL-6502          TO PGM-NAME
  6176         GO TO 9300-XCTL.
  6177
  6178     IF EIBAID = DFHPF7
  6179         MOVE XCTL-6504          TO PGM-NAME
  6180         GO TO 9300-XCTL.
  6181
  6182     IF EIBAID = DFHPF8
  6183         MOVE XCTL-6506          TO PGM-NAME
  6184         GO TO 9300-XCTL.
  6185
  6186     IF EIBAID = DFHPF9
  6187        MOVE XCTL-6505           TO PGM-NAME
  6188        GO TO 9300-XCTL.
  6189
  6190     IF EIBAID = DFHPF10
  6191        IF PI-COMPANY-ID = 'DMD'
  6192           PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6193           MOVE XCTL-608         TO PGM-NAME
  6194           GO TO 9300-XCTL.
  6195
  6196     MOVE ER-0029                TO EMI-ERROR.
  6197     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6198     MOVE AL-UNBON               TO PFENTERA.
  6199     MOVE -1                     TO PFENTERL.
  6200     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 117
* EL6501.cbl
  6202 1000-ADD-A-RECORD.
  6203     IF PI-MAINT = 'A'
  6204        PERFORM 4000-EDITS THRU 4900-EXIT
  6205     ELSE
  6206        MOVE ER-2180             TO EMI-ERROR
  6207        MOVE -1                  TO MAINTL
  6208        MOVE AL-UABON            TO MAINTA
  6209        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6210
  6211     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6212        EMI-FATAL-CTR    GREATER ZERO
  6213         GO TO 8200-SEND-DATAONLY.
  6214
  6215
  6216* EXEC CICS GETMAIN
  6217*         LENGTH   (ACCT-REC-LEN)
  6218*         SET      (ADDRESS OF ACCOUNT-MASTER)
  6219*         INITIMG  (GETMAIN-SPACE)
  6220*    END-EXEC.
  6221*    MOVE ',"IL                  $   #00006186' TO DFHEIV0
  6222     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6223     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6224     MOVE X'2020233030303036313836' TO DFHEIV0(25:11)
  6225     CALL 'kxdfhei1' USING DFHEIV0,
  6226           DFHEIV20,
  6227           ACCT-REC-LEN,
  6228           GETMAIN-SPACE
  6229     SET ADDRESS OF ACCOUNT-MASTER TO
  6230         DFHEIV20
  6231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6232
  6233
  6234     MOVE ZEROS          TO WSS-LF-LM-AGE (1) WSS-LF-LM-AGE (2)
  6235                            WSS-LF-LM-AGE (3) WSS-LF-LM-AGE (4)
  6236                            WSS-LF-LM-DUR (1) WSS-LF-LM-DUR (2)
  6237                            WSS-LF-LM-DUR (3) WSS-LF-LM-DUR (4)
  6238                            WSS-LF-LM-AMT (1) WSS-LF-LM-AMT (2)
  6239                            WSS-LF-LM-AMT (3) WSS-LF-LM-AMT (4).
  6240
  6241     MOVE ZEROS          TO WSS-AH-LM-AGE (1) WSS-LF-LM-AGE (2)
  6242                            WSS-AH-LM-AGE (3) WSS-LF-LM-AGE (4)
  6243                            WSS-AH-LM-DUR (1) WSS-LF-LM-DUR (2)
  6244                            WSS-AH-LM-DUR (3) WSS-LF-LM-DUR (4)
  6245                            WSS-AH-LM-AMT (1) WSS-LF-LM-AMT (2)
  6246                            WSS-AH-LM-AMT (3) WSS-LF-LM-AMT (4)
  6247                            WSS-AH-LM-MOA (1) WSS-AH-LM-MOA (2)
  6248                            WSS-AH-LM-MOA (3) WSS-AH-LM-MOA (4).
  6249
  6250     MOVE WSS-AGT-COMMS          TO AM-AGT-COMMS (1)
  6251                                    AM-AGT-COMMS (2)
  6252                                    AM-AGT-COMMS (3)
  6253                                    AM-AGT-COMMS (4)
  6254                                    AM-AGT-COMMS (5)
  6255                                    AM-AGT-COMMS (6)
  6256                                    AM-AGT-COMMS (7)
  6257                                    AM-AGT-COMMS (8)
  6258                                    AM-AGT-COMMS (9)
  6259                                    AM-AGT-COMMS (10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 118
* EL6501.cbl
  6260
  6261     IF PI-COMPANY-ID = 'FLI'
  6262         MOVE ZEROS              TO AM-FLI-BANK-BALANCE
  6263                                    AM-FLI-BANK-1ST-6-PREM
  6264                                    AM-FLI-BANK-CAP-AMT
  6265                                    AM-FLI-AGT-SHARE-PCT (1)
  6266                                    AM-FLI-AGT-SHARE-PCT (2)
  6267                                    AM-FLI-AGT-SHARE-PCT (3)
  6268                                    AM-FLI-AGT-SHARE-PCT (4)
  6269                                    AM-FLI-AGT-SHARE-PCT (5)
  6270                                    AM-FLI-AGT-SHARE-PCT (6)
  6271                                    AM-FLI-AGT-SHARE-PCT (7)
  6272                                    AM-FLI-AGT-SHARE-PCT (8)
  6273                                    AM-FLI-AGT-SHARE-PCT (9)
  6274                                    AM-FLI-AGT-SHARE-PCT (10).
  6275
  6276     MOVE ZEROS                  TO AM-GPCD
  6277                                    AM-LF-RET
  6278                                    AM-AH-RET
  6279                                    AM-LF-OB-RATE
  6280                                    AM-LF-OB-RATE-JNT
  6281                                    AM-AH-OB-RATE
  6282                                    AM-AH-OB-RATE-JNT
  6283                                    AM-REI-FEE-LF
  6284                                    AM-REI-FEE-AH
  6285                                    AM-REI-LF-TAX
  6286                                    AM-REI-PR-PCT
  6287                                    AM-REI-78-PCT
  6288                                    AM-REI-AH-TAX
  6289                                    AM-TOL-PREM
  6290                                    AM-TOL-REF
  6291                                    AM-CLP-TOL-PCT
  6292                                    AM-TOL-CLM
  6293                                    AM-CERTS-PURGED-DATE
  6294                                    AM-HI-CERT-DATE
  6295                                    AM-LO-CERT-DATE
  6296                                    AM-1ST-PROD-DATE
  6297                                    AM-GPCD
  6298                                    AM-CAL-TABLE
  6299                                    AM-LF-DEVIATION
  6300                                    AM-LF-DEVIATION-PCT
  6301                                    AM-AH-DEVIATION
  6302                                    AM-AH-DEVIATION-PCT
  6303                                    AM-ANNIVERSARY-DATE
  6304                                    AM-TEL-NO
  6305                                    AM-ENTRY-DATE
  6306                                    AM-INACTIVE-DATE
  6307                                    AM-RET-MIN-LOSS-L
  6308                                    AM-RET-MIN-LOSS-A
  6309                                    AM-LF-RPT021-EXP-PCT
  6310                                    AM-AH-RPT021-EXP-PCT
  6311                                    AM-MAX-MON-BEN
  6312                                    AM-MAX-TOT-BEN
  6313                                    AM-DCC-MAX-MARKETING-FEE
  6314                                    AM-SPP-LEASE-COMM
  6315                                    AM-RETRO-QUALIFY-LIMIT
  6316                                    AM-RETRO-RET-PCT-LF (1)
  6317                                    AM-RETRO-RET-PCT-LF (2)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 119
* EL6501.cbl
  6318                                    AM-RETRO-RET-PCT-LF (3)
  6319                                    AM-RETRO-RET-THRU-LF (1)
  6320                                    AM-RETRO-RET-THRU-LF (2)
  6321                                    AM-RETRO-RET-THRU-LF (3)
  6322                                    AM-RETRO-RET-PCT-AH (1)
  6323                                    AM-RETRO-RET-PCT-AH (2)
  6324                                    AM-RETRO-RET-PCT-AH (3)
  6325                                    AM-RETRO-RET-THRU-AH (1)
  6326                                    AM-RETRO-RET-THRU-AH (2)
  6327                                    AM-RETRO-RET-THRU-AH (3).
  6328
  6329     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  6330        MOVE +100                TO AM-DCC-MAX-MARKETING-FEE
  6331     END-IF
  6332     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP
  6333                                    AM-AR-HI-CERT-DATE.
  6334
  6335     MOVE 'AM'                   TO AM-RECORD-ID.
  6336     MOVE PI-ACCT-KEY            TO AM-CONTROL-PRIMARY
  6337                                    AM-CONTROL-BY-VAR-GRP.
  6338
  6339     IF ST-ACCNT-CNTL
  6340        MOVE SPACES              TO AM-VG-CARRIER
  6341                                    AM-VG-GROUPING.
  6342     IF CARR-ST-ACCNT-CNTL
  6343        MOVE SPACES              TO AM-VG-GROUPING.
  6344
  6345     IF ACCNT-CNTL
  6346        MOVE SPACES              TO AM-VG-CARRIER
  6347                                    AM-VG-STATE
  6348                                    AM-VG-GROUPING.
  6349
  6350     IF CARR-ACCNT-CNTL
  6351        MOVE SPACES              TO AM-VG-STATE
  6352                                    AM-VG-GROUPING.
  6353
  6354     MOVE CURRENT-SAVE           TO AM-ENTRY-DATE.
  6355     MOVE BIN-EXPCHG-SAVE        TO AM-VG-EXPIRATION-DT.
  6356     MOVE PI-BIN-EFF-DT (1)      TO AM-EFFECTIVE-DT.
  6357
  6358     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6359     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6360     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6361
  6362     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6363
  6364     IF PI-COMPANY-ID = 'NCL'
  6365         MOVE 'N'                TO AM-AH-ONLY-INDICATOR.
  6366
  6367     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6368        EMI-FATAL-CTR    GREATER ZERO
  6369         GO TO 8200-SEND-DATAONLY.
  6370
  6371     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  6372        IF CLPSTL <= ZEROS
  6373           MOVE ER-0144          TO  EMI-ERROR
  6374           MOVE -1               TO  CLPSTL
  6375           MOVE AL-UABON         TO  CLPSTA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 120
* EL6501.cbl
  6376           PERFORM 9900-ERROR-FORMAT
  6377                                 THRU  9900-EXIT
  6378           GO TO 8200-SEND-DATAONLY
  6379        END-IF
  6380     END-IF
  6381     MOVE AM-COMM-STRUCTURE      TO AM-COMM-STRUCTURE-SAVED.
  6382     MOVE SPACE                  TO AM-COMM-CHANGE-STATUS.
  6383
  6384     MOVE +1 TO AXRF-SUB
  6385                COMM-WORK-SUB.
  6386
  6387     PERFORM 6700-BUILD-COMM-WORK     THRU 6799-EXIT.
  6388     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6389
  6390     PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6391
  6392     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6393         NEXT SENTENCE
  6394     ELSE
  6395         PERFORM 1500-ADD-COMP     THRU 1500-EXIT.
  6396
  6397
  6398* EXEC CICS WRITE
  6399*        FROM      (ACCOUNT-MASTER)
  6400*        RIDFLD    (AM-CONTROL-PRIMARY)
  6401*        DATASET   (ACCT-FILE-ID)
  6402*    END-EXEC.
  6403     MOVE LENGTH OF
  6404      ACCOUNT-MASTER
  6405       TO DFHEIV11
  6406*    MOVE '&$ L                  ''   #00006355' TO DFHEIV0
  6407     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6408     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6409     MOVE X'2020233030303036333535' TO DFHEIV0(25:11)
  6410     CALL 'kxdfhei1' USING DFHEIV0,
  6411           ACCT-FILE-ID,
  6412           ACCOUNT-MASTER,
  6413           DFHEIV11,
  6414           AM-CONTROL-PRIMARY,
  6415           DFHEIV99,
  6416           DFHEIV99
  6417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6418
  6419
  6420     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6421
  6422     MOVE PI-MAINT               TO PI-SV-MAINT.
  6423     MOVE 'C'                    TO PI-MAINT.
  6424     MOVE LOW-VALUES             TO EL6501AI.
  6425
  6426     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6427     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6428     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6429
  6430     IF PI-COMPANY-ID = 'NCL'
  6431         MOVE ER-4011            TO EMI-ERROR
  6432      ELSE
  6433         MOVE ER-0000            TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 121
* EL6501.cbl
  6434
  6435     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6436
  6437     MOVE -1                     TO MAINTL.
  6438     MOVE AL-UANON               TO MAINTA.
  6439     MOVE '1'                    TO PI-RECORD-ADDED-SW.
  6440     GO TO 8100-SEND-INITIAL-MAP.
  6441
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 122
* EL6501.cbl
  6443 1500-ADD-COMP.
  6444
  6445* EXEC CICS GETMAIN
  6446*         LENGTH   (COMP-REC-LEN)
  6447*         SET      (ADDRESS OF COMPENSATION-MASTER)
  6448*         INITIMG  (GETMAIN-SPACE)
  6449*    END-EXEC.
  6450*    MOVE ',"IL                  $   #00006385' TO DFHEIV0
  6451     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6452     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6453     MOVE X'2020233030303036333835' TO DFHEIV0(25:11)
  6454     CALL 'kxdfhei1' USING DFHEIV0,
  6455           DFHEIV20,
  6456           COMP-REC-LEN,
  6457           GETMAIN-SPACE
  6458     SET ADDRESS OF COMPENSATION-MASTER TO
  6459         DFHEIV20
  6460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6461
  6462
  6463     MOVE SPACES                 TO COMPENSATION-MASTER.
  6464     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  6465                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  6466                   CO-OV30         CO-OV60      CO-OV90
  6467                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  6468                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  6469                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  6470                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  6471                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  6472                   CO-CURRENT-CUR     CO-CURRENT-OV30
  6473                   CO-CURRENT-OV60    CO-CURRENT-OV90
  6474                   CO-CURRENT-CUR-PMT
  6475                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  6476                   CO-ACT-YEAR        CO-ACT-MONTH
  6477                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  6478                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  6479                   CO-CURRENT-LAST-STMT-YEAR
  6480                   CO-CURRENT-LAST-STMT-MONTH
  6481                   CO-CURRENT-LAST-STMT-DAY
  6482                   CO-YTD-PAID-COM
  6483                   CO-YTD-PAID-OV
  6484                   co-ov120 co-current-ov120
  6485
  6486     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  6487     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  6488     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  6489     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  6490     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  6491
  6492     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  6493         MOVE ZEROS              TO CO-CARRIER
  6494     ELSE
  6495         MOVE AM-CARRIER         TO CO-CARRIER.
  6496
  6497     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  6498         MOVE ZEROS              TO CO-GROUPING
  6499     ELSE
  6500         MOVE AM-GROUPING        TO CO-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 123
* EL6501.cbl
  6501
  6502     MOVE 'CO'                   TO CO-RECORD-ID
  6503     MOVE 'A'                    TO CO-TYPE.
  6504     MOVE AM-NAME                TO CO-ACCT-NAME.
  6505     MOVE AM-PERSON              TO CO-MAIL-NAME.
  6506     MOVE AM-ADDRS               TO CO-ADDR-1.
  6507*    MOVE AM-CITY                TO CO-ADDR-3.
  6508     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  6509     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  6510     MOVE AM-ZIP                 TO CO-ZIP.
  6511     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  6512     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  6513
  6514     IF PI-COMPANY-ID = 'NCL'
  6515         MOVE AM-ID-NO           TO  WS-SOC-SEC-WORK
  6516         IF WS-SS-TYPE = 'C' OR 'P' OR 'S' OR 'T' OR
  6517                         'X' OR 'I'
  6518             MOVE WS-SS-TYPE     TO  CO-TYPE-AGENT
  6519             MOVE WS-SOC-SEC     TO  CO-SOC-SEC
  6520         ELSE
  6521             MOVE SPACE          TO  CO-TYPE-AGENT
  6522             MOVE AM-ID-NO       TO  CO-SOC-SEC
  6523     ELSE
  6524         MOVE AM-ID-NO           TO CO-SOC-SEC.
  6525
  6526     IF AM-REMIT-TO NOT = ZERO
  6527         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  6528       ELSE
  6529         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  6530
  6531     MOVE +0                      TO AGT-SUB.
  6532
  6533     PERFORM 1600-FIND-C-AGT THRU 1600-EXIT.
  6534
  6535     IF VALID-AGT-SW = 'Y'
  6536         NEXT SENTENCE
  6537     ELSE
  6538         GO TO 1500-EXIT.
  6539
  6540     IF CO-RESP-NO = CO-ACCOUNT
  6541         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  6542     ELSE
  6543         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  6544
  6545     IF PI-AR-PROCESSING
  6546        MOVE 'G'                   TO CO-AR-REPORTING
  6547        MOVE '1'                   TO CO-AR-BAL-LEVEL
  6548        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  6549        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  6550
  6551     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  6552        MOVE 'N'                   TO CO-AR-REPORTING.
  6553
  6554     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  6555        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  6556
  6557     PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6558
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 124
* EL6501.cbl
  6559
  6560* EXEC CICS HANDLE CONDITION
  6561*         DUPREC   (1500-EXIT)
  6562*    END-EXEC.
  6563*    MOVE '"$%                   ! # #00006487' TO DFHEIV0
  6564     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6566     MOVE X'2320233030303036343837' TO DFHEIV0(25:11)
  6567     CALL 'kxdfhei1' USING DFHEIV0
  6568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6569
  6570
  6571
  6572* EXEC CICS WRITE
  6573*        FROM      (COMPENSATION-MASTER)
  6574*        RIDFLD    (CO-CONTROL-PRIMARY)
  6575*        DATASET   (COMP-FILE-ID)
  6576*    END-EXEC.
  6577     MOVE LENGTH OF
  6578      COMPENSATION-MASTER
  6579       TO DFHEIV11
  6580*    MOVE '&$ L                  ''   #00006491' TO DFHEIV0
  6581     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6582     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6583     MOVE X'2020233030303036343931' TO DFHEIV0(25:11)
  6584     CALL 'kxdfhei1' USING DFHEIV0,
  6585           COMP-FILE-ID,
  6586           COMPENSATION-MASTER,
  6587           DFHEIV11,
  6588           CO-CONTROL-PRIMARY,
  6589           DFHEIV99,
  6590           DFHEIV99
  6591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6592
  6593
  6594 1500-EXIT.
  6595      EXIT.
  6596
  6597 1600-FIND-C-AGT.
  6598     ADD 1 TO  AGT-SUB.
  6599     IF AGT-SUB GREATER 10
  6600         MOVE 'N'                TO  VALID-AGT-SW
  6601         GO TO 1600-EXIT.
  6602
  6603************************************************************
  6604**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6605************************************************************
  6606
  6607     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F'
  6608         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  6609         MOVE 'Y'                TO  VALID-AGT-SW
  6610         GO TO 1600-EXIT
  6611     ELSE
  6612         GO TO 1600-FIND-C-AGT.
  6613
  6614 1600-EXIT.
  6615     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 125
* EL6501.cbl
  6617 1700-CHANGE-COMP.
  6618     MOVE 'N'                    TO CHANGE-WAS-MADE-SW.
  6619     MOVE PI-COMPANY-CD          TO COMP-COMPANY-CD.
  6620
  6621     IF PI-ZERO-CARRIER
  6622       OR PI-ZERO-CAR-GROUP
  6623         MOVE ZEROS              TO COMP-CARRIER
  6624     ELSE
  6625         MOVE AM-CARRIER         TO COMP-CARRIER.
  6626
  6627     IF PI-ZERO-GROUPING
  6628       OR PI-ZERO-CAR-GROUP
  6629         MOVE ZEROS              TO COMP-GROUPING
  6630     ELSE
  6631         MOVE AM-GROUPING        TO COMP-GROUPING.
  6632
  6633     IF AM-REMIT-TO NOT = ZERO
  6634         MOVE AM-AGT (AM-REMIT-TO)
  6635                                 TO COMP-RESP-NO
  6636     ELSE
  6637         MOVE AM-ACCOUNT         TO COMP-RESP-NO.
  6638
  6639     MOVE ZERO                   TO AGT-SUB.
  6640
  6641     PERFORM 1800-FIND-C-AGT THRU 1899-EXIT.
  6642
  6643     IF VALID-AGT-SW = 'Y'
  6644         NEXT SENTENCE
  6645     ELSE
  6646         GO TO 1799-EXIT.
  6647
  6648     MOVE 'A'                    TO COMP-TYPE.
  6649
  6650
  6651* EXEC CICS HANDLE CONDITION
  6652*         ENDFILE     (1799-EXIT)
  6653*         NOTFND      (1799-EXIT)
  6654*    END-EXEC.
  6655*    MOVE '"$''I                  ! $ #00006553' TO DFHEIV0
  6656     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6657     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6658     MOVE X'2420233030303036353533' TO DFHEIV0(25:11)
  6659     CALL 'kxdfhei1' USING DFHEIV0
  6660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6661
  6662
  6663
  6664* EXEC CICS READ
  6665*        UPDATE
  6666*        DATASET   (COMP-FILE-ID)
  6667*        SET       (ADDRESS OF COMPENSATION-MASTER)
  6668*        RIDFLD    (COMP-KEY)
  6669*    END-EXEC.
  6670*    MOVE '&"S        EU         (   #00006558' TO DFHEIV0
  6671     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6672     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6673     MOVE X'2020233030303036353538' TO DFHEIV0(25:11)
  6674     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 126
* EL6501.cbl
  6675           COMP-FILE-ID,
  6676           DFHEIV20,
  6677           DFHEIV99,
  6678           COMP-KEY,
  6679           DFHEIV99,
  6680           DFHEIV99,
  6681           DFHEIV99
  6682     SET ADDRESS OF COMPENSATION-MASTER TO
  6683         DFHEIV20
  6684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6685
  6686
  6687     IF (ON-LAST-DATE-RANGE)
  6688        IF NAMEL GREATER ZEROS
  6689           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6690           MOVE AM-NAME          TO CO-ACCT-NAME
  6691        END-IF
  6692        IF INCAREL GREATER ZEROS
  6693           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6694           MOVE AM-PERSON        TO CO-MAIL-NAME
  6695        END-IF
  6696        IF ADDR1L GREATER ZEROS
  6697           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6698           MOVE AM-ADDRS         TO CO-ADDR-1
  6699        END-IF
  6700        IF ACITYL  GREATER ZEROS
  6701           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6702           MOVE AM-ADDR-CITY     TO CO-ADDR-CITY
  6703        END-IF
  6704        IF ASTATEL  GREATER ZEROS
  6705           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6706           MOVE AM-ADDR-STATE    TO CO-ADDR-STATE
  6707        END-IF
  6708        IF ZIPL GREATER ZEROS
  6709           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6710           MOVE AM-ZIP           TO CO-ZIP
  6711        END-IF
  6712        IF CSRL GREATER ZEROS
  6713           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6714           MOVE AM-CSR-CODE      TO CO-CSR-CODE
  6715        END-IF
  6716        IF PHONEL GREATER ZEROS
  6717           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6718           MOVE AM-TEL-NO        TO CO-TELEPHONE
  6719        END-IF
  6720        IF TAXNOL GREATER ZEROS
  6721           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6722           MOVE AM-ID-NO         TO CO-SOC-SEC
  6723        END-IF
  6724        IF AUTO-CANCEL-ACCOUNT
  6725           IF CO-BILL-SW = ' '
  6726              MOVE 'B'           TO CO-BILL-SW
  6727              MOVE 'Y'           TO CHANGE-WAS-MADE-SW
  6728           END-IF
  6729        END-IF
  6730     END-IF
  6731
  6732     IF PCONTL > 0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 127
* EL6501.cbl
  6733         MOVE 'Y'                TO CHANGE-WAS-MADE-SW
  6734         MOVE AM-CONTROL-NAME    TO CO-CONTROL-NAME
  6735     END-IF
  6736
  6737     IF CHANGE-WAS-MADE
  6738         MOVE BIN-CURRENT-SAVE   TO CO-LAST-MAINT-DT
  6739         MOVE PI-PROCESSOR-ID    TO CO-LAST-MAINT-USER
  6740         MOVE EIBTIME            TO CO-LAST-MAINT-HHMMSS.
  6741
  6742     IF NAMEL GREATER THAN ZERO
  6743         PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6744
  6745
  6746* EXEC CICS REWRITE
  6747*        FROM      (COMPENSATION-MASTER)
  6748*        DATASET   (COMP-FILE-ID)
  6749*    END-EXEC.
  6750     MOVE LENGTH OF
  6751      COMPENSATION-MASTER
  6752       TO DFHEIV11
  6753*    MOVE '&& L                  %   #00006623' TO DFHEIV0
  6754     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6755     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6756     MOVE X'2020233030303036363233' TO DFHEIV0(25:11)
  6757     CALL 'kxdfhei1' USING DFHEIV0,
  6758           COMP-FILE-ID,
  6759           COMPENSATION-MASTER,
  6760           DFHEIV11,
  6761           DFHEIV99
  6762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6763
  6764
  6765 1799-EXIT.
  6766     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 128
* EL6501.cbl
  6768 1800-FIND-C-AGT.
  6769     ADD 1                       TO  AGT-SUB.
  6770
  6771     IF AGT-SUB GREATER 10
  6772         MOVE 'N'                TO  VALID-AGT-SW
  6773         GO TO 1899-EXIT.
  6774
  6775************************************************************
  6776**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6777************************************************************
  6778
  6779     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F'
  6780         MOVE AM-AGT (AGT-SUB)   TO  COMP-ACCOUNT
  6781         MOVE 'Y'                TO  VALID-AGT-SW
  6782         GO TO 1899-EXIT
  6783     ELSE
  6784         GO TO 1800-FIND-C-AGT.
  6785
  6786 1899-EXIT.
  6787     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 129
* EL6501.cbl
  6789 2000-CHANGE-A-RECORD.
  6790     PERFORM 4000-EDITS THRU 4900-EXIT.
  6791
  6792     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6793        EMI-FATAL-CTR    GREATER ZERO
  6794         GO TO 8200-SEND-DATAONLY.
  6795
  6796
  6797* EXEC CICS READ
  6798*        UPDATE
  6799*        DATASET   (ACCT-FILE-ID)
  6800*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6801*        RIDFLD    (PI-ACCT-KEY)
  6802*    END-EXEC.
  6803*    MOVE '&"S        EU         (   #00006659' TO DFHEIV0
  6804     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6805     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6806     MOVE X'2020233030303036363539' TO DFHEIV0(25:11)
  6807     CALL 'kxdfhei1' USING DFHEIV0,
  6808           ACCT-FILE-ID,
  6809           DFHEIV20,
  6810           DFHEIV99,
  6811           PI-ACCT-KEY,
  6812           DFHEIV99,
  6813           DFHEIV99,
  6814           DFHEIV99
  6815     SET ADDRESS OF ACCOUNT-MASTER TO
  6816         DFHEIV20
  6817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6818
  6819
  6820     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  6821
  6822     IF NOT PI-AR-PROCESSING
  6823        GO TO 2075-PROCESS-CHANGE.
  6824
  6825     MOVE AM-AGT (AM-REMIT-TO)   TO SAVE-FIN-RESP.
  6826     MOVE +0                     TO SUB1.
  6827
  6828 2075-PROCESS-CHANGE.
  6829     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6830
  6831     IF PI-AR-PROCESSING
  6832        PERFORM 5300-UPDATE-REQUEST-FILE THRU 5399-EXIT.
  6833
  6834     IF PI-COMPANY-ID = 'DMD'
  6835     IF AM-ANNIVERSARY-DATE = ZEROS
  6836           MOVE ER-0852             TO EMI-ERROR
  6837           MOVE -1                  TO CONTRL
  6838           MOVE AL-UABON            TO CONTRA
  6839           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6840
  6841     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6842        EMI-FATAL-CTR    GREATER ZERO
  6843         GO TO 8200-SEND-DATAONLY.
  6844
  6845     MOVE +1                     TO AXRF-SUB
  6846                                    COMM-WORK-SUB.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 130
* EL6501.cbl
  6847     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6848
  6849     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6850     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6851     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6852
  6853     IF ((PI-FST-PAGE)
  6854        AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  6855                      OR
  6856        ((PI-2ND-PAGE)
  6857        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  6858                      OR
  6859        ((PI-3RD-PAGE)
  6860        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  6861                      OR
  6862        ((PI-LST-PAGE)
  6863        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  6864        SET ON-LAST-DATE-RANGE   TO TRUE
  6865     END-IF
  6866     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6867         NEXT SENTENCE
  6868     ELSE
  6869         IF (ON-LAST-DATE-RANGE)
  6870                          OR
  6871            ((PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL') AND
  6872             (PCONTL > ZERO))
  6873             PERFORM 1700-CHANGE-COMP THRU 1799-EXIT.
  6874
  6875     IF NAMEL GREATER THAN ZERO
  6876         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6877
  6878
  6879* EXEC CICS REWRITE
  6880*        FROM      (ACCOUNT-MASTER)
  6881*        DATASET   (ACCT-FILE-ID)
  6882*    END-EXEC.
  6883     MOVE LENGTH OF
  6884      ACCOUNT-MASTER
  6885       TO DFHEIV11
  6886*    MOVE '&& L                  %   #00006724' TO DFHEIV0
  6887     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6888     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6889     MOVE X'2020233030303036373234' TO DFHEIV0(25:11)
  6890     CALL 'kxdfhei1' USING DFHEIV0,
  6891           ACCT-FILE-ID,
  6892           ACCOUNT-MASTER,
  6893           DFHEIV11,
  6894           DFHEIV99
  6895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6896
  6897
  6898     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6899
  6900     IF CSRL GREATER ZEROS
  6901         GO TO 3500-CHANGE-ALL-CSR.
  6902
  6903     MOVE ER-0000                TO EMI-ERROR.
  6904     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 131
* EL6501.cbl
  6905     MOVE LOW-VALUES             TO EL6501AI.
  6906
  6907     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6908     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6909     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6910
  6911     MOVE ER-0000                TO EMI-ERROR.
  6912     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6913
  6914     MOVE -1                     TO MAINTL.
  6915     MOVE AL-UANON               TO MAINTA.
  6916     GO TO 8100-SEND-INITIAL-MAP.
  6917
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 132
* EL6501.cbl
  6919 2100-ADD-ACCOUNT-NAME.
  6920
  6921* EXEC CICS HANDLE CONDITION
  6922*         DUPREC   (2100-EXIT)
  6923*    END-EXEC.
  6924*    MOVE '"$%                   ! % #00006751' TO DFHEIV0
  6925     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6926     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6927     MOVE X'2520233030303036373531' TO DFHEIV0(25:11)
  6928     CALL 'kxdfhei1' USING DFHEIV0
  6929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6930
  6931
  6932
  6933* EXEC CICS GETMAIN
  6934*         LENGTH   (NAME-REC-LEN)
  6935*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6936*         INITIMG  (GETMAIN-SPACE)
  6937*    END-EXEC.
  6938*    MOVE ',"IL                  $   #00006755' TO DFHEIV0
  6939     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6940     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6941     MOVE X'2020233030303036373535' TO DFHEIV0(25:11)
  6942     CALL 'kxdfhei1' USING DFHEIV0,
  6943           DFHEIV20,
  6944           NAME-REC-LEN,
  6945           GETMAIN-SPACE
  6946     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6947         DFHEIV20
  6948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6949
  6950
  6951     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6952     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6953     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6954     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6955     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6956     MOVE AM-NAME                TO  NL-NAME.
  6957     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6958        MOVE NL-NAME (5:26)      TO NL-NAME
  6959     END-IF
  6960     MOVE AM-ADDR-CITY           TO  NL-CITY.
  6961     MOVE AM-ADDR-STATE          TO  NL-ST.
  6962     MOVE 'A'                    TO  NL-RECORD-TYPE.
  6963     MOVE PI-COMPANY-CD          TO  NL-AM-COMPANY-CD.
  6964     MOVE AM-CARRIER             TO  NL-AM-CARRIER.
  6965     MOVE AM-GROUPING            TO  NL-AM-GROUPING.
  6966     MOVE AM-STATE               TO  NL-AM-STATE.
  6967     MOVE AM-ACCOUNT             TO  NL-AM-ACCOUNT.
  6968
  6969
  6970* EXEC CICS WRITE
  6971*        FROM      (NAME-LOOKUP-MASTER)
  6972*        RIDFLD    (NL-CONTROL-PRIMARY)
  6973*        DATASET   (NAME-FILE-ID)
  6974*    END-EXEC.
  6975     MOVE LENGTH OF
  6976      NAME-LOOKUP-MASTER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 133
* EL6501.cbl
  6977       TO DFHEIV11
  6978*    MOVE '&$ L                  ''   #00006779' TO DFHEIV0
  6979     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6980     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6981     MOVE X'2020233030303036373739' TO DFHEIV0(25:11)
  6982     CALL 'kxdfhei1' USING DFHEIV0,
  6983           NAME-FILE-ID,
  6984           NAME-LOOKUP-MASTER,
  6985           DFHEIV11,
  6986           NL-CONTROL-PRIMARY,
  6987           DFHEIV99,
  6988           DFHEIV99
  6989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6990
  6991
  6992 2100-EXIT.
  6993     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 134
* EL6501.cbl
  6995 2200-ADD-COMPENSATION-NAME.
  6996
  6997* EXEC CICS HANDLE CONDITION
  6998*         DUPREC   (2200-EXIT)
  6999*    END-EXEC.
  7000*    MOVE '"$%                   ! & #00006789' TO DFHEIV0
  7001     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7002     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7003     MOVE X'2620233030303036373839' TO DFHEIV0(25:11)
  7004     CALL 'kxdfhei1' USING DFHEIV0
  7005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7006
  7007
  7008
  7009* EXEC CICS GETMAIN
  7010*         LENGTH   (NAME-REC-LEN)
  7011*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  7012*         INITIMG  (GETMAIN-SPACE)
  7013*    END-EXEC.
  7014*    MOVE ',"IL                  $   #00006793' TO DFHEIV0
  7015     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7016     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7017     MOVE X'2020233030303036373933' TO DFHEIV0(25:11)
  7018     CALL 'kxdfhei1' USING DFHEIV0,
  7019           DFHEIV20,
  7020           NAME-REC-LEN,
  7021           GETMAIN-SPACE
  7022     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  7023         DFHEIV20
  7024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7025
  7026
  7027     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  7028     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  7029     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  7030     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  7031     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  7032     MOVE CO-ACCT-NAME           TO  NL-NAME.
  7033     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  7034        MOVE NL-NAME (5:26)      TO NL-NAME
  7035     END-IF
  7036     MOVE CO-ADDR-CITY           TO  NL-CITY.
  7037     MOVE CO-ADDR-STATE          TO  NL-ST
  7038     MOVE 'C'                    TO  NL-RECORD-TYPE.
  7039     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  7040     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  7041     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  7042     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  7043     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  7044     MOVE CO-TYPE                TO  NL-CO-TYPE.
  7045
  7046
  7047* EXEC CICS WRITE
  7048*        FROM      (NAME-LOOKUP-MASTER)
  7049*        RIDFLD    (NL-CONTROL-PRIMARY)
  7050*        DATASET   (NAME-FILE-ID)
  7051*    END-EXEC.
  7052     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 135
* EL6501.cbl
  7053      NAME-LOOKUP-MASTER
  7054       TO DFHEIV11
  7055*    MOVE '&$ L                  ''   #00006818' TO DFHEIV0
  7056     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7057     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7058     MOVE X'2020233030303036383138' TO DFHEIV0(25:11)
  7059     CALL 'kxdfhei1' USING DFHEIV0,
  7060           NAME-FILE-ID,
  7061           NAME-LOOKUP-MASTER,
  7062           DFHEIV11,
  7063           NL-CONTROL-PRIMARY,
  7064           DFHEIV99,
  7065           DFHEIV99
  7066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7067
  7068
  7069 2200-EXIT.
  7070     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 136
* EL6501.cbl
  7072 3000-CHANGE-ALL-RECORDS.
  7073     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP.
  7074     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7075
  7076
  7077* EXEC CICS HANDLE CONDITION
  7078*         ENDFILE     (3030-END-FILE)
  7079*    END-EXEC.
  7080*    MOVE '"$''                   ! '' #00006831' TO DFHEIV0
  7081     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7083     MOVE X'2720233030303036383331' TO DFHEIV0(25:11)
  7084     CALL 'kxdfhei1' USING DFHEIV0
  7085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7086
  7087
  7088     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7089
  7090 3010-READ-NEXT.
  7091     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7092
  7093     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7094        GO TO 3030-END-FILE.
  7095
  7096
  7097* EXEC CICS ENDBR
  7098*        DATASET   (ACCT-FILE-ID)
  7099*    END-EXEC.
  7100     MOVE 0
  7101       TO DFHEIV11
  7102*    MOVE '&2                    $   #00006843' TO DFHEIV0
  7103     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7104     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7105     MOVE X'2020233030303036383433' TO DFHEIV0(25:11)
  7106     CALL 'kxdfhei1' USING DFHEIV0,
  7107           ACCT-FILE-ID,
  7108           DFHEIV11,
  7109           DFHEIV99
  7110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7111
  7112     ADD +1                      TO WS-CHANGE-ALL-CNT
  7113
  7114* EXEC CICS READ
  7115*        UPDATE
  7116*        DATASET   (ACCT-FILE-ID)
  7117*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7118*        RIDFLD    (WS-KEY-SAVE)
  7119*    END-EXEC.
  7120*    MOVE '&"S        EU         (   #00006847' TO DFHEIV0
  7121     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7122     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7123     MOVE X'2020233030303036383437' TO DFHEIV0(25:11)
  7124     CALL 'kxdfhei1' USING DFHEIV0,
  7125           ACCT-FILE-ID,
  7126           DFHEIV20,
  7127           DFHEIV99,
  7128           WS-KEY-SAVE,
  7129           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 137
* EL6501.cbl
  7130           DFHEIV99,
  7131           DFHEIV99
  7132     SET ADDRESS OF ACCOUNT-MASTER TO
  7133         DFHEIV20
  7134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7135
  7136
  7137     IF NAMEL    GREATER THAN ZERO  OR
  7138        INCAREL  GREATER THAN ZERO  OR
  7139        ADDR1L   GREATER THAN ZERO  OR
  7140        ACITYL   GREATER THAN ZERO  OR
  7141        ASTATEL  GREATER THAN ZERO  OR
  7142        ZIPL     GREATER THAN ZERO  OR
  7143        CLPTOLPL GREATER THAN ZERO  OR
  7144        PHONEL   GREATER THAN ZERO
  7145         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  7146
  7147     IF STATUSL > ZERO
  7148        EVALUATE TRUE
  7149           WHEN STATUSI = 'A'
  7150              MOVE '0'           TO AM-STATUS
  7151           WHEN STATUSI = 'I'
  7152              MOVE '1'           TO AM-STATUS
  7153           WHEN (STATUSI = 'C')
  7154              AND (AM-STATUS NOT = '3' AND 'C')
  7155              MOVE '3'           TO AM-STATUS
  7156              SET AUTO-CANCEL-ACCOUNT
  7157                                 TO TRUE
  7158           WHEN (STATUSI = 'C')
  7159              MOVE '3'           TO AM-STATUS
  7160           WHEN STATUSI = 'F'
  7161              MOVE '4'           TO AM-STATUS
  7162           WHEN STATUSI = 'S'
  7163              MOVE '5'           TO AM-STATUS
  7164           WHEN STATUSI = 'D'
  7165              MOVE '6'           TO AM-STATUS
  7166           WHEN STATUSI = 'L'
  7167              MOVE '7'           TO AM-STATUS
  7168           WHEN STATUSI = 'R'
  7169              MOVE '8'           TO AM-STATUS
  7170           WHEN STATUSI = 'P'
  7171              MOVE '9'           TO AM-STATUS
  7172           WHEN OTHER
  7173              MOVE -1            TO STATUSL
  7174              MOVE AL-UABON      TO STATUSA
  7175              MOVE ER-2153       TO EMI-ERROR
  7176              PERFORM 9900-ERROR-FORMAT
  7177                                 THRU 9900-EXIT
  7178        END-EVALUATE
  7179     END-IF
  7180*    IF STATUSL > ZERO
  7181*       IF STATUSI = 'A'
  7182*          MOVE '0'              TO AM-STATUS
  7183*       ELSE
  7184*          IF STATUSI = 'I'
  7185*             MOVE '1'           TO AM-STATUS
  7186*          ELSE
  7187*             IF STATUSI = 'C'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 138
* EL6501.cbl
  7188*                IF AM-STATUS NOT = '3' AND 'C'
  7189*                   SET AUTO-CANCEL-ACCOUNT
  7190*                                TO TRUE
  7191*                END-IF
  7192*                MOVE '3'        TO AM-STATUS
  7193*             ELSE
  7194*                IF STATUSI = 'F'
  7195*                   MOVE '4'     TO AM-STATUS
  7196*                ELSE
  7197*                   MOVE -1         TO STATUSL
  7198*                   MOVE AL-UABON   TO STATUSA
  7199*                   MOVE ER-2153    TO EMI-ERROR
  7200*                   PERFORM 9900-ERROR-FORMAT
  7201*                                THRU 9900-EXIT
  7202*                END-IF
  7203*             END-IF
  7204*          END-IF
  7205*       END-IF
  7206*    END-IF
  7207
  7208     IF CSRL GREATER ZERO
  7209        MOVE CSRI                TO AM-CSR-CODE.
  7210     IF NAMEL GREATER THAN ZERO
  7211        MOVE NAMEI               TO AM-NAME.
  7212     IF PCONTL GREATER THAN ZERO
  7213        MOVE PCONTI              TO AM-CONTROL-NAME
  7214     END-IF
  7215     IF INCAREL GREATER ZEROS
  7216        MOVE INCAREI             TO AM-PERSON.
  7217     IF ADDR1L GREATER ZEROS
  7218        MOVE ADDR1I              TO AM-ADDRS.
  7219     IF ACITYL GREATER ZEROS
  7220        MOVE ACITYI             TO AM-ADDR-CITY.
  7221     IF ASTATEL GREATER ZEROS
  7222        MOVE ASTATEI            TO AM-ADDR-STATE.
  7223     IF ZIPL NOT GREATER ZEROS
  7224         GO TO 3015-CONT-CHANGING.
  7225
  7226     MOVE ZIPI                   TO WS-ZIP-CODE.
  7227
  7228     IF WS-CANADIAN-ZIP
  7229         IF WS-ZIP-4 = SPACE  OR  '-'
  7230             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  7231             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  7232         ELSE
  7233             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  7234             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  7235     ELSE
  7236         IF WS-ZIP-6 = SPACE  OR  '-'
  7237             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  7238             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  7239         ELSE
  7240             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  7241             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  7242
  7243 3015-CONT-CHANGING.
  7244
  7245     IF CLPTOLPL GREATER ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 139
* EL6501.cbl
  7246
  7247* EXEC CICS BIF
  7248*            DEEDIT
  7249*            FIELD    (CLPTOLPI)
  7250*            LENGTH   (6)
  7251*        END-EXEC
  7252     MOVE 6
  7253       TO DFHEIV11
  7254*    MOVE '@"L                   #   #00006963' TO DFHEIV0
  7255     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7256     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7257     MOVE X'2020233030303036393633' TO DFHEIV0(25:11)
  7258     CALL 'kxdfhei1' USING DFHEIV0,
  7259           CLPTOLPI,
  7260           DFHEIV11
  7261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7262         IF CLPTOLPI NUMERIC
  7263             MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  7264         ELSE
  7265             MOVE -1                  TO CLPTOLPL
  7266             MOVE AL-UNBON            TO CLPTOLPA
  7267             MOVE ER-1778             TO EMI-ERROR
  7268             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7269         END-IF
  7270     END-IF
  7271
  7272     IF LCOMML > ZEROS
  7273
  7274* EXEC CICS BIF
  7275*            DEEDIT
  7276*            FIELD    (LCOMMI)
  7277*            LENGTH   (8)
  7278*        END-EXEC
  7279     MOVE 8
  7280       TO DFHEIV11
  7281*    MOVE '@"L                   #   #00006979' TO DFHEIV0
  7282     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7283     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7284     MOVE X'2020233030303036393739' TO DFHEIV0(25:11)
  7285     CALL 'kxdfhei1' USING DFHEIV0,
  7286           LCOMMI,
  7287           DFHEIV11
  7288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7289         IF LCOMMI NUMERIC
  7290            MOVE LCOMMI          TO AM-SPP-LEASE-COMM
  7291         ELSE
  7292            MOVE -1              TO LCOMML
  7293            MOVE AL-UNBON        TO LCOMMA
  7294            MOVE ER-1778         TO EMI-ERROR
  7295            PERFORM 9900-ERROR-FORMAT
  7296                                 THRU 9900-EXIT
  7297         END-IF
  7298     END-IF
  7299
  7300     IF PHONEL GREATER ZEROS
  7301        MOVE PHONEI              TO DEEDIT-FIELD
  7302        PERFORM 8600-DEEDIT
  7303        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 140
* EL6501.cbl
  7304        MOVE WS-PH1              TO AM-AREA-CODE
  7305        MOVE WS-PH2              TO AM-TEL-PRE
  7306        MOVE WS-PH3              TO AM-TEL-NBR.
  7307
  7308*    IF PSILFFL GREATER +0
  7309*       MOVE PSILFFI             TO DEEDIT-FIELD
  7310*       PERFORM 8600-DEEDIT
  7311*       IF DEEDIT-FIELD NUMERIC
  7312*          MOVE DEEDIT-FIELD-V5  TO AM-LF-PSI-FACTOR.
  7313*
  7314*    IF PSIAHFL GREATER +0
  7315*       MOVE PSIAHFI             TO DEEDIT-FIELD
  7316*       PERFORM 8600-DEEDIT
  7317*       IF DEEDIT-FIELD NUMERIC
  7318*          MOVE DEEDIT-FIELD-V5  TO AM-AH-PSI-FACTOR.
  7319
  7320     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7321     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7322     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7323
  7324     IF ((PI-FST-PAGE)
  7325        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT))
  7326                      OR
  7327        ((PI-2ND-PAGE)
  7328        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 8))
  7329                      OR
  7330        ((PI-3RD-PAGE)
  7331        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 16))
  7332                      OR
  7333        ((PI-LST-PAGE)
  7334        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 24))
  7335        SET ON-LAST-DATE-RANGE   TO TRUE
  7336     END-IF
  7337*    IF ((PI-FST-PAGE)
  7338*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  7339*                     OR
  7340*       ((PI-2ND-PAGE)
  7341*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  7342*                     OR
  7343*       ((PI-3RD-PAGE)
  7344*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  7345*                     OR
  7346*       ((PI-LST-PAGE)
  7347*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  7348*       SET ON-LAST-DATE-RANGE   TO TRUE
  7349*    END-IF
  7350     MOVE PI-PAGE-NUMBER TO WS-PAGE-NUMBER
  7351     MOVE PI-TOTAL-LINES TO WS-TOTAL-LINES
  7352     MOVE PI-LINE-SELECTED TO WS-LINE-SELECTED
  7353*    EXEC CICS DELAY
  7354*       INTERVAL (WS-DELAY-INT)
  7355*    END-EXEC
  7356     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7357        CONTINUE
  7358     ELSE
  7359        IF (ON-LAST-DATE-RANGE)
  7360                   OR
  7361           ((PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL') AND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 141
* EL6501.cbl
  7362           (PCONTL > ZERO))
  7363           PERFORM 1700-CHANGE-COMP
  7364                                 THRU 1799-EXIT
  7365        END-IF
  7366     END-IF
  7367
  7368     IF NAMEL GREATER THAN ZERO
  7369         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  7370
  7371
  7372* EXEC CICS REWRITE
  7373*        FROM      (ACCOUNT-MASTER)
  7374*        DATASET   (ACCT-FILE-ID)
  7375*    END-EXEC.
  7376     MOVE LENGTH OF
  7377      ACCOUNT-MASTER
  7378       TO DFHEIV11
  7379*    MOVE '&& L                  %   #00007066' TO DFHEIV0
  7380     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7381     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7382     MOVE X'2020233030303037303636' TO DFHEIV0(25:11)
  7383     CALL 'kxdfhei1' USING DFHEIV0,
  7384           ACCT-FILE-ID,
  7385           ACCOUNT-MASTER,
  7386           DFHEIV11,
  7387           DFHEIV99
  7388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7389
  7390
  7391     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7392     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7393
  7394     GO TO 3010-READ-NEXT.
  7395
  7396 3030-END-FILE.
  7397     IF BROWSE-STARTED
  7398        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7399
  7400     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7401
  7402     IF AUTO-CANCEL-ACCOUNT
  7403
  7404* EXEC CICS GETMAIN
  7405*          LENGTH   (ERACNT-REC-LEN)
  7406*          SET      (ADDRESS OF NOTE-FILE)
  7407*          INITIMG  (GETMAIN-SPACE)
  7408*          RESP     (WS-RESPONSE)
  7409*       END-EXEC
  7410*    MOVE ',"IL                  $  N#00007083' TO DFHEIV0
  7411     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7412     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7413     MOVE X'204E233030303037303833' TO DFHEIV0(25:11)
  7414     CALL 'kxdfhei1' USING DFHEIV0,
  7415           DFHEIV20,
  7416           ERACNT-REC-LEN,
  7417           GETMAIN-SPACE
  7418     SET ADDRESS OF NOTE-FILE TO
  7419         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 142
* EL6501.cbl
  7420     MOVE EIBRESP  TO WS-RESPONSE
  7421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7422        MOVE PI-ACCT-CCGSA-KEY   TO NT-CONTROL-PRIMARY
  7423        MOVE '1'                 TO NT-RECORD-TYPE
  7424        MOVE +1                  TO NT-LINE-SEQUENCE
  7425        MOVE SAVE-BIN-DATE       TO NT-LAST-MAINT-DT
  7426        MOVE PI-PROCESSOR-ID     TO NT-LAST-MAINT-BY
  7427        MOVE EIBTIME             TO NT-LAST-MAINT-HHMMSS
  7428        MOVE 'CANCELLED DUE TO LOW PRODUCTION'
  7429                                 TO NT-NOTE-LINE
  7430        PERFORM WITH TEST AFTER UNTIL
  7431           (NOT RESP-DUPKEY)
  7432           AND (NOT RESP-DUPREC)
  7433
  7434* EXEC CICS WRITE
  7435*             FROM      (NOTE-FILE)
  7436*             RIDFLD    (NT-CONTROL-PRIMARY)
  7437*             DATASET   (ERACNT-FILE-ID)
  7438*             RESP      (WS-RESPONSE)
  7439*          END-EXEC
  7440     MOVE LENGTH OF
  7441      NOTE-FILE
  7442       TO DFHEIV11
  7443*    MOVE '&$ L                  ''  N#00007100' TO DFHEIV0
  7444     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7445     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7446     MOVE X'204E233030303037313030' TO DFHEIV0(25:11)
  7447     CALL 'kxdfhei1' USING DFHEIV0,
  7448           ERACNT-FILE-ID,
  7449           NOTE-FILE,
  7450           DFHEIV11,
  7451           NT-CONTROL-PRIMARY,
  7452           DFHEIV99,
  7453           DFHEIV99
  7454     MOVE EIBRESP  TO WS-RESPONSE
  7455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7456           IF RESP-DUPKEY OR RESP-DUPREC
  7457              ADD +1             TO NT-LINE-SEQUENCE
  7458           END-IF
  7459        END-PERFORM
  7460     END-IF
  7461     IF NOT EMI-NO-ERRORS
  7462         GO TO 8200-SEND-DATAONLY.
  7463
  7464     MOVE -1                     TO NAMEL.
  7465     MOVE ER-0000                TO EMI-ERROR.
  7466     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7467     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 143
* EL6501.cbl
  7469 3500-CHANGE-ALL-CSR.
  7470     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7471     MOVE LOW-VALUES             TO WS-ACCT-EXP-DT
  7472                                    WS-ACCT-REST-OF-EXP.
  7473
  7474
  7475* EXEC CICS HANDLE CONDITION
  7476*         ENDFILE     (3530-END-FILE)
  7477*    END-EXEC.
  7478*    MOVE '"$''                   ! ( #00007124' TO DFHEIV0
  7479     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7480     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7481     MOVE X'2820233030303037313234' TO DFHEIV0(25:11)
  7482     CALL 'kxdfhei1' USING DFHEIV0
  7483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7484
  7485
  7486     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7487
  7488 3510-READ-NEXT.
  7489     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7490
  7491     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7492        GO TO 3530-END-FILE.
  7493
  7494
  7495* EXEC CICS ENDBR
  7496*        DATASET   (ACCT-FILE-ID)
  7497*    END-EXEC.
  7498     MOVE 0
  7499       TO DFHEIV11
  7500*    MOVE '&2                    $   #00007136' TO DFHEIV0
  7501     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7502     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7503     MOVE X'2020233030303037313336' TO DFHEIV0(25:11)
  7504     CALL 'kxdfhei1' USING DFHEIV0,
  7505           ACCT-FILE-ID,
  7506           DFHEIV11,
  7507           DFHEIV99
  7508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7509
  7510
  7511
  7512* EXEC CICS READ
  7513*        UPDATE
  7514*        DATASET   (ACCT-FILE-ID)
  7515*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7516*        RIDFLD    (WS-KEY-SAVE)
  7517*    END-EXEC.
  7518*    MOVE '&"S        EU         (   #00007140' TO DFHEIV0
  7519     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7520     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7521     MOVE X'2020233030303037313430' TO DFHEIV0(25:11)
  7522     CALL 'kxdfhei1' USING DFHEIV0,
  7523           ACCT-FILE-ID,
  7524           DFHEIV20,
  7525           DFHEIV99,
  7526           WS-KEY-SAVE,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 144
* EL6501.cbl
  7527           DFHEIV99,
  7528           DFHEIV99,
  7529           DFHEIV99
  7530     SET ADDRESS OF ACCOUNT-MASTER TO
  7531         DFHEIV20
  7532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7533
  7534
  7535     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7536     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7537     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7538
  7539     MOVE CSRI                   TO AM-CSR-CODE.
  7540
  7541
  7542* EXEC CICS REWRITE
  7543*        FROM      (ACCOUNT-MASTER)
  7544*        DATASET   (ACCT-FILE-ID)
  7545*    END-EXEC.
  7546     MOVE LENGTH OF
  7547      ACCOUNT-MASTER
  7548       TO DFHEIV11
  7549*    MOVE '&& L                  %   #00007153' TO DFHEIV0
  7550     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7551     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7552     MOVE X'2020233030303037313533' TO DFHEIV0(25:11)
  7553     CALL 'kxdfhei1' USING DFHEIV0,
  7554           ACCT-FILE-ID,
  7555           ACCOUNT-MASTER,
  7556           DFHEIV11,
  7557           DFHEIV99
  7558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7559
  7560
  7561     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7562     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7563
  7564     GO TO 3510-READ-NEXT.
  7565
  7566 3530-END-FILE.
  7567     IF BROWSE-STARTED
  7568        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7569
  7570     MOVE ER-4009                TO EMI-ERROR.
  7571     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7572     MOVE LOW-VALUES             TO EL6501AI.
  7573
  7574     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  7575     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  7576     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  7577
  7578     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7579
  7580     MOVE -1                     TO MAINTL.
  7581     MOVE AL-UANON               TO MAINTA.
  7582     GO TO 8100-SEND-INITIAL-MAP.
  7583
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 145
* EL6501.cbl
  7585 4000-EDITS.
  7586     IF PI-COMPANY-ID = 'NCL'
  7587      IF MAINTI = 'A' OR 'C'
  7588        IF CSRL GREATER ZEROS
  7589            PERFORM 8050-USER-REC-READ THRU 8060-EXIT
  7590          ELSE
  7591            IF MAINTI = 'A'
  7592                MOVE ER-1883         TO EMI-ERROR
  7593                MOVE -1              TO CSRL
  7594                MOVE AL-UABON        TO CSRA
  7595                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7596
  7597     IF PI-COMPANY-ID  =  'AIG' OR 'AUK'
  7598        IF NAMEL NOT GREATER ZEROS
  7599           IF MAINTI = 'C'
  7600              GO TO 4070-CHECK-STATUS
  7601           ELSE
  7602              MOVE -1               TO  NAMEL
  7603              MOVE AL-UABON         TO  NAMEA
  7604              MOVE ER-2045          TO  EMI-ERROR
  7605              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7606        ELSE
  7607            GO TO 4065-CHECK-ASSOCIATES.
  7608
  7609     IF TYPEL NOT GREATER ZEROS
  7610        IF MAINTI = 'C'
  7611           GO TO 4050-CONTINUE
  7612        ELSE
  7613           GO TO 4020-BUS-TYPE-ERROR.
  7614
  7615     IF TYPEI NOT NUMERIC
  7616        GO TO 4020-BUS-TYPE-ERROR
  7617     ELSE
  7618        IF TYPEI LESS 1 OR GREATER 99
  7619           GO TO 4020-BUS-TYPE-ERROR.
  7620
  7621     MOVE SPACES                 TO ELCNTL-KEY.
  7622
  7623     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7624     MOVE TYPEI                  TO CNTL-BUS-TYPE.
  7625     MOVE '8'                    TO CNTL-REC-TYPE.
  7626     MOVE +0                     TO CNTL-SEQ-NO.
  7627
  7628
  7629* EXEC CICS HANDLE CONDITION
  7630*        NOTFND   (4020-BUS-TYPE-ERROR)
  7631*    END-EXEC.
  7632*    MOVE '"$I                   ! ) #00007225' TO DFHEIV0
  7633     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7634     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7635     MOVE X'2920233030303037323235' TO DFHEIV0(25:11)
  7636     CALL 'kxdfhei1' USING DFHEIV0
  7637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7638
  7639
  7640
  7641* EXEC CICS READ
  7642*        GTEQ
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 146
* EL6501.cbl
  7643*        DATASET   (CNTL-FILE-ID)
  7644*        SET       (ADDRESS OF CONTROL-FILE)
  7645*        RIDFLD    (ELCNTL-KEY)
  7646*    END-EXEC.
  7647*    MOVE '&"S        G          (   #00007229' TO DFHEIV0
  7648     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7649     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7650     MOVE X'2020233030303037323239' TO DFHEIV0(25:11)
  7651     CALL 'kxdfhei1' USING DFHEIV0,
  7652           CNTL-FILE-ID,
  7653           DFHEIV20,
  7654           DFHEIV99,
  7655           ELCNTL-KEY,
  7656           DFHEIV99,
  7657           DFHEIV99,
  7658           DFHEIV99
  7659     SET ADDRESS OF CONTROL-FILE TO
  7660         DFHEIV20
  7661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7662
  7663
  7664     IF TYPEI LESS 21
  7665        MOVE TYPEI               TO WS-BUS-ENTRY
  7666     ELSE
  7667        DIVIDE TYPEI BY 20
  7668            GIVING WS-BUS-TYPE REMAINDER WS-BUS-ENTRY
  7669        IF WS-BUS-ENTRY = ZEROS
  7670           MOVE 20               TO WS-BUS-ENTRY.
  7671
  7672     IF CF-BUSINESS-TITLE (WS-BUS-ENTRY) NOT = SPACES
  7673        GO TO 4050-CONTINUE.
  7674
  7675 4020-BUS-TYPE-ERROR.
  7676     MOVE -1                     TO TYPEL.
  7677     MOVE AL-UNBON               TO TYPEA.
  7678     MOVE ER-2178                TO EMI-ERROR.
  7679     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7680
  7681 4050-CONTINUE.
  7682     IF ASTATEL > 0
  7683        MOVE SPACES                 TO  ELCNTL-KEY
  7684        MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID
  7685        MOVE '3'                    TO  CNTL-REC-TYPE
  7686        MOVE ASTATEI                TO  CNTL-ACCESS (1:2)
  7687        MOVE +0                     TO  CNTL-SEQ-NO
  7688
  7689* EXEC CICS  READ
  7690*           DATASET  ('ELCNTL')
  7691*           SET      (ADDRESS OF CONTROL-FILE)
  7692*           RIDFLD   (ELCNTL-KEY)
  7693*           RESP     (WS-RESPONSE)
  7694*       END-EXEC
  7695     MOVE 'ELCNTL' TO DFHEIV1
  7696*    MOVE '&"S        E          (  N#00007260' TO DFHEIV0
  7697     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7698     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7699     MOVE X'204E233030303037323630' TO DFHEIV0(25:11)
  7700     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 147
* EL6501.cbl
  7701           DFHEIV1,
  7702           DFHEIV20,
  7703           DFHEIV99,
  7704           ELCNTL-KEY,
  7705           DFHEIV99,
  7706           DFHEIV99,
  7707           DFHEIV99
  7708     SET ADDRESS OF CONTROL-FILE TO
  7709         DFHEIV20
  7710     MOVE EIBRESP  TO WS-RESPONSE
  7711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7712        IF NOT RESP-NORMAL
  7713           MOVE ER-0144                TO  EMI-ERROR
  7714           MOVE -1                     TO  ASTATEL
  7715           MOVE AL-UABON               TO  ASTATEA
  7716           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7717        END-IF
  7718     ELSE
  7719        IF MAINTI = 'A'
  7720           MOVE ER-0144                TO  EMI-ERROR
  7721           MOVE -1                     TO  ASTATEL
  7722           MOVE AL-UABON               TO  ASTATEA
  7723           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7724        END-IF
  7725     END-IF
  7726     IF INDGRPL NOT GREATER ZEROS
  7727        IF MAINTI = 'C'
  7728           GO TO 4070-CHECK-STATUS
  7729        ELSE
  7730           GO TO 4060-IG-ERROR.
  7731
  7732     IF INDGRPI = 'I' OR 'G'
  7733        GO TO 4070-CHECK-STATUS.
  7734
  7735 4060-IG-ERROR.
  7736     MOVE -1                     TO INDGRPL.
  7737     MOVE AL-UABON               TO INDGRPA.
  7738     MOVE ER-2152                TO EMI-ERROR.
  7739     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7740
  7741 4065-CHECK-ASSOCIATES.
  7742     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7743        MOVE  PI-ACCT-ACCOUNT    TO  WS-ACCOUNT-NUM-AREA
  7744        MOVE  NAMEI              TO  WS-NAME-AREA
  7745     ELSE
  7746        GO TO 4070-CHECK-STATUS.
  7747
  7748     IF WS-NAME-1-4  =  WS-ACCT-BRANCH-CD
  7749        NEXT SENTENCE
  7750     ELSE
  7751        MOVE -1                  TO  NAMEL
  7752        MOVE AL-UABON            TO  NAMEA
  7753        MOVE ER-0788             TO  EMI-ERROR
  7754        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7755
  7756 4070-CHECK-STATUS.
  7757     IF STATUSL NOT GREATER ZEROS
  7758        IF MAINTI = 'C'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 148
* EL6501.cbl
  7759           GO TO 4090-CHECK-STD-AH-TYPE
  7760        ELSE
  7761           MOVE 'A'              TO STATUSI
  7762           MOVE AL-UANON         TO STATUSA
  7763           GO TO 4090-CHECK-STD-AH-TYPE.
  7764
  7765*    IF STATUSI = 'A' OR 'I' OR 'C' OR 'F' OR 'S'
  7766     IF STATUSI = 'A' OR 'I' OR 'C' OR 'F' OR 'S' OR 'D' OR 'L'
  7767                      OR 'R' OR 'P'
  7768        GO TO 4090-CHECK-STD-AH-TYPE.
  7769
  7770 4080-STATUS-ERROR.
  7771     MOVE -1                     TO STATUSL.
  7772     MOVE AL-UABON               TO STATUSA.
  7773     MOVE ER-2153                TO EMI-ERROR.
  7774     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7775
  7776 4090-CHECK-STD-AH-TYPE.
  7777
  7778     IF PI-COMPANY-ID  = 'AIG' OR 'AUK'
  7779         GO TO 4900-EXIT.
  7780
  7781     IF STDBENL NOT GREATER ZEROS
  7782        IF MAINTI = 'C'
  7783*          GO TO 4110-CHECK-REMIT
  7784           GO TO 4100-CHECK-CLPTOLP
  7785        ELSE
  7786           MOVE ZEROS            TO STDBENI
  7787           MOVE AL-UANON         TO STDBENA
  7788*          GO TO 4110-CHECK-REMIT.
  7789           GO TO 4100-CHECK-CLPTOLP.
  7790
  7791     IF STDBENI = SPACES
  7792         MOVE ZEROS               TO STDBENI.
  7793     IF STDBENI = ZEROS
  7794*        GO TO 4110-CHECK-REMIT.
  7795         GO TO 4100-CHECK-CLPTOLP.
  7796
  7797     MOVE STDBENI                TO WS-EDIT-BEN-CODE.
  7798     IF INVALID-BENEFIT-CODE
  7799        GO TO 4099-STD-BEN-ERROR.
  7800
  7801     MOVE SPACES                 TO ELCNTL-KEY.
  7802
  7803     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7804     MOVE STDBENI                TO CNTL-BEN-TYPE.
  7805     MOVE '5'                    TO CNTL-REC-TYPE.
  7806     MOVE +0                     TO CNTL-SEQ-NO.
  7807
  7808
  7809* EXEC CICS HANDLE CONDITION
  7810*        NOTFND   (4099-STD-BEN-ERROR)
  7811*    END-EXEC.
  7812*    MOVE '"$I                   ! * #00007362' TO DFHEIV0
  7813     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7814     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7815     MOVE X'2A20233030303037333632' TO DFHEIV0(25:11)
  7816     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 149
* EL6501.cbl
  7817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7818
  7819
  7820
  7821* EXEC CICS READ
  7822*        GTEQ
  7823*        DATASET   (CNTL-FILE-ID)
  7824*        SET       (ADDRESS OF CONTROL-FILE)
  7825*        RIDFLD    (ELCNTL-KEY)
  7826*    END-EXEC.
  7827*    MOVE '&"S        G          (   #00007366' TO DFHEIV0
  7828     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7829     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7830     MOVE X'2020233030303037333636' TO DFHEIV0(25:11)
  7831     CALL 'kxdfhei1' USING DFHEIV0,
  7832           CNTL-FILE-ID,
  7833           DFHEIV20,
  7834           DFHEIV99,
  7835           ELCNTL-KEY,
  7836           DFHEIV99,
  7837           DFHEIV99,
  7838           DFHEIV99
  7839     SET ADDRESS OF CONTROL-FILE TO
  7840         DFHEIV20
  7841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7842
  7843
  7844     IF CNTL-COMP-ID  = CF-COMPANY-ID  AND
  7845        CNTL-REC-TYPE = CF-RECORD-TYPE
  7846         MOVE 1                  TO SUB
  7847     ELSE
  7848         GO TO 4099-STD-BEN-ERROR.
  7849
  7850 4095-CHECK-BEN-TYPE.
  7851     IF STDBENI = CF-BENEFIT-CODE (SUB)
  7852*       GO TO 4110-CHECK-REMIT.
  7853        GO TO 4100-CHECK-CLPTOLP.
  7854
  7855     IF SUB LESS 8
  7856         ADD 1 TO SUB
  7857         GO TO 4095-CHECK-BEN-TYPE.
  7858
  7859 4099-STD-BEN-ERROR.
  7860     MOVE -1                     TO STDBENL.
  7861     MOVE AL-UABON               TO STDBENA.
  7862     MOVE ER-0250                TO EMI-ERROR.
  7863     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7864
  7865 4100-CHECK-CLPTOLP.
  7866
  7867     IF CLPTOLPL > ZERO
  7868
  7869* EXEC CICS BIF
  7870*            DEEDIT
  7871*            FIELD    (CLPTOLPI)
  7872*            LENGTH   (6)
  7873*        END-EXEC
  7874     MOVE 6
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 150
* EL6501.cbl
  7875       TO DFHEIV11
  7876*    MOVE '@"L                   #   #00007397' TO DFHEIV0
  7877     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7878     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7879     MOVE X'2020233030303037333937' TO DFHEIV0(25:11)
  7880     CALL 'kxdfhei1' USING DFHEIV0,
  7881           CLPTOLPI,
  7882           DFHEIV11
  7883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7884         IF CLPTOLPI NOT NUMERIC
  7885             MOVE ER-1778        TO EMI-ERROR
  7886             MOVE -1             TO CLPTOLPL
  7887             MOVE AL-UNBON       TO CLPTOLPA
  7888             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7889         END-IF
  7890     END-IF.
  7891     IF LCOMML > ZERO
  7892
  7893* EXEC CICS BIF
  7894*            DEEDIT
  7895*            FIELD    (LCOMMI)
  7896*            LENGTH   (8)
  7897*        END-EXEC
  7898     MOVE 8
  7899       TO DFHEIV11
  7900*    MOVE '@"L                   #   #00007410' TO DFHEIV0
  7901     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7902     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7903     MOVE X'2020233030303037343130' TO DFHEIV0(25:11)
  7904     CALL 'kxdfhei1' USING DFHEIV0,
  7905           LCOMMI,
  7906           DFHEIV11
  7907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7908         IF LCOMMI NOT NUMERIC
  7909             MOVE ER-1778        TO EMI-ERROR
  7910             MOVE -1             TO LCOMML
  7911             MOVE AL-UNBON       TO LCOMMA
  7912             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7913         END-IF
  7914     END-IF
  7915     IF MAXMFEEL > ZEROS
  7916
  7917* EXEC CICS BIF DEEDIT
  7918*          FIELD   (MAXMFEEI)
  7919*          LENGTH  (5)
  7920*       END-EXEC
  7921     MOVE 5
  7922       TO DFHEIV11
  7923*    MOVE '@"L                   #   #00007423' TO DFHEIV0
  7924     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7925     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7926     MOVE X'2020233030303037343233' TO DFHEIV0(25:11)
  7927     CALL 'kxdfhei1' USING DFHEIV0,
  7928           MAXMFEEI,
  7929           DFHEIV11
  7930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7931        IF MAXMFEEI NUMERIC
  7932           MOVE MAXMFEEI         TO WS-WORK-FIELD
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 151
* EL6501.cbl
  7933           MOVE WS-WORK-NUM      TO MAXMFEEO
  7934        ELSE
  7935           MOVE -1               TO MAXMFEEL
  7936           MOVE AL-UABON         TO MAXMFEEA
  7937           MOVE ER-7717          TO EMI-ERROR
  7938           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7939        END-IF
  7940     END-IF
  7941     IF (CLPSTL > 0)
  7942         MOVE AL-UANON           TO CLPSTA
  7943        IF (CLPSTI NOT = SPACES)
  7944           MOVE SPACES           TO ELCNTL-KEY
  7945           MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
  7946           MOVE '3'              TO CNTL-REC-TYPE
  7947           MOVE CLPSTI           TO CNTL-ACCESS (1:2)
  7948           MOVE +0               TO CNTL-SEQ-NO
  7949
  7950* EXEC CICS  READ
  7951*              DATASET  ('ELCNTL')
  7952*              SET      (ADDRESS OF CONTROL-FILE)
  7953*              RIDFLD   (ELCNTL-KEY)
  7954*              RESP     (WS-RESPONSE)
  7955*          END-EXEC
  7956     MOVE 'ELCNTL' TO DFHEIV1
  7957*    MOVE '&"S        E          (  N#00007445' TO DFHEIV0
  7958     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7959     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7960     MOVE X'204E233030303037343435' TO DFHEIV0(25:11)
  7961     CALL 'kxdfhei1' USING DFHEIV0,
  7962           DFHEIV1,
  7963           DFHEIV20,
  7964           DFHEIV99,
  7965           ELCNTL-KEY,
  7966           DFHEIV99,
  7967           DFHEIV99,
  7968           DFHEIV99
  7969     SET ADDRESS OF CONTROL-FILE TO
  7970         DFHEIV20
  7971     MOVE EIBRESP  TO WS-RESPONSE
  7972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7973           IF NOT RESP-NORMAL
  7974              MOVE ER-0144       TO EMI-ERROR
  7975              MOVE -1            TO CLPSTL
  7976              MOVE AL-UABON      TO CLPSTA
  7977              PERFORM 9900-ERROR-FORMAT
  7978                                 THRU  9900-EXIT
  7979           END-IF
  7980        ELSE
  7981           MOVE ER-0144          TO EMI-ERROR
  7982           MOVE -1               TO CLPSTL
  7983           MOVE AL-UABON         TO CLPSTA
  7984           PERFORM 9900-ERROR-FORMAT
  7985                                 THRU  9900-EXIT
  7986        END-IF
  7987     END-IF
  7988     IF (PRODCDL > ZEROS)
  7989        and (emi-error not = er-0144)
  7990        if prodcdi = spaces
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 152
* EL6501.cbl
  7991           continue
  7992        else
  7993           move low-values       to erpdef-key
  7994           move pi-company-cd    to erpdef-company-cd
  7995           move clpsti           to erpdef-state
  7996           move prodcdi          to erpdef-prod-cd
  7997           move erpdef-key       to erpdef-key-save
  7998
  7999* exec cics read
  8000*             dataset ('ERPDEF')
  8001*             set     (address of product-master)
  8002*             ridfld  (erpdef-key)
  8003*             length  (6)
  8004*             gteq
  8005*             resp    (ws-response)
  8006*          end-exec
  8007     MOVE 'ERPDEF' TO DFHEIV1
  8008*    MOVE '&"S        G          (  N#00007476' TO DFHEIV0
  8009     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8010     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8011     MOVE X'204E233030303037343736' TO DFHEIV0(25:11)
  8012     CALL 'kxdfhei1' USING DFHEIV0,
  8013           DFHEIV1,
  8014           DFHEIV20,
  8015           DFHEIV99,
  8016           erpdef-key,
  8017           DFHEIV99,
  8018           DFHEIV99,
  8019           DFHEIV99
  8020     SET ADDRESS OF product-master TO
  8021         DFHEIV20
  8022     MOVE EIBRESP  TO ws-response
  8023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8024           if (resp-normal)
  8025              and (pd-control-primary (1:6) =
  8026                           erpdef-key-save (1:6))
  8027              continue
  8028           else
  8029              move er-8156       to emi-error
  8030              MOVE -1            TO PRODCDL
  8031              MOVE AL-UABON      TO PRODCDA
  8032              PERFORM 9900-ERROR-FORMAT
  8033                                 THRU  9900-EXIT
  8034           end-if
  8035        end-if
  8036     end-if
  8037     .
  8038 4110-CHECK-REMIT.
  8039     IF REMITL NOT GREATER ZEROS
  8040        MOVE 1                   TO REMITI
  8041        MOVE AL-UNNON            TO REMITA
  8042        GO TO 4120-REMIT-ERROR.
  8043
  8044     IF (REMITI NOT NUMERIC)  OR
  8045        (REMITI LESS 1 OR GREATER 10)
  8046           GO TO 4120-REMIT-ERROR.
  8047
  8048 4115-CHECK-AGENT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 153
* EL6501.cbl
  8049     SET M-INDEX                 TO REMITI.
  8050
  8051     IF AGENTL (M-INDEX)  NOT GREATER ZEROS
  8052        MOVE ER-2156             TO EMI-ERROR
  8053        GO TO 4120-R-ERROR.
  8054
  8055     GO TO 4130-CHECK-CONTRACT.
  8056
  8057 4120-REMIT-ERROR.
  8058     MOVE ER-2155                TO EMI-ERROR.
  8059
  8060 4120-R-ERROR.
  8061     MOVE -1                     TO REMITL.
  8062     MOVE AL-UABON               TO REMITA.
  8063     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8064
  8065 4130-CHECK-CONTRACT.
  8066     IF CONTRL NOT = ZEROS AND CONTRI NOT = SPACES
  8067        MOVE CONTRI                TO DEEDIT-FIELD
  8068        PERFORM 8600-DEEDIT
  8069        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8070        MOVE '4'                    TO DC-OPTION-CODE
  8071        PERFORM 9700-DATE-LINK
  8072        IF DATE-CONVERSION-ERROR
  8073           MOVE ER-2157             TO EMI-ERROR
  8074           MOVE -1                  TO CONTRL
  8075           MOVE AL-UABON            TO CONTRA
  8076           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8077        ELSE
  8078***  Y2K PROJ 7744
  8079           MOVE DC-GREG-DATE-1-EDIT TO CONTRI
  8080           MOVE AL-UANON            TO CONTRA
  8081           MOVE DC-GREG-DATE-1-YMD  TO WS-ANVR-DT
  8082           MOVE DC-ALPHA-CENTURY    TO WS-ANVR-DT(4:2)
  8083        END-IF
  8084     END-IF.
  8085***  Y2K PROJ 7744
  8086
  8087     IF PI-COMPANY-ID = 'DMD'
  8088       IF PI-MAINT = 'A'
  8089        IF CONTRL = ZERO
  8090           MOVE ER-0852             TO EMI-ERROR
  8091           MOVE -1                  TO CONTRL
  8092           MOVE AL-UABON            TO CONTRA
  8093           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8094
  8095*4131-CHECK-PSI-FACTOR.
  8096*    IF PSILFFL GREATER +0
  8097*       MOVE PSILFFI             TO DEEDIT-FIELD
  8098*       PERFORM 8600-DEEDIT
  8099*       IF DEEDIT-FIELD NUMERIC
  8100*          MOVE DEEDIT-FIELD-V5  TO WS-LIFE-PSI
  8101*                                   PSILFFO
  8102*       ELSE
  8103*          MOVE ER-9999          TO EMI-ERROR
  8104*          MOVE -1               TO PSILFFL
  8105*          MOVE AL-UABON         TO PSILFFA
  8106*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 154
* EL6501.cbl
  8107*
  8108*    IF PSIAHFL GREATER +0
  8109*       MOVE PSIAHFI             TO DEEDIT-FIELD
  8110*       PERFORM 8600-DEEDIT
  8111*       IF DEEDIT-FIELD NUMERIC
  8112*          MOVE DEEDIT-FIELD-V5  TO WS-AH-PSI
  8113*                                   PSIAHFO
  8114*       ELSE
  8115*          MOVE ER-9999          TO EMI-ERROR
  8116*          MOVE -1               TO PSIAHFL
  8117*          MOVE AL-UABON         TO PSIAHFA
  8118*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8119
  8120 4135-CHECK-PREVIOUS-DATES.
  8121     IF PEFFDTEL NOT = ZEROS AND PEFFDTEI NOT = SPACES
  8122        MOVE PEFFDTEI              TO DEEDIT-FIELD
  8123        PERFORM 8600-DEEDIT
  8124        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8125        MOVE '4'                    TO DC-OPTION-CODE
  8126        PERFORM 9700-DATE-LINK
  8127        IF DATE-CONVERSION-ERROR
  8128           MOVE ER-0348             TO EMI-ERROR
  8129           MOVE -1                  TO PEFFDTEL
  8130           MOVE AL-UABON            TO PEFFDTEA
  8131           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8132        ELSE
  8133***  Y2K PROJ 7744
  8134           MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEI
  8135           MOVE AL-UANON            TO PEFFDTEA
  8136           MOVE DC-GREG-DATE-1-YMD  TO WS-PEFF-DT
  8137           MOVE DC-ALPHA-CENTURY    TO WS-PEFF-DT(4:2)
  8138        END-IF
  8139     END-IF.
  8140
  8141     IF PEXPDTEL NOT = ZEROS AND PEXPDTEI NOT = SPACES
  8142        MOVE PEXPDTEI              TO DEEDIT-FIELD
  8143        PERFORM 8600-DEEDIT
  8144        IF DEEDIT-FIELD-V0 NOT LESS 999999
  8145           MOVE '99/99/99'             TO PEXPDTEO
  8146           MOVE 99999999999            TO WS-PEXP-DT
  8147           MOVE AL-UANON               TO PEXPDTEA
  8148        ELSE
  8149           MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8150           MOVE '4'                    TO DC-OPTION-CODE
  8151           PERFORM 9700-DATE-LINK
  8152           IF DATE-CONVERSION-ERROR
  8153              MOVE ER-0454             TO EMI-ERROR
  8154              MOVE -1                  TO PEXPDTEL
  8155              MOVE AL-UABON            TO PEXPDTEA
  8156              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8157           ELSE
  8158              MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEI
  8159              MOVE AL-UANON            TO PEXPDTEA
  8160              MOVE DC-GREG-DATE-1-YMD  TO WS-PEXP-DT
  8161              MOVE DC-ALPHA-CENTURY    TO WS-PEXP-DT(4:2)
  8162           END-IF
  8163        END-IF
  8164     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 155
* EL6501.cbl
  8165***  Y2K PROJ 7744
  8166
  8167     IF COMMCALL NOT GREATER ZEROS
  8168         GO TO 4150-CHECK-REINCAL.
  8169
  8170     IF (PI-COMPANY-ID = 'ADL' OR 'DEF') AND
  8171         (EFFCHG-SAVE LESS 841101)       AND
  8172         (COMMCALI = 'Y' OR '1')         AND
  8173         (NOT MODIFY-CAP)
  8174           MOVE -1               TO COMMCALL
  8175           MOVE AL-UABON         TO COMMCALA
  8176           MOVE ER-2189          TO EMI-ERROR
  8177           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8178
  8179     IF COMMCALI = 'Y' OR 'N' OR '1' OR ' '
  8180         GO TO 4150-CHECK-REINCAL.
  8181
  8182 4140-COMMCAL-ERROR.
  8183     MOVE -1                     TO COMMCALL.
  8184     MOVE AL-UABON               TO COMMCALA.
  8185     MOVE ER-2158                TO EMI-ERROR.
  8186     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8187
  8188 4150-CHECK-REINCAL.
  8189     IF REINCALL NOT GREATER ZEROS
  8190         GO TO 4170-CHECK-REINTAB.
  8191
  8192     IF REINCALI = 'Y' OR 'N'
  8193        GO TO 4170-CHECK-REINTAB.
  8194
  8195 4160-REINCAL-ERROR.
  8196     MOVE -1                     TO REINCALL.
  8197     MOVE AL-UABON               TO REINCALA.
  8198     MOVE ER-2179                TO EMI-ERROR.
  8199     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8200
  8201 4170-CHECK-REINTAB.
  8202     IF REINTABL NOT GREATER ZEROS
  8203        IF PI-COMPANY-ID = 'NCL' AND
  8204           MAINTI = 'A'
  8205                MOVE ER-4010         TO EMI-ERROR
  8206                MOVE -1              TO REINTABL
  8207                MOVE AL-UABON        TO REINTABA
  8208                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8209
  8210     IF REINTABL NOT GREATER ZEROS OR REINTABI = SPACES
  8211         GO TO 4410-CHECK-AGENTS.
  8212     IF PI-COMPANY-ID = 'CID'
  8213        IF PI-ACCT-STATE = 'KY'
  8214           IF REINTABI NOT = 'K98' AND 'K99' AND 'KYA'
  8215              MOVE -1            TO REINTABL
  8216              MOVE AL-UABON      TO REINTABA
  8217              MOVE ER-2159       TO EMI-ERROR
  8218              PERFORM 9900-ERROR-FORMAT
  8219                                 THRU 9900-EXIT
  8220           END-IF
  8221        END-IF
  8222     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 156
* EL6501.cbl
  8223     MOVE LOW-VALUES             TO REIN-KEY.
  8224
  8225     MOVE PI-COMPANY-CD          TO REIN-COMP-CD.
  8226     MOVE 'A'                    TO REIN-CODE.
  8227     MOVE REINTABI               TO REIN-TABLE.
  8228
  8229
  8230* EXEC CICS HANDLE CONDITION
  8231*        NOTFND   (4180-REIN-ERROR)
  8232*    END-EXEC.
  8233*    MOVE '"$I                   ! + #00007689' TO DFHEIV0
  8234     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8235     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8236     MOVE X'2B20233030303037363839' TO DFHEIV0(25:11)
  8237     CALL 'kxdfhei1' USING DFHEIV0
  8238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8239
  8240
  8241
  8242* EXEC CICS READ
  8243*        DATASET   (REIN-FILE-ID)
  8244*        SET       (ADDRESS OF REINSURANCE-RECORD)
  8245*        RIDFLD    (REIN-KEY)
  8246*    END-EXEC.
  8247*    MOVE '&"S        E          (   #00007693' TO DFHEIV0
  8248     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8249     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8250     MOVE X'2020233030303037363933' TO DFHEIV0(25:11)
  8251     CALL 'kxdfhei1' USING DFHEIV0,
  8252           REIN-FILE-ID,
  8253           DFHEIV20,
  8254           DFHEIV99,
  8255           REIN-KEY,
  8256           DFHEIV99,
  8257           DFHEIV99,
  8258           DFHEIV99
  8259     SET ADDRESS OF REINSURANCE-RECORD TO
  8260         DFHEIV20
  8261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8262
  8263
  8264     GO TO 4410-CHECK-AGENTS.
  8265
  8266 4180-REIN-ERROR.
  8267     MOVE -1                     TO REINTABL.
  8268     MOVE AL-UABON               TO REINTABA.
  8269     MOVE ER-2615                TO EMI-ERROR.
  8270     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8271
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 157
* EL6501.cbl
  8273 4410-CHECK-AGENTS.
  8274     MOVE PI-COMPANY-CD          TO COMM-COMP-CD.
  8275     SET M-INDEX TO 1.
  8276
  8277     IF PI-COMPANY-ID = 'NCL'
  8278       IF AGENTL (M-INDEX) GREATER ZEROS
  8279         MOVE PI-ACCT-ACCOUNT    TO AGENT  (M-INDEX).
  8280
  8281 4420-LOOP.
  8282     IF AGENTL (M-INDEX) NOT GREATER ZEROS
  8283        IF (ATYPEL (M-INDEX)  GREATER ZEROS AND
  8284            ATYPE  (M-INDEX) NOT = SPACES)  OR
  8285           SINGLEL (M-INDEX) GREATER ZEROS  OR
  8286           JOINTL  (M-INDEX) GREATER ZEROS  OR
  8287           A-HL    (M-INDEX) GREATER ZEROS  OR
  8288           RECALL  (M-INDEX) GREATER ZEROS  OR
  8289           RCOMML  (M-INDEX) GREATER ZEROS  OR
  8290           CHGBCKL (M-INDEX) GREATER ZEROS  OR
  8291           CCEL    (M-INDEX) GREATER ZEROS
  8292           MOVE ER-2172          TO EMI-ERROR
  8293           MOVE -1               TO AGENTL (M-INDEX)
  8294           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8295           GO TO 4450-BUMP-INDEX
  8296        else
  8297           go to 4430-check-single
  8298*       ELSE
  8299*          GO TO 4450-BUMP-INDEX.
  8300        end-if
  8301     end-if
  8302     IF AGENT (M-INDEX) = ZEROS
  8303         MOVE ER-2970            TO  EMI-ERROR
  8304         MOVE -1                 TO  AGENTL (M-INDEX)
  8305         MOVE AL-UABON           TO  AGENTA (M-INDEX)
  8306         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8307         GO TO 4450-BUMP-INDEX.
  8308
  8309     IF ATYPEL (M-INDEX) = ZEROS
  8310        MOVE -1                  TO ATYPEL (M-INDEX)
  8311        MOVE ER-2173             TO EMI-ERROR
  8312        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8313        GO TO 4430-CHECK-SINGLE.
  8314
  8315     IF ATYPE (M-INDEX) = 'C'
  8316        ADD 1                    TO WS-ACCOUNT-CTR-C
  8317       ELSE
  8318        IF ATYPE (M-INDEX) = 'R'
  8319           ADD 1                 TO WS-ACCOUNT-CTR-R
  8320          ELSE
  8321           IF ATYPE (M-INDEX) = 'D'
  8322              ADD 1                 TO WS-ACCOUNT-CTR-D
  8323             ELSE
  8324              IF ATYPE (M-INDEX) = 'O' OR 'P' OR 'T' OR 'W'
  8325                                OR 'B' OR 'I' OR 'K' OR 'L'
  8326                                OR 'J' OR 'M' OR 'A' OR 'N'
  8327                                OR 'S'
  8328                 NEXT SENTENCE
  8329                ELSE
  8330                 IF ATYPE (M-INDEX) = SPACES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 158
* EL6501.cbl
  8331                    NEXT SENTENCE
  8332                   ELSE
  8333                    MOVE ER-2175       TO EMI-ERROR
  8334                    MOVE -1            TO ATYPEL (M-INDEX)
  8335                    MOVE AL-UABON      TO ATYPEA (M-INDEX)
  8336                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8337
  8338 4430-CHECK-SINGLE.
  8339     IF SINGLEL (M-INDEX) GREATER ZEROS
  8340        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8341           MOVE SINGLE-COMM-T (M-INDEX)    TO COMM-TABLE
  8342           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8343           MOVE LOW-VALUES                 TO COMM-FILLER
  8344           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8345           IF COMMISSION-ERROR
  8346              MOVE AL-UABON      TO SINGLEA (M-INDEX)
  8347              MOVE -1            TO SINGLEL (M-INDEX)
  8348           ELSE
  8349              if cceind(m-index) <> 'Y'
  8350                 add ws-table-max to COMM-SL-ACCUM
  8351                 if atype (m-index) = 'C' or 'D'
  8352                    add ws-table-max to comm-sl-accum-al
  8353                 else
  8354                    if atype (m-index) = 'O' OR 'P'
  8355                       add ws-table-max to comm-sl-accum-gl
  8356                    end-if
  8357                 end-if
  8358              end-if
  8359           END-IF
  8360        END-IF
  8361     END-IF
  8362     IF JOINTL (M-INDEX) GREATER ZEROS
  8363        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8364           MOVE JOINT-COMM-T (M-INDEX) TO COMM-TABLE
  8365           MOVE PI-LIFE-OVERRIDE-L1    TO COMM-LF-AH
  8366           MOVE LOW-VALUES             TO COMM-FILLER
  8367           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8368           IF COMMISSION-ERROR
  8369              MOVE AL-UABON      TO JOINTA (M-INDEX)
  8370              MOVE -1            TO JOINTL (M-INDEX)
  8371           ELSE
  8372              if cceind(m-index) <> 'Y'
  8373                 add ws-table-max to COMM-JL-ACCUM
  8374                 if atype (m-index) = 'C' or 'D'
  8375                    add ws-table-max to comm-jl-accum-al
  8376                 else
  8377                    if atype (m-index) = 'O' OR 'P'
  8378                       add ws-table-max to comm-jl-accum-gl
  8379                 end-if
  8380              end-if
  8381           END-IF
  8382        END-IF
  8383     END-IF
  8384     IF A-HL (M-INDEX) GREATER ZEROS
  8385        IF A-H-COMM-R (M-INDEX)  NOT NUMERIC
  8386           MOVE A-H-COMM-T (M-INDEX)      TO COMM-TABLE
  8387           MOVE PI-AH-OVERRIDE-L1         TO COMM-LF-AH
  8388           MOVE LOW-VALUES                 TO COMM-FILLER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 159
* EL6501.cbl
  8389           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8390           IF COMMISSION-ERROR
  8391              MOVE AL-UABON      TO A-HA (M-INDEX)
  8392              MOVE -1            TO A-HL (M-INDEX)
  8393           ELSE
  8394              if cceind(m-index) <> 'Y'
  8395                 add ws-table-max to COMM-ah-ACCUM
  8396                 if atype (m-index) = 'C' or 'D'
  8397                    add ws-table-max to comm-ah-accum-al
  8398                 else
  8399                    if atype (m-index) = 'O' OR 'P'
  8400                       add ws-table-max to comm-ah-accum-gl
  8401                 end-if
  8402              end-if
  8403           END-IF
  8404        END-IF
  8405     END-IF
  8406     IF RECALL (M-INDEX) GREATER ZEROS
  8407         IF RECAL (M-INDEX) = 'Y' OR 'N' OR '1' OR SPACE
  8408             MOVE AL-UANON       TO RECALA (M-INDEX)
  8409         ELSE
  8410             MOVE -1             TO RECALL (M-INDEX)
  8411             MOVE AL-UABON       TO RECALA (M-INDEX)
  8412             MOVE ER-2158        TO EMI-ERROR
  8413             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8414
  8415     IF RCOMML (M-INDEX) GREATER ZEROS
  8416         IF RCOMM (M-INDEX) = 'Y' OR 'N' OR 'A' OR SPACE
  8417             MOVE AL-UANON       TO RCOMMA (M-INDEX)
  8418         ELSE
  8419             MOVE -1             TO RCOMML (M-INDEX)
  8420             MOVE AL-UABON       TO RCOMMA (M-INDEX)
  8421             MOVE ER-0625        TO EMI-ERROR
  8422             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8423
  8424     IF  CHGBCKL (M-INDEX)  GREATER THAN  ZEROS
  8425         IF  CHGBCK (M-INDEX)    NUMERIC
  8426             MOVE  AL-UNNON        TO  CHGBCKA (M-INDEX)
  8427         ELSE
  8428             MOVE  -1              TO  CHGBCKL (M-INDEX)
  8429             MOVE  AL-UNBON        TO  CHGBCKA (M-INDEX)
  8430             MOVE  ER-0759         TO  EMI-ERROR
  8431             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8432     IF CCEL (M-INDEX) <> ZEROS
  8433        IF CCEIND(M-INDEX) = 'Y'
  8434           MOVE AL-UANON         TO CCEA(M-INDEX)
  8435           IF ATYPE(M-INDEX) = 'C' OR 'D'
  8436              IF WS-COMM-CAP-LIMIT-TO <> 'A' AND 'B'
  8437                 MOVE  -1        TO CCEL (M-INDEX)
  8438                 MOVE  AL-UABON  TO CCEA (M-INDEX)
  8439                 MOVE  ER-3065   TO EMI-ERROR
  8440                 PERFORM  9900-ERROR-FORMAT
  8441                                 THRU 9900-EXIT
  8442              END-IF
  8443           ELSE
  8444              IF ATYPE(M-INDEX) = 'O' OR 'P'
  8445                 IF WS-COMM-CAP-LIMIT-TO <> 'G' AND 'B'
  8446                    MOVE  -1        TO CCEL (M-INDEX)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 160
* EL6501.cbl
  8447                    MOVE  AL-UABON  TO CCEA (M-INDEX)
  8448                    MOVE  ER-3065   TO EMI-ERROR
  8449                    PERFORM  9900-ERROR-FORMAT
  8450                                    THRU 9900-EXIT
  8451                 END-IF
  8452              END-IF
  8453           END-IF
  8454        ELSE
  8455           IF CCEIND (M-INDEX) = 'N' OR ' '
  8456              MOVE  AL-UANON        TO CCEA (M-INDEX)
  8457           ELSE
  8458              MOVE  -1              TO CCEL (M-INDEX)
  8459              MOVE  AL-UABON        TO CCEA (M-INDEX)
  8460              MOVE  ER-3066         TO EMI-ERROR
  8461              PERFORM  9900-ERROR-FORMAT
  8462                                 THRU 9900-EXIT
  8463           END-IF
  8464        END-IF
  8465     END-IF
  8466     IF ATYPE (M-INDEX) NOT = 'C' AND 'D' AND 'O' AND 'P'
  8467        AND 'J'
  8468         GO TO 4450-BUMP-INDEX.
  8469     IF SINGLE-COMM-R (M-INDEX) NUMERIC
  8470        if cceind(m-index) <> 'Y'
  8471           ADD SINGLE-COMM-R (M-INDEX) TO COMM-SL-ACCUM
  8472           if atype (m-index) = 'C' or 'D'
  8473              add SINGLE-COMM-R (M-INDEX) to comm-sl-accum-al
  8474           else
  8475              if atype (m-index) = 'O' or 'P'
  8476                 add single-comm-r (m-index) to comm-sl-accum-gl
  8477              end-if
  8478           end-if
  8479        end-if
  8480     else
  8481        display ' single comm r not numeric '
  8482     end-if
  8483
  8484     IF JOINT-COMM-R (M-INDEX) NUMERIC
  8485        if cceind(m-index) <> 'Y'
  8486           ADD JOINT-COMM-R (M-INDEX)  TO COMM-JL-ACCUM
  8487           if atype (m-index) = 'C' or 'D'
  8488              add JOINT-COMM-R (M-INDEX) to comm-jl-accum-al
  8489           else
  8490              if atype (m-index) = 'O' or 'P'
  8491                 add joint-comm-r (m-index) to comm-jl-accum-gl
  8492              end-if
  8493           end-if
  8494        end-if
  8495     end-if
  8496
  8497     IF A-H-COMM-R (M-INDEX) NUMERIC
  8498        if cceind(m-index) <> 'Y'
  8499           ADD A-H-COMM-R (M-INDEX)    TO COMM-AH-ACCUM
  8500           if atype (m-index) = 'C' or 'D'
  8501              add A-H-COMM-R (M-INDEX) to comm-ah-accum-al
  8502           else
  8503              if atype (m-index) = 'O' or 'P'
  8504                 add a-h-comm-r (m-index) to comm-ah-accum-gl
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 161
* EL6501.cbl
  8505              end-if
  8506           end-if
  8507        end-if
  8508     END-IF
  8509     .
  8510 4450-BUMP-INDEX.
  8511     SET M-INDEX UP BY 1.
  8512
  8513     IF M-INDEX NOT = 11
  8514        GO TO 4420-LOOP.
  8515
  8516     IF WS-ACCOUNT-CTR-C = ZEROS AND
  8517        WS-ACCOUNT-CTR-D = ZEROS AND
  8518        WS-ACCOUNT-CTR-R = ZEROS
  8519          MOVE ER-2177             TO EMI-ERROR
  8520          MOVE -1                  TO AGENTL (1)
  8521          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8522          GO TO 4900-EXIT.
  8523
  8524     IF (WS-ACCOUNT-CTR-C  GREATER 0 AND
  8525         WS-ACCOUNT-CTR-D  GREATER 0) OR
  8526        (WS-ACCOUNT-CTR-R  GREATER 0 AND
  8527         WS-ACCOUNT-CTR-D  GREATER 0)
  8528           MOVE ER-2174             TO EMI-ERROR
  8529           MOVE -1                  TO AGENTL (1)
  8530           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8531           GO TO 4900-EXIT.
  8532
  8533     IF WS-ACCOUNT-CTR-C GREATER 1 OR
  8534        WS-ACCOUNT-CTR-R GREATER 1 OR
  8535        WS-ACCOUNT-CTR-D GREATER 1
  8536          MOVE ER-2182             TO EMI-ERROR
  8537          MOVE -1                  TO AGENTL (1)
  8538          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8539          GO TO 4900-EXIT.
  8540
  8541
  8542     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  8543        MOVE ZEROS               TO WS-ST-COMM-CAP-SL
  8544     end-if
  8545     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  8546        MOVE ZEROS               TO WS-ST-COMM-CAP-JL
  8547     END-IF
  8548     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  8549        MOVE ZEROS               TO WS-ST-COMM-CAP-SA
  8550     END-IF
  8551
  8552     if ws-st-comm-cap-sl = zeros
  8553        continue
  8554     else
  8555        if comm-sl-accum-al numeric
  8556           if (comm-sl-accum-al > ws-st-comm-cap-sl)
  8557              MOVE -1         TO MAINTL
  8558              MOVE ER-1955    TO EMI-ERROR
  8559              PERFORM 9900-ERROR-FORMAT
  8560                              THRU 9900-EXIT
  8561           end-if
  8562        end-if
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 162
* EL6501.cbl
  8563     end-if
  8564
  8565     if ws-st-comm-cap-jl = zeros
  8566        continue
  8567     else
  8568        if comm-jl-accum-al numeric
  8569           if (comm-jl-accum-al > ws-st-comm-cap-jl)
  8570              MOVE -1         TO MAINTL
  8571              MOVE ER-1956    TO EMI-ERROR
  8572              PERFORM 9900-ERROR-FORMAT
  8573                              THRU 9900-EXIT
  8574           end-if
  8575        end-if
  8576     end-if
  8577
  8578     if ws-st-comm-cap-sa = zeros
  8579        continue
  8580     else
  8581        if comm-ah-accum-al numeric
  8582           if (comm-ah-accum-al > ws-st-comm-cap-sa)
  8583              MOVE -1         TO MAINTL
  8584              MOVE ER-1957    TO EMI-ERROR
  8585              PERFORM 9900-ERROR-FORMAT
  8586                              THRU 9900-EXIT
  8587           end-if
  8588        end-if
  8589     end-if
  8590     if ws-st-ga-comm-cap-sl = zeros
  8591        continue
  8592     else
  8593        if comm-sl-accum-gl numeric
  8594           if (comm-sl-accum-gl > ws-st-ga-comm-cap-sl)
  8595              MOVE -1         TO MAINTL
  8596              MOVE ER-1958    TO EMI-ERROR
  8597              PERFORM 9900-ERROR-FORMAT
  8598                              THRU 9900-EXIT
  8599           end-if
  8600        end-if
  8601     end-if
  8602
  8603     if ws-st-ga-comm-cap-jl = zeros
  8604        continue
  8605     else
  8606        if comm-jl-accum-gl numeric
  8607           if (comm-jl-accum-gl > ws-st-ga-comm-cap-jl)
  8608              MOVE -1         TO MAINTL
  8609              MOVE ER-1959    TO EMI-ERROR
  8610              PERFORM 9900-ERROR-FORMAT
  8611                              THRU 9900-EXIT
  8612           end-if
  8613        end-if
  8614     end-if
  8615
  8616     if ws-st-ga-comm-cap-sa = zeros
  8617        continue
  8618     else
  8619        if comm-ah-accum-gl numeric
  8620           if (comm-ah-accum-gl > ws-st-ga-comm-cap-sa)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 163
* EL6501.cbl
  8621              MOVE -1         TO MAINTL
  8622              MOVE ER-1960    TO EMI-ERROR
  8623              PERFORM 9900-ERROR-FORMAT
  8624                              THRU 9900-EXIT
  8625           end-if
  8626        end-if
  8627     end-if
  8628     if ws-st-tot-comm-cap-sl = zeros
  8629        continue
  8630     else
  8631        if comm-sl-accum numeric
  8632           if (comm-sl-accum > ws-st-tot-comm-cap-sl)
  8633              MOVE -1         TO MAINTL
  8634              MOVE ER-1961    TO EMI-ERROR
  8635              PERFORM 9900-ERROR-FORMAT
  8636                              THRU 9900-EXIT
  8637           end-if
  8638        end-if
  8639     end-if
  8640
  8641     if ws-st-tot-comm-cap-jl = zeros
  8642        continue
  8643     else
  8644        if comm-jl-accum numeric
  8645           if (comm-jl-accum > ws-st-tot-comm-cap-jl)
  8646              MOVE -1         TO MAINTL
  8647              MOVE ER-1962    TO EMI-ERROR
  8648              PERFORM 9900-ERROR-FORMAT
  8649                              THRU 9900-EXIT
  8650           end-if
  8651        end-if
  8652     end-if
  8653
  8654     if ws-st-tot-comm-cap-sa = zeros
  8655        continue
  8656     else
  8657        if comm-ah-accum numeric
  8658           if (comm-ah-accum > ws-st-tot-comm-cap-sa)
  8659              MOVE -1         TO MAINTL
  8660              MOVE ER-1963    TO EMI-ERROR
  8661              PERFORM 9900-ERROR-FORMAT
  8662                              THRU 9900-EXIT
  8663           end-if
  8664        end-if
  8665     end-if
  8666     IF MAINTI NOT = 'C'
  8667        GO TO 4900-EXIT.
  8668
  8669     IF NOT PI-GA-BILLING
  8670        GO TO 4900-EXIT.
  8671
  8672 4460-CHECK-IF-GA-BILLED.
  8673     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  8674
  8675     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  8676     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  8677     SET M-INDEX TO +1.
  8678     MOVE +1 TO AXRF-SUB.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 164
* EL6501.cbl
  8679
  8680 4470-GA-LOOP.
  8681     IF ((AGENT (M-INDEX) NOT = WK-AM-AGT (AXRF-SUB)  OR
  8682        ATYPE  (M-INDEX) NOT = WK-AM-TYPE (AXRF-SUB)) OR
  8683        SINGLEL (M-INDEX) GREATER ZERO                OR
  8684        JOINTL  (M-INDEX) GREATER ZERO                OR
  8685        A-HL    (M-INDEX) GREATER ZERO                OR
  8686        RCOMML  (M-INDEX) GREATER ZERO                OR
  8687        CHGBCKL (M-INDEX) GREATER ZERO                OR
  8688        CCEL    (M-INDEX) GREATER ZERO)               AND
  8689        (WK-GA-BILL-DT (AXRF-SUB) NOT = LOW-VALUES AND SPACES)
  8690           MOVE ER-2131   TO EMI-ERROR
  8691           MOVE -1        TO AGENTL (M-INDEX)
  8692           MOVE AL-UABON  TO AGENTA (M-INDEX)
  8693           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8694
  8695     ADD +1 TO AXRF-SUB.
  8696     SET M-INDEX UP BY +1.
  8697
  8698     IF AXRF-SUB NOT = +11
  8699        GO TO 4470-GA-LOOP.
  8700
  8701 4900-EXIT.
  8702      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 165
* EL6501.cbl
  8704 5000-MOVE-TO-RECORD.
  8705
  8706     IF NAMEL   GREATER THAN ZERO  OR
  8707        INCAREL GREATER THAN ZERO  OR
  8708        ADDR1L  GREATER THAN ZERO  OR
  8709        ACITYL  GREATER THAN ZERO  OR
  8710        ASTATEL GREATER THAN ZERO  OR
  8711        ZIPL    GREATER THAN ZERO  OR
  8712        PHONEL  GREATER THAN ZERO  OR
  8713        TAXNOL  GREATER THAN ZERO
  8714         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  8715
  8716     IF CSRL GREATER ZEROS
  8717        MOVE CSRI                TO AM-CSR-CODE.
  8718     IF NAMEL GREATER ZEROS
  8719        MOVE NAMEI               TO AM-NAME.
  8720     IF PCONTL GREATER ZEROS
  8721        MOVE PCONTI              TO AM-CONTROL-NAME
  8722     END-IF
  8723     IF INCAREL GREATER ZEROS
  8724        MOVE INCAREI             TO AM-PERSON.
  8725     IF ADDR1L GREATER ZEROS
  8726        MOVE ADDR1I              TO AM-ADDRS.
  8727     IF TAXNOL GREATER ZEROS
  8728        MOVE TAXNOI              TO AM-ID-NO.
  8729     IF PHONEL GREATER ZEROS
  8730        MOVE PHONEI              TO DEEDIT-FIELD
  8731        PERFORM 8600-DEEDIT
  8732        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  8733        MOVE WS-PH1              TO AM-AREA-CODE
  8734        MOVE WS-PH2              TO AM-TEL-PRE
  8735        MOVE WS-PH3              TO AM-TEL-NBR.
  8736
  8737     IF ACITYL GREATER ZEROS
  8738        MOVE ACITYI             TO AM-ADDR-CITY.
  8739     IF ASTATEL GREATER ZEROS
  8740        MOVE ASTATEI            TO AM-ADDR-STATE.
  8741
  8742     IF ZIPL NOT GREATER ZEROS
  8743         GO TO 5010-CONT-MOVING.
  8744
  8745     MOVE ZIPI                   TO WS-ZIP-CODE.
  8746
  8747     IF WS-CANADIAN-ZIP
  8748         IF WS-ZIP-4 = SPACE  OR  '-'
  8749             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  8750             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  8751         ELSE
  8752             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  8753             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  8754     ELSE
  8755         IF WS-ZIP-6 = SPACE  OR  '-'
  8756             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  8757             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  8758         ELSE
  8759             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  8760             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  8761
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 166
* EL6501.cbl
  8762 5010-CONT-MOVING.
  8763     IF TYPEL GREATER ZEROS
  8764        MOVE TYPEI               TO AM-GPCD.
  8765
  8766     IF STDBENL GREATER ZEROS
  8767        MOVE STDBENI             TO AM-STD-AH-TYPE.
  8768
  8769     IF INDGRPL GREATER ZEROS
  8770        MOVE INDGRPI             TO AM-IG
  8771        INSPECT AM-IG CONVERTING 'IG' TO '12'.
  8772
  8773     IF STATUSL GREATER ZEROS
  8774        MOVE STATUSI             TO AM-STATUS
  8775*       INSPECT AM-STATUS CONVERTING 'SFCTIA' TO '543210'
  8776        INSPECT AM-STATUS CONVERTING 'PRLDSFCTIA' TO '9876543210'
  8777     END-IF
  8778
  8779     IF CLPTOLPL GREATER ZEROS
  8780        MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  8781     END-IF.
  8782
  8783     IF PRODCDL > 0
  8784        MOVE PRODCDI             TO AM-DCC-PRODUCT-CODE
  8785     END-IF
  8786     IF CLPSTL > 0
  8787        MOVE CLPSTI              TO AM-DCC-CLP-STATE
  8788     END-IF
  8789     IF MAXMFEEL > ZEROS
  8790        MOVE WS-WORK-NUM         TO AM-DCC-MAX-MARKETING-FEE
  8791     END-IF
  8792     IF LCOMML > ZEROS
  8793        MOVE LCOMMI              TO AM-SPP-LEASE-COMM
  8794     END-IF
  8795
  8796     IF REMITL GREATER ZEROS
  8797        MOVE REMITI              TO AM-REMIT-TO.
  8798     IF CONTRL GREATER ZEROS
  8799        MOVE WS-ANVR-DT          TO AM-ANNIVERSARY-DATE.
  8800*    IF PSILFFL GREATER +0
  8801*       MOVE WS-LIFE-PSI         TO AM-LF-PSI-FACTOR.
  8802*    IF PSIAHFL GREATER +0
  8803*       MOVE WS-AH-PSI           TO AM-AH-PSI-FACTOR.
  8804     IF PEFFDTEL GREATER ZEROS
  8805        MOVE WS-PEFF-DT          TO AM-PREV-EFF-DT.
  8806     IF PEXPDTEL GREATER ZEROS
  8807        MOVE WS-PEXP-DT          TO AM-PREV-EXP-DT.
  8808     IF COMMCALL GREATER ZEROS
  8809        MOVE COMMCALI            TO AM-RECALC-COMM
  8810        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8811     ELSE
  8812         IF MAINTI = 'A'
  8813             MOVE 'N'            TO AM-RECALC-COMM.
  8814
  8815     IF REINCALL GREATER ZEROS
  8816        MOVE REINCALI            TO AM-RECALC-REIN
  8817     ELSE
  8818         IF MAINTI = 'A'
  8819             MOVE 'N'            TO AM-RECALC-REIN.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 167
* EL6501.cbl
  8820
  8821     IF REINTABL GREATER ZEROS
  8822        MOVE REINTABI            TO AM-REI-TABLE.
  8823
  8824     IF PI-MAINT = 'A'
  8825        MOVE 'P'                 TO AM-RET-ST-TAX-USE
  8826     END-IF
  8827
  8828     MOVE 1                      TO SUB.
  8829     SET M-INDEX                 TO 1.
  8830
  8831
  8832* EXEC CICS
  8833*         ASKTIME
  8834*    END-EXEC.
  8835*    MOVE '0"                    "   #00008266' TO DFHEIV0
  8836     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  8837     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  8838     MOVE X'2020233030303038323636' TO DFHEIV0(25:11)
  8839     CALL 'kxdfhei1' USING DFHEIV0,
  8840           DFHEIV99
  8841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8842
  8843
  8844 5000-LOOP.
  8845*    IF PI-COMPANY-ID = 'DCC'
  8846*       IF (M-INDEX = +5)
  8847*          AND ((AGENTL (5) > ZEROS)
  8848*              OR (ATYPEL (5) > ZEROS))
  8849*             MOVE ER-3057         TO EMI-ERROR
  8850*             MOVE -1              TO AGENTL (5)
  8851*             MOVE AL-UABON        TO AGENTA (5)
  8852*             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8853*             GO TO 5000-EXIT
  8854*       END-IF
  8855*    END-IF
  8856     IF MAINTI = 'C'
  8857        IF ((AM-AGT (SUB) NOT = ZEROS AND AGENT (M-INDEX)) AND
  8858           (COMMCALI NOT = 'Y' AND '1')                    AND
  8859            AM-HI-CERT-DATE NOT = ZEROS)                    OR
  8860           ((AM-AGT (SUB) = ZEROS AND
  8861             (AGENT (M-INDEX)) NOT = LOW-VALUES AND SPACES AND
  8862                                     ZEROS) AND
  8863           (COMMCALI NOT = 'Y' AND '1')  AND
  8864            AM-HI-CERT-DATE NOT = ZEROS)
  8865              MOVE ER-2181         TO EMI-ERROR
  8866              MOVE -1              TO COMMCALL
  8867              MOVE AL-UABON        TO COMMCALA
  8868              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8869              GO TO 5000-EXIT.
  8870
  8871     IF MAINTI = 'C'
  8872        IF ((AM-COM-TYP (SUB) NOT = SPACES AND
  8873             ATYPE (M-INDEX)) AND
  8874           (COMMCALI NOT = 'Y' AND '1') AND
  8875            AM-HI-CERT-DATE NOT = ZEROS)
  8876            OR
  8877           ((AM-COM-TYP (SUB) = SPACES AND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 168
* EL6501.cbl
  8878             (ATYPE (M-INDEX)) NOT = LOW-VALUES AND SPACES) AND
  8879           (COMMCALI NOT = 'Y' AND '1')  AND
  8880            AM-HI-CERT-DATE NOT = ZEROS)
  8881              MOVE ER-2181         TO EMI-ERROR
  8882              MOVE -1              TO COMMCALL
  8883              MOVE AL-UABON        TO COMMCALA
  8884              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8885              GO TO 5000-EXIT.
  8886
  8887     IF AM-ACCOUNT-BILLED
  8888        IF COMMCALI = 'Y' OR '1'
  8889            MOVE ER-2183         TO EMI-ERROR
  8890            MOVE -1              TO COMMCALL
  8891            MOVE AL-UABON        TO COMMCALA
  8892            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8893            GO TO 5000-EXIT.
  8894
  8895     IF (AGENTL (M-INDEX) NOT GREATER ZEROS AND
  8896        ATYPEL  (M-INDEX) NOT GREATER ZEROS)
  8897        OR
  8898        ((AGENT (M-INDEX) = ZEROS OR SPACES) AND
  8899         ATYPE  (M-INDEX) = SPACES)
  8900           MOVE ZEROS              TO AM-AGT   (SUB)
  8901                                      AM-L-COM (SUB)
  8902                                      AM-J-COM (SUB)
  8903                                      AM-A-COM (SUB)
  8904           MOVE SPACE TO AM-COM-TYP (SUB)
  8905           SET M-INDEX UP BY 1
  8906           ADD 1 TO SUB
  8907           IF SUB = 11
  8908              GO TO 5000-CHECK-MAX-FEES
  8909            ELSE
  8910              GO TO 5000-LOOP.
  8911
  8912     MOVE AGENT (M-INDEX)        TO AM-AGT (SUB).
  8913     MOVE ATYPE (M-INDEX)        TO AM-COM-TYP (SUB).
  8914
  8915     IF SINGLEL (M-INDEX) GREATER ZEROS
  8916        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8917        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8918           MOVE SINGLE-COMM-T (M-INDEX) TO AM-L-COMA (SUB)
  8919          ELSE
  8920           MOVE SINGLE-COMM-R (M-INDEX) TO AM-L-COM  (SUB)
  8921           IF SINGLE-DASH (M-INDEX) = '-'
  8922               MULTIPLY AM-L-COM (SUB) BY -1
  8923                     GIVING AM-L-COM (SUB).
  8924
  8925     IF JOINTL (M-INDEX) GREATER ZEROS
  8926        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8927        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8928           MOVE JOINT-COMM-T (M-INDEX)  TO AM-J-COMA (SUB)
  8929          ELSE
  8930           MOVE JOINT-COMM-R (M-INDEX)  TO AM-J-COM (SUB)
  8931           IF JOINT-DASH (M-INDEX) = '-'
  8932               MULTIPLY AM-J-COM (SUB) BY -1
  8933                     GIVING AM-J-COM (SUB).
  8934
  8935     IF A-HL (M-INDEX) GREATER ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 169
* EL6501.cbl
  8936        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8937        IF A-H-COMM-R (M-INDEX) NOT NUMERIC
  8938           MOVE A-H-COMM-T (M-INDEX)  TO AM-A-COMA (SUB)
  8939          ELSE
  8940           MOVE A-H-COMM-R (M-INDEX)  TO AM-A-COM (SUB)
  8941           IF A-H-DASH (M-INDEX) = '-'
  8942               MULTIPLY AM-A-COM (SUB) BY -1
  8943                     GIVING AM-A-COM (SUB).
  8944
  8945     IF RECALL (M-INDEX) GREATER ZEROS
  8946         MOVE RECAL  (M-INDEX)   TO AM-RECALC-LV-INDIC (SUB).
  8947
  8948     IF RCOMML (M-INDEX) GREATER ZEROS
  8949         MOVE RCOMM  (M-INDEX)   TO AM-RETRO-LV-INDIC (SUB).
  8950
  8951     IF CHGBCKL (M-INDEX) GREATER ZEROS
  8952         MOVE CHGBCK (M-INDEX)   TO AM-COMM-CHARGEBACK (SUB).
  8953
  8954     IF CCEL (M-INDEX) GREATER ZEROS
  8955         MOVE CCEIND (M-INDEX)   TO AM-GL-CODES (SUB).
  8956
  8957     SET M-INDEX UP BY 1.
  8958     ADD 1 TO SUB.
  8959     IF M-INDEX NOT = 11
  8960        GO TO 5000-LOOP.
  8961
  8962 5000-CHECK-MAX-FEES.
  8963     IF (AM-DCC-PRODUCT-CODE = 'DDF')
  8964        MOVE +1                     TO S1
  8965        PERFORM UNTIL S1 > +10
  8966           IF (AM-A-COM (S1) NUMERIC)
  8967              AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M'
  8968                     AND 'O')
  8969              AND (AM-COM-TYP (S1) = 'J')
  8970                 COMPUTE COMM-MFEE-ACCUM = COMM-MFEE-ACCUM
  8971                    + (AM-A-COM (S1) * +1000)
  8972           END-IF
  8973           ADD +1             TO S1
  8974        END-PERFORM
  8975        IF COMM-MFEE-ACCUM > AM-DCC-MAX-MARKETING-FEE
  8976           MOVE -1               TO MAXMFEEL
  8977           MOVE AL-UABON         TO MAXMFEEA
  8978           MOVE ER-1817          TO EMI-ERROR
  8979           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8980        END-IF
  8981     END-IF
  8982     .
  8983 5000-EXIT.
  8984      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 170
* EL6501.cbl
  8986
  8987 5100-WRITE-TS.
  8988     PERFORM 6500-READ-ACCT THRU 6599-EXIT.
  8989
  8990     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  8991         MOVE ZEROS              TO PI-CR-CARRIER
  8992     ELSE
  8993         MOVE AM-CARRIER         TO PI-CR-CARRIER.
  8994
  8995     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  8996         MOVE ZEROS              TO PI-CR-GROUPING
  8997     ELSE
  8998         MOVE AM-GROUPING        TO PI-CR-GROUPING.
  8999
  9000     IF AM-REMIT-TO NOT = ZERO
  9001         MOVE AM-AGT (AM-REMIT-TO)
  9002                                 TO PI-CR-FIN-RESP
  9003       ELSE
  9004         MOVE AM-ACCOUNT         TO PI-CR-FIN-RESP.
  9005
  9006     MOVE 'A'                    TO PI-CR-TYPE.
  9007 5110-AGT-LOOP.
  9008     ADD 1                       TO  AGT-SUB.
  9009     IF AGT-SUB GREATER 10
  9010         MOVE LOW-VALUES         TO PI-CR-CONTROL-IN-PROGRESS
  9011         GO TO 5120-WRITE.
  9012
  9013************************************************************
  9014**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  9015************************************************************
  9016
  9017     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'R'
  9018                  OR 'F' OR 'U'
  9019         MOVE AM-AGT (AGT-SUB)   TO  PI-CR-ACCOUNT
  9020         GO TO 5120-WRITE
  9021     ELSE
  9022         GO TO 5110-AGT-LOOP.
  9023
  9024 5120-WRITE.
  9025
  9026* EXEC CICS WRITEQ TS
  9027*         QUEUE    (QID)
  9028*         FROM     (PROGRAM-INTERFACE-BLOCK)
  9029*         LENGTH   (WS-COMM-LENGTH)
  9030*         ITEM     (W-ONE)
  9031*    END-EXEC.
  9032*    MOVE '*" I   L              ''   #00008451' TO DFHEIV0
  9033     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
  9034     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9035     MOVE X'2020233030303038343531' TO DFHEIV0(25:11)
  9036     CALL 'kxdfhei1' USING DFHEIV0,
  9037           QID,
  9038           PROGRAM-INTERFACE-BLOCK,
  9039           WS-COMM-LENGTH,
  9040           W-ONE,
  9041           DFHEIV99,
  9042           DFHEIV99
  9043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 171
* EL6501.cbl
  9044
  9045
  9046 5199-EXIT.
  9047     EXIT.
  9048
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 172
* EL6501.cbl
  9050
  9051 5200-RECOVER-TS.
  9052
  9053     IF PI-CALLING-PROGRAM NOT = XCTL-652 AND
  9054                                 XCTL-653 AND
  9055                                 XCTL-689 AND
  9056                                 XCTL-608 AND
  9057                                 XCTL-690
  9058         GO TO 5299-EXIT.
  9059
  9060
  9061* EXEC CICS HANDLE CONDITION
  9062*        QIDERR  (5250-QID-ERROR)
  9063*    END-EXEC.
  9064*    MOVE '"$N                   ! , #00008472' TO DFHEIV0
  9065     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9066     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9067     MOVE X'2C20233030303038343732' TO DFHEIV0(25:11)
  9068     CALL 'kxdfhei1' USING DFHEIV0
  9069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9070
  9071
  9072
  9073* EXEC CICS READQ TS
  9074*        QUEUE    (QID)
  9075*        INTO     (PROGRAM-INTERFACE-BLOCK)
  9076*        LENGTH   (WS-COMM-LENGTH)
  9077*        ITEM     (W-ONE)
  9078*    END-EXEC.
  9079*    MOVE '*$II   L              ''   #00008476' TO DFHEIV0
  9080     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  9081     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9082     MOVE X'2020233030303038343736' TO DFHEIV0(25:11)
  9083     CALL 'kxdfhei1' USING DFHEIV0,
  9084           QID,
  9085           PROGRAM-INTERFACE-BLOCK,
  9086           WS-COMM-LENGTH,
  9087           W-ONE,
  9088           DFHEIV99,
  9089           DFHEIV99
  9090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9091
  9092
  9093 5200-DELETE-TS.
  9094
  9095
  9096* EXEC CICS DELETEQ TS
  9097*        QUEUE    (QID)
  9098*    END-EXEC.
  9099*    MOVE '*&                    #   #00008485' TO DFHEIV0
  9100     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9101     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9102     MOVE X'2020233030303038343835' TO DFHEIV0(25:11)
  9103     CALL 'kxdfhei1' USING DFHEIV0,
  9104           QID,
  9105           DFHEIV99
  9106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9107
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 173
* EL6501.cbl
  9108
  9109     GO TO 5299-EXIT.
  9110
  9111 5250-QID-ERROR.
  9112     MOVE ER-0033                TO  EMI-ERROR.
  9113     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9114
  9115 5299-EXIT.
  9116     EXIT.
  9117
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 174
* EL6501.cbl
  9119
  9120 5300-UPDATE-REQUEST-FILE.
  9121     MOVE +0                     TO SUB1.
  9122
  9123 5300-FIND-ACCOUNT-AGENT.
  9124     ADD +1                      TO SUB1.
  9125
  9126     IF SUB1 GREATER THAN +10
  9127        MOVE ER-2949             TO EMI-ERROR
  9128        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9129        MOVE -1                  TO AGENTL (1)
  9130
  9131* EXEC CICS SYNCPOINT ROLLBACK
  9132*       END-EXEC
  9133*    MOVE '6"R                   !   #00008510' TO DFHEIV0
  9134     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  9135     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9136     MOVE X'2020233030303038353130' TO DFHEIV0(25:11)
  9137     CALL 'kxdfhei1' USING DFHEIV0
  9138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9139        GO TO 8200-SEND-DATAONLY.
  9140
  9141     MOVE SAVE-ACCT-AGENT      TO SAVE-NEW-ACCT-AGENT.
  9142
  9143************************************************************
  9144**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  9145************************************************************
  9146
  9147     IF AM-COM-TYP  (SUB1) = 'C' OR 'D' OR 'F'
  9148        IF AM-AGT   (SUB1) NOT = SAVE-ACCT-AGENT
  9149           MOVE AM-AGT (SUB1)  TO SAVE-NEW-ACCT-AGENT.
  9150
  9151     IF AM-AGT (AM-REMIT-TO) NOT = SAVE-FIN-RESP
  9152        GO TO 5325-PROCESS-RQST-FILE.
  9153
  9154     IF SAVE-ACCT-AGENT NOT = SAVE-NEW-ACCT-AGENT
  9155        GO TO 5325-PROCESS-RQST-FILE.
  9156
  9157     GO TO 5399-EXIT.
  9158
  9159 5325-PROCESS-RQST-FILE.
  9160     MOVE LOW-VALUES             TO RQST3-KEY.
  9161     MOVE AM-COMPANY-CD          TO RQST3-COMPANY-CD.
  9162     MOVE AM-CARRIER             TO RQST3-CARRIER.
  9163     MOVE AM-GROUPING            TO RQST3-GROUPING.
  9164     MOVE SAVE-FIN-RESP          TO RQST3-FIN-RESP.
  9165     MOVE SAVE-ACCT-AGENT        TO RQST3-ACCT-AGENT.
  9166
  9167
  9168* EXEC CICS HANDLE CONDITION
  9169*        NOTFND(5399-EXIT)
  9170*        ENDFILE(5399-EXIT)
  9171*    END-EXEC.
  9172*    MOVE '"$I''                  ! - #00008540' TO DFHEIV0
  9173     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9174     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9175     MOVE X'2D20233030303038353430' TO DFHEIV0(25:11)
  9176     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 175
* EL6501.cbl
  9177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9178
  9179
  9180 5325-PROCESS-REQUEST-FILE.
  9181
  9182* EXEC CICS STARTBR
  9183*         DATASET   (RQST3-FILE-ID)
  9184*         RIDFLD    (RQST3-KEY)
  9185*    END-EXEC.
  9186     MOVE 0
  9187       TO DFHEIV11
  9188*    MOVE '&,         G          &   #00008546' TO DFHEIV0
  9189     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9190     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9191     MOVE X'2020233030303038353436' TO DFHEIV0(25:11)
  9192     CALL 'kxdfhei1' USING DFHEIV0,
  9193           RQST3-FILE-ID,
  9194           RQST3-KEY,
  9195           DFHEIV99,
  9196           DFHEIV11,
  9197           DFHEIV99
  9198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9199
  9200
  9201 5330-READNEXT-REQUEST.
  9202
  9203* EXEC CICS READNEXT
  9204*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9205*        DATASET(RQST3-FILE-ID)
  9206*        RIDFLD (RQST3-KEY)
  9207*    END-EXEC.
  9208     MOVE 0
  9209       TO DFHEIV11
  9210*    MOVE '&.S                   )   #00008552' TO DFHEIV0
  9211     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9212     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9213     MOVE X'2020233030303038353532' TO DFHEIV0(25:11)
  9214     CALL 'kxdfhei1' USING DFHEIV0,
  9215           RQST3-FILE-ID,
  9216           DFHEIV20,
  9217           DFHEIV99,
  9218           RQST3-KEY,
  9219           DFHEIV99,
  9220           DFHEIV11,
  9221           DFHEIV99,
  9222           DFHEIV99
  9223     SET ADDRESS OF AR-REQUEST-RECORD TO
  9224         DFHEIV20
  9225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9226
  9227
  9228     IF RQST3-KEY = SAVE-RQST3-KEY
  9229        GO TO 5330-READNEXT-REQUEST.
  9230
  9231     MOVE RQST3-KEY              TO SAVE-RQST3-KEY.
  9232
  9233     IF RQ-COMPANY-CD-A2 NOT = PI-COMPANY-CD
  9234        GO TO 5350-REQUESTS-FINISHED.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 176
* EL6501.cbl
  9235
  9236     IF RQ-FIN-RESP-A2 NOT = SAVE-FIN-RESP
  9237        GO TO 5350-REQUESTS-FINISHED.
  9238
  9239     IF RQ-ACCT-AGENT-A2 NOT = SAVE-ACCT-AGENT
  9240        GO TO 5350-REQUESTS-FINISHED.
  9241
  9242     MOVE RQ-CONTROL-PRIMARY     TO RQST-KEY.
  9243
  9244
  9245* EXEC CICS ENDBR
  9246*        DATASET(RQST3-FILE-ID)
  9247*    END-EXEC.
  9248     MOVE 0
  9249       TO DFHEIV11
  9250*    MOVE '&2                    $   #00008574' TO DFHEIV0
  9251     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9252     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9253     MOVE X'2020233030303038353734' TO DFHEIV0(25:11)
  9254     CALL 'kxdfhei1' USING DFHEIV0,
  9255           RQST3-FILE-ID,
  9256           DFHEIV11,
  9257           DFHEIV99
  9258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9259
  9260
  9261
  9262* EXEC CICS READ
  9263*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9264*        DATASET(RQST-FILE-ID)
  9265*        RIDFLD (RQST-KEY)
  9266*        UPDATE
  9267*    END-EXEC.
  9268*    MOVE '&"S        EU         (   #00008578' TO DFHEIV0
  9269     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9270     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9271     MOVE X'2020233030303038353738' TO DFHEIV0(25:11)
  9272     CALL 'kxdfhei1' USING DFHEIV0,
  9273           RQST-FILE-ID,
  9274           DFHEIV20,
  9275           DFHEIV99,
  9276           RQST-KEY,
  9277           DFHEIV99,
  9278           DFHEIV99,
  9279           DFHEIV99
  9280     SET ADDRESS OF AR-REQUEST-RECORD TO
  9281         DFHEIV20
  9282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9283
  9284
  9285     MOVE AM-AGT (AM-REMIT-TO)   TO RQ-FIN-RESP-A2.
  9286     MOVE SAVE-NEW-ACCT-AGENT    TO RQ-ACCT-AGENT-A2.
  9287
  9288
  9289* EXEC CICS REWRITE
  9290*        DATASET   (RQST-FILE-ID)
  9291*        FROM      (AR-REQUEST-RECORD)
  9292*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 177
* EL6501.cbl
  9293     MOVE LENGTH OF
  9294      AR-REQUEST-RECORD
  9295       TO DFHEIV11
  9296*    MOVE '&& L                  %   #00008588' TO DFHEIV0
  9297     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9298     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9299     MOVE X'2020233030303038353838' TO DFHEIV0(25:11)
  9300     CALL 'kxdfhei1' USING DFHEIV0,
  9301           RQST-FILE-ID,
  9302           AR-REQUEST-RECORD,
  9303           DFHEIV11,
  9304           DFHEIV99
  9305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9306
  9307
  9308     GO TO  5325-PROCESS-REQUEST-FILE.
  9309
  9310 5350-REQUESTS-FINISHED.
  9311
  9312* EXEC CICS ENDBR
  9313*        DATASET(RQST3-FILE-ID)
  9314*    END-EXEC.
  9315     MOVE 0
  9316       TO DFHEIV11
  9317*    MOVE '&2                    $   #00008596' TO DFHEIV0
  9318     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9319     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9320     MOVE X'2020233030303038353936' TO DFHEIV0(25:11)
  9321     CALL 'kxdfhei1' USING DFHEIV0,
  9322           RQST3-FILE-ID,
  9323           DFHEIV11,
  9324           DFHEIV99
  9325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9326
  9327
  9328 5399-EXIT.
  9329     EXIT.
  9330
  9331
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 178
* EL6501.cbl
  9333
  9334 6000-MOVE-TO-SCREEN.
  9335     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  9336
  9337     MOVE AM-LAST-MAINT-USER     TO MAINTBYO.
  9338     MOVE AM-NAME                TO NAMEO.
  9339     MOVE AM-CONTROL-NAME        TO PCONTO.
  9340     MOVE AM-CSR-CODE            TO CSRO.
  9341     MOVE AM-PERSON              TO INCAREO.
  9342     MOVE AM-ADDRS               TO ADDR1O.
  9343     MOVE AM-ID-NO               TO TAXNOO.
  9344     MOVE AM-TEL-NO              TO WS-PHONE.
  9345     MOVE WS-PHONE-NUM           TO PHONEO.
  9346     INSPECT PHONEI CONVERTING SPACES TO '-'.
  9347     MOVE AM-ADDR-CITY           TO ACITYO
  9348     MOVE AM-ADDR-STATE          TO ASTATEO
  9349
  9350     MOVE SPACES                 TO WS-ZIP-CODE.
  9351     IF AM-CANADIAN-POST-CODE
  9352         MOVE AM-CAN-POSTAL-1    TO WS-ZIP-CAN-2-POST1
  9353         MOVE AM-CAN-POSTAL-2    TO WS-ZIP-CAN-2-POST2
  9354     ELSE
  9355         MOVE AM-ZIP-PRIME       TO WS-ZIP-AM-2-CODE
  9356         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9357             MOVE '-'            TO WS-ZIP-AM-2-DASH
  9358             MOVE AM-ZIP-PLUS4   TO WS-ZIP-AM-2-PLUS4.
  9359
  9360     MOVE WS-ZIP-CODE            TO ZIPO.
  9361
  9362     MOVE AM-GPCD                TO TYPEO.
  9363     MOVE AM-STD-AH-TYPE         TO STDBENO.
  9364
  9365     MOVE AM-IG                  TO INDGRPO.
  9366     INSPECT INDGRPO CONVERTING '12' TO 'IG'.
  9367
  9368     MOVE AM-STATUS              TO STATUSO.
  9369*    INSPECT STATUSO CONVERTING '543210' TO 'SFCTIA'
  9370     INSPECT STATUSO CONVERTING '9876543210' TO 'PRLDSFCTIA'
  9371
  9372     MOVE AM-REMIT-TO            TO REMITO.
  9373
  9374     IF PI-AR-PROCESSING
  9375        IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9376           MOVE AL-UNNON         TO REMITA
  9377        ELSE
  9378           MOVE AL-SANON         TO REMITA
  9379     ELSE
  9380        MOVE AL-UNNON            TO REMITA.
  9381
  9382***  Y2K PROJ 7744
  9383     MOVE AM-ANNIVERSARY-DATE    TO DC-GREG-DATE-1-YMD.
  9384     MOVE '3'                    TO DC-OPTION-CODE.
  9385     PERFORM 9700-DATE-LINK.
  9386     IF DATE-CONVERSION-ERROR
  9387        MOVE SPACES              TO CONTRO
  9388     ELSE
  9389        MOVE DC-GREG-DATE-1-EDIT TO CONTRO
  9390     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 179
* EL6501.cbl
  9391***  Y2K PROJ 7744
  9392
  9393*    MOVE PI-LIFE-OVERRIDE-L6    TO PSILFTO
  9394*    MOVE PI-AH-OVERRIDE-L6      TO PSIAHTO.
  9395
  9396*    IF AM-LF-PSI-FACTOR NUMERIC
  9397*       MOVE AM-LF-PSI-FACTOR    TO PSILFFO.
  9398*
  9399*    IF AM-AH-PSI-FACTOR NUMERIC
  9400*       MOVE AM-AH-PSI-FACTOR    TO PSIAHFO.
  9401
  9402     MOVE AM-RECALC-COMM         TO COMMCALO.
  9403     MOVE AL-UANON               TO COMMCALA.
  9404     MOVE AM-RECALC-REIN         TO REINCALO.
  9405     MOVE AM-REI-TABLE           TO REINTABO.
  9406     MOVE AM-1ST-PROD-DATE       TO DC-GREG-DATE-1-YMD.
  9407     MOVE '3'                    TO DC-OPTION-CODE.
  9408     PERFORM 9700-DATE-LINK.
  9409     IF DATE-CONVERSION-ERROR
  9410        MOVE SPACES              TO PRODATEO
  9411     ELSE
  9412        MOVE DC-GREG-DATE-1-EDIT TO PRODATEO.
  9413
  9414     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  9415        IF AM-CLP-TOL-PCT NOT NUMERIC
  9416           MOVE ZEROS            TO AM-CLP-TOL-PCT
  9417        END-IF
  9418        IF AM-SPP-LEASE-COMM NOT NUMERIC
  9419           MOVE ZEROS            TO AM-SPP-LEASE-COMM
  9420        END-IF
  9421        MOVE AM-CLP-TOL-PCT      TO CLPTOLPO
  9422        MOVE AM-SPP-LEASE-COMM   TO LCOMMO
  9423        MOVE AM-DCC-PRODUCT-CODE TO PRODCDO
  9424        MOVE AM-DCC-CLP-STATE    TO CLPSTO
  9425        MOVE AL-UANON            TO CLPSTA
  9426        IF AM-DCC-MAX-MARKETING-FEE NOT NUMERIC
  9427           MOVE ZEROS            TO AM-DCC-MAX-MARKETING-FEE
  9428        END-IF
  9429        MOVE AM-DCC-MAX-MARKETING-FEE
  9430                                 TO MAXMFEEO
  9431     ELSE
  9432        MOVE AL-SADOF            TO CTPLABLA
  9433                                    CLPTOLPA
  9434                                    LCLABLA
  9435                                    LCOMMA
  9436     END-IF
  9437
  9438     IF AM-RET-Y-N = ' '  OR  'N'
  9439         MOVE 'NO '              TO RETROCDO
  9440     ELSE
  9441         MOVE 'YES'              TO RETROCDO.
  9442
  9443     IF AM-ACCOUNT-BILLED
  9444         MOVE 'YES'              TO BILLCDO
  9445     ELSE
  9446         MOVE 'NO '              TO BILLCDO.
  9447
  9448     MOVE AL-UANON               TO RETROCDA.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 180
* EL6501.cbl
  9449     MOVE AL-SANON               TO PRODATEA
  9450                                    BILLCDA.
  9451     MOVE AM-PREV-EFF-DT TO DC-GREG-DATE-1-YMD.
  9452     MOVE '3' TO DC-OPTION-CODE.
  9453     PERFORM 9700-DATE-LINK.
  9454     IF DATE-CONVERSION-ERROR
  9455        MOVE SPACES TO PEFFDTEO
  9456     ELSE
  9457        MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEO.
  9458
  9459     IF AM-PREV-EXP-DT NOT = 99999999999
  9460        MOVE AM-PREV-EXP-DT TO DC-GREG-DATE-1-YMD
  9461        MOVE '3' TO DC-OPTION-CODE
  9462        PERFORM 9700-DATE-LINK
  9463        IF DATE-CONVERSION-ERROR
  9464           MOVE SPACES TO PEXPDTEO
  9465        ELSE
  9466           MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEO
  9467     ELSE
  9468        MOVE '99/99/99' TO PEXPDTEO.
  9469
  9470     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  9471        MOVE AL-UANON            TO PEXPDTEA
  9472                                    PEFFDTEA
  9473        MOVE AL-SANOF TO            PDSPLYA.
  9474
  9475     MOVE LOW-VALUES             TO MAP-AGENT-AREA.
  9476     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  9477     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9478
  9479     MOVE 1  TO SUB.
  9480     SET M-INDEX TO 1.
  9481
  9482 6005-LOOP.
  9483     IF AM-AGT (SUB) = SPACES  OR ZEROS
  9484        IF PI-AR-PROCESSING
  9485           IF AM-AR-HI-CERT-DATE GREATER THAN LOW-VALUES
  9486              MOVE AL-SANOF     TO AGENTA  (M-INDEX)
  9487                                   ATYPEA (M-INDEX)
  9488                                   SINGLEA (M-INDEX)
  9489                                   JOINTA (M-INDEX)
  9490                                   A-HA    (M-INDEX)
  9491              GO TO 6010-BUMP-SUB
  9492           ELSE
  9493              GO TO 6010-BUMP-SUB
  9494        ELSE
  9495           GO TO 6010-BUMP-SUB.
  9496
  9497     MOVE AM-AGT (SUB)           TO AGENT (M-INDEX).
  9498
  9499***DMD CUSTOM CODE - CAPTURE THE FIRST AGENT TO BE DISPLAYED
  9500     IF WS-DMD-AGENT = LOW-VALUES
  9501        MOVE AM-AGT (SUB)        TO WS-DMD-AGENT.
  9502***DMD ******************************************************
  9503
  9504     IF PI-GA-BILLING
  9505        MOVE AM-AGT (SUB)        TO WK-AM-AGT (SUB).
  9506     MOVE AL-UANON               TO AGENTA (M-INDEX).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 181
* EL6501.cbl
  9507
  9508     MOVE AM-COM-TYP (SUB)       TO ATYPE (M-INDEX).
  9509     IF PI-GA-BILLING
  9510        MOVE AM-COM-TYP (SUB)    TO WK-AM-TYPE (SUB).
  9511     MOVE AL-UANON               TO ATYPEA (M-INDEX).
  9512
  9513     IF (AM-L-COM (SUB) NOT NUMERIC)
  9514        OR (AM-L-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9515        MOVE AM-L-COMA (SUB)     TO SINGLE-COMM-T (M-INDEX)
  9516     ELSE
  9517        IF AM-L-COM (SUB) NOT = ZEROS
  9518           MOVE AM-L-COM  (SUB)  TO SINGLE-COMM-O (M-INDEX).
  9519     move al-uanon to singlea (m-index)
  9520
  9521     IF (AM-J-COM (SUB) NOT NUMERIC)
  9522        OR (AM-J-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9523        MOVE AM-J-COMA (SUB)     TO JOINT-COMM-T (M-INDEX)
  9524     ELSE
  9525        IF AM-J-COM (SUB) NOT = ZEROS
  9526           MOVE AM-J-COM  (SUB)  TO JOINT-COMM-O (M-INDEX).
  9527     move al-uanon to jointa (m-index)
  9528
  9529     IF (AM-A-COM (SUB) NOT NUMERIC)
  9530        OR (AM-A-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9531        MOVE AM-A-COMA (SUB)     TO A-H-COMM-T (M-INDEX)
  9532     ELSE
  9533        IF AM-A-COM (SUB) NOT = ZEROS
  9534           MOVE AM-A-COM  (SUB)  TO A-H-COMM-O (M-INDEX).
  9535     move al-uanon to a-ha (m-index)
  9536
  9537************************************************************
  9538**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  9539************************************************************
  9540
  9541     IF (AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'O' AND 'P'
  9542            AND 'F' AND 'S' AND 'G' AND 'B' AND 'I'
  9543            AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N')
  9544         GO TO 6006-CONTINUE.
  9545     .
  9546 6006-CONTINUE.
  9547     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  9548        MOVE ZEROS               TO WS-ST-COMM-CAP-SL
  9549     end-if
  9550     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  9551        MOVE ZEROS               TO WS-ST-COMM-CAP-JL
  9552     end-if
  9553     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  9554        MOVE ZEROS               TO WS-ST-COMM-CAP-SA
  9555     end-if
  9556     IF (AM-L-COM (SUB) NUMERIC)
  9557        AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9558        if am-gl-codes(sub) <> 'Y'
  9559           ADD AM-L-COM (SUB)    TO COMM-SL-ACCUM
  9560           if am-com-typ (sub) = 'C' or 'D'
  9561              ADD AM-L-COM (SUB) TO COMM-SL-ACCUM-al
  9562           else
  9563              if am-com-typ (sub) = 'O' or 'P'
  9564                 add am-l-com (sub) to comm-sl-accum-gl
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 182
* EL6501.cbl
  9565              end-if
  9566           end-if
  9567        end-if
  9568     ELSE
  9569        MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9570        MOVE AM-L-COMA (SUB)  TO COMM-TABLE
  9571        MOVE PI-LIFE-OVERRIDE-L1
  9572                              TO COMM-LF-AH
  9573        MOVE LOW-VALUES       TO COMM-FILLER
  9574        PERFORM 6400-READ-COMMISSION
  9575                              THRU 6459-EXIT
  9576        if am-gl-codes(sub) <> 'Y'
  9577           add ws-table-max         to COMM-SL-ACCUM
  9578           if atype (m-index) = 'C' or 'D'
  9579              add ws-table-max to comm-sl-accum-al
  9580           else
  9581              if atype (m-index) = 'O' or 'P'
  9582                 add ws-table-max to comm-sl-accum-gl
  9583              end-if
  9584           end-if
  9585        end-if
  9586     END-IF
  9587     IF (AM-J-COM (SUB) NUMERIC)
  9588        AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9589        if am-gl-codes(sub) <> 'Y'
  9590           ADD AM-J-COM (SUB)    TO COMM-JL-ACCUM
  9591           if am-com-typ (sub) = 'C' or 'D'
  9592              ADD AM-J-COM (SUB) TO COMM-JL-ACCUM-al
  9593           else
  9594              if am-com-typ (sub) = 'O' or 'P'
  9595                 add am-J-com (sub) to comm-Jl-accum-gl
  9596              end-if
  9597           end-if
  9598        end-if
  9599     ELSE
  9600        MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9601        MOVE AM-J-COMA (SUB)  TO COMM-TABLE
  9602        MOVE PI-LIFE-OVERRIDE-L1
  9603                              TO COMM-LF-AH
  9604        MOVE LOW-VALUES       TO COMM-FILLER
  9605        PERFORM 6400-READ-COMMISSION
  9606                              THRU 6459-EXIT
  9607        if am-gl-codes(sub) <> 'Y'
  9608           add ws-table-max to COMM-JL-ACCUM
  9609           if atype (m-index) = 'C' or 'D'
  9610              add ws-table-max to comm-jl-accum-al
  9611           else
  9612              if atype (m-index) = 'O' or 'P'
  9613                 add ws-table-max to comm-jl-accum-gl
  9614              end-if
  9615           end-if
  9616        end-if
  9617     END-IF
  9618     IF (AM-A-COM (SUB) NUMERIC)
  9619        AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9620        if am-gl-codes(sub) <> 'Y'
  9621           ADD AM-A-COM (SUB)    TO COMM-AH-ACCUM
  9622           if am-com-typ (sub) = 'C' or 'D'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 183
* EL6501.cbl
  9623              ADD AM-A-COM (SUB) TO COMM-AH-ACCUM-al
  9624           else
  9625              if am-com-typ (sub) = 'O' or 'P'
  9626                 add am-a-com (sub) to comm-AH-accum-gl
  9627              end-if
  9628           end-if
  9629        end-if
  9630     ELSE
  9631        MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9632        MOVE AM-A-COMA (SUB)  TO COMM-TABLE
  9633        MOVE PI-AH-OVERRIDE-L1
  9634                              TO COMM-LF-AH
  9635        MOVE LOW-VALUES       TO COMM-FILLER
  9636        PERFORM 6400-READ-COMMISSION
  9637                              THRU 6459-EXIT
  9638        if am-gl-codes(sub) <> 'Y'
  9639           add ws-table-max to COMM-AH-ACCUM
  9640           if atype (m-index) = 'C' or 'D'
  9641              add ws-table-max to comm-AH-accum-al
  9642           else
  9643              if atype (m-index) = 'O' or 'P'
  9644                 add ws-table-max to comm-ah-accum-gl
  9645              end-if
  9646           end-if
  9647        end-if
  9648     END-IF
  9649
  9650
  9651     IF AM-RECALC-LV-INDIC (SUB) NOT = SPACE
  9652         MOVE AM-RECALC-LV-INDIC (SUB) TO RECAL (M-INDEX).
  9653
  9654     IF AM-RETRO-LV-INDIC (SUB) NOT = SPACE
  9655         MOVE AM-RETRO-LV-INDIC (SUB) TO RCOMM (M-INDEX).
  9656
  9657     IF AM-COMM-CHARGEBACK (SUB)  NUMERIC
  9658        NEXT SENTENCE
  9659     ELSE
  9660        MOVE ZEROS              TO  AM-COMM-CHARGEBACK (SUB).
  9661
  9662     IF AM-COMM-CHARGEBACK (SUB)   NOT  =    ZEROS
  9663         MOVE AM-COMM-CHARGEBACK (SUB) TO CHGBCK (M-INDEX).
  9664     IF AM-GL-CODES (SUB) = 'Y'
  9665        MOVE AM-GL-CODES (SUB)   TO CCEIND (M-INDEX)
  9666        MOVE AL-UANON            TO CCEA   (M-INDEX)
  9667     ELSE
  9668        MOVE 'N'                 TO CCEIND (M-INDEX)
  9669     END-IF
  9670     if am-gl-codes(sub) = 'Y'
  9671        if ((am-com-typ(sub) = 'C' OR 'D')
  9672           and (WS-COMM-CAP-LIMIT-TO not = 'A' AND 'B'))
  9673                            or
  9674           ((am-com-typ(sub) = 'O' or 'P')
  9675           and (ws-comm-cap-limit-to not = 'G' AND 'B'))
  9676           move er-3065       to emi-error
  9677           move -1            to maintl
  9678           perform 9900-error-format
  9679                                 thru 9900-exit
  9680        end-if
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 184
* EL6501.cbl
  9681     end-if
  9682     IF AM-GL-CODES (SUB)   NOT  =    ZEROS
  9683         MOVE AM-GL-CODES (SUB)  TO  CCEIND (M-INDEX).
  9684
  9685     IF NOT PI-AR-PROCESSING
  9686        GO TO 6010-BUMP-SUB.
  9687
  9688     IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9689        GO TO 6010-BUMP-SUB.
  9690
  9691     MOVE AL-SANON              TO AGENTA  (M-INDEX)
  9692                                   ATYPEA  (M-INDEX)
  9693                                   SINGLEA (M-INDEX)
  9694                                   JOINTA  (M-INDEX)
  9695                                   A-HA    (M-INDEX).
  9696
  9697 6010-BUMP-SUB.
  9698     ADD 1  TO SUB.
  9699     SET M-INDEX UP BY 1.
  9700     IF SUB LESS 11
  9701        GO TO 6005-LOOP.
  9702     if ws-st-comm-cap-sl = zeros
  9703        continue
  9704     else
  9705        if comm-sl-accum-al > ws-st-comm-cap-sl
  9706           MOVE -1               TO MAINTL
  9707           MOVE ER-1955          TO EMI-ERROR
  9708           PERFORM 9900-ERROR-FORMAT
  9709                                 THRU 9900-EXIT
  9710        end-if
  9711     end-if
  9712
  9713     if ws-st-comm-cap-jl = zeros
  9714        continue
  9715     else
  9716        if comm-jl-accum-al > ws-st-comm-cap-jl
  9717           MOVE -1               TO MAINTL
  9718           MOVE ER-1956          TO EMI-ERROR
  9719           PERFORM 9900-ERROR-FORMAT
  9720                                 THRU 9900-EXIT
  9721        end-if
  9722     end-if
  9723
  9724     if ws-st-comm-cap-sa = zeros
  9725        continue
  9726     else
  9727        if comm-ah-accum-al > ws-st-comm-cap-sa
  9728           MOVE -1               TO MAINTL
  9729           MOVE ER-1957          TO EMI-ERROR
  9730           PERFORM 9900-ERROR-FORMAT
  9731                                 THRU 9900-EXIT
  9732        end-if
  9733     end-if
  9734
  9735
  9736     if ws-st-ga-comm-cap-sl = zeros
  9737        continue
  9738     else
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 185
* EL6501.cbl
  9739        if comm-sl-accum-gl > ws-st-ga-comm-cap-sl
  9740           MOVE -1               TO MAINTL
  9741           MOVE ER-1958          TO EMI-ERROR
  9742           PERFORM 9900-ERROR-FORMAT
  9743                                 THRU 9900-EXIT
  9744        end-if
  9745     end-if
  9746
  9747     if ws-st-ga-comm-cap-jl = zeros
  9748        continue
  9749     else
  9750        if comm-jl-accum-gl > ws-st-ga-comm-cap-jl
  9751           MOVE -1               TO MAINTL
  9752           MOVE ER-1959          TO EMI-ERROR
  9753           PERFORM 9900-ERROR-FORMAT
  9754                                 THRU 9900-EXIT
  9755        end-if
  9756     end-if
  9757
  9758     if ws-st-ga-comm-cap-sa = zeros
  9759        continue
  9760     else
  9761        if comm-ah-accum-gl > ws-st-ga-comm-cap-sa
  9762           MOVE -1               TO MAINTL
  9763           MOVE ER-1960          TO EMI-ERROR
  9764           PERFORM 9900-ERROR-FORMAT
  9765                                 THRU 9900-EXIT
  9766        end-if
  9767     end-if
  9768
  9769     if ws-st-tot-comm-cap-sl = zeros
  9770        continue
  9771     else
  9772        if comm-sl-accum > ws-st-tot-comm-cap-sl
  9773           MOVE -1                  TO MAINTL
  9774           MOVE ER-1961             TO EMI-ERROR
  9775           PERFORM 9900-ERROR-FORMAT
  9776                                    THRU 9900-EXIT
  9777        end-if
  9778     end-if
  9779
  9780     if ws-st-tot-comm-cap-jl = zeros
  9781        continue
  9782     else
  9783        if comm-jl-accum > ws-st-tot-comm-cap-jl
  9784           MOVE -1                  TO MAINTL
  9785           MOVE ER-1962             TO EMI-ERROR
  9786           PERFORM 9900-ERROR-FORMAT
  9787                                    THRU 9900-EXIT
  9788        end-if
  9789     end-if
  9790
  9791     if ws-st-tot-comm-cap-sa = zeros
  9792        continue
  9793     else
  9794        if comm-ah-accum > ws-st-tot-comm-cap-sa
  9795           MOVE -1                  TO MAINTL
  9796           MOVE ER-1963             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 186
* EL6501.cbl
  9797           PERFORM 9900-ERROR-FORMAT
  9798                                    THRU 9900-EXIT
  9799        end-if
  9800     end-if
  9801     .
  9802 6099-EXIT.
  9803      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 187
* EL6501.cbl
  9805 6300-STARTBR.
  9806
  9807* EXEC CICS STARTBR
  9808*         DATASET   (ACCT-FILE-ID)
  9809*         RIDFLD    (WS-KEY-SAVE)
  9810*    END-EXEC.
  9811     MOVE 0
  9812       TO DFHEIV11
  9813*    MOVE '&,         G          &   #00009078' TO DFHEIV0
  9814     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9815     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9816     MOVE X'2020233030303039303738' TO DFHEIV0(25:11)
  9817     CALL 'kxdfhei1' USING DFHEIV0,
  9818           ACCT-FILE-ID,
  9819           WS-KEY-SAVE,
  9820           DFHEIV99,
  9821           DFHEIV11,
  9822           DFHEIV99
  9823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9824
  9825
  9826     MOVE 'Y'                    TO BROWSE-STARTED-SW.
  9827
  9828 6300-EXIT.
  9829      EXIT.
  9830
  9831 6310-READNEXT.
  9832
  9833* EXEC CICS READNEXT
  9834*         DATASET    (ACCT-FILE-ID)
  9835*         SET        (ADDRESS OF ACCOUNT-MASTER)
  9836*         RIDFLD     (WS-KEY-SAVE)
  9837*    END-EXEC.
  9838     MOVE 0
  9839       TO DFHEIV11
  9840*    MOVE '&.S                   )   #00009089' TO DFHEIV0
  9841     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9842     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9843     MOVE X'2020233030303039303839' TO DFHEIV0(25:11)
  9844     CALL 'kxdfhei1' USING DFHEIV0,
  9845           ACCT-FILE-ID,
  9846           DFHEIV20,
  9847           DFHEIV99,
  9848           WS-KEY-SAVE,
  9849           DFHEIV99,
  9850           DFHEIV11,
  9851           DFHEIV99,
  9852           DFHEIV99
  9853     SET ADDRESS OF ACCOUNT-MASTER TO
  9854         DFHEIV20
  9855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9856
  9857
  9858 6310-EXIT.
  9859      EXIT.
  9860
  9861 6320-ENDBR.
  9862     MOVE SPACE               TO BROWSE-STARTED-SW.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 188
* EL6501.cbl
  9863
  9864* EXEC CICS ENDBR
  9865*        DATASET(ACCT-FILE-ID)
  9866*    END-EXEC.
  9867     MOVE 0
  9868       TO DFHEIV11
  9869*    MOVE '&2                    $   #00009100' TO DFHEIV0
  9870     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9871     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9872     MOVE X'2020233030303039313030' TO DFHEIV0(25:11)
  9873     CALL 'kxdfhei1' USING DFHEIV0,
  9874           ACCT-FILE-ID,
  9875           DFHEIV11,
  9876           DFHEIV99
  9877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9878
  9879
  9880 6320-EXIT.
  9881      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 189
* EL6501.cbl
  9883 6400-READ-COMMISSION.
  9884     MOVE ZEROS                  TO WS-COMM-ERROR-SW
  9885
  9886* EXEC CICS HANDLE CONDITION
  9887*         NOTFND   (6450-NOT-FOUND)
  9888*    END-EXEC
  9889*    MOVE '"$I                   ! . #00009109' TO DFHEIV0
  9890     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9891     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9892     MOVE X'2E20233030303039313039' TO DFHEIV0(25:11)
  9893     CALL 'kxdfhei1' USING DFHEIV0
  9894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9895
  9896
  9897* EXEC CICS READ
  9898*        GTEQ
  9899*        DATASET   (COMM-FILE-ID)
  9900*        SET       (ADDRESS OF COMM-TABLE-RECORD)
  9901*        RIDFLD    (COMM-KEY)
  9902*    END-EXEC
  9903*    MOVE '&"S        G          (   #00009113' TO DFHEIV0
  9904     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9906     MOVE X'2020233030303039313133' TO DFHEIV0(25:11)
  9907     CALL 'kxdfhei1' USING DFHEIV0,
  9908           COMM-FILE-ID,
  9909           DFHEIV20,
  9910           DFHEIV99,
  9911           COMM-KEY,
  9912           DFHEIV99,
  9913           DFHEIV99,
  9914           DFHEIV99
  9915     SET ADDRESS OF COMM-TABLE-RECORD TO
  9916         DFHEIV20
  9917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9918
  9919     IF CT-COMPANY-CD = PI-COMPANY-CD AND
  9920        CT-TABLE      = COMM-TABLE    AND
  9921        CT-BEN-TYPE   = COMM-LF-AH
  9922        PERFORM 6460-CHECK-MAX THRU 6460-EXIT
  9923        GO TO 6459-EXIT
  9924     END-IF
  9925     .
  9926 6450-NOT-FOUND.
  9927     MOVE ER-2176                TO EMI-ERROR.
  9928     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9929     MOVE 1  TO WS-COMM-ERROR-SW.
  9930
  9931 6459-EXIT.
  9932      EXIT.
  9933
  9934 6460-CHECK-MAX.
  9935
  9936
  9937* EXEC CICS STARTBR
  9938*         DATASET   (COMM-FILE-ID)
  9939*         RIDFLD    (COMM-KEY)
  9940*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 190
* EL6501.cbl
  9941*    END-EXEC
  9942     MOVE 0
  9943       TO DFHEIV11
  9944*    MOVE '&,         G          &  N#00009137' TO DFHEIV0
  9945     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9946     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9947     MOVE X'204E233030303039313337' TO DFHEIV0(25:11)
  9948     CALL 'kxdfhei1' USING DFHEIV0,
  9949           COMM-FILE-ID,
  9950           COMM-KEY,
  9951           DFHEIV99,
  9952           DFHEIV11,
  9953           DFHEIV99
  9954     MOVE EIBRESP  TO WS-RESPONSE
  9955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9956
  9957     MOVE SPACES          TO WS-STATE-MAX-SW
  9958
  9959     IF RESP-NORMAL
  9960        MOVE LOW-VALUES          TO COMM-FILLER
  9961        MOVE COMM-KEY            TO WS-HOLD-COMM-KEY
  9962        MOVE ZEROS               TO WS-TABLE-MAX
  9963        PERFORM UNTIL
  9964              (NOT RESP-NORMAL) OR
  9965              (COMM-KEY (1:5) NOT = WS-HOLD-COMM-KEY (1:5))
  9966
  9967* EXEC CICS READNEXT
  9968*             DATASET   (COMM-FILE-ID)
  9969*             SET       (ADDRESS OF COMM-TABLE-RECORD)
  9970*             RIDFLD    (COMM-KEY)
  9971*             RESP      (WS-RESPONSE)
  9972*           END-EXEC
  9973     MOVE 0
  9974       TO DFHEIV11
  9975*    MOVE '&.S                   )  N#00009152' TO DFHEIV0
  9976     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9977     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9978     MOVE X'204E233030303039313532' TO DFHEIV0(25:11)
  9979     CALL 'kxdfhei1' USING DFHEIV0,
  9980           COMM-FILE-ID,
  9981           DFHEIV20,
  9982           DFHEIV99,
  9983           COMM-KEY,
  9984           DFHEIV99,
  9985           DFHEIV11,
  9986           DFHEIV99,
  9987           DFHEIV99
  9988     SET ADDRESS OF COMM-TABLE-RECORD TO
  9989         DFHEIV20
  9990     MOVE EIBRESP  TO WS-RESPONSE
  9991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9992            IF (RESP-NORMAL) AND
  9993               (COMM-KEY (1:5) = WS-HOLD-COMM-KEY (1:5))
  9994               PERFORM VARYING WS-NDX FROM +1 BY +1 UNTIL
  9995                   (WS-NDX > +27)
  9996                   IF CT-RT (WS-NDX) > WS-TABLE-MAX
  9997                      MOVE CT-RT (WS-NDX)
  9998                                 TO WS-TABLE-MAX
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 191
* EL6501.cbl
  9999                   END-IF
 10000               END-PERFORM
 10001            END-IF
 10002        END-PERFORM
 10003
 10004* EXEC CICS ENDBR
 10005*            DATASET   (COMM-FILE-ID)
 10006*       END-EXEC
 10007     MOVE 0
 10008       TO DFHEIV11
 10009*    MOVE '&2                    $   #00009169' TO DFHEIV0
 10010     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10011     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10012     MOVE X'2020233030303039313639' TO DFHEIV0(25:11)
 10013     CALL 'kxdfhei1' USING DFHEIV0,
 10014           COMM-FILE-ID,
 10015           DFHEIV11,
 10016           DFHEIV99
 10017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10018     END-IF
 10019
 10020     .
 10021 6460-EXIT.
 10022      EXIT.
 10023
 10024
 10025 6500-READ-ACCT.
 10026
 10027* EXEC CICS READ
 10028*        GTEQ
 10029*        DATASET   (ACCT-FILE-ID)
 10030*        SET       (ADDRESS OF ACCOUNT-MASTER)
 10031*        RIDFLD    (PI-ACCT-KEY)
 10032*    END-EXEC.
 10033*    MOVE '&"S        G          (   #00009180' TO DFHEIV0
 10034     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10035     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10036     MOVE X'2020233030303039313830' TO DFHEIV0(25:11)
 10037     CALL 'kxdfhei1' USING DFHEIV0,
 10038           ACCT-FILE-ID,
 10039           DFHEIV20,
 10040           DFHEIV99,
 10041           PI-ACCT-KEY,
 10042           DFHEIV99,
 10043           DFHEIV99,
 10044           DFHEIV99
 10045     SET ADDRESS OF ACCOUNT-MASTER TO
 10046         DFHEIV20
 10047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10048
 10049
 10050 6599-EXIT.
 10051      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 192
* EL6501.cbl
 10053 6600-UPDATE-MAINT-DT.
 10054     MOVE SPACES                 TO ELCNTL-KEY.
 10055
 10056     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10057     MOVE '1'                    TO CNTL-REC-TYPE.
 10058     MOVE +0                     TO CNTL-SEQ-NO.
 10059
 10060
 10061* EXEC CICS HANDLE CONDITION
 10062*        NOTFND   (6699-EXIT)
 10063*    END-EXEC.
 10064*    MOVE '"$I                   ! / #00009197' TO DFHEIV0
 10065     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10066     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10067     MOVE X'2F20233030303039313937' TO DFHEIV0(25:11)
 10068     CALL 'kxdfhei1' USING DFHEIV0
 10069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10070
 10071
 10072
 10073* EXEC CICS READ
 10074*        UPDATE
 10075*        DATASET   (CNTL-FILE-ID)
 10076*        SET       (ADDRESS OF CONTROL-FILE)
 10077*        RIDFLD    (ELCNTL-KEY)
 10078*    END-EXEC.
 10079*    MOVE '&"S        EU         (   #00009201' TO DFHEIV0
 10080     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10081     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10082     MOVE X'2020233030303039323031' TO DFHEIV0(25:11)
 10083     CALL 'kxdfhei1' USING DFHEIV0,
 10084           CNTL-FILE-ID,
 10085           DFHEIV20,
 10086           DFHEIV99,
 10087           ELCNTL-KEY,
 10088           DFHEIV99,
 10089           DFHEIV99,
 10090           DFHEIV99
 10091     SET ADDRESS OF CONTROL-FILE TO
 10092         DFHEIV20
 10093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10094
 10095
 10096     MOVE BIN-CURRENT-SAVE       TO CF-ACCOUNT-MSTR-MAINT-DT.
 10097
 10098
 10099* EXEC CICS REWRITE
 10100*        DATASET   (CNTL-FILE-ID)
 10101*        FROM      (CONTROL-FILE)
 10102*    END-EXEC.
 10103     MOVE LENGTH OF
 10104      CONTROL-FILE
 10105       TO DFHEIV11
 10106*    MOVE '&& L                  %   #00009210' TO DFHEIV0
 10107     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10108     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10109     MOVE X'2020233030303039323130' TO DFHEIV0(25:11)
 10110     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 193
* EL6501.cbl
 10111           CNTL-FILE-ID,
 10112           CONTROL-FILE,
 10113           DFHEIV11,
 10114           DFHEIV99
 10115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10116
 10117
 10118 6699-EXIT.
 10119      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 194
* EL6501.cbl
 10121 6700-BUILD-COMM-WORK.
 10122     IF NOT PI-GA-BILLING
 10123         GO TO 6799-EXIT.
 10124
 10125
 10126* EXEC CICS GETMAIN
 10127*         LENGTH   (260)
 10128*         SET      (ADDRESS OF COMMISSION-WORK-AREA)
 10129*         INITIMG  (GETMAIN-SPACE)
 10130*     END-EXEC.
 10131     MOVE 260
 10132       TO DFHEIV11
 10133*    MOVE ',"IL                  $   #00009222' TO DFHEIV0
 10134     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10135     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10136     MOVE X'2020233030303039323232' TO DFHEIV0(25:11)
 10137     CALL 'kxdfhei1' USING DFHEIV0,
 10138           DFHEIV20,
 10139           DFHEIV11,
 10140           GETMAIN-SPACE
 10141     SET ADDRESS OF COMMISSION-WORK-AREA TO
 10142         DFHEIV20
 10143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10144
 10145     SET LCP-WS-ADDR-PNTR TO ADDRESS OF COMMISSION-WORK-AREA
 10146
 10147     MOVE LCP-WS-ADDR-COMP TO PI-COMM-POINTER.
 10148     MOVE SPACES             TO COMMISSION-WORK-AREA.
 10149     MOVE 'X'                TO COMMISSION-GETMAIN-SW.
 10150
 10151     IF PI-MAINT = 'A'
 10152         GO TO 6799-EXIT.
 10153
 10154     MOVE AM-COMM-STRUCTURE TO COMMISSION-WORK-AREA.
 10155     MOVE +1                TO AXRF-SUB.
 10156
 10157 6710-AXRF-LOOP.
 10158     MOVE SPACES         TO AGENT-FIND.
 10159     MOVE ERGXRF-MAX-LEN TO ERGXRF-REC-LEN.
 10160
 10161     PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT.
 10162
 10163     IF AGENT-FIND = SPACES
 10164        MOVE GX-LAST-BILL-DT (GX-AGENT-SUB) TO
 10165             WK-GA-BILL-DT (AXRF-SUB)
 10166     ELSE
 10167        MOVE LOW-VALUES TO WK-GA-BILL-DT (AXRF-SUB).
 10168
 10169     ADD +1 TO AXRF-SUB.
 10170
 10171     IF AXRF-SUB NOT = +11
 10172        GO TO 6710-AXRF-LOOP.
 10173
 10174 6799-EXIT.
 10175     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 195
* EL6501.cbl
 10177 6800-COMPANY-REC-READ.
 10178     MOVE SPACES                 TO ELCNTL-KEY.
 10179     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10180     MOVE '1'                    TO CNTL-REC-TYPE.
 10181     MOVE +0                     TO CNTL-SEQ-NO.
 10182
 10183* EXEC CICS HANDLE CONDITION
 10184*        NOTFND   (6880-NO-COMP)
 10185*    END-EXEC.
 10186*    MOVE '"$I                   ! 0 #00009264' TO DFHEIV0
 10187     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10188     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10189     MOVE X'3020233030303039323634' TO DFHEIV0(25:11)
 10190     CALL 'kxdfhei1' USING DFHEIV0
 10191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10192
 10193
 10194
 10195* EXEC CICS READ
 10196*        DATASET   (CNTL-FILE-ID)
 10197*        SET       (ADDRESS OF CONTROL-FILE)
 10198*        RIDFLD    (ELCNTL-KEY)
 10199*    END-EXEC.
 10200*    MOVE '&"S        E          (   #00009268' TO DFHEIV0
 10201     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10202     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10203     MOVE X'2020233030303039323638' TO DFHEIV0(25:11)
 10204     CALL 'kxdfhei1' USING DFHEIV0,
 10205           CNTL-FILE-ID,
 10206           DFHEIV20,
 10207           DFHEIV99,
 10208           ELCNTL-KEY,
 10209           DFHEIV99,
 10210           DFHEIV99,
 10211           DFHEIV99
 10212     SET ADDRESS OF CONTROL-FILE TO
 10213         DFHEIV20
 10214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10215
 10216
 10217     IF CF-ACCOUNT-MSTR-MAINT-DT = LOW-VALUES
 10218         MOVE ER-2572               TO EMI-ERROR
 10219         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10220
 10221     GO TO 6899-EXIT.
 10222
 10223 6880-NO-COMP.
 10224     MOVE ER-0002                TO EMI-ERROR.
 10225     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10226
 10227 6899-EXIT.
 10228     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 196
* EL6501.cbl
 10230 6900-READ-AND-CHECK-AXRF.
 10231     IF NOT PI-GA-BILLING
 10232        GO TO 6999-EXIT.
 10233
 10234     MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
 10235     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
 10236
 10237 6905-AGENT-LEVEL-LOOP.
 10238     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10239     MOVE SPACES TO AGENT-FIND.
 10240     IF ((AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB))
 10241      OR
 10242        (AM-COM-TYP (AXRF-SUB) NOT = WK-AM-TYPE (AXRF-SUB)))
 10243      AND
 10244        ((AM-COM-TYP (AXRF-SUB) = 'O' OR 'P' OR 'G'
 10245                             OR 'B' OR 'I'
 10246                             OR 'K' OR 'L' OR 'J' OR 'M'
 10247                             OR 'S' OR 'A' OR 'N')
 10248                            OR
 10249        (WK-AM-TYPE (AXRF-SUB) = 'O' OR 'P' OR 'G' OR
 10250                'B' OR 'I' OR 'K' OR 'L' OR 'J' OR 'M'
 10251                                  OR 'S' OR 'A' OR 'N'))
 10252            PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT
 10253            IF AGENT-RECORD-NOT-FOUND
 10254               PERFORM 6950-ADD-AGENT-RECORD THRU 6959-EXIT
 10255           ELSE
 10256            IF ACCT-RECORD-NOT-FOUND OR ACCT-LEVEL-DIFFERENT
 10257               PERFORM 6970-REWRITE-AGENT-RECORD THRU 6979-EXIT
 10258           ELSE
 10259        IF (AM-COM-TYP (AXRF-SUB) NOT = 'O' AND 'P' AND 'G'
 10260              AND 'B' AND 'I' AND 'S'
 10261              AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N') OR
 10262           (AM-AGT (AXRF-SUB) NOT =
 10263                   WK-AM-AGT (AXRF-SUB))
 10264           PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT
 10265           GO TO 6910-INC-SUB.
 10266
 10267     MOVE SPACES TO AGENT-FIND.
 10268     IF (AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB)) AND
 10269        (WK-AM-AGT (AXRF-SUB) NOT = LOW-VALUES AND
 10270                               SPACES AND ZEROS)
 10271          MOVE WK-AM-AGT (AXRF-SUB)   TO WS-AXRF-AGENT-NO
 10272          MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN
 10273          PERFORM 6921-READ-AXRF THRU 6929-EXIT
 10274          IF AGENT-FIND = SPACES
 10275              PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT.
 10276
 10277 6910-INC-SUB.
 10278     ADD +1                      TO AXRF-SUB.
 10279     IF AXRF-SUB NOT = +11
 10280        GO TO 6905-AGENT-LEVEL-LOOP.
 10281
 10282     GO TO 6999-EXIT.
 10283
 10284 6920-READ-AXRF-FILE.
 10285*    IF GETMAIN-SW = 'X'
 10286*       GO TO 6920-BUILD-KEY.
 10287*
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 197
* EL6501.cbl
 10288*    EXEC CICS GETMAIN
 10289*         LENGTH   (ERGXRF-REC-LEN)
 10290*         SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
 10291*         INITIMG  (GETMAIN-SPACE)
 10292*    END-EXEC.
 10293*
 10294*    MOVE 'X' TO GETMAIN-SW.
 10295
 10296 6920-BUILD-KEY.
 10297     MOVE PI-COMPANY-CD          TO WS-AXRF-COMPANY-CD.
 10298
 10299     IF PI-ZERO-CARRIER
 10300       OR PI-ZERO-CAR-GROUP
 10301         MOVE ZERO               TO WS-AXRF-CARRIER
 10302     ELSE
 10303         MOVE AM-CARRIER         TO WS-AXRF-CARRIER.
 10304
 10305     IF PI-ZERO-GROUPING
 10306       OR PI-ZERO-CAR-GROUP
 10307         MOVE ZEROS              TO WS-AXRF-GROUPING
 10308     ELSE
 10309         MOVE AM-GROUPING        TO WS-AXRF-GROUPING.
 10310
 10311     IF AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
 10312                                              LOW-VALUES
 10313        MOVE AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
 10314     ELSE
 10315     IF WK-AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
 10316                                              LOW-VALUES
 10317        MOVE WK-AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
 10318     ELSE
 10319        MOVE 'X' TO AGENT-FIND
 10320        GO TO 6929-EXIT.
 10321
 10322     MOVE +1 TO GX-AGENT-SUB.
 10323
 10324 6921-READ-AXRF.
 10325
 10326* EXEC CICS HANDLE CONDITION
 10327*         ENDFILE     (6925-NOT-FIND)
 10328*         NOTFND      (6925-NOT-FIND)
 10329*    END-EXEC.
 10330*    MOVE '"$''I                  ! 1 #00009382' TO DFHEIV0
 10331     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10332     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10333     MOVE X'3120233030303039333832' TO DFHEIV0(25:11)
 10334     CALL 'kxdfhei1' USING DFHEIV0
 10335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10336
 10337
 10338
 10339* EXEC CICS READ
 10340*        DATASET   (ERGXRF-FILE-ID)
 10341*        LENGTH    (ERGXRF-REC-LEN)
 10342*        INTO      (AGENT-CROSS-REFERENCE)
 10343*        RIDFLD    (WS-AXRF-KEY)
 10344*        EQUAL
 10345*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 198
* EL6501.cbl
 10346*    MOVE '&"IL       E          (   #00009387' TO DFHEIV0
 10347     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10349     MOVE X'2020233030303039333837' TO DFHEIV0(25:11)
 10350     CALL 'kxdfhei1' USING DFHEIV0,
 10351           ERGXRF-FILE-ID,
 10352           AGENT-CROSS-REFERENCE,
 10353           ERGXRF-REC-LEN,
 10354           WS-AXRF-KEY,
 10355           DFHEIV99,
 10356           DFHEIV99,
 10357           DFHEIV99
 10358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10359
 10360
 10361     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10362
 10363     PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10364             FROM +1 BY +1 UNTIL
 10365         (GX-AGENT-SUB GREATER THAN GX-AGENT-POINTER-CNT) OR
 10366         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT      AND
 10367         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10368         AND
 10369         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10370         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10371         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10372         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10373
 10374     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10375        MOVE 'Y' TO AGENT-FIND
 10376        GO TO 6929-EXIT.
 10377
 10378     IF GX-AM-LEVEL-NO (GX-AGENT-SUB) NOT = AXRF-SUB
 10379        MOVE 'Z' TO AGENT-FIND.
 10380
 10381     GO TO 6929-EXIT.
 10382
 10383 6921-FIND-ACCT-LOOP.
 10384***  DUMMY PARAGRAPH  ***
 10385
 10386 6925-NOT-FIND.
 10387     MOVE 'X' TO AGENT-FIND.
 10388
 10389 6929-EXIT.
 10390     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 199
* EL6501.cbl
 10392 6950-ADD-AGENT-RECORD.
 10393     IF AM-AGT (AXRF-SUB) = SPACES OR ZEROS
 10394        GO TO 6959-EXIT.
 10395
 10396     MOVE +109                   TO ERGXRF-REC-LEN.
 10397
 10398     MOVE +1                     TO GX-AGENT-POINTER-CNT.
 10399     MOVE 'GX'                   TO GX-RECORD-ID.
 10400     MOVE AM-COMPANY-CD          TO GX-COMPANY-CD.
 10401
 10402     IF PI-ZERO-CARRIER
 10403       OR PI-ZERO-CAR-GROUP
 10404         MOVE ZERO               TO GX-CARRIER
 10405     ELSE
 10406         MOVE AM-CARRIER         TO GX-CARRIER.
 10407
 10408     IF PI-ZERO-GROUPING
 10409       OR PI-ZERO-CAR-GROUP
 10410         MOVE ZERO               TO GX-GROUPING
 10411     ELSE
 10412         MOVE AM-GROUPING        TO GX-GROUPING.
 10413
 10414     MOVE AM-AGT (AXRF-SUB)      TO GX-AGENT-NO.
 10415
 10416     MOVE AM-CARRIER             TO GX-AM-CARRIER (1).
 10417     MOVE AM-GROUPING            TO GX-AM-GROUPING (1).
 10418     MOVE AM-STATE               TO GX-AM-STATE (1).
 10419     MOVE AM-ACCOUNT             TO GX-AM-ACCOUNT (1).
 10420     MOVE AM-EXPIRATION-DT       TO GX-AM-EXPIRATION-DT (1).
 10421     MOVE AM-EFFECTIVE-DT        TO GX-AM-EFF-DT (1).
 10422     MOVE AXRF-SUB               TO GX-AM-LEVEL-NO (1).
 10423     MOVE LOW-VALUES             TO GX-LAST-BILL-DT (1).
 10424
 10425     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10426     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10427     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10428
 10429
 10430* EXEC CICS WRITE
 10431*        FROM      (AGENT-CROSS-REFERENCE)
 10432*        LENGTH    (ERGXRF-REC-LEN)
 10433*        RIDFLD    (GX-CONTROL-PRIMARY)
 10434*        DATASET   (ERGXRF-FILE-ID)
 10435*    END-EXEC.
 10436*    MOVE '&$ L                  ''   #00009463' TO DFHEIV0
 10437     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10438     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10439     MOVE X'2020233030303039343633' TO DFHEIV0(25:11)
 10440     CALL 'kxdfhei1' USING DFHEIV0,
 10441           ERGXRF-FILE-ID,
 10442           AGENT-CROSS-REFERENCE,
 10443           ERGXRF-REC-LEN,
 10444           GX-CONTROL-PRIMARY,
 10445           DFHEIV99,
 10446           DFHEIV99
 10447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10448
 10449
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 200
* EL6501.cbl
 10450 6959-EXIT.
 10451      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 201
* EL6501.cbl
 10453 6970-REWRITE-AGENT-RECORD.
 10454     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10455
 10456
 10457* EXEC CICS READ
 10458*        DATASET   (ERGXRF-FILE-ID)
 10459*        INTO      (AGENT-CROSS-REFERENCE)
 10460*        LENGTH    (ERGXRF-REC-LEN)
 10461*        RIDFLD    (WS-AXRF-KEY)
 10462*        EQUAL
 10463*        UPDATE
 10464*    END-EXEC.
 10465*    MOVE '&"IL       EU         (   #00009476' TO DFHEIV0
 10466     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10467     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10468     MOVE X'2020233030303039343736' TO DFHEIV0(25:11)
 10469     CALL 'kxdfhei1' USING DFHEIV0,
 10470           ERGXRF-FILE-ID,
 10471           AGENT-CROSS-REFERENCE,
 10472           ERGXRF-REC-LEN,
 10473           WS-AXRF-KEY,
 10474           DFHEIV99,
 10475           DFHEIV99,
 10476           DFHEIV99
 10477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10478
 10479
 10480     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10481
 10482     IF ACCT-LEVEL-DIFFERENT
 10483        GO TO 6975-UPDATE-LEVEL-NO.
 10484
 10485     IF GX-AGENT-POINTER-CNT = +1006
 10486         GO TO 6979-EXIT.
 10487
 10488     MOVE +1 TO FIND-AGENT-SUB1.
 10489
 10490 6972-FIND-REC-LOCATION.
 10491     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO GX-REST-OF-KEY.
 10492     MOVE AM-COMPANY-CD TO GX-AM-COMPANY-CD.
 10493
 10494     IF (GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY)  OR
 10495        (FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT)
 10496        NEXT SENTENCE
 10497     ELSE
 10498        ADD +1 TO FIND-AGENT-SUB1
 10499        GO TO 6972-FIND-REC-LOCATION.
 10500
 10501     MOVE GX-AGENT-POINTER-CNT TO FIND-AGENT-SUB2
 10502                                  FIND-AGENT-SUB3.
 10503     ADD +1 TO FIND-AGENT-SUB3.
 10504
 10505     IF FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT
 10506        NEXT SENTENCE
 10507     ELSE
 10508        PERFORM 6977-BUMP-AXRF-REC VARYING FIND-AGENT-SUB2
 10509        FROM FIND-AGENT-SUB2 BY -1 UNTIL
 10510        FIND-AGENT-SUB3 = FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 202
* EL6501.cbl
 10511
 10512     ADD ERGXRF-INC-LEN          TO ERGXRF-REC-LEN.
 10513     ADD  +1                     TO GX-AGENT-POINTER-CNT.
 10514
 10515     MOVE AM-CARRIER  TO GX-AM-CARRIER (FIND-AGENT-SUB3).
 10516     MOVE AM-GROUPING TO GX-AM-GROUPING (FIND-AGENT-SUB3).
 10517
 10518     MOVE AM-STATE    TO GX-AM-STATE (FIND-AGENT-SUB3).
 10519     MOVE AM-ACCOUNT  TO GX-AM-ACCOUNT (FIND-AGENT-SUB3).
 10520     MOVE AM-EXPIRATION-DT TO
 10521                  GX-AM-EXPIRATION-DT (FIND-AGENT-SUB3).
 10522     MOVE AM-EFFECTIVE-DT  TO
 10523                  GX-AM-EFF-DT (FIND-AGENT-SUB3).
 10524     MOVE AXRF-SUB    TO GX-AM-LEVEL-NO (FIND-AGENT-SUB3).
 10525     MOVE LOW-VALUES  TO GX-LAST-BILL-DT (FIND-AGENT-SUB3).
 10526
 10527 6975-UPDATE-LEVEL-NO.
 10528     MOVE AXRF-SUB TO GX-AM-LEVEL-NO (GX-AGENT-SUB).
 10529     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10530     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10531     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10532     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
 10533     if ergxrf-rec-len > +31264
 10534        move +31264               to ergxrf-rec-len
 10535        move +1006                to gx-agent-pointer-cnt
 10536     end-if
 10537
 10538
 10539* EXEC CICS REWRITE
 10540*        FROM      (AGENT-CROSS-REFERENCE)
 10541*        LENGTH    (ERGXRF-REC-LEN)
 10542*        DATASET   (ERGXRF-FILE-ID)
 10543*    END-EXEC.
 10544*    MOVE '&& L                  %   #00009543' TO DFHEIV0
 10545     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10546     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10547     MOVE X'2020233030303039353433' TO DFHEIV0(25:11)
 10548     CALL 'kxdfhei1' USING DFHEIV0,
 10549           ERGXRF-FILE-ID,
 10550           AGENT-CROSS-REFERENCE,
 10551           ERGXRF-REC-LEN,
 10552           DFHEIV99
 10553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10554
 10555
 10556     GO TO 6979-EXIT.
 10557
 10558 6977-BUMP-AXRF-REC.
 10559     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB2) TO
 10560          GX-AGENT-POINTER (FIND-AGENT-SUB3).
 10561
 10562     SUBTRACT +1 FROM FIND-AGENT-SUB3.
 10563
 10564 6979-EXIT.
 10565     EXIT.
 10566
 10567 6999-EXIT.
 10568     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 203
* EL6501.cbl
 10570 7000-DELETE-AXRF-REC.
 10571     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10572
 10573
 10574* EXEC CICS HANDLE CONDITION
 10575*         ENDFILE     (7999-EXIT)
 10576*         NOTFND      (7999-EXIT)
 10577*    END-EXEC.
 10578*    MOVE '"$''I                  ! 2 #00009566' TO DFHEIV0
 10579     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10580     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10581     MOVE X'3220233030303039353636' TO DFHEIV0(25:11)
 10582     CALL 'kxdfhei1' USING DFHEIV0
 10583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10584
 10585
 10586
 10587* EXEC CICS READ
 10588*        DATASET   (ERGXRF-FILE-ID)
 10589*        INTO      (AGENT-CROSS-REFERENCE)
 10590*        LENGTH    (ERGXRF-REC-LEN)
 10591*        RIDFLD    (WS-AXRF-KEY)
 10592*        EQUAL
 10593*        UPDATE
 10594*    END-EXEC.
 10595*    MOVE '&"IL       EU         (   #00009571' TO DFHEIV0
 10596     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10597     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10598     MOVE X'2020233030303039353731' TO DFHEIV0(25:11)
 10599     CALL 'kxdfhei1' USING DFHEIV0,
 10600           ERGXRF-FILE-ID,
 10601           AGENT-CROSS-REFERENCE,
 10602           ERGXRF-REC-LEN,
 10603           WS-AXRF-KEY,
 10604           DFHEIV99,
 10605           DFHEIV99,
 10606           DFHEIV99
 10607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10608
 10609
 10610     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10611
 10612     IF GX-AGENT-SUB = +0
 10613        PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10614        FROM +1 BY +1 UNTIL
 10615         (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT) OR
 10616         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT  AND
 10617         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10618         AND
 10619         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10620         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10621         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10622         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10623
 10624     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10625        GO TO 7999-EXIT.
 10626
 10627     MOVE GX-AGENT-SUB TO FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 204
* EL6501.cbl
 10628     PERFORM 7010-BUMP-RECORDS VARYING GX-AGENT-SUB
 10629                                  FROM GX-AGENT-SUB BY +1 UNTIL
 10630                            GX-AGENT-SUB = GX-AGENT-POINTER-CNT.
 10631     SUBTRACT ERGXRF-INC-LEN FROM ERGXRF-REC-LEN.
 10632     SUBTRACT +1             FROM GX-AGENT-POINTER-CNT.
 10633     GO TO 7020-REWRITE-AXRF-RECORD.
 10634
 10635 7010-BUMP-RECORDS.
 10636     ADD +1 TO FIND-AGENT-SUB1.
 10637     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO
 10638          GX-AGENT-POINTER (GX-AGENT-SUB).
 10639
 10640 7020-REWRITE-AXRF-RECORD.
 10641     IF GX-AGENT-POINTER-CNT = +0
 10642
 10643* EXEC CICS DELETE
 10644*            DATASET   (ERGXRF-FILE-ID)
 10645*       END-EXEC
 10646*    MOVE '&(                    &   #00009612' TO DFHEIV0
 10647     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10648     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10649     MOVE X'2020233030303039363132' TO DFHEIV0(25:11)
 10650     CALL 'kxdfhei1' USING DFHEIV0,
 10651           ERGXRF-FILE-ID,
 10652           DFHEIV99,
 10653           DFHEIV99,
 10654           DFHEIV99,
 10655           DFHEIV99
 10656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10657     ELSE
 10658        MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT
 10659        MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS
 10660        MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER
 10661        compute ergxrf-rec-len =
 10662            (gx-agent-pointer-cnt * +31) + +78
 10663        if ergxrf-rec-len > +31264
 10664           move +31264               to ergxrf-rec-len
 10665           move +1006                to gx-agent-pointer-cnt
 10666        end-if
 10667
 10668* EXEC CICS REWRITE
 10669*            FROM      (AGENT-CROSS-REFERENCE)
 10670*            LENGTH    (ERGXRF-REC-LEN)
 10671*            DATASET   (ERGXRF-FILE-ID)
 10672*       END-EXEC.
 10673*    MOVE '&& L                  %   #00009625' TO DFHEIV0
 10674     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10675     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10676     MOVE X'2020233030303039363235' TO DFHEIV0(25:11)
 10677     CALL 'kxdfhei1' USING DFHEIV0,
 10678           ERGXRF-FILE-ID,
 10679           AGENT-CROSS-REFERENCE,
 10680           ERGXRF-REC-LEN,
 10681           DFHEIV99
 10682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10683
 10684
 10685 7999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 205
* EL6501.cbl
 10686     EXIT.
 10687
 10688*************************************
 10689 8000-STATE-REC-READ.
 10690     MOVE SPACES                 TO ELCNTL-KEY.
 10691     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10692     MOVE '3'                    TO CNTL-REC-TYPE.
 10693     MOVE PI-ACCT-STATE          TO CNTL-ACCESS.
 10694     MOVE +0                     TO CNTL-SEQ-NO.
 10695
 10696* EXEC CICS HANDLE CONDITION
 10697*        NOTFND  (8010-EXIT)
 10698*    END-EXEC.
 10699*    MOVE '"$I                   ! 3 #00009641' TO DFHEIV0
 10700     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10701     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10702     MOVE X'3320233030303039363431' TO DFHEIV0(25:11)
 10703     CALL 'kxdfhei1' USING DFHEIV0
 10704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10705
 10706
 10707
 10708* EXEC CICS READ
 10709*        DATASET   (CNTL-FILE-ID)
 10710*        SET       (ADDRESS OF CONTROL-FILE)
 10711*        RIDFLD    (ELCNTL-KEY)
 10712*    END-EXEC.
 10713*    MOVE '&"S        E          (   #00009645' TO DFHEIV0
 10714     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10715     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10716     MOVE X'2020233030303039363435' TO DFHEIV0(25:11)
 10717     CALL 'kxdfhei1' USING DFHEIV0,
 10718           CNTL-FILE-ID,
 10719           DFHEIV20,
 10720           DFHEIV99,
 10721           ELCNTL-KEY,
 10722           DFHEIV99,
 10723           DFHEIV99,
 10724           DFHEIV99
 10725     SET ADDRESS OF CONTROL-FILE TO
 10726         DFHEIV20
 10727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10728
 10729
 10730     MOVE CF-ST-COMMISSION-CAPS   TO WS-ST-COMMISSION-CAPS
 10731     MOVE CF-ST-GA-COMMISSION-CAPS
 10732                                  TO WS-ST-GA-COMMISSION-CAPS
 10733     MOVE CF-ST-TOT-COMMISSION-CAPS
 10734                                  TO WS-ST-TOT-COMMISSION-CAPS
 10735     MOVE CF-COMM-CAP-LIMIT-TO    TO WS-COMM-CAP-LIMIT-TO.
 10736
 10737 8010-EXIT.
 10738      EXIT.
 10739
 10740 8050-USER-REC-READ.
 10741     MOVE SPACES                 TO ELCNTL-KEY.
 10742     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10743     MOVE '2'                    TO CNTL-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 206
* EL6501.cbl
 10744     MOVE CSRI                   TO CNTL-ACCESS.
 10745     MOVE +0                     TO CNTL-SEQ-NO.
 10746
 10747* EXEC CICS HANDLE CONDITION
 10748*        NOTFND  (8055-NOTFND)
 10749*    END-EXEC.
 10750*    MOVE '"$I                   ! 4 #00009667' TO DFHEIV0
 10751     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10752     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10753     MOVE X'3420233030303039363637' TO DFHEIV0(25:11)
 10754     CALL 'kxdfhei1' USING DFHEIV0
 10755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10756
 10757
 10758
 10759* EXEC CICS READ
 10760*        DATASET   (CNTL-FILE-ID)
 10761*        SET       (ADDRESS OF CONTROL-FILE)
 10762*        RIDFLD    (ELCNTL-KEY)
 10763*    END-EXEC.
 10764*    MOVE '&"S        E          (   #00009671' TO DFHEIV0
 10765     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10766     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10767     MOVE X'2020233030303039363731' TO DFHEIV0(25:11)
 10768     CALL 'kxdfhei1' USING DFHEIV0,
 10769           CNTL-FILE-ID,
 10770           DFHEIV20,
 10771           DFHEIV99,
 10772           ELCNTL-KEY,
 10773           DFHEIV99,
 10774           DFHEIV99,
 10775           DFHEIV99
 10776     SET ADDRESS OF CONTROL-FILE TO
 10777         DFHEIV20
 10778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10779
 10780
 10781     GO TO 8060-EXIT.
 10782
 10783 8055-NOTFND.
 10784     MOVE ER-1883             TO EMI-ERROR.
 10785     MOVE -1                  TO CSRL.
 10786     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10787
 10788 8060-EXIT.
 10789      EXIT.
 10790
 10791*************************************
 10792
 10793 8100-SEND-INITIAL-MAP.
 10794     MOVE SAVE-DATE              TO DATEO.
 10795     MOVE EIBTIME                TO TIME-IN.
 10796     MOVE TIME-OUT               TO TIMEO.
 10797     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10798     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10799     MOVE -1                     TO PFENTERL.
 10800     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10801
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 207
* EL6501.cbl
 10802     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10803
 10804*    IF PI-COMPANY-ID = 'HAN' OR 'LGX' OR 'BNE'
 10805*       NEXT SENTENCE
 10806*    ELSE
 10807*       MOVE AL-SADOF            TO PSIHEADA
 10808*                                   PSILFTA
 10809*                                   PSILFCA
 10810*                                   PSIAHTA
 10811*                                   PSIAHCA
 10812*                                   PSILFFA
 10813*                                   PSIAHFA.
 10814
 10815*    IF PI-COMPANY-ID = 'DMD'
 10816*         MOVE AL-SANOF          TO KEY10A.
 10817
 10818     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 10819        CONTINUE
 10820     ELSE
 10821        MOVE AL-SADOF            TO CTPLABLA
 10822                                    CLPTOLPA
 10823                                    LCLABLA
 10824                                    LCOMMA
 10825                                    MAXFEEHA
 10826                                    CLPSTHA
 10827                                    PRODCDHA
 10828     END-IF
 10829     IF PI-COMPANY-ID = 'NCL' OR 'LGX'
 10830        MOVE -1                  TO CSRL.
 10831
 10832     IF  CLAIM-SESSION
 10833         MOVE SPACES             TO PF1PF2O
 10834         MOVE AL-SANOF           TO PF1PF2A.
 10835
 10836
 10837* EXEC CICS SEND
 10838*        MAP      (MAP-NAME)
 10839*        MAPSET   (MAPSET-NAME)
 10840*        FROM     (EL6501AO)
 10841*        ERASE
 10842*        CURSOR
 10843*    END-EXEC.
 10844     MOVE LENGTH OF
 10845      EL6501AO
 10846       TO DFHEIV12
 10847     MOVE -1
 10848       TO DFHEIV11
 10849*    MOVE '8$     CT  E    H L F ,   #00009732' TO DFHEIV0
 10850     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10851     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10852     MOVE X'2020233030303039373332' TO DFHEIV0(25:11)
 10853     CALL 'kxdfhei1' USING DFHEIV0,
 10854           MAP-NAME,
 10855           EL6501AO,
 10856           DFHEIV12,
 10857           MAPSET-NAME,
 10858           DFHEIV99,
 10859           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 208
* EL6501.cbl
 10860           DFHEIV99,
 10861           DFHEIV11,
 10862           DFHEIV99,
 10863           DFHEIV99,
 10864           DFHEIV99
 10865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10866
 10867
 10868     GO TO 9100-RETURN-TRAN.
 10869
 10870 8200-SEND-DATAONLY.
 10871     MOVE SAVE-DATE              TO DATEO.
 10872     MOVE EIBTIME                TO TIME-IN.
 10873     MOVE TIME-OUT               TO TIMEO.
 10874     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10875     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10876     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10877
 10878     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10879
 10880     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 10881        CONTINUE
 10882     ELSE
 10883        MOVE AL-SADOF            TO CTPLABLA
 10884                                    CLPTOLPA
 10885                                    LCLABLA
 10886                                    LCOMMA
 10887                                    MAXFEEHA
 10888                                    CLPSTHA
 10889                                    PRODCDHA
 10890     END-IF
 10891     IF  CLAIM-SESSION
 10892         MOVE SPACES             TO PF1PF2O
 10893         MOVE AL-SANOF           TO PF1PF2A.
 10894
 10895
 10896* EXEC CICS SEND
 10897*        MAP      (MAP-NAME)
 10898*        MAPSET   (MAPSET-NAME)
 10899*        FROM     (EL6501AO)
 10900*        DATAONLY
 10901*        CURSOR
 10902*    END-EXEC.
 10903     MOVE LENGTH OF
 10904      EL6501AO
 10905       TO DFHEIV12
 10906     MOVE -1
 10907       TO DFHEIV11
 10908*    MOVE '8$D    CT       H L F ,   #00009767' TO DFHEIV0
 10909     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10910     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10911     MOVE X'2020233030303039373637' TO DFHEIV0(25:11)
 10912     CALL 'kxdfhei1' USING DFHEIV0,
 10913           MAP-NAME,
 10914           EL6501AO,
 10915           DFHEIV12,
 10916           MAPSET-NAME,
 10917           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 209
* EL6501.cbl
 10918           DFHEIV99,
 10919           DFHEIV99,
 10920           DFHEIV11,
 10921           DFHEIV99,
 10922           DFHEIV99,
 10923           DFHEIV99
 10924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10925
 10926
 10927     GO TO 9100-RETURN-TRAN.
 10928
 10929 8300-SEND-TEXT.
 10930
 10931* EXEC CICS SEND TEXT
 10932*        FROM     (LOGOFF-TEXT)
 10933*        LENGTH   (LOGOFF-LENGTH)
 10934*        ERASE
 10935*        FREEKB
 10936*    END-EXEC.
 10937*    MOVE '8&      T  E F  H   F -   #00009778' TO DFHEIV0
 10938     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10939     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10940     MOVE X'2020233030303039373738' TO DFHEIV0(25:11)
 10941     CALL 'kxdfhei1' USING DFHEIV0,
 10942           LOGOFF-TEXT,
 10943           LOGOFF-LENGTH,
 10944           DFHEIV99,
 10945           DFHEIV99,
 10946           DFHEIV99,
 10947           DFHEIV99,
 10948           DFHEIV99,
 10949           DFHEIV99,
 10950           DFHEIV99,
 10951           DFHEIV99,
 10952           DFHEIV99,
 10953           DFHEIV99
 10954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10955
 10956
 10957
 10958* EXEC CICS RETURN
 10959*    END-EXEC.
 10960*    MOVE '.(                    ''   #00009785' TO DFHEIV0
 10961     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10962     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10963     MOVE X'2020233030303039373835' TO DFHEIV0(25:11)
 10964     CALL 'kxdfhei1' USING DFHEIV0,
 10965           DFHEIV99,
 10966           DFHEIV99,
 10967           DFHEIV99,
 10968           DFHEIV99,
 10969           DFHEIV99,
 10970           DFHEIV99
 10971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10972
 10973
 10974 8600-DEEDIT.
 10975
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 210
* EL6501.cbl
 10976* EXEC CICS BIF DEEDIT
 10977*         FIELD(DEEDIT-FIELD)
 10978*         LENGTH(15)
 10979*     END-EXEC.
 10980     MOVE 15
 10981       TO DFHEIV11
 10982*    MOVE '@"L                   #   #00009789' TO DFHEIV0
 10983     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10984     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10985     MOVE X'2020233030303039373839' TO DFHEIV0(25:11)
 10986     CALL 'kxdfhei1' USING DFHEIV0,
 10987           DEEDIT-FIELD,
 10988           DFHEIV11
 10989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10990
 10991
 10992 8800-UNAUTHORIZED-ACCESS.
 10993     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10994     GO TO 8300-SEND-TEXT.
 10995
 10996 8810-PF23.
 10997     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10998     MOVE XCTL-005               TO PGM-NAME.
 10999     GO TO 9300-XCTL.
 11000
 11001 9100-RETURN-TRAN.
 11002     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 11003     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 11004
 11005* EXEC CICS RETURN
 11006*        TRANSID    (TRANS-ID)
 11007*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 11008*        LENGTH     (WS-COMM-LENGTH)
 11009*    END-EXEC.
 11010*    MOVE '.(CT                  ''   #00009806' TO DFHEIV0
 11011     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 11012     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11013     MOVE X'2020233030303039383036' TO DFHEIV0(25:11)
 11014     CALL 'kxdfhei1' USING DFHEIV0,
 11015           TRANS-ID,
 11016           PROGRAM-INTERFACE-BLOCK,
 11017           WS-COMM-LENGTH,
 11018           DFHEIV99,
 11019           DFHEIV99,
 11020           DFHEIV99
 11021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11022
 11023
 11024 9200-RETURN-MAIN-MENU.
 11025     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11026         MOVE XCTL-126           TO  PGM-NAME
 11027     ELSE
 11028         MOVE XCTL-626           TO  PGM-NAME.
 11029
 11030     GO TO 9300-XCTL.
 11031
 11032 9300-XCTL.
 11033
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 211
* EL6501.cbl
 11034* EXEC CICS XCTL
 11035*        PROGRAM    (PGM-NAME)
 11036*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 11037*        LENGTH     (WS-COMM-LENGTH)
 11038*    END-EXEC.
 11039*    MOVE '.$C                   %   #00009821' TO DFHEIV0
 11040     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 11041     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11042     MOVE X'2020233030303039383231' TO DFHEIV0(25:11)
 11043     CALL 'kxdfhei1' USING DFHEIV0,
 11044           PGM-NAME,
 11045           PROGRAM-INTERFACE-BLOCK,
 11046           WS-COMM-LENGTH,
 11047           DFHEIV99
 11048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11049
 11050
 11051 9400-CLEAR.
 11052     IF PI-GA-BILLING
 11053        IF GETMAIN-ACQUIRED
 11054           MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
 11055           SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR
 11056
 11057* EXEC CICS FREEMAIN
 11058*               DATA     (COMMISSION-WORK-AREA)
 11059*          END-EXEC.
 11060*    MOVE ',$D                   "   #00009832' TO DFHEIV0
 11061     MOVE X'2C2444202020202020202020' TO DFHEIV0(1:12)
 11062     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 11063     MOVE X'2020233030303039383332' TO DFHEIV0(25:11)
 11064     CALL 'kxdfhei1' USING DFHEIV0,
 11065           COMMISSION-WORK-AREA
 11066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11067
 11068
 11069     MOVE SPACES                 TO PI-SV-MAINT.
 11070     MOVE XCTL-650               TO PGM-NAME.
 11071     MOVE XCTL-650               TO PI-RETURN-TO-PROGRAM.
 11072     GO TO 9300-XCTL.
 11073
 11074 9500-PF12.
 11075     MOVE XCTL-010               TO PGM-NAME.
 11076     GO TO 9300-XCTL.
 11077
 11078 9600-PGMID-ERROR.
 11079
 11080* EXEC CICS HANDLE CONDITION
 11081*        PGMIDERR    (8300-SEND-TEXT)
 11082*    END-EXEC.
 11083*    MOVE '"$L                   ! 5 #00009846' TO DFHEIV0
 11084     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 11085     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11086     MOVE X'3520233030303039383436' TO DFHEIV0(25:11)
 11087     CALL 'kxdfhei1' USING DFHEIV0
 11088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11089
 11090
 11091     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 212
* EL6501.cbl
 11092     MOVE ' '                    TO PI-ENTRY-CD-1.
 11093     MOVE XCTL-005               TO PGM-NAME.
 11094     MOVE PGM-NAME               TO LOGOFF-PGM.
 11095     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 11096     GO TO 9300-XCTL.
 11097
 11098 9700-DATE-LINK.
 11099     MOVE LINK-ELDATCV           TO PGM-NAME.
 11100
 11101* EXEC CICS LINK
 11102*        PROGRAM    (PGM-NAME)
 11103*        COMMAREA   (DATE-CONVERSION-DATA)
 11104*        LENGTH     (DC-COMM-LENGTH)
 11105*    END-EXEC.
 11106*    MOVE '."C                   (   #00009859' TO DFHEIV0
 11107     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11108     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11109     MOVE X'2020233030303039383539' TO DFHEIV0(25:11)
 11110     CALL 'kxdfhei1' USING DFHEIV0,
 11111           PGM-NAME,
 11112           DATE-CONVERSION-DATA,
 11113           DC-COMM-LENGTH,
 11114           DFHEIV99,
 11115           DFHEIV99,
 11116           DFHEIV99,
 11117           DFHEIV99
 11118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11119
 11120
 11121 9900-ERROR-FORMAT.
 11122     IF NOT EMI-ERRORS-COMPLETE
 11123         MOVE LINK-001           TO PGM-NAME
 11124
 11125* EXEC CICS LINK
 11126*            PROGRAM    (PGM-NAME)
 11127*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 11128*            LENGTH     (EMI-COMM-LENGTH)
 11129*        END-EXEC.
 11130*    MOVE '."C                   (   #00009868' TO DFHEIV0
 11131     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11132     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11133     MOVE X'2020233030303039383638' TO DFHEIV0(25:11)
 11134     CALL 'kxdfhei1' USING DFHEIV0,
 11135           PGM-NAME,
 11136           ERROR-MESSAGE-INTERFACE-BLOCK,
 11137           EMI-COMM-LENGTH,
 11138           DFHEIV99,
 11139           DFHEIV99,
 11140           DFHEIV99,
 11141           DFHEIV99
 11142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11143
 11144
 11145 9900-EXIT.
 11146     EXIT.
 11147
 11148 9990-ABEND.
 11149     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 213
* EL6501.cbl
 11150     MOVE DFHEIBLK               TO EMI-LINE1.
 11151
 11152* EXEC CICS LINK
 11153*        PROGRAM   (PGM-NAME)
 11154*        COMMAREA  (EMI-LINE1)
 11155*        LENGTH    (72)
 11156*    END-EXEC.
 11157     MOVE 72
 11158       TO DFHEIV11
 11159*    MOVE '."C                   (   #00009880' TO DFHEIV0
 11160     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11162     MOVE X'2020233030303039383830' TO DFHEIV0(25:11)
 11163     CALL 'kxdfhei1' USING DFHEIV0,
 11164           PGM-NAME,
 11165           EMI-LINE1,
 11166           DFHEIV11,
 11167           DFHEIV99,
 11168           DFHEIV99,
 11169           DFHEIV99,
 11170           DFHEIV99
 11171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11172
 11173
 11174     MOVE -1                     TO PFENTERL.
 11175     GO TO 8200-SEND-DATAONLY.
 11176
 11177
 11178* GOBACK.
 11179     MOVE '9%                    "   ' TO DFHEIV0
 11180     MOVE 'EL6501' TO DFHEIV1
 11181     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11182     GOBACK.
 11183
 11184 9995-SECURITY-VIOLATION.
 11185*                            COPY ELCSCTP.
 11186******************************************************************
 11187*                                                                *
 11188*                            ELCSCTP                             *
 11189*                            VMOD=2.001                          *
 11190*                                                                *
 11191*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 11192******************************************************************
 11193
 11194
 11195     MOVE EIBDATE          TO SM-JUL-DATE.
 11196     MOVE EIBTRMID         TO SM-TERMID.
 11197     MOVE THIS-PGM         TO SM-PGM.
 11198     MOVE EIBTIME          TO TIME-IN.
 11199     MOVE TIME-OUT         TO SM-TIME.
 11200     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 11201
 11202
 11203* EXEC CICS LINK
 11204*         PROGRAM  ('EL003')
 11205*         COMMAREA (SECURITY-MESSAGE)
 11206*         LENGTH   (80)
 11207*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 214
* EL6501.cbl
 11208     MOVE 'EL003' TO DFHEIV1
 11209     MOVE 80
 11210       TO DFHEIV11
 11211*    MOVE '."C                   (   #00009909' TO DFHEIV0
 11212     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11213     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11214     MOVE X'2020233030303039393039' TO DFHEIV0(25:11)
 11215     CALL 'kxdfhei1' USING DFHEIV0,
 11216           DFHEIV1,
 11217           SECURITY-MESSAGE,
 11218           DFHEIV11,
 11219           DFHEIV99,
 11220           DFHEIV99,
 11221           DFHEIV99,
 11222           DFHEIV99
 11223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11224
 11225
 11226******************************************************************
 11227
 11228
 11229 9995-EXIT.
 11230     EXIT.
 11231
 11232 9999-DFHBACK SECTION.
 11233     MOVE '9%                    "   ' TO DFHEIV0
 11234     MOVE 'EL6501' TO DFHEIV1
 11235     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11236     GOBACK.
 11237 9999-DFHEXIT.
 11238     IF DFHEIGDJ EQUAL 0001
 11239         NEXT SENTENCE
 11240     ELSE IF DFHEIGDJ EQUAL 2
 11241         GO TO 9600-PGMID-ERROR,
 11242               9990-ABEND,
 11243               0500-CHECK-MAINT-TYPE
 11244         DEPENDING ON DFHEIGDI
 11245     ELSE IF DFHEIGDJ EQUAL 3
 11246         GO TO 1500-EXIT
 11247         DEPENDING ON DFHEIGDI
 11248     ELSE IF DFHEIGDJ EQUAL 4
 11249         GO TO 1799-EXIT,
 11250               1799-EXIT
 11251         DEPENDING ON DFHEIGDI
 11252     ELSE IF DFHEIGDJ EQUAL 5
 11253         GO TO 2100-EXIT
 11254         DEPENDING ON DFHEIGDI
 11255     ELSE IF DFHEIGDJ EQUAL 6
 11256         GO TO 2200-EXIT
 11257         DEPENDING ON DFHEIGDI
 11258     ELSE IF DFHEIGDJ EQUAL 7
 11259         GO TO 3030-END-FILE
 11260         DEPENDING ON DFHEIGDI
 11261     ELSE IF DFHEIGDJ EQUAL 8
 11262         GO TO 3530-END-FILE
 11263         DEPENDING ON DFHEIGDI
 11264     ELSE IF DFHEIGDJ EQUAL 9
 11265         GO TO 4020-BUS-TYPE-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:39 Page 215
* EL6501.cbl
 11266         DEPENDING ON DFHEIGDI
 11267     ELSE IF DFHEIGDJ EQUAL 10
 11268         GO TO 4099-STD-BEN-ERROR
 11269         DEPENDING ON DFHEIGDI
 11270     ELSE IF DFHEIGDJ EQUAL 11
 11271         GO TO 4180-REIN-ERROR
 11272         DEPENDING ON DFHEIGDI
 11273     ELSE IF DFHEIGDJ EQUAL 12
 11274         GO TO 5250-QID-ERROR
 11275         DEPENDING ON DFHEIGDI
 11276     ELSE IF DFHEIGDJ EQUAL 13
 11277         GO TO 5399-EXIT,
 11278               5399-EXIT
 11279         DEPENDING ON DFHEIGDI
 11280     ELSE IF DFHEIGDJ EQUAL 14
 11281         GO TO 6450-NOT-FOUND
 11282         DEPENDING ON DFHEIGDI
 11283     ELSE IF DFHEIGDJ EQUAL 15
 11284         GO TO 6699-EXIT
 11285         DEPENDING ON DFHEIGDI
 11286     ELSE IF DFHEIGDJ EQUAL 16
 11287         GO TO 6880-NO-COMP
 11288         DEPENDING ON DFHEIGDI
 11289     ELSE IF DFHEIGDJ EQUAL 17
 11290         GO TO 6925-NOT-FIND,
 11291               6925-NOT-FIND
 11292         DEPENDING ON DFHEIGDI
 11293     ELSE IF DFHEIGDJ EQUAL 18
 11294         GO TO 7999-EXIT,
 11295               7999-EXIT
 11296         DEPENDING ON DFHEIGDI
 11297     ELSE IF DFHEIGDJ EQUAL 19
 11298         GO TO 8010-EXIT
 11299         DEPENDING ON DFHEIGDI
 11300     ELSE IF DFHEIGDJ EQUAL 20
 11301         GO TO 8055-NOTFND
 11302         DEPENDING ON DFHEIGDI
 11303     ELSE IF DFHEIGDJ EQUAL 21
 11304         GO TO 8300-SEND-TEXT
 11305         DEPENDING ON DFHEIGDI.
 11306     MOVE '9%                    "   ' TO DFHEIV0
 11307     MOVE 'EL6501' TO DFHEIV1
 11308     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11309     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39964     Code:       37275
