* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL013.cbl
* Options: int("EL013.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL013.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL013.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL013.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL013 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:28:44.
     7*                            VMOD=2.006.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL013.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION - EXRT - RATING CALCULATIONS
    25*        THIS PROGRAM IS USED TO REVIEW THE RATING
    26*        CALCULATIONS DONE BY THE SUBROUTINE ELRATE.
    27
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL013.cbl
    29 ENVIRONMENT DIVISION.
    30 DATA DIVISION.
    31 WORKING-STORAGE SECTION.
    32 01  DFH-START PIC X(04).
    33 77  FILLER  PIC X(32)  VALUE '********************************'.
    34 77  FILLER  PIC X(32)  VALUE '*    EL013 WORKING STORAGE     *'.
    35 77  FILLER  PIC X(32)  VALUE '***********VMOD=2.006 **********'.
    36
    37 01  WS-DATE-AREA.
    38     05  SAVE-DATE               PIC X(8)    VALUE SPACES.
    39     05  SAVE-BIN-DATE           PIC X(2)    VALUE SPACES.
    40
    41 01  STANDARD-AREAS.
    42     12  MAP-NAME                PIC X(8)    VALUE 'EL013A'.
    43     12  MAPSET-NAME             PIC X(8)    VALUE 'EL013S'.
    44     12  TRANS-ID                PIC X(4)    VALUE 'EXRT'.
    45     12  PGM-NAME                PIC X(8)    VALUE SPACES.
    46     12  LINK-ELRTRM             PIC X(8)    VALUE 'ELRTRM'.
    47     12  LINK-ELRATE             PIC X(8)    VALUE 'ELRATE'.
    48     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
    49     12  LINK-001                PIC X(8)    VALUE 'EL001'.
    50     12  LINK-004                PIC X(8)    VALUE 'EL004'.
    51     12  TIME-IN                 PIC S9(7).
    52     12  TIME-OUT-R   REDEFINES TIME-IN.
    53         16  FILLER              PIC X.
    54         16  TIME-OUT            PIC 99V99.
    55         16  FILLER              PIC X(2).
    56
    57 01  MISC-WORK-AREAS.
    58     12  WS-COMPANY-CODE         PIC S9(4)   VALUE +0    COMP.
    59     12  WS-COMPANY-CODE-R          REDEFINES WS-COMPANY-CODE.
    60         16  FILLER              PIC X.
    61         16  WS-COMP-CD          PIC X.
    62     12  TEXT-AREA               PIC X(66).
    63     12  TEXT-LENGTH             PIC S9(4)   VALUE +66   COMP.
    64
    65     12  WS-EDIT-BEN-CODE        PIC XX.
    66         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
    67                                          '90' THRU '99'.
    68
    69     12  ER-0349                 PIC X(4)   VALUE '0349'.
    70     12  ER-2474                 PIC X(4)   VALUE '2474'.
    71     12  ER-2477                 PIC X(4)   VALUE '2477'.
    72     12  ER-2481                 PIC X(4)   VALUE '2481'.
    73     12  ER-2482                 PIC X(4)   VALUE '2482'.
    74     12  ER-2484                 PIC X(4)   VALUE '2484'.
    75     12  ER-2485                 PIC X(4)   VALUE '2485'.
    76     12  ER-2486                 PIC X(4)   VALUE '2486'.
    77     12  ER-2487                 PIC X(4)   VALUE '2487'.
    78     12  ER-2488                 PIC X(4)   VALUE '2488'.
    79     12  ER-2489                 PIC X(4)   VALUE '2489'.
    80     12  ER-2490                 PIC X(4)   VALUE '2490'.
    81     12  ER-2496                 PIC X(4)   VALUE '2496'.
    82     12  ER-2550                 PIC X(4)   VALUE '2550'.
    83     12  ER-2551                 PIC X(4)   VALUE '2551'.
    84     12  ER-2552                 PIC X(4)   VALUE '2552'.
    85     12  ER-2553                 PIC X(4)   VALUE '2553'.
    86     12  ER-2554                 PIC X(4)   VALUE '2554'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL013.cbl
    87     12  ER-2555                 PIC X(4)   VALUE '2555'.
    88     12  ER-2556                 PIC X(4)   VALUE '2556'.
    89     12  ER-2557                 PIC X(4)   VALUE '2557'.
    90     12  ER-3032                 PIC X(4)   VALUE '3032'.
    91     12  ER-3126                 PIC X(4)   VALUE '3126'.
    92
    93 01  TEXT-MESSAGES.
    94     12  TRAN-COMPLETE-MSG.
    95         16  FILLER              PIC X(45)
    96           VALUE '     CLEAR ENTERED - SESSION ENDED'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL013.cbl
    98*                                COPY ELCDATE.
    99******************************************************************
   100*                                                                *
   101*                                                                *
   102*                            ELCDATE.                            *
   103*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   104*                            VMOD=2.003
   105*                                                                *
   106*                                                                *
   107*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   108*                 LENGTH = 200                                   *
   109******************************************************************
   110
   111 01  DATE-CONVERSION-DATA.
   112     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   113     12  DC-OPTION-CODE                PIC X.
   114         88  BIN-TO-GREG                VALUE ' '.
   115         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   116         88  EDIT-GREG-TO-BIN           VALUE '2'.
   117         88  YMD-GREG-TO-BIN            VALUE '3'.
   118         88  MDY-GREG-TO-BIN            VALUE '4'.
   119         88  JULIAN-TO-BIN              VALUE '5'.
   120         88  BIN-PLUS-ELAPSED           VALUE '6'.
   121         88  FIND-CENTURY               VALUE '7'.
   122         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   123         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   124         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   125         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   126         88  JULIAN-TO-BIN-3            VALUE 'C'.
   127         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   128         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   129         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   130         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   131         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   132         88  CHECK-LEAP-YEAR            VALUE 'H'.
   133         88  BIN-3-TO-GREG              VALUE 'I'.
   134         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   135         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   136         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   137         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   138         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   139         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   140         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   141         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   142         88  THREE-CHARACTER-BIN
   143                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   144         88  GREGORIAN-TO-BIN
   145                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   146         88  BIN-TO-GREGORIAN
   147                  VALUES ' ' '1' 'I' '8' 'G'.
   148         88  JULIAN-TO-BINARY
   149                  VALUES '5' 'C' 'E' 'F'.
   150     12  DC-ERROR-CODE                 PIC X.
   151         88  NO-CONVERSION-ERROR        VALUE ' '.
   152         88  DATE-CONVERSION-ERROR
   153                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   154         88  DATE-IS-ZERO               VALUE '1'.
   155         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL013.cbl
   156         88  DATE-IS-INVALID            VALUE '3'.
   157         88  DATE1-GREATER-DATE2        VALUE '4'.
   158         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   159         88  DATE-INVALID-OPTION        VALUE '9'.
   160         88  INVALID-CENTURY            VALUE 'A'.
   161         88  ONLY-CENTURY               VALUE 'B'.
   162         88  ONLY-LEAP-YEAR             VALUE 'C'.
   163         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   164     12  DC-END-OF-MONTH               PIC X.
   165         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   166     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   167         88  USE-NORMAL-PROCESS         VALUE ' '.
   168         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   169         88  ADJUST-UP-100-YRS          VALUE '2'.
   170     12  FILLER                        PIC X.
   171     12  DC-CONVERSION-DATES.
   172         16  DC-BIN-DATE-1             PIC XX.
   173         16  DC-BIN-DATE-2             PIC XX.
   174         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   175         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   176                       DC-GREG-DATE-1-EDIT.
   177             20  DC-EDIT1-MONTH        PIC 99.
   178             20  SLASH1-1              PIC X.
   179             20  DC-EDIT1-DAY          PIC 99.
   180             20  SLASH1-2              PIC X.
   181             20  DC-EDIT1-YEAR         PIC 99.
   182         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   183         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   184                     DC-GREG-DATE-2-EDIT.
   185             20  DC-EDIT2-MONTH        PIC 99.
   186             20  SLASH2-1              PIC X.
   187             20  DC-EDIT2-DAY          PIC 99.
   188             20  SLASH2-2              PIC X.
   189             20  DC-EDIT2-YEAR         PIC 99.
   190         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   191         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   192                     DC-GREG-DATE-1-YMD.
   193             20  DC-YMD-YEAR           PIC 99.
   194             20  DC-YMD-MONTH          PIC 99.
   195             20  DC-YMD-DAY            PIC 99.
   196         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   197         16  DC-GREG-DATE-1-MDY-R REDEFINES
   198                      DC-GREG-DATE-1-MDY.
   199             20  DC-MDY-MONTH          PIC 99.
   200             20  DC-MDY-DAY            PIC 99.
   201             20  DC-MDY-YEAR           PIC 99.
   202         16  DC-GREG-DATE-1-ALPHA.
   203             20  DC-ALPHA-MONTH        PIC X(10).
   204             20  DC-ALPHA-DAY          PIC 99.
   205             20  FILLER                PIC XX.
   206             20  DC-ALPHA-CENTURY.
   207                 24 DC-ALPHA-CEN-N     PIC 99.
   208             20  DC-ALPHA-YEAR         PIC 99.
   209         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   210         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   211         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   212         16  DC-JULIAN-DATE            PIC 9(05).
   213         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL013.cbl
   214                                       PIC 9(05).
   215         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   216             20  DC-JULIAN-YEAR        PIC 99.
   217             20  DC-JULIAN-DAYS        PIC 999.
   218         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   219         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   220         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   221     12  DATE-CONVERSION-VARIBLES.
   222         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   223         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   224             20  FILLER                PIC 9(3).
   225             20  HOLD-CEN-1-CCYY.
   226                 24  HOLD-CEN-1-CC     PIC 99.
   227                 24  HOLD-CEN-1-YY     PIC 99.
   228             20  HOLD-CEN-1-MO         PIC 99.
   229             20  HOLD-CEN-1-DA         PIC 99.
   230         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   231             20  HOLD-CEN-1-R-MO       PIC 99.
   232             20  HOLD-CEN-1-R-DA       PIC 99.
   233             20  HOLD-CEN-1-R-CCYY.
   234                 24  HOLD-CEN-1-R-CC   PIC 99.
   235                 24  HOLD-CEN-1-R-YY   PIC 99.
   236             20  FILLER                PIC 9(3).
   237         16  HOLD-CENTURY-1-X.
   238             20  FILLER                PIC X(3)  VALUE SPACES.
   239             20  HOLD-CEN-1-X-CCYY.
   240                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   241                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   242             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   243             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   244         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   245             20  HOLD-CEN-1-R-X-MO     PIC XX.
   246             20  HOLD-CEN-1-R-X-DA     PIC XX.
   247             20  HOLD-CEN-1-R-X-CCYY.
   248                 24  HOLD-CEN-1-R-X-CC PIC XX.
   249                 24  HOLD-CEN-1-R-X-YY PIC XX.
   250             20  FILLER                PIC XXX.
   251         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   252         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   253         16  DC-JULIAN-DATE-1          PIC 9(07).
   254         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   255             20  DC-JULIAN-1-CCYY.
   256                 24  DC-JULIAN-1-CC    PIC 99.
   257                 24  DC-JULIAN-1-YR    PIC 99.
   258             20  DC-JULIAN-DA-1        PIC 999.
   259         16  DC-JULIAN-DATE-2          PIC 9(07).
   260         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   261             20  DC-JULIAN-2-CCYY.
   262                 24  DC-JULIAN-2-CC    PIC 99.
   263                 24  DC-JULIAN-2-YR    PIC 99.
   264             20  DC-JULIAN-DA-2        PIC 999.
   265         16  DC-GREG-DATE-A-EDIT.
   266             20  DC-EDITA-MONTH        PIC 99.
   267             20  SLASHA-1              PIC X VALUE '/'.
   268             20  DC-EDITA-DAY          PIC 99.
   269             20  SLASHA-2              PIC X VALUE '/'.
   270             20  DC-EDITA-CCYY.
   271                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL013.cbl
   272                 24  DC-EDITA-YEAR     PIC 99.
   273         16  DC-GREG-DATE-B-EDIT.
   274             20  DC-EDITB-MONTH        PIC 99.
   275             20  SLASHB-1              PIC X VALUE '/'.
   276             20  DC-EDITB-DAY          PIC 99.
   277             20  SLASHB-2              PIC X VALUE '/'.
   278             20  DC-EDITB-CCYY.
   279                 24  DC-EDITB-CENT     PIC 99.
   280                 24  DC-EDITB-YEAR     PIC 99.
   281         16  DC-GREG-DATE-CYMD         PIC 9(08).
   282         16  DC-GREG-DATE-CYMD-R REDEFINES
   283                              DC-GREG-DATE-CYMD.
   284             20  DC-CYMD-CEN           PIC 99.
   285             20  DC-CYMD-YEAR          PIC 99.
   286             20  DC-CYMD-MONTH         PIC 99.
   287             20  DC-CYMD-DAY           PIC 99.
   288         16  DC-GREG-DATE-MDCY         PIC 9(08).
   289         16  DC-GREG-DATE-MDCY-R REDEFINES
   290                              DC-GREG-DATE-MDCY.
   291             20  DC-MDCY-MONTH         PIC 99.
   292             20  DC-MDCY-DAY           PIC 99.
   293             20  DC-MDCY-CEN           PIC 99.
   294             20  DC-MDCY-YEAR          PIC 99.
   295    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   296        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   297    12  DC-EL310-DATE                  PIC X(21).
   298    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL013.cbl
   300*                                COPY ELCATTR.
   301******************************************************************
   302*                                                                *
   303*                            ELCATTR.                            *
   304*                            VMOD=2.001                          *
   305*                                                                *
   306*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   307*                                                                *
   308*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   309*                                                                *
   310*                   POS 1   P=PROTECTED                          *
   311*                           U=UNPROTECTED                        *
   312*                           S=ASKIP                              *
   313*                   POS 2   A=ALPHA/NUMERIC                      *
   314*                           N=NUMERIC                            *
   315*                   POS 3   N=NORMAL                             *
   316*                           B=BRIGHT                             *
   317*                           D=DARK                               *
   318*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   319*                           OF=MODIFIED DATA TAG OFF             *
   320*                                                                *
   321*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   322******************************************************************
   323 01  ATTRIBUTE-LIST.
   324     12  AL-PABOF            PIC X       VALUE 'Y'.
   325     12  AL-PABON            PIC X       VALUE 'Z'.
   326     12  AL-PADOF            PIC X       VALUE '%'.
   327     12  AL-PADON            PIC X       VALUE '_'.
   328     12  AL-PANOF            PIC X       VALUE '-'.
   329     12  AL-PANON            PIC X       VALUE '/'.
   330     12  AL-SABOF            PIC X       VALUE '8'.
   331     12  AL-SABON            PIC X       VALUE '9'.
   332     12  AL-SADOF            PIC X       VALUE '@'.
   333     12  AL-SADON            PIC X       VALUE QUOTE.
   334     12  AL-SANOF            PIC X       VALUE '0'.
   335     12  AL-SANON            PIC X       VALUE '1'.
   336     12  AL-UABOF            PIC X       VALUE 'H'.
   337     12  AL-UABON            PIC X       VALUE 'I'.
   338     12  AL-UADOF            PIC X       VALUE '<'.
   339     12  AL-UADON            PIC X       VALUE '('.
   340     12  AL-UANOF            PIC X       VALUE ' '.
   341     12  AL-UANON            PIC X       VALUE 'A'.
   342     12  AL-UNBOF            PIC X       VALUE 'Q'.
   343     12  AL-UNBON            PIC X       VALUE 'R'.
   344     12  AL-UNDOF            PIC X       VALUE '*'.
   345     12  AL-UNDON            PIC X       VALUE ')'.
   346     12  AL-UNNOF            PIC X       VALUE '&'.
   347     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL013.cbl
   349*                                COPY ELCEMIB.
   350******************************************************************
   351*                                                                *
   352*                                                                *
   353*                            ELCEMIB.                            *
   354*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   355*                            VMOD=2.005                          *
   356*                                                                *
   357*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   358*                                                                *
   359******************************************************************
   360 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   361     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   362     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   363     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   364     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   365     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   366     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   367     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   368     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   369     12  EMI-SWITCH1             PIC X        VALUE '1'.
   370         88  EMI-NO-ERRORS                    VALUE '1'.
   371         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   372         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   373     12  EMI-SWITCH2             PIC X        VALUE '1'.
   374         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   375     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   376         88  EMI-AREA1-EMPTY                  VALUE '1'.
   377         88  EMI-AREA1-FULL                   VALUE '2'.
   378     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   379         88  EMI-AREA2-EMPTY                  VALUE '1'.
   380         88  EMI-AREA2-FULL                   VALUE '2'.
   381     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   382         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   383         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   384         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   385         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   386         88  EMI-BYPASS-FATALS                VALUE 'X'.
   387     12  EMI-ERROR-LINES.
   388         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   389         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   390         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   391         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   392             20  EMI-ERR-CODES OCCURS 10 TIMES.
   393                 24  EMI-ERR-NUM         PIC X(4).
   394                 24  EMI-FILLER          PIC X.
   395                 24  EMI-SEV             PIC X.
   396                 24  FILLER              PIC X.
   397             20  FILLER                  PIC X(02).
   398     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   399         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   400             20  EMI-ERROR-NUMBER    PIC X(4).
   401             20  EMI-FILL            PIC X.
   402             20  EMI-SEVERITY        PIC X.
   403             20  FILLER              PIC X.
   404             20  EMI-ERROR-TEXT.
   405                 24  EMI-TEXT-VARIABLE   PIC X(10).
   406                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL013.cbl
   407     12  EMI-SEVERITY-SAVE           PIC X.
   408         88  EMI-NOTE                    VALUE 'N'.
   409         88  EMI-WARNING                 VALUE 'W'.
   410         88  EMI-FORCABLE                VALUE 'F'.
   411         88  EMI-FATAL                   VALUE 'X'.
   412     12  EMI-MESSAGE-FLAG            PIC X.
   413         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   414         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   415     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   416     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   417         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   418         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   419         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   420     12  FILLER                      PIC X(137)  VALUE SPACES.
   421     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   422     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   423     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   424     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL013.cbl
   426*                                COPY ELCCALC.
   427******************************************************************
   428*                                                                *
   429*                           ELCCALC.                            *
   430*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   431*                            VMOD=2.025                          *
   432*                                                                *
   433*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   434*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   435*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   436*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   437*                                                                *
   438*  PASSED TO ELRTRM                                              *
   439*  -----------------                                             *
   440*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   441*  ORIGINAL TERM                                                 *
   442*  BEGINNING DATE                                                *
   443*  ENDING DATE                                                   *
   444*  COMPANY I.D.                                                  *
   445*  ACCOUNT MASTER USER FIELD                                     *
   446*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   447*  FREE LOOK DAYS                                                *
   448*                                                                *
   449*  RETURNED FROM ELRTRM                                          *
   450*  ---------------------                                         *
   451*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   452*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   453*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   454*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   455*----------------------------------------------------------------*
   456*  PASSED TO ELRAMT                                              *
   457*  ----------------                                              *
   458*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   459*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   460*  ORIGINAL AMOUNT                                               *
   461*  ALTERNATE BENEFIT (BALLON)                                    *
   462*  A.P.R. - NET PAY ONLY                                         *
   463*  METHOD
   464*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   465*  COMPANY I.D.                                                  *
   466*  BENEFIT TYPE                                                  *
   467*                                                                *
   468*  RETURNED FROM ELRAMT                                          *
   469*  --------------------                                          *
   470*  REMAINING AMOUNT 1 - CURRENT                                  *
   471*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   472*  REMAINING AMOUNT FACTOR
   473*----------------------------------------------------------------*
   474*  PASSED TO ELRESV                                              *
   475*  -----------------                                             *
   476*  CERTIFICATE EFFECTIVE DATE                                    *
   477*  VALUATION DATE                                                *
   478*  PAID THRU DATE                                                *
   479*  BENEFIT                                                       *
   480*  INCURRED DATE                                                 *
   481*  REPORTED DATE                                                 *
   482*  ISSUE AGE                                                     *
   483*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL013.cbl
   484*  CDT PERCENT                                                   *
   485*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   486* *CLAIM TYPE (LIFE, A/H)                                        *
   487* *REMAINING BENEFIT (FROM ELRAMT)                               *
   488* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   489*                                                                *
   490*  RETURNED FROM ELRESV                                          *
   491*  --------------------                                          *
   492*  CDT TABLE USED                                                *
   493*  CDT FACTOR USED                                               *
   494*  PAY TO CURRENT RESERVE                                        *
   495*  I.B.N.R. - A/H ONLY                                           *
   496*  FUTURE (ACCRUED) AH ONLY                                      *
   497*----------------------------------------------------------------*
   498*  PASSED TO ELRATE                                              *
   499*  ----------------                                              *
   500*  CERT ISSUE DATE                                               *
   501*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   502*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   503*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   504*  STATE CODE (CLIENT DEFINED)                                   *
   505*  STATE CODE (STANDARD P.O. ABBRV)                              *
   506*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   507*  DEVIATION CODE                                                *
   508*  ISSUE AGE                                                     *
   509*  ORIGINAL BENEFIT AMOUNT                                       *
   510*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   511*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   512*  BENEFIT KIND (LIFE OR A/H)                                    *
   513*  A.P.R.                                                        *
   514*  METHOD
   515*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   516*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   517*  COMPANY I.D. (3 CHARACTER)                                    *
   518*  BENEFIT CODE                                                  *
   519*  BENEFIT OVERRIDE CODE                                         *
   520*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   521*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   522*  JOINT INDICATOR (CSL ONLY)                                    *
   523*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   524*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   525*                                                                *
   526*  RETURNED FROM ELRATE                                          *
   527*  --------------------                                          *
   528*  CALCULATED PREMIUM                                            *
   529*  PREMIUM RATE                                                  *
   530*  MORTALITY CODE                                                *
   531*  MAX ATTAINED AGE                                              *
   532*  MAX AGE                                                       *
   533*  MAX TERM                                                      *
   534*  MAX MONTHLY BENEFIT                                           *
   535*  MAX TOTAL BENIFIT                                             *
   536*  COMPOSITE RATE (OPEN-END ONLY)                                *
   537*----------------------------------------------------------------*
   538*  PASSED TO ELRFND                                              *
   539*  ----------------                                              *
   540*  CERT ISSUE DATE                                               *
   541*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL013.cbl
   542*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   543*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   544*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   545*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   546*  STATE CODE (CLIENT DEFINED)                                   *
   547*  STATE CODE (STANDARD P.O. ABBRV)                              *
   548*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   549*  DEVIATION CODE                                                *
   550*  ISSUE AGE                                                     *
   551*  ORIGINAL BENEFIT AMOUNT                                       *
   552*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   553*  PROCESS TYPE (CANCEL)                                         *
   554*  BENEFIT KIND (LIFE OR A/H)                                    *
   555*  A.P.R.                                                        *
   556*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   557*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   558*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   559*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   560*  COMPANY I.D. (3 CHARACTER)                                    *
   561*  BENEFIT CODE                                                  *
   562*  BENEFIT OVERRIDE CODE                                         *
   563*                                                                *
   564*  RETURNED FROM ELRFND                                          *
   565*  --------------------                                          *
   566*  CALCULATED REFUND                                             *
   567*----------------------------------------------------------------*
   568*  PASSED TO ELEARN                                              *
   569*  ----------------                                              *
   570*  CERT ISSUE DATE                                               *
   571*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   572*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   573*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   574*  STATE CODE (CLIENT DEFINED)                                   *
   575*  STATE CODE (STANDARD P.O. ABBRV)                              *
   576*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   577*  DEVIATION CODE                                                *
   578*  ISSUE AGE                                                     *
   579*  ORIGINAL BENEFIT AMOUNT                                       *
   580*  BENEFIT KIND (LIFE OR A/H)                                    *
   581*  A.P.R.                                                        *
   582*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   583*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   584*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   585*  COMPANY I.D. (3 CHARACTER)                                    *
   586*  BENEFIT CODE                                                  *
   587*  BENEFIT OVERRIDE CODE                                         *
   588*                                                                *
   589*  RETURNED FROM ELEARN                                          *
   590*  --------------------                                          *
   591*  INDICATED  EARNINGS                                           *
   592*----------------------------------------------------------------*
   593*                 LENGTH = 450                                   *
   594*                                                                *
   595******************************************************************
   596******************************************************************
   597*                   C H A N G E   L O G
   598*
   599* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL013.cbl
   600*-----------------------------------------------------------------
   601*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   602* EFFECTIVE    NUMBER
   603*-----------------------------------------------------------------
   604* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   605* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   606* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   607* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   608* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   609* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   610* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   611******************************************************************
   612
   613 01  CALCULATION-PASS-AREA.
   614     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   615                                     COMP.
   616
   617     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   618       88  NO-CP-ERROR                             VALUE ZERO.
   619       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   620                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   621       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   622       88  CP-ERROR-IN-DATES                       VALUE '2'.
   623       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   624       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   625       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   626       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   627       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   628       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   629       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   630       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   631       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   632       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   633       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   634       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   635       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   636       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   637       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   638
   639     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   640       88  NO-CP-ERROR-2                           VALUE ZERO.
   641***********************  INPUT AREAS ****************************
   642
   643     12  CP-CALCULATION-AREA.
   644         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   645         16  CP-CERT-EFF-DT        PIC XX.
   646         16  CP-VALUATION-DT       PIC XX.
   647         16  CP-PAID-THRU-DT       PIC XX.
   648         16  CP-BENEFIT-TYPE       PIC X.
   649           88  CP-AH                               VALUE 'A' 'D'
   650                                                   'I' 'U'.
   651           88  CP-REDUCING-LIFE                    VALUE 'R'.
   652           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   653         16  CP-INCURRED-DT        PIC XX.
   654         16  CP-REPORTED-DT        PIC XX.
   655         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   656         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   657         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL013.cbl
   658                                     COMP-3.
   659         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   660                                     COMP-3.
   661         16  CP-CDT-METHOD         PIC X.
   662           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   663           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   664           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   665         16  CP-CLAIM-TYPE         PIC X.
   666           88  CP-AH-CLAIM                         VALUE 'A'.
   667           88  CP-LIFE-CLAIM                       VALUE 'L'.
   668         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   669                                     COMP-3.
   670         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   671                                     COMP-3.
   672         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   673                                     COMP-3.
   674         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   675                                     COMP-3.
   676         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   677                                     COMP-3.
   678         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   679                                     COMP-3.
   680         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   681                                     COMP-3.
   682         16  CP-REM-TERM-METHOD    PIC X.
   683           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   684           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   685           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   686           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   687           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   688           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   689           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   690         16  CP-EARNING-METHOD     PIC X.
   691           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   692           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   693           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   694           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   695           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   696           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   697           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   698           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   699           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   700           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   701           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   702           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   703         16  CP-PROCESS-TYPE       PIC X.
   704           88  CP-CLAIM                            VALUE '1'.
   705           88  CP-CANCEL                           VALUE '2'.
   706           88  CP-ISSUE                            VALUE '3'.
   707         16  CP-SPECIAL-CALC-CD    PIC X.
   708           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   709           88  CP-1-MTH-INTEREST               VALUE ' '.
   710           88  CP-0-MTH-INTEREST               VALUE 'A'.
   711           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   712           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   713           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   714           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   715           88  CP-FARM-PLAN                    VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL013.cbl
   716           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   717           88  CP-2-MTH-INTEREST               VALUE 'I'.
   718           88  CP-3-MTH-INTEREST               VALUE 'J'.
   719           88  CP-4-MTH-INTEREST               VALUE 'K'.
   720           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   721           88  CP-MORTGAGE-REC                 VALUE 'M'.
   722           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   723           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   724           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   725           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   726                                                     'W' 'X'.
   727           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   728           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   729           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   730           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   731           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   732           88  CP-SUMMARY-REC                  VALUE 'Z'.
   733           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   734           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   735           88  CP-AD-D-BENEFIT                 VALUE '4'.
   736           88  CP-CSL-METH-1                   VALUE '5'.
   737           88  CP-CSL-METH-2                   VALUE '6'.
   738           88  CP-CSL-METH-3                   VALUE '7'.
   739           88  CP-CSL-METH-4                   VALUE '8'.
   740
   741         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   742                                     COMP-3.
   743         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   744         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   745         16  CP-STATE              PIC XX          VALUE SPACE.
   746         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   747         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   748           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   749               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   750         16  CP-R78-OPTION         PIC X.
   751           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   752           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   753
   754         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   755         16  CP-IBNR-RESERVE-SW    PIC X.
   756         16  CP-CLAIM-STATUS       PIC X.
   757         16  CP-RATE-FILE          PIC X.
   758         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   759                                     COMP-3.
   760
   761         16  CP-LIFE-OVERRIDE-CODE PIC X.
   762         16  CP-AH-OVERRIDE-CODE   PIC X.
   763
   764         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   765                                     COMP-3.
   766         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   767                                     COMP-3.
   768         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   769                                     COMP-3.
   770         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   771                                     COMP-3.
   772
   773         16  CP-PAID-FROM-DATE     PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL013.cbl
   774         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   775         16  CP-EXT-DAYS-CALC      PIC X.
   776           88  CP-EXT-NO-CHG                   VALUE ' '.
   777           88  CP-EXT-CHG-LF                   VALUE '1'.
   778           88  CP-EXT-CHG-AH                   VALUE '2'.
   779           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   780         16  CP-DOMICILE-STATE     PIC XX.
   781         16  CP-CARRIER            PIC X.
   782         16  CP-REIN-FLAG          PIC X.
   783         16  CP-REM-TRM-CALC-OPTION PIC X.
   784           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   785                      '2' '3' '4' '5'.
   786           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   787           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   788           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   789           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   790           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   791           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   792           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   793           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   794         16  CP-SIG-SWITCH         PIC X.
   795         16  CP-RATING-METHOD      PIC X.
   796           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   797           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   798           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   799           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   800           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   801           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   802           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   803           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   804           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   805         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   806                                     COMP-3.
   807         16  CP-BEN-CATEGORY       PIC X.
   808         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   809         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   810                                   PIC S99V9(5) COMP-3.
   811         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   812         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   813                                   PIC S99V9(5) COMP-3.
   814         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   815         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   816         16  CP-EXPIRE-DT          PIC XX.
   817         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   818         16  FILLER                PIC X(35).
   819*        16  FILLER                PIC X(50).
   820
   821***************    OUTPUT FROM ELRESV   ************************
   822
   823         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   824
   825         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   826                                     COMP-3.
   827         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   828                                     COMP-3.
   829         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   830                                     COMP-3.
   831         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL013.cbl
   832                                     COMP-3.
   833         16  FILLER                PIC X(09).
   834***************    OUTPUT FROM ELRTRM   *************************
   835
   836         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   837                                     COMP-3.
   838         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   839                                     COMP-3.
   840         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   841                                     COMP-3.
   842         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   843                                     COMP-3.
   844         16  FILLER                PIC X(12).
   845
   846***************    OUTPUT FROM ELRAMT   *************************
   847
   848         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   849                                     COMP-3.
   850         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   851                                     COMP-3.
   852         16  FILLER                PIC X(12).
   853
   854***************    OUTPUT FROM ELRATE   *************************
   855
   856         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   857                                     COMP-3.
   858         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   859                                     COMP-3.
   860         16  CP-MORTALITY-CODE     PIC X(4).
   861         16  CP-RATE-EDIT-FLAG     PIC X.
   862             88  CP-RATES-NEED-APR                  VALUE '1'.
   863         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   864                                     COMP-3.
   865         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   866         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   867         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   868                                   PIC S9(7)V99 COMP-3.
   869         16  FILLER                PIC X(07).
   870
   871***************    OUTPUT FROM ELRFND   *************************
   872
   873         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   874                                     COMP-3.
   875         16  CP-REFUND-TYPE-USED   PIC X.
   876           88  CP-R-AS-R78                         VALUE '1'.
   877           88  CP-R-AS-PRORATA                     VALUE '2'.
   878           88  CP-R-AS-CALIF                       VALUE '3'.
   879           88  CP-R-AS-TEXAS                       VALUE '4'.
   880           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   881           88  CP-R-AS-NET-PAY                     VALUE '5'.
   882           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   883           88  CP-R-AS-MEAN                        VALUE '8'.
   884           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   885           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   886           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   887         16  FILLER                PIC X(12).
   888
   889***************    OUTPUT FROM ELEARN   *************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL013.cbl
   890
   891         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   892                                     COMP-3.
   893         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   894                                     COMP-3.
   895         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   896                                     COMP-3.
   897         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   898                                     COMP-3.
   899         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   900                                     COMP-3.
   901         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   902                                     COMP-3.
   903         16  CP-EARNING-TYPE-USED  PIC X.
   904           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   905           88  CP-E-AS-R78                         VALUE '1'.
   906           88  CP-E-AS-PRORATA                     VALUE '2'.
   907           88  CP-E-AS-TEXAS                       VALUE '4'.
   908           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
   909           88  CP-E-AS-NET-PAY                     VALUE '5'.
   910           88  CP-E-AS-ANTICIPATION                VALUE '6'.
   911           88  CP-E-AS-MEAN                        VALUE '8'.
   912           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
   913         16  FILLER                PIC X(12).
   914
   915***************    OUTPUT FROM ELPMNT   *************************
   916
   917         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
   918                                     COMP-3.
   919         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
   920                                     COMP-3.
   921         16  FILLER                PIC X(12).
   922
   923***************   MISC WORK AREAS    *****************************
   924         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
   925                                     COMP-3.
   926         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
   927                                     COMP-3.
   928         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
   929                                     COMP-3.
   930         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
   931                                     COMP-3.
   932         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
   933                                     COMP-3.
   934         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
   935                                     COMP-3.
   936         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
   937             88  OPEN-RATE-FILE                   VALUE 'O'.
   938             88  CLOSE-RATE-FILE                  VALUE 'C'.
   939             88  IO-ERROR                         VALUE 'E'.
   940
   941         16  CP-FIRST-PAY-DATE     PIC XX.
   942
   943         16  CP-JOINT-INDICATOR    PIC X.
   944
   945         16  CP-RESERVE-REMAINING-TERM
   946                                   PIC S9(4)V9    VALUE ZERO
   947                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL013.cbl
   948
   949         16  CP-INSURED-BIRTH-DT   PIC XX.
   950
   951         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
   952                                     COMP-3.
   953
   954         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
   955                                     COMP-3.
   956
   957         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
   958                                     COMP-3.
   959
   960         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
   961                                     COMP-3.
   962
   963         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
   964                                     COMP-3.
   965
   966         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
   967                                     COMP-3.
   968
   969         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
   970                                     COMP-3.
   971
   972         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
   973             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
   974
   975         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
   976                                     COMP-3.
   977         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   978                                     COMP-3.
   979         16  FILLER                PIC X(17).
   980******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL013.cbl
   982*                                COPY ELCAID.
   983******************************************************************
   984*                                                                *
   985*                            ELCAID.                             *
   986*                            VMOD=2.001                          *
   987*                                                                *
   988*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   989*                                                                *
   990*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   991*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   992******************************************************************
   993
   994 01  DFHAID.
   995   02  DFHNULL   PIC  X  VALUE  ' '.
   996   02  DFHENTER  PIC  X  VALUE  QUOTE.
   997   02  DFHCLEAR  PIC  X  VALUE  '_'.
   998   02  DFHPEN    PIC  X  VALUE  '='.
   999   02  DFHOPID   PIC  X  VALUE  'W'.
  1000   02  DFHPA1    PIC  X  VALUE  '%'.
  1001   02  DFHPA2    PIC  X  VALUE  '>'.
  1002   02  DFHPA3    PIC  X  VALUE  ','.
  1003   02  DFHPF1    PIC  X  VALUE  '1'.
  1004   02  DFHPF2    PIC  X  VALUE  '2'.
  1005   02  DFHPF3    PIC  X  VALUE  '3'.
  1006   02  DFHPF4    PIC  X  VALUE  '4'.
  1007   02  DFHPF5    PIC  X  VALUE  '5'.
  1008   02  DFHPF6    PIC  X  VALUE  '6'.
  1009   02  DFHPF7    PIC  X  VALUE  '7'.
  1010   02  DFHPF8    PIC  X  VALUE  '8'.
  1011   02  DFHPF9    PIC  X  VALUE  '9'.
  1012   02  DFHPF10   PIC  X  VALUE  ':'.
  1013   02  DFHPF11   PIC  X  VALUE  '#'.
  1014   02  DFHPF12   PIC  X  VALUE  '@'.
  1015   02  DFHPF13   PIC  X  VALUE  'A'.
  1016   02  DFHPF14   PIC  X  VALUE  'B'.
  1017   02  DFHPF15   PIC  X  VALUE  'C'.
  1018   02  DFHPF16   PIC  X  VALUE  'D'.
  1019   02  DFHPF17   PIC  X  VALUE  'E'.
  1020   02  DFHPF18   PIC  X  VALUE  'F'.
  1021   02  DFHPF19   PIC  X  VALUE  'G'.
  1022   02  DFHPF20   PIC  X  VALUE  'H'.
  1023   02  DFHPF21   PIC  X  VALUE  'I'.
  1024*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1025   02  DFHPF22   PIC  X  VALUE  '['.
  1026   02  DFHPF23   PIC  X  VALUE  '.'.
  1027   02  DFHPF24   PIC  X  VALUE  '<'.
  1028   02  DFHMSRE   PIC  X  VALUE  'X'.
  1029   02  DFHSTRF   PIC  X  VALUE  'h'.
  1030   02  DFHTRIG   PIC  X  VALUE  '"'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL013.cbl
  1032*                                COPY EL013S.
  1033 01  EL013AI.
  1034     05  FILLER            PIC  X(0012).
  1035*    -------------------------------
  1036     05  RUNDATEL PIC S9(0004) COMP.
  1037     05  RUNDATEF PIC  X(0001).
  1038     05  FILLER REDEFINES RUNDATEF.
  1039         10  RUNDATEA PIC  X(0001).
  1040     05  RUNDATEI PIC  X(0008).
  1041*    -------------------------------
  1042     05  RUNTIMEL PIC S9(0004) COMP.
  1043     05  RUNTIMEF PIC  X(0001).
  1044     05  FILLER REDEFINES RUNTIMEF.
  1045         10  RUNTIMEA PIC  X(0001).
  1046     05  RUNTIMEI PIC  X(0005).
  1047*    -------------------------------
  1048     05  ORIGTRML PIC S9(0004) COMP.
  1049     05  ORIGTRMF PIC  X(0001).
  1050     05  FILLER REDEFINES ORIGTRMF.
  1051         10  ORIGTRMA PIC  X(0001).
  1052     05  ORIGTRMI PIC  S9(3).
  1053*    -------------------------------
  1054     05  ERRCODEL PIC S9(0004) COMP.
  1055     05  ERRCODEF PIC  X(0001).
  1056     05  FILLER REDEFINES ERRCODEF.
  1057         10  ERRCODEA PIC  X(0001).
  1058     05  ERRCODEI PIC  X(0001).
  1059*    -------------------------------
  1060     05  CLASSCDL PIC S9(0004) COMP.
  1061     05  CLASSCDF PIC  X(0001).
  1062     05  FILLER REDEFINES CLASSCDF.
  1063         10  CLASSCDA PIC  X(0001).
  1064     05  CLASSCDI PIC  X(0002).
  1065*    -------------------------------
  1066     05  DEVCODEL PIC S9(0004) COMP.
  1067     05  DEVCODEF PIC  X(0001).
  1068     05  FILLER REDEFINES DEVCODEF.
  1069         10  DEVCODEA PIC  X(0001).
  1070     05  DEVCODEI PIC  X(0003).
  1071*    -------------------------------
  1072     05  RATEL PIC S9(0004) COMP.
  1073     05  RATEF PIC  X(0001).
  1074     05  FILLER REDEFINES RATEF.
  1075         10  RATEA PIC  X(0001).
  1076     05  RATEI PIC  X(0008).
  1077*    -------------------------------
  1078     05  ORIGBENL PIC S9(0004) COMP.
  1079     05  ORIGBENF PIC  X(0001).
  1080     05  FILLER REDEFINES ORIGBENF.
  1081         10  ORIGBENA PIC  X(0001).
  1082     05  ORIGBENI PIC  S9(9)V99.
  1083*    -------------------------------
  1084     05  PREMIUML PIC S9(0004) COMP.
  1085     05  PREMIUMF PIC  X(0001).
  1086     05  FILLER REDEFINES PREMIUMF.
  1087         10  PREMIUMA PIC  X(0001).
  1088     05  PREMIUMI PIC  X(0010).
  1089*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL013.cbl
  1090     05  ORIGPRML PIC S9(0004) COMP.
  1091     05  ORIGPRMF PIC  X(0001).
  1092     05  FILLER REDEFINES ORIGPRMF.
  1093         10  ORIGPRMA PIC  X(0001).
  1094     05  ORIGPRMI PIC  S9(7)V99.
  1095*    -------------------------------
  1096     05  FACTORL PIC S9(0004) COMP.
  1097     05  FACTORF PIC  X(0001).
  1098     05  FILLER REDEFINES FACTORF.
  1099         10  FACTORA PIC  X(0001).
  1100     05  FACTORI PIC  X(0008).
  1101*    -------------------------------
  1102     05  BENTYPEL PIC S9(0004) COMP.
  1103     05  BENTYPEF PIC  X(0001).
  1104     05  FILLER REDEFINES BENTYPEF.
  1105         10  BENTYPEA PIC  X(0001).
  1106     05  BENTYPEI PIC  X(0001).
  1107*    -------------------------------
  1108     05  BENCODEL PIC S9(0004) COMP.
  1109     05  BENCODEF PIC  X(0001).
  1110     05  FILLER REDEFINES BENCODEF.
  1111         10  BENCODEA PIC  X(0001).
  1112     05  BENCODEI PIC  X(0002).
  1113*    -------------------------------
  1114     05  STCODEL PIC S9(0004) COMP.
  1115     05  STCODEF PIC  X(0001).
  1116     05  FILLER REDEFINES STCODEF.
  1117         10  STCODEA PIC  X(0001).
  1118     05  STCODEI PIC  X(0002).
  1119*    -------------------------------
  1120     05  STABBRL PIC S9(0004) COMP.
  1121     05  STABBRF PIC  X(0001).
  1122     05  FILLER REDEFINES STABBRF.
  1123         10  STABBRA PIC  X(0001).
  1124     05  STABBRI PIC  X(0002).
  1125*    -------------------------------
  1126     05  COMPIDL PIC S9(0004) COMP.
  1127     05  COMPIDF PIC  X(0001).
  1128     05  FILLER REDEFINES COMPIDF.
  1129         10  COMPIDA PIC  X(0001).
  1130     05  COMPIDI PIC  X(0003).
  1131*    -------------------------------
  1132     05  COMPCDL PIC S9(0004) COMP.
  1133     05  COMPCDF PIC  X(0001).
  1134     05  FILLER REDEFINES COMPCDF.
  1135         10  COMPCDA PIC  X(0001).
  1136     05  COMPCDI PIC  9(3).
  1137*    -------------------------------
  1138     05  ISSAGEL PIC S9(0004) COMP.
  1139     05  ISSAGEF PIC  X(0001).
  1140     05  FILLER REDEFINES ISSAGEF.
  1141         10  ISSAGEA PIC  X(0001).
  1142     05  ISSAGEI PIC  X(0002).
  1143*    -------------------------------
  1144     05  RATMETHL PIC S9(0004) COMP.
  1145     05  RATMETHF PIC  X(0001).
  1146     05  FILLER REDEFINES RATMETHF.
  1147         10  RATMETHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL013.cbl
  1148     05  RATMETHI PIC  X(0001).
  1149*    -------------------------------
  1150     05  CALCODEL PIC S9(0004) COMP.
  1151     05  CALCODEF PIC  X(0001).
  1152     05  FILLER REDEFINES CALCODEF.
  1153         10  CALCODEA PIC  X(0001).
  1154     05  CALCODEI PIC  X(0001).
  1155*    -------------------------------
  1156     05  APRL PIC S9(0004) COMP.
  1157     05  APRF PIC  X(0001).
  1158     05  FILLER REDEFINES APRF.
  1159         10  APRA PIC  X(0001).
  1160     05  APRI PIC  S9(3)V9(4).
  1161*    -------------------------------
  1162     05  CAPTERML PIC S9(0004) COMP.
  1163     05  CAPTERMF PIC  X(0001).
  1164     05  FILLER REDEFINES CAPTERMF.
  1165         10  CAPTERMA PIC  X(0001).
  1166     05  CAPTERMI PIC  S9(3).
  1167*    -------------------------------
  1168     05  PAYFREQL PIC S9(0004) COMP.
  1169     05  PAYFREQF PIC  X(0001).
  1170     05  FILLER REDEFINES PAYFREQF.
  1171         10  PAYFREQA PIC  X(0001).
  1172     05  PAYFREQI PIC  X(0002).
  1173*    -------------------------------
  1174     05  CERTISSL PIC S9(0004) COMP.
  1175     05  CERTISSF PIC  X(0001).
  1176     05  FILLER REDEFINES CERTISSF.
  1177         10  CERTISSA PIC  X(0001).
  1178     05  CERTISSI PIC  X(0006).
  1179*    -------------------------------
  1180     05  FSTPMTL PIC S9(0004) COMP.
  1181     05  FSTPMTF PIC  X(0001).
  1182     05  FILLER REDEFINES FSTPMTF.
  1183         10  FSTPMTA PIC  X(0001).
  1184     05  FSTPMTI PIC  X(0006).
  1185*    -------------------------------
  1186     05  EXTDAYL PIC S9(0004) COMP.
  1187     05  EXTDAYF PIC  X(0001).
  1188     05  FILLER REDEFINES EXTDAYF.
  1189         10  EXTDAYA PIC  X(0001).
  1190     05  EXTDAYI PIC  X(0003).
  1191*    -------------------------------
  1192     05  DEVPCTL PIC S9(0004) COMP.
  1193     05  DEVPCTF PIC  X(0001).
  1194     05  FILLER REDEFINES DEVPCTF.
  1195         10  DEVPCTA PIC  X(0001).
  1196     05  DEVPCTI PIC  S99V9(6).
  1197*    -------------------------------
  1198     05  ERRMSGL PIC S9(0004) COMP.
  1199     05  ERRMSGF PIC  X(0001).
  1200     05  FILLER REDEFINES ERRMSGF.
  1201         10  ERRMSGA PIC  X(0001).
  1202     05  ERRMSGI PIC  X(0072).
  1203 01  EL013AO REDEFINES EL013AI.
  1204     05  FILLER            PIC  X(0012).
  1205*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL013.cbl
  1206     05  FILLER            PIC  X(0003).
  1207     05  RUNDATEO PIC  X(0008).
  1208*    -------------------------------
  1209     05  FILLER            PIC  X(0003).
  1210     05  RUNTIMEO PIC  99.99.
  1211*    -------------------------------
  1212     05  FILLER            PIC  X(0003).
  1213     05  ORIGTRMO PIC  X(0003).
  1214*    -------------------------------
  1215     05  FILLER            PIC  X(0003).
  1216     05  ERRCODEO PIC  X(0001).
  1217*    -------------------------------
  1218     05  FILLER            PIC  X(0003).
  1219     05  CLASSCDO PIC  X(0002).
  1220*    -------------------------------
  1221     05  FILLER            PIC  X(0003).
  1222     05  DEVCODEO PIC  X(0003).
  1223*    -------------------------------
  1224     05  FILLER            PIC  X(0003).
  1225     05  RATEO PIC  ZZ.9(5).
  1226*    -------------------------------
  1227     05  FILLER            PIC  X(0003).
  1228     05  ORIGBENO PIC  X(0011).
  1229*    -------------------------------
  1230     05  FILLER            PIC  X(0003).
  1231     05  PREMIUMO PIC  Z(7).99.
  1232*    -------------------------------
  1233     05  FILLER            PIC  X(0003).
  1234     05  ORIGPRMO PIC  X(0009).
  1235*    -------------------------------
  1236     05  FILLER            PIC  X(0003).
  1237     05  FACTORO PIC  ZZ.9(5).
  1238*    -------------------------------
  1239     05  FILLER            PIC  X(0003).
  1240     05  BENTYPEO PIC  X(0001).
  1241*    -------------------------------
  1242     05  FILLER            PIC  X(0003).
  1243     05  BENCODEO PIC  X(0002).
  1244*    -------------------------------
  1245     05  FILLER            PIC  X(0003).
  1246     05  STCODEO PIC  X(0002).
  1247*    -------------------------------
  1248     05  FILLER            PIC  X(0003).
  1249     05  STABBRO PIC  X(0002).
  1250*    -------------------------------
  1251     05  FILLER            PIC  X(0003).
  1252     05  COMPIDO PIC  X(0003).
  1253*    -------------------------------
  1254     05  FILLER            PIC  X(0003).
  1255     05  COMPCDO PIC  X(0003).
  1256*    -------------------------------
  1257     05  FILLER            PIC  X(0003).
  1258     05  ISSAGEO PIC  X(0002).
  1259*    -------------------------------
  1260     05  FILLER            PIC  X(0003).
  1261     05  RATMETHO PIC  X(0001).
  1262*    -------------------------------
  1263     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL013.cbl
  1264     05  CALCODEO PIC  X(0001).
  1265*    -------------------------------
  1266     05  FILLER            PIC  X(0003).
  1267     05  APRO PIC  X(0007).
  1268*    -------------------------------
  1269     05  FILLER            PIC  X(0003).
  1270     05  CAPTERMO PIC  X(0003).
  1271*    -------------------------------
  1272     05  FILLER            PIC  X(0003).
  1273     05  PAYFREQO PIC  X(0002).
  1274*    -------------------------------
  1275     05  FILLER            PIC  X(0003).
  1276     05  CERTISSO PIC  X(0006).
  1277*    -------------------------------
  1278     05  FILLER            PIC  X(0003).
  1279     05  FSTPMTO PIC  X(0006).
  1280*    -------------------------------
  1281     05  FILLER            PIC  X(0003).
  1282     05  EXTDAYO PIC  X(0003).
  1283*    -------------------------------
  1284     05  FILLER            PIC  X(0003).
  1285     05  DEVPCTO PIC  X(0008).
  1286*    -------------------------------
  1287     05  FILLER            PIC  X(0003).
  1288     05  ERRMSGO PIC  X(0072).
  1289*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL013.cbl
  1291****************************************************************
  1292*
  1293* Copyright (c) 2007 by Clerity Solutions, Inc.
  1294* All rights reserved.
  1295*
  1296****************************************************************
  1297 01  DFHEIV.
  1298   02  DFHEIV0               PIC X(35).
  1299   02  DFHEIV1               PIC X(08).
  1300   02  DFHEIV2               PIC X(08).
  1301   02  DFHEIV3               PIC X(08).
  1302   02  DFHEIV4               PIC X(06).
  1303   02  DFHEIV5               PIC X(04).
  1304   02  DFHEIV6               PIC X(04).
  1305   02  DFHEIV7               PIC X(02).
  1306   02  DFHEIV8               PIC X(02).
  1307   02  DFHEIV9               PIC X(01).
  1308   02  DFHEIV10              PIC S9(7) COMP-3.
  1309   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1310   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1311   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1312   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1313   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1314   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1315   02  DFHEIV17              PIC X(04).
  1316   02  DFHEIV18              PIC X(04).
  1317   02  DFHEIV19              PIC X(04).
  1318   02  DFHEIV20              USAGE IS POINTER.
  1319   02  DFHEIV21              USAGE IS POINTER.
  1320   02  DFHEIV22              USAGE IS POINTER.
  1321   02  DFHEIV23              USAGE IS POINTER.
  1322   02  DFHEIV24              USAGE IS POINTER.
  1323   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1324   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1325   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1326   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1327   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1328   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1329   02  FILLER                PIC X(02).
  1330   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1331   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1332   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1333   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1334   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1335 LINKAGE  SECTION.
  1336*****************************************************************
  1337*                                                               *
  1338* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1339* All rights reserved.                                          *
  1340*                                                               *
  1341*****************************************************************
  1342 01  dfheiblk.
  1343     02  eibtime          pic s9(7) comp-3.
  1344     02  eibdate          pic s9(7) comp-3.
  1345     02  eibtrnid         pic x(4).
  1346     02  eibtaskn         pic s9(7) comp-3.
  1347     02  eibtrmid         pic x(4).
  1348     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL013.cbl
  1349     02  eibcposn         pic s9(4) comp.
  1350     02  eibcalen         pic s9(4) comp.
  1351     02  eibaid           pic x(1).
  1352     02  eibfiller1       pic x(1).
  1353     02  eibfn            pic x(2).
  1354     02  eibfiller2       pic x(2).
  1355     02  eibrcode         pic x(6).
  1356     02  eibfiller3       pic x(2).
  1357     02  eibds            pic x(8).
  1358     02  eibreqid         pic x(8).
  1359     02  eibrsrce         pic x(8).
  1360     02  eibsync          pic x(1).
  1361     02  eibfree          pic x(1).
  1362     02  eibrecv          pic x(1).
  1363     02  eibsend          pic x(1).
  1364     02  eibatt           pic x(1).
  1365     02  eibeoc           pic x(1).
  1366     02  eibfmh           pic x(1).
  1367     02  eibcompl         pic x(1).
  1368     02  eibsig           pic x(1).
  1369     02  eibconf          pic x(1).
  1370     02  eiberr           pic x(1).
  1371     02  eibrldbk         pic x(1).
  1372     02  eiberrcd         pic x(4).
  1373     02  eibsynrb         pic x(1).
  1374     02  eibnodat         pic x(1).
  1375     02  eibfiller5       pic x(2).
  1376     02  eibresp          pic 9(09) comp.
  1377     02  eibresp2         pic 9(09) comp.
  1378     02  dfheigdj         pic s9(4) comp.
  1379     02  dfheigdk         pic s9(4) comp.
  1380 01  DFHCOMMAREA                 PIC X(450).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL013.cbl
  1382 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1383 0000-DFHEXIT SECTION.
  1384     MOVE '9#                    $   ' TO DFHEIV0.
  1385     MOVE 'EL013' TO DFHEIV1.
  1386     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1387     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1388     MOVE '5'                    TO DC-OPTION-CODE.
  1389     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  1390     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1391     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  1392
  1393     IF EIBAID = DFHCLEAR
  1394         GO TO 8950-CLEAR-RETURN.
  1395
  1396     MOVE LOW-VALUES             TO EL013AO.
  1397
  1398     IF EIBCALEN NOT GREATER THAN ZERO
  1399         GO TO 8100-SEND-INITIAL-MAP.
  1400
  1401     MOVE DFHCOMMAREA            TO CALCULATION-PASS-AREA.
  1402
  1403
  1404* EXEC CICS RECEIVE
  1405*        MAP     (MAP-NAME)
  1406*        MAPSET  (MAPSET-NAME)
  1407*        INTO    (EL013AI)
  1408*    END-EXEC.
  1409     MOVE LENGTH OF
  1410      EL013AI
  1411       TO DFHEIV11
  1412*    MOVE '8"T I  L              ''   #00001399' TO DFHEIV0
  1413     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1414     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1415     MOVE X'2020233030303031333939' TO DFHEIV0(25:11)
  1416     CALL 'kxdfhei1' USING DFHEIV0,
  1417           MAP-NAME,
  1418           EL013AI,
  1419           DFHEIV11,
  1420           MAPSET-NAME,
  1421           DFHEIV99,
  1422           DFHEIV99
  1423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1424
  1425
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL013.cbl
  1427 1000-MOVE-DATA-TO-PASS-AREA.
  1428     IF ORIGTRML NOT = ZEROS
  1429         IF ORIGTRMI NUMERIC
  1430             IF ORIGTRMI GREATER 0 AND LESS 361
  1431                 MOVE ORIGTRMI   TO CP-ORIGINAL-TERM
  1432                 MOVE AL-UANON   TO ORIGTRMA
  1433             ELSE
  1434                 MOVE ER-2550    TO EMI-ERROR
  1435                 MOVE -1         TO ORIGTRML
  1436                 MOVE AL-UNBON   TO ORIGTRMA
  1437                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1438         ELSE
  1439             MOVE ER-2496        TO EMI-ERROR
  1440             MOVE -1             TO ORIGTRML
  1441             MOVE AL-UNBON       TO ORIGTRMA
  1442             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1443     ELSE
  1444         MOVE ER-2477            TO EMI-ERROR
  1445         MOVE -1                 TO ORIGTRML
  1446         MOVE AL-UNBON           TO ORIGTRMA
  1447         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1448
  1449     IF CLASSCDL NOT = ZEROS
  1450         MOVE CLASSCDI           TO CP-CLASS-CODE
  1451         MOVE AL-UANON           TO CLASSCDA
  1452     ELSE
  1453         MOVE ER-2551            TO EMI-ERROR
  1454         MOVE -1                 TO CLASSCDL
  1455         MOVE AL-UABON           TO CLASSCDA
  1456         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1457
  1458     IF DEVCODEL NOT = ZEROS
  1459         MOVE DEVCODEI           TO CP-DEVIATION-CODE
  1460         MOVE AL-UANON           TO DEVCODEA
  1461     ELSE
  1462         MOVE ER-2552            TO EMI-ERROR
  1463         MOVE -1                 TO DEVCODEL
  1464         MOVE AL-UABON           TO DEVCODEA
  1465         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1466
  1467     IF ORIGBENL NOT = ZEROS
  1468         IF ORIGBENI NUMERIC
  1469             MOVE ORIGBENI       TO CP-ORIGINAL-BENEFIT
  1470             MOVE AL-UNNON       TO ORIGBENA
  1471         ELSE
  1472             MOVE ER-2485        TO EMI-ERROR
  1473             MOVE -1             TO ORIGBENL
  1474             MOVE AL-UNBON       TO ORIGBENA
  1475             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1476     ELSE
  1477         MOVE ER-2553            TO EMI-ERROR
  1478         MOVE -1                 TO ORIGBENL
  1479         MOVE AL-UNBON           TO ORIGBENA
  1480         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1481
  1482     IF ORIGPRML NOT = ZEROS
  1483         IF ORIGPRMI NUMERIC
  1484             MOVE ORIGPRMI       TO CP-ORIGINAL-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL013.cbl
  1485             MOVE AL-UNNON       TO ORIGPRMA
  1486         ELSE
  1487             MOVE ER-2484        TO EMI-ERROR
  1488             MOVE -1             TO ORIGPRML
  1489             MOVE AL-UNBON       TO ORIGPRMA
  1490             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1491     ELSE
  1492         MOVE ZEROS              TO CP-ORIGINAL-PREMIUM.
  1493
  1494     IF BENTYPEI = 'L' OR 'A'
  1495         MOVE BENTYPEI           TO CP-BENEFIT-TYPE
  1496         MOVE AL-UANON           TO BENTYPEA
  1497         IF BENTYPEI IS EQUAL TO 'L'
  1498             MOVE BENTYPEI       TO CP-LIFE-OVERRIDE-CODE
  1499         ELSE
  1500             MOVE BENTYPEI       TO CP-AH-OVERRIDE-CODE
  1501     ELSE
  1502         MOVE ER-2481            TO EMI-ERROR
  1503         MOVE -1                 TO BENTYPEL
  1504         MOVE AL-UABON           TO BENTYPEA
  1505         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1506
  1507     IF BENCODEL NOT = ZEROS
  1508         MOVE BENCODEI           TO WS-EDIT-BEN-CODE
  1509         IF NOT INVALID-BENEFIT-CODE
  1510             MOVE BENCODEI       TO CP-BENEFIT-CD
  1511             MOVE AL-UANON       TO BENCODEA
  1512         ELSE
  1513             MOVE ER-2489        TO EMI-ERROR
  1514             MOVE -1             TO BENCODEL
  1515             MOVE AL-UABON       TO BENCODEA
  1516             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1517     ELSE
  1518         MOVE ER-2554            TO EMI-ERROR
  1519         MOVE -1                 TO BENCODEL
  1520         MOVE AL-UABON           TO BENCODEA
  1521         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1522
  1523     IF STCODEL NOT = ZEROS
  1524         MOVE STCODEI            TO CP-STATE
  1525         MOVE AL-UNNON           TO STCODEA
  1526     ELSE
  1527         MOVE ER-2555            TO EMI-ERROR
  1528         MOVE -1                 TO STCODEL
  1529         MOVE AL-UNBON           TO STCODEA
  1530         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1531
  1532     IF STABBRL NOT = ZEROS
  1533         MOVE STABBRI            TO CP-STATE-STD-ABBRV
  1534         MOVE AL-UANON           TO STABBRA.
  1535
  1536     IF COMPIDL NOT = ZEROS
  1537         MOVE COMPIDI            TO CP-COMPANY-ID
  1538         MOVE AL-UANON           TO COMPIDA.
  1539
  1540     IF COMPCDL NOT = ZEROS
  1541         IF COMPCDI NUMERIC
  1542             MOVE COMPCDI        TO WS-COMPANY-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL013.cbl
  1543             MOVE WS-COMP-CD     TO CP-COMPANY-CD
  1544             MOVE AL-UANON       TO COMPCDA
  1545         ELSE
  1546             MOVE ER-2488        TO EMI-ERROR
  1547             MOVE -1             TO COMPCDL
  1548             MOVE AL-UNBON       TO COMPCDA
  1549             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1550     ELSE
  1551         MOVE ER-2556            TO EMI-ERROR
  1552         MOVE -1                 TO COMPCDL
  1553         MOVE AL-UNBON           TO COMPCDA
  1554         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1555
  1556     IF ISSAGEL NOT = ZEROS
  1557         IF ISSAGEI NUMERIC
  1558             MOVE ISSAGEI        TO CP-ISSUE-AGE
  1559             MOVE AL-UNNON       TO ISSAGEA
  1560         ELSE
  1561             MOVE ER-2490        TO EMI-ERROR
  1562             MOVE -1             TO ISSAGEL
  1563             MOVE AL-UNBON       TO ISSAGEA
  1564             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1565     ELSE
  1566         MOVE ER-2557            TO EMI-ERROR
  1567         MOVE -1                 TO ISSAGEL
  1568         MOVE AL-UNBON           TO ISSAGEA
  1569         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1570
  1571     IF RATMETHL NOT = ZEROS
  1572         MOVE RATMETHI           TO CP-EARNING-METHOD
  1573         MOVE AL-UANON           TO RATMETHA.
  1574
  1575     IF CALCODEL NOT = ZEROS
  1576         MOVE CALCODEI           TO CP-SPECIAL-CALC-CD
  1577         MOVE AL-UANON           TO CALCODEA.
  1578
  1579     IF APRL NOT = ZEROS
  1580         IF APRI NUMERIC
  1581             MOVE APRI           TO CP-LOAN-APR
  1582             MOVE AL-UNNON       TO APRA
  1583         ELSE
  1584             MOVE ER-2487        TO EMI-ERROR
  1585             MOVE -1             TO APRL
  1586             MOVE AL-UNBON       TO APRA
  1587             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1588
  1589     IF CP-EARN-AS-NET-PAY  AND  CP-TRUNCATED-LIFE
  1590         IF CAPTERML NOT = ZEROS
  1591             IF CAPTERMI NUMERIC
  1592                 IF CAPTERMI GREATER THAN 0 AND LESS THAN 361
  1593                     MOVE CAPTERMI   TO CP-LOAN-TERM
  1594                     MOVE AL-UANON   TO CAPTERMA
  1595                 ELSE
  1596                     MOVE ER-2550    TO EMI-ERROR
  1597                     MOVE -1         TO CAPTERML
  1598                     MOVE AL-UNBON   TO CAPTERMA
  1599                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1600             ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL013.cbl
  1601                 MOVE ER-2496        TO EMI-ERROR
  1602                 MOVE -1             TO CAPTERML
  1603                 MOVE AL-UNBON       TO CAPTERMA
  1604                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1605         ELSE
  1606             MOVE ER-2477            TO EMI-ERROR
  1607             MOVE -1                 TO CAPTERML
  1608             MOVE AL-UNBON           TO CAPTERMA
  1609             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1610     ELSE
  1611         MOVE ZEROS              TO CP-LOAN-TERM
  1612         MOVE AL-UANON           TO CAPTERMA.
  1613
  1614     IF PAYFREQL NOT = ZEROS
  1615         MOVE PAYFREQI           TO CP-PAY-FREQUENCY
  1616         MOVE AL-UANON           TO PAYFREQA.
  1617
  1618     IF CERTISSL NOT = ZEROS
  1619         IF CERTISSI NUMERIC
  1620             MOVE CERTISSI       TO DC-GREG-DATE-1-MDY
  1621             MOVE 4              TO DC-OPTION-CODE
  1622             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  1623             IF NO-CONVERSION-ERROR
  1624                 MOVE DC-BIN-DATE-1  TO CP-CERT-EFF-DT
  1625                 MOVE AL-UNNON   TO CERTISSA
  1626             ELSE
  1627                 MOVE ER-2474    TO EMI-ERROR
  1628                 MOVE -1         TO CERTISSL
  1629                 MOVE AL-UNBON   TO CERTISSA
  1630                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1631         ELSE
  1632             MOVE ER-2482        TO EMI-ERROR
  1633             MOVE -1             TO CERTISSL
  1634             MOVE AL-UNBON       TO CERTISSA
  1635             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1636     ELSE
  1637         MOVE EIBDATE            TO DC-JULIAN-YYDDD
  1638         MOVE 5                  TO DC-OPTION-CODE
  1639         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  1640         MOVE DC-BIN-DATE-1      TO CP-CERT-EFF-DT.
  1641
  1642     IF FSTPMTL NOT = ZEROS
  1643         IF FSTPMTI NUMERIC
  1644             MOVE FSTPMTI        TO DC-GREG-DATE-1-MDY
  1645             MOVE 4              TO DC-OPTION-CODE
  1646             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  1647             IF NO-CONVERSION-ERROR
  1648                 MOVE DC-BIN-DATE-1  TO CP-FIRST-PAY-DATE
  1649                 MOVE AL-UNNON   TO FSTPMTA
  1650             ELSE
  1651                 MOVE ER-0349    TO EMI-ERROR
  1652                 MOVE -1         TO FSTPMTL
  1653                 MOVE AL-UNBON   TO FSTPMTA
  1654                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1655         ELSE
  1656             MOVE ER-0349        TO EMI-ERROR
  1657             MOVE -1             TO FSTPMTL
  1658             MOVE AL-UNBON       TO FSTPMTA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL013.cbl
  1659             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1660     ELSE
  1661         MOVE EIBDATE            TO DC-JULIAN-YYDDD
  1662         MOVE 5                  TO DC-OPTION-CODE
  1663         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  1664         MOVE DC-BIN-DATE-1      TO CP-CERT-EFF-DT.
  1665
  1666     IF EXTDAYL NOT = ZEROS
  1667         IF EXTDAYI NUMERIC
  1668             MOVE EXTDAYI        TO CP-TERM-OR-EXT-DAYS
  1669             MOVE AL-UNNON       TO EXTDAYA
  1670         ELSE
  1671             MOVE ER-3032        TO EMI-ERROR
  1672             MOVE -1             TO EXTDAYL
  1673             MOVE AL-UNBON       TO EXTDAYA
  1674             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1675
  1676     IF DEVPCTL NOT = ZEROS
  1677         IF DEVPCTI NUMERIC
  1678             MOVE DEVPCTI        TO CP-RATE-DEV-PCT
  1679             MOVE AL-UNNON       TO DEVPCTA
  1680         ELSE
  1681             MOVE ER-3126        TO EMI-ERROR
  1682             MOVE -1             TO DEVPCTL
  1683             MOVE AL-UNBON       TO DEVPCTA
  1684             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1685
  1686     IF EMI-ERROR NOT = ZEROS
  1687         GO TO 8200-SEND-DATAONLY.
  1688
  1689     IF COMPIDI IS EQUAL TO 'NCB'
  1690         IF STABBRI IS EQUAL TO 'NC'
  1691             IF RATMETHI IS EQUAL TO '5'
  1692                 COMPUTE CP-ORIGINAL-BENEFIT =
  1693                     CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM.
  1694
  1695     MOVE LINK-ELRATE            TO PGM-NAME.
  1696
  1697     PERFORM 9700-LINK THRU 9700-EXIT.
  1698
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL013.cbl
  1700 2000-FORMAT-RESULTS.
  1701     IF CP-RETURN-CODE = ZERO
  1702         MOVE CP-CALC-PREMIUM    TO PREMIUMO
  1703         MOVE CP-CDT-FACTOR      TO FACTORO
  1704         MOVE CP-PREMIUM-RATE    TO RATEO
  1705     ELSE
  1706         MOVE CP-RETURN-CODE     TO ERRCODEO.
  1707
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL013.cbl
  1709 8100-SEND-INITIAL-MAP.
  1710     MOVE SAVE-DATE              TO RUNDATEO.
  1711     MOVE EIBTIME                TO TIME-IN.
  1712     MOVE TIME-OUT               TO RUNTIMEO.
  1713     MOVE -1                     TO ORIGTRML.
  1714     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  1715
  1716
  1717* EXEC CICS SEND
  1718*        MAP    (MAP-NAME)
  1719*        MAPSET (MAPSET-NAME)
  1720*        FROM   (EL013AO)
  1721*        ERASE
  1722*        CURSOR
  1723*    END-EXEC.
  1724     MOVE LENGTH OF
  1725      EL013AO
  1726       TO DFHEIV12
  1727     MOVE -1
  1728       TO DFHEIV11
  1729*    MOVE '8$     CT  E    H L F ,   #00001695' TO DFHEIV0
  1730     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1731     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1732     MOVE X'2020233030303031363935' TO DFHEIV0(25:11)
  1733     CALL 'kxdfhei1' USING DFHEIV0,
  1734           MAP-NAME,
  1735           EL013AO,
  1736           DFHEIV12,
  1737           MAPSET-NAME,
  1738           DFHEIV99,
  1739           DFHEIV99,
  1740           DFHEIV99,
  1741           DFHEIV11,
  1742           DFHEIV99,
  1743           DFHEIV99,
  1744           DFHEIV99
  1745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1746
  1747
  1748     GO TO 9100-RETURN-TRAN.
  1749
  1750 8200-SEND-DATAONLY.
  1751     MOVE SAVE-DATE              TO RUNDATEO.
  1752     MOVE EIBTIME                TO TIME-IN.
  1753     MOVE TIME-OUT               TO RUNTIMEO.
  1754     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  1755
  1756
  1757* EXEC CICS SEND
  1758*        MAP    (MAP-NAME)
  1759*        MAPSET (MAPSET-NAME)
  1760*        FROM   (EL013AO)
  1761*        DATAONLY
  1762*        CURSOR
  1763*    END-EXEC.
  1764     MOVE LENGTH OF
  1765      EL013AO
  1766       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL013.cbl
  1767     MOVE -1
  1768       TO DFHEIV11
  1769*    MOVE '8$D    CT       H L F ,   #00001711' TO DFHEIV0
  1770     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  1771     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1772     MOVE X'2020233030303031373131' TO DFHEIV0(25:11)
  1773     CALL 'kxdfhei1' USING DFHEIV0,
  1774           MAP-NAME,
  1775           EL013AO,
  1776           DFHEIV12,
  1777           MAPSET-NAME,
  1778           DFHEIV99,
  1779           DFHEIV99,
  1780           DFHEIV99,
  1781           DFHEIV11,
  1782           DFHEIV99,
  1783           DFHEIV99,
  1784           DFHEIV99
  1785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1786
  1787
  1788     MOVE LOW-VALUES             TO EL013AO.
  1789
  1790     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL013.cbl
  1792 8500-DATE-CONVERT.
  1793     MOVE LINK-ELDATCV           TO PGM-NAME.
  1794
  1795
  1796* EXEC CICS LINK
  1797*        PROGRAM    (PGM-NAME)
  1798*        COMMAREA   (DATE-CONVERSION-DATA)
  1799*        LENGTH     (DC-COMM-LENGTH)
  1800*    END-EXEC.
  1801*    MOVE '."C                   ''   #00001726' TO DFHEIV0
  1802     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1803     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1804     MOVE X'2020233030303031373236' TO DFHEIV0(25:11)
  1805     CALL 'kxdfhei1' USING DFHEIV0,
  1806           PGM-NAME,
  1807           DATE-CONVERSION-DATA,
  1808           DC-COMM-LENGTH,
  1809           DFHEIV99,
  1810           DFHEIV99,
  1811           DFHEIV99
  1812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1813
  1814
  1815 8500-EXIT.
  1816     EXIT.
  1817
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL013.cbl
  1819 8950-CLEAR-RETURN.
  1820     MOVE TRAN-COMPLETE-MSG      TO TEXT-AREA.
  1821
  1822 8990-SEND-TEXT.
  1823
  1824* EXEC CICS SEND TEXT
  1825*        FROM    (TEXT-AREA)
  1826*        LENGTH  (TEXT-LENGTH)
  1827*        ERASE
  1828*        FREEKB
  1829*    END-EXEC.
  1830*    MOVE '8&      T  E F  H   F -   #00001740' TO DFHEIV0
  1831     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  1832     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  1833     MOVE X'2020233030303031373430' TO DFHEIV0(25:11)
  1834     CALL 'kxdfhei1' USING DFHEIV0,
  1835           TEXT-AREA,
  1836           TEXT-LENGTH,
  1837           DFHEIV99,
  1838           DFHEIV99,
  1839           DFHEIV99,
  1840           DFHEIV99,
  1841           DFHEIV99,
  1842           DFHEIV99,
  1843           DFHEIV99,
  1844           DFHEIV99,
  1845           DFHEIV99,
  1846           DFHEIV99
  1847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1848
  1849
  1850 9000-RETURN-CICS.
  1851
  1852* EXEC CICS RETURN
  1853*    END-EXEC.
  1854*    MOVE '.(                    &   #00001748' TO DFHEIV0
  1855     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1856     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1857     MOVE X'2020233030303031373438' TO DFHEIV0(25:11)
  1858     CALL 'kxdfhei1' USING DFHEIV0,
  1859           DFHEIV99,
  1860           DFHEIV99,
  1861           DFHEIV99,
  1862           DFHEIV99,
  1863           DFHEIV99
  1864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1865
  1866
  1867
  1868
  1869 9100-RETURN-TRAN.
  1870
  1871* EXEC CICS RETURN
  1872*        TRANSID   (TRANS-ID)
  1873*        COMMAREA  (CALCULATION-PASS-AREA)
  1874*        LENGTH    (CP-COMM-LENGTH)
  1875*    END-EXEC.
  1876*    MOVE '.(CT                  &   #00001754' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL013.cbl
  1877     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1878     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1879     MOVE X'2020233030303031373534' TO DFHEIV0(25:11)
  1880     CALL 'kxdfhei1' USING DFHEIV0,
  1881           TRANS-ID,
  1882           CALCULATION-PASS-AREA,
  1883           CP-COMM-LENGTH,
  1884           DFHEIV99,
  1885           DFHEIV99
  1886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1887
  1888
  1889 9700-LINK.
  1890
  1891* EXEC CICS LINK
  1892*        PROGRAM   (PGM-NAME)
  1893*        COMMAREA  (CALCULATION-PASS-AREA)
  1894*        LENGTH    (CP-COMM-LENGTH)
  1895*    END-EXEC.
  1896*    MOVE '."C                   ''   #00001761' TO DFHEIV0
  1897     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1898     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1899     MOVE X'2020233030303031373631' TO DFHEIV0(25:11)
  1900     CALL 'kxdfhei1' USING DFHEIV0,
  1901           PGM-NAME,
  1902           CALCULATION-PASS-AREA,
  1903           CP-COMM-LENGTH,
  1904           DFHEIV99,
  1905           DFHEIV99,
  1906           DFHEIV99
  1907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1908
  1909
  1910 9700-EXIT.
  1911      EXIT.
  1912
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL013.cbl
  1914 9900-ERROR-FORMAT.
  1915     IF NOT EMI-ERRORS-COMPLETE
  1916         MOVE LINK-001           TO PGM-NAME
  1917
  1918* EXEC CICS LINK
  1919*            PROGRAM   (PGM-NAME)
  1920*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  1921*            LENGTH    (EMI-COMM-LENGTH)
  1922*        END-EXEC.
  1923*    MOVE '."C                   ''   #00001774' TO DFHEIV0
  1924     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1925     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1926     MOVE X'2020233030303031373734' TO DFHEIV0(25:11)
  1927     CALL 'kxdfhei1' USING DFHEIV0,
  1928           PGM-NAME,
  1929           ERROR-MESSAGE-INTERFACE-BLOCK,
  1930           EMI-COMM-LENGTH,
  1931           DFHEIV99,
  1932           DFHEIV99,
  1933           DFHEIV99
  1934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1935
  1936
  1937 9900-EXIT.
  1938     EXIT.
  1939
  1940 9990-ABEND.
  1941     MOVE LINK-004               TO PGM-NAME.
  1942     MOVE DFHEIBLK               TO EMI-LINE1.
  1943
  1944
  1945* EXEC CICS LINK
  1946*        PROGRAM   (PGM-NAME)
  1947*        COMMAREA  (EMI-LINE1)
  1948*        LENGTH    (72)
  1949*    END-EXEC.
  1950     MOVE 72
  1951       TO DFHEIV11
  1952*    MOVE '."C                   ''   #00001787' TO DFHEIV0
  1953     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1954     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1955     MOVE X'2020233030303031373837' TO DFHEIV0(25:11)
  1956     CALL 'kxdfhei1' USING DFHEIV0,
  1957           PGM-NAME,
  1958           EMI-LINE1,
  1959           DFHEIV11,
  1960           DFHEIV99,
  1961           DFHEIV99,
  1962           DFHEIV99
  1963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1964
  1965
  1966     GO TO 8200-SEND-DATAONLY.
  1967
  1968* GOBACK.
  1969     MOVE '9%                    "   ' TO DFHEIV0
  1970     MOVE 'EL013' TO DFHEIV1
  1971     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL013.cbl
  1972     GOBACK.
  1973
  1974 9999-DFHBACK SECTION.
  1975     MOVE '9%                    "   ' TO DFHEIV0
  1976     MOVE 'EL013' TO DFHEIV1
  1977     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1978     GOBACK.
  1979 9999-DFHEXIT.
  1980     IF DFHEIGDJ EQUAL 0001
  1981         NEXT SENTENCE.
  1982     MOVE '9%                    "   ' TO DFHEIV0
  1983     MOVE 'EL013' TO DFHEIV1
  1984     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1985     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2764     Code:        3745
