* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page   1
* SOCK00.cbl
* Options: int("SOCK00.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK00.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK00.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK00.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    13* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page   2
* SOCK00.cbl
    14*-----------------------------------------------------------------
    15* 091609  CR2009082400002  PEMA  ADD USER SELECT 3
    16* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
    17* 042612  CR2012042500004  PEMA  ADD CODE TO HANDLE AHL
    18* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    19* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    20* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    21* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
    22* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    23*-----------------------------------------------------------------
    24 identification division.
    25 program-id. SOCK00.
    26*         This program is the first invoked by the SOCK
    27*         transaction. This transaction must be submited
    28*         by a message transmited over a stream socket.
    29*         The first message format is:
    30*         aaaa,bbbbb              ccc
    31*         where "aaaa" is the tran id SOCK (1 to 4 characters)
    32*         and "bbbbb is either "RATE " or "STATE" and ccc is eithe
    33*         DCC or CID or any future company id
    34*         Information on the originating message and
    35*         remote socket is provided in the DFHCOMMAREA.
    36*         As its first action this program must send a
    37*         message to the requesting socket. This lets the
    38*         remote program know its request has been
    39*         accepted and the transaction started.
    40*         The program will make four transmissions to
    41*         the initating program in response to received
    42*         messages and then close the socket.
    43*         This program is provided to show method and
    44*         has minimal checking and error messages.
    45*         The Cobol compiler, unless instructed otherwise,
    46*         will hold its working storage integer data items in
    47*         machine idependent form. This matches the network
    48*         ordering of information. Care should be exercised
    49*         to ensure that this data ordering is correct when
    50*         calling system library functions or passing data
    51*         structure containing such data to functions.
    52 environment division.
    53 data division.
    54 working-storage section.
    55 01  DFH-START PIC X(04).
    56*
    57* program buffers
    58*
    59 77 ws-send-msg-size           pic s9(8) comp value 4096.
    60 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    61 77 ws-recv-buf                pic x(4096).
    62 77 ws-send-buf                pic x(4096) VALUE SPACES.
    63 77 ws-recv-total              pic s9(8) comp value 0.
    64 77 ws-recv-left               pic s9(8) comp value 0.
    65 77 ws-seq-num                 pic s9(8) comp value 0.
    66 77 ws-flags                   pic s9(8) comp value 0.
    67 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    68 77 WS-COMP-ID                   PIC XXX VALUE 'CID'.
    69 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    70 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    71 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page   3
* SOCK00.cbl
    72 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    73 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    74 77 S1                           PIC S999 COMP-3 VALUE +0.
    75 77 S2                           PIC S999 COMP-3 VALUE +0.
    76 77 WS-BUILD-SW                  PIC X.
    77    88  TIME-TO-BUILD               VALUE 'Y'.
    78 77 WS-SAVE-ERACCT               PIC X(2000).
    79 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    80 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    81    88  GET-RATES                    VALUE 'R'.
    82    88  GET-ACT-ACCTS                VALUE 'A'.
    83 77 ws-bin-eff-dt                pic xx  value low-values.
    84 77 ws-bin-1st-pay-dt            pic xx  value low-values.
    85 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    86 77 ws-disp-rate                 pic z9.99999.
    87 77  WS-ERACCT-SW                PIC X VALUE ' '.
    88     88  END-OF-ERACCT                 VALUE 'Y'.
    89 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    90     88  END-OF-ERCTBL                 VALUE 'Y'.
    91 77  WS-STATUS                   PIC X.
    92 01  ws-work-date.
    93     05  ws-work-ccyy            pic x(4).
    94     05  ws-work-mm              pic xx.
    95     05  ws-work-dd              pic xx.
    96 01  ws-work-date-num redefines ws-work-date
    97                                 pic 9(8).
    98 01  WS-AM-CITY-STATE            PIC X(30) VALUE SPACES.
    99 01  ws-work-apr.
   100     05  ws-apr-num              pic 99V999.
   101 01  ws-work-ben.
   102     05  ws-ben-num              pic 9(5).
   103 01  ws-work-term.
   104     05  ws-term-num             pic 999.
   105 01  ws-get-rate-data.
   106     05  rate-state              pic xx.
   107     05  rate-lf-ah              pic x.
   108     05  rate-ben-code           pic xx.
   109     05  rate-earn-meth          pic x.
   110     05  rate-ben-amt            pic x(5).
   111     05  rate-eff-date           pic x(10).
   112     05  rate-term               pic xxx.
   113     05  rate-apr                pic x(5).
   114 01  WS-FIN-RESP                 PIC X(10).
   115 01  WS-GA-DATA.
   116     05  WS-GA-NUM               PIC X(10).
   117     05  WS-GA-PRIMARY-CONTACT   PIC X(30).
   118     05  WS-GA-NAME              PIC X(30).
   119     05  WS-GA-MAIL-NAME         PIC X(30).
   120     05  WS-GA-ADDR1             PIC X(30).
   121     05  WS-GA-ADDR2             PIC X(30).
   122     05  WS-GA-ADDR3             PIC X(30).
   123     05  WS-GA-ZIP               PIC X(9).
   124     05  WS-GA-PHONE             PIC X(10).
   125 01  WS-AM-KEY.
   126     05  WS-AM-COMPANY-CD        PIC X.
   127     05  WS-AM-CARRIER           PIC X.
   128     05  WS-AM-GROUP             PIC X(6).
   129     05  WS-AM-STATE             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page   4
* SOCK00.cbl
   130     05  WS-AM-ACCOUNT           PIC X(10).
   131     05  WS-AM-EXP-DT            PIC XX.
   132     05  FILLER                  PIC X(4).
   133 01  WS-NT-KEY.
   134     05  WS-NT-COMPANY-CD        PIC X.
   135     05  WS-NT-CARRIER           PIC X.
   136     05  WS-NT-GROUP             PIC X(6).
   137     05  WS-NT-STATE             PIC XX.
   138     05  WS-NT-ACCOUNT           PIC X(10).
   139     05  WS-NT-REC-TYPE          PIC X.
   140     05  WS-NT-SEQ-NO            PIC S9(4) COMP.
   141 01  WS-AM-ALT-KEY.
   142     05  WS-AM-ALT-ACCOUNT       PIC X(10).
   143     05  WS-AM-ALT-EXP-DT        PIC XX.
   144 01  WS-CT-KEY-SAVE              PIC X(5).
   145 01  WS-CT-KEY.
   146     05  WS-CT-COMPANY-CD        PIC X.
   147     05  WS-CT-TABLE             PIC XXX.
   148     05  WS-CT-BEN-TYPE          PIC X.
   149     05  WS-CT-BEN-CODE          PIC XX.
   150 01  WS-CF-KEY-SAVE              PIC X(10).
   151 01  WS-CF-KEY.
   152     05  WS-CF-COMPANY-ID        PIC XXX.
   153     05  WS-CF-RECORD-TYPE       PIC X.
   154     05  WS-CF-ACCESS            PIC X(4).
   155     05  WS-CF-SEQ-NO            PIC S9(4) COMP.
   156 01  WS-CO-KEY.
   157     05  WS-CO-COMPANY-CD        PIC X.
   158     05  WS-CO-CARRIER           PIC X.
   159     05  WS-CO-GROUP             PIC X(6).
   160     05  WS-CO-FIN-RESP          PIC X(10).
   161     05  WS-CO-ACCOUNT           PIC X(10).
   162     05  WS-CO-TYPE              PIC X.
   163 01  WS-WORK-SAH-COMM            PIC SV9(5) VALUE +0.
   164 01  WS-WORK-JAH-COMM            PIC SV9(5) VALUE +0.
   165 01  WS-POLICY-NO                PIC X(6).
   166 01  WS-SHORT-ACCT-NAME          PIC X(30).
   167 01  WS-LONG-ACCT-NAME           PIC X(60).
   168 01  WS-CONTR-NAME               PIC X(60).
   169 01  WS-SL-COMM                  PIC 9.99999.
   170 01  WS-JL-COMM                  PIC 9.99999.
   171 01  WS-SAH-COMM                 PIC 9.99999.
   172 01  WS-JAH-COMM                 PIC 9.99999.
   173 01  WS-CID-NO                   PIC X(8).
   174 01  WS-DISP-RESP                PIC 9(5).
   175 01  WS-RESPONSE                 PIC S9(8)   COMP.
   176     88  RESP-NORMAL                  VALUE +00.
   177     88  RESP-NOTFND                  VALUE +13.
   178     88  RESP-NOTOPEN                 VALUE +19.
   179     88  RESP-ENDFILE                 VALUE +20.
   180*                                 COPY ERCACNT.
   181******************************************************************
   182*                                                                *
   183*                                                                *
   184*                            ERCACNT.                            *
   185*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   186*                            VMOD=2.002                          *
   187*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page   5
* SOCK00.cbl
   188*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
   189*                                                                *
   190*   FILE TYPE = VSAM,KSDS                                        *
   191*   RECORD SIZE = 120   RECFORM = FIXED                          *
   192*                                                                *
   193*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
   194*       ALTERNATE INDEX = NONE                                   *
   195*                                                                *
   196*                                                                *
   197*   LOG = YES                                                    *
   198*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   199******************************************************************
   200*                   C H A N G E   L O G
   201*
   202* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   203*-----------------------------------------------------------------
   204*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   205* EFFECTIVE    NUMBER
   206*-----------------------------------------------------------------
   207* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
   208*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
   209******************************************************************
   210 01  NOTE-FILE.
   211     12  NT-FILE-ID                  PIC XX.
   212         88  VALID-NOTE-ID              VALUE 'NT'.
   213
   214     12  NT-CONTROL-PRIMARY.
   215         16  NT-COMPANY-CD           PIC X.
   216         16  NT-ACCT-NOTE-KEY.
   217             18  NT-CARRIER              PIC X.
   218             18  NT-GROUPING             PIC X(06).
   219             18  NT-STATE                PIC XX.
   220             18  NT-ACCOUNT              PIC X(10).
   221         16  NT-RECORD-TYPE          PIC X.
   222              88  ACCT-NOTE          VALUE '1'.
   223              88  ACCT-BRANCH-LOC    VALUE '2'.
   224              88  ACCT-SHIPPING-ADDR VALUE '3'.
   225         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
   226
   227     12  NT-LAST-MAINT-DT            PIC XX.
   228     12  NT-LAST-MAINT-BY            PIC X(4).
   229     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
   230
   231*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
   232*     SEQUENCE NUMBERS
   233     12  NT-NOTE-INFORMATION.
   234         16  NT-NOTE-LINE            PIC X(60).
   235         16  FILLER                  PIC X(25).
   236*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
   237     12  NT-LOCATION-INFORMATION REDEFINES
   238                         NT-NOTE-INFORMATION.
   239         16  NT-BRANCH-LOC-LINE      PIC X(60).
   240         16  FILLER                  PIC X(25).
   241* Account special indicator is record type '2', sequence 3
   242     12  filler REDEFINES NT-NOTE-INFORMATION.
   243         16  nt-account-special      PIC X.
   244         16  FILLER                  PIC X(84).
   245*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page   6
* SOCK00.cbl
   246*     SEQUENCE NUMBER 1 IS NAME LINE 1
   247*     SEQUENCE NUMBER 2 IS NAME LINE 2
   248*     SEQUENCE NUMBER 3 IS ADDR LINE 1
   249*     SEQUENCE NUMBER 4 IS ADDR LINE 2
   250*     SEQUENCE NUMBER 5 IS ADDR LINE 3
   251*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
   252     12  NT-SHIPPING-INFORMATION REDEFINES
   253                         NT-NOTE-INFORMATION.
   254         16  NT-SHIPPING-LINE        PIC X(60).
   255         16  NT-SHIP-STATE           PIC XX.
   256         16  NT-SHIP-ZIP             PIC X(10).
   257         16  FILLER                  PIC X(13).
   258*****************************************************************
   259*                                 COPY ERCACCT.
   260******************************************************************
   261*                                                                *
   262*                                                                *
   263*                            ERCACCT                             *
   264*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   265*                            VMOD=2.031                          *
   266*                                                                *
   267*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   268*                                                                *
   269*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   270*   VSAM ACCOUNT MASTER FILES.                                   *
   271*                                                                *
   272*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   273*                                                                *
   274*   FILE TYPE = VSAM,KSDS                                        *
   275*   RECORD SIZE = 2000  RECFORM = FIX                            *
   276*                                                                *
   277*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   278*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   279*                                                                *
   280*   LOG = NO                                                     *
   281*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   282*                                                                *
   283*                                                                *
   284******************************************************************
   285*                   C H A N G E   L O G
   286*
   287* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   288*-----------------------------------------------------------------
   289*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   290* EFFECTIVE    NUMBER
   291*-----------------------------------------------------------------
   292* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   293* 092705    2005050300006  PEMA  ADD SPP LEASES
   294* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   295* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   296* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   297* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   298* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   299* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
   300******************************************************************
   301
   302 01  ACCOUNT-MASTER.
   303     12  AM-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page   7
* SOCK00.cbl
   304         88  VALID-AM-ID                      VALUE 'AM'.
   305
   306     12  AM-CONTROL-PRIMARY.
   307         16  AM-COMPANY-CD                 PIC X.
   308         16  AM-MSTR-CNTRL.
   309             20  AM-CONTROL-A.
   310                 24  AM-CARRIER            PIC X.
   311                 24  AM-GROUPING.
   312                     28 AM-GROUPING-PREFIX PIC XXX.
   313                     28 AM-GROUPING-PRIME  PIC XXX.
   314                 24  AM-STATE              PIC XX.
   315                 24  AM-ACCOUNT.
   316                     28  AM-ACCOUNT-PREFIX PIC X(4).
   317                     28  AM-ACCOUNT-PRIME  PIC X(6).
   318             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   319                                           PIC X(19).
   320             20  AM-CNTRL-B.
   321                 24  AM-EXPIRATION-DT      PIC XX.
   322                 24  FILLER                PIC X(4).
   323             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   324                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   325
   326     12  AM-CONTROL-BY-VAR-GRP.
   327         16  AM-COMPANY-CD-A1              PIC X.
   328         16  AM-VG-CARRIER                 PIC X.
   329         16  AM-VG-GROUPING                PIC X(6).
   330         16  AM-VG-STATE                   PIC XX.
   331         16  AM-VG-ACCOUNT                 PIC X(10).
   332         16  AM-VG-DATE.
   333             20  AM-VG-EXPIRATION-DT       PIC XX.
   334             20  FILLER                    PIC X(4).
   335         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   336                                           PIC 9(11)      COMP-3.
   337     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   338         16  FILLER                        PIC X(10).
   339         16  AM-VG-KEY3.
   340             20  AM-VG3-ACCOUNT            PIC X(10).
   341             20  AM-VG3-EXP-DT             PIC XX.
   342         16  FILLER                        PIC X(4).
   343     12  AM-MAINT-INFORMATION.
   344         16  AM-LAST-MAINT-DT              PIC XX.
   345         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   346         16  AM-LAST-MAINT-USER            PIC X(4).
   347         16  FILLER                        PIC XX.
   348
   349     12  AM-EFFECTIVE-DT                   PIC XX.
   350     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   351
   352     12  AM-PREV-DATES  COMP-3.
   353         16  AM-PREV-EXP-DT                PIC 9(11).
   354         16  AM-PREV-EFF-DT                PIC 9(11).
   355
   356     12  AM-REPORT-CODE-1                  PIC X(10).
   357     12  AM-REPORT-CODE-2                  PIC X(10).
   358
   359     12  AM-CITY-CODE                      PIC X(4).
   360     12  AM-COUNTY-PARISH                  PIC X(6).
   361
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page   8
* SOCK00.cbl
   362     12  AM-NAME                           PIC X(30).
   363     12  AM-PERSON                         PIC X(30).
   364     12  AM-ADDRS                          PIC X(30).
   365     12  AM-CITY.
   366         16  AM-ADDR-CITY                  PIC X(28).
   367         16  AM-ADDR-STATE                 PIC XX.
   368     12  AM-ZIP.
   369         16  AM-ZIP-PRIME.
   370             20  AM-ZIP-PRI-1ST            PIC X.
   371                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   372             20  FILLER                    PIC X(4).
   373         16  AM-ZIP-PLUS4                  PIC X(4).
   374     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   375         16  AM-CAN-POSTAL-1               PIC XXX.
   376         16  AM-CAN-POSTAL-2               PIC XXX.
   377         16  FILLER                        PIC XXX.
   378     12  AM-TEL-NO.
   379         16  AM-AREA-CODE                  PIC 999.
   380         16  AM-TEL-PRE                    PIC 999.
   381         16  AM-TEL-NBR                    PIC 9(4).
   382     12  AM-TEL-LOC                        PIC X.
   383         88  AM-TEL-AT-HOME                   VALUE 'H'.
   384         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   385
   386     12  AM-COMM-STRUCTURE.
   387         16  AM-DEFN-1.
   388             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   389                 24  AM-AGT.
   390                     28  AM-AGT-PREFIX     PIC X(4).
   391                     28  AM-AGT-PRIME      PIC X(6).
   392                 24  AM-COM-TYP            PIC X.
   393                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   394                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   395                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   396                 24  AM-RECALC-LV-INDIC    PIC X.
   397                 24  AM-RETRO-LV-INDIC     PIC X.
   398                 24  AM-GL-CODES           PIC X.
   399                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   400                 24  FILLER                PIC X(01).
   401         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   402             20  AM-COM-TBLS        OCCURS 10 TIMES.
   403                 24  FILLER                PIC X(11).
   404                 24  AM-L-COMA             PIC XXX.
   405                 24  AM-J-COMA             PIC XXX.
   406                 24  AM-A-COMA             PIC XXX.
   407                 24  FILLER                PIC X(6).
   408
   409     12  AM-COMM-CHANGE-STATUS             PIC X.
   410         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   411
   412     12  AM-CSR-CODE                       PIC X(4).
   413
   414     12  AM-BILLING-STATUS                 PIC X.
   415         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   416         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   417     12  AM-AUTO-REFUND-SW                 PIC X.
   418         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   419         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page   9
* SOCK00.cbl
   420     12  AM-GPCD                           PIC 99.
   421     12  AM-IG                             PIC X.
   422         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   423         88  AM-HAS-GROUP                     VALUE '2'.
   424     12  AM-STATUS                         PIC X.
   425         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   426         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   427         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   428         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   429         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   430         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   431         88  AM-ACCOUNT-DROPPED               VALUE '6'.
   432         88  AM-ACCOUNT-LAPSED                VALUE '7'.
   433         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
   434         88  AM-ACCOUNT-PENDING               VALUE '9'.
   435     12  AM-REMIT-TO                       PIC 99.
   436     12  AM-ID-NO                          PIC X(11).
   437
   438     12  AM-CAL-TABLE                      PIC XX.
   439     12  AM-LF-DEVIATION                   PIC XXX.
   440     12  AM-AH-DEVIATION                   PIC XXX.
   441     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   442     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   443     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   444     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   445     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   446     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   447
   448     12  AM-USER-FIELDS.
   449         16  AM-FLD-1                      PIC XX.
   450         16  AM-FLD-2                      PIC XX.
   451         16  AM-FLD-3                      PIC XX.
   452         16  AM-FLD-4                      PIC XX.
   453         16  AM-FLD-5                      PIC XX.
   454
   455     12  AM-1ST-PROD-DATE.
   456         16  AM-1ST-PROD-YR                PIC XX.
   457         16  AM-1ST-PROD-MO                PIC XX.
   458         16  AM-1ST-PROD-DA                PIC XX.
   459     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   460     12  AM-CERTS-PURGED-DATE.
   461         16  AM-PUR-YR                     PIC XX.
   462         16  AM-PUR-MO                     PIC XX.
   463         16  AM-PUR-DA                     PIC XX.
   464     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   465     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   466     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   467     12  AM-INACTIVE-DATE.
   468         16  AM-INA-MO                     PIC 99.
   469         16  AM-INA-DA                     PIC 99.
   470         16  AM-INA-YR                     PIC 99.
   471     12  AM-AR-HI-CERT-DATE                PIC XX.
   472
   473     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   474     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   475
   476     12  AM-OB-PAYMENT-MODE                PIC X.
   477         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  10
* SOCK00.cbl
   478         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   479         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   480         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   481
   482     12  AM-AH-ONLY-INDICATOR              PIC X.
   483         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   484         88  AM-NO-AH-ONLY                    VALUE 'N'.
   485
   486     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   487
   488     12  AM-OVER-SHORT.
   489         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   490         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   491
   492     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   493     12  AM-DCC-CLP-STATE                  PIC XX.
   494
   495     12  AM-RECALC-COMM                    PIC X.
   496     12  AM-RECALC-REIN                    PIC X.
   497
   498     12  AM-REI-TABLE                      PIC XXX.
   499     12  AM-REI-ET-LF                      PIC X.
   500     12  AM-REI-ET-AH                      PIC X.
   501     12  AM-REI-PE-LF                      PIC X.
   502     12  AM-REI-PE-AH                      PIC X.
   503     12  AM-REI-PRT-ST                     PIC X.
   504     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   505     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   506     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   507     12  AM-REI-GROUP-A                    PIC X(6).
   508     12  AM-REI-MORT                       PIC X(4).
   509     12  AM-REI-PRT-OW                     PIC X.
   510     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   511     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   512     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   513     12  AM-REI-GROUP-B                    PIC X(6).
   514
   515     12  AM-TRUST-TYPE                     PIC X(2).
   516
   517     12  AM-EMPLOYER-STMT-USED             PIC X.
   518     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   519
   520     12  AM-STD-AH-TYPE                    PIC XX.
   521     12  AM-EARN-METHODS.
   522         16  AM-EARN-METHOD-R              PIC X.
   523             88 AM-REF-RL-R78                 VALUE 'R'.
   524             88 AM-REF-RL-PR                  VALUE 'P'.
   525             88 AM-REF-RL-MEAN                VALUE 'M'.
   526             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   527         16  AM-EARN-METHOD-L              PIC X.
   528             88 AM-REF-LL-R78                 VALUE 'R'.
   529             88 AM-REF-LL-PR                  VALUE 'P'.
   530             88 AM-REF-LL-MEAN                VALUE 'M'.
   531             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   532         16  AM-EARN-METHOD-A              PIC X.
   533             88 AM-REF-AH-R78                 VALUE 'R'.
   534             88 AM-REF-AH-PR                  VALUE 'P'.
   535             88 AM-REF-AH-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  11
* SOCK00.cbl
   536             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   537             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   538             88 AM-REF-AH-NET                 VALUE 'N'.
   539
   540     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   541     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   542     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   543
   544     12  AM-RET-Y-N                        PIC X.
   545     12  AM-RET-P-E                        PIC X.
   546     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   547     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   548     12  AM-RET-GRP                        PIC X(6).
   549     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   550         16  AM-POOL-PRIME                 PIC XXX.
   551         16  AM-POOL-SUB                   PIC XXX.
   552     12  AM-RETRO-EARNINGS.
   553         16  AM-RET-EARN-R                 PIC X.
   554         16  AM-RET-EARN-L                 PIC X.
   555         16  AM-RET-EARN-A                 PIC X.
   556     12  AM-RET-ST-TAX-USE                 PIC X.
   557         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   558         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   559     12  AM-RETRO-BEG-EARNINGS.
   560         16  AM-RET-BEG-EARN-R             PIC X.
   561         16  AM-RET-BEG-EARN-L             PIC X.
   562         16  AM-RET-BEG-EARN-A             PIC X.
   563     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   564     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   565
   566     12  AM-USER-SELECT-OPTIONS.
   567         16  AM-USER-SELECT-1              PIC X(10).
   568         16  AM-USER-SELECT-2              PIC X(10).
   569         16  AM-USER-SELECT-3              PIC X(10).
   570         16  AM-USER-SELECT-4              PIC X(10).
   571         16  AM-USER-SELECT-5              PIC X(10).
   572
   573     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   574
   575     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   576
   577     12  AM-RPT045A-SWITCH                 PIC X.
   578         88  RPT045A-OFF                   VALUE 'N'.
   579
   580     12  AM-INSURANCE-LIMITS.
   581         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   582         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   583
   584     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   585         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   586
   587     12  AM-DISMBR-COVERAGE-SW             PIC X.
   588         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   589         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   590
   591     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   592
   593     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  12
* SOCK00.cbl
   594     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   595     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   596     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   597     12  AM-DCC-UEF-STATE                  PIC XX.
   598     12  FILLER                            PIC XXX.
   599     12  AM-REPORT-CODE-3                  PIC X(10).
   600*    12  FILLER                            PIC X(22).
   601
   602     12  AM-RESERVE-DATE.
   603         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   604         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   605         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   606
   607     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   608     12  AM-NOTIFICATION-TYPES.
   609         16  AM-NOTIF-OF-LETTERS           PIC X.
   610         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   611         16  AM-NOTIF-OF-REPORTS           PIC X.
   612         16  AM-NOTIF-OF-STATUS            PIC X.
   613
   614     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   615         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   616         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   617         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   618         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   619
   620     12  AM-BENEFIT-CONTROLS.
   621         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   622             20  AM-BENEFIT-CODE           PIC XX.
   623             20  AM-BENEFIT-TYPE           PIC X.
   624             20  AM-BENEFIT-REVISION       PIC XXX.
   625             20  AM-BENEFIT-REM-TERM       PIC X.
   626             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   627             20  FILLER                    PIC XX.
   628         16  FILLER                        PIC X(80).
   629
   630     12  AM-TRANSFER-DATA.
   631         16  AM-TRANSFERRED-FROM.
   632             20  AM-TRNFROM-CARRIER        PIC X.
   633             20  AM-TRNFROM-GROUPING.
   634                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   635                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   636             20  AM-TRNFROM-STATE          PIC XX.
   637             20  AM-TRNFROM-ACCOUNT.
   638                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   639                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   640             20  AM-TRNFROM-DTE            PIC XX.
   641         16  AM-TRANSFERRED-TO.
   642             20  AM-TRNTO-CARRIER          PIC X.
   643             20  AM-TRNTO-GROUPING.
   644                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   645                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   646             20  AM-TRNTO-STATE            PIC XX.
   647             20  AM-TRNTO-ACCOUNT.
   648                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   649                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   650             20  AM-TRNTO-DTE              PIC XX.
   651         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  13
* SOCK00.cbl
   652
   653     12  AM-SAVED-REMIT-TO                 PIC 99.
   654
   655     12  AM-COMM-STRUCTURE-SAVED.
   656         16  AM-DEFN-1-SAVED.
   657             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   658                 24  AM-AGT-SV             PIC X(10).
   659                 24  AM-COM-TYP-SV         PIC X.
   660                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   661                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
   662                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
   663                 24  AM-RECALC-LV-INDIC-SV PIC X.
   664                 24  FILLER                PIC X.
   665                 24  AM-GL-CODES-SV        PIC X.
   666                 24  AM-COM-CHARGEBACK-SV  PIC 99.
   667                 24  FILLER                PIC X.
   668         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
   669             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
   670                 24  FILLER                PIC X(11).
   671                 24  AM-L-COMA-SV          PIC XXX.
   672                 24  AM-J-COMA-SV          PIC XXX.
   673                 24  AM-A-COMA-SV          PIC XXX.
   674                 24  FILLER                PIC X(6).
   675
   676     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
   677         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
   678            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
   679            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
   680            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
   681
   682     12  AM-ORIG-DEALER-NO                 PIC X(10).
   683     12  FILLER                            PIC X(120).
   684
   685     12  AM-ACCOUNT-EXECUTIVE-DATA.
   686         16  AM-CONTROL-NAME               PIC X(30).
   687         16  AM-EXECUTIVE-ONE.
   688             20  AM-EXEC1-NAME             PIC X(15).
   689             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
   690                                                          COMP-3.
   691             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
   692                                                          COMP-3.
   693         16  AM-EXECUTIVE-TWO.
   694             20  AM-EXEC2-NAME             PIC X(15).
   695             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
   696                                                          COMP-3.
   697             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
   698                                                          COMP-3.
   699
   700     12  AM-RETRO-ADDITIONAL-DATA.
   701         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
   702         16  AM-RETRO-PREM-P-E             PIC X.
   703         16  AM-RETRO-CLMS-P-I             PIC X.
   704         16  AM-RETRO-RET-BRACKET-LF.
   705             20  AM-RETRO-RET-METHOD-LF    PIC X.
   706                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
   707                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
   708             20  AM-RETRO-RET-BASIS-LF     PIC X.
   709                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  14
* SOCK00.cbl
   710                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
   711             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
   712                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
   713                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
   714         16  AM-RETRO-RET-BRACKET-AH.
   715             20  AM-RETRO-RET-METHOD-AH    PIC X.
   716                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
   717                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
   718                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
   719             20  AM-RETRO-RET-BASIS-AH     PIC X.
   720                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
   721                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
   722             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
   723                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
   724                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
   725
   726     12  AM-COMMENTS.
   727         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
   728
   729     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
   730         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
   731         16  AM-FLI-BILLING-CODE           PIC X.
   732         16  AM-FLI-ALT-STATE-CODE         PIC XX.
   733         16  AM-FLI-UNITED-IDENT           PIC X.
   734         16  AM-FLI-INTEREST-LOST-DATA.
   735             20  AM-FLI-BANK-NO            PIC X(5).
   736             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
   737             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
   738             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
   739         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
   740             20  AM-FLI-AGT                PIC X(9).
   741             20  AM-FLI-AGT-COMM-ACC       PIC X.
   742             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
   743         16  FILLER                        PIC X(102).
   744
   745     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
   746         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
   747             20  AM-BENEFIT-DMD-CODE         PIC XX.
   748             20  AM-BENEFIT-DMD-TYPE         PIC X.
   749             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
   750             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
   751             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
   752         16  FILLER                          PIC X(10).
   753******************************************************************
   754*                                 COPY ERCCOMP.
   755******************************************************************
   756*                                                                *
   757*                                                                *
   758*                            ERCCOMP                             *
   759*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   760*                            VMOD=2.019                          *
   761*                                                                *
   762*   ONLINE CREDIT SYSTEM                                         *
   763*                                                                *
   764*   FILE DESCRIPTION = COMPENSATION MASTER                       *
   765*                                                                *
   766*   FILE TYPE = VSAM,KSDS                                        *
   767*   RECORD SIZE = 700   RECFORM = FIXED                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  15
* SOCK00.cbl
   768*                                                                *
   769*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
   770*       ALTERNATE PATH = NONE                                    *
   771*                                                                *
   772*   LOG = NO                                                     *
   773*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   774*                                                                *
   775******************************************************************
   776*                   C H A N G E   L O G
   777*
   778* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   779*-----------------------------------------------------------------
   780*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   781* EFFECTIVE    NUMBER
   782*-----------------------------------------------------------------
   783* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   784* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
   785* 092205    2005050300006  PEMA  ADD LEASE FEE
   786* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
   787* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
   788* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
   789* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   790* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
   791* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
   792******************************************************************
   793
   794 01  COMPENSATION-MASTER.
   795     12  CO-RECORD-ID                          PIC XX.
   796         88  VALID-CO-ID                          VALUE 'CO'.
   797
   798     12  CO-CONTROL-PRIMARY.
   799         16  CO-COMPANY-CD                     PIC X.
   800         16  CO-CONTROL.
   801             20  CO-CTL-1.
   802                 24  CO-CARR-GROUP.
   803                     28  CO-CARRIER            PIC X.
   804                     28  CO-GROUPING.
   805                         32  CO-GROUP-PREFIX   PIC XXX.
   806                         32  CO-GROUP-PRIME    PIC XXX.
   807                 24  CO-RESP-NO.
   808                     28  CO-RESP-PREFIX        PIC X(4).
   809                     28  CO-RESP-PRIME         PIC X(6).
   810             20  CO-CTL-2.
   811                 24  CO-ACCOUNT.
   812                     28  CO-ACCT-PREFIX        PIC X(4).
   813                     28  CO-ACCT-PRIME         PIC X(6).
   814         16  CO-TYPE                           PIC X.
   815             88  CO-COMPANY-TYPE                  VALUE 'C'.
   816             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
   817             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
   818
   819     12  CO-MAINT-INFORMATION.
   820         16  CO-LAST-MAINT-DT                  PIC XX.
   821         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   822         16  CO-LAST-MAINT-USER                PIC X(4).
   823     12  FILLER                                PIC XX.
   824     12  CO-STMT-TYPE                          PIC XXX.
   825     12  CO-COMP-TYPE                          PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  16
* SOCK00.cbl
   826         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   827     12  CO-STMT-OWNER                         PIC X(4).
   828     12  CO-BALANCE-CONTROL                    PIC X.
   829         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   830         88  CO-NO-BALANCE                        VALUE 'N'.
   831
   832     12  CO-INTERNAL-CONTROL-1                 PIC X.
   833         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   834         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   835         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   836
   837     12  CO-INTERNAL-CONTROL-2                 PIC X.
   838         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   839         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   840
   841     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   842     12  CO-GA-DIRECT-DEP                      PIC X.
   843     12  CO-FUTURE-SPACE                       PIC X.
   844         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   845
   846     12  CO-ACCT-NAME                          PIC X(30).
   847     12  CO-MAIL-NAME                          PIC X(30).
   848     12  CO-ADDR-1                             PIC X(30).
   849     12  CO-ADDR-2                             PIC X(30).
   850     12  CO-ADDR-3.
   851         16  CO-ADDR-CITY                      PIC X(27).
   852         16  CO-ADDR-STATE                     PIC XX.
   853     12  CO-CSO-1099                           PIC X.
   854     12  CO-ZIP.
   855         16  CO-ZIP-PRIME.
   856             20  CO-ZIP-PRI-1ST                PIC X.
   857                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   858             20  FILLER                        PIC X(4).
   859         16  CO-ZIP-PLUS4                      PIC X(4).
   860     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   861         16  CO-CAN-POSTAL-1                   PIC XXX.
   862         16  CO-CAN-POSTAL-2                   PIC XXX.
   863         16  FILLER                            PIC XXX.
   864     12  CO-SOC-SEC                            PIC X(13).
   865     12  CO-TELEPHONE.
   866         16  CO-AREA-CODE                      PIC XXX.
   867         16  CO-PREFIX                         PIC XXX.
   868         16  CO-PHONE                          PIC X(4).
   869
   870     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   871
   872     12  CO-AR-BAL-LEVEL                       PIC X.
   873         88  CO-AR-REF-LVL                        VALUE '1'.
   874         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   875         88  CO-AR-BILL-LVL                       VALUE '2'.
   876         88  CO-AR-AGT-LVL                        VALUE '3'.
   877         88  CO-AR-FR-LVL                         VALUE '4'.
   878
   879     12  CO-AR-NORMAL-PRINT                    PIC X.
   880         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   881         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   882
   883     12  CO-AR-SUMMARY-CODE                    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  17
* SOCK00.cbl
   884
   885     12  CO-AR-REPORTING                       PIC X.
   886         88  CO-AR-NET-REPORT                     VALUE 'N'.
   887         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   888
   889     12  CO-AR-PULL-CHECK                      PIC X.
   890         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   891         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   892
   893     12  CO-AR-BALANCE-PRINT                   PIC X.
   894         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   895
   896     12  CO-AR-LAST-RUN-CODE                   PIC X.
   897         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   898         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   899         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   900
   901     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   902
   903     12  CO-USER-CODE                          PIC X.
   904     12  CO-REPORT-GROUP-ID                    PIC X(12).
   905
   906******************************************************************
   907*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   908*    THE LAST MONTH END RUN.
   909******************************************************************
   910
   911     12  CO-LAST-ACTIVITY-DATE.
   912         16  CO-ACT-YEAR                       PIC 99.
   913         16  CO-ACT-MONTH                      PIC 99.
   914         16  CO-ACT-DAY                        PIC 99.
   915
   916     12  CO-LAST-STMT-DT.
   917         16  CO-LAST-STMT-YEAR                 PIC 99.
   918         16  CO-LAST-STMT-MONTH                PIC 99.
   919         16  CO-LAST-STMT-DAY                  PIC 99.
   920
   921     12  CO-MO-END-TOTALS.
   922         16  CO-MONTHLY-TOTALS.
   923             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   924             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   925             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
   926             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   927             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   928
   929         16  CO-AGING-TOTALS.
   930             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   931             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   932             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   933             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   934
   935         16  CO-YTD-TOTALS.
   936             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   937             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   938
   939         16  CO-OVER-UNDER-TOTALS.
   940             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
   941             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  18
* SOCK00.cbl
   942
   943     12  CO-MISCELLANEOUS-TOTALS.
   944         16  CO-FICA-TOTALS.
   945             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
   946             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
   947
   948         16  CO-CLAIM-TOTALS.
   949             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
   950             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
   951
   952******************************************************************
   953*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
   954*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
   955******************************************************************
   956
   957     12  CO-CURRENT-TOTALS.
   958         16  CO-CURRENT-LAST-STMT-DT.
   959             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
   960             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
   961             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
   962
   963         16  CO-CURRENT-MONTHLY-TOTALS.
   964             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
   965             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
   966             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
   967             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
   968             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
   969
   970         16  CO-CURRENT-AGING-TOTALS.
   971             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
   972             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
   973             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
   974             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
   975
   976         16  CO-CURRENT-YTD-TOTALS.
   977             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
   978             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
   979
   980     12  CO-PAID-COMM-TOTALS.
   981         16  CO-YTD-PAID-COMMS.
   982             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
   983             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
   984
   985     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
   986         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
   987         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
   988
   989     12  CO-DELINQUENT-LETTER-CODE         PIC X.
   990         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
   991         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
   992         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
   993         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
   994         88  CO-OVERWRITE-LETTER              VALUE 'O'.
   995         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
   996         88  CO-FINAL-LETTER                  VALUE 'F'.
   997         88  CO-RECONCILING                   VALUE 'R'.
   998         88  CO-PHONE-CALL                    VALUE 'P'.
   999         88  CO-LEGAL                         VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  19
* SOCK00.cbl
  1000         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1001         88  CO-WRITE-OFF                     VALUE 'W'.
  1002         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1003
  1004     12  CO-CSR-CODE                       PIC X(4).
  1005
  1006     12  CO-GA-STATUS-INFO.
  1007         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1008         16  CO-GA-TERMINATION-DT          PIC XX.
  1009         16  CO-GA-STATUS-CODE             PIC X.
  1010             88  CO-GA-ACTIVE                 VALUE 'A'.
  1011             88  CO-GA-INACTIVE               VALUE 'I'.
  1012             88  CO-GA-PENDING                VALUE 'P'.
  1013         16  CO-GA-COMMENTS.
  1014             20  CO-GA-COMMENT-1           PIC X(40).
  1015             20  CO-GA-COMMENT-2           PIC X(40).
  1016             20  CO-GA-COMMENT-3           PIC X(40).
  1017             20  CO-GA-COMMENT-4           PIC X(40).
  1018
  1019     12  CO-RPTCD2                         PIC X(10).
  1020     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1021         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1022         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1023
  1024     12  CO-TYPE-AGENT                     PIC X(01).
  1025         88  CO-CORPORATION                   VALUE 'C'.
  1026         88  CO-PARTNERSHIP                   VALUE 'P'.
  1027         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1028         88  CO-TRUST                         VALUE 'T'.
  1029         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1030
  1031     12  CO-FAXNO.
  1032         16  CO-FAX-AREA-CODE                  PIC XXX.
  1033         16  CO-FAX-PREFIX                     PIC XXX.
  1034         16  CO-FAX-PHONE                      PIC X(4).
  1035
  1036     12  CO-BANK-INFORMATION.
  1037         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1038         16  CO-BANK-TRANSIT-NON REDEFINES
  1039             CO-BANK-TRANSIT-NO                PIC 9(8).
  1040
  1041         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1042     12  CO-MISC-DEDUCT-INFO REDEFINES
  1043                  CO-BANK-INFORMATION.
  1044         16  CO-MD-GL-ACCT                     PIC X(10).
  1045         16  CO-MD-DIV                         PIC XX.
  1046         16  CO-MD-CENTER                      PIC X(4).
  1047         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1048         16  CO-CREATE-AP-CHECK                PIC X.
  1049         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1050         16  FILLER                            PIC XXX.
  1051     12  CO-ACH-STATUS                         PIC X.
  1052         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1053         88  CO-ACH-PENDING                        VALUE 'P'.
  1054
  1055     12  CO-BILL-SW                            PIC X.
  1056     12  CO-CONTROL-NAME                       PIC X(30).
  1057     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  20
* SOCK00.cbl
  1058     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1059     12  CO-CLP-STATE                          PIC XX.
  1060     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1061     12  CO-SPP-REFUND-EDIT                    PIC X.
  1062
  1063******************************************************************
  1064*                                 COPY ELCCNTL.
  1065******************************************************************
  1066*                                                                *
  1067*                                                                *
  1068*                            ELCCNTL.                            *
  1069*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1070*                            VMOD=2.059                          *
  1071*                                                                *
  1072*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1073*                                                                *
  1074*   FILE TYPE = VSAM,KSDS                                        *
  1075*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1076*                                                                *
  1077*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1078*       ALTERNATE INDEX = NONE                                   *
  1079*                                                                *
  1080*   LOG = YES                                                    *
  1081*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1082******************************************************************
  1083*                   C H A N G E   L O G
  1084*
  1085* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1086*-----------------------------------------------------------------
  1087*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1088* EFFECTIVE    NUMBER
  1089*-----------------------------------------------------------------
  1090* 082503                   PEMA  ADD BENEFIT GROUP
  1091* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1092* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1093* 092705    2005050300006  PEMA  ADD SPP LEASES
  1094* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1095* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1096* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1097* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1098* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1099* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1100* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1101* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1102* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1103* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1104* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  1105******************************************************************
  1106*
  1107 01  CONTROL-FILE.
  1108     12  CF-RECORD-ID                       PIC XX.
  1109         88  VALID-CF-ID                        VALUE 'CF'.
  1110
  1111     12  CF-CONTROL-PRIMARY.
  1112         16  CF-COMPANY-ID                  PIC XXX.
  1113         16  CF-RECORD-TYPE                 PIC X.
  1114             88  CF-COMPANY-MASTER              VALUE '1'.
  1115             88  CF-PROCESSOR-MASTER            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  21
* SOCK00.cbl
  1116             88  CF-STATE-MASTER                VALUE '3'.
  1117             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1118             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1119             88  CF-CARRIER-MASTER              VALUE '6'.
  1120             88  CF-MORTALITY-MASTER            VALUE '7'.
  1121             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1122             88  CF-TERMINAL-MASTER             VALUE '9'.
  1123             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1124             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1125             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1126             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1127             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1128             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1129             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1130             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1131             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1132         16  CF-ACCESS-CD-GENL              PIC X(4).
  1133         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1134             20  CF-PROCESSOR               PIC X(4).
  1135         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1136             20  CF-STATE-CODE              PIC XX.
  1137             20  FILLER                     PIC XX.
  1138         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1139             20  FILLER                     PIC XX.
  1140             20  CF-HI-BEN-IN-REC           PIC XX.
  1141         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1142             20  FILLER                     PIC XXX.
  1143             20  CF-CARRIER-CNTL            PIC X.
  1144         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1145             20  FILLER                     PIC XX.
  1146             20  CF-HI-TYPE-IN-REC          PIC 99.
  1147         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1148             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1149                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1150             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1151             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1152         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1153             20  FILLER                     PIC X.
  1154             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1155         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1156             20  FILLER                     PIC XX.
  1157             20  CF-MORTGAGE-PLAN           PIC XX.
  1158         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1159
  1160     12  CF-LAST-MAINT-DT                   PIC XX.
  1161     12  CF-LAST-MAINT-BY                   PIC X(4).
  1162     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1163
  1164     12  CF-RECORD-BODY                     PIC X(728).
  1165
  1166
  1167****************************************************************
  1168*             COMPANY MASTER RECORD                            *
  1169****************************************************************
  1170
  1171     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1172         16  CF-COMPANY-ADDRESS.
  1173             20  CF-CL-MAIL-TO-NAME         PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  22
* SOCK00.cbl
  1174             20  CF-CL-IN-CARE-OF           PIC X(30).
  1175             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1176             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1177             20  CF-CL-CITY-STATE           PIC X(30).
  1178             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1179             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1180         16  CF-COMPANY-CD                  PIC X.
  1181         16  CF-COMPANY-PASSWORD            PIC X(8).
  1182         16  CF-SECURITY-OPTION             PIC X.
  1183             88  ALL-SECURITY                   VALUE '1'.
  1184             88  COMPANY-VERIFY                 VALUE '2'.
  1185             88  PROCESSOR-VERIFY               VALUE '3'.
  1186             88  NO-SECURITY                    VALUE '4'.
  1187             88  ALL-BUT-TERM                   VALUE '5'.
  1188         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1189             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1190         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1191             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1192         16  CF-INFORCE-LOCATION            PIC X.
  1193             88  CERTS-ARE-ONLINE               VALUE '1'.
  1194             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1195             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1196         16  CF-LOWER-CASE-LETTERS          PIC X.
  1197         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1198             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1199             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1200             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1201             88  CF-ACCNT-CNTL                  VALUE '3'.
  1202             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1203
  1204         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1205         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1206
  1207         16  CF-LGX-CREDIT-USER             PIC X.
  1208             88  CO-IS-NOT-USER                 VALUE 'N'.
  1209             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1210
  1211         16 CF-CREDIT-CALC-CODES.
  1212             20  CF-CR-REM-TERM-CALC PIC X.
  1213               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1214               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1215               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1216               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1217               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1218               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1219               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1220             20  CF-CR-R78-METHOD           PIC X.
  1221               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1222               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1223
  1224         16  CF-CLAIM-CONTROL-COUNTS.
  1225             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1226                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1227
  1228             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1229                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1230
  1231             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  23
* SOCK00.cbl
  1232                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1233
  1234             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1235                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1236
  1237         16  CF-CURRENT-MONTH-END           PIC XX.
  1238
  1239         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1240             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1241             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1242             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1243             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1244                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1245                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1246             20  CF-CO-PREM-REJECT-SW       PIC X.
  1247                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1248                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1249             20  CF-CO-REF-REJECT-SW        PIC X.
  1250                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1251                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1252
  1253         16  CF-CO-REPORTING-DT             PIC XX.
  1254         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1255         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1256           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1257           88  CF-CO-MONTH-END                  VALUE '1'.
  1258
  1259         16  CF-LGX-CLAIM-USER              PIC X.
  1260             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1261             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1262
  1263         16  CF-CREDIT-EDIT-CONTROLS.
  1264             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1265             20  CF-MIN-AGE                 PIC 99.
  1266             20  CF-DEFAULT-AGE             PIC 99.
  1267             20  CF-MIN-TERM                PIC S999      COMP-3.
  1268             20  CF-MAX-TERM                PIC S999      COMP-3.
  1269             20  CF-DEFAULT-SEX             PIC X.
  1270             20  CF-JOINT-AGE-INPUT         PIC X.
  1271                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1272             20  CF-BIRTH-DATE-INPUT        PIC X.
  1273                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1274             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1275                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1276                 88  CF-ZERO-CARRIER            VALUE '1'.
  1277                 88  CF-ZERO-GROUPING           VALUE '2'.
  1278                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1279             20  CF-EDIT-SW                 PIC X.
  1280                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1281             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1282             20  CF-CR-PR-METHOD            PIC X.
  1283               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1284               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1285             20  FILLER                     PIC X.
  1286
  1287         16  CF-CREDIT-MISC-CONTROLS.
  1288             20  CF-REIN-TABLE-SW           PIC X.
  1289                 88 REIN-TABLES-ARE-USED        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  24
* SOCK00.cbl
  1290             20  CF-COMP-TABLE-SW           PIC X.
  1291                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1292             20  CF-EXPERIENCE-RETENTION-AGE
  1293                                            PIC S9        COMP-3.
  1294             20  CF-CONVERSION-DT           PIC XX.
  1295             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1296             20  CF-RUN-FREQUENCY-SW        PIC X.
  1297                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1298                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1299
  1300             20  CF-CR-CHECK-NO-CONTROL.
  1301                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1302                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1303                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1304                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1305                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1306                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1307
  1308                 24  CF-CR-CHECK-COUNT       REDEFINES
  1309                     CF-CR-CHECK-COUNTER      PIC X(4).
  1310
  1311                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1312                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1313
  1314                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1315                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1316                 24  CF-MAIL-PROCESSING       PIC X.
  1317                     88  MAIL-PROCESSING          VALUE 'Y'.
  1318
  1319         16  CF-MISC-SYSTEM-CONTROL.
  1320             20  CF-SYSTEM-C                 PIC X.
  1321                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1322             20  CF-SYSTEM-D                 PIC X.
  1323                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1324             20  CF-SOC-SEC-NO-SW            PIC X.
  1325                 88  SOC-SEC-NO-USED             VALUE '1'.
  1326             20  CF-MEMBER-NO-SW             PIC X.
  1327                 88  MEMBER-NO-USED              VALUE '1'.
  1328             20  CF-TAX-ID-NUMBER            PIC X(11).
  1329             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1330             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1331                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1332                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1333                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1334                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1335             20  CF-SYSTEM-E                 PIC X.
  1336                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1337
  1338         16  CF-LGX-LIFE-USER               PIC X.
  1339             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1340             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1341
  1342         16  CF-CR-MONTH-END-DT             PIC XX.
  1343
  1344         16  CF-FILE-MAINT-DATES.
  1345             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1346                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1347             20  CF-LAST-BATCH       REDEFINES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  25
* SOCK00.cbl
  1348                 CF-LAST-BATCH-NO               PIC X(4).
  1349             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1350             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1351             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1352             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1353             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1354             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1355             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1356             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1357             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1358             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1359
  1360         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1361         16  FILLER                         PIC X.
  1362
  1363         16  CF-ALT-MORT-CODE               PIC X(4).
  1364         16  CF-MEMBER-CAPTION              PIC X(10).
  1365
  1366         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1367             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1368             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1369             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1370             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1371             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1372
  1373         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1374
  1375         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1376         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1377         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1378         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1379
  1380         16  CF-AH-OVERRIDE-L1              PIC X.
  1381         16  CF-AH-OVERRIDE-L2              PIC XX.
  1382         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1383         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1384
  1385         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1386         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1387
  1388         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1389         16  CF-AR-LAST-EL860-DT            PIC XX.
  1390         16  CF-MP-MONTH-END-DT             PIC XX.
  1391
  1392         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1393         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1394             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1395
  1396         16  CF-AR-MONTH-END-DT             PIC XX.
  1397
  1398         16  CF-CRDTCRD-USER                PIC X.
  1399             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1400             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1401
  1402         16  CF-CC-MONTH-END-DT             PIC XX.
  1403
  1404         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1405
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  26
* SOCK00.cbl
  1406         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1407             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1408             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1409             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1410         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1411         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1412         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1413         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1414             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1415             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1416         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1417         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1418         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1419             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1420         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1421
  1422         16  CF-CL-ZIP-CODE.
  1423             20  CF-CL-ZIP-PRIME.
  1424                 24  CF-CL-ZIP-1ST          PIC X.
  1425                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1426                 24  FILLER                 PIC X(4).
  1427             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1428         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1429             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1430             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1431             20  FILLER                     PIC XXX.
  1432
  1433         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1434         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1435         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1436         16  CF-CO-OPTION-START-DATE        PIC XX.
  1437         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1438           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1439                                                      '3' '4'.
  1440           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1441           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1442           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1443           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1444           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1445           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1446
  1447         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1448
  1449         16  CF-PAYMENT-APPROVAL-LEVELS.
  1450             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1451             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1452             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1453             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1454             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1455             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1456
  1457         16  CF-END-USER-REPORTING-USER     PIC X.
  1458             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1459             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1460
  1461         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1462             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1463             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  27
* SOCK00.cbl
  1464
  1465         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1466
  1467         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1468         16  FILLER                         PIC X.
  1469
  1470         16  CF-CREDIT-ARCHIVE-CNTL.
  1471             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1472             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1473             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1474
  1475         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1476
  1477         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1478             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1479             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1480
  1481         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1482             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1483             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1484
  1485         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1486
  1487         16  CF-CO-ACH-ID-CODE              PIC  X.
  1488             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1489             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1490             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1491         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1492         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1493         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1494         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1495         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1496         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1497         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1498         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1499         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1500                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1501         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1502                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1503
  1504         16  CF-CO-OVER-SHORT.
  1505             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1506             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1507
  1508*         16  FILLER                         PIC X(102).
  1509         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1510             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1511             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1512
  1513         16  CF-AH-APPROVAL-DAYS.
  1514             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1515             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1516             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1517             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1518
  1519         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1520
  1521         16  CF-APPROV-LEV-5.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  28
* SOCK00.cbl
  1522             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1523             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1524             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1525
  1526         16  FILLER                         PIC X(68).
  1527****************************************************************
  1528*             PROCESSOR/USER RECORD                            *
  1529****************************************************************
  1530
  1531     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1532         16  CF-PROCESSOR-NAME              PIC X(30).
  1533         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1534         16  CF-PROCESSOR-TITLE             PIC X(26).
  1535         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1536                 88  MESSAGE-YES                VALUE 'Y'.
  1537                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1538
  1539*****************************************************
  1540****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1541****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1542****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1543****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1544*****************************************************
  1545
  1546         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1547             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1548             20  CF-APPLICATION-FORCE       PIC X.
  1549             20  CF-INDIVIDUAL-APP.
  1550                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1551                     28  CF-BROWSE-APP      PIC X.
  1552                     28  CF-UPDATE-APP      PIC X.
  1553
  1554         16  CF-CURRENT-TERM-ON             PIC X(4).
  1555         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1556             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1557             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1558             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1559             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1560             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1561             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1562             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1563         16  CF-PROCESSOR-CARRIER           PIC X.
  1564             88  NO-CARRIER-SECURITY            VALUE ' '.
  1565         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1566             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1567         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1568             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1569         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1570             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1571
  1572         16  CF-PROC-SYS-ACCESS-SW.
  1573             20  CF-PROC-CREDIT-CLAIMS-SW.
  1574                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1575                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1576                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1577                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1578             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1579                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  29
* SOCK00.cbl
  1580                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1581             20  CF-PROC-LIFE-GNRLDGR-SW.
  1582                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1583                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1584                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1585                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1586             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1587                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1588                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1589         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1590             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1591             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1592         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1593
  1594         16  CF-APPROVAL-LEVEL                  PIC X.
  1595             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1596             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1597             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1598             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1599             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1600
  1601         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1602
  1603         16  CF-LANGUAGE-TYPE                   PIC X.
  1604             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1605             88  CF-LANG-IS-FR                      VALUE 'F'.
  1606
  1607         16  CF-CSR-IND                         PIC X.
  1608         16  FILLER                             PIC X(239).
  1609
  1610****************************************************************
  1611*             PROCESSOR/REMINDERS RECORD                       *
  1612****************************************************************
  1613
  1614     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1615         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1616             20  CF-START-REMIND-DT         PIC XX.
  1617             20  CF-END-REMIND-DT           PIC XX.
  1618             20  CF-REMINDER-TEXT           PIC X(50).
  1619         16  FILLER                         PIC X(296).
  1620
  1621
  1622****************************************************************
  1623*             STATE MASTER RECORD                              *
  1624****************************************************************
  1625
  1626     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1627         16  CF-STATE-ABBREVIATION          PIC XX.
  1628         16  CF-STATE-NAME                  PIC X(25).
  1629         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1630         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1631             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1632             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1633             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1634             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1635                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1636                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1637             20  CF-ST-PREM-REJECT-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  30
* SOCK00.cbl
  1638                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1639                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1640             20  CF-ST-REF-REJECT-SW        PIC X.
  1641                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1642                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1643         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1644         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1645         16  CF-ST-REFUND-RULES.
  1646             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1647             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1648             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1649         16  CF-ST-FST-PMT-EXTENSION.
  1650             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1651             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1652                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1653                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1654                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1655                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1656         16  CF-ST-STATE-CALL.
  1657             20  CF-ST-CALL-UNEARNED        PIC X.
  1658             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1659             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1660         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1661             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1662             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1663         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1664         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1665         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1666         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1667         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1668         16  FILLER                         PIC X.
  1669         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1670             20  CF-ST-BENEFIT-CD           PIC XX.
  1671             20  CF-ST-BENEFIT-KIND         PIC X.
  1672                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1673                 88  CF-ST-AH-KIND              VALUE 'A'.
  1674             20  CF-ST-REM-TERM-CALC        PIC X.
  1675                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1676                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1677                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1678                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1679                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1680                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1681                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1682                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1683
  1684             20  CF-ST-REFUND-CALC          PIC X.
  1685                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1686                 88  ST-REFD-BY-R78             VALUE '1'.
  1687                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1688                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1689                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1690                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1691                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1692                 88  ST-REFD-UTAH               VALUE '7'.
  1693                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1694                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1695                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  31
* SOCK00.cbl
  1696
  1697             20  CF-ST-EARNING-CALC         PIC X.
  1698                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1699                 88  ST-EARN-BY-R78             VALUE '1'.
  1700                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1701                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1702                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1703                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1704                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1705                 88  ST-EARN-MEAN               VALUE '8'.
  1706                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1707
  1708             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1709                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1710                 88  ST-OVRD-BY-R78             VALUE '1'.
  1711                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1712                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1713                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1714                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1715                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1716                 88  ST-OVRD-MEAN               VALUE '8'.
  1717                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1718             20  cf-st-extra-periods        pic 9.
  1719*            20  FILLER                     PIC X.
  1720
  1721         16  CF-ST-COMMISSION-CAPS.
  1722             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1723             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1724             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1725             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1726         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1727                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1728                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  1729                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  1730
  1731         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1732
  1733         16  CF-ST-STATUTORY-INTEREST.
  1734             20  CF-ST-STAT-DATE-FROM       PIC X.
  1735                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1736                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1737             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1738             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1739             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1740             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1741             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1742
  1743         16  CF-ST-OVER-SHORT.
  1744             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1745             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1746
  1747         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1748
  1749         16  CF-ST-RT-CALC                  PIC X.
  1750
  1751         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1752         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1753         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  32
* SOCK00.cbl
  1754         16  CF-ST-RF-LR-CALC               PIC X.
  1755         16  CF-ST-RF-LL-CALC               PIC X.
  1756         16  CF-ST-RF-LN-CALC               PIC X.
  1757         16  CF-ST-RF-AH-CALC               PIC X.
  1758         16  CF-ST-RF-CP-CALC               PIC X.
  1759*        16  FILLER                         PIC X(206).
  1760*CIDMOD         16  FILLER                         PIC X(192).
  1761         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1762             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1763         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1764         16  CF-ST-VFY-2ND-BENE             PIC X.
  1765         16  CF-ST-CAUSAL-STATE             PIC X.
  1766         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1767         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1768         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1769             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1770         16  CF-ST-NET-ONLY-STATE           PIC X.
  1771             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1772         16  cf-commission-cap-required     pic x.
  1773         16  CF-ST-GA-COMMISSION-CAPS.
  1774             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  1775             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  1776             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  1777             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  1778         16  CF-ST-TOT-COMMISSION-CAPS.
  1779             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  1780             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  1781             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  1782             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  1783         16  FILLER                         PIC X(156).
  1784
  1785****************************************************************
  1786*             BENEFIT MASTER RECORD                            *
  1787****************************************************************
  1788
  1789     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1790         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1791             20  CF-BENEFIT-CODE            PIC XX.
  1792             20  CF-BENEFIT-NUMERIC  REDEFINES
  1793                 CF-BENEFIT-CODE            PIC XX.
  1794             20  CF-BENEFIT-ALPHA           PIC XXX.
  1795             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1796             20  CF-BENEFIT-COMMENT         PIC X(10).
  1797
  1798             20  CF-LF-COVERAGE-TYPE        PIC X.
  1799                 88  CF-REDUCING                VALUE 'R'.
  1800                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1801
  1802             20  CF-SPECIAL-CALC-CD         PIC X.
  1803                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1804                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1805                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1806                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1807                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1808                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1809                 88  CF-FARM-PLAN               VALUE 'F'.
  1810                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1811                 88  CF-2-MTH-INTEREST          VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  33
* SOCK00.cbl
  1812                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1813                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1814                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1815                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1816                 88  CF-PRUDENTIAL              VALUE 'P'.
  1817                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1818                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1819                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1820                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1821                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1822                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1823
  1824             20  CF-JOINT-INDICATOR         PIC X.
  1825                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1826
  1827*            20  FILLER                     PIC X(12).
  1828             20  cf-maximum-benefits        pic s999 comp-3.
  1829             20  FILLER                     PIC X(09).
  1830             20  CF-BENEFIT-CATEGORY        PIC X.
  1831             20  CF-LOAN-TYPE               PIC X(8).
  1832
  1833             20  CF-CO-REM-TERM-CALC        PIC X.
  1834                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1835                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1836                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1837                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1838                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1839
  1840             20  CF-CO-EARNINGS-CALC        PIC X.
  1841                 88  CO-EARN-BY-R78             VALUE '1'.
  1842                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1843                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1844                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1845                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1846                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1847                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1848                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1849
  1850             20  CF-CO-REFUND-CALC          PIC X.
  1851                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1852                 88  CO-REFD-BY-R78             VALUE '1'.
  1853                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1854                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1855                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1856                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1857                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1858                 88  CO-REFD-MEAN               VALUE '8'.
  1859                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1860                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1861                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1862
  1863             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1864                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1865                 88  CO-OVRD-BY-R78             VALUE '1'.
  1866                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1867                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1868                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1869                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  34
* SOCK00.cbl
  1870                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1871                 88  CO-OVRD-MEAN               VALUE '8'.
  1872                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1873
  1874             20  CF-CO-BEN-I-G-CD           PIC X.
  1875                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1876                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1877                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1878
  1879         16  FILLER                         PIC X(304).
  1880
  1881
  1882****************************************************************
  1883*             CARRIER MASTER RECORD                            *
  1884****************************************************************
  1885
  1886     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1887         16  CF-ADDRESS-DATA.
  1888             20  CF-MAIL-TO-NAME            PIC X(30).
  1889             20  CF-IN-CARE-OF              PIC X(30).
  1890             20  CF-ADDRESS-LINE-1          PIC X(30).
  1891             20  CF-ADDRESS-LINE-2          PIC X(30).
  1892             20  CF-CITY-STATE              PIC X(30).
  1893             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1894             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1895
  1896         16  CF-CLAIM-NO-CONTROL.
  1897             20  CF-CLAIM-NO-METHOD         PIC X.
  1898                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1899                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1900                 88  CLAIM-NO-SEQ               VALUE '3'.
  1901                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1902             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1903                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1904                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1905                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1906
  1907         16  CF-CHECK-NO-CONTROL.
  1908             20  CF-CHECK-NO-METHOD         PIC X.
  1909                 88  CHECK-NO-MANUAL            VALUE '1'.
  1910                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1911                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1912                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1913             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1914                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1915
  1916         16  CF-DOMICILE-STATE              PIC XX.
  1917
  1918         16  CF-EXPENSE-CONTROLS.
  1919             20  CF-EXPENSE-METHOD          PIC X.
  1920                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1921                 88  DOLLARS-PER-PMT            VALUE '2'.
  1922                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1923                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1924             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1925             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1926
  1927         16  CF-CORRESPONDENCE-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  35
* SOCK00.cbl
  1928             20  CF-LETTER-RESEND-OPT       PIC X.
  1929                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1930                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1931             20  FILLER                     PIC X(4).
  1932
  1933         16  CF-RESERVE-CONTROLS.
  1934             20  CF-MANUAL-SW               PIC X.
  1935                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1936             20  CF-FUTURE-SW               PIC X.
  1937                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1938             20  CF-PTC-SW                  PIC X.
  1939                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1940             20  CF-IBNR-SW                 PIC X.
  1941                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1942             20  CF-PTC-LF-SW               PIC X.
  1943                 88  CF-LF-PTC-USED             VALUE '1'.
  1944             20  CF-CDT-ACCESS-METHOD       PIC X.
  1945                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1946                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1947                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1948             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1949
  1950         16  CF-CLAIM-CALC-METHOD           PIC X.
  1951             88  360-PLUS-MONTHS                VALUE '1'.
  1952             88  365-PLUS-MONTHS                VALUE '2'.
  1953             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1954             88  360-DAILY                      VALUE '4'.
  1955             88  365-DAILY                      VALUE '5'.
  1956
  1957         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1958         16  FILLER                         PIC X(11).
  1959
  1960         16  CF-LIMIT-AMOUNTS.
  1961             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1962             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1963             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1964             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1965             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1966             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1967             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1968             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1969             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1970             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1971
  1972         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1973         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1974         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1975
  1976         16  CF-ZIP-CODE.
  1977             20  CF-ZIP-PRIME.
  1978                 24  CF-ZIP-1ST             PIC X.
  1979                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1980                 24  FILLER                 PIC X(4).
  1981             20  CF-ZIP-PLUS4               PIC X(4).
  1982         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1983             20  CF-CAN-POSTAL-1            PIC XXX.
  1984             20  CF-CAN-POSTAL-2            PIC XXX.
  1985             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  36
* SOCK00.cbl
  1986
  1987         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1988         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1989         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1990
  1991         16  CF-RATING-SWITCH               PIC X.
  1992             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1993             88  CF-NO-RATING                   VALUE 'N'.
  1994
  1995         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1996
  1997         16  CF-CARRIER-OVER-SHORT.
  1998             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1999             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2000
  2001         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2002         16  CF-SECPAY-SWITCH               PIC X.
  2003             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2004             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2005         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2006         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2007         16  FILLER                         PIC X(444).
  2008*        16  FILLER                         PIC X(452).
  2009
  2010
  2011****************************************************************
  2012*             MORTALITY MASTER RECORD                          *
  2013****************************************************************
  2014
  2015     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2016         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2017                                INDEXED BY CF-MORT-NDX.
  2018             20  CF-MORT-TABLE              PIC X(5).
  2019             20  CF-MORT-TABLE-TYPE         PIC X.
  2020                 88  CF-MORT-JOINT              VALUE 'J'.
  2021                 88  CF-MORT-SINGLE             VALUE 'S'.
  2022                 88  CF-MORT-COMBINED           VALUE 'C'.
  2023                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2024                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2025             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2026             20  CF-MORT-AGE-METHOD         PIC XX.
  2027                 88  CF-AGE-LAST                VALUE 'AL'.
  2028                 88  CF-AGE-NEAR                VALUE 'AN'.
  2029             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2030             20  CF-MORT-ADJUSTMENT-DIRECTION
  2031                                            PIC X.
  2032                 88  CF-MINUS                   VALUE '-'.
  2033                 88  CF-PLUS                    VALUE '+'.
  2034             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2035             20  CF-MORT-JOINT-CODE         PIC X.
  2036                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2037             20  CF-MORT-PC-Q               PIC X.
  2038                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2039             20  CF-MORT-TABLE-CODE         PIC X(4).
  2040             20  CF-MORT-COMMENTS           PIC X(15).
  2041             20  FILLER                     PIC X(14).
  2042
  2043         16  FILLER                         PIC X(251).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  37
* SOCK00.cbl
  2044
  2045
  2046****************************************************************
  2047*             BUSSINESS TYPE MASTER RECORD                     *
  2048****************************************************************
  2049
  2050     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2051* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2052* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2053* AND RECORD 05 IS TYPES 81-99
  2054         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2055             20  CF-BUSINESS-TITLE          PIC  X(19).
  2056             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2057                                            PIC S9V9(4) COMP-3.
  2058             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2059             20  FILLER                     PIC  X.
  2060         16  FILLER                         PIC  X(248).
  2061
  2062
  2063****************************************************************
  2064*             TERMINAL MASTER RECORD                           *
  2065****************************************************************
  2066
  2067     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2068
  2069         16  CF-COMPANY-TERMINALS.
  2070             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2071                                  PIC X(4).
  2072         16  FILLER               PIC X(248).
  2073
  2074
  2075****************************************************************
  2076*             LIFE EDIT MASTER RECORD                          *
  2077****************************************************************
  2078
  2079     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2080         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2081             20  CF-LIFE-CODE-IN            PIC XX.
  2082             20  CF-LIFE-CODE-OUT           PIC XX.
  2083         16  FILLER                         PIC X(248).
  2084
  2085
  2086****************************************************************
  2087*             AH EDIT MASTER RECORD                            *
  2088****************************************************************
  2089
  2090     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2091         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2092             20  CF-AH-CODE-IN              PIC XXX.
  2093             20  CF-AH-CODE-OUT             PIC XX.
  2094         16  FILLER                         PIC X(248).
  2095
  2096
  2097****************************************************************
  2098*             CREDIBILITY TABLES                               *
  2099****************************************************************
  2100
  2101     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  38
* SOCK00.cbl
  2102         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2103                             INDEXED BY CF-CRDB-NDX.
  2104             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2105             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2106             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2107         16  FILLER                         PIC  X(332).
  2108
  2109
  2110****************************************************************
  2111*             REPORT CUSTOMIZATION RECORD                      *
  2112****************************************************************
  2113
  2114     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2115         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2116             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2117             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2118             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2119**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2120****       A T-TRANSFER.                                   ****
  2121             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2122
  2123         16  FILLER                         PIC XX.
  2124
  2125         16  CF-CARRIER-CNTL-OPT.
  2126             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2127                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2128                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2129             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2130                                            PIC X.
  2131         16  CF-GROUP-CNTL-OPT.
  2132             20  CF-GROUP-OPT-SEQ           PIC 9.
  2133                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2134                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2135             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2136                                            PIC X(6).
  2137         16  CF-STATE-CNTL-OPT.
  2138             20  CF-STATE-OPT-SEQ           PIC 9.
  2139                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2140                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2141             20  CF-STATE-SELECT OCCURS 3 TIMES
  2142                                            PIC XX.
  2143         16  CF-ACCOUNT-CNTL-OPT.
  2144             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2145                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2146                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2147             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2148                                            PIC X(10).
  2149         16  CF-BUS-TYP-CNTL-OPT.
  2150             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2151                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2152                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2153             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2154                                            PIC XX.
  2155         16  CF-LF-TYP-CNTL-OPT.
  2156             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2157                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2158                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2159             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  39
* SOCK00.cbl
  2160                                            PIC XX.
  2161         16  CF-AH-TYP-CNTL-OPT.
  2162             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2163                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2164                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2165             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2166                                            PIC XX.
  2167         16  CF-REPTCD1-CNTL-OPT.
  2168             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2169                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2170                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2171             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2172                                            PIC X(10).
  2173         16  CF-REPTCD2-CNTL-OPT.
  2174             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2175                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2176                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2177             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2178                                            PIC X(10).
  2179         16  CF-USER1-CNTL-OPT.
  2180             20  CF-USER1-OPT-SEQ           PIC 9.
  2181                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2182                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2183             20  CF-USER1-SELECT OCCURS 3 TIMES
  2184                                            PIC X(10).
  2185         16  CF-USER2-CNTL-OPT.
  2186             20  CF-USER2-OPT-SEQ           PIC 9.
  2187                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2188                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2189             20  CF-USER2-SELECT OCCURS 3 TIMES
  2190                                            PIC X(10).
  2191         16  CF-USER3-CNTL-OPT.
  2192             20  CF-USER3-OPT-SEQ           PIC 9.
  2193                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2194                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2195             20  CF-USER3-SELECT OCCURS 3 TIMES
  2196                                            PIC X(10).
  2197         16  CF-USER4-CNTL-OPT.
  2198             20  CF-USER4-OPT-SEQ           PIC 9.
  2199                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2200                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2201             20  CF-USER4-SELECT OCCURS 3 TIMES
  2202                                            PIC X(10).
  2203         16  CF-USER5-CNTL-OPT.
  2204             20  CF-USER5-OPT-SEQ           PIC 9.
  2205                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2206                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2207             20  CF-USER5-SELECT OCCURS 3 TIMES
  2208                                            PIC X(10).
  2209         16  CF-REINS-CNTL-OPT.
  2210             20  CF-REINS-OPT-SEQ           PIC 9.
  2211                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2212                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2213             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2214                 24  CF-REINS-PRIME         PIC XXX.
  2215                 24  CF-REINS-SUB           PIC XXX.
  2216
  2217         16  CF-AGENT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  40
* SOCK00.cbl
  2218             20  CF-AGENT-OPT-SEQ           PIC 9.
  2219                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2220                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2221             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2222                                            PIC X(10).
  2223
  2224         16  FILLER                         PIC X(43).
  2225
  2226         16  CF-LOSS-RATIO-SELECT.
  2227             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2228             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2229         16  CF-ENTRY-DATE-SELECT.
  2230             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2231             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2232         16  CF-EFFECTIVE-DATE-SELECT.
  2233             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2234             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2235
  2236         16  CF-EXCEPTION-LIST-IND          PIC X.
  2237             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2238
  2239         16  FILLER                         PIC X(318).
  2240
  2241****************************************************************
  2242*                  EXCEPTION REPORTING RECORD                  *
  2243****************************************************************
  2244
  2245     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2246         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2247             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2248
  2249         16  CF-COMBINED-LIFE-AH-OPT.
  2250             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2251             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2252             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2253             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2254
  2255         16  CF-LIFE-OPT.
  2256             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2257             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2258             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2259             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2260             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2261             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2262             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2263             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2264             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2265             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2266
  2267         16  CF-AH-OPT.
  2268             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2269             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2270             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2271             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2272             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2273             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2274             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2275             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  41
* SOCK00.cbl
  2276             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2277             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2278
  2279         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2280             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2281             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2282             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2283
  2284         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2285
  2286         16  FILLER                         PIC X(673).
  2287
  2288
  2289****************************************************************
  2290*             MORTGAGE SYSTEM PLAN RECORD                      *
  2291****************************************************************
  2292
  2293     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2294         16  CF-PLAN-TYPE                   PIC X.
  2295             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2296             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2297             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2298         16  CF-PLAN-ABBREV                 PIC XXX.
  2299         16  CF-PLAN-DESCRIPT               PIC X(10).
  2300         16  CF-PLAN-NOTES                  PIC X(20).
  2301         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2302         16  CF-PLAN-UNDERWRITING.
  2303             20  CF-PLAN-TERM-DATA.
  2304                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2305                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2306             20  CF-PLAN-AGE-DATA.
  2307                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2308                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2309                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2310             20  CF-PLAN-BENEFIT-DATA.
  2311                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2312                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2313                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2314                                            PIC S9(7)V99  COMP-3.
  2315         16  CF-PLAN-POLICY-FORMS.
  2316             20  CF-POLICY-FORM             PIC X(12).
  2317             20  CF-MASTER-APPLICATION      PIC X(12).
  2318             20  CF-MASTER-POLICY           PIC X(12).
  2319         16  CF-PLAN-RATING.
  2320             20  CF-RATE-CODE               PIC X(5).
  2321             20  CF-SEX-RATING              PIC X.
  2322                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2323                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2324             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2325             20  CF-SUB-STD-TYPE            PIC X.
  2326                 88  CF-PCT-OF-PREM            VALUE '1'.
  2327                 88  CF-PCT-OF-BENE            VALUE '2'.
  2328         16  CF-PLAN-PREM-TOLERANCES.
  2329             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2330             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2331         16  CF-PLAN-PYMT-TOLERANCES.
  2332             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2333             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  42
* SOCK00.cbl
  2334         16  CF-PLAN-MISC-DATA.
  2335             20  FILLER                     PIC X.
  2336             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2337             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2338         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2339         16  CF-PLAN-IND-GRP                PIC X.
  2340             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2341                                                     '1'.
  2342             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2343                                                     '2'.
  2344         16  CF-MIB-SEARCH-SW               PIC X.
  2345             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2346             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2347             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2348             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2349         16  CF-ALPHA-SEARCH-SW             PIC X.
  2350             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2351             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2352             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2353             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2354             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2355             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2356             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2357             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2358             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2359             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2360                                                     'A' 'B' 'C'
  2361                                                     'X' 'Y' 'Z'.
  2362         16  CF-EFF-DT-RULE-SW              PIC X.
  2363             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2364             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2365             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2366             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2367             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2368         16  FILLER                         PIC X(4).
  2369         16  CF-HEALTH-QUESTIONS            PIC X.
  2370             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2371         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2372         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2373         16  CF-PLAN-SNGL-JNT               PIC X.
  2374             88  CF-COMBINED-PLAN              VALUE 'C'.
  2375             88  CF-JNT-PLAN                   VALUE 'J'.
  2376             88  CF-SNGL-PLAN                  VALUE 'S'.
  2377         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2378         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2379         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2380         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2381         16  CF-RERATE-CNTL                 PIC  X.
  2382             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2383             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2384             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2385             88  CF-AUTO-RECALC                 VALUE '4'.
  2386         16  CF-BENEFIT-TYPE                PIC  X.
  2387             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2388             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2389         16  CF-POLICY-FEE                  PIC S999V99
  2390                                                    COMP-3.
  2391         16  CF-1ST-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  43
* SOCK00.cbl
  2392         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2393         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2394         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2395         16  FILLER                         PIC  X(32).
  2396         16  CF-TERMINATION-FORM            PIC  X(04).
  2397         16  FILLER                         PIC  X(08).
  2398         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2399                                                       COMP-3.
  2400         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2401         16  CF-ISSUE-LETTER                PIC  X(4).
  2402         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2403         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2404             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2405             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2406         16  CF-MP-REFUND-CALC              PIC X.
  2407             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2408             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2409             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2410             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2411             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2412             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2413             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2414             88  CF-MP-REFD-MEAN                VALUE '8'.
  2415         16  CF-ALT-RATE-CODE               PIC  X(5).
  2416
  2417
  2418         16  FILLER                         PIC X(498).
  2419****************************************************************
  2420*             MORTGAGE COMPANY MASTER RECORD                   *
  2421****************************************************************
  2422
  2423     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2424         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2425         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2426             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2427             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2428             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2429             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2430             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2431
  2432         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2433         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2434         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2435         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2436         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2437
  2438         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2439             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2440         16  CF-MP-RECON-USE-IND            PIC X(1).
  2441             88  CF-MP-USE-RECON             VALUE 'Y'.
  2442         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2443             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2444         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2445             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2446             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2447         16  FILLER                         PIC X(1).
  2448         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2449             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  44
* SOCK00.cbl
  2450         16  CF-MORTG-MIB-VERSION           PIC X.
  2451             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2452             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2453             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2454         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2455             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2456                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2457             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2458                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2459             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2460                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2461             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2462                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2463             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2464                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2465             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2466                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2467         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2468         16  FILLER                         PIC X(7).
  2469         16  CF-MORTG-DESTINATION-SYMBOL.
  2470             20  CF-MORTG-MIB-COMM          PIC X(5).
  2471             20  CF-MORTG-MIB-TERM          PIC X(5).
  2472         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2473             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2474         16  FILLER                         PIC X(03).
  2475         16  CF-MP-CHECK-NO-CONTROL.
  2476             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2477                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2478                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2479                                                ' ' LOW-VALUES.
  2480                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2481                                               VALUE '3'.
  2482         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2483         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2484         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2485             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2486                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2487             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2488                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2489             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2490                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2491             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2492                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2493             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2494                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2495             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2496                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2497         16  CF-MORTG-BILLING-AREA.
  2498             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2499                                            PIC X.
  2500         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2501         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2502         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2503         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2504             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2505             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2506         16  FILLER                         PIC X.
  2507         16  CF-MORTG-LABEL-CONTROL         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  45
* SOCK00.cbl
  2508             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2509             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2510         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2511         16  FILLER                         PIC X(8).
  2512         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2513         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2514         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2515         16  CF-ACH-COMPANY-ID.
  2516             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2517                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2518                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2519                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2520             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2521         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2522             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2523         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2524             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2525             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2526         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2527         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2528         16  FILLER                         PIC X(536).
  2529
  2530****************************************************************
  2531*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2532****************************************************************
  2533
  2534     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2535         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2536             20  CF-FEMALE-HEIGHT.
  2537                 24  CF-FEMALE-FT           PIC 99.
  2538                 24  CF-FEMALE-IN           PIC 99.
  2539             20  CF-FEMALE-MIN-WT           PIC 999.
  2540             20  CF-FEMALE-MAX-WT           PIC 999.
  2541         16  FILLER                         PIC X(428).
  2542
  2543     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2544         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2545             20  CF-MALE-HEIGHT.
  2546                 24  CF-MALE-FT             PIC 99.
  2547                 24  CF-MALE-IN             PIC 99.
  2548             20  CF-MALE-MIN-WT             PIC 999.
  2549             20  CF-MALE-MAX-WT             PIC 999.
  2550         16  FILLER                         PIC X(428).
  2551******************************************************************
  2552*             AUTOMATIC ACTIVITY RECORD                          *
  2553******************************************************************
  2554     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2555         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2556             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2557             20  CF-SYS-LETTER-ID           PIC X(04).
  2558             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2559             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2560             20  CF-SYS-RESET-SW            PIC X(01).
  2561             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2562             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2563
  2564         16  FILLER                         PIC X(50).
  2565
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  46
* SOCK00.cbl
  2566         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2567             20  CF-USER-ACTIVE-SW          PIC X(01).
  2568             20  CF-USER-LETTER-ID          PIC X(04).
  2569             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2570             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2571             20  CF-USER-RESET-SW           PIC X(01).
  2572             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2573             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2574             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2575
  2576         16  FILLER                         PIC X(246).
  2577*                                 COPY ERCCTBL.
  2578******************************************************************
  2579*                                                                *
  2580*                                                                *
  2581*                            ERCCTBL                             *
  2582*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2583*                            VMOD=2.003
  2584*                                                                *
  2585*   ONLINE CREDIT SYSTEM                                         *
  2586*                                                                *
  2587*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2588*                                                                *
  2589*   FILE TYPE = VSAM,KSDS                                        *
  2590*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2591*                                                                *
  2592*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2593*       ALTERNATE PATH = NONE                                    *
  2594*                                                                *
  2595*   LOG = NO                                                     *
  2596*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2597*                                                                *
  2598*                                                                *
  2599******************************************************************
  2600
  2601 01  COMM-TABLE-RECORD.
  2602     12  CT-RECORD-ID                      PIC XX.
  2603         88  VALID-CT-ID                      VALUE 'CT'.
  2604
  2605     12  CT-CONTROL-PRIMARY.
  2606         16  CT-COMPANY-CD                 PIC X.
  2607         16  CT-TABLE                      PIC XXX.
  2608         16  CT-CNTRL-2.
  2609             20  CT-BEN-TYPE               PIC X.
  2610             20  CT-BEN-CODE               PIC XX.
  2611
  2612     12  CT-MAINT-INFORMATION.
  2613         16  CT-LAST-MAINT-DT              PIC XX.
  2614         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2615         16  CT-LAST-MAINT-USER            PIC X(4).
  2616         16  FILLER                        PIC X(31).
  2617
  2618     12  CT-LIMITS.
  2619         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2620
  2621         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2622
  2623         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  47
* SOCK00.cbl
  2624
  2625     12  CT-RATES.
  2626         16  CT-RTX          OCCURS 27 TIMES.
  2627             20  CT-RT                     PIC SV9(5)     COMP-3.
  2628             20  CT-RT-R   REDEFINES
  2629                 CT-RT                     PIC XXX.
  2630
  2631     12  FILLER                            PIC  X(42).
  2632
  2633******************************************************************
  2634*                                 COPY ELCDATE.
  2635******************************************************************
  2636*                                                                *
  2637*                                                                *
  2638*                            ELCDATE.                            *
  2639*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2640*                            VMOD=2.003
  2641*                                                                *
  2642*                                                                *
  2643*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2644*                 LENGTH = 200                                   *
  2645******************************************************************
  2646
  2647 01  DATE-CONVERSION-DATA.
  2648     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2649     12  DC-OPTION-CODE                PIC X.
  2650         88  BIN-TO-GREG                VALUE ' '.
  2651         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2652         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2653         88  YMD-GREG-TO-BIN            VALUE '3'.
  2654         88  MDY-GREG-TO-BIN            VALUE '4'.
  2655         88  JULIAN-TO-BIN              VALUE '5'.
  2656         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2657         88  FIND-CENTURY               VALUE '7'.
  2658         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2659         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2660         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2661         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2662         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2663         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2664         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2665         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2666         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2667         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2668         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2669         88  BIN-3-TO-GREG              VALUE 'I'.
  2670         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2671         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2672         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2673         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2674         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2675         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2676         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2677         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2678         88  THREE-CHARACTER-BIN
  2679                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2680         88  GREGORIAN-TO-BIN
  2681                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  48
* SOCK00.cbl
  2682         88  BIN-TO-GREGORIAN
  2683                  VALUES ' ' '1' 'I' '8' 'G'.
  2684         88  JULIAN-TO-BINARY
  2685                  VALUES '5' 'C' 'E' 'F'.
  2686     12  DC-ERROR-CODE                 PIC X.
  2687         88  NO-CONVERSION-ERROR        VALUE ' '.
  2688         88  DATE-CONVERSION-ERROR
  2689                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2690         88  DATE-IS-ZERO               VALUE '1'.
  2691         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2692         88  DATE-IS-INVALID            VALUE '3'.
  2693         88  DATE1-GREATER-DATE2        VALUE '4'.
  2694         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2695         88  DATE-INVALID-OPTION        VALUE '9'.
  2696         88  INVALID-CENTURY            VALUE 'A'.
  2697         88  ONLY-CENTURY               VALUE 'B'.
  2698         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2699         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2700     12  DC-END-OF-MONTH               PIC X.
  2701         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2702     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2703         88  USE-NORMAL-PROCESS         VALUE ' '.
  2704         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2705         88  ADJUST-UP-100-YRS          VALUE '2'.
  2706     12  FILLER                        PIC X.
  2707     12  DC-CONVERSION-DATES.
  2708         16  DC-BIN-DATE-1             PIC XX.
  2709         16  DC-BIN-DATE-2             PIC XX.
  2710         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2711         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2712                       DC-GREG-DATE-1-EDIT.
  2713             20  DC-EDIT1-MONTH        PIC 99.
  2714             20  SLASH1-1              PIC X.
  2715             20  DC-EDIT1-DAY          PIC 99.
  2716             20  SLASH1-2              PIC X.
  2717             20  DC-EDIT1-YEAR         PIC 99.
  2718         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2719         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2720                     DC-GREG-DATE-2-EDIT.
  2721             20  DC-EDIT2-MONTH        PIC 99.
  2722             20  SLASH2-1              PIC X.
  2723             20  DC-EDIT2-DAY          PIC 99.
  2724             20  SLASH2-2              PIC X.
  2725             20  DC-EDIT2-YEAR         PIC 99.
  2726         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2727         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2728                     DC-GREG-DATE-1-YMD.
  2729             20  DC-YMD-YEAR           PIC 99.
  2730             20  DC-YMD-MONTH          PIC 99.
  2731             20  DC-YMD-DAY            PIC 99.
  2732         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2733         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2734                      DC-GREG-DATE-1-MDY.
  2735             20  DC-MDY-MONTH          PIC 99.
  2736             20  DC-MDY-DAY            PIC 99.
  2737             20  DC-MDY-YEAR           PIC 99.
  2738         16  DC-GREG-DATE-1-ALPHA.
  2739             20  DC-ALPHA-MONTH        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  49
* SOCK00.cbl
  2740             20  DC-ALPHA-DAY          PIC 99.
  2741             20  FILLER                PIC XX.
  2742             20  DC-ALPHA-CENTURY.
  2743                 24 DC-ALPHA-CEN-N     PIC 99.
  2744             20  DC-ALPHA-YEAR         PIC 99.
  2745         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2746         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2747         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2748         16  DC-JULIAN-DATE            PIC 9(05).
  2749         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2750                                       PIC 9(05).
  2751         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2752             20  DC-JULIAN-YEAR        PIC 99.
  2753             20  DC-JULIAN-DAYS        PIC 999.
  2754         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2755         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2756         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2757     12  DATE-CONVERSION-VARIBLES.
  2758         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2759         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2760             20  FILLER                PIC 9(3).
  2761             20  HOLD-CEN-1-CCYY.
  2762                 24  HOLD-CEN-1-CC     PIC 99.
  2763                 24  HOLD-CEN-1-YY     PIC 99.
  2764             20  HOLD-CEN-1-MO         PIC 99.
  2765             20  HOLD-CEN-1-DA         PIC 99.
  2766         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2767             20  HOLD-CEN-1-R-MO       PIC 99.
  2768             20  HOLD-CEN-1-R-DA       PIC 99.
  2769             20  HOLD-CEN-1-R-CCYY.
  2770                 24  HOLD-CEN-1-R-CC   PIC 99.
  2771                 24  HOLD-CEN-1-R-YY   PIC 99.
  2772             20  FILLER                PIC 9(3).
  2773         16  HOLD-CENTURY-1-X.
  2774             20  FILLER                PIC X(3)  VALUE SPACES.
  2775             20  HOLD-CEN-1-X-CCYY.
  2776                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2777                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2778             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2779             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2780         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2781             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2782             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2783             20  HOLD-CEN-1-R-X-CCYY.
  2784                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2785                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2786             20  FILLER                PIC XXX.
  2787         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2788         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2789         16  DC-JULIAN-DATE-1          PIC 9(07).
  2790         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2791             20  DC-JULIAN-1-CCYY.
  2792                 24  DC-JULIAN-1-CC    PIC 99.
  2793                 24  DC-JULIAN-1-YR    PIC 99.
  2794             20  DC-JULIAN-DA-1        PIC 999.
  2795         16  DC-JULIAN-DATE-2          PIC 9(07).
  2796         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2797             20  DC-JULIAN-2-CCYY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  50
* SOCK00.cbl
  2798                 24  DC-JULIAN-2-CC    PIC 99.
  2799                 24  DC-JULIAN-2-YR    PIC 99.
  2800             20  DC-JULIAN-DA-2        PIC 999.
  2801         16  DC-GREG-DATE-A-EDIT.
  2802             20  DC-EDITA-MONTH        PIC 99.
  2803             20  SLASHA-1              PIC X VALUE '/'.
  2804             20  DC-EDITA-DAY          PIC 99.
  2805             20  SLASHA-2              PIC X VALUE '/'.
  2806             20  DC-EDITA-CCYY.
  2807                 24  DC-EDITA-CENT     PIC 99.
  2808                 24  DC-EDITA-YEAR     PIC 99.
  2809         16  DC-GREG-DATE-B-EDIT.
  2810             20  DC-EDITB-MONTH        PIC 99.
  2811             20  SLASHB-1              PIC X VALUE '/'.
  2812             20  DC-EDITB-DAY          PIC 99.
  2813             20  SLASHB-2              PIC X VALUE '/'.
  2814             20  DC-EDITB-CCYY.
  2815                 24  DC-EDITB-CENT     PIC 99.
  2816                 24  DC-EDITB-YEAR     PIC 99.
  2817         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2818         16  DC-GREG-DATE-CYMD-R REDEFINES
  2819                              DC-GREG-DATE-CYMD.
  2820             20  DC-CYMD-CEN           PIC 99.
  2821             20  DC-CYMD-YEAR          PIC 99.
  2822             20  DC-CYMD-MONTH         PIC 99.
  2823             20  DC-CYMD-DAY           PIC 99.
  2824         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2825         16  DC-GREG-DATE-MDCY-R REDEFINES
  2826                              DC-GREG-DATE-MDCY.
  2827             20  DC-MDCY-MONTH         PIC 99.
  2828             20  DC-MDCY-DAY           PIC 99.
  2829             20  DC-MDCY-CEN           PIC 99.
  2830             20  DC-MDCY-YEAR          PIC 99.
  2831    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2832        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2833    12  DC-EL310-DATE                  PIC X(21).
  2834    12  FILLER                         PIC X(28).
  2835*                                 COPY ELCCALC.
  2836******************************************************************
  2837*                                                                *
  2838*                           ELCCALC.                            *
  2839*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2840*                            VMOD=2.025                          *
  2841*                                                                *
  2842*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2843*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2844*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2845*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2846*                                                                *
  2847*  PASSED TO ELRTRM                                              *
  2848*  -----------------                                             *
  2849*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2850*  ORIGINAL TERM                                                 *
  2851*  BEGINNING DATE                                                *
  2852*  ENDING DATE                                                   *
  2853*  COMPANY I.D.                                                  *
  2854*  ACCOUNT MASTER USER FIELD                                     *
  2855*  PROCESS SWITCH (CANCEL, CLAIM)                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  51
* SOCK00.cbl
  2856*  FREE LOOK DAYS                                                *
  2857*                                                                *
  2858*  RETURNED FROM ELRTRM                                          *
  2859*  ---------------------                                         *
  2860*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2861*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2862*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2863*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2864*----------------------------------------------------------------*
  2865*  PASSED TO ELRAMT                                              *
  2866*  ----------------                                              *
  2867*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2868*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2869*  ORIGINAL AMOUNT                                               *
  2870*  ALTERNATE BENEFIT (BALLON)                                    *
  2871*  A.P.R. - NET PAY ONLY                                         *
  2872*  METHOD
  2873*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2874*  COMPANY I.D.                                                  *
  2875*  BENEFIT TYPE                                                  *
  2876*                                                                *
  2877*  RETURNED FROM ELRAMT                                          *
  2878*  --------------------                                          *
  2879*  REMAINING AMOUNT 1 - CURRENT                                  *
  2880*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2881*  REMAINING AMOUNT FACTOR
  2882*----------------------------------------------------------------*
  2883*  PASSED TO ELRESV                                              *
  2884*  -----------------                                             *
  2885*  CERTIFICATE EFFECTIVE DATE                                    *
  2886*  VALUATION DATE                                                *
  2887*  PAID THRU DATE                                                *
  2888*  BENEFIT                                                       *
  2889*  INCURRED DATE                                                 *
  2890*  REPORTED DATE                                                 *
  2891*  ISSUE AGE                                                     *
  2892*  TERM                                                          *
  2893*  CDT PERCENT                                                   *
  2894*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2895* *CLAIM TYPE (LIFE, A/H)                                        *
  2896* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2897* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2898*                                                                *
  2899*  RETURNED FROM ELRESV                                          *
  2900*  --------------------                                          *
  2901*  CDT TABLE USED                                                *
  2902*  CDT FACTOR USED                                               *
  2903*  PAY TO CURRENT RESERVE                                        *
  2904*  I.B.N.R. - A/H ONLY                                           *
  2905*  FUTURE (ACCRUED) AH ONLY                                      *
  2906*----------------------------------------------------------------*
  2907*  PASSED TO ELRATE                                              *
  2908*  ----------------                                              *
  2909*  CERT ISSUE DATE                                               *
  2910*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2911*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2912*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2913*  STATE CODE (CLIENT DEFINED)                                   *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  52
* SOCK00.cbl
  2914*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2915*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2916*  DEVIATION CODE                                                *
  2917*  ISSUE AGE                                                     *
  2918*  ORIGINAL BENEFIT AMOUNT                                       *
  2919*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2920*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2921*  BENEFIT KIND (LIFE OR A/H)                                    *
  2922*  A.P.R.                                                        *
  2923*  METHOD
  2924*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2925*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2926*  COMPANY I.D. (3 CHARACTER)                                    *
  2927*  BENEFIT CODE                                                  *
  2928*  BENEFIT OVERRIDE CODE                                         *
  2929*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2930*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2931*  JOINT INDICATOR (CSL ONLY)                                    *
  2932*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2933*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2934*                                                                *
  2935*  RETURNED FROM ELRATE                                          *
  2936*  --------------------                                          *
  2937*  CALCULATED PREMIUM                                            *
  2938*  PREMIUM RATE                                                  *
  2939*  MORTALITY CODE                                                *
  2940*  MAX ATTAINED AGE                                              *
  2941*  MAX AGE                                                       *
  2942*  MAX TERM                                                      *
  2943*  MAX MONTHLY BENEFIT                                           *
  2944*  MAX TOTAL BENIFIT                                             *
  2945*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2946*----------------------------------------------------------------*
  2947*  PASSED TO ELRFND                                              *
  2948*  ----------------                                              *
  2949*  CERT ISSUE DATE                                               *
  2950*  REFUND DATE                                                   *
  2951*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2952*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2953*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2954*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2955*  STATE CODE (CLIENT DEFINED)                                   *
  2956*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2957*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2958*  DEVIATION CODE                                                *
  2959*  ISSUE AGE                                                     *
  2960*  ORIGINAL BENEFIT AMOUNT                                       *
  2961*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2962*  PROCESS TYPE (CANCEL)                                         *
  2963*  BENEFIT KIND (LIFE OR A/H)                                    *
  2964*  A.P.R.                                                        *
  2965*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2966*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2967*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2968*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2969*  COMPANY I.D. (3 CHARACTER)                                    *
  2970*  BENEFIT CODE                                                  *
  2971*  BENEFIT OVERRIDE CODE                                         *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  53
* SOCK00.cbl
  2972*                                                                *
  2973*  RETURNED FROM ELRFND                                          *
  2974*  --------------------                                          *
  2975*  CALCULATED REFUND                                             *
  2976*----------------------------------------------------------------*
  2977*  PASSED TO ELEARN                                              *
  2978*  ----------------                                              *
  2979*  CERT ISSUE DATE                                               *
  2980*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2981*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2982*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2983*  STATE CODE (CLIENT DEFINED)                                   *
  2984*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2985*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2986*  DEVIATION CODE                                                *
  2987*  ISSUE AGE                                                     *
  2988*  ORIGINAL BENEFIT AMOUNT                                       *
  2989*  BENEFIT KIND (LIFE OR A/H)                                    *
  2990*  A.P.R.                                                        *
  2991*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2992*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2993*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2994*  COMPANY I.D. (3 CHARACTER)                                    *
  2995*  BENEFIT CODE                                                  *
  2996*  BENEFIT OVERRIDE CODE                                         *
  2997*                                                                *
  2998*  RETURNED FROM ELEARN                                          *
  2999*  --------------------                                          *
  3000*  INDICATED  EARNINGS                                           *
  3001*----------------------------------------------------------------*
  3002*                 LENGTH = 450                                   *
  3003*                                                                *
  3004******************************************************************
  3005******************************************************************
  3006*                   C H A N G E   L O G
  3007*
  3008* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3009*-----------------------------------------------------------------
  3010*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3011* EFFECTIVE    NUMBER
  3012*-----------------------------------------------------------------
  3013* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3014* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3015* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3016* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3017* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3018* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3019* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3020* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3021* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3022* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3023* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3024* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
  3025******************************************************************
  3026
  3027 01  CALCULATION-PASS-AREA.
  3028     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3029                                     COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  54
* SOCK00.cbl
  3030
  3031     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3032       88  NO-CP-ERROR                             VALUE ZERO.
  3033       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3034                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
  3035       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3036       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3037       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3038       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3039       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3040       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3041       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3042       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3043       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3044       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3045       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3046       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3047       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3048       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3049       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3050       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3051       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3052       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
  3053
  3054     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3055       88  NO-CP-ERROR-2                           VALUE ZERO.
  3056***********************  INPUT AREAS ****************************
  3057
  3058     12  CP-CALCULATION-AREA.
  3059         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3060         16  CP-CERT-EFF-DT        PIC XX.
  3061         16  CP-VALUATION-DT       PIC XX.
  3062         16  CP-PAID-THRU-DT       PIC XX.
  3063         16  CP-BENEFIT-TYPE       PIC X.
  3064           88  CP-AH                               VALUE 'A' 'D'
  3065                                                   'I' 'U'.
  3066           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3067           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3068         16  CP-INCURRED-DT        PIC XX.
  3069         16  CP-REPORTED-DT        PIC XX.
  3070         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3071         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3072         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3073                                     COMP-3.
  3074         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3075                                     COMP-3.
  3076         16  CP-CDT-METHOD         PIC X.
  3077           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3078           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3079           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3080         16  CP-CLAIM-TYPE         PIC X.
  3081           88  CP-AH-CLAIM                         VALUE 'A'.
  3082           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3083         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3084                                     COMP-3.
  3085         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3086                                     COMP-3.
  3087         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  55
* SOCK00.cbl
  3088                                     COMP-3.
  3089         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3090                                     COMP-3.
  3091         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3092                                     COMP-3.
  3093         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3094                                     COMP-3.
  3095         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3096                                     COMP-3.
  3097         16  CP-REM-TERM-METHOD    PIC X.
  3098           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3099           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3100           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3101           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3102           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3103           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3104           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3105         16  CP-EARNING-METHOD     PIC X.
  3106           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3107           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3108           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3109           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3110           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3111           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3112           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3113           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3114           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3115           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3116           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3117           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3118           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3119           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3120         16  CP-PROCESS-TYPE       PIC X.
  3121           88  CP-CLAIM                            VALUE '1'.
  3122           88  CP-CANCEL                           VALUE '2'.
  3123           88  CP-ISSUE                            VALUE '3'.
  3124         16  CP-SPECIAL-CALC-CD    PIC X.
  3125           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3126           88  CP-1-MTH-INTEREST               VALUE ' '.
  3127           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3128           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3129           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3130           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3131           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3132           88  CP-FARM-PLAN                    VALUE 'F'.
  3133           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3134           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3135           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3136           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3137           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3138           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3139           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3140           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3141           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3142           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3143                                                     'W' 'X'.
  3144           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3145           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  56
* SOCK00.cbl
  3146           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3147           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3148           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3149           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3150           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3151           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3152           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3153           88  CP-CSL-METH-1                   VALUE '5'.
  3154           88  CP-CSL-METH-2                   VALUE '6'.
  3155           88  CP-CSL-METH-3                   VALUE '7'.
  3156           88  CP-CSL-METH-4                   VALUE '8'.
  3157
  3158         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3159                                     COMP-3.
  3160         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3161         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3162         16  CP-STATE              PIC XX          VALUE SPACE.
  3163         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3164         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3165           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3166               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3167         16  CP-R78-OPTION         PIC X.
  3168           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3169           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3170
  3171         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3172         16  CP-IBNR-RESERVE-SW    PIC X.
  3173         16  CP-CLAIM-STATUS       PIC X.
  3174         16  CP-RATE-FILE          PIC X.
  3175         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3176                                     COMP-3.
  3177
  3178         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3179         16  CP-AH-OVERRIDE-CODE   PIC X.
  3180
  3181         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3182                                     COMP-3.
  3183         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3184                                   PIC S9(5)V99 COMP-3.
  3185         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3186                                     COMP-3.
  3187         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3188                                     COMP-3.
  3189         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3190                                     COMP-3.
  3191         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3192                                  PIC S9(7)V99 COMP-3.
  3193
  3194         16  CP-PAID-FROM-DATE     PIC X(02).
  3195         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3196         16  CP-EXT-DAYS-CALC      PIC X.
  3197           88  CP-EXT-NO-CHG                   VALUE ' '.
  3198           88  CP-EXT-CHG-LF                   VALUE '1'.
  3199           88  CP-EXT-CHG-AH                   VALUE '2'.
  3200           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3201         16  CP-DOMICILE-STATE     PIC XX.
  3202         16  CP-CARRIER            PIC X.
  3203         16  CP-REIN-FLAG          PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  57
* SOCK00.cbl
  3204         16  CP-REM-TRM-CALC-OPTION PIC X.
  3205           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3206                      '2' '3' '4' '5'.
  3207           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3208           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3209           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3210           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3211           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3212           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3213           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3214           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3215         16  CP-SIG-SWITCH         PIC X.
  3216         16  CP-RATING-METHOD      PIC X.
  3217           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3218           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3219           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3220           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3221           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3222           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3223           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3224           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3225           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3226         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3227                                     COMP-3.
  3228         16  CP-BEN-CATEGORY       PIC X.
  3229         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3230         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3231                                   PIC S99V9(5) COMP-3.
  3232         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3233         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3234                                   PIC S99V9(5) COMP-3.
  3235         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3236         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3237         16  CP-EXPIRE-DT          PIC XX.
  3238         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3239         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3240         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3241         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3242         16  CP-DDF-SPEC-CALC      PIC X.
  3243             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3244             88  CP-CALC-CLP              VALUE 'C'.
  3245         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3246         16  CP-CANCEL-REASON      PIC X.
  3247         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3248         16  CP-PMT-MODE           PIC X.
  3249         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3250         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3251         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3252         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3253         16  FILLER                PIC X.
  3254
  3255***************    OUTPUT FROM ELRESV   ************************
  3256
  3257         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3258
  3259         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3260                                     COMP-3.
  3261         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  58
* SOCK00.cbl
  3262                                     COMP-3.
  3263         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3264                                     COMP-3.
  3265         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3266                                     COMP-3.
  3267         16  FILLER                PIC X(09).
  3268***************    OUTPUT FROM ELRTRM   *************************
  3269
  3270         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3271                                     COMP-3.
  3272         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3273                                     COMP-3.
  3274         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3275                                     COMP-3.
  3276         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3277                                     COMP-3.
  3278         16  FILLER                PIC X(12).
  3279
  3280***************    OUTPUT FROM ELRAMT   *************************
  3281
  3282         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3283                                     COMP-3.
  3284         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3285                                     COMP-3.
  3286         16  FILLER                PIC X(12).
  3287
  3288***************    OUTPUT FROM ELRATE   *************************
  3289
  3290         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3291                                     COMP-3.
  3292         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3293                                     COMP-3.
  3294         16  CP-MORTALITY-CODE     PIC X(4).
  3295         16  CP-RATE-EDIT-FLAG     PIC X.
  3296             88  CP-RATES-NEED-APR                  VALUE '1'.
  3297         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3298                                     COMP-3.
  3299         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3300         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3301         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3302                                   PIC S9(7)V99 COMP-3.
  3303         16  FILLER                PIC X(07).
  3304
  3305***************    OUTPUT FROM ELRFND   *************************
  3306
  3307         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3308                                     COMP-3.
  3309         16  CP-REFUND-TYPE-USED   PIC X.
  3310           88  CP-R-AS-R78                         VALUE '1'.
  3311           88  CP-R-AS-PRORATA                     VALUE '2'.
  3312           88  CP-R-AS-CALIF                       VALUE '3'.
  3313           88  CP-R-AS-TEXAS                       VALUE '4'.
  3314           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3315           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3316           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3317           88  CP-R-AS-MEAN                        VALUE '8'.
  3318           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3319           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  59
* SOCK00.cbl
  3320           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3321           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3322           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3323           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3324         16  FILLER                PIC X(12).
  3325
  3326***************    OUTPUT FROM ELEARN   *************************
  3327
  3328         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3329                                     COMP-3.
  3330         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3331                                     COMP-3.
  3332         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3333                                     COMP-3.
  3334         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3335                                     COMP-3.
  3336         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3337                                     COMP-3.
  3338         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3339                                     COMP-3.
  3340         16  CP-EARNING-TYPE-USED  PIC X.
  3341           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3342           88  CP-E-AS-R78                         VALUE '1'.
  3343           88  CP-E-AS-PRORATA                     VALUE '2'.
  3344           88  CP-E-AS-TEXAS                       VALUE '4'.
  3345           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3346           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3347           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3348           88  CP-E-AS-MEAN                        VALUE '8'.
  3349           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3350         16  FILLER                PIC X(12).
  3351
  3352***************    OUTPUT FROM ELPMNT   *************************
  3353
  3354         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3355                                     COMP-3.
  3356         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3357                                     COMP-3.
  3358         16  FILLER                PIC X(12).
  3359
  3360***************   MISC WORK AREAS    *****************************
  3361         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3362                                     COMP-3.
  3363         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3364                                     COMP-3.
  3365         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3366                                     COMP-3.
  3367         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3368                                     COMP-3.
  3369         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3370                                     COMP-3.
  3371         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3372                                     COMP-3.
  3373         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3374             88  OPEN-RATE-FILE                   VALUE 'O'.
  3375             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3376             88  IO-ERROR                         VALUE 'E'.
  3377
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  60
* SOCK00.cbl
  3378         16  CP-FIRST-PAY-DATE     PIC XX.
  3379
  3380         16  CP-JOINT-INDICATOR    PIC X.
  3381
  3382         16  CP-RESERVE-REMAINING-TERM
  3383                                   PIC S9(4)V9    VALUE ZERO
  3384                                     COMP-3.
  3385
  3386         16  CP-INSURED-BIRTH-DT   PIC XX.
  3387
  3388         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3389                                     COMP-3.
  3390
  3391         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3392                                     COMP-3.
  3393
  3394         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3395                                     COMP-3.
  3396
  3397         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3398                                     COMP-3.
  3399
  3400         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3401                                     COMP-3.
  3402
  3403         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3404                                     COMP-3.
  3405
  3406         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3407                                     COMP-3.
  3408
  3409         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3410             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3411
  3412         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3413                                     COMP-3.
  3414         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3415                                     COMP-3.
  3416         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3417         16  cp-extra-periods      pic 9 value zeros.
  3418         16  cp-net-only-state     pic x value spaces.
  3419         16  FILLER                PIC X(13).
  3420******************************************************************
  3421****************************************************************
  3422*
  3423* Copyright (c) 2007-2013 Dell Inc.
  3424* All rights reserved.
  3425*
  3426****************************************************************
  3427 01  DFHEIV.
  3428   02  DFHEIV0               PIC X(35).
  3429   02  DFHEIV1               PIC X(08).
  3430   02  DFHEIV2               PIC X(08).
  3431   02  DFHEIV3               PIC X(08).
  3432   02  DFHEIV4               PIC X(06).
  3433   02  DFHEIV5               PIC X(04).
  3434   02  DFHEIV6               PIC X(04).
  3435   02  DFHEIV7               PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  61
* SOCK00.cbl
  3436   02  DFHEIV8               PIC X(02).
  3437   02  DFHEIV9               PIC X(01).
  3438   02  DFHEIV10              PIC S9(7) COMP-3.
  3439   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3440   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3441   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3442   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3443   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3444   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3445   02  DFHEIV17              PIC X(04).
  3446   02  DFHEIV18              PIC X(04).
  3447   02  DFHEIV19              PIC X(04).
  3448   02  DFHEIV20              USAGE IS POINTER.
  3449   02  DFHEIV21              USAGE IS POINTER.
  3450   02  DFHEIV22              USAGE IS POINTER.
  3451   02  DFHEIV23              USAGE IS POINTER.
  3452   02  DFHEIV24              USAGE IS POINTER.
  3453   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3454   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3455   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3456   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3457   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3458   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3459   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3460   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3461   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3462   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3463   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3464   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3465   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3466   02  FILLER                PIC X(02).
  3467   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3468   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3469   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3470   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3471   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3472   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3473   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3474 LINKAGE  SECTION.
  3475*****************************************************************
  3476*                                                               *
  3477* Copyright (c) 2007-2013 Dell Inc.                             *
  3478* All rights reserved.                                          *
  3479*                                                               *
  3480*****************************************************************
  3481 01  dfheiblk.
  3482     02  eibtime          pic s9(7) comp-3.
  3483     02  eibdate          pic s9(7) comp-3.
  3484     02  eibtrnid         pic x(4).
  3485     02  eibtaskn         pic s9(7) comp-3.
  3486     02  eibtrmid         pic x(4).
  3487     02  dfheigdi         pic s9(4) comp.
  3488     02  eibcposn         pic s9(4) comp.
  3489     02  eibcalen         pic s9(4) comp.
  3490     02  eibaid           pic x(1).
  3491     02  eibfiller1       pic x(1).
  3492     02  eibfn            pic x(2).
  3493     02  eibfiller2       pic x(2).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  62
* SOCK00.cbl
  3494     02  eibrcode         pic x(6).
  3495     02  eibfiller3       pic x(2).
  3496     02  eibds            pic x(8).
  3497     02  eibreqid         pic x(8).
  3498     02  eibrsrce         pic x(8).
  3499     02  eibsync          pic x(1).
  3500     02  eibfree          pic x(1).
  3501     02  eibrecv          pic x(1).
  3502     02  eibsend          pic x(1).
  3503     02  eibatt           pic x(1).
  3504     02  eibeoc           pic x(1).
  3505     02  eibfmh           pic x(1).
  3506     02  eibcompl         pic x(1).
  3507     02  eibsig           pic x(1).
  3508     02  eibconf          pic x(1).
  3509     02  eiberr           pic x(1).
  3510     02  eibrldbk         pic x(1).
  3511     02  eiberrcd         pic x(4).
  3512     02  eibsynrb         pic x(1).
  3513     02  eibnodat         pic x(1).
  3514     02  eibfiller5       pic x(2).
  3515     02  eibresp          pic s9(8) comp.
  3516     02  eibresp2         pic s9(8) comp.
  3517     02  dfheigdj         pic s9(4) comp.
  3518     02  dfheigdk         pic s9(4) comp.
  3519 01  DFHCOMMAREA.
  3520   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3521   05 LSTN-NAME                PIC X(8).
  3522   05 LSTN-SUBNAME             PIC X(8).
  3523   05 CLIENT-IN-DATA.
  3524      15  CLIENT-CAR           PIC X.
  3525      15  CLIENT-GRP           PIC X(6).
  3526      15  CLIENT-ST            PIC XX.
  3527      15  CLIENT-ACT           PIC X(10).
  3528      15  CLIENT-ID            PIC XXX.
  3529      15  FILLER               PIC X(14).
  3530   05 SOCKADDR-IN-PARM.
  3531     15 SIN-FAMILY             PIC 9(4) COMP.
  3532     15 SIN-PORT               PIC 9(4) COMP.
  3533     15 SIN-ADDRESS            PIC 9(8) COMP.
  3534     15 SIN-ZERO               PIC X(8).
  3535 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3536 0000-DFHEXIT SECTION.
  3537     MOVE '9#                    $   ' TO DFHEIV0.
  3538     MOVE 'SOCK00' TO DFHEIV1.
  3539     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3540*
  3541* when calling a C function the function returns its value
  3542* in the system variable return code.
  3543*
  3544 start-here.
  3545*
  3546* data with transaction
  3547*
  3548     display 'SOCK00:transaction data =', CLIENT-IN-DATA.
  3549     display 'SOCK00:socket number    =', GIVE-TAKE-SOCKET.
  3550     IF CLIENT-IN-DATA (1:4) = "RATE"
  3551        SET GET-RATES            TO TRUE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  63
* SOCK00.cbl
  3552     ELSE
  3553        IF CLIENT-IN-DATA (1:5) = "STATE"
  3554           SET GET-ACT-ACCTS     TO TRUE
  3555        END-IF
  3556     END-IF
  3557     evaluate client-id
  3558        when 'DCC'
  3559           MOVE X'05'            TO WS-COMP-CD
  3560           MOVE 'DCC'            TO WS-SEND-BUF (5:3)
  3561                                    WS-COMP-ID
  3562        when 'AHL'
  3563           MOVE X'06'            TO WS-COMP-CD
  3564           MOVE 'AHL'            TO WS-SEND-BUF (5:3)
  3565                                    WS-COMP-ID
  3566        when = 'VPP'
  3567           MOVE X'07'            TO WS-COMP-CD
  3568           MOVE 'VPP'            TO WS-SEND-BUF (5:3)
  3569                                    WS-COMP-ID
  3570        when 'FNL'
  3571           MOVE X'08'            TO WS-COMP-CD
  3572           MOVE 'FNL'            TO WS-SEND-BUF (5:3)
  3573                                    WS-COMP-ID
  3574        when other
  3575           MOVE X'04'            TO WS-COMP-CD
  3576           MOVE 'CID'            TO WS-SEND-BUF (5:3)
  3577                                    WS-COMP-ID
  3578     end-evaluate
  3579     move 'CSO'                  to ws-send-buf (1:3)
  3580     move +25                    to ws-send-msg-size
  3581* send data
  3582*
  3583     display 'SOCK00:sequence number  =', ws-seq-num.
  3584     display 'SOCK00:send buffer      =', ws-send-buf(1:25).
  3585     call "send" using by value GIVE-TAKE-SOCKET,
  3586         by reference ws-send-buf,
  3587         by value ws-send-msg-size,
  3588         by value ws-flags.
  3589     if return-code <= zero
  3590         display 'SOCK00:send error ',
  3591         go to socket-error.
  3592*
  3593* set up the receive buffer
  3594*
  3595     move low-values to ws-recv-buf.
  3596     set ws-recv-total to zero.
  3597     compute ws-recv-left = ws-recv-msg-size.
  3598*
  3599* receive data
  3600*
  3601     display 'SOCK00:About to recv '
  3602     call "recv" using by value GIVE-TAKE-SOCKET,
  3603         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3604         by value ws-recv-left,
  3605         by value ws-flags.
  3606*
  3607* test what was received and decide what we should do
  3608*
  3609     if return-code < zero
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  64
* SOCK00.cbl
  3610        display 'SOCK00:recv error ',
  3611        go to socket-error.
  3612     if return-code = zero
  3613        display 'SOCK00:client disconnected',
  3614        go to socket-error.
  3615*
  3616     display 'SOCK00:Good recv  '
  3617     display 'SOCK00:return code      = ', return-code
  3618     display 'SOCK00:receive buffer   = ', ws-recv-buf(1:50)
  3619     move +4096                  to ws-send-msg-size
  3620*    move +750                   to ws-send-msg-size
  3621     if get-rates
  3622        perform 0300-get-rates   thru 0300-exit
  3623     end-if
  3624     IF GET-ACT-ACCTS
  3625        PERFORM 0400-GET-ACT-ACCTS
  3626                                 THRU 0400-EXIT
  3627     END-IF
  3628     move ws-recv-buf (1:19)     to client-in-data
  3629     IF (CLIENT-CAR NOT = ZEROS)
  3630        AND (CLIENT-ST NOT = ZEROS)
  3631        PERFORM 0500-GET-ONE-ACCT
  3632                                 THRU 0500-EXIT
  3633     END-IF
  3634     MOVE ' '                    TO WS-BUILD-SW
  3635     MOVE CLIENT-ACT             TO WS-AM-ALT-ACCOUNT
  3636     MOVE LOW-VALUES             TO WS-AM-ALT-EXP-DT
  3637     PERFORM 0010-STARTBR-ERACCT THRU 0010-EXIT
  3638     IF NOT RESP-NORMAL
  3639        MOVE 'BAD STARTBR ON ERACCT  '
  3640                                 TO WS-SEND-BUF
  3641        MOVE WS-RESPONSE         TO WS-DIS-RESP
  3642        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  3643        GO TO SEND-BUFFER
  3644     END-IF
  3645     PERFORM 0020-READNEXT-ERACCT
  3646                                 THRU 0020-EXIT
  3647     IF (NOT RESP-NORMAL)
  3648        OR (AM-ACCOUNT NOT = CLIENT-ACT)
  3649        MOVE 'BAD READNEXT ON ERACCT '
  3650                                 TO WS-SEND-BUF
  3651        MOVE WS-RESPONSE         TO WS-DIS-RESP
  3652        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  3653        GO TO SEND-BUFFER
  3654     ELSE
  3655        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  3656     END-IF
  3657     PERFORM UNTIL
  3658        (TIME-TO-BUILD)
  3659        IF AM-ACCOUNT = CLIENT-ACT
  3660         IF (AM-STATE = CLIENT-ST)
  3661                 OR
  3662            (CLIENT-ST = 00)
  3663           IF AM-EXPIRATION-DT = HIGH-VALUES
  3664              SET TIME-TO-BUILD  TO TRUE
  3665           ELSE
  3666              MOVE ACCOUNT-MASTER
  3667                                 TO WS-SAVE-ERACCT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  65
* SOCK00.cbl
  3668              PERFORM 0020-READNEXT-ERACCT
  3669                                 THRU 0020-EXIT
  3670              IF NOT RESP-NORMAL
  3671                 MOVE WS-SAVE-ERACCT
  3672                                 TO ACCOUNT-MASTER
  3673                 SET TIME-TO-BUILD
  3674                                 TO TRUE
  3675              END-IF
  3676           END-IF
  3677         ELSE
  3678          PERFORM 0020-READNEXT-ERACCT
  3679                            THRU 0020-EXIT
  3680         END-IF
  3681        ELSE
  3682           MOVE WS-SAVE-ERACCT   TO ACCOUNT-MASTER
  3683           SET TIME-TO-BUILD     TO TRUE
  3684        END-IF
  3685     END-PERFORM
  3686     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  3687     .
  3688*
  3689* send data
  3690*
  3691 SEND-BUFFER.
  3692     display 'SOCK00:About to send      '
  3693     display 'SOCK00:sequence number  =', ws-seq-num.
  3694     display 'SOCK00:send buffer      =', ws-send-buf(1:300).
  3695     call "send" using by value GIVE-TAKE-SOCKET,
  3696         by reference ws-send-buf,
  3697         by value ws-send-msg-size,
  3698         by value ws-flags.
  3699     if return-code <= zero
  3700         display 'SOCK00:send error ',
  3701         go to socket-error.
  3702     GO TO SOCKET-FIN
  3703*
  3704* set up the receive buffer
  3705*
  3706     move low-values to ws-recv-buf.
  3707     set ws-recv-total to zero.
  3708     compute ws-recv-left = ws-recv-msg-size.
  3709*
  3710* receive data
  3711*
  3712 recv-1.
  3713     call "recv" using by value GIVE-TAKE-SOCKET,
  3714         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3715         by value ws-recv-left,
  3716         by value ws-flags.
  3717*
  3718* test what was received and decide what we should do
  3719*
  3720     if return-code < zero
  3721        display 'SOCK00:recv error ',
  3722        go to socket-error.
  3723     if return-code = zero
  3724        display 'SOCK00:client disconnected',
  3725        go to socket-error.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  66
* SOCK00.cbl
  3726*
  3727* have we received all the data yet?
  3728*
  3729     compute ws-recv-total = ws-recv-total + return-code.
  3730     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  3731*
  3732* not yet
  3733*
  3734     if ws-recv-left > 0 go to recv-1.
  3735*
  3736* received all the data
  3737*
  3738     display 'SOCK00:receive buffer   =', ws-recv-buf(1:50).
  3739*
  3740* make sure what we received was what we sent
  3741*
  3742*    if ws-recv-buf <> ws-send-buf
  3743*        display "SOCK00:data doesn't match",
  3744*        go to socket-error.
  3745*
  3746* end of pass
  3747*
  3748*loop-end.
  3749*    if ws-seq-num = 5 go to socket-error.
  3750*    go to loop-1.
  3751*
  3752* program end
  3753*
  3754 socket-error.
  3755     if ws-seq-num <> 0
  3756         display "SOCK00:did not complete".
  3757*
  3758* flush the send buffer and deallocate
  3759*
  3760*    display 'SOCK00:closing socket'.
  3761*    call "close" using by value GIVE-TAKE-SOCKET .
  3762*
  3763* finised return to cics
  3764*
  3765 socket-fin.
  3766*    display 'SOCK00:closing socket'.
  3767*    call "close" using by value GIVE-TAKE-SOCKET .
  3768     display 'SOCK00:done'.
  3769
  3770* exec cics return end-exec.
  3771*    MOVE '.(                    ''   #00003765' TO DFHEIV0
  3772     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3773     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3774     MOVE X'2020233030303033373635' TO DFHEIV0(25:11)
  3775     CALL 'kxdfhei1' USING DFHEIV0,
  3776           DFHEIV99,
  3777           DFHEIV99,
  3778           DFHEIV99,
  3779           DFHEIV99,
  3780           DFHEIV99,
  3781           DFHEIV99
  3782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3783
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  67
* SOCK00.cbl
  3784
  3785* goback.
  3786     MOVE '9%                    "   ' TO DFHEIV0
  3787     MOVE 'SOCK00' TO DFHEIV1
  3788     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3789     goback.
  3790 0010-STARTBR-ERACCT.
  3791
  3792* EXEC CICS STARTBR
  3793*         DATASET    ('ERACCT3')
  3794*         RIDFLD     (WS-AM-ALT-KEY)
  3795*         GENERIC
  3796*         GTEQ
  3797*         KEYLENGTH  (10)
  3798*         RESP       (WS-RESPONSE)
  3799*    END-EXEC
  3800     MOVE 'ERACCT3' TO DFHEIV1
  3801     MOVE 10
  3802       TO DFHEIV11
  3803     MOVE 0
  3804       TO DFHEIV12
  3805*    MOVE '&,   KG    G          &  N#00003768' TO DFHEIV0
  3806     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3807     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3808     MOVE X'204E233030303033373638' TO DFHEIV0(25:11)
  3809     CALL 'kxdfhei1' USING DFHEIV0,
  3810           DFHEIV1,
  3811           WS-AM-ALT-KEY,
  3812           DFHEIV11,
  3813           DFHEIV12,
  3814           DFHEIV99
  3815     MOVE EIBRESP  TO WS-RESPONSE
  3816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3817     .
  3818 0010-EXIT.
  3819     EXIT.
  3820 0020-READNEXT-ERACCT.
  3821
  3822* EXEC CICS READNEXT
  3823*         INTO    (ACCOUNT-MASTER)
  3824*         DATASET ('ERACCT3')
  3825*         RIDFLD  (WS-AM-ALT-KEY)
  3826*         RESP    (WS-RESPONSE)
  3827*    END-EXEC
  3828     MOVE LENGTH OF
  3829      ACCOUNT-MASTER
  3830       TO DFHEIV12
  3831     MOVE 'ERACCT3' TO DFHEIV1
  3832     MOVE 0
  3833       TO DFHEIV11
  3834*    MOVE '&.IL                  )  N#00003780' TO DFHEIV0
  3835     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3836     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3837     MOVE X'204E233030303033373830' TO DFHEIV0(25:11)
  3838     CALL 'kxdfhei1' USING DFHEIV0,
  3839           DFHEIV1,
  3840           ACCOUNT-MASTER,
  3841           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  68
* SOCK00.cbl
  3842           WS-AM-ALT-KEY,
  3843           DFHEIV99,
  3844           DFHEIV11,
  3845           DFHEIV99,
  3846           DFHEIV99
  3847     MOVE EIBRESP  TO WS-RESPONSE
  3848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3849     .
  3850 0020-EXIT.
  3851     EXIT.
  3852 0030-BUILD-BUFFER.
  3853     PERFORM 0100-BUILD-ERACCT-STUFF
  3854                                 THRU 0100-EXIT
  3855     MOVE SPACES                 TO WS-SEND-BUF
  3856     EVALUATE AM-STATUS
  3857        WHEN '1'
  3858           MOVE 'I'              TO WS-STATUS
  3859        WHEN '2'
  3860           MOVE 'T'              TO WS-STATUS
  3861        WHEN '3'
  3862           MOVE 'C'              TO WS-STATUS
  3863        WHEN '4'
  3864           MOVE 'I'              TO WS-STATUS
  3865        WHEN '5'
  3866           MOVE 'S'              TO WS-STATUS
  3867        WHEN '6'
  3868           MOVE 'D'              TO WS-STATUS
  3869        WHEN '7'
  3870           MOVE 'L'              TO WS-STATUS
  3871        WHEN '8'
  3872           MOVE 'R'              TO WS-STATUS
  3873        WHEN '9'
  3874           MOVE 'P'              TO WS-STATUS
  3875        WHEN OTHER
  3876           MOVE 'A'              TO WS-STATUS
  3877     END-EVALUATE
  3878     IF AM-REMIT-TO NOT NUMERIC
  3879        MOVE ZEROS         TO AM-REMIT-TO
  3880     END-IF
  3881     IF AM-REMIT-TO = ZEROS
  3882        MOVE 01        TO AM-REMIT-TO
  3883     END-IF
  3884     MOVE AM-AGT (AM-REMIT-TO) TO WS-FIN-RESP
  3885     MOVE SPACES                 TO WS-AM-CITY-STATE
  3886     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3887        DELIMITED BY '  ' INTO WS-AM-CITY-STATE
  3888     END-STRING
  3889     IF NOT GET-ACT-ACCTS
  3890* this is when a single account is selected
  3891       STRING
  3892        AM-ACCOUNT      ';'
  3893        WS-LONG-ACCT-NAME    ';'
  3894        WS-CONTR-NAME   ';'
  3895        AM-ADDRS        ';'
  3896        WS-AM-CITY-STATE ';'
  3897        AM-ZIP          ';'
  3898        AM-GPCD         ';'
  3899        WS-EFF-DATE     ';'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  69
* SOCK00.cbl
  3900        WS-EXP-DATE     ';'
  3901        WS-POLICY-NO    ';'
  3902        WS-SL-COMM      ';'
  3903        WS-JL-COMM      ';'
  3904        WS-SAH-COMM     ';'
  3905        WS-JAH-COMM     ';'
  3906        WS-CID-NO       ';'
  3907        AM-STATE        ';'
  3908        WS-GA-NUM       ';'
  3909        WS-GA-PRIMARY-CONTACT ';'
  3910        WS-GA-NAME      ';'
  3911        WS-GA-MAIL-NAME ';'
  3912        WS-GA-ADDR1     ';'
  3913        WS-GA-ADDR2     ';'
  3914        WS-GA-ADDR3     ';'
  3915        WS-GA-ZIP       ';'
  3916        WS-GA-PHONE     ';'
  3917        AM-CONTROL-NAME ';'
  3918        WS-ORIG-EFF-DT  ';'
  3919        AM-COMMENT-LINE (1) ';'
  3920        AM-COMMENT-LINE (2) ';'
  3921        AM-COMMENT-LINE (3) ';'
  3922        AM-COMMENT-LINE (4) ';'
  3923        AM-COMMENT-LINE (5) ';'
  3924        AM-TEL-NO       ';'
  3925        AM-REPORT-CODE-1    ';'
  3926        AM-REPORT-CODE-2    ';'
  3927        WS-STATUS           ';'
  3928        AM-REPORT-CODE-3    ';'
  3929        AM-USER-SELECT-2    ';'
  3930        AM-CARRIER          ';'
  3931        WS-FIN-RESP         ';'
  3932        AM-USER-SELECT-3    ';'
  3933        WS-SHORT-ACCT-NAME  ';'
  3934           DELIMITED BY SIZE INTO WS-SEND-BUF
  3935       END-STRING
  3936     ELSE
  3937       STRING
  3938        AM-ACCOUNT      ';'
  3939        WS-LONG-ACCT-NAME    ';'
  3940        WS-CONTR-NAME   ';'
  3941        AM-ADDRS        ';'
  3942        WS-AM-CITY-STATE ';'
  3943        AM-ZIP          ';'
  3944        AM-GPCD         ';'
  3945        WS-EFF-DATE     ';'
  3946        WS-EXP-DATE     ';'
  3947        WS-POLICY-NO    ';'
  3948        WS-SL-COMM      ';'
  3949        WS-JL-COMM      ';'
  3950        WS-SAH-COMM     ';'
  3951        WS-JAH-COMM     ';'
  3952        WS-CID-NO       ';'
  3953        AM-STATE        ';'
  3954        WS-GA-NUM       ';'
  3955        WS-GA-PRIMARY-CONTACT ';'
  3956        WS-GA-NAME      ';'
  3957        WS-GA-MAIL-NAME ';'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  70
* SOCK00.cbl
  3958        WS-GA-ADDR1     ';'
  3959        WS-GA-ADDR2     ';'
  3960        WS-GA-ADDR3     ';'
  3961        WS-GA-ZIP       ';'
  3962        WS-GA-PHONE     ';'
  3963        AM-COMMENT-LINE (1) ';'
  3964        AM-COMMENT-LINE (2) ';'
  3965        AM-COMMENT-LINE (3) ';'
  3966        AM-COMMENT-LINE (4) ';'
  3967        AM-COMMENT-LINE (5) ';'
  3968        AM-CONTROL-NAME     ';'
  3969        WS-ORIG-EFF-DT      ';'
  3970        AM-TEL-NO           ';'
  3971        AM-REPORT-CODE-1    ';'
  3972        AM-REPORT-CODE-2    ';'
  3973        WS-STATUS           ';'
  3974        AM-REPORT-CODE-3    ';'
  3975        AM-USER-SELECT-2    ';'
  3976        AM-CARRIER          ';'
  3977        WS-FIN-RESP         ';'
  3978        AM-USER-SELECT-3    ';'
  3979        WS-SHORT-ACCT-NAME  ';'
  3980           DELIMITED BY SIZE INTO WS-SEND-BUF
  3981       END-STRING
  3982     END-IF
  3983     .
  3984 0030-EXIT.
  3985     EXIT.
  3986 0100-BUILD-ERACCT-STUFF.
  3987     MOVE AM-EFFECTIVE-DT        TO DC-BIN-DATE-1
  3988     MOVE ' '                    TO DC-OPTION-CODE
  3989     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  3990     IF NO-CONVERSION-ERROR
  3991        MOVE DC-GREG-DATE-A-EDIT TO WS-EFF-DATE
  3992     ELSE
  3993        MOVE '00/00/0000'        TO WS-EFF-DATE
  3994     END-IF
  3995     IF AM-EXPIRATION-DT = HIGH-VALUES
  3996        MOVE '99/99/9999'        TO WS-EXP-DATE
  3997     ELSE
  3998        MOVE AM-EXPIRATION-DT    TO DC-BIN-DATE-1
  3999        MOVE ' '                 TO DC-OPTION-CODE
  4000        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4001        IF NO-CONVERSION-ERROR
  4002           MOVE DC-GREG-DATE-A-EDIT
  4003                                 TO WS-EXP-DATE
  4004        ELSE
  4005           MOVE '00/00/0000'     TO WS-EXP-DATE
  4006        END-IF
  4007     END-IF
  4008     MOVE WS-BIN-ORIG-EFF-DT     TO DC-BIN-DATE-1
  4009     MOVE ' '                    TO DC-OPTION-CODE
  4010     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4011     IF NO-CONVERSION-ERROR
  4012        MOVE DC-GREG-DATE-A-EDIT TO WS-ORIG-EFF-DT
  4013     ELSE
  4014        MOVE '00/00/0000'        TO WS-ORIG-EFF-DT
  4015     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  71
* SOCK00.cbl
  4016     MOVE AM-COMMENT-LINE (2)    TO WS-POLICY-NO
  4017     PERFORM VARYING S1 FROM +7 BY +1 UNTIL
  4018        (S1 > +48)
  4019        OR (AM-COMMENT-LINE (2) (S1:3) = 'CID')
  4020     END-PERFORM
  4021     IF S1 > +48
  4022        MOVE SPACES              TO WS-CID-NO
  4023     ELSE
  4024        MOVE AM-COMMENT-LINE (2) (S1:8)
  4025                                 TO WS-CID-NO
  4026     END-IF
  4027     MOVE AM-NAME                TO WS-SHORT-ACCT-NAME
  4028                                    WS-LONG-ACCT-NAME
  4029     MOVE AM-PERSON              TO WS-CONTR-NAME
  4030*    IF AM-REPORT-CODE-3 = 'RLIC'
  4031        MOVE AM-CONTROL-PRIMARY  TO WS-NT-KEY
  4032        MOVE '3'                 TO WS-NT-REC-TYPE
  4033        MOVE +1                  TO WS-NT-SEQ-NO
  4034
  4035* EXEC CICS READ
  4036*          DATASET    ('ERACNT')
  4037*          RIDFLD     (WS-NT-KEY)
  4038*          INTO       (NOTE-FILE)
  4039*          RESP       (WS-RESPONSE)
  4040*       END-EXEC
  4041     MOVE LENGTH OF
  4042      NOTE-FILE
  4043       TO DFHEIV11
  4044     MOVE 'ERACNT' TO DFHEIV1
  4045*    MOVE '&"IL       E          (  N#00003971' TO DFHEIV0
  4046     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4047     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4048     MOVE X'204E233030303033393731' TO DFHEIV0(25:11)
  4049     CALL 'kxdfhei1' USING DFHEIV0,
  4050           DFHEIV1,
  4051           NOTE-FILE,
  4052           DFHEIV11,
  4053           WS-NT-KEY,
  4054           DFHEIV99,
  4055           DFHEIV99,
  4056           DFHEIV99
  4057     MOVE EIBRESP  TO WS-RESPONSE
  4058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4059        IF RESP-NORMAL
  4060           IF NT-SHIPPING-LINE NOT = SPACES AND LOW-VALUES
  4061              MOVE NT-SHIPPING-LINE TO WS-LONG-ACCT-NAME
  4062           END-IF
  4063        END-IF
  4064        MOVE AM-CONTROL-PRIMARY  TO WS-NT-KEY
  4065        MOVE '3'                 TO WS-NT-REC-TYPE
  4066        MOVE +2                  TO WS-NT-SEQ-NO
  4067
  4068* EXEC CICS READ
  4069*          DATASET    ('ERACNT')
  4070*          RIDFLD     (WS-NT-KEY)
  4071*          INTO       (NOTE-FILE)
  4072*          RESP       (WS-RESPONSE)
  4073*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  72
* SOCK00.cbl
  4074     MOVE LENGTH OF
  4075      NOTE-FILE
  4076       TO DFHEIV11
  4077     MOVE 'ERACNT' TO DFHEIV1
  4078*    MOVE '&"IL       E          (  N#00003985' TO DFHEIV0
  4079     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4081     MOVE X'204E233030303033393835' TO DFHEIV0(25:11)
  4082     CALL 'kxdfhei1' USING DFHEIV0,
  4083           DFHEIV1,
  4084           NOTE-FILE,
  4085           DFHEIV11,
  4086           WS-NT-KEY,
  4087           DFHEIV99,
  4088           DFHEIV99,
  4089           DFHEIV99
  4090     MOVE EIBRESP  TO WS-RESPONSE
  4091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4092        IF RESP-NORMAL
  4093           IF NT-SHIPPING-LINE NOT = SPACES AND LOW-VALUES
  4094              MOVE NT-SHIPPING-LINE TO WS-CONTR-NAME
  4095           END-IF
  4096        END-IF
  4097*    END-IF
  4098     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4099        (S1 > +10)
  4100        OR (AM-COM-TYP (S1) = 'D' OR 'C')
  4101     END-PERFORM
  4102     IF S1 > +10
  4103        CONTINUE
  4104     ELSE
  4105        PERFORM 0150-BUILD-DW-COMM
  4106                                 THRU 0150-EXIT
  4107     END-IF
  4108     MOVE SPACES                 TO WS-GA-DATA
  4109     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4110        (S1 > +10)
  4111        OR (AM-COM-TYP (S1) = 'O' OR 'P' OR 'K' OR 'S')
  4112     END-PERFORM
  4113     IF S1 > +10
  4114        MOVE ZEROS               TO WS-GA-NUM
  4115     ELSE
  4116        MOVE AM-AGT (S1)         TO WS-GA-NUM
  4117     END-IF
  4118     IF WS-GA-NUM NOT = ZEROS
  4119        PERFORM 0200-GET-ERCOMP  THRU 0200-EXIT
  4120     END-IF
  4121     .
  4122 0100-EXIT.
  4123     EXIT.
  4124 0150-BUILD-DW-COMM.
  4125     MOVE ZEROS                  TO WS-SL-COMM
  4126                                    WS-JL-COMM
  4127                                    WS-SAH-COMM
  4128                                    WS-JAH-COMM
  4129                                    WS-WORK-SAH-COMM
  4130                                    WS-WORK-JAH-COMM
  4131     IF (AM-L-COM (S1) NOT NUMERIC)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  73
* SOCK00.cbl
  4132        OR (AM-L-COMA (S1) (3:1) = 'L' OR 'M')
  4133        CONTINUE
  4134     ELSE
  4135        MOVE AM-L-COM (S1)       TO WS-SL-COMM
  4136     END-IF
  4137     IF (AM-J-COM (S1) NOT NUMERIC)
  4138        OR (AM-J-COMA (S1) (3:1) = 'L' OR 'M')
  4139        CONTINUE
  4140     ELSE
  4141        MOVE AM-J-COM (S1)       TO WS-JL-COMM
  4142     END-IF
  4143     IF (AM-A-COM (S1) NOT NUMERIC)
  4144        OR (AM-A-COMA (S1) (3:1) = 'L' OR 'M')
  4145        PERFORM 0160-ERCTBL-STARTBR
  4146                                 THRU 0160-EXIT
  4147        IF RESP-NORMAL
  4148           PERFORM 0165-ERCTBL-READNEXT
  4149                                 THRU 0165-EXIT
  4150           UNTIL
  4151           ((WS-WORK-SAH-COMM NOT = ZEROS)
  4152            AND (WS-WORK-JAH-COMM NOT = ZEROS))
  4153                       OR
  4154            END-OF-ERCTBL
  4155            MOVE WS-WORK-JAH-COMM TO WS-JAH-COMM
  4156            MOVE WS-WORK-SAH-COMM TO WS-SAH-COMM
  4157        END-IF
  4158     ELSE
  4159        MOVE AM-A-COM (S1)       TO WS-SAH-COMM
  4160                                    WS-JAH-COMM
  4161     END-IF
  4162     .
  4163 0150-EXIT.
  4164     EXIT.
  4165 0160-ERCTBL-STARTBR.
  4166     MOVE AM-COMPANY-CD          TO WS-CT-COMPANY-CD
  4167     MOVE AM-A-COMA (S1)         TO WS-CT-TABLE
  4168     MOVE 'A'                    TO WS-CT-BEN-TYPE
  4169     MOVE LOW-VALUES             TO WS-CT-BEN-CODE
  4170     MOVE WS-CT-KEY              TO WS-CT-KEY-SAVE
  4171
  4172* EXEC CICS STARTBR
  4173*         DATASET    ('ERCTBL')
  4174*         RIDFLD     (WS-CT-KEY)
  4175*         GTEQ
  4176*         RESP       (WS-RESPONSE)
  4177*    END-EXEC
  4178     MOVE 'ERCTBL' TO DFHEIV1
  4179     MOVE 0
  4180       TO DFHEIV11
  4181*    MOVE '&,         G          &  N#00004070' TO DFHEIV0
  4182     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4183     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4184     MOVE X'204E233030303034303730' TO DFHEIV0(25:11)
  4185     CALL 'kxdfhei1' USING DFHEIV0,
  4186           DFHEIV1,
  4187           WS-CT-KEY,
  4188           DFHEIV99,
  4189           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  74
* SOCK00.cbl
  4190           DFHEIV99
  4191     MOVE EIBRESP  TO WS-RESPONSE
  4192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4193     .
  4194 0160-EXIT.
  4195     EXIT.
  4196 0165-ERCTBL-READNEXT.
  4197
  4198* EXEC CICS READNEXT
  4199*         INTO    (COMM-TABLE-RECORD)
  4200*         DATASET ('ERCTBL')
  4201*         RIDFLD  (WS-CT-KEY)
  4202*         RESP    (WS-RESPONSE)
  4203*    END-EXEC
  4204     MOVE LENGTH OF
  4205      COMM-TABLE-RECORD
  4206       TO DFHEIV12
  4207     MOVE 'ERCTBL' TO DFHEIV1
  4208     MOVE 0
  4209       TO DFHEIV11
  4210*    MOVE '&.IL                  )  N#00004080' TO DFHEIV0
  4211     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4212     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4213     MOVE X'204E233030303034303830' TO DFHEIV0(25:11)
  4214     CALL 'kxdfhei1' USING DFHEIV0,
  4215           DFHEIV1,
  4216           COMM-TABLE-RECORD,
  4217           DFHEIV12,
  4218           WS-CT-KEY,
  4219           DFHEIV99,
  4220           DFHEIV11,
  4221           DFHEIV99,
  4222           DFHEIV99
  4223     MOVE EIBRESP  TO WS-RESPONSE
  4224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4225     IF (RESP-NORMAL)
  4226        AND (WS-CT-KEY (1:5) = WS-CT-KEY-SAVE (1:5))
  4227        PERFORM 0170-PROCESS-BEN-CODE
  4228                                 THRU 0170-EXIT
  4229     ELSE
  4230        SET END-OF-ERCTBL        TO TRUE
  4231     END-IF
  4232     .
  4233 0165-EXIT.
  4234     EXIT.
  4235 0170-PROCESS-BEN-CODE.
  4236     MOVE SPACES                 TO WS-CF-KEY
  4237     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  4238     MOVE '5'                    TO WS-CF-RECORD-TYPE
  4239     MOVE CT-BEN-CODE            TO WS-CF-ACCESS (3:2)
  4240     MOVE +0                     TO WS-CF-SEQ-NO
  4241     MOVE WS-CF-KEY              TO WS-CF-KEY-SAVE
  4242
  4243* EXEC CICS READ
  4244*         DATASET    ('ELCNTL')
  4245*         RIDFLD     (WS-CF-KEY)
  4246*         INTO       (CONTROL-FILE)
  4247*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  75
* SOCK00.cbl
  4248*         RESP       (WS-RESPONSE)
  4249*    END-EXEC
  4250     MOVE LENGTH OF
  4251      CONTROL-FILE
  4252       TO DFHEIV11
  4253     MOVE 'ELCNTL' TO DFHEIV1
  4254*    MOVE '&"IL       G          (  N#00004103' TO DFHEIV0
  4255     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4256     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4257     MOVE X'204E233030303034313033' TO DFHEIV0(25:11)
  4258     CALL 'kxdfhei1' USING DFHEIV0,
  4259           DFHEIV1,
  4260           CONTROL-FILE,
  4261           DFHEIV11,
  4262           WS-CF-KEY,
  4263           DFHEIV99,
  4264           DFHEIV99,
  4265           DFHEIV99
  4266     MOVE EIBRESP  TO WS-RESPONSE
  4267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4268     IF NOT RESP-NORMAL
  4269        MOVE WS-RESPONSE         TO WS-DISP-RESP
  4270        DISPLAY ' ERROR - ELCNTL - READ ' WS-DISP-RESP
  4271        GO TO 0170-EXIT
  4272     END-IF
  4273     IF WS-CF-KEY (1:4) = WS-CF-KEY-SAVE (1:4)
  4274        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  4275           (S2 > +8)
  4276           OR (CT-BEN-CODE = CF-BENEFIT-CODE (S2))
  4277        END-PERFORM
  4278        IF CT-BEN-CODE = CF-BENEFIT-CODE (S2)
  4279           IF CF-JOINT-INDICATOR (S2) = 'J'
  4280              IF WS-WORK-JAH-COMM = ZEROS
  4281                 MOVE CT-RT (1)  TO WS-WORK-JAH-COMM
  4282              END-IF
  4283           ELSE
  4284              IF WS-WORK-SAH-COMM = ZEROS
  4285                 MOVE CT-RT (1)  TO WS-WORK-SAH-COMM
  4286              END-IF
  4287           END-IF
  4288        END-IF
  4289     END-IF
  4290     .
  4291 0170-EXIT.
  4292     EXIT.
  4293 0200-GET-ERCOMP.
  4294     MOVE LOW-VALUES             TO WS-CO-KEY
  4295     MOVE AM-COMPANY-CD          TO WS-CO-COMPANY-CD
  4296     MOVE AM-CARRIER             TO WS-CO-CARRIER
  4297     MOVE AM-GROUPING            TO WS-CO-GROUP
  4298     MOVE WS-GA-NUM              TO WS-CO-FIN-RESP
  4299     MOVE LOW-VALUES             TO WS-CO-ACCOUNT
  4300     MOVE 'G'                    TO WS-CO-TYPE
  4301
  4302* EXEC CICS READ
  4303*         INTO    (COMPENSATION-MASTER)
  4304*         DATASET ('ERCOMP')
  4305*         RIDFLD  (WS-CO-KEY)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  76
* SOCK00.cbl
  4306*         RESP    (WS-RESPONSE)
  4307*    END-EXEC
  4308     MOVE LENGTH OF
  4309      COMPENSATION-MASTER
  4310       TO DFHEIV11
  4311     MOVE 'ERCOMP' TO DFHEIV1
  4312*    MOVE '&"IL       E          (  N#00004143' TO DFHEIV0
  4313     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4315     MOVE X'204E233030303034313433' TO DFHEIV0(25:11)
  4316     CALL 'kxdfhei1' USING DFHEIV0,
  4317           DFHEIV1,
  4318           COMPENSATION-MASTER,
  4319           DFHEIV11,
  4320           WS-CO-KEY,
  4321           DFHEIV99,
  4322           DFHEIV99,
  4323           DFHEIV99
  4324     MOVE EIBRESP  TO WS-RESPONSE
  4325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4326     IF RESP-NORMAL
  4327        MOVE CO-CONTROL-NAME     TO WS-GA-PRIMARY-CONTACT
  4328        MOVE CO-ACCT-NAME        TO WS-GA-NAME
  4329        MOVE CO-MAIL-NAME        TO WS-GA-MAIL-NAME
  4330        MOVE CO-ADDR-1           TO WS-GA-ADDR1
  4331        MOVE CO-ADDR-2           TO WS-GA-ADDR2
  4332*       MOVE CO-ADDR-3           TO WS-GA-ADDR3
  4333        MOVE SPACES              TO WS-GA-ADDR3
  4334        STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  4335           DELIMITED BY '  ' INTO WS-GA-ADDR3
  4336        END-STRING
  4337        MOVE CO-ZIP              TO WS-GA-ZIP
  4338        MOVE CO-TELEPHONE        TO WS-GA-PHONE
  4339     ELSE
  4340        MOVE SPACES              TO WS-GA-DATA
  4341        MOVE 'GA NOT FOUND '     TO WS-GA-NAME
  4342     END-IF
  4343     .
  4344 0200-EXIT.
  4345     EXIT.
  4346 0300-get-rates.
  4347     move +30                    to ws-send-msg-size
  4348     move ws-recv-buf (1:31)     to ws-get-rate-data
  4349     if rate-apr not numeric
  4350        move zeros               to rate-apr
  4351     end-if
  4352     move rate-apr               to ws-work-apr
  4353     if rate-ben-amt not numeric
  4354        move zeros               to rate-ben-amt
  4355     end-if
  4356     move rate-ben-amt           to ws-work-ben
  4357     if rate-term not numeric
  4358        move zeros               to rate-term
  4359     end-if
  4360     move rate-term              to ws-work-term
  4361     move rate-eff-date (7:4)    to ws-work-date (1:4)
  4362     move rate-eff-date (1:2)    to ws-work-date (5:2)
  4363     move rate-eff-date (4:2)    to ws-work-date (7:2)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  77
* SOCK00.cbl
  4364     move ws-work-date-num       to dc-greg-date-cymd
  4365     move 'L'                    to dc-option-code
  4366     perform 9700-date-link      thru 9700-exit
  4367     if no-conversion-error
  4368        move dc-bin-date-1       to ws-bin-eff-dt
  4369     else
  4370        move 'bad eff dt convert ' to ws-send-buf
  4371        go to send-rate-buf
  4372     end-if
  4373     move +1                     to dc-elapsed-months
  4374     move +0                     to dc-elapsed-days
  4375     move '6'                    to dc-option-code
  4376     perform 9700-date-link      thru 9700-exit
  4377     if no-conversion-error
  4378        move dc-bin-date-2       to ws-bin-1st-pay-dt
  4379     else
  4380        move 'bad 1st dt convert ' to ws-send-buf
  4381        go to send-rate-buf
  4382     end-if
  4383*    move spaces                 to calculation-pass-area
  4384     move zeros                  to cp-r-max-mon-ben
  4385                                    cp-r-max-tot-ben
  4386                                    cp-class-code
  4387                                    cp-deviation-code
  4388                                    cp-rate-dev-pct
  4389                                    cp-original-premium
  4390                                    cp-critical-months
  4391                                    cp-term-or-ext-days
  4392     move rate-state             to cp-state
  4393                                    cp-state-std-abbrv
  4394     move rate-lf-ah             to cp-benefit-type
  4395     move rate-ben-code          to cp-benefit-cd
  4396     move ws-ben-num             to cp-original-benefit
  4397                                    cp-rating-benefit-amt
  4398     move 40                     to cp-issue-age
  4399     move WS-COMP-ID             to cp-company-id
  4400     move WS-COMP-CD             to cp-company-cd
  4401     move ws-apr-num             to cp-loan-apr
  4402     move ws-term-num            to cp-original-term
  4403                                    cp-loan-term
  4404                                    cp-remaining-term
  4405     move 'L'                    to cp-life-override-code
  4406     move 'A'                    to cp-ah-override-code
  4407     move '3'                    to cp-process-type
  4408     move rate-earn-meth         to cp-earning-method
  4409                                    cp-rating-method
  4410     move 'R'                    to cp-rate-file
  4411     move ws-bin-eff-dt          to cp-cert-eff-dt
  4412     move ws-bin-1st-pay-dt      to cp-first-pay-date
  4413     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4414     if not no-cp-error
  4415        move cp-return-code      to ws-send-buf
  4416     else
  4417        move cp-calc-premium     to ws-disp-amt
  4418        move cp-premium-rate     to ws-disp-rate
  4419        string ws-disp-amt ';' ws-disp-rate delimited
  4420           by size into ws-send-buf
  4421        end-string
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  78
* SOCK00.cbl
  4422     end-if
  4423     .
  4424 SEND-RATE-BUF.
  4425     display 'SOCK00:About to send      '
  4426     display 'SOCK00:sequence number  =', ws-seq-num.
  4427     display 'SOCK00:send buffer      =', ws-send-buf(1:30).
  4428     call "send" using by value GIVE-TAKE-SOCKET,
  4429         by reference ws-send-buf,
  4430         by value ws-send-msg-size,
  4431         by value ws-flags.
  4432     if return-code <= zero
  4433         display 'SOCK00:send error ',
  4434         go to socket-error.
  4435     GO TO SOCKET-FIN
  4436     .
  4437 0300-exit.
  4438     exit.
  4439 0400-GET-ACT-ACCTS.
  4440     MOVE WS-RECV-BUF (1:2)      TO CLIENT-ST
  4441     MOVE ' '                    TO WS-BUILD-SW
  4442     MOVE LOW-VALUES             TO WS-AM-KEY
  4443     MOVE WS-COMP-CD             TO WS-AM-COMPANY-CD
  4444     PERFORM 0410-STARTBR-ERACCT THRU 0410-EXIT
  4445     IF NOT RESP-NORMAL
  4446        MOVE 'BAD STARTBR ON ERACCT  '
  4447                                 TO WS-SEND-BUF
  4448        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4449        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4450        GO TO SEND-BUFFER
  4451     END-IF
  4452     PERFORM 0420-READNEXT-ERACCT
  4453                                 THRU 0420-EXIT
  4454     IF NOT RESP-NORMAL
  4455        MOVE 'BAD READNEXT ON ERACCT '
  4456                                 TO WS-SEND-BUF
  4457        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4458        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4459        GO TO SEND-BUFFER
  4460     ELSE
  4461        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  4462        MOVE AM-ACCOUNT          TO WS-SAVE-ACCOUNT
  4463     END-IF
  4464     PERFORM UNTIL END-OF-ERACCT
  4465        IF NOT (RESP-NORMAL)
  4466           OR (AM-COMPANY-CD > WS-COMP-CD)
  4467           SET END-OF-ERACCT     TO TRUE
  4468        ELSE
  4469           IF AM-ACCOUNT NOT = WS-SAVE-ACCOUNT
  4470              MOVE AM-EFFECTIVE-DT TO WS-BIN-ORIG-EFF-DT
  4471           END-IF
  4472           IF (AM-STATE = CLIENT-ST)
  4473              AND (AM-EXPIRATION-DT = HIGH-VALUES)
  4474*             AND (AM-STATUS = '0')
  4475              PERFORM 0030-BUILD-BUFFER
  4476                                 THRU 0030-EXIT
  4477              PERFORM 0430-SEND-BUFFER
  4478                                 THRU 0430-EXIT
  4479           END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  79
* SOCK00.cbl
  4480           PERFORM 0420-READNEXT-ERACCT
  4481                                 THRU 0420-EXIT
  4482        END-IF
  4483     END-PERFORM
  4484     GO TO SOCKET-FIN
  4485     .
  4486 0400-EXIT.
  4487     EXIT.
  4488 0410-STARTBR-ERACCT.
  4489
  4490* EXEC CICS STARTBR
  4491*         DATASET    ('ERACCT')
  4492*         RIDFLD     (WS-AM-KEY)
  4493*         GTEQ
  4494*         RESP       (WS-RESPONSE)
  4495*    END-EXEC
  4496     MOVE 'ERACCT' TO DFHEIV1
  4497     MOVE 0
  4498       TO DFHEIV11
  4499*    MOVE '&,         G          &  N#00004312' TO DFHEIV0
  4500     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4501     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4502     MOVE X'204E233030303034333132' TO DFHEIV0(25:11)
  4503     CALL 'kxdfhei1' USING DFHEIV0,
  4504           DFHEIV1,
  4505           WS-AM-KEY,
  4506           DFHEIV99,
  4507           DFHEIV11,
  4508           DFHEIV99
  4509     MOVE EIBRESP  TO WS-RESPONSE
  4510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4511     .
  4512 0410-EXIT.
  4513     EXIT.
  4514 0420-READNEXT-ERACCT.
  4515
  4516* EXEC CICS READNEXT
  4517*         INTO    (ACCOUNT-MASTER)
  4518*         DATASET ('ERACCT')
  4519*         RIDFLD  (WS-AM-KEY)
  4520*         RESP    (WS-RESPONSE)
  4521*    END-EXEC
  4522     MOVE LENGTH OF
  4523      ACCOUNT-MASTER
  4524       TO DFHEIV12
  4525     MOVE 'ERACCT' TO DFHEIV1
  4526     MOVE 0
  4527       TO DFHEIV11
  4528*    MOVE '&.IL                  )  N#00004322' TO DFHEIV0
  4529     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4530     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4531     MOVE X'204E233030303034333232' TO DFHEIV0(25:11)
  4532     CALL 'kxdfhei1' USING DFHEIV0,
  4533           DFHEIV1,
  4534           ACCOUNT-MASTER,
  4535           DFHEIV12,
  4536           WS-AM-KEY,
  4537           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  80
* SOCK00.cbl
  4538           DFHEIV11,
  4539           DFHEIV99,
  4540           DFHEIV99
  4541     MOVE EIBRESP  TO WS-RESPONSE
  4542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4543     .
  4544 0420-EXIT.
  4545     EXIT.
  4546 0430-SEND-BUFFER.
  4547     display 'SOCK00:About to send      '
  4548     display 'SOCK00:sequence number  =', ws-seq-num.
  4549     display 'SOCK00:send buffer      =', ws-send-buf(1:300).
  4550     call "send" using by value GIVE-TAKE-SOCKET,
  4551         by reference ws-send-buf,
  4552         by value ws-send-msg-size,
  4553         by value ws-flags.
  4554     if return-code <= zero
  4555         display 'SOCK00:send error ',
  4556         go to socket-error.
  4557     .
  4558 0430-EXIT.
  4559     EXIT.
  4560 0500-GET-ONE-ACCT.
  4561     MOVE WS-COMP-CD             TO WS-AM-COMPANY-CD
  4562     MOVE CLIENT-CAR             TO WS-AM-CARRIER
  4563     MOVE CLIENT-GRP             TO WS-AM-GROUP
  4564     MOVE CLIENT-ST              TO WS-AM-STATE
  4565     MOVE CLIENT-ACT             TO WS-AM-ACCOUNT
  4566     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  4567     MOVE '5'                    TO DC-OPTION-CODE
  4568     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4569     MOVE DC-BIN-DATE-1          TO WS-AM-EXP-DT
  4570     MOVE LOW-VALUES             TO WS-AM-EXP-DT
  4571     MOVE ' '                    TO WS-BUILD-SW
  4572    PERFORM 0410-STARTBR-ERACCT THRU 0410-EXIT
  4573     IF NOT RESP-NORMAL
  4574        MOVE 'BAD STARTBR ON ERACCT  '
  4575                                 TO WS-SEND-BUF
  4576        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4577        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4578        GO TO SEND-BUFFER
  4579     END-IF
  4580     PERFORM 0420-READNEXT-ERACCT
  4581                                 THRU 0420-EXIT
  4582     IF NOT RESP-NORMAL
  4583        MOVE 'BAD READNEXT ON ERACCT '
  4584                                 TO WS-SEND-BUF
  4585        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4586        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4587        GO TO SEND-BUFFER
  4588     ELSE
  4589        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  4590        MOVE AM-ACCOUNT          TO WS-SAVE-ACCOUNT
  4591     END-IF
  4592     PERFORM UNTIL
  4593        (TIME-TO-BUILD)
  4594        IF AM-ACCOUNT = CLIENT-ACT
  4595           IF AM-EXPIRATION-DT = HIGH-VALUES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  81
* SOCK00.cbl
  4596              SET TIME-TO-BUILD  TO TRUE
  4597           ELSE
  4598              MOVE ACCOUNT-MASTER
  4599                                 TO WS-SAVE-ERACCT
  4600              PERFORM 0420-READNEXT-ERACCT
  4601                                 THRU 0420-EXIT
  4602              IF NOT RESP-NORMAL
  4603                 MOVE WS-SAVE-ERACCT
  4604                                 TO ACCOUNT-MASTER
  4605                 SET TIME-TO-BUILD
  4606                                 TO TRUE
  4607              END-IF
  4608           END-IF
  4609        ELSE
  4610           MOVE WS-SAVE-ERACCT   TO ACCOUNT-MASTER
  4611           SET TIME-TO-BUILD     TO TRUE
  4612        END-IF
  4613     END-PERFORM
  4614     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4615     PERFORM 0430-SEND-BUFFER    THRU 0430-EXIT
  4616     GO TO SOCKET-FIN
  4617     .
  4618 0500-EXIT.
  4619     EXIT.
  4620 7000-GET-RATE.
  4621
  4622* EXEC CICS LINK
  4623*       PROGRAM ('ELRATE')
  4624*       COMMAREA (CALCULATION-PASS-AREA)
  4625*       LENGTH   (CP-COMM-LENGTH)
  4626*    END-EXEC
  4627     MOVE 'ELRATE' TO DFHEIV1
  4628*    MOVE '."C                   (   #00004406' TO DFHEIV0
  4629     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4630     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4631     MOVE X'2020233030303034343036' TO DFHEIV0(25:11)
  4632     CALL 'kxdfhei1' USING DFHEIV0,
  4633           DFHEIV1,
  4634           CALCULATION-PASS-AREA,
  4635           CP-COMM-LENGTH,
  4636           DFHEIV99,
  4637           DFHEIV99,
  4638           DFHEIV99,
  4639           DFHEIV99
  4640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4641     .
  4642 7000-EXIT.
  4643     EXIT.
  4644 9700-DATE-LINK.
  4645
  4646* EXEC CICS LINK
  4647*         PROGRAM  ('ELDATCV')
  4648*         COMMAREA (DATE-CONVERSION-DATA)
  4649*         LENGTH   (DC-COMM-LENGTH)
  4650*    END-EXEC.
  4651     MOVE 'ELDATCV' TO DFHEIV1
  4652*    MOVE '."C                   (   #00004415' TO DFHEIV0
  4653     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:45 Page  82
* SOCK00.cbl
  4654     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4655     MOVE X'2020233030303034343135' TO DFHEIV0(25:11)
  4656     CALL 'kxdfhei1' USING DFHEIV0,
  4657           DFHEIV1,
  4658           DATE-CONVERSION-DATA,
  4659           DC-COMM-LENGTH,
  4660           DFHEIV99,
  4661           DFHEIV99,
  4662           DFHEIV99,
  4663           DFHEIV99
  4664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4665
  4666 9700-EXIT.
  4667      EXIT.
  4668
  4669 9999-DFHBACK SECTION.
  4670     MOVE '9%                    "   ' TO DFHEIV0
  4671     MOVE 'SOCK00' TO DFHEIV1
  4672     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4673     GOBACK.
  4674 9999-DFHEXIT.
  4675     IF DFHEIGDJ EQUAL 0001
  4676         NEXT SENTENCE.
  4677     MOVE '9%                    "   ' TO DFHEIV0
  4678     MOVE 'SOCK00' TO DFHEIV1
  4679     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4680     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       17084     Code:        8854
