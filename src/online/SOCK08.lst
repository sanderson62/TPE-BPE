* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   1
* SOCK08.cbl
* Options: int("SOCK08.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK08.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK08.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK08.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID. SOCK08.
     4 AUTHOR.     Cowtown.
     5 DATE-COMPILED. 05-Feb-19 08:06.
     6*SECURITY.   *****************************************************
     7*            *                                                   *
     8*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
     9*            *                                                   *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF     CSO     IS EXPRESSLY PROHIBITED WITHOUT  *
    12*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   2
* SOCK08.cbl
    14*            *****************************************************
    15******************************************************************
    16*REMARKS.                                                        *
    17*  Broker program for webservices for premium rating.            *
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 020617   2017020300002   PEMA  New Program version 2 of SOCK07
    27* 100917   2017020300002   PEMA  Add message003
    28******************************************************************
    29 ENVIRONMENT DIVISION.
    30 data division.
    31 WORKING-STORAGE SECTION.
    32 01  DFH-START PIC X(04).
    33 77  FILLER  PIC X(32) VALUE '********************************'.
    34 77  FILLER  PIC X(32) VALUE '   SOCK08   WORKING STORAGE     '.
    35 77  FILLER  PIC X(32) VALUE '********************************'.
    36*
    37* program buffers
    38*
    39 77 ws-send-msg-size             pic s9(8) comp value 512.
    40 77 ws-recv-msg-size             pic s9(8) comp value 256.
    41 77 ws-recv-buf                  pic x(256).
    42 77 ws-send-buf                  pic x(512) VALUE SPACES.
    43 77 ws-recv-total                pic s9(8) comp value 0.
    44 77 ws-recv-left                 pic s9(8) comp value 0.
    45 77 ws-seq-num                   pic s9(8) comp value 0.
    46 77 ws-flags                     pic s9(8) comp value 0.
    47 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    48 77  ws-comp-id                  pic xxx value spaces.
    49 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    50 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    51 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    52 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    53 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    54 77 X1                           PIC S999 COMP-3 VALUE +0.
    55 77 S1                           PIC S999 COMP-3 VALUE +0.
    56 77 S2                           PIC S999 COMP-3 VALUE +0.
    57 77  b1                          pic s999 comp-3 value +0.
    58 77 WS-BUILD-SW                  PIC X.
    59    88  TIME-TO-BUILD               VALUE 'Y'.
    60 77 WS-SAVE-ERACCT               PIC X(2000).
    61 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    62 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    63    88  GET-RATES                    VALUE 'R'.
    64    88  GET-ACT-ACCTS                VALUE 'A'.
    65 77  ws-bin-current-dt           pic xx  value low-values.
    66 77 ws-bin-eff-dt                pic xx  value low-values.
    67 77  ws-bin-exp-dt               pic xx  value low-values.
    68 77 ws-bin-1st-pmt-dt            pic xx  value low-values.
    69 77 ws-bin-pri-birth-dt          pic xx  value low-values.
    70 77 ws-bin-cob-birth-dt          pic xx  value low-values.
    71 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   3
* SOCK08.cbl
    72 77 ws-disp-rate                 pic z9.99999.
    73 77  WS-ERACCT-SW                PIC X VALUE ' '.
    74     88  END-OF-ERACCT                 VALUE 'Y'.
    75 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    76     88  END-OF-ERCTBL                 VALUE 'Y'.
    77 77  WS-STATUS                   PIC X.
    78 77  ws-socket-sw                pic x value ' '.
    79     88  end-of-socket              value 'Y'.
    80 77  rec-cnt                     pic 9(5) value zeros.
    81 77  ws-stop-sw                  pic x value ' '.
    82     88  i-say-stop                 value 'Y'.
    83 77  ws-browse-sw                pic x value ' '.
    84     88  browse-started            value 'Y'.
    85 77  ws-contract-sw              pic x  value ' '.
    86     88  contract-no-assigned      value 'Y'.
    87 77  ws-error-sw                 pic x value ' '.
    88     88  error-in-one-coverage     value 'Y'.
    89 77  ws-connect-sw               pic x value ' '.
    90     88  connected-to-db           value 'Y'.
    91 01  a-angle-n                   pic s9(7)v9(11) comp-3 value +0.
    92 01  a-angle-n-m                 pic s9(7)v9(11) comp-3 value +0.
    93 01  a-prm-angle-n               pic s9(7)v9(11) comp-3 value +0.
    94 01  a-prm-angle-n-m             pic s9(7)v9(11) comp-3 value +0.
    95 01  gamma                       pic s9(7)v9(11) comp-3 value +0.
    96 01  temp-value-1                pic s9(7)v9(11) comp-3 value +0.
    97 01  temp-value-2                pic s9(7)v9(11) comp-3 value +0.
    98 01  temp-value-3                pic s9(7)v9(11) comp-3 value +0.
    99 01  temp-value-4                pic s9(7)v9(11) comp-3 value +0.
   100 01  temp-value-5                pic s9(7)v9(11) comp-3 value +0.
   101 01  temp-value-6                pic s9(7)v9(11) comp-3 value +0.
   102 01  m                           pic s9(4)v9(4)  comp-3 value +0.
   103 01  n                           pic s9(4)v9(4)  comp-3 value +0.
   104 01  i                           pic s9(7)v9(11) comp-3 value +0.
   105 01  ppy                         pic s9(5)       comp-3 value +0.
   106 01  dpp                         pic s9(5)       comp-3 value +0.
   107 01  P pointer.
   108 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   109 01  var-ptr pointer.
   110 01  env-var-len                 pic 9(4)  binary.
   111 01  rc                          pic 9(9)  binary.
   112 01  WS-KIXSYS.
   113     05  WS-KIX-FIL1             PIC X(10).
   114     05  WS-KIX-APPS             PIC X(10).
   115     05  WS-KIX-ENV              PIC X(10).
   116     05  WS-KIX-MYENV            PIC X(10).
   117     05  WS-KIX-SYS              PIC X(10).
*  118 EXEC SQL
*  119    INCLUDE SQLDA
*  120 END-EXEC
   121 01 SQLDA sync.
   122    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   123    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   124    05 SQLN                  PIC S9(4) COMP-5 value 0.
   125    05 SQLD                  PIC S9(4) COMP-5 value 0.
   126    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   127       10 SQLTYPE            PIC S9(4) COMP-5.
   128       10 SQLLEN             PIC S9(4) COMP-5.
   129$IF P64 SET
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   4
* SOCK08.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130X      *> For 64-bit environments, ensure that SQLDATA is
   131X      *> aligned on an 8-byte boundary.
   132X      10 FILLER             PIC S9(9) COMP-5.
   133$END
   134       10 SQLDATA            USAGE POINTER.
   135       10 SQLIND             USAGE POINTER.
   136       10 SQLNAME.
   137          15 SQLNAMEL        PIC S9(4) COMP-5.
   138          15 SQLNAMEC        PIC X(30).
   139
   140* Values for SQLTYPE
   141
   142 78  ESQL-DATE-CHAR              VALUE 384.
   143 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   144 78  ESQL-DATE-REC               VALUE 386.
   145 78  ESQL-DATE-REC-NULL          VALUE 387.
   146 78  ESQL-TIME-CHAR              VALUE 388.
   147 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   148 78  ESQL-TIME-REC               VALUE 390.
   149 78  ESQL-TIME-REC-NULL          VALUE 391.
   150 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   151 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   152 78  ESQL-TIMESTAMP-REC          VALUE 394.
   153 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   154 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   155 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   156 78  ESQL-TS-OFFSET-REC          VALUE 398.
   157 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   158 78  ESQL-LONGVARBINARY          VALUE 404.
   159 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   160 78  ESQL-LONGVARCHAR            VALUE 408.
   161 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   162 78  ESQL-BINARY                 VALUE 444.
   163 78  ESQL-BINARY-NULL            VALUE 445.
   164 78  ESQL-VARBINARY              VALUE 446.
   165 78  ESQL-VARBINARY-NULL         VALUE 447.
   166 78  ESQL-VARCHAR                VALUE 448.
   167 78  ESQL-VARCHAR-NULL           VALUE 449.
   168
   169 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   170 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   171
   172 78  ESQL-CHAR                   VALUE 452.
   173 78  ESQL-CHAR-NULL              VALUE 453.
   174
   175 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   176 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   177
   178 78  ESQL-DOUBLE                 VALUE 480.
   179 78  ESQL-DOUBLE-NULL            VALUE 481.
   180 78  ESQL-REAL                   VALUE 482.
   181 78  ESQL-REAL-NULL              VALUE 483.
   182 78  ESQL-DECIMAL                VALUE 484.
   183 78  ESQL-DECIMAL-NULL           VALUE 485.
   184 78  ESQL-INTEGER                VALUE 496.
   185 78  ESQL-INTEGER-NULL           VALUE 497.
   186 78  ESQL-SMALLINT               VALUE 500.
   187 78  ESQL-SMALLINT-NULL          VALUE 501.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   5
* SOCK08.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   188 78  ESQL-TINYINT                VALUE 502.
   189 78  ESQL-TINYINT-NULL           VALUE 503.
*  190 EXEC SQL
*  191    INCLUDE SQLCA
*  192 END-EXEC
   193 01 SQLCA.
   194     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   195     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   196     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   197     05  SQLERRM.
   198         49  SQLERRML    PIC S9(4) COMP-5.
   199         49  SQLERRMC    PIC X(70).
   200     05  SQLERRP         PIC X(8).
   201     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   202     05  SQLWARN.
   203         10  SQLWARN0    PIC X.
   204         10  SQLWARN1    PIC X.
   205         10  SQLWARN2    PIC X.
   206         10  SQLWARN3    PIC X.
   207         10  SQLWARN4    PIC X.
   208         10  SQLWARN5    PIC X.
   209         10  SQLWARN6    PIC X.
   210         10  SQLWARN7    PIC X.
   211     05  SQLEXT.
   212         10  SQLWARN8    PIC X.
   213         10  SQLWARN9    PIC X.
   214         10  SQLWARN10   PIC X.
   215         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   216     05  SQLSTATE    PIC X(5).
   217 EXEC SQL
   218    BEGIN DECLARE SECTION
   219 END-EXEC
   220 01  ws-dealer-state             pic xx.
   221 01  ws-dealer-id                pic x(10).
   222 01  ws-contract-eff-dt          pic x(10).
   223 01  ws-contract-no              pic x(10) value spaces.
   224 01  ws-contract-suffix          pic x     value spaces.
   225 01  ws-status-code-a            pic x(7) value zeros.
   226 01  ws-status-code redefines
   227     ws-status-code-a            pic 9(7).
   228 01  ws-error-message            pic x(50) value spaces.
   229 01  ws-status-date              pic x(10).
   230 01  sqlcmd                      pic x(1024).
   231 01  svr                         pic x(32).
   232 01  usr                         pic x(32).
   233 01  pass                        pic x(32).
   234 01  usr-pass                    pic x(64).
   235 01  ws-disp-code                pic s9(11).
   236***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   237***                                                            ***
   238***  These indicators are used to determine if a variable      ***
   239***  is        null.           The indicator will be -1        ***
   240***  if the value        is null  and +0 if the value is       ***
   241***  something other than null.  Here is an example on how     ***
   242***  to use the indicator variables.                           ***
   243***                                                            ***
   244***     EXEC SQL                                               ***
   245***        fetch checkapp into                                 ***
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   6
* SOCK08.cbl
   246***           :db-app-status :nu-app-status,                   ***
   247***           :db-app-by     :nu-app-by,                       ***
   248***           :db-app-date   :nu-app-date,                     ***
   249***           :db-app-batch  :nu-app-batch                     ***
   250***     END-EXEC                                               ***
   251***                                                            ***
   252***           OR This way on an update                         ***
   253***                                                            ***
   254***     EXEC SQL                                               ***
   255***        UPDATE                                              ***
   256***           CUC_Logic_Remittance                             ***
   257***        SET                                                 ***
   258***           LogicStatus     = :ws-status-code,               ***
   259***           LogicStatusDate = :ws-status-date,               ***
   260***           BatchNumber     = :ws-batch-no :nu-batchno       ***
   261***        WHERE                                               ***
   262***           RemitId = :ws-remit-id                           ***
   263***     END-EXEC                                               ***
   264***                                                            ***
   265***    Also, when the table has a column with a data type of   ***
   266***  "BIT" and used as true/false move the 1 byte receiving    ***
   267***  field to ws-bit and check out ws-bit-comp. if = zeros,    ***
   268***  then its false. I think true would be 256.                ***
   269***                                                            ***
   270***                                                            ***
   271***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   272 01  ws-bit                      pic x.
   273 01  ws-bit-comp redefines ws-bit pic s9(4) comp.
   274 01  indicator-vaiables-for-nulls.
   275     05  nu-app-status           pic s9(4) comp value +0.
   276     05  nu-app-by               pic s9(4) comp value +0.
   277     05  nu-app-date             pic s9(4) comp value +0.
   278     05  nu-app-batch            pic s9(4) comp value +0.
   279     05  nu-fincar               pic s9(4) comp value +0.
   280     05  nu-batchno              pic s9(4) comp value +0.
   281     05  nu-error-message        pic s9(4) comp value +0.
   282 01  sql-cert-records.
   283     05  sql-dlr-state           pic xx.
   284     05  sql-dlr-id              pic x(10).
   285     05  sql-eff-dt              pic x(10).
   286     05  sql-contr-no            pic x(10).
   287     05  sql-contr-suffix        pic x.
   288 EXEC SQL
   289    END DECLARE SECTION
   290 END-EXEC
   291 01  filler.
   292     05  ws-last-suffix          pic x value low-values.
   293     05  ws-tbl-last-suffix      pic x value low-values.
   294     05  filler.  *> Use X1 for this table.
   295         10  ws-codes            pic x(26) value
   296         ' ABCDEFGHIJKLMNOPQRSTUVWXY'.
   297         10  ws-suffix-value redefines ws-codes
   298           occurs 26             pic x.
   299 01  ws-work-date.
   300     05  ws-work-ccyy            pic x(4).
   301     05  ws-work-mm              pic xx.
   302     05  ws-work-dd              pic xx.
   303 01  ws-work-date-num redefines ws-work-date
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   7
* SOCK08.cbl
   304                                 pic 9(8).
   305 01  soc-client-in-data.
   306     05  message-queuename       pic x(10).
   307     05  message-area            pic x(1024).
   308 01  WS-CID-NO                   PIC X(8).
   309 01  WS-DISP-RESP                PIC 9(5).
   310 01  WS-RESPONSE                 PIC S9(8)   COMP.
   311     88  RESP-NORMAL                  VALUE +00.
   312     88  RESP-NOTFND                  VALUE +13.
   313     88  resp-duprec                  value +14.
   314     88  resp-dupkey                  value +15.
   315     88  RESP-NOTOPEN                 VALUE +19.
   316     88  RESP-ENDFILE                 VALUE +20.
   317 01  ws-return-string            pic x(512).
   318 01  ws-mess001-length           pic s9(4) comp value +1024.
   319 01  WS-MESS001-PASS-AREA        PIC X(1024).
   320 01  ws-mess002-length           pic s9(4) comp value +1024.
   321 01  WS-MESS002-PASS-AREA        PIC X(1024).
   322 01  ws-mess003-length           pic s9(4) comp value +1024.
   323 01  WS-MESS003-PASS-AREA        PIC X(1024).
   324*                                 COPY ELCFUNDT.
   325*****************************************************************
   326*                                                               *
   327*                            ELCFUNDT.                          *
   328*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   329*                            VMOD=2.001                         *
   330*                                                               *
   331*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   332*                                                               *
   333*****************************************************************
   334
   335
   336 01  FUNCTION-DATE.
   337     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   338     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   339         10  WS-FN-CCYR            PIC 9(4).
   340         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   341             15  WS-FN-CC          PIC 99.
   342             15  WS-FN-YR          PIC 99.
   343         10  WS-FN-MO              PIC 99.
   344         10  WS-FN-DA              PIC 99.
   345     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   346     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   347     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   348     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   349     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   350         88  WS-BEHIND-GMT                     VALUE '-'.
   351         88  WS-AFTER-GMT                      VALUE '+'.
   352         88  WS-NO-GMT                         VALUE ZERO.
   353     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   354     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   355*                                 COPY ELCDATE.
   356******************************************************************
   357*                                                                *
   358*                                                                *
   359*                            ELCDATE.                            *
   360*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   361*                            VMOD=2.003
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   8
* SOCK08.cbl
   362*                                                                *
   363*                                                                *
   364*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   365*                 LENGTH = 200                                   *
   366******************************************************************
   367
   368 01  DATE-CONVERSION-DATA.
   369     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   370     12  DC-OPTION-CODE                PIC X.
   371         88  BIN-TO-GREG                VALUE ' '.
   372         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   373         88  EDIT-GREG-TO-BIN           VALUE '2'.
   374         88  YMD-GREG-TO-BIN            VALUE '3'.
   375         88  MDY-GREG-TO-BIN            VALUE '4'.
   376         88  JULIAN-TO-BIN              VALUE '5'.
   377         88  BIN-PLUS-ELAPSED           VALUE '6'.
   378         88  FIND-CENTURY               VALUE '7'.
   379         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   380         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   381         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   382         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   383         88  JULIAN-TO-BIN-3            VALUE 'C'.
   384         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   385         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   386         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   387         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   388         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   389         88  CHECK-LEAP-YEAR            VALUE 'H'.
   390         88  BIN-3-TO-GREG              VALUE 'I'.
   391         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   392         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   393         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   394         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   395         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   396         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   397         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   398         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   399         88  THREE-CHARACTER-BIN
   400                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   401         88  GREGORIAN-TO-BIN
   402                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   403         88  BIN-TO-GREGORIAN
   404                  VALUES ' ' '1' 'I' '8' 'G'.
   405         88  JULIAN-TO-BINARY
   406                  VALUES '5' 'C' 'E' 'F'.
   407     12  DC-ERROR-CODE                 PIC X.
   408         88  NO-CONVERSION-ERROR        VALUE ' '.
   409         88  DATE-CONVERSION-ERROR
   410                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   411         88  DATE-IS-ZERO               VALUE '1'.
   412         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   413         88  DATE-IS-INVALID            VALUE '3'.
   414         88  DATE1-GREATER-DATE2        VALUE '4'.
   415         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   416         88  DATE-INVALID-OPTION        VALUE '9'.
   417         88  INVALID-CENTURY            VALUE 'A'.
   418         88  ONLY-CENTURY               VALUE 'B'.
   419         88  ONLY-LEAP-YEAR             VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   9
* SOCK08.cbl
   420         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   421     12  DC-END-OF-MONTH               PIC X.
   422         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   423     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   424         88  USE-NORMAL-PROCESS         VALUE ' '.
   425         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   426         88  ADJUST-UP-100-YRS          VALUE '2'.
   427     12  FILLER                        PIC X.
   428     12  DC-CONVERSION-DATES.
   429         16  DC-BIN-DATE-1             PIC XX.
   430         16  DC-BIN-DATE-2             PIC XX.
   431         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   432         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   433                       DC-GREG-DATE-1-EDIT.
   434             20  DC-EDIT1-MONTH        PIC 99.
   435             20  SLASH1-1              PIC X.
   436             20  DC-EDIT1-DAY          PIC 99.
   437             20  SLASH1-2              PIC X.
   438             20  DC-EDIT1-YEAR         PIC 99.
   439         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   440         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   441                     DC-GREG-DATE-2-EDIT.
   442             20  DC-EDIT2-MONTH        PIC 99.
   443             20  SLASH2-1              PIC X.
   444             20  DC-EDIT2-DAY          PIC 99.
   445             20  SLASH2-2              PIC X.
   446             20  DC-EDIT2-YEAR         PIC 99.
   447         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   448         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   449                     DC-GREG-DATE-1-YMD.
   450             20  DC-YMD-YEAR           PIC 99.
   451             20  DC-YMD-MONTH          PIC 99.
   452             20  DC-YMD-DAY            PIC 99.
   453         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   454         16  DC-GREG-DATE-1-MDY-R REDEFINES
   455                      DC-GREG-DATE-1-MDY.
   456             20  DC-MDY-MONTH          PIC 99.
   457             20  DC-MDY-DAY            PIC 99.
   458             20  DC-MDY-YEAR           PIC 99.
   459         16  DC-GREG-DATE-1-ALPHA.
   460             20  DC-ALPHA-MONTH        PIC X(10).
   461             20  DC-ALPHA-DAY          PIC 99.
   462             20  FILLER                PIC XX.
   463             20  DC-ALPHA-CENTURY.
   464                 24 DC-ALPHA-CEN-N     PIC 99.
   465             20  DC-ALPHA-YEAR         PIC 99.
   466         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   467         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   468         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   469         16  DC-JULIAN-DATE            PIC 9(05).
   470         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   471                                       PIC 9(05).
   472         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   473             20  DC-JULIAN-YEAR        PIC 99.
   474             20  DC-JULIAN-DAYS        PIC 999.
   475         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   476         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   477         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  10
* SOCK08.cbl
   478     12  DATE-CONVERSION-VARIBLES.
   479         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   480         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   481             20  FILLER                PIC 9(3).
   482             20  HOLD-CEN-1-CCYY.
   483                 24  HOLD-CEN-1-CC     PIC 99.
   484                 24  HOLD-CEN-1-YY     PIC 99.
   485             20  HOLD-CEN-1-MO         PIC 99.
   486             20  HOLD-CEN-1-DA         PIC 99.
   487         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   488             20  HOLD-CEN-1-R-MO       PIC 99.
   489             20  HOLD-CEN-1-R-DA       PIC 99.
   490             20  HOLD-CEN-1-R-CCYY.
   491                 24  HOLD-CEN-1-R-CC   PIC 99.
   492                 24  HOLD-CEN-1-R-YY   PIC 99.
   493             20  FILLER                PIC 9(3).
   494         16  HOLD-CENTURY-1-X.
   495             20  FILLER                PIC X(3)  VALUE SPACES.
   496             20  HOLD-CEN-1-X-CCYY.
   497                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   498                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   499             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   500             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   501         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   502             20  HOLD-CEN-1-R-X-MO     PIC XX.
   503             20  HOLD-CEN-1-R-X-DA     PIC XX.
   504             20  HOLD-CEN-1-R-X-CCYY.
   505                 24  HOLD-CEN-1-R-X-CC PIC XX.
   506                 24  HOLD-CEN-1-R-X-YY PIC XX.
   507             20  FILLER                PIC XXX.
   508         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   509         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   510         16  DC-JULIAN-DATE-1          PIC 9(07).
   511         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   512             20  DC-JULIAN-1-CCYY.
   513                 24  DC-JULIAN-1-CC    PIC 99.
   514                 24  DC-JULIAN-1-YR    PIC 99.
   515             20  DC-JULIAN-DA-1        PIC 999.
   516         16  DC-JULIAN-DATE-2          PIC 9(07).
   517         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   518             20  DC-JULIAN-2-CCYY.
   519                 24  DC-JULIAN-2-CC    PIC 99.
   520                 24  DC-JULIAN-2-YR    PIC 99.
   521             20  DC-JULIAN-DA-2        PIC 999.
   522         16  DC-GREG-DATE-A-EDIT.
   523             20  DC-EDITA-MONTH        PIC 99.
   524             20  SLASHA-1              PIC X VALUE '/'.
   525             20  DC-EDITA-DAY          PIC 99.
   526             20  SLASHA-2              PIC X VALUE '/'.
   527             20  DC-EDITA-CCYY.
   528                 24  DC-EDITA-CENT     PIC 99.
   529                 24  DC-EDITA-YEAR     PIC 99.
   530         16  DC-GREG-DATE-B-EDIT.
   531             20  DC-EDITB-MONTH        PIC 99.
   532             20  SLASHB-1              PIC X VALUE '/'.
   533             20  DC-EDITB-DAY          PIC 99.
   534             20  SLASHB-2              PIC X VALUE '/'.
   535             20  DC-EDITB-CCYY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  11
* SOCK08.cbl
   536                 24  DC-EDITB-CENT     PIC 99.
   537                 24  DC-EDITB-YEAR     PIC 99.
   538         16  DC-GREG-DATE-CYMD         PIC 9(08).
   539         16  DC-GREG-DATE-CYMD-R REDEFINES
   540                              DC-GREG-DATE-CYMD.
   541             20  DC-CYMD-CEN           PIC 99.
   542             20  DC-CYMD-YEAR          PIC 99.
   543             20  DC-CYMD-MONTH         PIC 99.
   544             20  DC-CYMD-DAY           PIC 99.
   545         16  DC-GREG-DATE-MDCY         PIC 9(08).
   546         16  DC-GREG-DATE-MDCY-R REDEFINES
   547                              DC-GREG-DATE-MDCY.
   548             20  DC-MDCY-MONTH         PIC 99.
   549             20  DC-MDCY-DAY           PIC 99.
   550             20  DC-MDCY-CEN           PIC 99.
   551             20  DC-MDCY-YEAR          PIC 99.
   552    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   553        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   554    12  DC-EL310-DATE                  PIC X(21).
   555    12  FILLER                         PIC X(28).
   556*                                 COPY ELCCALC.
   557******************************************************************
   558*                                                                *
   559*                           ELCCALC.                            *
   560*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   561*                            VMOD=2.025                          *
   562*                                                                *
   563*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   564*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   565*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   566*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   567*                                                                *
   568*  PASSED TO ELRTRM                                              *
   569*  -----------------                                             *
   570*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   571*  ORIGINAL TERM                                                 *
   572*  BEGINNING DATE                                                *
   573*  ENDING DATE                                                   *
   574*  COMPANY I.D.                                                  *
   575*  ACCOUNT MASTER USER FIELD                                     *
   576*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   577*  FREE LOOK DAYS                                                *
   578*                                                                *
   579*  RETURNED FROM ELRTRM                                          *
   580*  ---------------------                                         *
   581*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   582*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   583*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   584*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   585*----------------------------------------------------------------*
   586*  PASSED TO ELRAMT                                              *
   587*  ----------------                                              *
   588*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   589*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   590*  ORIGINAL AMOUNT                                               *
   591*  ALTERNATE BENEFIT (BALLON)                                    *
   592*  A.P.R. - NET PAY ONLY                                         *
   593*  METHOD
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  12
* SOCK08.cbl
   594*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   595*  COMPANY I.D.                                                  *
   596*  BENEFIT TYPE                                                  *
   597*                                                                *
   598*  RETURNED FROM ELRAMT                                          *
   599*  --------------------                                          *
   600*  REMAINING AMOUNT 1 - CURRENT                                  *
   601*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   602*  REMAINING AMOUNT FACTOR
   603*----------------------------------------------------------------*
   604*  PASSED TO ELRESV                                              *
   605*  -----------------                                             *
   606*  CERTIFICATE EFFECTIVE DATE                                    *
   607*  VALUATION DATE                                                *
   608*  PAID THRU DATE                                                *
   609*  BENEFIT                                                       *
   610*  INCURRED DATE                                                 *
   611*  REPORTED DATE                                                 *
   612*  ISSUE AGE                                                     *
   613*  TERM                                                          *
   614*  CDT PERCENT                                                   *
   615*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   616* *CLAIM TYPE (LIFE, A/H)                                        *
   617* *REMAINING BENEFIT (FROM ELRAMT)                               *
   618* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   619*                                                                *
   620*  RETURNED FROM ELRESV                                          *
   621*  --------------------                                          *
   622*  CDT TABLE USED                                                *
   623*  CDT FACTOR USED                                               *
   624*  PAY TO CURRENT RESERVE                                        *
   625*  I.B.N.R. - A/H ONLY                                           *
   626*  FUTURE (ACCRUED) AH ONLY                                      *
   627*----------------------------------------------------------------*
   628*  PASSED TO ELRATE                                              *
   629*  ----------------                                              *
   630*  CERT ISSUE DATE                                               *
   631*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   632*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   633*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   634*  STATE CODE (CLIENT DEFINED)                                   *
   635*  STATE CODE (STANDARD P.O. ABBRV)                              *
   636*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   637*  DEVIATION CODE                                                *
   638*  ISSUE AGE                                                     *
   639*  ORIGINAL BENEFIT AMOUNT                                       *
   640*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   641*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   642*  BENEFIT KIND (LIFE OR A/H)                                    *
   643*  A.P.R.                                                        *
   644*  METHOD
   645*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   646*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   647*  COMPANY I.D. (3 CHARACTER)                                    *
   648*  BENEFIT CODE                                                  *
   649*  BENEFIT OVERRIDE CODE                                         *
   650*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   651*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  13
* SOCK08.cbl
   652*  JOINT INDICATOR (CSL ONLY)                                    *
   653*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   654*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   655*                                                                *
   656*  RETURNED FROM ELRATE                                          *
   657*  --------------------                                          *
   658*  CALCULATED PREMIUM                                            *
   659*  PREMIUM RATE                                                  *
   660*  MORTALITY CODE                                                *
   661*  MAX ATTAINED AGE                                              *
   662*  MAX AGE                                                       *
   663*  MAX TERM                                                      *
   664*  MAX MONTHLY BENEFIT                                           *
   665*  MAX TOTAL BENIFIT                                             *
   666*  COMPOSITE RATE (OPEN-END ONLY)                                *
   667*----------------------------------------------------------------*
   668*  PASSED TO ELRFND                                              *
   669*  ----------------                                              *
   670*  CERT ISSUE DATE                                               *
   671*  REFUND DATE                                                   *
   672*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   673*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   674*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   675*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   676*  STATE CODE (CLIENT DEFINED)                                   *
   677*  STATE CODE (STANDARD P.O. ABBRV)                              *
   678*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   679*  DEVIATION CODE                                                *
   680*  ISSUE AGE                                                     *
   681*  ORIGINAL BENEFIT AMOUNT                                       *
   682*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   683*  PROCESS TYPE (CANCEL)                                         *
   684*  BENEFIT KIND (LIFE OR A/H)                                    *
   685*  A.P.R.                                                        *
   686*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   687*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   688*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   689*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   690*  COMPANY I.D. (3 CHARACTER)                                    *
   691*  BENEFIT CODE                                                  *
   692*  BENEFIT OVERRIDE CODE                                         *
   693*                                                                *
   694*  RETURNED FROM ELRFND                                          *
   695*  --------------------                                          *
   696*  CALCULATED REFUND                                             *
   697*----------------------------------------------------------------*
   698*  PASSED TO ELEARN                                              *
   699*  ----------------                                              *
   700*  CERT ISSUE DATE                                               *
   701*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   702*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   703*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   704*  STATE CODE (CLIENT DEFINED)                                   *
   705*  STATE CODE (STANDARD P.O. ABBRV)                              *
   706*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   707*  DEVIATION CODE                                                *
   708*  ISSUE AGE                                                     *
   709*  ORIGINAL BENEFIT AMOUNT                                       *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  14
* SOCK08.cbl
   710*  BENEFIT KIND (LIFE OR A/H)                                    *
   711*  A.P.R.                                                        *
   712*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   713*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   714*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   715*  COMPANY I.D. (3 CHARACTER)                                    *
   716*  BENEFIT CODE                                                  *
   717*  BENEFIT OVERRIDE CODE                                         *
   718*                                                                *
   719*  RETURNED FROM ELEARN                                          *
   720*  --------------------                                          *
   721*  INDICATED  EARNINGS                                           *
   722*----------------------------------------------------------------*
   723*                 LENGTH = 450                                   *
   724*                                                                *
   725******************************************************************
   726******************************************************************
   727*                   C H A N G E   L O G
   728*
   729* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   730*-----------------------------------------------------------------
   731*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   732* EFFECTIVE    NUMBER
   733*-----------------------------------------------------------------
   734* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   735* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   736* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   737* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   738* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   739* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   740* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   741* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   742* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   743* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   744* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   745******************************************************************
   746
   747 01  CALCULATION-PASS-AREA.
   748     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   749                                     COMP.
   750
   751     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   752       88  NO-CP-ERROR                             VALUE ZERO.
   753       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   754                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   755       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   756       88  CP-ERROR-IN-DATES                       VALUE '2'.
   757       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   758       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   759       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   760       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   761       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   762       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   763       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   764       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   765       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   766       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   767       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  15
* SOCK08.cbl
   768       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   769       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   770       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   771       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   772
   773     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   774       88  NO-CP-ERROR-2                           VALUE ZERO.
   775***********************  INPUT AREAS ****************************
   776
   777     12  CP-CALCULATION-AREA.
   778         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   779         16  CP-CERT-EFF-DT        PIC XX.
   780         16  CP-VALUATION-DT       PIC XX.
   781         16  CP-PAID-THRU-DT       PIC XX.
   782         16  CP-BENEFIT-TYPE       PIC X.
   783           88  CP-AH                               VALUE 'A' 'D'
   784                                                   'I' 'U'.
   785           88  CP-REDUCING-LIFE                    VALUE 'R'.
   786           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   787         16  CP-INCURRED-DT        PIC XX.
   788         16  CP-REPORTED-DT        PIC XX.
   789         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   790         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   791         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   792                                     COMP-3.
   793         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   794                                     COMP-3.
   795         16  CP-CDT-METHOD         PIC X.
   796           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   797           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   798           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   799         16  CP-CLAIM-TYPE         PIC X.
   800           88  CP-AH-CLAIM                         VALUE 'A'.
   801           88  CP-LIFE-CLAIM                       VALUE 'L'.
   802         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   803                                     COMP-3.
   804         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   805                                     COMP-3.
   806         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   807                                     COMP-3.
   808         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   809                                     COMP-3.
   810         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   811                                     COMP-3.
   812         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   813                                     COMP-3.
   814         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   815                                     COMP-3.
   816         16  CP-REM-TERM-METHOD    PIC X.
   817           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   818           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   819           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   820           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   821           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   822           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   823           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   824         16  CP-EARNING-METHOD     PIC X.
   825           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  16
* SOCK08.cbl
   826           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   827           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   828           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   829           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   830           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   831           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   832           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   833           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   834           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   835           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   836           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   837           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   838           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   839         16  CP-PROCESS-TYPE       PIC X.
   840           88  CP-CLAIM                            VALUE '1'.
   841           88  CP-CANCEL                           VALUE '2'.
   842           88  CP-ISSUE                            VALUE '3'.
   843         16  CP-SPECIAL-CALC-CD    PIC X.
   844           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   845           88  CP-1-MTH-INTEREST               VALUE ' '.
   846           88  CP-0-MTH-INTEREST               VALUE 'A'.
   847           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   848           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   849           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   850           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   851           88  CP-FARM-PLAN                    VALUE 'F'.
   852           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   853           88  CP-2-MTH-INTEREST               VALUE 'I'.
   854           88  CP-3-MTH-INTEREST               VALUE 'J'.
   855           88  CP-4-MTH-INTEREST               VALUE 'K'.
   856           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   857           88  CP-MORTGAGE-REC                 VALUE 'M'.
   858           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   859           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   860           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   861           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   862                                                     'W' 'X'.
   863           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   864           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   865           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   866           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   867           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   868           88  CP-SUMMARY-REC                  VALUE 'Z'.
   869           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   870           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   871           88  CP-AD-D-BENEFIT                 VALUE '4'.
   872           88  CP-CSL-METH-1                   VALUE '5'.
   873           88  CP-CSL-METH-2                   VALUE '6'.
   874           88  CP-CSL-METH-3                   VALUE '7'.
   875           88  CP-CSL-METH-4                   VALUE '8'.
   876
   877         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   878                                     COMP-3.
   879         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   880         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   881         16  CP-STATE              PIC XX          VALUE SPACE.
   882         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   883         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  17
* SOCK08.cbl
   884           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   885               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   886         16  CP-R78-OPTION         PIC X.
   887           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   888           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   889
   890         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   891         16  CP-IBNR-RESERVE-SW    PIC X.
   892         16  CP-CLAIM-STATUS       PIC X.
   893         16  CP-RATE-FILE          PIC X.
   894         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   895                                     COMP-3.
   896
   897         16  CP-LIFE-OVERRIDE-CODE PIC X.
   898         16  CP-AH-OVERRIDE-CODE   PIC X.
   899
   900         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   901                                     COMP-3.
   902         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   903                                   PIC S9(5)V99 COMP-3.
   904         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   905                                     COMP-3.
   906         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   907                                     COMP-3.
   908         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   909                                     COMP-3.
   910         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   911                                  PIC S9(7)V99 COMP-3.
   912
   913         16  CP-PAID-FROM-DATE     PIC X(02).
   914         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   915         16  CP-EXT-DAYS-CALC      PIC X.
   916           88  CP-EXT-NO-CHG                   VALUE ' '.
   917           88  CP-EXT-CHG-LF                   VALUE '1'.
   918           88  CP-EXT-CHG-AH                   VALUE '2'.
   919           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   920         16  CP-DOMICILE-STATE     PIC XX.
   921         16  CP-CARRIER            PIC X.
   922         16  CP-REIN-FLAG          PIC X.
   923         16  CP-REM-TRM-CALC-OPTION PIC X.
   924           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   925                      '2' '3' '4' '5'.
   926           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   927           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   928           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   929           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   930           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   931           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   932           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   933           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   934         16  CP-SIG-SWITCH         PIC X.
   935         16  CP-RATING-METHOD      PIC X.
   936           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   937           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   938           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   939           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   940           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   941           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  18
* SOCK08.cbl
   942           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   943           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   944           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   945         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   946                                     COMP-3.
   947         16  CP-BEN-CATEGORY       PIC X.
   948         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   949         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   950                                   PIC S99V9(5) COMP-3.
   951         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   952         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   953                                   PIC S99V9(5) COMP-3.
   954         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   955         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   956         16  CP-EXPIRE-DT          PIC XX.
   957         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   958         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   959         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   960         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   961         16  CP-DDF-SPEC-CALC      PIC X.
   962             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   963             88  CP-CALC-CLP              VALUE 'C'.
   964         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   965         16  CP-CANCEL-REASON      PIC X.
   966         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   967         16  CP-PMT-MODE           PIC X.
   968         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   969         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   970         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   971         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   972         16  FILLER                PIC X.
   973
   974***************    OUTPUT FROM ELRESV   ************************
   975
   976         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   977
   978         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   979                                     COMP-3.
   980         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   981                                     COMP-3.
   982         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   983                                     COMP-3.
   984         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   985                                     COMP-3.
   986         16  FILLER                PIC X(09).
   987***************    OUTPUT FROM ELRTRM   *************************
   988
   989         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   990                                     COMP-3.
   991         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   992                                     COMP-3.
   993         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   994                                     COMP-3.
   995         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   996                                     COMP-3.
   997         16  FILLER                PIC X(12).
   998
   999***************    OUTPUT FROM ELRAMT   *************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  19
* SOCK08.cbl
  1000
  1001         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1002                                     COMP-3.
  1003         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1004                                     COMP-3.
  1005         16  FILLER                PIC X(12).
  1006
  1007***************    OUTPUT FROM ELRATE   *************************
  1008
  1009         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1010                                     COMP-3.
  1011         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1012                                     COMP-3.
  1013         16  CP-MORTALITY-CODE     PIC X(4).
  1014         16  CP-RATE-EDIT-FLAG     PIC X.
  1015             88  CP-RATES-NEED-APR                  VALUE '1'.
  1016         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1017                                     COMP-3.
  1018         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1019         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1020         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1021                                   PIC S9(7)V99 COMP-3.
  1022         16  FILLER                PIC X(07).
  1023
  1024***************    OUTPUT FROM ELRFND   *************************
  1025
  1026         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1027                                     COMP-3.
  1028         16  CP-REFUND-TYPE-USED   PIC X.
  1029           88  CP-R-AS-R78                         VALUE '1'.
  1030           88  CP-R-AS-PRORATA                     VALUE '2'.
  1031           88  CP-R-AS-CALIF                       VALUE '3'.
  1032           88  CP-R-AS-TEXAS                       VALUE '4'.
  1033           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1034           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1035           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1036           88  CP-R-AS-MEAN                        VALUE '8'.
  1037           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1038           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1039           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1040           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1041           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1042           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1043         16  FILLER                PIC X(12).
  1044
  1045***************    OUTPUT FROM ELEARN   *************************
  1046
  1047         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1048                                     COMP-3.
  1049         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1050                                     COMP-3.
  1051         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1052                                     COMP-3.
  1053         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1054                                     COMP-3.
  1055         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1056                                     COMP-3.
  1057         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  20
* SOCK08.cbl
  1058                                     COMP-3.
  1059         16  CP-EARNING-TYPE-USED  PIC X.
  1060           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1061           88  CP-E-AS-R78                         VALUE '1'.
  1062           88  CP-E-AS-PRORATA                     VALUE '2'.
  1063           88  CP-E-AS-TEXAS                       VALUE '4'.
  1064           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1065           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1066           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1067           88  CP-E-AS-MEAN                        VALUE '8'.
  1068           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1069         16  FILLER                PIC X(12).
  1070
  1071***************    OUTPUT FROM ELPMNT   *************************
  1072
  1073         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1074                                     COMP-3.
  1075         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1076                                     COMP-3.
  1077         16  FILLER                PIC X(12).
  1078
  1079***************   MISC WORK AREAS    *****************************
  1080         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1081                                     COMP-3.
  1082         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1083                                     COMP-3.
  1084         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1085                                     COMP-3.
  1086         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1087                                     COMP-3.
  1088         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1089                                     COMP-3.
  1090         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1091                                     COMP-3.
  1092         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1093             88  OPEN-RATE-FILE                   VALUE 'O'.
  1094             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1095             88  IO-ERROR                         VALUE 'E'.
  1096
  1097         16  CP-FIRST-PAY-DATE     PIC XX.
  1098
  1099         16  CP-JOINT-INDICATOR    PIC X.
  1100
  1101         16  CP-RESERVE-REMAINING-TERM
  1102                                   PIC S9(4)V9    VALUE ZERO
  1103                                     COMP-3.
  1104
  1105         16  CP-INSURED-BIRTH-DT   PIC XX.
  1106
  1107         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1108                                     COMP-3.
  1109
  1110         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1111                                     COMP-3.
  1112
  1113         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1114                                     COMP-3.
  1115
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  21
* SOCK08.cbl
  1116         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1117                                     COMP-3.
  1118
  1119         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1120                                     COMP-3.
  1121
  1122         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1123                                     COMP-3.
  1124
  1125         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1126                                     COMP-3.
  1127
  1128         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1129             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1130
  1131         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1132                                     COMP-3.
  1133         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1134                                     COMP-3.
  1135         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1136         16  cp-extra-periods      pic 9 value zeros.
  1137         16  cp-net-only-state     pic x value spaces.
  1138         16  FILLER                PIC X(13).
  1139******************************************************************
  1140****************************************************************
  1141*
  1142* Copyright (c) 2007-2013 Dell Inc.
  1143* All rights reserved.
  1144*
  1145****************************************************************
  1146 01  DFHEIV.
  1147   02  DFHEIV0               PIC X(35).
  1148   02  DFHEIV1               PIC X(08).
  1149   02  DFHEIV2               PIC X(08).
  1150   02  DFHEIV3               PIC X(08).
  1151   02  DFHEIV4               PIC X(06).
  1152   02  DFHEIV5               PIC X(04).
  1153   02  DFHEIV6               PIC X(04).
  1154   02  DFHEIV7               PIC X(02).
  1155   02  DFHEIV8               PIC X(02).
  1156   02  DFHEIV9               PIC X(01).
  1157   02  DFHEIV10              PIC S9(7) COMP-3.
  1158   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1159   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1160   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1161   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1162   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1163   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1164   02  DFHEIV17              PIC X(04).
  1165   02  DFHEIV18              PIC X(04).
  1166   02  DFHEIV19              PIC X(04).
  1167   02  DFHEIV20              USAGE IS POINTER.
  1168   02  DFHEIV21              USAGE IS POINTER.
  1169   02  DFHEIV22              USAGE IS POINTER.
  1170   02  DFHEIV23              USAGE IS POINTER.
  1171   02  DFHEIV24              USAGE IS POINTER.
  1172   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1173   02  DFHEIV26              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  22
* SOCK08.cbl
  1174   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1175   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1176   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1177   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1178   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1179   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1180   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1181   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1182   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1183   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1184   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1185   02  FILLER                PIC X(02).
  1186   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1187   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1188   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1189   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1190   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1191   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1192   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1193 LINKAGE  SECTION.
  1194*****************************************************************
  1195*                                                               *
  1196* Copyright (c) 2007-2013 Dell Inc.                             *
  1197* All rights reserved.                                          *
  1198*                                                               *
  1199*****************************************************************
  1200 01  dfheiblk.
  1201     02  eibtime          pic s9(7) comp-3.
  1202     02  eibdate          pic s9(7) comp-3.
  1203     02  eibtrnid         pic x(4).
  1204     02  eibtaskn         pic s9(7) comp-3.
  1205     02  eibtrmid         pic x(4).
  1206     02  dfheigdi         pic s9(4) comp.
  1207     02  eibcposn         pic s9(4) comp.
  1208     02  eibcalen         pic s9(4) comp.
  1209     02  eibaid           pic x(1).
  1210     02  eibfiller1       pic x(1).
  1211     02  eibfn            pic x(2).
  1212     02  eibfiller2       pic x(2).
  1213     02  eibrcode         pic x(6).
  1214     02  eibfiller3       pic x(2).
  1215     02  eibds            pic x(8).
  1216     02  eibreqid         pic x(8).
  1217     02  eibrsrce         pic x(8).
  1218     02  eibsync          pic x(1).
  1219     02  eibfree          pic x(1).
  1220     02  eibrecv          pic x(1).
  1221     02  eibsend          pic x(1).
  1222     02  eibatt           pic x(1).
  1223     02  eibeoc           pic x(1).
  1224     02  eibfmh           pic x(1).
  1225     02  eibcompl         pic x(1).
  1226     02  eibsig           pic x(1).
  1227     02  eibconf          pic x(1).
  1228     02  eiberr           pic x(1).
  1229     02  eibrldbk         pic x(1).
  1230     02  eiberrcd         pic x(4).
  1231     02  eibsynrb         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  23
* SOCK08.cbl
  1232     02  eibnodat         pic x(1).
  1233     02  eibfiller5       pic x(2).
  1234     02  eibresp          pic s9(8) comp.
  1235     02  eibresp2         pic s9(8) comp.
  1236     02  dfheigdj         pic s9(4) comp.
  1237     02  dfheigdk         pic s9(4) comp.
  1238 01  DFHCOMMAREA.
  1239   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  1240   05 LSTN-NAME                PIC X(8).
  1241   05 LSTN-SUBNAME             PIC X(8).
  1242****   client-in-data must be 36 characters.  ****
  1243   05 CLIENT-IN-DATA.
  1244      15  CLIENT-KICK-OFF      PIC X(8).
  1245      15  CLIENT-ID            PIC XXX.
  1246      15  FILLER               PIC X(25).
  1247   05 SOCKADDR-IN-PARM.
  1248     15 SIN-FAMILY             PIC 9(4) COMP.
  1249     15 SIN-PORT               PIC 9(4) COMP.
  1250     15 SIN-ADDRESS            PIC 9(8) COMP.
  1251     15 SIN-ZERO               PIC X(8).
  1252 01  var  pic x(30).
  1253 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  1254 0000-DFHEXIT SECTION.
  1255     MOVE '9#                    $   ' TO DFHEIV0.
  1256     MOVE 'SOCK08' TO DFHEIV1.
  1257     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1258     display ' Entering program SOCK08.cl2 '
  1259*    display 'SOCK08:transaction data =', CLIENT-IN-DATA '**'
  1260*    display 'SOCK08:socket number    =', GIVE-TAKE-SOCKET.
  1261*       lstn-subname
  1262     perform 0000-init           thru 0000-exit
  1263     perform 0010-init-contact   thru 0010-exit
  1264     perform 0100-process-socket thru 0100-exit until
  1265        end-of-socket
  1266     go to 0300-close-socket
  1267     .
  1268 0000-init.
  1269     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  1270     move ws-fn-cymd             to dc-greg-date-cymd
  1271     move 'L'                    to dc-option-code
  1272     perform 9700-date-link      thru 9700-exit
  1273     if no-conversion-error
  1274        move dc-bin-date-1       to ws-bin-current-dt
  1275     else
  1276        display ' error current dt invalid ' dc-error-code
  1277     end-if
  1278     set P to address of KIXSYS
  1279     CALL "getenv" using by value P returning var-ptr
  1280     if var-ptr = null then
  1281        display ' kixsys not set '
  1282     else
  1283        set address of var to var-ptr
  1284        move 0 to env-var-len
  1285        inspect var tallying env-var-len
  1286          for characters before X'00'
  1287        unstring var (1:env-var-len) delimited by '/'
  1288           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  1289              WS-KIX-SYS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  24
* SOCK08.cbl
  1290        end-unstring
  1291     end-if
  1292     .
  1293 0000-exit.
  1294     exit.
  1295 0010-init-contact.
  1296     if client-kick-off = 'SOCKET08'
  1297        continue
  1298     else
  1299        move '9999;Unknown origin, who are you? '
  1300                                 to ws-return-string
  1301        PERFORM 0200-SEND-BUFFER thru 0200-exit
  1302        display ' Unknown origin ' client-in-data
  1303        go to 0300-close-socket
  1304     end-if
  1305     evaluate client-id
  1306        when 'DCC'
  1307           MOVE X'05'            TO WS-COMP-CD
  1308           MOVE 'DCC'            TO WS-COMP-ID
  1309        when 'CID'
  1310           MOVE X'04'            TO WS-COMP-CD
  1311           MOVE 'CID'            TO WS-COMP-ID
  1312        when 'AHL'
  1313           MOVE X'06'            TO WS-COMP-CD
  1314           MOVE 'AHL'            TO WS-COMP-ID
  1315        when other
  1316           move '0113;Invalid company id ' to ws-return-string
  1317           PERFORM 0200-SEND-BUFFER thru 0200-exit
  1318           display ' Invalid company id ' client-id
  1319           go to 0300-close-socket
  1320     END-evaluate
  1321     move 'SOCKET08READY'        to ws-send-buf
  1322     move +25                    to ws-send-msg-size
  1323     call "send" using by value GIVE-TAKE-SOCKET,
  1324         by reference ws-send-buf,
  1325         by value ws-send-msg-size,
  1326         by value ws-flags
  1327     if return-code <= zero
  1328        display 'SOCK08:send error ' return-code
  1329        perform 0250-socket-error thru 0250-exit
  1330        go to 0300-close-socket
  1331     end-if
  1332     .
  1333 0010-exit.
  1334     exit.
  1335 0100-process-socket.
  1336     perform 0110-receive        thru 0110-exit
  1337     if end-of-socket
  1338        go to 0100-exit
  1339     end-if
  1340     evaluate message-queuename
  1341        when 'message001'
  1342           perform 1000-link-mess001
  1343                                 thru 1000-exit
  1344           move ws-mess001-pass-area
  1345                                 to ws-return-string
  1346        when 'message002'
  1347           perform 2000-link-mess002
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  25
* SOCK08.cbl
  1348                                 thru 2000-exit
  1349           move ws-mess002-pass-area
  1350                                 to ws-return-string
  1351        when 'message003'
  1352           perform 3000-link-mess003
  1353                                 thru 3000-exit
  1354           move ws-mess003-pass-area
  1355                                 to ws-return-string
  1356        when other
  1357           move 'Invalid message number '
  1358                                 to ws-return-string
  1359           set end-of-socket to true
  1360     end-evaluate
  1361     perform 0200-send-buffer    thru 0200-exit
  1362     .
  1363 0100-exit.
  1364     exit.
  1365 0110-receive.
  1366     move spaces                 to ws-recv-buf
  1367     call "recv" using by value GIVE-TAKE-SOCKET
  1368         by reference ws-recv-buf
  1369         by value ws-recv-msg-size
  1370         by value ws-flags.
  1371     if return-code < zero
  1372        display 'SOCK08:recv error ' return-code
  1373        perform 0250-socket-error thru 0250-exit
  1374        set end-of-socket to true
  1375        go to 0110-exit
  1376     end-if
  1377     if return-code = zero
  1378        display 'SOCK08:client disconnected',
  1379        perform 0250-socket-error thru 0250-exit
  1380        set end-of-socket to true
  1381        go to 0110-exit
  1382     end-if
  1383     move +512                   to ws-send-msg-size
  1384     move ws-recv-buf (1:170)     to soc-client-in-data
  1385     if ws-recv-buf (1:4) = 'DONE' or 'done' or 'Done'
  1386        set end-of-socket to true
  1387     end-if
  1388     .
  1389 0110-exit.
  1390     exit.
  1391 0200-send-buffer.
  1392     move ws-return-string       to ws-send-buf
  1393     call "send" using by value GIVE-TAKE-SOCKET,
  1394         by reference ws-send-buf,
  1395         by value ws-send-msg-size,
  1396         by value ws-flags.
  1397     if return-code <= zero
  1398        display 'SOCK08:send error ',
  1399        perform 0250-socket-error thru 0250-exit
  1400        go to 0300-close-socket
  1401     end-if
  1402     .
  1403 0200-exit.
  1404     exit.
  1405 0250-socket-error.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  26
* SOCK08.cbl
  1406     display "SOCK08:did not complete"
  1407     display 'SOCK08:transaction data =', CLIENT-IN-DATA '**'
  1408     display 'SOCK08:socket number    =', GIVE-TAKE-SOCKET.
  1409     display 'SOCK08:socket name      =', lstn-name ' '
  1410        lstn-subname
  1411     display ' return code = ' return-code
  1412     .
  1413 0250-exit.
  1414     exit.
  1415 0300-close-socket.
  1416
  1417* exec cics return end-exec.
  1418*    MOVE '.(                    ''   #00001320' TO DFHEIV0
  1419     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1420     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1421     MOVE X'2020233030303031333230' TO DFHEIV0(25:11)
  1422     CALL 'kxdfhei1' USING DFHEIV0,
  1423           DFHEIV99,
  1424           DFHEIV99,
  1425           DFHEIV99,
  1426           DFHEIV99,
  1427           DFHEIV99,
  1428           DFHEIV99
  1429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1430
  1431
  1432* goback.
  1433     MOVE '9%                    "   ' TO DFHEIV0
  1434     MOVE 'SOCK08' TO DFHEIV1
  1435     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1436     goback.
  1437     .
  1438 0300-exit.
  1439     exit.
  1440 1000-link-mess001.
  1441     move soc-client-in-data     to ws-mess001-pass-area
  1442
  1443* EXEC CICS LINK
  1444*         PROGRAM  ('WSMESS01')
  1445*         COMMAREA (WS-MESS001-PASS-AREA)
  1446*         LENGTH   (ws-mess001-length)
  1447*    END-EXEC.
  1448     MOVE 'WSMESS01' TO DFHEIV1
  1449*    MOVE '."C                   (   #00001327' TO DFHEIV0
  1450     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1451     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1452     MOVE X'2020233030303031333237' TO DFHEIV0(25:11)
  1453     CALL 'kxdfhei1' USING DFHEIV0,
  1454           DFHEIV1,
  1455           WS-MESS001-PASS-AREA,
  1456           ws-mess001-length,
  1457           DFHEIV99,
  1458           DFHEIV99,
  1459           DFHEIV99,
  1460           DFHEIV99
  1461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1462
  1463     .
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  27
* SOCK08.cbl
  1464 1000-exit.
  1465     exit.
  1466 2000-link-mess002.
  1467     move soc-client-in-data     to ws-mess002-pass-area
  1468
  1469* EXEC CICS LINK
  1470*         PROGRAM  ('WSMESS02')
  1471*         COMMAREA (WS-MESS002-PASS-AREA)
  1472*         LENGTH   (ws-mess002-length)
  1473*    END-EXEC.
  1474     MOVE 'WSMESS02' TO DFHEIV1
  1475*    MOVE '."C                   (   #00001337' TO DFHEIV0
  1476     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1477     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1478     MOVE X'2020233030303031333337' TO DFHEIV0(25:11)
  1479     CALL 'kxdfhei1' USING DFHEIV0,
  1480           DFHEIV1,
  1481           WS-MESS002-PASS-AREA,
  1482           ws-mess002-length,
  1483           DFHEIV99,
  1484           DFHEIV99,
  1485           DFHEIV99,
  1486           DFHEIV99
  1487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1488
  1489     .
  1490 2000-exit.
  1491     exit.
  1492 3000-link-mess003.
  1493
  1494     move soc-client-in-data     to ws-mess003-pass-area
  1495
  1496
  1497* EXEC CICS LINK
  1498*         PROGRAM  ('WSMESS03')
  1499*         COMMAREA (WS-MESS003-PASS-AREA)
  1500*         LENGTH   (ws-mess003-length)
  1501*    END-EXEC.
  1502     MOVE 'WSMESS03' TO DFHEIV1
  1503*    MOVE '."C                   (   #00001349' TO DFHEIV0
  1504     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1505     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1506     MOVE X'2020233030303031333439' TO DFHEIV0(25:11)
  1507     CALL 'kxdfhei1' USING DFHEIV0,
  1508           DFHEIV1,
  1509           WS-MESS003-PASS-AREA,
  1510           ws-mess003-length,
  1511           DFHEIV99,
  1512           DFHEIV99,
  1513           DFHEIV99,
  1514           DFHEIV99
  1515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1516
  1517
  1518     .
  1519 3000-exit.
  1520     exit.
  1521 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  28
* SOCK08.cbl
  1522
  1523* EXEC CICS LINK
  1524*         PROGRAM  ('ELDATCV')
  1525*         COMMAREA (DATE-CONVERSION-DATA)
  1526*         LENGTH   (DC-COMM-LENGTH)
  1527*    END-EXEC.
  1528     MOVE 'ELDATCV' TO DFHEIV1
  1529*    MOVE '."C                   (   #00001359' TO DFHEIV0
  1530     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1531     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1532     MOVE X'2020233030303031333539' TO DFHEIV0(25:11)
  1533     CALL 'kxdfhei1' USING DFHEIV0,
  1534           DFHEIV1,
  1535           DATE-CONVERSION-DATA,
  1536           DC-COMM-LENGTH,
  1537           DFHEIV99,
  1538           DFHEIV99,
  1539           DFHEIV99,
  1540           DFHEIV99
  1541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1542
  1543 9700-EXIT.
  1544      EXIT.
  1545
  1546 9999-DFHBACK SECTION.
  1547     MOVE '9%                    "   ' TO DFHEIV0
  1548     MOVE 'SOCK08' TO DFHEIV1
  1549     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1550     GOBACK.
  1551 9999-DFHEXIT.
  1552     IF DFHEIGDJ EQUAL 0001
  1553         NEXT SENTENCE.
  1554     MOVE '9%                    "   ' TO DFHEIV0
  1555     MOVE 'SOCK08' TO DFHEIV1
  1556     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1557     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      143504     Code:        2797
