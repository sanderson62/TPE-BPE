* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6523.cbl
* Options: int("EL6523.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6523.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6523.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6523.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6523.
     3*              PROGRAM CONVERTED BY
     4*              COBOL CONVERSION AID PO 5785-ABJ
     5*              CONVERSION DATE 02/14/96 11:58:19.
     6*                            VMOD=2.005
     7*
     8*AUTHOR.     LOGIC,INC.
     9*            DALLAS, TEXAS.
    10*DATE-COMPILED.
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6523.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    17*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    18*            *                                                   *
    19*            *****************************************************
    20*REMARKS.    TRANSACTION - EXDD - DISPLAY BANK
    21*                                 CROSS REFERENCE RECORDS.
    22 ENVIRONMENT DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6523.cbl
    24 DATA DIVISION.
    25 WORKING-STORAGE SECTION.
    26 01  DFH-START PIC X(04).
    27 77  FILLER  PIC X(32)  VALUE '********************************'.
    28 77  FILLER  PIC X(32)  VALUE '*    EL6523 WORKING STORAGE    *'.
    29 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    30 77  NDX     PIC S9(5)  COMP-3 VALUE +1.
    31 77  WSUB1   PIC S9(5)  COMP-3 VALUE +0.
    32 77  WSUB2   PIC S9(5)  COMP-3 VALUE +0.
    33 77  WSUB3   PIC S9(5)  COMP-3 VALUE +0.
    34 01  WS-WORK-ACCT-TABLE.
    35     12  WS-BANKS OCCURS 725.
    36         16  WS-AM-ACCOUNT       PIC X(10).
    37         16  WS-AM-EXP-DT        PIC XX.
    38         16  WS-AM-EFF-DT        PIC XX.
    39         16  WS-AM-STATE         PIC XX.
    40         16  FILLER              PIC X(20).
    41 01  WS-DATE-AREA.
    42     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    43     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
    44 01  WS-CONTROL-PRIMARY.
    45     05  WS-COMPANY-CD       PIC X.
    46     05  WS-CARRIER          PIC X.
    47     05  WS-GROUPING         PIC X(6).
    48     05  WS-BANK             PIC X(10).
    49     05  WS-OPEN-COUNT       PIC S9(4)    COMP-3 VALUE ZEROS.
    50*                            COPY ELCATTR SUPPRESS.
    51******************************************************************
    52*                                                                *
    53*                            ELCATTR.                            *
    54*                            VMOD=2.001                          *
    55*                                                                *
    56*             LIST OF STANDARD ATTRIBUTE VALUES                  *
    57*                                                                *
    58*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
    59*                                                                *
    60*                   POS 1   P=PROTECTED                          *
    61*                           U=UNPROTECTED                        *
    62*                           S=ASKIP                              *
    63*                   POS 2   A=ALPHA/NUMERIC                      *
    64*                           N=NUMERIC                            *
    65*                   POS 3   N=NORMAL                             *
    66*                           B=BRIGHT                             *
    67*                           D=DARK                               *
    68*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
    69*                           OF=MODIFIED DATA TAG OFF             *
    70*                                                                *
    71*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
    72******************************************************************
    73 01  ATTRIBUTE-LIST.
    74     12  AL-PABOF            PIC X       VALUE 'Y'.
    75     12  AL-PABON            PIC X       VALUE 'Z'.
    76     12  AL-PADOF            PIC X       VALUE '%'.
    77     12  AL-PADON            PIC X       VALUE '_'.
    78     12  AL-PANOF            PIC X       VALUE '-'.
    79     12  AL-PANON            PIC X       VALUE '/'.
    80     12  AL-SABOF            PIC X       VALUE '8'.
    81     12  AL-SABON            PIC X       VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6523.cbl
    82     12  AL-SADOF            PIC X       VALUE '@'.
    83     12  AL-SADON            PIC X       VALUE QUOTE.
    84     12  AL-SANOF            PIC X       VALUE '0'.
    85     12  AL-SANON            PIC X       VALUE '1'.
    86     12  AL-UABOF            PIC X       VALUE 'H'.
    87     12  AL-UABON            PIC X       VALUE 'I'.
    88     12  AL-UADOF            PIC X       VALUE '<'.
    89     12  AL-UADON            PIC X       VALUE '('.
    90     12  AL-UANOF            PIC X       VALUE ' '.
    91     12  AL-UANON            PIC X       VALUE 'A'.
    92     12  AL-UNBOF            PIC X       VALUE 'Q'.
    93     12  AL-UNBON            PIC X       VALUE 'R'.
    94     12  AL-UNDOF            PIC X       VALUE '*'.
    95     12  AL-UNDON            PIC X       VALUE ')'.
    96     12  AL-UNNOF            PIC X       VALUE '&'.
    97     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6523.cbl
    99 01  ERROR-MESSAGES.
   100     12  ER-0000                 PIC X(4)  VALUE '0000'.
   101     12  ER-0004                 PIC X(4)  VALUE '0004'.
   102     12  ER-0029                 PIC X(4)  VALUE '0029'.
   103     12  ER-0033                 PIC X(4)  VALUE '0033'.
   104     12  ER-0034                 PIC X(4)  VALUE '0034'.
   105     12  ER-0068                 PIC X(4)  VALUE '0068'.
   106     12  ER-0070                 PIC X(4)  VALUE '0070'.
   107     12  ER-0130                 PIC X(4)  VALUE '0130'.
   108     12  ER-0131                 PIC X(4)  VALUE '0131'.
   109     12  ER-0142                 PIC X(4)  VALUE '0142'.
   110     12  ER-0193                 PIC X(4)  VALUE '0193'.
   111     12  ER-0226                 PIC X(4)  VALUE '0226'.
   112     12  ER-0234                 PIC X(4)  VALUE '0234'.
   113     12  ER-0235                 PIC X(4)  VALUE '0235'.
   114     12  ER-0348                 PIC X(4)  VALUE '0348'.
   115     12  ER-0454                 PIC X(4)  VALUE '0454'.
   116     12  ER-1162                 PIC X(4)  VALUE '1162'.
   117     12  ER-1164                 PIC X(4)  VALUE '1164'.
   118     12  ER-1299                 PIC X(4)  VALUE '1299'.
   119     12  ER-2039                 PIC X(4)  VALUE '2039'.
   120     12  ER-2056                 PIC X(4)  VALUE '2056'.
   121     12  ER-2057                 PIC X(4)  VALUE '2057'.
   122     12  ER-2237                 PIC X(4)  VALUE '2237'.
   123     12  ER-2238                 PIC X(4)  VALUE '2238'.
   124     12  ER-2339                 PIC X(4)  VALUE '2339'.
   125     12  ER-2370                 PIC X(4)  VALUE '2370'.
   126     12  ER-2947                 PIC X(4)  VALUE '2947'.
   127     12  ER-3112                 PIC X(4)  VALUE '3112'.
   128     12  ER-5004                 PIC X(4)  VALUE '5004'.
   129     12  ER-5005                 PIC X(4)  VALUE '5005'.
   130     12  ER-6508                 PIC X(4)  VALUE '6508'.
   131*                          COPY ELCSCTM.
   132******************************************************************
   133*                                                                *
   134*                                                                *
   135*                            ELCSCTM                             *
   136*                            VMOD=2.001                          *
   137*                                                                *
   138*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   139*                                                                *
   140******************************************************************
   141 01  SECURITY-MESSAGE.
   142     12  FILLER                          PIC X(30)
   143            VALUE '** LOGIC SECURITY VIOLATION -'.
   144     12  SM-READ                         PIC X(6).
   145     12  FILLER                          PIC X(5)
   146            VALUE ' PGM='.
   147     12  SM-PGM                          PIC X(6).
   148     12  FILLER                          PIC X(5)
   149            VALUE ' OPR='.
   150     12  SM-PROCESSOR-ID                 PIC X(4).
   151     12  FILLER                          PIC X(6)
   152            VALUE ' TERM='.
   153     12  SM-TERMID                       PIC X(4).
   154     12  FILLER                          PIC XX   VALUE SPACE.
   155     12  SM-JUL-DATE                     PIC 9(5).
   156     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6523.cbl
   157     12  SM-TIME                         PIC 99.99.
   158
   159*                          COPY ELCSCRTY.
   160******************************************************************
   161*                                                                *
   162*                                                                *
   163*                            ELCSCRTY                            *
   164*                            VMOD=2.001                          *
   165*                                                                *
   166*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   167*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   168*        SAVED IN PI-SECURITY-ADDRESS.                           *
   169*                                                                *
   170******************************************************************
   171 01  SECURITY-CONTROL.
   172     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   173     12  FILLER                       PIC XX    VALUE 'SC'.
   174     12  SC-CREDIT-CODES.
   175         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   176             20  SC-CREDIT-DISPLAY    PIC X.
   177             20  SC-CREDIT-UPDATE     PIC X.
   178     12  SC-CLAIMS-CODES.
   179         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   180             20  SC-CLAIMS-DISPLAY    PIC X.
   181             20  SC-CLAIMS-UPDATE     PIC X.
   182 01  STANDARD-AREAS.
   183     12  WS-ERACCT-KEY.
   184         16  WS-ERACCT-COMP-CD   PIC X.
   185         16  WS-ERACCT-CARRIER   PIC X.
   186         16  WS-ERACCT-GROUPING  PIC X(6).
   187         16  WS-ERACCT-STATE     PIC XX.
   188         16  WS-ERACCT-ACCOUNT   PIC X(10).
   189         16  WS-ERACCT-EXP-DT    PIC XX.
   190         16  FILLER              PIC X(4).
   191     12  WS-RESPONSE             PIC S9(8)   COMP.
   192         88  RESP-NORMAL                  VALUE +00.
   193         88  RESP-NOTFND                  VALUE +13.
   194         88  RESP-NOTOPEN                 VALUE +19.
   195         88  RESP-ENDFILE                 VALUE +20.
   196     12  WS-CHANGE-SW            PIC X  VALUE ' '.
   197         88  CHANGES-MADE               VALUE 'Y'.
   198         88  NO-CHANGES-MADE            VALUE 'N'.
   199     12  WS-LINE-CHANGE-SW       PIC X  VALUE ' '.
   200         88  LINE-CHANGES               VALUE 'Y'.
   201         88  NO-LINE-CHANGES            VALUE 'N'.
   202     12  GETMAIN-SPACE           PIC X     VALUE SPACE.
   203     12  WS-DEEDIT-FIELD         PIC X(10) VALUE SPACES.
   204     12  WS-DT-DEEDIT-FIELD REDEFINES WS-DEEDIT-FIELD
   205                                      PIC X(10).
   206     12  WS-DEEDIT-FIELD-DATE REDEFINES WS-DT-DEEDIT-FIELD.
   207         16  FILLER                   PIC X(4).
   208         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   209     12  SC-ITEM-CL-CR       PIC S9(4)         VALUE +1   COMP.
   210     12  WS-ACCESS.
   211         16  FILLER          PIC  X(3)         VALUE SPACES.
   212         16  WS-ACARRIER     PIC  X.
   213     12  ELCNTL-KEY.
   214         16  CNTL-COMP-ID    PIC  X(3)         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6523.cbl
   215         16  CNTL-REC-TYPE   PIC  X            VALUE SPACES.
   216         16  CNTL-ACCESS     PIC  X(4)         VALUE SPACES.
   217         16  CNTL-SEQ-NO     PIC S9(4)         VALUE +0   COMP.
   218     12  QID.
   219         16  QID-TERM        PIC X(4).
   220         16  FILLER          PIC X(4)    VALUE '652D'.
   221     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   222     12  QID-MAP-LENGTH      PIC S9(4)   VALUE +1376   COMP.
   223     12  MAP-NAME                PIC X(8)    VALUE 'EL652D'.
   224     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6523S'.
   225     12  TRANS-ID                PIC X(4)    VALUE 'EXDD'.
   226     12  EL652-TRANS-ID          PIC X(4)    VALUE 'EXD4'.
   227     12  EL650-TRANS-ID          PIC X(4)    VALUE 'EXC4'.
   228     12  PGM-NAME                PIC X(8)    VALUE SPACES.
   229     12  THIS-PGM                PIC X(8)    VALUE 'EL6523'.
   230     12  XCTL-650                PIC X(8)    VALUE 'EL650'.
   231     12  BXRF-FILE-ID            PIC X(8)    VALUE 'ERBXRF'.
   232     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   233     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   234     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   235     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   236     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   237     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   238     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   239     12  TIME-IN                 PIC S9(7).
   240     12  TIME-OUT-R   REDEFINES TIME-IN.
   241         16  FILLER              PIC X.
   242         16  TIME-OUT            PIC 99V99.
   243         16  FILLER              PIC X(2).
   244     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   245         88  BROWSE-STARTED      VALUE 'Y'.
   246 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   247     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   248     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   249*                                COPY ELCDATE.
   250******************************************************************
   251*                                                                *
   252*                                                                *
   253*                            ELCDATE.                            *
   254*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   255*                            VMOD=2.003
   256*                                                                *
   257*                                                                *
   258*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   259*                 LENGTH = 200                                   *
   260******************************************************************
   261
   262 01  DATE-CONVERSION-DATA.
   263     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   264     12  DC-OPTION-CODE                PIC X.
   265         88  BIN-TO-GREG                VALUE ' '.
   266         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   267         88  EDIT-GREG-TO-BIN           VALUE '2'.
   268         88  YMD-GREG-TO-BIN            VALUE '3'.
   269         88  MDY-GREG-TO-BIN            VALUE '4'.
   270         88  JULIAN-TO-BIN              VALUE '5'.
   271         88  BIN-PLUS-ELAPSED           VALUE '6'.
   272         88  FIND-CENTURY               VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6523.cbl
   273         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   274         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   275         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   276         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   277         88  JULIAN-TO-BIN-3            VALUE 'C'.
   278         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   279         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   280         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   281         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   282         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   283         88  CHECK-LEAP-YEAR            VALUE 'H'.
   284         88  BIN-3-TO-GREG              VALUE 'I'.
   285         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   286         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   287         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   288         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   289         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   290         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   291         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   292         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   293         88  THREE-CHARACTER-BIN
   294                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   295         88  GREGORIAN-TO-BIN
   296                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   297         88  BIN-TO-GREGORIAN
   298                  VALUES ' ' '1' 'I' '8' 'G'.
   299         88  JULIAN-TO-BINARY
   300                  VALUES '5' 'C' 'E' 'F'.
   301     12  DC-ERROR-CODE                 PIC X.
   302         88  NO-CONVERSION-ERROR        VALUE ' '.
   303         88  DATE-CONVERSION-ERROR
   304                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   305         88  DATE-IS-ZERO               VALUE '1'.
   306         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   307         88  DATE-IS-INVALID            VALUE '3'.
   308         88  DATE1-GREATER-DATE2        VALUE '4'.
   309         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   310         88  DATE-INVALID-OPTION        VALUE '9'.
   311         88  INVALID-CENTURY            VALUE 'A'.
   312         88  ONLY-CENTURY               VALUE 'B'.
   313         88  ONLY-LEAP-YEAR             VALUE 'C'.
   314         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   315     12  DC-END-OF-MONTH               PIC X.
   316         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   317     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   318         88  USE-NORMAL-PROCESS         VALUE ' '.
   319         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   320         88  ADJUST-UP-100-YRS          VALUE '2'.
   321     12  FILLER                        PIC X.
   322     12  DC-CONVERSION-DATES.
   323         16  DC-BIN-DATE-1             PIC XX.
   324         16  DC-BIN-DATE-2             PIC XX.
   325         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   326         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   327                       DC-GREG-DATE-1-EDIT.
   328             20  DC-EDIT1-MONTH        PIC 99.
   329             20  SLASH1-1              PIC X.
   330             20  DC-EDIT1-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6523.cbl
   331             20  SLASH1-2              PIC X.
   332             20  DC-EDIT1-YEAR         PIC 99.
   333         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   334         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   335                     DC-GREG-DATE-2-EDIT.
   336             20  DC-EDIT2-MONTH        PIC 99.
   337             20  SLASH2-1              PIC X.
   338             20  DC-EDIT2-DAY          PIC 99.
   339             20  SLASH2-2              PIC X.
   340             20  DC-EDIT2-YEAR         PIC 99.
   341         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   342         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   343                     DC-GREG-DATE-1-YMD.
   344             20  DC-YMD-YEAR           PIC 99.
   345             20  DC-YMD-MONTH          PIC 99.
   346             20  DC-YMD-DAY            PIC 99.
   347         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   348         16  DC-GREG-DATE-1-MDY-R REDEFINES
   349                      DC-GREG-DATE-1-MDY.
   350             20  DC-MDY-MONTH          PIC 99.
   351             20  DC-MDY-DAY            PIC 99.
   352             20  DC-MDY-YEAR           PIC 99.
   353         16  DC-GREG-DATE-1-ALPHA.
   354             20  DC-ALPHA-MONTH        PIC X(10).
   355             20  DC-ALPHA-DAY          PIC 99.
   356             20  FILLER                PIC XX.
   357             20  DC-ALPHA-CENTURY.
   358                 24 DC-ALPHA-CEN-N     PIC 99.
   359             20  DC-ALPHA-YEAR         PIC 99.
   360         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   361         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   362         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   363         16  DC-JULIAN-DATE            PIC 9(05).
   364         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   365                                       PIC 9(05).
   366         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   367             20  DC-JULIAN-YEAR        PIC 99.
   368             20  DC-JULIAN-DAYS        PIC 999.
   369         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   370         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   371         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   372     12  DATE-CONVERSION-VARIBLES.
   373         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   374         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   375             20  FILLER                PIC 9(3).
   376             20  HOLD-CEN-1-CCYY.
   377                 24  HOLD-CEN-1-CC     PIC 99.
   378                 24  HOLD-CEN-1-YY     PIC 99.
   379             20  HOLD-CEN-1-MO         PIC 99.
   380             20  HOLD-CEN-1-DA         PIC 99.
   381         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   382             20  HOLD-CEN-1-R-MO       PIC 99.
   383             20  HOLD-CEN-1-R-DA       PIC 99.
   384             20  HOLD-CEN-1-R-CCYY.
   385                 24  HOLD-CEN-1-R-CC   PIC 99.
   386                 24  HOLD-CEN-1-R-YY   PIC 99.
   387             20  FILLER                PIC 9(3).
   388         16  HOLD-CENTURY-1-X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6523.cbl
   389             20  FILLER                PIC X(3)  VALUE SPACES.
   390             20  HOLD-CEN-1-X-CCYY.
   391                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   392                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   393             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   394             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   395         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   396             20  HOLD-CEN-1-R-X-MO     PIC XX.
   397             20  HOLD-CEN-1-R-X-DA     PIC XX.
   398             20  HOLD-CEN-1-R-X-CCYY.
   399                 24  HOLD-CEN-1-R-X-CC PIC XX.
   400                 24  HOLD-CEN-1-R-X-YY PIC XX.
   401             20  FILLER                PIC XXX.
   402         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   403         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   404         16  DC-JULIAN-DATE-1          PIC 9(07).
   405         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   406             20  DC-JULIAN-1-CCYY.
   407                 24  DC-JULIAN-1-CC    PIC 99.
   408                 24  DC-JULIAN-1-YR    PIC 99.
   409             20  DC-JULIAN-DA-1        PIC 999.
   410         16  DC-JULIAN-DATE-2          PIC 9(07).
   411         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   412             20  DC-JULIAN-2-CCYY.
   413                 24  DC-JULIAN-2-CC    PIC 99.
   414                 24  DC-JULIAN-2-YR    PIC 99.
   415             20  DC-JULIAN-DA-2        PIC 999.
   416         16  DC-GREG-DATE-A-EDIT.
   417             20  DC-EDITA-MONTH        PIC 99.
   418             20  SLASHA-1              PIC X VALUE '/'.
   419             20  DC-EDITA-DAY          PIC 99.
   420             20  SLASHA-2              PIC X VALUE '/'.
   421             20  DC-EDITA-CCYY.
   422                 24  DC-EDITA-CENT     PIC 99.
   423                 24  DC-EDITA-YEAR     PIC 99.
   424         16  DC-GREG-DATE-B-EDIT.
   425             20  DC-EDITB-MONTH        PIC 99.
   426             20  SLASHB-1              PIC X VALUE '/'.
   427             20  DC-EDITB-DAY          PIC 99.
   428             20  SLASHB-2              PIC X VALUE '/'.
   429             20  DC-EDITB-CCYY.
   430                 24  DC-EDITB-CENT     PIC 99.
   431                 24  DC-EDITB-YEAR     PIC 99.
   432         16  DC-GREG-DATE-CYMD         PIC 9(08).
   433         16  DC-GREG-DATE-CYMD-R REDEFINES
   434                              DC-GREG-DATE-CYMD.
   435             20  DC-CYMD-CEN           PIC 99.
   436             20  DC-CYMD-YEAR          PIC 99.
   437             20  DC-CYMD-MONTH         PIC 99.
   438             20  DC-CYMD-DAY           PIC 99.
   439         16  DC-GREG-DATE-MDCY         PIC 9(08).
   440         16  DC-GREG-DATE-MDCY-R REDEFINES
   441                              DC-GREG-DATE-MDCY.
   442             20  DC-MDCY-MONTH         PIC 99.
   443             20  DC-MDCY-DAY           PIC 99.
   444             20  DC-MDCY-CEN           PIC 99.
   445             20  DC-MDCY-YEAR          PIC 99.
   446    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6523.cbl
   447        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   448    12  DC-EL310-DATE                  PIC X(21).
   449    12  FILLER                         PIC X(28).
   450*                                COPY ELCEMIB SUPPRESS.
   451******************************************************************
   452*                                                                *
   453*                                                                *
   454*                            ELCEMIB.                            *
   455*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   456*                            VMOD=2.005                          *
   457*                                                                *
   458*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   459*                                                                *
   460******************************************************************
   461 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   462     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   463     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   464     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   465     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   466     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   467     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   468     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   469     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   470     12  EMI-SWITCH1             PIC X        VALUE '1'.
   471         88  EMI-NO-ERRORS                    VALUE '1'.
   472         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   473         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   474     12  EMI-SWITCH2             PIC X        VALUE '1'.
   475         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   476     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   477         88  EMI-AREA1-EMPTY                  VALUE '1'.
   478         88  EMI-AREA1-FULL                   VALUE '2'.
   479     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   480         88  EMI-AREA2-EMPTY                  VALUE '1'.
   481         88  EMI-AREA2-FULL                   VALUE '2'.
   482     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   483         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   484         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   485         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   486         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   487         88  EMI-BYPASS-FATALS                VALUE 'X'.
   488     12  EMI-ERROR-LINES.
   489         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   490         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   491         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   492         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   493             20  EMI-ERR-CODES OCCURS 10 TIMES.
   494                 24  EMI-ERR-NUM         PIC X(4).
   495                 24  EMI-FILLER          PIC X.
   496                 24  EMI-SEV             PIC X.
   497                 24  FILLER              PIC X.
   498             20  FILLER                  PIC X(02).
   499     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   500         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   501             20  EMI-ERROR-NUMBER    PIC X(4).
   502             20  EMI-FILL            PIC X.
   503             20  EMI-SEVERITY        PIC X.
   504             20  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6523.cbl
   505             20  EMI-ERROR-TEXT.
   506                 24  EMI-TEXT-VARIABLE   PIC X(10).
   507                 24  FILLER          PIC X(55).
   508     12  EMI-SEVERITY-SAVE           PIC X.
   509         88  EMI-NOTE                    VALUE 'N'.
   510         88  EMI-WARNING                 VALUE 'W'.
   511         88  EMI-FORCABLE                VALUE 'F'.
   512         88  EMI-FATAL                   VALUE 'X'.
   513     12  EMI-MESSAGE-FLAG            PIC X.
   514         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   515         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   516     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   517     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   518         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   519         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   520         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   521     12  FILLER                      PIC X(137)  VALUE SPACES.
   522     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   523     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   524     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   525     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   526*                  COPY ELCLOGOF SUPPRESS.
   527******************************************************************
   528*                                                                *
   529*                                                                *
   530*                            ELCLOGOF.                           *
   531*                            VMOD=2.001                          *
   532*                                                                *
   533*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   534*                                                                *
   535******************************************************************
   536 01  CLASIC-LOGOFF.
   537     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   538     12  LOGOFF-TEXT.
   539         16  FILLER          PIC X(5)    VALUE SPACES.
   540         16  LOGOFF-MSG.
   541             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   542             20  FILLER      PIC X       VALUE SPACES.
   543             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   544         16  FILLER          PIC X(80)
   545           VALUE '* YOU ARE NOW LOGGED OFF'.
   546         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   547         16  FILLER          PIC X       VALUE QUOTE.
   548         16  LOGOFF-SYS-MSG  PIC X(17)
   549           VALUE 'S CLAS-IC SYSTEM '.
   550     12  TEXT-MESSAGES.
   551         16  UNACCESS-MSG    PIC X(29)
   552             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   553         16  PGMIDERR-MSG    PIC X(17)
   554             VALUE 'PROGRAM NOT FOUND'.
   555*                                COPY ELCINTF.
   556******************************************************************
   557*                                                                *
   558*                                                                *
   559*                            ELCINTF.                            *
   560*                            VMOD=2.017                          *
   561*                                                                *
   562*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6523.cbl
   563*                                                                *
   564*       LENGTH = 1024                                            *
   565*                                                                *
   566******************************************************************
   567 01  PROGRAM-INTERFACE-BLOCK.
   568     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   569     12  PI-CALLING-PROGRAM              PIC X(8).
   570     12  PI-SAVED-PROGRAM-1              PIC X(8).
   571     12  PI-SAVED-PROGRAM-2              PIC X(8).
   572     12  PI-SAVED-PROGRAM-3              PIC X(8).
   573     12  PI-SAVED-PROGRAM-4              PIC X(8).
   574     12  PI-SAVED-PROGRAM-5              PIC X(8).
   575     12  PI-SAVED-PROGRAM-6              PIC X(8).
   576     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   577     12  PI-COMPANY-ID                   PIC XXX.
   578     12  PI-COMPANY-CD                   PIC X.
   579
   580     12  PI-COMPANY-PASSWORD             PIC X(8).
   581
   582     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   583
   584     12  PI-CONTROL-IN-PROGRESS.
   585         16  PI-CARRIER                  PIC X.
   586         16  PI-GROUPING                 PIC X(6).
   587         16  PI-STATE                    PIC XX.
   588         16  PI-ACCOUNT                  PIC X(10).
   589         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   590                                         PIC X(10).
   591         16  PI-CLAIM-CERT-GRP.
   592             20  PI-CLAIM-NO             PIC X(7).
   593             20  PI-CERT-NO.
   594                 25  PI-CERT-PRIME       PIC X(10).
   595                 25  PI-CERT-SFX         PIC X.
   596             20  PI-CERT-EFF-DT          PIC XX.
   597         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   598             20  PI-PLAN-CODE            PIC X(2).
   599             20  PI-REVISION-NUMBER      PIC X(3).
   600             20  PI-PLAN-EFF-DT          PIC X(2).
   601             20  PI-PLAN-EXP-DT          PIC X(2).
   602             20  FILLER                  PIC X(11).
   603         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   604             20  PI-OE-REFERENCE-1.
   605                 25  PI-OE-REF-1-PRIME   PIC X(18).
   606                 25  PI-OE-REF-1-SUFF    PIC XX.
   607
   608     12  PI-SESSION-IN-PROGRESS          PIC X.
   609         88  CLAIM-SESSION                   VALUE '1'.
   610         88  CREDIT-SESSION                  VALUE '2'.
   611         88  WARRANTY-SESSION                VALUE '3'.
   612         88  MORTGAGE-SESSION                VALUE '4'.
   613         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   614
   615
   616*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   617
   618     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   619     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   620
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6523.cbl
   621     12  PI-CREDIT-USER                  PIC X.
   622         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   623         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   624
   625     12  PI-CLAIM-USER                   PIC X.
   626         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   627         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   628
   629     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   630         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   631         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   632         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   633         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   634         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   635
   636     12  PI-PROCESSOR-ID                 PIC X(4).
   637
   638     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   639
   640     12  PI-MEMBER-CAPTION               PIC X(10).
   641
   642     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   643         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   644
   645     12  PI-LIFE-OVERRIDE-L1             PIC X.
   646     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   647     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   648     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   649
   650     12  PI-AH-OVERRIDE-L1               PIC X.
   651     12  PI-AH-OVERRIDE-L2               PIC XX.
   652     12  PI-AH-OVERRIDE-L6               PIC X(6).
   653     12  PI-AH-OVERRIDE-L12              PIC X(12).
   654
   655     12  PI-NEW-SYSTEM                   PIC X(2).
   656
   657     12  PI-PRIMARY-CERT-NO              PIC X(11).
   658     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   659         88  PI-USES-PAID-TO                 VALUE '1'.
   660     12  PI-CRDTCRD-SYSTEM.
   661         16  PI-CRDTCRD-USER             PIC X.
   662             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   663             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   664         16  PI-CC-MONTH-END-DT          PIC XX.
   665     12  PI-PROCESSOR-PRINTER            PIC X(4).
   666
   667     12  PI-OE-REFERENCE-2.
   668         16  PI-OE-REF-2-PRIME           PIC X(10).
   669         16  PI-OE-REF-2-SUFF            PIC X.
   670
   671     12  PI-REM-TRM-CALC-OPTION          PIC X.
   672
   673     12  PI-LANGUAGE-TYPE                PIC X.
   674             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   675             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   676             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   677
   678     12  PI-POLICY-LINKAGE-IND           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6523.cbl
   679         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   680         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   681                                                   LOW-VALUES.
   682
   683     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   684     12  PI-CLAIM-PW-SESSION             PIC X(1).
   685         88  PI-CLAIM-CREDIT                 VALUE '1'.
   686         88  PI-CLAIM-CONVEN                 VALUE '2'.
   687     12  FILLER                          PIC X(4).
   688
   689     12  PI-SYSTEM-LEVEL                 PIC X(145).
   690
   691     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   692         PI-SYSTEM-LEVEL.
   693
   694         16  PI-ENTRY-CODES.
   695             20  PI-ENTRY-CD-1           PIC X.
   696             20  PI-ENTRY-CD-2           PIC X.
   697
   698         16  PI-RETURN-CODES.
   699             20  PI-RETURN-CD-1          PIC X.
   700             20  PI-RETURN-CD-2          PIC X.
   701
   702         16  PI-UPDATE-STATUS-SAVE.
   703             20  PI-UPDATE-BY            PIC X(4).
   704             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   705
   706         16  PI-LOWER-CASE-LETTERS       PIC X.
   707             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   708
   709*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   710*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   711*            88  CARRIER-CLM-CNTL            VALUE '2'.
   712
   713         16  PI-CERT-ACCESS-CONTROL      PIC X.
   714             88  ST-ACCNT-CNTL               VALUE ' '.
   715             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   716             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   717             88  ACCNT-CNTL                  VALUE '3'.
   718             88  CARR-ACCNT-CNTL             VALUE '4'.
   719
   720         16  PI-PROCESSOR-CAP-LIST.
   721             20  PI-SYSTEM-CONTROLS.
   722                24 PI-SYSTEM-DISPLAY     PIC X.
   723                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   724                24 PI-SYSTEM-MODIFY      PIC X.
   725                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   726             20  FILLER                  PIC XX.
   727             20  PI-DISPLAY-CAP          PIC X.
   728                 88  DISPLAY-CAP             VALUE 'Y'.
   729             20  PI-MODIFY-CAP           PIC X.
   730                 88  MODIFY-CAP              VALUE 'Y'.
   731             20  PI-MSG-AT-LOGON-CAP     PIC X.
   732                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   733             20  PI-FORCE-CAP            PIC X.
   734                 88  FORCE-CAP               VALUE 'Y'.
   735
   736         16  PI-PROGRAM-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6523.cbl
   737             20  PI-PGM-PRINT-OPT        PIC X.
   738             20  PI-PGM-FORMAT-OPT       PIC X.
   739             20  PI-PGM-PROCESS-OPT      PIC X.
   740             20  PI-PGM-TOTALS-OPT       PIC X.
   741
   742         16  PI-HELP-INTERFACE.
   743             20  PI-LAST-ERROR-NO        PIC X(4).
   744             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   745
   746         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   747             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   748
   749         16  PI-CR-CONTROL-IN-PROGRESS.
   750             20  PI-CR-CARRIER           PIC X.
   751             20  PI-CR-GROUPING          PIC X(6).
   752             20  PI-CR-STATE             PIC XX.
   753             20  PI-CR-ACCOUNT           PIC X(10).
   754             20  PI-CR-FIN-RESP          PIC X(10).
   755             20  PI-CR-TYPE              PIC X.
   756
   757         16  PI-CR-BATCH-NUMBER          PIC X(6).
   758
   759         16  PI-CR-MONTH-END-DT          PIC XX.
   760
   761         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   762             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   763             88  PI-ZERO-CARRIER             VALUE '1'.
   764             88  PI-ZERO-GROUPING            VALUE '2'.
   765             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   766
   767         16  PI-CARRIER-SECURITY         PIC X.
   768             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   769
   770         16  PI-ACCOUNT-SECURITY         PIC X(10).
   771             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   772             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   773
   774         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   775             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   776                                         INDEXED BY PI-ACCESS-NDX
   777                                         PIC X.
   778
   779         16  PI-GA-BILLING-CONTROL       PIC X.
   780             88  PI-GA-BILLING               VALUE '1'.
   781
   782         16  PI-MAIL-PROCESSING          PIC X.
   783             88  PI-MAIL-YES                 VALUE 'Y'.
   784
   785         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   786
   787         16  PI-AR-SYSTEM.
   788             20  PI-AR-PROCESSING-CNTL   PIC X.
   789                 88  PI-AR-PROCESSING        VALUE 'Y'.
   790             20  PI-AR-SUMMARY-CODE      PIC X(6).
   791             20  PI-AR-MONTH-END-DT      PIC XX.
   792
   793         16  PI-MP-SYSTEM.
   794             20  PI-MORTGAGE-USER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6523.cbl
   795                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   796                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   797             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   798                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   799                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   800                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   801                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   802                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   803             20  PI-MP-MONTH-END-DT          PIC XX.
   804             20  PI-MP-REFERENCE-NO.
   805                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   806                 24  PI-MP-REFERENCE-SFX     PIC XX.
   807
   808         16  PI-LABEL-CONTROL            PIC X(01).
   809             88  PI-CREATE-LABELS                    VALUE 'Y'.
   810             88  PI-BYPASS-LABELS                    VALUE 'N'.
   811
   812         16  PI-BILL-GROUPING-CODE       PIC X(01).
   813             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   814
   815         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   816             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   817             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   818
   819         16  FILLER                      PIC X(14).
   820
   821     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   822******************************************************************
   823     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   824         16  PI-ERBXRF-KEY.
   825             20  PI-BXRF-COMP-CD     PIC X.
   826             20  PI-BXRF-CARRIER     PIC X.
   827             20  PI-BXRF-GROUPING    PIC X(6).
   828             20  PI-BXRF-BANK        PIC X(10).
   829         16  PI-TOP-NDX              PIC S9(5)  COMP-3.
   830         16  PI-NDX                  PIC S9(5)  COMP-3.
   831         16  PI-EOF-SW               PIC X.
   832             88  PI-FILE-EOF             VALUE 'Y'.
   833         16  PI-CHECK-MAINT-TYPE     PIC  X.
   834             88  VALID-MAINT-TYPE            VALUE 'S' 'A'
   835                                                   'C' 'D'.
   836             88  ADD-FUNCTION                VALUE 'A'.
   837             88  SHOW-FUNCTION               VALUE 'S'.
   838             88  DELETE-FUNCTION             VALUE 'D'.
   839             88  CHANGE-FUNCTION             VALUE 'C'.
   840         16  PI-ERC-KEY.
   841             20  PI-ERC-COMPANY-CD   PIC  X.
   842             20  PI-ERC-CARRIER      PIC  X.
   843             20  PI-ERC-GROUP        PIC  X(6).
   844             20  PI-ERC-BANK         PIC  X(10).
   845         16  PI-SAVE-ERBXRF-KEY      PIC  X(18).
   846         16  PI-EL6523-DEL-SW        PIC  X.
   847         16  FILLER                  PIC X(616).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6523.cbl
   849*                            COPY ELCAID SUPPRESS.
   850******************************************************************
   851*                                                                *
   852*                            ELCAID.                             *
   853*                            VMOD=2.001                          *
   854*                                                                *
   855*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   856*                                                                *
   857*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   858*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   859******************************************************************
   860
   861 01  DFHAID.
   862   02  DFHNULL   PIC  X  VALUE  ' '.
   863   02  DFHENTER  PIC  X  VALUE  QUOTE.
   864   02  DFHCLEAR  PIC  X  VALUE  '_'.
   865   02  DFHPEN    PIC  X  VALUE  '='.
   866   02  DFHOPID   PIC  X  VALUE  'W'.
   867   02  DFHPA1    PIC  X  VALUE  '%'.
   868   02  DFHPA2    PIC  X  VALUE  '>'.
   869   02  DFHPA3    PIC  X  VALUE  ','.
   870   02  DFHPF1    PIC  X  VALUE  '1'.
   871   02  DFHPF2    PIC  X  VALUE  '2'.
   872   02  DFHPF3    PIC  X  VALUE  '3'.
   873   02  DFHPF4    PIC  X  VALUE  '4'.
   874   02  DFHPF5    PIC  X  VALUE  '5'.
   875   02  DFHPF6    PIC  X  VALUE  '6'.
   876   02  DFHPF7    PIC  X  VALUE  '7'.
   877   02  DFHPF8    PIC  X  VALUE  '8'.
   878   02  DFHPF9    PIC  X  VALUE  '9'.
   879   02  DFHPF10   PIC  X  VALUE  ':'.
   880   02  DFHPF11   PIC  X  VALUE  '#'.
   881   02  DFHPF12   PIC  X  VALUE  '@'.
   882   02  DFHPF13   PIC  X  VALUE  'A'.
   883   02  DFHPF14   PIC  X  VALUE  'B'.
   884   02  DFHPF15   PIC  X  VALUE  'C'.
   885   02  DFHPF16   PIC  X  VALUE  'D'.
   886   02  DFHPF17   PIC  X  VALUE  'E'.
   887   02  DFHPF18   PIC  X  VALUE  'F'.
   888   02  DFHPF19   PIC  X  VALUE  'G'.
   889   02  DFHPF20   PIC  X  VALUE  'H'.
   890   02  DFHPF21   PIC  X  VALUE  'I'.
   891*00039    02  DFHPF22   PIC  X  VALUE  ''.
   892   02  DFHPF22   PIC  X  VALUE  '['.
   893   02  DFHPF23   PIC  X  VALUE  '.'.
   894   02  DFHPF24   PIC  X  VALUE  '<'.
   895   02  DFHMSRE   PIC  X  VALUE  'X'.
   896   02  DFHSTRF   PIC  X  VALUE  'h'.
   897   02  DFHTRIG   PIC  X  VALUE  '"'.
   898 01  FILLER    REDEFINES DFHAID.
   899     12  FILLER              PIC X(8).
   900     12  PF-VALUES           PIC X       OCCURS 24.
   901*                            COPY EL6523S.
   902 01  EL652DI.
   903     05  FILLER            PIC  X(0012).
   904*    -------------------------------
   905     05  TIMEL PIC S9(0004) COMP.
   906     05  TIMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6523.cbl
   907     05  FILLER REDEFINES TIMEF.
   908         10  TIMEA PIC  X(0001).
   909     05  TIMEI PIC  X(0005).
   910*    -------------------------------
   911     05  DATEL PIC S9(0004) COMP.
   912     05  DATEF PIC  X(0001).
   913     05  FILLER REDEFINES DATEF.
   914         10  DATEA PIC  X(0001).
   915     05  DATEI PIC  X(0008).
   916*    -------------------------------
   917     05  MAINTYPL PIC S9(0004) COMP.
   918     05  MAINTYPF PIC  X(0001).
   919     05  FILLER REDEFINES MAINTYPF.
   920         10  MAINTYPA PIC  X(0001).
   921     05  MAINTYPI PIC  X(0001).
   922*    -------------------------------
   923     05  CARRIERL PIC S9(0004) COMP.
   924     05  CARRIERF PIC  X(0001).
   925     05  FILLER REDEFINES CARRIERF.
   926         10  CARRIERA PIC  X(0001).
   927     05  CARRIERI PIC  X(0001).
   928*    -------------------------------
   929     05  GROUPL PIC S9(0004) COMP.
   930     05  GROUPF PIC  X(0001).
   931     05  FILLER REDEFINES GROUPF.
   932         10  GROUPA PIC  X(0001).
   933     05  GROUPI PIC  X(0006).
   934*    -------------------------------
   935     05  BANKL PIC S9(0004) COMP.
   936     05  BANKF PIC  X(0001).
   937     05  FILLER REDEFINES BANKF.
   938         10  BANKA PIC  X(0001).
   939     05  BANKI PIC  X(0010).
   940*    -------------------------------
   941     05  MAINTDTL PIC S9(0004) COMP.
   942     05  MAINTDTF PIC  X(0001).
   943     05  FILLER REDEFINES MAINTDTF.
   944         10  MAINTDTA PIC  X(0001).
   945     05  MAINTDTI PIC  X(0008).
   946*    -------------------------------
   947     05  TOTOPNL PIC S9(0004) COMP.
   948     05  TOTOPNF PIC  X(0001).
   949     05  FILLER REDEFINES TOTOPNF.
   950         10  TOTOPNA PIC  X(0001).
   951     05  TOTOPNI PIC  X(0005).
   952*    -------------------------------
   953     05  TOTOCCL PIC S9(0004) COMP.
   954     05  TOTOCCF PIC  X(0001).
   955     05  FILLER REDEFINES TOTOCCF.
   956         10  TOTOCCA PIC  X(0001).
   957     05  TOTOCCI PIC  X(0005).
   958*    -------------------------------
   959     05  ACCT01L PIC S9(0004) COMP.
   960     05  ACCT01F PIC  X(0001).
   961     05  FILLER REDEFINES ACCT01F.
   962         10  ACCT01A PIC  X(0001).
   963     05  ACCT01I PIC  X(0010).
   964*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6523.cbl
   965     05  EFFDT01L PIC S9(0004) COMP.
   966     05  EFFDT01F PIC  X(0001).
   967     05  FILLER REDEFINES EFFDT01F.
   968         10  EFFDT01A PIC  X(0001).
   969     05  EFFDT01I PIC  X(0008).
   970*    -------------------------------
   971     05  EXPDT01L PIC S9(0004) COMP.
   972     05  EXPDT01F PIC  X(0001).
   973     05  FILLER REDEFINES EXPDT01F.
   974         10  EXPDT01A PIC  X(0001).
   975     05  EXPDT01I PIC  X(0008).
   976*    -------------------------------
   977     05  STATE01L PIC S9(0004) COMP.
   978     05  STATE01F PIC  X(0001).
   979     05  FILLER REDEFINES STATE01F.
   980         10  STATE01A PIC  X(0001).
   981     05  STATE01I PIC  X(0002).
   982*    -------------------------------
   983     05  ACCT02L PIC S9(0004) COMP.
   984     05  ACCT02F PIC  X(0001).
   985     05  FILLER REDEFINES ACCT02F.
   986         10  ACCT02A PIC  X(0001).
   987     05  ACCT02I PIC  X(0010).
   988*    -------------------------------
   989     05  EFFDT02L PIC S9(0004) COMP.
   990     05  EFFDT02F PIC  X(0001).
   991     05  FILLER REDEFINES EFFDT02F.
   992         10  EFFDT02A PIC  X(0001).
   993     05  EFFDT02I PIC  X(0008).
   994*    -------------------------------
   995     05  EXPDT02L PIC S9(0004) COMP.
   996     05  EXPDT02F PIC  X(0001).
   997     05  FILLER REDEFINES EXPDT02F.
   998         10  EXPDT02A PIC  X(0001).
   999     05  EXPDT02I PIC  X(0008).
  1000*    -------------------------------
  1001     05  STATE02L PIC S9(0004) COMP.
  1002     05  STATE02F PIC  X(0001).
  1003     05  FILLER REDEFINES STATE02F.
  1004         10  STATE02A PIC  X(0001).
  1005     05  STATE02I PIC  X(0002).
  1006*    -------------------------------
  1007     05  ACCT03L PIC S9(0004) COMP.
  1008     05  ACCT03F PIC  X(0001).
  1009     05  FILLER REDEFINES ACCT03F.
  1010         10  ACCT03A PIC  X(0001).
  1011     05  ACCT03I PIC  X(0010).
  1012*    -------------------------------
  1013     05  EFFDT03L PIC S9(0004) COMP.
  1014     05  EFFDT03F PIC  X(0001).
  1015     05  FILLER REDEFINES EFFDT03F.
  1016         10  EFFDT03A PIC  X(0001).
  1017     05  EFFDT03I PIC  X(0008).
  1018*    -------------------------------
  1019     05  EXPDT03L PIC S9(0004) COMP.
  1020     05  EXPDT03F PIC  X(0001).
  1021     05  FILLER REDEFINES EXPDT03F.
  1022         10  EXPDT03A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6523.cbl
  1023     05  EXPDT03I PIC  X(0008).
  1024*    -------------------------------
  1025     05  STATE03L PIC S9(0004) COMP.
  1026     05  STATE03F PIC  X(0001).
  1027     05  FILLER REDEFINES STATE03F.
  1028         10  STATE03A PIC  X(0001).
  1029     05  STATE03I PIC  X(0002).
  1030*    -------------------------------
  1031     05  ACCT04L PIC S9(0004) COMP.
  1032     05  ACCT04F PIC  X(0001).
  1033     05  FILLER REDEFINES ACCT04F.
  1034         10  ACCT04A PIC  X(0001).
  1035     05  ACCT04I PIC  X(0010).
  1036*    -------------------------------
  1037     05  EFFDT04L PIC S9(0004) COMP.
  1038     05  EFFDT04F PIC  X(0001).
  1039     05  FILLER REDEFINES EFFDT04F.
  1040         10  EFFDT04A PIC  X(0001).
  1041     05  EFFDT04I PIC  X(0008).
  1042*    -------------------------------
  1043     05  EXPDT04L PIC S9(0004) COMP.
  1044     05  EXPDT04F PIC  X(0001).
  1045     05  FILLER REDEFINES EXPDT04F.
  1046         10  EXPDT04A PIC  X(0001).
  1047     05  EXPDT04I PIC  X(0008).
  1048*    -------------------------------
  1049     05  STATE04L PIC S9(0004) COMP.
  1050     05  STATE04F PIC  X(0001).
  1051     05  FILLER REDEFINES STATE04F.
  1052         10  STATE04A PIC  X(0001).
  1053     05  STATE04I PIC  X(0002).
  1054*    -------------------------------
  1055     05  ACCT05L PIC S9(0004) COMP.
  1056     05  ACCT05F PIC  X(0001).
  1057     05  FILLER REDEFINES ACCT05F.
  1058         10  ACCT05A PIC  X(0001).
  1059     05  ACCT05I PIC  X(0010).
  1060*    -------------------------------
  1061     05  EFFDT05L PIC S9(0004) COMP.
  1062     05  EFFDT05F PIC  X(0001).
  1063     05  FILLER REDEFINES EFFDT05F.
  1064         10  EFFDT05A PIC  X(0001).
  1065     05  EFFDT05I PIC  X(0008).
  1066*    -------------------------------
  1067     05  EXPDT05L PIC S9(0004) COMP.
  1068     05  EXPDT05F PIC  X(0001).
  1069     05  FILLER REDEFINES EXPDT05F.
  1070         10  EXPDT05A PIC  X(0001).
  1071     05  EXPDT05I PIC  X(0008).
  1072*    -------------------------------
  1073     05  STATE05L PIC S9(0004) COMP.
  1074     05  STATE05F PIC  X(0001).
  1075     05  FILLER REDEFINES STATE05F.
  1076         10  STATE05A PIC  X(0001).
  1077     05  STATE05I PIC  X(0002).
  1078*    -------------------------------
  1079     05  ACCT06L PIC S9(0004) COMP.
  1080     05  ACCT06F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6523.cbl
  1081     05  FILLER REDEFINES ACCT06F.
  1082         10  ACCT06A PIC  X(0001).
  1083     05  ACCT06I PIC  X(0010).
  1084*    -------------------------------
  1085     05  EFFDT06L PIC S9(0004) COMP.
  1086     05  EFFDT06F PIC  X(0001).
  1087     05  FILLER REDEFINES EFFDT06F.
  1088         10  EFFDT06A PIC  X(0001).
  1089     05  EFFDT06I PIC  X(0008).
  1090*    -------------------------------
  1091     05  EXPDT06L PIC S9(0004) COMP.
  1092     05  EXPDT06F PIC  X(0001).
  1093     05  FILLER REDEFINES EXPDT06F.
  1094         10  EXPDT06A PIC  X(0001).
  1095     05  EXPDT06I PIC  X(0008).
  1096*    -------------------------------
  1097     05  STATE06L PIC S9(0004) COMP.
  1098     05  STATE06F PIC  X(0001).
  1099     05  FILLER REDEFINES STATE06F.
  1100         10  STATE06A PIC  X(0001).
  1101     05  STATE06I PIC  X(0002).
  1102*    -------------------------------
  1103     05  ACCT07L PIC S9(0004) COMP.
  1104     05  ACCT07F PIC  X(0001).
  1105     05  FILLER REDEFINES ACCT07F.
  1106         10  ACCT07A PIC  X(0001).
  1107     05  ACCT07I PIC  X(0010).
  1108*    -------------------------------
  1109     05  EFFDT07L PIC S9(0004) COMP.
  1110     05  EFFDT07F PIC  X(0001).
  1111     05  FILLER REDEFINES EFFDT07F.
  1112         10  EFFDT07A PIC  X(0001).
  1113     05  EFFDT07I PIC  X(0008).
  1114*    -------------------------------
  1115     05  EXPDT07L PIC S9(0004) COMP.
  1116     05  EXPDT07F PIC  X(0001).
  1117     05  FILLER REDEFINES EXPDT07F.
  1118         10  EXPDT07A PIC  X(0001).
  1119     05  EXPDT07I PIC  X(0008).
  1120*    -------------------------------
  1121     05  STATE07L PIC S9(0004) COMP.
  1122     05  STATE07F PIC  X(0001).
  1123     05  FILLER REDEFINES STATE07F.
  1124         10  STATE07A PIC  X(0001).
  1125     05  STATE07I PIC  X(0002).
  1126*    -------------------------------
  1127     05  ACCT08L PIC S9(0004) COMP.
  1128     05  ACCT08F PIC  X(0001).
  1129     05  FILLER REDEFINES ACCT08F.
  1130         10  ACCT08A PIC  X(0001).
  1131     05  ACCT08I PIC  X(0010).
  1132*    -------------------------------
  1133     05  EFFDT08L PIC S9(0004) COMP.
  1134     05  EFFDT08F PIC  X(0001).
  1135     05  FILLER REDEFINES EFFDT08F.
  1136         10  EFFDT08A PIC  X(0001).
  1137     05  EFFDT08I PIC  X(0008).
  1138*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6523.cbl
  1139     05  EXPDT08L PIC S9(0004) COMP.
  1140     05  EXPDT08F PIC  X(0001).
  1141     05  FILLER REDEFINES EXPDT08F.
  1142         10  EXPDT08A PIC  X(0001).
  1143     05  EXPDT08I PIC  X(0008).
  1144*    -------------------------------
  1145     05  STATE08L PIC S9(0004) COMP.
  1146     05  STATE08F PIC  X(0001).
  1147     05  FILLER REDEFINES STATE08F.
  1148         10  STATE08A PIC  X(0001).
  1149     05  STATE08I PIC  X(0002).
  1150*    -------------------------------
  1151     05  ACCT09L PIC S9(0004) COMP.
  1152     05  ACCT09F PIC  X(0001).
  1153     05  FILLER REDEFINES ACCT09F.
  1154         10  ACCT09A PIC  X(0001).
  1155     05  ACCT09I PIC  X(0010).
  1156*    -------------------------------
  1157     05  EFFDT09L PIC S9(0004) COMP.
  1158     05  EFFDT09F PIC  X(0001).
  1159     05  FILLER REDEFINES EFFDT09F.
  1160         10  EFFDT09A PIC  X(0001).
  1161     05  EFFDT09I PIC  X(0008).
  1162*    -------------------------------
  1163     05  EXPDT09L PIC S9(0004) COMP.
  1164     05  EXPDT09F PIC  X(0001).
  1165     05  FILLER REDEFINES EXPDT09F.
  1166         10  EXPDT09A PIC  X(0001).
  1167     05  EXPDT09I PIC  X(0008).
  1168*    -------------------------------
  1169     05  STATE09L PIC S9(0004) COMP.
  1170     05  STATE09F PIC  X(0001).
  1171     05  FILLER REDEFINES STATE09F.
  1172         10  STATE09A PIC  X(0001).
  1173     05  STATE09I PIC  X(0002).
  1174*    -------------------------------
  1175     05  ACCT10L PIC S9(0004) COMP.
  1176     05  ACCT10F PIC  X(0001).
  1177     05  FILLER REDEFINES ACCT10F.
  1178         10  ACCT10A PIC  X(0001).
  1179     05  ACCT10I PIC  X(0010).
  1180*    -------------------------------
  1181     05  EFFDT10L PIC S9(0004) COMP.
  1182     05  EFFDT10F PIC  X(0001).
  1183     05  FILLER REDEFINES EFFDT10F.
  1184         10  EFFDT10A PIC  X(0001).
  1185     05  EFFDT10I PIC  X(0008).
  1186*    -------------------------------
  1187     05  EXPDT10L PIC S9(0004) COMP.
  1188     05  EXPDT10F PIC  X(0001).
  1189     05  FILLER REDEFINES EXPDT10F.
  1190         10  EXPDT10A PIC  X(0001).
  1191     05  EXPDT10I PIC  X(0008).
  1192*    -------------------------------
  1193     05  STATE10L PIC S9(0004) COMP.
  1194     05  STATE10F PIC  X(0001).
  1195     05  FILLER REDEFINES STATE10F.
  1196         10  STATE10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6523.cbl
  1197     05  STATE10I PIC  X(0002).
  1198*    -------------------------------
  1199     05  ACCT11L PIC S9(0004) COMP.
  1200     05  ACCT11F PIC  X(0001).
  1201     05  FILLER REDEFINES ACCT11F.
  1202         10  ACCT11A PIC  X(0001).
  1203     05  ACCT11I PIC  X(0010).
  1204*    -------------------------------
  1205     05  EFFDT11L PIC S9(0004) COMP.
  1206     05  EFFDT11F PIC  X(0001).
  1207     05  FILLER REDEFINES EFFDT11F.
  1208         10  EFFDT11A PIC  X(0001).
  1209     05  EFFDT11I PIC  X(0008).
  1210*    -------------------------------
  1211     05  EXPDT11L PIC S9(0004) COMP.
  1212     05  EXPDT11F PIC  X(0001).
  1213     05  FILLER REDEFINES EXPDT11F.
  1214         10  EXPDT11A PIC  X(0001).
  1215     05  EXPDT11I PIC  X(0008).
  1216*    -------------------------------
  1217     05  STATE11L PIC S9(0004) COMP.
  1218     05  STATE11F PIC  X(0001).
  1219     05  FILLER REDEFINES STATE11F.
  1220         10  STATE11A PIC  X(0001).
  1221     05  STATE11I PIC  X(0002).
  1222*    -------------------------------
  1223     05  ACCT12L PIC S9(0004) COMP.
  1224     05  ACCT12F PIC  X(0001).
  1225     05  FILLER REDEFINES ACCT12F.
  1226         10  ACCT12A PIC  X(0001).
  1227     05  ACCT12I PIC  X(0010).
  1228*    -------------------------------
  1229     05  EFFDT12L PIC S9(0004) COMP.
  1230     05  EFFDT12F PIC  X(0001).
  1231     05  FILLER REDEFINES EFFDT12F.
  1232         10  EFFDT12A PIC  X(0001).
  1233     05  EFFDT12I PIC  X(0008).
  1234*    -------------------------------
  1235     05  EXPDT12L PIC S9(0004) COMP.
  1236     05  EXPDT12F PIC  X(0001).
  1237     05  FILLER REDEFINES EXPDT12F.
  1238         10  EXPDT12A PIC  X(0001).
  1239     05  EXPDT12I PIC  X(0008).
  1240*    -------------------------------
  1241     05  STATE12L PIC S9(0004) COMP.
  1242     05  STATE12F PIC  X(0001).
  1243     05  FILLER REDEFINES STATE12F.
  1244         10  STATE12A PIC  X(0001).
  1245     05  STATE12I PIC  X(0002).
  1246*    -------------------------------
  1247     05  ACCT13L PIC S9(0004) COMP.
  1248     05  ACCT13F PIC  X(0001).
  1249     05  FILLER REDEFINES ACCT13F.
  1250         10  ACCT13A PIC  X(0001).
  1251     05  ACCT13I PIC  X(0010).
  1252*    -------------------------------
  1253     05  EFFDT13L PIC S9(0004) COMP.
  1254     05  EFFDT13F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6523.cbl
  1255     05  FILLER REDEFINES EFFDT13F.
  1256         10  EFFDT13A PIC  X(0001).
  1257     05  EFFDT13I PIC  X(0008).
  1258*    -------------------------------
  1259     05  EXPDT13L PIC S9(0004) COMP.
  1260     05  EXPDT13F PIC  X(0001).
  1261     05  FILLER REDEFINES EXPDT13F.
  1262         10  EXPDT13A PIC  X(0001).
  1263     05  EXPDT13I PIC  X(0008).
  1264*    -------------------------------
  1265     05  STATE13L PIC S9(0004) COMP.
  1266     05  STATE13F PIC  X(0001).
  1267     05  FILLER REDEFINES STATE13F.
  1268         10  STATE13A PIC  X(0001).
  1269     05  STATE13I PIC  X(0002).
  1270*    -------------------------------
  1271     05  ACCOCCL PIC S9(0004) COMP.
  1272     05  ACCOCCF PIC  X(0001).
  1273     05  FILLER REDEFINES ACCOCCF.
  1274         10  ACCOCCA PIC  X(0001).
  1275     05  ACCOCCI PIC  9(4).
  1276*    -------------------------------
  1277     05  ERRMSGL PIC S9(0004) COMP.
  1278     05  ERRMSGF PIC  X(0001).
  1279     05  FILLER REDEFINES ERRMSGF.
  1280         10  ERRMSGA PIC  X(0001).
  1281     05  ERRMSGI PIC  X(0076).
  1282*    -------------------------------
  1283     05  PFENTERL PIC S9(0004) COMP.
  1284     05  PFENTERF PIC  X(0001).
  1285     05  FILLER REDEFINES PFENTERF.
  1286         10  PFENTERA PIC  X(0001).
  1287     05  PFENTERI PIC  9(2).
  1288 01  EL652DO REDEFINES EL652DI.
  1289     05  FILLER            PIC  X(0012).
  1290*    -------------------------------
  1291     05  FILLER            PIC  X(0003).
  1292     05  TIMEO PIC  99.99.
  1293*    -------------------------------
  1294     05  FILLER            PIC  X(0003).
  1295     05  DATEO PIC  X(0008).
  1296*    -------------------------------
  1297     05  FILLER            PIC  X(0003).
  1298     05  MAINTYPO PIC  X(0001).
  1299*    -------------------------------
  1300     05  FILLER            PIC  X(0003).
  1301     05  CARRIERO PIC  X(0001).
  1302*    -------------------------------
  1303     05  FILLER            PIC  X(0003).
  1304     05  GROUPO PIC  X(0006).
  1305*    -------------------------------
  1306     05  FILLER            PIC  X(0003).
  1307     05  BANKO PIC  X(0010).
  1308*    -------------------------------
  1309     05  FILLER            PIC  X(0003).
  1310     05  MAINTDTO PIC  X(0008).
  1311*    -------------------------------
  1312     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6523.cbl
  1313     05  TOTOPNO PIC  Z,ZZ9.
  1314*    -------------------------------
  1315     05  FILLER            PIC  X(0003).
  1316     05  TOTOCCO PIC  Z,ZZ9.
  1317*    -------------------------------
  1318     05  FILLER            PIC  X(0003).
  1319     05  ACCT01O PIC  X(0010).
  1320*    -------------------------------
  1321     05  FILLER            PIC  X(0003).
  1322     05  EFFDT01O PIC  X(0008).
  1323*    -------------------------------
  1324     05  FILLER            PIC  X(0003).
  1325     05  EXPDT01O PIC  X(0008).
  1326*    -------------------------------
  1327     05  FILLER            PIC  X(0003).
  1328     05  STATE01O PIC  X(0002).
  1329*    -------------------------------
  1330     05  FILLER            PIC  X(0003).
  1331     05  ACCT02O PIC  X(0010).
  1332*    -------------------------------
  1333     05  FILLER            PIC  X(0003).
  1334     05  EFFDT02O PIC  X(0008).
  1335*    -------------------------------
  1336     05  FILLER            PIC  X(0003).
  1337     05  EXPDT02O PIC  X(0008).
  1338*    -------------------------------
  1339     05  FILLER            PIC  X(0003).
  1340     05  STATE02O PIC  X(0002).
  1341*    -------------------------------
  1342     05  FILLER            PIC  X(0003).
  1343     05  ACCT03O PIC  X(0010).
  1344*    -------------------------------
  1345     05  FILLER            PIC  X(0003).
  1346     05  EFFDT03O PIC  X(0008).
  1347*    -------------------------------
  1348     05  FILLER            PIC  X(0003).
  1349     05  EXPDT03O PIC  X(0008).
  1350*    -------------------------------
  1351     05  FILLER            PIC  X(0003).
  1352     05  STATE03O PIC  X(0002).
  1353*    -------------------------------
  1354     05  FILLER            PIC  X(0003).
  1355     05  ACCT04O PIC  X(0010).
  1356*    -------------------------------
  1357     05  FILLER            PIC  X(0003).
  1358     05  EFFDT04O PIC  X(0008).
  1359*    -------------------------------
  1360     05  FILLER            PIC  X(0003).
  1361     05  EXPDT04O PIC  X(0008).
  1362*    -------------------------------
  1363     05  FILLER            PIC  X(0003).
  1364     05  STATE04O PIC  X(0002).
  1365*    -------------------------------
  1366     05  FILLER            PIC  X(0003).
  1367     05  ACCT05O PIC  X(0010).
  1368*    -------------------------------
  1369     05  FILLER            PIC  X(0003).
  1370     05  EFFDT05O PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6523.cbl
  1371*    -------------------------------
  1372     05  FILLER            PIC  X(0003).
  1373     05  EXPDT05O PIC  X(0008).
  1374*    -------------------------------
  1375     05  FILLER            PIC  X(0003).
  1376     05  STATE05O PIC  X(0002).
  1377*    -------------------------------
  1378     05  FILLER            PIC  X(0003).
  1379     05  ACCT06O PIC  X(0010).
  1380*    -------------------------------
  1381     05  FILLER            PIC  X(0003).
  1382     05  EFFDT06O PIC  X(0008).
  1383*    -------------------------------
  1384     05  FILLER            PIC  X(0003).
  1385     05  EXPDT06O PIC  X(0008).
  1386*    -------------------------------
  1387     05  FILLER            PIC  X(0003).
  1388     05  STATE06O PIC  X(0002).
  1389*    -------------------------------
  1390     05  FILLER            PIC  X(0003).
  1391     05  ACCT07O PIC  X(0010).
  1392*    -------------------------------
  1393     05  FILLER            PIC  X(0003).
  1394     05  EFFDT07O PIC  X(0008).
  1395*    -------------------------------
  1396     05  FILLER            PIC  X(0003).
  1397     05  EXPDT07O PIC  X(0008).
  1398*    -------------------------------
  1399     05  FILLER            PIC  X(0003).
  1400     05  STATE07O PIC  X(0002).
  1401*    -------------------------------
  1402     05  FILLER            PIC  X(0003).
  1403     05  ACCT08O PIC  X(0010).
  1404*    -------------------------------
  1405     05  FILLER            PIC  X(0003).
  1406     05  EFFDT08O PIC  X(0008).
  1407*    -------------------------------
  1408     05  FILLER            PIC  X(0003).
  1409     05  EXPDT08O PIC  X(0008).
  1410*    -------------------------------
  1411     05  FILLER            PIC  X(0003).
  1412     05  STATE08O PIC  X(0002).
  1413*    -------------------------------
  1414     05  FILLER            PIC  X(0003).
  1415     05  ACCT09O PIC  X(0010).
  1416*    -------------------------------
  1417     05  FILLER            PIC  X(0003).
  1418     05  EFFDT09O PIC  X(0008).
  1419*    -------------------------------
  1420     05  FILLER            PIC  X(0003).
  1421     05  EXPDT09O PIC  X(0008).
  1422*    -------------------------------
  1423     05  FILLER            PIC  X(0003).
  1424     05  STATE09O PIC  X(0002).
  1425*    -------------------------------
  1426     05  FILLER            PIC  X(0003).
  1427     05  ACCT10O PIC  X(0010).
  1428*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6523.cbl
  1429     05  FILLER            PIC  X(0003).
  1430     05  EFFDT10O PIC  X(0008).
  1431*    -------------------------------
  1432     05  FILLER            PIC  X(0003).
  1433     05  EXPDT10O PIC  X(0008).
  1434*    -------------------------------
  1435     05  FILLER            PIC  X(0003).
  1436     05  STATE10O PIC  X(0002).
  1437*    -------------------------------
  1438     05  FILLER            PIC  X(0003).
  1439     05  ACCT11O PIC  X(0010).
  1440*    -------------------------------
  1441     05  FILLER            PIC  X(0003).
  1442     05  EFFDT11O PIC  X(0008).
  1443*    -------------------------------
  1444     05  FILLER            PIC  X(0003).
  1445     05  EXPDT11O PIC  X(0008).
  1446*    -------------------------------
  1447     05  FILLER            PIC  X(0003).
  1448     05  STATE11O PIC  X(0002).
  1449*    -------------------------------
  1450     05  FILLER            PIC  X(0003).
  1451     05  ACCT12O PIC  X(0010).
  1452*    -------------------------------
  1453     05  FILLER            PIC  X(0003).
  1454     05  EFFDT12O PIC  X(0008).
  1455*    -------------------------------
  1456     05  FILLER            PIC  X(0003).
  1457     05  EXPDT12O PIC  X(0008).
  1458*    -------------------------------
  1459     05  FILLER            PIC  X(0003).
  1460     05  STATE12O PIC  X(0002).
  1461*    -------------------------------
  1462     05  FILLER            PIC  X(0003).
  1463     05  ACCT13O PIC  X(0010).
  1464*    -------------------------------
  1465     05  FILLER            PIC  X(0003).
  1466     05  EFFDT13O PIC  X(0008).
  1467*    -------------------------------
  1468     05  FILLER            PIC  X(0003).
  1469     05  EXPDT13O PIC  X(0008).
  1470*    -------------------------------
  1471     05  FILLER            PIC  X(0003).
  1472     05  STATE13O PIC  X(0002).
  1473*    -------------------------------
  1474     05  FILLER            PIC  X(0003).
  1475     05  ACCOCCO PIC  Z(4).
  1476*    -------------------------------
  1477     05  FILLER            PIC  X(0003).
  1478     05  ERRMSGO PIC  X(0076).
  1479*    -------------------------------
  1480     05  FILLER            PIC  X(0003).
  1481     05  PFENTERO PIC  X(0002).
  1482*    -------------------------------
  1483 01  FILLER REDEFINES EL652DI.
  1484     12  FILLER                  PIC X(88).
  1485     12  BLD-LINE OCCURS 13.
  1486         16  BL-ACCOUNTL         PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6523.cbl
  1487         16  BL-ACCOUNTA         PIC X.
  1488         16  BL-ACCOUNT          PIC X(10).
  1489         16  BL-EFFECTL          PIC S9(4) COMP.
  1490         16  BL-EFFECTA          PIC X.
  1491         16  BL-EFFECT           PIC X(8).
  1492         16  BL-EXPIREL          PIC S9(4) COMP.
  1493         16  BL-EXPIREA          PIC X.
  1494         16  BL-EXPIRE           PIC X(8).
  1495         16  BL-STATEL           PIC S9(4) COMP.
  1496         16  BL-STATEA           PIC X.
  1497         16  BL-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6523.cbl
  1499****************************************************************
  1500*
  1501* Copyright (c) 2007 by Clerity Solutions, Inc.
  1502* All rights reserved.
  1503*
  1504****************************************************************
  1505 01  DFHEIV.
  1506   02  DFHEIV0               PIC X(35).
  1507   02  DFHEIV1               PIC X(08).
  1508   02  DFHEIV2               PIC X(08).
  1509   02  DFHEIV3               PIC X(08).
  1510   02  DFHEIV4               PIC X(06).
  1511   02  DFHEIV5               PIC X(04).
  1512   02  DFHEIV6               PIC X(04).
  1513   02  DFHEIV7               PIC X(02).
  1514   02  DFHEIV8               PIC X(02).
  1515   02  DFHEIV9               PIC X(01).
  1516   02  DFHEIV10              PIC S9(7) COMP-3.
  1517   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1518   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1519   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1520   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1521   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1522   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1523   02  DFHEIV17              PIC X(04).
  1524   02  DFHEIV18              PIC X(04).
  1525   02  DFHEIV19              PIC X(04).
  1526   02  DFHEIV20              USAGE IS POINTER.
  1527   02  DFHEIV21              USAGE IS POINTER.
  1528   02  DFHEIV22              USAGE IS POINTER.
  1529   02  DFHEIV23              USAGE IS POINTER.
  1530   02  DFHEIV24              USAGE IS POINTER.
  1531   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1532   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1533   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1534   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1535   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1536   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1537   02  FILLER                PIC X(02).
  1538   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1539   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1540   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1541   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1542   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1543 LINKAGE  SECTION.
  1544*****************************************************************
  1545*                                                               *
  1546* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1547* All rights reserved.                                          *
  1548*                                                               *
  1549*****************************************************************
  1550 01  dfheiblk.
  1551     02  eibtime          pic s9(7) comp-3.
  1552     02  eibdate          pic s9(7) comp-3.
  1553     02  eibtrnid         pic x(4).
  1554     02  eibtaskn         pic s9(7) comp-3.
  1555     02  eibtrmid         pic x(4).
  1556     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6523.cbl
  1557     02  eibcposn         pic s9(4) comp.
  1558     02  eibcalen         pic s9(4) comp.
  1559     02  eibaid           pic x(1).
  1560     02  eibfiller1       pic x(1).
  1561     02  eibfn            pic x(2).
  1562     02  eibfiller2       pic x(2).
  1563     02  eibrcode         pic x(6).
  1564     02  eibfiller3       pic x(2).
  1565     02  eibds            pic x(8).
  1566     02  eibreqid         pic x(8).
  1567     02  eibrsrce         pic x(8).
  1568     02  eibsync          pic x(1).
  1569     02  eibfree          pic x(1).
  1570     02  eibrecv          pic x(1).
  1571     02  eibsend          pic x(1).
  1572     02  eibatt           pic x(1).
  1573     02  eibeoc           pic x(1).
  1574     02  eibfmh           pic x(1).
  1575     02  eibcompl         pic x(1).
  1576     02  eibsig           pic x(1).
  1577     02  eibconf          pic x(1).
  1578     02  eiberr           pic x(1).
  1579     02  eibrldbk         pic x(1).
  1580     02  eiberrcd         pic x(4).
  1581     02  eibsynrb         pic x(1).
  1582     02  eibnodat         pic x(1).
  1583     02  eibfiller5       pic x(2).
  1584     02  eibresp          pic 9(09) comp.
  1585     02  eibresp2         pic 9(09) comp.
  1586     02  dfheigdj         pic s9(4) comp.
  1587     02  dfheigdk         pic s9(4) comp.
  1588 01  DFHCOMMAREA                 PIC X(1024).
  1589*                                COPY ELCCNTL.
  1590******************************************************************
  1591*                                                                *
  1592*                                                                *
  1593*                            ELCCNTL.                            *
  1594*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1595*                            VMOD=2.059                          *
  1596*                                                                *
  1597*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1598*                                                                *
  1599*   FILE TYPE = VSAM,KSDS                                        *
  1600*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1601*                                                                *
  1602*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1603*       ALTERNATE INDEX = NONE                                   *
  1604*                                                                *
  1605*   LOG = YES                                                    *
  1606*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1607******************************************************************
  1608*                   C H A N G E   L O G
  1609*
  1610* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1611*-----------------------------------------------------------------
  1612*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1613* EFFECTIVE    NUMBER
  1614*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6523.cbl
  1615* 082503                   PEMA  ADD BENEFIT GROUP
  1616* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1617* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1618* 092705    2005050300006  PEMA  ADD SPP LEASES
  1619* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1620* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1621* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1622* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1623******************************************************************
  1624*
  1625 01  CONTROL-FILE.
  1626     12  CF-RECORD-ID                       PIC XX.
  1627         88  VALID-CF-ID                        VALUE 'CF'.
  1628
  1629     12  CF-CONTROL-PRIMARY.
  1630         16  CF-COMPANY-ID                  PIC XXX.
  1631         16  CF-RECORD-TYPE                 PIC X.
  1632             88  CF-COMPANY-MASTER              VALUE '1'.
  1633             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1634             88  CF-STATE-MASTER                VALUE '3'.
  1635             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1636             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1637             88  CF-CARRIER-MASTER              VALUE '6'.
  1638             88  CF-MORTALITY-MASTER            VALUE '7'.
  1639             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1640             88  CF-TERMINAL-MASTER             VALUE '9'.
  1641             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1642             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1643             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1644             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1645             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1646             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1647             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1648             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1649             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1650         16  CF-ACCESS-CD-GENL              PIC X(4).
  1651         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1652             20  CF-PROCESSOR               PIC X(4).
  1653         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1654             20  CF-STATE-CODE              PIC XX.
  1655             20  FILLER                     PIC XX.
  1656         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1657             20  FILLER                     PIC XX.
  1658             20  CF-HI-BEN-IN-REC           PIC XX.
  1659         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1660             20  FILLER                     PIC XXX.
  1661             20  CF-CARRIER-CNTL            PIC X.
  1662         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1663             20  FILLER                     PIC XX.
  1664             20  CF-HI-TYPE-IN-REC          PIC 99.
  1665         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1666             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1667                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1668             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1669             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1670         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1671             20  FILLER                     PIC X.
  1672             20  CF-CUSTOM-REPORT-NO        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6523.cbl
  1673         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1674             20  FILLER                     PIC XX.
  1675             20  CF-MORTGAGE-PLAN           PIC XX.
  1676         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1677
  1678     12  CF-LAST-MAINT-DT                   PIC XX.
  1679     12  CF-LAST-MAINT-BY                   PIC X(4).
  1680     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1681
  1682     12  CF-RECORD-BODY                     PIC X(728).
  1683
  1684
  1685****************************************************************
  1686*             COMPANY MASTER RECORD                            *
  1687****************************************************************
  1688
  1689     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1690         16  CF-COMPANY-ADDRESS.
  1691             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1692             20  CF-CL-IN-CARE-OF           PIC X(30).
  1693             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1694             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1695             20  CF-CL-CITY-STATE           PIC X(30).
  1696             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1697             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1698         16  CF-COMPANY-CD                  PIC X.
  1699         16  CF-COMPANY-PASSWORD            PIC X(8).
  1700         16  CF-SECURITY-OPTION             PIC X.
  1701             88  ALL-SECURITY                   VALUE '1'.
  1702             88  COMPANY-VERIFY                 VALUE '2'.
  1703             88  PROCESSOR-VERIFY               VALUE '3'.
  1704             88  NO-SECURITY                    VALUE '4'.
  1705             88  ALL-BUT-TERM                   VALUE '5'.
  1706         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1707             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1708         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1709             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1710         16  CF-INFORCE-LOCATION            PIC X.
  1711             88  CERTS-ARE-ONLINE               VALUE '1'.
  1712             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1713             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1714         16  CF-LOWER-CASE-LETTERS          PIC X.
  1715         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1716             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1717             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1718             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1719             88  CF-ACCNT-CNTL                  VALUE '3'.
  1720             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1721
  1722         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1723         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1724
  1725         16  CF-LGX-CREDIT-USER             PIC X.
  1726             88  CO-IS-NOT-USER                 VALUE 'N'.
  1727             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1728
  1729         16 CF-CREDIT-CALC-CODES.
  1730             20  CF-CR-REM-TERM-CALC PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6523.cbl
  1731               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1732               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1733               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1734               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1735               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1736               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1737               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1738             20  CF-CR-R78-METHOD           PIC X.
  1739               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1740               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1741
  1742         16  CF-CLAIM-CONTROL-COUNTS.
  1743             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1744                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1745
  1746             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1747                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1748
  1749             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1750                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1751
  1752             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1753                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1754
  1755         16  CF-CURRENT-MONTH-END           PIC XX.
  1756
  1757         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1758             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1759             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1760             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1761             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1762                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1763                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1764             20  CF-CO-PREM-REJECT-SW       PIC X.
  1765                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1766                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1767             20  CF-CO-REF-REJECT-SW        PIC X.
  1768                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1769                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1770
  1771         16  CF-CO-REPORTING-DT             PIC XX.
  1772         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1773         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1774           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1775           88  CF-CO-MONTH-END                  VALUE '1'.
  1776
  1777         16  CF-LGX-CLAIM-USER              PIC X.
  1778             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1779             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1780
  1781         16  CF-CREDIT-EDIT-CONTROLS.
  1782             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1783             20  CF-MIN-AGE                 PIC 99.
  1784             20  CF-DEFAULT-AGE             PIC 99.
  1785             20  CF-MIN-TERM                PIC S999      COMP-3.
  1786             20  CF-MAX-TERM                PIC S999      COMP-3.
  1787             20  CF-DEFAULT-SEX             PIC X.
  1788             20  CF-JOINT-AGE-INPUT         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6523.cbl
  1789                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1790             20  CF-BIRTH-DATE-INPUT        PIC X.
  1791                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1792             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1793                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1794                 88  CF-ZERO-CARRIER            VALUE '1'.
  1795                 88  CF-ZERO-GROUPING           VALUE '2'.
  1796                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1797             20  CF-EDIT-SW                 PIC X.
  1798                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1799             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1800             20  CF-CR-PR-METHOD            PIC X.
  1801               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1802               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1803             20  FILLER                     PIC X.
  1804
  1805         16  CF-CREDIT-MISC-CONTROLS.
  1806             20  CF-REIN-TABLE-SW           PIC X.
  1807                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1808             20  CF-COMP-TABLE-SW           PIC X.
  1809                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1810             20  CF-EXPERIENCE-RETENTION-AGE
  1811                                            PIC S9        COMP-3.
  1812             20  CF-CONVERSION-DT           PIC XX.
  1813             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1814             20  CF-RUN-FREQUENCY-SW        PIC X.
  1815                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1816                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1817
  1818             20  CF-CR-CHECK-NO-CONTROL.
  1819                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1820                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1821                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1822                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1823                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1824                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1825
  1826                 24  CF-CR-CHECK-COUNT       REDEFINES
  1827                     CF-CR-CHECK-COUNTER      PIC X(4).
  1828
  1829                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1830                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1831
  1832                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1833                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1834                 24  CF-MAIL-PROCESSING       PIC X.
  1835                     88  MAIL-PROCESSING          VALUE 'Y'.
  1836
  1837         16  CF-MISC-SYSTEM-CONTROL.
  1838             20  CF-SYSTEM-C                 PIC X.
  1839                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1840             20  CF-SYSTEM-D                 PIC X.
  1841                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1842             20  CF-SOC-SEC-NO-SW            PIC X.
  1843                 88  SOC-SEC-NO-USED             VALUE '1'.
  1844             20  CF-MEMBER-NO-SW             PIC X.
  1845                 88  MEMBER-NO-USED              VALUE '1'.
  1846             20  CF-TAX-ID-NUMBER            PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6523.cbl
  1847             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1848             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1849                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1850                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1851                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1852                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1853             20  CF-SYSTEM-E                 PIC X.
  1854                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1855
  1856         16  CF-LGX-LIFE-USER               PIC X.
  1857             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1858             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1859
  1860         16  CF-CR-MONTH-END-DT             PIC XX.
  1861
  1862         16  CF-FILE-MAINT-DATES.
  1863             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1864                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1865             20  CF-LAST-BATCH       REDEFINES
  1866                 CF-LAST-BATCH-NO               PIC X(4).
  1867             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1868             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1869             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1870             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1871             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1872             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1873             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1874             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1875             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1876             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1877
  1878         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1879         16  FILLER                         PIC X.
  1880
  1881         16  CF-ALT-MORT-CODE               PIC X(4).
  1882         16  CF-MEMBER-CAPTION              PIC X(10).
  1883
  1884         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1885             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1886             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1887             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1888             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1889             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1890
  1891         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1892
  1893         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1894         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1895         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1896         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1897
  1898         16  CF-AH-OVERRIDE-L1              PIC X.
  1899         16  CF-AH-OVERRIDE-L2              PIC XX.
  1900         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1901         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1902
  1903         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1904         16  CF-REPORT-CD2-CAPTION          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6523.cbl
  1905
  1906         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1907         16  CF-AR-LAST-EL860-DT            PIC XX.
  1908         16  CF-MP-MONTH-END-DT             PIC XX.
  1909
  1910         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1911         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1912             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1913
  1914         16  CF-AR-MONTH-END-DT             PIC XX.
  1915
  1916         16  CF-CRDTCRD-USER                PIC X.
  1917             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1918             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1919
  1920         16  CF-CC-MONTH-END-DT             PIC XX.
  1921
  1922         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1923
  1924         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1925             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1926             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1927             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1928         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1929         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1930         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1931         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1932             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1933             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1934         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1935         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1936         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1937             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1938         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1939
  1940         16  CF-CL-ZIP-CODE.
  1941             20  CF-CL-ZIP-PRIME.
  1942                 24  CF-CL-ZIP-1ST          PIC X.
  1943                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1944                 24  FILLER                 PIC X(4).
  1945             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1946         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1947             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1948             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1949             20  FILLER                     PIC XXX.
  1950
  1951         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1952         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1953         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1954         16  CF-CO-OPTION-START-DATE        PIC XX.
  1955         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1956           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1957                                                      '3' '4'.
  1958           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1959           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1960           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1961           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1962           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6523.cbl
  1963           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1964
  1965         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1966
  1967         16  CF-PAYMENT-APPROVAL-LEVELS.
  1968             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1969             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1970             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1971             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1972             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1973             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1974
  1975         16  CF-END-USER-REPORTING-USER     PIC X.
  1976             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1977             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1978
  1979         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1980             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1981             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1982
  1983         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1984
  1985         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1986         16  FILLER                         PIC X.
  1987
  1988         16  CF-CREDIT-ARCHIVE-CNTL.
  1989             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1990             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1991             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1992
  1993         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1994
  1995         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1996             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1997             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1998
  1999         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2000             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2001             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2002
  2003         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2004
  2005         16  CF-CO-ACH-ID-CODE              PIC  X.
  2006             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2007             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2008             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2009         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2010         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2011         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2012         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2013         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2014         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2015         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2016         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2017         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2018                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2019         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2020                 CF-CO-ACH-TRACE-NO         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6523.cbl
  2021
  2022         16  CF-CO-OVER-SHORT.
  2023             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2024             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2025
  2026*         16  FILLER                         PIC X(102).
  2027         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2028             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2029             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2030
  2031         16  CF-AH-APPROVAL-DAYS.
  2032             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2033             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2034             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2035             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2036
  2037         16  FILLER                         PIC X(82).
  2038****************************************************************
  2039*             PROCESSOR/USER RECORD                            *
  2040****************************************************************
  2041
  2042     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2043         16  CF-PROCESSOR-NAME              PIC X(30).
  2044         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2045         16  CF-PROCESSOR-TITLE             PIC X(26).
  2046         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2047                 88  MESSAGE-YES                VALUE 'Y'.
  2048                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2049
  2050*****************************************************
  2051****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2052****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2053****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2054****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2055*****************************************************
  2056
  2057         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2058             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2059             20  CF-APPLICATION-FORCE       PIC X.
  2060             20  CF-INDIVIDUAL-APP.
  2061                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2062                     28  CF-BROWSE-APP      PIC X.
  2063                     28  CF-UPDATE-APP      PIC X.
  2064
  2065         16  CF-CURRENT-TERM-ON             PIC X(4).
  2066         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2067             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2068             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2069             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2070             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2071             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2072             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2073             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2074         16  CF-PROCESSOR-CARRIER           PIC X.
  2075             88  NO-CARRIER-SECURITY            VALUE ' '.
  2076         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2077             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2078         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6523.cbl
  2079             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2080         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2081             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2082
  2083         16  CF-PROC-SYS-ACCESS-SW.
  2084             20  CF-PROC-CREDIT-CLAIMS-SW.
  2085                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2086                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2087                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2088                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2089             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2090                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2091                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2092             20  CF-PROC-LIFE-GNRLDGR-SW.
  2093                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2094                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2095                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2096                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2097             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2098                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2099                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2100         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2101             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2102             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2103         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2104
  2105         16  CF-APPROVAL-LEVEL                  PIC X.
  2106             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2107             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2108             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2109             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2110
  2111         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2112
  2113         16  CF-LANGUAGE-TYPE                   PIC X.
  2114             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2115             88  CF-LANG-IS-FR                      VALUE 'F'.
  2116         16  FILLER                             PIC  X(240).
  2117
  2118****************************************************************
  2119*             PROCESSOR/REMINDERS RECORD                       *
  2120****************************************************************
  2121
  2122     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2123         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2124             20  CF-START-REMIND-DT         PIC XX.
  2125             20  CF-END-REMIND-DT           PIC XX.
  2126             20  CF-REMINDER-TEXT           PIC X(50).
  2127         16  FILLER                         PIC X(296).
  2128
  2129
  2130****************************************************************
  2131*             STATE MASTER RECORD                              *
  2132****************************************************************
  2133
  2134     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2135         16  CF-STATE-ABBREVIATION          PIC XX.
  2136         16  CF-STATE-NAME                  PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6523.cbl
  2137         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2138         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2139             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2140             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2141             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2142             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2143                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2144                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2145             20  CF-ST-PREM-REJECT-SW       PIC X.
  2146                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2147                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2148             20  CF-ST-REF-REJECT-SW        PIC X.
  2149                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2150                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2151         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2152         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2153         16  CF-ST-REFUND-RULES.
  2154             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2155             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2156             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2157         16  CF-ST-FST-PMT-EXTENSION.
  2158             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2159             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2160                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2161                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2162                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2163                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2164         16  CF-ST-STATE-CALL.
  2165             20  CF-ST-CALL-UNEARNED        PIC X.
  2166             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2167             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2168         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2169             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2170             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2171         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2172         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2173         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2174         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2175         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2176         16  FILLER                         PIC X.
  2177         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2178             20  CF-ST-BENEFIT-CD           PIC XX.
  2179             20  CF-ST-BENEFIT-KIND         PIC X.
  2180                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2181                 88  CF-ST-AH-KIND              VALUE 'A'.
  2182             20  CF-ST-REM-TERM-CALC        PIC X.
  2183                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2184                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2185                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2186                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2187                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2188                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2189                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2190                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2191
  2192             20  CF-ST-REFUND-CALC          PIC X.
  2193                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2194                 88  ST-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6523.cbl
  2195                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2196                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2197                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2198                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2199                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2200                 88  ST-REFD-UTAH               VALUE '7'.
  2201                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2202                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2203                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2204
  2205             20  CF-ST-EARNING-CALC         PIC X.
  2206                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2207                 88  ST-EARN-BY-R78             VALUE '1'.
  2208                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2209                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2210                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2211                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2212                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2213                 88  ST-EARN-MEAN               VALUE '8'.
  2214                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2215
  2216             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2217                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2218                 88  ST-OVRD-BY-R78             VALUE '1'.
  2219                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2220                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2221                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2222                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2223                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2224                 88  ST-OVRD-MEAN               VALUE '8'.
  2225                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2226             20  FILLER                     PIC X.
  2227
  2228         16  CF-ST-COMMISSION-CAPS.
  2229             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2230             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2231             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2232             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2233         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2234                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2235
  2236         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2237
  2238         16  CF-ST-STATUTORY-INTEREST.
  2239             20  CF-ST-STAT-DATE-FROM       PIC X.
  2240                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2241                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2242             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2243             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2244             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2245             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2246             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2247
  2248         16  CF-ST-OVER-SHORT.
  2249             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2250             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2251
  2252         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6523.cbl
  2253
  2254         16  CF-ST-RT-CALC                  PIC X.
  2255
  2256         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2257         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2258         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2259         16  CF-ST-RF-LR-CALC               PIC X.
  2260         16  CF-ST-RF-LL-CALC               PIC X.
  2261         16  CF-ST-RF-LN-CALC               PIC X.
  2262         16  CF-ST-RF-AH-CALC               PIC X.
  2263         16  CF-ST-RF-CP-CALC               PIC X.
  2264*        16  FILLER                         PIC X(206).
  2265*CIDMOD         16  FILLER                         PIC X(192).
  2266         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2267             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2268         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2269         16  FILLER                         PIC X(187).
  2270
  2271****************************************************************
  2272*             BENEFIT MASTER RECORD                            *
  2273****************************************************************
  2274
  2275     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2276         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2277             20  CF-BENEFIT-CODE            PIC XX.
  2278             20  CF-BENEFIT-NUMERIC  REDEFINES
  2279                 CF-BENEFIT-CODE            PIC XX.
  2280             20  CF-BENEFIT-ALPHA           PIC XXX.
  2281             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2282             20  CF-BENEFIT-COMMENT         PIC X(10).
  2283
  2284             20  CF-LF-COVERAGE-TYPE        PIC X.
  2285                 88  CF-REDUCING                VALUE 'R'.
  2286                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2287
  2288             20  CF-SPECIAL-CALC-CD         PIC X.
  2289                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2290                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2291                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2292                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2293                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2294                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2295                 88  CF-FARM-PLAN               VALUE 'F'.
  2296                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2297                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2298                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2299                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2300                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2301                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2302                 88  CF-PRUDENTIAL              VALUE 'P'.
  2303                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2304                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2305                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2306                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2307                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2308                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2309
  2310             20  CF-JOINT-INDICATOR         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6523.cbl
  2311                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2312
  2313*            20  FILLER                     PIC X(12).
  2314             20  FILLER                     PIC X(11).
  2315             20  CF-BENEFIT-CATEGORY        PIC X.
  2316             20  CF-LOAN-TYPE               PIC X(8).
  2317
  2318             20  CF-CO-REM-TERM-CALC        PIC X.
  2319                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2320                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2321                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2322                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2323                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2324
  2325             20  CF-CO-EARNINGS-CALC        PIC X.
  2326                 88  CO-EARN-BY-R78             VALUE '1'.
  2327                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2328                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2329                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2330                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2331                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2332                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2333                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2334
  2335             20  CF-CO-REFUND-CALC          PIC X.
  2336                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2337                 88  CO-REFD-BY-R78             VALUE '1'.
  2338                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2339                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2340                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2341                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2342                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2343                 88  CO-REFD-MEAN               VALUE '8'.
  2344                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2345                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2346                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2347
  2348             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2349                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2350                 88  CO-OVRD-BY-R78             VALUE '1'.
  2351                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2352                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2353                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2354                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2355                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2356                 88  CO-OVRD-MEAN               VALUE '8'.
  2357                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2358
  2359             20  CF-CO-BEN-I-G-CD           PIC X.
  2360                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2361                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2362                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2363
  2364         16  FILLER                         PIC X(304).
  2365
  2366
  2367****************************************************************
  2368*             CARRIER MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6523.cbl
  2369****************************************************************
  2370
  2371     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2372         16  CF-ADDRESS-DATA.
  2373             20  CF-MAIL-TO-NAME            PIC X(30).
  2374             20  CF-IN-CARE-OF              PIC X(30).
  2375             20  CF-ADDRESS-LINE-1          PIC X(30).
  2376             20  CF-ADDRESS-LINE-2          PIC X(30).
  2377             20  CF-CITY-STATE              PIC X(30).
  2378             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2379             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2380
  2381         16  CF-CLAIM-NO-CONTROL.
  2382             20  CF-CLAIM-NO-METHOD         PIC X.
  2383                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2384                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2385                 88  CLAIM-NO-SEQ               VALUE '3'.
  2386                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2387             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2388                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2389                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2390                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2391
  2392         16  CF-CHECK-NO-CONTROL.
  2393             20  CF-CHECK-NO-METHOD         PIC X.
  2394                 88  CHECK-NO-MANUAL            VALUE '1'.
  2395                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2396                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2397                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2398             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2399                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2400
  2401         16  CF-DOMICILE-STATE              PIC XX.
  2402
  2403         16  CF-EXPENSE-CONTROLS.
  2404             20  CF-EXPENSE-METHOD          PIC X.
  2405                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2406                 88  DOLLARS-PER-PMT            VALUE '2'.
  2407                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2408                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2409             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2410             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2411
  2412         16  CF-CORRESPONDENCE-CONTROL.
  2413             20  CF-LETTER-RESEND-OPT       PIC X.
  2414                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2415                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2416             20  FILLER                     PIC X(4).
  2417
  2418         16  CF-RESERVE-CONTROLS.
  2419             20  CF-MANUAL-SW               PIC X.
  2420                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2421             20  CF-FUTURE-SW               PIC X.
  2422                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2423             20  CF-PTC-SW                  PIC X.
  2424                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2425             20  CF-IBNR-SW                 PIC X.
  2426                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6523.cbl
  2427             20  CF-PTC-LF-SW               PIC X.
  2428                 88  CF-LF-PTC-USED             VALUE '1'.
  2429             20  CF-CDT-ACCESS-METHOD       PIC X.
  2430                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2431                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2432                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2433             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2434
  2435         16  CF-CLAIM-CALC-METHOD           PIC X.
  2436             88  360-PLUS-MONTHS                VALUE '1'.
  2437             88  365-PLUS-MONTHS                VALUE '2'.
  2438             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2439             88  360-DAILY                      VALUE '4'.
  2440             88  365-DAILY                      VALUE '5'.
  2441
  2442         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2443         16  FILLER                         PIC X(11).
  2444
  2445         16  CF-LIMIT-AMOUNTS.
  2446             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2447             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2448             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2449             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2450             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2451             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2452             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2453             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2454             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2455             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2456
  2457         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2458         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2459         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2460
  2461         16  CF-ZIP-CODE.
  2462             20  CF-ZIP-PRIME.
  2463                 24  CF-ZIP-1ST             PIC X.
  2464                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2465                 24  FILLER                 PIC X(4).
  2466             20  CF-ZIP-PLUS4               PIC X(4).
  2467         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2468             20  CF-CAN-POSTAL-1            PIC XXX.
  2469             20  CF-CAN-POSTAL-2            PIC XXX.
  2470             20  FILLER                     PIC XXX.
  2471
  2472         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2473         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2474         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2475
  2476         16  CF-RATING-SWITCH               PIC X.
  2477             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2478             88  CF-NO-RATING                   VALUE 'N'.
  2479
  2480         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2481
  2482         16  CF-CARRIER-OVER-SHORT.
  2483             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2484             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6523.cbl
  2485
  2486         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2487         16  CF-SECPAY-SWITCH               PIC X.
  2488             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2489             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2490         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2491         16  FILLER                         PIC X(448).
  2492*        16  FILLER                         PIC X(452).
  2493
  2494
  2495****************************************************************
  2496*             MORTALITY MASTER RECORD                          *
  2497****************************************************************
  2498
  2499     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2500         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2501                                INDEXED BY CF-MORT-NDX.
  2502             20  CF-MORT-TABLE              PIC X(5).
  2503             20  CF-MORT-TABLE-TYPE         PIC X.
  2504                 88  CF-MORT-JOINT              VALUE 'J'.
  2505                 88  CF-MORT-SINGLE             VALUE 'S'.
  2506                 88  CF-MORT-COMBINED           VALUE 'C'.
  2507                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2508                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2509             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2510             20  CF-MORT-AGE-METHOD         PIC XX.
  2511                 88  CF-AGE-LAST                VALUE 'AL'.
  2512                 88  CF-AGE-NEAR                VALUE 'AN'.
  2513             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2514             20  CF-MORT-ADJUSTMENT-DIRECTION
  2515                                            PIC X.
  2516                 88  CF-MINUS                   VALUE '-'.
  2517                 88  CF-PLUS                    VALUE '+'.
  2518             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2519             20  CF-MORT-JOINT-CODE         PIC X.
  2520                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2521             20  CF-MORT-PC-Q               PIC X.
  2522                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2523             20  CF-MORT-TABLE-CODE         PIC X(4).
  2524             20  CF-MORT-COMMENTS           PIC X(15).
  2525             20  FILLER                     PIC X(14).
  2526
  2527         16  FILLER                         PIC X(251).
  2528
  2529
  2530****************************************************************
  2531*             BUSSINESS TYPE MASTER RECORD                     *
  2532****************************************************************
  2533
  2534     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2535* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2536* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2537* AND RECORD 05 IS TYPES 81-99
  2538         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2539             20  CF-BUSINESS-TITLE          PIC  X(19).
  2540             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2541                                            PIC S9V9(4) COMP-3.
  2542             20  CF-BUS-EXCL-ST-CALL        PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6523.cbl
  2543             20  FILLER                     PIC  X.
  2544         16  FILLER                         PIC  X(248).
  2545
  2546
  2547****************************************************************
  2548*             TERMINAL MASTER RECORD                           *
  2549****************************************************************
  2550
  2551     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2552
  2553         16  CF-COMPANY-TERMINALS.
  2554             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2555                                  PIC X(4).
  2556         16  FILLER               PIC X(248).
  2557
  2558
  2559****************************************************************
  2560*             LIFE EDIT MASTER RECORD                          *
  2561****************************************************************
  2562
  2563     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2564         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2565             20  CF-LIFE-CODE-IN            PIC XX.
  2566             20  CF-LIFE-CODE-OUT           PIC XX.
  2567         16  FILLER                         PIC X(248).
  2568
  2569
  2570****************************************************************
  2571*             AH EDIT MASTER RECORD                            *
  2572****************************************************************
  2573
  2574     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2575         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2576             20  CF-AH-CODE-IN              PIC XXX.
  2577             20  CF-AH-CODE-OUT             PIC XX.
  2578         16  FILLER                         PIC X(248).
  2579
  2580
  2581****************************************************************
  2582*             CREDIBILITY TABLES                               *
  2583****************************************************************
  2584
  2585     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2586         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2587                             INDEXED BY CF-CRDB-NDX.
  2588             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2589             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2590             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2591         16  FILLER                         PIC  X(332).
  2592
  2593
  2594****************************************************************
  2595*             REPORT CUSTOMIZATION RECORD                      *
  2596****************************************************************
  2597
  2598     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2599         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2600             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6523.cbl
  2601             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2602             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2603**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2604****       A T-TRANSFER.                                   ****
  2605             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2606
  2607         16  FILLER                         PIC XX.
  2608
  2609         16  CF-CARRIER-CNTL-OPT.
  2610             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2611                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2612                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2613             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2614                                            PIC X.
  2615         16  CF-GROUP-CNTL-OPT.
  2616             20  CF-GROUP-OPT-SEQ           PIC 9.
  2617                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2618                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2619             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2620                                            PIC X(6).
  2621         16  CF-STATE-CNTL-OPT.
  2622             20  CF-STATE-OPT-SEQ           PIC 9.
  2623                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2624                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2625             20  CF-STATE-SELECT OCCURS 3 TIMES
  2626                                            PIC XX.
  2627         16  CF-ACCOUNT-CNTL-OPT.
  2628             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2629                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2630                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2631             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2632                                            PIC X(10).
  2633         16  CF-BUS-TYP-CNTL-OPT.
  2634             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2635                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2636                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2637             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2638                                            PIC XX.
  2639         16  CF-LF-TYP-CNTL-OPT.
  2640             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2641                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2642                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2643             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2644                                            PIC XX.
  2645         16  CF-AH-TYP-CNTL-OPT.
  2646             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2647                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2648                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2649             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2650                                            PIC XX.
  2651         16  CF-REPTCD1-CNTL-OPT.
  2652             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2653                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2654                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2655             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2656                                            PIC X(10).
  2657         16  CF-REPTCD2-CNTL-OPT.
  2658             20  CF-REPTCD2-OPT-SEQ         PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6523.cbl
  2659                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2660                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2661             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2662                                            PIC X(10).
  2663         16  CF-USER1-CNTL-OPT.
  2664             20  CF-USER1-OPT-SEQ           PIC 9.
  2665                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2666                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2667             20  CF-USER1-SELECT OCCURS 3 TIMES
  2668                                            PIC X(10).
  2669         16  CF-USER2-CNTL-OPT.
  2670             20  CF-USER2-OPT-SEQ           PIC 9.
  2671                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2672                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2673             20  CF-USER2-SELECT OCCURS 3 TIMES
  2674                                            PIC X(10).
  2675         16  CF-USER3-CNTL-OPT.
  2676             20  CF-USER3-OPT-SEQ           PIC 9.
  2677                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2678                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2679             20  CF-USER3-SELECT OCCURS 3 TIMES
  2680                                            PIC X(10).
  2681         16  CF-USER4-CNTL-OPT.
  2682             20  CF-USER4-OPT-SEQ           PIC 9.
  2683                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2684                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2685             20  CF-USER4-SELECT OCCURS 3 TIMES
  2686                                            PIC X(10).
  2687         16  CF-USER5-CNTL-OPT.
  2688             20  CF-USER5-OPT-SEQ           PIC 9.
  2689                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2690                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2691             20  CF-USER5-SELECT OCCURS 3 TIMES
  2692                                            PIC X(10).
  2693         16  CF-REINS-CNTL-OPT.
  2694             20  CF-REINS-OPT-SEQ           PIC 9.
  2695                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2696                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2697             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2698                 24  CF-REINS-PRIME         PIC XXX.
  2699                 24  CF-REINS-SUB           PIC XXX.
  2700
  2701         16  CF-AGENT-CNTL-OPT.
  2702             20  CF-AGENT-OPT-SEQ           PIC 9.
  2703                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2704                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2705             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2706                                            PIC X(10).
  2707
  2708         16  FILLER                         PIC X(43).
  2709
  2710         16  CF-LOSS-RATIO-SELECT.
  2711             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2712             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2713         16  CF-ENTRY-DATE-SELECT.
  2714             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2715             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2716         16  CF-EFFECTIVE-DATE-SELECT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6523.cbl
  2717             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2718             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2719
  2720         16  CF-EXCEPTION-LIST-IND          PIC X.
  2721             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2722
  2723         16  FILLER                         PIC X(318).
  2724
  2725****************************************************************
  2726*                  EXCEPTION REPORTING RECORD                  *
  2727****************************************************************
  2728
  2729     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2730         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2731             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2732
  2733         16  CF-COMBINED-LIFE-AH-OPT.
  2734             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2735             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2736             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2737             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2738
  2739         16  CF-LIFE-OPT.
  2740             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2741             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2742             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2743             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2744             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2745             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2746             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2747             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2748             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2749             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2750
  2751         16  CF-AH-OPT.
  2752             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2753             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2754             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2755             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2756             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2757             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2758             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2759             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2760             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2761             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2762
  2763         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2764             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2765             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2766             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2767
  2768         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2769
  2770         16  FILLER                         PIC X(673).
  2771
  2772
  2773****************************************************************
  2774*             MORTGAGE SYSTEM PLAN RECORD                      *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6523.cbl
  2775****************************************************************
  2776
  2777     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2778         16  CF-PLAN-TYPE                   PIC X.
  2779             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2780             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2781             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2782         16  CF-PLAN-ABBREV                 PIC XXX.
  2783         16  CF-PLAN-DESCRIPT               PIC X(10).
  2784         16  CF-PLAN-NOTES                  PIC X(20).
  2785         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2786         16  CF-PLAN-UNDERWRITING.
  2787             20  CF-PLAN-TERM-DATA.
  2788                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2789                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2790             20  CF-PLAN-AGE-DATA.
  2791                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2792                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2793                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2794             20  CF-PLAN-BENEFIT-DATA.
  2795                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2796                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2797                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2798                                            PIC S9(7)V99  COMP-3.
  2799         16  CF-PLAN-POLICY-FORMS.
  2800             20  CF-POLICY-FORM             PIC X(12).
  2801             20  CF-MASTER-APPLICATION      PIC X(12).
  2802             20  CF-MASTER-POLICY           PIC X(12).
  2803         16  CF-PLAN-RATING.
  2804             20  CF-RATE-CODE               PIC X(5).
  2805             20  CF-SEX-RATING              PIC X.
  2806                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2807                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2808             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2809             20  CF-SUB-STD-TYPE            PIC X.
  2810                 88  CF-PCT-OF-PREM            VALUE '1'.
  2811                 88  CF-PCT-OF-BENE            VALUE '2'.
  2812         16  CF-PLAN-PREM-TOLERANCES.
  2813             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2814             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2815         16  CF-PLAN-PYMT-TOLERANCES.
  2816             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2817             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2818         16  CF-PLAN-MISC-DATA.
  2819             20  FILLER                     PIC X.
  2820             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2821             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2822         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2823         16  CF-PLAN-IND-GRP                PIC X.
  2824             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2825                                                     '1'.
  2826             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2827                                                     '2'.
  2828         16  CF-MIB-SEARCH-SW               PIC X.
  2829             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2830             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2831             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2832             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6523.cbl
  2833         16  CF-ALPHA-SEARCH-SW             PIC X.
  2834             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2835             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2836             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2837             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2838             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2839             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2840             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2841             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2842             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2843             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2844                                                     'A' 'B' 'C'
  2845                                                     'X' 'Y' 'Z'.
  2846         16  CF-EFF-DT-RULE-SW              PIC X.
  2847             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2848             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2849             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2850             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2851             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2852         16  FILLER                         PIC X(4).
  2853         16  CF-HEALTH-QUESTIONS            PIC X.
  2854             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2855         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2856         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2857         16  CF-PLAN-SNGL-JNT               PIC X.
  2858             88  CF-COMBINED-PLAN              VALUE 'C'.
  2859             88  CF-JNT-PLAN                   VALUE 'J'.
  2860             88  CF-SNGL-PLAN                  VALUE 'S'.
  2861         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2862         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2863         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2864         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2865         16  CF-RERATE-CNTL                 PIC  X.
  2866             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2867             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2868             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2869             88  CF-AUTO-RECALC                 VALUE '4'.
  2870         16  CF-BENEFIT-TYPE                PIC  X.
  2871             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2872             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2873         16  CF-POLICY-FEE                  PIC S999V99
  2874                                                    COMP-3.
  2875         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2876         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2877         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2878         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2879         16  FILLER                         PIC  X(32).
  2880         16  CF-TERMINATION-FORM            PIC  X(04).
  2881         16  FILLER                         PIC  X(08).
  2882         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2883                                                       COMP-3.
  2884         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2885         16  CF-ISSUE-LETTER                PIC  X(4).
  2886         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2887         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2888             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2889             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2890         16  CF-MP-REFUND-CALC              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6523.cbl
  2891             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2892             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2893             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2894             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2895             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2896             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2897             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2898             88  CF-MP-REFD-MEAN                VALUE '8'.
  2899         16  CF-ALT-RATE-CODE               PIC  X(5).
  2900
  2901
  2902         16  FILLER                         PIC X(498).
  2903****************************************************************
  2904*             MORTGAGE COMPANY MASTER RECORD                   *
  2905****************************************************************
  2906
  2907     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2908         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2909         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2910             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2911             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2912             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2913             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2914             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2915
  2916         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2917         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2918         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2919         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2920         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2921
  2922         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2923             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2924         16  CF-MP-RECON-USE-IND            PIC X(1).
  2925             88  CF-MP-USE-RECON             VALUE 'Y'.
  2926         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2927             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2928         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2929             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2930             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2931         16  FILLER                         PIC X(1).
  2932         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2933             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2934         16  CF-MORTG-MIB-VERSION           PIC X.
  2935             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2936             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2937             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2938         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2939             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2940                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2941             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2942                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2943             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2944                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2945             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2946                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2947             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2948                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6523.cbl
  2949             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2950                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2951         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2952         16  FILLER                         PIC X(7).
  2953         16  CF-MORTG-DESTINATION-SYMBOL.
  2954             20  CF-MORTG-MIB-COMM          PIC X(5).
  2955             20  CF-MORTG-MIB-TERM          PIC X(5).
  2956         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2957             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2958         16  FILLER                         PIC X(03).
  2959         16  CF-MP-CHECK-NO-CONTROL.
  2960             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2961                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2962                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2963                                                ' ' LOW-VALUES.
  2964                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2965                                               VALUE '3'.
  2966         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2967         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2968         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2969             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2970                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2971             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2972                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2973             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2974                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2975             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2976                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2977             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2978                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2979             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2980                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2981         16  CF-MORTG-BILLING-AREA.
  2982             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2983                                            PIC X.
  2984         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2985         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2986         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2987         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2988             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2989             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2990         16  FILLER                         PIC X.
  2991         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2992             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2993             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2994         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2995         16  FILLER                         PIC X(8).
  2996         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2997         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2998         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2999         16  CF-ACH-COMPANY-ID.
  3000             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3001                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3002                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3003                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3004             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3005         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3006             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6523.cbl
  3007         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3008             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3009             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3010         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3011         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3012         16  FILLER                         PIC X(536).
  3013
  3014****************************************************************
  3015*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3016****************************************************************
  3017
  3018     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3019         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3020             20  CF-FEMALE-HEIGHT.
  3021                 24  CF-FEMALE-FT           PIC 99.
  3022                 24  CF-FEMALE-IN           PIC 99.
  3023             20  CF-FEMALE-MIN-WT           PIC 999.
  3024             20  CF-FEMALE-MAX-WT           PIC 999.
  3025         16  FILLER                         PIC X(428).
  3026
  3027     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3028         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3029             20  CF-MALE-HEIGHT.
  3030                 24  CF-MALE-FT             PIC 99.
  3031                 24  CF-MALE-IN             PIC 99.
  3032             20  CF-MALE-MIN-WT             PIC 999.
  3033             20  CF-MALE-MAX-WT             PIC 999.
  3034         16  FILLER                         PIC X(428).
  3035******************************************************************
  3036*             AUTOMATIC ACTIVITY RECORD                          *
  3037******************************************************************
  3038     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3039         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3040             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3041             20  CF-SYS-LETTER-ID           PIC X(04).
  3042             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3043             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3044             20  CF-SYS-RESET-SW            PIC X(01).
  3045             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3046             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3047
  3048         16  FILLER                         PIC X(50).
  3049
  3050         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3051             20  CF-USER-ACTIVE-SW          PIC X(01).
  3052             20  CF-USER-LETTER-ID          PIC X(04).
  3053             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3054             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3055             20  CF-USER-RESET-SW           PIC X(01).
  3056             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3057             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3058             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3059
  3060         16  FILLER                         PIC X(246).
  3061*                                COPY ERCBXRF.
  3062******************************************************************
  3063*                                                                *
  3064*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6523.cbl
  3065*                            ERCBXRF                             *
  3066*                                                                *
  3067*   ONLINE CREDIT SYSTEM                                         *
  3068*                                                                *
  3069*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  3070*                                                                *
  3071*   FILE TYPE = VSAM,KSDS                                        *
  3072*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  3073*                                                                *
  3074*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  3075*       ALTERNATE PATH = NONE                                    *
  3076*                                                                *
  3077*   LOG = NO                                                     *
  3078*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3079*                                                                *
  3080******************************************************************
  3081
  3082 01  BANK-CROSS-REFERENCE.
  3083     12  BK-RECORD-ID                PIC XX.
  3084         88  VALID-BK-ID             VALUE 'BK'.
  3085
  3086     12  BK-CONTROL-PRIMARY.
  3087         16  BK-COMPANY-CD           PIC X.
  3088         16  BK-CARRIER              PIC X.
  3089         16  BK-GROUPING             PIC X(6).
  3090         16  BK-BANK-NO              PIC X(10).
  3091
  3092     12  BK-MAINT-INFORMATION.
  3093         16  BK-LAST-MAINT-DT        PIC XX.
  3094         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  3095         16  BK-LAST-MAINT-USER      PIC X(4).
  3096         16  FILLER                  PIC X(9).
  3097
  3098     12  FILLER                      PIC X(37).
  3099
  3100     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  3101
  3102     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  3103                            DEPENDING ON BK-BANK-POINTER-CNT.
  3104         16  BK-AM-ACCOUNT           PIC X(10).
  3105         16  BK-AM-EXP-DT            PIC XX.
  3106         16  BK-AM-EFF-DT            PIC XX.
  3107         16  BK-AM-STATE             PIC XX.
  3108         16  FILLER                  PIC X(20).
  3109
  3110******************************************************************
  3111*                                COPY ERCACCT.
  3112******************************************************************
  3113*                                                                *
  3114*                                                                *
  3115*                            ERCACCT                             *
  3116*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3117*                            VMOD=2.031                          *
  3118*                                                                *
  3119*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3120*                                                                *
  3121*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3122*   VSAM ACCOUNT MASTER FILES.                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6523.cbl
  3123*                                                                *
  3124*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3125*                                                                *
  3126*   FILE TYPE = VSAM,KSDS                                        *
  3127*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3128*                                                                *
  3129*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3130*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3131*                                                                *
  3132*   LOG = NO                                                     *
  3133*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3134*                                                                *
  3135*                                                                *
  3136******************************************************************
  3137*                   C H A N G E   L O G
  3138*
  3139* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3140*-----------------------------------------------------------------
  3141*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3142* EFFECTIVE    NUMBER
  3143*-----------------------------------------------------------------
  3144* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3145* 092705    2005050300006  PEMA  ADD SPP LEASES
  3146* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3147* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3148******************************************************************
  3149
  3150 01  ACCOUNT-MASTER.
  3151     12  AM-RECORD-ID                      PIC XX.
  3152         88  VALID-AM-ID                      VALUE 'AM'.
  3153
  3154     12  AM-CONTROL-PRIMARY.
  3155         16  AM-COMPANY-CD                 PIC X.
  3156         16  AM-MSTR-CNTRL.
  3157             20  AM-CONTROL-A.
  3158                 24  AM-CARRIER            PIC X.
  3159                 24  AM-GROUPING.
  3160                     28 AM-GROUPING-PREFIX PIC XXX.
  3161                     28 AM-GROUPING-PRIME  PIC XXX.
  3162                 24  AM-STATE              PIC XX.
  3163                 24  AM-ACCOUNT.
  3164                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3165                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3166             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3167                                           PIC X(19).
  3168             20  AM-CNTRL-B.
  3169                 24  AM-EXPIRATION-DT      PIC XX.
  3170                 24  FILLER                PIC X(4).
  3171             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3172                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3173
  3174     12  AM-CONTROL-BY-VAR-GRP.
  3175         16  AM-COMPANY-CD-A1              PIC X.
  3176         16  AM-VG-CARRIER                 PIC X.
  3177         16  AM-VG-GROUPING                PIC X(6).
  3178         16  AM-VG-STATE                   PIC XX.
  3179         16  AM-VG-ACCOUNT                 PIC X(10).
  3180         16  AM-VG-DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6523.cbl
  3181             20  AM-VG-EXPIRATION-DT       PIC XX.
  3182             20  FILLER                    PIC X(4).
  3183         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3184                                           PIC 9(11)      COMP-3.
  3185     12  AM-MAINT-INFORMATION.
  3186         16  AM-LAST-MAINT-DT              PIC XX.
  3187         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3188         16  AM-LAST-MAINT-USER            PIC X(4).
  3189         16  FILLER                        PIC XX.
  3190
  3191     12  AM-EFFECTIVE-DT                   PIC XX.
  3192     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3193
  3194     12  AM-PREV-DATES  COMP-3.
  3195         16  AM-PREV-EXP-DT                PIC 9(11).
  3196         16  AM-PREV-EFF-DT                PIC 9(11).
  3197
  3198     12  AM-REPORT-CODE-1                  PIC X(10).
  3199     12  AM-REPORT-CODE-2                  PIC X(10).
  3200
  3201     12  AM-CITY-CODE                      PIC X(4).
  3202     12  AM-COUNTY-PARISH                  PIC X(6).
  3203
  3204     12  AM-NAME                           PIC X(30).
  3205     12  AM-PERSON                         PIC X(30).
  3206     12  AM-ADDRS                          PIC X(30).
  3207     12  AM-CITY.
  3208         16  AM-ADDR-CITY                  PIC X(28).
  3209         16  AM-ADDR-STATE                 PIC XX.
  3210     12  AM-ZIP.
  3211         16  AM-ZIP-PRIME.
  3212             20  AM-ZIP-PRI-1ST            PIC X.
  3213                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3214             20  FILLER                    PIC X(4).
  3215         16  AM-ZIP-PLUS4                  PIC X(4).
  3216     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3217         16  AM-CAN-POSTAL-1               PIC XXX.
  3218         16  AM-CAN-POSTAL-2               PIC XXX.
  3219         16  FILLER                        PIC XXX.
  3220     12  AM-TEL-NO.
  3221         16  AM-AREA-CODE                  PIC 999.
  3222         16  AM-TEL-PRE                    PIC 999.
  3223         16  AM-TEL-NBR                    PIC 9(4).
  3224     12  AM-TEL-LOC                        PIC X.
  3225         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3226         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3227
  3228     12  AM-COMM-STRUCTURE.
  3229         16  AM-DEFN-1.
  3230             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3231                 24  AM-AGT.
  3232                     28  AM-AGT-PREFIX     PIC X(4).
  3233                     28  AM-AGT-PRIME      PIC X(6).
  3234                 24  AM-COM-TYP            PIC X.
  3235                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3236                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3237                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3238                 24  AM-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6523.cbl
  3239                 24  AM-RETRO-LV-INDIC     PIC X.
  3240                 24  AM-GL-CODES           PIC X.
  3241                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3242                 24  FILLER                PIC X(01).
  3243         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3244             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3245                 24  FILLER                PIC X(11).
  3246                 24  AM-L-COMA             PIC XXX.
  3247                 24  AM-J-COMA             PIC XXX.
  3248                 24  AM-A-COMA             PIC XXX.
  3249                 24  FILLER                PIC X(6).
  3250
  3251     12  AM-COMM-CHANGE-STATUS             PIC X.
  3252         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3253
  3254     12  AM-CSR-CODE                       PIC X(4).
  3255
  3256     12  AM-BILLING-STATUS                 PIC X.
  3257         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3258         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3259     12  AM-AUTO-REFUND-SW                 PIC X.
  3260         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3261         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3262     12  AM-GPCD                           PIC 99.
  3263     12  AM-IG                             PIC X.
  3264         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3265         88  AM-HAS-GROUP                     VALUE '2'.
  3266     12  AM-STATUS                         PIC X.
  3267         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3268         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3269         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3270         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3271         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3272     12  AM-REMIT-TO                       PIC 99.
  3273     12  AM-ID-NO                          PIC X(11).
  3274
  3275     12  AM-CAL-TABLE                      PIC XX.
  3276     12  AM-LF-DEVIATION                   PIC XXX.
  3277     12  AM-AH-DEVIATION                   PIC XXX.
  3278     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3279     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3280     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3281     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3282     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3283     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3284
  3285     12  AM-USER-FIELDS.
  3286         16  AM-FLD-1                      PIC XX.
  3287         16  AM-FLD-2                      PIC XX.
  3288         16  AM-FLD-3                      PIC XX.
  3289         16  AM-FLD-4                      PIC XX.
  3290         16  AM-FLD-5                      PIC XX.
  3291
  3292     12  AM-1ST-PROD-DATE.
  3293         16  AM-1ST-PROD-YR                PIC XX.
  3294         16  AM-1ST-PROD-MO                PIC XX.
  3295         16  AM-1ST-PROD-DA                PIC XX.
  3296     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6523.cbl
  3297     12  AM-CERTS-PURGED-DATE.
  3298         16  AM-PUR-YR                     PIC XX.
  3299         16  AM-PUR-MO                     PIC XX.
  3300         16  AM-PUR-DA                     PIC XX.
  3301     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3302     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3303     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3304     12  AM-INACTIVE-DATE.
  3305         16  AM-INA-MO                     PIC 99.
  3306         16  AM-INA-DA                     PIC 99.
  3307         16  AM-INA-YR                     PIC 99.
  3308     12  AM-AR-HI-CERT-DATE                PIC XX.
  3309
  3310     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3311     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3312
  3313     12  AM-OB-PAYMENT-MODE                PIC X.
  3314         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3315         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3316         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3317         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3318
  3319     12  AM-AH-ONLY-INDICATOR              PIC X.
  3320         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3321         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3322
  3323     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3324
  3325     12  AM-OVER-SHORT.
  3326         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3327         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3328
  3329     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3330     12  AM-DCC-CLP-STATE                  PIC XX.
  3331
  3332     12  AM-RECALC-COMM                    PIC X.
  3333     12  AM-RECALC-REIN                    PIC X.
  3334
  3335     12  AM-REI-TABLE                      PIC XXX.
  3336     12  AM-REI-ET-LF                      PIC X.
  3337     12  AM-REI-ET-AH                      PIC X.
  3338     12  AM-REI-PE-LF                      PIC X.
  3339     12  AM-REI-PE-AH                      PIC X.
  3340     12  AM-REI-PRT-ST                     PIC X.
  3341     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3342     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3343     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3344     12  AM-REI-GROUP-A                    PIC X(6).
  3345     12  AM-REI-MORT                       PIC X(4).
  3346     12  AM-REI-PRT-OW                     PIC X.
  3347     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3348     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3349     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3350     12  AM-REI-GROUP-B                    PIC X(6).
  3351
  3352     12  AM-TRUST-TYPE                     PIC X(2).
  3353
  3354     12  AM-EMPLOYER-STMT-USED             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6523.cbl
  3355     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3356
  3357     12  AM-STD-AH-TYPE                    PIC XX.
  3358     12  AM-EARN-METHODS.
  3359         16  AM-EARN-METHOD-R              PIC X.
  3360             88 AM-REF-RL-R78                 VALUE 'R'.
  3361             88 AM-REF-RL-PR                  VALUE 'P'.
  3362             88 AM-REF-RL-MEAN                VALUE 'M'.
  3363             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3364         16  AM-EARN-METHOD-L              PIC X.
  3365             88 AM-REF-LL-R78                 VALUE 'R'.
  3366             88 AM-REF-LL-PR                  VALUE 'P'.
  3367             88 AM-REF-LL-MEAN                VALUE 'M'.
  3368             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3369         16  AM-EARN-METHOD-A              PIC X.
  3370             88 AM-REF-AH-R78                 VALUE 'R'.
  3371             88 AM-REF-AH-PR                  VALUE 'P'.
  3372             88 AM-REF-AH-MEAN                VALUE 'M'.
  3373             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3374             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3375             88 AM-REF-AH-NET                 VALUE 'N'.
  3376
  3377     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3378     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3379     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3380
  3381     12  AM-RET-Y-N                        PIC X.
  3382     12  AM-RET-P-E                        PIC X.
  3383     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3384     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3385     12  AM-RET-GRP                        PIC X(6).
  3386     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3387         16  AM-POOL-PRIME                 PIC XXX.
  3388         16  AM-POOL-SUB                   PIC XXX.
  3389     12  AM-RETRO-EARNINGS.
  3390         16  AM-RET-EARN-R                 PIC X.
  3391         16  AM-RET-EARN-L                 PIC X.
  3392         16  AM-RET-EARN-A                 PIC X.
  3393     12  AM-RET-ST-TAX-USE                 PIC X.
  3394         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3395         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3396     12  AM-RETRO-BEG-EARNINGS.
  3397         16  AM-RET-BEG-EARN-R             PIC X.
  3398         16  AM-RET-BEG-EARN-L             PIC X.
  3399         16  AM-RET-BEG-EARN-A             PIC X.
  3400     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3401     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3402
  3403     12  AM-USER-SELECT-OPTIONS.
  3404         16  AM-USER-SELECT-1              PIC X(10).
  3405         16  AM-USER-SELECT-2              PIC X(10).
  3406         16  AM-USER-SELECT-3              PIC X(10).
  3407         16  AM-USER-SELECT-4              PIC X(10).
  3408         16  AM-USER-SELECT-5              PIC X(10).
  3409
  3410     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3411
  3412     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6523.cbl
  3413
  3414     12  AM-RPT045A-SWITCH                 PIC X.
  3415         88  RPT045A-OFF                   VALUE 'N'.
  3416
  3417     12  AM-INSURANCE-LIMITS.
  3418         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3419         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3420
  3421     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3422         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3423
  3424     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3425         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3426         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3427
  3428     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3429
  3430     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3431     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3432     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3433     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3434     12  FILLER                            PIC X(5).
  3435     12  AM-REPORT-CODE-3                  PIC X(10).
  3436*    12  FILLER                            PIC X(22).
  3437
  3438     12  AM-RESERVE-DATE.
  3439         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3440         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3441         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3442
  3443     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3444     12  AM-NOTIFICATION-TYPES.
  3445         16  AM-NOTIF-OF-LETTERS           PIC X.
  3446         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3447         16  AM-NOTIF-OF-REPORTS           PIC X.
  3448         16  AM-NOTIF-OF-STATUS            PIC X.
  3449
  3450     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3451         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3452         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3453         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3454         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3455
  3456     12  AM-BENEFIT-CONTROLS.
  3457         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3458             20  AM-BENEFIT-CODE           PIC XX.
  3459             20  AM-BENEFIT-TYPE           PIC X.
  3460             20  AM-BENEFIT-REVISION       PIC XXX.
  3461             20  AM-BENEFIT-REM-TERM       PIC X.
  3462             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  3463             20  FILLER                    PIC XX.
  3464         16  FILLER                        PIC X(80).
  3465
  3466     12  AM-TRANSFER-DATA.
  3467         16  AM-TRANSFERRED-FROM.
  3468             20  AM-TRNFROM-CARRIER        PIC X.
  3469             20  AM-TRNFROM-GROUPING.
  3470                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6523.cbl
  3471                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3472             20  AM-TRNFROM-STATE          PIC XX.
  3473             20  AM-TRNFROM-ACCOUNT.
  3474                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3475                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3476             20  AM-TRNFROM-DTE            PIC XX.
  3477         16  AM-TRANSFERRED-TO.
  3478             20  AM-TRNTO-CARRIER          PIC X.
  3479             20  AM-TRNTO-GROUPING.
  3480                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3481                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3482             20  AM-TRNTO-STATE            PIC XX.
  3483             20  AM-TRNTO-ACCOUNT.
  3484                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3485                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3486             20  AM-TRNTO-DTE              PIC XX.
  3487         16  FILLER                        PIC X(10).
  3488
  3489     12  AM-SAVED-REMIT-TO                 PIC 99.
  3490
  3491     12  AM-COMM-STRUCTURE-SAVED.
  3492         16  AM-DEFN-1-SAVED.
  3493             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3494                 24  AM-AGT-SV             PIC X(10).
  3495                 24  AM-COM-TYP-SV         PIC X.
  3496                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3497                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3498                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3499                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3500                 24  FILLER                PIC X.
  3501                 24  AM-GL-CODES-SV        PIC X.
  3502                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3503                 24  FILLER                PIC X.
  3504         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3505             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3506                 24  FILLER                PIC X(11).
  3507                 24  AM-L-COMA-SV          PIC XXX.
  3508                 24  AM-J-COMA-SV          PIC XXX.
  3509                 24  AM-A-COMA-SV          PIC XXX.
  3510                 24  FILLER                PIC X(6).
  3511
  3512     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3513         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3514            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3515            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3516            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3517
  3518     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3519     12  FILLER                            PIC X(120).
  3520
  3521     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3522         16  AM-CONTROL-NAME               PIC X(30).
  3523         16  AM-EXECUTIVE-ONE.
  3524             20  AM-EXEC1-NAME             PIC X(15).
  3525             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3526                                                          COMP-3.
  3527             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3528                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6523.cbl
  3529         16  AM-EXECUTIVE-TWO.
  3530             20  AM-EXEC2-NAME             PIC X(15).
  3531             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3532                                                          COMP-3.
  3533             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3534                                                          COMP-3.
  3535
  3536     12  AM-RETRO-ADDITIONAL-DATA.
  3537         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3538         16  AM-RETRO-PREM-P-E             PIC X.
  3539         16  AM-RETRO-CLMS-P-I             PIC X.
  3540         16  AM-RETRO-RET-BRACKET-LF.
  3541             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3542                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3543                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3544             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3545                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3546                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3547             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3548                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3549                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3550         16  AM-RETRO-RET-BRACKET-AH.
  3551             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3552                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3553                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3554                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3555             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3556                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3557                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3558             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3559                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3560                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3561
  3562     12  AM-COMMENTS.
  3563         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3564
  3565     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3566         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3567         16  AM-FLI-BILLING-CODE           PIC X.
  3568         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3569         16  AM-FLI-UNITED-IDENT           PIC X.
  3570         16  AM-FLI-INTEREST-LOST-DATA.
  3571             20  AM-FLI-BANK-NO            PIC X(5).
  3572             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3573             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3574             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3575         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3576             20  AM-FLI-AGT                PIC X(9).
  3577             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3578             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3579         16  FILLER                        PIC X(102).
  3580
  3581     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3582         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3583             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3584             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3585             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3586             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6523.cbl
  3587             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3588         16  FILLER                          PIC X(10).
  3589******************************************************************
  3590 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  3591                          BANK-CROSS-REFERENCE ACCOUNT-MASTER.
  3592 0000-DFHEXIT SECTION.
  3593     MOVE '9#                    $   ' TO DFHEIV0.
  3594     MOVE 'EL6523' TO DFHEIV1.
  3595     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3596     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  3597     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  3598     MOVE '5'                   TO DC-OPTION-CODE.
  3599     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  3600     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  3601     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  3602     MOVE EIBTRMID              TO QID-TERM.
  3603
  3604* EXEC CICS HANDLE CONDITION
  3605*        ERROR     (9990-ABEND)
  3606*        MAPFAIL   (8100-SEND-INITIAL-MAP)
  3607*    END-EXEC.
  3608*    MOVE '"$.?                  ! " #00003599' TO DFHEIV0
  3609     MOVE X'22242E3F2020202020202020' TO DFHEIV0(1:12)
  3610     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3611     MOVE X'2220233030303033353939' TO DFHEIV0(25:11)
  3612     CALL 'kxdfhei1' USING DFHEIV0
  3613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3614
  3615     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3616         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3617*  THIS IS THE FIRST TIME THRU
  3618             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3619             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3620             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3621             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3622             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3623             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3624             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3625             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3626             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  3627         ELSE
  3628* THIS IS WHEN I COME BACK FROM WHERE I XCTL'D TO
  3629             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  3630             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3631             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3632             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3633             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3634             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3635             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3636             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  3637         END-IF
  3638* ALL SUBSEQUENT TIMES
  3639     END-IF
  3640     IF EIBTRNID = TRANS-ID
  3641         IF EIBAID = DFHCLEAR
  3642             GO TO 9400-CLEAR
  3643         ELSE
  3644             GO TO 0200-RECEIVE-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6523.cbl
  3645     IF EIBTRNID  = EL652-TRANS-ID
  3646* THIS IS WHEN I CAME FROM COMP MAINT
  3647         MOVE DFHENTER       TO EIBAID
  3648         MOVE PI-CR-CARRIER  TO CARRIERI
  3649         MOVE PI-CR-GROUPING TO GROUPI
  3650         MOVE PI-CR-FIN-RESP TO BANKI
  3651         MOVE 'S'            TO MAINTYPI
  3652         MOVE 1              TO CARRIERL
  3653         MOVE 6              TO GROUPL
  3654         MOVE 10             TO BANKL
  3655         MOVE 1              TO MAINTYPL
  3656         MOVE AL-UANON       TO CARRIERA GROUPA BANKA MAINTYPA
  3657         GO TO 4000-EDIT-MAINT
  3658     END-IF
  3659     MOVE LOW-VALUES       TO PI-ERBXRF-KEY    EL652DI.
  3660     MOVE PI-COMPANY-CD    TO PI-BXRF-COMP-CD  WS-COMPANY-CD.
  3661     IF EIBTRNID  = EL650-TRANS-ID
  3662* THIS IS WHEN I CAME FROM ACCOUNT MAINT
  3663         GO TO 0600-RECOVER-TEMP-STORAGE.
  3664     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6523.cbl
  3666 0200-RECEIVE-MAP.
  3667     MOVE LOW-VALUES             TO EL652DI
  3668
  3669* EXEC CICS RECEIVE
  3670*        MAP (MAP-NAME)
  3671*        MAPSET (MAPSET-NAME)
  3672*        INTO (EL652DI)
  3673*    END-EXEC
  3674     MOVE LENGTH OF
  3675      EL652DI
  3676       TO DFHEIV11
  3677*    MOVE '8"T I  L              ''   #00003656' TO DFHEIV0
  3678     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3679     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3680     MOVE X'2020233030303033363536' TO DFHEIV0(25:11)
  3681     CALL 'kxdfhei1' USING DFHEIV0,
  3682           MAP-NAME,
  3683           EL652DI,
  3684           DFHEIV11,
  3685           MAPSET-NAME,
  3686           DFHEIV99,
  3687           DFHEIV99
  3688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3689     IF PFENTERL = 0
  3690        GO TO 0300-CHECK-PFKEYS
  3691     END-IF
  3692     IF EIBAID NOT = DFHENTER
  3693        MOVE ER-0004             TO EMI-ERROR
  3694        GO TO 0320-INPUT-ERROR
  3695     END-IF
  3696     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  3697        MOVE PF-VALUES (PFENTERI)
  3698                                 TO EIBAID
  3699     ELSE
  3700        MOVE ER-0029             TO EMI-ERROR
  3701        GO TO 0320-INPUT-ERROR
  3702     END-IF
  3703     .
  3704 0300-CHECK-PFKEYS.
  3705     IF EIBAID = DFHPF23
  3706         GO TO 8810-PF23.
  3707     IF EIBAID = DFHPF24
  3708         GO TO 9200-RETURN-MAIN-MENU.
  3709     IF EIBAID = DFHPF12
  3710         GO TO 9500-PF12.
  3711     IF (MAINTYPL > ZERO)
  3712        AND (MAINTYPI NOT = 'D')
  3713        MOVE SPACES              TO PI-EL6523-DEL-SW
  3714     END-IF
  3715     IF EIBAID = DFHPF1 OR DFHPF2
  3716        GO TO 5000-BROWSE-FILE
  3717     END-IF
  3718     IF EIBAID = DFHPF3 OR DFHPF4
  3719         GO TO 6000-OCCURRENCE.
  3720     IF EIBAID = DFHPF5
  3721         GO TO 4000-ACCT-MAINT.
  3722     IF EIBAID = DFHENTER
  3723        GO TO 4000-EDIT-MAINT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL6523.cbl
  3724     END-IF
  3725     MOVE ER-0029                TO EMI-ERROR
  3726     .
  3727 0320-INPUT-ERROR.
  3728     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3729     MOVE -1                     TO CARRIERL.
  3730     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL6523.cbl
  3732 0500-CREATE-TEMP-STORAGE.
  3733
  3734* EXEC CICS WRITEQ TS
  3735*        QUEUE   (QID)
  3736*        FROM    (EL652DI)
  3737*        LENGTH  (QID-MAP-LENGTH)
  3738*        END-EXEC.
  3739*    MOVE '*"                    ''   #00003705' TO DFHEIV0
  3740     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  3741     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3742     MOVE X'2020233030303033373035' TO DFHEIV0(25:11)
  3743     CALL 'kxdfhei1' USING DFHEIV0,
  3744           QID,
  3745           EL652DI,
  3746           QID-MAP-LENGTH,
  3747           DFHEIV99,
  3748           DFHEIV99,
  3749           DFHEIV99
  3750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3751
  3752 0599-EXIT.
  3753      EXIT.
  3754 0600-RECOVER-TEMP-STORAGE.
  3755
  3756* EXEC CICS HANDLE CONDITION
  3757*        NOTFND  (1500-BXRF-NOT-FOUND)
  3758*        QIDERR  (0690-QIDERR)
  3759*        END-EXEC.
  3760*    MOVE '"$IN                  ! # #00003713' TO DFHEIV0
  3761     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  3762     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3763     MOVE X'2320233030303033373133' TO DFHEIV0(25:11)
  3764     CALL 'kxdfhei1' USING DFHEIV0
  3765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3766
  3767
  3768* EXEC CICS READQ TS
  3769*        QUEUE    (QID)
  3770*        INTO     (EL652DI)
  3771*        LENGTH   (QID-MAP-LENGTH)
  3772*        END-EXEC.
  3773*    MOVE '*$I    L              ''   #00003717' TO DFHEIV0
  3774     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3775     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3776     MOVE X'2020233030303033373137' TO DFHEIV0(25:11)
  3777     CALL 'kxdfhei1' USING DFHEIV0,
  3778           QID,
  3779           EL652DI,
  3780           QID-MAP-LENGTH,
  3781           DFHEIV99,
  3782           DFHEIV99,
  3783           DFHEIV99
  3784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3785
  3786
  3787* EXEC CICS DELETEQ TS
  3788*        QUEUE   (QID)
  3789*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL6523.cbl
  3790*    MOVE '*&                    #   #00003722' TO DFHEIV0
  3791     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3792     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3793     MOVE X'2020233030303033373232' TO DFHEIV0(25:11)
  3794     CALL 'kxdfhei1' USING DFHEIV0,
  3795           QID,
  3796           DFHEIV99
  3797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3798     IF CARRIERL NOT = 0
  3799         MOVE AL-UANON TO CARRIERA.
  3800     IF GROUPL NOT = 0
  3801         MOVE AL-UANON TO GROUPA.
  3802     IF BANKL NOT = 0
  3803         MOVE AL-UANON TO BANKA.
  3804     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD.
  3805     MOVE CARRIERO               TO WS-CARRIER.
  3806     MOVE GROUPO                 TO WS-GROUPING.
  3807     MOVE BANKO                  TO WS-BANK.
  3808     GO TO 1050-READ-BANK.
  3809 0690-QIDERR.
  3810     MOVE ER-0033                TO EMI-ERROR
  3811     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  3812     GO TO 8100-SEND-INITIAL-MAP
  3813     .
  3814 4000-EDIT-MAINT.
  3815     IF MAINTYPL > ZERO
  3816        MOVE MAINTYPI            TO PI-CHECK-MAINT-TYPE
  3817        IF VALID-MAINT-TYPE
  3818           MOVE AL-UANON         TO MAINTYPA
  3819        ELSE
  3820           MOVE -1               TO MAINTYPL
  3821           MOVE AL-UABON         TO MAINTYPA
  3822           MOVE ER-2039          TO EMI-ERROR
  3823           PERFORM 9900-ERROR-FORMAT
  3824                                 THRU  9900-EXIT
  3825        END-IF
  3826     ELSE
  3827        MOVE -1                  TO MAINTYPL
  3828        MOVE AL-UABON            TO MAINTYPA
  3829        MOVE ER-2039             TO EMI-ERROR
  3830        PERFORM 9900-ERROR-FORMAT
  3831                                 THRU 9900-EXIT
  3832     END-IF
  3833     MOVE PI-COMPANY-CD          TO PI-ERC-COMPANY-CD
  3834     IF (NOT MODIFY-CAP)
  3835        AND (NOT SHOW-FUNCTION)
  3836        MOVE 'UPDATE'            TO SM-READ
  3837        PERFORM 9995-SECURITY-VIOLATION
  3838                                 THRU 9995-EXIT
  3839        MOVE ER-0070             TO EMI-ERROR
  3840        PERFORM 9900-ERROR-FORMAT
  3841                                 THRU 9900-EXIT
  3842        GO TO 8100-SEND-INITIAL-MAP
  3843     END-IF
  3844     IF CARRIERL > ZERO
  3845        IF PI-CARRIER-SECURITY > SPACES
  3846           IF CARRIERI = PI-CARRIER-SECURITY
  3847              CONTINUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL6523.cbl
  3848           ELSE
  3849              MOVE -1            TO CARRIERL
  3850              MOVE ER-2370       TO EMI-ERROR
  3851              PERFORM 9900-ERROR-FORMAT
  3852                                 THRU 9900-EXIT
  3853              MOVE AL-UABON      TO CARRIERA
  3854              GO TO 8200-SEND-DATAONLY
  3855           END-IF
  3856        END-IF
  3857     END-IF
  3858     IF CARRIERL > ZERO
  3859         IF ADD-FUNCTION
  3860             IF PI-ZERO-CARRIER
  3861               OR PI-ZERO-CAR-GROUP
  3862                 MOVE ZEROS      TO  PI-ERC-CARRIER
  3863                                     CARRIERI
  3864                 MOVE AL-UANON   TO  CARRIERA
  3865             ELSE
  3866                 MOVE CARRIERI   TO  WS-ACARRIER
  3867                                     PI-ERC-CARRIER
  3868                 MOVE '6'        TO  CNTL-REC-TYPE
  3869                 PERFORM 7400-READ-CONTROL-FILE  THRU  7499-EXIT
  3870         ELSE
  3871             IF PI-ZERO-CARRIER
  3872               OR PI-ZERO-CAR-GROUP
  3873                 MOVE ZEROS      TO  PI-ERC-CARRIER
  3874                                     CARRIERI
  3875                 MOVE AL-UANON   TO  CARRIERA
  3876             ELSE
  3877                 MOVE AL-UANON   TO  CARRIERA
  3878                 MOVE CARRIERI   TO  PI-ERC-CARRIER
  3879     ELSE
  3880         IF ADD-FUNCTION
  3881             IF PI-ZERO-CARRIER
  3882               OR PI-ZERO-CAR-GROUP
  3883                 MOVE ZEROS      TO  PI-ERC-CARRIER
  3884                                     CARRIERI
  3885                 MOVE AL-UANON   TO  CARRIERA
  3886             ELSE
  3887                 MOVE -1         TO  CARRIERL
  3888                 MOVE AL-UABON   TO  CARRIERA
  3889                 MOVE ER-0193    TO  EMI-ERROR
  3890                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3891         ELSE
  3892             MOVE -1             TO  CARRIERL
  3893             MOVE AL-UABON       TO  CARRIERA
  3894             MOVE ER-0193        TO  EMI-ERROR
  3895             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3896     IF GROUPL > ZERO
  3897         IF PI-ZERO-GROUPING
  3898           OR PI-ZERO-CAR-GROUP
  3899             MOVE ZEROS          TO  PI-ERC-GROUP
  3900                                     GROUPI
  3901             MOVE AL-UANON       TO  GROUPA
  3902         ELSE
  3903             MOVE AL-UANON       TO  GROUPA
  3904             MOVE GROUPI         TO  PI-ERC-GROUP
  3905     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL6523.cbl
  3906         IF ADD-FUNCTION
  3907             IF PI-ZERO-GROUPING
  3908               OR PI-ZERO-CAR-GROUP
  3909                 MOVE ZEROS      TO  PI-ERC-GROUP
  3910                                     GROUPI
  3911                 MOVE AL-UANON   TO  GROUPA
  3912             ELSE
  3913                 MOVE LOW-VALUES  TO  PI-ERC-GROUP
  3914         ELSE
  3915             MOVE LOW-VALUES     TO  PI-ERC-GROUP.
  3916     IF BANKL > ZERO
  3917         MOVE AL-UANON           TO BANKA
  3918         MOVE BANKI              TO PI-ERC-BANK
  3919     ELSE
  3920         MOVE LOW-VALUES         TO PI-ERC-BANK
  3921     END-IF
  3922     IF NOT MODIFY-CAP
  3923         IF SHOW-FUNCTION
  3924             GO TO 1000-EDIT-INPUT
  3925         ELSE
  3926             MOVE 'UPDATE'       TO SM-READ
  3927             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3928             MOVE ER-0070        TO  EMI-ERROR
  3929             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3930             GO TO 8100-SEND-INITIAL-MAP.
  3931     IF EMI-NO-ERRORS
  3932        CONTINUE
  3933     ELSE
  3934        IF EIBTRNID NOT = TRANS-ID
  3935           GO TO 8100-SEND-INITIAL-MAP
  3936        ELSE
  3937           GO TO 8200-SEND-DATAONLY
  3938        END-IF
  3939     END-IF
  3940     IF CHANGE-FUNCTION
  3941        GO TO 4400-CHANGE
  3942     END-IF
  3943     IF DELETE-FUNCTION
  3944        GO TO 4600-DELETE
  3945     END-IF
  3946     IF SHOW-FUNCTION
  3947        GO TO 1000-EDIT-INPUT
  3948     END-IF
  3949     IF EMI-NO-ERRORS
  3950        CONTINUE
  3951     ELSE
  3952        GO TO 8200-SEND-DATAONLY
  3953     END-IF
  3954     IF ADD-FUNCTION
  3955        GO TO 4200-ADD
  3956     END-IF
  3957     MOVE -1                     TO MAINTYPL
  3958     MOVE ER-2056                TO EMI-ERROR
  3959     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  3960     GO TO 8200-SEND-DATAONLY
  3961     .
  3962 4000-EXIT.
  3963     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL6523.cbl
  3965 1000-EDIT-INPUT.
  3966     IF CARRIERL NOT = ZEROS
  3967        MOVE CARRIERI            TO WS-CARRIER
  3968     ELSE
  3969        MOVE ER-0234             TO EMI-ERROR
  3970        MOVE -1                  TO CARRIERL
  3971        MOVE AL-UABON            TO CARRIERA
  3972        PERFORM 9900-ERROR-FORMAT
  3973                                 THRU 9900-EXIT
  3974     END-IF
  3975     IF GROUPL NOT = ZEROS
  3976        MOVE GROUPI              TO WS-GROUPING
  3977     ELSE
  3978        MOVE ER-0235             TO EMI-ERROR
  3979        MOVE -1                  TO GROUPL
  3980        MOVE AL-UABON            TO GROUPA
  3981        PERFORM 9900-ERROR-FORMAT
  3982                                 THRU 9900-EXIT
  3983     END-IF
  3984     IF BANKL  NOT = ZEROS
  3985        MOVE BANKI               TO WS-BANK
  3986     ELSE
  3987        MOVE ER-6508             TO EMI-ERROR
  3988        MOVE -1                  TO BANKL
  3989        MOVE AL-UABON            TO BANKA
  3990        PERFORM 9900-ERROR-FORMAT
  3991                                 THRU 9900-EXIT
  3992     END-IF
  3993     IF NOT EMI-NO-ERRORS
  3994        GO TO 8200-SEND-DATAONLY
  3995     END-IF
  3996     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  3997     .
  3998 1050-READ-BANK.
  3999
  4000* EXEC CICS HANDLE CONDITION
  4001*         NOTFND (1500-BXRF-NOT-FOUND)
  4002*    END-EXEC
  4003*    MOVE '"$I                   ! $ #00003926' TO DFHEIV0
  4004     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4005     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4006     MOVE X'2420233030303033393236' TO DFHEIV0(25:11)
  4007     CALL 'kxdfhei1' USING DFHEIV0
  4008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4009     PERFORM 7050-READ-ERBXRF    THRU 7050-EXIT
  4010     MOVE BK-LAST-MAINT-USER     TO PI-UPDATE-BY
  4011     IF BK-LAST-MAINT-HHMMSS NUMERIC
  4012        MOVE BK-LAST-MAINT-HHMMSS
  4013                                 TO PI-UPDATE-HHMMSS
  4014     ELSE
  4015        MOVE ZEROS               TO PI-UPDATE-HHMMSS
  4016     END-IF
  4017     MOVE WS-CONTROL-PRIMARY     TO PI-SAVE-ERBXRF-KEY
  4018     MOVE +1                     TO PI-NDX
  4019                                    PI-TOP-NDX
  4020     MOVE ER-0000                TO EMI-ERROR
  4021     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  4022     GO TO 5200-FORMAT-SCREEN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL6523.cbl
  4023     .
  4024 1500-BXRF-NOT-FOUND.
  4025     MOVE ER-0142                TO EMI-ERROR
  4026     MOVE -1                     TO CARRIERL
  4027     MOVE AL-UABON               TO CARRIERA
  4028     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  4029     IF EIBTRNID  = EL652-TRANS-ID
  4030        GO TO 8100-SEND-INITIAL-MAP
  4031     ELSE
  4032        GO TO 8200-SEND-DATAONLY
  4033     END-IF
  4034     .
  4035 3000-BLD-LINE.
  4036     MOVE 1                      TO NDX
  4037     .
  4038 3000-BLD-LINE-LOOP.
  4039     IF PI-NDX > BK-BANK-POINTER-CNT
  4040        GO TO 3000-XIT
  4041     END-IF
  4042     MOVE BK-AM-ACCOUNT (PI-NDX) TO BL-ACCOUNT (NDX)
  4043     IF BK-AM-EFF-DT (PI-NDX) NOT = SPACES AND LOW-VALUES
  4044        MOVE BK-AM-EFF-DT (PI-NDX)
  4045                                 TO DC-BIN-DATE-1
  4046        MOVE SPACE               TO DC-OPTION-CODE
  4047        PERFORM 8500-DATE-CONVERT
  4048                                 THRU 8500-EXIT
  4049        MOVE DC-GREG-DATE-1-EDIT TO BL-EFFECT (NDX)
  4050     END-IF
  4051     IF BK-AM-EXP-DT (PI-NDX) NOT = SPACES AND LOW-VALUES
  4052        AND HIGH-VALUES
  4053        MOVE BK-AM-EXP-DT (PI-NDX)
  4054                                 TO DC-BIN-DATE-1
  4055        MOVE SPACE               TO DC-OPTION-CODE
  4056        PERFORM 8500-DATE-CONVERT
  4057                                 THRU 8500-EXIT
  4058        MOVE DC-GREG-DATE-1-EDIT TO BL-EXPIRE (NDX)
  4059     END-IF
  4060     IF BK-AM-EXP-DT (PI-NDX) = HIGH-VALUES
  4061        MOVE '99/99/99'          TO BL-EXPIRE (NDX)
  4062      END-IF
  4063*    MOVE BK-AM-LEVEL-NO (PI-NDX)       TO BL-LEVEL.
  4064     MOVE BK-AM-STATE (PI-NDX)   TO BL-STATE (NDX)
  4065     IF (PI-NDX = BK-BANK-POINTER-CNT)  OR  (NDX = 13)
  4066         GO TO 3000-XIT
  4067     END-IF
  4068     ADD 1                       TO PI-NDX NDX
  4069     GO TO 3000-BLD-LINE-LOOP
  4070     .
  4071 3000-XIT.
  4072     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL6523.cbl
  4074 4000-ACCT-MAINT.
  4075     IF (CARRIERI    NOT = PI-BXRF-CARRIER)
  4076        OR (GROUPI   NOT = PI-BXRF-GROUPING)
  4077        OR (BANKI    NOT = PI-BXRF-BANK)
  4078        MOVE ER-5005             TO EMI-ERROR
  4079        GO TO 4050-ERR
  4080     END-IF
  4081     IF ACCOCCI NOT NUMERIC
  4082        GO TO 4010-ERROR
  4083     END-IF
  4084     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  4085     MOVE CARRIERI               TO WS-CARRIER
  4086     MOVE GROUPI                 TO WS-GROUPING
  4087     MOVE BANKI                  TO WS-BANK
  4088
  4089* EXEC CICS HANDLE CONDITION
  4090*         NOTFND (4010-ERROR)
  4091*    END-EXEC
  4092*    MOVE '"$I                   ! % #00004008' TO DFHEIV0
  4093     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4094     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4095     MOVE X'2520233030303034303038' TO DFHEIV0(25:11)
  4096     CALL 'kxdfhei1' USING DFHEIV0
  4097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4098     PERFORM 7050-READ-ERBXRF    THRU 7050-EXIT
  4099     MOVE ACCOCCI                TO NDX
  4100     COMPUTE NDX = PI-TOP-NDX + NDX - 1
  4101     IF NDX  NOT > BK-BANK-POINTER-CNT
  4102        MOVE BK-CARRIER          TO PI-CR-CARRIER
  4103        MOVE BK-GROUPING         TO PI-CR-GROUPING
  4104        MOVE BK-AM-STATE (NDX)   TO PI-CR-STATE
  4105        MOVE BK-AM-ACCOUNT (NDX) TO PI-CR-ACCOUNT
  4106        PERFORM 0500-CREATE-TEMP-STORAGE
  4107                                 THRU 0599-EXIT
  4108        MOVE XCTL-650            TO PGM-NAME
  4109        GO TO 9300-XCTL
  4110     END-IF
  4111     .
  4112 4010-ERROR.
  4113      MOVE ER-5004 TO EMI-ERROR.
  4114 4050-ERR.
  4115      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4116      MOVE -1                     TO ACCOCCL.
  4117      MOVE AL-UNBON               TO ACCOCCA.
  4118      GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL6523.cbl
  4120 4200-ADD.
  4121*    PERFORM 7000-EDIT           THRU 7000-EXIT
  4122     IF EMI-NO-ERRORS
  4123        CONTINUE
  4124     ELSE
  4125        GO TO 8200-SEND-DATAONLY
  4126     END-IF
  4127
  4128* EXEC CICS HANDLE CONDITION
  4129*        NOTOPEN  (9990-ABEND)
  4130*        NOTFND   (4250-CONT)
  4131*    END-EXEC.
  4132*    MOVE '"$JI                  ! & #00004040' TO DFHEIV0
  4133     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  4134     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4135     MOVE X'2620233030303034303430' TO DFHEIV0(25:11)
  4136     CALL 'kxdfhei1' USING DFHEIV0
  4137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4138
  4139     MOVE PI-ERC-KEY             TO WS-CONTROL-PRIMARY
  4140     PERFORM 7050-READ-ERBXRF    THRU 7050-EXIT
  4141     MOVE ER-2057                TO EMI-ERROR
  4142     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  4143     MOVE LOW-VALUES             TO PI-SAVE-ERBXRF-KEY
  4144     MOVE -1                     TO  MAINTYPL
  4145     GO TO 8200-SEND-DATAONLY
  4146     .
  4147 4250-CONT.
  4148
  4149* EXEC CICS GETMAIN
  4150*        SET      (ADDRESS OF BANK-CROSS-REFERENCE)
  4151*        LENGTH   (BXRF-REC-LENGTH)
  4152*        INITIMG  (GETMAIN-SPACE)
  4153*    END-EXEC
  4154*    MOVE ',"IL                  $   #00004053' TO DFHEIV0
  4155     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4156     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4157     MOVE X'2020233030303034303533' TO DFHEIV0(25:11)
  4158     CALL 'kxdfhei1' USING DFHEIV0,
  4159           DFHEIV20,
  4160           BXRF-REC-LENGTH,
  4161           GETMAIN-SPACE
  4162     SET ADDRESS OF BANK-CROSS-REFERENCE TO
  4163         DFHEIV20
  4164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4165     MOVE SPACES                 TO BANK-CROSS-REFERENCE
  4166     MOVE PI-COMPANY-CD          TO BK-COMPANY-CD
  4167     MOVE 'BK'                   TO BK-RECORD-ID
  4168     MOVE PI-ERC-KEY             TO BK-CONTROL-PRIMARY
  4169     MOVE +1                     TO PI-NDX
  4170     SET NO-CHANGES-MADE         TO TRUE
  4171     PERFORM 7300-EDIT-DATA      THRU 7300-EXIT
  4172     IF EMI-NO-ERRORS
  4173        CONTINUE
  4174     ELSE
  4175
  4176* EXEC CICS UNLOCK
  4177*            DATASET  (BXRF-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL6523.cbl
  4178*       END-EXEC
  4179*    MOVE '&*                    #   #00004068' TO DFHEIV0
  4180     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4181     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4182     MOVE X'2020233030303034303638' TO DFHEIV0(25:11)
  4183     CALL 'kxdfhei1' USING DFHEIV0,
  4184           BXRF-FILE-ID,
  4185           DFHEIV99
  4186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4187        GO TO 8200-SEND-DATAONLY
  4188     END-IF
  4189     PERFORM 7325-COMPRESS       THRU 7325-EXIT
  4190     MOVE PI-NDX                 TO BK-BANK-POINTER-CNT
  4191     PERFORM 7510-SORT-ACCOUNTS  THRU 7599-EXIT
  4192     MOVE PI-PROCESSOR-ID        TO BK-LAST-MAINT-USER
  4193     MOVE EIBTIME                TO BK-LAST-MAINT-HHMMSS
  4194     MOVE SAVE-BIN-DATE          TO BK-LAST-MAINT-DT
  4195
  4196* EXEC CICS WRITE
  4197*        DATASET  (BXRF-FILE-ID)
  4198*        FROM     (BANK-CROSS-REFERENCE)
  4199*        RIDFLD   (BK-CONTROL-PRIMARY)
  4200*    END-EXEC
  4201     MOVE LENGTH OF
  4202      BANK-CROSS-REFERENCE
  4203       TO DFHEIV11
  4204*    MOVE '&$ L                  ''   #00004079' TO DFHEIV0
  4205     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4206     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4207     MOVE X'2020233030303034303739' TO DFHEIV0(25:11)
  4208     CALL 'kxdfhei1' USING DFHEIV0,
  4209           BXRF-FILE-ID,
  4210           BANK-CROSS-REFERENCE,
  4211           DFHEIV11,
  4212           BK-CONTROL-PRIMARY,
  4213           DFHEIV99,
  4214           DFHEIV99
  4215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4216     MOVE LOW-VALUES             TO EL652DO
  4217     MOVE 'S'                    TO MAINTYPO
  4218     MOVE +1                     TO MAINTYPL
  4219     MOVE AL-UANON               TO MAINTYPA
  4220     MOVE PI-ERC-CARRIER         TO CARRIERO
  4221     MOVE AL-UANON               TO CARRIERA
  4222     MOVE +1                     TO CARRIERL
  4223     IF PI-ERC-GROUP NOT = SPACES
  4224         MOVE PI-ERC-GROUP       TO GROUPO
  4225         MOVE AL-UANON           TO GROUPA
  4226         MOVE +6                 TO GROUPL
  4227     END-IF
  4228     IF PI-ERC-BANK NOT = SPACES
  4229        MOVE PI-ERC-BANK         TO BANKO
  4230        MOVE AL-UANON            TO BANKA
  4231        MOVE +10                 TO BANKL
  4232     END-IF
  4233     GO TO 1000-EDIT-INPUT
  4234     .
  4235 4200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL6523.cbl
  4236     EXIT.
  4237 4400-CHANGE.
  4238     IF PI-ERC-KEY = PI-SAVE-ERBXRF-KEY
  4239        CONTINUE
  4240     ELSE
  4241        MOVE ER-2056             TO EMI-ERROR
  4242        PERFORM 9900-ERROR-FORMAT
  4243                                 THRU 9900-EXIT
  4244        MOVE -1                  TO MAINTYPL
  4245        GO TO 8200-SEND-DATAONLY
  4246     END-IF
  4247     MOVE PI-ERC-KEY             TO WS-CONTROL-PRIMARY
  4248     PERFORM 7200-READ-ERBXRF-UPDATE
  4249                                 THRU 7200-EXIT
  4250     IF (BK-LAST-MAINT-USER = PI-UPDATE-BY)
  4251        AND (BK-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS)
  4252        CONTINUE
  4253     ELSE
  4254
  4255* EXEC CICS UNLOCK
  4256*            DATASET  (BXRF-FILE-ID)
  4257*       END-EXEC
  4258*    MOVE '&*                    #   #00004122' TO DFHEIV0
  4259     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4260     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4261     MOVE X'2020233030303034313232' TO DFHEIV0(25:11)
  4262     CALL 'kxdfhei1' USING DFHEIV0,
  4263           BXRF-FILE-ID,
  4264           DFHEIV99
  4265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4266        MOVE ER-0068             TO EMI-ERROR
  4267        PERFORM 9900-ERROR-FORMAT
  4268                                 THRU  9900-EXIT
  4269        GO TO 8200-SEND-DATAONLY
  4270     END-IF
  4271     MOVE PI-TOP-NDX             TO PI-NDX
  4272     SET NO-CHANGES-MADE         TO TRUE
  4273     PERFORM 7300-EDIT-DATA      THRU 7300-EXIT
  4274     IF EMI-NO-ERRORS
  4275        CONTINUE
  4276     ELSE
  4277
  4278* EXEC CICS UNLOCK
  4279*            DATASET  (BXRF-FILE-ID)
  4280*       END-EXEC
  4281*    MOVE '&*                    #   #00004136' TO DFHEIV0
  4282     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4283     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4284     MOVE X'2020233030303034313336' TO DFHEIV0(25:11)
  4285     CALL 'kxdfhei1' USING DFHEIV0,
  4286           BXRF-FILE-ID,
  4287           DFHEIV99
  4288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4289        GO TO 8200-SEND-DATAONLY
  4290     END-IF
  4291     IF NO-CHANGES-MADE
  4292        MOVE ER-3112             TO EMI-ERROR
  4293        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL6523.cbl
  4294                                 THRU 9900-EXIT
  4295        MOVE -1                  TO MAINTYPL
  4296        GO TO 8200-SEND-DATAONLY
  4297     END-IF
  4298     COMPUTE PI-NDX = BK-BANK-POINTER-CNT + +13
  4299     PERFORM 7325-COMPRESS       THRU 7325-EXIT
  4300     MOVE PI-NDX                 TO BK-BANK-POINTER-CNT
  4301     PERFORM 7510-SORT-ACCOUNTS  THRU 7599-EXIT
  4302     MOVE PI-PROCESSOR-ID        TO BK-LAST-MAINT-USER
  4303     MOVE EIBTIME                TO BK-LAST-MAINT-HHMMSS
  4304     MOVE SAVE-BIN-DATE          TO BK-LAST-MAINT-DT
  4305
  4306* EXEC CICS REWRITE
  4307*        DATASET  (BXRF-FILE-ID)
  4308*        FROM     (BANK-CROSS-REFERENCE)
  4309*    END-EXEC
  4310     MOVE LENGTH OF
  4311      BANK-CROSS-REFERENCE
  4312       TO DFHEIV11
  4313*    MOVE '&& L                  %   #00004155' TO DFHEIV0
  4314     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4315     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4316     MOVE X'2020233030303034313535' TO DFHEIV0(25:11)
  4317     CALL 'kxdfhei1' USING DFHEIV0,
  4318           BXRF-FILE-ID,
  4319           BANK-CROSS-REFERENCE,
  4320           DFHEIV11,
  4321           DFHEIV99
  4322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4323     GO TO 1000-EDIT-INPUT
  4324     .
  4325 4600-DELETE.
  4326     IF PI-ERC-KEY = PI-SAVE-ERBXRF-KEY
  4327        CONTINUE
  4328     ELSE
  4329        MOVE ER-2056             TO EMI-ERROR
  4330        PERFORM 9900-ERROR-FORMAT
  4331                                 THRU 9900-EXIT
  4332        MOVE -1                  TO MAINTYPL
  4333        GO TO 8200-SEND-DATAONLY
  4334     END-IF
  4335     IF PI-EL6523-DEL-SW = 'Y'
  4336        CONTINUE
  4337     ELSE
  4338        MOVE 'Y'                 TO PI-EL6523-DEL-SW
  4339        MOVE ER-1299             TO EMI-ERROR
  4340        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4341        MOVE SPACES              TO MAINTYPO
  4342        MOVE -1                  TO MAINTYPL
  4343        GO TO 1000-EDIT-INPUT
  4344     END-IF
  4345     MOVE PI-ERC-KEY             TO WS-CONTROL-PRIMARY
  4346     PERFORM 7200-READ-ERBXRF-UPDATE
  4347                                 THRU 7200-EXIT
  4348     IF (BK-LAST-MAINT-USER = PI-UPDATE-BY)
  4349        AND (BK-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS)
  4350        CONTINUE
  4351     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL6523.cbl
  4352
  4353* EXEC CICS UNLOCK
  4354*            DATASET  (BXRF-FILE-ID)
  4355*       END-EXEC
  4356*    MOVE '&*                    #   #00004188' TO DFHEIV0
  4357     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4358     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4359     MOVE X'2020233030303034313838' TO DFHEIV0(25:11)
  4360     CALL 'kxdfhei1' USING DFHEIV0,
  4361           BXRF-FILE-ID,
  4362           DFHEIV99
  4363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4364        MOVE ER-0068             TO EMI-ERROR
  4365        PERFORM 9900-ERROR-FORMAT
  4366                                 THRU  9900-EXIT
  4367        GO TO 8200-SEND-DATAONLY
  4368     END-IF
  4369
  4370* EXEC CICS DELETE
  4371*        DATASET  (BXRF-FILE-ID)
  4372*    END-EXEC
  4373*    MOVE '&(                    &   #00004196' TO DFHEIV0
  4374     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4375     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4376     MOVE X'2020233030303034313936' TO DFHEIV0(25:11)
  4377     CALL 'kxdfhei1' USING DFHEIV0,
  4378           BXRF-FILE-ID,
  4379           DFHEIV99,
  4380           DFHEIV99,
  4381           DFHEIV99,
  4382           DFHEIV99
  4383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4384     MOVE ER-0000                TO  EMI-ERROR
  4385     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4386     MOVE LOW-VALUES             TO  EL652DO
  4387     MOVE PI-ERC-CARRIER         TO  CARRIERO
  4388     MOVE AL-UANON               TO  CARRIERA
  4389     IF PI-ERC-GROUP NOT = SPACES
  4390         MOVE PI-ERC-GROUP       TO  GROUPO
  4391         MOVE AL-UANON           TO  GROUPA
  4392     END-IF
  4393     IF PI-ERC-BANK NOT = SPACES
  4394        MOVE PI-ERC-BANK        TO  BANKO
  4395        MOVE AL-UANON           TO  BANKA
  4396     END-IF
  4397     MOVE LOW-VALUES             TO  PI-SAVE-ERBXRF-KEY
  4398     GO TO 8100-SEND-INITIAL-MAP
  4399     .
  4400 4600-EXIT.
  4401     EXIT.
  4402 5000-BROWSE-FILE.
  4403     MOVE SPACE                  TO BROWSE-STARTED-SW
  4404
  4405* EXEC CICS HANDLE CONDITION
  4406*        NOTFND (5800-NO-RECORD)
  4407*        ENDFILE (5900-END-OF-FILE)
  4408*    END-EXEC
  4409*    MOVE '"$I''                  ! '' #00004219' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL6523.cbl
  4410     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4411     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4412     MOVE X'2720233030303034323139' TO DFHEIV0(25:11)
  4413     CALL 'kxdfhei1' USING DFHEIV0
  4414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4415     MOVE PI-SAVE-ERBXRF-KEY     TO WS-CONTROL-PRIMARY
  4416
  4417* EXEC CICS STARTBR
  4418*        DATASET (BXRF-FILE-ID)
  4419*        RIDFLD (WS-CONTROL-PRIMARY)
  4420*    END-EXEC
  4421     MOVE 0
  4422       TO DFHEIV11
  4423*    MOVE '&,         G          &   #00004224' TO DFHEIV0
  4424     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4425     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4426     MOVE X'2020233030303034323234' TO DFHEIV0(25:11)
  4427     CALL 'kxdfhei1' USING DFHEIV0,
  4428           BXRF-FILE-ID,
  4429           WS-CONTROL-PRIMARY,
  4430           DFHEIV99,
  4431           DFHEIV11,
  4432           DFHEIV99
  4433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4434     MOVE 'Y'                    TO BROWSE-STARTED-SW
  4435     IF EIBAID = DFHPF2
  4436        GO TO 5100-BROWSE-BKWD
  4437     END-IF
  4438     .
  4439 5010-READ-LOOP.
  4440     MOVE BXRF-MAX-REC-LENGTH    TO BXRF-REC-LENGTH
  4441
  4442* EXEC CICS READNEXT
  4443*        DATASET (BXRF-FILE-ID)
  4444*        SET     (ADDRESS OF BANK-CROSS-REFERENCE)
  4445*        RIDFLD  (WS-CONTROL-PRIMARY)
  4446*        LENGTH  (BXRF-REC-LENGTH)
  4447*    END-EXEC
  4448     MOVE 0
  4449       TO DFHEIV11
  4450*    MOVE '&.SL                  )   #00004235' TO DFHEIV0
  4451     MOVE X'262E534C2020202020202020' TO DFHEIV0(1:12)
  4452     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4453     MOVE X'2020233030303034323335' TO DFHEIV0(25:11)
  4454     CALL 'kxdfhei1' USING DFHEIV0,
  4455           BXRF-FILE-ID,
  4456           DFHEIV20,
  4457           BXRF-REC-LENGTH,
  4458           WS-CONTROL-PRIMARY,
  4459           DFHEIV99,
  4460           DFHEIV11,
  4461           DFHEIV99,
  4462           DFHEIV99
  4463     SET ADDRESS OF BANK-CROSS-REFERENCE TO
  4464         DFHEIV20
  4465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4466     MOVE BK-BANK-POINTER-CNT    TO BK-BANK-POINTER-CNT
  4467     MOVE +1                     TO PI-NDX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL6523.cbl
  4468     IF BK-COMPANY-CD NOT = PI-COMPANY-CD
  4469        GO TO 5900-END-OF-FILE
  4470     END-IF
  4471     IF EIBAID = DFHPF1
  4472        IF CARRIERO     = BK-CARRIER
  4473           AND GROUPO   = BK-GROUPING
  4474           AND BANKO    = BK-BANK-NO
  4475           GO TO 5010-READ-LOOP
  4476        END-IF
  4477     END-IF
  4478     MOVE BK-LAST-MAINT-USER     TO PI-UPDATE-BY
  4479     IF BK-LAST-MAINT-HHMMSS NUMERIC
  4480        MOVE BK-LAST-MAINT-HHMMSS
  4481                                 TO PI-UPDATE-HHMMSS
  4482     ELSE
  4483        MOVE ZEROS               TO PI-UPDATE-HHMMSS
  4484     END-IF
  4485     MOVE BK-CONTROL-PRIMARY     TO PI-SAVE-ERBXRF-KEY
  4486     GO TO 5200-FORMAT-SCREEN
  4487     .
  4488 5100-BROWSE-BKWD.
  4489
  4490* EXEC CICS HANDLE CONDITION
  4491*         NOTFND (5900-END-OF-FILE)
  4492*    END-EXEC
  4493*    MOVE '"$I                   ! ( #00004264' TO DFHEIV0
  4494     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4495     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4496     MOVE X'2820233030303034323634' TO DFHEIV0(25:11)
  4497     CALL 'kxdfhei1' USING DFHEIV0
  4498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4499     MOVE BXRF-MAX-REC-LENGTH    TO BXRF-REC-LENGTH
  4500
  4501* EXEC CICS READPREV
  4502*        DATASET (BXRF-FILE-ID)
  4503*        SET     (ADDRESS OF BANK-CROSS-REFERENCE)
  4504*        LENGTH  (BXRF-REC-LENGTH)
  4505*        RIDFLD  (WS-CONTROL-PRIMARY)
  4506*    END-EXEC
  4507     MOVE 0
  4508       TO DFHEIV11
  4509*    MOVE '&0SL                  )   #00004268' TO DFHEIV0
  4510     MOVE X'2630534C2020202020202020' TO DFHEIV0(1:12)
  4511     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4512     MOVE X'2020233030303034323638' TO DFHEIV0(25:11)
  4513     CALL 'kxdfhei1' USING DFHEIV0,
  4514           BXRF-FILE-ID,
  4515           DFHEIV20,
  4516           BXRF-REC-LENGTH,
  4517           WS-CONTROL-PRIMARY,
  4518           DFHEIV99,
  4519           DFHEIV11,
  4520           DFHEIV99,
  4521           DFHEIV99
  4522     SET ADDRESS OF BANK-CROSS-REFERENCE TO
  4523         DFHEIV20
  4524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4525     MOVE BXRF-MAX-REC-LENGTH    TO BXRF-REC-LENGTH
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL6523.cbl
  4526     IF PI-FILE-EOF
  4527        MOVE SPACE               TO PI-EOF-SW
  4528     ELSE
  4529
  4530* EXEC CICS READPREV
  4531*            DATASET (BXRF-FILE-ID)
  4532*            SET     (ADDRESS OF BANK-CROSS-REFERENCE)
  4533*            LENGTH  (BXRF-REC-LENGTH)
  4534*            RIDFLD  (WS-CONTROL-PRIMARY)
  4535*       END-EXEC
  4536     MOVE 0
  4537       TO DFHEIV11
  4538*    MOVE '&0SL                  )   #00004278' TO DFHEIV0
  4539     MOVE X'2630534C2020202020202020' TO DFHEIV0(1:12)
  4540     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4541     MOVE X'2020233030303034323738' TO DFHEIV0(25:11)
  4542     CALL 'kxdfhei1' USING DFHEIV0,
  4543           BXRF-FILE-ID,
  4544           DFHEIV20,
  4545           BXRF-REC-LENGTH,
  4546           WS-CONTROL-PRIMARY,
  4547           DFHEIV99,
  4548           DFHEIV11,
  4549           DFHEIV99,
  4550           DFHEIV99
  4551     SET ADDRESS OF BANK-CROSS-REFERENCE TO
  4552         DFHEIV20
  4553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4554     END-IF
  4555     MOVE BK-BANK-POINTER-CNT TO BK-BANK-POINTER-CNT
  4556     MOVE +1                     TO PI-NDX
  4557     IF BK-COMPANY-CD NOT = PI-COMPANY-CD
  4558        GO TO 5900-END-OF-FILE
  4559     END-IF
  4560     MOVE BK-LAST-MAINT-USER     TO PI-UPDATE-BY
  4561     IF BK-LAST-MAINT-HHMMSS NUMERIC
  4562        MOVE BK-LAST-MAINT-HHMMSS
  4563                                 TO PI-UPDATE-HHMMSS
  4564     ELSE
  4565        MOVE ZEROS               TO PI-UPDATE-HHMMSS
  4566     END-IF
  4567     MOVE BK-CONTROL-PRIMARY     TO PI-SAVE-ERBXRF-KEY
  4568     GO TO 5200-FORMAT-SCREEN
  4569     .
  4570 5200-FORMAT-SCREEN.
  4571     MOVE LOW-VALUES             TO EL652DI
  4572     MOVE BK-CONTROL-PRIMARY     TO PI-ERBXRF-KEY
  4573     MOVE BK-CARRIER             TO CARRIERO
  4574     MOVE BK-GROUPING            TO GROUPO
  4575     MOVE BK-BANK-NO             TO BANKO
  4576     MOVE BK-BANK-POINTER-CNT    TO TOTOCCO
  4577     PERFORM 7500-COUNT-OPEN-RANGES
  4578                                 THRU 7500-EXIT
  4579     MOVE WS-OPEN-COUNT          TO TOTOPNO
  4580     IF BK-LAST-MAINT-DT NOT = SPACES AND LOW-VALUES AND ZEROS
  4581        MOVE BK-LAST-MAINT-DT    TO DC-BIN-DATE-1
  4582        MOVE SPACE               TO DC-OPTION-CODE
  4583        PERFORM 8500-DATE-CONVERT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL6523.cbl
  4584                                 THRU 8500-EXIT
  4585        MOVE DC-GREG-DATE-1-EDIT TO MAINTDTO
  4586     ELSE
  4587        MOVE '00/00/00'          TO MAINTDTO
  4588      END-IF
  4589     PERFORM 3000-BLD-LINE       THRU 3000-XIT
  4590     MOVE AL-UANON               TO CARRIERA GROUPA
  4591                                    BANKA
  4592     GO TO 8100-SEND-INITIAL-MAP
  4593     .
  4594 5800-NO-RECORD.
  4595     MOVE -1                     TO CARRIERL.
  4596     MOVE AL-UANON               TO CARRIERA   GROUPA
  4597                                     BANKA
  4598     MOVE ER-1164                TO EMI-ERROR.
  4599     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4600     IF BROWSE-STARTED
  4601
  4602* EXEC CICS ENDBR
  4603*           DATASET  (BXRF-FILE-ID)
  4604*           END-EXEC.
  4605     MOVE 0
  4606       TO DFHEIV11
  4607*    MOVE '&2                    $   #00004331' TO DFHEIV0
  4608     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4609     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4610     MOVE X'2020233030303034333331' TO DFHEIV0(25:11)
  4611     CALL 'kxdfhei1' USING DFHEIV0,
  4612           BXRF-FILE-ID,
  4613           DFHEIV11,
  4614           DFHEIV99
  4615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4616
  4617     GO TO 8200-SEND-DATAONLY.
  4618 5900-END-OF-FILE.
  4619     IF EIBAID = DFHPF1
  4620         MOVE 'Y'                TO PI-EOF-SW
  4621         MOVE ER-2237            TO EMI-ERROR
  4622     ELSE
  4623         MOVE LOW-VALUES         TO PI-ERBXRF-KEY
  4624         MOVE PI-COMPANY-CD      TO PI-BXRF-COMP-CD
  4625         MOVE ER-2238            TO EMI-ERROR.
  4626     MOVE -1            TO CARRIERL.
  4627     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4628     IF BROWSE-STARTED
  4629
  4630* EXEC CICS ENDBR
  4631*           DATASET  (BXRF-FILE-ID)
  4632*           END-EXEC.
  4633     MOVE 0
  4634       TO DFHEIV11
  4635*    MOVE '&2                    $   #00004346' TO DFHEIV0
  4636     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4637     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4638     MOVE X'2020233030303034333436' TO DFHEIV0(25:11)
  4639     CALL 'kxdfhei1' USING DFHEIV0,
  4640           BXRF-FILE-ID,
  4641           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL6523.cbl
  4642           DFHEIV99
  4643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4644
  4645     MOVE SPACE TO BROWSE-STARTED-SW.
  4646     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL6523.cbl
  4648 6000-OCCURRENCE.
  4649     MOVE PI-ERBXRF-KEY          TO WS-CONTROL-PRIMARY
  4650
  4651* EXEC CICS HANDLE CONDITION
  4652*        NOTFND (1500-BXRF-NOT-FOUND)
  4653*    END-EXEC
  4654*    MOVE '"$I                   ! ) #00004354' TO DFHEIV0
  4655     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4656     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4657     MOVE X'2920233030303034333534' TO DFHEIV0(25:11)
  4658     CALL 'kxdfhei1' USING DFHEIV0
  4659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4660     PERFORM 7050-READ-ERBXRF    THRU 7050-EXIT
  4661     IF EIBAID = DFHPF3
  4662        GO TO 6500-NEXT-OCC
  4663     ELSE
  4664        GO TO 7000-PRIOR-OCC
  4665     END-IF
  4666     .
  4667 6500-NEXT-OCC.
  4668*    IF PI-NDX = BK-BANK-POINTER-CNT
  4669*       MOVE -1                  TO CARRIERL
  4670*       MOVE ER-0130             TO EMI-ERROR
  4671*       PERFORM 9900-ERROR-FORMAT
  4672*                                THRU 9900-EXIT
  4673*       GO TO 8200-SEND-DATAONLY
  4674*    END-IF
  4675     ADD +1                      TO PI-NDX
  4676     MOVE PI-NDX                 TO PI-TOP-NDX
  4677     GO TO 5200-FORMAT-SCREEN
  4678     .
  4679 7000-PRIOR-OCC.
  4680     IF PI-NDX LESS 14
  4681        MOVE -1                  TO CARRIERL
  4682        MOVE ER-0131             TO EMI-ERROR
  4683        PERFORM 9900-ERROR-FORMAT
  4684                                 THRU 9900-EXIT
  4685        GO TO 8200-SEND-DATAONLY
  4686     END-IF
  4687     COMPUTE PI-NDX = (PI-NDX - 1) / 13
  4688     IF PI-NDX NOT = 1
  4689        COMPUTE PI-NDX = PI-NDX * 13
  4690        COMPUTE PI-NDX = PI-NDX - 12
  4691     END-IF
  4692     MOVE PI-NDX                 TO PI-TOP-NDX
  4693     GO TO 5200-FORMAT-SCREEN
  4694     .
  4695 7050-READ-ERBXRF.
  4696     MOVE BXRF-MAX-REC-LENGTH    TO BXRF-REC-LENGTH
  4697
  4698* EXEC CICS READ
  4699*         SET     (ADDRESS OF BANK-CROSS-REFERENCE)
  4700*         DATASET ('ERBXRF')
  4701*         LENGTH  (BXRF-REC-LENGTH)
  4702*         RIDFLD  (WS-CONTROL-PRIMARY)
  4703*    END-EXEC
  4704     MOVE 'ERBXRF' TO DFHEIV1
  4705*    MOVE '&"SL       E          (   #00004394' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL6523.cbl
  4706     MOVE X'2622534C2020202020202045' TO DFHEIV0(1:12)
  4707     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4708     MOVE X'2020233030303034333934' TO DFHEIV0(25:11)
  4709     CALL 'kxdfhei1' USING DFHEIV0,
  4710           DFHEIV1,
  4711           DFHEIV20,
  4712           BXRF-REC-LENGTH,
  4713           WS-CONTROL-PRIMARY,
  4714           DFHEIV99,
  4715           DFHEIV99,
  4716           DFHEIV99
  4717     SET ADDRESS OF BANK-CROSS-REFERENCE TO
  4718         DFHEIV20
  4719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4720     MOVE BK-BANK-POINTER-CNT    TO BK-BANK-POINTER-CNT
  4721     .
  4722 7050-EXIT.
  4723     EXIT.
  4724 7200-READ-ERBXRF-UPDATE.
  4725
  4726* EXEC CICS HANDLE CONDITION
  4727*        NOTFND (7200-BXRF-NOT-FOUND)
  4728*    END-EXEC
  4729*    MOVE '"$I                   ! * #00004405' TO DFHEIV0
  4730     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4731     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4732     MOVE X'2A20233030303034343035' TO DFHEIV0(25:11)
  4733     CALL 'kxdfhei1' USING DFHEIV0
  4734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4735     MOVE BXRF-MAX-REC-LENGTH    TO BXRF-REC-LENGTH
  4736
  4737* EXEC CICS READ
  4738*         SET     (ADDRESS OF BANK-CROSS-REFERENCE)
  4739*         DATASET ('ERBXRF')
  4740*         LENGTH  (BXRF-REC-LENGTH)
  4741*         RIDFLD  (WS-CONTROL-PRIMARY)
  4742*         UPDATE
  4743*    END-EXEC
  4744     MOVE 'ERBXRF' TO DFHEIV1
  4745*    MOVE '&"SL       EU         (   #00004409' TO DFHEIV0
  4746     MOVE X'2622534C2020202020202045' TO DFHEIV0(1:12)
  4747     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4748     MOVE X'2020233030303034343039' TO DFHEIV0(25:11)
  4749     CALL 'kxdfhei1' USING DFHEIV0,
  4750           DFHEIV1,
  4751           DFHEIV20,
  4752           BXRF-REC-LENGTH,
  4753           WS-CONTROL-PRIMARY,
  4754           DFHEIV99,
  4755           DFHEIV99,
  4756           DFHEIV99
  4757     SET ADDRESS OF BANK-CROSS-REFERENCE TO
  4758         DFHEIV20
  4759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4760     MOVE BK-BANK-POINTER-CNT    TO BK-BANK-POINTER-CNT
  4761     .
  4762 7200-EXIT.
  4763     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL6523.cbl
  4764     .
  4765 7200-BXRF-NOT-FOUND.
  4766     MOVE ER-0142                TO EMI-ERROR
  4767     MOVE -1                     TO CARRIERL
  4768     MOVE AL-UABON               TO CARRIERA
  4769     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  4770     IF EIBTRNID  = EL652-TRANS-ID
  4771        GO TO 8100-SEND-INITIAL-MAP
  4772     ELSE
  4773        GO TO 8200-SEND-DATAONLY
  4774     END-IF
  4775     .
  4776 7300-EDIT-DATA.
  4777     SET NO-LINE-CHANGES         TO TRUE
  4778     PERFORM VARYING NDX FROM +1 BY +1 UNTIL
  4779        (NDX > +13)
  4780        IF BL-ACCOUNTL (NDX) > +0
  4781           SET LINE-CHANGES      TO TRUE
  4782           MOVE BL-ACCOUNT (NDX) TO BK-AM-ACCOUNT (PI-NDX)
  4783        END-IF
  4784        IF BL-STATEL (NDX) > +0
  4785           SET LINE-CHANGES      TO TRUE
  4786           MOVE BL-STATE (NDX)   TO BK-AM-STATE (PI-NDX)
  4787        END-IF
  4788        IF BL-EFFECTL (NDX) > +0
  4789           SET LINE-CHANGES      TO TRUE
  4790           MOVE BL-EFFECT (NDX)  TO WS-DEEDIT-FIELD
  4791           PERFORM 8600-DEEDIT   THRU 8600-EXIT
  4792           MOVE WS-DEEDIT-FIELD-DATE-OUT
  4793                                 TO  DC-GREG-DATE-1-MDY
  4794           MOVE '4'              TO  DC-OPTION-CODE
  4795           PERFORM 9700-DATE-CONVERSION
  4796           IF DATE-CONVERSION-ERROR
  4797              MOVE ER-0348              TO EMI-ERROR
  4798              MOVE -1                   TO BL-EFFECTL (NDX)
  4799              MOVE AL-UABON             TO BL-EFFECTA (NDX)
  4800              PERFORM 9900-ERROR-FORMAT THRU  9900-EXIT
  4801           ELSE
  4802              MOVE DC-GREG-DATE-1-EDIT  TO BL-EFFECT (NDX)
  4803              MOVE AL-UANON             TO BL-EFFECTA (NDX)
  4804              MOVE DC-BIN-DATE-1        TO BK-AM-EFF-DT (PI-NDX)
  4805           END-IF
  4806        END-IF
  4807        IF BL-EXPIREL (NDX) > +0
  4808           SET LINE-CHANGES      TO TRUE
  4809           MOVE BL-EXPIRE (NDX)  TO WS-DEEDIT-FIELD
  4810           PERFORM 8600-DEEDIT   THRU 8600-EXIT
  4811           IF WS-DEEDIT-FIELD-DATE-OUT = 999999
  4812              MOVE HIGH-VALUES   TO BK-AM-EXP-DT (PI-NDX)
  4813              MOVE '99/99/99'    TO BL-EXPIRE (NDX)
  4814              MOVE AL-UANON      TO BL-EXPIREA (NDX)
  4815           ELSE
  4816              MOVE WS-DEEDIT-FIELD-DATE-OUT
  4817                                 TO DC-GREG-DATE-1-MDY
  4818              MOVE '4'           TO DC-OPTION-CODE
  4819              PERFORM 9700-DATE-CONVERSION
  4820              IF DATE-CONVERSION-ERROR
  4821                 MOVE ER-0454    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL6523.cbl
  4822                 MOVE -1         TO BL-EXPIREL (NDX)
  4823                 MOVE AL-UABON   TO BL-EXPIREA (NDX)
  4824                 PERFORM 9900-ERROR-FORMAT
  4825                                 THRU 9900-EXIT
  4826              ELSE
  4827                 MOVE DC-GREG-DATE-1-EDIT
  4828                                 TO BL-EXPIRE (NDX)
  4829                 MOVE AL-UANON   TO BL-EXPIREA (NDX)
  4830                 MOVE DC-BIN-DATE-1
  4831                                 TO BK-AM-EXP-DT (PI-NDX)
  4832              END-IF
  4833           END-IF
  4834        END-IF
  4835        IF LINE-CHANGES
  4836           SET CHANGES-MADE      TO TRUE
  4837           IF BK-AM-EXP-DT (PI-NDX) NOT > BK-AM-EFF-DT (PI-NDX)
  4838              MOVE ER-2339       TO EMI-ERROR
  4839              MOVE -1            TO BL-EXPIREL (NDX)
  4840              MOVE AL-UABON      TO BL-EXPIREA (NDX)
  4841              PERFORM 9900-ERROR-FORMAT
  4842                                 THRU 9900-EXIT
  4843           END-IF
  4844           IF BK-AM-ACCOUNT (PI-NDX) NOT = SPACES
  4845              PERFORM 7350-VERIFY-ACCOUNT
  4846                                 THRU 7350-EXIT
  4847           END-IF
  4848        END-IF
  4849        ADD +1                   TO PI-NDX
  4850        SET NO-LINE-CHANGES      TO TRUE
  4851     END-PERFORM
  4852     .
  4853 7300-EXIT.
  4854     EXIT.
  4855 7325-COMPRESS.
  4856     PERFORM VARYING WSUB1 FROM +1 BY +1 UNTIL
  4857        (WSUB1 > PI-NDX)
  4858        IF BK-AM-ACCOUNT (WSUB1) = SPACES OR LOW-VALUES OR ZEROS
  4859           PERFORM VARYING WSUB2 FROM WSUB1 BY +1 UNTIL
  4860              (BK-AM-ACCOUNT (WSUB2) NOT = SPACES AND LOW-VALUES
  4861                                       AND ZEROS)
  4862              OR (WSUB2 > PI-NDX)
  4863           END-PERFORM
  4864           IF WSUB2 NOT > PI-NDX
  4865              MOVE BK-AM-ACCOUNT (WSUB2)
  4866                                 TO BK-AM-ACCOUNT (WSUB1)
  4867              MOVE BK-AM-EFF-DT (WSUB2)
  4868                                 TO BK-AM-EFF-DT (WSUB1)
  4869              MOVE BK-AM-EXP-DT (WSUB2)
  4870                                 TO BK-AM-EXP-DT (WSUB1)
  4871              MOVE BK-AM-STATE (WSUB2)
  4872                                 TO BK-AM-STATE (WSUB1)
  4873              MOVE LOW-VALUES    TO BK-AM-ACCOUNT (WSUB2)
  4874                                    BK-AM-EFF-DT  (WSUB2)
  4875                                    BK-AM-EXP-DT  (WSUB2)
  4876                                    BK-AM-STATE   (WSUB2)
  4877           END-IF
  4878        END-IF
  4879     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL6523.cbl
  4880     PERFORM VARYING WSUB1 FROM +1 BY +1 UNTIL
  4881        BK-AM-ACCOUNT (WSUB1) = SPACES OR LOW-VALUES
  4882     END-PERFORM
  4883     COMPUTE PI-NDX = WSUB1 - +1
  4884     .
  4885 7325-EXIT.
  4886     EXIT.
  4887 7350-VERIFY-ACCOUNT.
  4888     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  4889     MOVE BK-COMPANY-CD          TO WS-ERACCT-COMP-CD
  4890     MOVE BK-CARRIER             TO WS-ERACCT-CARRIER
  4891     MOVE BK-GROUPING            TO WS-ERACCT-GROUPING
  4892     MOVE BK-AM-STATE (PI-NDX)   TO WS-ERACCT-STATE
  4893     MOVE BK-AM-ACCOUNT (PI-NDX) TO WS-ERACCT-ACCOUNT
  4894
  4895* EXEC CICS READ
  4896*        DATASET ('ERACCT')
  4897*        SET     (ADDRESS OF ACCOUNT-MASTER)
  4898*        RIDFLD  (WS-ERACCT-KEY)
  4899*        GTEQ
  4900*        RESP    (WS-RESPONSE)
  4901*    END-EXEC
  4902     MOVE 'ERACCT' TO DFHEIV1
  4903*    MOVE '&"S        G          (  N#00004550' TO DFHEIV0
  4904     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  4905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4906     MOVE X'204E233030303034353530' TO DFHEIV0(25:11)
  4907     CALL 'kxdfhei1' USING DFHEIV0,
  4908           DFHEIV1,
  4909           DFHEIV20,
  4910           DFHEIV99,
  4911           WS-ERACCT-KEY,
  4912           DFHEIV99,
  4913           DFHEIV99,
  4914           DFHEIV99
  4915     SET ADDRESS OF ACCOUNT-MASTER TO
  4916         DFHEIV20
  4917     MOVE EIBRESP  TO WS-RESPONSE
  4918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4919     IF RESP-NORMAL
  4920        IF (AM-COMPANY-CD   = PI-COMPANY-CD)
  4921           AND (AM-CARRIER  = BK-CARRIER)
  4922           AND (AM-GROUPING = BK-GROUPING)
  4923           AND (AM-STATE    = BK-AM-STATE (PI-NDX))
  4924           AND (AM-ACCOUNT  = BK-AM-ACCOUNT (PI-NDX))
  4925           GO TO 7350-EXIT
  4926        END-IF
  4927     END-IF
  4928     .
  4929 7350-NOT-FOUND.
  4930     MOVE ER-0226                TO EMI-ERROR
  4931     MOVE -1                     TO BL-ACCOUNTL (NDX)
  4932     MOVE AL-UABON               TO BL-ACCOUNTA (NDX)
  4933     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  4934     .
  4935 7350-EXIT.
  4936     EXIT.
  4937 7400-READ-CONTROL-FILE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL6523.cbl
  4938     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  4939     MOVE WS-ACCESS              TO CNTL-ACCESS
  4940
  4941* EXEC CICS HANDLE CONDITION
  4942*        NOTFND  (7490-NOT-FOUND)
  4943*        ERROR   (9990-ABEND)
  4944*    END-EXEC
  4945*    MOVE '"$I.                  ! + #00004578' TO DFHEIV0
  4946     MOVE X'2224492E2020202020202020' TO DFHEIV0(1:12)
  4947     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4948     MOVE X'2B20233030303034353738' TO DFHEIV0(25:11)
  4949     CALL 'kxdfhei1' USING DFHEIV0
  4950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4951
  4952* EXEC CICS READ
  4953*        DATASET  (CNTL-FILE-ID)
  4954*        SET      (ADDRESS OF CONTROL-FILE)
  4955*        RIDFLD   (ELCNTL-KEY)
  4956*    END-EXEC
  4957*    MOVE '&"S        E          (   #00004582' TO DFHEIV0
  4958     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4959     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4960     MOVE X'2020233030303034353832' TO DFHEIV0(25:11)
  4961     CALL 'kxdfhei1' USING DFHEIV0,
  4962           CNTL-FILE-ID,
  4963           DFHEIV20,
  4964           DFHEIV99,
  4965           ELCNTL-KEY,
  4966           DFHEIV99,
  4967           DFHEIV99,
  4968           DFHEIV99
  4969     SET ADDRESS OF CONTROL-FILE TO
  4970         DFHEIV20
  4971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4972     IF CNTL-REC-TYPE = '6'
  4973        MOVE AL-UANON           TO CARRIERA
  4974        MOVE CARRIERI           TO PI-ERC-CARRIER
  4975        GO TO 7499-EXIT
  4976     END-IF
  4977     .
  4978 7490-NOT-FOUND.
  4979     IF CNTL-REC-TYPE = '6'
  4980        MOVE -1                  TO CARRIERL
  4981        MOVE AL-UABON            TO CARRIERA
  4982        MOVE ER-0193             TO EMI-ERROR
  4983     END-IF
  4984     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  4985     .
  4986 7499-EXIT.
  4987     EXIT.
  4988 7500-COUNT-OPEN-RANGES.
  4989     MOVE +1                     TO NDX
  4990     MOVE +0                     TO WS-OPEN-COUNT.
  4991 7500-LOOP.
  4992     IF NDX GREATER THAN BK-BANK-POINTER-CNT
  4993          MOVE +1                TO NDX
  4994          GO TO 7500-EXIT.
  4995     IF BK-AM-EXP-DT (NDX) = HIGH-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL6523.cbl
  4996         ADD +1 TO WS-OPEN-COUNT.
  4997     ADD +1 TO NDX
  4998     GO TO 7500-LOOP.
  4999 7500-EXIT.
  5000     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL6523.cbl
  5002 7510-SORT-ACCOUNTS.
  5003     IF BK-BANK-POINTER-CNT NOT > +1
  5004        GO TO 7599-EXIT
  5005     END-IF
  5006     MOVE +1                     TO WSUB1
  5007                                    WSUB2
  5008     MOVE HIGH-VALUES            TO WS-WORK-ACCT-TABLE
  5009     .
  5010 7520-CONTINUE-SORT.
  5011     IF WSUB2 > BK-BANK-POINTER-CNT
  5012        GO TO 7540-RID-OF-HIGH-VALUES
  5013     END-IF
  5014     IF (BK-AM-ACCOUNT (WSUB1) < WS-AM-ACCOUNT (WSUB2))
  5015        AND (BK-AM-ACCOUNT (WSUB1) NOT = SPACES)
  5016        MOVE BK-BANK-POINTER (WSUB1)
  5017                                 TO WS-BANKS (WSUB2)
  5018        MOVE WSUB1               TO WSUB3
  5019     END-IF
  5020     ADD +1 TO WSUB1
  5021     IF WSUB1 NOT > BK-BANK-POINTER-CNT
  5022        GO TO 7520-CONTINUE-SORT
  5023     END-IF
  5024     MOVE HIGH-VALUES            TO BK-BANK-POINTER (WSUB3)
  5025     ADD +1                      TO WSUB2
  5026     MOVE +1                     TO WSUB1
  5027     GO TO 7520-CONTINUE-SORT
  5028     .
  5029 7540-RID-OF-HIGH-VALUES.
  5030     IF WS-BANKS (WSUB1) = HIGH-VALUES
  5031        MOVE SPACES              TO WS-BANKS (WSUB1)
  5032     END-IF
  5033     ADD +1 TO WSUB1
  5034     IF WSUB1 NOT > BK-BANK-POINTER-CNT
  5035        GO TO 7540-RID-OF-HIGH-VALUES
  5036     END-IF
  5037     MOVE +1                     TO WSUB1
  5038     MOVE +2                     TO WSUB2
  5039     .
  5040 7550-CHECK-DUPS.
  5041     IF (WS-AM-ACCOUNT (WSUB1) = WS-AM-ACCOUNT (WSUB2))
  5042        AND (WS-AM-STATE (WSUB1) = WS-AM-STATE (WSUB2))
  5043        AND (WS-AM-EXP-DT (WSUB1) NOT = SPACES)
  5044        MOVE ER-2947             TO  EMI-ERROR
  5045        PERFORM 9900-ERROR-FORMAT
  5046                                 THRU 9900-EXIT
  5047        MOVE -1                  TO  MAINTYPL
  5048        GO TO 8200-SEND-DATAONLY
  5049     END-IF
  5050     ADD +1 TO WSUB2
  5051     IF WSUB2 NOT > BK-BANK-POINTER-CNT
  5052        GO TO 7550-CHECK-DUPS
  5053     END-IF
  5054     ADD +1                      TO WSUB1
  5055     MOVE WSUB1                  TO WSUB2
  5056     ADD +1                      TO WSUB2
  5057     IF WSUB1 NOT > BK-BANK-POINTER-CNT
  5058        GO TO 7550-CHECK-DUPS
  5059     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL6523.cbl
  5060     PERFORM VARYING WSUB1 FROM +1 BY +1 UNTIL
  5061        (WSUB1 > BK-BANK-POINTER-CNT)
  5062        MOVE WS-BANKS (WSUB1)    TO BK-BANK-POINTER (WSUB1)
  5063     END-PERFORM
  5064     .
  5065 7599-EXIT.
  5066     EXIT.
  5067 8100-SEND-INITIAL-MAP.
  5068     MOVE SAVE-DATE              TO DATEO.
  5069     MOVE EIBTIME                TO TIME-IN.
  5070     MOVE TIME-OUT               TO TIMEO.
  5071     MOVE -1                     TO MAINTYPL
  5072     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  5073
  5074* EXEC CICS SEND
  5075*        MAP    (MAP-NAME)
  5076*        MAPSET (MAPSET-NAME)
  5077*        FROM   (EL652DO)
  5078*        ERASE
  5079*        CURSOR
  5080*        END-EXEC.
  5081     MOVE LENGTH OF
  5082      EL652DO
  5083       TO DFHEIV12
  5084     MOVE -1
  5085       TO DFHEIV11
  5086*    MOVE '8$     CT  E    H L F ,   #00004688' TO DFHEIV0
  5087     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5088     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5089     MOVE X'2020233030303034363838' TO DFHEIV0(25:11)
  5090     CALL 'kxdfhei1' USING DFHEIV0,
  5091           MAP-NAME,
  5092           EL652DO,
  5093           DFHEIV12,
  5094           MAPSET-NAME,
  5095           DFHEIV99,
  5096           DFHEIV99,
  5097           DFHEIV99,
  5098           DFHEIV11,
  5099           DFHEIV99,
  5100           DFHEIV99,
  5101           DFHEIV99
  5102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5103
  5104     GO TO 9100-RETURN-TRAN.
  5105 8200-SEND-DATAONLY.
  5106     MOVE SAVE-DATE              TO DATEO.
  5107     MOVE EIBTIME                TO TIME-IN.
  5108     MOVE TIME-OUT               TO TIMEO.
  5109     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  5110
  5111* EXEC CICS SEND
  5112*        MAP    (MAP-NAME)
  5113*        MAPSET (MAPSET-NAME)
  5114*        FROM   (EL652DO)
  5115*        DATAONLY
  5116*        CURSOR
  5117*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL6523.cbl
  5118     MOVE LENGTH OF
  5119      EL652DO
  5120       TO DFHEIV12
  5121     MOVE -1
  5122       TO DFHEIV11
  5123*    MOVE '8$D    CT       H L F ,   #00004701' TO DFHEIV0
  5124     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5125     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5126     MOVE X'2020233030303034373031' TO DFHEIV0(25:11)
  5127     CALL 'kxdfhei1' USING DFHEIV0,
  5128           MAP-NAME,
  5129           EL652DO,
  5130           DFHEIV12,
  5131           MAPSET-NAME,
  5132           DFHEIV99,
  5133           DFHEIV99,
  5134           DFHEIV99,
  5135           DFHEIV11,
  5136           DFHEIV99,
  5137           DFHEIV99,
  5138           DFHEIV99
  5139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5140
  5141     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL6523.cbl
  5143 8500-DATE-CONVERT.
  5144     MOVE LINK-ELDATCV           TO PGM-NAME.
  5145
  5146* EXEC CICS LINK
  5147*        PROGRAM    (PGM-NAME)
  5148*        COMMAREA   (DATE-CONVERSION-DATA)
  5149*        LENGTH     (DC-COMM-LENGTH)
  5150*        END-EXEC.
  5151*    MOVE '."C                   ''   #00004712' TO DFHEIV0
  5152     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5153     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5154     MOVE X'2020233030303034373132' TO DFHEIV0(25:11)
  5155     CALL 'kxdfhei1' USING DFHEIV0,
  5156           PGM-NAME,
  5157           DATE-CONVERSION-DATA,
  5158           DC-COMM-LENGTH,
  5159           DFHEIV99,
  5160           DFHEIV99,
  5161           DFHEIV99
  5162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5163
  5164 8500-EXIT.
  5165     EXIT.
  5166 8600-DEEDIT.
  5167
  5168* EXEC CICS  BIF DEEDIT
  5169*        FIELD   (WS-DEEDIT-FIELD)
  5170*        LENGTH  (10)
  5171*    END-EXEC.
  5172     MOVE 10
  5173       TO DFHEIV11
  5174*    MOVE '@"L                   #   #00004720' TO DFHEIV0
  5175     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5176     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5177     MOVE X'2020233030303034373230' TO DFHEIV0(25:11)
  5178     CALL 'kxdfhei1' USING DFHEIV0,
  5179           WS-DEEDIT-FIELD,
  5180           DFHEIV11
  5181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5182
  5183 8600-EXIT.
  5184      EXIT.
  5185 8810-PF23.
  5186     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  5187     MOVE XCTL-005               TO PGM-NAME.
  5188     GO TO 9300-XCTL.
  5189 9100-RETURN-TRAN.
  5190     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  5191     MOVE '652D'               TO PI-CURRENT-SCREEN-NO.
  5192
  5193* EXEC CICS RETURN
  5194*        TRANSID(TRANS-ID)
  5195*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  5196*        LENGTH(PI-COMM-LENGTH)
  5197*        END-EXEC.
  5198*    MOVE '.(CT                  &   #00004733' TO DFHEIV0
  5199     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5200     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL6523.cbl
  5201     MOVE X'2020233030303034373333' TO DFHEIV0(25:11)
  5202     CALL 'kxdfhei1' USING DFHEIV0,
  5203           TRANS-ID,
  5204           PROGRAM-INTERFACE-BLOCK,
  5205           PI-COMM-LENGTH,
  5206           DFHEIV99,
  5207           DFHEIV99
  5208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5209
  5210
  5211* GOBACK.
  5212     MOVE '9%                    "   ' TO DFHEIV0
  5213     MOVE 'EL6523' TO DFHEIV1
  5214     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5215     GOBACK.
  5216 9910-INITIALIZE-SECURITY.
  5217******************************************************************
  5218*                                                                *
  5219*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  5220*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
  5221*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  5222*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  5223*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  5224*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  5225*                                                                *
  5226******************************************************************
  5227     IF PI-PROCESSOR-ID NOT = 'LGXX'
  5228
  5229* EXEC CICS    READQ TS
  5230*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5231*            INTO    (SECURITY-CONTROL)
  5232*            LENGTH  (SC-COMM-LENGTH)
  5233*            ITEM    (SC-ITEM-CL-CR)
  5234*       END-EXEC
  5235*    MOVE '*$II   L              ''   #00004751' TO DFHEIV0
  5236     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5237     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5238     MOVE X'2020233030303034373531' TO DFHEIV0(25:11)
  5239     CALL 'kxdfhei1' USING DFHEIV0,
  5240           PI-SECURITY-TEMP-STORE-ID,
  5241           SECURITY-CONTROL,
  5242           SC-COMM-LENGTH,
  5243           SC-ITEM-CL-CR,
  5244           DFHEIV99,
  5245           DFHEIV99
  5246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5247        MOVE SC-CREDIT-DISPLAY (05)
  5248                                 TO PI-DISPLAY-CAP
  5249        MOVE SC-CREDIT-UPDATE  (05)
  5250                                 TO PI-MODIFY-CAP
  5251        IF  NOT DISPLAY-CAP
  5252            MOVE 'READ'          TO SM-READ
  5253            PERFORM 9995-SECURITY-VIOLATION
  5254                                 THRU 9995-EXIT
  5255            MOVE ER-0070         TO EMI-ERROR
  5256            PERFORM 9900-ERROR-FORMAT
  5257                                 THRU 9900-EXIT
  5258            GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL6523.cbl
  5259        END-IF
  5260     END-IF
  5261     .
  5262 9910-EXIT.
  5263     EXIT.
  5264 9200-RETURN-MAIN-MENU.
  5265     MOVE XCTL-626               TO PGM-NAME.
  5266     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL6523.cbl
  5268 9300-XCTL.
  5269
  5270* EXEC CICS XCTL
  5271*        PROGRAM    (PGM-NAME)
  5272*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  5273*        LENGTH     (PI-COMM-LENGTH)
  5274*        END-EXEC.
  5275*    MOVE '.$C                   $   #00004779' TO DFHEIV0
  5276     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5277     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5278     MOVE X'2020233030303034373739' TO DFHEIV0(25:11)
  5279     CALL 'kxdfhei1' USING DFHEIV0,
  5280           PGM-NAME,
  5281           PROGRAM-INTERFACE-BLOCK,
  5282           PI-COMM-LENGTH
  5283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5284
  5285 9400-CLEAR.
  5286     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  5287     GO TO 9300-XCTL.
  5288 9500-PF12.
  5289     MOVE XCTL-010               TO PGM-NAME.
  5290     GO TO 9300-XCTL.
  5291 9700-DATE-CONVERSION.
  5292
  5293* EXEC CICS LINK
  5294*        PROGRAM   ('ELDATCV')
  5295*        COMMAREA  (DATE-CONVERSION-DATA)
  5296*        LENGTH    (DC-COMM-LENGTH)
  5297*    END-EXEC.
  5298     MOVE 'ELDATCV' TO DFHEIV1
  5299*    MOVE '."C                   ''   #00004791' TO DFHEIV0
  5300     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5301     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5302     MOVE X'2020233030303034373931' TO DFHEIV0(25:11)
  5303     CALL 'kxdfhei1' USING DFHEIV0,
  5304           DFHEIV1,
  5305           DATE-CONVERSION-DATA,
  5306           DC-COMM-LENGTH,
  5307           DFHEIV99,
  5308           DFHEIV99,
  5309           DFHEIV99
  5310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5311
  5312 9700-EXIT.
  5313     EXIT.
  5314 9900-ERROR-FORMAT.
  5315     IF NOT EMI-ERRORS-COMPLETE
  5316         MOVE LINK-001 TO PGM-NAME
  5317
  5318* EXEC CICS LINK
  5319*            PROGRAM(PGM-NAME)
  5320*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  5321*            LENGTH(EMI-COMM-LENGTH)
  5322*            END-EXEC.
  5323*    MOVE '."C                   ''   #00004801' TO DFHEIV0
  5324     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5325     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL6523.cbl
  5326     MOVE X'2020233030303034383031' TO DFHEIV0(25:11)
  5327     CALL 'kxdfhei1' USING DFHEIV0,
  5328           PGM-NAME,
  5329           ERROR-MESSAGE-INTERFACE-BLOCK,
  5330           EMI-COMM-LENGTH,
  5331           DFHEIV99,
  5332           DFHEIV99,
  5333           DFHEIV99
  5334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5335
  5336 9900-EXIT.
  5337     EXIT.
  5338 9990-ABEND.
  5339     MOVE LINK-004 TO PGM-NAME.
  5340     MOVE DFHEIBLK TO EMI-LINE1.
  5341
  5342* EXEC CICS LINK
  5343*        PROGRAM   (PGM-NAME)
  5344*        COMMAREA  (EMI-LINE1)
  5345*        LENGTH    (72)
  5346*        END-EXEC.
  5347     MOVE 72
  5348       TO DFHEIV11
  5349*    MOVE '."C                   ''   #00004811' TO DFHEIV0
  5350     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5351     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5352     MOVE X'2020233030303034383131' TO DFHEIV0(25:11)
  5353     CALL 'kxdfhei1' USING DFHEIV0,
  5354           PGM-NAME,
  5355           EMI-LINE1,
  5356           DFHEIV11,
  5357           DFHEIV99,
  5358           DFHEIV99,
  5359           DFHEIV99
  5360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5361
  5362     GO TO 8200-SEND-DATAONLY.
  5363 9995-SECURITY-VIOLATION.
  5364*                                COPY ELCSCTP.
  5365******************************************************************
  5366*                                                                *
  5367*                            ELCSCTP                             *
  5368*                            VMOD=2.001                          *
  5369*                                                                *
  5370*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5371******************************************************************
  5372
  5373
  5374     MOVE EIBDATE          TO SM-JUL-DATE.
  5375     MOVE EIBTRMID         TO SM-TERMID.
  5376     MOVE THIS-PGM         TO SM-PGM.
  5377     MOVE EIBTIME          TO TIME-IN.
  5378     MOVE TIME-OUT         TO SM-TIME.
  5379     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5380
  5381
  5382* EXEC CICS LINK
  5383*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL6523.cbl
  5384*         COMMAREA (SECURITY-MESSAGE)
  5385*         LENGTH   (80)
  5386*    END-EXEC.
  5387     MOVE 'EL003' TO DFHEIV1
  5388     MOVE 80
  5389       TO DFHEIV11
  5390*    MOVE '."C                   ''   #00004835' TO DFHEIV0
  5391     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5392     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5393     MOVE X'2020233030303034383335' TO DFHEIV0(25:11)
  5394     CALL 'kxdfhei1' USING DFHEIV0,
  5395           DFHEIV1,
  5396           SECURITY-MESSAGE,
  5397           DFHEIV11,
  5398           DFHEIV99,
  5399           DFHEIV99,
  5400           DFHEIV99
  5401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5402
  5403
  5404******************************************************************
  5405
  5406 9995-EXIT.
  5407      EXIT.
  5408
  5409 9999-DFHBACK SECTION.
  5410     MOVE '9%                    "   ' TO DFHEIV0
  5411     MOVE 'EL6523' TO DFHEIV1
  5412     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5413     GOBACK.
  5414 9999-DFHEXIT.
  5415     IF DFHEIGDJ EQUAL 0001
  5416         NEXT SENTENCE
  5417     ELSE IF DFHEIGDJ EQUAL 2
  5418         GO TO 9990-ABEND,
  5419               8100-SEND-INITIAL-MAP
  5420         DEPENDING ON DFHEIGDI
  5421     ELSE IF DFHEIGDJ EQUAL 3
  5422         GO TO 1500-BXRF-NOT-FOUND,
  5423               0690-QIDERR
  5424         DEPENDING ON DFHEIGDI
  5425     ELSE IF DFHEIGDJ EQUAL 4
  5426         GO TO 1500-BXRF-NOT-FOUND
  5427         DEPENDING ON DFHEIGDI
  5428     ELSE IF DFHEIGDJ EQUAL 5
  5429         GO TO 4010-ERROR
  5430         DEPENDING ON DFHEIGDI
  5431     ELSE IF DFHEIGDJ EQUAL 6
  5432         GO TO 9990-ABEND,
  5433               4250-CONT
  5434         DEPENDING ON DFHEIGDI
  5435     ELSE IF DFHEIGDJ EQUAL 7
  5436         GO TO 5800-NO-RECORD,
  5437               5900-END-OF-FILE
  5438         DEPENDING ON DFHEIGDI
  5439     ELSE IF DFHEIGDJ EQUAL 8
  5440         GO TO 5900-END-OF-FILE
  5441         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL6523.cbl
  5442     ELSE IF DFHEIGDJ EQUAL 9
  5443         GO TO 1500-BXRF-NOT-FOUND
  5444         DEPENDING ON DFHEIGDI
  5445     ELSE IF DFHEIGDJ EQUAL 10
  5446         GO TO 7200-BXRF-NOT-FOUND
  5447         DEPENDING ON DFHEIGDI
  5448     ELSE IF DFHEIGDJ EQUAL 11
  5449         GO TO 7490-NOT-FOUND,
  5450               9990-ABEND
  5451         DEPENDING ON DFHEIGDI.
  5452     MOVE '9%                    "   ' TO DFHEIV0
  5453     MOVE 'EL6523' TO DFHEIV1
  5454     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5455     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       30500     Code:       11912
