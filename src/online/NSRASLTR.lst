* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page   1
* NSRASLTR.cbl
* Options: int("NSRASLTR.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASLTR.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASLTR.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "NSRASLTR.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRASLTR.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM INDEX.HTML
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page   2
* NSRASLTR.cbl
    14* 060611    2011022800001  PEMA  NEW PROGRAM
    15* 080612    2011022800001  AJRA  ADD AHL
    16* 101812  CR2012101700002  AJRA  ADD ENDARCH AND SCREENID
    17* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    18* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
    19* 061421  CR2017031500001  PEMA  Update to CCM8
    20******************************************************************
    21 ENVIRONMENT DIVISION.
    22 DATA DIVISION.
    23 working-storage section.
    24 01  DFH-START PIC X(04).
    25 77  ws-comm-length      pic 9(4) BINARY.
    26 01  P pointer.
    27 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    28 01  WS-KIXHOST                  PIC X(10).
    29 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    30 01  var-ptr pointer.
    31 01  env-var-len                 pic 9(4)  binary.
    32 01  rc                          pic 9(9)  binary.
    33 01  bl-length                   pic s9(5) value +0 comp-3.
    34 01  sl-length                   pic 9(8) binary.
    35 01  WS-KIXSYS.
    36     05  WS-KIX-FIL1             PIC X(10).
    37     05  WS-KIX-APPS             PIC X(10).
    38     05  WS-KIX-ENV              PIC X(10).
    39     05  WS-KIX-MYENV            PIC X(10).
    40     05  WS-KIX-SYS              PIC X(10).
    41************************************************
    42* commarea passed to the business logic
    43************************************************
    44 01 srch-commarea.
    45*                                copy ELCADLTRSPI.
    46******************************************************************
    47*                   C H A N G E   L O G
    48*
    49* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    50*-----------------------------------------------------------------
    51*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    52* EFFECTIVE    NUMBER
    53*-----------------------------------------------------------------
    54* 060611    2011022800001  PEMA  NEW COPYBOOK
    55* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
    56* 110612    2012101700002  AJRA  EXPAND PASSED DATA
    57******************************************************************
    58****************************************
    59*  commarea for NaperSoft On Demand Admin services letters
    60*  (business logic input & output)
    61****************************************
    62     03  BL-INPUT.
    63         05  BL-DATA-SRCE        PIC X.
    64         05  BL-LETTER-ID        PIC XXXX.
    65         05  BL-CARRIER          PIC X.
    66         05  BL-GROUP            PIC X(6).
    67         05  BL-STATE            PIC XX.
    68         05  BL-ACCOUNT          PIC X(10).
    69         05  BL-EFF-DT           PIC X(10).
    70         05  BL-CERT-NO          PIC X(11).
    71         05  BL-BATCH-NO         PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page   3
* NSRASLTR.cbl
    72         05  BL-BATCH-SEQ        PIC 9(8).
    73         05  BL-RESP-NO          PIC X(10).
    74         05  BL-NO-OF-COPIES     PIC 99.
    75         05  BL-PROC-ID          PIC XXXX.
    76         05  BL-COMP-ID          PIC XXX.
    77         05  BL-PRINT-NOW-SW     PIC X.
    78         05  BL-ENC-CD           PIC XXX.
    79         05  BL-RESEND-DT        PIC X(10).
    80         05  BL-FOLLOW-UP-DT     PIC X(10).
    81         05  BL-ARCHIVE-NO       PIC 9(8).
    82         05  BL-FUNC             PIC X(8).
    83         05  BL-COMMENTS         PIC X(100).
    84         05  FILLER REDEFINES BL-COMMENTS.
    85             10  BL-REASON-CODE OCCURS 12 PIC X(4).
    86             10  BL-LETTER-TO-ACCT PIC X.
    87             10  BL-LETTER-TO-BENE PIC X.
    88             10  BL-WRITE-ERARCH   PIC X.
    89                 88  ERARCH-QWS      VALUE 'Q'.
    90                 88  ERARCH-BATCH    VALUE 'B'.
    91                 88  ERARCH-TEMP     VALUE 'T'.
    92             10  BL-PROCESS-TYPE PIC X(07).
    93             10  BL-CERT-FORM-ID PIC X(05).
    94             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
    95             10  BL-SOURCE-SCREEN PIC X(8).
    96             10  FILLER          PIC X(25).
    97     03  BL-OUTPUT.
    98         05  BL-STATUS                   PIC X.
    99             88  BL-OK                      VALUE "P".
   100             88  BL-FAIL                  VALUE "F".
   101         05  BL-MESSAGE          PIC X(50).
   102     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   103     03  FILLER                  PIC X(31).
   104 01  INPUT-FROM-FORM.
   105     05  IFF-DATA-SRCE           PIC X.
   106     05  IFF-LETTER-ID           PIC XXXX.
   107     05  IFF-CARRIER             PIC X.
   108     05  IFF-GROUP               PIC X(6).
   109     05  IFF-STATE               PIC XX.
   110     05  IFF-ACCOUNT             PIC X(10).
   111     05  IFF-EFF-DT              PIC X(10).
   112     05  IFF-CERT-NO             PIC X(11).
   113     05  IFF-BATCH-NO            PIC X(6).
   114     05  IFF-BATCH-SEQ           PIC 9(8).
   115     05  IFF-RESP-NO             PIC X(10).
   116     05  IFF-NO-OF-COPIES        PIC 99.
   117     05  IFF-PROC-ID             PIC XXXX.
   118     05  IFF-COMP-ID             PIC XXX.
   119     05  IFF-PRINT-NOW-SW        PIC X.
   120     05  IFF-ENC-CD              PIC XXX.
   121     05  IFF-RESEND-DT           PIC X(10).
   122     05  IFF-FOLLOW-UP-DT        PIC X(10).
   123     05  IFF-ARCHIVE-NO          PIC 9(08).
   124     05  IFF-FUNC                PIC X(08).
   125*    05  IFF-COMMENTS            PIC X(70).
   126     05  IFF-ENDT-ARCH-NO        PIC 9(08).
   127************************************
   128* fields used to read web data
   129************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page   4
* NSRASLTR.cbl
   130 01  w-form-name       pic x(80).
   131 01  w-form-value      pic x(80).
   132 01  w-form-name-len   pic s9(8) comp.
   133 01  w-form-value-len  pic s9(8) comp.
   134 01  w-resp            pic s9(8) comp.
   135 01  w-doctoken        pic x(16).
   136* COMP ID TPE REGION   GROUP NAME       HOST          HTTP PORT
   137*
   138*  CID      CID1P      AcctServCID  sdv-nsft01       7001
   139*  CID      MDOFF      AcctServCID  hov-nsft01       7003
   140*  CID      CID1T      AcctServCID  hov-nsft01       6002
   141*  CID      PAUL       AcctServCID  hov-nsft01       5002
   142*  CID      TONY       AcctServCID  hov-nsft01       6003
   143*  DCC      CID1P      AcctServDCC  sdv-nsft01       7001
   144*  DCC      MDOFF      AcctServDCC  hov-nsft01       7003
   145*  DCC      CID1T      AcctServDCC  hov-nsft01       6002
   146*  DCC      PAUL       AcctServDCC  hov-nsft01       5002
   147*  DCC      TONY       AcctServDCC  hov-nsft01       6003
   148*  AHL      CID1P      AcctServAHL  sdv-nsft01       7001
   149*  AHL      MDOFF      AcctServAHL  hov-nsft01       7003
   150*  AHL      CID1T      AcctServAHL  hov-nsft01       6002
   151*  AHL      PAUL       AcctServAHL  hov-nsft01       5002
   152*  AHL      TONY       AcctServAHL  hov-nsft01       6003
   153*  AHL      AHLTST     AcctServAHL  hov-nsft01       6007
   154*  FNL      CID1P      AcctServFNL  sdv-nsft01       7001
   155*  FNL      MDOFF      AcctServFNL  hov-nsft01       7003
   156*  FNL      CID1T      AcctServFNL  hov-nsft01       6002
   157*  FNL      PAUL       AcctServFNL  hov-nsft01       5002
   158*  FNL      TONY       AcctServFNL  hov-nsft01       6003
   159*  FNL      AHLTST     AcctServFNL  hov-nsft01       6007
   160******************************************
   161* symbol list text for ASERR template
   162******************************************
   163 01  WS-ASERR.
   164     05  F                       PIC X(6)  VALUE "PGMDT=".
   165     05  ASERR-DT                PIC X(12) VALUE ' '.
   166     05  F                       PIC X(5)  VALUE '&MSG='.
   167     05  ASERR-MESS              PIC X(50) VALUE ' '.
   168******************************************
   169* symbol list text for ASHDR template
   170******************************************
   171 01  WS-PROD-CID-ASHDR.
   172     05  F                       PIC X(7)  VALUE "SERVER=".
   173     05  F                       PIC X(20) VALUE
   174                                    'sdv-nsft01.cso.local'.
   175     05  F                       PIC X(11) VALUE '&GROUPNAME='.
   176     05  F                       PIC X(11) VALUE 'AcctServCID'.
   177     05  F                       PIC X(7)  VALUE '&UNAME='.
   178     05  F                       PIC X(8)  VALUE 'batchjob'.
   179     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   180     05  F                       PIC X(8)  VALUE 'batchjob'.
   181 01  WS-PROD-DCC-ASHDR.
   182     05  F                       PIC X(7)  VALUE "SERVER=".
   183     05  F                       PIC X(20) VALUE
   184                                    'sdv-nsft01.cso.local'.
   185     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   186     05  F                       PIC X(11) VALUE 'AcctServDCC'.
   187     05  F                       PIC X(7)  VALUE '&UNAME='.
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page   5
* NSRASLTR.cbl
   188     05  F                       PIC X(8)  VALUE 'batchjob'.
   189     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   190     05  F                       PIC X(8)  VALUE 'batchjob'.
   191 01  WS-PROD-VPP-ASHDR.
   192     05  F                       PIC X(7)  VALUE "SERVER=".
   193     05  F                       PIC X(20) VALUE
   194                                    'sdv-nsft01.cso.local'.
   195     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   196     05  F                       PIC X(11) VALUE 'AcctServVPP'.
   197     05  F                       PIC X(7)  VALUE '&UNAME='.
   198     05  F                       PIC X(8)  VALUE 'batchjob'.
   199     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   200     05  F                       PIC X(8)  VALUE 'batchjob'.
   201 01  WS-PROD-AHL-ASHDR.
   202     05  F                       PIC X(7)  VALUE "SERVER=".
   203     05  F                       PIC X(20) VALUE
   204                                    'sdv-nsft01.cso.local'.
   205     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   206     05  F                       PIC X(11) VALUE 'AcctServAHL'.
   207     05  F                       PIC X(7)  VALUE '&UNAME='.
   208     05  F                       PIC X(8)  VALUE 'batchjob'.
   209     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   210     05  F                       PIC X(8)  VALUE 'batchjob'.
   211 01  WS-PROD-FNL-ASHDR.
   212     05  F                       PIC X(7)  VALUE "SERVER=".
   213     05  F                       PIC X(20) VALUE
   214                                    'sdv-nsft01.cso.local'.
   215     05  F                       PIC X(11) VALUE '&GROUPNAME='.
   216     05  F                       PIC X(11) VALUE 'AcctServFNL'.
   217     05  F                       PIC X(7)  VALUE '&UNAME='.
   218     05  F                       PIC X(8)  VALUE 'batchjob'.
   219     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   220     05  F                       PIC X(8)  VALUE 'batchjob'.
   221 01  WS-TEST-CID-ASHDR.
   222     05  F                       PIC X(7)  VALUE "SERVER=".
   223     05  F                       PIC X(20) VALUE
   224                          'hov-nsft02.cso.local'.
   225     05  F                       PIC X(11) VALUE '&GROUPNAME='.
   226     05  F                       PIC X(11) VALUE 'AcctServCID'.
   227     05  F                       PIC X(7)  VALUE '&UNAME='.
   228     05  F                       PIC X(8)  VALUE 'batchjob'.
   229     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   230     05  F                       PIC X(8)  VALUE 'batchjob'.
   231 01  WS-TEST-DCC-ASHDR.
   232     05  F                       PIC X(7)  VALUE "SERVER=".
   233     05  F                       PIC X(20) VALUE
   234                          'hov-nsft02.cso.local'.
   235     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   236     05  F                       PIC X(11) VALUE 'AcctServDCC'.
   237     05  F                       PIC X(7)  VALUE '&UNAME='.
   238     05  F                       PIC X(8)  VALUE 'batchjob'.
   239     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   240     05  F                       PIC X(8)  VALUE 'batchjob'.
   241
   242 01  WS-TEST-VPP-ASHDR.
   243     05  F                       PIC X(7)  VALUE "SERVER=".
   244     05  F                       PIC X(20) VALUE
   245                          'hov-nsft02.cso.local'.
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page   6
* NSRASLTR.cbl
   246     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   247     05  F                       PIC X(11) VALUE 'AcctServVPP'.
   248     05  F                       PIC X(7)  VALUE '&UNAME='.
   249     05  F                       PIC X(8)  VALUE 'batchjob'.
   250     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   251     05  F                       PIC X(8)  VALUE 'batchjob'.
   252
   253 01  WS-TEST-AHL-ASHDR.
   254     05  F                       PIC X(7)  VALUE "SERVER=".
   255     05  F                       PIC X(20) VALUE
   256                          'hov-nsft02.cso.local'.
   257     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   258     05  F                       PIC X(11) VALUE 'AcctServAHL'.
   259     05  F                       PIC X(7)  VALUE '&UNAME='.
   260     05  F                       PIC X(8)  VALUE 'batchjob'.
   261     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   262     05  F                       PIC X(8)  VALUE 'batchjob'.
   263 01  WS-TEST-FNL-ASHDR.
   264     05  F                       PIC X(7)  VALUE "SERVER=".
   265     05  F                       PIC X(20) VALUE
   266                          'hov-nsft02.cso.local'.
   267     05  F                       PIC X(11) VALUE '&GROUPNAME='.
   268     05  F                       PIC X(11) VALUE 'AcctServFNL'.
   269     05  F                       PIC X(7)  VALUE '&UNAME='.
   270     05  F                       PIC X(8)  VALUE 'batchjob'.
   271     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   272     05  F                       PIC X(8)  VALUE 'batchjob'.
   273******************************************
   274* symbol list text for ASFTR template
   275******************************************
   276 01  WS-VAR-SLUNIKIX.
   277     05  FILLER                  PIC X(18) VALUE
   278                                 "HOSTINFO=slunikix:".
   279     05  WS-SL-PORT              PIC XXXX  VALUE '7001'.
   280     05  FILLER                  PIC X(11)  VALUE "&URLVARLST=".
   281     05  WS-SL-KEY               PIC X(32)  VALUE SPACES.
   282*    05  FILLER                  PIC X(20) VALUE
   283*                                "&HOSTINFO2=slunikix:".
   284*    05  WS-SL-PORT2             PIC XXXX  VALUE '7001'.
   285*    05  FILLER                  PIC X(12)  VALUE "&URLVARLST2=".
   286*    05  WS-SL-KEY2              PIC X(12)  VALUE SPACES.
   287 01  WS-VAR-LOGICTEST.
   288     05  FILLER                  PIC X(19) VALUE
   289                                 "HOSTINFO=logictest:".
   290     05  WS-LT-PORT              PIC XXXX  VALUE '6002'.
   291     05  FILLER                  PIC X(11)  VALUE "&URLVARLST=".
   292     05  WS-LT-KEY               PIC X(32)  VALUE SPACES.
   293*    05  FILLER                  PIC X(21) VALUE
   294*                                "&HOSTINFO2=logictest:".
   295*    05  WS-LT-PORT2             PIC XXXX  VALUE '6002'.
   296*    05  FILLER                  PIC X(12)  VALUE "&URLVARLST2=".
   297*    05  WS-LT-KEY2              PIC X(12)  VALUE SPACES.
   298 01 WS-ASFTR.
   299    05  OT-COMP-ID           PIC XXX.
   300    05  OT-PRINT-NOW-SW      PIC X.
   301    05  OT-ARCHIVE-NO        PIC 9(08).
   302    05  OT-FUNC              PIC X(06).
   303    05  ot-batch-no          pic x(06).
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page   7
* NSRASLTR.cbl
   304    05  ot-batch-seq-no      pic x(08).
   305 01 output-msg.
   306    05 filler              pic x(4) value "MSG=".
   307    05 out-msg-text        pic x(50).
   308 01  MISC.
   309     12  WS-RESPONSE             PIC S9(8)   COMP.
   310         88  RESP-NORMAL                  VALUE +00.
   311         88  RESP-NOTFND                  VALUE +13.
   312         88  RESP-DUPREC                  VALUE +14.
   313         88  RESP-DUPKEY                  VALUE +15.
   314         88  RESP-NOTOPEN                 VALUE +19.
   315         88  RESP-ENDFILE                 VALUE +20.
   316*                                COPY ELCDATE.
   317******************************************************************
   318*                                                                *
   319*                                                                *
   320*                            ELCDATE.                            *
   321*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   322*                            VMOD=2.003
   323*                                                                *
   324*                                                                *
   325*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   326*                 LENGTH = 200                                   *
   327******************************************************************
   328
   329 01  DATE-CONVERSION-DATA.
   330     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   331     12  DC-OPTION-CODE                PIC X.
   332         88  BIN-TO-GREG                VALUE ' '.
   333         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   334         88  EDIT-GREG-TO-BIN           VALUE '2'.
   335         88  YMD-GREG-TO-BIN            VALUE '3'.
   336         88  MDY-GREG-TO-BIN            VALUE '4'.
   337         88  JULIAN-TO-BIN              VALUE '5'.
   338         88  BIN-PLUS-ELAPSED           VALUE '6'.
   339         88  FIND-CENTURY               VALUE '7'.
   340         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   341         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   342         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   343         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   344         88  JULIAN-TO-BIN-3            VALUE 'C'.
   345         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   346         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   347         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   348         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   349         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   350         88  CHECK-LEAP-YEAR            VALUE 'H'.
   351         88  BIN-3-TO-GREG              VALUE 'I'.
   352         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   353         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   354         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   355         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   356         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   357         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   358         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   359         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   360         88  THREE-CHARACTER-BIN
   361                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page   8
* NSRASLTR.cbl
   362         88  GREGORIAN-TO-BIN
   363                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   364         88  BIN-TO-GREGORIAN
   365                  VALUES ' ' '1' 'I' '8' 'G'.
   366         88  JULIAN-TO-BINARY
   367                  VALUES '5' 'C' 'E' 'F'.
   368     12  DC-ERROR-CODE                 PIC X.
   369         88  NO-CONVERSION-ERROR        VALUE ' '.
   370         88  DATE-CONVERSION-ERROR
   371                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   372         88  DATE-IS-ZERO               VALUE '1'.
   373         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   374         88  DATE-IS-INVALID            VALUE '3'.
   375         88  DATE1-GREATER-DATE2        VALUE '4'.
   376         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   377         88  DATE-INVALID-OPTION        VALUE '9'.
   378         88  INVALID-CENTURY            VALUE 'A'.
   379         88  ONLY-CENTURY               VALUE 'B'.
   380         88  ONLY-LEAP-YEAR             VALUE 'C'.
   381         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   382     12  DC-END-OF-MONTH               PIC X.
   383         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   384     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   385         88  USE-NORMAL-PROCESS         VALUE ' '.
   386         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   387         88  ADJUST-UP-100-YRS          VALUE '2'.
   388     12  FILLER                        PIC X.
   389     12  DC-CONVERSION-DATES.
   390         16  DC-BIN-DATE-1             PIC XX.
   391         16  DC-BIN-DATE-2             PIC XX.
   392         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   393         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   394                       DC-GREG-DATE-1-EDIT.
   395             20  DC-EDIT1-MONTH        PIC 99.
   396             20  SLASH1-1              PIC X.
   397             20  DC-EDIT1-DAY          PIC 99.
   398             20  SLASH1-2              PIC X.
   399             20  DC-EDIT1-YEAR         PIC 99.
   400         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   401         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   402                     DC-GREG-DATE-2-EDIT.
   403             20  DC-EDIT2-MONTH        PIC 99.
   404             20  SLASH2-1              PIC X.
   405             20  DC-EDIT2-DAY          PIC 99.
   406             20  SLASH2-2              PIC X.
   407             20  DC-EDIT2-YEAR         PIC 99.
   408         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   409         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   410                     DC-GREG-DATE-1-YMD.
   411             20  DC-YMD-YEAR           PIC 99.
   412             20  DC-YMD-MONTH          PIC 99.
   413             20  DC-YMD-DAY            PIC 99.
   414         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   415         16  DC-GREG-DATE-1-MDY-R REDEFINES
   416                      DC-GREG-DATE-1-MDY.
   417             20  DC-MDY-MONTH          PIC 99.
   418             20  DC-MDY-DAY            PIC 99.
   419             20  DC-MDY-YEAR           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page   9
* NSRASLTR.cbl
   420         16  DC-GREG-DATE-1-ALPHA.
   421             20  DC-ALPHA-MONTH        PIC X(10).
   422             20  DC-ALPHA-DAY          PIC 99.
   423             20  FILLER                PIC XX.
   424             20  DC-ALPHA-CENTURY.
   425                 24 DC-ALPHA-CEN-N     PIC 99.
   426             20  DC-ALPHA-YEAR         PIC 99.
   427         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   428         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   429         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   430         16  DC-JULIAN-DATE            PIC 9(05).
   431         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   432                                       PIC 9(05).
   433         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   434             20  DC-JULIAN-YEAR        PIC 99.
   435             20  DC-JULIAN-DAYS        PIC 999.
   436         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   437         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   438         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   439     12  DATE-CONVERSION-VARIBLES.
   440         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   441         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   442             20  FILLER                PIC 9(3).
   443             20  HOLD-CEN-1-CCYY.
   444                 24  HOLD-CEN-1-CC     PIC 99.
   445                 24  HOLD-CEN-1-YY     PIC 99.
   446             20  HOLD-CEN-1-MO         PIC 99.
   447             20  HOLD-CEN-1-DA         PIC 99.
   448         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   449             20  HOLD-CEN-1-R-MO       PIC 99.
   450             20  HOLD-CEN-1-R-DA       PIC 99.
   451             20  HOLD-CEN-1-R-CCYY.
   452                 24  HOLD-CEN-1-R-CC   PIC 99.
   453                 24  HOLD-CEN-1-R-YY   PIC 99.
   454             20  FILLER                PIC 9(3).
   455         16  HOLD-CENTURY-1-X.
   456             20  FILLER                PIC X(3)  VALUE SPACES.
   457             20  HOLD-CEN-1-X-CCYY.
   458                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   459                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   460             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   461             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   462         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   463             20  HOLD-CEN-1-R-X-MO     PIC XX.
   464             20  HOLD-CEN-1-R-X-DA     PIC XX.
   465             20  HOLD-CEN-1-R-X-CCYY.
   466                 24  HOLD-CEN-1-R-X-CC PIC XX.
   467                 24  HOLD-CEN-1-R-X-YY PIC XX.
   468             20  FILLER                PIC XXX.
   469         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   470         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   471         16  DC-JULIAN-DATE-1          PIC 9(07).
   472         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   473             20  DC-JULIAN-1-CCYY.
   474                 24  DC-JULIAN-1-CC    PIC 99.
   475                 24  DC-JULIAN-1-YR    PIC 99.
   476             20  DC-JULIAN-DA-1        PIC 999.
   477         16  DC-JULIAN-DATE-2          PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  10
* NSRASLTR.cbl
   478         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   479             20  DC-JULIAN-2-CCYY.
   480                 24  DC-JULIAN-2-CC    PIC 99.
   481                 24  DC-JULIAN-2-YR    PIC 99.
   482             20  DC-JULIAN-DA-2        PIC 999.
   483         16  DC-GREG-DATE-A-EDIT.
   484             20  DC-EDITA-MONTH        PIC 99.
   485             20  SLASHA-1              PIC X VALUE '/'.
   486             20  DC-EDITA-DAY          PIC 99.
   487             20  SLASHA-2              PIC X VALUE '/'.
   488             20  DC-EDITA-CCYY.
   489                 24  DC-EDITA-CENT     PIC 99.
   490                 24  DC-EDITA-YEAR     PIC 99.
   491         16  DC-GREG-DATE-B-EDIT.
   492             20  DC-EDITB-MONTH        PIC 99.
   493             20  SLASHB-1              PIC X VALUE '/'.
   494             20  DC-EDITB-DAY          PIC 99.
   495             20  SLASHB-2              PIC X VALUE '/'.
   496             20  DC-EDITB-CCYY.
   497                 24  DC-EDITB-CENT     PIC 99.
   498                 24  DC-EDITB-YEAR     PIC 99.
   499         16  DC-GREG-DATE-CYMD         PIC 9(08).
   500         16  DC-GREG-DATE-CYMD-R REDEFINES
   501                              DC-GREG-DATE-CYMD.
   502             20  DC-CYMD-CEN           PIC 99.
   503             20  DC-CYMD-YEAR          PIC 99.
   504             20  DC-CYMD-MONTH         PIC 99.
   505             20  DC-CYMD-DAY           PIC 99.
   506         16  DC-GREG-DATE-MDCY         PIC 9(08).
   507         16  DC-GREG-DATE-MDCY-R REDEFINES
   508                              DC-GREG-DATE-MDCY.
   509             20  DC-MDCY-MONTH         PIC 99.
   510             20  DC-MDCY-DAY           PIC 99.
   511             20  DC-MDCY-CEN           PIC 99.
   512             20  DC-MDCY-YEAR          PIC 99.
   513    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   514        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   515    12  DC-EL310-DATE                  PIC X(21).
   516    12  FILLER                         PIC X(28).
   517*****************************************
   518* symbol list for the ASBOD template
   519*****************************************
   520*                                COPY NSCASVARS.
   521******************************************************************
   522*                   C H A N G E   L O G
   523*
   524*        CURRENT SIZE - 6180
   525*
   526* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   527*-----------------------------------------------------------------
   528*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   529* EFFECTIVE    NUMBER
   530*-----------------------------------------------------------------
   531* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
   532* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
   533* 091213  CR2013090300001  AJRA  ADD NEXT BUSINESS DATE
   534* 121015  CR2015100900001  TANA  ADD VIN NUMBER
   535******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  11
* NSRASLTR.cbl
   536 01 NAPER-OUTPUT-DATA.
   537    05  F                       PIC X(07) VALUE "LETTER=".
   538    05  OUT-LETTER              PIC X(06) VALUE SPACES.
   539    05  F                       PIC X(08) VALUE "~PROCID=".
   540    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
   541    05  F                       PIC X(10) VALUE "~PROCNAME=".
   542    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
   543    05  F                       PIC X(11) VALUE "~PROCTITLE=".
   544    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
   545    05  F                       PIC X(09) VALUE "~CSRNAME=".
   546    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
   547    05  F                       PIC X(10) VALUE "~CSRTITLE=".
   548    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
   549    05  F                       PIC X(06) VALUE "~CARR=".
   550    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
   551    05  F                       PIC X(10) VALUE "~GROUPING=".
   552    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
   553    05  F                       PIC X(08) VALUE "~CERTST=".
   554    05  OUT-STATE               PIC X(02) VALUE SPACES.
   555    05  F                       PIC X(09) VALUE "~ACCOUNT=".
   556    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
   557    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
   558    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
   559    05  F                       PIC X(07) VALUE "~CRTNO=".
   560    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
   561    05  F                       PIC X(08) VALUE "~CRTSUF=".
   562    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
   563    05  F                       PIC X(08) VALUE "~ILNAME=".
   564    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
   565    05  F                       PIC X(08) VALUE "~IFNAME=".
   566    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
   567    05  F                       PIC X(08) VALUE "~IFINIT=".
   568    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
   569    05  F                       PIC X(08) VALUE "~IMINIT=".
   570    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
   571    05  F                       PIC X(09) VALUE "~IISSAGE=".
   572    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
   573    05  F                       PIC X(06) VALUE "~ISEX=".
   574    05  OUT-ISEX                PIC X(01) VALUE SPACES.
   575    05  F                       PIC X(10) VALUE "~INSADDR1=".
   576    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
   577    05  F                       PIC X(10) VALUE "~INSADDR2=".
   578    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
   579    05  F                       PIC X(09) VALUE "~INSCITY=".
   580    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
   581    05  F                       PIC X(10) VALUE "~INSSTATE=".
   582    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
   583    05  F                       PIC X(08) VALUE "~INSZIP=".
   584    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
   585    05  F                       PIC X(05) VALUE "~SSN=".
   586    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
   587    05  F                       PIC X(07) VALUE "~MEMNO=".
   588    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
   589    05  F                       PIC X(08) VALUE "~JLNAME=".
   590    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
   591    05  F                       PIC X(08) VALUE "~JFNAME=".
   592    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
   593    05  F                       PIC X(08) VALUE "~JMINIT=".
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  12
* NSRASLTR.cbl
   594    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
   595    05  F                       PIC X(08) VALUE "~JNTAGE=".
   596    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
   597    05  F                       PIC X(10) VALUE "~ACCTNAME=".
   598    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
   599    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
   600    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
   601    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
   602    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
   603    05  F                       PIC X(10) VALUE "~ACCTCITY=".
   604    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
   605    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
   606    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
   607    05  F                       PIC X(09) VALUE "~ACCTZIP=".
   608    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
   609    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
   610    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
   611    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
   612    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
   613    05  F                       PIC X(09) VALUE "~BUSTYPE=".
   614    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
   615    05  F                       PIC X(10) VALUE "~BENENAME=".
   616    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
   617    05  F                       PIC X(11) VALUE "~BENEADDR1=".
   618    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
   619    05  F                       PIC X(11) VALUE "~BENEADDR2=".
   620    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
   621    05  F                       PIC X(10) VALUE "~BENECITY=".
   622    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
   623    05  F                       PIC X(11) VALUE "~BENESTATE=".
   624    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
   625    05  F                       PIC X(09) VALUE "~BENEZIP=".
   626    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
   627    05  F                       PIC X(10) VALUE "~CARRNAME=".
   628    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
   629    05  F                       PIC X(08) VALUE "~RESPNO=".
   630    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
   631    05  F                       PIC X(12) VALUE "~COACCTNAME=".
   632    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
   633    05  F                       PIC X(12) VALUE "~COMAILNAME=".
   634    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
   635    05  F                       PIC X(11) VALUE "~COMPADDR1=".
   636    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
   637    05  F                       PIC X(11) VALUE "~COMPADDR2=".
   638    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
   639    05  F                       PIC X(10) VALUE "~COMPCITY=".
   640    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
   641    05  F                       PIC X(11) VALUE "~COMPSTATE=".
   642    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
   643    05  F                       PIC X(09) VALUE "~COMPZIP=".
   644    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
   645    05  F                       PIC X(11) VALUE "~COMPPHONE=".
   646    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
   647    05  F                       PIC X(09) VALUE "~COMPFAX=".
   648    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
   649    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
   650    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
   651    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  13
* NSRASLTR.cbl
   652    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
   653    05  F                       PIC X(08) VALUE "~RPTCD1=".
   654    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
   655    05  F                       PIC X(08) VALUE "~RPTCD2=".
   656    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
   657    05  F                       PIC X(09) VALUE "~ENTRYDT=".
   658    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
   659    05  F                       PIC X(07) VALUE "~BATCH=".
   660    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
   661    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
   662    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
   663    05  F                       PIC X(10) VALUE "~1STPMTDT=".
   664    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
   665    05  F                       PIC X(05) VALUE "~APR=".
   666    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
   667    05  F                       PIC X(08) VALUE "~LNTERM=".
   668    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
   669    05  F                       PIC X(11) VALUE "~RATECLASS=".
   670    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
   671    05  F                       PIC X(09) VALUE "~EXTDAYS=".
   672    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
   673    05  F                       PIC X(09) VALUE "~CSRCODE=".
   674    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
   675    05  F                       PIC X(07) VALUE "~UCODE=".
   676    05  OUT-UCODE               PIC X(01) VALUE SPACES.
   677    05  F                       PIC X(10) VALUE "~PREMTYPE=".
   678    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
   679    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
   680    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
   681    05  F                       PIC X(06) VALUE "~SKIP=".
   682    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
   683    05  F                       PIC X(06) VALUE "~MODE=".
   684    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
   685    05  F                       PIC X(09) VALUE "~LOANOFF=".
   686    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
   687    05  F                       PIC X(06) VALUE "~RTBL=".
   688    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
   689    05  F                       PIC X(10) VALUE "~SPECREIN=".
   690    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
   691    05  F                       PIC X(09) VALUE "~LFBENCD=".
   692    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
   693    05  F                       PIC X(08) VALUE "~LFTERM=".
   694    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
   695    05  F                       PIC X(07) VALUE "~LFDEV=".
   696    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
   697    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
   698    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
   699    05  F                       PIC X(07) VALUE "~LFBEN=".
   700    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
   701    05  F                       PIC X(08) VALUE "~LFPREM=".
   702    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
   703    05  F                       PIC X(08) VALUE "~LFABEN=".
   704    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
   705    05  F                       PIC X(09) VALUE "~LFAPREM=".
   706    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
   707    05  F                       PIC X(07) VALUE "~LFNSP=".
   708    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
   709    05  F                       PIC X(08) VALUE "~LFRBEN=".
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  14
* NSRASLTR.cbl
   710    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
   711    05  F                       PIC X(07) VALUE "~LFCAN=".
   712    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
   713    05  F                       PIC X(07) VALUE "~LFDTH=".
   714    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
   715    05  F                       PIC X(08) VALUE "~LFRATE=".
   716    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
   717    05  F                       PIC X(09) VALUE "~LFARATE=".
   718    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
   719    05  F                       PIC X(09) VALUE "~LFEXPDT=".
   720    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
   721    05  F                       PIC X(08) VALUE "~LFSTAT=".
   722    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
   723    05  F                       PIC X(09) VALUE "~LFCANDT=".
   724    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
   725    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
   726    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
   727    05  F                       PIC X(07) VALUE "~DTHDT=".
   728    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
   729    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
   730    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
   731    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
   732    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
   733    05  F                       PIC X(08) VALUE "~LFCOMM=".
   734    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
   735    05  F                       PIC X(11) VALUE "~LFBENDESC=".
   736    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
   737    05  F                       PIC X(11) VALUE "~LFBENABRV=".
   738    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
   739    05  F                       PIC X(09) VALUE "~AHBENCD=".
   740    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
   741    05  F                       PIC X(08) VALUE "~AHTERM=".
   742    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
   743    05  F                       PIC X(11) VALUE "~AHCRITPER=".
   744    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
   745    05  F                       PIC X(09) VALUE "~AHDEVCD=".
   746    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
   747    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
   748    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
   749    05  F                       PIC X(07) VALUE "~AHBEN=".
   750    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
   751    05  F                       PIC X(08) VALUE "~AHPREM=".
   752    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
   753    05  F                       PIC X(07) VALUE "~AHNSP=".
   754    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
   755    05  F                       PIC X(07) VALUE "~AHCAN=".
   756    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
   757    05  F                       PIC X(10) VALUE "~AHITDPMT=".
   758    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
   759    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
   760    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
   761    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
   762    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
   763    05  F                       PIC X(08) VALUE "~AHRATE=".
   764    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
   765    05  F                       PIC X(09) VALUE "~AHEXPDT=".
   766    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
   767    05  F                       PIC X(08) VALUE "~AHSTAT=".
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  15
* NSRASLTR.cbl
   768    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
   769    05  F                       PIC X(09) VALUE "~AHCANDT=".
   770    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
   771    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
   772    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
   773    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
   774    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
   775    05  F                       PIC X(08) VALUE "~AHCOMM=".
   776    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
   777    05  F                       PIC X(11) VALUE "~AHBENDESC=".
   778    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
   779    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
   780    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
   781    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
   782    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
   783    05  F                       PIC X(08) VALUE "~AHWAIT=".
   784    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
   785    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
   786    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
   787    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
   788                                PIC X(2).
   789    05  F                       PIC X(09) VALUE "~TOTPREM=".
   790    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
   791    05  F                       PIC X(08) VALUE "~TOTREF=".
   792    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
   793    05  F                       PIC X(08) VALUE "~SEXPDT=".
   794    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
   795    05  F                       PIC X(07) VALUE "~STERM=".
   796    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
   797    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
   798    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
   799    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
   800    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
   801    05  F                       PIC X(11) VALUE "~IORIGINIT=".
   802    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
   803    05  F                       PIC X(10) VALUE "~IORIGAGE=".
   804    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
   805    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
   806    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
   807    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
   808    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
   809    05  F                       PIC X(11) VALUE "~JORIGINIT=".
   810    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
   811    05  F                       PIC X(10) VALUE "~JORIGAGE=".
   812    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
   813    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
   814    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
   815    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
   816    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
   817    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
   818    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
   819    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
   820                                PIC X(12).
   821    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
   822    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
   823    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
   824                                PIC X(12).
   825    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  16
* NSRASLTR.cbl
   826    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
   827    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
   828    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
   829    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
   830    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
   831    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
   832    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
   833    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
   834                                PIC X(12).
   835    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
   836    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
   837    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
   838                                PIC X(10).
   839    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
   840    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
   841    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
   842    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
   843    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
   844    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
   845    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
   846    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
   847    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
   848    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
   849    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
   850    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
   851    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
   852                                PIC X(10).
   853    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
   854    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
   855    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
   856                                PIC X(10).
   857    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
   858    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
   859    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
   860    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
   861    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
   862    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
   863    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
   864    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
   865    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
   866    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
   867    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
   868    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
   869    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
   870    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
   871    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
   872    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
   873    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
   874    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
   875    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
   876                                PIC X(2).
   877    05  F                       PIC X(09) VALUE "~OSEXPDT=".
   878    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
   879    05  F                       PIC X(08) VALUE "~OSTERM=".
   880    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
   881    05  F                       PIC X(11) VALUE "~INEWLNAME=".
   882    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
   883    05  F                       PIC X(11) VALUE "~INEWFNAME=".
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  17
* NSRASLTR.cbl
   884    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
   885    05  F                       PIC X(10) VALUE "~INEWINIT=".
   886    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
   887    05  F                       PIC X(09) VALUE "~INEWAGE=".
   888    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
   889    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
   890                                PIC X(09).
   891    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
   892    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
   893    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
   894    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
   895    05  F                       PIC X(10) VALUE "~JNEWINIT=".
   896    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
   897    05  F                       PIC X(09) VALUE "~JNEWAGE=".
   898    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
   899    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
   900                                PIC X(09).
   901    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
   902    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
   903    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
   904    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
   905    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
   906                                PIC X(09).
   907    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
   908    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
   909    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
   910                                PIC X(12).
   911    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
   912    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
   913    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
   914                                PIC X(10).
   915    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
   916    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
   917    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
   918    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
   919    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
   920                                PIC X(12).
   921    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
   922    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
   923    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
   924                                PIC X(10).
   925    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
   926    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
   927    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
   928    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
   929    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
   930    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
   931    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
   932    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
   933    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
   934                                PIC X(09).
   935    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
   936    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
   937    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
   938                                PIC X(09).
   939    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
   940    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
   941    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  18
* NSRASLTR.cbl
   942                                PIC X(10).
   943    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
   944    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
   945    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
   946                                PIC X(10).
   947    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
   948    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
   949    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
   950    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
   951    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
   952    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
   953    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
   954    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
   955    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
   956    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
   957    05  F                       PIC X(09) VALUE "~NEWWAIT=".
   958    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
   959    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
   960    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
   961    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
   962                                PIC X(09).
   963    05  F                       PIC X(09) VALUE "~NSEXPDT=".
   964    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
   965    05  F                       PIC X(08) VALUE "~NSTERM=".
   966    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
   967    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
   968                                PIC X(09).
   969    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
   970    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
   971    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
   972    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
   973    05  F                       PIC X(11) VALUE "~PAYABLETO=".
   974    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
   975    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
   976    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
   977    05  F                       PIC X(09) VALUE "~BALLOON=".
   978    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
   979    05  F                       PIC X(10) VALUE "~LEASEIND=".
   980    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
   981    05  F                       PIC X(09) VALUE "~RESCIND=".
   982    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
   983    05  F                       PIC X(07) VALUE "~RCD01=".
   984    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
   985    05  F                       PIC X(07) VALUE "~RCD02=".
   986    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
   987    05  F                       PIC X(07) VALUE "~RCD03=".
   988    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
   989    05  F                       PIC X(07) VALUE "~RCD04=".
   990    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
   991    05  F                       PIC X(07) VALUE "~RCD05=".
   992    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
   993    05  F                       PIC X(07) VALUE "~RCD06=".
   994    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
   995    05  F                       PIC X(07) VALUE "~RCD07=".
   996    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
   997    05  F                       PIC X(07) VALUE "~RCD08=".
   998    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
   999    05  F                       PIC X(07) VALUE "~RCD09=".
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  19
* NSRASLTR.cbl
  1000    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  1001    05  F                       PIC X(07) VALUE "~RCD10=".
  1002    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  1003    05  F                       PIC X(07) VALUE "~RCD11=".
  1004    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  1005    05  F                       PIC X(07) VALUE "~RCD12=".
  1006    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  1007    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
  1008    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  1009    05  F                       PIC X(08) VALUE "~ARCHNO=".
  1010    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  1011    05  F                       PIC X(06) VALUE "~FORM=".
  1012    05  OUT-FORM                PIC X(03) VALUE SPACES.
  1013    05  F                       PIC X(09) VALUE "~ENCLINE=".
  1014    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  1015    05  F                       PIC X(08) VALUE "~ATTACH=".
  1016    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
  1017    05  F                       PIC X(10) VALUE "~OUTSTACK=".
  1018    05  OUT-STACK               PIC X(10) VALUE SPACES.
  1019    05  F                       PIC X(11) VALUE "~STATENAME=".
  1020    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
  1021    05  F                       PIC X(08) VALUE "~PRTNOW=".
  1022    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  1023    05  F                       PIC X(05) VALUE "~NCB=".
  1024    05  OUT-CHGBACK             PIC X     VALUE ' '.
  1025    05  F                       PIC X(8) VALUE "~CSOAMT=".
  1026    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  1027    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  1028    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
  1029    05  F                       PIC X(09) VALUE "~LETRTYP=".
  1030    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
  1031    05  F                       PIC X(10) VALUE "~PRNTCERT=".
  1032    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
  1033    05  F                       PIC X(08) VALUE "~INSBDT=".
  1034    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
  1035    05  F                       PIC X(08) VALUE "~JNTBDT=".
  1036    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
  1037    05  F                       PIC X(08) VALUE "~TOTINT=".
  1038    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
  1039    05  F                       PIC X(8) VALUE "~TOPREM=".
  1040    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  1041    05  F                       PIC X(7) VALUE "~TOREF=".
  1042    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  1043    05  F                       PIC X(7) VALUE "~CANDT=".
  1044    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  1045    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  1046    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  1047    05  F                       PIC X(08) VALUE "~CERTID=".
  1048    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  1049    05  F                       PIC X(08) VALUE "~UNDWID=".
  1050    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
  1051    05  F                       PIC X(8) VALUE "~TNPREM=".
  1052    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  1053    05  F                       PIC X(7) VALUE "~TNREF=".
  1054    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  1055    05  F                       PIC X(8)  VALUE "~COVIND=".
  1056    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  1057    05  F                       PIC X(9)  VALUE "~OCOVIND=".
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  20
* NSRASLTR.cbl
  1058    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  1059    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  1060    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  1061    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  1062    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  1063    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  1064    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  1065    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  1066    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  1067    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  1068                                PIC X(10).
  1069    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  1070    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  1071    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  1072    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  1073    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  1074    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  1075    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
  1076    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  1077    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  1078    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  1079    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  1080    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  1081    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  1082    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  1083    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  1084    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  1085    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  1086    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  1087    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  1088    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  1089    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  1090    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  1091    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  1092    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  1093    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  1094    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  1095    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  1096    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  1097    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  1098    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  1099    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  1100    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1101    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  1102    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1103    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  1104    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  1105    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  1106    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  1107    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  1108    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  1109    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  1110    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1111    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  1112    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1113    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  1114    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  1115    05  F                       PIC X(09) VALUE "~CSOOAMT=".
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  21
* NSRASLTR.cbl
  1116    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  1117    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  1118    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  1119    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  1120    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1121    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  1122    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1123    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  1124    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  1125    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  1126    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  1127    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  1128    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  1129    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  1130    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1131    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  1132    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1133    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
  1134    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  1135    05  F                       PIC X(09) VALUE "~CSONAMT=".
  1136    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  1137    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  1138    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  1139    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  1140    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  1141    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  1142    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  1143    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  1144    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  1145    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  1146    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  1147    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  1148    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  1149    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  1150    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  1151    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  1152    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  1153    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  1154    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  1155    05  F                       PIC X(08) VALUE "~CSOCHG=".
  1156    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  1157    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  1158    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  1159    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  1160    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  1161    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  1162    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  1163    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  1164    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  1165    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  1166    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  1167    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  1168    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  1169    05  F                       PIC X(8)  VALUE "~SCREEN=".
  1170    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  1171    05  F                       PIC X(9)  VALUE "~NXTBSDT=".
  1172    05  OUT-NEXT-BUS-DT         PIC X(21) VALUE SPACES.
  1173    05  F                       PIC X(7)  VALUE "~VINNO=".
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  22
* NSRASLTR.cbl
  1174    05  OUT-VIN-NUMBER          PIC X(17) VALUE SPACES.
  1175    05  F                       PIC X(11) VALUE 'EndOfString'.
  1176    05  f                       pic x(2) value spaces.
  1177****************************************************************
  1178*
  1179* Copyright (c) 2007-2013 Dell Inc.
  1180* All rights reserved.
  1181*
  1182****************************************************************
  1183 01  DFHEIV.
  1184   02  DFHEIV0               PIC X(35).
  1185   02  DFHEIV1               PIC X(08).
  1186   02  DFHEIV2               PIC X(08).
  1187   02  DFHEIV3               PIC X(08).
  1188   02  DFHEIV4               PIC X(06).
  1189   02  DFHEIV5               PIC X(04).
  1190   02  DFHEIV6               PIC X(04).
  1191   02  DFHEIV7               PIC X(02).
  1192   02  DFHEIV8               PIC X(02).
  1193   02  DFHEIV9               PIC X(01).
  1194   02  DFHEIV10              PIC S9(7) COMP-3.
  1195   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1196   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1197   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1198   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1199   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1200   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1201   02  DFHEIV17              PIC X(04).
  1202   02  DFHEIV18              PIC X(04).
  1203   02  DFHEIV19              PIC X(04).
  1204   02  DFHEIV20              USAGE IS POINTER.
  1205   02  DFHEIV21              USAGE IS POINTER.
  1206   02  DFHEIV22              USAGE IS POINTER.
  1207   02  DFHEIV23              USAGE IS POINTER.
  1208   02  DFHEIV24              USAGE IS POINTER.
  1209   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1210   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1211   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1212   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1213   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1214   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1215   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1216   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1217   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1218   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1219   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1220   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1221   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1222   02  FILLER                PIC X(02).
  1223   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1224   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1225   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1226   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1227   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1228   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1229   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1230 LINKAGE  SECTION.
  1231*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  23
* NSRASLTR.cbl
  1232*                                                               *
  1233* Copyright (c) 2007-2013 Dell Inc.                             *
  1234* All rights reserved.                                          *
  1235*                                                               *
  1236*****************************************************************
  1237 01  dfheiblk.
  1238     02  eibtime          pic s9(7) comp-3.
  1239     02  eibdate          pic s9(7) comp-3.
  1240     02  eibtrnid         pic x(4).
  1241     02  eibtaskn         pic s9(7) comp-3.
  1242     02  eibtrmid         pic x(4).
  1243     02  dfheigdi         pic s9(4) comp.
  1244     02  eibcposn         pic s9(4) comp.
  1245     02  eibcalen         pic s9(4) comp.
  1246     02  eibaid           pic x(1).
  1247     02  eibfiller1       pic x(1).
  1248     02  eibfn            pic x(2).
  1249     02  eibfiller2       pic x(2).
  1250     02  eibrcode         pic x(6).
  1251     02  eibfiller3       pic x(2).
  1252     02  eibds            pic x(8).
  1253     02  eibreqid         pic x(8).
  1254     02  eibrsrce         pic x(8).
  1255     02  eibsync          pic x(1).
  1256     02  eibfree          pic x(1).
  1257     02  eibrecv          pic x(1).
  1258     02  eibsend          pic x(1).
  1259     02  eibatt           pic x(1).
  1260     02  eibeoc           pic x(1).
  1261     02  eibfmh           pic x(1).
  1262     02  eibcompl         pic x(1).
  1263     02  eibsig           pic x(1).
  1264     02  eibconf          pic x(1).
  1265     02  eiberr           pic x(1).
  1266     02  eibrldbk         pic x(1).
  1267     02  eiberrcd         pic x(4).
  1268     02  eibsynrb         pic x(1).
  1269     02  eibnodat         pic x(1).
  1270     02  eibfiller5       pic x(2).
  1271     02  eibresp          pic s9(8) comp.
  1272     02  eibresp2         pic s9(8) comp.
  1273     02  dfheigdj         pic s9(4) comp.
  1274     02  dfheigdk         pic s9(4) comp.
  1275 01  DFHCOMMAREA       PIC X(01).
  1276 01  var  pic x(30).
  1277 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  1278 0000-DFHEXIT SECTION.
  1279     MOVE '9#                    $   ' TO DFHEIV0.
  1280     MOVE 'NSRASLTR' TO DFHEIV1.
  1281     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1282*********************
  1283* Receive web input
  1284*********************
  1285*    DISPLAY ' ENTERING NSRASLTR '
  1286     set P to address of KIXSYS
  1287     CALL "getenv" using by value P returning var-ptr
  1288     if var-ptr = null then
  1289        display ' kixsys not set '
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  24
* NSRASLTR.cbl
  1290     else
  1291        set address of var to var-ptr
  1292        move 0 to env-var-len
  1293        inspect var tallying env-var-len
  1294          for characters before X'00'
  1295        DISPLAY '  KIXSYS = ' var (1:env-var-len)
  1296        unstring var (1:env-var-len) delimited by '/'
  1297           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  1298              WS-KIX-SYS
  1299        end-unstring
  1300*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  1301*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  1302     end-if
  1303     set P to address of KIXHOST
  1304     CALL "getenv" using by value P returning var-ptr
  1305     if var-ptr = null then
  1306        display ' kixhost not set '
  1307     else
  1308        set address of var to var-ptr
  1309        move 0 to env-var-len
  1310        inspect var tallying env-var-len
  1311          for characters before X'00'
  1312        MOVE var(1:env-var-len)  to ws-kixhost
  1313        DISPLAY ' WS KIX HOST ' WS-KIXHOST
  1314     end-if
  1315     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1316     MOVE '5'                    TO DC-OPTION-CODE
  1317     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  1318     MOVE DC-GREG-DATE-A-EDIT    TO ASERR-DT
  1319
  1320* exec cics web
  1321*       startbr formfield resp(w-resp)
  1322*     end-exec.
  1323*    MOVE 'X(f                   &  N#00001315' TO DFHEIV0
  1324     MOVE X'582866202020202020202020' TO DFHEIV0(1:12)
  1325     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1326     MOVE X'204E233030303031333135' TO DFHEIV0(25:11)
  1327     CALL 'kxdfhei1' USING DFHEIV0,
  1328           DFHEIV99,
  1329           DFHEIV99,
  1330           DFHEIV99,
  1331           DFHEIV99,
  1332           DFHEIV99
  1333     MOVE EIBRESP  TO w-resp
  1334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1335
  1336      perform read-form thru read-form-exit
  1337         until w-resp not = 0 .
  1338*   dfhresp(normal)
  1339
  1340* exec cics web
  1341*       endbr formfield
  1342*     end-exec
  1343*    MOVE 'X,f                   #   #00001320' TO DFHEIV0
  1344     MOVE X'582C66202020202020202020' TO DFHEIV0(1:12)
  1345     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1346     MOVE X'2020233030303031333230' TO DFHEIV0(25:11)
  1347     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  25
* NSRASLTR.cbl
  1348           DFHEIV99,
  1349           DFHEIV99
  1350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1351*    display ' form input ' INPUT-FROM-FORM
  1352     MOVE SPACES                  TO BL-INPUT
  1353     MOVE IFF-DATA-SRCE           TO BL-DATA-SRCE
  1354     MOVE IFF-CARRIER             TO BL-CARRIER
  1355     MOVE IFF-GROUP               TO BL-GROUP
  1356     MOVE IFF-STATE               TO BL-STATE
  1357     MOVE IFF-ACCOUNT             TO BL-ACCOUNT
  1358     MOVE IFF-EFF-DT              TO BL-EFF-DT
  1359     MOVE IFF-CERT-NO             TO BL-CERT-NO
  1360     MOVE IFF-BATCH-NO            TO BL-BATCH-NO
  1361                                     ot-batch-no
  1362     MOVE IFF-BATCH-SEQ           TO BL-BATCH-SEQ
  1363                                     ot-batch-seq-no
  1364     MOVE IFF-RESP-NO             TO BL-RESP-NO
  1365     MOVE IFF-LETTER-ID           TO BL-LETTER-ID
  1366     MOVE IFF-NO-OF-COPIES        TO BL-NO-OF-COPIES
  1367     MOVE IFF-PROC-ID             TO BL-PROC-ID
  1368     MOVE IFF-COMP-ID             TO OT-COMP-ID
  1369                                     BL-COMP-ID
  1370     MOVE IFF-PRINT-NOW-SW        TO OT-PRINT-NOW-SW
  1371                                     BL-PRINT-NOW-SW
  1372     MOVE IFF-ENC-CD              TO BL-ENC-CD
  1373     MOVE IFF-RESEND-DT           TO BL-RESEND-DT
  1374     MOVE IFF-FOLLOW-UP-DT        TO BL-FOLLOW-UP-DT
  1375*    MOVE IFF-COMMENTS            TO BL-COMMENTS
  1376     MOVE IFF-ARCHIVE-NO          TO BL-ARCHIVE-NO
  1377     MOVE IFF-FUNC                TO BL-FUNC
  1378                                     OT-FUNC
  1379     MOVE IFF-ENDT-ARCH-NO        TO BL-ENDT-ARCH-NO
  1380
  1381     EVALUATE BL-FUNC
  1382         WHEN 'Letter'
  1383             MOVE 'LETTER'        TO BL-SOURCE-SCREEN
  1384         WHEN 'CrtVerif'
  1385             MOVE 'VERIFY'        TO BL-SOURCE-SCREEN
  1386         WHEN 'Endorse'
  1387             MOVE 'ISS ENDT'      TO BL-SOURCE-SCREEN
  1388         WHEN 'CancChg'
  1389             MOVE 'CAN ENDT'      TO BL-SOURCE-SCREEN
  1390         WHEN OTHER
  1391             MOVE 'UNKNOWN'       TO BL-SOURCE-SCREEN
  1392     END-EVALUATE
  1393
  1394*****************************************
  1395* Since this program was called from the webservice
  1396* we really don't know if a real letter is being created
  1397* a "T" below will create temporary erarch and nsasextr
  1398* records and "X" we won't create anything
  1399*****************************************
  1400     MOVE 'T'                    TO BL-WRITE-ERARCH
  1401     IF BL-PRINT-NOW-SW = 'P'
  1402        MOVE 'X'                 TO BL-WRITE-ERARCH
  1403     END-IF
  1404     MOVE 'X'                 TO BL-WRITE-ERARCH
  1405*    DISPLAY ' INPUT FORM ' WS-KEY
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  26
* NSRASLTR.cbl
  1406*****************************************
  1407* Invoke the LETTER business logic
  1408*****************************************
  1409*    DISPLAY ' BL INPUT ' BL-INPUT
  1410     MOVE FUNCTION LENGTH(SRCH-COMMAREA) TO WS-COMM-LENGTH
  1411
  1412* exec cics link
  1413*       program('NSRASBL')
  1414*       commarea(srch-commarea)
  1415*       LENGTH  (WS-COMM-LENGTH)
  1416*    end-exec.
  1417     MOVE 'NSRASBL' TO DFHEIV1
  1418*    MOVE '."C                   (   #00001383' TO DFHEIV0
  1419     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1421     MOVE X'2020233030303031333833' TO DFHEIV0(25:11)
  1422     CALL 'kxdfhei1' USING DFHEIV0,
  1423           DFHEIV1,
  1424           srch-commarea,
  1425           WS-COMM-LENGTH,
  1426           DFHEIV99,
  1427           DFHEIV99,
  1428           DFHEIV99,
  1429           DFHEIV99
  1430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1431
  1432     IF BL-OK
  1433        perform varying bl-length from +6200 by -1 until
  1434           (bl-record-passed-data (bl-length:1) not = ' ')
  1435           or (bl-length = +1)
  1436        end-perform
  1437*       DISPLAY ' BL OK ' BL-ARCHIVE-NO
  1438        move bl-length to sl-length
  1439        move spaces to naper-output-data
  1440        MOVE BL-RECORD-PASSED-DATA (1:bl-length)
  1441                                 TO NAPER-OUTPUT-DATA
  1442        MOVE BL-ARCHIVE-NO          TO OT-ARCHIVE-NO
  1443     ELSE
  1444        MOVE BL-MESSAGE          TO ASERR-MESS
  1445
  1446* exec cics document create
  1447*          doctoken   (w-doctoken)
  1448*          template   ('ASERR')
  1449*          symbollist (WS-ASERR)
  1450*          resp       (WS-RESPONSE)
  1451*       end-exec
  1452     MOVE LENGTH OF
  1453      WS-ASERR
  1454       TO DFHEIV16
  1455     MOVE 'ASERR' TO DFHEIV1
  1456*    MOVE '\"D tSL               )  N#00001401' TO DFHEIV0
  1457     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1458     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1459     MOVE X'204E233030303031343031' TO DFHEIV0(25:11)
  1460     CALL 'kxdfhei1' USING DFHEIV0,
  1461           w-doctoken,
  1462           DFHEIV99,
  1463           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  27
* NSRASLTR.cbl
  1464           WS-ASERR,
  1465           DFHEIV16,
  1466           DFHEIV99,
  1467           DFHEIV99,
  1468           DFHEIV99
  1469     MOVE EIBRESP  TO WS-RESPONSE
  1470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1471
  1472* exec cics web send
  1473*          doctoken(w-doctoken)
  1474*                      resp   (WS-RESPONSE)
  1475*       end-exec
  1476*    MOVE 'X$D                   *  N#00001407' TO DFHEIV0
  1477     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  1478     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  1479     MOVE X'204E233030303031343037' TO DFHEIV0(25:11)
  1480     CALL 'kxdfhei1' USING DFHEIV0,
  1481           w-doctoken,
  1482           DFHEIV99,
  1483           DFHEIV99,
  1484           DFHEIV99,
  1485           DFHEIV99,
  1486           DFHEIV99,
  1487           DFHEIV99,
  1488           DFHEIV99,
  1489           DFHEIV99
  1490     MOVE EIBRESP  TO WS-RESPONSE
  1491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1492
  1493* exec cics
  1494*          return
  1495*       end-exec
  1496*    MOVE '.(                    ''   #00001411' TO DFHEIV0
  1497     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1498     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1499     MOVE X'2020233030303031343131' TO DFHEIV0(25:11)
  1500     CALL 'kxdfhei1' USING DFHEIV0,
  1501           DFHEIV99,
  1502           DFHEIV99,
  1503           DFHEIV99,
  1504           DFHEIV99,
  1505           DFHEIV99,
  1506           DFHEIV99
  1507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1508     END-IF
  1509     evaluate ws-kixhost
  1510        when 'slunikix'
  1511           evaluate ws-kix-myenv
  1512              when 'cid1p'
  1513                 move '7001'     to ws-sl-port
  1514*                                   ws-sl-port2
  1515              when 'mdoff'
  1516                 move '7003'     to ws-sl-port
  1517*                                   ws-sl-port2
  1518              when 'cid1t'
  1519                 move '7002'     to ws-sl-port
  1520*                                   ws-sl-port2
  1521           end-evaluate
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  28
* NSRASLTR.cbl
  1522           move ws-asftr         to ws-sl-key
  1523*                                   ws-sl-key2
  1524        when 'logictest'
  1525           evaluate ws-kix-myenv
  1526              when 'cid1t'
  1527                 move '6002'     to ws-lt-port
  1528*                                   ws-lt-port2
  1529              when 'tony'
  1530                 move '6003'     to ws-lt-port
  1531*                                   ws-lt-port2
  1532              when 'paul'
  1533                 move '5002'     to ws-lt-port
  1534*                                   ws-lt-port2
  1535              when 'ahltst'
  1536                 move '6007'     to ws-lt-port
  1537*                                   ws-lt-port2
  1538           end-evaluate
  1539           move ws-asftr         to ws-lt-key
  1540*                                   ws-lt-key2
  1541     end-evaluate
  1542***********************************************************
  1543* Build output document.  There are three templates used
  1544* for this document.  ASHDR and ASFTR are the header
  1545* and footer, respectively.  ASBOD is used for the
  1546* actual data.  For each array entry in the business
  1547* logic output, set the symbol list from the array
  1548* entry and insert into the document using the ASBOD
  1549* template.
  1550***********************************************************
  1551*    move bl-output-message to out-msg-text.
  1552     evaluate true
  1553        when iff-comp-id = 'DCC'
  1554           IF WS-KIX-MYENV = 'cid1p'
  1555
  1556* exec cics document create
  1557*                doctoken   (w-doctoken)
  1558*                template   ('ASHDR')
  1559*                symbollist (WS-PROD-DCC-ASHDR)
  1560*                resp       (WS-RESPONSE)
  1561*             end-exec
  1562     MOVE LENGTH OF
  1563      WS-PROD-DCC-ASHDR
  1564       TO DFHEIV16
  1565     MOVE 'ASHDR' TO DFHEIV1
  1566*    MOVE '\"D tSL               )  N#00001461' TO DFHEIV0
  1567     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1568     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1569     MOVE X'204E233030303031343631' TO DFHEIV0(25:11)
  1570     CALL 'kxdfhei1' USING DFHEIV0,
  1571           w-doctoken,
  1572           DFHEIV99,
  1573           DFHEIV1,
  1574           WS-PROD-DCC-ASHDR,
  1575           DFHEIV16,
  1576           DFHEIV99,
  1577           DFHEIV99,
  1578           DFHEIV99
  1579     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  29
* NSRASLTR.cbl
  1580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1581           ELSE
  1582
  1583* exec cics document create
  1584*                doctoken   (w-doctoken)
  1585*                template   ('ASHDR')
  1586*                symbollist (WS-TEST-DCC-ASHDR)
  1587*                resp       (WS-RESPONSE)
  1588*             end-exec
  1589     MOVE LENGTH OF
  1590      WS-TEST-DCC-ASHDR
  1591       TO DFHEIV16
  1592     MOVE 'ASHDR' TO DFHEIV1
  1593*    MOVE '\"D tSL               )  N#00001468' TO DFHEIV0
  1594     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1595     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1596     MOVE X'204E233030303031343638' TO DFHEIV0(25:11)
  1597     CALL 'kxdfhei1' USING DFHEIV0,
  1598           w-doctoken,
  1599           DFHEIV99,
  1600           DFHEIV1,
  1601           WS-TEST-DCC-ASHDR,
  1602           DFHEIV16,
  1603           DFHEIV99,
  1604           DFHEIV99,
  1605           DFHEIV99
  1606     MOVE EIBRESP  TO WS-RESPONSE
  1607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1608           END-IF
  1609        when iff-comp-id = 'AHL'
  1610           IF WS-KIX-MYENV = 'cid1p'
  1611
  1612* exec cics document create
  1613*                doctoken   (w-doctoken)
  1614*                template   ('ASHDR')
  1615*                symbollist (WS-PROD-AHL-ASHDR)
  1616*                resp       (WS-RESPONSE)
  1617*             end-exec
  1618     MOVE LENGTH OF
  1619      WS-PROD-AHL-ASHDR
  1620       TO DFHEIV16
  1621     MOVE 'ASHDR' TO DFHEIV1
  1622*    MOVE '\"D tSL               )  N#00001477' TO DFHEIV0
  1623     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1624     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1625     MOVE X'204E233030303031343737' TO DFHEIV0(25:11)
  1626     CALL 'kxdfhei1' USING DFHEIV0,
  1627           w-doctoken,
  1628           DFHEIV99,
  1629           DFHEIV1,
  1630           WS-PROD-AHL-ASHDR,
  1631           DFHEIV16,
  1632           DFHEIV99,
  1633           DFHEIV99,
  1634           DFHEIV99
  1635     MOVE EIBRESP  TO WS-RESPONSE
  1636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1637           ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  30
* NSRASLTR.cbl
  1638
  1639* exec cics document create
  1640*                doctoken   (w-doctoken)
  1641*                template   ('ASHDR')
  1642*                symbollist (WS-TEST-AHL-ASHDR)
  1643*                resp       (WS-RESPONSE)
  1644*             end-exec
  1645     MOVE LENGTH OF
  1646      WS-TEST-AHL-ASHDR
  1647       TO DFHEIV16
  1648     MOVE 'ASHDR' TO DFHEIV1
  1649*    MOVE '\"D tSL               )  N#00001484' TO DFHEIV0
  1650     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1651     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1652     MOVE X'204E233030303031343834' TO DFHEIV0(25:11)
  1653     CALL 'kxdfhei1' USING DFHEIV0,
  1654           w-doctoken,
  1655           DFHEIV99,
  1656           DFHEIV1,
  1657           WS-TEST-AHL-ASHDR,
  1658           DFHEIV16,
  1659           DFHEIV99,
  1660           DFHEIV99,
  1661           DFHEIV99
  1662     MOVE EIBRESP  TO WS-RESPONSE
  1663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1664           END-IF
  1665        when iff-comp-id = 'VPP'
  1666           IF WS-KIX-MYENV = 'cid1p'
  1667
  1668* exec cics document create
  1669*                doctoken   (w-doctoken)
  1670*                template   ('ASHDR')
  1671*                symbollist (WS-PROD-VPP-ASHDR)
  1672*                resp       (WS-RESPONSE)
  1673*             end-exec
  1674     MOVE LENGTH OF
  1675      WS-PROD-VPP-ASHDR
  1676       TO DFHEIV16
  1677     MOVE 'ASHDR' TO DFHEIV1
  1678*    MOVE '\"D tSL               )  N#00001493' TO DFHEIV0
  1679     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1680     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1681     MOVE X'204E233030303031343933' TO DFHEIV0(25:11)
  1682     CALL 'kxdfhei1' USING DFHEIV0,
  1683           w-doctoken,
  1684           DFHEIV99,
  1685           DFHEIV1,
  1686           WS-PROD-VPP-ASHDR,
  1687           DFHEIV16,
  1688           DFHEIV99,
  1689           DFHEIV99,
  1690           DFHEIV99
  1691     MOVE EIBRESP  TO WS-RESPONSE
  1692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1693           ELSE
  1694
  1695* exec cics document create
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  31
* NSRASLTR.cbl
  1696*                doctoken   (w-doctoken)
  1697*                template   ('ASHDR')
  1698*                symbollist (WS-TEST-VPP-ASHDR)
  1699*                resp       (WS-RESPONSE)
  1700*             end-exec
  1701     MOVE LENGTH OF
  1702      WS-TEST-VPP-ASHDR
  1703       TO DFHEIV16
  1704     MOVE 'ASHDR' TO DFHEIV1
  1705*    MOVE '\"D tSL               )  N#00001500' TO DFHEIV0
  1706     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1707     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1708     MOVE X'204E233030303031353030' TO DFHEIV0(25:11)
  1709     CALL 'kxdfhei1' USING DFHEIV0,
  1710           w-doctoken,
  1711           DFHEIV99,
  1712           DFHEIV1,
  1713           WS-TEST-VPP-ASHDR,
  1714           DFHEIV16,
  1715           DFHEIV99,
  1716           DFHEIV99,
  1717           DFHEIV99
  1718     MOVE EIBRESP  TO WS-RESPONSE
  1719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1720           END-IF
  1721        when iff-comp-id = 'FNL'
  1722           IF WS-KIX-MYENV = 'cid1p'
  1723
  1724* exec cics document create
  1725*                doctoken   (w-doctoken)
  1726*                template   ('ASHDR')
  1727*                symbollist (WS-PROD-FNL-ASHDR)
  1728*                resp       (WS-RESPONSE)
  1729*             end-exec
  1730     MOVE LENGTH OF
  1731      WS-PROD-FNL-ASHDR
  1732       TO DFHEIV16
  1733     MOVE 'ASHDR' TO DFHEIV1
  1734*    MOVE '\"D tSL               )  N#00001509' TO DFHEIV0
  1735     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1736     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1737     MOVE X'204E233030303031353039' TO DFHEIV0(25:11)
  1738     CALL 'kxdfhei1' USING DFHEIV0,
  1739           w-doctoken,
  1740           DFHEIV99,
  1741           DFHEIV1,
  1742           WS-PROD-FNL-ASHDR,
  1743           DFHEIV16,
  1744           DFHEIV99,
  1745           DFHEIV99,
  1746           DFHEIV99
  1747     MOVE EIBRESP  TO WS-RESPONSE
  1748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1749           ELSE
  1750
  1751* exec cics document create
  1752*                doctoken   (w-doctoken)
  1753*                template   ('ASHDR')
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  32
* NSRASLTR.cbl
  1754*                symbollist (WS-TEST-FNL-ASHDR)
  1755*                resp       (WS-RESPONSE)
  1756*             end-exec
  1757     MOVE LENGTH OF
  1758      WS-TEST-FNL-ASHDR
  1759       TO DFHEIV16
  1760     MOVE 'ASHDR' TO DFHEIV1
  1761*    MOVE '\"D tSL               )  N#00001516' TO DFHEIV0
  1762     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1763     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1764     MOVE X'204E233030303031353136' TO DFHEIV0(25:11)
  1765     CALL 'kxdfhei1' USING DFHEIV0,
  1766           w-doctoken,
  1767           DFHEIV99,
  1768           DFHEIV1,
  1769           WS-TEST-FNL-ASHDR,
  1770           DFHEIV16,
  1771           DFHEIV99,
  1772           DFHEIV99,
  1773           DFHEIV99
  1774     MOVE EIBRESP  TO WS-RESPONSE
  1775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1776           END-IF
  1777        when OTHER
  1778           IF WS-KIX-MYENV = 'cid1p'
  1779
  1780* exec cics document create
  1781*               doctoken   (w-doctoken)
  1782*               template   ('ASHDR')
  1783*               symbollist (WS-PROD-CID-ASHDR)
  1784*               resp       (WS-RESPONSE)
  1785*            end-exec
  1786     MOVE LENGTH OF
  1787      WS-PROD-CID-ASHDR
  1788       TO DFHEIV16
  1789     MOVE 'ASHDR' TO DFHEIV1
  1790*    MOVE '\"D tSL               )  N#00001525' TO DFHEIV0
  1791     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1792     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1793     MOVE X'204E233030303031353235' TO DFHEIV0(25:11)
  1794     CALL 'kxdfhei1' USING DFHEIV0,
  1795           w-doctoken,
  1796           DFHEIV99,
  1797           DFHEIV1,
  1798           WS-PROD-CID-ASHDR,
  1799           DFHEIV16,
  1800           DFHEIV99,
  1801           DFHEIV99,
  1802           DFHEIV99
  1803     MOVE EIBRESP  TO WS-RESPONSE
  1804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1805           ELSE
  1806
  1807* exec cics document create
  1808*               doctoken   (w-doctoken)
  1809*               template   ('ASHDR')
  1810*               symbollist (WS-TEST-CID-ASHDR)
  1811*               resp       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  33
* NSRASLTR.cbl
  1812*            end-exec
  1813     MOVE LENGTH OF
  1814      WS-TEST-CID-ASHDR
  1815       TO DFHEIV16
  1816     MOVE 'ASHDR' TO DFHEIV1
  1817*    MOVE '\"D tSL               )  N#00001532' TO DFHEIV0
  1818     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1819     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1820     MOVE X'204E233030303031353332' TO DFHEIV0(25:11)
  1821     CALL 'kxdfhei1' USING DFHEIV0,
  1822           w-doctoken,
  1823           DFHEIV99,
  1824           DFHEIV1,
  1825           WS-TEST-CID-ASHDR,
  1826           DFHEIV16,
  1827           DFHEIV99,
  1828           DFHEIV99,
  1829           DFHEIV99
  1830     MOVE EIBRESP  TO WS-RESPONSE
  1831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1832           END-IF
  1833     end-evaluate
  1834*    DISPLAY ' ASHDR DOC CREATE ' WS-RESPONSE
  1835*    move 1 to bl-index.
  1836*
  1837*    perform bl-output-record-count times
  1838*
  1839*        move bl-output-account-number(bl-index)
  1840*          to out-account-number
  1841*        move bl-output-last-name(bl-index)
  1842*          to out-last-name
  1843*        move bl-output-first-name(bl-index)
  1844*          to out-first-name
  1845*        move bl-output-middle-initial(bl-index)
  1846*          to out-middle-initial
  1847*
  1848*    MOVE 'EL01'                 TO OUT-TEMP
  1849*    MOVE 'ALWA'                 TO OUT-PROC-ID
  1850*    MOVE 'EL01'                 TO OUT-LETTER
  1851*    MOVE '9'                    TO OUT-CARRIER
  1852*    MOVE 'MCDANIEL'             TO OUT-ILNAME
  1853*    MOVE 'KATHI'                TO OUT-IFNAME
  1854*
  1855*    MOVE '0009235906 '          TO OUT-CERT-NO
  1856*    MOVE '0990000208'           TO OUT-ACCOUNT
  1857
  1858* exec cics document set
  1859*       doctoken(w-doctoken)
  1860*       symbollist(NAPER-OUTPUT-DATA (1:bl-length))
  1861*       delimiter ('?')
  1862*       length(length of NAPER-OUTPUT-DATA)
  1863*       length(sl-length)
  1864*                   resp   (WS-RESPONSE)
  1865*     unescaped
  1866*    end-exec
  1867*    MOVE '\(Ds L                ''  N#00001563' TO DFHEIV0
  1868     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1869     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  34
* NSRASLTR.cbl
  1870     MOVE X'204E233030303031353633' TO DFHEIV0(25:11)
  1871     CALL 'kxdfhei1' USING DFHEIV0,
  1872           w-doctoken,
  1873           NAPER-OUTPUT-DATA(1 : bl-length),
  1874           DFHEIV99,
  1875           sl-length,
  1876           DFHEIV99,
  1877           DFHEIV99
  1878     MOVE EIBRESP  TO WS-RESPONSE
  1879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1880*    DISPLAY ' DOC SET    ' WS-RESPONSE
  1881
  1882* exec cics document insert
  1883*       doctoken(w-doctoken)
  1884*       template('ASBOD')
  1885*                   resp   (WS-RESPONSE)
  1886*    end-exec
  1887     MOVE 'ASBOD' TO DFHEIV1
  1888*    MOVE '\$Dt                  (  N#00001573' TO DFHEIV0
  1889     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1890     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1891     MOVE X'204E233030303031353733' TO DFHEIV0(25:11)
  1892     CALL 'kxdfhei1' USING DFHEIV0,
  1893           w-doctoken,
  1894           DFHEIV1,
  1895           DFHEIV99,
  1896           DFHEIV99,
  1897           DFHEIV99,
  1898           DFHEIV99,
  1899           DFHEIV99
  1900     MOVE EIBRESP  TO WS-RESPONSE
  1901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1902     IF BL-LETTER-TO-ACCT NOT = SPACES
  1903        MOVE BL-LETTER-TO-ACCT   TO NAPER-OUTPUT-DATA (12:1)
  1904*       MOVE 'EL01T'             TO NAPER-OUTPUT-DATA (8:6)
  1905
  1906* exec cics document set
  1907*          doctoken(w-doctoken)
  1908*          symbollist(NAPER-OUTPUT-DATA (1:bl-length))
  1909*          length(sl-length)
  1910*          resp   (WS-RESPONSE)
  1911*       end-exec
  1912*    MOVE '\(Ds L                ''  N#00001581' TO DFHEIV0
  1913     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1914     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1915     MOVE X'204E233030303031353831' TO DFHEIV0(25:11)
  1916     CALL 'kxdfhei1' USING DFHEIV0,
  1917           w-doctoken,
  1918           NAPER-OUTPUT-DATA(1 : bl-length),
  1919           DFHEIV99,
  1920           sl-length,
  1921           DFHEIV99,
  1922           DFHEIV99
  1923     MOVE EIBRESP  TO WS-RESPONSE
  1924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1925
  1926* exec cics document insert
  1927*          doctoken(w-doctoken)
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  35
* NSRASLTR.cbl
  1928*          template('ASBOD')
  1929*          resp   (WS-RESPONSE)
  1930*       end-exec
  1931     MOVE 'ASBOD' TO DFHEIV1
  1932*    MOVE '\$Dt                  (  N#00001587' TO DFHEIV0
  1933     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1934     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1935     MOVE X'204E233030303031353837' TO DFHEIV0(25:11)
  1936     CALL 'kxdfhei1' USING DFHEIV0,
  1937           w-doctoken,
  1938           DFHEIV1,
  1939           DFHEIV99,
  1940           DFHEIV99,
  1941           DFHEIV99,
  1942           DFHEIV99,
  1943           DFHEIV99
  1944     MOVE EIBRESP  TO WS-RESPONSE
  1945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1946     END-IF
  1947     IF BL-LETTER-TO-BENE NOT = SPACES
  1948        MOVE BL-LETTER-TO-BENE   TO NAPER-OUTPUT-DATA (12:1)
  1949*       MOVE 'EL01T'             TO NAPER-OUTPUT-DATA (8:6)
  1950
  1951* exec cics document set
  1952*          doctoken(w-doctoken)
  1953*          symbollist(NAPER-OUTPUT-DATA (1:bl-length))
  1954*          length(sl-length)
  1955*          resp   (WS-RESPONSE)
  1956*       end-exec
  1957*    MOVE '\(Ds L                ''  N#00001596' TO DFHEIV0
  1958     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1959     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1960     MOVE X'204E233030303031353936' TO DFHEIV0(25:11)
  1961     CALL 'kxdfhei1' USING DFHEIV0,
  1962           w-doctoken,
  1963           NAPER-OUTPUT-DATA(1 : bl-length),
  1964           DFHEIV99,
  1965           sl-length,
  1966           DFHEIV99,
  1967           DFHEIV99
  1968     MOVE EIBRESP  TO WS-RESPONSE
  1969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1970
  1971* exec cics document insert
  1972*          doctoken(w-doctoken)
  1973*          template('ASBOD')
  1974*          resp   (WS-RESPONSE)
  1975*       end-exec
  1976     MOVE 'ASBOD' TO DFHEIV1
  1977*    MOVE '\$Dt                  (  N#00001602' TO DFHEIV0
  1978     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1979     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1980     MOVE X'204E233030303031363032' TO DFHEIV0(25:11)
  1981     CALL 'kxdfhei1' USING DFHEIV0,
  1982           w-doctoken,
  1983           DFHEIV1,
  1984           DFHEIV99,
  1985           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  36
* NSRASLTR.cbl
  1986           DFHEIV99,
  1987           DFHEIV99,
  1988           DFHEIV99
  1989     MOVE EIBRESP  TO WS-RESPONSE
  1990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1991     END-IF
  1992*    DISPLAY ' ASBOD DOC INSERT ' WS-RESPONSE
  1993*
  1994*        add 1 to bl-index
  1995*
  1996*    end-perform.
  1997*    MOVE BL-CARRIER  TO OT-CARRIER
  1998*    MOVE BL-CLAIM-NO TO OT-CLMNO
  1999*    MOVE BL-CERT-NO  TO OT-CRTNO
  2000*    MOVE BL-ARCHIVE-NO TO OT-ARCHNO
  2001     IF WS-KIXHOST = 'slunikix'
  2002        display ' host slunikix ' ws-kixhost
  2003
  2004* exec cics document set
  2005*          doctoken(w-doctoken)
  2006*          symbollist(WS-VAR-SLUNIKIX)
  2007*          length(length of WS-VAR-SLUNIKIX)
  2008*                      resp   (WS-RESPONSE)
  2009*       end-exec
  2010     MOVE LENGTH OF
  2011      WS-VAR-SLUNIKIX TO DFHEIV16
  2012*    MOVE '\(Ds L                ''  N#00001619' TO DFHEIV0
  2013     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  2014     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2015     MOVE X'204E233030303031363139' TO DFHEIV0(25:11)
  2016     CALL 'kxdfhei1' USING DFHEIV0,
  2017           w-doctoken,
  2018           WS-VAR-SLUNIKIX,
  2019           DFHEIV99,
  2020           DFHEIV16,
  2021           DFHEIV99,
  2022           DFHEIV99
  2023     MOVE EIBRESP  TO WS-RESPONSE
  2024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2025     else
  2026        display ' host logictest ' ws-kixhost
  2027
  2028* exec cics document set
  2029*          doctoken(w-doctoken)
  2030*          symbollist(WS-VAR-LOGICTEST)
  2031*          length(length of WS-VAR-LOGICTEST)
  2032*                      resp   (WS-RESPONSE)
  2033*       end-exec
  2034     MOVE LENGTH OF
  2035      WS-VAR-LOGICTEST TO DFHEIV16
  2036*    MOVE '\(Ds L                ''  N#00001627' TO DFHEIV0
  2037     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  2038     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2039     MOVE X'204E233030303031363237' TO DFHEIV0(25:11)
  2040     CALL 'kxdfhei1' USING DFHEIV0,
  2041           w-doctoken,
  2042           WS-VAR-LOGICTEST,
  2043           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  37
* NSRASLTR.cbl
  2044           DFHEIV16,
  2045           DFHEIV99,
  2046           DFHEIV99
  2047     MOVE EIBRESP  TO WS-RESPONSE
  2048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2049     end-if
  2050*    DISPLAY ' DOC SET ' WS-RESPONSE
  2051
  2052* exec cics document insert
  2053*       doctoken(w-doctoken)
  2054*       template('ASFTR')
  2055*                   resp   (WS-RESPONSE)
  2056*    end-exec
  2057     MOVE 'ASFTR' TO DFHEIV1
  2058*    MOVE '\$Dt                  (  N#00001635' TO DFHEIV0
  2059     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  2060     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2061     MOVE X'204E233030303031363335' TO DFHEIV0(25:11)
  2062     CALL 'kxdfhei1' USING DFHEIV0,
  2063           w-doctoken,
  2064           DFHEIV1,
  2065           DFHEIV99,
  2066           DFHEIV99,
  2067           DFHEIV99,
  2068           DFHEIV99,
  2069           DFHEIV99
  2070     MOVE EIBRESP  TO WS-RESPONSE
  2071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2072*    DISPLAY ' ASFTR DOC INSERT ' WS-RESPONSE
  2073*    if bl-fail
  2074*       exec cics syncpoint rollback
  2075*       end-exec
  2076*    end-if.
  2077****************************************
  2078* Send the document and return.
  2079****************************************
  2080
  2081* exec cics web send
  2082*       doctoken(w-doctoken)
  2083*                   resp   (WS-RESPONSE)
  2084*    end-exec.
  2085*    MOVE 'X$D                   *  N#00001648' TO DFHEIV0
  2086     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  2087     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  2088     MOVE X'204E233030303031363438' TO DFHEIV0(25:11)
  2089     CALL 'kxdfhei1' USING DFHEIV0,
  2090           w-doctoken,
  2091           DFHEIV99,
  2092           DFHEIV99,
  2093           DFHEIV99,
  2094           DFHEIV99,
  2095           DFHEIV99,
  2096           DFHEIV99,
  2097           DFHEIV99,
  2098           DFHEIV99
  2099     MOVE EIBRESP  TO WS-RESPONSE
  2100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2101
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  38
* NSRASLTR.cbl
  2102*    DISPLAY ' WEB SEND  ' WS-RESPONSE
  2103*    DISPLAY ' ABOUT TO RETURN '
  2104
  2105* exec cics
  2106*       return
  2107*    end-exec.
  2108*    MOVE '.(                    ''   #00001654' TO DFHEIV0
  2109     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2110     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2111     MOVE X'2020233030303031363534' TO DFHEIV0(25:11)
  2112     CALL 'kxdfhei1' USING DFHEIV0,
  2113           DFHEIV99,
  2114           DFHEIV99,
  2115           DFHEIV99,
  2116           DFHEIV99,
  2117           DFHEIV99,
  2118           DFHEIV99
  2119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2120
  2121******************************************************
  2122* Read all fields of the incoming form, moving
  2123* each to the corresponding field of the commarea
  2124* (business logic input fields).
  2125******************************************************
  2126 read-form.
  2127     move spaces to w-form-name.
  2128     move length of w-form-name to w-form-name-len.
  2129           move spaces to w-form-value.
  2130     move length of w-form-value to w-form-value-len.
  2131
  2132* exec cics web readnext
  2133*                  formfield(w-form-name)
  2134*                  namelength(w-form-name-len)
  2135*                  value(w-form-value)
  2136*                  valuelength(w-form-value-len)
  2137*                  resp(w-resp)
  2138*    end-exec.
  2139*    MOVE 'X*FLVL                &  N#00001667' TO DFHEIV0
  2140     MOVE X'582A464C564C202020202020' TO DFHEIV0(1:12)
  2141     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2142     MOVE X'204E233030303031363637' TO DFHEIV0(25:11)
  2143     CALL 'kxdfhei1' USING DFHEIV0,
  2144           w-form-name,
  2145           w-form-name-len,
  2146           w-form-value,
  2147           w-form-value-len,
  2148           DFHEIV99
  2149     MOVE EIBRESP  TO w-resp
  2150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2151
  2152     evaluate w-resp
  2153        when 0
  2154*   dfhresp(normal)
  2155           evaluate w-form-name(1:w-form-name-len)
  2156              when 'data_src'
  2157                 if w-form-value-len not = 0
  2158                    move w-form-value(1:w-form-value-len)
  2159                                 to IFF-DATA-SRCE
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  39
* NSRASLTR.cbl
  2160                 else
  2161                                move spaces to IFF-DATA-SRCE
  2162                 end-if
  2163              when 'letter_id'
  2164                 if w-form-value-len not = 0
  2165                    move w-form-value(1:w-form-value-len)
  2166                                 to IFF-LETTER-ID
  2167                 else
  2168                                move spaces to IFF-LETTER-ID
  2169                 end-if
  2170              when 'carrier'
  2171                 if w-form-value-len not = 0
  2172                    move w-form-value(1:w-form-value-len)
  2173                             to IFF-CARRIER
  2174                 else
  2175                                move spaces to IFF-CARRIER
  2176                 end-if
  2177              when 'grouping'
  2178                             if w-form-value-len not = 0
  2179                    move w-form-value(1:w-form-value-len)
  2180                                                   to IFF-GROUP
  2181                 else
  2182                                move spaces  to IFF-GROUP
  2183                 end-if
  2184              when 'state_cd'
  2185                             if w-form-value-len not = 0
  2186                    move w-form-value(1:w-form-value-len)
  2187                                 to IFF-STATE
  2188                 else
  2189                                move spaces  to IFF-STATE
  2190                 end-if
  2191              when 'acct_no'
  2192                             if w-form-value-len not = 0
  2193                    move w-form-value(1:w-form-value-len)
  2194                                 to IFF-ACCOUNT
  2195                 else
  2196                    move spaces  to IFF-ACCOUNT
  2197                 end-if
  2198              when 'eff_date'
  2199                             if w-form-value-len not = 0
  2200                    move w-form-value(1:w-form-value-len)
  2201                                 to IFF-EFF-DT
  2202                 else
  2203                                move spaces  to IFF-EFF-DT
  2204                 end-if
  2205              when 'cert_no'
  2206                             if w-form-value-len not = 0
  2207                    move w-form-value(1:w-form-value-len)
  2208                                 to IFF-CERT-NO
  2209                 else
  2210                                move spaces  to IFF-CERT-NO
  2211                 end-if
  2212              when 'batch_no'
  2213                             if w-form-value-len not = 0
  2214                    move w-form-value(1:w-form-value-len)
  2215                                 to IFF-BATCH-NO
  2216                 else
  2217                  move zeros   to IFF-BATCH-NO
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  40
* NSRASLTR.cbl
  2218                 end-if
  2219              when 'batch_seq'
  2220                             if w-form-value-len not = 0
  2221                    move w-form-value(1:w-form-value-len)
  2222                                 to IFF-BATCH-SEQ
  2223                 else
  2224                                move zeros   to IFF-BATCH-SEQ
  2225                 end-if
  2226              when 'resp_no'
  2227                             if w-form-value-len not = 0
  2228                    move w-form-value(1:w-form-value-len)
  2229                                 to IFF-RESP-NO
  2230                 else
  2231                                move spaces  to IFF-RESP-NO
  2232                 end-if
  2233              when 'no_copies'
  2234                             if w-form-value-len not = 0
  2235                    move w-form-value(1:w-form-value-len)
  2236                                 to IFF-NO-OF-COPIES
  2237                 else
  2238                    move zeros   to IFF-NO-OF-COPIES
  2239                 end-if
  2240              when 'proc_id'
  2241                             if w-form-value-len not = 0
  2242                    move w-form-value(1:w-form-value-len)
  2243                                 to IFF-PROC-ID
  2244                 else
  2245                    move 'JJVA'  to IFF-PROC-ID
  2246                 end-if
  2247              when 'comp_id'
  2248                             if w-form-value-len not = 0
  2249                    move w-form-value(1:w-form-value-len)
  2250                                 to IFF-COMP-ID
  2251                 else
  2252                    move 'CID'   to IFF-COMP-ID
  2253                 end-if
  2254              when 'prt_now'
  2255                             if w-form-value-len not = 0
  2256                    move w-form-value(1:w-form-value-len)
  2257                                 to IFF-PRINT-NOW-SW
  2258                 else
  2259                    move 'N'     to IFF-PRINT-NOW-SW
  2260                 end-if
  2261              when 'enc_cd'
  2262                             if w-form-value-len not = 0
  2263                    move w-form-value(1:w-form-value-len)
  2264                                 to IFF-ENC-CD
  2265                 else
  2266                    move '0'     to IFF-ENC-CD
  2267                 end-if
  2268              when 'resend_dt'
  2269                             if w-form-value-len not = 0
  2270                    move w-form-value(1:w-form-value-len)
  2271                                 to IFF-RESEND-DT
  2272                 else
  2273                    move SPACES  to IFF-RESEND-DT
  2274                 end-if
  2275              when 'follow_dt'
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  41
* NSRASLTR.cbl
  2276                             if w-form-value-len not = 0
  2277                    move w-form-value(1:w-form-value-len)
  2278                                 to IFF-FOLLOW-UP-DT
  2279                 else
  2280                    move SPACES  to IFF-FOLLOW-UP-DT
  2281                 end-if
  2282              when 'arch_no'
  2283                             if w-form-value-len not = 0
  2284                    move w-form-value(1:w-form-value-len)
  2285                                 to IFF-ARCHIVE-NO
  2286                 else
  2287                    move ZEROS   to IFF-ARCHIVE-NO
  2288                 end-if
  2289              when 'pgm_func'
  2290                             if w-form-value-len not = 0
  2291                    move w-form-value(1:w-form-value-len)
  2292                                 to IFF-FUNC
  2293                 else
  2294                    move ZEROS   to IFF-FUNC
  2295                 end-if
  2296*             when 'ltr_comments'
  2297*                if w-form-value-len not = 0
  2298*                   move w-form-value(1:w-form-value-len)
  2299*                                to IFF-COMMENTS
  2300*                else
  2301*                   move SPACES  to IFF-COMMENTS
  2302*                end-if
  2303              when 'end_arch'
  2304                 if w-form-value-len not = 0
  2305                    move w-form-value(1:w-form-value-len)
  2306                                 to IFF-ENDT-ARCH-NO
  2307                 else
  2308                    move ZEROS  to IFF-ENDT-ARCH-NO
  2309                 end-if
  2310           end-evaluate
  2311        when other
  2312           continue
  2313     end-evaluate.
  2314 read-form-exit.
  2315 9700-DATE-LINK.
  2316
  2317* EXEC CICS LINK
  2318*        PROGRAM   ('ELDATCV')
  2319*        COMMAREA  (DATE-CONVERSION-DATA)
  2320*        LENGTH    (DC-COMM-LENGTH)
  2321*    END-EXEC.
  2322     MOVE 'ELDATCV' TO DFHEIV1
  2323*    MOVE '."C                   (   #00001837' TO DFHEIV0
  2324     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2325     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2326     MOVE X'2020233030303031383337' TO DFHEIV0(25:11)
  2327     CALL 'kxdfhei1' USING DFHEIV0,
  2328           DFHEIV1,
  2329           DATE-CONVERSION-DATA,
  2330           DC-COMM-LENGTH,
  2331           DFHEIV99,
  2332           DFHEIV99,
  2333           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Jun-21 14:22 Page  42
* NSRASLTR.cbl
  2334           DFHEIV99
  2335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2336
  2337 9700-EXIT.
  2338      EXIT.
  2339
  2340 9999-DFHBACK SECTION.
  2341     MOVE '9%                    "   ' TO DFHEIV0
  2342     MOVE 'NSRASLTR' TO DFHEIV1
  2343     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2344     GOBACK.
  2345 9999-DFHEXIT.
  2346     IF DFHEIGDJ EQUAL 0001
  2347         NEXT SENTENCE.
  2348     MOVE '9%                    "   ' TO DFHEIV0
  2349     MOVE 'NSRASLTR' TO DFHEIV1
  2350     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2351     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16064     Code:        6985
