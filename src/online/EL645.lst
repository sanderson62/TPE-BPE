* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL645.cbl
* Options: int("EL645.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL645.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL645.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL645.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL645 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 07:42:58.
     7*                            VMOD=2.004
     8*
     9*
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL645.cbl
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM PROVIDES THE QUALIFICATION NECESSARY FOR
    27*        LOSS RATIOS LOOK-UP.
    28
    29*    SCREENS     - EL645A - LOSS RATIOS SELECTION MENU
    30
    31*    ENTERED BY  - EL626 - MAIN PROCESSING MENU
    32
    33*    EXIT TO     - CALLING PROGRAM
    34*                  EL6451 - LOSS RATIOS AS OF (MM/DD/YY)
    35*                  EL659  - NAME LOOKUP (ACCT,COMP,REIN)
    36
    37*    INPUT FILE  - ERLOSS - LOSS RATIOS
    38
    39*    OUTPUT FILE - NONE
    40
    41*    COMMAREA    - PASSED.  THE CONTROL INFORMATION KEYED IN THIS
    42*                  PROGRAM IS PLACED IN THE APPROPRIATE FIELDS OF
    43*                  THE COMMAREA FOR REFERENCE BY EL6451.  THE
    44*                  PROGRAM WORK AREA OF THE COMMAREA IS USED TO
    45*                  PASS THE RECORD KEY INFORMATION NEEDED BY
    46*                  EL6451.
    47
    48*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL626.  ON
    49*                  FIRST ENTRY, A SKELETON SCREEN IS SENT AND THE
    50*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    51*                  ENTRIES (XCTL FROM CICS VIA EXR1) THE SCREEN
    52*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    53*                  OPTION INDICATED.  PROGRAM FUNCTION KEY 10 WILL
    54*                  TRANSFER CONTROL TO PROGRAM EL659 - NAME LOOKUP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL645.cbl
    56 ENVIRONMENT DIVISION.
    57 DATA DIVISION.
    58 WORKING-STORAGE SECTION.
    59 01  DFH-START PIC X(04).
    60
    61 77  FILLER  PIC  X(32) VALUE '********************************'.
    62 77  FILLER  PIC  X(32) VALUE '*    EL645 WORKING STORAGE     *'.
    63 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.004 *********'.
    64
    65*                                COPY ELCSCTM.
    66******************************************************************
    67*                                                                *
    68*                                                                *
    69*                            ELCSCTM                             *
    70*                            VMOD=2.001                          *
    71*                                                                *
    72*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    73*                                                                *
    74******************************************************************
    75 01  SECURITY-MESSAGE.
    76     12  FILLER                          PIC X(30)
    77            VALUE '** LOGIC SECURITY VIOLATION -'.
    78     12  SM-READ                         PIC X(6).
    79     12  FILLER                          PIC X(5)
    80            VALUE ' PGM='.
    81     12  SM-PGM                          PIC X(6).
    82     12  FILLER                          PIC X(5)
    83            VALUE ' OPR='.
    84     12  SM-PROCESSOR-ID                 PIC X(4).
    85     12  FILLER                          PIC X(6)
    86            VALUE ' TERM='.
    87     12  SM-TERMID                       PIC X(4).
    88     12  FILLER                          PIC XX   VALUE SPACE.
    89     12  SM-JUL-DATE                     PIC 9(5).
    90     12  FILLER                          PIC X    VALUE SPACE.
    91     12  SM-TIME                         PIC 99.99.
    92
    93
    94*                                COPY ELCSCRTY.
    95******************************************************************
    96*                                                                *
    97*                                                                *
    98*                            ELCSCRTY                            *
    99*                            VMOD=2.001                          *
   100*                                                                *
   101*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   102*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   103*        SAVED IN PI-SECURITY-ADDRESS.                           *
   104*                                                                *
   105******************************************************************
   106 01  SECURITY-CONTROL.
   107     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   108     12  FILLER                       PIC XX    VALUE 'SC'.
   109     12  SC-CREDIT-CODES.
   110         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   111             20  SC-CREDIT-DISPLAY    PIC X.
   112             20  SC-CREDIT-UPDATE     PIC X.
   113     12  SC-CLAIMS-CODES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL645.cbl
   114         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   115             20  SC-CLAIMS-DISPLAY    PIC X.
   116             20  SC-CLAIMS-UPDATE     PIC X.
   117
   118 01  WS-DATE-AREA.
   119     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   120     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
   121
   122 01  FILLER                  COMP-3.
   123     12  WS-COMPLETED-SUCCESSFUL     PIC S9(01)  VALUE ZERO.
   124         88  TRANSACTION-SUCCESSFUL              VALUE +1.
   125     12  TIME-IN                     PIC S9(07)  VALUE ZERO.
   126     12  TIME-OUT  REDEFINES
   127         TIME-IN                     PIC S9(03)V9(4).
   128
   129 01  FILLER                  COMP SYNC.
   130     12  SC-ITEM                 PIC S9(04)      VALUE +0001.
   131
   132 01  FILLER.
   133     12  WS-MAPSET-NAME          PIC  X(08)      VALUE 'EL645S'.
   134     12  WS-MAP-NAME             PIC  X(08)    VALUE 'EL645A  '.
   135     12  FILLER  REDEFINES  WS-MAP-NAME.
   136         16  FILLER              PIC  X(02).
   137         16  WS-MAP-NUMBER       PIC  X(04).
   138         16  FILLER              PIC  X(02).
   139     12  THIS-PGM                PIC  X(08)      VALUE 'EL645'.
   140     12  WS-LOSS-RATIO-DSID      PIC  X(08)      VALUE 'ERLOSS'.
   141     12  WS-TRANS-ID             PIC  X(04)      VALUE 'EXR1'.
   142     12  ERROR-MESSAGES.
   143         16  ER-0002             PIC  X(04)      VALUE '0002'.
   144         16  ER-0004             PIC  X(04)      VALUE '0004'.
   145         16  ER-0005             PIC  X(04)      VALUE '0005'.
   146         16  ER-0008             PIC  X(04)      VALUE '0008'.
   147         16  ER-0029             PIC  X(04)      VALUE '0029'.
   148         16  ER-0070             PIC  X(04)      VALUE '0070'.
   149         16  ER-0671             PIC  X(04)      VALUE '0671'.
   150         16  ER-0674             PIC  X(04)      VALUE '0674'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL645.cbl
   152*                                COPY ELCINTF.
   153******************************************************************
   154*                                                                *
   155*                                                                *
   156*                            ELCINTF.                            *
   157*                            VMOD=2.017                          *
   158*                                                                *
   159*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   160*                                                                *
   161*       LENGTH = 1024                                            *
   162*                                                                *
   163******************************************************************
   164 01  PROGRAM-INTERFACE-BLOCK.
   165     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   166     12  PI-CALLING-PROGRAM              PIC X(8).
   167     12  PI-SAVED-PROGRAM-1              PIC X(8).
   168     12  PI-SAVED-PROGRAM-2              PIC X(8).
   169     12  PI-SAVED-PROGRAM-3              PIC X(8).
   170     12  PI-SAVED-PROGRAM-4              PIC X(8).
   171     12  PI-SAVED-PROGRAM-5              PIC X(8).
   172     12  PI-SAVED-PROGRAM-6              PIC X(8).
   173     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   174     12  PI-COMPANY-ID                   PIC XXX.
   175     12  PI-COMPANY-CD                   PIC X.
   176
   177     12  PI-COMPANY-PASSWORD             PIC X(8).
   178
   179     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   180
   181     12  PI-CONTROL-IN-PROGRESS.
   182         16  PI-CARRIER                  PIC X.
   183         16  PI-GROUPING                 PIC X(6).
   184         16  PI-STATE                    PIC XX.
   185         16  PI-ACCOUNT                  PIC X(10).
   186         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   187                                         PIC X(10).
   188         16  PI-CLAIM-CERT-GRP.
   189             20  PI-CLAIM-NO             PIC X(7).
   190             20  PI-CERT-NO.
   191                 25  PI-CERT-PRIME       PIC X(10).
   192                 25  PI-CERT-SFX         PIC X.
   193             20  PI-CERT-EFF-DT          PIC XX.
   194         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   195             20  PI-PLAN-CODE            PIC X(2).
   196             20  PI-REVISION-NUMBER      PIC X(3).
   197             20  PI-PLAN-EFF-DT          PIC X(2).
   198             20  PI-PLAN-EXP-DT          PIC X(2).
   199             20  FILLER                  PIC X(11).
   200         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   201             20  PI-OE-REFERENCE-1.
   202                 25  PI-OE-REF-1-PRIME   PIC X(18).
   203                 25  PI-OE-REF-1-SUFF    PIC XX.
   204
   205     12  PI-SESSION-IN-PROGRESS          PIC X.
   206         88  CLAIM-SESSION                   VALUE '1'.
   207         88  CREDIT-SESSION                  VALUE '2'.
   208         88  WARRANTY-SESSION                VALUE '3'.
   209         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL645.cbl
   210         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   211
   212
   213*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   214
   215     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   216     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   217
   218     12  PI-CREDIT-USER                  PIC X.
   219         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   220         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   221
   222     12  PI-CLAIM-USER                   PIC X.
   223         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   224         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   225
   226     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   227         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   228         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   229         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   230         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   231         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   232
   233     12  PI-PROCESSOR-ID                 PIC X(4).
   234
   235     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   236
   237     12  PI-MEMBER-CAPTION               PIC X(10).
   238
   239     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   240         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   241
   242     12  PI-LIFE-OVERRIDE-L1             PIC X.
   243     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   244     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   245     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   246
   247     12  PI-AH-OVERRIDE-L1               PIC X.
   248     12  PI-AH-OVERRIDE-L2               PIC XX.
   249     12  PI-AH-OVERRIDE-L6               PIC X(6).
   250     12  PI-AH-OVERRIDE-L12              PIC X(12).
   251
   252     12  PI-NEW-SYSTEM                   PIC X(2).
   253
   254     12  PI-PRIMARY-CERT-NO              PIC X(11).
   255     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   256         88  PI-USES-PAID-TO                 VALUE '1'.
   257     12  PI-CRDTCRD-SYSTEM.
   258         16  PI-CRDTCRD-USER             PIC X.
   259             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   260             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   261         16  PI-CC-MONTH-END-DT          PIC XX.
   262     12  PI-PROCESSOR-PRINTER            PIC X(4).
   263
   264     12  PI-OE-REFERENCE-2.
   265         16  PI-OE-REF-2-PRIME           PIC X(10).
   266         16  PI-OE-REF-2-SUFF            PIC X.
   267
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL645.cbl
   268     12  PI-REM-TRM-CALC-OPTION          PIC X.
   269
   270     12  PI-LANGUAGE-TYPE                PIC X.
   271             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   272             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   273             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   274
   275     12  PI-POLICY-LINKAGE-IND           PIC X.
   276         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   277         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   278                                                   LOW-VALUES.
   279
   280     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   281     12  PI-CLAIM-PW-SESSION             PIC X(1).
   282         88  PI-CLAIM-CREDIT                 VALUE '1'.
   283         88  PI-CLAIM-CONVEN                 VALUE '2'.
   284     12  FILLER                          PIC X(4).
   285
   286     12  PI-SYSTEM-LEVEL                 PIC X(145).
   287
   288     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   289         PI-SYSTEM-LEVEL.
   290
   291         16  PI-ENTRY-CODES.
   292             20  PI-ENTRY-CD-1           PIC X.
   293             20  PI-ENTRY-CD-2           PIC X.
   294
   295         16  PI-RETURN-CODES.
   296             20  PI-RETURN-CD-1          PIC X.
   297             20  PI-RETURN-CD-2          PIC X.
   298
   299         16  PI-UPDATE-STATUS-SAVE.
   300             20  PI-UPDATE-BY            PIC X(4).
   301             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   302
   303         16  PI-LOWER-CASE-LETTERS       PIC X.
   304             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   305
   306*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   307*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   308*            88  CARRIER-CLM-CNTL            VALUE '2'.
   309
   310         16  PI-CERT-ACCESS-CONTROL      PIC X.
   311             88  ST-ACCNT-CNTL               VALUE ' '.
   312             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   313             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   314             88  ACCNT-CNTL                  VALUE '3'.
   315             88  CARR-ACCNT-CNTL             VALUE '4'.
   316
   317         16  PI-PROCESSOR-CAP-LIST.
   318             20  PI-SYSTEM-CONTROLS.
   319                24 PI-SYSTEM-DISPLAY     PIC X.
   320                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   321                24 PI-SYSTEM-MODIFY      PIC X.
   322                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   323             20  FILLER                  PIC XX.
   324             20  PI-DISPLAY-CAP          PIC X.
   325                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL645.cbl
   326             20  PI-MODIFY-CAP           PIC X.
   327                 88  MODIFY-CAP              VALUE 'Y'.
   328             20  PI-MSG-AT-LOGON-CAP     PIC X.
   329                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   330             20  PI-FORCE-CAP            PIC X.
   331                 88  FORCE-CAP               VALUE 'Y'.
   332
   333         16  PI-PROGRAM-CONTROLS.
   334             20  PI-PGM-PRINT-OPT        PIC X.
   335             20  PI-PGM-FORMAT-OPT       PIC X.
   336             20  PI-PGM-PROCESS-OPT      PIC X.
   337             20  PI-PGM-TOTALS-OPT       PIC X.
   338
   339         16  PI-HELP-INTERFACE.
   340             20  PI-LAST-ERROR-NO        PIC X(4).
   341             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   342
   343         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   344             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   345
   346         16  PI-CR-CONTROL-IN-PROGRESS.
   347             20  PI-CR-CARRIER           PIC X.
   348             20  PI-CR-GROUPING          PIC X(6).
   349             20  PI-CR-STATE             PIC XX.
   350             20  PI-CR-ACCOUNT           PIC X(10).
   351             20  PI-CR-FIN-RESP          PIC X(10).
   352             20  PI-CR-TYPE              PIC X.
   353
   354         16  PI-CR-BATCH-NUMBER          PIC X(6).
   355
   356         16  PI-CR-MONTH-END-DT          PIC XX.
   357
   358         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   359             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   360             88  PI-ZERO-CARRIER             VALUE '1'.
   361             88  PI-ZERO-GROUPING            VALUE '2'.
   362             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   363
   364         16  PI-CARRIER-SECURITY         PIC X.
   365             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   366
   367         16  PI-ACCOUNT-SECURITY         PIC X(10).
   368             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   369             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   370
   371         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   372             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   373                                         INDEXED BY PI-ACCESS-NDX
   374                                         PIC X.
   375
   376         16  PI-GA-BILLING-CONTROL       PIC X.
   377             88  PI-GA-BILLING               VALUE '1'.
   378
   379         16  PI-MAIL-PROCESSING          PIC X.
   380             88  PI-MAIL-YES                 VALUE 'Y'.
   381
   382         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   383
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL645.cbl
   384         16  PI-AR-SYSTEM.
   385             20  PI-AR-PROCESSING-CNTL   PIC X.
   386                 88  PI-AR-PROCESSING        VALUE 'Y'.
   387             20  PI-AR-SUMMARY-CODE      PIC X(6).
   388             20  PI-AR-MONTH-END-DT      PIC XX.
   389
   390         16  PI-MP-SYSTEM.
   391             20  PI-MORTGAGE-USER            PIC X.
   392                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   393                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   394             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   395                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   396                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   397                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   398                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   399                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   400             20  PI-MP-MONTH-END-DT          PIC XX.
   401             20  PI-MP-REFERENCE-NO.
   402                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   403                 24  PI-MP-REFERENCE-SFX     PIC XX.
   404
   405         16  PI-LABEL-CONTROL            PIC X(01).
   406             88  PI-CREATE-LABELS                    VALUE 'Y'.
   407             88  PI-BYPASS-LABELS                    VALUE 'N'.
   408
   409         16  PI-BILL-GROUPING-CODE       PIC X(01).
   410             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   411
   412         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   413             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   414             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   415
   416         16  FILLER                      PIC X(14).
   417
   418     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   419******************************************************************
   420
   421*                                COPY ELC645PI.
   422******************************************************************
   423*                                                                *
   424*                                                                *
   425*                            ELC645PI                            *
   426*                            VMOD=2.003                          *
   427*                                                                *
   428******************************************************************
   429
   430     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
   431         16  FILLER                      PIC  X(12).
   432         16  PI-1ST-TIME-SW              PIC S9(01)  COMP-3.
   433         16  PI-LINE-COUNT               PIC S9(03)  COMP-3.
   434         16  PI-AIX-RECORD-COUNT         PIC S9(04)  COMP SYNC.
   435         16  PI-START-SW                 PIC S9(01)  COMP-3.
   436         16  PI-BROWSE-SW                PIC S9(01)  COMP-3.
   437         16  PI-END-OF-FILE              PIC S9(01)  COMP-3.
   438         16  PI-DSID                     PIC  X(08).
   439         16  PI-OPTION                   PIC  X(01).
   440             88  OPTION-ONE-SELECTED             VALUE '1'.
   441             88  OPTION-TWO-SELECTED             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL645.cbl
   442             88  OPTION-THREE-SELECTED           VALUE '3'.
   443             88  OPTION-FOUR-SELECTED            VALUE '4'.
   444             88  OPTION-FIVE-SELECTED            VALUE '5'.
   445             88  OPTION-SIX-SELECTED             VALUE '6'.
   446         16  PI-READ-SWITCH              PIC  X(01).
   447             88  PI-READ-TOTAL                   VALUE 'B'.
   448             88  PI-READ-DETAIL                  VALUE 'C'.
   449         16  PI-RETURN-SWITCH            PIC  X(01).
   450             88  PI-REENTERED                    VALUE 'Y'.
   451         16  PI-SELECTION-CRITERIA.
   452             20  PI-SC-COMPANY-CD        PIC  X(01).
   453             20  PI-SC-RCD-TYPE          PIC  X(01).
   454             20  PI-SC-REIN-CO           PIC  X(03).
   455             20  PI-SC-RPT-CD-1          PIC  X(10).
   456             20  PI-SC-CARRIER           PIC  X(01).
   457             20  PI-SC-GROUPING          PIC  X(06).
   458             20  PI-SC-GA-RPT-CD-2       PIC  X(10).
   459             20  PI-SC-STATE             PIC  X(02).
   460             20  PI-SC-ACCOUNT           PIC  X(10).
   461             20  PI-SC-REIN-SUB          PIC  X(03).
   462         16  PI-LOSS-RATIO-KEY.
   463             20  PI-LRK-COMPANY-CD       PIC  X(01).
   464             20  PI-LRK-RCD-TYPE         PIC  X(01).
   465             20  PI-LRK-REIN-CO          PIC  X(03).
   466             20  PI-LRK-RPT-CD-1         PIC  X(10).
   467             20  PI-LRK-CARRIER          PIC  X(01).
   468             20  PI-LRK-GROUPING         PIC  X(06).
   469             20  PI-LRK-GA-RPT-CD-2      PIC  X(10).
   470             20  PI-LRK-STATE            PIC  X(02).
   471             20  PI-LRK-ACCOUNT          PIC  X(10).
   472             20  PI-LRK-REIN-SUB         PIC  X(03).
   473         16  PI-PREV-LOSS-RATIO-KEY.
   474             20  PI-PREV-LRK-COMPANY-CD  PIC  X(01).
   475             20  PI-PREV-LRK-RCD-TYPE    PIC  X(01).
   476             20  PI-PREV-LRK-REIN-CO     PIC  X(03).
   477             20  PI-PREV-LRK-RPT-CD-1    PIC  X(10).
   478             20  PI-PREV-LRK-CARRIER     PIC  X(01).
   479             20  PI-PREV-LRK-GROUPING    PIC  X(06).
   480             20  PI-PREV-LRK-GA-RPT-CD-2
   481                                         PIC  X(10).
   482             20  PI-PREV-LRK-STATE       PIC  X(02).
   483             20  PI-PREV-LRK-ACCOUNT     PIC  X(10).
   484             20  PI-PREV-LRK-REIN-SUB    PIC  X(03).
   485         16  PI-KEY-LENGTH               PIC S9(04)  COMP SYNC.
   486         16  PI-TS-ITEM                  PIC S9(04)  COMP SYNC.
   487         16  PI-1ST-KEY                  PIC  X(47).
   488         16  PI-LAST-KEY                 PIC  X(47).
   489         16  PI-PREV-AID                 PIC  X(01).
   490         16  PI-START-LOSS-RATIO-KEY.
   491             20  PI-START-LRK-COMPANY-CD
   492                                         PIC  X(01).
   493             20  PI-START-LRK-RCD-TYPE   PIC  X(01).
   494             20  PI-START-LRK-REIN-CO    PIC  X(03).
   495             20  PI-START-LRK-RPT-CD-1   PIC  X(10).
   496             20  PI-START-LRK-CARRIER    PIC  X(01).
   497             20  PI-START-LRK-GROUPING   PIC  X(06).
   498             20  PI-START-LRK-GA-RPT-CD-2
   499                                         PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL645.cbl
   500             20  PI-START-LRK-STATE      PIC  X(02).
   501             20  PI-START-LRK-ACCOUNT    PIC  X(10).
   502             20  PI-START-LRK-REIN-SUB   PIC  X(03).
   503         16  PI-END-LOSS-RATIO-KEY.
   504             20  PI-END-LRK-COMPANY-CD   PIC  X(01).
   505             20  PI-END-LRK-RCD-TYPE     PIC  X(01).
   506             20  PI-END-LRK-REIN-CO      PIC  X(03).
   507             20  PI-END-LRK-RPT-CD-1     PIC  X(10).
   508             20  PI-END-LRK-CARRIER      PIC  X(01).
   509             20  PI-END-LRK-GROUPING     PIC  X(06).
   510             20  PI-END-LRK-GA-RPT-CD-2  PIC  X(10).
   511             20  PI-END-LRK-STATE        PIC  X(02).
   512             20  PI-END-LRK-ACCOUNT      PIC  X(10).
   513             20  PI-END-LRK-REIN-SUB     PIC  X(03).
   514         16  PI-SAVE-LOSS-RATIO-KEY.
   515             20  PI-SAVE-LRK-COMPANY-CD  PIC  X(01).
   516             20  PI-SAVE-LRK-RCD-TYPE    PIC  X(01).
   517             20  PI-SAVE-LRK-REIN-CO     PIC  X(03).
   518             20  PI-SAVE-LRK-RPT-CD-1    PIC  X(10).
   519             20  PI-SAVE-LRK-CARRIER     PIC  X(01).
   520             20  PI-SAVE-LRK-GROUPING    PIC  X(06).
   521             20  PI-SAVE-LRK-GA-RPT-CD-2
   522                                         PIC  X(10).
   523             20  PI-SAVE-LRK-STATE       PIC  X(02).
   524             20  PI-SAVE-LRK-ACCOUNT     PIC  X(10).
   525             20  PI-SAVE-LRK-REIN-SUB    PIC  X(03).
   526         16  PI-LIN1-LOSS-RATIO-KEY      PIC  X(47).
   527         16  PI-SCREEN-COUNT             PIC S9(08)  COMP.
   528         16  PI-SUB                      PIC S9(02).
   529         16  PI-FIRST-TIME-SW            PIC  X(01).
   530         16  PI-MAPNAME                  PIC  X(08).
   531             88  PI-MAP-B                    VALUE 'EL654B  '.
   532             88  PI-MAP-C                    VALUE 'EL654C  '.
   533         16  PI-ACTIVE-ONLY              PIC  X(01).
   534             88  PI-ACCT-ACTIVE              VALUE 'Y'.
   535         16  FILLER                      PIC  X(163).
   536
   537******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL645.cbl
   539*                                COPY ELCEMIB.
   540******************************************************************
   541*                                                                *
   542*                                                                *
   543*                            ELCEMIB.                            *
   544*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   545*                            VMOD=2.005                          *
   546*                                                                *
   547*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   548*                                                                *
   549******************************************************************
   550 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   551     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   552     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   553     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   554     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   555     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   556     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   557     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   558     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   559     12  EMI-SWITCH1             PIC X        VALUE '1'.
   560         88  EMI-NO-ERRORS                    VALUE '1'.
   561         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   562         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   563     12  EMI-SWITCH2             PIC X        VALUE '1'.
   564         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   565     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   566         88  EMI-AREA1-EMPTY                  VALUE '1'.
   567         88  EMI-AREA1-FULL                   VALUE '2'.
   568     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   569         88  EMI-AREA2-EMPTY                  VALUE '1'.
   570         88  EMI-AREA2-FULL                   VALUE '2'.
   571     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   572         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   573         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   574         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   575         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   576         88  EMI-BYPASS-FATALS                VALUE 'X'.
   577     12  EMI-ERROR-LINES.
   578         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   579         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   580         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   581         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   582             20  EMI-ERR-CODES OCCURS 10 TIMES.
   583                 24  EMI-ERR-NUM         PIC X(4).
   584                 24  EMI-FILLER          PIC X.
   585                 24  EMI-SEV             PIC X.
   586                 24  FILLER              PIC X.
   587             20  FILLER                  PIC X(02).
   588     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   589         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   590             20  EMI-ERROR-NUMBER    PIC X(4).
   591             20  EMI-FILL            PIC X.
   592             20  EMI-SEVERITY        PIC X.
   593             20  FILLER              PIC X.
   594             20  EMI-ERROR-TEXT.
   595                 24  EMI-TEXT-VARIABLE   PIC X(10).
   596                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL645.cbl
   597     12  EMI-SEVERITY-SAVE           PIC X.
   598         88  EMI-NOTE                    VALUE 'N'.
   599         88  EMI-WARNING                 VALUE 'W'.
   600         88  EMI-FORCABLE                VALUE 'F'.
   601         88  EMI-FATAL                   VALUE 'X'.
   602     12  EMI-MESSAGE-FLAG            PIC X.
   603         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   604         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   605     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   606     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   607         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   608         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   609         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   610     12  FILLER                      PIC X(137)  VALUE SPACES.
   611     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   612     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   613     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   614     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL645.cbl
   616*                                COPY ELCDATE.
   617******************************************************************
   618*                                                                *
   619*                                                                *
   620*                            ELCDATE.                            *
   621*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   622*                            VMOD=2.003
   623*                                                                *
   624*                                                                *
   625*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   626*                 LENGTH = 200                                   *
   627******************************************************************
   628
   629 01  DATE-CONVERSION-DATA.
   630     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   631     12  DC-OPTION-CODE                PIC X.
   632         88  BIN-TO-GREG                VALUE ' '.
   633         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   634         88  EDIT-GREG-TO-BIN           VALUE '2'.
   635         88  YMD-GREG-TO-BIN            VALUE '3'.
   636         88  MDY-GREG-TO-BIN            VALUE '4'.
   637         88  JULIAN-TO-BIN              VALUE '5'.
   638         88  BIN-PLUS-ELAPSED           VALUE '6'.
   639         88  FIND-CENTURY               VALUE '7'.
   640         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   641         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   642         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   643         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   644         88  JULIAN-TO-BIN-3            VALUE 'C'.
   645         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   646         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   647         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   648         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   649         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   650         88  CHECK-LEAP-YEAR            VALUE 'H'.
   651         88  BIN-3-TO-GREG              VALUE 'I'.
   652         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   653         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   654         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   655         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   656         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   657         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   658         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   659         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   660         88  THREE-CHARACTER-BIN
   661                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   662         88  GREGORIAN-TO-BIN
   663                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   664         88  BIN-TO-GREGORIAN
   665                  VALUES ' ' '1' 'I' '8' 'G'.
   666         88  JULIAN-TO-BINARY
   667                  VALUES '5' 'C' 'E' 'F'.
   668     12  DC-ERROR-CODE                 PIC X.
   669         88  NO-CONVERSION-ERROR        VALUE ' '.
   670         88  DATE-CONVERSION-ERROR
   671                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   672         88  DATE-IS-ZERO               VALUE '1'.
   673         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL645.cbl
   674         88  DATE-IS-INVALID            VALUE '3'.
   675         88  DATE1-GREATER-DATE2        VALUE '4'.
   676         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   677         88  DATE-INVALID-OPTION        VALUE '9'.
   678         88  INVALID-CENTURY            VALUE 'A'.
   679         88  ONLY-CENTURY               VALUE 'B'.
   680         88  ONLY-LEAP-YEAR             VALUE 'C'.
   681         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   682     12  DC-END-OF-MONTH               PIC X.
   683         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   684     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   685         88  USE-NORMAL-PROCESS         VALUE ' '.
   686         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   687         88  ADJUST-UP-100-YRS          VALUE '2'.
   688     12  FILLER                        PIC X.
   689     12  DC-CONVERSION-DATES.
   690         16  DC-BIN-DATE-1             PIC XX.
   691         16  DC-BIN-DATE-2             PIC XX.
   692         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   693         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   694                       DC-GREG-DATE-1-EDIT.
   695             20  DC-EDIT1-MONTH        PIC 99.
   696             20  SLASH1-1              PIC X.
   697             20  DC-EDIT1-DAY          PIC 99.
   698             20  SLASH1-2              PIC X.
   699             20  DC-EDIT1-YEAR         PIC 99.
   700         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   701         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   702                     DC-GREG-DATE-2-EDIT.
   703             20  DC-EDIT2-MONTH        PIC 99.
   704             20  SLASH2-1              PIC X.
   705             20  DC-EDIT2-DAY          PIC 99.
   706             20  SLASH2-2              PIC X.
   707             20  DC-EDIT2-YEAR         PIC 99.
   708         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   709         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   710                     DC-GREG-DATE-1-YMD.
   711             20  DC-YMD-YEAR           PIC 99.
   712             20  DC-YMD-MONTH          PIC 99.
   713             20  DC-YMD-DAY            PIC 99.
   714         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   715         16  DC-GREG-DATE-1-MDY-R REDEFINES
   716                      DC-GREG-DATE-1-MDY.
   717             20  DC-MDY-MONTH          PIC 99.
   718             20  DC-MDY-DAY            PIC 99.
   719             20  DC-MDY-YEAR           PIC 99.
   720         16  DC-GREG-DATE-1-ALPHA.
   721             20  DC-ALPHA-MONTH        PIC X(10).
   722             20  DC-ALPHA-DAY          PIC 99.
   723             20  FILLER                PIC XX.
   724             20  DC-ALPHA-CENTURY.
   725                 24 DC-ALPHA-CEN-N     PIC 99.
   726             20  DC-ALPHA-YEAR         PIC 99.
   727         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   728         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   729         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   730         16  DC-JULIAN-DATE            PIC 9(05).
   731         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL645.cbl
   732                                       PIC 9(05).
   733         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   734             20  DC-JULIAN-YEAR        PIC 99.
   735             20  DC-JULIAN-DAYS        PIC 999.
   736         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   737         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   738         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   739     12  DATE-CONVERSION-VARIBLES.
   740         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   741         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   742             20  FILLER                PIC 9(3).
   743             20  HOLD-CEN-1-CCYY.
   744                 24  HOLD-CEN-1-CC     PIC 99.
   745                 24  HOLD-CEN-1-YY     PIC 99.
   746             20  HOLD-CEN-1-MO         PIC 99.
   747             20  HOLD-CEN-1-DA         PIC 99.
   748         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   749             20  HOLD-CEN-1-R-MO       PIC 99.
   750             20  HOLD-CEN-1-R-DA       PIC 99.
   751             20  HOLD-CEN-1-R-CCYY.
   752                 24  HOLD-CEN-1-R-CC   PIC 99.
   753                 24  HOLD-CEN-1-R-YY   PIC 99.
   754             20  FILLER                PIC 9(3).
   755         16  HOLD-CENTURY-1-X.
   756             20  FILLER                PIC X(3)  VALUE SPACES.
   757             20  HOLD-CEN-1-X-CCYY.
   758                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   759                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   760             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   761             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   762         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   763             20  HOLD-CEN-1-R-X-MO     PIC XX.
   764             20  HOLD-CEN-1-R-X-DA     PIC XX.
   765             20  HOLD-CEN-1-R-X-CCYY.
   766                 24  HOLD-CEN-1-R-X-CC PIC XX.
   767                 24  HOLD-CEN-1-R-X-YY PIC XX.
   768             20  FILLER                PIC XXX.
   769         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   770         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   771         16  DC-JULIAN-DATE-1          PIC 9(07).
   772         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   773             20  DC-JULIAN-1-CCYY.
   774                 24  DC-JULIAN-1-CC    PIC 99.
   775                 24  DC-JULIAN-1-YR    PIC 99.
   776             20  DC-JULIAN-DA-1        PIC 999.
   777         16  DC-JULIAN-DATE-2          PIC 9(07).
   778         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   779             20  DC-JULIAN-2-CCYY.
   780                 24  DC-JULIAN-2-CC    PIC 99.
   781                 24  DC-JULIAN-2-YR    PIC 99.
   782             20  DC-JULIAN-DA-2        PIC 999.
   783         16  DC-GREG-DATE-A-EDIT.
   784             20  DC-EDITA-MONTH        PIC 99.
   785             20  SLASHA-1              PIC X VALUE '/'.
   786             20  DC-EDITA-DAY          PIC 99.
   787             20  SLASHA-2              PIC X VALUE '/'.
   788             20  DC-EDITA-CCYY.
   789                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL645.cbl
   790                 24  DC-EDITA-YEAR     PIC 99.
   791         16  DC-GREG-DATE-B-EDIT.
   792             20  DC-EDITB-MONTH        PIC 99.
   793             20  SLASHB-1              PIC X VALUE '/'.
   794             20  DC-EDITB-DAY          PIC 99.
   795             20  SLASHB-2              PIC X VALUE '/'.
   796             20  DC-EDITB-CCYY.
   797                 24  DC-EDITB-CENT     PIC 99.
   798                 24  DC-EDITB-YEAR     PIC 99.
   799         16  DC-GREG-DATE-CYMD         PIC 9(08).
   800         16  DC-GREG-DATE-CYMD-R REDEFINES
   801                              DC-GREG-DATE-CYMD.
   802             20  DC-CYMD-CEN           PIC 99.
   803             20  DC-CYMD-YEAR          PIC 99.
   804             20  DC-CYMD-MONTH         PIC 99.
   805             20  DC-CYMD-DAY           PIC 99.
   806         16  DC-GREG-DATE-MDCY         PIC 9(08).
   807         16  DC-GREG-DATE-MDCY-R REDEFINES
   808                              DC-GREG-DATE-MDCY.
   809             20  DC-MDCY-MONTH         PIC 99.
   810             20  DC-MDCY-DAY           PIC 99.
   811             20  DC-MDCY-CEN           PIC 99.
   812             20  DC-MDCY-YEAR          PIC 99.
   813    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   814        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   815    12  DC-EL310-DATE                  PIC X(21).
   816    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL645.cbl
   818*                                COPY ELCLOGOF.
   819******************************************************************
   820*                                                                *
   821*                                                                *
   822*                            ELCLOGOF.                           *
   823*                            VMOD=2.001                          *
   824*                                                                *
   825*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   826*                                                                *
   827******************************************************************
   828 01  CLASIC-LOGOFF.
   829     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   830     12  LOGOFF-TEXT.
   831         16  FILLER          PIC X(5)    VALUE SPACES.
   832         16  LOGOFF-MSG.
   833             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   834             20  FILLER      PIC X       VALUE SPACES.
   835             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   836         16  FILLER          PIC X(80)
   837           VALUE '* YOU ARE NOW LOGGED OFF'.
   838         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   839         16  FILLER          PIC X       VALUE QUOTE.
   840         16  LOGOFF-SYS-MSG  PIC X(17)
   841           VALUE 'S CLAS-IC SYSTEM '.
   842     12  TEXT-MESSAGES.
   843         16  UNACCESS-MSG    PIC X(29)
   844             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   845         16  PGMIDERR-MSG    PIC X(17)
   846             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL645.cbl
   848*                                COPY EL645S.
   849 01  EL645AI.
   850     05  FILLER            PIC  X(0012).
   851*    -------------------------------
   852     05  ADATEL PIC S9(0004) COMP.
   853     05  ADATEF PIC  X(0001).
   854     05  FILLER REDEFINES ADATEF.
   855         10  ADATEA PIC  X(0001).
   856     05  ADATEI PIC  X(0008).
   857*    -------------------------------
   858     05  ATIMEL PIC S9(0004) COMP.
   859     05  ATIMEF PIC  X(0001).
   860     05  FILLER REDEFINES ATIMEF.
   861         10  ATIMEA PIC  X(0001).
   862     05  ATIMEI PIC  X(0005).
   863*    -------------------------------
   864     05  ACARRL PIC S9(0004) COMP.
   865     05  ACARRF PIC  X(0001).
   866     05  FILLER REDEFINES ACARRF.
   867         10  ACARRA PIC  X(0001).
   868     05  ACARRI PIC  X(0001).
   869*    -------------------------------
   870     05  AGROUPL PIC S9(0004) COMP.
   871     05  AGROUPF PIC  X(0001).
   872     05  FILLER REDEFINES AGROUPF.
   873         10  AGROUPA PIC  X(0001).
   874     05  AGROUPI PIC  X(0006).
   875*    -------------------------------
   876     05  ASTATEL PIC S9(0004) COMP.
   877     05  ASTATEF PIC  X(0001).
   878     05  FILLER REDEFINES ASTATEF.
   879         10  ASTATEA PIC  X(0001).
   880     05  ASTATEI PIC  X(0002).
   881*    -------------------------------
   882     05  AACCTL PIC S9(0004) COMP.
   883     05  AACCTF PIC  X(0001).
   884     05  FILLER REDEFINES AACCTF.
   885         10  AACCTA PIC  X(0001).
   886     05  AACCTI PIC  X(0010).
   887*    -------------------------------
   888     05  AGENAGTL PIC S9(0004) COMP.
   889     05  AGENAGTF PIC  X(0001).
   890     05  FILLER REDEFINES AGENAGTF.
   891         10  AGENAGTA PIC  X(0001).
   892     05  AGENAGTI PIC  X(0010).
   893*    -------------------------------
   894     05  AREINCOL PIC S9(0004) COMP.
   895     05  AREINCOF PIC  X(0001).
   896     05  FILLER REDEFINES AREINCOF.
   897         10  AREINCOA PIC  X(0001).
   898     05  AREINCOI PIC  X(0003).
   899*    -------------------------------
   900     05  ARPTCD1L PIC S9(0004) COMP.
   901     05  ARPTCD1F PIC  X(0001).
   902     05  FILLER REDEFINES ARPTCD1F.
   903         10  ARPTCD1A PIC  X(0001).
   904     05  ARPTCD1I PIC  X(0010).
   905*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL645.cbl
   906     05  ARPTCD2L PIC S9(0004) COMP.
   907     05  ARPTCD2F PIC  X(0001).
   908     05  FILLER REDEFINES ARPTCD2F.
   909         10  ARPTCD2A PIC  X(0001).
   910     05  ARPTCD2I PIC  X(0010).
   911*    -------------------------------
   912     05  ACTONLYL PIC S9(0004) COMP.
   913     05  ACTONLYF PIC  X(0001).
   914     05  FILLER REDEFINES ACTONLYF.
   915         10  ACTONLYA PIC  X(0001).
   916     05  ACTONLYI PIC  X(0001).
   917*    -------------------------------
   918     05  ASELL PIC S9(0004) COMP.
   919     05  ASELF PIC  X(0001).
   920     05  FILLER REDEFINES ASELF.
   921         10  ASELA PIC  X(0001).
   922     05  ASELI PIC  99.
   923*    -------------------------------
   924     05  AEMSG1L PIC S9(0004) COMP.
   925     05  AEMSG1F PIC  X(0001).
   926     05  FILLER REDEFINES AEMSG1F.
   927         10  AEMSG1A PIC  X(0001).
   928     05  AEMSG1I PIC  X(0079).
   929*    -------------------------------
   930     05  AEMSG2L PIC S9(0004) COMP.
   931     05  AEMSG2F PIC  X(0001).
   932     05  FILLER REDEFINES AEMSG2F.
   933         10  AEMSG2A PIC  X(0001).
   934     05  AEMSG2I PIC  X(0079).
   935*    -------------------------------
   936     05  APFKL PIC S9(0004) COMP.
   937     05  APFKF PIC  X(0001).
   938     05  FILLER REDEFINES APFKF.
   939         10  APFKA PIC  X(0001).
   940     05  APFKI PIC  99.
   941 01  EL645AO REDEFINES EL645AI.
   942     05  FILLER            PIC  X(0012).
   943*    -------------------------------
   944     05  FILLER            PIC  X(0003).
   945     05  ADATEO PIC  X(0008).
   946*    -------------------------------
   947     05  FILLER            PIC  X(0003).
   948     05  ATIMEO PIC  99.99.
   949*    -------------------------------
   950     05  FILLER            PIC  X(0003).
   951     05  ACARRO PIC  X(0001).
   952*    -------------------------------
   953     05  FILLER            PIC  X(0003).
   954     05  AGROUPO PIC  X(0006).
   955*    -------------------------------
   956     05  FILLER            PIC  X(0003).
   957     05  ASTATEO PIC  X(0002).
   958*    -------------------------------
   959     05  FILLER            PIC  X(0003).
   960     05  AACCTO PIC  X(0010).
   961*    -------------------------------
   962     05  FILLER            PIC  X(0003).
   963     05  AGENAGTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL645.cbl
   964*    -------------------------------
   965     05  FILLER            PIC  X(0003).
   966     05  AREINCOO PIC  X(0003).
   967*    -------------------------------
   968     05  FILLER            PIC  X(0003).
   969     05  ARPTCD1O PIC  X(0010).
   970*    -------------------------------
   971     05  FILLER            PIC  X(0003).
   972     05  ARPTCD2O PIC  X(0010).
   973*    -------------------------------
   974     05  FILLER            PIC  X(0003).
   975     05  ACTONLYO PIC  X(0001).
   976*    -------------------------------
   977     05  FILLER            PIC  X(0003).
   978     05  ASELO PIC  99.
   979*    -------------------------------
   980     05  FILLER            PIC  X(0003).
   981     05  AEMSG1O PIC  X(0079).
   982*    -------------------------------
   983     05  FILLER            PIC  X(0003).
   984     05  AEMSG2O PIC  X(0079).
   985*    -------------------------------
   986     05  FILLER            PIC  X(0003).
   987     05  APFKO PIC  99.
   988*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL645.cbl
   990*                                COPY ELCATTR.
   991******************************************************************
   992*                                                                *
   993*                            ELCATTR.                            *
   994*                            VMOD=2.001                          *
   995*                                                                *
   996*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   997*                                                                *
   998*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   999*                                                                *
  1000*                   POS 1   P=PROTECTED                          *
  1001*                           U=UNPROTECTED                        *
  1002*                           S=ASKIP                              *
  1003*                   POS 2   A=ALPHA/NUMERIC                      *
  1004*                           N=NUMERIC                            *
  1005*                   POS 3   N=NORMAL                             *
  1006*                           B=BRIGHT                             *
  1007*                           D=DARK                               *
  1008*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1009*                           OF=MODIFIED DATA TAG OFF             *
  1010*                                                                *
  1011*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1012******************************************************************
  1013 01  ATTRIBUTE-LIST.
  1014     12  AL-PABOF            PIC X       VALUE 'Y'.
  1015     12  AL-PABON            PIC X       VALUE 'Z'.
  1016     12  AL-PADOF            PIC X       VALUE '%'.
  1017     12  AL-PADON            PIC X       VALUE '_'.
  1018     12  AL-PANOF            PIC X       VALUE '-'.
  1019     12  AL-PANON            PIC X       VALUE '/'.
  1020     12  AL-SABOF            PIC X       VALUE '8'.
  1021     12  AL-SABON            PIC X       VALUE '9'.
  1022     12  AL-SADOF            PIC X       VALUE '@'.
  1023     12  AL-SADON            PIC X       VALUE QUOTE.
  1024     12  AL-SANOF            PIC X       VALUE '0'.
  1025     12  AL-SANON            PIC X       VALUE '1'.
  1026     12  AL-UABOF            PIC X       VALUE 'H'.
  1027     12  AL-UABON            PIC X       VALUE 'I'.
  1028     12  AL-UADOF            PIC X       VALUE '<'.
  1029     12  AL-UADON            PIC X       VALUE '('.
  1030     12  AL-UANOF            PIC X       VALUE ' '.
  1031     12  AL-UANON            PIC X       VALUE 'A'.
  1032     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1033     12  AL-UNBON            PIC X       VALUE 'R'.
  1034     12  AL-UNDOF            PIC X       VALUE '*'.
  1035     12  AL-UNDON            PIC X       VALUE ')'.
  1036     12  AL-UNNOF            PIC X       VALUE '&'.
  1037     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL645.cbl
  1039*                                COPY ELCAID.
  1040******************************************************************
  1041*                                                                *
  1042*                            ELCAID.                             *
  1043*                            VMOD=2.001                          *
  1044*                                                                *
  1045*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1046*                                                                *
  1047*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1048*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1049******************************************************************
  1050
  1051 01  DFHAID.
  1052   02  DFHNULL   PIC  X  VALUE  ' '.
  1053   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1054   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1055   02  DFHPEN    PIC  X  VALUE  '='.
  1056   02  DFHOPID   PIC  X  VALUE  'W'.
  1057   02  DFHPA1    PIC  X  VALUE  '%'.
  1058   02  DFHPA2    PIC  X  VALUE  '>'.
  1059   02  DFHPA3    PIC  X  VALUE  ','.
  1060   02  DFHPF1    PIC  X  VALUE  '1'.
  1061   02  DFHPF2    PIC  X  VALUE  '2'.
  1062   02  DFHPF3    PIC  X  VALUE  '3'.
  1063   02  DFHPF4    PIC  X  VALUE  '4'.
  1064   02  DFHPF5    PIC  X  VALUE  '5'.
  1065   02  DFHPF6    PIC  X  VALUE  '6'.
  1066   02  DFHPF7    PIC  X  VALUE  '7'.
  1067   02  DFHPF8    PIC  X  VALUE  '8'.
  1068   02  DFHPF9    PIC  X  VALUE  '9'.
  1069   02  DFHPF10   PIC  X  VALUE  ':'.
  1070   02  DFHPF11   PIC  X  VALUE  '#'.
  1071   02  DFHPF12   PIC  X  VALUE  '@'.
  1072   02  DFHPF13   PIC  X  VALUE  'A'.
  1073   02  DFHPF14   PIC  X  VALUE  'B'.
  1074   02  DFHPF15   PIC  X  VALUE  'C'.
  1075   02  DFHPF16   PIC  X  VALUE  'D'.
  1076   02  DFHPF17   PIC  X  VALUE  'E'.
  1077   02  DFHPF18   PIC  X  VALUE  'F'.
  1078   02  DFHPF19   PIC  X  VALUE  'G'.
  1079   02  DFHPF20   PIC  X  VALUE  'H'.
  1080   02  DFHPF21   PIC  X  VALUE  'I'.
  1081*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1082   02  DFHPF22   PIC  X  VALUE  '['.
  1083   02  DFHPF23   PIC  X  VALUE  '.'.
  1084   02  DFHPF24   PIC  X  VALUE  '<'.
  1085   02  DFHMSRE   PIC  X  VALUE  'X'.
  1086   02  DFHSTRF   PIC  X  VALUE  'h'.
  1087   02  DFHTRIG   PIC  X  VALUE  '"'.
  1088
  1089 01  FILLER  REDEFINES  DFHAID.
  1090     12  FILLER                      PIC  X(08).
  1091     12  PF-VALUES                   PIC  X(01)
  1092             OCCURS  24  TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL645.cbl
  1094****************************************************************
  1095*
  1096* Copyright (c) 2007 by Clerity Solutions, Inc.
  1097* All rights reserved.
  1098*
  1099****************************************************************
  1100 01  DFHEIV.
  1101   02  DFHEIV0               PIC X(35).
  1102   02  DFHEIV1               PIC X(08).
  1103   02  DFHEIV2               PIC X(08).
  1104   02  DFHEIV3               PIC X(08).
  1105   02  DFHEIV4               PIC X(06).
  1106   02  DFHEIV5               PIC X(04).
  1107   02  DFHEIV6               PIC X(04).
  1108   02  DFHEIV7               PIC X(02).
  1109   02  DFHEIV8               PIC X(02).
  1110   02  DFHEIV9               PIC X(01).
  1111   02  DFHEIV10              PIC S9(7) COMP-3.
  1112   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1113   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1114   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1115   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1116   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1117   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1118   02  DFHEIV17              PIC X(04).
  1119   02  DFHEIV18              PIC X(04).
  1120   02  DFHEIV19              PIC X(04).
  1121   02  DFHEIV20              USAGE IS POINTER.
  1122   02  DFHEIV21              USAGE IS POINTER.
  1123   02  DFHEIV22              USAGE IS POINTER.
  1124   02  DFHEIV23              USAGE IS POINTER.
  1125   02  DFHEIV24              USAGE IS POINTER.
  1126   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1127   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1128   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1129   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1130   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1131   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1132   02  FILLER                PIC X(02).
  1133   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1134   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1135   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1136   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1137   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1138 LINKAGE  SECTION.
  1139*****************************************************************
  1140*                                                               *
  1141* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1142* All rights reserved.                                          *
  1143*                                                               *
  1144*****************************************************************
  1145 01  dfheiblk.
  1146     02  eibtime          pic s9(7) comp-3.
  1147     02  eibdate          pic s9(7) comp-3.
  1148     02  eibtrnid         pic x(4).
  1149     02  eibtaskn         pic s9(7) comp-3.
  1150     02  eibtrmid         pic x(4).
  1151     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL645.cbl
  1152     02  eibcposn         pic s9(4) comp.
  1153     02  eibcalen         pic s9(4) comp.
  1154     02  eibaid           pic x(1).
  1155     02  eibfiller1       pic x(1).
  1156     02  eibfn            pic x(2).
  1157     02  eibfiller2       pic x(2).
  1158     02  eibrcode         pic x(6).
  1159     02  eibfiller3       pic x(2).
  1160     02  eibds            pic x(8).
  1161     02  eibreqid         pic x(8).
  1162     02  eibrsrce         pic x(8).
  1163     02  eibsync          pic x(1).
  1164     02  eibfree          pic x(1).
  1165     02  eibrecv          pic x(1).
  1166     02  eibsend          pic x(1).
  1167     02  eibatt           pic x(1).
  1168     02  eibeoc           pic x(1).
  1169     02  eibfmh           pic x(1).
  1170     02  eibcompl         pic x(1).
  1171     02  eibsig           pic x(1).
  1172     02  eibconf          pic x(1).
  1173     02  eiberr           pic x(1).
  1174     02  eibrldbk         pic x(1).
  1175     02  eiberrcd         pic x(4).
  1176     02  eibsynrb         pic x(1).
  1177     02  eibnodat         pic x(1).
  1178     02  eibfiller5       pic x(2).
  1179     02  eibresp          pic 9(09) comp.
  1180     02  eibresp2         pic 9(09) comp.
  1181     02  dfheigdj         pic s9(4) comp.
  1182     02  dfheigdk         pic s9(4) comp.
  1183
  1184 01  DFHCOMMAREA                     PIC  X(1024).
  1185
  1186*01 PARMLIST             COMP  SYNC.
  1187*    12  FILLER                      PIC S9(09).
  1188*    12  ERLOSS-POINTER              PIC S9(09).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL645.cbl
  1190*                                COPY ERCLOSS.
  1191******************************************************************
  1192*                                                                *
  1193*                                                                *
  1194*                            ERCLOSS                             *
  1195*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1196*                            VMOD=2.005                          *
  1197*                                                                *
  1198*   FILE DESCRIPTION  =  LOSS RATIOS                             *
  1199*                                                                *
  1200*   **NOTE**  THIS COPYBOOK IS USED FOR BOTH THE ON-LINE         *
  1201*             AND OFF-LINE LOSS-RATIO FILES.                     *
  1202*                                                                *
  1203*                                                                *
  1204*   FILE TYPE  =  VSAM,KSDS(ON-LINE),  SEQUENTIAL(OFFLINE)       *
  1205*   RECORD SIZE = 525           RECFORM = FIXED                  *
  1206*                                                                *
  1207*   BASE CLUSTER NAME  =  ERLOSS               RKP=2,LEN=47      *
  1208*                                                                *
  1209*   LOG = NO                                                     *
  1210*   SERVREQ = BROWSE                                             *
  1211*                                                                *
  1212******************************************************************
  1213
  1214 01  LOSS-RATIO-MASTER.
  1215
  1216     12  LR-RECORD-ID        PIC XX.
  1217         88  VALID-LR-RECORD           VALUE 'LR'.
  1218
  1219     12  LR-CONTROL.
  1220         16  LR-COMPANY-CD   PIC X.
  1221         16  LR-RCD-TYPE     PIC X.
  1222             88  ACCOUNT-RECORD        VALUE 'A'.
  1223             88  G-A-RECORD            VALUE 'G'.
  1224             88  REIN-RECORD           VALUE 'R'.
  1225             88  REPORT-CD1-RECORD     VALUE 'B'.
  1226             88  REPORT-CD2-RECORD     VALUE 'C'.
  1227             88  STATE-RECORD          VALUE 'S'.
  1228         16  LR-REIN-CO      PIC XXX.
  1229         16  LR-RPT-CD-1     PIC X(10).
  1230         16  LR-CARRIER      PIC X.
  1231         16  LR-GROUPING     PIC X(6).
  1232         16  LR-GA-RPT-CD-2  PIC X(10).
  1233         16  LR-STATE        PIC XX.
  1234         16  LR-ACCOUNT      PIC X(10).
  1235         16  LR-REIN-SUB     PIC XXX.
  1236
  1237     12  LR-DATA.
  1238         16  LR-RUN-DATE     PIC X(6).
  1239         16  LR-RUN-DATE-N REDEFINES
  1240                LR-RUN-DATE  PIC 9(6).
  1241         16  LR-ACCT-NAME    PIC X(30).
  1242         16  LR-ACCT-RANGES  OCCURS  2  TIMES.
  1243             20  LR-EXP-DATE PIC X(6).
  1244             20  LR-REI-TAB  PIC XXX.
  1245             20  LR-RETRO    PIC X.
  1246             20  LR-BASIS    PIC X.
  1247             20  LR-GA-DATA  OCCURS  3  TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL645.cbl
  1248                 24  LR-AGT-NO   PIC X(10).
  1249                 24  LR-SNG-PCT  PIC SV9(5)        COMP-3.
  1250                 24  LR-SNG-PCT-X REDEFINES
  1251                     LR-SNG-PCT  PIC XXX.
  1252                 24  LR-JNT-PCT  PIC SV9(5)        COMP-3.
  1253                 24  LR-JNT-PCT-X REDEFINES
  1254                     LR-JNT-PCT  PIC XXX.
  1255                 24  LR-A-H-PCT  PIC SV9(5)        COMP-3.
  1256                 24  LR-A-H-PCT-X REDEFINES
  1257                     LR-A-H-PCT  PIC XXX.
  1258
  1259         16  LR-REIN-NAME    PIC X(30).
  1260         16  LR-G-A-NAME     PIC X(30).
  1261
  1262         16  LR-ACCT-STATUS  PIC X.
  1263             88  ACCT-ACTIVE          VALUE 'A' '0'.
  1264             88  ACCT-INACTIVE        VALUE 'I' '1'.
  1265             88  ACCT-TRANSFERRED     VALUE 'T' '2'.
  1266
  1267         16  FILLER          PIC X(15).
  1268
  1269     12  LR-TOTALS  OCCURS  3  TIMES.
  1270         16  LR-YTD-NET      PIC S9(11)V99     COMP-3.
  1271         16  LR-YTD-EARN     PIC S9(11)V99     COMP-3.
  1272         16  LR-YTD-PAID     PIC S9(11)V99     COMP-3.
  1273         16  LR-YTD-RESV     PIC S9(11)V99     COMP-3.
  1274         16  LR-YTD-INCUR    PIC S9(11)V99     COMP-3.
  1275         16  LR-YTD-RATIO    PIC S9(4)V9       COMP-3.
  1276         16  LR-ITD-NET      PIC S9(11)V99     COMP-3.
  1277         16  LR-ITD-EARN     PIC S9(11)V99     COMP-3.
  1278         16  LR-ITD-PAID     PIC S9(11)V99     COMP-3.
  1279         16  LR-ITD-RESV     PIC S9(11)V99     COMP-3.
  1280         16  LR-ITD-INCUR    PIC S9(11)V99     COMP-3.
  1281         16  LR-ITD-RATIO    PIC S9(4)V9       COMP-3.
  1282
  1283******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL645.cbl
  1285 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA LOSS-RATIO-MASTER.
  1286 0000-DFHEXIT SECTION.
  1287     MOVE '9#                    $   ' TO DFHEIV0.
  1288     MOVE 'EL645' TO DFHEIV1.
  1289     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1290
  1291     CONTINUE.
  1292
  1293     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  1294     MOVE '5'                    TO  DC-OPTION-CODE.
  1295
  1296     PERFORM 7000-DATE-CONVERSION.
  1297
  1298     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1299     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  1300     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  1301     MOVE +2                     TO  EMI-NUMBER-OF-LINES
  1302                                     EMI-SWITCH2.
  1303
  1304*    NOTE *******************************************************
  1305*         *                                                     *
  1306*         *      ACCESS TO THIS MODULE CAN BE ONLY FROM AN XCTL *
  1307*         *  FROM ANOTHER MODULE.                               *
  1308*         *                                                     *
  1309*         *******************************************************.
  1310
  1311     IF EIBCALEN  IS NOT GREATER THAN  ZERO
  1312         MOVE UNACCESS-MSG       TO  LOGOFF-MSG
  1313         GO TO 6000-SEND-TEXT.
  1314
  1315
  1316* EXEC CICS HANDLE CONDITION
  1317*        PGMIDERR  (9400-PGMIDERR)
  1318*        NOTFND    (1020-NOTFND)
  1319*        ENDFILE   (1020-NOTFND)
  1320*        ERROR     (9600-ERROR)
  1321*    END-EXEC.
  1322*    MOVE '"$LI''.                ! " #00001311' TO DFHEIV0
  1323     MOVE X'22244C49272E202020202020' TO DFHEIV0(1:12)
  1324     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1325     MOVE X'2220233030303031333131' TO DFHEIV0(25:11)
  1326     CALL 'kxdfhei1' USING DFHEIV0
  1327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1328
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL645.cbl
  1330 0100-MAIN-LOGIC.
  1331     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  1332         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  1333             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  1334             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  1335             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  1336             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  1337             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  1338             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  1339             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  1340             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  1341         ELSE
  1342             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  1343             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  1344             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  1345             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  1346             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  1347             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  1348             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  1349             MOVE SPACES                TO  PI-SAVED-PROGRAM-6
  1350             PERFORM 3000-BUILD-SCREEN
  1351     ELSE
  1352         GO TO 0120-MAIN-LOGIC.
  1353
  1354 0110-MAIN-LOGIC.
  1355*    NOTE *******************************************************
  1356*         *      INITALIZE THE WORK FIELDS FOR THE PROGRAM      *
  1357*         *  INTERFACE BLOCK FOR THIS MODULE.                   *
  1358*         *******************************************************.
  1359
  1360     MOVE SPACES                 TO  PI-PROGRAM-WORK-AREA
  1361                                     PI-RETURN-SWITCH
  1362                                     PI-CONTROL-IN-PROGRESS.
  1363     MOVE ZERO                   TO  PI-1ST-TIME-SW
  1364                                     PI-LINE-COUNT
  1365                                     PI-BROWSE-SW
  1366                                     PI-KEY-LENGTH
  1367                                     PI-TS-ITEM
  1368                                     PI-END-OF-FILE
  1369                                     PI-START-SW
  1370                                     PI-AIX-RECORD-COUNT.
  1371
  1372*    NOTE *******************************************************
  1373*         *      SEND THE INITIAL MAP OUT TO BEGIN PROCESSING   *
  1374*         *  FOR EL645.                                         *
  1375*         *******************************************************.
  1376
  1377     MOVE LOW-VALUES             TO  EL645AO.
  1378
  1379     PERFORM 4000-SEND-INITIAL-MAP.
  1380
  1381     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL645.cbl
  1383 0120-MAIN-LOGIC.
  1384     IF PI-REENTERED
  1385         GO TO 0900-RESTORE-SCREEN.
  1386
  1387*    NOTE *******************************************************
  1388*         *      AFTER THE FIRST TIME THROUGH THE PROPER ATTEN- *
  1389*         *  TION KEY USAGE NEEDS TO BE CHECKED FOR VALIDITY    *
  1390*         *  BEFORE ANY FURTHER PROCESSING CAN BE DONE.         *
  1391*         *******************************************************.
  1392
  1393     IF EIBAID  IS EQUAL TO  DFHCLEAR
  1394         GO TO 9300-CLEAR.
  1395
  1396     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  1397         MOVE LOW-VALUES         TO  EL645AO
  1398         MOVE -1                 TO  ASELL
  1399         MOVE ER-0008            TO  EMI-ERROR
  1400         PERFORM 5000-SEND-DATA-ONLY
  1401         GO TO 9100-RETURN-TRAN.
  1402
  1403
  1404* EXEC CICS RECEIVE
  1405*        INTO    (EL645AI)
  1406*        MAPSET  (WS-MAPSET-NAME)
  1407*        MAP     (WS-MAP-NAME)
  1408*    END-EXEC.
  1409     MOVE LENGTH OF
  1410      EL645AI
  1411       TO DFHEIV11
  1412*    MOVE '8"T I  L              ''   #00001391' TO DFHEIV0
  1413     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1414     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1415     MOVE X'2020233030303031333931' TO DFHEIV0(25:11)
  1416     CALL 'kxdfhei1' USING DFHEIV0,
  1417           WS-MAP-NAME,
  1418           EL645AI,
  1419           DFHEIV11,
  1420           WS-MAPSET-NAME,
  1421           DFHEIV99,
  1422           DFHEIV99
  1423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1424
  1425
  1426     IF ASELL  EQUAL  ZERO
  1427         GO TO 0125-CHECK-PFKEYS.
  1428
  1429     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  1430         MOVE ER-0004            TO  EMI-ERROR
  1431         MOVE AL-UNBOF           TO  ASELA
  1432         MOVE -1                 TO  ASELL
  1433         PERFORM 5000-SEND-DATA-ONLY
  1434         GO TO 9100-RETURN-TRAN.
  1435
  1436     IF ASELI  IS NUMERIC  AND
  1437       (ASELI  IS GREATER THAN  0  AND
  1438        ASELI  IS LESS THAN  25)
  1439         MOVE PF-VALUES (ASELI)  TO EIBAID
  1440     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL645.cbl
  1441         MOVE ER-0029            TO  EMI-ERROR
  1442         MOVE AL-UNBOF           TO  ASELA
  1443         MOVE -1                 TO  ASELL
  1444         PERFORM 5000-SEND-DATA-ONLY
  1445         GO TO 9100-RETURN-TRAN.
  1446
  1447 0125-CHECK-PFKEYS.
  1448     IF EIBAID  IS EQUAL TO  DFHPF1 OR DFHPF2 OR DFHPF3 OR
  1449                             DFHPF4 OR DFHPF5 OR DFHPF6
  1450         GO TO 0130-MAIN-LOGIC.
  1451
  1452     IF EIBAID  IS EQUAL TO  DFHPF10
  1453         MOVE 'EL659'            TO  THIS-PGM
  1454         GO TO 9200-XCTL.
  1455
  1456     IF EIBAID  IS EQUAL TO  DFHPF12
  1457         MOVE 'EL010'            TO  THIS-PGM
  1458         GO TO 9200-XCTL.
  1459
  1460     IF EIBAID  IS EQUAL TO  DFHPF23
  1461         GO TO 9000-RETURN-CICS.
  1462
  1463     IF EIBAID  IS EQUAL TO  DFHPF24
  1464         MOVE 'EL126'            TO  THIS-PGM
  1465         GO TO 9200-XCTL.
  1466
  1467     MOVE ER-0029                TO  EMI-ERROR.
  1468     MOVE AL-UNBOF               TO  ASELA.
  1469     MOVE -1                     TO  ASELL.
  1470     PERFORM 5000-SEND-DATA-ONLY.
  1471     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL645.cbl
  1473 0130-MAIN-LOGIC.
  1474     MOVE SPACES                 TO  PI-SELECTION-CRITERIA
  1475                                     PI-LOSS-RATIO-KEY.
  1476     MOVE PI-COMPANY-CD          TO  PI-SC-COMPANY-CD
  1477                                     PI-LRK-COMPANY-CD.
  1478     MOVE ACTONLYI               TO  PI-ACTIVE-ONLY.
  1479
  1480     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  1481         NEXT SENTENCE
  1482     ELSE
  1483
  1484* EXEC CICS READQ TS
  1485*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  1486*            INTO    (SECURITY-CONTROL)
  1487*            LENGTH  (SC-COMM-LENGTH)
  1488*            ITEM    (SC-ITEM)
  1489*        END-EXEC
  1490*    MOVE '*$II   L              ''   #00001454' TO DFHEIV0
  1491     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1492     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1493     MOVE X'2020233030303031343534' TO DFHEIV0(25:11)
  1494     CALL 'kxdfhei1' USING DFHEIV0,
  1495           PI-SECURITY-TEMP-STORE-ID,
  1496           SECURITY-CONTROL,
  1497           SC-COMM-LENGTH,
  1498           SC-ITEM,
  1499           DFHEIV99,
  1500           DFHEIV99
  1501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1502         MOVE SC-CREDIT-DISPLAY (31)
  1503                                 TO  PI-DISPLAY-CAP
  1504         MOVE SC-CREDIT-UPDATE  (31)
  1505                                 TO  PI-MODIFY-CAP
  1506         IF NOT DISPLAY-CAP
  1507             MOVE 'READ'         TO  SM-READ
  1508             PERFORM 9700-SECURITY-VIOLATION
  1509             MOVE ER-0070        TO  EMI-ERROR
  1510             PERFORM 4000-SEND-INITIAL-MAP
  1511             GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL645.cbl
  1513 0200-OPTION-1-PROCESSING.
  1514******************************************************************
  1515*           O P T I O N  1  P R O C E S S I N G                  *
  1516******************************************************************
  1517
  1518     IF EIBAID IS EQUAL TO  DFHPF6
  1519         GO TO 0700-OPTION-6-PROCESSING.
  1520
  1521     IF EIBAID IS EQUAL TO  DFHPF5
  1522         GO TO 0600-OPTION-5-PROCESSING.
  1523
  1524     IF EIBAID IS EQUAL TO  DFHPF4
  1525         GO TO 0500-OPTION-4-PROCESSING.
  1526
  1527     IF EIBAID IS EQUAL TO  DFHPF3
  1528         GO TO 0400-OPTION-3-PROCESSING.
  1529
  1530     IF EIBAID IS EQUAL TO  DFHPF2
  1531         GO TO 0300-OPTION-2-PROCESSING.
  1532
  1533     MOVE LOW-VALUES             TO  PI-SELECTION-CRITERIA.
  1534
  1535     MOVE 'EL645C'               TO  PI-MAPNAME.
  1536
  1537     IF PI-CERT-ACCESS-CONTROL = '1'  OR  '2'  OR  '4'
  1538         IF ACARRL  IS GREATER THAN  ZERO
  1539             MOVE ACARRI         TO  PI-SC-CARRIER
  1540         ELSE
  1541             MOVE ER-0005        TO  EMI-ERROR
  1542             MOVE AL-UNBOF       TO  ACARRA
  1543             MOVE -1             TO  ACARRL
  1544             PERFORM 5000-SEND-DATA-ONLY
  1545             GO TO 9100-RETURN-TRAN.
  1546
  1547     IF PI-CERT-ACCESS-CONTROL = '1'
  1548         IF AGROUPL  IS GREATER THAN  ZERO
  1549             MOVE AGROUPI        TO  PI-SC-GROUPING
  1550         ELSE
  1551             MOVE ER-0005        TO  EMI-ERROR
  1552             MOVE AL-UNBOF       TO  AGROUPA
  1553             MOVE -1             TO  AGROUPL
  1554             PERFORM 5000-SEND-DATA-ONLY
  1555             GO TO 9100-RETURN-TRAN.
  1556
  1557     IF PI-CERT-ACCESS-CONTROL = ' '  OR  '1'  OR  '2'
  1558         IF ASTATEL  IS GREATER THAN  ZERO
  1559             MOVE ASTATEI        TO  PI-SC-STATE
  1560         ELSE
  1561             MOVE ER-0005        TO  EMI-ERROR
  1562             MOVE AL-UNBOF       TO  ASTATEA
  1563             MOVE -1             TO  ASTATEL
  1564             PERFORM 5000-SEND-DATA-ONLY
  1565             GO TO 9100-RETURN-TRAN.
  1566
  1567     IF AACCTL  IS GREATER THAN  ZERO
  1568         MOVE AACCTI             TO  PI-SC-ACCOUNT
  1569     ELSE
  1570         MOVE ER-0005            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL645.cbl
  1571         MOVE AL-UNBOF           TO  AACCTA
  1572         MOVE -1                 TO  AACCTL
  1573         PERFORM 5000-SEND-DATA-ONLY
  1574         GO TO 9100-RETURN-TRAN.
  1575
  1576 0210-PROCESS-OPTION-1.
  1577
  1578     MOVE WS-LOSS-RATIO-DSID     TO  PI-DSID.
  1579     MOVE '1'                    TO  PI-OPTION.
  1580     MOVE PI-COMPANY-CD          TO  PI-SC-COMPANY-CD.
  1581     MOVE 'A'                    TO  PI-SC-RCD-TYPE.
  1582     MOVE +47                    TO  PI-KEY-LENGTH.
  1583     MOVE PI-SELECTION-CRITERIA  TO  PI-LOSS-RATIO-KEY
  1584                                     PI-SAVE-LOSS-RATIO-KEY.
  1585     MOVE -1                     TO  ACARRL.
  1586
  1587     PERFORM 1000-READ-LOSS-RATIO.
  1588     GO TO 9200-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL645.cbl
  1590 0300-OPTION-2-PROCESSING.
  1591******************************************************************
  1592*           O P T I O N  2  P R O C E S S I N G                  *
  1593******************************************************************
  1594
  1595     MOVE LOW-VALUES             TO  PI-SELECTION-CRITERIA.
  1596
  1597     MOVE 'EL645B'               TO  PI-MAPNAME.
  1598
  1599     IF PI-CAR-GROUP-ACCESS-CNTL = ' ' OR '2'
  1600         IF ACARRL  IS GREATER THAN  ZERO
  1601             MOVE ACARRI         TO  PI-SC-CARRIER
  1602         ELSE
  1603             MOVE ER-0005        TO  EMI-ERROR
  1604             MOVE AL-UNBOF       TO  ACARRA
  1605             MOVE -1             TO  ACARRL
  1606             PERFORM 5000-SEND-DATA-ONLY
  1607             GO TO 9100-RETURN-TRAN
  1608     ELSE
  1609         IF PI-CAR-GROUP-ACCESS-CNTL = '1' OR '3'
  1610             MOVE '0'            TO  PI-SC-CARRIER.
  1611
  1612     IF PI-CAR-GROUP-ACCESS-CNTL = ' ' OR '1'
  1613         IF AGROUPL  IS GREATER THAN  ZERO
  1614             MOVE AGROUPI        TO  PI-SC-GROUPING
  1615         ELSE
  1616             MOVE ER-0005        TO  EMI-ERROR
  1617             MOVE AL-UNBOF       TO  AGROUPA
  1618             MOVE -1             TO  AGROUPL
  1619             PERFORM 5000-SEND-DATA-ONLY
  1620             GO TO 9100-RETURN-TRAN
  1621     ELSE
  1622         IF PI-CAR-GROUP-ACCESS-CNTL = '2' OR '3'
  1623             MOVE '000000'       TO  PI-SC-GROUPING.
  1624
  1625     IF AGENAGTL  IS GREATER THAN  ZERO
  1626         MOVE AGENAGTI           TO  PI-SC-GA-RPT-CD-2
  1627     ELSE
  1628         MOVE ER-0005            TO  EMI-ERROR
  1629         MOVE AL-UNBOF           TO  AGENAGTA
  1630         MOVE -1                 TO  AGENAGTL
  1631         PERFORM 5000-SEND-DATA-ONLY
  1632         GO TO 9100-RETURN-TRAN.
  1633
  1634     IF AACCTL  IS GREATER THAN  ZERO
  1635         MOVE 'EL645C'           TO  PI-MAPNAME
  1636         MOVE AACCTI             TO  PI-SC-ACCOUNT
  1637     ELSE
  1638         GO TO 0310-PROCESS-OPTION-2.
  1639
  1640     IF PI-CERT-ACCESS-CONTROL = ' '  OR  '1'  OR  '2'
  1641         IF ASTATEL  IS GREATER THAN  ZERO
  1642*            MOVE 'EL645C'       TO  PI-MAPNAME
  1643             MOVE ASTATEI        TO  PI-SC-STATE
  1644         ELSE
  1645             MOVE ER-0005        TO  EMI-ERROR
  1646             MOVE AL-UNBOF       TO  ASTATEA
  1647             MOVE -1             TO  ASTATEL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL645.cbl
  1648             PERFORM 5000-SEND-DATA-ONLY
  1649             GO TO 9100-RETURN-TRAN.
  1650
  1651 0310-PROCESS-OPTION-2.
  1652     MOVE WS-LOSS-RATIO-DSID     TO  PI-DSID.
  1653     MOVE '2'                    TO  PI-OPTION.
  1654     MOVE PI-COMPANY-CD          TO  PI-SC-COMPANY-CD.
  1655     MOVE 'G'                    TO  PI-SC-RCD-TYPE.
  1656     MOVE +47                    TO  PI-KEY-LENGTH.
  1657     MOVE PI-SELECTION-CRITERIA  TO  PI-LOSS-RATIO-KEY
  1658                                     PI-SAVE-LOSS-RATIO-KEY.
  1659     MOVE -1                     TO  ACARRL.
  1660
  1661     PERFORM 1000-READ-LOSS-RATIO.
  1662     GO TO 9200-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL645.cbl
  1664 0400-OPTION-3-PROCESSING.
  1665******************************************************************
  1666*           O P T I O N  3  P R O C E S S I N G                  *
  1667******************************************************************
  1668
  1669     MOVE LOW-VALUES             TO  PI-SELECTION-CRITERIA.
  1670
  1671     MOVE 'EL645B'               TO  PI-MAPNAME.
  1672
  1673     IF AREINCOL  IS GREATER THAN  ZERO
  1674         MOVE AREINCOI           TO  PI-SC-REIN-CO
  1675     ELSE
  1676         MOVE ER-0005            TO  EMI-ERROR
  1677         MOVE AL-UNBOF           TO  AREINCOA
  1678         MOVE -1                 TO  AREINCOL
  1679         PERFORM 5000-SEND-DATA-ONLY
  1680         GO TO 9100-RETURN-TRAN.
  1681
  1682     IF AACCTL  IS GREATER THAN  ZERO
  1683         MOVE 'EL645C'           TO  PI-MAPNAME
  1684         MOVE AACCTI             TO  PI-SC-ACCOUNT
  1685     ELSE
  1686         GO TO 0410-PROCESS-OPTION-3.
  1687
  1688     IF PI-CERT-ACCESS-CONTROL = '1'  OR  '2'  OR  '4'
  1689         IF ACARRL  IS GREATER THAN  ZERO
  1690             MOVE ACARRI         TO  PI-SC-CARRIER
  1691         ELSE
  1692             MOVE ER-0005        TO  EMI-ERROR
  1693             MOVE AL-UNBOF       TO  ACARRA
  1694             MOVE -1             TO  ACARRL
  1695             PERFORM 5000-SEND-DATA-ONLY
  1696             GO TO 9100-RETURN-TRAN.
  1697
  1698     IF PI-CERT-ACCESS-CONTROL = '1'
  1699         IF AGROUPL  IS GREATER THAN  ZERO
  1700             MOVE AGROUPI        TO  PI-SC-GROUPING
  1701         ELSE
  1702             MOVE ER-0005        TO  EMI-ERROR
  1703             MOVE AL-UNBOF       TO  AGROUPA
  1704             MOVE -1             TO  AGROUPL
  1705             PERFORM 5000-SEND-DATA-ONLY
  1706             GO TO 9100-RETURN-TRAN.
  1707
  1708     IF PI-CERT-ACCESS-CONTROL = ' '  OR  '1'  OR  '2'
  1709         IF ASTATEL  IS GREATER THAN  ZERO
  1710             MOVE ASTATEI        TO  PI-SC-STATE
  1711         ELSE
  1712             MOVE ER-0005        TO  EMI-ERROR
  1713             MOVE AL-UNBOF       TO  ASTATEA
  1714             MOVE -1             TO  ASTATEL
  1715             PERFORM 5000-SEND-DATA-ONLY
  1716             GO TO 9100-RETURN-TRAN.
  1717
  1718 0410-PROCESS-OPTION-3.
  1719     MOVE WS-LOSS-RATIO-DSID     TO  PI-DSID.
  1720     MOVE '3'                    TO  PI-OPTION.
  1721     MOVE PI-COMPANY-CD          TO  PI-SC-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL645.cbl
  1722     MOVE 'R'                    TO  PI-SC-RCD-TYPE.
  1723     MOVE +47                    TO  PI-KEY-LENGTH.
  1724     MOVE PI-SELECTION-CRITERIA  TO  PI-LOSS-RATIO-KEY
  1725                                     PI-SAVE-LOSS-RATIO-KEY.
  1726     MOVE -1                     TO  AREINCOL.
  1727
  1728     PERFORM 1000-READ-LOSS-RATIO.
  1729     GO TO 9200-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL645.cbl
  1731 0500-OPTION-4-PROCESSING.
  1732******************************************************************
  1733*           O P T I O N  4  P R O C E S S I N G                  *
  1734******************************************************************
  1735
  1736     MOVE LOW-VALUES             TO  PI-SELECTION-CRITERIA.
  1737
  1738     MOVE 'EL645B'               TO  PI-MAPNAME.
  1739
  1740     IF ARPTCD1L  IS GREATER THAN  ZERO
  1741         MOVE ARPTCD1I           TO  PI-SC-RPT-CD-1
  1742     ELSE
  1743         MOVE ER-0005            TO  EMI-ERROR
  1744         MOVE AL-UNBOF           TO  ARPTCD1A
  1745         MOVE -1                 TO  ARPTCD1L
  1746         PERFORM 5000-SEND-DATA-ONLY
  1747         GO TO 9100-RETURN-TRAN.
  1748
  1749     IF AACCTL  IS GREATER THAN  ZERO
  1750         MOVE 'EL645C'           TO  PI-MAPNAME
  1751         MOVE AACCTI             TO  PI-SC-ACCOUNT
  1752     ELSE
  1753         GO TO 0510-PROCESS-OPTION-4.
  1754
  1755     IF PI-CERT-ACCESS-CONTROL = '1'  OR  '2'  OR  '4'
  1756         IF ACARRL  IS GREATER THAN  ZERO
  1757             MOVE ACARRI         TO  PI-SC-CARRIER
  1758         ELSE
  1759             MOVE ER-0005        TO  EMI-ERROR
  1760             MOVE AL-UNBOF       TO  ACARRA
  1761             MOVE -1             TO  ACARRL
  1762             PERFORM 5000-SEND-DATA-ONLY
  1763             GO TO 9100-RETURN-TRAN.
  1764
  1765     IF PI-CERT-ACCESS-CONTROL = '1'
  1766         IF AGROUPL  IS GREATER THAN  ZERO
  1767             MOVE AGROUPI        TO  PI-SC-GROUPING
  1768         ELSE
  1769             MOVE ER-0005        TO  EMI-ERROR
  1770             MOVE AL-UNBOF       TO  AGROUPA
  1771             MOVE -1             TO  AGROUPL
  1772             PERFORM 5000-SEND-DATA-ONLY
  1773             GO TO 9100-RETURN-TRAN.
  1774
  1775     IF PI-CERT-ACCESS-CONTROL = ' '  OR  '1'  OR  '2'
  1776         IF ASTATEL  IS GREATER THAN  ZERO
  1777             MOVE ASTATEI        TO  PI-SC-STATE
  1778         ELSE
  1779             MOVE ER-0005        TO  EMI-ERROR
  1780             MOVE AL-UNBOF       TO  ASTATEA
  1781             MOVE -1             TO  ASTATEL
  1782             PERFORM 5000-SEND-DATA-ONLY
  1783             GO TO 9100-RETURN-TRAN.
  1784
  1785 0510-PROCESS-OPTION-4.
  1786     MOVE WS-LOSS-RATIO-DSID     TO  PI-DSID.
  1787     MOVE '4'                    TO  PI-OPTION.
  1788     MOVE PI-COMPANY-CD          TO  PI-SC-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL645.cbl
  1789     MOVE 'B'                    TO  PI-SC-RCD-TYPE.
  1790     MOVE +47                    TO  PI-KEY-LENGTH.
  1791     MOVE PI-SELECTION-CRITERIA  TO  PI-LOSS-RATIO-KEY
  1792                                     PI-SAVE-LOSS-RATIO-KEY.
  1793     MOVE -1                     TO  ARPTCD1L.
  1794
  1795     PERFORM 1000-READ-LOSS-RATIO.
  1796     GO TO 9200-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL645.cbl
  1798 0600-OPTION-5-PROCESSING.
  1799******************************************************************
  1800*           O P T I O N  5  P R O C E S S I N G                  *
  1801******************************************************************
  1802
  1803     MOVE LOW-VALUES             TO  PI-SELECTION-CRITERIA.
  1804
  1805     MOVE 'EL645B'               TO  PI-MAPNAME.
  1806
  1807     IF ARPTCD2L  IS GREATER THAN  ZERO
  1808         MOVE ARPTCD2I           TO  PI-SC-GA-RPT-CD-2
  1809     ELSE
  1810         MOVE ER-0005            TO  EMI-ERROR
  1811         MOVE AL-UNBOF           TO  ARPTCD2A
  1812         MOVE -1                 TO  ARPTCD2L
  1813         PERFORM 5000-SEND-DATA-ONLY
  1814         GO TO 9100-RETURN-TRAN.
  1815
  1816     IF PI-CERT-ACCESS-CONTROL = '1'  OR  '2'  OR  '4'
  1817         IF ACARRL  IS GREATER THAN  ZERO
  1818             MOVE ACARRI         TO  PI-SC-CARRIER
  1819         ELSE
  1820             MOVE ER-0005        TO  EMI-ERROR
  1821             MOVE AL-UNBOF       TO  ACARRA
  1822             MOVE -1             TO  ACARRL
  1823             PERFORM 5000-SEND-DATA-ONLY
  1824             GO TO 9100-RETURN-TRAN.
  1825
  1826     IF PI-CERT-ACCESS-CONTROL = '1'
  1827         IF AGROUPL  IS GREATER THAN  ZERO
  1828             MOVE AGROUPI        TO  PI-SC-GROUPING
  1829         ELSE
  1830             MOVE ER-0005        TO  EMI-ERROR
  1831             MOVE AL-UNBOF       TO  AGROUPA
  1832             MOVE -1             TO  AGROUPL
  1833             PERFORM 5000-SEND-DATA-ONLY
  1834             GO TO 9100-RETURN-TRAN.
  1835
  1836     IF AACCTL  IS GREATER THAN  ZERO
  1837         MOVE 'EL645C'           TO  PI-MAPNAME
  1838         MOVE AACCTI             TO  PI-SC-ACCOUNT
  1839     ELSE
  1840         GO TO 0610-PROCESS-OPTION-5.
  1841
  1842     IF PI-CERT-ACCESS-CONTROL = ' '  OR  '1'  OR  '2'
  1843         IF ASTATEL  IS GREATER THAN  ZERO
  1844             MOVE ASTATEI        TO  PI-SC-STATE
  1845         ELSE
  1846             MOVE ER-0005        TO  EMI-ERROR
  1847             MOVE AL-UNBOF       TO  ASTATEA
  1848             MOVE -1             TO  ASTATEL
  1849             PERFORM 5000-SEND-DATA-ONLY
  1850             GO TO 9100-RETURN-TRAN.
  1851
  1852 0610-PROCESS-OPTION-5.
  1853     MOVE WS-LOSS-RATIO-DSID     TO  PI-DSID.
  1854     MOVE '5'                    TO  PI-OPTION.
  1855     MOVE PI-COMPANY-CD          TO  PI-SC-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL645.cbl
  1856     MOVE 'C'                    TO  PI-SC-RCD-TYPE.
  1857     MOVE +47                    TO  PI-KEY-LENGTH.
  1858     MOVE PI-SELECTION-CRITERIA  TO  PI-LOSS-RATIO-KEY
  1859                                     PI-SAVE-LOSS-RATIO-KEY.
  1860     MOVE -1                     TO  ACARRL.
  1861
  1862     PERFORM 1000-READ-LOSS-RATIO.
  1863     GO TO 9200-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL645.cbl
  1865 0700-OPTION-6-PROCESSING.
  1866******************************************************************
  1867*           O P T I O N  6  P R O C E S S I N G                  *
  1868******************************************************************
  1869
  1870     MOVE LOW-VALUES             TO  PI-SELECTION-CRITERIA.
  1871
  1872     MOVE 'EL645B'               TO  PI-MAPNAME.
  1873
  1874     IF ASTATEL  IS GREATER THAN  ZERO
  1875         MOVE ASTATEI            TO  PI-SC-STATE
  1876     ELSE
  1877         MOVE ER-0005            TO  EMI-ERROR
  1878         MOVE AL-UNBOF           TO  ASTATEA
  1879         MOVE -1                 TO  ASTATEL
  1880         PERFORM 5000-SEND-DATA-ONLY
  1881         GO TO 9100-RETURN-TRAN.
  1882
  1883 0710-PROCESS-OPTION-6.
  1884     MOVE WS-LOSS-RATIO-DSID     TO  PI-DSID.
  1885     MOVE '6'                    TO  PI-OPTION.
  1886     MOVE PI-COMPANY-CD          TO  PI-SC-COMPANY-CD.
  1887     MOVE 'S'                    TO  PI-SC-RCD-TYPE.
  1888     MOVE +47                    TO  PI-KEY-LENGTH.
  1889     MOVE PI-SELECTION-CRITERIA  TO  PI-LOSS-RATIO-KEY
  1890                                     PI-SAVE-LOSS-RATIO-KEY.
  1891     MOVE -1                     TO  ASELL.
  1892
  1893     PERFORM 1000-READ-LOSS-RATIO.
  1894     GO TO 9200-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL645.cbl
  1896 0900-RESTORE-SCREEN.
  1897     MOVE SPACE                  TO  PI-RETURN-SWITCH.
  1898     MOVE ZERO                   TO  PI-1ST-TIME-SW
  1899                                     PI-LINE-COUNT
  1900                                     PI-BROWSE-SW
  1901                                     PI-KEY-LENGTH
  1902                                     PI-TS-ITEM
  1903                                     PI-END-OF-FILE
  1904                                     PI-START-SW
  1905                                     PI-AIX-RECORD-COUNT.
  1906     MOVE LOW-VALUES             TO  EL645AO.
  1907     MOVE PI-SAVE-LRK-REIN-CO    TO  AREINCOO.
  1908     MOVE PI-SAVE-LRK-RPT-CD-1   TO  ARPTCD1O.
  1909     MOVE PI-SAVE-LRK-CARRIER    TO  ACARRO.
  1910     MOVE PI-SAVE-LRK-GROUPING   TO  AGROUPO.
  1911     IF OPTION-FIVE-SELECTED
  1912         MOVE PI-SAVE-LRK-GA-RPT-CD-2
  1913                                 TO  ARPTCD2O
  1914     ELSE
  1915         MOVE PI-SAVE-LRK-GA-RPT-CD-2
  1916                                 TO  AGENAGTO.
  1917     MOVE PI-SAVE-LRK-STATE      TO  ASTATEO.
  1918     MOVE PI-SAVE-LRK-ACCOUNT    TO  AACCTO.
  1919     MOVE AL-UANON               TO  ACTONLYA.
  1920     MOVE PI-ACTIVE-ONLY         TO  ACTONLYO.
  1921     MOVE -1                     TO  ACARRL.
  1922
  1923     PERFORM 5000-SEND-DATA-ONLY.
  1924
  1925     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL645.cbl
  1927 1000-READ-LOSS-RATIO  SECTION.
  1928
  1929* EXEC CICS HANDLE CONDITION
  1930*        DUPKEY   (9200-XCTL)
  1931*        NOTFND   (1020-NOTFND)
  1932*        DSIDERR  (1010-DSIDERR)
  1933*    END-EXEC.
  1934*    MOVE '"$$I"                 ! # #00001886' TO DFHEIV0
  1935     MOVE X'222424492220202020202020' TO DFHEIV0(1:12)
  1936     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1937     MOVE X'2320233030303031383836' TO DFHEIV0(25:11)
  1938     CALL 'kxdfhei1' USING DFHEIV0
  1939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1940
  1941
  1942     MOVE +1                     TO  PI-START-SW.
  1943
  1944
  1945* EXEC CICS READ
  1946*        DATASET    (PI-DSID)
  1947*        RIDFLD     (PI-LOSS-RATIO-KEY)
  1948*        SET        (ADDRESS OF LOSS-RATIO-MASTER)
  1949*    END-EXEC.
  1950*    MOVE '&"S        E          (   #00001894' TO DFHEIV0
  1951     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1953     MOVE X'2020233030303031383934' TO DFHEIV0(25:11)
  1954     CALL 'kxdfhei1' USING DFHEIV0,
  1955           PI-DSID,
  1956           DFHEIV20,
  1957           DFHEIV99,
  1958           PI-LOSS-RATIO-KEY,
  1959           DFHEIV99,
  1960           DFHEIV99,
  1961           DFHEIV99
  1962     SET ADDRESS OF LOSS-RATIO-MASTER TO
  1963         DFHEIV20
  1964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1965
  1966
  1967     CONTINUE.
  1968
  1969     IF LR-COMPANY-CD  IS EQUAL TO  PI-COMPANY-CD
  1970         NEXT SENTENCE
  1971     ELSE
  1972         GO TO 1020-NOTFND.
  1973
  1974     MOVE 'EL6451'               TO  THIS-PGM.
  1975
  1976     GO TO 1099-EXIT.
  1977*PEM GO TO 9200-XCTL.
  1978
  1979 1010-DSIDERR.
  1980     MOVE ER-0671                TO  EMI-ERROR.
  1981
  1982     PERFORM 5000-SEND-DATA-ONLY.
  1983
  1984     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL645.cbl
  1985
  1986 1020-NOTFND.
  1987     MOVE ER-0674                TO  EMI-ERROR.
  1988
  1989     PERFORM 5000-SEND-DATA-ONLY.
  1990
  1991     GO TO 9100-RETURN-TRAN.
  1992
  1993 1099-EXIT.
  1994     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL645.cbl
  1996 3000-BUILD-SCREEN  SECTION.
  1997******************************************************************
  1998*          REBUILD ORIGNAL SCREEN AND ERROR MESSAGE IF EL6451    *
  1999*          DID NOT FIND ANY CERTIFICATES DURING BROWSE OF FILE.  *
  2000******************************************************************
  2001
  2002     IF EIBTRNID  IS EQUAL TO  WS-TRANS-ID
  2003         NEXT SENTENCE
  2004     ELSE
  2005         GO TO 3099-EXIT.
  2006
  2007     MOVE LOW-VALUES             TO  EL645AO.
  2008     MOVE ER-0674                TO  EMI-ERROR.
  2009
  2010     MOVE PI-SC-CARRIER          TO  ACARRO.
  2011     MOVE PI-SC-GROUPING         TO  AGROUPO.
  2012     MOVE PI-SC-STATE            TO  ASTATEO.
  2013     MOVE PI-SC-ACCOUNT          TO  AACCTO.
  2014
  2015     IF OPTION-TWO-SELECTED
  2016         GO TO 3020-OPTION-TWO.
  2017
  2018     IF OPTION-THREE-SELECTED
  2019         GO TO 3030-OPTION-THREE.
  2020
  2021     IF OPTION-FOUR-SELECTED
  2022         GO TO 3040-OPTION-FOUR.
  2023
  2024     IF OPTION-FIVE-SELECTED
  2025         GO TO 3050-OPTION-FIVE.
  2026
  2027     IF OPTION-SIX-SELECTED
  2028         GO TO 3060-OPTION-SIX.
  2029
  2030 3010-OPTION-ONE.
  2031     MOVE -1                     TO  ACARRL.
  2032     MOVE AL-UANON               TO  ACARRA.
  2033
  2034     GO TO 3070-INITIALIZE-WORK-AREAS.
  2035
  2036 3020-OPTION-TWO.
  2037     MOVE PI-SC-GA-RPT-CD-2      TO  AGENAGTO.
  2038     MOVE -1                     TO  AGENAGTL.
  2039     MOVE AL-UANON               TO  AGENAGTA.
  2040
  2041     GO TO 3070-INITIALIZE-WORK-AREAS.
  2042
  2043 3030-OPTION-THREE.
  2044     MOVE PI-SC-REIN-CO          TO  AREINCOO.
  2045     MOVE -1                     TO  AREINCOL.
  2046     MOVE AL-UANON               TO  AREINCOA.
  2047
  2048     GO TO 3070-INITIALIZE-WORK-AREAS.
  2049
  2050 3040-OPTION-FOUR.
  2051     MOVE PI-SC-RPT-CD-1         TO  ARPTCD1O.
  2052     MOVE -1                     TO  ARPTCD1L.
  2053     MOVE AL-UANON               TO  ARPTCD1A.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL645.cbl
  2054
  2055     GO TO 3070-INITIALIZE-WORK-AREAS.
  2056
  2057 3050-OPTION-FIVE.
  2058     MOVE PI-SC-GA-RPT-CD-2      TO  ARPTCD2O.
  2059     MOVE -1                     TO  ARPTCD2L.
  2060     MOVE AL-UANON               TO  ARPTCD2A.
  2061
  2062     GO TO 3070-INITIALIZE-WORK-AREAS.
  2063
  2064 3060-OPTION-SIX.
  2065     MOVE PI-SC-STATE            TO  ASTATEO.
  2066     MOVE -1                     TO  ASTATEL.
  2067     MOVE AL-UANON               TO  ASTATEA.
  2068
  2069 3070-INITIALIZE-WORK-AREAS.
  2070     MOVE SPACES                 TO  PI-PROGRAM-WORK-AREA
  2071                                     PI-CONTROL-IN-PROGRESS.
  2072     MOVE ZERO                   TO  PI-1ST-TIME-SW
  2073                                     PI-LINE-COUNT
  2074                                     PI-BROWSE-SW
  2075                                     PI-KEY-LENGTH
  2076                                     PI-TS-ITEM
  2077                                     PI-END-OF-FILE
  2078                                     PI-START-SW
  2079                                     PI-AIX-RECORD-COUNT.
  2080
  2081     PERFORM 5000-SEND-DATA-ONLY.
  2082
  2083     GO TO 9100-RETURN-TRAN.
  2084
  2085 3099-EXIT.
  2086     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL645.cbl
  2088 4000-SEND-INITIAL-MAP  SECTION.
  2089     MOVE -1                     TO  ACARRL.
  2090     MOVE SAVE-DATE              TO  ADATEO.
  2091     MOVE EIBTIME                TO  TIME-IN.
  2092     MOVE TIME-OUT               TO  ATIMEO.
  2093     MOVE AL-UANON               TO  ACTONLYA.
  2094     MOVE 'Y'                    TO  ACTONLYO.
  2095
  2096     IF EMI-ERROR  IS NOT EQUAL TO  ZERO
  2097         PERFORM 9500-ERROR-FORMAT
  2098     ELSE
  2099         IF TRANSACTION-SUCCESSFUL
  2100             PERFORM 9500-ERROR-FORMAT.
  2101
  2102     MOVE EMI-MESSAGE-AREA (1)   TO  AEMSG1O.
  2103     MOVE EMI-MESSAGE-AREA (2)   TO  AEMSG2O.
  2104
  2105
  2106* EXEC CICS SEND
  2107*        FROM    (EL645AO)
  2108*        MAPSET  (WS-MAPSET-NAME)
  2109*        MAP     (WS-MAP-NAME)
  2110*        CURSOR
  2111*        ERASE
  2112*    END-EXEC.
  2113     MOVE LENGTH OF
  2114      EL645AO
  2115       TO DFHEIV12
  2116     MOVE -1
  2117       TO DFHEIV11
  2118*    MOVE '8$     CT  E    H L F ,   #00002038' TO DFHEIV0
  2119     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2120     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2121     MOVE X'2020233030303032303338' TO DFHEIV0(25:11)
  2122     CALL 'kxdfhei1' USING DFHEIV0,
  2123           WS-MAP-NAME,
  2124           EL645AO,
  2125           DFHEIV12,
  2126           WS-MAPSET-NAME,
  2127           DFHEIV99,
  2128           DFHEIV99,
  2129           DFHEIV99,
  2130           DFHEIV11,
  2131           DFHEIV99,
  2132           DFHEIV99,
  2133           DFHEIV99
  2134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2135
  2136
  2137 4099-EXIT.
  2138     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL645.cbl
  2140 5000-SEND-DATA-ONLY SECTION.
  2141     MOVE SAVE-DATE              TO  ADATEO.
  2142     MOVE EIBTIME                TO  TIME-IN.
  2143     MOVE TIME-OUT               TO  ATIMEO.
  2144
  2145     IF EMI-ERROR  IS NOT EQUAL TO  ZERO
  2146         PERFORM 9500-ERROR-FORMAT.
  2147
  2148     MOVE EMI-MESSAGE-AREA (1)   TO  AEMSG1O.
  2149     MOVE EMI-MESSAGE-AREA (2)   TO  AEMSG2O.
  2150
  2151
  2152* EXEC CICS SEND DATAONLY
  2153*        FROM    (EL645AO)
  2154*        MAPSET  (WS-MAPSET-NAME)
  2155*        MAP     (WS-MAP-NAME)
  2156*        CURSOR
  2157*    END-EXEC.
  2158     MOVE LENGTH OF
  2159      EL645AO
  2160       TO DFHEIV12
  2161     MOVE -1
  2162       TO DFHEIV11
  2163*    MOVE '8$D    CT       H L F ,   #00002060' TO DFHEIV0
  2164     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2165     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2166     MOVE X'2020233030303032303630' TO DFHEIV0(25:11)
  2167     CALL 'kxdfhei1' USING DFHEIV0,
  2168           WS-MAP-NAME,
  2169           EL645AO,
  2170           DFHEIV12,
  2171           WS-MAPSET-NAME,
  2172           DFHEIV99,
  2173           DFHEIV99,
  2174           DFHEIV99,
  2175           DFHEIV11,
  2176           DFHEIV99,
  2177           DFHEIV99,
  2178           DFHEIV99
  2179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2180
  2181
  2182 5099-EXIT.
  2183     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL645.cbl
  2185 6000-SEND-TEXT  SECTION.
  2186
  2187* EXEC CICS SEND TEXT
  2188*        FROM    (LOGOFF-TEXT)
  2189*        LENGTH  (LOGOFF-LENGTH)
  2190*        ERASE
  2191*        FREEKB
  2192*    END-EXEC.
  2193*    MOVE '8&      T  E F  H   F -   #00002071' TO DFHEIV0
  2194     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2195     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2196     MOVE X'2020233030303032303731' TO DFHEIV0(25:11)
  2197     CALL 'kxdfhei1' USING DFHEIV0,
  2198           LOGOFF-TEXT,
  2199           LOGOFF-LENGTH,
  2200           DFHEIV99,
  2201           DFHEIV99,
  2202           DFHEIV99,
  2203           DFHEIV99,
  2204           DFHEIV99,
  2205           DFHEIV99,
  2206           DFHEIV99,
  2207           DFHEIV99,
  2208           DFHEIV99,
  2209           DFHEIV99
  2210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2211
  2212
  2213
  2214* EXEC CICS RETURN
  2215*        END-EXEC.
  2216*    MOVE '.(                    &   #00002078' TO DFHEIV0
  2217     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2218     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2219     MOVE X'2020233030303032303738' TO DFHEIV0(25:11)
  2220     CALL 'kxdfhei1' USING DFHEIV0,
  2221           DFHEIV99,
  2222           DFHEIV99,
  2223           DFHEIV99,
  2224           DFHEIV99,
  2225           DFHEIV99
  2226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2227
  2228
  2229 6099-EXIT.
  2230     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL645.cbl
  2232 7000-DATE-CONVERSION  SECTION.
  2233
  2234* EXEC CICS LINK
  2235*        PROGRAM   ('ELDATCV')
  2236*        COMMAREA  (DATE-CONVERSION-DATA)
  2237*        LENGTH    (DC-COMM-LENGTH)
  2238*    END-EXEC.
  2239     MOVE 'ELDATCV' TO DFHEIV1
  2240*    MOVE '."C                   ''   #00002085' TO DFHEIV0
  2241     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2242     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2243     MOVE X'2020233030303032303835' TO DFHEIV0(25:11)
  2244     CALL 'kxdfhei1' USING DFHEIV0,
  2245           DFHEIV1,
  2246           DATE-CONVERSION-DATA,
  2247           DC-COMM-LENGTH,
  2248           DFHEIV99,
  2249           DFHEIV99,
  2250           DFHEIV99
  2251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2252
  2253
  2254 7099-EXIT.
  2255     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL645.cbl
  2257 9000-RETURN-CICS  SECTION.
  2258     MOVE 'EL005'                TO  THIS-PGM.
  2259     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2260
  2261     GO TO 9200-XCTL.
  2262
  2263 9099-EXIT.
  2264     EXIT.
  2265
  2266 9100-RETURN-TRAN  SECTION.
  2267     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  2268     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  2269
  2270
  2271* EXEC CICS RETURN
  2272*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  2273*        LENGTH    (PI-COMM-LENGTH)
  2274*        TRANSID   (WS-TRANS-ID)
  2275*    END-EXEC.
  2276*    MOVE '.(CT                  &   #00002107' TO DFHEIV0
  2277     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2278     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2279     MOVE X'2020233030303032313037' TO DFHEIV0(25:11)
  2280     CALL 'kxdfhei1' USING DFHEIV0,
  2281           WS-TRANS-ID,
  2282           PROGRAM-INTERFACE-BLOCK,
  2283           PI-COMM-LENGTH,
  2284           DFHEIV99,
  2285           DFHEIV99
  2286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2287
  2288
  2289 9199-EXIT.
  2290     EXIT.
  2291
  2292 9200-XCTL  SECTION.
  2293     MOVE DFHENTER               TO  EIBAID.
  2294
  2295
  2296* EXEC CICS XCTL
  2297*        PROGRAM   (THIS-PGM)
  2298*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  2299*        LENGTH    (PI-COMM-LENGTH)
  2300*    END-EXEC.
  2301*    MOVE '.$C                   $   #00002119' TO DFHEIV0
  2302     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2303     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2304     MOVE X'2020233030303032313139' TO DFHEIV0(25:11)
  2305     CALL 'kxdfhei1' USING DFHEIV0,
  2306           THIS-PGM,
  2307           PROGRAM-INTERFACE-BLOCK,
  2308           PI-COMM-LENGTH
  2309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2310
  2311
  2312 9299-EXIT.
  2313     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL645.cbl
  2315 9300-CLEAR  SECTION.
  2316     MOVE PI-RETURN-TO-PROGRAM   TO  THIS-PGM.
  2317
  2318     GO TO 9200-XCTL.
  2319
  2320 9399-EXIT.
  2321     EXIT.
  2322
  2323 9400-PGMIDERR  SECTION.
  2324
  2325* EXEC CICS HANDLE CONDITION
  2326*        PGMIDERR  (6000-SEND-TEXT)
  2327*    END-EXEC.
  2328*    MOVE '"$L                   ! $ #00002137' TO DFHEIV0
  2329     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2330     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2331     MOVE X'2420233030303032313337' TO DFHEIV0(25:11)
  2332     CALL 'kxdfhei1' USING DFHEIV0
  2333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2334
  2335
  2336     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  2337                                     LOGOFF-PGM.
  2338     MOVE 'EL005'                TO  THIS-PGM.
  2339     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  2340     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  2341
  2342     GO TO 9200-XCTL.
  2343
  2344 9499-EXIT.
  2345     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL645.cbl
  2347 9500-ERROR-FORMAT  SECTION.
  2348
  2349* EXEC CICS LINK
  2350*        PROGRAM   ('EL001')
  2351*        COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  2352*        LENGTH    (EMI-COMM-LENGTH)
  2353*    END-EXEC.
  2354     MOVE 'EL001' TO DFHEIV1
  2355*    MOVE '."C                   ''   #00002153' TO DFHEIV0
  2356     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2357     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2358     MOVE X'2020233030303032313533' TO DFHEIV0(25:11)
  2359     CALL 'kxdfhei1' USING DFHEIV0,
  2360           DFHEIV1,
  2361           ERROR-MESSAGE-INTERFACE-BLOCK,
  2362           EMI-COMM-LENGTH,
  2363           DFHEIV99,
  2364           DFHEIV99,
  2365           DFHEIV99
  2366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2367
  2368
  2369 9599-EXIT.
  2370     EXIT.
  2371
  2372 9600-ERROR  SECTION.
  2373     MOVE DFHEIBLK               TO  EMI-LINE1.
  2374
  2375
  2376* EXEC CICS LINK
  2377*        PROGRAM   ('EL004')
  2378*        COMMAREA  (EMI-LINE1)
  2379*        LENGTH    (72)
  2380*    END-EXEC.
  2381     MOVE 'EL004' TO DFHEIV1
  2382     MOVE 72
  2383       TO DFHEIV11
  2384*    MOVE '."C                   ''   #00002165' TO DFHEIV0
  2385     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2386     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2387     MOVE X'2020233030303032313635' TO DFHEIV0(25:11)
  2388     CALL 'kxdfhei1' USING DFHEIV0,
  2389           DFHEIV1,
  2390           EMI-LINE1,
  2391           DFHEIV11,
  2392           DFHEIV99,
  2393           DFHEIV99,
  2394           DFHEIV99
  2395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2396
  2397
  2398     PERFORM 5000-SEND-DATA-ONLY.
  2399
  2400     GO TO 9100-RETURN-TRAN.
  2401
  2402 9699-EXIT.
  2403     EXIT.
  2404
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL645.cbl
  2405 9700-SECURITY-VIOLATION.
  2406*                                COPY ELCSCTP.
  2407******************************************************************
  2408*                                                                *
  2409*                            ELCSCTP                             *
  2410*                            VMOD=2.001                          *
  2411*                                                                *
  2412*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2413******************************************************************
  2414
  2415
  2416     MOVE EIBDATE          TO SM-JUL-DATE.
  2417     MOVE EIBTRMID         TO SM-TERMID.
  2418     MOVE THIS-PGM         TO SM-PGM.
  2419     MOVE EIBTIME          TO TIME-IN.
  2420     MOVE TIME-OUT         TO SM-TIME.
  2421     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2422
  2423
  2424* EXEC CICS LINK
  2425*         PROGRAM  ('EL003')
  2426*         COMMAREA (SECURITY-MESSAGE)
  2427*         LENGTH   (80)
  2428*    END-EXEC.
  2429     MOVE 'EL003' TO DFHEIV1
  2430     MOVE 80
  2431       TO DFHEIV11
  2432*    MOVE '."C                   ''   #00002196' TO DFHEIV0
  2433     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2434     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2435     MOVE X'2020233030303032313936' TO DFHEIV0(25:11)
  2436     CALL 'kxdfhei1' USING DFHEIV0,
  2437           DFHEIV1,
  2438           SECURITY-MESSAGE,
  2439           DFHEIV11,
  2440           DFHEIV99,
  2441           DFHEIV99,
  2442           DFHEIV99
  2443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2444
  2445
  2446******************************************************************
  2447
  2448
  2449 9799-EXIT.
  2450     EXIT.
  2451
  2452 9999-LAST-PARAGRAPH  SECTION.
  2453
  2454* GOBACK.
  2455     MOVE '9%                    "   ' TO DFHEIV0
  2456     MOVE 'EL645' TO DFHEIV1
  2457     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2458     GOBACK.
  2459
  2460 9999-DFHBACK SECTION.
  2461     MOVE '9%                    "   ' TO DFHEIV0
  2462     MOVE 'EL645' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL645.cbl
  2463     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2464     GOBACK.
  2465 9999-DFHEXIT.
  2466     IF DFHEIGDJ EQUAL 0001
  2467         NEXT SENTENCE
  2468     ELSE IF DFHEIGDJ EQUAL 2
  2469         GO TO 9400-PGMIDERR,
  2470               1020-NOTFND,
  2471               1020-NOTFND,
  2472               9600-ERROR
  2473         DEPENDING ON DFHEIGDI
  2474     ELSE IF DFHEIGDJ EQUAL 3
  2475         GO TO 9200-XCTL,
  2476               1020-NOTFND,
  2477               1010-DSIDERR
  2478         DEPENDING ON DFHEIGDI
  2479     ELSE IF DFHEIGDJ EQUAL 4
  2480         GO TO 6000-SEND-TEXT
  2481         DEPENDING ON DFHEIGDI.
  2482     MOVE '9%                    "   ' TO DFHEIV0
  2483     MOVE 'EL645' TO DFHEIV1
  2484     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2485     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3600     Code:        6239
